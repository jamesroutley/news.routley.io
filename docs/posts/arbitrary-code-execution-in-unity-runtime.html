<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://flatt.tech/research/posts/arbitrary-code-execution-in-unity-runtime/">Original</a>
    <h1>Arbitrary code execution in Unity Runtime</h1>
    
    <div id="readability-page-1" class="page"><article>

    
    
    <h5>
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <rect x="4" y="5" width="16" height="16" rx="2"></rect>
        <line x1="16" y1="3" x2="16" y2="7"></line>
        <line x1="8" y1="3" x2="8" y2="7"></line>
        <line x1="4" y1="11" x2="20" y2="11"></line>
        <rect x="8" y="15" width="2" height="2"></rect>
      </svg>
      Posted on 
  
    October 3, 2025
  


      
         • 
      
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <circle cx="12" cy="12" r="9"></circle>
        <polyline points="12 7 12 12 15 15"></polyline>
      </svg>
      6 minutes
       •
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"></path>
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"></path>
        <line x1="3" y1="6" x2="3" y2="19"></line>
        <line x1="12" y1="6" x2="12" y2="19"></line>
        <line x1="21" y1="6" x2="21" y2="19"></line>
      </svg>
      1067 words
      
    </h5>
    

    <details id="TableOfContents">
    <summary>
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul>
        

        
        <li>
        <a href="#introduction">Introduction</a>
        

        
        </li><li>
        <a href="#tldr">TL;DR</a>
        

        
        </li><li>
        <a href="#about-unity">About Unity</a>
        

        
        </li><li>
        <a href="#technical-details">Technical Details</a>
        

        
        <ul>
            <li>
        <a href="#unitys-intent-handler">Unity’s Intent Handler</a>
        

        
        </li><li>
        <a href="#xrsdk-pre-init-library-command-line-argument">xrsdk-pre-init-library Command Line Argument</a>
        

        
        </li></ul>
      </li><li>
        <a href="#attack-scenarios">Attack Scenarios</a>
        

        
        <ul>
            <li>
        <a href="#local-attack">Local Attack</a>
        

        
        </li><li>
        <a href="#remote-exploitation-via-browser">Remote Exploitation via Browser</a>
        

        
        </li><li>
        <a href="#selinux-restrictions">SELinux Restrictions</a>
        

        
        </li><li>
        <a href="#requirements-for-remote-exploitation">Requirements for Remote Exploitation</a>
        

        
        </li></ul>
      </li><li>
        <a href="#demonstration">Demonstration</a>
        

        
        </li><li>
        <a href="#conclusion">Conclusion</a>
        

        
        </li><li>
        <a href="#shameless-plug">Shameless plug</a>
        </li></ul>
  </details>

    <h2 id="introduction">Introduction</h2>
<p>Hello, I’m <a href="https://ryotak.net" target="_blank" rel="noopener">RyotaK</a>
 (<a href="https://twitter.com/ryotkak" target="_blank" rel="noopener">@ryotkak</a>
), a security engineer at GMO Flatt Security Inc.</p>
<p>In May 2025, I participated in the <a href="https://www.youtube.com/watch?v=jiLeF0zO8Mg" target="_blank" rel="noopener">Meta Bug Bounty Researcher Conference 2025.</a>

During this event, I discovered a vulnerability (CVE-2025-59489) in the Unity Runtime that affects games and applications built on Unity 2017.1 and later.</p>
<p>In this article, I will explain the technical aspects of this vulnerability and its impact.</p>
<p>This vulnerability was disclosed to Unity following responsible disclosure practices.</p>
<p>For the official security advisory, please refer to Unity’s advisory here: <a href="https://unity.com/security/sept-2025-01" target="_blank" rel="noopener">https://unity.com/security/sept-2025-01</a>
</p>
<p>We appreciate Unity’s commitment to addressing this issue promptly and their ongoing efforts to enhance the security of their platform.</p>
<h2 id="tldr">TL;DR</h2>
<p>A vulnerability was identified in the Unity Runtime’s intent handling process for Unity games and applications.</p>
<p>In its default configuration, this vulnerability allowed malicious applications installed on the same device to hijack permissions granted to Unity applications.</p>
<p>Unity has addressed this issue and has updated all affected Unity versions starting with 2019.1. Developers are strongly encouraged to <a href="https://unity.com/releases/editor/archive" target="_blank" rel="noopener">download them,</a>
 recompile their games and applications, and republish to ensure their projects remain secure.</p>
<h2 id="about-unity">About Unity</h2>
<p>Unity is a popular game engine used to develop games and applications for various platforms, including Android.</p>
<p>According to Unity’s website, 70% of top mobile games are built with Unity. This includes popular games like Among Us and Pokémon GO, along with many other applications that use Unity for development.</p>
<h2 id="technical-details">Technical Details</h2>
<p><strong>Note:</strong> During the analysis, I used Android 16.0 on the Android Emulator of Android Studio. The behavior and impact of this vulnerability may differ on older Android versions.</p>
<h3 id="unitys-intent-handler">Unity’s Intent Handler</h3>
<p>To support debugging Unity applications on Android devices, Unity automatically adds a handler for the intent containing the <code>unity</code> extra to the UnityPlayerActivity. This activity serves as the default entry point for applications and is exported to other applications.</p>
<p><a href="https://docs.unity3d.com/6000.0/Documentation/Manual/android-custom-activity-command-line.html" target="_blank" rel="noopener">https://docs.unity3d.com/6000.0/Documentation/Manual/android-custom-activity-command-line.html</a>
</p>
<div><pre tabindex="0"><code data-lang="shell"><span><span>adb shell am start -n <span>&#34;com.Company.MyGame/com.unity3d.player.UnityPlayerActivity&#34;</span> -e unity <span>&#34;-systemallocator&#34;</span>
</span></span></code></pre></div><p>As documented above, the <code>unity</code> extra is parsed as command line arguments for Unity.</p>
<p>While Android’s permission model manages feature access by granting permissions to applications, it does not restrict which intents can be sent to an application.</p>
<h3 id="xrsdk-pre-init-library-command-line-argument">xrsdk-pre-init-library Command Line Argument</h3>
<p>After loading the Unity Runtime binary into Ghidra, I discovered the following command line argument:</p>
<div><pre tabindex="0"><code data-lang="c"><span><span>initLibPath <span>=</span> <span>FUN_00272540</span>(uVar5, <span>&#34;xrsdk-pre-init-library&#34;</span>);
</span></span></code></pre></div><p>The value of this command line argument is later passed to <code>dlopen</code>, causing the path specified in <code>xrsdk-pre-init-library</code> to be loaded as a native library.</p>
<div><pre tabindex="0"><code data-lang="c"><span><span>lVar2 <span>=</span> <span>dlopen</span>(initLibPath, <span>2</span>);  
</span></span></code></pre></div><p>This behavior allows attackers to execute arbitrary code within the context of the Unity application, leveraging its permissions by launching them with the -xrsdk-pre-init-library argument.</p>
<h2 id="attack-scenarios">Attack Scenarios</h2>
<h3 id="local-attack">Local Attack</h3>
<p>Any malicious application installed on the same device can exploit this vulnerability by:</p>
<ol>
<li>Extracting the native library with the <code>android:extractNativeLibs</code> attribute set to <code>true</code> in the AndroidManifest.xml</li>
<li>Launching the Unity application with the <code>-xrsdk-pre-init-library</code> argument pointing to the malicious library</li>
<li>The Unity application would then load and execute the malicious code with its own permissions</li>
</ol>
<h3 id="remote-exploitation-via-browser">Remote Exploitation via Browser</h3>
<p>In specific cases, this vulnerability could potentially be exploited remotely although the condition .</p>
<pre tabindex="0"><code>intent:#Intent;package=com.example.unitygame;scheme=custom-scheme;S.unity=-xrsdk-pre-init-library%20/data/local/tmp/malicious.so;end;
</code></pre><p>At first glance, it might appear that malicious websites could exploit this vulnerability by forcing browsers to download <code>.so</code> files and load them via the <code>xrsdk-pre-init-library</code> argument.</p>
<h3 id="selinux-restrictions">SELinux Restrictions</h3>
<p>However, Android’s strict SELinux policy prevents <code>dlopen</code> from opening files in the downloads directory, which mitigates almost all remote exploitation scenarios.</p>
<pre tabindex="0"><code>library &#34;/sdcard/Download/libtest.so&#34; (&#34;/storage/emulated/0/Download/libtest.so&#34;) needed 
or dlopened by &#34;/data/app/~~24UwD8jnw7asNjRwx1MOBg==/com.DefaultCompany.com.unity.template. 
mobile2D-E043IptGJDwcTqq56BocIA==/lib/arm64/libunity.so&#34; is not accessible for the 
namespace: [name=&#34;clns-9&#34;, ld_library_paths=&#34;&#34;,default_library_paths=&#34;/data/app/~~24UwD8jnw7asNjRwx1MOBg==/com.DefaultCompany.com.unity.template. 
mobile2D-E043IptGJDwcTqq56BocIA==/lib/arm64:/data/app/~~24UwD8jnw7asNjRwx1MOBg==/com.DefaultCompany.com.unity.template.mobile2D-E043IptGJDwcTqq56BocIA==/base.apk!/lib/arm64-v8a&#34;, permitted_paths=&#34;/data:/mnt/expand:/data/data/com.DefaultCompany.com.unity.template.mobile2D&#34;]
</code></pre><p>That being said, since the <code>/data/</code> directory is included in <code>permitted_paths</code>, if the target application writes files to its private storage, it can be used to bypass this restriction.</p>
<p>Furthermore, <code>dlopen</code> doesn’t require the <code>.so</code> file extension. If attackers can control the content of a file in an application’s private storage, they can exploit this vulnerability by creating a file containing malicious native library binary. This is actually a common pattern when applications cache data.</p>
<p>For example, another vulnerability in Messenger was exploited using the application’s cache: <a href="https://www.hexacon.fr/slides/Calvanno-Defense_through_Offense_Building_a_1-click_Exploit_Targeting_Messenger_for_Android.pdf" target="_blank" rel="noopener">https://www.hexacon.fr/slides/Calvanno-Defense_through_Offense_Building_a_1-click_Exploit_Targeting_Messenger_for_Android.pdf</a>
</p>
<h3 id="requirements-for-remote-exploitation">Requirements for Remote Exploitation</h3>
<p>To exploit this vulnerability remotely, the following conditions must be met:</p>
<ul>
<li>The application exports <code>UnityPlayerActivity</code> or <code>UnityPlayerGameActivity</code> with the <code>android.intent.category.BROWSABLE</code> category</li>
<li>The application writes files with attacker-controlled content to its private storage (e.g., through caching)</li>
</ul>
<p>Even without these conditions, local exploitation remains possible for any Unity application.</p>
<h2 id="demonstration">Demonstration</h2>

    <p>
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/QEhqb4A_MwQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" title="YouTube video"></iframe>
    </p>

<h2 id="conclusion">Conclusion</h2>
<p>In this article, I explained a vulnerability in Unity Runtime that allows arbitrary code execution in almost all Unity applications on Android.</p>
<p>I hope this article helps you understand that vulnerabilities can exist in the frameworks and libraries you depend on, and you should always be mindful of the security implications of the features you use.</p>
<h2 id="shameless-plug">Shameless plug</h2>
<p>At GMO Flatt Security, we provide top-notch penetration testing for a wide range of targets, from Web apps to IoT devices.</p>
<p><a href="https://flatt.tech/en/professional/penetration_test" target="_blank" rel="noopener">https://flatt.tech/en/professional/penetration_test</a>
</p>
<p>We also developed Takumi, our AI security engineer. It’s an autonomous agent that finds vulnerabilities in source code and has already discovered CVEs in major libraries like Vim and Next.js.
<a href="https://flatt.tech/en/takumi" target="_blank" rel="noopener">https://flatt.tech/en/takumi</a>
</p>
<p>Recently, we’ve expanded Takumi’s capabilities. It’s no longer just a SAST (white-box testing) tool; we’ve added DAST (black-box testing) to enable high-fidelity gray-box scanning for more accurate results.</p>
<p>Based in Japan, we work with clients globally, including industry leaders like Canonical Ltd.</p>
<p><img src="https://flatt.tech/research/arbitrary-code-execution-in-unity-runtime/logos.webp" alt="An image of our client logos"/></p>
<p>If you’d like to learn more, please contact us at <a href="https://flatt.tech/en" target="_blank" rel="noopener">https://flatt.tech/en</a>
</p>

  </article></div>
  </body>
</html>
