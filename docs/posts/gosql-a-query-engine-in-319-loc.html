<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/archiewood/gosql">Original</a>
    <h1>Show HN: GoSQL â€“ A query engine in 319 LoC</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A basic SQL query engine in Go</p>
<ul dir="auto">
<li>It can parse and execute simple SQL queries on CSV files</li>
<li>Supports SELECT, FROM, WHERE, and LIMIT clauses.</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/archiewood/gosql/blob/main/img/terminal.gif"><img src="https://github.com/archiewood/gosql/raw/main/img/terminal.gif" alt="Terminal Demo" data-animated-image=""/></a></p>

<p dir="auto">The program is simple:</p>
<section data-identity="1d07e5a9-a590-4a06-82b9-74a2b0cf4e3f" data-host="https://viewscreen.githubusercontent.com" data-src="https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com" data-type="mermaid" aria-label="mermaid rendered output container">
  <div data-json="{&#34;data&#34;:&#34;graph LR\n    A[Parse Query] --&amp;gt; B[Create AST]\n    B --&amp;gt; C[Execute Query against CSV]\n    C --&amp;gt; D[Output Results]\n&#34;}" data-plain="graph LR
    A[Parse Query] --&gt; B[Create AST]
    B --&gt; C[Execute Query against CSV]
    C --&gt; D[Output Results]
" dir="auto">
    <div dir="auto">
      <pre lang="mermaid" aria-label="Raw mermaid code">graph LR
    A[Parse Query] --&gt; B[Create AST]
    B --&gt; C[Execute Query against CSV]
    C --&gt; D[Output Results]
</pre>
    </div>
  </div>
  <span role="presentation">
    <span data-view-component="true">
  <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true" data-view-component="true">
    <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" fill="none"></circle>
    <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"></path>
</svg>    <span>Loading</span>
</span>
  </span>
</section>

<p dir="auto">An AST is an Abstract Syntax Tree. It is a tree representation of the structure of the SQL query, eg</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
    &#34;type&#34;: &#34;SELECT&#34;,
    &#34;value&#34;: [&#34;first_name&#34;, &#34;last_name&#34;]
},
{
    &#34;type&#34;: &#34;FROM&#34;,
    &#34;value&#34;: &#34;data/addresses&#34;
},
{
    &#34;type&#34;: &#34;WHERE&#34;,
    &#34;left&#34;: &#34;first_name&#34;,
    &#34;operator&#34;: &#34;=&#34;,
    &#34;right&#34;: &#34;John&#34;
}"><pre>{
    <span>&#34;type&#34;</span>: <span><span>&#34;</span>SELECT<span>&#34;</span></span>,
    <span>&#34;value&#34;</span>: [<span><span>&#34;</span>first_name<span>&#34;</span></span>, <span><span>&#34;</span>last_name<span>&#34;</span></span>]
},
{
    <span>&#34;type&#34;</span>: <span><span>&#34;</span>FROM<span>&#34;</span></span>,
    <span>&#34;value&#34;</span>: <span><span>&#34;</span>data/addresses<span>&#34;</span></span>
},
{
    <span>&#34;type&#34;</span>: <span><span>&#34;</span>WHERE<span>&#34;</span></span>,
    <span>&#34;left&#34;</span>: <span><span>&#34;</span>first_name<span>&#34;</span></span>,
    <span>&#34;operator&#34;</span>: <span><span>&#34;</span>=<span>&#34;</span></span>,
    <span>&#34;right&#34;</span>: <span><span>&#34;</span>John<span>&#34;</span></span>
}</pre></div>

<ol dir="auto">
<li>Ensure you have Go installed on your system.</li>
<li>Clone this repository:
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/archiewood/sql.git
cd sql"><pre>git clone https://github.com/archiewood/sql.git
<span>cd</span> sql</pre></div>
</li>
<li>Build the project:

</li>
</ol>

<p dir="auto">Run the program with your SQL query as an argument:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./sql &#34;SELECT column1, column2 FROM table WHERE column3 = &#39;value&#39; LIMIT 10&#34;"><pre>./sql <span><span>&#34;</span>SELECT column1, column2 FROM table WHERE column3 = &#39;value&#39; LIMIT 10<span>&#34;</span></span></pre></div>
<p dir="auto">The program expects CSV files to be relative to the directory from which you run the program, named as <code>&lt;table&gt;.csv</code>. You can use unix paths eg</p>
<div dir="auto" data-snippet-clipboard-copy-content="./sql &#34;SELECT * FROM data/wait_times&#34;"><pre>./sql <span><span>&#34;</span>SELECT * FROM data/wait_times<span>&#34;</span></span></pre></div>

<ul dir="auto">
<li><code>-ast</code>: Print the Abstract Syntax Tree of the query</li>
</ul>
<p dir="auto">Example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./sql -ast &#34;SELECT * FROM users WHERE country = &#39;USA&#39; LIMIT 5&#34;"><pre>./sql -ast <span><span>&#34;</span>SELECT * FROM users WHERE country = &#39;USA&#39; LIMIT 5<span>&#34;</span></span></pre></div>

<ul dir="auto">
<li><code>SELECT</code> not required, * assumed if not specified</li>
<li>Trailing commas after final select clause are allowed</li>
</ul>
</article></div></div>
  </body>
</html>
