<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/pirxthepilot/wtfis">Original</a>
    <h1>Wtfis: Passive hostname, domain and IP lookup tool for non-robots</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://github.com/pirxthepilot/wtfis/actions/workflows/tests.yml"><img src="https://github.com/pirxthepilot/wtfis/actions/workflows/tests.yml/badge.svg" alt="Tests"/></a>
<a href="https://pypi.org/project/wtfis/" rel="nofollow"><img src="https://camo.githubusercontent.com/cb625f35f06a6468c7be3edf32d9e65844257f29e2e7c8988800ad409a7e7629/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f77746669733f636f6c6f723d626c7565266c6f676f3d70797069266c6f676f436f6c6f723d676f6c64" alt="PyPI" data-canonical-src="https://img.shields.io/pypi/v/wtfis?color=blue&amp;logo=pypi&amp;logoColor=gold"/></a></p>
<p dir="auto">Passive hostname, domain and IP lookup tool for non-robots</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/demo.gif?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/demo.gif?raw=true" alt="" data-animated-image=""/></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-ip.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-ip.png?raw=true" alt=""/></a></p>

<p dir="auto"><strong>wtfis</strong> is a commandline tool that gathers information about a domain, FQDN or IP address using various OSINT services. Unlike other tools of its kind, it&#39;s built specifically for human consumption, providing results that are pretty (YMMV) and easy to read and understand.</p>
<p dir="auto">This tool assumes that you are using free tier / community level accounts, and so makes as few API calls as possible to minimize hitting quotas and rate limits.</p>
<p dir="auto">The project name is a play on &#34;whois&#34;.</p>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Service</th>
<th>Used in lookup</th>
<th>Required</th>
<th>Free Tier</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://virustotal.com" rel="nofollow">Virustotal</a></td>
<td>All</td>
<td>Yes</td>
<td><a href="https://www.virustotal.com/gui/join-us" rel="nofollow">Yes</a></td>
</tr>
<tr>
<td><a href="https://www.ip2whois.com" rel="nofollow">IP2Whois</a></td>
<td>Domain/FQDN</td>
<td>No</td>
<td><a href="https://www.ip2location.io/pricing#ip2whois" rel="nofollow">Yes</a></td>
</tr>
<tr>
<td><a href="https://ipwhois.io" rel="nofollow">IPWhois</a></td>
<td>IP address</td>
<td>No</td>
<td>Yes (no signup)</td>
</tr>
<tr>
<td><a href="https://shodan.io" rel="nofollow">Shodan</a></td>
<td>IP address</td>
<td>No</td>
<td><a href="https://account.shodan.io/billing" rel="nofollow">No</a></td>
</tr>
<tr>
<td><a href="https://greynoise.io" rel="nofollow">Greynoise</a></td>
<td>IP address</td>
<td>No</td>
<td><a href="https://www.greynoise.io/plans/community" rel="nofollow">Yes</a></td>
</tr>
<tr>
<td><a href="https://urlhaus.abuse.ch/" rel="nofollow">URLhaus</a></td>
<td>All</td>
<td>No</td>
<td>Yes (no signup)</td>
</tr>
<tr>
<td><a href="https://www.abuseipdb.com/" rel="nofollow">AbuseIPDB</a></td>
<td>IP address</td>
<td>No</td>
<td><a href="https://www.abuseipdb.com/register?plan=free" rel="nofollow">Yes</a></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">The primary source of information. Retrieves:</p>
<ul dir="auto">
<li><a href="https://developers.virustotal.com/reference/domains-1" rel="nofollow">Hostname (FQDN), domain or IP</a>
<ul dir="auto">
<li>Latest analysis stats with vendor detail</li>
<li>Reputation score (based on VT community votes)</li>
<li>Popularity ranks (Alexa, Cisco Umbrella, etc.) (FQDN and domain only)</li>
<li>Categories (assigned by different vendors)</li>
</ul>
</li>
<li><a href="https://developers.virustotal.com/reference/domain-resolutions" rel="nofollow">Resolutions</a> (FQDN and domain only)
<ul dir="auto">
<li>Last n IP addresses (default: 3, max: 10)</li>
<li>Latest analysis stats of each IP above</li>
</ul>
</li>
<li><a href="https://developers.virustotal.com/reference/whois" rel="nofollow">Whois</a>
<ul dir="auto">
<li>Fallback only: if IP2Whois creds are not available</li>
<li>Various whois data about the domain itself</li>
</ul>
</li>
</ul>

<p dir="auto">Optionally used if creds are provided. Retrieves:</p>
<ul dir="auto">
<li><a href="https://www.ip2location.io/ip2whois-documentation" rel="nofollow">Whois</a>
<ul dir="auto">
<li>Various whois data about the domain itself</li>
</ul>
</li>
</ul>
<p dir="auto">IP2Whois is recommended over Virustotal for whois data for a couple of reasons:</p>
<ul dir="auto">
<li>VT whois data format is less consistent</li>
<li>IP2Whois whois data tends to be of better quality than VT. Also, VT&#39;s registrant data is apparently <a href="https://developers.virustotal.com/reference/whois" rel="nofollow">anonymized</a>.</li>
<li>You can save one VT API call by offloading to IP2Whois.</li>
</ul>

<p dir="auto">Default Geolocation and ASN lookup source for IP addresses. Retrieves:</p>
<ul dir="auto">
<li>ASN, Org, ISP and Geolocation</li>
</ul>
<p dir="auto">IPWhois should not be confused with IP2Whois, which provides domain Whois data.</p>

<p dir="auto">GETs data from the <code>/shodan/host/{ip}</code> endpoint (see <a href="https://developer.shodan.io/api" rel="nofollow">doc</a>). For each IP, retrieves:</p>
<ul dir="auto">
<li>List of open ports and services</li>
<li>Operating system (if available)</li>
<li>Tags (assigned by Shodan)</li>
</ul>

<p dir="auto">Using Greynoise&#39;s <a href="https://docs.greynoise.io/docs/using-the-greynoise-community-api" rel="nofollow">community API</a>, wtfis will show whether an IP is in one of Greynoise&#39;s datasets:</p>
<ul dir="auto">
<li><strong>Noise</strong>: IP has been seen regularly scanning the Internet</li>
<li><strong>RIOT</strong>: IP belongs to a common business application (e.g. Microsoft O365, Google Workspace, Slack)</li>
</ul>
<p dir="auto">More information about the datasets <a href="https://docs.greynoise.io/docs/understanding-greynoise-data-sets" rel="nofollow">here</a>.</p>
<p dir="auto">In addition, the API also returns Greynoise&#39;s <a href="https://docs.greynoise.io/docs/understanding-greynoise-classifications" rel="nofollow">classification</a> of an IP (if available). Possible values are <strong>benign</strong>, <strong>malicious</strong>, and <strong>unknown</strong>.</p>

<p dir="auto"><a href="https://urlhaus.abuse.ch/" rel="nofollow">URLhaus</a> is a crowd-sourced database of reported malicious URLs. This enrichment provides insight on whether the queried hostname or IP is being or was used for malware distribution via HTTP or HTTPS. Data that is provided include:</p>
<ul dir="auto">
<li>Count of currently online and total malware URLs</li>
<li>Whether the hostname or IP is currently in the <a href="https://www.dnsbl.info/" rel="nofollow">DNSBL</a> and <a href="https://www.surbl.org/" rel="nofollow">SURBL</a> public blocklists</li>
<li>All tags that have been assigned to the URL throughout its history in the URLhaus database</li>
</ul>

<p dir="auto"><a href="https://www.abuseipdb.com/" rel="nofollow">AbuseIPDB</a> is a crowd-sourced database of reported malicious IP addresses. Through its API wtfis shows:</p>
<ul dir="auto">
<li>Abuse confidence score (0-100)</li>
<li>Number of reports</li>
</ul>


<p dir="auto">To install via <code>conda</code> (from conda-forge), see <a href="https://github.com/conda-forge/wtfis-feedstock">wtfis-feedstock</a>.</p>
<p dir="auto">To install via <a href="https://brew.sh" rel="nofollow"><code>brew</code></a>:</p>


<p dir="auto">wtfis uses these environment variables:</p>
<ul dir="auto">
<li><code>VT_API_KEY</code> (required) - Virustotal API key</li>
<li><code>IP2WHOIS_API_KEY</code> (optional) - IP2WHOIS API key</li>
<li><code>SHODAN_API_KEY</code> (optional) - Shodan API key</li>
<li><code>GREYNOISE_API_KEY</code> (optional) - Greynoise API key</li>
<li><code>ABUSEIPDB_API_KEY</code> (optional) - AbuseIPDB API key</li>
<li><code>WTFIS_DEFAULTS</code> (optional) - Default arguments</li>
</ul>
<p dir="auto">Set these using your own method.</p>
<p dir="auto">Alternatively, create a file in your home directory <code>~/.env.wtfis</code> with the above declarations. See <a href="https://github.com/pirxthepilot/wtfis/blob/main/.env.wtfis.example">.env.wtfis.example</a> for a template. <strong>NOTE: Don&#39;t forget to <code>chmod 400</code> the file!</strong></p>

<div data-snippet-clipboard-copy-content="usage: wtfis [-h] [-m N] [-s] [-g] [-a] [-u] [-n] [-1] [-V] entity

positional arguments:
  entity                Hostname, domain or IP

optional arguments:
  -h, --help            show this help message and exit
  -m N, --max-resolutions N
                        Maximum number of resolutions to show (default: 3)
  -s, --use-shodan      Use Shodan to enrich IPs
  -g, --use-greynoise   Enable Greynoise for IPs
  -a, --use-abuseipdb   Enable AbuseIPDB for IPs
  -u, --use-urlhaus     Enable URLhaus for IPs and domains
  -n, --no-color        Show output without colors
  -1, --one-column      Display results in one column
  -V, --version         Print version number"><pre><code>usage: wtfis [-h] [-m N] [-s] [-g] [-a] [-u] [-n] [-1] [-V] entity

positional arguments:
  entity                Hostname, domain or IP

optional arguments:
  -h, --help            show this help message and exit
  -m N, --max-resolutions N
                        Maximum number of resolutions to show (default: 3)
  -s, --use-shodan      Use Shodan to enrich IPs
  -g, --use-greynoise   Enable Greynoise for IPs
  -a, --use-abuseipdb   Enable AbuseIPDB for IPs
  -u, --use-urlhaus     Enable URLhaus for IPs and domains
  -n, --no-color        Show output without colors
  -1, --one-column      Display results in one column
  -V, --version         Print version number
</code></pre></div>
<p dir="auto">Basically:</p>
<div data-snippet-clipboard-copy-content="$ wtfis FQDN_OR_DOMAIN_OR_IP"><pre><code>$ wtfis FQDN_OR_DOMAIN_OR_IP
</code></pre></div>
<p dir="auto">and you will get results organized by panel, similar to the image above.</p>
<p dir="auto">Defanged input is accepted (e.g. <code>api[.]google[.]com</code>).</p>
<p dir="auto">If the terminal supports it, certain fields and headings are clickable hyperlinks that point to the respective services&#39; websites.</p>

<p dir="auto">Shodan can be used to show an IP&#39;s open ports or services, and OS in some results. Invoke with the <code>-s</code> or <code>--use-shodan</code> flag.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-shodan.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-shodan.png?raw=true" alt=""/></a></p>
<p dir="auto">If supported by the terminal, the <code>Services</code> field is a clickable hyperlink that takes you to the Shodan web interface.</p>

<p dir="auto">To enable Greynoise, invoke with the <code>-g</code> or <code>--use-greynoise</code> flag. Because the API quota is quite low (50 requests per week as of March 2023), this lookup is off by default.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-greynoise.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-greynoise.png?raw=true" alt=""/></a></p>
<p dir="auto">The <code>GreyNoise</code> field name is also a hyperlink (if terminal-supported) that points to the IP entry in the Greynoise web interface, where more context is shown.</p>

<p dir="auto">Use the <code>-u</code> or <code>--use-urlhaus</code> flag to enable URLhaus enrichment for hostnames, domains and IPs.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-urlhaus.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-urlhaus.png?raw=true" alt=""/></a></p>
<p dir="auto">The <code>Malware URLs</code> field name is a hyperlink (if terminal-supported) that takes you to the specific URLhaus database page for your query.</p>

<p dir="auto">Use the <code>-a</code> or <code>--use-abuseipdb</code> flag to enable AbuseIPDB enrichment for hostnames, domains and IPs.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-abuseipdb.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-abuseipdb.png?raw=true" alt=""/></a></p>
<p dir="auto">The <code>AbuseIPDB</code> field name is a hyperlink (if terminal-supported) that takes you to the specific AbuseIPDB database page for your query.</p>

<p dir="auto">For FQDN and domain lookups, you can increase or decrease the maximum number of displayed IP resolutions with <code>-m NUMBER</code> or <code>--max-resolutions=NUMBER</code>. The upper limit is 10. If you don&#39;t need resolutions at all, set the number to <code>0</code>.</p>
<p dir="auto">To show all panels in one column, use the <code>-1</code> or <code>--one-column</code> flag.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-one-column.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-one-column.png?raw=true" alt=""/></a></p>
<p dir="auto">Panels can be displayed with no color with <code>-n</code> or <code>--no-color</code>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pirxthepilot/wtfis/blob/main/imgs/example-no-color.png?raw=true"><img src="https://github.com/pirxthepilot/wtfis/raw/main/imgs/example-no-color.png?raw=true" alt=""/></a></p>

<p dir="auto">Default arguments can be defined by setting the <code>WTFIS_DEFAULTS</code> environment variable. For example, to use shodan and display results in one column by default:</p>

<p dir="auto">If an argument is in <code>WTFIS_DEFAULTS</code>, then specifying the same argument during command invocation <strong>negates</strong> that argument. So in the example above, if you then run:</p>

<p dir="auto">then Shodan will NOT be used.</p>
<p dir="auto">Note that maximum resolutions (<code>-m N, --max-resolutions N</code>) cannot be defined in defaults at the moment.</p>

<p dir="auto">wtfis can be run from a Docker image. First, build the image (using the included <a href="https://github.com/pirxthepilot/wtfis/blob/main/Dockerfile">Dockerfile</a>) by running:</p>

<p dir="auto">The image will have the latest <em>tagged</em> version (not necessarily from the latest commit) wtfis. This ensures that you are getting a stable release.</p>
<p dir="auto">Two ways you can run the image:</p>
<p dir="auto">Ensure <code>.env.wtfis</code> is in your home directory and set with the necessary envvars. Then simply run:</p>

<p dir="auto">This is an alias to</p>
<div data-snippet-clipboard-copy-content="$ docker run --env-file=${HOME}/.env.wtfis -it wtfis"><pre><code>$ docker run --env-file=${HOME}/.env.wtfis -it wtfis
</code></pre></div>
<p dir="auto">Note that each definition must NOT have any spaces before and after the equal sign (<code>FOO=bar</code>, not <code>FOO = bar</code>).</p>
<p dir="auto">Altenatively, you can set the environment variables yourself, then run, e.g.:</p>
<div data-snippet-clipboard-copy-content="$ docker run -e VT_API_KEY -e SHODAN_API_KEY -it wtfis"><pre><code>$ docker run -e VT_API_KEY -e SHODAN_API_KEY -it wtfis
</code></pre></div>
</article></div></div>
  </body>
</html>
