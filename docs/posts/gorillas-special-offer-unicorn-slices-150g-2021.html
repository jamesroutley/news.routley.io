<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://zerforschung.org/posts/gorillas-en/">Original</a>
    <h1>Gorillas: Special offer ‚Äì unicorn slices, 150g (2021)</h1>
    
    <div id="readability-page-1" class="page"><div>
<figure><a href="https://zerforschung.org/p/gorillas/gorillas-daten.jpg"><img src="https://zerforschung.org/p/gorillas/gorillas-daten.jpg" alt="Gorillas Advertising with the slogan &#39;Just going check gorillas one more time, then I will put the phone away... oh nice, cinnamon buns&#39; but &#39;cinnamon buns&#39; is replaced with &#39;data&#39;"/></a><figcaption>
<p>We felt more like ‚ÄúOh fuck, Databreach‚Äù</p>
</figcaption>
</figure>

<p>During the pandemic, grocery delivery services gained popularity.
New players on the market offer delivery in under an hour.
One of them is Gorillas, which not only delivers apples and granola bars in 10 minutes, but just as quickly delivered the data of all its customers.</p>
<p>How could this happen? Unfortunately, it was once again much too simple. But let‚Äôs start at the beginning:</p>
<p>Gorillas currently is the largest of these services in Germany.
On large billbords they promise delivery times of under 10 minutes.
Orders are picked in decentralized depots and delivered by riders on bicycles.</p>
<p>A few weeks ago, we already stumbled across <a href="https://zerforschung.org/posts/flink/">a security vulnerability in the software of their competitor ‚Äòflink‚Äô</a>.
Gorillas has experienced extreme growth in recent weeks and also <a href="https://techcrunch.com/2021/03/25/gorillacorn/">raised another absurd 290 million US dollars in venture capital</a><sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> - a good reason for us to give their service a try.</p>
<p>
Gorillas is active in over 15 cities in 4 countries (DE, NL, UK, FR) and plans to expand to over 50 cities soon, including the USA.
We found out about this through job ads, which are always an <a href="https://radforschung.org/log/roller-in-die-staedte/">interesting research approach</a>.
</p>
<p>For us it‚Äôs almost a routine step: with every new app we install we take a quick look at its data traffic with a mitmproxy<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>.
At first glance, we notice that Gorillas loads data from two different Google Cloud Storage buckets: <code>eddress</code> and <code>gorillas-public</code>.
Buckets is simply a fancy name for folders in cloud storage services - here these are used to store and deliver product images and advertising banners to the app.</p>
<p>You don‚Äôt always want a list of all the files that are in a cloud bucket to be publicly available, for example when business data is involved.
That‚Äôs why most cloud services disable the public listing of files by default.
That way you can access the files - but only if you know the exact link.</p>
<p>Well, in this case, we were able to see a list of all the files, and thus access the individual files themselves.
We had access to many, many photos of all the products Gorillas offers.
Knowing the links to all product images would not necessarily be a problem, but unfortunately, it didn‚Äôt stop there:</p>
<figure><a href="https://zerforschung.org/p/gorillas/bucket.png"><img src="https://zerforschung.org/p/gorillas/bucket.png" alt="Screenshot of the XML response listing all the files contained in the bucket."/></a>
</figure>
<p>In the <code>gorillas</code> cloud bucket, we also found photos of things we didn‚Äôt expect to see there: front doors and doorbell signs.
Are these product images, too?
Has the delivery service discovered another market niche and entered the hardware store business?
Probably not: these files were definitely not intended for the public.
Strictly speaking, not even for Gorillas.</p>
<p>The photographed front doors and doorbell plates come from drivers who seem to sometimes need to take such photos when delivering an order.
Not only is this part missing in the privacy policy<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup>, but it‚Äôs also just creepy<sup id="fnref:4"><a href="#fn:4" role="doc-noteref">4</a></sup>.</p>
<p>As we now find voice memos, invoices and database backups in the bucket <code>eddress</code>, it becomes clear that this cannot be intentional.</p>
<figure><a href="https://zerforschung.org/p/gorillas/lindenstrasse.png"><img src="https://zerforschung.org/p/gorillas/lindenstrasse.png" alt="Doorbell place at the TV-Set of  Lindenstra√üe"/></a><figcaption>
<p>Symbolbild (image: <a href="https://commons.wikimedia.org/wiki/File:Klingelschild_Lindenstra%C3%9Fe.jpg">Jedesto</a>, <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>, via Wikimedia Commons)</p>
</figcaption>
</figure>
<h3 id="what-the-hell-is-eddress">What the hell is eddress?</h3>
<p>The name ‚Äúeddress‚Äù appears in many places.
Not only in the bucket name, but also in the app identifier, so it seems relevant.</p>
<figure><a href="https://zerforschung.org/p/gorillas/app-identifier.png"><img src="https://zerforschung.org/p/gorillas/app-identifier.png" alt="Screenshot of the URL bar of the link to the Gorillas app which contains com.eddress.getgoodys as the app identifier"/></a>
</figure>
<p>After a brief investigation, it turns out:
<a href="https://www.eddress.co">Eddress</a> is a company based in Pakistan and Lebanon that offers white-label courier software - software that is purposefully kept neutral, which individual delivery services can then design to fit their own business.
Eddress itself also operates a delivery service, much like Gorillas, called <a href="https://noknok.co">noknok</a> in Lebanon.</p>
<figure><a href="https://zerforschung.org/p/gorillas/gorillas-noknok.png"><img src="https://zerforschung.org/p/gorillas/gorillas-noknok.png" alt="Screenshots of the apps from gorillas and noknok side by side, differing almost exclusively in colour."/></a><figcaption>
<p>There are 20 differences between these images, can you spot them all?</p>
</figcaption>
</figure>
<p>The apps from noknok and Gorillas look almost identical.
This suggests that Gorillas bought their software entirely from eddress.
Also, it turns out that the CEO of eddress has now become the CTO of Gorillas.
So the two companies are indeed closely intertwined.</p>
<figure><a href="https://zerforschung.org/p/gorillas/gorillas-eddress.png"><img src="https://zerforschung.org/p/gorillas/gorillas-eddress.png" alt="The logos of eddress and Gorillas, with the handshake emoji in between."/></a>
</figure>
<h2 id="add-another-200g-of-api-keys">Add another 200g of API keys?</h2>
<p>After knowing that the Gorillas system was built by eddress, we wanted to learn more about this collaboration.
Our search engine of choice didn‚Äôt find any articles on the subject, but it did take us to an admin portal for Gorillas/eddress: <a href="https://portal.gorillas.io">portal.gorillas.io</a>.</p>
<p>Here we are greeted by a login screen to which we have no credentials.
But a quick look into the browser tools shows:
The JavaScript for the portal is loaded before the login.
That allows us a look into the source code.</p>
<div>
<p><strong>Why is that?</strong></p>
<p>The admin portal of Gorillas is a so-called <a href="https://en.wikipedia.org/wiki/Single-page_application">single-page Application</a>.
This means that the page consists of only one HTML file and all content is loaded dynamically.
The entire JavaScript code of the application is also delivered right from the start.</p>
<p>This is not a security problem per se, but it sometimes allows exciting insights into the infrastructure and features of a web app that was previously inaccessible due to a lack of login or permissions.</p>
</div>
<p>Looking at the code, these lines caught our eye:</p>
<figure><a href="https://zerforschung.org/p/gorillas/sourcecode.png"><img src="https://zerforschung.org/p/gorillas/sourcecode.png" alt="Screenshot of a piece of JavaScript code. In it, there&#39;s a line hightlighted with a URL that says &#39;graphql&#39;."/></a>
</figure>
<p>Having had previous experience with GraphQL interfaces in the delivery service <a href="https://zerforschung.org/posts/flink/">Flink</a>, we immediately entered the URL into a GraphQL client of our choice.</p>
<p>GraphQL is a language for data queries.
That means you can describe what information you would like to have from the server and in what format.
For example, at Flink, we could tell the server, ‚ÄúGive us the last 10 orders, who placed them, and what was ordered.‚Äù
The server on the other side should be configured not to handle all requests equally, but to only give out certain information to authorized users.
With Flink, this was configured incorrectly - and with Gorillas?</p>
<p>To find out, we used a really cool function of GraphQL: <a href="https://graphql.org/learn/introspection/">Introspection</a>.
Introspection provides a method to find out what information can be retrieved and how.
Most GraphQL clients automatically create documentation of the API from this:</p>
<figure><a href="https://zerforschung.org/p/gorillas/graphql-doku.png"><img src="https://zerforschung.org/p/gorillas/graphql-doku.png" alt="Screenshot of an automatically generated doc for the &#39;activeOrders&#39;, &#39;ordersData&#39; and &#39;tenantConfig&#39; endpoints."/></a>
</figure>
<p>The two queries for orders need credentials, that‚Äôs why we only get the following error message:</p>
<figure><a href="https://zerforschung.org/p/gorillas/access-denied.png"><img src="https://zerforschung.org/p/gorillas/access-denied.png" alt="Screenshot of a GraphQL error message that we are not authorized to call `activeOrders`."/></a>
</figure>
<p>The <code>tenantConfig</code> however can be accessed without any restrictions.
And the information delivered there is quite interesting: API keys and URLs for various services that are apparently used by the Gorillas/eddress infrastructure.
Among them we found API keys for Sendgrid and Slack webhook URLs.</p>
<figure><a href="https://zerforschung.org/p/gorillas/tenant-config.png"><img src="https://zerforschung.org/p/gorillas/tenant-config.png" alt="GraphQL API Response, the data shows objects like &#39;emailConfig&#39; with apiKey, sender email address and &#39;slackConfig&#39;"/></a>
</figure>
<p>With the Slack URLs, we could post messages to specific Gorillas Slack channels: ‚Äú<em>No work today!</em>‚Äù</p>
<p>Much more relevant, however, are the Sendgrid API keys.
<a href="https://sendgrid.com">Sendgrid</a> is a so-called transactional email provider.
In recent years it has become increasingly difficult to send emails with your own infrastructure in a way where they end up in the receivers inbox and don‚Äôt immediately get caught by spam filters.
So instead of taking care of sending e-mails themselves, more and more providers turn to services like Sendgrid, <a href="https://www.mailjet.com/">Mailjet</a> or <a href="https://aws.amazon.com/ses/">Amazon SES</a>, which send out the e-mails for them.</p>
<p>So with the Sendgrid API key, we could send emails on behalf of Gorillas: ‚Äú<em>Hey investors, we‚Äôve run out of money again</em>‚Äù</p>
<p>This problem doesn‚Äôt only affect Gorillas, but also other services that use eddress&#39; software. Among them are:</p>
<ul>
<li><a href="https://www.oyanow.ng">oyanow</a>, Nigeria</li>
<li><a href="https://noknok.co">noknok</a>, Lebanon</li>
<li>LibanPost (the national post office of Lebanon).</li>
</ul>
<p>This would allow attackers to send authentic-looking emails on behalf of Gorillas or other eddress clients.</p>
<p>Sendgrid allows a very detailed configuration of which API key is allowed to do what.
However, the API keys in question have an extremely large number of permissions:
The API key of Gorillas for 100 of these so-called ‚Äúscopes‚Äù, the one of Liban Post for more than 200.
In addition to sending e-mails, this also includes the authorization to create new API keys.
An attacker could thus create a new API key relatively unnoticed - and continue to use it even if the leaked API key is revoked.</p>
<h2 id="would-you-like-to-have-some-more-data">Would you like to have some more data?</h2>
<p>We had just finished writing the report for the problems described so far when an idea came to us:
To access the queries for orders you need an access token.
When you log into the app you get a token of this type.
So, expecting that it would allow us to query our own data, we took our access identifier from the app and entered it into our GraphQL client.
And sure enough, we got data.
Not just ours, but all of it.</p>
<p>In total, we were able to retrieve data on over 1,000,000 orders, the associated 200,000 customers, and workers.</p>
<p>This includes:</p>
<ul>
<li>Names, addresses, email addresses and phone numbers of customers</li>
<li>Order details (products ordered, quantity, price, etc.)</li>
<li>In the case of credit card payment: the expiration date of the credit card</li>
<li>References to photos of the front door/bell plate, if available</li>
<li>Name and phone number of ‚ÄúactiveWorker‚Äù, presumably drivers or pickers.</li>
</ul>
<figure><a href="https://zerforschung.org/p/gorillas/orders-data.png"><img src="https://zerforschung.org/p/gorillas/orders-data.png" alt="Screenshot of the JSON return of the API. Contains the COMPLETE information of an order, including products, amount, payment type, address, contact details, geo-coordinates, order status."/></a>
</figure>
<p>So it‚Äôs not just the customers who are affected, but also the workers - another problem in how startup delivery services treat them.
<a href="https://www.neues-deutschland.de/artikel/1148393.lieferdienst-gorillas-streiken-wild.html">The working conditions of pickers and riders have already been criticized several times.</a></p>
<h2 id="spear-phishing-with-a-trawl">Spear phishing with a trawl</h2>
<p>All this data, together with SendGrid access, forms the basis for an extremely evil attack scenario.
To safeguard against phishing e-mails, people are taught to not only check the accuracy of the sender, but also whether for instance one is addressed with the correct name.</p>
<p>But we have both now: We know the data of all customers, including their orders, and can write e-mails in the name of Gorillas.</p>
<p>Now let‚Äôs imagine an e-mail to all Gorillas customers that ordered in the last few days with the following content:</p>
<blockquote>
<p>Hello Alex Example, ü¶ç‚ù§Ô∏è</p>
<p>Yesterday you ordered with us for 23.42‚Ç¨ to the address ‚ÄúExamplestreet 123, 00000 Examplecity‚Äù.
For this, you used your credit card with an expiration date of 13/37.
Unfortunately, the payment was declined by our payment service provider.
Therefore we have to ask you to settle your invoice.</p>
<p>You can make the payment comfortably under the following link:
i-steal-your-credit-card-data.com/payment/{order-number}</p>
<p>The products you ordered were: [‚Ä¶]</p>
</blockquote>
<p>Since the domains <code>gorlllas.io</code> and <code>goriilas.io</code> are not registered, even familiar-looking domains could be used.
Anyway, people are already used to being redirected to a wide variety of payment providers.</p>
<p>One thing is for certain: We would fall for it.</p>
<h2 id="gorillas-reaction">Gorilla‚Äôs reaction</h2>
<p>While finding the vulnerabilities, we also documented them and reported them collectively to <a href="https://www.cert-bund.de/">CERT-Bund</a>, the german federal Computer Emergency Response Team.
CERT-Bund then reviewed them and forwarded our reports to Gorillas.
Gorillas has, according to its own statement, closed the vulnerabilities described, revoked leaked API keys and also informed the relevant authorities as well as its customers and workers.
We very much welcome that Gorillas informed its customers and workers on its own initiative, even though there is not necessarily a legal obligation.</p>
<p>We also received the e-mail Gorillas sent to its customers.
Unfortunately, we have to criticize that they do not name exactly which data was retrievable.
Who remembers what data they might have entered, months after ordering normal everyday goods?
And there is not a word about the photos of front doors and doorbell signs either.
We think this is even worse because the customers of Gorillas don‚Äôt even know that these pictures exist.</p>
<h2 id="when-will-the-industry-finally-learn">When will the industry finally learn‚ÄΩ</h2>
<p>This is the second time that a supermarket delivery service leaked all customer data because of an unprotected GraphQL interface.
We hoped that the issue at Flink served as a warning for all providers and that they would take another close look into their own systems to see if they have similar problems.
The fact that even with investments of triple-digit millions, IT security does not seem to be seen as important<sup id="fnref:5"><a href="#fn:5" role="doc-noteref">5</a></sup> surprises us once again.
We expected that investors would take a little more care when selecting their investment targets for such enormous sums.
After all, the competitors are certainly not supposed to know which products are doing particularly well in which parts of the city.</p>
<p>Here IT security has the same problem as other preventative measures:
The better it is, the less one sees its benefit.
Only when it‚Äôs too late and we already found our way into the databases, the companies realise what they did wrong.
As long as the system is sufficiently secured, no one notices - because everything is running properly, smoothly and quietly.</p>
<p>At the same time, IT security is harder to advertise than new features<sup id="fnref:6"><a href="#fn:6" role="doc-noteref">6</a></sup> and financial incentives are somewhat lacking.
The GDPR allows for severe penalties for such data breaches.
Now it‚Äôs on the data protection authorities to issue them so that companies will have one more reason to pay attention to their IT security in the future.</p>
<p>
Our delivery times are longer than 10 minutes: As a collective, we need well over a week to create such an article, from finding the issues to writing the reports, to publishing this post.
If you like it, <a href="https://zerforschung.org/unterstuetzen">feel free to support us</a>.
</p>

</div></div>
  </body>
</html>
