<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/cisco-ai-defense/mcp-scanner">Original</a>
    <h1>MCP-Scanner – Scan MCP Servers for vulnerabilities</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A Python tool for scanning MCP (Model Context Protocol) servers and tools for potential security findings. The MCP Scanner combines Cisco AI Defense inspect API, YARA rules and LLM-as-a-judge to detect malicious MCP tools.</p>

<p dir="auto">The MCP Scanner provides a comprehensive solution for scanning MCP servers and tools for security findings. It leverages three powerful scanning engines (Yara, LLM-as-judge, Cisco AI Defense) that can be used together or independently.</p>
<p dir="auto">The SDK is designed to be easy to use while providing powerful scanning capabilities, flexible authentication options, and customization.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/cisco-ai-defense/mcp-scanner/raw/main/images/mcp_scanner.gif?raw=true"><img src="https://github.com/cisco-ai-defense/mcp-scanner/raw/main/images/mcp_scanner.gif?raw=true" alt="MCP Scanner" data-animated-image=""/></a></p>

<ul dir="auto">
<li><strong>Multiple Modes:</strong> Run scanner as a stand-alone CLI tool or REST API server</li>
<li><strong>Multi-Engine Security Analysis</strong>: Use all three scanning engines together or independently based on your needs.</li>
<li><strong>Comprehensive Scanning</strong>: Scan MCP tools, prompts, and resources for security findings</li>
<li><strong>Explicit Authentication Control</strong>: Fine-grained control over authentication with explicit Auth parameters.</li>
<li><strong>OAuth Support</strong>: Full OAuth authentication support for both SSE and streamable HTTP connections.</li>
<li><strong>Custom Endpoints</strong>: Configure the API endpoint to support any Cisco AI Defense environments.</li>
<li><strong>MCP Server Integration</strong>: Connect directly to MCP servers to scan tools, prompts, and resources with flexible authentication.</li>
<li><strong>Customizable YARA Rules</strong>: Add your own YARA rules to detect specific patterns.</li>
<li><strong>Comprehensive Reporting</strong>: Detailed reports on detected security findings.</li>
</ul>


<ul dir="auto">
<li>Python 3.11+</li>
<li>uv (Python package manager)</li>
<li>A valid Cisco AI Defense API Key (optional)</li>
<li>LLM Provider API Key (optional)</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="uv venv -p &lt;Python version less than or equal to 3.13&gt; /path/to/your/choice/of/venv/directory
source /path/to/your/choice/of/venv/directory/bin/activate
uv pip install cisco-ai-mcp-scanner"><pre>uv venv -p <span>&lt;</span>Python version less than or equal to 3.<span>13&gt;</span> /path/to/your/choice/of/venv/directory
<span>source</span> /path/to/your/choice/of/venv/directory/bin/activate
uv pip install cisco-ai-mcp-scanner</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/cisco-ai-defense/mcp-scanner
cd mcp-scanner
# Install with uv (recommended)

uv venv -p &lt;Python version less than or equal to 3.13&gt; /path/to/your/choice/of/venv/directory

source /path/to/your/choice/of/venv/directory/bin/activate

uv pip install .
# Or install in development mode
uv pip install -e ."><pre>git clone https://github.com/cisco-ai-defense/mcp-scanner
<span>cd</span> mcp-scanner
<span><span>#</span> Install with uv (recommended)</span>

uv venv -p <span>&lt;</span>Python version less than or equal to 3.<span>13&gt;</span> /path/to/your/choice/of/venv/directory

<span>source</span> /path/to/your/choice/of/venv/directory/bin/activate

uv pip install <span>.</span>
<span><span>#</span> Or install in development mode</span>
uv pip install -e <span>.</span></pre></div>



<div dir="auto" data-snippet-clipboard-copy-content="Cisco AI Defense API (only required for API analyzer)
export MCP_SCANNER_API_KEY=&#34;your_cisco_api_key&#34;
export MCP_SCANNER_ENDPOINT=&#34;https://us.api.inspect.aidefense.security.cisco.com/api/v1&#34;
# For other endpoints please visit https://developer.cisco.com/docs/ai-defense/getting-started/#base-url"><pre>Cisco AI Defense API (only required <span>for</span> API analyzer)
<span>export</span> MCP_SCANNER_API_KEY=<span><span>&#34;</span>your_cisco_api_key<span>&#34;</span></span>
<span>export</span> MCP_SCANNER_ENDPOINT=<span><span>&#34;</span>https://us.api.inspect.aidefense.security.cisco.com/api/v1<span>&#34;</span></span>
<span><span>#</span> For other endpoints please visit https://developer.cisco.com/docs/ai-defense/getting-started/#base-url</span></pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">LLM Configuration (for LLM analyzer)</h4><a id="user-content-llm-configuration-for-llm-analyzer" aria-label="Permalink: LLM Configuration (for LLM analyzer)" href="#llm-configuration-for-llm-analyzer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Tested LLMs:</strong> OpenAI GPT-4o and GPT-4.1</p>
<div dir="auto" data-snippet-clipboard-copy-content="# AWS Bedrock Claude with AWS credentials (profile)
export AWS_PROFILE=&#34;your-profile&#34;
export AWS_REGION=&#34;us-east-1&#34;
export MCP_SCANNER_LLM_MODEL=&#34;bedrock/anthropic.claude-sonnet-4-5-20250929-v2:0&#34; # Any AWS Bedrock supported model

# AWS Bedrock Claude with API key (Bearer token)
export MCP_SCANNER_LLM_API_KEY=&#34;bedrock-api-key-...&#34; # Generated via Amazon Bedrock -&gt; API Keys
export AWS_REGION=&#34;us-east-1&#34;
export MCP_SCANNER_LLM_MODEL=&#34;bedrock/us.anthropic.claude-sonnet-4-5-20250929-v2:0&#34; # Any AWS Bedrock supported model

# LLM Provider API Key (required for LLM analyzer)
export MCP_SCANNER_LLM_API_KEY=&#34;your_llm_api_key&#34;  # OpenAI

# LLM Model Configuration (optional - defaults provided)
export MCP_SCANNER_LLM_MODEL=&#34;gpt-4o&#34;  # Any LiteLLM-supported model
export MCP_SCANNER_LLM_BASE_URL=&#34;https://api.openai.com/v1&#34;  # Custom LLM endpoint
export MCP_SCANNER_LLM_API_VERSION=&#34;2024-02-01&#34;  # API version (if required)

# For Azure OpenAI (example)
export MCP_SCANNER_LLM_BASE_URL=&#34;https://your-resource.openai.azure.com/&#34;
export MCP_SCANNER_LLM_API_VERSION=&#34;2024-02-01&#34;
export MCP_SCANNER_LLM_MODEL=&#34;azure/gpt-4&#34;

# For Extended Thinking Models (longer timeout)
export MCP_SCANNER_LLM_TIMEOUT=300"><pre><span><span>#</span> AWS Bedrock Claude with AWS credentials (profile)</span>
<span>export</span> AWS_PROFILE=<span><span>&#34;</span>your-profile<span>&#34;</span></span>
<span>export</span> AWS_REGION=<span><span>&#34;</span>us-east-1<span>&#34;</span></span>
<span>export</span> MCP_SCANNER_LLM_MODEL=<span><span>&#34;</span>bedrock/anthropic.claude-sonnet-4-5-20250929-v2:0<span>&#34;</span></span> <span><span>#</span> Any AWS Bedrock supported model</span>

<span><span>#</span> AWS Bedrock Claude with API key (Bearer token)</span>
<span>export</span> MCP_SCANNER_LLM_API_KEY=<span><span>&#34;</span>bedrock-api-key-...<span>&#34;</span></span> <span><span>#</span> Generated via Amazon Bedrock -&gt; API Keys</span>
<span>export</span> AWS_REGION=<span><span>&#34;</span>us-east-1<span>&#34;</span></span>
<span>export</span> MCP_SCANNER_LLM_MODEL=<span><span>&#34;</span>bedrock/us.anthropic.claude-sonnet-4-5-20250929-v2:0<span>&#34;</span></span> <span><span>#</span> Any AWS Bedrock supported model</span>

<span><span>#</span> LLM Provider API Key (required for LLM analyzer)</span>
<span>export</span> MCP_SCANNER_LLM_API_KEY=<span><span>&#34;</span>your_llm_api_key<span>&#34;</span></span>  <span><span>#</span> OpenAI</span>

<span><span>#</span> LLM Model Configuration (optional - defaults provided)</span>
<span>export</span> MCP_SCANNER_LLM_MODEL=<span><span>&#34;</span>gpt-4o<span>&#34;</span></span>  <span><span>#</span> Any LiteLLM-supported model</span>
<span>export</span> MCP_SCANNER_LLM_BASE_URL=<span><span>&#34;</span>https://api.openai.com/v1<span>&#34;</span></span>  <span><span>#</span> Custom LLM endpoint</span>
<span>export</span> MCP_SCANNER_LLM_API_VERSION=<span><span>&#34;</span>2024-02-01<span>&#34;</span></span>  <span><span>#</span> API version (if required)</span>

<span><span>#</span> For Azure OpenAI (example)</span>
<span>export</span> MCP_SCANNER_LLM_BASE_URL=<span><span>&#34;</span>https://your-resource.openai.azure.com/<span>&#34;</span></span>
<span>export</span> MCP_SCANNER_LLM_API_VERSION=<span><span>&#34;</span>2024-02-01<span>&#34;</span></span>
<span>export</span> MCP_SCANNER_LLM_MODEL=<span><span>&#34;</span>azure/gpt-4<span>&#34;</span></span>

<span><span>#</span> For Extended Thinking Models (longer timeout)</span>
<span>export</span> MCP_SCANNER_LLM_TIMEOUT=300</pre></div>

<p dir="auto">The fastest way to get started is using the <code>mcp-scanner</code> CLI command. Global flags (like <code>--analyzers</code>, <code>--format</code>, etc.) must be placed before a subcommand.</p>

<div dir="auto" data-snippet-clipboard-copy-content="# Scan well-known client configs on this machine
mcp-scanner --scan-known-configs --analyzers yara --format summary

# Stdio server (example using uvx mcp-server-fetch)
mcp-scanner --stdio-command uvx --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch --analyzers yara --format summary

# Remote server (deepwiki example)
mcp-scanner --server-url https://mcp.deepwki.com/mcp --analyzers yara --format summary

# MCP Scanner as REST API
mcp-scanner-api --host 0.0.0.0 --port 8080
"><pre><span><span>#</span> Scan well-known client configs on this machine</span>
mcp-scanner --scan-known-configs --analyzers yara --format summary

<span><span>#</span> Stdio server (example using uvx mcp-server-fetch)</span>
mcp-scanner --stdio-command uvx --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch --analyzers yara --format summary

<span><span>#</span> Remote server (deepwiki example)</span>
mcp-scanner --server-url https://mcp.deepwki.com/mcp --analyzers yara --format summary

<span><span>#</span> MCP Scanner as REST API</span>
mcp-scanner-api --host 0.0.0.0 --port 8080
</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="import asyncio
from mcpscanner import Config, Scanner
from mcpscanner.core.models import AnalyzerEnum

async def main():
    # Create configuration with your API keys
    config = Config(
        api_key=&#34;your_cisco_api_key&#34;,
        llm_provider_api_key=&#34;your_llm_api_key&#34;
    )

    # Create scanner
    scanner = Scanner(config)

    # Scan all tools on a remote server
    tool_results = await scanner.scan_remote_server_tools(
        &#34;https://mcp.deepwki.com/mcp&#34;,
        analyzers=[AnalyzerEnum.API, AnalyzerEnum.YARA, AnalyzerEnum.LLM]
    )

    # Print tool results
    for result in tool_results:
        print(f&#34;Tool: {result.tool_name}, Safe: {result.is_safe}&#34;)

    # Scan all prompts on a server
    prompt_results = await scanner.scan_remote_server_prompts(
        &#34;http://127.0.0.1:8000/mcp&#34;,
        analyzers=[AnalyzerEnum.LLM]
    )

    # Print prompt results
    for result in prompt_results:
        print(f&#34;Prompt: {result.prompt_name}, Safe: {result.is_safe}&#34;)

    # Scan all resources on a server
    resource_results = await scanner.scan_remote_server_resources(
        &#34;http://127.0.0.1:8000/mcp&#34;,
        analyzers=[AnalyzerEnum.LLM],
        allowed_mime_types=[&#34;text/plain&#34;, &#34;text/html&#34;]
    )

    # Print resource results
    for result in resource_results:
        print(f&#34;Resource: {result.resource_name}, Safe: {result.is_safe}, Status: {result.status}&#34;)

# Run the scanner
asyncio.run(main())"><pre><span>import</span> <span>asyncio</span>
<span>from</span> <span>mcpscanner</span> <span>import</span> <span>Config</span>, <span>Scanner</span>
<span>from</span> <span>mcpscanner</span>.<span>core</span>.<span>models</span> <span>import</span> <span>AnalyzerEnum</span>

<span>async</span> <span>def</span> <span>main</span>():
    <span># Create configuration with your API keys</span>
    <span>config</span> <span>=</span> <span>Config</span>(
        <span>api_key</span><span>=</span><span>&#34;your_cisco_api_key&#34;</span>,
        <span>llm_provider_api_key</span><span>=</span><span>&#34;your_llm_api_key&#34;</span>
    )

    <span># Create scanner</span>
    <span>scanner</span> <span>=</span> <span>Scanner</span>(<span>config</span>)

    <span># Scan all tools on a remote server</span>
    <span>tool_results</span> <span>=</span> <span>await</span> <span>scanner</span>.<span>scan_remote_server_tools</span>(
        <span>&#34;https://mcp.deepwki.com/mcp&#34;</span>,
        <span>analyzers</span><span>=</span>[<span>AnalyzerEnum</span>.<span>API</span>, <span>AnalyzerEnum</span>.<span>YARA</span>, <span>AnalyzerEnum</span>.<span>LLM</span>]
    )

    <span># Print tool results</span>
    <span>for</span> <span>result</span> <span>in</span> <span>tool_results</span>:
        <span>print</span>(<span>f&#34;Tool: <span><span>{</span><span>result</span>.<span>tool_name</span><span>}</span></span>, Safe: <span><span>{</span><span>result</span>.<span>is_safe</span><span>}</span></span>&#34;</span>)

    <span># Scan all prompts on a server</span>
    <span>prompt_results</span> <span>=</span> <span>await</span> <span>scanner</span>.<span>scan_remote_server_prompts</span>(
        <span>&#34;http://127.0.0.1:8000/mcp&#34;</span>,
        <span>analyzers</span><span>=</span>[<span>AnalyzerEnum</span>.<span>LLM</span>]
    )

    <span># Print prompt results</span>
    <span>for</span> <span>result</span> <span>in</span> <span>prompt_results</span>:
        <span>print</span>(<span>f&#34;Prompt: <span><span>{</span><span>result</span>.<span>prompt_name</span><span>}</span></span>, Safe: <span><span>{</span><span>result</span>.<span>is_safe</span><span>}</span></span>&#34;</span>)

    <span># Scan all resources on a server</span>
    <span>resource_results</span> <span>=</span> <span>await</span> <span>scanner</span>.<span>scan_remote_server_resources</span>(
        <span>&#34;http://127.0.0.1:8000/mcp&#34;</span>,
        <span>analyzers</span><span>=</span>[<span>AnalyzerEnum</span>.<span>LLM</span>],
        <span>allowed_mime_types</span><span>=</span>[<span>&#34;text/plain&#34;</span>, <span>&#34;text/html&#34;</span>]
    )

    <span># Print resource results</span>
    <span>for</span> <span>result</span> <span>in</span> <span>resource_results</span>:
        <span>print</span>(<span>f&#34;Resource: <span><span>{</span><span>result</span>.<span>resource_name</span><span>}</span></span>, Safe: <span><span>{</span><span>result</span>.<span>is_safe</span><span>}</span></span>, Status: <span><span>{</span><span>result</span>.<span>status</span><span>}</span></span>&#34;</span>)

<span># Run the scanner</span>
<span>asyncio</span>.<span>run</span>(<span>main</span>())</pre></div>

<ul dir="auto">
<li><strong>remote</strong>: scan a remote MCP server (SSE or streamable HTTP). Supports <code>--server-url</code>, optional <code>--bearer-token</code>.</li>
<li><strong>stdio</strong>: launch and scan a stdio MCP server. Requires <code>--stdio-command</code>; accepts <code>--stdio-args</code>, <code>--stdio-env</code>, optional <code>--stdio-tool</code>.</li>
<li><strong>config</strong>: scan servers from a specific MCP config file. Requires <code>--config-path</code>; optional <code>--bearer-token</code>.</li>
<li><strong>known-configs</strong>: scan servers from well-known client config locations on this machine; optional <code>--bearer-token</code>.</li>
<li><strong>prompts</strong>: scan prompts on an MCP server. Requires <code>--server-url</code>; optional <code>--prompt-name</code>, <code>--bearer-token</code>.</li>
<li><strong>resources</strong>: scan resources on an MCP server. Requires <code>--server-url</code>; optional <code>--resource-uri</code>, <code>--mime-types</code>, <code>--bearer-token</code>.</li>
</ul>
<p dir="auto">Note: Top-level flags (e.g., <code>--server-url</code>, <code>--stdio-*</code>, <code>--config-path</code>, <code>--scan-known-configs</code>) remain supported when no subcommand is used, but subcommands are recommended.</p>

<div dir="auto"><h4 tabindex="-1" dir="auto">Scan well-known MCP config paths (Windsurf, Cursor, Claude, VS Code)</h4><a id="user-content-scan-well-known-mcp-config-paths-windsurf-cursor-claude-vs-code" aria-label="Permalink: Scan well-known MCP config paths (Windsurf, Cursor, Claude, VS Code)" href="#scan-well-known-mcp-config-paths-windsurf-cursor-claude-vs-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# YARA-only scan of all servers defined in well-known config locations
mcp-scanner --scan-known-configs --analyzers yara --format summary

# Detailed output
mcp-scanner --scan-known-configs --analyzers yara --detailed"><pre><span><span>#</span> YARA-only scan of all servers defined in well-known config locations</span>
mcp-scanner --scan-known-configs --analyzers yara --format summary

<span><span>#</span> Detailed output</span>
mcp-scanner --scan-known-configs --analyzers yara --detailed</pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Scan a specific MCP config file</h4><a id="user-content-scan-a-specific-mcp-config-file" aria-label="Permalink: Scan a specific MCP config file" href="#scan-a-specific-mcp-config-file"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Expand ~ yourself if needed by your shell
mcp-scanner --config-path &#34;$HOME/.codeium/windsurf/mcp_config.json&#34; \
 --analyzers yara --format by_tool"><pre><span><span>#</span> Expand ~ yourself if needed by your shell</span>
mcp-scanner --config-path <span><span>&#34;</span><span>$HOME</span>/.codeium/windsurf/mcp_config.json<span>&#34;</span></span> \
 --analyzers yara --format by_tool</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Use repeated --stdio-arg for reliable argument passing
mcp-scanner --analyzers yara --format summary \
  stdio --stdio-command uvx \
  --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch

# Or list-form (ensure it doesn&#39;t conflict with later flags)
mcp-scanner --analyzers yara --detailed \
  stdio --stdio-command uvx \
  --stdio-args --from mcp-server-fetch mcp-server-fetch

# Scan only a specific tool on the stdio server
mcp-scanner --analyzers yara --format summary \
  stdio --stdio-command uvx \
  --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch \
  --stdio-tool fetch"><pre><span><span>#</span> Use repeated --stdio-arg for reliable argument passing</span>
mcp-scanner --analyzers yara --format summary \
  stdio --stdio-command uvx \
  --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch

<span><span>#</span> Or list-form (ensure it doesn&#39;t conflict with later flags)</span>
mcp-scanner --analyzers yara --detailed \
  stdio --stdio-command uvx \
  --stdio-args --from mcp-server-fetch mcp-server-fetch

<span><span>#</span> Scan only a specific tool on the stdio server</span>
mcp-scanner --analyzers yara --format summary \
  stdio --stdio-command uvx \
  --stdio-arg=--from --stdio-arg=mcp-server-fetch --stdio-arg=mcp-server-fetch \
  --stdio-tool fetch</pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Use a Bearer token with remote servers (non-OAuth)</h4><a id="user-content-use-a-bearer-token-with-remote-servers-non-oauth" aria-label="Permalink: Use a Bearer token with remote servers (non-OAuth)" href="#use-a-bearer-token-with-remote-servers-non-oauth"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Direct remote server with Bearer token
mcp-scanner --analyzers yara --format summary \
  remote --server-url https://your-mcp-server/sse --bearer-token &#34;$TOKEN&#34;

# Apply Bearer token to all remote servers discovered from configs
mcp-scanner --analyzers yara --detailed known-configs --bearer-token &#34;$TOKEN&#34;
mcp-scanner --analyzers yara --format by_tool \
  config --config-path &#34;$HOME/.codeium/windsurf/mcp_config.json&#34; --bearer-token &#34;$TOKEN&#34;"><pre><span><span>#</span> Direct remote server with Bearer token</span>
mcp-scanner --analyzers yara --format summary \
  remote --server-url https://your-mcp-server/sse --bearer-token <span><span>&#34;</span><span>$TOKEN</span><span>&#34;</span></span>

<span><span>#</span> Apply Bearer token to all remote servers discovered from configs</span>
mcp-scanner --analyzers yara --detailed known-configs --bearer-token <span><span>&#34;</span><span>$TOKEN</span><span>&#34;</span></span>
mcp-scanner --analyzers yara --format by_tool \
  config --config-path <span><span>&#34;</span><span>$HOME</span>/.codeium/windsurf/mcp_config.json<span>&#34;</span></span> --bearer-token <span><span>&#34;</span><span>$TOKEN</span><span>&#34;</span></span></pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Scan all prompts on an MCP server
mcp-scanner --analyzers llm prompts --server-url http://127.0.0.1:8000/mcp

# Scan all prompts with detailed output
mcp-scanner --analyzers llm --detailed prompts --server-url http://127.0.0.1:8000/mcp

# Scan all prompts with table format
mcp-scanner --analyzers llm --format table prompts --server-url http://127.0.0.1:8000/mcp

# Scan a specific prompt by name
mcp-scanner --analyzers llm prompts --server-url http://127.0.0.1:8000/mcp --prompt-name &#34;greet_user&#34;

# Get raw JSON output
mcp-scanner --analyzers llm --raw prompts --server-url http://127.0.0.1:8000/mcp"><pre><span><span>#</span> Scan all prompts on an MCP server</span>
mcp-scanner --analyzers llm prompts --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan all prompts with detailed output</span>
mcp-scanner --analyzers llm --detailed prompts --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan all prompts with table format</span>
mcp-scanner --analyzers llm --format table prompts --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan a specific prompt by name</span>
mcp-scanner --analyzers llm prompts --server-url http://127.0.0.1:8000/mcp --prompt-name <span><span>&#34;</span>greet_user<span>&#34;</span></span>

<span><span>#</span> Get raw JSON output</span>
mcp-scanner --analyzers llm --raw prompts --server-url http://127.0.0.1:8000/mcp</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Scan all resources on an MCP server
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp

# Scan all resources with detailed output
mcp-scanner --analyzers llm --detailed resources --server-url http://127.0.0.1:8000/mcp

# Scan all resources with table format
mcp-scanner --analyzers llm --format table resources --server-url http://127.0.0.1:8000/mcp

# Scan a specific resource by URI
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp \
  --resource-uri &#34;file://test/document.txt&#34;

# Scan with custom MIME type filtering
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp \
  --mime-types &#34;text/plain,text/html,application/json&#34;"><pre><span><span>#</span> Scan all resources on an MCP server</span>
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan all resources with detailed output</span>
mcp-scanner --analyzers llm --detailed resources --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan all resources with table format</span>
mcp-scanner --analyzers llm --format table resources --server-url http://127.0.0.1:8000/mcp

<span><span>#</span> Scan a specific resource by URI</span>
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp \
  --resource-uri <span><span>&#34;</span>file://test/document.txt<span>&#34;</span></span>

<span><span>#</span> Scan with custom MIME type filtering</span>
mcp-scanner --analyzers llm resources --server-url http://127.0.0.1:8000/mcp \
  --mime-types <span><span>&#34;</span>text/plain,text/html,application/json<span>&#34;</span></span></pre></div>

<p dir="auto">The API server provides a REST interface to the MCP scanner functionality, allowing you to integrate security scanning into web applications, CI/CD pipelines, or other services. It exposes the same scanning capabilities as the CLI tool but through HTTP endpoints.</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Start the API server (loads configuration from .env file)
mcp-scanner-api --port 8000

# Or with custom host and port
mcp-scanner-api --host 0.0.0.0 --port 8080

# Enable development mode with auto-reload
mcp-scanner-api --reload"><pre><span><span>#</span> Start the API server (loads configuration from .env file)</span>
mcp-scanner-api --port 8000

<span><span>#</span> Or with custom host and port</span>
mcp-scanner-api --host 0.0.0.0 --port 8080

<span><span>#</span> Enable development mode with auto-reload</span>
mcp-scanner-api --reload</pre></div>
<p dir="auto">Once running, the API server provides endpoints for:</p>
<ul dir="auto">
<li><strong><code>/scan-tool</code></strong> - Scan a specific tool on an MCP server</li>
<li><strong><code>/scan-all-tools</code></strong> - Scan all tools on an MCP server</li>
<li><strong><code>/scan-prompt</code></strong> - Scan a specific prompt on an MCP server</li>
<li><strong><code>/scan-all-prompts</code></strong> - Scan all prompts on an MCP server</li>
<li><strong><code>/scan-resource</code></strong> - Scan a specific resource on an MCP server</li>
<li><strong><code>/scan-all-resources</code></strong> - Scan all resources on an MCP server</li>
<li><strong><code>/health</code></strong> - Health check endpoint</li>
</ul>
<p dir="auto">Documentation is available in <a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/api-reference.md">docs/api-reference.md</a> or as interactive documentation at <code>http://localhost:8000/docs</code> when the server is running.</p>

<p dir="auto">The scanner supports multiple output formats:</p>
<ul dir="auto">
<li><strong><code>summary</code></strong>: Concise overview with key findings</li>
<li><strong><code>detailed</code></strong>: Comprehensive analysis with full findings breakdown</li>
<li><strong><code>table</code></strong>: Clean tabular format</li>
<li><strong><code>by_severity</code></strong>: Results grouped by severity level</li>
<li><strong><code>raw</code></strong>: Raw JSON output</li>
</ul>


<div dir="auto" data-snippet-clipboard-copy-content="mcp-scanner --server-url http://127.0.0.1:8001/sse --format detailed"><pre>mcp-scanner --server-url http://127.0.0.1:8001/sse --format detailed</pre></div>
<div data-snippet-clipboard-copy-content="=== MCP Scanner Detailed Results ===

Scan Target: http://127.0.0.1:8001/sse

Tool: execute_system_command
Status: completed
Safe: No
Analyzer Results:
  • api_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 1 threat: security violation
    - Threat Names: SECURITY VIOLATION
    - Total Findings: 1
  • yara_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 2 threats: system access, command injection
    - Threat Names: SECURITY VIOLATION, SUSPICIOUS CODE EXECUTION
    - Total Findings: 2
  • llm_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 2 threats: prompt injection, tool poisoning
    - Threat Names: PROMPT INJECTION, SUSPICIOUS CODE EXECUTION
    - Total Findings: 2"><pre><code>=== MCP Scanner Detailed Results ===

Scan Target: http://127.0.0.1:8001/sse

Tool: execute_system_command
Status: completed
Safe: No
Analyzer Results:
  • api_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 1 threat: security violation
    - Threat Names: SECURITY VIOLATION
    - Total Findings: 1
  • yara_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 2 threats: system access, command injection
    - Threat Names: SECURITY VIOLATION, SUSPICIOUS CODE EXECUTION
    - Total Findings: 2
  • llm_analyzer:
    - Severity: HIGH
    - Threat Summary: Detected 2 threats: prompt injection, tool poisoning
    - Threat Names: PROMPT INJECTION, SUSPICIOUS CODE EXECUTION
    - Total Findings: 2
</code></pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="mcp-scanner --server-url http://127.0.0.1:8002/sse --format table"><pre>mcp-scanner --server-url http://127.0.0.1:8002/sse --format table</pre></div>
<div data-snippet-clipboard-copy-content="=== MCP Scanner Results Table ===

Scan Target: http://127.0.0.1:8002/sse

Scan Target                   Tool Name     Status     API      YARA     LLM      Severity
-----------------------------------------------------------------------------------------
http://127.0.0.1:8002/sse     exec_secrets  UNSAFE     HIGH     HIGH     HIGH     HIGH
http://127.0.0.1:8002/sse     safe_command  SAFE       SAFE     SAFE     SAFE     SAFE"><pre><code>=== MCP Scanner Results Table ===

Scan Target: http://127.0.0.1:8002/sse

Scan Target                   Tool Name     Status     API      YARA     LLM      Severity
-----------------------------------------------------------------------------------------
http://127.0.0.1:8002/sse     exec_secrets  UNSAFE     HIGH     HIGH     HIGH     HIGH
http://127.0.0.1:8002/sse     safe_command  SAFE       SAFE     SAFE     SAFE     SAFE
</code></pre></div>

<p dir="auto">For detailed documentation, see the <a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs">docs/</a> directory:</p>
<ul dir="auto">
<li><strong><a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/architecture.md">Architecture</a></strong> - System architecture and components</li>
<li><strong><a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/authentication.md">Authentication</a></strong> - OAuth and security configuration</li>
<li><strong><a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/programmatic-usage.md">Programmatic Usage</a></strong> - Programmatic usage examples and advanced usage</li>
<li><strong><a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/api-reference.md">API Reference</a></strong> - Complete REST API documentation</li>
<li><strong><a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/docs/output-formats.md">Output Formats</a></strong> - Detailed output format options</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Contact Cisco for obtaining an AI Defense subscription</h2><a id="user-content-contact-cisco-for-obtaining-an-ai-defense-subscription" aria-label="Permalink: Contact Cisco for obtaining an AI Defense subscription" href="#contact-cisco-for-obtaining-an-ai-defense-subscription"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://www.cisco.com/site/us/en/products/security/ai-defense/index.html" rel="nofollow">https://www.cisco.com/site/us/en/products/security/ai-defense/index.html</a></p>

<p dir="auto">Distributed under the <code>Apache 2.0</code> License. See <a href="https://github.com/cisco-ai-defense/mcp-scanner/tree/main/LICENSE">LICENSE</a> for more information.</p>
<p dir="auto">Project Link: <a href="https://github.com/cisco-ai-defense/mcp-scanner">https://github.com/cisco-ai-defense/mcp-scanner</a></p>
</article></div></div>
  </body>
</html>
