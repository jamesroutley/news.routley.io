<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://webcache.googleusercontent.com/search?q=cache:2T9NpG8thZgJ:https://community.fly.io/t/service-interruption-cant-destroy-machine-deploy-or-restart/14227&amp;cd=9&amp;hl=en&amp;ct=clnk&amp;gl=au">Original</a>
    <h1>Fly.io Postgres cluster down for 3 days, no word from them about it</h1>
    
    <div id="readability-page-1" class="page"><div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
      <meta itemprop="headline" content="Service Interruption: Can&#39;t Destroy Machine, Deploy, or Restart"/>
        <meta itemprop="articleSection" content="Questions / Help"/>
      <meta itemprop="keywords" content="rails"/>
      

          <div id="post_1">
            
            <div itemprop="articleBody">
              <p>Hey team, the health checks on our fly app were failing this morning and so I’ve logged in to diagnose this. I can see the machine has the “stopped” state, and there is a little banner saying:</p>
<pre><code>Service Interruption 3 hours ago
We are performing emergency maintenance on a host some of your apps instances are running on.
</code></pre>
<p>and no other information. I can’t see an issue on the status page and not sure where else to look for resolution steps or ETA?</p>
<p>I’m unable to restart or destroy the stopped machine instances (it times out), and trying to re-deploy the app throws an error:</p>
<pre><code>Error: found 1 machines that are unmanaged. `fly deploy` only updates machines with fly_platform_version=v2 in their metadata. Use `fly machine list` to list machines and `fly machine update --metadata fly_platform_version=v2 &lt;machine id&gt;` to update individual machines with the metadata. Once done, `fly deploy` will update machines with the metadata based on your fly.toml app configuration
</code></pre>
<p>Not sure what else to try at this point short of re-creating a new app or putting it up on another host. Any info you can provide?</p>
            </div>

            

            

          </div>
          <div id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>We also experienced this. One of our machines seems to have gone zombie mode, reporting unreachable for all <code>fly machine</code> commands with “Error: could not get machine.”</p>
<p>I’ve been able to restore availability to our app by using <code>fly scale</code> to allocate more VMs. However, the bad VM continues to exist in an indeterminate state, can’t be destroyed or removed from the account. <code>fly machine list</code> shows invalid data for the VM such as creation date of “1970-01-01T00:00:00Z”</p>
<p>I would appreciate any advice on how to remediate this.</p>
            </div>

            

            

          </div>
          <div id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>We’re seeing the same issue in our app, as of nearly 14 hours ago - and ours is for the database container, so it’s not as simple as scaling up to restore access <img src="https://emoji.discourse-cdn.com/twitter/frowning.png?v=12" title=":frowning:" alt=":frowning:" loading="lazy" width="20" height="20"/></p>
<p>We have a paid plan so I emailed support several hours ago, but no reply as of yet.</p>
<p>For the record, our app is hosted in <code>syd</code>, so maybe one or two hosts are having issues there?</p>
            </div>

            

            

          </div>
          <div id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>I’m also getting this - just like <a href="https://webcache.googleusercontent.com/u/mfwgenerics">@mfwgenerics</a>, I worked around this by scaling to create a new machine, but still have the original machine in a state where it can’t be destroyed:</p>
<pre><code>Error: could not get machine [machine ID]: failed to get VM [machine ID]: unavailable: dial tcp [ipv6]:3593: connect: connection refused
</code></pre>
<p>My staging environment is in the same state, but until I’m not adding more VMs that I’m surely going to be billed for until I know I can clean up the zombies.</p>
<p>Just like OP, I see the same error in the dashboard about emergency maintenance. That’s been there for <em>15 hours</em>, with no other information.</p>
<p>This is the <a href="https://community.fly.io/t/error-failed-to-launch-vm-request-returned-non-2xx-status-503/13394/4">second time</a> I’ve had this kind of issue with Fly, where my service just goes down, Fly reports everything healthy, and there’s literally no information and nothing I can really do other than wait and hope it comes back up sometime (hours later, probably).</p>
<p>I appreciate the convenience that Fly offers, but these kind of problems erode my trust in this platform completely. Heroku had it’s faults, but I was never left scouring a forum trying to get my service back up - if a host was unhealthy, my dyno would be automatically moved, no worries. I’m running a small-scale golden path Rails app with Postgres, I can’t imagine trying to fix these kinds of problems on a more complex app.</p>
            </div>

            

            

          </div>
          <div id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Adding some more information here since I’m also surprised that this is still ongoing 12 hours later with no response.</p>
<ul>
<li>We had four machines (app + Postgres for staging and production) running yesterday, and three of the four (including both databases) are still down and can’t be accessed. I can replicate the issues others have mentioned here.</li>
<li>This is our company’s external API app and so the issue broke all of our integrations.</li>
<li>Our team ended up setting up a new project in fly to spin up an instance to keep us going which took a couple of hours (backfilling environment variables and configuration etc, not a bad test of our DR ability).</li>
<li>There is no way I can find to get the data from the db machines. Thank goodness this isn’t our main production db and we were able to reverse engineer what we needed into there.</li>
</ul>
<p>Very keen to hear what’s happening with this and why after so many hours there’s no more info or updates.</p>
            </div>

            

            

          </div>
          <div id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>As an aside, it’s kind of a kick in the teeth to see the status page for our organization reporting no incidents - the same page that lists our apps as under maintenance and inaccessible!</p>

            

            

          </div>
          <div id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>Confirming my deployment is in <code>syd</code> too. I’m still seeing the zombie VM and observing failing CLI commands against the machine.</p>

            

            

          </div>
          <div id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <div><a href="https://global.discourse-cdn.com/business7/uploads/fly1/original/2X/6/6c0156ccc5696c58a720d8d900de3fd31ca2f109.png" data-download-href="/uploads/short-url/fpsr0Y1xw5dOzeiRWDqN1qRSIxX.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://global.discourse-cdn.com/business7/uploads/fly1/original/2X/6/6c0156ccc5696c58a720d8d900de3fd31ca2f109.png" alt="image" data-base62-sha1="fpsr0Y1xw5dOzeiRWDqN1qRSIxX" width="690" height="339" data-dominant-color="FBFBFD"/></a></div>
<p>We have <code>syd</code> deployments as well for all our apps too</p>
<p>I’m feeling very lucky that none of our paid production apps or databases are affected currently (only our development environment is), but also really surprised that the issue has been ongoing for 17 hours now with no status page update, no notifications (beyond betterstack letting us know it was down) and one note on the app with not much info as to whats going on.</p>
<p>It really worries me what would happen if it <em>was</em> one of our paid production instances that was affected - the data we’re working with can’t simply be ‘recovered’ later, it’d just get dropped until service resumed or we migrated to another region to get things running again</p>
<p>Keen to know whats wrong and whats being done about it</p>
            </div>

            

            

          </div>
          <div id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Message has now been updated</p>
<pre><code>Service Interruption (20 hours ago)
We are continuing to investigate an infrastructure related issue on this host.
</code></pre>
<p>Still no incidents listed on status page though for SYD region <img src="https://emoji.discourse-cdn.com/twitter/thinking.png?v=12" title=":thinking:" alt=":thinking:" loading="lazy" width="20" height="20"/></p>
            </div>

            

            

          </div>
          <div id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>not sure if connected but had a redis app in lhr fall into suspended status overnight, killed an important demo</p>
<p>machine is a zombie…</p>
<p>machine [id] was found and is currently in a stopped state, attempting to kill…</p>
            </div>

            

            

          </div>
          <div id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>I got a response from support a few hours ago -</p>
<blockquote>
<p>Unfortunately this host managed to get into a extremely poor state, and a fix is taking longer than expected. We have a team continuing to work on it, but no estimated resolution time to share right now. As soon as we have an update we will let you know.</p>
</blockquote>
<p>So I guess we just wait…</p>
            </div>

            

            

          </div>
          <div id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://community.fly.io/u/jl1"><span itemprop="name">jl1</span></a>
                
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-19T01:55:50Z">
                    July 19, 2023,  1:55am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-19T01:55:50Z"/>
              <span itemprop="position">12</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>Same issue here for me, on a host in <code>syd</code>. It’s completely broken a pg cluster.</p>
<p>The absence of any proactive status updates on this issue has been really poor.</p>
            </div>

            

            

          </div>
          <div id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Thank you for sharing that update, surprised there is no status update from Fly yet though <img src="https://emoji.discourse-cdn.com/twitter/cold_sweat.png?v=12" title=":cold_sweat:" alt=":cold_sweat:" loading="lazy" width="20" height="20"/></p>
<p>I can appreciate the issue might be taking up a lot of time and they want to focus on fixing it first - but even just a message from the staff here earlier would put me at ease for our production apps that are running</p>
            </div>

            

            

          </div>
          <div id="post_14" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>We worked out we could create a new Postgres cluster from one of the snapshots of the currently-down app - so we’re back up and running for our app.</p>
<p>(We had to create it with a different name, and then when we tried to make another one with the previous name, flyctl put the cluster on the same currently-down host! Oops)</p>
            </div>

            

            

          </div>
          <div id="post_15" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Also having this issue. Scale worked for the Phoenix server, but the Postgres server is also dead.</p>
<p>And I can’t even restore the Postgres one:</p>
<pre><code>Error: failed to create volume: Couldn&#39;t allocate volume, not enough compute capacity left in yyz
</code></pre>
            </div>

            

            

          </div>
          <div id="post_16" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>There’s a known incident listed on the status page for YYZ, might be related. <a href="https://status.flyio.net/incidents/f3jn8jh46nw6" rel="noopener nofollow ugc">Fly.io Status - We are undergoing emergency vendor hardware replacement in YYZ region.</a></p>
<p>Still crickets for the down host in SYD though <img src="https://emoji.discourse-cdn.com/twitter/frowning.png?v=12" title=":frowning:" alt=":frowning:" loading="lazy" width="20" height="20"/></p>
            </div>

            

            

          </div>
          <div id="post_17" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>Yes, mine has been fixed.</p>

            

            

          </div>
          <div id="post_18" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>Really weird how radio silent it’s been on it <img src="https://emoji.discourse-cdn.com/twitter/thinking.png?v=12" title=":thinking:" alt=":thinking:" loading="lazy" width="20" height="20"/> we’re coming up on 48 hours now</p>

            

            

          </div>
          <div id="post_19" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Just a note that the status update for me now states that the service interruption was resolved 7 hours ago:</p>
<blockquote>
<p>Service Interruption resolved 7 hours ago</p>
</blockquote>
<p>I still had to manually restart the machine to actually bring my app back up, but I’ve been able to actually interact with machines now, so I guess it is resolved.</p>
<p>Never heard anything from Fly, just complete silence. No status page updates either. I’m sympathetic to the problems I can imagine Fly having to scale their service and support, but the takeaway I have from this experience is that if something outside my own control happens with Fly, there’s nothing I can do to find out what’s going on, when it’s going to be resolved, and if there’s anything I can do to resolve the issue. It sounds like even the paid email support has a multi-hour response, and even then it’s just going to be a “we’re working on it”. I can’t recommend Fly professionally with that kind of experience, and I’m not sure if I can even tolerate it for personal apps.</p>
            </div>

            

            

          </div>
          <div id="post_20" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              <p>Update: my bad VM has finally been restored after a couple of days.</p>
<p>I am concerned about the lack of clarity and communication around what happened but I’m happy to put this situation down to growing pains on Fly’s part. I think I’ll be sticking to non-critical, non-stateful workloads for the near term though. <img src="https://emoji.discourse-cdn.com/twitter/sweat_smile.png?v=12" title=":sweat_smile:" alt=":sweat_smile:" loading="lazy" width="20" height="20"/></p>
            </div>

            

            

          </div>
    </div></div>
  </body>
</html>
