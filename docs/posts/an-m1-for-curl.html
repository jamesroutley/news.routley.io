<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://daniel.haxx.se/blog/2022/12/30/an-m1-for-curl/">Original</a>
    <h1>An M1 for Curl</h1>
    
    <div id="readability-page-1" class="page"><div id="page">
		
	
	<!-- #masthead -->

	<div id="main">

	<div id="primary">
		<div id="content" role="main">
			
<article id="post-21147">
	
		<p><img width="672" height="338" src="https://daniel.haxx.se/blog/wp-content/uploads/2022/03/apples.jpg" alt="" decoding="async"/>		</p>

		
	<!-- .entry-header -->

		<div>
		
<p>A generous member of the wider curl community stepped up and donated an unused Mac mini m1 model to me to be used for curl development. Today it arrived at my home. An <code>8C CPU/16GB/1TB/8C GPU/1GbE</code> model as per the sticker on the box.</p>


<div>
<figure><a href="https://daniel.haxx.se/blog/wp-content/uploads/2022/12/PXL_20221229_121515059.jpg"><img decoding="async" loading="lazy" width="3024" height="3027" src="https://daniel.haxx.se/blog/wp-content/uploads/2022/12/PXL_20221229_121515059.jpg" alt=""/></a><figcaption>The m1 mac mini, still wrapped in plastic.</figcaption></figure></div>


<h2>Apple is not helping</h2>



<p>Apple has shipped and used curl in their products for twenty years but <strong>they never assist, help or otherwise contribute to the development</strong>. They also don’t sponsor us in any way, like with hardware.</p>



<p>Yet, there are many curl users on the different Apple platforms and sometimes these <a href="https://daniel.haxx.se/blog/2021/11/18/free-apple-support/" data-type="post" data-id="17766">users run into issues</a> that are unique to those platforms and are challenging to address without direct access to such.</p>



<h2>For curl</h2>



<p>I decided to accept this gift as I believe it might help the project, but this is not a guarantee or promise that I will run around and become the mac support guy in the project. It will just allow me to sometimes get a better grip and ability to help out.</p>



<p>I will also offer other curl committers access to the machine in case of need. For development and debugging and whatnot. Talk to me about it.</p>



<h2>A tiny speed comparison</h2>



<p>My Intel-based development machine runs Linux, is ten years old and is equipped with an i7-3770K CPU at 3.5GHz. The source code is stored on an OCZ-VERTEX4 SSD on the Intel, the mac has SSD storage only.</p>



<p>Here’s a rough and not very scientific test of some of my most common build activities on the m1+macOS vs the old Intel+Linux machines. This is using the bleeding edge curl source code with roughly the same build config. Both used clang for compiling, a debug build.</p>



<figure><table><tbody><tr><td><strong>Test</strong></td><td><strong>m1</strong></td><td><strong>Intel</strong></td></tr><tr><td>configure</td><td>19.8 s</td><td>18.5 s</td></tr><tr><td>make -sj</td><td>12.8 s</td><td>14.2 s</td></tr><tr><td>autoreconf -fi</td><td>7.9 s</td><td>12.8 s</td></tr><tr><td>make -sj (in <code>tests/</code>)</td><td>19.1 s</td><td>33.9 s</td></tr></tbody></table></figure>



<p>I expected the differences to be bigger.</p>



<p>The first line of curl -V for the two builds:</p>



<pre>curl 7.87.1-DEV (aarch64-apple-darwin22.2.0) libcurl/7.87.1-DEV OpenSSL/3.0.7 zlib/1.2.11 brotli/1.0.9 zstd/1.5.2 c-ares/1.18.1 libidn2/2.3.4 libpsl/0.21.2 (+libicu/71.1) libssh2/1.10.0 nghttp2/1.51.0 libgsasl/2.2.0</pre>



<pre>curl 7.87.1-DEV (x86_64-pc-linux-gnu) libcurl/7.87.1-DEV OpenSSL/3.0.7 zlib/1.2.13 brotli/1.0.9 zstd/1.5.2 c-ares/1.17.0 libidn2/2.3.3 libpsl/0.21.0 (+libidn2/2.3.0) libssh2/1.10.1_DEV nghttp2/1.50.0-DEV librtmp/2.3 libgsasl/2.2.0</pre>



<p>Interestingly, there is no mention anywhere that I can find in the OS settings/config or in the box etc as to what CPU speed the m1 runs at.</p>



<h2>Credits</h2>



<p>This device was donated “to the cause” by “a member and supporter of the Network Time Foundation at nwtime.org” (real name withheld on request).</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-21147 -->
		<nav>
		
		<!-- .nav-links -->
		</nav><!-- .navigation -->
		
<!-- #comments -->
		</div><!-- #content -->
	</div><!-- #primary -->

<!-- #content-sidebar -->
<div id="secondary">
		<h2>tech, open source and networking</h2>
	
	
		<!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<!-- #colophon -->
	</div></div>
  </body>
</html>
