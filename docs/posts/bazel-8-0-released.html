<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/bazelbuild/bazel/releases/tag/8.0.0">Original</a>
    <h1>Bazel 8.0 Released</h1>
    
    <div id="readability-page-1" class="page"><div data-pjax="true" data-test-selector="body-content" data-view-component="true"><p>Bazel 8.0 is a major LTS release. It contains new features and backwards incompatible changes.</p>
<h2>Highlights</h2>
<ul>
<li>Many rules that were bundled with Bazel are now split into their own repositories, as part of the Starlarkification effort. This includes:
<ul>
<li>Android: All android_* build and repo rules have been moved to <a href="https://github.com/bazelbuild/rules_android">http://github.com/bazelbuild/rules_android</a>. Android tools are no longer bundled with Bazel inside @bazel_tools//tools/android.</li>
<li>C++: All C++ toolchain-related symbols have been moved <a href="https://github.com/bazelbuild/rules_cc">http://github.com/bazelbuild/rules_cc</a>; other symbols, including the rules themselves, will be moved in a future release.</li>
<li>Java: All java_* rules and providers (like JavaInfo)  have been moved to <a href="https://github.com/bazelbuild/rules_java">http://github.com/bazelbuild/rules_java</a>.</li>
<li>Protobuf: All *_proto_library rules (for Java, C++, Python)  and providers (like ProtoInfo)  have been moved to <a href="https://github.com/google/protobuf">http://github.com/google/protobuf</a>.</li>
<li>Python: All py_* rules and providers (like PyInfo) have been moved to <a href="https://github.com/bazelbuild/rules_python">http://github.com/bazelbuild/rules_python</a>.</li>
<li>Shell: All sh_* rules have been moved to <a href="https://github.com/bazelbuild/rules_shell">http://github.com/bazelbuild/rules_shell</a>.</li>
<li>Use load statements for all  the rules and providers from the above repositories. The load statements work with Bazel 6, 7 and 8 (repositories are backwards compatible and support both bzlmod and WORKSPACE mode). Bazel 9 will make load statements mandatory.</li>
<li>To facilitate migration, Bazel 8 introduces the --incompatible_autoload_externally flag, which by default loads rules and symbols that were previously hard-coded inside Bazel from corresponding rule repositories.</li>
</ul>
</li>
<li>The WORKSPACE mechanism is now disabled by default.
<ul>
<li><a href="https://bazel.build/external/overview#bzlmod" rel="nofollow">Bzlmod</a>, the new way to manage external dependencies, is turned on by default since Bazel 7.0.</li>
<li>The WORKSPACE and WORKSPACE.bzlmod files are no longer read by Bazel, by default. To bring back this behavior, use --enable_workspace. Check the <a href="https://bazel.build/external/migration" rel="nofollow">migration guide</a> and try out the <a href="https://github.com/bazelbuild/bazel-central-registry/tree/main/tools#migrate_to_bzlmodpy">migration tool</a> for moving your external dependencies to Bzlmod.</li>
<li>We are aiming to remove WORKSPACE in Bazel 9 completely.</li>
</ul>
</li>
<li>Symbolic macros are introduced as a new way to write build macros, improving the experience for both macro authors and BUILD file owners.
<ul>
<li>Symbolic macro arguments are typed like rule attributes, with similar type conversions. They also are less prone to latent bugs because they automatically promote values of configurable attributes to select() expressions.</li>
<li>Symbolic macros avoid pitfalls that harm BUILD readability, such as mutating their arguments, and are compatible with lazy evaluation (not implemented yet).</li>
<li>Internal targets of symbolic macros are protected from clients by the visibility system.</li>
<li>Legacy macros that call native.existing_rules() can often be replaced by finalizer macros.</li>
<li>See <a href="https://bazel.build/extending/macros" rel="nofollow">https://bazel.build/extending/macros</a> for more detail on symbolic macros.</li>
</ul>
</li>
</ul>
<h2>Migration-Ready Incompatible Flags</h2>
<p>The following flags are flipped in 8.0:</p>
<ul>
<li>--enable_workspace (<a href="https://github.com/bazelbuild/bazel/issues/23023" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23023/hovercard">#23023</a>; now defaults to false)</li>
<li>--incompatible_disallow_ctx_resolve_tools (<a href="https://github.com/bazelbuild/bazel/issues/22249" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/22249/hovercard">#22249</a>; now defaults to true)</li>
<li>--incompatible_disallow_empty_glob (<a href="https://github.com/bazelbuild/bazel/pull/8195" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/8195/hovercard">#8195</a>; now defaults to true)</li>
<li>--incompatible_macos_set_install_name (<a href="https://github.com/bazelbuild/bazel/issues/12370" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/12370/hovercard">#12370</a>; now defaults to true)</li>
<li>--incompatible_no_implicit_watch_label (<a href="https://github.com/bazelbuild/bazel/issues/23861" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23861/hovercard">#23861</a>; now defaults to true)</li>
<li>--incompatible_struct_has_no_methods (<a href="https://github.com/bazelbuild/bazel/issues/19465" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19465/hovercard">#19465</a>; now defaults to true)</li>
<li>--incompatible_use_plus_in_repo_names (<a href="https://github.com/bazelbuild/bazel/issues/23127" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23127/hovercard">#23127</a>; now defaults to true)</li>
<li>--legacy_external_runfiles (<a href="https://github.com/bazelbuild/bazel/issues/23574" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23574/hovercard">#23574</a>; now defaults to false)</li>
<li>--legacy_important_outputs (<a href="https://github.com/bazelbuild/bazel/pull/14353" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/14353/hovercard">#14353</a>; now defaults to false)</li>
<li>--zip_undeclared_test_outputs (<a href="https://github.com/bazelbuild/bazel/commit/489d08bf472f4568b3f7f478a8747a30cb956111">489d08b</a>; now defaults to false)</li>
</ul>
<p>The following flags will be flipped in a future major release:</p>
<ul>
<li>--incompatible_autoload_externally (<a href="https://github.com/bazelbuild/bazel/issues/23043" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23043/hovercard">#23043</a>; will default to true)</li>
<li>--incompatible_disable_native_repo_rules (<a href="https://github.com/bazelbuild/bazel/issues/22080" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/22080/hovercard">#22080</a>; will default to true)</li>
<li>--incompatible_disable_non_executable_java_binary (<a href="https://github.com/bazelbuild/bazel/issues/19687" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19687/hovercard">#19687</a>; will default to true)</li>
<li>--incompatible_disallow_struct_provider_syntax (<a href="https://github.com/bazelbuild/bazel/issues/19467" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19467/hovercard">#19467</a>; will default to true)</li>
<li>--incompatible_disable_target_provider_fields (<a href="https://github.com/bazelbuild/bazel/issues/19466" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19466/hovercard">#19466</a>; will default to true)</li>
<li>--incompatible_enable_deprecated_label_apis (<a href="https://github.com/bazelbuild/bazel/issues/23144" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/23144/hovercard">#23144</a>; will default to false)</li>
<li>--incompatible_stop_exporting_language_modules (<a href="https://github.com/bazelbuild/bazel/issues/19455" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19455/hovercard">#19455</a>; will default to true)</li>
<li>--incompatible_auto_exec_groups (<a href="https://github.com/bazelbuild/bazel/issues/17134" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/17134/hovercard">#17134</a>; will default to true)</li>
<li>--incompatible_disable_starlark_host_transitions (<a href="https://github.com/bazelbuild/bazel/issues/17032" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/17032/hovercard">#17032</a>; will default to true)</li>
<li>--incompatible_config_setting_private_default_visibility (<a href="https://github.com/bazelbuild/bazel/issues/12933" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/12933/hovercard">#12933</a>; will default to true)</li>
</ul>
<h2>General</h2>
<ul>
<li><strong>[Incompatible]</strong> All labels in Bazel error messages, log output, Build Event Protocol, etc. are now prefixed with double-at (@@) instead of single-at (@) where applicable, to properly denote that they contain canonical repo names.</li>
<li><strong>[Incompatible]</strong> The global applicable_licenses attribute has been renamed to package_metadata. The older name may be used for creating targets, but Starlark code must use the name package_metadata to retrieve it.</li>
<li><strong>[Incompatible]</strong> The package(distribs=[...]) attribute has been removed. It has been a no-op for several years now. distribs() at the package level is no longer legal syntax.</li>
<li><strong>[Incompatible]</strong> The --host_jvm_profile command line argument is not supported anymore.</li>
<li><strong>[Incompatible]</strong> The path attribute is removed from filegroup.</li>
<li><strong>[Incompatible]</strong> &#34;bazel query&#34; and &#34;bazel print_action&#34; can&#39;t run under the output base anymore.</li>
<li><strong>[Incompatible]</strong> --zip_undeclared_test_outputs now defaults to false, causing undeclared test outputs (i.e., files written to $TEST_UNDECLARED_OUTPUTS_DIR by a test) to be produced as a directory instead of a zip file.</li>
<li><strong>[Incompatible]</strong> On Windows, a change to the output base locking protocol might cause an older Bazel invoked immediately after a newer Bazel (on the same output base) to error out instead of blocking for the lock, even if --block_for_lock is enabled. (<a href="https://github.com/bazelbuild/bazel/pull/24210" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24210/hovercard">#24210</a>)</li>
<li>The result of canonicalize-flags now includes all Starlark flags by default. Use --noexperimental_include_default_values for the old behavior that only reports Starlark flags with non-default values.</li>
<li>Bazel now supports all characters in the rlocation and target paths of runfiles and can be run from workspaces with a space in their full path (<a href="https://github.com/bazelbuild/bazel/pull/23331" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/23331/hovercard">#23331</a>).</li>
<li>genquery now supports (unconfigured) cycles, but may have higher peak memory usage.</li>
<li>The default value of --skyframe_high_water_mark_minor_gc_drops_per_invocation and --skyframe_high_water_mark_full_gc_drops_per_invocation has been decreased to 10, which can result in Bazel OOMing more eagerly as Skyframe state is no longer dropped an unlimited number of times in response to high memory pressure.</li>
<li>Improved progress message in case there are no actions in flight, and display explicitly &#34;no actions running&#34; in that case.</li>
<li>glob now has a more efficient implementation that uses less retained memory and CPU, while sometimes taking more wall time for recursive globs in very large directory trees.</li>
<li>REPO.bazel now allows another directive, ignore_directories(). It takes a list of directories to ignore just like .bazelignore does, but with glob semantics. (<a href="https://github.com/bazelbuild/bazel/pull/24203" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24203/hovercard">#24203</a>)</li>
</ul>
<h2>Android</h2>
<ul>
<li>Native <code>mobile-install</code> is deleted. Please use the new Starlarkified version (“mobile-install v3”) instead. See <a href="https://github.com/bazelbuild/rules_android">https://github.com/bazelbuild/rules_android</a>.</li>
</ul>
<h2>Build Event Protocol</h2>
<ul>
<li>BEP will include correct TestResult and TargetSummary events when special test inputs like $test_runtime fail to build.</li>
<li>The default size limit for a named set of files in BEP is now 5000 (was unlimited before). In the event that the limit is reached, the message will be split.</li>
<li>BEP now contains data similar to dump command breakdowns for rules, aspects and skykeys.</li>
<li>WorkerMetrics of killed workers are logged (max 50 based on custom prioritization and then arranged in order of worker id). WorkerMetrics also includes the number of actions executed by each worker are now logged in the BEP. The semantics of WorkerPoolStats.evicted_count to refer to the workers that are killed (destroyed) as a result of memory pressure (evicted_count &lt;= destroyed_count).</li>
<li>BEP&#39;s execution_phase_time_in_ms no longer includes the analysis-only part at the beginning of the build. Artificial downtrend in execution_phase_time_in_ms expected.</li>
<li>A new experimental flag, --experimental_build_event_output_group_mode, allows users to change how a given output group&#39;s files are reported in BEP. The current behavior is NAMED_SET_OF_FILES_ONLY which populates OutputGroup.file_sets. Users may now specify INLINE_ONLY to instead report files directly in the TargetComplete/AspectComplete event under OutputGroup.inline_files. Users may also specify BOTH to populate OutputGroup.file_sets and OutputGroup.inline_files.</li>
<li>Undeclared test outputs are now reported individually in the BEP, unless zipping is enabled via --zip_undeclared_test_outputs.</li>
<li>Log all WorkerPoolStats for all worker pools (even though workers aren&#39;t created or destroyed). Also add unknown_destroyed_count and alive_count to the WorkerPoolStats proto.</li>
<li>By default, coverage artifacts will be reported inline in the TargetComplete event. To disable this behavior, pass --experimental_build_event_output_group_mode=baseline.lcov=named_set_of_files_only.</li>
</ul>
<h2>C++ / Objective-C</h2>
<ul>
<li><strong>[Incompatible]</strong> apple_cc_toolchain rule was removed. Use regular cc_toolchain instead.</li>
<li><strong>[Incompatible]</strong> The Starlark methods copts, generate_linkmap, and should_strip_binary in the objc fragment have been deleted.  Please use the equivalent methods objccopts, objc_generate_linkmap, and objc_should_strip_binary in the cpp fragment instead.</li>
<li><strong>[Incompatible]</strong> Removed def_file from cc_common.create_link_variables.</li>
<li><strong>[Incompatible]</strong> With the default Unix toolchain on macOS, binaries now use <a data-hovercard-type="user" data-hovercard-url="/users/rpath/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/rpath">@rpath</a> to find their .dylib dependencies. This is required to fix issues where tools run during the build couldn&#39;t find their dynamic dependencies. (<a href="https://github.com/bazelbuild/bazel/pull/23090" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/23090/hovercard">#23090</a>)</li>
<li><strong>[Incompatible]</strong> The deprecated fragments[&#34;apple&#34;].bitcode_mode and fragments[&#34;cpp&#34;].apple_bitcode_mode APIs have been removed from Bazel. Apple deprecated Bitcode in Xcode 14.</li>
<li><strong>[Incompatible]</strong> CppLinkAction returns 2 args to aspects that have the correct quoting set (before it was always 1 args object defaulting to bash escaping).</li>
<li><strong>[Incompatible]</strong> The BAZEL_CURRENT_REPOSITORY preprocessor variable, which holds the canonical name of the Bazel repository containing a cc_* target, is now only set during compilation if the target depends on the C/C++ runfiles library @rules_cc/cc//runfiles via deps or implementation_deps.</li>
<li><strong>[Incompatible]</strong> C++ toolchains configuration files have moved to rules_cc, if you are depending on anything in @bazel_tools//tools/cpp, you should use the version from @rules_cc (&gt;=0.0.12) instead.</li>
<li>Added conlyopts and cxxopts attributes to C++ rules (<a href="https://github.com/bazelbuild/bazel/pull/23792" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/23792/hovercard">#23792</a>)</li>
<li>cc_toolchain now passes runfiles for its *_files attrs (e.g. data files for a tool built for linking).</li>
<li>The new cc_static_library rule produces a static library that bundles given targets and all their transitive dependencies. It has to be enabled via --experimental_cc_static_library.</li>
<li>New $(DUMPBIN) make variable is now available for Visual Studio toolchains.</li>
<li>--incompatible_make_thinlto_command_lines_standalone is now a no-op.</li>
<li>--compile_one_dependency selects header-only cc_librarys in more cases.</li>
<li>Added windows_quoting_for_param_files feature for windows-style parameter file escaping.</li>
<li>The local_defines attribute of cc_library() and cc_binary() supports $(location ...) expansion for additional_compiler_inputs just like for deps.</li>
<li>The bazel --quiet command line option can now be used to make Bazel emit much less output. (<a href="https://github.com/bazelbuild/bazel/pull/24024" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24024/hovercard">#24024</a>)</li>
<li><strong>[Incompatible]</strong> cc_toolchain_suite is a <a href="https://github.com/bazelbuild/bazel/issues/7260" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/7260/hovercard">no op</a>. All C++ rules use Bazel&#39;s <a href="https://bazel.build/extending/toolchains" rel="nofollow">toolchain API</a>.</li>
<li><strong>[Incompatible]</strong> --incompatible_enable_cc_toolchain_resolution is a <a href="https://github.com/bazelbuild/bazel/issues/7260" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/7260/hovercard">no op</a>. All C++ rules use Bazel&#39;s <a href="https://bazel.build/extending/toolchains" rel="nofollow">toolchain API</a>.</li>
</ul>
<h2>Configurability / cquery</h2>
<ul>
<li><strong>[Incompatible]</strong> <a href="https://bazel.build/extending/config#incoming-edge-transitions" rel="nofollow">Incoming</a> rule() transitions  can&#39;t set cfg = &#34;exec&#34; or <a href="https://bazel.build/rules/lib/toplevel/config#exec" rel="nofollow">cfg = config.exec()</a>. This generally doesn&#39;t make sense. Prefer declaring dependencies as exec tools.</li>
<li>Starlark rules can annotate attr() with <a href="https://bazel.build/rules/lib/toplevel/config#none" rel="nofollow">cfg = config.none()</a>. This is useful for pure-data dependencies that should build the same no matter their parent&#39;s configuration.</li>
<li>Starlark rules can replace cfg = &#34;target&#34; on attribute definitions with <a href="https://bazel.build/rules/lib/toplevel/config#target" rel="nofollow">cfg = config.target()</a> for more consistent syntax.</li>
<li><a href="https://bazel.build/query/cquery" rel="nofollow">bazel cquery</a> <a href="https://github.com/bazelbuild/bazel/issues/16310#issuecomment-1876108171" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/16310/hovercard">more accurately</a> lists dependencies from aspects. Requires --experimental_explicit_aspects. Try this if you see confusing results. As an experimental feature this doesn&#39;t work for all output formats. Available since 7.2.0.</li>
<li><a href="https://bazel.build/query/guide" rel="nofollow">bazel query</a> includes <a href="https://bazel.build/reference/be/platforms-and-toolchains#toolchain_type" rel="nofollow">toolchain type requirements</a> as implicit dependencies.. This includes the <a href="https://bazel.build/rules/lib/globals/bzl.html#rule.toolchains" rel="nofollow">toolchains</a> parameter in rule() definitions.</li>
</ul>
<h2>Coverage</h2>
<ul>
<li><strong>[Incompatible]</strong> Passing a FilesToRunProvider to coverage_support_files will now result in an error as opposed to being silently ignored.</li>
<li><strong>[Incompatible]</strong> Coverage report generators no longer receive the JAVA_RUNFILES and PYTHON_RUNFILES environment variables.</li>
</ul>
<h2>External Dependencies</h2>
<ul>
<li><strong>[Incompatible]</strong> The format of canonical repo names has changed to use plus (+) instead of tilde (~). Effectively, this flips the flag --incompatible_use_plus_in_repo_names to true, and the flag is now a no-op (i.e. cannot be &#34;unflipped&#34;). ​​See <a href="https://bazel.build/external/module#repository_names_and_strict_deps" rel="nofollow">https://bazel.build/external/module#repository_names_and_strict_deps</a> for advice on how to avoid hardcoding canonical repository names.</li>
<li>--experimental_repository_downloader_retries now defaults to 5.</li>
<li>Overrides in the root MODULE.bazel file are now ignored with --ignore_dev_dependency. (Overrides in non-root modules are already ignored.)</li>
<li>The fetch and vendor commands now support --target_pattern_file for specifying target patterns.</li>
<li>Patches to the module file in single_version_override are now effective as long as the patch file lies in the root module.</li>
<li>Repository rules instantiated in the same module extensions can now refer to each other by their extension-specified names in label attributes.</li>
<li>override_repo and inject_repo can be used to override and inject repos in module extensions. (<a href="https://github.com/bazelbuild/bazel/pull/23534" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/23534/hovercard">#23534</a>)</li>
<li>The new --inject_repository flag can be used to add new repositories via the CLI with --enable_bzlmod. Such repositories behave as if they were declared by local_repository via use_repo_rule in the root module. (<a href="https://github.com/bazelbuild/bazel/pull/24301" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24301/hovercard">#24301</a>)</li>
<li>External repositories that are managed by Bzlmod can now contain a top-level external directory or package. (<a href="https://github.com/bazelbuild/bazel/pull/24147" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24147/hovercard">#24147</a>)</li>
<li>repository_ctx.execute can now remove an environment variable when executing a process by associating it with the value None in the environment argument. (<a href="https://github.com/bazelbuild/bazel/pull/24245" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24245/hovercard">#24245</a>)</li>
<li>bazel mod now tries to evaluate all module extensions, even when some have failed to evaluate. (<a href="https://github.com/bazelbuild/bazel/pull/24259" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24259/hovercard">#24259</a>)</li>
<li>archive_override now accepts all attributes usable with http_archive; similar for git_override and git_repository. (<a href="https://github.com/bazelbuild/bazel/pull/24443" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24443/hovercard">#24443</a>)</li>
</ul>
<h2>Java</h2>
<ul>
<li>The core Java rules (java_binary, java_library, java_test, java_import, java_plugin) and symbols (java_common, JavaInfo, JavaPluginInfo) are no longer available in Bazel and must be loaded from @rules_java.
<ul>
<li>WORKSPACE builds may need to update their setup, see the release notes at <a href="https://github.com/bazelbuild/rules_java/releases">https://github.com/bazelbuild/rules_java/releases</a> for what @rules_java now requires. Relatedly, projects enabling both --enable_bzlmod and --enable_workspace that fetch @rules_java via the MODULE.bazel file, may need to explicitly re-declare some dependencies in the WORKSPACE file, as Bzlmod dependencies are not automatically visible to other WORKSPACE repositories.</li>
</ul>
</li>
<li>The default java language level (with rules_java 8.1.0) is now 11 (previously 8).</li>
<li>java_binary and java_test no longer generate an additional target - the deploy jars are once again outputs of the primary (only) target.</li>
<li>JavaInfo.compilation_info.javac_options now returns a depset. Use tokenize_javacopts from @rules_java to get the options as a correctly ordered list.</li>
<li>Java compilation actions now set LC_ALL=C.UTF-8 (previously: en_US.UTF-8).</li>
</ul>
<h2>Local Execution</h2>
<ul>
<li><strong>[Incompatible]</strong> The mnemonic passed to --worker_extra_flag is now matched against the worker key mnemonic when one is available, instead of the action mnemonic. This makes it consistent with other worker flags taking a mnemonic. (<a href="https://github.com/bazelbuild/bazel/pull/24251" data-hovercard-type="pull_request" data-hovercard-url="/bazelbuild/bazel/pull/24251/hovercard">#24251</a>)</li>
<li>Prevent linux-sandbox(ed) spawns from being able to write in the cgroups mount.</li>
<li>Symlink trees are now created through direct filesystem calls by default, instead of delegated to a helper process. On Windows, this entails respecting the --windows_enable_symlinks flag, falling back to a copy when the flag is unset (the helper process always attempts to create symlinks, irrespective of the flag). Set --noexperimental_inprocess_symlink_creation to temporarily revert to the previous behavior, which will be removed in a future release.</li>
</ul>
<h2>Performance</h2>
<ul>
<li><strong>[Incompatible]</strong> The aquery command now reports all potential inputs of actions that support input discovery, including the input headers of C++ compilation actions and those explicitly marked as unused through the unused_inputs_list argument to ctx.actions.run. Set --noinclude_pruned_inputs to omit pruned inputs from aquery output when running it after action execution.</li>
<li><strong>[Incompatible]</strong> The --experimental_aquery_dump_after_build_format and --experimental_aquery_dump_after_build_output_file command line options are not available anymore.</li>
<li>--experimental_collect_system_network_usage is flipped to true and will be removed soon.</li>
<li>Introduced Skyfocus, an experimental feature aimed to reduce Bazel&#39;s retained heap usage with working sets. Use --experimental_enable_skyfocus to enable it. See <a href="https://bazel.build/advanced/performance/memory#trade-flexibility" rel="nofollow">documentation</a> for more information.</li>
<li>bazel query now uses 3% less memory.</li>
<li>Introduce new flag --experimental_worker_use_cgroups_on_linux that uses cgroups to track memory usage for singleplex workers (on Linux).</li>
<li>Added --experimental_collect_skyframe_counts_in_profiler to collect Skyframe node counts in the JSON profile over time. Currently, the following SkyFunctions are measured: BZL_LOAD, GLOB, GLOBS, PACKAGE, CONFIGURED_TARGET, ASPECT, ACTION_EXECUTION.</li>
<li>Introduced a new format for the execution log, enabled by --execution_log_compact_file. This format is preferred over the preexisting --execution_log_{binary,json}_file, as it’s much cheaper to produce and smaller in size; however, it’s not human-readable. The tools in //src/tools/execlog may be used to analyze logs and convert between formats.</li>
</ul>
<h2>Remote Execution</h2>
<ul>
<li>Added the ability to garbage collect the disk cache by setting one or both of --experimental_disk_cache_gc_max_size and --experimental_disk_cache_gc_max_age. Garbage collection occurs in the background while the Bazel server is idle; the idle timer defaults to 5 minutes, but may be overridden by --experimental_disk_cache_gc_idle_delay.</li>
<li>The default value of --experimental_remote_cache_eviction_retries is changed to 5.</li>
<li>Uploading local action results to a disk or remote cache now occurs in the background whenever possible, potentially unblocking the execution of followup actions. Set --noremote_cache_async to revert to the previous behavior.</li>
<li>Added support for using a remote cache that evicts blobs and doesn&#39;t have AC integrity check (e.g. HTTP cache).</li>
<li>--incompatible_remote_symlinks, --incompatible_remote_dangling_symlinks, --incompatible_remote_downloader_send_all_headers and --incompatible_remote_output_paths_relative_to_input_rootare deleted.</li>
<li>--build_event_upload_max_threads is removed.</li>
<li>The default value of --experimental_remote_cache_compression_threshold is changed to 100.</li>
</ul>
<h2>Starlark / Build Language</h2>
<ul>
<li>Bazel can now parse .scl files, a dialect of Starlark without Bazel-specific symbols.</li>
<li>Dormant dependencies and materializer functions are now available with the --experimental_dormant_deps flag.</li>
<li>Aspects can now propagate to target’s toolchain dependencies by specifying the toolchain types to propagate to via toolchains_aspects.</li>
<li>Aspects can now return DefaultInfo, which will then be merged with that of the configured target they are applied to. Currently, only the files field is supported.</li>
<li>Output groups provided by a rule and/or multiple aspects are now merged instead of resulting in an error.</li>
<li>If --proto:rule_classes flag is enabled, query proto output will contain rule class definitions in Stardoc proto format.</li>
<li>Starlark min and max builtins now allow a key callback, similarly to sorted.</li>
<li><strong>[Incompatible]</strong> Non-singleton target visibility lists can now contain //visibility:public and //visibility:private elements; the result is appropriately simplified when assigned to an attribute. (<a href="https://github.com/bazelbuild/bazel/issues/19922" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19922/hovercard">#19922</a>)</li>
<li><strong>[Incompatible]</strong> --incompatible_simplify_unconditional_selects_in_rule_attrs simplifies configurable rule attributes which contain only unconditional selects. (<a href="https://github.com/bazelbuild/bazel/issues/19922" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/19922/hovercard">#19922</a>)</li>
<li><strong>[Incompatible]</strong> The input_manifests argument of ctx.actions.{run,run_shell} is now a no-op. resolve_command and resolve_tools always return the empty list as the input manifest list.</li>
<li><strong>[Incompatible]</strong> ctx.resolve_tools is no longer available by default, in preparation for complete removal. Use --noincompatible_disallow_ctx_resolve_tools to temporarily make it available again. (<a data-error-text="Failed to load title" data-id="2280997341" data-permission-text="Title is private" data-url="https://github.com/bazelbuild/bazel/issues/22249" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/22249/hovercard" href="https://github.com/bazelbuild/bazel/issues/22249">#22249</a>)</li>
</ul>
<h2>Windows</h2>
<ul>
<li><strong>[Incompatible]</strong> On Windows, the default msys64 root is changed to C:/msys64 from C:/tools/msys64.</li>
</ul>
<h2>Appendix</h2>
<p>The following flags have been removed or changed to no-op:</p>
<ul>
<li>--android_cpu</li>
<li>--android_crosstool_top</li>
<li>--android_grte_top</li>
<li>--android_sdk</li>
<li>--crosstool_top</li>
<li>--enable_fdo_profile_absolute_path</li>
<li>--experimental_announce_profile_path</li>
<li>--experimental_objc_include_scanning</li>
<li>--experimental_proto_extra_actions</li>
<li>--fat_apk_cpu</li>
<li>--host_crosstool_top</li>
<li>--host_swiftcopt</li>
<li>--incompatible_depset_for_java_output_source_jars</li>
<li>--incompatible_disallow_symlink_file_to_dir</li>
<li>--incompatible_disallow_unsound_directory_outputs</li>
<li>--incompatible_enable_android_toolchain_resolution</li>
<li>--incompatible_enable_cc_toolchain_resolution</li>
<li>--incompatible_existing_rules_immutable_view</li>
<li>--incompatible_make_thinlto_command_lines_standalone</li>
<li>--incompatible_objc_provider_remove_linking_info</li>
<li>--incompatible_remote_build_event_upload_respect_no_cache</li>
<li>--incompatible_remote_dangling_symlinks</li>
<li>--incompatible_remote_downloader_send_all_headers</li>
<li>--incompatible_remote_output_paths_relative_to_input_root</li>
<li>--incompatible_remote_results_ignore_disk</li>
<li>--incompatible_remote_symlinks</li>
<li>--incompatible_struct_has_no_methods</li>
<li>--incompatible_use_host_features</li>
<li>--incompatible_use_plus_in_repo_names</li>
<li>--python2_path</li>
<li>--python3_path</li>
<li>--swiftcopt</li>
</ul>
<h2>Acknowledgements:</h2>
<p>This release contains contributions from many people at Google, as well as Adam Azarchs, Adam Singer, Alan Falloon, Alessandro Patti, Alex Eagle, Alex Sharoff, Alexander Golovlev, Alexandre Boulgakov, Artem V. Navrotskiy, Ben Lee, Benjamin Peterson, Brentley Jones, CaerusKaru, Cameron Martin, Chirag Ramani, Chris Gray, Christian Scott, Clay McClure, Cornelius Riemenschneider, Cristin Donoso, Daniel Wagner-Hall, David Ostrovsky, David Sanderson, Dennis van den Berg, detailyang, Dimi Shahbaz, DocQuantum, Douglas Thor, eantpil, Ed Schouten, Emil Waijers, Fabian Meumertzheim, FaBrand, Farid Zakaria, Fil-Den, Fredrik Medley, Fredrikhms, George Gensure, Greg Magolan, Greg Roodt, Grzegorz Lukasik, Guillaume Maudoux, Gunnar Wagenknecht, Honnix, Ikko Eltociear Ashimine, Isaac Torres, Jacob Van De Weert, James Sharpe, Jamison Lahman, Jan Keromnes, Jason Schroeder, Javier Maestro, Jay Conrod, Jiawen (Kevin) Chen, JKutscha, Joe Lencioni, John Millikin, Jonas Scharpf, Jonathan Block, jonshea, Jordan Mele, Josh Chorlton, Keith Smiley, Laurent Le Brun, Laurenz Altenmller, Letu Ren, Lior Gorelik, Luis Padron, M. Taimoor Zaeem, Marc Redemske, Maria, Mark Elliot, Matt Brown, Matt Smith, Matthieu MOREL, Michael Siegrist, Muescha, Nick Biryulin, Nikhil Kalige, Niko Wenselowski, Nils Wireklint, ouguoc2-stripe, Patrick Balestra, Paul Janzen, Peter Lobsinger, PikachuHy, Rahul Butani, Richard Smith, Richard Woodbury, Romain Chossart, Roman Salvador, Ryan Beasley, Sangita.Nalkar, Sara Adams, shingt, Siddhartha Bagaria, Simon Mavi Stewart, Son Luong Ngoc, Spencer Putt, Stefano Baghino, Sushain Cherivirala, Tanya Bouman, Ted, thesayyn, Thi Doan, Thomas Weischuh, Tianyu Geng, Timothy Gu, Tomasz Pasternak, UebelAndre, Ulf Adams, Ventzilla, Victor Hiairrassary, Viktor Kustov, Wade Carpenter, Xavier Bonaventura, xinyu.wang, and Yannic Bonenberger.</p>
<p><em>Notice</em>: Bazel installers contain binaries licensed under the GPLv2 with Classpath exception. Those installers should always be redistributed along with the source code.</p>
<p>Some versions of Bazel contain a bundled version of OpenJDK. The license of the bundled OpenJDK and other open-source components can be displayed by running the command <code>bazel license</code>. The vendor and version information of the bundled</p>
<p><em>Security</em>: All our binaries are signed with our <a href="https://bazel.build/bazel-release.pub.gpg" rel="nofollow">public key</a> 3D5919B448457EE0.</p></div></div>
  </body>
</html>
