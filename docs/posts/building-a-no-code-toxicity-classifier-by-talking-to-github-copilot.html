<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.surgehq.ai/blog/building-a-no-code-toxicity-classifier-by-talking-to-copilot">Original</a>
    <h1>Building a No-Code Toxicity Classifier ‚Äì By Talking to GitHub Copilot</h1>
    
    <div id="readability-page-1" class="page"><div><p>Last year, GitHub and OpenAI released <a href="https://copilot.github.com/">Copilot</a>, an AI-powered coding assistant built on top of GPT-3. It&#39;s incredible ‚Äì even I find it automates a lot of my daily work!</p><p>But as helpful as it is for coders, what if it enabled non-engineers to program too ‚Äì by merely <em>talking</em> to an AI about their goals? Let‚Äôs walk through an example.</p><h3>Building a Toxicity Classifier</h3><p>So imagine you want to build a machine learning model to classify toxic speech. You understand ML concepts at a high level, but you‚Äôre not a Python expert. We‚Äôll show how Copilot can help! </p><p>In this example, we‚Äôre using the <a href="https://github.com/github/copilot-docs/blob/main/docs/visualstudiocode/gettingstarted.md">Copilot extension for Visual Studio Code</a>, and a free <a href="https://www.surgehq.ai/datasets/toxicity-dataset">toxicity dataset</a> that we built; you can follow along by downloading the Jupyter notebook <a href="https://github.com/surge-ai/copilot-toxicity">here</a>.</p><p>Each time we want to issue Copilot a command, we‚Äôll write our directive as a <strong>comment</strong> (in green); Copilot&#39;s actions are the subsequent lines of code.</p><p>So let‚Äôs create a Jupyter notebook and start by telling Copilot to import all the programming libraries we need to train a toxicity classifier.¬†We write this comment in green:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623d08b76b7302fa3a01ac5d_CleanShot%202022-03-24%20at%2017.11.20%402x.png" loading="lazy" alt=""/></p></figure><p>Its first response is to &#34;import numpy as np&#34;!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7533c26286390b290ccc_gBBBCd3m-FU_bhE8hlXnZUJ0q2KogCoC7iMvwSRzanxy6LxDUe5L4uKoEJB6iTXk8xGxdmZL7zZDbDQW8-h2Pl-QuH-DTjWc0eu_K7WfHZADByATdwMMICR0tJcU8skrLNhQDQhP.png" alt=""/></p></figure><p>We let it continue until it starts repeating itself, leading to the following:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7533d40c1e5782c788c0_OCe4L26tEwMRq17OBND6GMosSIDGnCDcih5VY_b3Uufr0Sg7I-zhN5CBOV6gYleUIUTiZnoGk9pGKkqhCPcyubHjQTuWJ5GfMpFSCTvQ6ehbHSfzwpx9D--gdywjfAon7hmNTMhW.png" alt=""/></p></figure><p><em>All 28 imports were generated by¬†Copilot.</em> Next, we ask it to read in our dataset.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75343091b96a8173ced6_B-O-1WhzioV-fCHitz77xuyQxO4-_HQ4280fEu101PBV3OBF6BM8nenTrmTzYAlgJLq0rVT8y89olvWJ4GNK6dvWLihdvM-reOq_sDbgGBu60NJ_e6T6YnMH5D7Ugj-jP697juA9.png" alt=""/></p></figure><p>Remember: our only contribution will be the <strong>green #comments</strong> ‚Äì Copilot created the toxicity = pd.read_csv(&#34;toxicity.csv&#34;) line itself.</p><p>What does this dataset look like? We ask it to display the file...</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7533b16f33773d4baaa9_aBkf6HN491Zi8TWmlBEKuvDyvpaRPaPCbf8MlBrrb-Kk6jyWb8KDaY0ZIgkLCSZn2KEMiJp3f6obd-SUTR9s0pJwzYO3pNIChVlQKFS94roh2xPDNitVb6a7awdqFIywmSV0LFq4.png" alt=""/></p></figure><p>...and it successfully responds by showing the first 5 rows.</p><p>How many examples are in each class?</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753428f79c1fc24bc577__w8be_CALKpfgdQX5Vk5jXIvK-KkpZ30CpF6-y_4ac8As4tXOI9c5hp0HZdvafFYbaydYr9gn6JsfmL8wIc41eeQGql4Vap4fZ6GTp-K_olIShMn_M9bb4uHk9ju9bZD7_x6_L7W.png" alt=""/></p></figure><p>Copilot responds, unfortunately, with a line of code that doesn‚Äôt quite work ‚Äì there‚Äôs no &#39;target&#39; column or variable in our dataset.</p><p>It would be easy to fix this by replacing &#39;target&#39; with &#39;is_toxic&#39;, but where‚Äôs the fun in that? Does it help if we make our request more explicit?</p><p>It does!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7533a01bddcbd8d39821_QhJP_y04d9nynpMFjkR_aJFqTELuBczM7Ma2smAF5MhWLJiLqdq5Y0JMzCsXjEx5kTpK6jztOfboRdW2RNMqKvWVKzsmWSXEqxHIUXHtVNOXr6fhwGADI9S4qR4tAUumA-z1wucz.png" alt=""/></p></figure><p>We can even ask it to create a bar chart:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753428f79c49a54bc578_sq8FussWU5b-5pmIZsrRnEAFvR0mtI_NwGixTfhfq_NXFiZRqE-CZ-8psI_EwSQek0BnIUH2gksVmQJp48VZ-15O0lvpHj2yA6nG-UB18aA7MXTgvKLNRRTFMifAz7lSKxbad6xv.png" alt=""/></p></figure><p>Great, but it‚Äôs visually bland. Can Copilot pretty it up?</p><p>Let‚Äôs ask it to flip the axes, so that the bars are horizontal.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75346a7c6af79c072032_o9nzytkfAuVcM6N8EZ5jdqqTHCktWcgCKhDVqU5tLWFNwx2YMDzjJq7JVE3uO4M_nFvv1qD-lO39rXsyelCxh0CdUh9db5Z6keDywil4iMEIsWKUxjZtOBM9995Cwu5I-cgtmt1j.png" alt=""/></p></figure><p>That didn‚Äôt work, but let‚Äôs modify our comment and try again:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75343420ea3a58511036_hpUiz5bxwS9llV8lFJOiQzxyfBvAPqll59E8acOZVkf8OIfLkHlowkdFOntu0CTXy0Z5TfeR93S5_eQYIIpI76kKvIuvi8OVnHOsdsXWdJxcXCBuoZkmNN0xk4npsd6bgPCWwiiA.png" alt=""/></p></figure><p>üëå. </p><p>Can we also change the color of the bars?</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7534704a9093545ffb65_n7SCrdIqMvqCUGc2F3xx2c8kALfZQUERnxbUQHxVYKF-Nz0DrZX_rQO067HgI-ORy7U3RcHoQkXTe8d_rswoVux0HgHExBusxPKN5dRT2Az-pCKGkfznFbkSnTrM0_7HDX1ODza_.png" alt=""/></p></figure><p>Let‚Äôs give the bar chart a title too.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7534600b5e8aeafd583e_rJKNmfJOq0h7V4hmFOmJ4w9dKa019-CLLmrOHgGLlMfg07ZsHa3yKQqdiLKrwY609TrEfzufR1IlUSLSnJWz37DbKNehSpa6t0VG_aSUFNtBYs--IOP2GVVorYWE5KfiCrO3MFM8.png" alt=""/></p></figure><p><em>Who needs highly paid data scientists now?</em></p><p>Again, Copilot created <em>all of this code</em> simply through a ‚Äúconversation‚Äù with it! As someone who doesn‚Äôt generate many data visualizations in Python, I couldn&#39;t have easily done this myself, without a lot of Googling and reading documentation.</p><p>Imagine, in the future, Copilot creating this bar chart (and other insights) from a higher-level command: ‚Äúanalyze the dataset and produce useful insights‚Äù. In the same way that GPT-3 can understand important aspects of text, what if Copilot could automatically detect the important columns in a data frame, and predict that we might want to see the class balance or a precision-recall curve?</p><p>In our work with research labs developing large language models, we build advanced ‚Äúlabeling‚Äù teams of programmers and <a href="https://openai.com/blog/grade-school-math/">mathematicians</a> who train their AI systems to do exactly this. In other words, teams of high-skill, STEM ‚Äúlabelers‚Äù on our platform are given commands (or come up with commands themselves) and generate Python programs that solve them, serving as training demonstrations.</p><p>Moving on, let‚Äôs now ask Copilot to build a toxicity ML model using the dataset.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753439c2af3364569b35_9HJmAvfU9gjJe0RekT-hfxsHypJw8SzXGtHC_kod03PlA6CjXRmBTmMQsmQXW1fZPVdeZ_mkcutfC2oQDkD4lvfZJzwNkBDS7lBxS3SoEBy-J6VX6fx-sHcf000kMbW3sUga6kQb.png" alt=""/></p></figure><p>It produced the following as a result ‚Äì both the subsequent comments (&#34;# using a Naive Bayes classifier&#34; onwards) as well as the pipeline code!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75349362642625840228_NOICbaCfb8gumdS5iD9CSB7b8ctGFNF2t9NE5IULMWfYWrRwAaJ24pztaqIRsjAgT5zN26lCsZ7V8jGwEtA9pG7RwYRDHsrdVDJHJz_1mwM3jRr-QOPsekZp5NUNIPeDwXMeu_yZ.png" alt=""/></p></figure><p>I don‚Äôt know what a Pipeline is, but let‚Äôs ask Copilot to use it to classify regardless.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7534e8ca7cb2a66acd8e_q82ejajsP_n3scSNeCB5ZtCqSpTAhFFYGyPqjsdcRaSprZk1jmVrMtmzuLLXSXyGiatVzOFwLT2ZMFwBZ1YBNcmt6tmGO-1YdqhGbSo3Pltd1SC0bO8NBnOqEQxd5cQYK9z-QJc3.png" alt=""/></p></figure><p>When I don‚Äôt know what to do next (what do I use a pipeline for?), and Copilot doesn‚Äôt automatically create additional continuations, I simply create a new cell, write #, and let Copilot respond ‚Äì letting it predict what I might want to ask!</p><p>In this case, it completes the comment with ‚Äúpredict the toxicity of a new text‚Äù...</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753412c19c031b8109fe_1z5I4GtBCbGNb6hDI0rOY_lBLUM_xhNiHnlo1UrytpKwiwHCxqdts78Z91AdonBAi2np5jpz0sW02_WBYlxRyX89KVLeWD6USqEaIwEwCMppqJ9OLb7CYuh2gPUSCSpjlW8o3jPI.png" alt=""/></p></figure><p>‚Ä¶which it then continues with the following.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7534c72c16d3f9aafc6f_Py1C087nZKmBowiVhFL75qNusyu5_fLYAsc2CA76DLwsC_X1ZLkJnzpbP4v3V0vktMs9wuaIPmr3zCbzL4z_hA0bbfTsxOprcxjAroMOdWp2r3nCgV175J7Ld06R2FkBwwU3gOaQ.png" alt=""/></p></figure><p>Unfortunately for <a href="https://en.wikipedia.org/wiki/Liar_paradox">paradoxes</a>, our classifier predicts it correctly!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753541d11e81cc607379_qHBNKFRuxvfdHxQr1nSPPRuO2bwNONYhMCQ16Ow9K4fefXOS1pfWWjbCnRIbophYx-KIcmvAcA1M96IeTjGOFf2yonVhUiPrfDnFOGXcL536YrAwn131FBhOOB0s3briSDLAJig1.png" alt=""/></p></figure><p>Can we also get Copilot to create some test cases for us to try?</p><p>Unfortunately, it doesn‚Äôt do a very good job‚Ä¶</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7535a94f847477f85745_JY0K7WyLXtRhIxa4G78A7p4-Ok7d2pX_ghZQXwvGmHXf5e4iViwz3qAxux6w1l3EobY3yGExKORLaMZQ_ZhXLdCCqF7RxTsd5fihByzqCQMfeXe-rojnJI-OEQiHAPtf5sngLCy4.png" alt=""/></p></figure><p>‚Ä¶so we‚Äôll give it some examples. When generating the array, it even creates the ideal variable name and escapes the quotations.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7535600b5e32befd5842_M7R1mL_-VcLbjg96o1yEY8Ev_b48eMpXJ1cDKLOnPmJvQffpRHq1qWl0KEX1cXTyOIaf4An6gp-aB61QiNM94wu-DXJLJCkViFnYjVAJVLg7bK_j6Ye5MVKldGLUipQbDGzDSpqD.png" alt=""/></p></figure><p>Let‚Äôs test it out. Even though I had a typo in my instructions, it gets them all right!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75354db6755c7712906c_KZcvMxTlAFvZfDGQ8XYa2OQ_FyAj87q2sj8-7PG46oNhwS64AXokxYxOKQ7rBrPHvnALwVvoqROeB4qLe5SkyEwNC2rzfPDJTEXmgYkl9jgUt53Y41Z-gEEjKvS8GaaP_tBH0Uy8.png" alt=""/></p></figure><p>Let‚Äôs test it on non-toxic comments too.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753586ef29becb88509a_JhHCNt91HpCadRkLMxAY-3-95xU9ELQDNMF_OuqlEk3jctr7iwGOwxWyzlivy3jL_qA3mjHn0h7VetHFL1Q96I4peCAOjb9j_dBvIigmUSzW2l67CIxep31tpwPO--SK4AXX-897.png" alt=""/></p></figure><p>Of course, we should measure how the model performs on a holdout test set, so we‚Äôll ask Copilot to split the original dataset into training and test.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75356a7c6a17d907204d_Y7ykII-y1OnwAR_ij-qE9tGLoxNZiBTbM5ZDNFoLczdwFPApMtsVEDCCvbHmGP9YcnCVmOMBO9BB8YU4LHsqGhkENACZV4ZBozhILa5H349do3wGqlwRGDTtMGd4qBWCa2j0MjQW.png" alt=""/></p></figure><p>It continues with the following (after we create new cells and begin them with an empty comment)!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7535227b76644025e392_mx58vUxWOPP2WgM3MHacTUBryZcOcg31Sz0ImegOj0SGPXbZ6l4Etzd2o6t72Ugu6lCIYQlb-G-oIKMtHqNgMkx4-xT-w6mdqSQiN4J5pmcu-wRQYfnOmi1R7KvjqGnB_B_i02MK.png" alt=""/></p></figure><p>Let‚Äôs ask Copilot how well the model performs.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75353dec76de1eeacafb__rcK8yXkFEmv_LjwMbWVJksW9gZUIjWiurHIu5So69JhQW3lVDX6Zi09YDDzRBxDPGIc1VCn-rIG43avIws9NIGQhSNOkHbeJlnRPj4W6NKfc-fYaxGt-uuZ_5MJ6F4vUbfCDYcq.png" alt=""/></p></figure><p>It even automatically suggests printing a classification report next!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7535a01bdd93c5d3982a__6n5I37kLetkJL0Fayi4YUbxyZfOYYLqV_Zo_sugqdtxRTvBLbC-TKLc8ieG9J4WBW1WYMh3gQIZ-CVlPYABxdOGFLiRvMKqCCGkr37k8j5keUqtrl_UYsaFasVawgBUBI2D6dot.png" alt=""/></p></figure><p>Can we ask Copilot to plot a precision-recall curve?</p><p>Unfortunately, its first attempt fails:</p><p>‚Äç</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753641d11ec06160737b_UmyxY-NpiKOPbtQ4qT5F7RW_QOE0OWglryvYenS3j0sMORXbxlFeHGCm5LX0pl228XL1mjf9fSqbZ6yVt29KgyJwGnoB22jHYfgep8qJgz1924yIw4ZoowIlNA_VTQG1JSjiI0ri.png" alt=""/></p></figure><p>One interesting way around this: OpenAI and Google have been developing research systems where they <a href="https://openai.com/blog/webgpt/">give AI models access to search engines</a> so that they can gather information by browsing the web. What if Copilot could search for the error string, discover a relevant StackOverflow solution, and use that to fix itself?!</p><p>In the meantime, it seems like the error has something to do with the fact that y_test and y_prod are arrays of strings (‚ÄúToxic‚Äù, ‚ÄúNot Toxic‚Äù), so let‚Äôs try binarizing them.</p><p>Our first command leads to buggy code:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7536c72c162f24aafc79_lZqN074xQzkXNLW-0oGTi3Ay4FGX_5_skNnnuzTEsWsKiJCtDERBW2Nz1cue9OjEWnO6NX4q2DNtodu7iJhlpavSB3I9W2KH4TkA5MowQQzN_tidHN6TIBKRW4EULfsVu3JRby-l.png" alt=""/></p></figure><p>But once again, after we make our instruction more detailed, it gets much better!</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b7536b16f330c064baabe_hT1QpzWekU6t99-VlYJV964x6lNRc7YgoU0rDUG4Aj5hEzVG95QC-KQZ4qkqIdM64m1nkhOLoPk6DSQAnu8H1uii5doHuhFrHXc0iqf7K4Ytz8YRY53lcZ_HnZMFDKdgOB9IbslU.png" alt=""/></p></figure><p>Let‚Äôs also regenerate our predictions:</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b753628f79c41904bc594_RdyP-TGyLv6EwQjCaFd_4mY60SKyZSS-icMMDUmS_RGgwpUhF_qYGhK324IlxmNf3dhVvBam94QBwEpwikvuaoanXgDtCJPfYtFFHRxKI4fi2Eo5wtgzSsHWUFPAApyDf5mfqxJ2.png" alt=""/></p></figure><p>And ask Copilot to create a precision-recall curve.</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75365a47a775e4cea29a_rw1d4GK4wsKe7uDS_oFfYXOhxK4gscvSdgEnKZ6A-JPvtLCY-m3ovqisxH2F0gOZXcgZEs7FArG1XxKqpkr4DY4WvMr8_7s-COisagfx53YNqE4XGg_phqLhMWwqRC9b92Uj9Oko.png" alt=""/></p></figure><p>‚Äç</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623b75368547e4561d34cd59_8xtgCmw5_3KKVqFWFns-TYprLq8SR0VfX6vBw54mdWJAnEuO7a6XNCy8kdY9w03WG0yUzQGpZQm4koUWFmv8NKpvIaR-ppVMRvjVfPQ0IPW-zvkZN_eC-_6CbAj8p4kqAyICySOU.png" alt=""/></p></figure><p>Once again, let‚Äôs try prettying it up‚Ä¶</p><figure><p><img src="https://assets.website-files.com/610770ea9c21ff57ccb6a6a9/623c1636b9b5cd84a069e6b2_CleanShot%202022-03-23%20at%2023.56.08%402x.png" loading="lazy" alt=""/></p></figure><p>Tufte couldn&#39;t have done it better himself.</p></div></div>
  </body>
</html>
