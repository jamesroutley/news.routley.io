<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.copetti.org/writings/consoles/playstation-3">Original</a>
    <h1>PlayStation 3 Architecture (2021)</h1>
    
    <div id="readability-page-1" class="page"><article><h2 id="imagery">Supporting imagery</h2><section><ul><li><a href="#cover-model">Model</a></li><li><a href="#cover-motherboard">Motherboard</a></li><li><a href="#cover-diagram">Diagram</a></li></ul><div><h3>Model</h3><div id="cover-model"><ul><li><a href="#cover-model-original">Original</a></li><li><a href="#cover-model-slim">Slim</a></li><li><a href="#cover-model-super-slim">Super Slim</a></li></ul><figure id="cover-model-original"><a href="https://www.copetti.org/images/consoles/ps3/original.ef1da38ba374252ffbad5d6c30133170973f1acb33b542ff36f2f525a8d4ef3d.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/original.ef1da38ba374252ffbad5d6c30133170973f1acb33b542ff36f2f525a8d4ef3d_hu_274155d21a3ff182.webp 500w,
https://www.copetti.org/images/consoles/ps3/original.ef1da38ba374252ffbad5d6c30133170973f1acb33b542ff36f2f525a8d4ef3d_hu_7fadc43430bffeb9.webp 800w,
https://www.copetti.org/images/consoles/ps3/original.ef1da38ba374252ffbad5d6c30133170973f1acb33b542ff36f2f525a8d4ef3d_hu_6d6892392d2643ef.webp 1111w"/><img alt="Original" width="1111" height="445" src="https://www.copetti.org/images/consoles/ps3/original.ef1da38ba374252ffbad5d6c30133170973f1acb33b542ff36f2f525a8d4ef3d.png"/></picture></a><figcaption>The original PlayStation 3 or &#39;PS3&#39;.</figcaption></figure><figure id="cover-model-slim"><a href="https://www.copetti.org/images/consoles/ps3/slim.fa022a6fc255e5d17882988d6bbb62f55c7874570b8206da08e073eeb1b247cb.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/slim.fa022a6fc255e5d17882988d6bbb62f55c7874570b8206da08e073eeb1b247cb_hu_60f84b14d663e2fc.webp 500w,
https://www.copetti.org/images/consoles/ps3/slim.fa022a6fc255e5d17882988d6bbb62f55c7874570b8206da08e073eeb1b247cb_hu_cc1818ade1737828.webp 800w,
https://www.copetti.org/images/consoles/ps3/slim.fa022a6fc255e5d17882988d6bbb62f55c7874570b8206da08e073eeb1b247cb_hu_b2d158018552cb02.webp 1111w"/><img alt="Slim" width="1111" height="463" src="https://www.copetti.org/images/consoles/ps3/slim.fa022a6fc255e5d17882988d6bbb62f55c7874570b8206da08e073eeb1b247cb.png" loading="lazy"/></picture></a><figcaption>The PS3 2000/3000 series (a.k.a. &#39;Slim&#39;).</figcaption></figure><figure id="cover-model-super-slim"><a href="https://www.copetti.org/images/consoles/ps3/super-slim.936d096657935b85e08a984cddea792ff08add84ac2eef5bfd3a53a9fe91e204.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/super-slim.936d096657935b85e08a984cddea792ff08add84ac2eef5bfd3a53a9fe91e204_hu_caa848128e8dfe41.webp 500w,
https://www.copetti.org/images/consoles/ps3/super-slim.936d096657935b85e08a984cddea792ff08add84ac2eef5bfd3a53a9fe91e204_hu_30a52dea35a12539.webp 800w,
https://www.copetti.org/images/consoles/ps3/super-slim.936d096657935b85e08a984cddea792ff08add84ac2eef5bfd3a53a9fe91e204_hu_aab139827c922011.webp 1111w"/><img alt="Super Slim" width="1111" height="418" src="https://www.copetti.org/images/consoles/ps3/super-slim.936d096657935b85e08a984cddea792ff08add84ac2eef5bfd3a53a9fe91e204.png" loading="lazy"/></picture></a><figcaption>The PS3 4000 series (a.k.a. &#39;Super Slim&#39;).</figcaption></figure></div><h3>Motherboard</h3><figure id="cover-motherboard"></figure><h3>Diagram</h3><figure id="cover-diagram"><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/main.f552c7ca68a50c45b2f986d26f95e1ea6e8b942f8e4e2c013f7deb2ab77c4b01.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/main.f552c7ca68a50c45b2f986d26f95e1ea6e8b942f8e4e2c013f7deb2ab77c4b01_hu_249f329b4fed1dea.webp 500w,
https://www.copetti.org/images/consoles/ps3/_diagrams/main.f552c7ca68a50c45b2f986d26f95e1ea6e8b942f8e4e2c013f7deb2ab77c4b01_hu_8cd5a4ee0680074a.webp 800w,
https://www.copetti.org/images/consoles/ps3/_diagrams/main.f552c7ca68a50c45b2f986d26f95e1ea6e8b942f8e4e2c013f7deb2ab77c4b01_hu_cb9f176c4ea0d6bf.webp 1435w"/><img alt="Diagram" width="1435" height="965" src="https://www.copetti.org/images/consoles/ps3/_diagrams/main.f552c7ca68a50c45b2f986d26f95e1ea6e8b942f8e4e2c013f7deb2ab77c4b01.png" loading="lazy"/></picture></a><figcaption>Main architecture diagram</figcaption></figure></div></section><hr/><h2 id="a-quick-introduction">A quick introduction</h2><p>In 2006, Sony unveiled the long-awaited ‘next generation’ video game console, a shiny (albeit heavy) machine whose underlying hardware architecture continues the teachings of the <a href="https://www.copetti.org/writings/consoles/playstation-2/">Emotion Engine</a>, that is, focus on vector processing to maximise performance, even at the cost of complexity. Meanwhile, their new ‘super processor’, the Cell Broadband Engine, is conceived during a crisis of innovation and will have to keep up as trends for multimedia services evolve.</p><p>This write-up takes a deep look at Sony, IBM, Toshiba and Nvidia’s joint project, along with its execution and effect on the industry.</p><h3 id="on-the-articles-length">On the article’s length</h3><p>I’m afraid this article is not the typical ‘lunchtime’ one that I usually write for other consoles in <a href="https://www.copetti.org/writings/consoles/">this series</a>. If you are interested in every area of the PlayStation 3, you are in for the whole journey! Having said that, this writing encompasses ~6 years of research and development carried out by countless engineers, so I don’t expect you to digest it all at once. Please take your time (and breaks if needed) and if at the end you are hungry for more, help yourself at the ‘Sources’ section!</p><hr/><h2 id="cpu">CPU</h2><p>Welcome to the most recognisable and innovative part of this console.</p><h3 id="introduction">Introduction</h3><p>The PS3’s CPU is massively complex, but it’s also a very fascinating work of engineering that intersects complex needs and unusual solutions, prominent in an era of change and experimentation. So, before we step into the internals of the PS3’s CPU, I wrote the following paragraphs to bring some historical context into the article. That way, we’ll be able to decompose the chip from top to bottom in a way that not only you will understand how this chip works, but also get the reasoning behind major design decisions.</p><div><ul><li id="tab-1-1-the-state-of-progress-link"><a href="#tab-1-1-the-state-of-progress">The state of progress</a></li><li id="tab-1-2-new-design-philosophies-link"><a href="#tab-1-2-new-design-philosophies">New design philosophies</a></li><li id="tab-1-3-a-new-multicore-era-link"><a href="#tab-1-3-a-new-multicore-era">A new multicore era</a></li></ul><div><div id="tab-1-1-the-state-of-progress"><h4 id="tab-1-1-the-state-of-progress">The state of progress</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ps1.c337398157c7ba32a604bc3c28e222f052190b3f79129e07e89c7bb22cdf4b9f.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ps1.c337398157c7ba32a604bc3c28e222f052190b3f79129e07e89c7bb22cdf4b9f.webp"/><img alt="Image" width="714" height="481" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ps1.c337398157c7ba32a604bc3c28e222f052190b3f79129e07e89c7bb22cdf4b9f_hu_d52b6c9279dca726.png" loading="lazy"/></picture></a><figcaption>The PS1’s CPU (1994). Designed by LSI and Sony, using MIPS’ technology.</figcaption></figure><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ee.542f2a97512596c474aa5c0b3793b8c7719d77991766e2a89cb084a075360156.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ee.542f2a97512596c474aa5c0b3793b8c7719d77991766e2a89cb084a075360156.webp"/><img alt="Image" width="839" height="449" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ee.542f2a97512596c474aa5c0b3793b8c7719d77991766e2a89cb084a075360156_hu_be38be6f12c540b9.png" loading="lazy"/></picture></a><figcaption>The PS2’s Emotion Engine (2001). Designed by Toshiba, with MIPS’ technology, again.</figcaption></figure><p>Almost ten years after the introduction of the <a href="https://www.copetti.org/writings/consoles/playstation/">original MIPS-powered PlayStation</a>, we find ourselves in the early noughties, and things are not looking good for SGI/MIPS. Nintendo recently ditched them for a <a href="https://www.copetti.org/writings/consoles/gamecube/#cpu">low-end PowerPC core</a> with IBM as their new supplier while Microsoft, the newcomer in this market, <a href="https://www.copetti.org/writings/consoles/xbox/#cpu">chose Intel</a> and their x86 empire.</p><p>Sony has a history of grabbing existing low-end designs (cheap MIPS cores) and moulding them to achieve acceptable 3D performance at a reduced cost, a process that involved other companies like LSI (for the <a href="https://www.copetti.org/writings/consoles/playstation/#cpu">PS1’s CPU</a>) and Toshiba (for the PS2’s <a href="https://www.copetti.org/writings/consoles/playstation-2/#cpu">Emotion Engine</a>). This methodology carried on until 2004 with the release of the <a href="https://www.copetti.org/writings/consoles/playstation-portable/">PlayStation Portable</a>. So, what new MIPS amalgamate were they going to build for the PlayStation 3?</p><p>Well, it turns out the development of the PlayStation 3 predates the PlayStation Portable one <sup id="bibref:1"><a href="#bib:cpu-koranne" role="doc-biblioref">[1]</a></sup>. In 2000, months after the PS2’s release, Sony formed an alliance with IBM and Toshiba called ‘STI’ with the sole goal to deliver the next chip that could power the next generation of supercomputers <sup id="bibref:2"><a href="#bib:cpu-engine" role="doc-biblioref">[2]</a></sup>. If this didn’t sound extravagant enough, the next chip would also be used on the successor of the PS2. In the end, in 2004, IBM unveiled the <strong>Cell Broadband Engine</strong> (also known as ‘Cell BE’ or just ‘Cell’) <sup id="bibref:3"><a href="#bib:cpu-nbc_cell" role="doc-biblioref">[3]</a></sup>.</p></div><div id="tab-1-2-new-design-philosophies"><h4 id="tab-1-2-new-design-philosophies">New design philosophies</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/cell.9094ea980b502e7aa8d2fdf9dce0c487a6687892dfa6e41dd42c723d7f092e3d.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/cell.9094ea980b502e7aa8d2fdf9dce0c487a6687892dfa6e41dd42c723d7f092e3d_hu_a59fdc413afed9bb.webp 500w,
https://www.copetti.org/images/consoles/ps3/cell.9094ea980b502e7aa8d2fdf9dce0c487a6687892dfa6e41dd42c723d7f092e3d_hu_b60abfe09839ef77.webp 800w,
https://www.copetti.org/images/consoles/ps3/cell.9094ea980b502e7aa8d2fdf9dce0c487a6687892dfa6e41dd42c723d7f092e3d_hu_874d4d0623bf5a71.webp 900w"/><img alt="Image" width="900" height="675" src="https://www.copetti.org/images/consoles/ps3/cell.9094ea980b502e7aa8d2fdf9dce0c487a6687892dfa6e41dd42c723d7f092e3d.jpg" loading="lazy"/></picture></a><figcaption>The Cell Broadband Engine chip. Unfortunately too shiny for my camera.</figcaption></figure><p>To understand Cell’s <em>radical</em> proposal, we must first take into account the problems affecting that era (late 90s-early 00s).</p><p>Every year, consumers ask for more speed. That’s always been the case. However, the last approach used to solve that (<a href="https://www.copetti.org/writings/consoles/xbox/#tab-1-4-cisc-or-risc">pipeline the datapath</a> and step up the clock frequency) is now failing to scale. Intel’s NetBurst <a href="https://www.copetti.org/writings/consoles/xbox/#p6-and-the-end-of-pentium-numbers">can’t evolve any further</a> and its promised successor is nowhere to be seen. Similarly, IBM’s PowerPC 970/G5 can’t deliver its ‘3 GHz’ promise nor their low-power CPU (hence Apple can’t ship any laptop carrying their last-gen CPU) <sup id="bibref:4"><a href="#bib:cpu-no5g" role="doc-biblioref">[4]</a></sup>. All in all, it looks like engineers have a new <a href="https://www.copetti.org/writings/consoles/playstation/#tab-1-1-a-bit-of-history">scalability crisis</a> on their hands.</p><p>So, the focus turns to <strong>distributed computing</strong> <sup id="bibref:5"><a href="#bib:cpu-mit" role="doc-biblioref">[5]</a></sup>. In other words, why obsess with cranking up the performance of a single machine where you could instead have multiple smaller machines distributing their workload? Conversely, this approach is anything but new, considering all of the consoles analysed on this website contain more than one processor. However, it’s the development of a ‘single processor with multiple cores’ that opens up new opportunities for CPU design (which are not necessarily limited to the console market).</p><p>Consequently, Cell is part of this new wave of research and development. This new CPU combines a multi-core design with a special focus on vector processing. If you remember, vector computing is optimal for simulations (physics, lighting, etc) and it was previously materialised in the form of the <a href="https://www.copetti.org/writings/consoles/playstation/#tab-2-2-geometry-transformation-engine">Geometry Transformation Engine</a> or the <a href="https://www.copetti.org/writings/consoles/playstation-2/#co-cpus">Vector Units</a>, but you’ll soon see why Cell’s design is a huge step forward from the previous two.</p></div><div id="tab-1-3-a-new-multicore-era"><h4 id="tab-1-3-a-new-multicore-era">A new multicore era</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/heterogeneous.ff1b5df19357c1c8f679f0ffaa449a547256d802a166cbccf93a0391b1c159ff.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/heterogeneous.ff1b5df19357c1c8f679f0ffaa449a547256d802a166cbccf93a0391b1c159ff.webp"/><img alt="Image" width="833" height="402" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/heterogeneous.ff1b5df19357c1c8f679f0ffaa449a547256d802a166cbccf93a0391b1c159ff_hu_ddec25a507a376ec.png" loading="lazy"/></picture></a><figcaption>Example of heterogeneous design.</figcaption></figure><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/homogeneous.1068fc92306cb93c84f829d036c91f3aacee99d72af0265b1f4404804983b8cb.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/homogeneous.1068fc92306cb93c84f829d036c91f3aacee99d72af0265b1f4404804983b8cb.webp"/><img alt="Image" width="833" height="402" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/paradigm/homogeneous.1068fc92306cb93c84f829d036c91f3aacee99d72af0265b1f4404804983b8cb_hu_1064aaaf4d221583.png" loading="lazy"/></picture></a><figcaption>Example of homogeneous design.</figcaption></figure><p>If you stop to think about it, both the PS1’s CPU and the Emotion Engine were already multi-core processors. So why was there so much fanfare about Cell? Well, the previous two chips were composed of one general-purpose core and several application-specific cores (i.e. audio processor, image decompression, etc) mixing different architectures, where the general-purpose core is in charge of commanding the others.</p><p>This type of CPU design is called <strong>Heterogeneous computing</strong> and it’s been the de-facto choice for building machines that are specialised in a particular set of applications (gaming, in this case). Its counterpart, <strong>Homogeneous computing</strong>, is more predominant on the PC market, where CPUs are required to perform a wider range of tasks (and they all have the same priority). Hence, the latter type may house multiple cores, but of the same type.</p><p>Back on topic, <strong>Cell combines both models</strong>: there are two types of cores in this CPU, <strong>one general-purpose ‘leader’ and eight vector ‘assistants’</strong>. These vector cores may take up various roles, and in doing so, they fulfil previous tasks that were originally solved by heterogeneous designs, but since Cell’s vectors are not limited to a single type of task, their cores provide the flexibility of homogeneous computers. All in all, this design is not perfect and will inherit some compromises, but throughout this writing, you’ll see the different problems that Cell will attempt to solve and how did it manage to do so.</p></div></div></div><h3 id="a-glance-at-cell">A glance at Cell</h3><p>Having explained all that history and theory, I think we are ready to bring forward the protagonist of this section. This is Cell …</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/cell.579b69c3a49b45e7a2784a3daae110b970a758a142f8f3246d8c1e8fca3fa0e1.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/cell.579b69c3a49b45e7a2784a3daae110b970a758a142f8f3246d8c1e8fca3fa0e1.webp"/><img alt="Image" width="626" height="510" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/cell.579b69c3a49b45e7a2784a3daae110b970a758a142f8f3246d8c1e8fca3fa0e1_hu_db23f04fd4152487.png" loading="lazy"/></picture></a><figcaption>The Cell Broadband Engine (PS3 variant).</figcaption></figure><p>… and by the end of this section, you’ll know what each component does.</p><h4 id="overall-structure">Overall structure</h4><p>Cell runs at a <em>mighty</em> <strong>3.2 GHz</strong> and it’s composed of a multitude of components. So, for the sake of this analysis, this CPU can be divided into three main areas <sup id="bibref:6"><a href="#bib:cpu-architecture" role="doc-biblioref">[6]</a></sup>:</p><ul><li>The <strong>leader</strong>: this is the part of Cell that directs the rest of the circuitry. Here we find a component called <strong>PowerPC Processing Element</strong> (PPE).</li><li>The <strong>assistants</strong>: these are as crucial as the PPE, but their capabilities are limited to an assistant/accelerator role. This group comprises eight <strong>Synergistic Processing Elements</strong> (SPEs).</li><li>The <strong>interfaces</strong>: As the need for bandwidth surges exponentially, newer interfaces are implemented to move data around without producing bottlenecks. In the interfaces group, we find a handful of protocols: the <strong>Element Interconnect Bus</strong> (EIB), the <strong>Broadband Engine Interface Unit</strong> (BEI), the <strong>Memory Interface Controller</strong> (MIC) and the <strong>Flex I/O buses</strong>.</li></ul><p>This information will be revisited throughout the article in more depth, so you don’t have to memorise these names. The main goal of this section is to let the reader get a mental image of the nature of Cell and familiarise with all the components we’ll be discussing in due time.</p><h4 id="how-this-study-is-organised">How this study is organised</h4><p>Seeing the previous structure, I had to organise this so you don’t get fed up with lots of information. Thus, we are going to analyse Cell by studying each component in this order:</p><ol><li>The bus connecting all components, the <strong>Element Interconnect Bus (EIB)</strong>.</li><li>The <strong>PowerPC Processing Element (PPE)</strong> and its core element, the <strong>PowerPC Processing Unit (PPU)</strong>.</li><li>What <strong>general-purpose memory</strong> is available in this console.</li><li>The <strong>Synergistic Processing Elements (SPE)</strong> and their core element, the <strong>Synergistic Processing Unit (SPU)</strong>.</li><li>The <strong>programming model</strong> devised to program Cell efficiently.</li></ol><p>That being said, let’s begin the real analysis.</p><h3 id="inside-cell-the-heart">Inside Cell: The heart</h3><p>Since its announcement, Cell has been referred to as a <strong>Network-on-Chip</strong> (NoC) <sup id="bibref:7"><a href="#bib:cpu-koranne" role="doc-biblioref">[7]</a></sup> instead of traditional the System-on-Chip (SoC) definition, this is attributed to Cell’s unorthodox data bus, the <strong>Element Interconnect Bus</strong> (EIB). <a href="https://www.copetti.org/writings/consoles/playstation-2/#a-recognisable-memory-choice">We’ve seen</a> so far how demanding CPU components can be, in addition to how <a href="https://www.copetti.org/writings/consoles/nintendo-64/#tab-3-1-pipeline-stalls">susceptible</a> a system is to bottlenecks. Well, to tackle this for the eleventh time, IBM has devised a new design… and has documented it using terms analogous to <em>road driving</em>.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/eib.087692d843c4316a01ec665080abe20cd26c9bcadb52ce1127c5fb0b035d9300.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/eib.087692d843c4316a01ec665080abe20cd26c9bcadb52ce1127c5fb0b035d9300.webp"/><img alt="Image" width="943" height="653" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/eib.087692d843c4316a01ec665080abe20cd26c9bcadb52ce1127c5fb0b035d9300_hu_3c6254805e69716.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the Element Interconnect Bus (EIB).</figcaption></figure><p>The EIB is made of twelve nodes called <strong>Ramps</strong>, each one connecting one component of Cell. Ramps are interconnected using four buses, two of them travel <strong>clockwise</strong> and the other two do so <strong>anti-clockwise</strong>. Each bus (or <strong>channel</strong>) is 128-bit wide. Having said that, instead of recurring to single bus topologies (like the Emotion Engine and its precursor did), ramps are inter-connected following the <strong>token ring</strong> topology, where data packets must cross through all neighbours until it reaches the destination (there’s no direct path). Considering the EIB provides four channels, there’re four possible routes (<strong>rings</strong>).</p><p>Now, you may think, what’s the point of a token ring if data may end up travelling longer paths (compared to a single direct bus)? Well, a single bus is highly susceptible to <a href="https://www.copetti.org/writings/consoles/playstation-2/#a-recognisable-memory-choice">congestion</a>. Hence, EIB’s engineers decided on this topology to tackle large amounts of concurrent traffic (keep reading if you want to know how the token ring helped).</p><p>Data is transferred in the form of <strong>128-bit packets</strong> <sup id="bibref:8"><a href="#bib:cpu-cell_arch" role="doc-biblioref">[8]</a></sup>. Each ring can carry up to <strong>three concurrent transfers</strong> as long as the packets don’t overlap. The EIB operates with the use of <strong>command credits</strong>, in other words, whenever a component needs to initiate a transfer, it sends a request to the EIB’s <strong>Data Arbiter</strong>, which manages the traffic within the rings. The moment the request is approved, packets enter the ring and receive a ‘token’, which the data arbiter uses as meta-data to supervise the transfer. Moreover, some components have preferential priority over others, like the <strong>Memory Interface Controller</strong> (MIC) component, which is where main RAM is located. Finally, the data arbiter will never place packets at rings whose path is longer than half of the ring.</p><p>Each ramp plays a part in the transfer, they read the destination address of the packet to know whether to post data to their respective component or forward it to the next Ramp. During each clock cycle, ramps can receive and send 128-bit (16 Bytes) packets at the same time. So, considering there are four channels and the <strong>EIB operates at 1.6 GHz</strong> (half of Cell’s speed), the theoretical maximum transfer rate is <code>16 Bytes x 2 transfer/clock x 4 rings x 1.6 GHz = 204.8 GB/s</code>, this value is of course too optimistic and there are many other external factors (i.e. origin/destination path, state of the bus, etc.) conditioning the performance. In any case, many research papers made by IBM and other authors compiled more realistic speeds using practical experiments <sup id="bibref:9"><a href="#bib:cpu-hpc" role="doc-biblioref">[9]</a></sup>.</p><p>Now that you’ve seen how every component of Cell is interconnected, it’s time to check out the first component of this chip…</p><h3 id="inside-cell-the-leader">Inside Cell: The leader</h3><p>Here we will take a look at the ‘main part’ of Cell. That is the part of the silicon that is in charge of commanding the rest. The component’s name is <strong>PowerPC Processing Element</strong> (PPE) and you can think of it as the MIPS R5900 of the Emotion Engine.</p><h4 id="composition-of-the-ppe">Composition of the PPE</h4><p>Remember how I divided Cell into different areas before? Well, the same can be done with the PPE. IBM uses the term ‘element’ to describe the independent machine <sup id="bibref:10"><a href="#bib:cpu-arevalo" role="doc-biblioref">[10]</a></sup>, but once inside it uses the term ‘unit’ to separate the core circuitry from the interfaces that communicate with the rest of Cell.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppe.7e33861785c18f91b2da415458dc9c8295d89d9005aff59706e2fab439e80d10.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppe.7e33861785c18f91b2da415458dc9c8295d89d9005aff59706e2fab439e80d10.webp"/><img alt="Image" width="864" height="585" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppe.7e33861785c18f91b2da415458dc9c8295d89d9005aff59706e2fab439e80d10_hu_3dbdd440cfb0c4a7.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the PowerPC Processing Element (PPE).</figcaption></figure><p>Having said that, the PowerPC Processor element is <em>surprisingly</em> composed of two parts:</p><ul><li><strong>PowerPC Processing Unit</strong> (PPU): This is the logical part of the PPE (the ‘core’). Don’t forget this is not Nintendo’s <a href="https://www.copetti.org/writings/consoles/nes/#graphics">PPU</a>! (even though they are sharing the same letters of the Latin alphabet… in the same order…).</li><li><strong>PowerPC Processor Storage Subsystem</strong> (PPSS): The big interface that connects the PPU to the outside world. Furthermore, it provides a whopping <strong>512 KB of L2 cache</strong>.</li></ul><p>As you can see, the design of the PPE (and the rest of Cell) is pretty modular, which follows the teachings of RISC design, you’ll soon see that the modularity is applied even inside the PPU.</p><h4 id="the-powerpc-processing-unit">The PowerPC Processing Unit</h4><p>We are going to take a look at the insides of the PPU just now. To recap, we’ve dived into Cell, then into the PPE, and finally into the PPU. We’ll analyse the PPU just like any other CPU core.</p><div><ul><li id="tab-2-1-a-familiar-architecture-link"><a href="#tab-2-1-a-familiar-architecture">A familiar architecture</a></li><li id="tab-2-2-distinctive-features-link"><a href="#tab-2-2-distinctive-features">Distinctive features</a></li></ul><div><div id="tab-2-1-a-familiar-architecture"><h5 id="tab-2-1-a-familiar-architecture">A familiar architecture</h5><p>To start with, the PPU is not built from the ground up but <strong>re-purposes existing PowerPC technology</strong>. However, unlike <a href="https://www.copetti.org/writings/consoles/gamecube/#the-powerpc-gekko">previous iterations</a> where IBM grabbed an existing processor and half-updated it to meet new requirements, the PPE doesn’t replicate any previous CPU design. Instead, IBM constructed a new CPU that follows version 2.02 of the PowerPC specification (which happens to be the last PowerPC spec before being rebranded to ‘Power ISA’). To sum up, you won’t find the PPU’s design on any existing chip from that time, yet, it’s programmed using the same machine code as other PowerPC chips.</p><p>That being said, why did IBM choose PowerPC technology to develop a high-performance chip? Simple, PowerPC is a mature platform <sup id="bibref:11"><a href="#bib:cpu-koranne" role="doc-biblioref">[11]</a></sup> that enjoyed ~10 years of Macintosh user-base <a href="https://www.copetti.org/writings/consoles/gamecube/#tab-2-2-joining-forces-again">testing and revisioning</a>, it ticks all the boxes in Sony’s list and, if the need arises, it can be adapted to different environments. Last but not least, the use of a well-known architecture is good news for existing compilers and codebases which, for a new console, is a big starting advantage.</p><p>It’s worth mentioning that IBM was one of the authors of the first PowerPC chips, along with Motorola and Apple (recall the <a href="https://www.copetti.org/writings/consoles/gamecube/#tab-1-2-reaching-the-average-user">AIM alliance</a>). Be as it may, towards the early 00s, the so-called alliance members were already <a href="https://www.copetti.org/writings/consoles/gamecube/#tab-2-3-the-band-splits-for-good">working separately</a>, where Motorola/Freescale developed a different PowerPC series from IBM.</p></div><div id="tab-2-2-distinctive-features"><h5 id="tab-2-2-distinctive-features">Distinctive features</h5><p>The PPU shares some history with the PowerPC 970 (called <em>G5</em> by Apple), both are descendants of POWER4, a PowerPC predecessor mainly used in workstations and supercomputers. This will become more evident when I show you the modularised execution units soon. This is a radical change compared to the GameCube’s <a href="https://www.copetti.org/writings/consoles/gamecube/#the-powerpc-gekko">750-line CPU</a>, which had considerable input from Motorola but was then slightly modified by IBM.</p><p>Back on topic, the PPU is a <strong>complete 64-bit processor</strong>. This means:</p><ul><li>The size of a word is <strong>64-bits</strong>.</li><li>There are <strong>64-bit general-purpose registers</strong> (32 to be exact).</li><li>The data-bus is <em>at least</em> 64-bit wide: in the next sections of the article, you’ll see it’s <strong>much wider</strong> than that, but for now, keep in mind that transferring 64-bit words <strong>won’t penalise performance</strong>.</li><li>The address bus is 64-bit wide: in theory, the CPU can access up to <strong>16 exabytes of memory</strong>. Now, in practice, this is very costly if the machine doesn’t house all that memory. So, modern CPUs delegate addressing to the Memory Management Unit (MMU) to provide more uses to the address bus.</li></ul><p>Finally, the PPU implements the <strong>PowerPC ISA version 2.02</strong>, including optional opcodes for floating-point square root <sup id="bibref:12"><a href="#bib:cpu-prog_tut" role="doc-biblioref">[12]</a></sup>. It’s also been extended with a group of SIMD instructions called <strong>Vector/SIMD Multimedia Extension</strong> (VMX). On the other side, some elements are missing from the original specification, such little-endian mode (in fact, Cell only operates in big-endian) and just a handful of opcodes.</p></div></div></div><h4 id="ppus-building-blocks">PPU’s building blocks</h4><p>By applying a ‘microscopic’ view to the PPU, we can observe this unit is composed of different blocks or sub-units which perform independent operations (load values from memory, carry out arithmetic, etc). The capabilities of the PPU are defined by what each block can do and how:</p><div><ul><li id="tab-3-1-instructions-link"><a href="#tab-3-1-instructions">Instructions</a></li><li id="tab-3-2-memory-management-link"><a href="#tab-3-2-memory-management">Memory management</a></li><li id="tab-3-3-arithmetic-link"><a href="#tab-3-3-arithmetic">Arithmetic</a></li></ul><div><div id="tab-3-1-instructions"><h5 id="tab-3-1-instructions">Instructions</h5><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/iu.cfde70e209e872f0f264e351166d3858da4e7776935f31c099b04c27d1556de3.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/iu.cfde70e209e872f0f264e351166d3858da4e7776935f31c099b04c27d1556de3.webp"/><img alt="Image" width="547" height="607" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/iu.cfde70e209e872f0f264e351166d3858da4e7776935f31c099b04c27d1556de3_hu_3b201087694ce7fc.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the Instruction Unit (IU).</figcaption></figure><p>The first block is called <strong>Instruction Unit</strong> (IU) and as its name suggests, it pulls instructions from L2 cache and signals other units to perform the requested operation. Like its <a href="https://www.copetti.org/writings/consoles/xbox/#cpu">i686 contemporaries</a>, part of the instruction set is interpreted with the use of <a href="https://www.copetti.org/writings/consoles/nintendo-64/#tab-1-1-reality-signal-processor">microcode</a> (the IU embeds a small ROM for this purpose). Lastly, the IU also houses <strong>32 KB of L1 cache for instructions</strong>.</p><p>Instruction issuing is carried out with a <strong>12-stage pipeline</strong>, though in practice the total number of stages will greatly vary depending on the type of instruction. For instance, the <strong>branch prediction</strong> block may bypass great parts. If we combine the IU with the neighbour units, the final number of stages is often <strong>close to 24</strong> (yes, it’s a big number, but remember Cell runs at 3.2 GHz).</p><p>Now for the interesting parts, The IU is <strong>dual-issued</strong>: in some cases, the IU will dispatch up to two instructions at the same time, consequently improving throughput greatly. In practice, however, there are many conditions for this to work, so programmers/compilers are responsible for optimising their routines so their sequence of instructions can take advantage of this function. By the way, dual-issuing has been implemented by <a href="https://www.copetti.org/writings/consoles/gamecube/#the-powerpc-gekko">previous CPUs</a> as well, and the term varies between vendors, so here I used IBM’s definition.</p><p>Furthermore, to top it off, the IU is also <strong>multi-threaded</strong>, where the unit can execute two different sequences of instructions (called ‘threads’) at the same time. Behind the scenes, the IU is just alternating between the two threads at each cycle, giving the appearance of multi-threading. This technique is historically known as <strong>Simultaneous Multi-Threading</strong> (SMT) or <em>hyper-threading</em>, as Intel later coined. Nevertheless, IBM’s multi-threading mitigates unwanted effects like <a href="https://www.copetti.org/writings/consoles/nintendo-64/#tab-3-1-pipeline-stalls">pipeline stalls</a>, since the CPU will no longer be blocked if one instruction jams up the flow. To accomplish multi-threading, IBM engineers duplicated the internal resources of the IU, which includes general-purpose registers (previously I said there are 32 registers available, that’s per thread. In reality, there are 64 in total!), however, resources that don’t belong to the PowerPC specification (such as L1 and L2 cache; and the interfaces) are still shared. Thus, the latter group is single-threaded.</p><p>All in all, combining dual-threading with dual-issuing, the PPU can execute <strong>up to four instructions per cycle</strong>. Even though this is a ‘best-case scenario’, it still provides optimisation opportunities that users will ultimately notice in the game’s frame rate!</p></div><div id="tab-3-2-memory-management"><h5 id="tab-3-2-memory-management">Memory management</h5><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/lsu.918d38bd76e87d7a337f0e16f0eb33fdc0e2f8935bc6504c975ccb964f3e2810.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/lsu.918d38bd76e87d7a337f0e16f0eb33fdc0e2f8935bc6504c975ccb964f3e2810.webp"/><img alt="Image" width="760" height="561" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/lsu.918d38bd76e87d7a337f0e16f0eb33fdc0e2f8935bc6504c975ccb964f3e2810_hu_eeb44ef6daec5785.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the Load-Store Unit (LSU) and its neighbours.</figcaption></figure><p>The following blocks grant the PPU the ability to execute load-store instructions and carry out memory management.</p><p>To begin with, the <strong>Load and Store Unit</strong> (LSU) executes ‘load’ and ‘store’ opcodes backed by <strong>32 KB of L1 data cache</strong>. As a consequence, this unit has direct access to memory and registers.</p><p>Furthermore, the LSU is coupled with <strong>Memory Management Unit</strong> (MMU), which is a common occurrence in nowadays hardware. To make a long story short, the MMU handles memory addressing using a <a href="https://www.copetti.org/writings/consoles/nintendo-64/#memory-management">virtual address map</a> combined with <a href="https://www.copetti.org/writings/consoles/playstation-portable/#focused-memory-management">memory protection</a>. To improve the latter, this MMU in particular features a <strong>segment unit</strong>, which groups memory addresses using ranges called ‘segments’. Now, to prevent performance degradation in the process, a Translation Lookaside Buffer (TLB) (caches converted addresses) and a Segment Lookaside Buffer (SLB) (caches segments) are included.</p></div><div id="tab-3-3-arithmetic"><h5 id="tab-3-3-arithmetic">Arithmetic</h5><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/vsu_fxu.52d380ddf340bf50365cfab1b7347986f593f4e6012261457915a5dd03db6c5e.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/vsu_fxu.52d380ddf340bf50365cfab1b7347986f593f4e6012261457915a5dd03db6c5e.webp"/><img alt="Image" width="896" height="640" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/ppu/vsu_fxu.52d380ddf340bf50365cfab1b7347986f593f4e6012261457915a5dd03db6c5e_hu_fcc4b36b438c10f9.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the units that perform arithmetic.</figcaption></figure><p>There’re only two more units of the PPU left to explain, the ones computing the math any game will need.</p><p>The first one is a traditional <strong>Fixed-Point Integer Unit</strong> (FXU). It carries out integer arithmetic, such as division, multiplication, bit rotation (similar to bit shifting but discarded bits are returned to the other end) and count-leading zero (useful for normalising vertex coordinates, for instance). Its pipeline is 11-stages long.</p><p>If you look at the diagram, you’ll see that the FXU, LSU and MMU are grouped into a single unit called <strong>Execution Unit</strong> (XU), this is because they share the same register file.</p><p>The second unit is way more interesting, the <strong>Vector/Scalar Unit</strong> (VSU) performs operations with floating-point numbers and vectors. It’s made up of a <strong>64-bit FPU</strong> (follows the IEEE 754 standard) and a <strong>Vector/SIMD Multimedia Extension unit</strong> (VXU), which executes a set of SIMD instructions called <em>VMX</em>. The latter operates 128-bit vectors made from sixteen 8-bit values to four 32-bit ones <sup id="bibref:13"><a href="#bib:cpu-arevalo" role="doc-biblioref">[13]</a></sup>. You may have heard about this extension before, as ‘VMX’ is IBM’s name to Motorola’s ‘AltiVec’ or Apple’s ‘Velocity Engine’ (<em>long live trademarks</em>). Conversely, Cell’s competitive SIMD capabilities are found in another processor, so don’t relax just yet!</p></div></div></div><h4 id="wrapping-the-ppe-up">Wrapping the PPE up</h4><p>You’ve just seen how the PPE works and what is made of, but what does it mean for a developer?</p><p>After all, the PowerPC Processing Element is only a general-purpose processor, but here’s the thing: <strong>it’s not meant to work alone</strong>. Remember that wide main bus (the EIB)? IBM designed the PPE so engineers may combine it with other processors to accelerate particular applications (i.e. HPC, 3D graphics, security, scientific simulations, networking, video processing, etc) and since this writing is about the PlayStation 3, you’ll see the rest of Cell is treated with computer graphics and physics in mind, so, the rest of the article reflects that purpose.</p><h3 id="outside-cell-main-memory">Outside Cell: Main Memory</h3><p>Let’s now step out of Cell for a moment, as it doesn’t matter how good the PPE is if we don’t have a proper working space (memory) to put it to work.</p><p>Thus, Sony fitted <strong>256 MB of XDR DRAM</strong> on the motherboard… But, again, <em>what does this mean?</em> To answer that, we need to take a look at how the memory blocks work and how they connect to Cell.</p><div><figure><a href="https://www.copetti.org/images/consoles/ps3/cell_mem.8ac989201645b6ab9a52553dd07c2d89a35e2c2d4a08794fe13e98a7b4f5c961.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/cell_mem.8ac989201645b6ab9a52553dd07c2d89a35e2c2d4a08794fe13e98a7b4f5c961_hu_35e1c2cb6165cfe9.webp 500w,
https://www.copetti.org/images/consoles/ps3/cell_mem.8ac989201645b6ab9a52553dd07c2d89a35e2c2d4a08794fe13e98a7b4f5c961_hu_24c6ac7c9349e337.webp 800w,
https://www.copetti.org/images/consoles/ps3/cell_mem.8ac989201645b6ab9a52553dd07c2d89a35e2c2d4a08794fe13e98a7b4f5c961_hu_1e4bb24ee282c0d5.webp 900w"/><img alt="Image" width="900" height="600" src="https://www.copetti.org/images/consoles/ps3/cell_mem.8ac989201645b6ab9a52553dd07c2d89a35e2c2d4a08794fe13e98a7b4f5c961.jpg" loading="lazy"/></picture></a><figcaption>Cell next to the four 64 MB XDR DRAM chips.</figcaption></figure><p>First of all, the type of memory fitted is called <strong>Extreme Data Rate</strong> (XDR). You may recognise XDR DRAM as the successor of the <em>jinxed</em> <strong>RDRAM</strong> found in the <a href="https://www.copetti.org/writings/consoles/nintendo-64/">Nintendo 64</a> and the <a href="https://www.copetti.org/writings/consoles/playstation-2/#a-recognisable-memory-choice">PlayStation 2</a>. But don’t jump to conclusions just yet!</p><p>Rambus, like any other company, improves upon their inventions. Their third revision (XDR) now operates at octa-rate (four times the rate of its adversary, DDR DRAM) <sup id="bibref:14"><a href="#bib:cpu-xdr" role="doc-biblioref">[14]</a></sup>. Latency doesn’t pose an issue anymore, if we take a look at one of its manufacturers’ data-sheets, XDR’s latency is reported between 28 ns and 36 ns <sup id="bibref:15"><a href="#bib:cpu-k4y5016" role="doc-biblioref">[15]</a></sup>, almost <a href="https://www.copetti.org/writings/consoles/nintendo-64/#memory-design">10 times faster</a> than the first-generation RDRAM chips.</p></div><p>The first revision of the PlayStation 3’s motherboard contains four 64 MB chips, handled in pairs. XDR is connected to Cell using two 32-bit buses, one on each pair. So, whenever the PPU writes a word (64-bit data), it’s split between two XDR chips. The latter are clocked at 400 MHz <sup id="bibref:16"><a href="#bib:cpu-ram" role="doc-biblioref">[16]</a></sup>.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/memory.f17d5f5591e18bdd87c693ecef3c4bdffe0dc40afac3beef7910f00e91dcc5c0.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/memory.f17d5f5591e18bdd87c693ecef3c4bdffe0dc40afac3beef7910f00e91dcc5c0.webp"/><img alt="Image" width="989" height="327" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/memory.f17d5f5591e18bdd87c693ecef3c4bdffe0dc40afac3beef7910f00e91dcc5c0_hu_f50f96846d5df969.png" loading="lazy"/></picture></a><figcaption>Cell’s memory architecture diagram.</figcaption></figure><p>Cell connects to XDR chips is using the <strong>Memory Interface Controller</strong> (MIC), another component within Cell (like the PPE). Additionally, the MIC buffers memory transfers to improve bandwidth, but it has a big limitation: large byte alignment. In essence, the MIC’s smallest data size for transfers is <strong>128 Bytes</strong>, which works well for sequential reads or writes. But if the data is smaller than 128 B or it requires alternating between writing and reading, performance penalties appear.</p><p>That being said, is the MIC a bottleneck or an accelerator? Well, you have to put it into perspective, bandwidth optimisation is critical in data-hungry systems. In the past, we’ve seen solutions like the <a href="https://www.copetti.org/writings/consoles/gamecube/#ibms-enhancements">write-gather pipe</a> or the <a href="https://www.copetti.org/writings/consoles/playstation-2/#preventing-past-mishaps">write back buffer</a>, so the MIC is simply a new proposal to a recurring problem. For what it’s worth, Sony claims the transfer rate is 25.6 GB/s, still, there are too many factors that will condition the final rate in practice (you’ve seen how convoluted is to move data from one place to another within Cell).</p><p>This is as far as it goes for main RAM, but there’s more memory elsewhere: the hard drive. The PS3 also enables games to use <strong>2 GB</strong> from its internal hard drive as a working area (similarly to what the <a href="https://www.copetti.org/writings/consoles/xbox/#memory-layout">original Xbox provided</a>) <sup id="bibref:17"><a href="#bib:cpu-files" role="doc-biblioref">[17]</a></sup>.</p><h3 id="inside-cell-the-assistants">Inside Cell: The assistants</h3><p>We’ve <a href="https://www.copetti.org/writings/consoles/playstation-2/#the-leader">seen before</a> how Sony always supplies a general-purpose processor (the PPE in this case) accompanied by accelerators to reach acceptable gaming performance (the VPUs and IPU in the case of the PS2; and the GTE and MDEC with the PS1). This is common practice with video console hardware, as general-purpose can perform a wide range of tasks, but are not specialised in anything. Game consoles require only a subset of skills (physics, graphics and audio, for instance) so co-processors bring them up to their task.</p><blockquote><p>[The PPE] is a watered-down version to reduce power consumption. So it doesn’t have the horsepower that you see in say a Pentium 4 (…) If you take the code that runs today on your Intel or AMD, whatever your power, and you recompile it on Cell, it’ll run today - maybe you have to change the library or two, but it’ll run today here, no problem. But it’ll be about 60% slower, 50% slower and so people say “Oh my god! This cell processor’s terrible!” <strong>but that’s because you’re only using that one piece</strong> <sup id="bibref:18"><a href="#bib:cpu-mit" role="doc-biblioref">[18]</a></sup>.</p><p>– <cite>Dr. Michael Perrone, manager of the IBM TJ Watson Research Center’s Cell Solutions Department</cite></p></blockquote><p>The accelerators included within PS3’s Cell are the <strong>Synergistic Processor Element</strong> (SPE). Cell includes <strong>eight of them</strong>, although one is disabled while the console boots up. This is because chip fabrication requires an exceptional amount of precision (Cell initially used the 90nm fabrication process) and the machinery is not perfect. So, instead of chucking out circuitry that came out &lt; 10% defective, Cell includes one spare SPE. Thus, if one of them comes out defective, the whole chip is not discarded. Now, that spare SPE will always be deactivated, independently whether it’s fine or not (Sony can’t have two different PS3s in the market).</p><h4 id="composition-of-the-spe">Composition of the SPE</h4><p>Moving on, the Synergistic Processor Element (SPE) is a tiny independent computer inside Cell and commanded by the PPE. Remember what I explained before about the adoption of elements from homogeneous computing? Well, these coprocessors are somewhat general-purpose and not restricted to a single application, so they will be able to assist in a wide range of tasks, that is, as long as developers can program them properly.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spe.e654c305810905d9471fc5114acbbffe72c34acfc702b5ddfe16f0e07a40f4ba.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spe.e654c305810905d9471fc5114acbbffe72c34acfc702b5ddfe16f0e07a40f4ba.webp"/><img alt="Image" width="864" height="572" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spe.e654c305810905d9471fc5114acbbffe72c34acfc702b5ddfe16f0e07a40f4ba_hu_ce17442568151fe.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the Synergistic Processor Element (SPE), there are eight of these within Cell (one disabled).</figcaption></figure><p>Just like we did with the PPE, we’ll have a look at the SPE. It’s a shorter one so if at the end, you’d like to learn more about the SPEs, check out the ‘Sources’ section at the end of the article. That being said, let’s start…</p><p>The SPE is a processor that follows similar structuring to the PPE, being made of two parts:</p><div><ul><li id="tab-4-1-the-memory-flow-controller-link"><a href="#tab-4-1-the-memory-flow-controller">The Memory Flow Controller</a></li><li id="tab-4-2-the-synergistic-processor-unit-link"><a href="#tab-4-2-the-synergistic-processor-unit">The Synergistic Processor Unit</a></li></ul><div><div id="tab-4-1-the-memory-flow-controller"><h5 id="tab-4-1-the-memory-flow-controller">The Memory Flow Controller</h5><p>The <strong>Memory Flow Controller</strong> (MFC) is the block that interconnects the core with the rest of Cell, this is equivalent to the PowerPC Processor Storage Subsystem (PPSS) in the PPE. The MFC’s main job is to move data between SPU’s local memory and Cell’s main memory and keep the SPU in sync with its neighbours.</p><p>To perform its duties, The MFC embeds a <strong>DMA controller</strong> to handle communication between the EIB and the SPU’s local memory. Furthermore, the MFC houses another component called <strong>Synergistic Bus Interface</strong> (SBI) that sits between the EIB bus and the DMA controller. It’s a very complex piece of circuitry to summarise, but it basically interprets commands and data received from outside and signals the internal units of the SPE. As the front door to Cell, the SBI operates in two modes: bus master (where the SPE is adapted to requests data from outside) or bus slave (where the SPE is set to receive orders from outside).</p><p>As a curious fact, considering the limit of EIB packets (up to 128-bit long), the MFC’s Direct Memory Access block can only move up to 16 KB of data per cycle, otherwise, the EIB throws a ‘Bus Error’ exception during execution <sup id="bibref:19"><a href="#bib:cpu-hpc" role="doc-biblioref">[19]</a></sup>.</p></div><div id="tab-4-2-the-synergistic-processor-unit"><h5 id="tab-4-2-the-synergistic-processor-unit">The Synergistic Processor Unit</h5><p>The <strong>Synergistic Processor Unit</strong> (SPU) is the part of the SPE where the core processor resides, equivalent to the ‘PPU’ when we talked about the PPE.</p><p>Contrariwise to the PPU, the SPU is isolated from the rest of the Cell. Thus, there’s no shared memory between PPU or others SPUs. Instead, the SPU contains local memory used as working space. However, the contents of local memory can be moved back and forth using the MFC.</p><p>In terms of functionality, the SPU is a lot more limited than the PPU. For instance, SPU doesn’t include any memory management functions (address translation and memory protection) or even state-of-the-art functions (i.e. dynamic branch prediction). Nonetheless, it performs exceptionally well at vector processing.</p><p>To program this unit, developers use the PPU to invoke routines provided by the PlayStation 3’s Operating System, these upload the executable specifically written for the SPU to the SPU of choice and signal it to start execution. Afterwards, the PPU keeps a reference of the SPU’s thread for synchronisation purposes <sup id="bibref:20"><a href="#bib:cpu-spuprog" role="doc-biblioref">[20]</a></sup>.</p></div></div></div><h4 id="architecture-of-the-spu">Architecture of the SPU</h4><p>Like any CPU, the Synergistic Processor Unit (SPU) is programmed using an instruction set architecture (ISA). Both SPU and PPU follow the RISC methodology, however, unlike the PPU (which implements a PowerPC ISA), the SPU’s ISA is proprietary and mainly composed of a SIMD-type instruction set. As a result, the SPU features <strong>128 128-bit general-purpose registers</strong> which house vectors made of 32/16-bit fixed-point or floating-point values. On the other side, to preserve memory, SPU instructions are much smaller, just <strong>32 bits long</strong>. The first part contains the opcode and the rest can reference up to three operands to be computed in parallel.</p><p>This is very relatable to the previous <a href="https://www.copetti.org/writings/consoles/playstation-2/#co-cpus">Vector Floating Point Unit</a> debuted in the PS2, but a lot has changed since then. For instance, the SPU doesn’t require developers to learn a new proprietary assembly language - IBM and Sony provided toolkits to program the SPUs using either C++, C or assembly.</p><p>In terms of design, this processor doesn’t execute all instructions using the same unit, execution is instead divided into two blocks or ‘execution pipelines’, one is called <strong>Odd Pipeline</strong> and the other is named <strong>Even Pipeline</strong>. These two pipelines execute different types of instructions, enabling the SPU to issue <strong>two instructions per cycle</strong> whenever it’s possible to do so. On the other hand, the SPU will never dual-issue instructions that depend on each other, thus, mitigating <a href="https://www.copetti.org/writings/consoles/playstation/#delay-galore">data hazards</a> that may emerge.</p><p>Let’s now take a look at the two pipelines <sup id="bibref:21"><a href="#bib:cpu-hyesoon" role="doc-biblioref">[21]</a></sup>:</p><div><ul><li id="tab-5-1-odd-pipeline-link"><a href="#tab-5-1-odd-pipeline">Odd Pipeline</a></li><li id="tab-5-2-even-pipeline-link"><a href="#tab-5-2-even-pipeline">Even Pipeline</a></li></ul><div><div id="tab-5-1-odd-pipeline"><h5 id="tab-5-1-odd-pipeline">Odd Pipeline</h5><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/odd.4522b0b8f0b120a5f60895119fa38cc73c3c25e34ba06801a3fd5c589c3a6ff3.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/odd.4522b0b8f0b120a5f60895119fa38cc73c3c25e34ba06801a3fd5c589c3a6ff3.webp"/><img alt="Image" width="760" height="624" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/odd.4522b0b8f0b120a5f60895119fa38cc73c3c25e34ba06801a3fd5c589c3a6ff3_hu_bc9616b1dbc7b9c6.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the odd pipeline.</figcaption></figure><p>The Odd pipeline executes most of the instructions except the arithmetic ones.</p><p>First of all, you’ll find the <strong>SPU Load/Store unit</strong> (SLS) does three essential things:</p><ul><li>Houses <strong>256 KB of local memory</strong> to store instructions and data. The type of memory fitted is single-ported (considering this is a critical area, it’s a bit disappointing they didn’t use dual-ported chips…). Furthermore, the address bus is 32-bit long.</li><li>Executes load and store instructions.</li><li>Forwards instructions to another block for issuing.</li></ul><p>Notice that there are <strong>only 256 KB available to store the program</strong>. Considering SPU programs can be compiled using C/C++, it’s not easy to predict how large the binary will be. For this reason, it is recommended that developers assume there’s only half the memory available (128 KB) <sup id="bibref:22"><a href="#bib:cpu-hpc" role="doc-biblioref">[22]</a></sup>, which leaves enough window for the compiled code to take up as much space as it needs, although this comes at the cost of storage and efficiency.</p><p>Finally, there’s also a <strong>SPU Channel and DMA Transport</strong> (SSC) unit, which the Memory Flow controller uses to fill and/or fetch local memory, and a <em>puny</em> <strong>Fixed-Point Unit</strong> that only does shuffling and vector rotation.</p></div><div id="tab-5-2-even-pipeline"><h5 id="tab-5-2-even-pipeline">Even Pipeline</h5><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/even.0341b94d38d74fff62ca8e105723c9911ef0ce393292f72d53c7f54d34c5aa6f.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/even.0341b94d38d74fff62ca8e105723c9911ef0ce393292f72d53c7f54d34c5aa6f.webp"/><img alt="Image" width="760" height="431" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/spu/even.0341b94d38d74fff62ca8e105723c9911ef0ce393292f72d53c7f54d34c5aa6f_hu_74ea8c2fbcbf3907.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the even pipeline.</figcaption></figure><p>The Even pipeline is notable for its arithmetic capabilities.</p><p>In here we find a <em>real</em> <strong>Fixed-point Unit</strong> (FXU) which performs basic arithmetic, logical operations (AND, OR, etc), and word shifts.</p><p>Last but not least, we’ve got a <strong>Floating-point Unit</strong> (FPU) which performs single-precision (32-bit <code>float</code>), double-precision (64-bit <code>double</code>) and integer (32-bit <code>int</code>) operations. It follows IEEE standard with some deviations (floats behave similarly to the <a href="https://www.copetti.org/writings/consoles/playstation-2/#the-leader">PS2</a>).</p></div></div></div><h3 id="inside-cell-programming-styles">Inside Cell: Programming styles</h3><p>As we reach the end of Cell, you may ask how are developers supposed to program this <em>monster</em>? Well, similarly to the <a href="https://www.copetti.org/writings/consoles/playstation-2/#you-define-the-workflow">previous programming models</a> devised for the Emotion Engine, IBM proposed the following methodologies <sup id="bibref:23"><a href="#bib:cpu-prog_tut" role="doc-biblioref">[23]</a></sup>:</p><h4 id="ppe-centric-approaches">PPE-centric approaches</h4><p>PPE-centric approaches are a set of programming patterns that place the main responsibilities on the PPE and leave the SPE for offloading work. There are three possible patterns:</p><ul><li><strong>Multistage pipeline model</strong>: the PPE is tasked with sending work to a single SPE, which in turn performs the required computations and passes the results to the next SPE. This continues until the last SPE in the chain sends the processed data back to the PPE.<ul><li>For obvious reasons, IBM doesn’t suggest this design for primary tasks as it requires a considerable amount of bandwidth and it tends to be difficult to maintain.</li></ul></li><li><strong>Parallel stages model</strong>: the PPE divides its main task into independent sub-tasks and sends each one to a different SPE. Each SPE then returns the processed data to the PPE after they finish, then, the PPE combines it to produce the final result.</li><li><strong>Services model</strong>: each SPE get assigned a single job (i.e. MPEG decoding, audio streaming, perspective projection, vertex lighting, etc) and the PPE is in charge of sending raw data to the designated SPE. While waiting, the PPE carries out other functions.<ul><li>While this implies each SPE will have a single job, their job designation is not meant to last forever. The PPE must reallocate different jobs on the fly as the needs of the program change.</li></ul></li></ul><h4 id="spe-centric-approaches">SPE-centric approaches</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/programming/spe_centric.283f649d68951efed04354376e1188f4d0108ddc84515244a8f5917cb92f2d6e.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/programming/spe_centric.283f649d68951efed04354376e1188f4d0108ddc84515244a8f5917cb92f2d6e.webp"/><img alt="Image" width="388" height="217" src="https://www.copetti.org/images/consoles/ps3/_diagrams/cell/programming/spe_centric.283f649d68951efed04354376e1188f4d0108ddc84515244a8f5917cb92f2d6e_hu_30543336bbaa001d.png" loading="lazy"/></picture></a><figcaption>Representation of the SPE-centric pattern, where each SPE is in charge of its functionality and only interacts with the PPE to obtain a resource.</figcaption></figure><p>Instead of using the SPEs to serve the PPE, it’s the other way around. Using the internal DMA unit, SPEs fetch and execute tasks stored in main memory, while the PPE is limited to resource management.</p><p>This model is a lot more radical than the rest, in the sense that previous patterns are closer to the traditional and PC-like ‘general-purpose processor with co-processors’ paradigm. Thus, codebases implementing SPE-centric algorithms may be harder to port to other platforms.</p><h3 id="conclusion">Conclusion</h3><p>As you can imagine, while the multi-core design of Cell accelerates emerging techniques such as <a href="https://www.copetti.org/writings/consoles/playstation-2/#infinite-worlds">procedural generation</a>, none of these designs are particularly simple to implement, especially considering game studios prefer codebases that can be shared across different platforms.</p><p>To give you an example, the developers of the Unreal Engine 3 (Epic Games) demonstrated the limitations of the SPUs while trying to implement their collision detection system <sup id="bibref:24"><a href="#bib:cpu-unreal" role="doc-biblioref">[24]</a></sup>. Their design relies on Binary Space Partitioning (BSP), an algorithm strongly dependent on comparisons (branching). Because the SPUs don’t provide dynamic branch prediction like the PPU, their implementation disappointed PlayStation 3 users when compared side-by-side against other platforms (i.e. <a href="https://www.copetti.org/writings/consoles/xbox-360/#cpu">Xbox 360</a> or <a href="https://www.copetti.org/writings/consoles/xbox/#tab-1-3-the-microarchitecture">i686</a> PCs, both of which provide consistent prediction techniques across all their cores). Hence, Epic Games had to resort to further optimisations only compatible with Cell.</p><p>I suppose it’s just a matter of time, patience and a lot of learning for software engineers to crank up the full potential of Cell. However, history demonstrated <a href="https://www.copetti.org/writings/consoles/sega-saturn/#as-a-challenging-3d-console">that’s not feasible for every studio</a>, which makes me wonder if that’s the reason current console hardware (as of 2021) has homogenised so much.</p><hr/><h2 id="graphics">Graphics</h2><p>If you thought that Cell, with all its quirks, could take care of every task of this console, then let me tell you something hysterical: <strong>Sony fitted a separate chip for 3D graphics</strong>.</p><figure><ul><li id="nestedtab-2-1-uncharted-link"><a href="#nestedtab-2-1-uncharted">Uncharted</a></li><li id="nestedtab-2-2-skyrim-link"><a href="#nestedtab-2-2-skyrim">Skyrim</a></li><li id="nestedtab-2-3-killzone-link"><a href="#nestedtab-2-3-killzone">Killzone</a></li><li id="nestedtab-2-4-one-piece-link"><a href="#nestedtab-2-4-one-piece">One Piece</a></li></ul><figure id="nestedtab-2-1-uncharted"><a href="https://www.copetti.org/images/consoles/ps3/games/uncharted3.3f83b2b5e168a72e0de208c22ef986d4d6a6525762e64a87598ff7b39c399588.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/games/uncharted3.3f83b2b5e168a72e0de208c22ef986d4d6a6525762e64a87598ff7b39c399588_hu_6c2326a7cbd5a15a.webp 500w,
https://www.copetti.org/images/consoles/ps3/games/uncharted3.3f83b2b5e168a72e0de208c22ef986d4d6a6525762e64a87598ff7b39c399588_hu_633efdd542bef85d.webp 800w,
https://www.copetti.org/images/consoles/ps3/games/uncharted3.3f83b2b5e168a72e0de208c22ef986d4d6a6525762e64a87598ff7b39c399588_hu_71ca42187cc7e0f2.webp 1280w"/><img alt="Image" width="1280" height="720" src="https://www.copetti.org/images/consoles/ps3/games/uncharted3.3f83b2b5e168a72e0de208c22ef986d4d6a6525762e64a87598ff7b39c399588.jpg" loading="lazy"/></picture></a><figcaption>Uncharted 3: Drake’s Deception (2011).</figcaption></figure><figure id="nestedtab-2-2-skyrim"><a href="https://www.copetti.org/images/consoles/ps3/games/skyrim.f433d067c3083c66ce87f67a2a8a8dd58b190391cbd9fba39c7b7cb023ed251c.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/games/skyrim.f433d067c3083c66ce87f67a2a8a8dd58b190391cbd9fba39c7b7cb023ed251c_hu_efe6e72b801cf3ec.webp 500w,
https://www.copetti.org/images/consoles/ps3/games/skyrim.f433d067c3083c66ce87f67a2a8a8dd58b190391cbd9fba39c7b7cb023ed251c_hu_c8ea8ae2a62388ac.webp 800w,
https://www.copetti.org/images/consoles/ps3/games/skyrim.f433d067c3083c66ce87f67a2a8a8dd58b190391cbd9fba39c7b7cb023ed251c_hu_62cc2c3ecfb55643.webp 1280w"/><img alt="Image" width="1280" height="720" src="https://www.copetti.org/images/consoles/ps3/games/skyrim.f433d067c3083c66ce87f67a2a8a8dd58b190391cbd9fba39c7b7cb023ed251c.jpg" loading="lazy"/></picture></a><figcaption>The Elder Scrolls V: Skyrim (2011).</figcaption></figure><figure id="nestedtab-2-3-killzone"><a href="https://www.copetti.org/images/consoles/ps3/games/killzone.8c502f748269ce1adfbbbd2965455f828ba45c4151e57adf85518fc6fe7506e8.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/games/killzone.8c502f748269ce1adfbbbd2965455f828ba45c4151e57adf85518fc6fe7506e8_hu_c011f7a2f591eb89.webp 500w,
https://www.copetti.org/images/consoles/ps3/games/killzone.8c502f748269ce1adfbbbd2965455f828ba45c4151e57adf85518fc6fe7506e8_hu_8281d543f10f770b.webp 800w,
https://www.copetti.org/images/consoles/ps3/games/killzone.8c502f748269ce1adfbbbd2965455f828ba45c4151e57adf85518fc6fe7506e8_hu_8fc543508476bf35.webp 1280w"/><img alt="Image" width="1280" height="720" src="https://www.copetti.org/images/consoles/ps3/games/killzone.8c502f748269ce1adfbbbd2965455f828ba45c4151e57adf85518fc6fe7506e8.jpg" loading="lazy"/></picture></a><figcaption>Killzone 3 (2011).</figcaption></figure><figure id="nestedtab-2-4-one-piece"><a href="https://www.copetti.org/images/consoles/ps3/games/onepiece.05172b1704d4189ce788a1ab52fd67a22dda3121d5131c09ebd1277fb4ce4ebe.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/games/onepiece.05172b1704d4189ce788a1ab52fd67a22dda3121d5131c09ebd1277fb4ce4ebe_hu_4f753f164b9710de.webp 500w,
https://www.copetti.org/images/consoles/ps3/games/onepiece.05172b1704d4189ce788a1ab52fd67a22dda3121d5131c09ebd1277fb4ce4ebe_hu_81a2ff12d88b4a80.webp 800w,
https://www.copetti.org/images/consoles/ps3/games/onepiece.05172b1704d4189ce788a1ab52fd67a22dda3121d5131c09ebd1277fb4ce4ebe_hu_de878dd1f6d0235.webp 1280w"/><img alt="Image" width="1280" height="720" src="https://www.copetti.org/images/consoles/ps3/games/onepiece.05172b1704d4189ce788a1ab52fd67a22dda3121d5131c09ebd1277fb4ce4ebe.jpg" loading="lazy"/></picture></a><figcaption>One Piece: Pirate Warriors (2012).</figcaption></figure><figcaption>Example of PS3 games. All rendered at their maximum resolution (1280x720 pixels).</figcaption></figure><p>It appears that even with a supercomputer chip, Sony still had to fetch a GPU to finalise the PlayStation 3. This makes you wonder if IBM/Sony/Toshiba hit a wall while trying to scale Cell further, so Sony had no option but to get help from a graphics company.</p><blockquote><p>We had started this ICE [Initiative For A Common Engine] team with the intent of developing some core technology that could be shared amongst all the first parties (…) For a while, [PS3 had] no GPU, it was going to run everything with SPUs. The ICE team proved to Japan that it was just impossible. It would be ridiculous. Performance-wise, it would be a disaster. That’s why they finally added the GPU, closer to the end <sup id="bibref:25"><a href="#bib:graphics-ign_naughtydog" role="doc-biblioref">[25]</a></sup>.</p><p>– <cite>Unnamed sources from Naughty Dog</cite></p></blockquote><p>What I am sure is that the PS3 contains a GPU chip manufactured by <strong>Nvidia</strong> meant to offload part of the graphics pipeline. The chip is called <strong>Reality Synthesizer</strong> or ‘RSX’ and runs at <strong>500 MHz</strong> <sup id="bibref:26"><a href="#bib:graphics-rsx_dev" role="doc-biblioref">[26]</a></sup>. Its clock speed looks concerning when compared to Cell’s (3.2 GHz), though you’ll soon see that the GPU is better equipped for computing huge amounts of operations in parallel. So it’s a matter of finding a balance between Cell and RSX when it comes to building the graphics pipeline (though I must confess this sounds simpler on paper than it is in practice).</p><p>I will now perform the same level of analysis previously done with Cell, this time focusing on RSX and its graphics capabilities.</p><h3 id="overview">Overview</h3><p>It’s been five years since Nvidia debuted the <a href="https://www.copetti.org/writings/consoles/xbox/#graphics">GeForce3/NV30 lineup</a> in 2001, and by then the arena was battled by strong players like 3dfx, S3 and ArtX/ATI. Though in subsequent years, the number of companies slowly reduced to the point that by 2006, only ATI and Nvidia remained as the flagship video card suppliers in the PC market.</p><div><figure><a href="https://www.copetti.org/images/consoles/ps3/rsx.79512d1ea8a77ed2fad1329c6031d6a0ad9a7adae968488017f7b1b40229c2da.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/rsx.79512d1ea8a77ed2fad1329c6031d6a0ad9a7adae968488017f7b1b40229c2da_hu_3742162b4ea4fbbc.webp 500w,
https://www.copetti.org/images/consoles/ps3/rsx.79512d1ea8a77ed2fad1329c6031d6a0ad9a7adae968488017f7b1b40229c2da_hu_e65119cea0f22359.webp 800w,
https://www.copetti.org/images/consoles/ps3/rsx.79512d1ea8a77ed2fad1329c6031d6a0ad9a7adae968488017f7b1b40229c2da_hu_6c968a8f9116c4ad.webp 900w"/><img alt="Image" width="900" height="703" src="https://www.copetti.org/images/consoles/ps3/rsx.79512d1ea8a77ed2fad1329c6031d6a0ad9a7adae968488017f7b1b40229c2da.jpg" loading="lazy"/></picture></a><figcaption>RSX chip next to Cell.</figcaption></figure><p>The RSX inherits existing Nvidia technology, it’s reported to be based on the 7800 GTX model sold for PCs, which implements the <strong>GeForce7</strong> (or NV47) architecture <sup id="bibref:27"><a href="#bib:graphics-nvarch" role="doc-biblioref">[27]</a></sup>, also named ‘Curie’.</p><p>In my <a href="https://www.copetti.org/writings/consoles/xbox/#graphics">previous Xbox analysis</a>, I talked about the GeForce3 and their debuting pixel shaders, so what has changed since then? There have some been ups and downs, but mostly incremental changes, so nothing too groundbreaking compared to GeForce3’s pixel shaders.</p></div><p>On the other side, while the 7800 GTX relies on the PCI Express protocol to communicate with the CPU, the RSX has been remodelled to work with a proprietary protocol called <strong>Flex I/O</strong> <sup id="bibref:28"><a href="#bib:graphics-gschwind" role="doc-biblioref">[28]</a></sup>, a distinct interface within Cell designed to connect to neighbouring chips. Flex I/O operates in two modes:</p><ul><li><strong>BIC</strong> mode for connecting other Cell processors (to be used in multi-processor environments).</li><li>The slower <strong>IOIF</strong> mode for connecting up to two peripherals, a ‘fast’ one and a ‘slow’ one.</li></ul><p>Alas, the RSX is not Cell, so it goes through the IOIF protocol, using the fastest slot.</p><p>For comparison purposes, IOIF behaves as a 32-bit parallel bus with a theoretical bandwidth of up to 20 GB/s, while the PCI-express used in the 7800 GTX (x16 1.0) is a 16-bit serial bus with a theoretical bandwidth of up to 4 GB/s.</p><h3 id="organising-the-content">Organising the content</h3><p>RSX has <strong>256 MB of dedicated GDDR3 SDRAM</strong> at its disposal. Surprisingly, it’s the <a href="https://www.copetti.org/writings/consoles/wii/#what-about-memory">same memory type</a> found in the Wii. The memory bus runs at <strong>650 MHz</strong> with a theoretical bandwidth of up to <strong>20.8 GB/s</strong>.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/content.39059097e43ae5d20fb2f32eafa6b0e390fd1bfd9216a180bbe8f29ff7f5741f.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/content.39059097e43ae5d20fb2f32eafa6b0e390fd1bfd9216a180bbe8f29ff7f5741f.webp"/><img alt="Image" width="909" height="389" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/content.39059097e43ae5d20fb2f32eafa6b0e390fd1bfd9216a180bbe8f29ff7f5741f_hu_7b99a86a36322856.png" loading="lazy"/></picture></a><figcaption>Example of how data is organised across the memory available. Notice how RSX can access its content from different memory chips.</figcaption></figure><p>Inside those 256 MB, Cell can place everything that RSX will need to render a frame. That includes vertex data, shaders, textures and commands. Now, thanks to Cell’s Flex I/O bus, RSX can also utilise the aforementioned 256 MB of XDR memory (CPU’s main RAM) as working space, though this will come with some performance penalties. This comes in handy if the rendered frame will be post-processed by an SPU, for instance.</p><p>As you can see, while this console didn’t implement a UMA architecture, <strong>it can still distribute graphics data across different memory chips</strong> if programmers decide to do so. I mention this because I wish many ‘technical explainers’ would read more about this feature before shouting over-summarising statements like “The PS3 was limited because it didn’t have UMA”. That may be true in certain cases, but unless they mention these, that generic claim is, in my opinion, <strong>misguiding</strong>.</p><p>Finally, RSX supports many forms of data optimisation to save bandwidth, examples include 4:1 colour compression, z-compression and ‘tiled’ mode (I’ll explain more about it later on).</p><h3 id="constructing-the-frame">Constructing the frame</h3><p>Let’s now take a look at how RSX processes and renders 3D scenes.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline.abe1fd61c7be31b0ef0baa196b0790945ed99f33108e8a87879f89c9338ee557.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline.abe1fd61c7be31b0ef0baa196b0790945ed99f33108e8a87879f89c9338ee557.webp"/><img alt="Image" width="573" height="459" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline.abe1fd61c7be31b0ef0baa196b0790945ed99f33108e8a87879f89c9338ee557_hu_31de3a1907af9bfb.png" loading="lazy"/></picture></a><figcaption>Pipeline overview of the RSX.</figcaption></figure><p>Its pipeline model is very similar to the <a href="https://www.copetti.org/writings/consoles/xbox/#architecture-and-design">GeForce3</a>, but super-charged with five years of technological progress. So I suggest checking out that article beforehand since this one will focus on the new features, I also recommend reading about the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#functionality">PlayStation Portable’s GPU</a> because a lot of new developments and needs overlap with that chip. That being said, let’s see what we’ve got here… <sup id="bibref:29"><a href="#bib:graphics-marcelina" role="doc-biblioref">[29]</a></sup></p><div><ul><li id="tab-6-1-commands-link"><a href="#tab-6-1-commands">Commands</a></li><li id="tab-6-2-vertex-shader-link"><a href="#tab-6-2-vertex-shader">Vertex Shader</a></li><li id="tab-6-3-rasterization-link"><a href="#tab-6-3-rasterization">Rasterization</a></li><li id="tab-6-4-pixel-shader-link"><a href="#tab-6-4-pixel-shader">Pixel Shader</a></li><li id="tab-6-5-pixel-operations-link"><a href="#tab-6-5-pixel-operations">Pixel operations</a></li></ul><div><div id="tab-6-1-commands"><h4 id="tab-6-1-commands">Commands</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_commands.d642267c04bc1584b1d87f9f104212996a4ad01ea6fdc7f9893cc4e8f20b3a60.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_commands.d642267c04bc1584b1d87f9f104212996a4ad01ea6fdc7f9893cc4e8f20b3a60.webp"/><img alt="Image" width="542" height="481" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_commands.d642267c04bc1584b1d87f9f104212996a4ad01ea6fdc7f9893cc4e8f20b3a60_hu_ff0d52b81f674a4a.png" loading="lazy"/></picture></a><figcaption>Diagram of the command stage.</figcaption></figure><p>As with any other GPU, there must be a block of circuitry in charge of receiving the orders from outside. With RSX, this is handled by two blocks, <strong>Host</strong> and <strong>Graphics Front End</strong>.</p><p>The Host is responsible for reading commands from memory (either at local or main) and translating them into internal signals that other components in RSX understand, this is done with the use of four sub-blocks:</p><ul><li><strong>Pusher</strong>: fetches graphics commands from memory and <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-1-1-commands">interprets</a> branch instructions. It also contains 1 KB of <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#memory-locations">prefetch buffer</a>. The processed commands are sent to the FIFO Cache.</li><li><strong>FIFO Cache</strong>: stores up to 512 commands decoded by the Pusher in a FIFO manner to provide quick access.</li><li><strong>Puller</strong>: as the name indicates, it pulls commands from the FIFO cache whenever RSX is ready to render and sends them to the next unit.</li><li><strong>Graphics FIFO</strong>: stores up to eight commands that will be read by the Graphics Front End.</li></ul><p>The Graphics Front end then reads from the Graphics FIFO and signals the required units inside RSX to compute the operations. If you remember, this is equivalent to the ‘pfifo’ in the GeForce3.</p><p>As you can see, commands and data pass through many buffers and caches before reaching the final destination. This is intentional, as it prevents stalling the pipeline due to different units and buses operating at different speeds. So, cached memory takes advantage of fast bandwidth whenever it’s possible.</p></div><div id="tab-6-2-vertex-shader"><h4 id="tab-6-2-vertex-shader">Vertex Shader</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_vertex.a9b17355ef4b13db690f14fcf3b5c27232393ffb382d164d02f8e9f4d7c43f21.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_vertex.a9b17355ef4b13db690f14fcf3b5c27232393ffb382d164d02f8e9f4d7c43f21.webp"/><img alt="Image" width="820" height="670" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_vertex.a9b17355ef4b13db690f14fcf3b5c27232393ffb382d164d02f8e9f4d7c43f21_hu_298799e3ccc70cea.png" loading="lazy"/></picture></a><figcaption>Diagram of the vertex stage process, notice that the Vertex Processing Engines (VPE) are bypassed if the vertices don’t need further processing by the vertex shader.</figcaption></figure><p>The next unit is the <strong>Geometry Processing</strong> block, an evolution of the ‘Vertex Block’ in the GeForce3 that performs vertex transformation. It’s still programmable with the use of <strong>vertex shaders</strong>, which is now a widely adopted feature in the graphics industry. Furthermore, the instruction limit has been increased to 512 instructions minimum (originally, 136 was the limit!).</p><p>The block that executes shaders is called <strong>Vertex Processing Engine</strong> (VPE) and it can process <strong>one vertex per clock cycle</strong>. As if wasn’t enough, there are <strong>eight VPEs working in parallel</strong>. Since the GeForce6 series, Nvidia has aligned its shader programming interface to a model called ‘Vertex Shader Model 3’ or ‘vs_3_0_’, a standard developed by Microsoft for use with their DirectX 9.0c libraries <sup id="bibref:30"><a href="#bib:graphics-vs3" role="doc-biblioref">[30]</a></sup>. The VPEs also support the non-proprietary OpenGL 2.1 model <sup id="bibref:31"><a href="#bib:graphics-kilgard" role="doc-biblioref">[31]</a></sup> and Nvidia’s own variant (Cg) <sup id="bibref:32"><a href="#bib:graphics-vp40" role="doc-biblioref">[32]</a></sup>.</p><p>Compared to the GeForce3, we’ve got new instructions available for branching and subroutine calls. Also, the VPE contains four texture samplers that pull texture colours during this stage, in case programmers want to use this unit to perform some operations on them.</p><p>The Geometry Processing block works like this:</p><ol><li>The <strong>Index Vertex Processor</strong> (IDX) fetches and caches vertex data and textures from VRAM. Afterwards, it sends the data to the VAB.</li><li>The <strong>Vertex Attribute Buffer</strong> (VAB) pulls data from the IDX cache and redirects it to each VPE.</li><li>Each VPE processes the data based on the shader loaded. It computes <strong>one shader instruction per clock</strong>.</li><li>The result of each VPE is sent to the <strong>Post Transform Cache</strong>, which caches results to skip identical computations over the same vertex. This only applies if <a href="https://www.copetti.org/writings/consoles/gamecube/#tab-3-2-geometry">vertex indices</a> are used instead of vertex data.</li><li>The final result is stored in the <strong>Viewport Cull Unit</strong> (VPC), which applies scissoring to discard vertices found outside the viewport; and the <strong>Attribute RAM</strong> (ATR), which caches vertex attributes (texture, colour, fog, etc) to be read at the next stages.</li></ol></div><div id="tab-6-3-rasterization"><h4 id="tab-6-3-rasterization">Rasterization</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_rasterizer.75c4f440a1c7eb8cf337cf8b0ae9e178c71cceb8eeea53f9fcd6b89aff0ee928.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_rasterizer.75c4f440a1c7eb8cf337cf8b0ae9e178c71cceb8eeea53f9fcd6b89aff0ee928.webp"/><img alt="Image" width="443" height="402" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_rasterizer.75c4f440a1c7eb8cf337cf8b0ae9e178c71cceb8eeea53f9fcd6b89aff0ee928_hu_5f27118cda736a13.png" loading="lazy"/></picture></a><figcaption>Simplified diagram of the rasterization stage. RSX embeds different units to calculate values used for interpolation of pixels and colours.</figcaption></figure><p>Moving on, it’s time to convert (<a href="https://www.copetti.org/writings/consoles/playstation/#tab-3-3-rasterisation">rasterize</a>) vertices into pixels. The RSX’s rasterizer is quite fast, it can rasterize up to 8x8 pixels (64) per cycle and works with frame-buffers of up to <strong>4096x4096 pixels</strong> (though developers may need less than that).</p><p>The rasterizer accepts points, lines (including strips and closed types), triangles (including strips and fans), quadrilaterals and regular polygons. Naturally, as with this console generation, the rasterizer works with <strong>sub-pixel coordinates</strong>, where the sampling points are half-coordinates (<code>0.5</code>) of pixels. This allows the unit to apply anti-aliasing methods such as <strong>Multisampling</strong> afterwards. Multisampling consists in rasterizing the same geometry multiple times but shifting a few sub-pixels apart at every batch (the RSX supports four different shifting modes) and then computes an average. This results in a smoothed image.</p><p>Furthermore, this unit also performs <strong>z-culling</strong> using dedicated RAM within the RSX (it has a capacity of around three million pixels). This saves processing pixels and stencils that have already been rendered and allows to perform <strong>early <a href="https://www.copetti.org/writings/consoles/nintendo-64/#modern-visible-surface-determination">z-test</a></strong> on incoming geometry.</p><p>A separate unit is used for rasterizing 2D objects (sprites), although this one is isolated from the 3D pipeline. Consequently, RSX works in two modes, 2D and 3D, but intermittently switching between them is expensive in terms of performance.</p></div><div id="tab-6-4-pixel-shader"><h4 id="tab-6-4-pixel-shader">Pixel Shader</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_pixel.d6c3382e15c73510ba222c3b43390c9235553cf02fc89baf5f5bb6862a89da80.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_pixel.d6c3382e15c73510ba222c3b43390c9235553cf02fc89baf5f5bb6862a89da80.webp"/><img alt="Image" width="818" height="624" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_pixel.d6c3382e15c73510ba222c3b43390c9235553cf02fc89baf5f5bb6862a89da80_hu_e1c892a16b86be8a.png" loading="lazy"/></picture></a><figcaption>Pixel/Fragment stage diagram.</figcaption></figure><p>Next in line we’ve got the <strong>Fragment Shader &amp; Texture</strong> block, this is a programmable unit (through the use of ‘fragment programs’ or ‘shader’) that applies texture mapping and other effects.</p><p>Being an advanced successor of GeForce3’s <a href="https://www.copetti.org/writings/consoles/xbox/#tab-2-3-pixel">texture units</a>, the new block contains <strong>six fragment units</strong> (also called ‘pipes’), each one process 2x2 texels (named ‘quads’). To organise multiple units working concurrently, another sub-block called <strong>Shader Quad Distributor</strong> (SQD) is placed to dispatch quads to each fragment unit. Afterwards, each fragment unit loads the fragment program.</p><p>To compute operations, each pipe contains the <em>enormous</em> amount of <strong>1536 128-bit registers</strong>. On top of all that, each pipe can process multiple quads in parallel (<strong>multi-threading</strong>), though the number of quads processed in parallel depends on the number of registers allocated to the fragment program (<code>no. threads = 1536 ÷ no. registers reserved by shader</code>). In global terms, up to 460 quads can be processed in parallel. Furthermore, up to three fragment pipes can process two instructions at the same time (<strong>dual-issuing</strong>, like the PPU) as long as the instructions don’t depend on each other.</p><p>The fragment units provide similar arithmetic-type instructions to the vertex unit, with the addition of texture-related opcodes, such as multiple types of texture fetching (since textures can be encoded using many structures and then compressed) and unpacking. Similarly to the vertex block, the fragment shader abides by DirectX’s Pixel Shader 3.0 model <sup id="bibref:33"><a href="#bib:graphics-vs3" role="doc-biblioref">[33]</a></sup>, OpenGL’s NV_fragment_program2 profile <sup id="bibref:34"><a href="#bib:graphics-khronos" role="doc-biblioref">[34]</a></sup> and Cg’s ‘fp40’ profile <sup id="bibref:35"><a href="#bib:graphics-fp40" role="doc-biblioref">[35]</a></sup>. All of this to ease programming and avoid learning low-level APIs from the ground up.</p><p>Finally, since the units will be constantly fetching texture pieces from video RAM or main RAM, this block includes three texture caches: <strong>4 KB of L1 cache</strong> for each pipe, <strong>48 KB of L2 cache</strong> for video RAM fetches; and <strong>96 KB of L2 cache for main RAM</strong>. Notice that main RAM cache is significantly larger, this was a conscientious decision made to compensate for higher latency.</p></div><div id="tab-6-5-pixel-operations"><h4 id="tab-6-5-pixel-operations">Pixel operations</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_post.93a79a0d7b9e23fd06e32583a9c06475d22b95dc2c19852763a1d1e1016a54cc.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_post.93a79a0d7b9e23fd06e32583a9c06475d22b95dc2c19852763a1d1e1016a54cc.webp"/><img alt="Image" width="820" height="481" src="https://www.copetti.org/images/consoles/ps3/_diagrams/rsx/pipeline_post.93a79a0d7b9e23fd06e32583a9c06475d22b95dc2c19852763a1d1e1016a54cc_hu_90d9f604426af2e5.png" loading="lazy"/></picture></a><figcaption>Post-processing stage.</figcaption></figure><p>Before writing the results into the frame-buffer (stored either in VRAM or Main RAM), a final block called <strong>Raster Operation Block</strong> (ROP) performs final tests on the resulting pixels.</p><p>There are two sets of ROPs made of four blocks each (eight in total). Each group performs z-testing, alpha blending and the final write to memory. All in all, this circuitry can process up to 16 z-values and 8 pixel colours per clock. Curiously enough, the PC-variant Nvidia 7800 GTX features 16 ROPs instead of 8, maybe this cut was done to prioritise memory bandwidth consumed by the SPUs?</p><p>To save further bandwidth, ROPs also provide colour compression and z-compression. Additionally, there’s a <strong>Tiling mode</strong> available for optimising memory access by the video encoder. In tiling mode, the frame buffer is stored into continuous 128 B blocks ordered in the same way they would be broadcasted/scanned. Thus, saving the GPU from doing page swaps (used for memory addressing) while transmitting the frame buffer for display, consequently improving bandwidth. These ‘tiles’ are stored in marked locations in memory exclusive for this type of addressing.</p></div></div></div><h3 id="a-unified-video-output">A unified Video Output</h3><p>Gone are the days of console-proprietary video sockets and dozens of analogue signals squashed together in a single socket to accommodate every region on the earth. The PlayStation 3 finally incorporated a unified video signal soon to be adopted worldwide: the <strong>High Definition Media Interface</strong> (HDMI), used for transferring both audio and video at the same time.</p><div><figure><a href="https://www.copetti.org/images/consoles/ps3/cecha/back.a6a35a546ab4a4ea0a8d9152ed8c9ac10f16d85b94696ab55489b3768fec6aff.jpg"><picture><img alt="Image" width="800" height="527" src="https://www.copetti.org/images/consoles/ps3/cecha/back.a6a35a546ab4a4ea0a8d9152ed8c9ac10f16d85b94696ab55489b3768fec6aff.jpg" loading="lazy"/></picture></a><figcaption>Back of the PS3, HDMI output on the left side and at the other extreme there’s the old Multi A/V for analogue video out.</figcaption></figure><p>The HDMI connector is made of 19 pins <sup id="bibref:36"><a href="#bib:graphics-hdmi_wiki" role="doc-biblioref">[36]</a></sup>, all in a single socket. It transfers a digital signal, meaning that the picture and audio are broadcast using discrete zeroes and ones (and not a range of continuous values found in analogue signals). Consequently, it doesn’t suffer from the interference or image degradation that previous equipment did, such as screen artefacts produced by cheap SCART cables.</p><p>To this day, the HDMI protocol is continuously being revised <sup id="bibref:37"><a href="#bib:graphics-hdmi_spec" role="doc-biblioref">[37]</a></sup>, with new versions of the specification offering more features (i.e. larger image resolution, refresh rate, alternative colour spaces, etc) while retaining the same physical medium for backwards compatibility.</p></div><p>Throughout the PS3 lifecycle, Sony added certain HDMI features of new revisions to the PS3 through software updates <sup id="bibref:38"><a href="#bib:graphics-hdmi_dev" role="doc-biblioref">[38]</a></sup>. The last protocol compatible with the PS3 is version 1.4, which most notably brought support for ‘3D television’. Although, other capabilities, such as higher video resolutions, remained capped at <strong>1920x1080 pixels</strong>, with most games rendering their frame buffers at just 1280x720 pixels.</p><h3 id="real-3d-visionprojection">‘Real’ 3D vision/projection</h3><p>So what was that ‘3D television’ I mentioned before? Well, it so happens that the lifetime of this console overlapped with a short-lived fever for 3D tellies (the so-called <em>3DTV</em>) <sup id="bibref:39"><a href="#bib:graphics-3dtv" role="doc-biblioref">[39]</a></sup>. To support these, Sony updated their SDK to assist the rendering of stereoscopic frames in RSX and implemented the ‘3D specification’ in their HDMI encoder. What’s happening behind the scenes is that the encoder broadcasts two frames at a time, and the television alternates them similarly to what the <a href="https://www.copetti.org/writings/consoles/master-system/#tab-2-3-3d-glasses">Master System’s 3D glasses</a> used to do 30 years before.</p><hr/><h2 id="audio">Audio</h2><p>I’m afraid you won’t see a lot of information in this section anymore, mainly because since the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#audio">last portable invention</a>, audio has <em>silently</em> shifted to the software side. In other words, there are no longer dedicated audio chips.</p><p>You see, while the need for better graphics tends to grow exponentially (consumers want more scenery, better detail and colours), you won’t hear the same level of demands for sound. I presume this is because the capabilities have reached our cognitive limit (44.1 kHz sampling rate and 16-bit resolution). The only thing left is to implement more channels and effects, but these don’t need the processing power that would require installing specialised chips, at least with consumer equipment.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/audio.d7f3ef281b5d8ea908aaf1e26c2b5a6eb12b48b6cab0252a069af4e2716f6a32.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/audio.d7f3ef281b5d8ea908aaf1e26c2b5a6eb12b48b6cab0252a069af4e2716f6a32.webp"/><img alt="Image" width="789" height="239" src="https://www.copetti.org/images/consoles/ps3/_diagrams/audio.d7f3ef281b5d8ea908aaf1e26c2b5a6eb12b48b6cab0252a069af4e2716f6a32_hu_6a5164cf4e7ced01.png" loading="lazy"/></picture></a><figcaption>Summary of the audio pipeline.</figcaption></figure><p>So, in the end, audio is now completely implemented with software and processed by the SPUs (I mean the Synergistic Processor Unit, not the <a href="https://www.copetti.org/writings/consoles/playstation-2/#audio">Sound Processing Unit</a>! it’s a bit ironic that both share the same initials…). Moving on, Sony provides many libraries in their SDK that instruct the SPUs to carry out audio sequencing, mixing and streaming. And if that’s not enough, many effects can also be applied.</p><p>That being said, where is the audio signal sent for broadcast? <strong>The RSX</strong>. This chip also contains the ports used to broadcast raw audio signals to the TV. Before sending it, the signal is encoded in different formats, depending on the output selected (analogue, HDMI or S/PDIF, the latter is also called ‘digital audio’).</p><hr/><h2 id="io-and-backwards-compatibility">I/O and backwards compatibility</h2><p>All I/O operations are delegated to another chunky chip called <strong>Southbridge</strong> <sup id="bibref:40"><a href="#bib:io-southbridge" role="doc-biblioref">[40]</a></sup>. This is very similar to the architecture the original Xbox <a href="https://www.copetti.org/writings/consoles/xbox/#motherboard-architecture">adopted</a> back in the day. It seems as if the architectural gap between consoles is becoming narrower, or maybe this approach proved very reliable and it’s architecture-agnostic, I’ll let you decide.</p><p>Like the PS2’s <a href="https://www.copetti.org/writings/consoles/playstation-2/#io">IOP</a>, the Southbridge is completely proprietary, though this time made by Toshiba (they called it the ‘Super Companion Chip’ <sup id="bibref:41"><a href="#bib:io-supercompanion" role="doc-biblioref">[41]</a></sup>). So, while it still remains an obscure piece of silicon, it does a superior job consolidating many interfaces and protocols, both external (i.e. USB, Ethernet, etc) and internal (i.e. SATA). For reference, in the past, the IOP’s slow clock speed ended up <a href="https://www.copetti.org/writings/consoles/playstation-2/#available-interfaces">bottlenecking</a> speedy interfaces like ATA and Ethernet, greatly reducing their full bandwidth.</p><p>Furthermore, the southbridge implements encryption algorithms to protect the communication between standard protocols in a seamless way, such as the Hard Drive data.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/southbridge.c7357291d582ce2695d44e57a14019a69c9cf32ab4c931cd578c51b75e8a6f46.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/southbridge.c7357291d582ce2695d44e57a14019a69c9cf32ab4c931cd578c51b75e8a6f46.webp"/><img alt="Image" width="1154" height="651" src="https://www.copetti.org/images/consoles/ps3/_diagrams/southbridge.c7357291d582ce2695d44e57a14019a69c9cf32ab4c931cd578c51b75e8a6f46_hu_982e881f7108dbfd.png" loading="lazy"/></picture></a><figcaption>Diagram of the Southbridge’s connections.</figcaption></figure><p>Overall, Southbridge embeds an enormous amount of interfaces, this has to do with the fact this console was designed during the ‘multimedia hub’ trend. It’s not enough for video game consoles to play games, but they also need to become DVD and Blu-ray players, set-top boxes (partially), photo viewers (by importing the camera’s photos using the multi-card reader) and possibly more as the needs evolve (thanks to its updatable operating system).</p><h3 id="external-interfaces">External interfaces</h3><div><div><ul><li id="nestedtab-4-1-opened-link"><a href="#nestedtab-4-1-opened">Opened</a></li><li id="nestedtab-4-2-closed-link"><a href="#nestedtab-4-2-closed">Closed</a></li></ul><figure id="nestedtab-4-1-opened"><a href="https://www.copetti.org/images/consoles/ps3/cecha/front_open.1753c22e109e83827177b6f87f871f43429420a852c052b28a032ade13bf24b5.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/cecha/front_open.1753c22e109e83827177b6f87f871f43429420a852c052b28a032ade13bf24b5_hu_b37f0cba235ec881.webp 500w,
https://www.copetti.org/images/consoles/ps3/cecha/front_open.1753c22e109e83827177b6f87f871f43429420a852c052b28a032ade13bf24b5_hu_7f6e6a5c956e5779.webp 800w"/><img alt="Image" width="800" height="516" src="https://www.copetti.org/images/consoles/ps3/cecha/front_open.1753c22e109e83827177b6f87f871f43429420a852c052b28a032ade13bf24b5.jpg" loading="lazy"/></picture></a><figcaption>Like many PC towers of that era (including mine), a multi-card reader was in order. Next to it, you get four USB 2.0 ports.</figcaption></figure><figure id="nestedtab-4-2-closed"><a href="https://www.copetti.org/images/consoles/ps3/cecha/front_closed.6dbb971dfb696d1669c2e1232655c73de6c92f4950aa343f7158f5e9b96b0242.jpg"><picture><img alt="Image" width="800" height="513" src="https://www.copetti.org/images/consoles/ps3/cecha/front_closed.6dbb971dfb696d1669c2e1232655c73de6c92f4950aa343f7158f5e9b96b0242.jpg" loading="lazy"/></picture></a><figcaption>Same console with the lid closed.</figcaption></figure></div><p>In the case of user-accessible ports, the Southbridge is connected to:</p><ul><li>A <strong>USB 2.0</strong> hub: provides <strong>four front USB A ports</strong>. These can be used for accessories or to link/charge the controllers.</li><li>A <strong>Serial ATA</strong> (SATA) interface: connects the Blu-ray drive and a 2.5” Hard Disk.<ul><li>Until 2008, Blu-ray readers interfaced with Parallel ATA <sup id="bibref:42"><a href="#bib:io-bd_rev" role="doc-biblioref">[42]</a></sup>, so an intermediate chip was fitted in the middle to do the SATA → PATA conversion.</li></ul></li><li><strong>1000/100/10 (Gigabit) Ethernet Controller</strong>: in the form of an RJ45 socket on the back, but it also forks to a Wireless daughterboard, providing <strong>Wi-Fi 802.11b/g</strong> and <strong>Bluetooth 2.0</strong> connection.</li><li>A <strong>Multi-card reader</strong>: provides slots for <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-3-2-memory-stick-duo">Memory Stick</a>, SD, MultiMediaCard (MMC), Microdrive and Compact Flash.</li></ul></div><h4 id="less-wire-equipment">‘Less wire’ equipment</h4><p>Thanks to wide the adoption of Bluetooth technology, wired controls are now a thing of the past. The new form of the PS2’s <a href="https://www.copetti.org/writings/consoles/playstation-2/#interactive-accessories">Dualshock 2</a> controller is called <strong>Sixaxis</strong> and while it’s not the <a href="https://www.copetti.org/writings/consoles/wii/#next-gen-controllers">radical change</a> others decided to go for, it features a gyroscope for new types of human input. This comes at the expense of the haptic feedback (<em>Rumble</em>), however. A year later, Sony surprised players with the <strong>Dualshock 3</strong>, which restored the haptic motor.</p><p>On a different topic, you can now turn on the console from the wireless controller.</p><h3 id="internal-interfaces">Internal interfaces</h3><p>Regarding internal components, SouthBridge connects to:</p><ul><li><strong>Starship 2</strong>: an adapter for <strong>two 128 MB NAND Flash</strong> chips. Behind the scenes, Starship bridges the Southbridge’s local bus with the standardised ‘Common Flash Interface Protocol’ (widely adopted for interfacing Flash memory) <sup id="bibref:43"><a href="#bib:io-starship" role="doc-biblioref">[43]</a></sup>. The PS3 stores the operating system on these, among other things.</li><li>The <strong>PlayStation 2 chipset</strong>: at the corner of the motherboard there’s an eye-catching chip that houses none other than the <a href="https://www.copetti.org/writings/consoles/playstation-2/#cpu">Emotion Engine</a> and the <a href="https://www.copetti.org/writings/consoles/playstation-2/#graphics">Graphics Synthesizer</a>. The EE+GS combo connects to <strong>32 MB of RDRAM</strong> and an <strong>IO bridge</strong> (named ‘PS2 bridge’), which combined form roughly 90% of the original PlayStation 2.<ul><li>The EE+GS chip sends the video signal directly to the RSX.</li><li>These chips are not accessible by developers, they are used for backwards compatibility only!</li></ul></li></ul><h4 id="backwards-compatibility">Backwards compatibility</h4><p>Having mentioned the PS2 chips, I guess this is my cue to talk about backwards compatibility of the PlayStation 3 once in for all.</p><p>First things first, let me introduce how backwards compatibility generally works: consoles can either play their predecessor’s games with the help of <strong>software</strong> (instructs existing hardware to behave as the old game would expect) and <strong>hardware</strong> (either the existing hardware provides total or partial backwards compatibility; and/or the company added extra chips to recreate the older system within the new motherboard). With the amount of processing power the PS3 shows, you would expect Sony to ship a PS2 emulator running within Cell and accelerated by RSX. Well, for some reason that didn’t happen and instead, Sony fitted the PS2’s chipset at one corner of the motherboard.</p><p>On the other side, the missing but not-as-critical chips (IOP, SPU, etc) are replicated with software running in Cell. In the case of game saves, initially, users had to acquire a memory card adaptor, but once a new software update landed, Memory Cards are now emulated as disk images stored in the hard disk, while Magic Gate (the encryption system) is handled seamlessly by one SPU.</p><p>Since the Cell and RSX are still ‘on’ while playing a PS2 game, the system offers two scaling methods for increasing the screen area during gameplay, these are ‘nearest neighbour’ or ‘smoothed’ (anti-aliased).</p><figure><a href="https://www.copetti.org/images/consoles/ps3/xmb/ps2.b67d02e4c4a78a167377c11848acaece65feaa9c7a0a2c03b2ef94ef439dd82f.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/xmb/ps2.b67d02e4c4a78a167377c11848acaece65feaa9c7a0a2c03b2ef94ef439dd82f_hu_c09aa728bc387670.webp 500w,
https://www.copetti.org/images/consoles/ps3/xmb/ps2.b67d02e4c4a78a167377c11848acaece65feaa9c7a0a2c03b2ef94ef439dd82f_hu_836e11d553d00bde.webp 800w,
https://www.copetti.org/images/consoles/ps3/xmb/ps2.b67d02e4c4a78a167377c11848acaece65feaa9c7a0a2c03b2ef94ef439dd82f_hu_b3f719c953ef237f.webp 1920w"/><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/ps2.b67d02e4c4a78a167377c11848acaece65feaa9c7a0a2c03b2ef94ef439dd82f.jpg" loading="lazy"/></picture></a><figcaption>PS3’s user interface showing the game entry after inserting a PS2 disc.</figcaption></figure><p>All in all, thanks to this setup, the PS3 runs PS2 games at an impressive compatibility rate. On top of all, you can take advantage of new features that come with the new console (wireless control, HDMI interface and virtual memory cards).</p><p>As if wasn’t enough, PS1 games can run as well, this time without needing to embed the old SoC or GPU (it relies on pure software emulation).</p><h4 id="the-strange-end-of-terms">The strange end of terms</h4><p>Throughout the lifecycle of the PS3, Sony slowly trimmed PS2-only chips from the PS3 motherboard to the point backwards compatibility was solely software-emulated (with greater limitations, such as only running PS2 games purchased from their online store). Because Sony never replaced the PS2 chipset (as it had previously done with the PS1 hardware inside the PS2), it makes you wonder about the technical and executive rationale behind this. Well, as a case study, here’s my quick opinion about the reasons for this:</p><ul><li><strong>Timing</strong>: Sony likely intended PS2 owners to buy their new product as a replacement of their current one, as this is more affordable for consumers (they can sell their old system). However, for some reason, Sony didn’t have a software emulator prepared before release day, so they initially resorted to adding extra chips. Later on, as the software emulation progressed satisfactorily, they slowly removed these in further motherboard revisions.<ul><li>To complement this, developer ‘M4j0r’ commented: “An interesting point might be that Sony developed the two hardware emulation revisions at the same time (EE/GS and GS only), I guess because some games run better depending on which you use.” <sup id="bibref:44"><a href="#bib:operating_system-psxplace" role="doc-biblioref">[44]</a></sup>.</li></ul></li><li><strong>Costs</strong>: The introductory price of the first revision of the console (<em>CECHA</em>, only in Japan and US) in 2006, which was PS2-compatible, was priced at $599.99 or ¥60,000 without taxes (£425 adjusted for 2020 inflation) <sup id="bibref:45"><a href="#bib:io-launch_fun" role="doc-biblioref">[45]</a></sup>. The following model (<em>CECHC</em>, shipped in 2007 internationally) removed the Emotion Engine and RDRAM (shifting those tasks to software emulation) and launched in the UK with a £425 price tag (£603 in 2020 money). Later in the same year, Sony released a new model (<em>CECHG</em>) without any PS2-related chip for £126 less <sup id="bibref:46"><a href="#bib:io-price_cut" role="doc-biblioref">[46]</a></sup>. All this proves that backwards compatibility is, in the end, an expensive feature.</li><li><strong>Idling hardware and wasted power</strong>: While Cell and RSX still take care of some tasks to recreate the original environment, these are minimal compared to their full potential. Combined with the fact CECHA models have a cumulative power consumption of 399 Watts <sup id="bibref:47"><a href="#bib:io-psu" role="doc-biblioref">[47]</a></sup>, it does make you wonder if this design is worth the power consumption, let alone efficient (for comparison, CECHG’s new power supply consumes 285 Watts).<ul><li>I understand there are other factors involved in the reduction of power consumption, like the new revisions of Cell and RSX. However, I still believe the PS2’s chipset plays an important role.</li></ul></li><li><strong>Inflexibility</strong>: The EE+GS chip is not re-programmable, which means the end result will always be the same, independently whether there are glitches or possible enhancements. Compare this to the PCSX2 emulator’s graphic enhancements <sup id="bibref:48"><a href="#bib:io-widescreen_hack" role="doc-biblioref">[48]</a></sup> and its modding capabilities <sup id="bibref:49"><a href="#bib:io-persona_mods" role="doc-biblioref">[49]</a></sup>, this show us that room for improvement is possible and appreciated.</li></ul><p>Personally, I believe pure software emulation is the most feasible option in the long term due to its scalability, customisation, and independence from proprietary hardware. But of course, this takes more effort to implement accurately, as the ongoing development of PCSX2 by a volunteer-driven community demonstrates it (please note that the aforementioned emulator only runs on x86 PCs, however).</p><h4 id="lateral-compatibility">Lateral compatibility</h4><p>We are not over talking about compatibility just yet! It may surprise you that Sony also allowed users to run a subset of <a href="https://www.copetti.org/writings/consoles/playstation-portable/#games">PlayStation Portable</a> games as well. Though emulation was carried out completely with software, just like the PS2 compatibility in later models.</p><p>As there isn’t any <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-3-1-umd-discs">UMD disc</a> reader in the PS3, users must access a game catalogue from Sony’s online store to download and install any PSP game.</p><hr/><h2 id="operating-system">Operating System</h2><p>Now that home consoles have become powerful multimedia hubs, a more <em>convoluted</em> operating system will be needed to provide users with more services and games with a thicker layer of abstraction. All of these, while keeping security and performance up to the task.</p><p>Consequently, terms like <a href="https://www.copetti.org/writings/consoles/playstation-2/#operating-system">shell</a> or <a href="https://www.copetti.org/writings/consoles/playstation/#operating-system">BIOS</a> are no longer used to describe this area, not because they don’t exist anymore but because they describe a small fraction of the new system. The generic term is now ‘operating system’, this comprises many areas (boot loader, kernel, user interface) analysed separately. As always, I recommend checking out the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#operating-system">PSP’s OS</a> first, since its modular design is a recurrent ingredient in the PS3.</p><h3 id="cells-privileged-security">Cell’s privileged security</h3><p>Before we dive into details, I need to mention the different modes of operation in Cell. I originally planned to describe this in the ‘CPU’ section, but since that got incredibly dense, I’ll introduce it here where you’ll see its practical use right away. Furthermore, its modes also affect the design of any operating system running within Cell - not just the one Sony developed for this console.</p><p>Having said that, to safeguard against unauthorised access to sensitive data and/or resources, Cell implements a set of <strong>privilege levels</strong> inherited from the PowerPC specification. In other words, Cell executes programs in two modes:</p><ul><li><strong>Privileged mode</strong>: Cell grants access to every corner of its hardware (registers, memory addresses, opcodes, etc) <sup id="bibref:50"><a href="#bib:cpu-cell_arch-book" role="doc-biblioref">[50]</a></sup>. For security reasons, this mode should only be used by the operating system’s core (i.e. the Kernel).<ul><li>Moreover, Cell was also prepared to <strong>run multiple operating systems concurrently</strong> and to achieve that in the hardware level, ‘privilege mode’ can be further divided into <strong>Privilege 1</strong> and <strong>Privilege 2</strong>. ‘Privilege 2’ is meant to be used by a Kernel, while ‘Privilege 1’ is used by a <strong>Hypervisor</strong>, the latter arbitrates resources between different Kernels running at the same time.</li><li>The ‘hypervisor’ functionality also turned into an area of research in IBM’s headquarters <sup id="bibref:51"><a href="#bib:operating_system-watson_hypervisor" role="doc-biblioref">[51]</a></sup> <sup id="bibref:52"><a href="#bib:operating_system-shype" role="doc-biblioref">[52]</a></sup>.</li></ul></li><li><strong>User Mode</strong>: As the name indicates, Cell only grants a limited set of resources <sup id="bibref:53"><a href="#bib:cpu-cell_arch-book" role="doc-biblioref">[53]</a></sup> and it’s directed to traditional applications running on top of the operating system. If for any reason, a program requests access to a protected location, then execution jumps to the Kernel or Hypervisor to request whether access should be granted or not.</li></ul><p>Additionally, SPEs contain a modus operandi called <strong>isolated mode</strong> and it shields the execution process within the SPU so no external unit (the PPE or other SPEs) can access it until the SPU finishes. This can be activated after uploading a program to any SPE and ensures that the processor is not tampered with while the sensible code (i.e. an encryption routine) is being executed.</p><p>Sony’s operating system, which I’m going to describe in the following paragraphs, uses all the modes described to handle its security.</p><h3 id="overview-1">Overview</h3><p>As I said before, the OS is quite complex. So, to be able to follow this section without too much trouble, we can divide the type of files we’ll find in the operating system of this console into different layers:</p><ul><li><strong>Loaders</strong>: to make a long story short, programs/binaries in this console are systematically encrypted. So, ‘Loaders’ are programs that execute ‘real’ programs. To put it in another way, Loaders grab binaries, decrypt them, check their authenticity and finally send them to the respective processor (the PPE or either SPE) for execution. If that doesn’t sound complicated, Loaders are chained together to protect the software even further. Finally, Loaders are found across many media.<ul><li>Some Loaders are updated by Sony (through software updates) while others can’t be changed. This is independent of whether they are installed in re-writable storage, as some loaders are encrypted using console-specific keys, so they can’t be altered after the console leaves the factory (at least through traditional means).</li></ul></li><li><strong>System files</strong>: these comprise low-level binaries (executed through Loaders), metadata for organising the hardware, utilities and other assets (i.e. fonts, imagery). Just like Loaders, there are console-specific system files that cannot be replaced or autogenerated.<ul><li>Some binaries borrowed code from the Free BSD and NetBSD projects <sup id="bibref:54"><a href="#bib:operating_system-opensource" role="doc-biblioref">[54]</a></sup>.</li></ul></li><li><strong>User Content</strong>: These include configuration files (i.e internet settings), data used by games (i.e. game installation files and saves) and data generated automatically by the console (i.e. hard drive information).<ul><li>Unlike the other layers, destruction of this data does not lead to catastrophic outcomes.</li></ul></li></ul><h3 id="os-security-hierarchy">OS’ security hierarchy</h3><p>Generally speaking, the PS3’s OS is designed with the same modular approach as the PSP. To recall the previous article, the OS is made of multiple <strong>modules</strong>. These may serve the user (like a game or app) or reside in memory indefinitely to serve other modules (in the form of system calls and/or drivers). Some modules have more privilege access than others (kernel module vs. user module).</p><figure><a href="https://www.copetti.org/images/consoles/ps3/_diagrams/os_levels.3a31cfe5e78682166b713571dd26670a5521824fe33f87b18a5ea2ea266ef886.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/_diagrams/os_levels.3a31cfe5e78682166b713571dd26670a5521824fe33f87b18a5ea2ea266ef886.webp"/><img alt="Image" width="769" height="461" src="https://www.copetti.org/images/consoles/ps3/_diagrams/os_levels.3a31cfe5e78682166b713571dd26670a5521824fe33f87b18a5ea2ea266ef886_hu_6448379fbeff0f6c.png" loading="lazy"/></picture></a><figcaption>Diagram showing how the components of the PlayStation operating system fit in Cell’s privilege levels.</figcaption></figure><p>The operating system, throughout its lifecycle, will call upon many modules with different privileges. Sony constructed its OS so that modules run under Cell’s three privilege levels:</p><ul><li><strong>Level 1</strong>: here is where a <strong>Hypervisor</strong> programmed by Sony resides. Also referred to as <code>lv1</code>, this program is the door to every single bit of this console and chained to exceptions triggered by the MMU. That being said, the hypervisor only accepts requests from programs authorised by Sony (residing in the next privilege level). While the Hypervisor resides in memory, it also provides low-level system calls and FAT16 filesystem support.</li><li><strong>Level 2</strong>: naturally reserved for the <strong>Kernel</strong>, a privileged program also named <code>lv2</code> or ‘Supervisor’. The kernel abstracts the hypervisor so level 3 programs don’t interact with it directly. The Kernel provides multi-threading functions for both PPU and SPU. Ultimately, the Kernel bootstraps userland modules.</li><li><strong>Level 3</strong>: the rest of the programs (called userland or userspace), including <strong>games</strong> and the <strong>visual shell</strong>, run at this level. These <em>plebs</em> are under the will of the Kernel to communicate with the console’s hardware and cannot spawn any new process or program unilaterally.</li></ul><h3 id="storage-medium">Storage medium</h3><p>With all being said, where is all this data stored? From a general user’s perspective, there are only two visible media: Blu-ray discs for games and a Hard Disk for saves. Well, there are a few more, so we will now examine every one of them!</p><div><ul><li id="tab-7-1-cell-bootrom-link"><a href="#tab-7-1-cell-bootrom">Cell BootROM</a></li><li id="tab-7-2-nandnor-flash-memory-link"><a href="#tab-7-2-nandnor-flash-memory">NAND/NOR Flash Memory</a></li><li id="tab-7-3-hard-drive-link"><a href="#tab-7-3-hard-drive">Hard Drive</a></li><li id="tab-7-4-emmc-link"><a href="#tab-7-4-emmc">eMMC</a></li></ul><div><div id="tab-7-1-cell-bootrom"><h4 id="tab-7-1-cell-bootrom">Cell BootROM</h4><p>It turns out, within Cell there’s a small ROM hidden somewhere that manufacturers may store a ‘protected’ boot-loader. IBM provides this space to spare any company (not just Sony) from having to manually implement <a href="https://www.copetti.org/writings/consoles/xbox/#system-protection">tailored obfuscation methods</a> to protect their boot code, as off-the-shelf components are not always prepared for bespoken needs.</p><p>Since this piece is already physically protected with obfuscation, it doesn’t have to be encrypted. Thus, it’s ideal for a first-stage boot-loader (which can’t be encrypted) and the PlayStation 3 stores its early boot stage there.</p></div><div id="tab-7-2-nandnor-flash-memory"><h4 id="tab-7-2-nandnor-flash-memory">NAND/NOR Flash Memory</h4><p>Remember about those <strong>256 MB of NAND flash</strong> I briefly mentioned before? Well, here is where most of the operating system resides. That is, until Sony released the <em>CECHH</em> model in late 2007, replacing the 256 MB NAND for a puny <strong>16 MB NOR</strong>. As a consequence, some files had to be moved elsewhere. For the sake of simplicity, let’s first see what these chips store <sup id="bibref:55"><a href="#bib:operating_system-flash" role="doc-biblioref">[55]</a></sup>:</p><ul><li><strong>Console-specific Loaders</strong>: specifically, two loaders called <code>bootldr</code> and <code>metldr</code>. These files are encrypted with a key engraved during manufacturing, so they can’t be replaced!<ul><li>Be as it may, there are hidden functions in Sony’s hypervisor that allow to update these, although, for some reason, they have never been used <sup id="bibref:56"><a href="#bib:operating_system-psxplace" role="doc-biblioref">[56]</a></sup>.</li></ul></li><li><strong>CoreOS</strong>: the first half of the operating system. It mainly consists of more loaders that will continue the boot process and eventually bootstrap the second half (<strong>GameOS</strong>). CoreOS also supplies the <strong>Recovery Menu</strong>, an alternative shell that contains maintenance utilities that users can use to (attempt to) repair their console.</li><li><strong>Unique IDs</strong>: similar to the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-2-2-kernelipl">PSP’s IDStorage</a>, these are used by the console to control secured hardware like the Blu-ray drive; or by Sony to authenticate the console with their online servers (i.e. the IDPS key).</li><li><strong>Security assets</strong>: some programs depend on them to perform security operations. For instance, Blu-ray movies with DRM check a block called Virtual Table Rights Management (VTRM). Sony also stores <strong>revocation tools and records</strong> to blacklist security certificates that have been compromised in the past.</li></ul><p>Due to their larger size, models with NAND Flash also store the remainder of the OS (called <strong>GameOS</strong> or <code>devflash</code>). This includes:</p><ul><li>The <strong>Visual Shell</strong> (VSH): a continuation of the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#visual-shell">PSP’s signature interface</a>, it’s also bundled with tons of modules (plugins) and assets.</li><li><strong>Emulators</strong>: aforementioned programs that enable a PS3 to run PS1, PS2 or PSP games. The specific PS2 emulator loaded depends on the console revision (whether it has full PS2 hardware, partial hardware or uses no PS2 hardware whatsoever).</li><li><strong>Runtime libraries</strong>: programs developed with Sony’s SDK are dynamically linked to a set of libraries stored here.</li><li><strong>Blu-ray Player</strong>: programs that handle interaction with the Blu-ray drive and movie decoding.</li><li><strong>System assets</strong>: such as fonts and certificates that binaries depend on to work.</li></ul><p>As if it wasn’t enough, NAND consoles also house other data like the <strong>xRegistry</strong> (collection of network settings, PlayStation Network accounts and a list of Bluetooth-paired devices), more revocation records and a Loader for <strong>OtherOS</strong> (a really interesting piece which we’ll discuss more in the next paragraphs).</p></div><div id="tab-7-3-hard-drive"><h4 id="tab-7-3-hard-drive">Hard Drive</h4><p>The debuting 2.5-inch Hard drive, ranging between 20 GB and 500 GB (as more revisions were shipped), provides persistent data storage for:</p><ul><li><strong>User content</strong>: including game saves, trophies (more information in the ‘Games’ section) and other user-related data.</li><li><strong>Game assets</strong>: games can copy files from the disc to the hard disk to improve loading times. These are treated as ‘game data’ by the operating system.</li><li><strong>Cache</strong>: a separate 2 GB partition is available to games for temporary storage (in case main RAM is not enough).</li></ul><p>NOR systems, however, also store GameOS in the HDD. As a consequence, whenever the user swaps out the hard drive, the console asks for an update file to re-install GameOS into the disk. Be as it may, neither NOR nor NAND systems will boot without the hard disk.</p><p>Certain user data can be backed up using a USB stick and then moved to another console if necessary, though this process re-formats the newer console before copying the old data.</p></div><div id="tab-7-4-emmc"><h4 id="tab-7-4-emmc">eMMC</h4><p>In 2012, Sony unveiled a redesigned revision of the console called ‘SuperSlim’ (codenamed CECH-4xxx). These were available in three flavours: One with a 250 GB Hard drive, another with a 500 GB Hard drive, or a third option with only a <strong>12 GB eMMC internal flash</strong>. The first two options follow the file system layout implemented in NOR models, while the third one stores everything in the eMMC (including user data) and follows the NAND layout to store system files.</p><p>There’s a catch in the eMMC model, however. In the place of the NOR chip, Sony fitted a Panasonic ‘MN66840’ chip which, according to the PS3 Dev Wiki <sup id="bibref:57"><a href="#bib:operating_system-MN66840" role="doc-biblioref">[57]</a></sup>, it seems to redirect the NOR bus to the eMMC. I assume this is just a trick to save costs, as it recycles the same Southbridge from the other variants.</p><p>Curiously enough, if the user decides to fit a Hard Drive into the eMMC model, the console moves all user data away from eMMC to the new Hard drive. As a consequence, the user can fully utilise the hard drive, though the empty space in eMMC is now left to waste.</p></div></div></div><h3 id="boot-process">Boot process</h3><p>All right, using all the previous knowledge, you are going to learn now how the system boots up - and let me tell you, it’s pretty complicated. The reason is simple: Sony doesn’t want you fiddling with their hardware or software, so they built many layers of obfuscation and encryption to prevent you from breaking in and side-loading your own code (and hopefully <em>give up and keep buying games/movies/whatever</em>) but, as history will tell you, the opposite happened.</p><p>In the following section, I’m going to describe what this console does once you push the power button. Note that this process only drastically changed once (after hackers cracked it). So, for simplicity purposes, we’ll start with the ‘original’ boot process (implemented before system version <code>3.60</code>)<sup id="bibref:58"><a href="#bib:operating_system-levin" role="doc-biblioref">[58]</a></sup> <sup id="bibref:59"><a href="#bib:operating_system-boot" role="doc-biblioref">[59]</a></sup> <sup id="bibref:60"><a href="#bib:operating_system-the_exploit" role="doc-biblioref">[60]</a></sup>:</p><ol><li>A separate chip in the motherboard (called <strong>Syscon</strong>) powers on and executes instructions from its internal ROM. It then sends a ‘Configuration Ring’ to Cell via SPI (a serial connection), this initialises Cell and deactivates the eighth SPU. Finally, it latches the power line and gives life to Cell.</li><li>Cell’s PPU reset vector points to its hidden ROM, which stores the routines to locate and decrypt <code>bootldr</code> from Flash. The decrypted piece is then loaded by the first SPU in isolation mode.</li><li>The now-isolated SPU, having loaded <code>bootldr</code>, initialises part of the hardware (XDR memory and I/O interfaces) and decrypts a binary named <code>lv0</code> and instructs the PPU to run it.</li><li>The PPU, now executing <code>lv0</code>, decrypts <code>metldr</code> (a console-specific loader) and sends it to the third SPU, again in isolation mode.</li><li>The SPU2, now executing <code>metldr</code>, executes five more loaders sequentially:<ol><li><code>lv1ldr</code> decrypts and loads <code>lv1</code>, which contains the <strong>Hypervisor</strong> that takes over the first privilege level. Moreover, <code>lv1</code> sets up the hard drive, Blu-ray drive and RSX.</li><li><code>lv2ldr</code> decrypts and loads <code>lv2</code>, which contains the kernel and runs on top of the hypervisor. It also finishes initialising RSX, the PS2 emulation, Bluetooth, USB controller and the Multi-card reader.</li><li><code>appldr</code> decrypts and loads <code>vsh</code> (the <strong>Visual Shell</strong>) and other dependencies. <code>vsh</code> will later enable the user to load a game.</li><li><code>isoldr</code> decrypts and loads modules that will run in the third SPU in isolation module. These modules are critical for security and perform many cryptographic functions throughout the console’s lifecycle. Consequently, the <strong>third SPU is reserved for security functions and games can’t use it</strong> (leaving only six SPEs for games).</li></ol></li></ol><p>The PPU, having loaded <code>vsh</code>, grants the user control through a graphical user interface, which manifests itself with an iconic <em>orchestral splash sound</em> followed by the <em>XMB</em> menu.</p><h4 id="revisioned-boot-process">Revisioned boot process</h4><p>In March 2011, a hacker known by the name ‘GeoHot’ broke the security of <code>metldr</code>, thereby compromising the authenticity of subsequent loaders. Thus, Sony retaliated by issuing security updates for both their hardware and software. These fixes are further discussed in the ‘Anti-piracy’ section of this article.</p><h3 id="visual-shell">Visual Shell</h3><p>Are you getting tired from all this theory? Let me switch to something everyone can actually see: The <strong>Visual Shell</strong>.</p><p><strong>XrossMediaBar</strong> (XMB), a new user interface that gained international recognition <a href="https://www.copetti.org/writings/consoles/playstation-portable/#visual-shell">two years before</a>, has been slightly adapted so it can be interacted from the sofa (the so-called ‘10-foot user interface’) and expanded to take advantage of ‘full HD’ resolution (1920x1080 pixels).</p><div><figure><a href="https://www.copetti.org/images/consoles/psp/xmb/main.3f3c9dada3bb82af2858c655906de0d1c2e5f4e3b21e4016c3b8455c23a084ae.jpg"><picture><img alt="Image" width="480" height="272" src="https://www.copetti.org/images/consoles/psp/xmb/main.3f3c9dada3bb82af2858c655906de0d1c2e5f4e3b21e4016c3b8455c23a084ae.jpg" loading="lazy"/></picture></a><figcaption>XMB in the PSP (2004).</figcaption></figure><figure><a href="https://www.copetti.org/images/consoles/ps3/xmb/main.8b18e3646258a98cb2dd42f2645645247e08b8b51c3d96a7b14574e43f92b494.jpg"><picture><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/main.8b18e3646258a98cb2dd42f2645645247e08b8b51c3d96a7b14574e43f92b494.jpg" loading="lazy"/></picture></a><figcaption>XMB in the PS3 (2006).</figcaption></figure></div><p>While PSP users will find many familiarities, Sony added a new set of apps that use the potential of Cell, RSX and the Blu-ray drive. Many of them related to multimedia (i.e. video player and image slideshow), television (such as on-demand TV apps, like BBC’s iPlayer), social profile (online avatars) and online purchases (PlayStation Now and PlayStation Store, to name a few).</p><p>Additionally, since this is a home console that might be shared by multiple members, XMB supports <strong>multiple users</strong>, where each one may use a different PlayStation Network account and store separate user data (purchased games and saves).</p><figure><ul><li id="nestedtab-6-1-game-link"><a href="#nestedtab-6-1-game">Game</a></li><li id="nestedtab-6-2-settings-link"><a href="#nestedtab-6-2-settings">Settings</a></li><li id="nestedtab-6-3-multimedia-link"><a href="#nestedtab-6-3-multimedia">Multimedia</a></li><li id="nestedtab-6-4-installation-link"><a href="#nestedtab-6-4-installation">Installation</a></li></ul><figure id="nestedtab-6-1-game"><a href="https://www.copetti.org/images/consoles/ps3/xmb/game.aeeb3b6f40ef596689eb53f59356d0a3a143cf3d9799ad860bb57307eba1a26f.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/xmb/game.aeeb3b6f40ef596689eb53f59356d0a3a143cf3d9799ad860bb57307eba1a26f_hu_ad0ca41ddea785ea.webp 500w,
https://www.copetti.org/images/consoles/ps3/xmb/game.aeeb3b6f40ef596689eb53f59356d0a3a143cf3d9799ad860bb57307eba1a26f_hu_53fa00888659bb67.webp 800w,
https://www.copetti.org/images/consoles/ps3/xmb/game.aeeb3b6f40ef596689eb53f59356d0a3a143cf3d9799ad860bb57307eba1a26f_hu_7307383d258b837e.webp 1920w"/><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/game.aeeb3b6f40ef596689eb53f59356d0a3a143cf3d9799ad860bb57307eba1a26f.jpg" loading="lazy"/></picture></a><figcaption>Just like in the PSP, highlighting a game may style the background to get your attention!.</figcaption></figure><figure id="nestedtab-6-2-settings"><a href="https://www.copetti.org/images/consoles/ps3/xmb/settings.2f9e55f22bd51fa7b058dd15b8b73dfbd7d83403f24a9d8aa8b0bb6f18bda8ce.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/xmb/settings.2f9e55f22bd51fa7b058dd15b8b73dfbd7d83403f24a9d8aa8b0bb6f18bda8ce_hu_cac7d42a92ac4666.webp 500w,
https://www.copetti.org/images/consoles/ps3/xmb/settings.2f9e55f22bd51fa7b058dd15b8b73dfbd7d83403f24a9d8aa8b0bb6f18bda8ce_hu_aea6a03e60816fc2.webp 800w,
https://www.copetti.org/images/consoles/ps3/xmb/settings.2f9e55f22bd51fa7b058dd15b8b73dfbd7d83403f24a9d8aa8b0bb6f18bda8ce_hu_f23f99a7f2d16e28.webp 1920w"/><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/settings.2f9e55f22bd51fa7b058dd15b8b73dfbd7d83403f24a9d8aa8b0bb6f18bda8ce.jpg" loading="lazy"/></picture></a><figcaption>The XMB provides an immense amount of settings, especially helpful when you need to setup your shiny new 1080p telly with 3.1 surround audio.</figcaption></figure><figure id="nestedtab-6-3-multimedia"><a href="https://www.copetti.org/images/consoles/ps3/xmb/multimedia.b1a3bd2582a4061415358ab7a023712b35ec29187b2d586cda08ac83b8c91b46.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/xmb/multimedia.b1a3bd2582a4061415358ab7a023712b35ec29187b2d586cda08ac83b8c91b46_hu_26cc586529259425.webp 500w,
https://www.copetti.org/images/consoles/ps3/xmb/multimedia.b1a3bd2582a4061415358ab7a023712b35ec29187b2d586cda08ac83b8c91b46_hu_ebbea68a2f59c03f.webp 800w,
https://www.copetti.org/images/consoles/ps3/xmb/multimedia.b1a3bd2582a4061415358ab7a023712b35ec29187b2d586cda08ac83b8c91b46_hu_eb0d8f5487c9a338.webp 1920w"/><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/multimedia.b1a3bd2582a4061415358ab7a023712b35ec29187b2d586cda08ac83b8c91b46.jpg" loading="lazy"/></picture></a><figcaption>Various multimedia options.</figcaption></figure><figure id="nestedtab-6-4-installation"><a href="https://www.copetti.org/images/consoles/ps3/xmb/installpkg.d44c5e705c08a65768465d3a7530863d0d4ea8cb57282fb54ae40ac466d0fdf0.jpg"><picture><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/xmb/installpkg.d44c5e705c08a65768465d3a7530863d0d4ea8cb57282fb54ae40ac466d0fdf0.jpg" loading="lazy"/></picture></a><figcaption>XMB can install games, updates and expansions (DLCs) using a native package installer.</figcaption></figure><figcaption>The PlayStation 3’s XrossMediaBar (XMB) interface</figcaption></figure><p>Finally, the inclusion of a hard drive is a relief for the veterans that in the past were obliged to buy expensive proprietary storage (<a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-3-2-memory-stick-duo">Memory Stick Pro Duo</a>) whenever they ran out of space.</p><h4 id="lend-me-your-ps3">Lend me your PS3</h4><p>Impressively enough, not every app bundled with this console had <em>self-interest</em> goals. With the advent of distributed computing and the capabilities of Cell for data science projects, Stanford University joined hands with Sony to enable PlayStation 3 owners to contribute to medical research. The result was <strong>Folding@home</strong> (pronounced ‘folding at home’).</p><p>Folding@home was an application installed in every PlayStation 3 that, once opened by the user, connected to a central server and ran protein simulations. Moreover, the app was also allowed to run in the background during off-peak times.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/xmb/folding.bbb4874ab92329dc5f9bd80c8e9de19c979cae2c0efa0c99aa4d8057c711eed8.jpg"><picture><img alt="Image" width="1280" height="720" src="https://www.copetti.org/images/consoles/ps3/xmb/folding.bbb4874ab92329dc5f9bd80c8e9de19c979cae2c0efa0c99aa4d8057c711eed8.jpg" loading="lazy"/></picture></a><figcaption>Folding@Home displaying the work accomplished since the user started the app <sup id="bibref:61"><a href="#bib:operating_system-folding_app" role="doc-biblioref">[61]</a></sup>.</figcaption></figure><p>Throughout its lifetime, the joined computing power of 15 million PS3 users worldwide assisted Folding@home with their research towards curing Alzheimer’s disease <sup id="bibref:62"><a href="#bib:operating_system-protein_retirement" role="doc-biblioref">[62]</a></sup>. In the end, Folding@home and Sony retired the app in 2012 and the former lives on on other platforms.</p><p>This is my personal opinion, but I enjoy reading about projects that make global contributions using the capabilities of distributed computing, as opposed to the never-ending sensational articles wining about cryptocurrency mining. I guess we shouldn’t forget that, with every new powerful technology, there will always be selfless applications developed for it.</p><h3 id="a-multi-os-proposal">A multi-OS proposal</h3><p>When IBM described Cell from the software level, they mentioned that Cell is capable of running multiple OS at the same time, due to Cell’s many execution cores <sup id="bibref:63"><a href="#bib:cpu-mit" role="doc-biblioref">[63]</a></sup>. Thus, Sony took this idea forward and added an option in XMB to install a <strong>secondary operating system</strong> <sup id="bibref:64"><a href="#bib:operating_system-open_platform" role="doc-biblioref">[64]</a></sup>. This feature was called <strong>OtherOS</strong> and, in a nutshell, provides a partition manager (XMB just guides the user to resize GameOS’ partition and allocate new space for the second OS) and a button to boot from the second OS (thanks to OtherOS’ boot files already setup in Flash). So, the user just need to fill the new partition with an OS. Consequently, many Linux distributions (i.e. Ubuntu and Fedora) added the PS3 as another possible target to install it on. You may consider this a spiritual successor to <a href="https://www.copetti.org/writings/consoles/playstation-2/#an-unusual-kind-of-game">Linux for PS2</a>.</p><div><figure><a href="https://www.copetti.org/images/consoles/ps3/xmb/red_ribbon.1b33b786942693c2a65cc39f3aee4d931c6ba71c1f35dbac858dafc3039323c9.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/xmb/red_ribbon.1b33b786942693c2a65cc39f3aee4d931c6ba71c1f35dbac858dafc3039323c9_hu_7f8d6f1c7df11ee9.webp 500w,
https://www.copetti.org/images/consoles/ps3/xmb/red_ribbon.1b33b786942693c2a65cc39f3aee4d931c6ba71c1f35dbac858dafc3039323c9_hu_6a9779f8c672cc76.webp 800w,
https://www.copetti.org/images/consoles/ps3/xmb/red_ribbon.1b33b786942693c2a65cc39f3aee4d931c6ba71c1f35dbac858dafc3039323c9_hu_ce986055dac95343.webp 1024w"/><img alt="Image" width="1024" height="768" src="https://www.copetti.org/images/consoles/ps3/xmb/red_ribbon.1b33b786942693c2a65cc39f3aee4d931c6ba71c1f35dbac858dafc3039323c9.png" loading="lazy"/></picture></a><figcaption>Red Ribbon GNU/Linux is a distribution exclusive for the PS3/Cell and compiled using the PPC64 target <sup id="bibref:65"><a href="#bib:operating_system-ribbon" role="doc-biblioref">[65]</a></sup>.</figcaption></figure><p>Thanks to OtherOS, experienced users had the opportunity to develop homebrew applications running on Cell without licensing restrictions, this was particularly interesting for research/scientific purposes <sup id="bibref:66"><a href="#bib:games-cluster" role="doc-biblioref">[66]</a></sup> <sup id="bibref:67"><a href="#bib:operating_system-barcelona" role="doc-biblioref">[67]</a></sup>, as this console carried a more affordable price tag than a mainframe. For multimedia purposes, the Blu-ray drive and Multi-card reader were also accessible from OtherOS.</p><p>On the other side, while OtherOS’ privileges may surpass GameOS’ (at the kernel level), <strong>they don’t overtake the hypervisor</strong>, which still resides in memory. So, any hardware access from OtherOS still depends on the will of Sony’s hypervisor, and it so happens that the latter <strong>blocks access to RSX’s command buffers</strong> (preventing the use of the shader units, among other components used for accelerating graphics operations). Consequently, resulting Linux distribution resort to software rendering (all graphics are drawn by Cell) and then stream the frame-buffer to the RSX for display. While it’s disappointing that OtherOS can’t make use of the full capabilities of this console, this was probably done to reduce attack surfaces. Ironically, OtherOS’ use of Cell is similar to how IBM/Toshiba/Sony may have originally envisioned the PS3!</p></div><p>Sharing the same fate of Folding@home, OtherOS was eventually removed in a subsequent update, but due to different causes (mainly related to security). Shortly afterwards, OtherOS was <em>unofficially</em> restored thanks to software exploits and reverse engineering efforts. At the moment, OtherOS is available if the user installs a <em>custom firmware</em>. I explain this further in the ‘Anti-piracy and homebrew’ section.</p><p>At the time of this writing, developer René Rebe is currently implementing proper xf86 drivers that take advantage of the acceleration provided by RSX and its 256 MB of memory <sup id="bibref:68"><a href="#bib:operating_system-rsxx11" role="doc-biblioref">[68]</a></sup>. His work is combined with other developments that removed the restrictions imposed by the hypervisor (initially thanks to the discovery of software exploits and later with the use of a <em>custom firmware</em>, the latter is explained further in the ‘Anti-piracy and homebrew’ section). Mr. Rebe publishes his progress on his Youtube channel and relies on voluntary donations to continue his work <sup id="bibref:69"><a href="#bib:operating_system-rsxfund" role="doc-biblioref">[69]</a></sup>.</p><h3 id="updatability">Updatability</h3><p>For the final part of this long section, let’s talk about the updatability capabilities of GameOS.</p><p>In a nutshell, just like the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#updatability">PSP</a>, Sony distributed <code>PS3UPDAT.PUP</code> files that package all the new OS binaries. Due to the console’s security system, only those files which aren’t secured with unique console keys and are stored in re-writable storage (Flash, Hard drive, eMMC) are updatable, the rest must stay as it is.</p><p>PUP files were distributed through Sony’s official website, the XMB update assistant or found in the contents of a game disc (all games embed a PUP file, reflecting the SDK version developed for). Since models with NAND Flash contain only 256 MB of space and store the whole OS there, Sony never released update files with sizes higher than 256 MB.</p><hr/><h2 id="games">Games</h2><p>This section encompasses topics related to game development, distribution and services.</p><h3 id="development-ecosystem">Development ecosystem</h3><p>As this console amalgamates technology from various companies, including products already commercialised in other markets (i.e. Nvidia’s GeForce7 GPU line for PCs), developers were drowned with many different tools to develop their software. Note that this doesn’t imply development was easy, but it’s something to appreciate compared to the <a href="https://www.copetti.org/writings/consoles/master-system/#games">assembly days</a>.</p><p>To program Cell, IBM and Sony shipped separate development suites, IBM ones targeted non-restrictive environments like Linux (and OtherOS), while Sony’s tools explicitly targeted the PS3’s GameOS as the only execution environment.</p><p>Having said that, IBM distributed the <strong>IBM Cell SDK</strong> package for free <sup id="bibref:70"><a href="#bib:games-cell_programming" role="doc-biblioref">[70]</a></sup>. It includes the <strong>GCC toolchain</strong> modified to generate PPU and SPU binaries, allowing to development in C, C++, Fortran and assembly. It’s also cross-platform, enabling to compile code from other equipment (like an x86 PC). The SDK also included low-level libraries to facilitate SIMD mathematical operations and SPU-PPU management. Finally, it bundled a fork of <strong>Eclipse</strong> IDE.</p><p>To ease the complexity of Cell development, IBM also developed another short-lived compiler called <strong>XLCL</strong> that compiles <strong>OpenCL</strong> code (C/C++ variant for parallelised computations) for the PPU and SPU. Though this was only distributed through IBM’s Alphawork’s channel, meaning it remained experimental.</p><p>Now, what about Sony? Well, similarly to their <a href="https://www.copetti.org/writings/consoles/playstation-portable/#development-ecosystem">PSP SDK</a>, they shipped hardware devkits (many variants with different sizes and enhancements) and a software package made of compilers, libraries and debuggers that used Visual Studio 2008 (and later 2010) as an IDE <sup id="bibref:71"><a href="#bib:games-napier" role="doc-biblioref">[71]</a></sup>. Since they only supported the PS3, their SDK included the same GCC toolchains but complemented with tons of libraries to assist in graphics tasks, audio and I/O. In the case of graphics/RSX, Sony provided <strong>GCM</strong> to build raw commands and <strong>psGL</strong>, built on top of GCM, to provide an OpenGL ES API. To write shaders, Nvidia provided <strong>Cg</strong>, a shader compiler that parses a language similar to HLSL (the shader language defined by Microsoft).</p><h4 id="license-free-development">License-free development</h4><p>With the advent of native Homebrew (running on GameOS, not OtherOS), new open-source SDKs were created to bypass the dependency of Sony’s copyrighted libraries and therefore prevent copyright litigation. One example is <strong>PSL1GHT</strong>, an SDK used in conjunction with <strong>ps3toolchain</strong> <sup id="bibref:72"><a href="#bib:games-ps3toolchain" role="doc-biblioref">[72]</a></sup>, to provide a full development suite ready for developing legal Homebrew (though this requires a modified/hacked console with signature checks disabled).</p><p>Back in 2018, I built my own suite based on ps3toolchain but distributed in the form of a Docker container <sup id="bibref:73"><a href="#bib:games-docker" role="doc-biblioref">[73]</a></sup>, so developers wouldn’t need to compile ps3toolchain and instead download my pre-compiled setup (saving many hours of compilation time). The container also bundled many tools like Nvidia’s Cg shader to mitigate dependency problems that I found while experimenting with PSL1GHT-based project. In the end, it was a fun experiment that helped me learn more about the development environment.</p><h4 id="outsourcing-development">Outsourcing development</h4><p>It’s worth pointing out that a peculiar business-to-business model raised in popularity during that time: <strong>Game Engines</strong>. Instead of spending time and money developing a game from the ground up, why not buy the codebase of other companies and build the game on top of that? This is what game studios like Epic Games envisioned <sup id="bibref:74"><a href="#bib:games-unreal" role="doc-biblioref">[74]</a></sup>. Apart from selling popular game titles such as <em>Unreal Tournament 3</em>, the studio licensed a stripped-down version (without the assets) to other developers. This was packaged and named <strong>‘Unreal Engine 3’</strong>. In a nutshell, game engines take care of all the fundamental areas (physics, lighting, etc) so developers only have to add their custom content (scripts, textures, models, sounds, etc.).</p><p>Game engine licensing is not a new business model, but due to the challenging environment of the PS3, they eventually became another attractive option for development.</p><h3 id="storage-medium-1">Storage Medium</h3><p>Now that we’ve finished talking about game development, it’s time for distribution. So, here I describe the official distribution mechanisms available for PS3 games.</p><div><ul><li id="tab-8-1-blu-ray-discs-link"><a href="#tab-8-1-blu-ray-discs">Blu-ray Discs</a></li><li id="tab-8-2-online-store-link"><a href="#tab-8-2-online-store">Online Store</a></li></ul><div><div id="tab-8-1-blu-ray-discs"><h4 id="tab-8-1-blu-ray-discs">Blu-ray Discs</h4><figure><a href="https://www.copetti.org/images/consoles/ps3/games/retail.f44495b38282a148cb818713d82309af5da67f25c7fe22786742f4fce5f4f6ff.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/games/retail.f44495b38282a148cb818713d82309af5da67f25c7fe22786742f4fce5f4f6ff_hu_ac26286736f8da5d.webp 500w,
https://www.copetti.org/images/consoles/ps3/games/retail.f44495b38282a148cb818713d82309af5da67f25c7fe22786742f4fce5f4f6ff_hu_68b3340c398af843.webp 800w,
https://www.copetti.org/images/consoles/ps3/games/retail.f44495b38282a148cb818713d82309af5da67f25c7fe22786742f4fce5f4f6ff_hu_ba90754c8e05178d.webp 900w"/><img alt="Image" width="900" height="596" src="https://www.copetti.org/images/consoles/ps3/games/retail.f44495b38282a148cb818713d82309af5da67f25c7fe22786742f4fce5f4f6ff.jpg" loading="lazy"/></picture></a><figcaption>Example of retail game.</figcaption></figure><p>New generation = new medium. As the advantages of DVD start to wear down and its limitations, expressed by the game industry (space limit) and the film industry (480i format) <sup id="bibref:75"><a href="#bib:games-dvd" role="doc-biblioref">[75]</a></sup>, become apparent, it’s a matter of time before Sony unveils <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-3-1-umd-discs">another standard</a> to replace their new appliances. For this new console, the <strong>Blu-Ray disc</strong> was chosen.</p><p>The Blu-ray, as the name indicates, is a new optical disc format that delivered higher storage density thanks to the use of <strong>blue light diodes</strong> <sup id="bibref:76"><a href="#bib:games-brit" role="doc-biblioref">[76]</a></sup>, as opposed to red diodes used with DVDs. Since blue light has a shorter wavelength than red light, more information (<a href="https://www.copetti.org/writings/consoles/playstation/#anti-piracy--region-lock">pits and lands</a>) can be squashed together in the same space <sup id="bibref:77"><a href="#bib:games-blue_laser" role="doc-biblioref">[77]</a></sup>. As a result, Blu-ray discs provide a surprisingly large capacity (between 25 GB and 50 GB!) using the same plastic disc with the same dimensions as the CD/DVD.</p><p>The Blu-ray data format responds to many needs by different industries: high definition film, digital rights management (DRM), region locking, a new file system and even a runtime environment for Java programs <sup id="bibref:78"><a href="#bib:games-bdj" role="doc-biblioref">[78]</a></sup>. In the case of the video game industry, retail games for PlayStation 3 were distributed in <strong>25 GB or 50 GB</strong> Blu-ray discs with <strong>copy protection</strong>. These are read by a 2x drive reaching speeds of up to 8.58 MB/sec <sup id="bibref:79"><a href="#bib:io-bd_rev" role="doc-biblioref">[79]</a></sup>, though the PS3’s laser can also read DVDs (at 8x speed) and CDs (at 24x speed) to play old games and movies.</p><p>While launch titles execute from the disc, later games copied part of their assets to the Hard Drive to increase reading speeds. Nevertheless, the game disc is always needed to kickstart the game.</p></div><div id="tab-8-2-online-store"><h4 id="tab-8-2-online-store">Online Store</h4><p>At the same time of the console’s release, Sony launched its proprietary distribution channel called <strong>PlayStation Store</strong>, allowing game studios to sell their games digitally and users to purchase new content without leaving their sofa. These don’t require any physical medium to work (apart from space in the hard drive) but the digital product’s ownership is tied to an online account, something that became a concern for users in March 2021, when Sony announced <sup id="bibref:80"><a href="#bib:games-closure" role="doc-biblioref">[80]</a></sup> (and later retracted <sup id="bibref:81"><a href="#bib:games-reversal" role="doc-biblioref">[81]</a></sup>) the closure of this store.</p><p>Within their digital store, Sony also took the opportunity to sell digitalised versions of PS1, PS2 and PSP games called <strong>PlayStation Classics</strong>. These are also downloaded and installed in the same way, but use the bundled emulators to work. In fact, PS2 classics invoke the same unaccelerated software emulator independently whether the PS3 models contain the PS2 chipset <sup id="bibref:82"><a href="#bib:io-ps2emu" role="doc-biblioref">[82]</a></sup>! I guess this is the closing chapter for hardware-based emulation in the PS3.</p><p>Behind the scenes, the PS Store is just a website only accessible through the PS Store app in XMB. Throughout its lifecycle, its user interface has been revamped a few times to reflect what I suppose was <em>a global demand for more fancy user interfaces</em>.</p></div></div></div><h3 id="network-service">Network service</h3><p>Apart from the online store, there were many more online solutions added to the platform, including the debuting <strong>PlayStation Network</strong>, a free online service competing directly with Microsoft’s paid-for <a href="https://www.copetti.org/writings/consoles/xbox/#network-service">Xbox Live</a>.</p><p>PlayStation Network enabled users to create a personal account and assign an avatar, then use that new digital persona to do multiplayer gaming, message and other social interactions. Users can also earn <strong>trophies</strong> if they complete a certain event in a game, and these then show up in the online profile (as in some form of medal of honour) to intimidate rivals and gain the respect of friends, I think.</p><p>Last but not least, just like having an updatable operating system, games are updated too. Hence, upon launching a game, XMB may suggest downloading game updates (in the form of ‘packages’) that patch glitches and/or add new content. Updates install in the hard drive and work similarly to a <em>layered file system</em>.</p><hr/><h2 id="anti-piracy-and-homebrew">Anti-Piracy and Homebrew</h2><p>Everything you’ve just read has to be protected somehow against ‘unauthorised’ access. If you want to know an overview of how Sony carried out that, you are in for a treat.</p><h3 id="security-foundation-overview">Security foundation overview</h3><p>Many parts of the console already provide security features that don’t require any manual implementation in software:</p><ul><li><strong>SysCon</strong>, the obscure proprietary chip (briefly mentioned in the boot process), controls the power lines of Cell, RSX and Southbridge. Its EEPROM contains records read by the operating system’s modules to determine which functions are enabled and which are not <sup id="bibref:83"><a href="#bib:anti_piracy-qaflag" role="doc-biblioref">[83]</a></sup>.<ul><li>Though I use the word ‘obscure’, SysCon is just a microcontroller, either an off-the-shelf <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#cpu">ARM7TDMI</a>-S (that’s right, the PS3 shares some of its DNA with the <a href="https://www.copetti.org/writings/consoles/game-boy-advance/">Game Boy Advance</a> and even late PS2 revisions) enhanced with <a href="https://www.copetti.org/writings/consoles/playstation-2/#interactive-accessories">MagicGate</a> support, or a custom NEC 78K0R variant <sup id="bibref:84"><a href="#bib:anti_piracy-syscon" role="doc-biblioref">[84]</a></sup>. SysCon’s internal firmware is what intrigues the most.</li><li>SysCon and Cell communicate to each other using a serial interface (SPI) which plugs to Cell’s <strong>TEST</strong> component <sup id="bibref:85"><a href="#bib:anti_piracy-cell_test" role="doc-biblioref">[85]</a></sup>. TEST provides many debugging functions on Cell, although SysCon only connects to the ‘Pervasive logic’ port, enabling SysCon to manage areas like power or thermal <sup id="bibref:86"><a href="#bib:anti_piracy-pervasive" role="doc-biblioref">[86]</a></sup>.</li></ul></li><li>Cell houses a <strong>hidden ROM</strong> that store unencrypted boot routines without worrying about snoopers.</li><li>Cell’s <strong>privilege modes</strong> and SPE’s <strong>isolated mode</strong> prevents programs from accessing unauthorised resources.</li><li>The Southbridge seamlessly encrypts the hard drive’s content using AES.</li><li>The Blu-ray subsystem is another walled fortress, and its disc content is encrypted using a key found in the ‘ROM mark’ area of the disc (inaccessible by conventional readers) <sup id="bibref:87"><a href="#bib:anti_piracy-bdauth" role="doc-biblioref">[87]</a></sup>.</li></ul><p>On top of this, Sony implemented the following protections in software:</p><ul><li>A complex <strong>Chain of trust</strong> that starts with Cell’s unencrypted boot ROM and ends with a graphical user interface (XMB) that only loads encrypted binaries (by Sony) under a kernel and hypervisor.<ul><li>The chain of trust implements multiple <strong>encryption algorithms</strong>, including asymmetric ones like RSA and ECDSA and symmetric systems like AES; combined with HMAC and SHA-1 (to confirm the integrity of data).</li></ul></li><li>Some encryption keys are <strong>produced during manufacturing</strong>, meaning if hackers find and leak these keys, they will not work on other consoles. Though this comes at a cost of Sony not being able to patch software encrypted with those keys once the console leaves the factory.<ul><li>These special keys are used for <code>bootldr</code> and <code>metldr</code> (the early boot stages).</li></ul></li><li>Games must call the kernel to access the hardware, which in turn asks the <strong>Hypervisor</strong>. This ‘abstraction onion’ prevents <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-6-1-early-blunders">game exploits</a> from escalating privileges, <em>in theory</em>.</li></ul><h3 id="defeat">Defeat</h3><p>You’ve seen how much this console is capable of, did you expect hackers to settle with the limited features of OtherOS? I guess Sony didn’t either, the company tried hard to protect some areas, while leaving others half-closed, as hackers will later demonstrate.</p><p>Let’s take a look at how some of its strongholds were cracked by independent hackers across the world, bear in mind the PS3 hacking community was very active, with many tools and documentation produced every year. So, I’m going to focus on a few milestones that pave the way to an influx of content and homebrew development, but you can find more info at PS3History <sup id="bibref:88"><a href="#bib:anti_piracy-ps3history" role="doc-biblioref">[88]</a></sup>.</p><div><ul><li id="tab-9-1-hypervisor-bypass-link"><a href="#tab-9-1-hypervisor-bypass">Hypervisor bypass</a></li><li id="tab-9-2-psjailbreak-link"><a href="#tab-9-2-psjailbreak">PSJailbreak</a></li><li id="tab-9-3-honorable-mentions-link"><a href="#tab-9-3-honorable-mentions">Honorable mentions</a></li><li id="tab-9-4-the-fall-of-encryption-link"><a href="#tab-9-4-the-fall-of-encryption">The fall of encryption</a></li></ul><div><div id="tab-9-1-hypervisor-bypass"><h4 id="tab-9-1-hypervisor-bypass">Hypervisor bypass</h4><p>In 2010, after three quiet years in the hacking scene, the community took a turn for the best. George Hotz, a hacker known for previously unlocking the first iPhone model (a.k.a the ‘2G’) so it can work with any network (originally only on Cingular/AT&amp;T), managed to read and write protected areas in memory without being stopped by the Hypervisor. He then published his exploit along with a short summary in his blog <sup id="bibref:89"><a href="#bib:anti_piracy-lv1xploit" role="doc-biblioref">[89]</a></sup>.</p><p>The exploit requires two materials: A Linux installation running under OtherOS (for arbitrary, yet limited, code execution); and an external glitcher connected to the XDR bus (interfacing main RAM). To make a long story short, the hypervisor uses a hash table stored in main RAM to catalogue memory addresses along with their privilege levels, so user programs can’t access protected memory spaces. The attack works by breaking the integrity of such table to be able to write over it, and then use that privilege to modify the entries to grant the current program access to every corner in memory.</p><p>In summary, Hotz discovered that under Linux/OtherOS, programs can request the Hypervisor many blocks of memory pointing to the same physical address, but if the program deallocates them while there’s an external interference in the XDR bus (due to a glitcher sending electrical pulses), the deallocation process ends half-done <sup id="bibref:90"><a href="#bib:anti_piracy-lv1xploit_summary" role="doc-biblioref">[90]</a></sup>. As a consequence, the hypervisor’s hash table (residing in RAM) still contains an entry of the allocated addresses, but at the same time, it thinks that that space has been freed. Hotz’ exploit then proceeds to request more blocks so the Hypervisor extends its table with more entries, and the process continues until an entry of the hash table overlaps the memory location of the block that was supposed to deallocate. Since the hash table kept the old entry granting the user access to that address, the hypervisor ends up giving the user access to modify a hash table entry! Thus, the exploit amends the entry to extend access to all memory space.</p><p>While this exploit required a Linux-running-under-OtherOS environment, it was a huge step towards further reverse-engineering and research projects, since hackers were now able to investigate critical areas of the system that were originally inaccessible. It’s worth mentioning that, during the same time, Sony released software update <code>3.21</code> removing OtherOS. You would think that this would deter hackers from continuing their work, but it just gave them more reasons to speed it up.</p></div><div id="tab-9-2-psjailbreak"><h4 id="tab-9-2-psjailbreak">PSJailbreak</h4><p>Later in 2010, a group identified as ‘PS Jailbreak’ announced (and later released) a unique solution to run Homebrew directly from the console’s native shell (XMB, under GameOS) without requiring to tamper with the console’s hardware. All of this at the dismay of Sony, who will soon take the legal route to block sales of that product.</p><p>‘PS Jailbreak’ consisted of a USB dongle that was plugged into the front USB port before the console was turned on. The user would then have to press the power button and shortly after, the eject button. If the instructions were carried out successfully, users would then see the normal XMB interface but with the addition of an <strong>‘Install PKG’</strong> option and a couple of homebrew apps made to dump Blu-ray games into the hard disk, and then load them.</p><p>Behind the scenes, this dongle carries out a huge amount of work, which can be divided into two groups <sup id="bibref:91"><a href="#bib:anti_piracy-psjail" role="doc-biblioref">[91]</a></sup>:</p><ol><li>The <strong>USB exploit</strong>: Once the console is turned on, the dongle tricks the system into thinking it’s connected to a six-port USB hub, and then performs a complex sequence of USB commands until it reaches a <strong>heap overflow</strong> and escalates access to the PS3’s Kernel (level 2), it then proceeds to execute a payload.</li><li>The <strong>Payload</strong>: this is another complex package that patches the original shell to enable hidden functions only available on debug units (i.e. the ‘Install PKG’ entry), disable signature verification (to load any arbitrary module/package); and redirect Blu-ray commands to the hard drive instead (for loading games from the hard drive). The fact this program can alter so much from the kernel level makes you wonder what’s the hypervisor good at?<ul><li>To complement this, I was later told by M4j0r: “Interestingly it doesn’t even exploit Sony’s code, this part of lv2 was written by Logitech and the developers of that exploit might had access to the source code (due to the 2008 hack).” <sup id="bibref:92"><a href="#bib:operating_system-psxplace" role="doc-biblioref">[92]</a></sup>.</li></ul></li></ol><p>This product was subsequently reversed-engineered by other communities and shortly after, open-source clones appeared (i.e. PS Groove) which removed many restrictions (for instance, users could now unplug the device after the exploit finishes). Some forks were even deployed on a Texas Instruments calculator <sup id="bibref:93"><a href="#bib:anti_piracy-tijb" role="doc-biblioref">[93]</a></sup>. In any case, Sony acted quickly with software update <code>3.42</code> to remove this gold mine <sup id="bibref:94"><a href="#bib:anti_piracy-ps3history" role="doc-biblioref">[94]</a></sup>, although the door for Homebrew was already opened.</p></div><div id="tab-9-3-honorable-mentions"><h4 id="tab-9-3-honorable-mentions">Honorable mentions</h4><p>Before I finally talk about the grand prize of the PS3 homebrew scene, let me describe to you a couple of methods that were developed around the same time:</p><ul><li>The <strong>USB Jig</strong>: another USB stick, this time programmed to trick the console into entering <strong>Factory Service Mode</strong>, which is only intended for servicing the console by authorised personnel. The program embedded in the Jig replicates what Sony provides to their engineers. The main advantage of service mode is to enable to <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-6-2-downgrading">downgrade</a> the console to a PSJailbreak-compatible version. The payload was also available in the form of a Homebrew app for the PSP <sup id="bibref:95"><a href="#bib:anti_piracy-pspjig" role="doc-biblioref">[95]</a></sup>. Sony responded by patching service mode to make it harder to restore it to ‘normal’ mode or alter the firmware from it, discouraging users from resorting to Service mode.</li><li>The <strong>Optical Disc Emulator</strong> (ODE): a series of hardware products that different companies (Cobra, E3, etc) shipped. Instead of tampering with the console’s firmware, these tampered with the Blu-ray’s SATA/PATA interface. ODEs are boards that sit between the motherboard and the Blu-ray drive, thereby acting as a middleman that tricks the console into thinking it contains a valid disc game, but it’s instead loading a disc image from an external USB drive. The hacking history of the PS3 contains long gaps of ‘unhackable periods’ where there was no software exploit available for new consoles. So, at a hefty price tag, ODEs came to fill that gap.</li><li>The <strong>Downgrader</strong>: as Sony kept mitigating exploits with more software updates, users were left with no viable options but to downgrade to an exploitable firmware. Thus, there were companies like E3 that shipped specialised equipment that could overwrite the console’s system the ‘hard way’. That is, by directly flashing the NAND or NOR chips. For obvious reasons, this method required more skill and patience compared to the USB-based ones.</li><li><strong>Isolated leaks</strong>: this one is for research purposes, as opposed to a ‘feature’ the user will see (but imperative for further developments, nonetheless). Anyway, the revocation data (used to blacklist compromised certificates) is parsed by <code>lv2ldr</code>, so far so good? Well, it was discovered that this process contained many vulnerabilities. Firstly and for some unexplained reason, <strong>revocation data is writable in userland</strong>. Secondly, <strong>the parser doesn’t perform bounds checking</strong> on the data fetched (<a href="https://www.copetti.org/writings/consoles/playstation-2/#tab-5-1-independence-overflow">here we go again</a>). Therefore, hackers managed to craft custom revocation data that could produce a buffer overflow and ultimately enable them to run <strong>arbitrary code inside the SPU’s isolated mode</strong>. This allowed them to get access to confidential data (i.e. keys) that was presumably protected from the rest of the system <sup id="bibref:96"><a href="#bib:operating_system-psxplace" role="doc-biblioref">[96]</a></sup>.</li></ul></div><div id="tab-9-4-the-fall-of-encryption"><h4 id="tab-9-4-the-fall-of-encryption">The fall of encryption</h4><p>Just like the PSP saga, the initial exploits required a lot of effort and could be easily patched by Sony, thereby resulting in a disadvantageous cat-and-mouse game. However, as it happened with the PSP, it was a matter of time before a discovery broke the fundamental security of this system: its chain of trust.</p><p>In 2011, George Hotz (along with the fail0verflow team) published another breakthrough, <strong>the private encryption keys that Sony uses to sign binaries executed by <code>metldr</code></strong>. Binaries loaded during that boot stage are signed with an ECDSA key. Being an asymmetric encryption system, this means that anyone that possesses the private key (Sony, and now <em>others</em>) can encrypt and sign binaries, consequently, they will look ‘authentic’ in <code>metldr</code>’s eyes. Since <code>metldr</code> is the third boot stage before loading <code>lv1</code> (the hypervisor), this means hackers will be able to customise or develop their own hypervisor, kernel and anything underneath it. On top of that, every PlayStation 3 in the market will also think the custom binaries are authentic. All in all, a <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-6-3-pandora">Pandora-style</a> exploit completely done with software.</p><p>The discovery of this key, which should have been computationally unfeasible, is possible thanks to what is considered a ‘blunder’ in Sony’s implementation of the ECDSA algorithm. To make a long story short, the mathematical formula used for ECDSA uses a random value which Sony never changed in all the update files they distributed <sup id="bibref:97"><a href="#bib:anti_piracy-ecsda" role="doc-biblioref">[97]</a></sup>, turning that number into a constant, thereby making it easier to solve the other variables, which is what happened eventually.</p><p>The effects of this discovery are described in the next paragraphs.</p></div></div></div><h3 id="the-custom-firmware-cfw-era">The Custom Firmware (CFW) era</h3><p>Cracking metldr meant everyone was now able to create ‘official’ systems for the PS3, this resulted in an influx of GameOS ‘flavours’ which different communities produced with various customisations. These systems were modifications of Sony’s official firmware files (that Sony distributed as updates) and re-packaged using Sony’s leaked keys, so they could be installed anywhere. The result was called <strong>Custom Firmware</strong> (CFW) and became the de-facto method for hacking this console, that is until Sony responded with tough measures.</p><figure><a href="https://www.copetti.org/images/consoles/ps3/cfw/vshmenu.3299443cbba2b076b3e39a0d286d4d434d47fb7e7d108e2f3c7a3b2919a1d299.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/cfw/vshmenu.3299443cbba2b076b3e39a0d286d4d434d47fb7e7d108e2f3c7a3b2919a1d299_hu_1e4bf72e52119506.webp 500w,
https://www.copetti.org/images/consoles/ps3/cfw/vshmenu.3299443cbba2b076b3e39a0d286d4d434d47fb7e7d108e2f3c7a3b2919a1d299_hu_15a4e05140dfc1fe.webp 800w,
https://www.copetti.org/images/consoles/ps3/cfw/vshmenu.3299443cbba2b076b3e39a0d286d4d434d47fb7e7d108e2f3c7a3b2919a1d299_hu_3672bbfa4f67dad1.webp 1920w"/><img alt="Image" width="1920" height="1080" src="https://www.copetti.org/images/consoles/ps3/cfw/vshmenu.3299443cbba2b076b3e39a0d286d4d434d47fb7e7d108e2f3c7a3b2919a1d299.jpg" loading="lazy"/></picture></a><figcaption>My CFW installation with ‘VSH menu’ opened. This variant (called ‘Rebug’) also enabled me to turn my console into a debugging station (notice the IP address at the bottom right corner, you need to enter it on the debugger to attach to a running process) and fiddle with my own homebrew.</figcaption></figure><p>In the meantime, many CFW appeared on the net with many names (i.e. ‘Rebug’, ‘Ferrox’, etc) and they contained customisations such as <sup id="bibref:98"><a href="#bib:anti_piracy-patches" role="doc-biblioref">[98]</a></sup>:</p><ul><li>Disabling signature verifications on any module installed or to be installed.</li><li>Enabling to read and write (the classic <em>peek and poke</em>) over any memory address, either using the Hypervisor (level 1) or the Kernel (level 2).</li><li>Activating hidden debug functions to install modules packaged as ‘pkg’ files. These didn’t need to be signed with Sony’s keys to work inside a CFW environment.</li><li>Enabling to mount disc images as a virtual Blu-ray disc.</li><li>Restoring OtherOS and even enhance it by removing the restrictions imposed by the Hypervisor. The result was called OtherOS++.</li><li>Writing over Syscon EEPROM’s database to enable to install any system version of choice. This is also known as <em>QA Toggling</em>.</li><li>Altering the style of XMB (i.e. removing the epilepsy warning, allow to take screenshots in-game, etc).</li></ul><p>There’s also my favourite one: bring the debugging functions of a testkit, allowing any retail console to become a debugging station. This could be done either by installing a CFW with debugging capabilities, or a CFW that could convert the retail console (called ‘CEX’) into a debugging model (called ‘DEX’) by altering console-specific data in Flash memory.</p><h4 id="sonys-strong-response">Sony’s strong response</h4><p>Similarly to the events that happened after <a href="https://www.copetti.org/writings/consoles/playstation-portable/#tab-6-4-cfw-and-beyond">CFWs</a> were invented for the PSP, Sony retaliated with two security updates:</p><p>From the <strong>software side</strong>, Sony shipped two system updates that enhanced the security system:</p><ul><li>With <code>3.56</code>, binaries are signed with new encryption keys resilient to the previous ECSDA discovery <sup id="bibref:99"><a href="#bib:anti_piracy-keys" role="doc-biblioref">[99]</a></sup>, thus, CFW creators can’t customise the new binaries (since they don’t have the private keys to re-encrypt them). Furthermore, a new revision of the ‘system updater’ application is also shipped, this enforces the new certificates in system update files (<code>PS3UPDAT.PUP</code>), meaning that even if hackers manage to package a new CFW, only consoles with system version <code>3.55</code> or lower will be able to install it <sup id="bibref:100"><a href="#bib:anti_piracy-spkg" role="doc-biblioref">[100]</a></sup>.</li><li>Later on, system update <code>3.60</code> revamped the boot process, it nullified <code>metldr</code> and promoted <code>lv0</code> to take over in bootstraping the loaders (<code>lv1ldr</code>, <code>lv2ldr</code>, <code>appldr</code> and <code>isoldr</code>). All in all, this meant hackers could not modify the new system files without first cracking <code>lv0</code> (finding its private key).<ul><li>This eventually happened in late 2012, when a team called “The Three Musketeers” published the lv0 keys <sup id="bibref:101"><a href="#bib:anti_piracy-lv0leak" role="doc-biblioref">[101]</a></sup>, which paved the way to new CFWs made from system versions newer than <code>3.55</code>. Although, due to the aforementioned changes in the updater, only users on system version <code>3.55</code> or lower (including any CFW with signature checks disabled) can install it.</li></ul></li></ul><p>From the <strong>hardware side</strong>, not only subsequent PS3 models (late CECH-25xxx, CECH-3xxx and CECH-4xxx) came pre-installed with a system version higher than <code>3.55</code>, but they also contain a different variant of <code>bootldr</code>/<code>lv0ldr</code> (called <code>lv0ldr.1</code>) that not only decrypts and loads <code>lv0</code> but it also fetches a new system file called <code>lv0.2</code>. The latter contains metadata about <code>lv0</code> <sup id="bibref:102"><a href="#bib:anti_piracy-lv0ldr" role="doc-biblioref">[102]</a></sup> to ensure that <code>lv0</code> hasn’t been tampered with. <code>lv0.2</code> is signed with a new key (also invulnerable to the previous ECDSA discovery), thus, preventing hackers from taking control of the boot chain.</p><p>To this day, <strong>these models are not able to run a CFW</strong>, therefore nicknamed <em>unhackables</em>. Though they can run a ‘Hybrid Firmware’ (HFW) and we’ll discuss more about it later on.</p><p>As time went by, the number of CFW-compatible consoles only decreased. Hence, PS3s that weren’t updated past 3.55 became some sort of <em>relics</em>. In the meantime, there was a surge in demand for alternatives, like downgraders (to revert to system version <code>3.55</code> on old models) and ODEs (to play pirated games on new models).</p><h4 id="homebrew-revival">Homebrew revival</h4><p>After a long waiting period for users that missed the window to install a CFW, in late 2017, a team of hackers released <strong>PS3Xploit</strong>, a collection of exploits and utilities <sup id="bibref:103"><a href="#bib:anti_piracy-ps3xploit" role="doc-biblioref">[103]</a></sup> that brought back the ability to install a CFW on old models without needing an expensive downgrader (and skills to operate it).</p><p>PS3Xploit’s main payload replicates the job of a hardware downgrader (patching CoreOS files) entirely by software, it works as follows:</p><ol><li>The starting point is the XMB’s internet browser, built on top of WebKit. PS3Xploit uses JavaScript to gain <strong>arbitrary code execution within the system’s userspace</strong> (and outside JavaScript’s environment). To kickstart this, users only have to open XMB’s native web browser, enter an URL pointing to the PS3Xploit’s host an let it do its job.</li><li>It so happens the kernel provides system calls that can be used to <strong>overwrite the operating system’s files in Flash memory</strong>. On top of this, the Visual Shell (XMB) and its plugins store routines in memory that make use of those calls.</li><li>PS3Xploit can’t trigger those system calls directly due to the Hypervisor’s ‘no-execute’ protection, preventing the exploit from loading new code in userland. However, it can find a way to overwrite Flash memory by ‘borrowing’ Visual Shell’s routines.</li><li>Consequently, PS3Xploit proceeds to modify Webkit’s execution stack to redirect execution to Visual Shell’s routines. This type of technique (corrupting the stack to deviate execution to other code residing in memory) is called <strong>Return Oriented Programming</strong> (ROP) and it’s very popular in the InfoSec genre. One way of mitigating this is by implementing <strong>Address space layout randomisation</strong> (ASLR), which makes it difficult to guess the location of the routines (called <em>gadgets</em>) but, as you can guess, Sony’s hypervisor lacks ASLR.</li><li>Finally, those system calls are triggered with PS3Xploit’s parameters and so they replace CoreOS files (the first part of the operating system, stored in Flash memory) with patched ones <sup id="bibref:104"><a href="#bib:anti_piracy-flash_writer" role="doc-biblioref">[104]</a></sup>.</li><li>The console is now able to install unofficial software updates, an opportunity the user can now <em>exploit</em> to install a custom firmware. However, it can’t downgrade the system version, yet, but once an up-to-date CFW is installed, the user can install further utilities to downgrade the system and install a better-equipped CFW, if so wants.</li></ol><p>As you can see, this <em>gift from the sky</em> brought custom firmwares back into the spotlight and rendered hardware downgraders and ODEs obsolete. On the other side, for those units which couldn’t install a CFW either way (the <em>unhackables</em>), the team later offered <strong>PS3Hen</strong>, a different exploit package that focused on enabling a subset of CFW functions (including the ability to execute homebrew). This one installs itself as an entry in XMB and the user must run it every time they power on their console to re-enable the execution of homebrew apps.</p><h4 id="sonys-partial-response">Sony’s partial response</h4><p>As luck would have it, Sony only took small steps to block PS3Xploit (maybe because this turn of events happened years after the PS3’s successor, the PlayStation 4, hit the stores). They released a few system updates that didn’t fix this chain of exploits but removed the routine used in Webkit for bootstrapping the chain. In response, hackers published slightly modified software updates that restored such entry (and somehow, they didn’t need to be re-signed) <sup id="bibref:105"><a href="#bib:anti_piracy-hfw" role="doc-biblioref">[105]</a></sup>. These custom updates were called <strong>Hybrid firmware</strong> (HFW) and at the time of this writing, they are the de-facto option used to enable homebrew on unhackable systems.</p><p>And here concludes the anti-piracy/homebrew saga. In my humble opinion, I don’t think Sony is interested in putting more effort into this console. So I wouldn’t expect any more cat-and-mouse games in this field.</p><hr/><h2 id="thats-all-folks">That’s all folks</h2><figure><a href="https://www.copetti.org/images/consoles/ps3/myps3s.7da10f2d0858ee2b891ad0cb0e907fb7dcd5e57928c9b7bf17ae4c185477010d.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/ps3/myps3s.7da10f2d0858ee2b891ad0cb0e907fb7dcd5e57928c9b7bf17ae4c185477010d_hu_b739c7e440233b22.webp 500w,
https://www.copetti.org/images/consoles/ps3/myps3s.7da10f2d0858ee2b891ad0cb0e907fb7dcd5e57928c9b7bf17ae4c185477010d_hu_746b42a1b0974ae0.webp 800w,
https://www.copetti.org/images/consoles/ps3/myps3s.7da10f2d0858ee2b891ad0cb0e907fb7dcd5e57928c9b7bf17ae4c185477010d_hu_cfcbd6b7d997bdcc.webp 1111w"/><img alt="Image" width="1111" height="743" src="https://www.copetti.org/images/consoles/ps3/myps3s.7da10f2d0858ee2b891ad0cb0e907fb7dcd5e57928c9b7bf17ae4c185477010d.jpg" loading="lazy"/></picture></a><figcaption>Two PS3s, one playing that game which-shall-not-be-named.</figcaption></figure><p>You made it to the end!</p><p>To be fair, I originally planned this to be a two-month project, but it turned into a whole summer one (and you’ve seen why). In any case, I hope this helped you expand your knowledge about this system and enabled you to understand the reasonings behind the technological progress during that era. This way, you can now think beyond the popular hearsay constantly recycled by <em>the masses</em>.</p><p>If you wonder, for this writing, I’ve used three PS3 models:</p><ul><li>An <em>unhackable</em> CECH-3001 one from my teenage years (for some reason the box says it’s a CECH-25XX model!). It’s been recently taken out of the attic to try out PS3Hen.</li><li>A CECH-2100 that I bought after PS3Xploit came out. With it, I was finally able to install homebrew.</li><li>A CECHA model (only released in Japan) that I acquired in August 2021 to gather material for this article (mostly photography and info about PS2 compatibility). It was quite pricey, luckily the donations of supporters helped me offset the costs.</li></ul><p>While I repeated many times how Cell was groundbreaking technology, you may have noticed that I didn’t mention how unreliable the early models ended up being. It was the first time I heard about a console malfunctioning by just playing a game for a while. Indeed, these things ate electricity like dinosaurs and heat up like an oven (a <em>plastic</em> oven). Luckily, I had a slim model (should’ve been named ‘the-working-one’)… What a rushed era, huh?</p><p>Anyway, as for what’s next on my agenda, I’ll be taking some time off myself before starting the next article, so I can work on other areas to improve the website and catch up on personal stuff.</p><p>Until next time!</p></article></div>
  </body>
</html>
