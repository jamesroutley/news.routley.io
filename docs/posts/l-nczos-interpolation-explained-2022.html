<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mazzo.li/posts/lanczos.html">Original</a>
    <h1>Lánczos Interpolation Explained (2022)</h1>
    
    <div id="readability-page-1" class="page"><div id="wrapper">



<div>
<p>Lánczos interpolation is one of the most popular methods to resize images, together with linear and cubic interpolation. I’ve spent a lot of time staring at images resampled with Lánczos, and a few years ago, I wondered where it came from. While many sources evaluate interpolation filters visually, I couldn’t find a good explanation of how Lánczos interpolation is derived. So here it is!</p>
<p>In this post I do not attempt to explain what a <a href="https://en.wikipedia.org/wiki/Fourier_transform">Fourier transform</a> does, so if you do not know that already you might find the mathematical details unclear. However, I do try to visualize and explain the intuition behind all the ideas.<a href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Before we begin, the images below showcase a variety of images resized with no interpolation, linear interpolation, and Lánczos interpolation. Lánczos produces non-blocky, sharp images, both when upscaling and downscaling.<a href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a><a href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>


<p>We will proceed as follows:</p>
<ol type="1">
<li><a href="#problem">A description of the problem we’re trying to solve;</a></li>
<li><a href="#convolutions">How interpolation can be phrased in terms of convolutions;</a></li>
<li><a href="#sinc">An introduction to <span>\mathrm{sinc}</span>, the “best” interpolation function, together with a quick recap on Fourier transforms;</a></li>
<li><a href="#sinc-in-practice">A concrete example of interpolating with <span>\mathrm{sinc}</span>;</a></li>
<li><a href="#sinc-problems">Why we can’t and shouldn’t use <span>\mathrm{sinc}</span> directly;</a></li>
<li><a href="#lanczos">How <span>\mathrm{sinc}</span> can be modified to make it work well in practice;</a></li>
<li><a href="#closing-thoughts">Some closing thoughts.</a></li>
</ol>
<p>If you’re already familiar with Fourier analysis, section 6 might still be of interest, given that it explains the main ideas behind Lánczos interpolation.</p>
<p>Let’s get started.</p>
<h2 id="problem">The problem <a href="#problem">#</a></h2>
<p>When resizing an image, we generally have a specific target size in mind. In this post, we focus on the general problem of “filling in” the gaps between regularly spaced samples — that is, interpolating. Once we know how to interpolate between samples, we can resample at will, including downsampling and upsampling.</p>
<p>Let’s consider the 1-dimensional case — we’ll see shortly how to extend 1D interpolation techniques to two dimensions. Here’s a 1-dimensional signal sampled at a fixed interval:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-example-fun.svg"/></p>
<p>We’ll generally call the “original” signal from which the samples are taken <span>f(t)</span>, and refer to the input as “time” to go along with digital signal processing terminology.</p>
<p><em>Linear interpolation</em> is just connecting the dots:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-example-fun-linear.svg"/></p>
<p>We’ll call the interpolated signal <span>\bar{f}(t)</span>, shown above in gold. More samples mean better interpolation:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-example-fun-linear-more-samples.svg"/></p>
<div>
<p>Cubic interpolation fits a third-degree polynomial between each point and generally produces a smoother, more pleasant interpolation:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-example-fun-cubic.svg"/></p>
<p>If we can interpolate in one dimension, we can easily extend it to two by first interpolating along one axis, then interpolating the interpolated 1-dimensional signals:</p>
</div>
<div>

<p>Here, the discrete samples are colored, and the interpolated points are shown in black. Note how linear interpolation needs two samples, while cubic needs four – the number of points we need for a unique line and cubic respectively.<a href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<!--
Here's another image explaining in the context of images in particular:

<div class="center-image" style="margin-bottom: 1rem;">
![<small>Courtesy of [ImageMagick](https://legacy.imagemagick.org/Usage/misc/)</small>](/assets/images/imagemagick-interpolation-diagram.png)
</div>
-->
<p>We’ll only be concerned with 1-dimensional interpolation from this point forward.</p>
</div>

<h2 id="convolutions">Interpolation and convolution <a href="#convolutions">#</a></h2>
<p>It is mathematically and practically helpful to frame interpolations as convolutions.</p>
<p>Let’s imagine that our signal <span>f(t)</span> is sampled at regular intervals so that they are <span>1/\xi</span> apart from each other. We’ll say that <span>\xi</span> is the <em>frequency</em> at which the samples are taken – the higher the frequency, the denser the samples. We’ll also use <span>\xi</span> to talk about frequencies in the spectrum of <span>f(t)</span> later on, and relate the two.</p>
<p>For instance, using our previous function and <span>\xi = 2</span>:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-evenly-spaced.svg"/></p>
<p>We’ll refer to a single sample with <span>f_k</span>, where <span>f_k</span> is taken at time <span>k/\xi</span>. Given some interpolation function <span>g</span>, we can convolve it with our discrete samples to get an interpolated signal <span>\bar{f}(t)</span>:</p>
<p><span>
\bar{f}(t) = \sum_{k = -\infty}^{+\infty} g(t - k/\xi) \, f_k 
</span></p>
<p>If the sum above is a bit opaque, don’t worry, visual aid is coming shortly.</p>
<p>Within this framework, linear interpolation can be seen as interpolating with an appropriately scaled triangle function:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-triangle.svg"/></p>
<p>The first thing to note is that when <span>g(t) = \mathrm{triangle}(\xi t)</span>, convolving at the sample points will not change them. Or in other words, the convolution at <span>k/\xi</span> will multiply <span>f_k</span> by <span>1</span>, and all the other <span>f_k</span>s by <span>0</span>, with the result of having <span>\bar{f}(k/\xi) = f(k/\xi)</span>:</p>
<p>Let’s see this in action when <span>\xi = 2</span>, and <span>t = -3/\xi</span>:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-triangle-1.svg"/></p>
<p>We’re showing the interpolating function <span>\mathrm{triangle}(t)</span> in green, the green points are each term of the convolution sum, and the gold point is the interpolated point (that is, the sum of the green points, which is the convolution).</p>
<p>As you can see, the only point that contributes is <span>f_{-3} = f(-3/2)</span>. Note that the only non-zero green point is hidden behind the gold point – since they have the same value.</p>
<p>Leaving the samples intact is a desirable and guiding property for interpolating functions.</p>
<p>Between sample points is where things get interesting:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-triangle-2.svg"/></p>
<p><img src="https://mazzo.li/assets/images/lanczos-triangle-3.svg"/></p>
<p>The triangle will mix the two points to its left and right, producing the linear interpolation in the middle. Running the convolution at every point, we get back our linear interpolation:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-triangle-linear.svg"/></p>
<p>The triangle function is a very basic option, but we’ll soon discuss a fancier interpolation function.</p>
<h2 id="sinc"><span>\mathrm{sinc}</span>, master interpolator <a href="#sinc">#</a></h2>
<p>We now get talking about <span>\mathrm{sinc}</span>, which is the basis for Lánczos interpolation and many other interpolation filters.</p>
<p><span>\mathrm{sinc}</span> is defined as</p>
<p><span>
\mathrm{sinc}(t) = \frac{\sin t}{t}
</span></p>
<p>The hole at <span>t = 0</span> is plugged by setting <span>\mathrm{sinc}(0) = 1</span>. It looks like this:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc.svg"/></p>
<p>The first good property of <span>\mathrm{sinc}</span> is that it interpolates well in the sense that it keeps samples intact: we have <span>\mathrm{sinc}(0) = 1</span>, and then we have evenly spaced zeros. By default the zeros are spaced by <span>\pi</span>, but we can scale it to work with any frequency <span>\xi</span> using <span>\mathrm{sinc}(\pi \xi t)</span>:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-1.svg"/></p>
<p>Just like with <span>\mathrm{triangle}</span>, the samples are preserved, given the very conveniently placed zeros. But just like before, the interesting case is when we’re interpolating <em>between</em> samples:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-2.svg"/></p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-3.svg"/></p>
<p>I’ve centered the interpolation point to better show what happens to the sides. While <span>\mathrm{triangle}</span> considers only the two closest points, <span>\mathrm{sinc}</span> considers an infinite number of points to its left and right.</p>
<p>This is what the full interpolation looks like for our function:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-convolution.svg"/></p>
<p>Nice and smooth!</p>
<p>Beyond being a well-behaved interpolating function, <span>\mathrm{sinc}</span> has a second property which makes it special in this realm.</p>
<p>Before going forward, let’s recap on a few Fourier ingredients:</p>
<ul>
<li><p>A <a href="https://en.wikipedia.org/wiki/Dirichlet_conditions#Dirichlet_conditions_for_Fourier_transform">very large class of functions</a> can be represented as the sum of <span>\cos \pi \xi</span> and <span>\sin \pi \xi</span> oscillations (or frequencies).</p></li>
<li><p>The <em>Fourier transform</em> <span>\mathcal{F}\{f(t)\}(\xi)</span> of <span>f(t)</span> tells us “how much” of a frequency <span>\xi</span> is present in <span>f(t)</span>.</p></li>
<li><p><span>\mathcal{F}\{f(t)\}</span> uniquely determines <span>f</span>, and vice-versa.</p></li>
</ul>
<div>
<p><span>\mathrm{sinc}</span>’s Fourier transform<a href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a> looks a bit like a brick wall. Here it is compared to the spectrum of <span>\mathrm{triangle}</span>:<a href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-vs-triangle.svg"/></p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-vs-triangle-spectrum.svg"/></p>
<p>The spectrum of <span>\mathrm{sinc}(\pi t)</span> is constant within <span>1/2</span>, and <span>0</span> elsewhere. Or in other words, <span>\mathrm{sinc}(\pi t)</span> contains a constant amount of frequencies below <span>1/2</span>, and no frequencies beyond that.</p>
<p>The spectrum of <span>\mathrm{triangle}</span>, on the other hand, tapers smoothly. This tapering reflects the blurring we witness when resizing images with linear interpolation.</p>
<p>If we increase the <span>\xi</span> in <span>\mathrm{sinc}(\pi \xi t)</span>, the spectrum will widen accordingly:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-vs-sinc2.svg"/></p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-vs-sinc2-spectrum.svg"/></p>
</div>

<p>With <span>\xi = 2</span> the spectrum is now of width <span>1</span>, although with halved magnitude. The halving is compensated by the fact that we have double the zeros (that is, double the samples when interpolating).</p>
<p>When we’re interpolating by convolving we’re adding up scaled versions of <span>\mathrm{sinc}</span>:</p>
<p><span>
\bar{f}(t) = \sum_{k = -\infty}^{+\infty} \mathrm{sinc}(\xi \pi (t - k/\xi)) \, f_k 
</span></p>
<div>
<p>This means that the spectrum of <span>\bar{f}(t)</span> will also be limited to <span>\xi/2</span> just like <span>\mathrm{sinc}(\pi \xi t)</span> is.<a href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>Moreover, <em>samples taken at a rate of <span>\xi</span> uniquely identify functions with a spectrum of width less than <span>\xi/2</span></em>. Or in other words, there’s only one function with frequencies limited to less than <span>\xi/2</span> passing through a given set of samples taken at a rate of <span>\xi</span>.</p>
<p>Intuitively, what this means is that if we take enough samples, the frequencies have nowhere to hide and are fully determined by the samples.</p>
</div>

<div>
<p>This key fact is known as the Shannon-Nyquist sampling theorem,<a href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a> and implies that if the spectrum for <span>f(t)</span> is narrower than <span>\xi/2</span>, and if we generate <span>\bar{f}(t)</span> using <span>\mathrm{sinc}(\pi \xi t)</span>, we’ll have that <span>f(t) = \bar{f}(t)</span>.</p>
<p>So, if we sample densely enough, <span>\mathrm{sinc}</span> can reconstruct continuous signals from discrete samples <em>perfectly!</em> This is the sense in which <span>\mathrm{sinc}</span> is the “best” interpolating function, given that it is the <em>only</em> function with these characteristics.</p>
<p>We’ve gone through a lot of mathy details quickly, but what’s important to remember is:</p>
<ul>
<li><span>\mathrm{sinc}</span> interpolates leaving samples intact;</li>
<li>The spectrum for <span>\mathrm{sinc}(\pi \xi t)</span> is constant within <span>\xi/2</span>, and zero otherwise;</li>
<li>Convolving adds scaled and translated versions of <span>\mathrm{sinc}(\pi \xi t)</span>, so the spectrum of the convolution will still be constrained to <span>\xi/2</span>;</li>
<li>The facts above, together with Shannon-Nyquist, allow <span>\mathrm{sinc}</span> to reconstruct signals perfectly, assuming we sample densely enough.</li>
</ul>
<p>In the next section we’ll gain a more intuitive understanding for how this process works out.</p>
</div>

<h2 id="sinc-in-practice"><span>\mathrm{sinc}</span> in practice <a href="#sinc-in-practice">#</a></h2>
<p>Let’s put this knowledge in action with our example function, which just so happens to be formed of three individual frequencies:</p>
<p><span>
f(t) = \sin \pi \frac{t}{5} + \frac{1}{2}\cos \pi t + \frac{1}{3}\sin \pi 2 t
</span></p>

<p>Usually, the Fourier transform of a function will be continuous. However, since we’re dealing with three isolated frequencies, for this signal it will not even be a proper function, but rather one impulse for each of the three frequencies. We might plot as follows:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-example-fun-freqs.svg"/></p>
<p>Shannon-Nyquist tells us that that we need to sample at a frequency greater than twice the maximum frequency in the spectrum. In this case the maximum frequency is <span>1</span>, so we need to sample using some <span>\xi &gt; 2</span>. If we do that and convolve with a scaled <span>\mathrm{sinc}</span>, we should reconstruct the signal exactly:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-reconstruct.svg"/></p>
<div>
<p>The dramatic switch from <span>\xi = 2</span> to <span>\xi = 2.01</span> is no accident: our highest frequency sits right at the boundary of the spectrum, so we need to go past it to capture it.<a href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>While I wanted to give a good intuition on why <span>\mathrm{sinc}</span> is such a mathematically sound interpolator, when interpolating we usually don’t really know nor care what the frequency of the original image is. However, <span>\mathrm{sinc}</span> is still the starting point for many interpolation functions given its ideal properties.</p>
</div>

<h2 id="sinc-problems">The problem with <span>\mathrm{sinc}</span> <a href="#sinc-problems">#</a></h2>
<p>Now that we know about how convolving with <span>\mathrm{sinc}</span> interpolates points, we still face problems. The first problem is evident: to convolve with <span>\mathrm{sinc}</span>, we need to consider all the samples we have every time. This is clearly impractical: we’d need to look at every pixel in the input image to generate each pixel in the output!</p>
<p>The second problem is what happens when our spectrum is <em>not</em> of limited width. Let’s consider a simple stepping function, and its spectrum:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sign.svg"/></p>
<p>As you can see, the spectrum of <span>\mathrm{sgn}(t)</span> tapers but never reaches zero. This makes sense: to identify the precise moment where the function goes from <span>-1</span> to <span>+1</span>, we’d need samples with no distance between them. So we can never reconstruct this function exactly with a finite number of samples.</p>
<p>That said, one might still be surprised at how poorly <span>\mathrm{sinc}</span> performs in situations like this:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-reconstruct-sign.svg"/></p>
<div>
<p>The reconstructed signal repeatedly overshoots and undershoot our original function. These undesirable oscillations, known as <em>Gibbs phenomenon</em>, show up all the time in Fourier analysis when dealing with jump discontinuities and finite approximations. They are intimately related to <span>\mathrm{sinc}</span> – in a sense the Gibbs oscillations are all ghosts of <span>\mathrm{sinc}</span> in one form or another.<a href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<p>Lánczos interpolation will address both problems presented in this section.</p>
</div>

<h2 id="lanczos"><span>\mathrm{sinc}</span>, chopped and screwed <a href="#lanczos">#</a></h2>
<p>Let’s first consider the problem of <span>\mathrm{sinc}</span> extending into infinity, and therefore requiring to examine all samples. Our first attempt to solve this issue might be just to just set <span>\mathrm{sinc}</span> to zero outside a certain window:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-sinc-3-lobed.svg"/></p>
<p>This allows our convolution to be made up of “only” 7 terms, rather than an infinite number of terms. For images, that would be <span>7 \times 7 = 49</span> terms, given we need to go in both dimensions. Not a tiny number, but manageable.</p>
<p>We’ll refer to function set to zero when <span>|t| \ge a</span> as <span>\langle f(t) \rangle_a</span>:</p>
<p><span>
\langle f(t) \rangle_a = \begin{cases}
 f(t) &amp; \text{if}\ -a &lt; t &lt; a, \\
 0 &amp; \text{otherwise}.
\end{cases}
</span></p>
<p>How will <span>\langle \mathrm{sinc} \rangle_3</span> fare as an interpolation function? The first thing to notice is that we’re still stuck with the Gibbs oscillations in the reconstructed signal:</p>
<p><img src="https://mazzo.li/assets/images/lanczos-truncated-sinc-ringing.svg"/></p>
<p>In images, this shows up in so-called “ringing” artifacts:</p>
<p><picture><source srcset="../assets/images/lanczos-gutenberg-4x-600px-sinc.webp" type="image/webp"/><source srcset="../assets/images/lanczos-gutenberg-4x-600px-sinc.png" type="image/png"/><img src="https://mazzo.li/assets/images/lanczos-gutenberg-4x-600px-sinc.png"/></picture></p>
<p>Those “echoes” around the letters are the same phenomenon as the wobbles in our reconstructed step function. They are particularly evident in images when text is present – the glyphs’ edges being our jump discontinuities.</p>
<p>However, to characterize how <span>\langle \mathrm{sinc} \rangle_a</span> fares mathematically we can again look at its spectrum compared to <span>\mathrm{sinc}</span>’s. Here’s the spectrum of <span>\langle \mathrm{sinc} \rangle_a</span> with <span>a</span> set to <span>3</span>, <span>5</span>, and <span>10</span> respectively:</p>

<div>
<p>The Gibbs oscillations spoil the fun again. Earlier, we didn’t have enough samples, this time, we have too little <span>\mathrm{sinc}</span>, but it’s the same phenomenon. Lánczos’ key idea was to exploit its specific nature to modify our truncated function and counteract them.<a href="#fn11" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>The oscillations in the spectrum for our truncated function follow a frequency that depends directly on how wide our window is – that is, how big <span>a</span> is. We can immediately see this from the last plot: as we increase <span>a</span>, we’re getting more rapid oscillations.</p>
<p>We’re going to make this precise now, so we need to get a bit technical. The maths is not required to understand the intuition behind Lánczos interpolation – but it is useful to grasp the ideas that underpin it.</p>
<p>We’ve been throwing the Fourier transform around, but let’s define it exactly, alongside its inverse:</p>
</div>

<p><span>
\begin{equation*}
\begin{split}
\mathcal{F}\{f(t)\}(\xi) = &amp; \int_{-\infty}^{+\infty} f(t) \, e^{-2 \pi i \xi t} \, dt \\
f(t) = &amp;\int_{-\infty}^{+\infty} \mathcal{F}\{f(t)\}(\xi) \, e^{+2 \pi i \xi t} \, d\xi
\end{split}
\end{equation*}
</span></p>
<p>As usual we’re packing both <span>\sin</span> and <span>\cos</span> oscillations together using Euler’s formula:</p>
<p><span>
e^{i x} = \cos x + i \sin x
</span></p>
<p>The Fourier transform picks out how much a given frequency contributes to the function by looking how much they “line up”.</p>
<p>What we want to do is modify <span>\langle f(t) \rangle_a</span> so that its spectrum is as close as possible to that of <span>f(t)</span>. Our starting point will be characterizing the nature of the error in the spectrum more precisely. First, let’s split the spectrum of <span>f(t)</span> in three parts:</p>
<p><span>
\mathcal{F}\{f(t)\}(\xi) = \int_{-\infty}^{-a} f(t) e^{-2 \pi i \xi t} \, dt + \int_{-a}^{+a} f(t) e^{-2 \pi i \xi t} \, dt + \int_{+a}^{+\infty} f(t) e^{-2 \pi i \xi t} \, dt
</span></p>
<p>The error for the spectrum of <span>\langle f(t) \rangle_a</span> will be the first and third term:</p>
<p><span>
\mathcal{F}\{f(t)\}(\xi) - \mathcal{F}\{\langle f(t) \rangle_a\}(\xi) = \int_{-\infty}^{-a} f(t) \, e^{-2 \pi i \xi t} \, dt + \int_{+a}^{+\infty} f(t) \, e^{-2 \pi i \xi t} \, dt
</span></p>
<p>These are the annoying oscillations we see for our truncated <span>\mathrm{sinc}</span>s, and that we do <em>not</em> want. Considering only the right hand side of the sum above, and reworking it a bit, we get:</p>
<p><span>
\begin{equation*}
\begin{split}
\int_{+a}^{+\infty} f(t) \, e^{-2 \pi i \xi t} \, dt &amp; = \int_{0}^{+\infty} f(t+a) \, e^{-2 \pi i \xi (t + a)} \, dt\\
                                                     &amp; = e^{-2 \pi i \xi a} \int_{0}^{+\infty} f(t+a) \, e^{-2 \pi i \xi t} \, dt
\end{split}
\end{equation*}
</span></p>
<div>
<p>We’ve now phrased the error as a modulation of the frequency <span>e^{-2 \pi i \xi a}</span>. Again, pause to appreciate that this “carrier wave” gets faster as <span>a</span> grows, which is consistent with how we witnessed our oscillations get more rapid as we truncated <span>\mathrm{sinc}</span> with a wider window.</p>
<p>Here’s the error for the spectrum of <span>\langle \mathrm{sinc} \rangle_3</span>, together with its carrier wave <span>\cos 2 \pi 3 \xi</span>:<a href="#fn12" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<p><img src="https://mazzo.li/assets/images/lanczos-carrier-wave.svg"/></p>
</div>

<p>Lánczos’ next step was to “smooth out” the undesired oscillations by averaging out the result by the period of that frequency:</p>
<p><span>
\text{smoothed} \: \mathcal{F}\{\langle f(t) \rangle_a\}(\xi) = a \int_{\xi-1/2 a}^{\xi+1/2a} \mathcal{F}\{\langle f(t) \rangle_a\}(\xi_0) \, d \xi_0
</span></p>
<p>The period of <span>e^{-2 \pi i \xi a}</span> is <span>1/a</span>, so we modify the spectrum by taking the average with a window of that width at each point.</p>
<p>This is what the “smoothed” spectrum looks like for <span>\langle \mathrm{sinc} \rangle_3</span>, <span>\langle \mathrm{sinc} \rangle_5</span>, and <span>\langle \mathrm{sinc} \rangle_{10}</span>:</p>

<p>It tracks the original spectrum much more closely – in fact it’s useful to focus on the area around the cutoff to see what’s going on:</p>

<div>
<p>The smoothed spectrum <em>does</em> taper a bit earlier. But this is a compromise well worth taking. Moreover, the convergence to the spectrum of <span>\mathrm{sinc}</span> as <span>a</span> grows to infinity is not compromised.</p>
<p>This is all well and good, but how do we apply this in practice? Well, Lánczos’ final trick was to prove that we can smooth out the spectrum of any truncated function in this way by multiplying the function pointwise with <span>\mathrm{sinc}(\pi t / a)</span>. That’s right, it’s <span>\mathrm{sinc}</span> again!</p>
<p>So, instead of <span>\langle f(t) \rangle_a</span>, we’d use</p>
<p><span>
\langle f(t) \rangle_a \, \mathrm{sinc}(\pi t / a)
</span></p>
<p>This <span>\mathrm{sinc}</span> stretched to match the Gibbs oscillations is called the <em>Lánczos window</em>.<a href="#fn13" id="fnref13" role="doc-noteref"><sup>13</sup></a> Wanting to smoothen the spectrum of <span>\langle \mathrm{sinc}(\pi t) \rangle_a</span> itself, we’ll use</p>
<p><span>
\langle \mathrm{sinc}(\pi t) \rangle_a \, \mathrm{sinc}(\pi t / a)
</span></p>
<p>Lánczos interpolation consists of convolving our samples with this chopped and modified <span>\mathrm{sinc}</span>. This is what this new interpolation function looks like:</p>
</div>

<p><img src="https://mazzo.li/assets/images/lanczos-window.svg"/></p>
<p>The plot above shows <span>\mathrm{sinc}_3</span>, the Lánczos window, and their pointwise multiplication. The spectrum is smoothed in exactly the way we desire. <span>\mathrm{sinc}</span> and its spectrum are also shown for reference.</p>
<p>While we set out to mimick <span>\mathrm{sinc}</span>’s spectrum, Lánczos interpolation actually works <em>better</em> than interpolating with <span>\mathrm{sinc}</span> in the presence of jump discontinuities, due to its dampened curve:</p>

<!--
TODO maybe be more specific of when exactly ringing arises?
-->
<p>That said, a bit of ringing remains. This is the main drawback with Lánczos or similar filters, compared to linear interpolation or some cubic filters:</p>
<table>
<thead>
<tr>
<th>
Nearest
</th>
<th>
<span>\langle \mathrm{sinc} \rangle_3</span>
</th>
<th>
<span>\mathrm{Lanczos}_3</span>
</th>
</tr></thead>
<tbody>
<tr>
<td>
<div>
<picture><source srcset="../assets/images/lanczos-gutenberg-4x-linear.webp" type="image/webp"/><source srcset="../assets/images/lanczos-gutenberg-4x-linear.png" type="image/png"/><img src="https://mazzo.li/assets/images/lanczos-gutenberg-4x-linear.png"/></picture>
</div>
</td>
<td>
<div>
<picture><source srcset="../assets/images/lanczos-gutenberg-4x-sinc.webp" type="image/webp"/><source srcset="../assets/images/lanczos-gutenberg-4x-sinc.png" type="image/png"/><img src="https://mazzo.li/assets/images/lanczos-gutenberg-4x-sinc.png"/></picture>
</div>
</td>
<td>
<div>
<picture><source srcset="../assets/images/lanczos-gutenberg-4x-Lanczos.webp" type="image/webp"/><source srcset="../assets/images/lanczos-gutenberg-4x-Lanczos.png" type="image/png"/><img src="https://mazzo.li/assets/images/lanczos-gutenberg-4x-Lanczos.png"/></picture>
</div>
</td>
</tr>
</tbody>
</table>
<p>But for many applications, Lánczos (or something close to it) will be the best compromise.</p>
<h2 id="closing-thoughts">Closing thoughts <a href="#closing-thoughts">#</a></h2>
<p>When I set out to write this post, I wanted to work up to Lánczos interpolation using just high-school maths. I couldn’t find a way to explain it without getting quite technical, so I downgraded to an explanation targetet to an audience who has at least heard of the Fourier transform.<a href="#fn14" id="fnref14" role="doc-noteref"><sup>14</sup></a> That said, I still hope this post could illuminate these key areas in modern engineering through a concrete example.</p>

<p>Cornelius Lánczos himself brought forward a multitude of numerical methods. I highly recommend <a href="https://archive.org/details/appliedanalysis00lanc_0">“Applied Analysis”</a>, the book that introduced the technique explained in this post. Some of it is outdated, explaining how to manually compute roots of polynomials or solutions to linear systems. It’s still very interesting, and written in an unusual conversational style that I find endearing.</p>
<p>Lánczos also strikes me as a delightful man, at least from two interviews I found on YouTube <a href="https://www.youtube.com/watch?v=avSHHi9QCjA">about mathematics</a> and <a href="https://www.youtube.com/watch?v=PO6xtSxB5Vg">about his life</a>.</p>
<p>Another reason to write this blog post was to showcase how much one can get out of software like Mathematica when playing around with such topics. In the end I mostly used Mathematica for plots, but I encourage you to look at <a href="https://mazzo.li/assets/other/lanczos.html">the notebook</a> to get a peek of what’s possible.</p>
<h2 id="acknowledgements">Acknowledgements <a href="#acknowledgements">#</a></h2>
<p>Many thanks to Alex Appetiti, <a href="https://scvalex.net/">Alexandru Sçvortov</a>, Alex Sayers, Stephen Lavelle, and Kurren Nischal for reviewing drafts of this blog post.</p>







</div></div>
  </body>
</html>
