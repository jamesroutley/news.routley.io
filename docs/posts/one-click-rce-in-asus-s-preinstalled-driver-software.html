<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mrbruh.com/asusdriverhub/">Original</a>
    <h1>One-Click RCE in Asus&#39;s Preinstalled Driver Software</h1>
    
    <div id="readability-page-1" class="page"><div>
  
<h2 id="introduction">Introduction</h2>
<p>This story begins with a conversation about new PC parts.</p>
<p><img src="https://mrbruh.com/asusdriverhub/dms.avif" alt="dms.avif"/></p>
<p>After ignoring the advice from my friend, I bought a new ASUS motherboard for my PC. I was a little concerned about having a BIOS that would by default silently install software into my OS in the background. But it could be turned off so I figured I would just do that.</p>
<p><img src="https://mrbruh.com/asusdriverhub/bios.avif" alt="bios.avif"/></p>
<p>Immediately after logging into Windows I was hit with a notification requesting admin permissions to complete the installation of ASUS DriverHub, because I forgot to change the BIOS option. Since I needed to get a WiFi driver for the motherboard anyway, I got curious and installed it.</p>
<p><img src="https://mrbruh.com/asusdriverhub/admin_prompt.avif" alt="admin_prompt.avif"/></p>
<p><em>I don’t have a screenshot of DriverHub but it showed a popup exactly like this in the bottom-right of my screen</em></p>
<h2 id="driverhub">DriverHub</h2>
<p><img src="https://mrbruh.com/asusdriverhub/driverhub_ui.avif" alt="driverhub_ui.avif"/></p>
<p>DriverHub is an interesting piece of driver software because it doesn’t have any GUI. Instead it’s just a background process that communicates with the website <a href="https://driverhub.asus.com">driverhub.asus.com</a> and tells you what drivers to install for your system and which ones need updating. Naturally I wanted to know more about how this website knew what drivers my system needed and how it was installing them, so I cracked open the Firefox network tab.</p>
<p>As I expected, the website uses RPC to talk to the background process running on my system. This is where the background process hosts an HTTP or Websocket service locally which a website or service can connect to by sending an API request to <code>127.0.0.1</code> on a predefined port, in this case <code>53000</code>.</p>
<p>Right about now my elite hacker senses started tingling.</p>
<p><img src="https://media1.tenor.com/m/9Z4aF3ksVH0AAAAd/joey-gibson.gif" alt="joey-gibson.gif"/></p>
<p>This is a very sketchy way to design driver management software. If the RPC isn’t properly secured, it could be weaponized by an attacker to install malicious applications.</p>
<h2 id="finding-the-vulnerability">Finding the Vulnerability</h2>
<p>The next step was to see if I could call the RPC from any website, this was replicated by copying the request from my browser as a curl command and pasting it into my terminal.</p>
<p><img src="https://mrbruh.com/asusdriverhub/copyascurl.avif" alt="copyascurl.avif"/></p>
<p>After fiddling with variations of the command for a while my assumptions were confirmed. DriverHub only responded to requests with the origin header set to “driverhub.asus.com”. So at least this software wasn’t completely busted and evil hackers can’t just send requests to DriverHub willy-nilly.</p>
<p>However I wasn’t done yet, presumably the program checks if the origin is <code>driverhub.asus.hub</code> and if so it’d accept RPC request. What I did next was see if the program did a direct comparison like <code>origin == driverhub.asus.hub</code> or if it was a wildcard match such as <code>origin.includes(&#34;driverhub.asus.com&#34;)</code>.</p>
<p>When I switched the origin to <code>driverhub.asus.com.mrbruh.com</code>, <strong>it allowed my request.</strong></p>
<p>It was obvious now there was a serious threat. The next step was to determine how much damage was possible.</p>
<h2 id="the-extent-of-the-damage">The Extent of the Damage</h2>
<p>By trawling through the Javascript on the website, and about 700k lines of decompiled code that the exe produced, I managed to create a list of callable endpoints including some unused ones sitting in the exe.</p>
<ul>
<li>
<p><strong>Initialize</strong>
This command is used by the website to check if the software is installed and returns basic installation information.</p>
</li>
<li>
<p><strong>DeviceInfo</strong>
This returns all installed ASUS’s software, all installed .sys drivers, all your hardware components, and your MAC address.</p>
</li>
<li>
<p><strong>Reboot</strong>
This reboots the target device immediately without confirmation.</p>
</li>
</ul>
<video width="100%" controls="">
    <source src="reboot_poc.mp4"/>
    Your browser does not support the video lmao
</video>
<ul>
<li>
<p><strong>Log</strong>
This returns a zipped copy of all of DriverHub’s logs.</p>
</li>
<li>
<p><strong>InstallApp</strong>
This installs an app or driver by its ID. The ID’s for all the apps are hard coded in an XML file which is provided by the DriverHub installer.</p>
</li>
<li>
<p><strong>UpdateApp</strong>
This self-updates DriverHub using a provided file URL to download and run.</p>
</li>
</ul>
<h2 id="achieving-rce">Achieving RCE</h2>
<p>I became fixated on the UpdateApp endpoint for obvious reasons. So I spent a few hours exploring the code in ghidra and hitting it with various curl requests to learn the intricacies of how it behaves.</p>
<p>A request to the endpoint looks like this:</p>
<div><pre tabindex="0"><code data-lang="shell"><span><span>curl <span>&#34;http://127.0.0.1:53000/asus/v1.0/UpdateApp&#34;</span> -X POST --data-raw <span>&#39;{&#34;List&#34;: [{&#34;Url&#34;: &#34;https://driverhub.asus.com/&lt;app.exe&gt;&#34;}]}&#39;</span>
</span></span></code></pre></div><p>Here were the observations I had made about the UpdateApp function at that point.</p>
<ul>
<li>The “Url” parameter must contain “.asus.com” but unlike the RPC origin check, it allows stupidity like <code>example.com/payload.exe?foo=.asus.com</code></li>
<li>It saves the file with the filename specified at the end of the URL.</li>
<li>Any file with any extension can be downloaded</li>
<li>If the file is an executable signed by ASUS it will be automatically executed with admin permissions</li>
<li>It will run <em>any</em> executable signed by ASUS, not just a DriverHub installer.</li>
<li><strong>If a downloaded file fails the signing check, it does not get deleted.</strong></li>
</ul>
<p>When I learned that DriverHub validates the signature of the executable I suspected an RCE may no longer be possible, however I soldiered on regardless.</p>
<p>My first thought was potentially a <em>timing attack</em>, where I tell DriverHub to install a valid executable, and after it validates the signature, but just before it installs the exe, I swap it out with a malicious executable. I theorized this could be possible by making two UpdateApp requests in parallel, with the malicious update being just after the legitimate one.</p>
<p>However timing attacks need to be extremely precise and having that timing being affected by files needing to be downloaded made it a very unreliable option. Given that, I decided to take a step back and think if there were any other options.</p>
<p>Eventually I was led back to the standalone WiFi driver I was going to install all along. The driver was distributed in the following zip file.</p>
<p><img src="https://mrbruh.com/asusdriverhub/zip_contents.avif" alt="Zip Contents"/></p>
<p>The files of importance here are the <code>AsusSetup.exe</code>, <code>AsusSetup.ini</code> and <code>SilentInstall.cmd</code>. When executing AsusSetup.exe it first reads from AsusSetup.ini, which contains metadata about the driver. I took interest in a property in the file: <code>SilentInstallRun</code>.</p>
<p>When you double-click AsusSetup.exe it launches a simple gui installer thingy. But if you run AsusSetup.exe with the <code>-s</code> flag (DriverHub calls it using this to do a silent install), it will execute <em>whatever’s</em> specified in SilentInstallRun. In this case the ini file specifies a cmd script that performs an automated headless install of the driver, <strong>but it could run anything</strong>.</p>
<h4 id="here-is-the-completed-exploit-chain">Here is the completed exploit chain</h4>
<ol>
<li>
<p>Visit website with <code>driverhub.asus.com.*</code> subdomain</p>
</li>
<li>
<p>Site makes UpdateApp request for PoC executable “calc.exe”</p>
<blockquote>
<p>“calc.exe” will be downloaded, fail the signature check and not be executed</p>
</blockquote>
</li>
<li>
<p>Site makes UpdateApp request for custom AsusSetup.ini</p>
<blockquote>
<p>This will also be downloaded and not executed</p>
</blockquote>
</li>
</ol>
<div><pre tabindex="0"><code data-lang="ini"><span><span>   <span>[InstallInfo]</span>
</span></span><span><span>   <span>SilentInstallPath</span><span>=</span><span>.\
</span></span></span><span><span><span>   SilentInstallRun=calc.exe</span>
</span></span></code></pre></div><ol start="4">
<li>
<p>Site makes UpdateApp request for signed ASUS binary “AsusSetup.exe”</p>
<blockquote>
<p>This will be downloaded and executed with admin permissions and does a silent install using <code>-s</code>, which will cause it to read the AsusSetup.ini file and run “calc.exe” specified in “SilentInstallRun” also <strong>with admin permissions</strong></p>
</blockquote>
</li>
</ol>
<p>PoC in action:
<video width="100%" controls="">
<source src="website_poc.mp4"/>
Your browser does not support the video lmao
</video></p>
<h2 id="reporting-timeline-ddmmyyyy">Reporting Timeline (DD/MM/YYYY)</h2>
<ul>
<li>07/04/2025 - Found the initial vulnerability</li>
<li>08/04/2025 - Escalated the vulnerability to RCE</li>
<li>08/04/2025 - Reported the vulnerability</li>
<li>09/04/2025 - Automated response from ASUS</li>
<li>17/04/2025 - I followed up and got a human response letting me know they had patched the software and sent me a build to verify</li>
<li>18/04/2025 - ASUS confirmed the fix was live</li>
<li>09/05/2025 - <a href="https://www.cve.org/CVERecord?id=CVE-2025-3462">CVE-2025-3462</a> (8.4) and <a href="https://www.cve.org/CVERecord?id=CVE-2025-3463">CVE-2025-3463</a> (9.4) were published</li>
</ul>
<h2 id="assessing-the-damage">Assessing the Damage</h2>
<p>Almost immediately after reporting the RCE to ASUS I wrote a script to track <a href="https://certificate.transparency.dev/">certificate transparency</a> updates on my VPS, so I could see if anyone else had a domain with <code>driverhub.asus.com.*</code> registered. From looking at other websites certificate transparency logs, I could see that domains and subdomains would appear in the logs usually within a month.</p>
<p>After a month of waiting I am happy to say that my test domain is the only website that fits the regex, meaning <strong>it is unlikely that this was being actively exploited</strong> prior to my reporting of it.</p>
<h2 id="bug-bounty">Bug Bounty</h2>
<p>I asked ASUS if they offered bug bounties. They responded saying they do not, but they would instead put my name in their <a href="https://www.asus.com/content/asus-product-security-advisory/#header2025">“hall of fame”</a>. This is understandable since ASUS is just a <a href="https://companiesmarketcap.com/asus/marketcap/">small startup</a> and likely does not have the capital to pay a bounty.</p>
<h2 id="fun-notes">Fun Notes</h2>
<ul>
<li>
<p>When submitting the vulnerability report through ASUS’s <a href="https://www.asus.com/securityadvisory/">Security Advisory form</a>, Amazon CloudFront <strong>flagged the attached PoC as a malicious request</strong> and blocked the submission. So I had to strip out some of the PoC code and link video recordings instead.</p>
</li>
<li>
<p>If you click “Install All” in DriverHub instead of manually clicking install on each recommended driver, it will also install ArmouryCrate, ASUS’s custom CPU-Z, Norton360 and WinRAR.</p>
</li>
<li>
<p>Their CVE description for the RCE is a little misleading. They say <em>“This issue is limited to motherboards and does not affect laptops, desktop computers”</em>, however this affects any computer including desktops/laptops that have DriverHub installed. Also, instead of them saying it allows for arbitrary/remote code execution they say it <em>“may allow untrusted sources to affect system behaviour”</em>.</p>
</li>
<li>
<p><strong>MY ONBOARD WIFI STILL DOESN’T WORK</strong>, I had to buy an external USB WiFi adapter. Thanks for nothing DriverHub.</p>
</li>
</ul>

<ul>
<li>If you have any questions you can contact me on Signal (preferred) @paul19.84 or via email <code>contact [at] mrbruh.com</code></li>
</ul>

</div></div>
  </body>
</html>
