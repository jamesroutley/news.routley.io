<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ory.dev/login-spa-react-nextjs-authentication-example-api-open-source/">Original</a>
    
    <div id="readability-page-1" class="page"><div><div><div><p>Add authentication and user management to your <a href="https://nextjs.org">Next.js</a>
<a href="https://reactjs.org">React</a> app using the new
<a href="https://nextjs.org/docs/api-reference/edge-runtime">Next.js Edge Runtime</a> and
the <a href="https://github.com/ory/kratos">Ory Kratos open source project</a>! This
example also contains end-to-end tests! To deploy the full and working project, hit the button:</p><p><a href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fory%2Fkratos-nextjs-react-example&amp;env=ORY_SDK_URL&amp;envDescription=Set%20the%20URL%20where%20your%20Ory%20Identity%20Service%20(e.g.%20Ory%20Cloud%20%2F%20Ory%20Kratos)%20is%20running.%20Defaults%20to%20%22https%3A%2F%2Fplayground.projects.oryapis.com%2F%22.%20For%20more%20information%20go%20to%20the%20docs%3A%20https%3A%2F%2Fwww.ory.sh%2Fdocs%2Fconcepts%2Fservices-api.&amp;envLink=https%3A%2F%2Fwww.ory.sh%2Fdocs%2Fconcepts%2Fservices-api&amp;redirect-url=https%3A%2F%2Fconsole.ory.sh%2F"><img src="https://vercel.com/button" alt="Deploy"/></a></p><p>If you like watching videos instead of reading text, watch Vincent&#39;s video tutorial!</p><p><iframe loading="lazy" width="100%" height="315" src="https://www.youtube-nocookie.com/embed/ueEAoTQ-CTo?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" srcdoc="&lt;style&gt;*{padding: 0; margin: 0; overflow: hidden}html, body{height: 100%}img, span{position: absolute; width: 100%; top: 0; bottom: 0; margin: auto}span{height: 1.5em; text-align: center; font: 48px/1.5 sans-serif; color: white; text-shadow: 0 0 0.5em black}&lt;/style&gt;&lt;a href=&#39;https://www.youtube-nocookie.com/embed/ueEAoTQ-CTo?rel=0&amp;autoplay=1&#39;&gt;&lt;img src=&#39;https://img.youtube.com/vi/ueEAoTQ-CTo/hqdefault.jpg&#39;/&gt;&lt;span&gt;â–¶&lt;/span&gt;&lt;/a&gt;"></iframe></p><h2 id="ory-kratos-open-source-identity-platform"><a href="#ory-kratos-open-source-identity-platform" aria-label="ory kratos open source identity platform permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ory Kratos Open Source Identity Platform</h2><p><a href="https://github.com/ory/kratos">Ory Kratos</a> is a full-featured, free, and open
source authentication and identity management platform. It supports multi-factor
authentication with
<a href="https://www.ory.sh/kratos/docs/next/two-factor-authentication-2fa-mfa/">FIDO2, TOTP, and OTP</a>;
<a href="https://www.ory.sh/kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin/">Social Sign In</a>,
<a href="https://www.ory.sh/kratos/docs/next/concepts/identity-schema/">custom identity models</a>;
registration, profile management, account recovery, administrative user
management and so much more! In contrast to other identity systems,
<a href="https://github.com/ory/kratos">Ory Kratos</a> enables you to build your own
<a href="https://github.com/ory/kratos-selfservice-ui-react-nextjs/blob/master/pages/login.tsx">login</a>,
<a href="https://github.com/ory/kratos-selfservice-ui-react-nextjs/blob/master/pages/registration.tsx">registration</a>,
<a href="https://github.com/ory/kratos-selfservice-ui-react-nextjs/blob/master/pages/settings.tsx">account settings</a>,
<a href="https://github.com/ory/kratos-selfservice-ui-react-nextjs/blob/master/pages/verification.tsx">account verification</a>
(e.g. email, phone, activate account),
<a href="https://github.com/ory/kratos-selfservice-ui-react-nextjs/blob/master/pages/recovery.tsx">account verification</a>
(e.g. reset password) user interfaces and user flows using dead-simple APIs.
This guide focuses on integrating with Ory Kratos&#39; session and login APIs. If
you are interested in building your own UI, check out
<a href="https://ory.dev/nextjs-authentication-spa-custom-flows-open-source">Add Custom Login, Registration, User Settings to Your Next.js &amp; React Single Page Application (SPA)</a></p><p>Before we start, let&#39;s get some terminology out of the way:</p><ul><li>At Ory, identity can mean any actor in a system (user, robot, service account,
...). The term <code>user</code> always refers to a human being sitting in front of a
browser or mobile app.</li><li>A session refers to a user&#39;s session in a browser or mobile app after they
have authenticated.</li><li>Self-Service refers to flows the user can do on their own - such as login,
registration, and so on. It does not require administrative / support
intervention.</li></ul><h2 id="nextjs-authentication-with-ory-kratos"><a href="#nextjs-authentication-with-ory-kratos" aria-label="nextjs authentication with ory kratos permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next.js Authentication with Ory Kratos</h2><p>If you want to see a live demo right away, check out
<a href="https://kratos-nextjs-react-example.vercel.app">this app in action</a>.</p><p>You can find the source code for this guide on
<a href="https://github.com/ory/kratos-nextjs-react-example">GitHub</a>. To give it a spin,
clone it and run the following commands:</p><video autoplay="" muted="" loop="" playsinline=""><source src="https://d33wubrfki0l68.cloudfront.net/05742c69bd6b7efe4d7beaa198b952db7078e5aa/8e0f9/images/articles/auth-react-next-vercel/app.mp4" type="video/mp4"/><source src="https://d33wubrfki0l68.cloudfront.net/41a952570b2826633a2703408ff719321a905ef6/3bdd7/images/articles/auth-react-next-vercel/app.webm" type="video/webm"/></video><div data-language="bash"><pre><code><span>git</span> clone https://github.com/ory/kratos-nextjs-react-example.git
<span>cd</span> kratos-nextjs-react-example
<span>npm</span> i</code></pre></div><p>Per default, this app uses the public playground deployment of Ory Kratos at
<code>https://playground.projects.oryapis.com</code>. To use it, simply run:</p><p>If you want to use your own Ory Kratos instance, you can use the <code>ORY_KATOS_URL</code>
or <code>ORY_SDK_URL</code> environment variable. The easiest way to run Ory Kratos is in
an <a href="https://www.ory.sh/docs/start-building/create-project">Ory Cloud Project</a>
<em>(free for developers)</em>! In that case, set the <code>ORY_SDK_URL</code> to your
<a href="https://www.ory.sh/docs/concepts/services-api">project&#39;s SDK url</a>:</p><div data-language="text"><pre><code># If you run Ory Kratos in Ory Cloud:
export ORY_SDK_URL=https://my-project.projects.oryapis.com</code></pre></div><p>You may also run Ory Kratos yourself. A quick way to get started is to run the
Ory Kratos Docker quickstart:</p><div data-language="shell"><pre><code><span>git</span> clone --depth <span>1</span> --branch master https://github.com/ory/kratos.git
<span>cd</span> kratos
<span>git</span> checkout master
<span>git</span> pull -ff
docker-compose -f quickstart.yml -f contrib/quickstart/kratos/cloud/quickstart.yml up --build --force-recreate -d</code></pre></div><p>In that case, set the <code>ORY_SDK_URL</code> to your local Ory Kratos instance:</p><div data-language="shell"><pre><code>
<span>export</span> <span>ORY_KRATOS_URL</span><span>=</span>http://localhost:4455/


<span>npm</span> run dev</code></pre></div><p>Next head over to <a href="http://localhost:3000/">http://localhost:3000/</a> to see the
app in action with login, registration - a working user management!</p><h2 id="create-a-nextjs-single-page-app-with-ory-kratos-from-scratch"><a href="#create-a-nextjs-single-page-app-with-ory-kratos-from-scratch" aria-label="create a nextjs single page app with ory kratos from scratch permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a Next.js Single Page App with Ory Kratos from Scratch</h2><p>To add login / auth to your Next.js app, first create a new Next.js project</p><div data-language="shell"><pre><code>npx create-next-app@latest --typescript</code></pre></div><p>and install the Ory Kratos SDK as well as Ory&#39;s NodeJS integration helpers</p><div data-language="shell"><pre><code><span>npm</span> i --save @ory/integrations @ory/kratos-client</code></pre></div><p>Then we will add Ory&#39;s Next.js Edge-Integration helpers to our project, which
will act as a tunnel to Ory Kratos. You can either conveniently copy this route
from our reference application</p><div data-language="shell"><pre><code><span>curl</span> -o <span>&#34;pages/api/.ory/[...paths].ts&#34;</span> --create-dirs <span>\</span>
  https://raw.githubusercontent.com/ory/kratos-nextjs-react-example/master/pages/api/.ory/%5B<span>..</span>.paths%5D.ts</code></pre></div><p>or manually create a file called <code>pages/api/.ory/[...paths].js</code> in your NextJS
project and copy the following contents:</p><h3 id="add-the-ory-kratos-sdk-to-your-nextjs-app"><a href="#add-the-ory-kratos-sdk-to-your-nextjs-app" aria-label="add the ory kratos sdk to your nextjs app permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add the Ory Kratos SDK to your Next.js App</h3><p>Great, now you have a NextJS app with a login route. If the user is
authenticated we want to show the session. If the user is not signed in, we want
to offer a way to sign up or sign in! Let&#39;s take a look at the home page. First,
we need to add the Ory Kratos SDK to our Next.js app:</p><p>Easy, right? The package <code>@ory/integrations</code> takes care of all the heavy lifting
for you and sets up the SDK so that it connects with the Next.js Edge function
we created in the step prior.</p><h3 id="react-hook-to-find-out-if-a-user-is-authenticated"><a href="#react-hook-to-find-out-if-a-user-is-authenticated" aria-label="react hook to find out if a user is authenticated permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Hook to Find Out if a User is Authenticated</h3><p>Next let&#39;s figure out if the user is authenticated. We will use a React Hook to
check this. We also want to track any errors that may happen as well as creating
a logout url.</p><h3 id="adding-login-and-registration-links-if-the-user-is-not-authenticated"><a href="#adding-login-and-registration-links-if-the-user-is-not-authenticated" aria-label="adding login and registration links if the user is not authenticated permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding Login and Registration Links if the User is Not Authenticated</h3><p>Let&#39;s also show the user a login and registration link if the user has no login
session yet</p><p>or the account settings and logout link if the user is authenticated!</p><p>As you can see, it is really easy to initialize login, registration, and profile
updates. Just create a link!</p><ul><li><code>&lt;a href=&#34;/api/.ory/self-service/login/browser&#34;&gt;</code> will initialize the login
flow.</li><li><code>&lt;a href=&#34;/api/.ory/self-service/registration/browser&#34;&gt;</code> will initialize the
registration flow.</li><li><code>&lt;a href=&#34;/api/.ory/self-service/settings/browser&#34;&gt;</code> will initialize the
account settings flow (needs login).</li><li><code>&lt;a href=&#34;/api/.ory/self-service/verification/browser&#34;&gt;</code> will initialize the
(email, phone, ...) verification flow.</li><li><code>&lt;a href=&#34;/api/.ory/self-service/recovery/browser&#34;&gt;</code> will initialize the
(password, 2fa, ...) recovery flow.</li></ul><h3 id="adding-a-logout-link-for-authenticated-users"><a href="#adding-a-logout-link-for-authenticated-users" aria-label="adding a logout link for authenticated users permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a Logout Link for Authenticated Users</h3><p>To prevent certain types of attack vectors, such as Denial of Service, Ory
Kratos provides a secure logout mechanism. This involves first fetching a logout
URL from the Ory Kratos API and then redirecting the user to that URL if logout
is requested:</p><p>If we do not bind the logout URL to the user&#39;s session, it means that anyone
could load e.g. an image with the logout URL and logout the user without user
interaction:</p><div data-language="html"><pre><code><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span><span>&#34;</span>https://www.example.org/my-vulnerable-logout-command<span>&#34;</span></span> <span>/&gt;</span></span></code></pre></div><p>Ory Kratos protects you from these type of attacks with the flow shown above.</p><h3 id="putting-it-all-together"><a href="#putting-it-all-together" aria-label="putting it all together permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Putting it all Together</h3><p>You&#39;ve made it! Clone the app and try it out right now!</p><div data-language="bash"><pre><code><span>git</span> clone https://github.com/ory/kratos-nextjs-react-example.git
<span>cd</span> kratos-nextjs-react-example
<span>npm</span> i</code></pre></div><p>Or look at the code we wrote above in full below:</p><h3 id="deploy-to-vercel"><a href="#deploy-to-vercel" aria-label="deploy to vercel permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy to Vercel</h3><p>The easiest way to deploy your Next.js app is to use the
<a href="https://vercel.com/new">Vercel Platform</a> from the creators of Next.js. If you
have never deployed on Vercel, check out the
<a href="https://nextjs.org/docs/deployment">Next.js deployment documentation</a> for more
details. Deploying the app is easy. Ensure that your build works by running</p><p>Then, set up your <a href="https://vercel.com/">Vercel</a> account and create a new app.
You will need to configure your
<a href="https://www.ory.sh/docs/concepts/services-api">Ory Cloud Project SDK URL</a> or
the URL of your self-hosted Ory Kratos instance in your Vercel deployment:</p><p><img src="https://d33wubrfki0l68.cloudfront.net/d549d865766879eb82f0122c167fd394aa283fd3/83b94/images/articles/auth-react-next-vercel/vercel-env-var.png" alt="Add Ory Cloud SDK URL to Vercel"/></p><p>By the way! If you want to use separate Ory Kratos deployments for staging,
production, and development then use different SDK URLs for the different
environments by un/selecting the checkboxes in the Vercel UI:</p><p><img src="https://d33wubrfki0l68.cloudfront.net/5705308be22678c6ecfdc54abb872c3d757fab1d/c40d2/images/articles/auth-react-next-vercel/vercel-dev.png" alt="Use a development project for development Vercel"/></p><p><img src="https://d33wubrfki0l68.cloudfront.net/5e84aeb5c492ba6e12b84f6abdfcd4e02025351b/7eb89/images/articles/auth-react-next-vercel/vercel-prod.png" alt="Use a production project for production Vercel"/></p><p>If you want to call Ory Cloud&#39;s Admin APIs from your Next.js Edge serverless
functions, optionally set up the
<a href="https://www.ory.sh/docs/guides/create-personal-access-token">Ory Personal Access Token</a>:</p><p><img src="https://d33wubrfki0l68.cloudfront.net/83b7fe3cfc7121441dd77aa62c3e72607456967c/5a2ca/images/articles/auth-react-next-vercel/vercel-secret.png" alt="Connect Vercel with Ory Personal Access Token"/></p><p>Next all you need to do is to run the deploy command and connect it to the
project you created:</p><p>This also works with Vercel PR Preview!</p><h2 id="end-to-end-tests"><a href="#end-to-end-tests" aria-label="end to end tests permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>End-to-End Tests</h2><p>Adding end-to-end tests is also easy! Clone the repository and run the following
commands:</p><div data-language="bash"><pre><code><span>git</span> clone https://github.com/ory/kratos-nextjs-react-example.git
<span>cd</span> kratos-nextjs-react-example
<span>npm</span> i</code></pre></div><p>Then, depending on your setup, you can either use Ory Kratos local or deployed
in Ory Cloud:</p><div data-language="shell"><pre><code><span>export</span> <span>ORY_KRATOS_URL</span><span>=</span>https://playground.projects.oryapis.com/</code></pre></div><p>Then, build and start the server</p><p>and in a new shell run the end-to-end tests:</p><p>You can find the full spec file in the <code>cypress/integration/pages.spec.js</code> file:</p><p>The GitHub Action file is also straight forward and contains two configurations,
one for running Ory Kratos locally and one for running Ory Kratos in Ory Cloud:</p><h2 id="conclusion"><a href="#conclusion" aria-label="conclusion permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2><p>Adding login and registration to your Next.js app is a breeze with open source
technology like <a href="https://github.com/ory/kratos">Ory Kratos</a> and
<a href="https://nextjs.org/">Next.js</a>.</p><p>We hope you enjoyed this guide and found it helpful! If you have any questions,
check out the Ory community on <a href="https://slack.ory.sh/">Slack</a> and
<a href="https://github.com/ory/kratos/discussions">GitHub</a>!</p></div></div></div></div>
  </body>
</html>
