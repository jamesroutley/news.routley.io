<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.phylum.io/the-great-npm-garbage-patch/">Original</a>
    <h1>70% of new NPM packages in last 6 months were spam</h1>
    
    <div id="readability-page-1" class="page"><div>
            
<!--kg-card-begin: html-->
    
<a href="https://www.phylum.io/black-hat-2024">
        <p><img src="https://www.blackhat.com/images/page-graphics-usa-15/logos/bh_logo_black_onwhite.png"/></p>
        <p>Headed to Black Hat USA? Come talk to us in Start-Up City at SC203!</p>
    </a>
<!--kg-card-end: html-->
<p>In April of this year, the Phylum Research Team revealed the <a href="https://blog.phylum.io/digital-detritus-unintended-consequences-of-open-source-sustainability-platforms/" rel="noopener noreferrer">proliferation of spam packages in npm</a> associated with the Tea protocol, a decentralized initiative that promises to compensate software developers in cryptocurrency for their open-source contributions. Last month, we published our <a href="https://blog.phylum.io/q2-2024-evolution-of-software-supply-chain-security-report/" rel="noopener noreferrer">quarterly research report</a>, which estimated that approximately one out of every four packages published to npm in Q2 were associated with Tea, virtually all of which had no redeeming quality aside from gaming the protocol to inflate a software developer’s contribution artificially. With new research from a fresh perspective, our team can now report that the volume of these packages is likely larger than our initial estimates. Like the island of discarded plastic twice the size of Texas floating in the North Pacific Ocean, npm has accrued an astonishing amount of spam packages over the past six months. Join us as we take a fresh look at the pollution in this open-source ecosystem.</p><p>As detailed in <a href="https://blog.phylum.io/digital-detritus-unintended-consequences-of-open-source-sustainability-platforms/">our previous blog</a>, the Tea protocol perversely incentivizes software developers to exaggerate their contribution to open-source development. Using a modified PageRank called teaRank, software developers are rewarded based on their “Proof of Contribution”. As the early SEO spammers figured out how to game PageRank for their benefit, history repeats itself, and a few software developers have spammed open-source repositories with absurd amounts of worthless packages.</p><p>npm, the largest open-source ecosystem, has suffered the worst from this pollution from various actors. Some of the hallmarks of these spam packages are <a href="https://www.npmjs.com/package/mdanattagdaysrh?activeTab=code">gibberish package names</a>, packages named with <a href="https://www.npmjs.com/package/interesting-moccasin-pike?activeTab=code">random combinations of words</a> from a list, implausible <a href="https://www.npmjs.com/package/rusttool080059?activeTab=dependencies">lists of dependent packages</a>, a <a href="https://www.npmjs.com/package/random-job-selector?activeTab=dependents">dubious number of dependent packages</a>, and in this morass of transitive dependencies, the ubiquitous <code>tea.yaml</code> file that ultimately <a href="https://www.npmjs.com/package/hoadandi-27">identifies the code owner</a>. When Phylum first started investigating this situation in February, we were continually amazed at the sheer volume of packages that could be published, clearly due to automation. So, we turned our attention to trying to understand the full scope of this spam problem.</p><p>For a baseline, at the start of 2024, the total number of packages ingested into Phylum daily from npm was about 1,500 each business day and about half that on the weekends. Starting in February of 2024, Phylum began to notice a steady increase in npm package publications from a few thousand to tens of thousands. The high water mark of this increase occurred on 8 April 2024, with over 48,000 packages published to npm. This explosion of packages led us to our first discovery of the <a href="https://blog.phylum.io/digital-detritus-unintended-consequences-of-open-source-sustainability-platforms/">perverse incentives</a> of the Tea protocol.</p><p>Last month, in preparation for our quarterly report, we took a random sample from all npm packages published in Q2, and we manually triaged 1600 packages. If a package contained markers of Tea protocol abuse, as noted above, we marked it as spam. With these, we found a 95% confidence interval for the estimate of the percentage of spam packages in npm in Q2 between 21.25% and 25.5%, or in other words, over 500,000 spam packages.</p><p>Upon further reflection, we considered that many npm projects have nightly builds or alpha, beta, and canary versions. So, these legitimate packages that enjoy a robust development cycle might dilute the size of the true impact of spam. What if we restricted our search to new packages? Packages that have never been seen before in npm?</p><p>We widened our search in our npm data back to February, when we saw the first Tea protocol spam, and then removed all the packages that had at least one version published prior. This left us over 890,000 new, never-before-seen packages between February 2024 and the present. From this set, we took a random sample of 900 packages and applied the same criteria as before. From this new perspective, our 95% confidence interval for the estimate of Tea protocol spam in new packages over the past six months jumped to between 68.66% and 74.67%, or somewhere between 613,000 and 667,000 packages.</p><p>In other words, among all new packages published to npm in the past six months, about five out of every seven packages are Tea spam.</p><p>Followers of this blog know that most of our content focuses on exposing active malicious attacks against open-source software developers. In the spirit of full disclosure, Phylum has yet to discover evidence that these packages contain or lead to the usual kind of malice that we regularly report. But, as a general observation, this pollution is a kind of malice, and there are several dangerous avenues that this could turn into.</p><p>First, unlike malicious typosquatting campaigns, in which an unsuspecting developer might accidentally install <code>reaxt</code> instead of <code>react</code>, it is not at all likely that a developer would make the same mistake with, for example, <a href="https://www.npmjs.com/package/quasar-fig-0e1t?activeTab=dependencies">quasar-fig-0e1t</a>. However, a package like <a href="https://www.npmjs.com/package/web3-cover?activeTab=dependencies">web3-cover</a> is more plausible, where the developer would also get the 170 dependents along with the complete transitive dependency tree for each of those.</p><p>Next, because the AI hype train is at full steam, we must point out the obvious. AI models that are trained on these packages will almost certainly skew the outputs in unintended directions. These packages are ultimately garbage, and the mantra of “garbage in, garbage out” holds true.</p><p>Finally, these large-scale spam campaigns hinder the open-source package registry’s ability to reason through the safety of all packages in an ecosystem, despite the fact that no reasonable person would ever endeavor to install one of these spam packages. They raise the noise floor and create an environment in which an adversary could surreptitiously hide actual maliciousness.</p><p>Let’s start by taking a look at the following package, <a href="https://www.npmjs.com/package/sournoise" rel="noopener noreferrer">sournoise</a>. The npmjs website lists a single dependency on axios.</p><figure><img src="https://blog.phylum.io/content/images/2024/08/Screenshot-2024-08-05-at-17.55.22.png" alt="npmjs.org showing axios as a dependency of sournoise" loading="lazy" width="2000" height="1152" srcset="https://blog.phylum.io/content/images/size/w600/2024/08/Screenshot-2024-08-05-at-17.55.22.png 600w, https://blog.phylum.io/content/images/size/w1000/2024/08/Screenshot-2024-08-05-at-17.55.22.png 1000w, https://blog.phylum.io/content/images/size/w1600/2024/08/Screenshot-2024-08-05-at-17.55.22.png 1600w, https://blog.phylum.io/content/images/2024/08/Screenshot-2024-08-05-at-17.55.22.png 2000w" sizes="(min-width: 720px) 720px"/><figcaption><span>npmjs.org showing </span><code spellcheck="false"><span>axios</span></code><span> as a dependency of </span><code spellcheck="false"><span>sournoise</span></code></figcaption></figure><p>There is not a lot happening here. The package does not contain code, and according to npm, the only dependency is on the extremely popular Axios package. Is this package safe to install?</p><p>The <code>package.json</code> tells a different story.</p><figure><pre><code>{
  &#34;name&#34;: &#34;sournoise&#34;,
  &#34;version&#34;: &#34;1.0.1&#34;,
  &#34;description&#34;: &#34;&#34;,
  &#34;main&#34;: &#34;index.js&#34;,
  &#34;scripts&#34;: {
    &#34;test&#34;: &#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;
  },
  &#34;author&#34;: &#34;&#34;,
  &#34;license&#34;: &#34;ISC&#34;,
  &#34;dependencies&#34;: {
    &#34;axios&#34;: &#34;https://registry.npmjs.org/@putrifransiska/kwonthol36/-/kwonthol36-1.1.4.tgz&#34;
  }
}</code></pre><figcaption><p><code spellcheck="false"><span>package.json</span></code><span> for </span><code spellcheck="false"><span>sournoise</span></code><span> shouting the spurious </span><code spellcheck="false"><span>axios</span></code><span> dependency</span></p></figcaption></figure><p>Contrary to what npm states, this package actually depends on one of our aforementioned spam packages. This is a by-product of how npm handles and displays dependencies to users on its website. There is no clear linkage to <code>@putrifransiska/kwonthol36</code>, <code>axios</code> lists <code>sournoise</code> as a dependent.</p><p>To say that you’d never install one of these spam packages is to ignore the complexity of the supply chain: transitive dependencies can pull in packages that the developer neither wants nor expects to receive.</p><p>Open-source software ecosystem pollution is a problem for everyone. The Tea protocol project is <a href="https://tea.xyz/blog/proof-of-contribution" rel="noopener noreferrer">taking steps to remediate this problem.</a> It would be unfair to legitimate participants in the Tea protocol to have their remuneration reduced because others are scamming the system. Also, npm has begun to take down <a href="https://github.com/advisories?query=type%3Amalware+zitterorg" rel="noopener noreferrer">some of these spammers</a>, but the take-down rate does not match the new publication rate. And this problem is not limited to npm alone. For example, <a href="https://packages.ecosyste.ms/api/v1/registries/rubygems.org/maintainers/188987/packages" rel="noopener noreferrer">this user</a> published nearly 1800 spam packages on Rubygems in late February and early March 2024. Phylum is actively researching this area, and we will continue to seek new ways to detect this spam as these actors adapt their tactics.</p>
        </div></div>
  </body>
</html>
