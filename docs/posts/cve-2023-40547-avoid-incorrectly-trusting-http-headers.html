<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/rhboot/shim/commit/0226b56513b2b8bd5fd281bce77c40c9bf07c66d">Original</a>
    <h1>CVE-2023-40547 â€“ avoid incorrectly trusting HTTP headers</h1>
    
    <div id="readability-page-1" class="page"><div><pre>When retrieving files via HTTP or related protocols, shim attempts to
allocate a buffer to store the received data.  Unfortunately, this means
getting the size from an HTTP header, which can be manipulated to
specify a size that&#39;s smaller than the received data.  In this case, the
code accidentally uses the header for the allocation but the protocol
metadata to copy it from the rx buffer, resulting in an out-of-bounds
write.

This patch adds an additional check to test that the rx buffer is not
larger than the allocation.

Resolves: <a title="CVE-2023-40547" data-hovercard-type="advisory" data-hovercard-url="/advisories/GHSA-qjqj-4cq6-6f2f/hovercard" href="https://github.com/advisories/GHSA-qjqj-4cq6-6f2f">CVE-2023-40547</a>
Reported-by: Bill Demirkapi, Microsoft Security Response Center
Signed-off-by: Peter Jones &lt;pjones@redhat.com&gt;</pre></div></div>
  </body>
</html>
