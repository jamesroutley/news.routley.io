<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://krebsonsecurity.com/2022/05/when-your-smart-id-card-reader-comes-with-malware/">Original</a>
    <h1>When Your Smart ID Card Reader Comes with Malware</h1>
    
    <div id="readability-page-1" class="page"><div>
												<p>Millions of U.S. government employees and contractors have been issued a secure smart ID card that enables physical access to buildings and controlled spaces, and provides access to government computer networks and systems at the cardholder’s appropriate security level. But many government employees aren’t issued an approved card reader device that lets them use these cards at home or remotely, and so turn to low-cost readers they find online. What could go wrong? Here’s one example.</p>
<div id="attachment_59847"><p><img aria-describedby="caption-attachment-59847" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/caccard.png" alt="" width="730" height="224"/></p><p id="caption-attachment-59847">A sample Common Access Card (CAC). Image: Cac.mil.</p></div>
<p>KrebsOnSecurity recently heard from a reader — we’ll call him “Mark” because he wasn’t authorized to speak to the press — who works in IT for a major government defense contractor and was issued a Personal Identity Verification (PIV) government smart card designed for civilian employees. Not having a smart card reader at home and lacking any obvious guidance from his co-workers on how to get one, Mark opted to purchase a $15 reader from Amazon that said it was made to handle U.S. government smart cards.</p>
<p>The USB-based device Mark settled on is the first result that currently comes up one when searches on Amazon.com for “PIV card reader.” The card reader Mark bought was sold by a company called <strong>Saicoo</strong>, whose sponsored Amazon listing advertises a “DOD Military USB Common Access Card (CAC) Reader” and has more than 11,700 mostly positive ratings. </p>
<p>The <a href="https://www.cac.mil/common-access-card/" target="_blank" rel="noopener">Common Access Card</a> (CAC) is the standard identification for active duty uniformed service personnel, selected reserve, DoD civilian employees, and eligible contractor personnel. It is the principal card used to enable physical access to buildings and controlled spaces, and provides access to DoD computer networks and systems.</p>
<p>Mark said when he received the reader and plugged it into his Windows 10 PC, the operating system complained that the device’s hardware drivers weren’t functioning properly. Windows suggested consulting the vendor’s website for newer drivers.</p>
<div id="attachment_59848"><p><img aria-describedby="caption-attachment-59848" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoo.png" alt="" width="751" height="428" srcset="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoo.png 1151w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoo-768x438.png 768w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoo-782x446.png 782w" sizes="(max-width: 751px) 100vw, 751px"/></p><p id="caption-attachment-59848">The Saicoo smart card reader that Mark purchased. Image: Amazon.com</p></div>
<p>So Mark went to the website mentioned on Saicoo’s packaging and found a ZIP file containing drivers for Linux, Mac OS and Windows:</p>
<div id="attachment_59852"><p><img aria-describedby="caption-attachment-59852" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoodrivers.png" alt="" width="786" height="756" srcset="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoodrivers.png 786w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoodrivers-768x739.png 768w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicoodrivers-782x752.png 782w" sizes="(max-width: 786px) 100vw, 786px"/></p><p id="caption-attachment-59852">Image: Saicoo</p></div>
<p>Out of an abundance of caution, Mark submitted Saicoo’s drivers file to <a href="https://www.virustotal.com" target="_blank" rel="noopener">Virustotal.com</a>, which simultaneously scans any shared files with more than five dozen antivirus and security products. Virustotal reported that some 43 different security tools detected the Saicoo drivers as malicious. The consensus seems to be that the ZIP file currently harbors a malware threat known as <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.ramnit.a" target="_blank" rel="noopener">Ramnit</a>, a fairly common but dangerous trojan horse that spreads by appending itself to other files.</p>
<div id="attachment_59849"><p><a href="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooramnit.png" target="_blank" rel="noopener"><img aria-describedby="caption-attachment-59849" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooramnit.png" alt="" width="754" height="541" srcset="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooramnit.png 1138w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooramnit-768x551.png 768w, https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooramnit-782x561.png 782w" sizes="(max-width: 754px) 100vw, 754px"/></a></p><p id="caption-attachment-59849">Image: Virustotal.com</p></div>
<p>Ramnit is a well-known and older threat — first surfacing more than a decade ago — but it has evolved over the years and is <a href="https://www.cybereason.com/blog/research/banking-trojan-delivered-by-lolbins-ramnit-trojan" target="_blank" rel="noopener">still employed in more sophisticated data exfiltration attacks</a>. Amazon said in a written statement that it was investigating the reports.</p>
<p>“Seems like a potentially significant national security risk, considering that many end users might have elevated clearance levels who are using PIV cards for secure access,” Mark said.</p>
<p>Mark said he contacted Saicoo about their website serving up malware, and received a response saying the company’s newest hardware did not require any additional drivers. He said Saicoo did not address his concern that the driver package on its website was bundled with malware.</p>
<p>In response to KrebsOnSecurity’s request for comment, Saicoo sent a somewhat less reassuring reply.</p>
<p>“From the details you offered, issue may probably caused by your computer security defense system as it seems not recognized our rarely used driver &amp; detected it as malicious or a virus,” Saicoo’s support team wrote in an email.</p>
<p>“Actually, it’s not carrying any virus as you can trust us, if you have our reader on hand, please just ignore it and continue the installation steps,” the message continued. “When driver installed, this message will vanish out of sight. Don’t worry.”<span id="more-59840"></span></p>
<div id="attachment_59851"><p><img aria-describedby="caption-attachment-59851" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicooresponse.png" alt="" width="611" height="487"/></p><p id="caption-attachment-59851">Saicoo’s response to KrebsOnSecurity.</p></div>
<p>The trouble with Saicoo’s apparently infected drivers may be little more than a case of a technology company having their site hacked and responding poorly. <strong>Will Dormann</strong>, a vulnerability analyst at CERT/CC, <a href="https://twitter.com/wdormann/status/1526306527237267458" target="_blank" rel="noopener">wrote</a> on Twitter that the executable files (.exe) in the Saicoo drivers ZIP file were not altered by the Ramnit malware — only the included HTML files.</p>
<p>Dormann said it’s bad enough that searching for device drivers online is one of the riskiest activities one can undertake online.</p>
<p>“Doing a web search for drivers is a VERY dangerous (in terms of legit/malicious hit ratio) search to perform, based on results of any time I’ve tried to do it,” Dormann <a href="https://twitter.com/wdormann/status/1526404312137703424" target="_blank" rel="noopener">added</a>. “Combine that with the apparent due diligence of the vendor outlined here, and well, it ain’t a pretty picture.”</p>
<p>But by all accounts, the potential attack surface here is enormous, as many federal employees clearly will purchase these readers from a myriad of online vendors when the need arises. Saicoo’s product listings, for example, are replete with <a href="https://www.amazon.com/hz/reviews-render/lighthouse/B00CMKS2DI?filterByKeyword=smart+card&amp;pageNumber=1" target="_blank" rel="noopener">comments</a> from customers who self-state that they work at a federal agency (and several who reported problems installing drivers).</p>
<p>A <a href="https://twitter.com/briankrebs/status/1526297731748216833" target="_blank" rel="noopener">thread about Mark’s experience on Twitter</a> generated a strong response from some of my followers, many of whom apparently work for the U.S. government in some capacity and have government-issued CAC or PIV cards.</p>
<p><img loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/saicootweet.png" alt="" width="751" height="537"/></p>
<p>Two things emerged clearly from that conversation. The first was general confusion about whether the U.S. government has any sort of list of approved vendors. It does. The <strong>General Services Administration</strong> (GSA), the agency which handles procurement for federal civilian agencies, maintains <a href="https://www.idmanagement.gov/approved-products-list-pacs-products/" target="_blank" rel="noopener">a list of approved card reader vendors at idmanagement.gov</a> (Saicoo is not on that list). [Thanks to <a href="https://twitter.com/MetaBiometrics/status/1526662768476270597" rel="noopener" target="_blank">@MetaBiometrics</a> and <a href="https://twitter.com/shugenja/status/1526613826858254338" rel="noopener" target="_blank">@shugenja</a> for the link!]</p>
<p>The other theme that ran through the Twitter discussion was the reality that many people find buying off-the-shelf readers more expedient than going through the GSA’s official procurement process, whether it’s because they were never issued one or the reader they were using simply no longer worked or was lost and they needed another one quickly.</p>
<p>“Almost every officer and NCO [non-commissioned officer] I know in the Reserve Component has a CAC reader they bought because they had to get to their DOD email at home and they’ve never been issued a laptop or a CAC reader,” <a href="https://twitter.com/dixondaver/with_replies" target="_blank" rel="noopener">said</a> <strong>David Dixon</strong>, an Army veteran and author who lives in Northern Virginia. “When your boss tells you to check your email at home and you’re in the National Guard and you live 2 hours from the nearest [non-classified military network installation], what do you think is going to happen?”</p>
<p>Interestingly, anyone asking on Twitter about how to navigate purchasing the right smart card reader and getting it all to work properly is invariably steered toward <a href="https://www.militarycac.com" target="_blank" rel="noopener">militarycac.com</a>. The website is maintained by <strong>Michael Danberry</strong>, a decorated and retired Army veteran who launched the site in 2008 (its text and link-heavy design very much takes one back to that era of the Internet and webpages in general). His site has even been <a href="https://militarycac.com/PDFs/EEmail.pdf" target="_blank" rel="noopener">officially recommended by the Army</a> (PDF). Mark shared emails showing Saicoo itself recommends militarycac.com.</p>
<div id="attachment_59853"><p><img aria-describedby="caption-attachment-59853" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2022/05/militarycac.png" alt="" width="751" height="749" srcset="https://krebsonsecurity.com/wp-content/uploads/2022/05/militarycac.png 814w, https://krebsonsecurity.com/wp-content/uploads/2022/05/militarycac-768x766.png 768w, https://krebsonsecurity.com/wp-content/uploads/2022/05/militarycac-782x780.png 782w" sizes="(max-width: 751px) 100vw, 751px"/></p><p id="caption-attachment-59853">Image: Militarycac.com.</p></div>
<p>“The Army Reserve started using CAC logon in May 2006,” Danberry wrote on his <a href="https://militarycac.com/about.htm" target="_blank" rel="noopener">“About” page</a>. “I [once again] became the ‘Go to guy’ for my Army Reserve Center and Minnesota. I thought Why stop there? I could use my website and knowledge of CAC and share it with you.”</p>
<p>Danberry did not respond to requests for an interview — no doubt because he’s busy doing tech support for the federal government. The friendly message on Danberry’s voicemail instructs support-needing callers to leave detailed information about the issue they’re having with CAC/PIV card readers.</p>
<p>Dixon said Danberry has “done more to keep the Army running and connected than all the G6s [Army Chief Information Officers] put together.”</p>
<p>In many ways, Mr. Danberry is the equivalent of that little known software developer whose tiny open-sourced code project ends up becoming widely adopted and eventually folded into the fabric of the Internet.  I wonder if he ever imagined 15 years ago that his website would one day become “critical infrastructure” for Uncle Sam?</p>
											</div></div>
  </body>
</html>
