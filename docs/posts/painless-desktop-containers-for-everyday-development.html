<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dock.orion3.space/readme.htm">Original</a>
    <h1>Painless desktop containers for everyday development</h1>
    
    <div id="readability-page-1" class="page"><div>

    <section>
      <p><abbr>dock</abbr> is an alternative way to use Docker (and very soon other container engines) without writing config files: <em>cd</em> into any directory, type <code>dock</code> and you&#39;re inside new or existing container with the directory mounted into it by default.</p>

        <section>
          <p>This toolset isn&#39;t forcing anyone else on the team to use itself or even Docker.</p>
          <p>It is written in Bash entirely and has minimum requirements.
          While currently intended for Desktop use by developers, the hope is to
          eventually allow it to be easily used as part of a deployment process and
          production environments.</p>
        </section>

      <p>If you prefer cinematic experience, click on one of the videos below. They are not narrated,
      and are perfectly watchable and self-explanatory.</p>
    </section>

    <section>
      <div>
        <p><a href="https://dock.orion3.space/screencasts/dock_install.mp4"><img src="https://dock.orion3.space/assets/img/dock_install_video_thumbnail.png"/></a>
        </p>
        <p>
          Installation video demo. In truth it&#39;s a two step process. Perhaps, this video is pointless. But then... the people of this world demandeth proof.
        </p>
      </div>

      <div>
        <p><a href="https://dock.orion3.space/screencasts/dock_usage.mp4">
            <img src="https://dock.orion3.space/assets/img/dock_usage_video_thumbnail.png"/>
          </a>
        </p>
        <p>
          Basic usage. Two containers created, changes introduced and committed to local images.
          It is then demonstrated how easy it is to connect to a running or a stopped container.
        </p>
      </div>
    </section>

    <section>
      <p>With <abbr>dock</abbr> you can easily:</p>
      <ul>

        <li><b>Create a container and mount any directory into it</b> - or multiple
        directories - with just single command: <code>dock</code>.</li><li><b>Automatically connect</b> to the container via ssh (or other means later).
        If you just created the container, it will also do this step
        automatically.</li>

        <li><b>Have beautifully set up environment</b> with zsh shell and Vim waiting
        for you inside the default image based on Ubuntu 20.04.
        You can, of course, customize it and install any shell, text editor and
        other software. See the <a href="#INSTALLATION">INSTALLATION</a> section to download the image.</li>

        <li>
          <b>Create images</b> with environments specifically designed for your projects, which is what
          containers are for. At the same time may you forget about Dockerfiles - not needed anymore.
          <abbr>dock</abbr> was created with
          the idea that Dockerfiles shall not be used.
          <p>INCREMENTAL IMAGE UPDATES section in .documentation/IMAGES.txt
          explains the reasoning and expands on that topic.</p>
        </li>
      </ul>
    </section>

    <section>
      <p>Others wouldn&#39;t even need to know you&#39;re using this tool, let alone
      familiarize themselves with <abbr>Docker</abbr> or <abbr>dock</abbr>. It is designed to
      be &#34;exceptionally optional&#34; and &#34;personally useful&#34;.</p>

      <p>There are also a few more non-default images you might find useful in
      your daily sessions as a developer, such as the ones that provide
      VPN and TOR functionality.</p>

      <p>Please also kindly read <a href="https://dock.orion3.space/contribute.html">CONTRIBUTE</a>,
      <a href="https://dock.orion3.space/about.html">ABOUT</a>, <a href="https://dock.orion3.space/donate.html">DONATE</a>, and
      <a href="https://gitea.orion3.space/DOCK/dock/src/branch/master/LICENSE">LICENCE</a> pages for more information.
      I believe that this software may be useful to people who 
      aren&#39;t software engineers, but who know their way around command line -
      a least a little bit and so it&#39;d would be great if we could continue this work.</p>
    </section>

    
    <section>
      <ol>
        <li>
          <b>GOAL 1:</b>
          <p>NO Dockerfiles or learning new DSL, or programming language, or some
          other convoluted configuration options. Or even NO understanding
          how Docker itself works. This tool is eventually intended to be
          used with different containerization tools.</p>
        </li>

        <li>
          <b>GOAL 2:</b>
          <p>ease of use of <abbr>dock</abbr> itself (less cli-options or configuration).</p>
        </li>

        <li>
          <b>GOAL 3:</b>
          <p>make code reasonably uncomplicated, while acknowledging the
          ambiguity - which is necessary to achieve GOAL (2) - managing
          it with as little complexity in code as possible.</p>
        </li>

        <li>
          <b>GOAL 4:</b>
          <p>Make it last. Even if not a single line of code is added after
          the official release, it will be useful for years to come. It&#39;s
          all POSIX-compliant and written in Bash, so not much can break.
          The only serious dependency is Docker, but even that one can be
          disregarded when GOAL 5 is achieved.</p>
        </li>

        <li>
        <b>GOAL 5:</b>
          <div> 
                <p>not implemented
                </p><p>make this tool work with different container engines in such
                a way, that the cli stays the same for the end user.
                Support for engines likely to be added first: BSD jails &amp; Podman.</p>

                <p>Right now Docker-specific code is not very well isolated and
                rather scattered among various files, but there isn&#39;t too many calls
                to various docker commands, so, hopefully, it&#39;ll be easy to identify
                and separate them.</p>
          </div>
        </li>
      </ol>
    </section>

    
    <section>
      <h2>DEPENDENCIES</h2>
      <section>bash &gt;= 4.2, git, sed, awk, ssh, docker</section>

      <h2>SOFT DEPENDENCIES</h2>
      <ol>
        <li>
          <b>✱</b>
          <p><b>Tilix terminal</b> <span>(try, it&#39;s very cool).</span>
          <small>If you&#39;re using Tilix, containers will be properly highlighted
          when you connect to them. Other terminal have different escape
          codes for that and I haven&#39;t adjusted for them all just yet. See
          https://gnunn1.github.io/tilix-web/</small></p>
        </li>

        <li>
          <b>✱</b>
          
        </li>
      </ol>

      <h2>STEPS TO INSTALL</h2>

      <ol>
        <li>
          <b>1.</b>
          <div>
            <p><b>GET THE <abbr>dock</abbr> UTILITIES SET</b></p><p><a href="https://dock.orion3.space/releases/dock_stable.tgz">Download the archive</a> 
            with the stable version of the <abbr>dock</abbr> utilities set, which includes all submodules, 
            but no git-related files or other unnecessary artifacts:</p>

<pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>curl https://dock.orion3.space/releases/dock_stable.tgz \
  -o dock_stable.tgz &amp;&amp; \ tar xvzf dock_stable.tgz &amp;&amp;
  rm dock_stable.tgz
</pre><p>

            OR

            </p><p>Clone the git repository, and place it anywhere on your file system,
            then initialize and update all git submodules in it:</p>

<pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>git clone -b stable \
  https://gitea.orion3.space/DOCK/dock.git &amp;&amp; cd dock &amp;&amp; \
  git submodule init &amp;&amp; git submodule update
</pre>
          </div>

        </li>

        <li>
          <b>2.</b>
          <div><p><b>RUN THE INSTALLER SCRIPT</b></p><p>Navigate to the directory with project&#39;s source code you&#39;ve just obtained
          and run this command:</p>

          <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>./install</pre>

            <p>It&#39;ll ask you a few questions, but they&#39;re simple.
            You won&#39;t need to edit any configuration files manually. The script will
            download the default image for either directly from the official Docker Hub
            or website, but it also will offer you to use a magnet link first too
            <a href="#image_magnet_link">[2]</a> (you can, of course, say no).</p>

            <p>Please consider downloading it via BitTorrent and seeding. You can then
            tell the script the downloaded image filename to use (it&#39;ll ask).</p>

          </div>
        </li>
      </ol>

      <section>
        <em>NOTE ABOUT <b>MACOSX</b>:</em>
        <p>You may not be able to run this default image under MacOSX, although
        <abbr>dock</abbr> scripts themselves are fully compatible. The problem is that
        MacOSX is not running on an amd64 architecture, so the default image may not be able to boot.
        I don&#39;t use MacOSX, nor intend to, but I&#39;d like this to work on any major OS. As
        far as I&#39;m concerned, Docker has a tool called <a href="https://docs.docker.com/buildx/working-with-buildx/">buildx</a>
        to help convert images for various architectures. If you&#39;re on MacOSX and can help me do it, I&#39;ll
        happily publish the converted, dock-compatible base image of Ubuntu 20.04 that would
        run on MacOSX.</p>
      </section>

      <section>
        You should now be able to run the <code>dock</code> command from anywhere. 
        Try it with the <code>dock -y</code> flag (dry run), which will print all
        the variables and other debug information about creating or starting/connecting
        to a container with relation to your current directory
      </section>


      <ol>
        <li>
          <b>[1]</b>
          
        </li>

        <li id="image_magnet_link">
          <b>[2]</b>
          
        </li>

        <li>
          <b>[3]</b>
          <div><p>
            While everyone hates <abbr>tar</abbr>, because it&#39;s impossible
            to remember the correct cli-options to it (see <a href="https://xkcd.com/1168/">XKCD</a>)
            the download archive includes a utility called <abbr>untar</abbr>,
            which does the job for you. Ironically, it&#39;s trapped inside that very same
            archive it could&#39;ve extracted.</p>

            <p>But, on a more serious note, this tiny <abbr>untar</abbr>
            script is part of a set of libraries under
            <a href="https://gitea.orion3.space/bashjazz/">./vendor/bashjazz</a>
            which I strongly recommend you explore. They are small to medium sized bash-scripts
            (some executable, some source-able, some both) helping you in
            everyday life (you can use zsh, or any other shell, of course -
            they just require bash installed).</p>
          </div>
        </li>
       </ol>

    </section>

    
    <section>
      Unambiguous:

        <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock [IMAGE_NAME] [CONTAINER_NAME]</pre>

      Here, with just one positional argument provided,
      <abbr>dock</abbr> will be doing some guessing:

<pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock [IMAGE_NAME]
<img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock [CONTAINER_NAME]
</pre>

      And, finally, without any positional arguments <abbr>dock</abbr> will be basing
      its guessing on default image you set in ~/.dockrc and your current directory:

        <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock</pre>

      Both positional arguments are optional, however they&#39;re not exactly
      positional. If the second one isn&#39;t provided, <abbr>dock</abbr> tries its best to guess
      what&#39;s going on. The simplified version looks like this when only the first
      argument is supplied:

      <ol>
        <li>
          <b>a.</b>
          <p>Assume <var>$1</var> (first argument to <abbr>dock</abbr>) is the name of an existing CONTAINER.
          If it exists, launch it and connect via ssh.</p>
        </li>

        <li>
          <b>b.</b>
          <p>If container cannot be found, assume it&#39;s an image name.</p>
        </li>

        <li>
          <b>c.</b>
          <p>If NO image is found, use the default one defined in ~/.dockrc
          to create a new container.</p>
        </li>
      </ol>

      <p>Go trough the EXAMPLES section as it shows pretty much all possible
      ways in which <abbr>dock</abbr> can be in invoked to create or start a container.</p>

      <p>For a detailed overview of the &#34;guessing&#34; process with all two, only one or
      none of the positional arguments provided in the <a href="https://dock.orion3.space/decision_tree.html">DECISION TREE</a>
      file it&#39;s actually quite intuitive in terms of usage and the elaborate
      explanation is intended for those who read and/or contribute code to this
      project.</p>
    </section>

    
    <ol>
      <li>
        <b>1.</b>
        <p>Navigate to the target directory you want mounted inside your container -
        let us suppose it&#39;s called <var>~/dev/my/new/project</var> - this is the directory that
        will be mounted as <var>/home/docker/main</var> inside the container by default.
        It&#39;s also the directory you&#39;ll automatically <em>cd</em> into when you connect
        to the container.</p>
      </li>

      <li><b>2.</b><p>Type <code>dock somerepo/img_name:stable</code></p></li>

      <li>
        <b>3.</b>
        <p>See your terminal displaying what it&#39;s about to do when calling
        <code>docker run</code>
        and asking for the confirmation <em>(y/n)</em>.</p>
      </li>

      <li>
        <b>4.</b>
        <div><p>
          Type <em>y</em> and press ENTER, then see yourself connected to the newly
          created container via ssh (no additional configuration is necessary)
          as user <abbr>docker</abbr>.

        </p><h2>EXPLORE INSIDE THE CONTAINER</h2>
        <p>Once you&#39;re connected you can:</p>
        <ol>
          <li>
            <sup>✱</sup>
            <p>Type <code>pwd</code> and you&#39;ll see you&#39;re inside
            <var>/home/docker/main</var> directory
            into which the current directory on your host machine is mounted in
            read+write mode.</p>
          </li>

          <li>
            <sup>✱</sup>
            <p>If you have used the <em>-H</em> option when creating the container, <var>~/main</var>
            will not be be created and nothing is mounted into it.</p>
          </li>

          <li>
            <sup>✱</sup>
            <p>If you had used <em>-u root</em> option with <abbr>dock</abbr> when creating,
            starting or connecting to the container, you&#39;ll found yourself in the <var>/root</var> dir of the container.
            The <em>root</em> user doesn&#39;t have a <var>~/main</var> directory - it&#39;s only the <em>docker</em>
            user&#39;s <var>$HOME/main</var> is where <abbr>dock</abbr> would mount current host directory.</p>
          </li>
        </ol>

      </div>
      </li>

      <li>
        <b>5.</b>
        <p>Type <code>exit</code> - you guessed it, to exit the container.</p>
      </li>

      <li>
        <b>6.</b>
        <p>If you&#39;re in the same directory, type <code>dock</code>
        (WITHOUT arguments) to reconnect to the same running container or start and connect to
        the stopped one named <em>project.new.my</em>.</p>
      </li>

      <li>
        <b>7.</b>
        <p>If you&#39;re in a different directory, type <code>dock project.new.my</code> to connect.</p>
      </li>

    </ol>

    <section>
      <em>NOTE:</em>
      <p>container names DON&#39;T HAVE to contain dots <em>(.)</em> - they only do because
      the names are auto-assigned from the target directory path upon
      creation of the container. But you could easily create a container
      with a simple name, mounting current directory inside of it:</p>
      <p><code>dock dock/ubuntu20:stable newapp</code></p>
      <p>You can then connect to it from anywhere by simply typing:</p>
      <p><code>dock newapp</code></p>

    </section>

    
    <section>
      <p>Current list of images can be be found here
      <a href="https://dock.orion3.space/images.txt">here</a>.</p>

      <p>You don&#39;t have to manually visit this link every time and download and
      import/load the images with Docker commands. Instead, <abbr>dock</abbr> already provides
      a simple way to do this. Try:</p>

      <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock -c image list</pre>

      <section>
        <p><b>NOTE:</b></p>
        <p>It isn&#39;t optimal at all to pull images from Docker Hub, or download them. Instead, work
        is currently being done on an alternative way of achieving this: it will be possible to
        &#34;patch&#34; any Docker images with a series of Bash scripts applied consecutively, much like
        migrations to a database. This doesn&#39;t achieve 100% reproducible environment, but since we&#39;ve
        already established <abbr>Dock</abbr> will be doing things slightly differently, just accept it.</p>
        <p><b>What this does achieve is:</b></p>
        <ol>
          <li>
            <b>a)</b>
            <p>no issues with running docker images on various platforms. You&#39;ll be able to pull an image of,
            say, Ubuntu, that runs on your platform and just patch, such that it&#39;s dock-compatible, or,
            better, yet, has Python environment, or a Ruby environment etc.</p>
          </li>
          <li>
            <b>b)</b>
            <p>Patches will be receiving updates, but it will be up to you whether to apply them.</p>
          </li>
          <li>
            <b>c)</b>
            <p>Bash scripts cannot conceal anything. You can open it and read every command to be run inside
            your container.</p>
          </li>
        
      </ol></section>

      <p>This displays a list of stable images available for automatic download
      and approved by the <abbr>dock</abbr> maintainer(s). Each line represents a particular
      image with all its multiple aliases. The last alias on each line will be used
      to tag the image when it&#39;s downloaded:</p>

      <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock -c image import nodejs hub</pre>

      <p>This command pulls a stable image from orion3 Docker Hub repo, then tags it as
      <code>dock/ubuntu20-nodejs16:stable</code>, because at Docker Hub the image would normally
      have a different name. At the time of writing the image on Docker Hub which
      corresponds to <abbr>nodejs</abbr> alias is called <code>orion3/ubuntu20-nodejs16:March30_2022</code>.</p>

      <p>Instead of pulling it from Docker Hub, you ask for a magnet link and use a BitTorrent client
      to download the image:</p>

      <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock -c image import nodejs magnet</pre>

      <p>In this case, when the download is completed and you have the <b>.tgz</b> archive of the image you can
      import it with this command:</p>

      <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock -c image import dock_ubuntu20-nodejs16_300322_SQ.tgz file</pre>

      <p>That&#39;s assuming the file was downloaded into your $DOCK_PATH/tmp dir.
      If not, specify the full path:</p>

      <pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>dock -c image import ~/Downloads/dock_ubuntu20-nodejs16_300322_SQ.tgz file</pre>

    </section>

    
    <h3>WITH NO CONTAINERS THAT CAN BE MATCHED</h3>
    <section>

      <b>Example 1:</b> no arguments
<pre><img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>docker ps -a | grep &#39;project1&#39;
<output> # =&gt; NO OUTPUT, container doesn&#39;t exist</output>
<img src="https://dock.orion3.space/assets/img/host_prompt.svg"/>cd ~/dev/pets/project1
<img src="https://dock.orion3.space/assets/img/host_prompt.svg"/><em>dock</em>

<output># RESULT: a new container is created with the name &#34;project1.pets&#34;
#         based on the image defined as the default one in ~/.dockrc
#         which currently is &#34;dock/ubuntu20:stable&#34;</output></pre>

      </section></div></div>
  </body>
</html>
