<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://flower.dev/">Original</a>
    <h1>Flower â€“ A Friendly Federated Learning Framework</h1>
    
    <div id="readability-page-1" class="page"><div><div><pre><code><span>import</span><span> flwr </span><span>as</span><span> fl
</span><span></span><span>import</span><span> tensorflow </span><span>as</span><span> tf
</span>
<span></span><span># Load model and data (MobileNetV2, CIFAR-10)</span><span>
</span><span>model = tf.keras.applications.MobileNetV2((</span><span>32</span><span>, </span><span>32</span><span>, </span><span>3</span><span>), classes=</span><span>10</span><span>, weights=</span><span>None</span><span>)
</span><span>model.</span><span>compile</span><span>(</span><span>&#34;adam&#34;</span><span>, </span><span>&#34;sparse_categorical_crossentropy&#34;</span><span>, metrics=[</span><span>&#34;accuracy&#34;</span><span>])
</span>(x_train, y_train), (x_test, y_test) = tf.keras.datasets.cifar10.load_data()
<!-- -->
<span></span><span># Define Flower client</span><span>
</span><span></span><span>class</span><span> </span><span>CifarClient</span><span>(</span><span>fl.client.NumPyClient</span><span>):</span><span>
</span><span>  </span><span>def</span><span> </span><span>get_parameters</span><span>(</span><span>self</span><span>):</span><span>
</span><span>    </span><span>return</span><span> model.get_weights()
</span>
<span>  </span><span>def</span><span> </span><span>fit</span><span>(</span><span>self, parameters, config</span><span>):</span><span>
</span>    model.set_weights(parameters)
<span>    model.fit(x_train, y_train, epochs=</span><span>1</span><span>, batch_size=</span><span>32</span><span>)
</span><span>    </span><span>return</span><span> model.get_weights(), </span><span>len</span><span>(x_train), {}
</span>
<span>  </span><span>def</span><span> </span><span>evaluate</span><span>(</span><span>self, parameters, config</span><span>):</span><span>
</span>    model.set_weights(parameters)
<!-- -->    loss, accuracy = model.evaluate(x_test, y_test)
<span>    </span><span>return</span><span> loss, </span><span>len</span><span>(x_test), {</span><span>&#34;accuracy&#34;</span><span>: accuracy}
</span>
<span></span><span># Start Flower client</span><span>
</span><span>fl.client.start_numpy_client(</span><span>&#34;[::]:8080&#34;</span><span>, client=CifarClient())</span></code></pre></div></div></div>
  </body>
</html>
