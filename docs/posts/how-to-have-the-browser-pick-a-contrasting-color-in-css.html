<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://webkit.org/blog/16929/contrast-color/">Original</a>
    <h1>How to have the browser pick a contrasting color in CSS</h1>
    
    <div id="readability-page-1" class="page"><div>
                                
                <p>Have you ever wished you could write simple CSS to declare a color, and then have the browser figure out whether black or white should be paired with that color? Well, now you can, with <code>contrast-color()</code>. Here’s how it works.</p>
<p>Imagine we’re building a website or a web app, and the design calls for a bunch of buttons with different background colors. We can create a variable named <code>--button-color</code>  to handle the background color. And then assign that variable different values from our design system in different situations.</p>
<p>Sometimes the button background will be a dark color, and the button text should be white to provide contrast. Other times, the background will be a lighter color, and the text should be black. Like this:</p>
<figure><picture><source src="https://webkit.org/wp-content/uploads/cc-button-1-dark-scaled.png" type="image/png" media="(prefers-color-scheme: dark)"/><img fetchpriority="high" decoding="async" src="https://webkit.org/wp-content/uploads/cc-button-1-light-scaled.png" alt="Two buttons side by side. White text on dark purple for the first, black text on pink background for the second. " width="2560" height="546" srcset="https://webkit.org/wp-content/uploads/cc-button-1-light-scaled.png 2560w, https://webkit.org/wp-content/uploads/cc-button-1-light-300x64.png 300w, https://webkit.org/wp-content/uploads/cc-button-1-light-1024x218.png 1024w, https://webkit.org/wp-content/uploads/cc-button-1-light-768x164.png 768w, https://webkit.org/wp-content/uploads/cc-button-1-light-1536x327.png 1536w, https://webkit.org/wp-content/uploads/cc-button-1-light-2048x436.png 2048w" sizes="(max-width: 2560px) 100vw, 2560px"/></picture></figure>
<p>Now, of course, we could use a second variable for the text color and carefully define the values for <code>--button-color</code> and <code>--button-text-color</code> at the same time, in pairs, to ensure the choice for the text color is the right one. But, on a large project, with a large team, carefully managing such details can become a really hard task to get right. Suddenly a dark button has unreadable black text, and users can’t figure out what to do.</p>
<p>It’d be easier if we could just tell our CSS to make the text black/white, and have the browser pick which to use — whichever one provides more contrast with a specific color. Then we could just manage our many background colors, and not worry about the text color.</p>
<p>That’s exactly what the <code>contrast-color()</code> function will let us do.</p>
<h2>contrast-color()</h2>
<p>We can write this in our CSS:</p>
<pre><code><span>color</span>: <span>contrast-color</span>(<span>purple</span>);
</code></pre>
<p>And the browser will set <code>color</code> to either black or white, whichever choice provides better contrast with <code>purple</code>.</p>
<p>Let’s style our button. We’ll set the button background color to our variable. And we’ll define the text color to be the contrasting black/white choice that pairs with that variable.</p>
<pre><code><span>button</span> {
  <span>background-color</span>: <span>var</span>(<span>--button-color</span>);
  <span>color</span>: <span>contrast-color</span>(<span>var</span>(<span>--button-color</span>));
}
</code></pre>
<p>Now we only need to define one color, and the other follows! When we change the button color, the browser will reconsider whether the text should be black or white, and choose fresh the option with more contrast.</p>
<p>For fun, let’s also define a hover color using <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_colors/Relative_colors">Relative Color Syntax</a>, and now one variable determines four colors — the default button color &amp; the text to go with it, plus the hover color &amp; the text to go with that.</p>
<pre><code><span>:root</span> {
  <span>--button-color</span>: <span>purple</span>;
  <span>--hover-color</span>: <span>oklch</span>(<span>from</span> <span>var</span>(<span>--button-color</span>) <span>calc</span>(<span>l</span> + <span>.2</span>) <span>c</span> <span>h</span>);
}
<span>button</span> {
  <span>background-color</span>: <span>var</span>(<span>--button-color</span>);
  <span>color</span>: <span>contrast-color</span>(<span>var</span>(<span>--button-color</span>));
  <span>text-box</span>: <span>cap</span> <span>alphabetic</span>; 
}
<span>button</span><span>:hover</span> {
  <span>background-color</span>: <span>var</span>(<span>--hover-color</span>);
  <span>color</span>: <span>contrast-color</span>(<span>var</span>(<span>--hover-color</span>));
}
</code></pre>
<p><a href="https://codepen.io/jensimmons/pen/XJJjKMO?editors=1100">Here’s a demo of the result</a>. Try it in <a href="https://developer.apple.com/safari/technology-preview/">Safari Technology Preview</a>, where you can change the button color dynamically.</p>

<h2>Accessibility considerations and contrast algorithms</h2>
<p>Now, it might be tempting to believe that <code>contrast-color()</code> will magically solve all contrast accessibility concerns all by itself, and your team will never have to think about color contrast again. Nope, that’s not the case. At all.</p>
<p>Using the <code>contrast-color()</code> function does not guarantee that the resulting pair of colors will be accessible. It’s quite possible to pick a color (in this case a background color) that will not have enough contrast with either black or white. It’s still up to the humans involved — designers, developers, testers, and more — to ensure there’s enough contrast.</p>
<p>In fact, if you try out <a href="https://codepen.io/jensimmons/pen/XJJjKMO?editors=1100">our demo</a> in Safari Technology Preview now (as this article is published in May 2025), you’ll find many of the pairings with mid-tone background colors don’t result in enough contrast. It often seems like the wrong choice is being made. For example, this #317CFF blue returns a contrast-color of black.</p>
<figure><picture><source src="https://webkit.org/wp-content/uploads/cc-button-2-dark-scaled.png" type="image/png" media="(prefers-color-scheme: dark)"/><img decoding="async" src="https://webkit.org/wp-content/uploads/cc-button-2-light-scaled.png" alt="Medium dark blue button with black text. The text is hard to see." width="2560" height="545" srcset="https://webkit.org/wp-content/uploads/cc-button-2-light-scaled.png 2560w, https://webkit.org/wp-content/uploads/cc-button-2-light-300x64.png 300w, https://webkit.org/wp-content/uploads/cc-button-2-light-1024x218.png 1024w, https://webkit.org/wp-content/uploads/cc-button-2-light-768x164.png 768w, https://webkit.org/wp-content/uploads/cc-button-2-light-1536x327.png 1536w, https://webkit.org/wp-content/uploads/cc-button-2-light-2048x436.png 2048w" sizes="(max-width: 2560px) 100vw, 2560px"/>
</picture></figure>
<p>When white is clearly the better choice for perceptual contrast.</p>
<figure><picture><source src="https://webkit.org/wp-content/uploads/cc-button-3-dark-scaled.png" type="image/png" media="(prefers-color-scheme: dark)"/><img decoding="async" src="https://webkit.org/wp-content/uploads/cc-button-3-light-scaled.png" alt="Same dark medium blue button, now with white text. Much easier to see what it says." width="2560" height="545" srcset="https://webkit.org/wp-content/uploads/cc-button-3-light-scaled.png 2560w, https://webkit.org/wp-content/uploads/cc-button-3-light-300x64.png 300w, https://webkit.org/wp-content/uploads/cc-button-3-light-1024x218.png 1024w, https://webkit.org/wp-content/uploads/cc-button-3-light-768x164.png 768w, https://webkit.org/wp-content/uploads/cc-button-3-light-1536x327.png 1536w, https://webkit.org/wp-content/uploads/cc-button-3-light-2048x436.png 2048w" sizes="(max-width: 2560px) 100vw, 2560px"/></picture></figure>
<p>What is happening here? Why is the less-contrasting choice being made?</p>
<p>Well, the current implementation in Safari Technology Preview is using the contrast algorithm officially defined in <a href="https://www.w3.org/WAI/standards-guidelines/wcag/">WCAG 2</a> (Web Content Accessibility Guidelines version 2). If we put this color blue through a well-respected <a href="https://webaim.org/resources/contrastchecker/">color contrast checker at WebAIM</a>, it does clearly recommend using black for the text color, not white. WCAG 2 is the current authoritative standard for accessibility on the web, required by law in many places.</p>
<p>The WCAG 2 algorithm calculates black-on-#317CFF as having a contrast ratio of 5.45:1, while white-on-#317CFF has 3.84:1. The <code>contrast-color()</code> function is simply choosing the option with the bigger number — and 5.45 is bigger than 3.84.</p>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/WCAG2-test-blue-scaled.png" alt="Screenshots of the WCAG 2 color contrast checker, showing results of white on blue and black on blue. Black passes. White fails. But black is hard to read while white is easy to read." width="2560" height="1361" srcset="https://webkit.org/wp-content/uploads/WCAG2-test-blue-scaled.png 2560w, https://webkit.org/wp-content/uploads/WCAG2-test-blue-300x160.png 300w, https://webkit.org/wp-content/uploads/WCAG2-test-blue-1024x545.png 1024w, https://webkit.org/wp-content/uploads/WCAG2-test-blue-768x408.png 768w, https://webkit.org/wp-content/uploads/WCAG2-test-blue-1536x817.png 1536w, https://webkit.org/wp-content/uploads/WCAG2-test-blue-2048x1089.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px"/><figcaption>Testing black versus white on a medium-dark blue in the <a href="https://webaim.org/resources/contrastchecker/">WCAG 2 color contrast checker at Web AIM</a>.</figcaption></figure>
<p>When machines run the WCAG 2 algorithm, the black text has higher contrast mathematically. But when humans look at these combinations, the black text has lower contrast perceptually. If you find this odd, well, you aren’t the only one. The WCAG 2 color contrast algorithm has long been a subject of criticism. In fact, one of the major driving forces for updating WCAG to level 3 is a desire to improve the contrast algorithm.</p>
<p>The <a href="https://github.com/Myndex/SAPC-APCA">Accessible Perceptual Contrast Algorithm (APCA)</a> is one possible candidate for inclusion in <a href="https://www.w3.org/WAI/standards-guidelines/wcag/wcag3-intro/">WCAG 3</a>. You can try out this algorithm today by using the APCA Contrast Calculator at <a href="https://apcacontrast.com/">apcacontrast.com</a>. Let’s look at what it thinks about black vs white text on this particular shade of blue background.</p>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/APCA-test-blue.png" alt="Screenshot of APCA Contrast Calculator, showing the same tests of black on blue vs white on blue. White clearly wins." width="1924" height="2442" srcset="https://webkit.org/wp-content/uploads/APCA-test-blue.png 1924w, https://webkit.org/wp-content/uploads/APCA-test-blue-236x300.png 236w, https://webkit.org/wp-content/uploads/APCA-test-blue-807x1024.png 807w, https://webkit.org/wp-content/uploads/APCA-test-blue-768x975.png 768w, https://webkit.org/wp-content/uploads/APCA-test-blue-1210x1536.png 1210w, https://webkit.org/wp-content/uploads/APCA-test-blue-1614x2048.png 1614w" sizes="auto, (max-width: 1924px) 100vw, 1924px"/><figcaption>Testing the same black versus white on a medium-dark blue in the <a href="https://apcacontrast.com/">APCA Contrast Calculator</a>.</figcaption></figure>
<p>This contrast algorithm evaluates black-on-blue as having a score of Lc 38.7, while white-on-blue scores Lc -70.9. To know which has more contrast, ignore the negative sign for a moment, and compare 38.7 to 70.9. The bigger the number, the more contrast. The APCA test results say that white text is clearly better than black. Which feels exactly right.</p>
<p>(In the APCA scoring system, the negative number simply signifies that the text is lighter than the background. Think light mode = positive numbers, dark mode = negative numbers.)</p>
<p>Why is APCA giving such better results than WCAG 2? Because its algorithm calculates contrast perceptually instead of with simple mathematics. This takes into consideration the fact humans do not perceive contrast linearly across hue and lightness. If you’ve learned about LCH vs HSL color models, you’ve probably heard about how newer approaches to color mathematics do a better job of understanding our perception of lightness, and knowing which colors seem to be the same luminance or tone. The “Lc” marking the APCA score stands for “Lightness contrast”, as in “Lc 75”.</p>
<p>Luckily, the algorithm behind the <code>contrast-color</code> function can be swapped out. Support for this feature first shipped in March 2021, in <a href="https://webkit.org/blog/11577/release-notes-for-safari-technology-preview-122/">Safari Technology Preview 122</a>. (Also, at that time it was named <code>color-contrast</code>.) Back then, it was too early to choose a better algorithm.</p>
<p>The CSS standard still calls for browsers to use the older algorithm, but contains a note about the future: “Currently only WCAG 2.1 is supported, however this algorithm is known to have problems, particularly on dark backgrounds. Future revisions of this module will likely introduce additional contrast algorithms.” Debates over which algorithm is best for WCAG 3 are still ongoing, including discussion of licensing of the algorithms under consideration.</p>
<p>Meanwhile, your team should still take great care in choosing color palettes, keeping accessibility in mind. If you are choosing clearly-light or clearly-dark colors for the contrasting color,  <code>contrast-color()</code> will work great even when backed by the WCAG 2 algorithm. It’s in evaluating contrast with mid-tones where the algorithms start to differ in their results.</p>
<p>Plus, the <code>contrast-color()</code> function alone will never guarantee accessibility, even when updated with a better algorithm. “This one has <em>more</em> contrast” is not the same thing as “this one has <em>enough</em> contrast”. There are plenty of colors that never have enough contrast with either black or white, especially at smaller text sizes or thinner font weights.</p>
<h2>Providing enough contrast in the real world</h2>
<p>While thinking about color contrast, we should remember another tool in our arsenal to ensure we provide good contrast for everyone — the<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-contrast"></a><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme"><code>prefers-contrast</code></a> media query. It lets us offer alternative styling to those who want more contrast.</p>
<pre><code><span>@media</span> (<span>prefers-contrast</span>: <span>more</span>) {
  
}
</code></pre>
<p>Let’s think through how to use these tools in a real world situation. Imagine we are creating a website for a tree nursery whose main brand color is a particular shade of bright medium green. Our design team really wants to use #2DAD4E as the main button background.</p>
<p>To keep things simple, let’s also pretend we live in a future when the APCA algorithm has replaced the WCAG 2 algorithm in CSS. This change will mean <code>contrast-color()</code> will return white for our text color against this medium green, not black.</p>
<p>But looking up <a href="https://apcacontrast.com/?BG=2dad4e&amp;TXT=ffffff&amp;DEV=G4g&amp;BUF=A22">this color combination</a>, we see there might not be enough contrast for some users, especially if the text is small. This is where good design is important.</p>
<p><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/APCA-text-green-scaled.png" alt="Testing white on medium green in the APCA contrast calculator. The interface has lots of options for adjusting the colors. And it&#39;s got a panel across the bottom with six sections of examples of white text on this color green, in various sizes and weights of fonts. " width="2560" height="1341" srcset="https://webkit.org/wp-content/uploads/APCA-text-green-scaled.png 2560w, https://webkit.org/wp-content/uploads/APCA-text-green-300x157.png 300w, https://webkit.org/wp-content/uploads/APCA-text-green-1024x536.png 1024w, https://webkit.org/wp-content/uploads/APCA-text-green-768x402.png 768w, https://webkit.org/wp-content/uploads/APCA-text-green-1536x805.png 1536w, https://webkit.org/wp-content/uploads/APCA-text-green-2048x1073.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px"/></p>
<p>When using this shade of green as the background for white text, the APCA score is Lc -60.4.</p>
<p>You might remember that WCAG 2 evaluates contrast with a ratio (like “2.9:1”). However, APCA scores are a single number, ranging from Lc -108 to 106. Whether or not Lc -60.4 has enough contrast depends on how big the text is — and, new in APCA, how thick the font weight is.</p>
<p>There’s information about what’s considered a good target for Bronze, Silver, and Gold level conformance in the <a href="https://readtech.org/ARC/tests/visual-readability-contrast/?tn=criterion">APCA Readability Criterion</a>. These recommendations can really help guide designers to select the size and weight of text to ensure enough contrast, while allowing a range of beautiful color combinations. In fact, the WCAG 3 itself is being designed to provide flexible guidance to help you understand how to support all users, rather than binary judgments the way WCAG 2 does. Good accessibility isn’t about simply meeting a magical metric to check off a box on a list. It’s about understanding what works for real people, and designing for them. And what people need is complex, not binary.</p>
<p>You’ll notice that this particular <a href="https://apcacontrast.com/">APCA Contrast Calculator</a> not only provides a score, but also evaluates the success of dynamic examples showing combinations of font size and font weight. In our case, for “Usage” it says “fluent text okay”. (For the black on blue example above, it instead says “Usage: spot &amp; non text only”.) The Calculator is showing that white text on #2DAD4E works at 24px text if the font weight is 400 or bolder. If we want to use a font-weight of 300, then the text should be at least 41px. Of course, this will depend on which font-face we use, and we aren’t using the same font as that Contrast Calculator does, but there’s far more nuance in this guidance than tools for the WCAG 2 algorithm. And it helps our team come up with a plan for a beautiful design.</p>
<p>Our tree nursery website supports both light and dark mode, and our designers determined that #2DAD4E works as a button color for both light and dark mode for many users, as long as they carefully designed our buttons considering how font size and weight impacts contrast. But even with those considerations, Lc -60.4 is not quite enough contrast for all users, so for anyone who has set their accessibility preferences to ask for more contrast, we’ll replace the button background color with two options — a darker #3B873E green for light mode (with white text, scoring Lc -76.1), and a lighter #77e077 green for dark mode (with black text, scoring Lc 75.2).</p>
<p>Here’s the color palette our fictional design team wants us to accomplish in CSS:</p>
<p><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/green-design-2-scaled.png" alt="A diagram of our color palette, explaining when to use which color combination. (All information is also articulated in the text of this article.)" width="2560" height="1436" srcset="https://webkit.org/wp-content/uploads/green-design-2-scaled.png 2560w, https://webkit.org/wp-content/uploads/green-design-2-300x168.png 300w, https://webkit.org/wp-content/uploads/green-design-2-1024x575.png 1024w, https://webkit.org/wp-content/uploads/green-design-2-768x431.png 768w, https://webkit.org/wp-content/uploads/green-design-2-1536x862.png 1536w, https://webkit.org/wp-content/uploads/green-design-2-2048x1149.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px"/></p>
<p>When we define colors in variables, it’s incredibly easy to swap out color values for these various conditions. And by using <code>contrast-color()</code>, we only need to worry about the background colors, not the text color pairings. We’ll make the browser do the work, and get the paired colors for free.</p>
<p>To accomplish all of these things at once, we can just write this code (because, remember, we are pretending to live in a future when a better algorithm has replaced the WCAG 2 algorithm in CSS):</p>
<pre><code><span>--button-color</span>: #2<span>DAD4E</span>;   

<span>@media</span> (<span>prefers-contrast</span>: <span>more</span>) {
  @<span>media</span> (<span>prefers-color-scheme</span>: <span>light</span>) {
    <span>--button-color</span>: <span>#419543</span>;  
  }
  <span>@media</span> (<span>prefers-color-scheme</span>: <span>dark</span>) {
    <span>--button-color</span>: <span>#77CA8B</span>;  
  }
}

<span>button</span> {
  <span>background-color</span>: <span>var</span>(<span>--button-color</span>);
  <span>color</span>: <span>contrast-color</span>(<span>var</span>(<span>--button-color</span>));
  <span>font-size</span>: <span>1.5</span><span>rem</span>;  
  <span>font-weight</span>: <span>500</span>;
}
</code></pre>
<p>In reality, since the WCAG 2 algorithm is the one driving <code>contrast-color()</code>, we probably couldn’t use it on this website. But if we had another project where the brand color was a darker green, and the choice between white/black was the correct one, it could be quite helpful today.</p>
<p>Using <code>contrast-color()</code> is especially helpful when defining colors for multiple states or options like enabled/disabled, light/dark mode, prefers-contrast, and more.</p>
<h2>Beyond black &amp; white</h2>
<p>You might be wondering, “but what if I want the browser to choose a color beyond just black/white?” If you read about or tried out our original implementation in Safari Technology Preview 122 four years ago, you might remember that the original feature did much more. The newer <code>contrast-color()</code> function is greatly simplified from the original <code>color-contrast()</code>.</p>
<p>Because a decision on which color-contrast algorithm to use for WCAG 3 is still being debated, the CSS Working Group decided to move forward with a tool that simply chooses black or white to contrast with the first color. Keeping it simple makes it possible to swap out the algorithm later. By hardcoding the list of options to be black/white, websites are far less likely to break when the WCAG 2 algorithm is replaced, giving the CSSWG the flexibility it needs to keep making needed changes, even as <code>contrast-color</code> ships into the hands of users.</p>
<p>In the future, more complex tools will come along to support more powerful options. Perhaps you’ll be able to list a set of custom color options and have the browser pick from those, instead of picking from black/white. Perhaps you’ll list a set of options, plus specify a contrast level that you want the browser to aim for, instead of having it picking the choice that yields maximum contrast.</p>
<p>In the meantime, often a simple choice between black and white is all you need. We wanted to get the simple version into your hands sooner, rather than waiting for a process that will take years.</p>
<p>And while all of the examples above show black/white text on a color background, <code>contrast-color</code> can be used for much more. You can use a custom color for your text, and make the background be black/white. Or not involve text at all, and define colors for borders, background — anything. There’s a lot you can do.</p>
<h2>Continue the conversation</h2>
<p>You can learn more about the APCA (Accessible Perceptual Contrast Algorithm) by reading documentation from the folks <a href="https://github.com/Myndex/SAPC-APCA/?tab=readme-ov-file">creating it</a>. Including:</p>
<ul>
<li><a href="https://git.apcacontrast.com/documentation/APCAeasyIntro">The Easy Intro to the APCA Contrast Method</a> — a plain-language introduction to perceptually uniform contrast</li>
<li><a href="https://readtech.org/ARC/tests/bronze-simple-mode/?tn=criterion">Bronze Simple Mode</a> — a “most basic” design guideline, intended for users migrating from WCAG 2 contrast</li>
</ul>
<p>We’d love to hear your thoughts about <code>contrast-color()</code>. Your feedback on this tool can help shape its future. You can find me, Jen Simmons, on <a href="https://bsky.app/profile/jensimmons.bsky.social">Bluesky</a> / <a href="https://front-end.social/@jensimmons">Mastodon</a>. Or follow our other web evangelists —  Saron Yitbarek on <a href="https://bsky.app/profile/saron.bsky.social">BlueSky</a>, and Jon Davis on <a href="https://bsky.app/profile/jondavis.bsky.social">Bluesky</a> / <a href="https://mastodon.social/@jondavis">Mastodon</a>. You can also follow WebKit <a href="https://www.linkedin.com/in/apple-webkit/">on LinkedIn</a>.</p>

                            </div></div>
  </body>
</html>
