<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/facebookresearch/segment-anything-2">Original</a>
    <h1>SAM 2: Segment Anything in Images and Videos</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><strong><a href="https://ai.meta.com/research/" rel="nofollow">AI at Meta, FAIR</a></strong></p>
<p dir="auto"><a href="https://nikhilaravi.com/" rel="nofollow">Nikhila Ravi</a>, <a href="https://gabeur.github.io/" rel="nofollow">Valentin Gabeur</a>, <a href="https://scholar.google.com/citations?user=E8DVVYQAAAAJ&amp;hl=en" rel="nofollow">Yuan-Ting Hu</a>, <a href="https://ronghanghu.com/" rel="nofollow">Ronghang Hu</a>, <a href="https://scholar.google.com/citations?user=4LWx24UAAAAJ&amp;hl=en" rel="nofollow">Chaitanya Ryali</a>, <a href="https://scholar.google.com/citations?user=VeTSl0wAAAAJ&amp;hl=en" rel="nofollow">Tengyu Ma</a>, <a href="https://hkhedr.com/" rel="nofollow">Haitham Khedr</a>, <a href="https://scholar.google.de/citations?user=Tpt57v0AAAAJ&amp;hl=en" rel="nofollow">Roman Rädle</a>, <a href="https://scholar.google.com/citations?hl=fr&amp;user=n-SnMhoAAAAJ" rel="nofollow">Chloe Rolland</a>, <a href="https://scholar.google.com/citations?user=c8IpF9gAAAAJ&amp;hl=en" rel="nofollow">Laura Gustafson</a>, <a href="https://ericmintun.github.io/" rel="nofollow">Eric Mintun</a>, <a href="https://junting.github.io/" rel="nofollow">Junting Pan</a>, <a href="https://scholar.google.co.in/citations?user=m34oaWEAAAAJ&amp;hl=en" rel="nofollow">Kalyan Vasudev Alwala</a>, <a href="https://www.nicolascarion.com/" rel="nofollow">Nicolas Carion</a>, <a href="https://chaoyuan.org/" rel="nofollow">Chao-Yuan Wu</a>, <a href="https://www.rossgirshick.info/" rel="nofollow">Ross Girshick</a>, <a href="https://pdollar.github.io/" rel="nofollow">Piotr Dollár</a>, <a href="https://feichtenhofer.github.io/" rel="nofollow">Christoph Feichtenhofer</a></p>
<p dir="auto">[<a href="https://ai.meta.com/research/publications/sam-2-segment-anything-in-images-and-videos/" rel="nofollow"><code>Paper</code></a>] [<a href="https://ai.meta.com/sam2" rel="nofollow"><code>Project</code></a>] [<a href="https://sam2.metademolab.com/" rel="nofollow"><code>Demo</code></a>] [<a href="https://ai.meta.com/datasets/segment-anything-video" rel="nofollow"><code>Dataset</code></a>] [<a href="https://ai.meta.com/blog/segment-anything-2" rel="nofollow"><code>Blog</code></a>] [<a href="#citing-sam-2"><code>BibTeX</code></a>]</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/assets/model_diagram.png?raw=true"><img src="https://elijer.github.io/facebookresearch/segment-anything-2/raw/main/assets/model_diagram.png?raw=true" alt="SAM 2 architecture"/></a></p>
<p dir="auto"><strong>Segment Anything Model 2 (SAM 2)</strong> is a foundation model towards solving promptable visual segmentation in images and videos. We extend SAM to video by considering images as a video with a single frame. The model design is a simple transformer architecture with streaming memory for real-time video processing. We build a model in the loop data engine, which improves model and data via user interaction, to collect <a href="https://ai.meta.com/datasets/segment-anything-video" rel="nofollow"><strong>our SA-V dataset</strong></a>, the largest video segmentation dataset to date. SAM 2 trained on our data provides strong performance across a wide range of tasks and visual domains.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/assets/sa_v_dataset.jpg?raw=true"><img src="https://elijer.github.io/facebookresearch/segment-anything-2/raw/main/assets/sa_v_dataset.jpg?raw=true" alt="SA-V dataset"/></a></p>

<p dir="auto">Please install SAM 2 on a GPU machine using:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone git@github.com:facebookresearch/segment-anything-2.git

cd segment-anything-2; pip install -e ."><pre>git clone git@github.com:facebookresearch/segment-anything-2.git

<span>cd</span> segment-anything-2<span>;</span> pip install -e <span>.</span></pre></div>
<p dir="auto">To use the SAM 2 predictor and run the example notebooks, <code>jupyter</code> and <code>matplotlib</code> are required and can be installed by:</p>



<p dir="auto">First, we need to download a model checkpoint. All the model checkpoints can be downloaded by running:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cd checkpoints
./download_ckpts.sh"><pre><span>cd</span> checkpoints
./download_ckpts.sh</pre></div>
<p dir="auto">or individually from:</p>
<ul dir="auto">
<li><a href="https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_tiny.pt" rel="nofollow">sam2_hiera_tiny.pt</a></li>
<li><a href="https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_small.pt" rel="nofollow">sam2_hiera_small.pt</a></li>
<li><a href="https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_base_plus.pt" rel="nofollow">sam2_hiera_base_plus.pt</a></li>
<li><a href="https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt" rel="nofollow">sam2_hiera_large.pt</a></li>
</ul>
<p dir="auto">Then SAM 2 can be used in a few lines as follows for image and video prediction.</p>

<p dir="auto">SAM 2 has all the capabilities of <a href="https://github.com/facebookresearch/segment-anything">SAM</a> on static images, and we provide image prediction APIs that closely resemble SAM for image use cases. The <code>SAM2ImagePredictor</code> class has an easy interface for image prompting.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import torch
from sam2.build_sam import build_sam2
from sam2.sam2_image_predictor import SAM2ImagePredictor

checkpoint = &#34;./checkpoints/sam2_hiera_large.pt&#34;
model_cfg = &#34;sam2_hiera_l.yaml&#34;
predictor = SAM2ImagePredictor(build_sam2(model_cfg, checkpoint))

with torch.inference_mode(), torch.autocast(&#34;cuda&#34;, dtype=torch.bfloat16):
    predictor.set_image(&lt;your_image&gt;)
    masks, _, _ = predictor.predict(&lt;input_prompts&gt;)"><pre><span>import</span> <span>torch</span>
<span>from</span> <span>sam2</span>.<span>build_sam</span> <span>import</span> <span>build_sam2</span>
<span>from</span> <span>sam2</span>.<span>sam2_image_predictor</span> <span>import</span> <span>SAM2ImagePredictor</span>

<span>checkpoint</span> <span>=</span> <span>&#34;./checkpoints/sam2_hiera_large.pt&#34;</span>
<span>model_cfg</span> <span>=</span> <span>&#34;sam2_hiera_l.yaml&#34;</span>
<span>predictor</span> <span>=</span> <span>SAM2ImagePredictor</span>(<span>build_sam2</span>(<span>model_cfg</span>, <span>checkpoint</span>))

<span>with</span> <span>torch</span>.<span>inference_mode</span>(), <span>torch</span>.<span>autocast</span>(<span>&#34;cuda&#34;</span>, <span>dtype</span><span>=</span><span>torch</span>.<span>bfloat16</span>):
    <span>predictor</span>.<span>set_image</span>(<span>&lt;</span><span>your_image</span><span>&gt;</span>)
    <span>masks</span>, <span>_</span>, <span>_</span> <span>=</span> <span>predictor</span>.<span>predict</span>(<span>&lt;</span><span>input_prompts</span><span>&gt;</span>)</pre></div>
<p dir="auto">Please refer to the examples in <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/notebooks/image_predictor_example.ipynb">image_predictor_example.ipynb</a> for static image use cases.</p>
<p dir="auto">SAM 2 also supports automatic mask generation on images just like SAM. Please see <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/notebooks/automatic_mask_generator_example.ipynb">automatic_mask_generator_example.ipynb</a> for automatic mask generation in images.</p>

<p dir="auto">For promptable segmentation and tracking in videos, we provide a video predictor with APIs for example to add prompts and propagate masklets throughout a video. SAM 2 supports video inference on multiple objects and uses an inference state to keep track of the interactions in each video.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import torch
from sam2.build_sam import build_sam2_video_predictor

checkpoint = &#34;./checkpoints/sam2_hiera_large.pt&#34;
model_cfg = &#34;sam2_hiera_l.yaml&#34;
predictor = build_sam2_video_predictor(model_cfg, checkpoint)

with torch.inference_mode(), torch.autocast(&#34;cuda&#34;, dtype=torch.bfloat16):
    state = predictor.init_state(&lt;your_video&gt;)

    # add new prompts and instantly get the output on the same frame
    frame_idx, object_ids, masks = predictor.add_new_points(state, &lt;your prompts&gt;):

    # propagate the prompts to get masklets throughout the video
    for frame_idx, object_ids, masks in predictor.propagate_in_video(state):
        ..."><pre><span>import</span> <span>torch</span>
<span>from</span> <span>sam2</span>.<span>build_sam</span> <span>import</span> <span>build_sam2_video_predictor</span>

<span>checkpoint</span> <span>=</span> <span>&#34;./checkpoints/sam2_hiera_large.pt&#34;</span>
<span>model_cfg</span> <span>=</span> <span>&#34;sam2_hiera_l.yaml&#34;</span>
<span>predictor</span> <span>=</span> <span>build_sam2_video_predictor</span>(<span>model_cfg</span>, <span>checkpoint</span>)

<span>with</span> <span>torch</span>.<span>inference_mode</span>(), <span>torch</span>.<span>autocast</span>(<span>&#34;cuda&#34;</span>, <span>dtype</span><span>=</span><span>torch</span>.<span>bfloat16</span>):
    <span>state</span> <span>=</span> <span>predictor</span>.<span>init_state</span>(<span>&lt;</span><span>your_video</span><span>&gt;</span>)

    <span># add new prompts and instantly get the output on the same frame</span>
    <span>frame_idx</span>, <span>object_ids</span>, <span>masks</span> <span>=</span> <span>predictor</span>.<span>add_new_points</span>(<span>state</span>, <span>&lt;</span><span>your</span> <span>prompts</span><span>&gt;</span>):

    <span># propagate the prompts to get masklets throughout the video</span>
    <span>for</span> <span>frame_idx</span>, <span>object_ids</span>, <span>masks</span> <span>in</span> <span>predictor</span>.<span>propagate_in_video</span>(<span>state</span>):
        ...</pre></div>
<p dir="auto">Please refer to the examples in <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/notebooks/video_predictor_example.ipynb">video_predictor_example.ipynb</a> for details on how to add prompts, make refinements, and track multiple objects in videos.</p>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th><strong>Model</strong></th>
<th><strong>Size (M)</strong></th>
<th><strong>Speed (FPS)</strong></th>
<th><strong>SA-V test (J&amp;F)</strong></th>
<th><strong>MOSE val (J&amp;F)</strong></th>
<th><strong>LVOS v2 (J&amp;F)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sam2_hiera_tiny</td>
<td>38.9</td>
<td>47.2</td>
<td>75.0</td>
<td>70.9</td>
<td>75.3</td>
</tr>
<tr>
<td>sam2_hiera_small</td>
<td>46</td>
<td>43.3 (53.0 compiled*)</td>
<td>74.9</td>
<td>71.5</td>
<td>76.4</td>
</tr>
<tr>
<td>sam2_hiera_base_plus</td>
<td>80.8</td>
<td>34.8 (43.8 compiled*)</td>
<td>74.7</td>
<td>72.8</td>
<td>75.8</td>
</tr>
<tr>
<td>sam2_hiera_large</td>
<td>224.4</td>
<td>24.2 (30.2 compiled*)</td>
<td>76.0</td>
<td>74.6</td>
<td>79.8</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">* Compile the model by setting <code>compile_image_encoder: True</code> in the config.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Segment Anything Video Dataset</h2><a id="user-content-segment-anything-video-dataset" aria-label="Permalink: Segment Anything Video Dataset" href="#segment-anything-video-dataset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">See <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/sav_dataset/README.md">sav_dataset/README.md</a> for details.</p>

<p dir="auto">The models are licensed under the <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/LICENSE">Apache 2.0 license</a>. Please refer to our research paper for more details on the models.</p>

<p dir="auto">See <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/CONTRIBUTING.md">contributing</a> and the <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/CODE_OF_CONDUCT.md">code of conduct</a>.</p>

<p dir="auto">The SAM 2 project was made possible with the help of many contributors (alphabetical):</p>
<p dir="auto">Karen Bergan, Daniel Bolya, Alex Bosenberg, Kai Brown, Vispi Cassod, Christopher Chedeau, Ida Cheng, Luc Dahlin, Shoubhik Debnath, Rene Martinez Doehner, Grant Gardner, Sahir Gomez, Rishi Godugu, Baishan Guo, Caleb Ho, Andrew Huang, Somya Jain, Bob Kamma, Amanda Kallet, Jake Kinney, Alexander Kirillov, Shiva Koduvayur, Devansh Kukreja, Robert Kuo, Aohan Lin, Parth Malani, Jitendra Malik, Mallika Malhotra, Miguel Martin, Alexander Miller, Sasha Mitts, William Ngan, George Orlin, Joelle Pineau, Kate Saenko, Rodrick Shepard, Azita Shokrpour, David Soofian, Jonathan Torres, Jenny Truong, Sagar Vaze, Meng Wang, Claudette Ward, Pengchuan Zhang.</p>
<p dir="auto">Third-party code: we use a GPU-based connected component algorithm adapted from <a href="https://github.com/zsef123/Connected_components_PyTorch"><code>cc_torch</code></a> (with its license in <a href="https://elijer.github.io/facebookresearch/segment-anything-2/blob/main/LICENSE_cctorch"><code>LICENSE_cctorch</code></a>) as an optional post-processing step for the mask predictions.</p>

<p dir="auto">If you use SAM 2 or the SA-V dataset in your research, please use the following BibTeX entry.</p>
<div dir="auto" data-snippet-clipboard-copy-content="@article{ravi2024sam2,
  title={SAM 2: Segment Anything in Images and Videos},
  author={Ravi, Nikhila and Gabeur, Valentin and Hu, Yuan-Ting and Hu, Ronghang and Ryali, Chaitanya and Ma, Tengyu and Khedr, Haitham and R{\&#34;a}dle, Roman and Rolland, Chloe and Gustafson, Laura and Mintun, Eric and Pan, Junting and Alwala, Kalyan Vasudev and Carion, Nicolas and Wu, Chao-Yuan and Girshick, Ross and Doll{\&#39;a}r, Piotr and Feichtenhofer, Christoph},
  journal={arXiv preprint},
  year={2024}
}"><pre><span>@article</span>{<span>ravi2024sam2</span>,
  <span>title</span>=<span><span>{</span>SAM 2: Segment Anything in Images and Videos<span>}</span></span>,
  <span>author</span>=<span><span>{</span>Ravi, Nikhila and Gabeur, Valentin and Hu, Yuan-Ting and Hu, Ronghang and Ryali, Chaitanya and Ma, Tengyu and Khedr, Haitham and R{\&#34;a}dle, Roman and Rolland, Chloe and Gustafson, Laura and Mintun, Eric and Pan, Junting and Alwala, Kalyan Vasudev and Carion, Nicolas and Wu, Chao-Yuan and Girshick, Ross and Doll{\&#39;a}r, Piotr and Feichtenhofer, Christoph<span>}</span></span>,
  <span>journal</span>=<span><span>{</span>arXiv preprint<span>}</span></span>,
  <span>year</span>=<span><span>{</span>2024<span>}</span></span>
}</pre></div>
</article></div></div>
  </body>
</html>
