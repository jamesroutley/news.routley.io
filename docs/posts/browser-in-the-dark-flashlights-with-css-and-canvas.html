<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://voussoir.net/writing/browser_in_the_dark">Original</a>
    <h1>Browser in the Dark: flashlights with CSS and canvas</h1>
    
    <div id="readability-page-1" class="page"><article>
<p><a href="http://alok.github.io/writing">Back to writing</a></p>
<ol id="table_of_contents">Table of contents<li><a href="#mixblendmode">mix-blend-mode</a></li><li><a href="#canvas">Canvas</a></li><li><a href="#night_light_with_css">Night Light with CSS</a></li><li><a href="#night_light_with_canvas">Night Light with canvas</a></li></ol>
<p>Note: this article will make more sense if you are using a mouse or other pointing device. Requires javascript.</p>
<p>Warning: things can get a little spooky in the dark!</p>
<p>You can read the source code for this document <a href="https://github.com/voussoir/voussoir.net/raw/master/voussoir.net/writing/browser_in_the_dark/browser_in_the_dark.md">here</a> (or by pressing Ctrl+U in chrome / firefox).</p>
<h2 id="mixblendmode">mix-blend-mode<a href="#mixblendmode"> (¶)</a></h2>
<p>I really like the &#34;dark mode&#34; switch on <a href="https://tonsky.me">https://tonsky.me</a> <a data-index="1" href="#footnote_text_1" id="footnote_link_1" title="[1] Archived here in case it gets changed.">[1]</a>. It&#39;s a fun subversion of expectations and reminds me of <a href="http://alok.github.io/writing/night_light_1995">Night Light (1995)</a>, a PC game for kids about using a flashlight in the dark.</p>
<p>One of the splash texts I put on <a href="http://alok.github.io/?justthesplash">my homepage</a> a while back says &#34;looks better in black and white&#34;. Yesterday, while hypnotized by my own pulsating creation <a data-index="2" href="#footnote_text_2" id="footnote_link_2" title="[2] A little vanity goes a long way!">[2]</a>, I had the idea to put the two together and create a grayscale &#34;flashlight&#34;, or perhaps a lens. I learned that the CSS property <code>mix-blend-mode</code> allows me to make a div that turns everything below it gray. The other mix-blend-mode options are cool too.</p>
<p>The results don&#39;t look exactly like a light source, but it&#39;s a nice toy. Here are some different flashlights and photos with which to admire them:</p>
<p><img data-dark-src="the_bear_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/the_bear.jpg"/></p>
<p><img data-dark-src="shining_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/shining.jpg"/></p>
<p><img data-dark-src="all_american_murder_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/all_american_murder.jpg"/></p>
<p><span>It applies to all elements on the page. <SPAN color="ivysaur">sample</SPAN> <SPAN color="charmeleon">sample</SPAN> <SPAN color="squirtle">sample</SPAN> <SPAN color="chucknorris">sample</SPAN> <SPAN color="cabs">sample</SPAN>. <!-- https://stackoverflow.com/questions/8318911/why-does-html-think-chucknorris-is-a-color --></span></p>
<p><span><SPAN color="red">♫ It&#39;s just your imagination</SPAN></span></p>
<p><img data-dark-src="dancer_in_the_dark_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/dancer_in_the_dark.jpg"/></p>
<p><img data-dark-src="the_tracker_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/the_tracker.jpg"/></p>
<p><img data-dark-src="hellraiser_spooky.jpg" loading="lazy" src="http://alok.github.io/writing/browser_in_the_dark/hellraiser.jpg"/></p>
<h2 id="canvas">Canvas<a href="#canvas"> (¶)</a></h2>
<canvas id="fullpage_canvas"></canvas><p>I think those effects are fun, but they don&#39;t really give you the feeling of being in the dark like tonsky&#39;s flashlight switch. His works by setting the background color to black, so all the black text &#34;disappears&#34; even though it&#39;s still there. I wanted to come up with a flashlight that really works for all elements on the page, but I don&#39;t think any combination of DOM elements and mix-blend-modes would do it.</p>
<p>I&#39;ve never used HTML canvas before, but I realized that would be the correct solution. I was able to get a basic flashlight effect working by covering the entire screen in a black rectangle, and punching a hole in it.</p>
<p><span>If at any time you need to come back, all you must do is open your eyes.</span></p>
<p>This works great in conjunction with the mix-blend-mode lights:</p>
<p>Go back up and look at the images again!</p>
<h2 id="night_light_with_css">Night Light with CSS<a href="#night_light_with_css"> (¶)</a></h2>
<p>I also wanted to try making a Night Light game effect. The player who recorded the above video also uploaded the game .iso to the Internet Archive. Thank you Vulnerose!</p>
<p><a href="https://archive.org/details/NightLight_201809">https://archive.org/details/NightLight_201809</a></p>
<p>I was able to open the iso in 7-zip, extract the level artwork as bmp files, produce the toy below. I&#39;ve made a <a href="http://alok.github.io/writing/night_light_1995">followup article</a> with the other assets.</p>
<p>I first tried to approach it with mix-blend-mode, but I don&#39;t think you can use those effects to produce arbitrary image masks. I got it done with a more traditional method of translating a background-image property. The only jank fix I&#39;m not really happy about is the background-size property for the flashlight layer, which I had to set using px values in javascript to match the rendered size of the parent. All the other background-size options created ill effects when I wanted to change the size of the flashlight to anything other than 100%. But I&#39;m not that good with CSS and there might be a better answer.</p>
<p>Please turn off your flashlight first. Or don&#39;t, and enjoy the two effects together!</p>
<p>And, I couldn&#39;t help it:</p>
<h2 id="night_light_with_canvas">Night Light with canvas<a href="#night_light_with_canvas"> (¶)</a></h2>
<p>The background-image version of Night Light works okay, but the revealed image is sometimes a few pixels out of alignment, which weakens the illusion. This depends on how much you&#39;ve resized your browser and is especially noticeable with the vertical lines on the &#34;close out sale&#34; window.</p>
<p>This was a good opportunity for me to get practice with canvas, and I find the results look a lot smoother, so here&#39;s the same game again.</p>
<canvas id="nightlight_bedroom_canvas"></canvas><canvas id="nightlight_theylive_obey_canvas"></canvas><canvas id="nightlight_theylive_consume_canvas"></canvas><p>Have fun!</p>
<p><a data-index="1" href="#footnote_link_1" id="footnote_text_1">[1]</a> <a href="http://alok.github.io/writing/browser_in_the_dark/tonsky_me.html">Archived here</a> in case it gets changed.</p>
<p><a data-index="2" href="#footnote_link_2" id="footnote_text_2">[2]</a> A little vanity goes a long way!</p>
<hr/>
<p><a href="https://github.com/voussoir/voussoir.net/commits/master/voussoir.net/writing/browser_in_the_dark/browser_in_the_dark.md">View this document&#39;s history</a></p>
<ul>
<li><a href="https://github.com/voussoir/voussoir.net/commit/a0402ff5b94e2725703dd6971547533ca91b2af3">2022-04-13 Add links to the followup article.</a></li>
<li><a href="https://github.com/voussoir/voussoir.net/commit/ec38f1a47aeae96cbec3b1e594ce57d9a13d0ce2">2022-04-07 Move tonsky_me.html to my own folder.</a></li>
<li><a href="https://github.com/voussoir/voussoir.net/commit/75642340e20d0f8713eeaabf7a0d84ead9d840b7">2022-04-04 Update Night Light with actual game resources.</a></li>
<li><a href="https://github.com/voussoir/voussoir.net/commit/4b6ae138c865146c22625e40fa9844c2320e2c43">2022-03-21 Oversize the canvas to cover scroll on android chrome.</a></li>
<li><a href="https://github.com/voussoir/voussoir.net/commit/7799827931cf63ecccc2f4dbc9fe0d61882a2765">2022-03-21 Add browser_in_the_dark.md.</a></li>
</ul>
<p>Contact me: writing@voussoir.net</p>
</article></div>
  </body>
</html>
