<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bmitch.net/blog/2025-08-22-ghrc-appears-malicious/">Original</a>
    <h1>Ghrc.io appears to be malicious</h1>
    
    <div id="readability-page-1" class="page"><div><article><div><p>A simple typo of ghcr.io to ghrc.io would normally be a small goof.
You’d typically get a 404 or similar error, finally work out the issue, fix it, and move along.
But in this case, that typo appears to be doing something very malicious, stealing GitHub credentials.</p><h2 id="whats-ghcrio">What’s ghcr.io?</h2><p>First, a quick bit of background.
<code>ghcr.io</code> is an OCI conformant registry for container images and OCI artifacts used by a lot of projects.
It’s part of GitHub and is a very popular image and artifact repository used by open source projects.</p><h2 id="ghrcio-is-just-a-default-nginx">ghrc.io Is Just a Default Nginx</h2><p>At first glance, <code>ghrc.io</code> is just a default nginx install:</p><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://ghrc.io/
</span></span><span><span>HTTP/2 <span>200</span>
</span></span><span><span>server: nginx
</span></span><span><span>date: Fri, <span>22</span> Aug <span>2025</span> 17:58:01 GMT
</span></span><span><span>content-type: text/html
</span></span><span><span>content-length: <span>615</span>
</span></span><span><span>last-modified: Tue, <span>23</span> Apr <span>2024</span> 14:04:32 GMT
</span></span><span><span>etag: <span>&#34;6627bff0-267&#34;</span>
</span></span><span><span>strict-transport-security: max-age<span>=</span>31536000<span>;</span> includeSubDomains
</span></span><span><span>accept-ranges: bytes
</span></span><span><span>
</span></span><span><span>&lt;!DOCTYPE html&gt;
</span></span><span><span>&lt;html&gt;
</span></span><span><span>&lt;head&gt;
</span></span><span><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span><span>&lt;style&gt;
</span></span><span><span>html <span>{</span> color-scheme: light dark<span>;</span> <span>}</span>
</span></span><span><span>body <span>{</span> width: 35em<span>;</span> margin: <span>0</span> auto<span>;</span>
</span></span><span><span>font-family: Tahoma, Verdana, Arial, sans-serif<span>;</span> <span>}</span>
</span></span><span><span>&lt;/style&gt;
</span></span><span><span>&lt;/head&gt;
</span></span><span><span>&lt;body&gt;
</span></span><span><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span><span>
</span></span><span><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span><span>&lt;a <span>href</span><span>=</span><span>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span><span>Commercial support is available at
</span></span><span><span>&lt;a <span>href</span><span>=</span><span>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span><span>
</span></span><span><span>&lt;p&gt;&lt;em&gt;Thank you <span>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span><span>&lt;/body&gt;
</span></span><span><span>&lt;/html&gt;
</span></span></code></pre></div><p>Even checking other links gives a typical 404 error:</p><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://ghrc.io/404/
</span></span><span><span>HTTP/2 <span>404</span>
</span></span><span><span>server: nginx
</span></span><span><span>date: Fri, <span>22</span> Aug <span>2025</span> 17:58:04 GMT
</span></span><span><span>content-type: text/html
</span></span><span><span>content-length: <span>146</span>
</span></span><span><span>strict-transport-security: max-age<span>=</span>31536000<span>;</span> includeSubDomains
</span></span><span><span>
</span></span><span><span>&lt;html&gt;
</span></span><span><span>&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;
</span></span><span><span>&lt;body&gt;
</span></span><span><span>&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;
</span></span><span><span>&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;
</span></span><span><span>&lt;/body&gt;
</span></span><span><span>&lt;/html&gt;
</span></span></code></pre></div><h2 id="why-is-it-malicious">Why Is It Malicious?</h2><p>The concerning part comes in when looking at the OCI API’s.
Those are all under the <code>/v2/</code> prefix for legacy reasons.
Looking at <code>ghrc.io</code>, suddenly it’s not acting like a default nginx install anymore:</p><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://ghrc.io/v2/
</span></span><span><span>HTTP/2 <span>401</span>
</span></span><span><span>server: nginx
</span></span><span><span>date: Fri, <span>22</span> Aug <span>2025</span> 17:56:36 GMT
</span></span><span><span>content-type: application/json
</span></span><span><span>content-length: <span>72</span>
</span></span><span><span>www-authenticate: Bearer <span>realm</span><span>=</span><span>&#34;https://ghrc.io/token&#34;</span>
</span></span><span><span>
</span></span><span><span><span>{</span><span>&#34;errors&#34;</span>:<span>[{</span><span>&#34;code&#34;</span>:<span>&#34;UNAUTHORIZED&#34;</span>,<span>&#34;message&#34;</span>:<span>&#34;authentication required&#34;</span><span>}]}</span>
</span></span></code></pre></div><p>Compare that to some other registries and you’ll see the 401 status, <code>www-authenticate</code> header, and error message look very similar:</p><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://ghcr.io/v2/
</span></span><span><span>HTTP/2 <span>401</span>
</span></span><span><span>content-type: application/json
</span></span><span><span>docker-distribution-api-version: registry/2.0
</span></span><span><span>strict-transport-security: max-age<span>=</span>63072000<span>;</span> includeSubDomains<span>;</span> preload
</span></span><span><span>www-authenticate: Bearer <span>realm</span><span>=</span><span>&#34;https://ghcr.io/token&#34;</span>,service<span>=</span><span>&#34;ghcr.io&#34;</span>,scope<span>=</span><span>&#34;repository:user/image:pull&#34;</span>
</span></span><span><span>date: Fri, <span>22</span> Aug <span>2025</span> 17:51:36 GMT
</span></span><span><span>content-length: <span>73</span>
</span></span><span><span>x-github-request-id: DA46:5B047:5EDB5D:66E5C2:68A8AE28
</span></span><span><span>
</span></span><span><span><span>{</span><span>&#34;errors&#34;</span>:<span>[{</span><span>&#34;code&#34;</span>:<span>&#34;UNAUTHORIZED&#34;</span>,<span>&#34;message&#34;</span>:<span>&#34;authentication required&#34;</span><span>}]}</span>
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://registry-1.docker.io/v2/
</span></span><span><span>HTTP/2 <span>401</span>
</span></span><span><span>date: Sun, <span>24</span> Aug <span>2025</span> 17:31:43 GMT
</span></span><span><span>content-type: application/json
</span></span><span><span>content-length: <span>87</span>
</span></span><span><span>docker-distribution-api-version: registry/2.0
</span></span><span><span>www-authenticate: Bearer <span>realm</span><span>=</span><span>&#34;https://auth.docker.io/token&#34;</span>,service<span>=</span><span>&#34;registry.docker.io&#34;</span>
</span></span><span><span>strict-transport-security: max-age<span>=</span><span>31536000</span>
</span></span><span><span>
</span></span><span><span><span>{</span><span>&#34;errors&#34;</span>:<span>[{</span><span>&#34;code&#34;</span>:<span>&#34;UNAUTHORIZED&#34;</span>,<span>&#34;message&#34;</span>:<span>&#34;authentication required&#34;</span>,<span>&#34;detail&#34;</span>:null<span>}]}</span>
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="shell"><span><span>$ curl -i https://quay.io/v2/
</span></span><span><span>HTTP/2 <span>401</span>
</span></span><span><span>date: Sun, <span>24</span> Aug <span>2025</span> 17:32:18 GMT
</span></span><span><span>content-type: text/html<span>;</span> <span>charset</span><span>=</span>utf-8
</span></span><span><span>content-length: <span>4</span>
</span></span><span><span>server: nginx/1.22.1
</span></span><span><span>www-authenticate: Bearer <span>realm</span><span>=</span><span>&#34;https://quay.io/v2/auth&#34;</span>,service<span>=</span><span>&#34;quay.io&#34;</span>
</span></span><span><span>docker-distribution-api-version: registry/2.0
</span></span><span><span>
</span></span><span><span><span>true</span>
</span></span></code></pre></div><p>The (optional) error message is defined by the <a href="https://github.com/opencontainers/distribution-spec/">OCI Distribution Spec</a> along with the various OCI APIs under the <code>/v2/</code> prefix.
Authentication hasn’t been standardized by OCI, yet, but projects all use the <a href="https://distribution.github.io/distribution/spec/auth/token/">token auth workflow</a> currently defined by the distribution project.</p><p><strong>The important detail is this <code>www-authenticate</code> header is telling OCI clients, like Docker, containerd, podman, and the various CRI’s used by Kubernetes, to send their user credentials to that <code>https://ghrc.io/token</code> API.</strong>
There is no legitimate reason to configure this header on a default nginx install, and other parts of the server indicate that this is not a container registry.</p><h2 id="whats-the-risk">What’s the Risk?</h2><p>All signs point to this being a credential stealing typo-squatting attack.
Credentials would be stolen only if you stored credentials for the <code>ghrc.io</code> registry, because clients won’t send credentials for a different host to <code>ghcr.io</code>.</p><p>Some scenarios that would result in credentials being leaked include:</p><ul><li>Running <code>docker login ghrc.io</code>.</li><li>A GitHub action with <code>uses: docker/login-action</code> and with <code>registry: ghrc.io</code>.</li><li>Creating a Kubernetes secret with registry credentials for <code>ghrc.io</code> and then trying to pull an image from that typoed host.</li></ul><p>Simply trying to push or pull an image to this registry without logging in will not leak credentials and will not leak any data other than your repository name.
These commands default to trying to acquire an anonymous token, which will quickly fail.</p><h2 id="what-should-you-do">What Should You Do?</h2><p>If you’ve ever accidentally performed the login to the wrong server, you should change your password, revoke any PATs you used, and look for any potentially malicious activity in your GitHub account.
An attacker could use it to push malicious images to your <code>ghcr.io</code> repositories, or they may gain access to your GitHub account directly depending on what login credentials were used.</p></div></article></div></div>
  </body>
</html>
