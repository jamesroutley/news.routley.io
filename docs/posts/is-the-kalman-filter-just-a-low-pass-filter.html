<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jbconsulting.substack.com/p/is-the-kalman-filter-just-a-low-pass">Original</a>
    <h1>Is the Kalman filter just a low-pass filter?</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><div class=""><div><div dir="auto"><p><em>Quick notes: No, </em><strong>These Are Systems</strong><em> isn’t going to be just “the Kalman Filter Blog”. Yes, I plan to continue the inflation series. Yes, I am still planning to write an introductory series about control theory more broadly. There’s a lot of material to get through! As always, I welcome your feedback.</em></p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg" width="1370" height="555" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/bf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:555,&#34;width&#34;:1370,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:131476,&#34;alt&#34;:&#34;Pictured: Rudolf Kálmán (left), Norbert Wiener (right).&#34;,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:false}" alt="Pictured: Rudolf Kálmán (left), Norbert Wiener (right)." title="Pictured: Rudolf Kálmán (left), Norbert Wiener (right)." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf51ece8-fad7-484f-999e-f5c750158faa_1370x555.jpeg 1456w" sizes="100vw"/></picture></a><figcaption>Rudolf Kálmán (left), and Norbert Wiener (right), helped advance 20th century signal-processing and enable the Apollo missions.</figcaption></figure></div><p>Among the frequently-asked, frequently-unanswered questions about the Kalman filter are these:</p><ul><li><p>Is the Kalman filter essentially a kind of frequency filter, like a low-pass filter?</p></li><li><p>Do Kalman and low-pass filters serve the same purpose?</p></li><li><p><span>Which one is… </span><em>better</em><span>?</span></p></li></ul><p><a href="https://dsp.stackexchange.com/questions/75281/why-is-modern-control-theory-in-the-time-domain-instead-of-the-s-domain" rel="">Ahh, the never-ending war</a><span> between the </span><a href="https://en.wikipedia.org/wiki/Time_domain" rel="">time-domain</a><span> and the </span><a href="https://en.wikipedia.org/wiki/Frequency_domain" rel="">frequency-domain</a><span> perspectives. Well, let’s get some answers!</span></p><p><span>My </span><a href="https://jbconsulting.substack.com/p/voiding-the-warranty-how-the-kalman" rel="">previous</a><span> </span><a href="https://jbconsulting.substack.com/p/the-kalman-filter-on-a-moving-target" rel="">two</a><span> posts in this series introduced the idea of Kalman filtering, and examined how it relates to the principles of Bayesian probability. (If the term is new to you, then read those first!)</span></p><p><span>To quickly summarize: a Kalman filter is a very fast, very effective algorithm that you can use for estimating the true value of some signal in the presence of noise. (Among other applications).</span><a id="footnote-anchor-1" href="#footnote-1" rel="">1</a></p><p><span>But to anyone with signal processing experience, that sounds immediately reminiscent of the job of a frequency-selective filter, such as a </span><em>low-pass</em><span>, </span><em>high-pass</em><span>, or </span><em>band-pass</em><span> filter. In fact, pretty much the first thing anybody does when they notice their data is too noisy is to reach for some sort of low-pass filter to clean it up a little.</span></p><p><span>(To bring you up to speed, a </span><strong>low-pass filter</strong><span> is any technique that smooths a signal by cutting out high-frequency noise. A simple version that many readers will be familiar with is running a moving average in Excel.)</span><a id="footnote-anchor-2" href="#footnote-2" rel="">2</a></p><p>So is the Kalman filter a sort of frequency filter?</p><p><span>The question is actually a bit more complicated than it sounds, because there isn’t any </span><em>one</em><span> Kalman filter. The Kalman filter is really a </span><strong>recipe</strong><span> for constructing optimal linear predictive filters, but the actual characteristics of the resulting filter will depend on the dynamics, state variables, and sensors that you’ve tuned it for, and that dependence gets reflected numerically in the various matrices that your specific Kalman filter is built from.</span></p><p>And nor is there any one frequency filter.</p><p><span>A low-pass filter might nicely smooth out the noise from a sensor, but if you’re trying to tune into an FM radio station, it wouldn’t be the right choice — you need a bandpass filter, centered on that station’s frequency.</span><a id="footnote-anchor-3" href="#footnote-3" rel="">3</a><span> On the other hand, if you want to remove trends to look at short-term cycles in the housing market, then you’ll want a high-pass filter.</span><a id="footnote-anchor-4" href="#footnote-4" rel="">4</a></p><p><span>The frequency-domain view suggests that we think in terms of </span><em>signal</em><span> and </span><em>noise</em><span> occupying various parts of the frequency spectrum, and sometimes competing with each other. The frequency filter that is right for you depends on what counts as signal to you, and what counts as noise.</span></p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png" width="900" height="300" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:300,&#34;width&#34;:900,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:74101,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8d28bcc3-b5e6-4241-acea-b57c8bbbc2a3_900x300.png 1456w" sizes="100vw" loading="lazy"/></picture></a><figcaption>A low-pass filter captures gradual trends, while a high-pass filter removes them.</figcaption></figure></div><p><span>Not surprisingly, there is also a recipe to construct optimal frequency-domain filters, given some prior information about the spectral densities of the signal and noise, respectively. (This is called the </span><a href="https://en.wikipedia.org/wiki/Wiener_filter" rel="">Wiener filter</a><span>, after the “Father of Cybernetics” Norbert Wiener).</span><a id="footnote-anchor-5" href="#footnote-5" rel="">5</a><span> </span><a id="footnote-anchor-6" href="#footnote-6" rel="">6</a></p><p><span>Wiener’s recipe is famously difficult to work with, but basically says: “</span><em>let through such frequency bands where the signal exceeds the noise; cut out those where the noise exceeds the signal</em><span>.”</span></p><p><em>Well? Are they the same? Stop explaining why it’s so complicated and just answer the question!</em></p><p>Okay, okay.</p><p><span>Let’s look at an example: a temperature sensor measuring a cup of water that is exposed to the elements. (Let’s say this is part of a remote weather station). The water temperature </span><em>T</em><span> gradually drifts up and down, unpredictably influenced by the surrounding environment in ways that we can’t predict, because we’re not measuring the surroundings — just the water. In the time between one measurement </span><em>Tₖ</em><span> and the next, the water temperature will have drifted by some mean-square amount Q, although we can’t predict in any individual timestep whether that drift will be big, small, or even up or down.</span></p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png" width="454" height="176.16871165644173" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/21f76343-2347-4e94-9738-b680f11094fd_652x253.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:253,&#34;width&#34;:652,&#34;resizeWidth&#34;:454,&#34;bytes&#34;:9657,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F21f76343-2347-4e94-9738-b680f11094fd_652x253.png 1456w" sizes="100vw" loading="lazy"/></picture></a></figure></div><p><span>On top of the real changes in water temperature, the sensor also adds its own measurement noise with variance </span><em>R</em><span>. And to keep things simple, it’s all Gaussian white noise.</span></p><p>The corresponding Kalman filter for this system has a very simple 1D structure, so we don’t need any matrices:</p><ul><li><p><em>Prediction step</em><span>:</span></p><ul><li><p><span> ͞</span><em>μₖ</em><span> = </span><em>μₖ₋₁   </em><span>              — We don’t know which way the system will move next</span></p></li><li><p><span>  ͞</span><em>σ²ₖ</em><span> = </span><em>σ²ₖ₋₁ </em><span>+ </span><em>Q</em><span>      — Our certainty about the future is less than the present</span></p></li></ul></li><li><p><em>Update step</em><span>: </span></p><ul><li><p><em>Kₖ</em><span> = ͞</span><em>σ²ₖ</em><span>/( ͞</span><em>σ²ₖ </em><span>+ </span><em>R</em><span>)          — Kalman gain tracks measurement confidence</span></p></li><li><p><em>μₖ</em><span> =  ͞</span><em>μₖ</em><span> + </span><em>Kₖ</em><span>(</span><em>Tₖ</em><span> − ͞</span><em>μₖ</em><span>)     — Mean belief shifts with surprising</span><a id="footnote-anchor-7" href="#footnote-7" rel="">7</a><span> new data</span></p></li><li><p><em>σ²ₖ</em><span> = (1 − </span><em>Kₖ</em><span>) ͞</span><em>σ²ₖ     </em><span>       — Uncertainty shrinks with the new data</span></p></li></ul></li></ul><p><span>You might notice that regardless of what the measurements </span><em>Tₖ</em><span> actually are, the variance </span><em>σ² </em><span>evolves exactly the same way with each update: Average down towards </span><em>R</em><span>, and then grow by </span><em>Q</em><span>; average down towards </span><em>R</em><span>, then grow by </span><em>Q</em><span> again; etc. After the filter has been running for a while, the variance — and thus the Kalman gain — approaches a steady state:</span><a id="footnote-anchor-8" href="#footnote-8" rel="">8</a></p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png" width="216" height="103" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:103,&#34;width&#34;:216,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:3608,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5f402e2e-8342-4383-b44f-a0b5e35ab353_216x103.png 1456w" sizes="100vw" loading="lazy"/></picture></a></figure></div><p>What do I mean by “a while”? Let me show you:</p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png" width="1456" height="326" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:326,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:86701,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F6496f0f8-a4a5-45dd-b370-e7b64c2825b3_1691x379.png 1456w" sizes="100vw" loading="lazy"/></picture></a></figure></div><p>At this point, the recursion relationship for the mean from one update to the next becomes a linear filter with constant coefficients:</p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png" width="203" height="19" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/d4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:19,&#34;width&#34;:203,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:801,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4a16a2e-6032-46e5-9d10-1ca2c11e6c2c_203x19.png 1456w" sizes="100vw" loading="lazy"/></picture></a></figure></div><p><span>As it happens, this is </span><em>precisely</em><span> a first-order low-pass filter with a pole at </span><em>z</em><span> = 1 - </span><em>Kₛₛ</em><span>. We can plot this on a Bode plot, which displays how a system transforms signals of various frequencies. (Have you ever seen the Bode plot of a Kalman filter before?)</span><a id="footnote-anchor-9" href="#footnote-9" rel="">9</a></p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png" width="1456" height="326" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:326,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:89840,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0112e722-dcb4-407b-9c05-d0fc7859b869_1691x379.png 1456w" sizes="100vw" loading="lazy"/></picture></a><figcaption><em>Yep, that’s a low-pass filter</em></figcaption></figure></div><p>And here’s what both filters look like in action. The Kalman and Wiener filter outputs overlap to the point that it’s quite difficult to distinguish them. (I gave them both an initial guess that’s off by 5°C).</p><div><figure><a target="_blank" rel="nofollow" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png" width="900" height="400" data-attrs="{&#34;src&#34;:&#34;https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:400,&#34;width&#34;:900,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:91050,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F8632a03e-d976-48c5-802f-0e0bf21e3243_900x400.png 1456w" sizes="100vw" loading="lazy"/></picture></a></figure></div><ul><li><p><span>Remember, filtering data isn’t just about smoothing your measurements to make them look nice for your boss. A good filter gives you the </span><em>best estimate of the truth</em><span> from measurements that are corrupted by noise.</span></p></li></ul><p><span>So in summary: yes, at least for this system where using a low-pass filter is justified, the Kalman filter </span><em>becomes</em><span> that low-pass filter, after it’s been running for a while.</span></p><p><span>And indeed, it turns out in general that </span><strong>as the Kalman filter runs,</strong><span> </span><strong>it gradually morphs into the optimal Wiener filter for the system it models.</strong><a id="footnote-anchor-10" href="#footnote-10" rel="">10</a><span> </span><a id="footnote-anchor-11" href="#footnote-11" rel="">11</a></p><p><a href="https://gitlab.com/these-are-systems/public/-/tree/master/tas_public/articles/article_20220726" rel="">Source code is available on gitlab</a><span> if you’d like to play with this.</span></p><p><span>In fact, in his famous 1960 paper, Rudolf Kálmán introduces his filter partly as a technique for </span><em>constructing</em><span> the optimal Wiener filter. And in that paper, he makes the very same observation:</span></p><blockquote><p><span>             </span><strong>x</strong><span>*(</span><em>t </em><span>+ 1|</span><em>t</em><span>) = </span><strong>Φ</strong><span>*(</span><em>t</em><span> + 1; </span><em>t</em><span>)</span><strong>x</strong><span>*(</span><em>t</em><span>|</span><em>t</em><span> – 1) + </span><strong>∆</strong><span>*(</span><em>t</em><span>)</span><strong>y</strong><span>(</span><em>t</em><span>)                                          (21)</span></p><p><span>The dynamic system (21) is, in general, nonstationary. This is due to two things: (1) The time dependence of </span><strong>Φ</strong><span>(t + 1; t) and </span><strong>M</strong><span>(t); (2) the fact that the estimation starts at t = t₀ and improves as more data are accumulated. If Φ, M are constants, it can be shown that (21) becomes a stationary dynamic system in the limit t → ∞. This is the case treated by the classical Wiener theory.</span></p><p><span>             — R. E. Kálmán, </span><em>A New Approach to Linear Filtering and Prediction Problems</em></p></blockquote><p>In other words, if the covariance is initialized with its steady-state value, and the noise and system dynamics don’t vary with time, then the Kalman filter is a conventional frequency-domain filter with constant coefficients.</p><p><em><span>So does that mean the Kalman filter is </span><strong>better</strong><span> than the best frequency-domain filter?</span></em></p><p>If you care about rapid convergence to truth from an initial state of broad ignorance, or if you’re dealing with a system whose dynamics or noise characteristics are themselves evolving in some way, then the full (ie, dynamic) Kalman filter is much better equipped to deal with that.</p><p>On the other hand, if you’re going to be processing the same signal continuously, or you can initialize to a known-correct state, then implementing your filter as a dynamic Kalman filter is both overkill and wasteful, because you’ll just end up inverting a bunch of matrices every timestep for no reason. For such cases, it makes a lot of sense to precalculate the steady-state Kalman gain and then implement a Wiener filter with constant coefficients. And as a plus, this will allow you to leverage the powerful techniques of frequency-domain analysis like poles, zeros, and Bode plots to guarantee that your system stays well-behaved.</p><p>So I’m not going to declare a victor here.</p><p><span>This post isn’t intended as professional engineering advice. If you </span><em>are</em><span> looking for professional engineering advice, please </span><a href="https://www.jbaylessconsulting.ca" rel="">contact me</a><span> with your requirements.</span></p></div></div></div></article></div></div></div>
  </body>
</html>
