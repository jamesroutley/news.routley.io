<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tanelpoder.com/posts/generate-qr-code-with-pure-sql-in-postgres/">Original</a>
    <h1>Generate QR Codes with Pure SQL in PostgreSQL</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>As my cat woke me up way too early for a Saturday morning, I decided to put all this extra time (and my ChatGPT Pro subscription) into good use and generated a QR-code generator for PostgreSQL, written as a <strong>single pure SQL statement</strong>. No external libraries or Postgres extension installation needed!</p>
<p>The <a href="https://github.com/tanelpoder/tpt-postgres/blob/main/demos/pqr.sql">pqr.sql</a> example usage is simple:</p>
<pre>$ psql -qf pqr.sql -v payload=&#39;Hello, World!&#39;
</pre>
<p><img src="https://tanelpoder.com/files/images/pqr.webp" alt="An example QR code created with SQL"/></p>
<p>There’s also a bit more complex version <a href="https://github.com/tanelpoder/tpt-postgres/blob/main/demos/pqrsafe.sql">pqrsafe.sql</a> that raises an error if you’re trying to encode a too long payload into the QR code (the basic version would just generate a QR code that doesn’t “read”).</p>
<pre>$ psql -qf pqrsafe.sql -v payload=&#39;Hello, World!!!&#39;
Version 1-M (ECC M) cannot encode byte payloads that long. Got 15 characters (15 bytes).
</pre>
<p>I did this purely for fun and learning, I don’t think this is going to be the best way for generating QR codes in production. But optimizing this SQL to run faster should be a fun learning exercise. PostgreSQL 17 ran it much faster than 16 in my lab, haven’t gotten to compare the execution plans yet.</p>
<p><strong>Fun fact:</strong> about 20 years ago, I spent my entire Sunday <em>manually</em> writing an important <a href="https://github.com/tanelpoder/tpt-oracle/blob/master/fish.sql">production fish generator</a> utility for large-scale Oracle databases. Today I got all the QR code work done with just an hour of talking to OpenAI Codex.</p>
<p><img src="https://tanelpoder.com/files/images/oracle-fish.webp" alt="A SQL generated image of a fish"/></p>
<p><strong>I am an 11x engineer now!</strong></p>

</div></div>
  </body>
</html>
