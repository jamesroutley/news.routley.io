<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/stenh0use/docker-machine-for-mac">Original</a>
    <h1>Docker for Mac Without Docker Desktop</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto">If you need docker and kernel modules to support things like SCTP, IP_VS, WireGuard etc. then this project might be for you.</p>
<p dir="auto">These Vagrant boxes are intended to replace Docker for Mac and utilises docker-machine, Vagrant, VirtualBox and Ansible to provide a fully featured linux vm.</p>
<p dir="auto">Motivation: Docker for Mac was proving to be a workflow pain rather than a workflow gain. It was slowing down my 16&#34; Macbook Pro (32GB RAM, 6 CPUs), draining the battery, and causing the fans to constantly spin at full speed. There had also been occurrences where kernel modules had been removed, rendering it difficult to do system development.</p>
<h2 dir="auto"><a id="user-content-background" aria-hidden="true" href="#background"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Background</h2>
<p dir="auto">Vagrant and VirtualBox can be used to quickly build or rebuild virtual servers.</p>
<p dir="auto">This Vagrant profile installs <a href="https://www.docker.com/" rel="nofollow">docker</a> using the <a href="http://www.ansible.com/" rel="nofollow">Ansible</a> provisioner and finishes up with the docker-machine configuration.</p>
<h2 dir="auto"><a id="user-content-getting-started" aria-hidden="true" href="#getting-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting Started</h2>
<p dir="auto">Each docker-machine directory contains a <code>Vagrantfile</code> for a different base operating systems (hereafter this folder shall be called the [vagrant_root]), which tells Vagrant how to set up your virtual machine in VirtualBox.</p>
<p dir="auto">To use the vagrant file, you will need to have done the following:</p>
<ol dir="auto">
<li>Download and Install <a href="https://www.virtualbox.org/wiki/Downloads" rel="nofollow">VirtualBox</a></li>
<li>Download and Install <a href="https://www.vagrantup.com/downloads.html" rel="nofollow">Vagrant</a></li>
<li>If you want to completely remove Docker for Mac <a href="https://github.com/docker/toolbox/blob/master/osx/uninstall.sh">run this script</a> (recommended)</li>
<li>If you removed Docker for Mac you&#39;ll then need to <a href="https://docs.docker.com/engine/install/binaries/" rel="nofollow">Download and install</a> the <code>docker</code> cli binary</li>
<li>Install Docker Machine <a href="https://docs.docker.com/machine/install-machine/" rel="nofollow">docker-machine</a></li>
<li>Install <a href="http://docs.ansible.com/ansible/latest/intro_installation.html" rel="nofollow">Ansible</a></li>
<li>Open a shell prompt (Terminal app on a Mac) and cd into the folder containing the <code>Vagrantfile</code> of the target operating systems that you want to build.</li>
</ol>
<p dir="auto">Once all of that is done, you can simply type in <code>make build</code>, and Vagrant will create a new VM, install the base box, and configure it to work with <code>docker</code>.</p>
<p dir="auto">Once the new VM is up and running, you should see the message:</p>
<div data-snippet-clipboard-copy-content="Docker Machine setup was successful
To connect to this host run &#34;eval `docker-machine env &lt;vagrant_hostname&gt;`&#34;. To make this your default docker machine add the command or the output from &#34;docker-machine env &lt;vagrant_hostname&gt;&#34; to your ~/.bash_profile"><pre><code>Docker Machine setup was successful
To connect to this host run &#34;eval `docker-machine env &lt;vagrant_hostname&gt;`&#34;. To make this your default docker machine add the command or the output from &#34;docker-machine env &lt;vagrant_hostname&gt;&#34; to your ~/.bash_profile
</code></pre></div>
<h3 dir="auto"><a id="user-content-setting-up-your-hosts-file" aria-hidden="true" href="#setting-up-your-hosts-file"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setting up your hosts file</h3>
<p dir="auto">If you want to modify your host machine&#39;s hosts file (<code>/etc/hosts</code>), to add the docker machine hostname you can do so adding the line below:</p>
<div data-snippet-clipboard-copy-content="&lt;vagrant_ip&gt;  &lt;vagrant_hostname&gt;"><pre><code>&lt;vagrant_ip&gt;  &lt;vagrant_hostname&gt;
</code></pre></div>
<p dir="auto">eg.</p>
<div data-snippet-clipboard-copy-content="192.168.33.3  docker-debian-10"><pre><code>192.168.33.3  docker-debian-10
</code></pre></div>
<p dir="auto">(Where <code>docker-debian-10</code>) is the hostname you have configured in the <code>Vagrantfile</code>).</p>
<p dir="auto">If you&#39;d like additional assistance editing your hosts file, please read <a href="http://www.rackspace.com/knowledge_center/article/how-do-i-modify-my-hosts-file" rel="nofollow">How do I modify my hosts file?</a> from Rackspace.</p>
<h3 dir="auto"><a id="user-content-managing-your-docker-machine" aria-hidden="true" href="#managing-your-docker-machine"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Managing your docker-machine</h3>
<p dir="auto">The setup of your docker machine is handled during the build stage. If you need to update or re-do this in any way the following commands are helpful.</p>
<table>
<thead>
<tr>
<th>command</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>make build</code></td>
<td>build a the <code>docker-machine</code> vm and configure for use with docker</td>
</tr>
<tr>
<td><code>make destroy</code></td>
<td>this will destroy the vagrant box and clean up the <code>.vagrant</code> directory</td>
</tr>
<tr>
<td><code>make up</code></td>
<td>the same as <code>vagrant up</code>, you can use this to start the <code>docker-machine</code> vm if it has already been built and needs to be started again.</td>
</tr>
<tr>
<td><code>make down</code></td>
<td>the same as <code>vagrant halt</code>, you can use this to shutdown your <code>docker-machine</code> vm.</td>
</tr>
<tr>
<td><code>make docker-machine-add</code></td>
<td>add the vagrant box as a docker machine</td>
</tr>
<tr>
<td><code>make docker-machine-rm</code></td>
<td>remove the vagrant box as a docker machine</td>
</tr>
<tr>
<td><code>make docker-machine-check</code></td>
<td>check that the vagrant box is correctly setup as a docker machine</td>
</tr>
</tbody>
</table>
</article>
        </div></div>
  </body>
</html>
