<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/floodfx/liveviewjs">Original</a>
    <h1>Show HN: LiveViewJS ‚Äì TypeScript back end for LiveView Apps (Phoenix LiveView)</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><h2 dir="auto"><a id="user-content-liveviewjs" aria-hidden="true" href="#liveviewjs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>LiveViewJS</h2>
<h3 dir="auto"><a id="user-content-front-end-framework-for-back-end-developers" aria-hidden="true" href="#front-end-framework-for-back-end-developers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><em>Front-end framework for back-end developers</em></h3>
<h3 dir="auto"><a id="user-content-credit-" aria-hidden="true" href="#credit-"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Credit <g-emoji alias="raised_hands" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f64c.png">üôå</g-emoji></h3>
<p dir="auto">This is a backend implementation of <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html" rel="nofollow">Phoenix LiveView</a> in Typescript.  What the Phoenix folks have built is phenominal and I wanted to use that paradigm in Typescript and make it available to others.</p>
<h3 dir="auto"><a id="user-content-quick-overview-of-liveview-approach" aria-hidden="true" href="#quick-overview-of-liveview-approach"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Overview of LiveView Approach</h3>
<p dir="auto">How Phoenix desribes LiveView:</p>
<blockquote>
<p dir="auto">LiveView is an exciting new library which enables rich, real-time user experiences with server-rendered HTML. LiveView powered applications are stateful on the server with bidrectional communication via WebSockets, offering a vastly simplified programming model compared to JavaScript alternatives.</p>
</blockquote>
<p dir="auto">In other words, LiveView takes a very different approach than the popular SPA frameworks like React, Vuejs, and Svelt to building rich, highly interactive web applications.  Instead of sending down a bundle of javascript, LiveView apps render an HTML page on the first request and then connect via a persistent socket over which client events are sent and updated received.  These events may trigger a state update on the server and a re-calculation of what the page should look like.  Instead of reloading the page, the client receives a &#34;diff&#34; of the page via the socket and the page&#39;s DOM is updated.  (This <a href="https://online.pragmaticstudio.com/courses/liveview-pro/modules/4" rel="nofollow">video</a> by Pragmatic Studio does an amazing job of explaining how LiveView works.)</p>
<p dir="auto">The programming paradigm is extremely powerful and productive!</p>
<h3 dir="auto"><a id="user-content-feedback-is-a-" aria-hidden="true" href="#feedback-is-a-"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feedback is a <g-emoji alias="gift" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f381.png">üéÅ</g-emoji></h3>
<p dir="auto">I am not an expert on Phoenix Liveview, Elixir, Erlang VMs, etc or really most things.  Please feel free to open an issue with questios, bugs, etc.</p>
<h3 dir="auto"><a id="user-content-status---Œ≤" aria-hidden="true" href="#status---Œ≤"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Status - <strong>Œ≤</strong></h3>
<p dir="auto">LiveViewJS is in Œ≤eta. The project is still young but the code is stable, tested, and well-documented.</p>
<h3 dir="auto"><a id="user-content-implemented-phoenix-bindings" aria-hidden="true" href="#implemented-phoenix-bindings"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Implemented Phoenix Bindings</h3>
<p dir="auto">The bindings below marked with <g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji> are working and tested and most of them have example usage in the <code>examples</code> codebase.  Those with <code>?</code>, I have not gotten around to testing so not sure if they work. Those marked with <g-emoji alias="x" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png">‚ùå</g-emoji> are not yet implemented and known not to work.</p>
<p dir="auto">(See <a href="https://hexdocs.pm/phoenix_live_view/bindings.html" rel="nofollow">Phoenix Bindings Docs</a> for more details)</p>
<table>
<thead>
<tr>
<th>Binding</th>
<th>Attribute</th>
<th>Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td>Params</td>
<td><code>phx-value-*</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Click Events</td>
<td><code>phx-click</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Click Events</td>
<td><code>phx-click-away</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-change</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-submit</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-feedback-for</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-disable-with</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-trigger-action</code></td>
<td>Ôπñ</td>
</tr>
<tr>
<td>Form Events</td>
<td><code>phx-auto-recover</code></td>
<td>Ôπñ</td>
</tr>
<tr>
<td>Focus Events</td>
<td><code>phx-blur</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Focus Events</td>
<td><code>phx-focus</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Focus Events</td>
<td><code>phx-window-blur</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Focus Events</td>
<td><code>phx-window-focus</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Key Events</td>
<td><code>phx-keydown</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Key Events</td>
<td><code>phx-keyup</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Key Events</td>
<td><code>phx-window-keydown</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Key Events</td>
<td><code>phx-window-keyup</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Key Events</td>
<td><code>phx-key</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>DOM Patching</td>
<td><code>phx-update</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>DOM Patching</td>
<td><code>phx-remove</code></td>
<td>Ôπñ</td>
</tr>
<tr>
<td>JS Interop</td>
<td><code>phx-hook</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Rate Limiting</td>
<td><code>phx-debounce</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Rate Limiting</td>
<td><code>phx-throttle</code></td>
<td><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji></td>
</tr>
<tr>
<td>Static Tracking</td>
<td><code>phx-track-static</code></td>
<td><g-emoji alias="x" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png">‚ùå</g-emoji></td>
</tr>
</tbody>
</table>
<h4 dir="auto"><a id="user-content-liveviewjs-changesets" aria-hidden="true" href="#liveviewjs-changesets"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>LiveViewJS Changesets</h4>
<p dir="auto">Phoenix&#39;s Ecto ORM library and Phoenix LiveView rely on <a href="https://hexdocs.pm/ecto/Ecto.Changeset.html" rel="nofollow">Ecto Changesets</a> to allow filtering, validation, and other logic to be applied to the data.  Changesets are a powerful way to apply logic to data and are used in Phoenix&#39;s ORM and LiveView.  LiveViewJS uses Changesets to provide a similar API to Phoenix&#39;s though it is NOT a full-blown ORM.</p>
<p dir="auto">Detailed documentation on <a href="https://github.com/floodfx/liveviewjs/blob/main/docs/changesets.md">LiveViewJS Changesets</a>.</p>
<h3 dir="auto"><a id="user-content-usage---show-me-some-code-Ô∏è" aria-hidden="true" href="#usage---show-me-some-code-Ô∏è"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage - Show me some code! <g-emoji alias="keyboard" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2328.png">‚å®Ô∏è</g-emoji></h3>
<p dir="auto"><strong>Step 0</strong> Install LiveViewJS
<code>npm i liveviewjs</code></p>
<p dir="auto"><strong>Step 1</strong> Implement a <code>LiveViewComponent</code></p>
<div data-snippet-clipboard-copy-content="import { SessionData } from &#34;express-session&#34;;
import {html, BaseLiveViewComponent, LiveViewComponent, LiveViewExternalEventListener, LiveViewMountParams, LiveViewSocket } from &#34;liveviewjs&#34;;

// define your component&#39;s data shape
export interface LightContext {
  brightness: number;
}

// define the component events
export type LightEvent = &#34;on&#34; | &#34;off&#34; | &#34;up&#34; | &#34;down&#34;;

// implement your component
export class LightLiveViewComponent extends BaseLiveViewComponent&lt;LightContext, never&gt; implements
  LiveViewComponent&lt;LightContext, never&gt;,
  LiveViewExternalEventListener&lt;LightContext, LightEvent, never&gt; {

  // mount is called before html render on HTTP requests and
  // when the socket is connected on the phx-join event
  mount(params: LiveViewMountParams, session: Partial&lt;SessionData&gt;, socket: LiveViewSocket&lt;LightContext&gt;) {
    // set the default value(s) for the component data
    return { brightness: 10 };
  };

  // Define and render the HTML for your LiveViewComponent
  // This function is called after any context change and
  // only diffs are sent back to the page to re-render
  render(context: LightContext) {
    const { brightness } = context;
    return html`
    &lt;div id=&#34;light&#34;&gt;
      &lt;h1&gt;Front Porch Light &lt;/h1&gt;
      &lt;div class=&#34;meter&#34;&gt;
        &lt;div&gt;${brightness}%&lt;/div&gt;
        &lt;progress id=&#34;light_level&#34; value=&#34;${brightness}&#34; max=&#34;100&#34;&gt;
        &lt;/progress&gt;
      &lt;/div&gt;

      &lt;button phx-click=&#34;off&#34;&gt;
        Off
      &lt;/button&gt;

      &lt;button phx-click=&#34;down&#34;&gt;
        Down
      &lt;/button&gt;

      &lt;button phx-click=&#34;up&#34;&gt;
        Up
      &lt;/button&gt;

      &lt;button phx-click=&#34;on&#34;&gt;
        On
      &lt;/button&gt;
    &lt;/div&gt;
    `
  };

  // Handle events sent back from the client...  Events
  // may update the state (context) of the component and
  // cause a re-render
  handleEvent(event: LightEvent, params: never, socket: LiveViewSocket&lt;LightContext&gt;) {
    const ctx: LightContext = { brightness: socket.context.brightness };
    switch (event) {
      case &#39;off&#39;:
        ctx.brightness = 0;
        break;
      case &#39;on&#39;:
        ctx.brightness = 100;
        break;
      case &#39;up&#39;:
        ctx.brightness = Math.min(ctx.brightness + 10, 100);
        break;
      case &#39;down&#39;:
        ctx.brightness = Math.max(ctx.brightness - 10, 0);
        break;
    }
    return ctx;
  }

}"><pre><span>import</span> <span>{</span> <span>SessionData</span> <span>}</span> <span>from</span> <span>&#34;express-session&#34;</span><span>;</span>
<span>import</span> <span>{</span><span>html</span><span>,</span> <span>BaseLiveViewComponent</span><span>,</span> <span>LiveViewComponent</span><span>,</span> <span>LiveViewExternalEventListener</span><span>,</span> <span>LiveViewMountParams</span><span>,</span> <span>LiveViewSocket</span> <span>}</span> <span>from</span> <span>&#34;liveviewjs&#34;</span><span>;</span>

<span>// define your component&#39;s data shape</span>
<span>export</span> <span>interface</span> <span>LightContext</span> <span>{</span>
  <span>brightness</span>: <span>number</span><span>;</span>
<span>}</span>

<span>// define the component events</span>
<span>export</span> <span>type</span> <span>LightEvent</span> <span>=</span> <span>&#34;on&#34;</span> <span>|</span> <span>&#34;off&#34;</span> <span>|</span> <span>&#34;up&#34;</span> <span>|</span> <span>&#34;down&#34;</span><span>;</span>

<span>// implement your component</span>
<span>export</span> <span>class</span> <span>LightLiveViewComponent</span> <span>extends</span> <span>BaseLiveViewComponent</span><span>&lt;</span><span>LightContext</span><span>,</span> <span>never</span><span>&gt;</span> <span>implements</span>
  <span>LiveViewComponent</span><span>&lt;</span><span>LightContext</span><span>,</span> <span>never</span><span>&gt;</span><span>,</span>
  <span>LiveViewExternalEventListener</span><span>&lt;</span><span>LightContext</span><span>,</span> <span>LightEvent</span><span>,</span> <span>never</span><span>&gt;</span> <span>{</span>

  <span>// mount is called before html render on HTTP requests and</span>
  <span>// when the socket is connected on the phx-join event</span>
  <span>mount</span><span>(</span><span>params</span>: <span>LiveViewMountParams</span><span>,</span> <span>session</span>: <span>Partial</span><span>&lt;</span><span>SessionData</span><span>&gt;</span><span>,</span> <span>socket</span>: <span>LiveViewSocket</span><span>&lt;</span><span>LightContext</span><span>&gt;</span><span>)</span> <span>{</span>
    <span>// set the default value(s) for the component data</span>
    <span>return</span> <span>{</span> <span>brightness</span>: <span>10</span> <span>}</span><span>;</span>
  <span>}</span><span>;</span>

  <span>// Define and render the HTML for your LiveViewComponent</span>
  <span>// This function is called after any context change and</span>
  <span>// only diffs are sent back to the page to re-render</span>
  <span>render</span><span>(</span><span>context</span>: <span>LightContext</span><span>)</span> <span>{</span>
    <span>const</span> <span>{</span> brightness <span>}</span> <span>=</span> <span>context</span><span>;</span>
    <span>return</span> <span>html</span><span>`</span>
<span>    <span>&lt;</span><span>div</span> <span>id</span>=&#34;<span>light</span>&#34;<span>&gt;</span></span>
<span>      <span>&lt;</span><span>h1</span><span>&gt;</span>Front Porch Light <span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span>      <span>&lt;</span><span>div</span> <span>class</span>=&#34;<span>meter</span>&#34;<span>&gt;</span></span>
<span>        <span>&lt;</span><span>div</span><span>&gt;</span><span><span>${</span><span>brightness</span><span>}</span></span>%<span>&lt;/</span><span>div</span><span>&gt;</span></span>
<span>        <span>&lt;</span><span>progress</span> <span>id</span>=&#34;<span>light_level</span>&#34; <span>value</span>=&#34;<span><span>${</span><span>brightness</span><span>}</span></span>&#34; <span>max</span>=&#34;<span>100</span>&#34;<span>&gt;</span></span>
<span>        <span>&lt;/</span><span>progress</span><span>&gt;</span></span>
<span>      <span>&lt;/</span><span>div</span><span>&gt;</span></span>
<span></span>
<span>      <span>&lt;</span><span>button</span> <span>phx-click</span>=&#34;<span>off</span>&#34;<span>&gt;</span></span>
<span>        Off</span>
<span>      <span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span></span>
<span>      <span>&lt;</span><span>button</span> <span>phx-click</span>=&#34;<span>down</span>&#34;<span>&gt;</span></span>
<span>        Down</span>
<span>      <span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span></span>
<span>      <span>&lt;</span><span>button</span> <span>phx-click</span>=&#34;<span>up</span>&#34;<span>&gt;</span></span>
<span>        Up</span>
<span>      <span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span></span>
<span>      <span>&lt;</span><span>button</span> <span>phx-click</span>=&#34;<span>on</span>&#34;<span>&gt;</span></span>
<span>        On</span>
<span>      <span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span>    <span>&lt;/</span><span>div</span><span>&gt;</span></span>
<span>    `</span>
  <span>}</span><span>;</span>

  <span>// Handle events sent back from the client...  Events</span>
  <span>// may update the state (context) of the component and</span>
  <span>// cause a re-render</span>
  <span>handleEvent</span><span>(</span><span>event</span>: <span>LightEvent</span><span>,</span> <span>params</span>: <span>never</span><span>,</span> <span>socket</span>: <span>LiveViewSocket</span><span>&lt;</span><span>LightContext</span><span>&gt;</span><span>)</span> <span>{</span>
    <span>const</span> <span>ctx</span>: <span>LightContext</span> <span>=</span> <span>{</span> <span>brightness</span>: <span>socket</span><span>.</span><span>context</span><span>.</span><span>brightness</span> <span>}</span><span>;</span>
    <span>switch</span> <span>(</span><span>event</span><span>)</span> <span>{</span>
      <span>case</span> <span>&#39;off&#39;</span>:
        <span>ctx</span><span>.</span><span>brightness</span> <span>=</span> <span>0</span><span>;</span>
        <span>break</span><span>;</span>
      <span>case</span> <span>&#39;on&#39;</span>:
        <span>ctx</span><span>.</span><span>brightness</span> <span>=</span> <span>100</span><span>;</span>
        <span>break</span><span>;</span>
      <span>case</span> <span>&#39;up&#39;</span>:
        <span>ctx</span><span>.</span><span>brightness</span> <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(</span><span>ctx</span><span>.</span><span>brightness</span> <span>+</span> <span>10</span><span>,</span> <span>100</span><span>)</span><span>;</span>
        <span>break</span><span>;</span>
      <span>case</span> <span>&#39;down&#39;</span>:
        <span>ctx</span><span>.</span><span>brightness</span> <span>=</span> <span>Math</span><span>.</span><span>max</span><span>(</span><span>ctx</span><span>.</span><span>brightness</span> <span>-</span> <span>10</span><span>,</span> <span>0</span><span>)</span><span>;</span>
        <span>break</span><span>;</span>
    <span>}</span>
    <span>return</span> <span>ctx</span><span>;</span>
  <span>}</span>

<span>}</span></pre></div>
<p dir="auto"><strong>Step 2</strong> - Register your <code>LiveViewComponent</code>s and start the HTTP and Socket server with <code>LiveViewServer</code></p>
<div data-snippet-clipboard-copy-content="// import package
import {LiveViewServer} from &#34;liveviewjs&#34;;

// create new LiveViewServer
const lvServer = new LiveViewServer();

// define your routes by mapping paths to LiveViewComponents
const lvRouter: LiveViewRouter = {
  &#34;/light&#34;: new LightLiveViewComponent();
}
// AND then passing the router to the server
lvServer.registerLiveViewRoutes(lvRouter);

// OR register your route with the server directly
lvServer.registerLiveViewRoute(&#34;/light&#34;, new LightLiveViewComponent());

// then start the server
lvServer.start();"><pre><span>// import package</span>
<span>import</span> <span>{</span><span>LiveViewServer</span><span>}</span> <span>from</span> <span>&#34;liveviewjs&#34;</span><span>;</span>

<span>// create new LiveViewServer</span>
<span>const</span> <span>lvServer</span> <span>=</span> <span>new</span> <span>LiveViewServer</span><span>(</span><span>)</span><span>;</span>

<span>// define your routes by mapping paths to LiveViewComponents</span>
<span>const</span> <span>lvRouter</span>: <span>LiveViewRouter</span> <span>=</span> <span>{</span>
  <span>&#34;/light&#34;</span>: <span>new</span> <span>LightLiveViewComponent</span><span>(</span><span>)</span><span>;</span>
<span>}</span>
<span>// AND then passing the router to the server</span>
<span>lvServer</span><span>.</span><span>registerLiveViewRoutes</span><span>(</span><span>lvRouter</span><span>)</span><span>;</span>

<span>// OR register your route with the server directly</span>
<span>lvServer</span><span>.</span><span>registerLiveViewRoute</span><span>(</span><span>&#34;/light&#34;</span><span>,</span> <span>new</span> <span>LightLiveViewComponent</span><span>(</span><span>)</span><span>)</span><span>;</span>

<span>// then start the server</span>
<span>lvServer</span><span>.</span><span>start</span><span>(</span><span>)</span><span>;</span></pre></div>
<h4 dir="auto"><a id="user-content-other-features-to-be-implemented" aria-hidden="true" href="#other-features-to-be-implemented"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Other features to be implemented:</h4>
<ul dir="auto">
<li><a href="https://hexdocs.pm/phoenix_live_view/live-layouts.html#updating-the-html-document-title" rel="nofollow">Updating HTML Document Title</a> - Vote for <a href="https://github.com/floodfx/liveviewjs/issues/16">Issue 16</a></li>
<li><a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.Helpers.html" rel="nofollow">LiveView Helpers</a> - Vote for <a href="https://github.com/floodfx/liveviewjs/issues/17">Issue 17</a></li>
<li><a href="https://hexdocs.pm/phoenix_live_view/dom-patching.html#temporary-assigns" rel="nofollow">Temporary Assigns</a> - Vote for <a href="https://github.com/floodfx/liveviewjs/issues/18">Issue 18</a></li>
<li><a href="https://hexdocs.pm/phoenix_live_view/0.17.6/Phoenix.LiveView.html#put_flash/3" rel="nofollow">Build in Flash Message Support</a> - Vote for <a href="https://github.com/floodfx/liveviewjs/issues/19">Issue 19</a></li>
<li><a href="https://hexdocs.pm/phoenix_live_view/uploads.html" rel="nofollow">File Uploads</a> - Vote for <a href="https://github.com/floodfx/liveviewjs/issues/20">Issue 20</a></li>
</ul>
<h3 dir="auto"><a id="user-content-npm-commands" aria-hidden="true" href="#npm-commands"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NPM Commands</h3>
<p dir="auto"><code>npm i</code> - install the deps</p>
<p dir="auto"><code>npm run build</code> - builds the framework, client, and examples (server)</p>
<p dir="auto"><code>npm run watch</code> - continually rebuilds the codebase when files are updated</p>
<p dir="auto"><code>npm run examples</code> - runs the examples [See <code>src/examples</code>]</p>
<p dir="auto"><code>npm run test</code> - runs the (few) tests</p>
<h3 dir="auto"><a id="user-content-run-and-browse-examples" aria-hidden="true" href="#run-and-browse-examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Run and Browse Examples</h3>
<p dir="auto"><strong>Credit</strong>: These examples are adapted from an amazing <a href="https://online.pragmaticstudio.com/courses/liveview-starter/steps/15" rel="nofollow">Phoenix Video / Code Course</a> authored by the folks at <a href="https://pragmaticstudio.com/" rel="nofollow">Pragmatic Studio</a>.</p>
<p dir="auto">Navigate to <code>src/examples</code> to see the example code.</p>
<p dir="auto">Run <code>npm run examples</code> then point your browser to:</p>
<ul dir="auto">
<li><code>http://localhost:4444/</code> - Shows the index of all the examples</li>
</ul>
<p dir="auto">There is also a standalone <a href="https://github.com/floodfx/todomvc-liveviewjs">TodoMVC</a> example application written in LiveViewJS.</p>
<h3 dir="auto"><a id="user-content-more-details-on-the-approach-to-building-liveviewjs-" aria-hidden="true" href="#more-details-on-the-approach-to-building-liveviewjs-"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>More Details on the Approach to Building LiveViewJS <g-emoji alias="triangular_ruler" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4d0.png">üìê</g-emoji></h3>
<ul dir="auto">
<li>
<p dir="auto"><strong>Reuse Phoenix Client Libraries and app.js code</strong> - The Phoenix team has done a ton of heavy lifting on the client that we can just use.  We also benefit from fixes and improvements in the future.  [See <code>src/client/liveview.ts</code> for client code.]</p>
</li>
<li>
<p dir="auto"><strong>Reuse Phoenix socket message protocol</strong> - The Phoenix team already figured out a great protocol to send events to/from the server.  We just implemented a different backend.</p>
</li>
<li>
<p dir="auto"><strong>Follow component API design (i.e. <code>mount</code>, <code>render</code> etc), reimplemented with Typescript (so even more type-safe)</strong> - Components in LiveViewJS follow the <code>mount</code>, <code>render</code>, <code>handleEvent</code>, and <code>handleInfo</code> API defined in Phoenix. Again, no need to invent a new API.</p>
</li>
</ul>
<h3 dir="auto"><a id="user-content-gratitude-" aria-hidden="true" href="#gratitude-"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Gratitude <g-emoji alias="pray" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f64f.png">üôè</g-emoji></h3>
<p dir="auto">Thanks to <a href="https://github.com/ogrodnek">@ogrodnek</a> for the early support, feedback, and the idea to reuse the Phoenix client code instead of reinventing!</p>
<p dir="auto">Thanks to <a href="https://github.com/blimmer/">@blimmer</a> for the awesome feedback, documentation suggests, and support!</p>
</article>
        </div></div>
  </body>
</html>
