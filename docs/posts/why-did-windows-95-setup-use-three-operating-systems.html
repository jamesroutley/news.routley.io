<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://devblogs.microsoft.com/oldnewthing/20241112-00/?p=110507">Original</a>
    <h1>Why did Windows 95 setup use three operating systems?</h1>
    
    <div id="readability-page-1" class="page"><div id="single-wrapper">
    
    <article data-clarity-region="article" id="post-110507">
        <div data-bi-area="body_article" data-bi-id="post_page_body_article">
            <p>Twitter users @tthirtle asked why Windows 95 setup goes through three operating systems: MS-DOS, Windows 3.1, and then Windows 95. Why not go from MS-DOS straight to Windows 95?</p>
<blockquote data-conversation="none">
<p dir="ltr" lang="en">Here’s another good question. Why does Windows 95 setup use 3 different UI’s. DOS,Win3.x,and Win9x?</p>
<p>— Thomas (@tthirtle) <a href="https://twitter.com/tthirtle/status/1809777917565767993?ref_src=twsrc%5Etfw">July 7, 2024</a></p></blockquote>

<p>Windows 95 setup could upgrade from three starting points: MS-DOS, Windows 3.1, or Windows 95. (Yes, you could upgrade Windows 95 to Windows 95. You might do this to repair a corrupted system while preserving data.)</p>
<p>One option is to write three versions of Windows 95 setup: One for setting up from MS-DOS, another for setting up from Windows 3.1, and a third for setting up from Windows 95.</p>
<p>This was not a pleasant option because you basically did the same work three times, but implemented separately, so you have to do three times the coding.</p>
<p>A better option is to just write one version of Windows 95 setup and use it for all three starting points. So now you get to choose the platform on which to base your code.</p>
<table>
<tbody>
<tr>
<th rowspan="2">From</th>
<th colspan="3">App type</th>
</tr>
<tr>
<th>MS-DOS</th>
<th>16-bit GUI</th>
<th>32-bit GUI</th>
</tr>
<tr>
<td>MS-DOS</td>
<td>•</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td>Windows 3.1</td>
<td>•</td>
<td>•</td>
<td> </td>
</tr>
<tr>
<td>Windows 95</td>
<td>•</td>
<td>•</td>
<td>•</td>
</tr>
</tbody>
</table>
<p>If you write Windows 95 setup as an MS-DOS app, then it runs on all three platforms. That’s great! You need to write only one setup program. The downside is that it’s going to be a text-mode setup program, which looks ugly and gives a poor initial impression of what is supposed to be a brand new GUI world.</p>
<p>At the other extreme, you can write Windows 95 setup as a 32-bit GUI program, but that means that if the user is starting from MS-DOS or Windows 3.1, you have to install Windows 95 before you can run Windows 95 setup, which is a bit of a catch-22.</p>
<p>In the middle is the happy medium: You can have the MS-DOS setup program install a minimal version of Windows 3.1, just barely enough to support what the 16-bit GUI setup program needs.¹ This tiny version is small enough to be copied and installed off a small number of floppy disks. Once that’s done, boot into the tiny version of Windows 3.1 and run the 16-bit GUI setup program.</p>
<p>Okay, so now we have three setup programs. The first one is used if you’re installing from MS-DOS: It installs the tiny version of Windows 3.1, and then boots into Windows 3.1 to continue to the next step.</p>
<p>The second setup program runs as a 16-bit Windows app, either in the miniature copy of Windows 3.1 (if the user is upgrading from MS-DOS), the real copy of Windows 3.1 (if the user is upgrading from Windows 3.1), or the real copy of Windows 95 (if the user is upgrading from Windows 95). This second setup program is the one that does almost all of the real work: It does the initial interaction with the user to gather information about how to install Windows 95, like asking which optional components to include, and does hardware detection to decide which drivers to install.² And then it copies the drivers and Windows 95 files onto the system, migrates your old settings to the new operating system, and boots into Windows 95.</p>
<p>The third setup program runs as a 32-bit Windows app. It is running in the real Windows 95 system and does some final steps that require operation a live running system, like installing printers.</p>
<table>
<tbody>
<tr>
<td>Starting from MS-DOS →</td>
<td>Install mini Windows 3.1</td>
<td> </td>
<td> </td>
<td>MS-DOS app</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Boot into mini-Windows 3.1</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td>Starting from Windows 3.1 →</td>
<td>Gather information</td>
<td rowspan="7"> </td>
<td rowspan="7"> </td>
<td rowspan="7">16-bit Windows app</td>
</tr>
<tr>
<td>or Windows 95</td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Detect hardware</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Copy drivers and</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Migrate settings and configure drivers</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Boot into Windows 95</td>
</tr>
<tr>
<td> </td>
<td>↓</td>
</tr>
<tr>
<td> </td>
<td>Final setup</td>
<td> </td>
<td> </td>
<td>Windows 95 app</td>
</tr>
</tbody>
</table>
<p>So that’s why Windows 95 setup is really three setup programs chained together. It allows a single copy of the code to be used for all three of the installation scenarios. Each program takes you one step closer to the goal. And everything got implemented only once.</p>
<p>¹ There was existing precedent for a tiny version of Windows that is barely enough to run a single program. The original Windows version of Microsoft Excel <a href="https://en.wikipedia.org/w/index.php?title=Microsoft_Excel&amp;oldid=166461028"> came with a runtime version of Windows 2.1</a>, so that customers who didn’t have Windows could still use Excel.</p>
<p>² This hardware detection code that Setup uses is the same code that runs when you do hardware detection from within Windows 95 itself, so even that code needed to be written only once. It did have some runtime checks to change behavior slightly depending on whether it’s running in Windows 3.1 or Windows 95, but the vast majority of the code is identical.</p>
        </div><!-- .entry-content -->

        <!-- AI Disclaimer -->
            </article>
    
</div></div>
  </body>
</html>
