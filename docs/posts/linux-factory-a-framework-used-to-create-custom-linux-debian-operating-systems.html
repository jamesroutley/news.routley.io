<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/clayrisser/linux-factory">Original</a>
    <h1>Linux-factory: A framework used to create custom Linux Debian operating systems</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<blockquote>
<p dir="auto">a framework used to create custom linux debian operating systems</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/clayrisser/linux-factory/blob/main/assets/linux-factory.jpeg"><img src="https://github.com/clayrisser/linux-factory/raw/main/assets/linux-factory.jpeg" alt=""/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<p dir="auto">Make configurations in the <code>os/config.yaml</code>, activate custom overlays and when ready . . .</p>

<h2 tabindex="-1" dir="auto"><a id="user-content-tools" aria-hidden="true" href="#tools"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tools</h2>
<p dir="auto"><code>grub-emu</code> - used to test grub without rebooting</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-dependencies" aria-hidden="true" href="#dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Dependencies</h2>
<p dir="auto">This system can only be built from a Debian based operating system. While
any Debian based operating system should work, this is only tested against
the official Debian distribution on amd64.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Install</th>
<th>Url</th>
</tr>
</thead>
<tbody>
<tr>
<td>GNU Make</td>
<td><code>sudo apt-get install -y make</code></td>
<td><a href="https://www.gnu.org/software/make" rel="nofollow">https://www.gnu.org/software/make</a></td>
</tr>
<tr>
<td>Live Build</td>
<td><code>sudo apt-get install -y live-build</code></td>
<td><a href="https://live-team.pages.debian.net/live-manual/html/live-manual/index.en.html" rel="nofollow">https://live-team.pages.debian.net/live-manual/html/live-manual/index.en.html</a></td>
</tr>
<tr>
<td>Python 3</td>
<td><code>sudo apt-get install -y python3</code></td>
<td><a href="https://www.python.org" rel="nofollow">https://www.python.org</a></td>
</tr>
<tr>
<td>jq</td>
<td><code>sudo apt-get install -y jq</code></td>
<td><a href="https://stedolan.github.io/jq" rel="nofollow">https://stedolan.github.io/jq</a></td>
</tr>
<tr>
<td>poetry</td>
<td><code>sudo apt-get install -y python3-poetry-core</code></td>
<td><a href="https://python-poetry.org" rel="nofollow">https://python-poetry.org</a></td>
</tr>
<tr>
<td>virtualenv</td>
<td><code>sudo apt-get install -y python3-virtualenv</code></td>
<td><a href="https://virtualenv.pypa.io" rel="nofollow">https://virtualenv.pypa.io</a></td>
</tr>
<tr>
<td>yq</td>
<td><code>sudo apt-get install -y snap &amp;&amp; sudo snap install yq</code></td>
<td><a href="https://mikefarah.gitbook.io/yq" rel="nofollow">https://mikefarah.gitbook.io/yq</a></td>
</tr>
</tbody>
</table>
<p dir="auto">You can install all of the dependencies with the following command.</p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo apt-get install -y make live-build python3 jq python3-poetry-core python3-virtualenv snap &amp;&amp; sudo snap install yq"><pre>sudo apt-get install -y make live-build python3 jq python3-poetry-core python3-virtualenv snap <span>&amp;&amp;</span> sudo snap install yq</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-overlays" aria-hidden="true" href="#overlays"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overlays</h2>
<p dir="auto">Overlays are configurable, flexible and decoupled customizations that get applied to the operating system build. They
can be mixed and matched with other overlays, or be completely disabled if you don&#39;t want those changes.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-debian-installer" aria-hidden="true" href="#debian-installer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Debian Installer</h3>
<p dir="auto">The Debian Installer is the official installation system for the Debian operating system.
It provides a user-friendly interface for installing Debian on a wide range of hardware,
from desktops and laptops to servers and embedded systems. The Debian Installer supports
multiple languages, network installations, and a variety of disk partitioning options. With
its flexible and customizable design, the Debian Installer is a popular choice for many
users who are looking to install Debian on their systems.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-grub" aria-hidden="true" href="#grub"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Grub</h3>
<p dir="auto">GRUB (GRand Unified Bootloader) is a boot loader package from the GNU Project. It is used to
boot Linux operating systems, as well as a number of other operating systems. In the context
of this system, Grub can be used as an overlay to customize the boot loader.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-calamares" aria-hidden="true" href="#calamares"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Calamares</h3>
<p dir="auto">Calamares is a distribution-independent system installer, which aims
to be easy, useful and fast. In the context of this system, Calamares
can be used as an overlay to provide a graphical installer for the target system.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-sway" aria-hidden="true" href="#sway"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sway</h3>
<p dir="auto">Sway is a tiling window manager for Wayland. It provides a tiling window manager
experience for users who are looking for a modern, keyboard-driven interface. In the
context of this system, Sway can be used as an overlay to provide a tiling
window manager for the target system.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-overlay-components" aria-hidden="true" href="#overlay-components"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overlay Components</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-fonts" aria-hidden="true" href="#fonts"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fonts</h3>
<p dir="auto">Supports <code>zip</code>, <code>tar</code> and <code>tar.gz</code> files that contain <code>.ttf</code> or <code>.otf</code> fonts</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-packages" aria-hidden="true" href="#packages"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Packages</h3>
<h3 tabindex="-1" dir="auto"><a id="user-content-repos" aria-hidden="true" href="#repos"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Repos</h3>
<h3 tabindex="-1" dir="auto"><a id="user-content-filesystem" aria-hidden="true" href="#filesystem"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Filesystem</h3>
<h3 tabindex="-1" dir="auto"><a id="user-content-prompt" aria-hidden="true" href="#prompt"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Prompt</h3>
<h4 tabindex="-1" dir="auto"><a id="user-content-types" aria-hidden="true" href="#types"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Types</h4>
<ul dir="auto">
<li><code>string</code></li>
<li><code>boolean</code></li>
<li><code>select</code></li>
<li><code>multiselect</code></li>
<li><code>error</code></li>
<li><code>note</code></li>
<li><code>password</code></li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-hooks" aria-hidden="true" href="#hooks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Hooks</h3>
<p dir="auto">To use the hooks in your overlay, you will need to create a file named overlay.py within your overlay directory. This file should contain a class named OverlayHooks that implements methods for each hook.</p>
<p dir="auto">Each hook has two corresponding methods, one for before the stage is executed and one for after the stage is executed. There are currently three stages in the process: build, config, and prepare. This means the following hooks are available for you to use:</p>
<ul dir="auto">
<li><code>before_build()</code></li>
<li><code>after_build()</code></li>
<li><code>before_config()</code></li>
<li><code>after_config()</code></li>
<li><code>before_prepare()</code></li>
<li><code>after_prepare()</code></li>
</ul>
<p dir="auto">For example, if you wanted to run some custom code before the build stage is executed, you could implement the following in your overlay.py file:</p>
<p dir="auto"><em>overlay.py</em></p>
<div dir="auto" data-snippet-clipboard-copy-content="class OverlayHooks:
    def before_build(self):
        # Your custom code here"><pre><span>class</span> <span>OverlayHooks</span>:
    <span>def</span> <span>before_build</span>(<span>self</span>):
        <span># Your custom code here</span></pre></div>
<p dir="auto">It&#39;s important to note that the order in which hooks are executed is determined by the order in which the overlays are specified. Make sure to take this into consideration when implementing your hooks.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-script-hooks" aria-hidden="true" href="#script-hooks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Script Hooks</h3>
<blockquote>
<p dir="auto">Script hooks are a linux-factory concept and should not be confused with the live build hooks available at <code>lb/hooks/</code>.</p>
</blockquote>
<p dir="auto">During the installation process, there are two script hooks that can be utilized, <code>post-install</code> and <code>user-post-install</code>.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-location-of-script-hooks" aria-hidden="true" href="#location-of-script-hooks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Location of Script Hooks</h4>
<p dir="auto">Script hooks should be placed in the <code>hooks/&lt;hook&gt;</code> folder. All scripts within the specified
folder will be executed during the corresponding hook.</p>
<blockquote>
<p dir="auto">the name of the script should be the same name as your overlay to prevent collisions with hooks from other overlays</p>
</blockquote>
<h4 tabindex="-1" dir="auto"><a id="user-content-execution-of-script-hooks" aria-hidden="true" href="#execution-of-script-hooks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Execution of Script Hooks</h4>
<ul dir="auto">
<li><code>user-post-install</code>: This script hook will execute after the system has been installed as the newly created user.</li>
<li><code>post-install</code>: This script hook will also execute after the system has been installed, but it runs as the root user.</li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-example" aria-hidden="true" href="#example"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example</h4>
<p dir="auto">Here&#39;s an example of how you can utilize the user-post-install script hook.</p>
<p dir="auto">Create a folder named user-post-install in the hooks directory and add a file named script.sh in it. In the script.sh file, you can add the following code.</p>
<p dir="auto"><em>hooks/user-post-install/&lt;overlay&gt;.sh</em></p>
<div dir="auto" data-snippet-clipboard-copy-content="#!/bin/sh

echo &#34;Running user-post-install script&#34;"><pre><span><span>#!</span>/bin/sh</span>

<span>echo</span> <span><span>&#34;</span>Running user-post-install script<span>&#34;</span></span></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-live-build-cheatsheet" aria-hidden="true" href="#live-build-cheatsheet"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Live Build Cheatsheet</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-definitions" aria-hidden="true" href="#definitions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Definitions</h3>
<ul dir="auto">
<li><strong>live medium</strong> - the ISO image and filesystem</li>
<li><strong>live system</strong> - the operating system booted from the live medium</li>
<li><strong>installed system</strong> - the operating system installed from debian installer</li>
<li><strong>chroot stage</strong> - stage when building the image</li>
<li><strong>binary stage</strong> - stage when building the live medium (binary can also refer to the debian installer)</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-file-structure" aria-hidden="true" href="#file-structure"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>File Structure</h3>
<ul dir="auto">
<li><code>config/archives/*.{list,key}.binary</code> - repositories added to <em>live system</em> <code>/etc/apt/sources.list.d/</code></li>
<li><code>config/archives/*.{list,key}.chroot</code> - repositories loaded during the <em>chroot stage</em></li>
<li><code>config/includes.binary/*</code> - files to include in the <em>live medium&#39;s</em> filesystem</li>
<li><code>config/includes.chroot/*</code> - files to include in the <em>live system&#39;s</em> filesystem</li>
<li><code>config/includes.installer/*</code> - configuration for debian installer</li>
<li><code>config/package-lists/*.list.binary</code> - packages to place in the APT <code>pool/</code> repository on the <em>live medium</em> (for offline packages)</li>
<li><code>config/package-lists/*.list.chroot_install</code> - packages to install in the <em>live system</em> and <em>installed system</em></li>
<li><code>config/package-lists/*.list.chroot_live</code> - packages to install in the <em>live system</em> only (works by uninstalling them from <em>installed system</em>)</li>
<li><code>config/package-lists/*.list.chroot</code> - packages to install in the <em>live system</em> (which will most likely be added to the <em>installed system</em>)</li>
<li><code>config/packages.binary</code> - udeb packages to install for the debian installer</li>
<li><code>config/packages.chroot</code> - deb packages to install for the live system</li>
</ul>
<p dir="auto"><em>I&#39;m not sure exactly what the differences between <code>config/package-lists/*.list.chroot</code> and
<code>config/package-lists/*.list.chroot_install</code> are.</em></p>
<blockquote>
<p dir="auto">WARNING: <em>binary</em> unfortunately has many different meanings in the documentation depending on the context. The following table helps clarify the context of binary.</p>
</blockquote>
<table>
<thead>
<tr>
<th>binary</th>
<th>refers to</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>config/archives/*.{list,key}.binary</code></td>
<td><em>live system</em></td>
</tr>
<tr>
<td><code>config/includes.binary/*</code></td>
<td><em>live medium</em></td>
</tr>
<tr>
<td><code>config/package-lists/*.list.binary</code></td>
<td><em>live medium</em> <code>/pool</code></td>
</tr>
<tr>
<td><code>config/packages.binary</code></td>
<td><em>debian installer</em></td>
</tr>
</tbody>
</table>
<blockquote>
<p dir="auto">WARNING: <code>config/archives/*.{list,key}.chroot</code> does not make the repositories available to the <em>live system</em>. Instead you must use <code>config/archives/*.{list,key}.binary</code> for the repositories to be available to the <em>live system</em>.</p>
</blockquote>
<h3 tabindex="-1" dir="auto"><a id="user-content-mounts" aria-hidden="true" href="#mounts"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Mounts</h3>
<ul dir="auto">
<li><strong>live medium</strong> - <code>/cdrom</code> if debian installer or <code>/run/live/medium</code> from live system</li>
<li><strong>installed system</strong> - <code>/target</code> if debian installer or <code>/tmp/calamares-root-*</code> if calamares</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-resources" aria-hidden="true" href="#resources"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Resources</h2>
<ul dir="auto">
<li><a href="https://bugs.launchpad.net/subiquity/+bug/1960068" rel="nofollow">https://bugs.launchpad.net/subiquity/+bug/1960068</a></li>
<li><a href="https://debian-live-config.readthedocs.io/en/latest/custom.html" rel="nofollow">https://debian-live-config.readthedocs.io/en/latest/custom.html</a></li>
<li><a href="https://discourse.ubuntu.com/t/automated-server-install-reference/16613/21" rel="nofollow">https://discourse.ubuntu.com/t/automated-server-install-reference/16613/21</a></li>
<li><a href="https://github.com/elementary/os/wiki/Building-ISO-Images">https://github.com/elementary/os/wiki/Building-ISO-Images</a></li>
<li><a href="https://help.ubuntu.com/community/InstallCDCustomization" rel="nofollow">https://help.ubuntu.com/community/InstallCDCustomization</a></li>
<li><a href="https://live-team.pages.debian.net/live-manual/html/live-manual/index.en.html" rel="nofollow">https://live-team.pages.debian.net/live-manual/html/live-manual/index.en.html</a></li>
<li><a href="https://manpages.debian.org/unstable/live-build/lb_config.1.en.html" rel="nofollow">https://manpages.debian.org/unstable/live-build/lb_config.1.en.html</a></li>
</ul>
</article>
          </div></div>
  </body>
</html>
