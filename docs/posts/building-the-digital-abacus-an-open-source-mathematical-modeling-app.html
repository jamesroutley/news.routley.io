<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://humanprogramming.substack.com/p/building-the-digital-abacus-an-open">Original</a>
    <h1>Building the Digital Abacus, an Open-Source Mathematical Modeling App</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><div class=""><div><div dir="auto"><p><em>Editor’s note: the scope of this blog is expanding. Going forward, some posts will discuss human-programming tools, and others will cover my adventures as a programmer who is a human (so you see, the name ‘Human Programming’ is backwards compatible). This series is the first in the latter category. I write with the same audience in mind — people interested in human-computer interaction, web tools, programming interfaces, and personal development. With that said, I’m confident you’ll enjoy this series exploring the inner workings of an experimental math tool: the Digital Abacus.</em></p><p>In February of 2023,  I was holed up in San Bruno, CA, deep in development of a flowchart-powered developer tool called InstructionKit.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png" width="520" height="325" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:910,&#34;width&#34;:1456,&#34;resizeWidth&#34;:520,&#34;bytes&#34;:null,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:null,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;topImage&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F00a0943f-842c-46ce-83b6-51839a374936_2880x1800.png 1456w" sizes="100vw" fetchpriority="high"/></picture></div></a><figcaption>InstructionKit’s interactive-guide editor</figcaption></figure></div><p><span>My cofounder Chris and I were looking to bootstrap, so we needed side gigs. Chris was already working part-time with Hack Club to produce his amazing game SineRider (</span><a href="https://sinerider.com/" rel="nofollow ugc noopener">check it out</a><span>), and would soon connect me with Paul Dancstep, who was looking for help with his project called the Digital Abacus.</span></p><p>As Paul explained, he and a team of mathematicians were building a tool for solving math problems, to be used by students and professionals alike. Something that would look like this:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png" width="1456" height="713" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:713,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:1001348,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1456w" sizes="100vw"/></picture></div></a><figcaption>An actual screenshot of the current Digital Abacus Tool, showing the equation e^(i*pi) = -1</figcaption></figure></div><p><span>There would be two interfaces: on the left, a flowchart with nodes and edges representing operators and constraints, and on the right, a plot showing the live-updating real and imaginary coordinates of every input-, intermediate-, and output-value in the system. The user could directly drag and manipulate values from either view, so they could construct </span><em>reusable interactive tools</em><span> to help them model real-world systems (see </span><a href="https://www.youtube.com/watch?v=nURYv1r_AKM" rel="nofollow ugc noopener">this lecture for some conceptual background</a><span>).</span></p><p><span>This project sounded like a perfect match for me given my experience building InstructionKit, so I joined and spent a fantastic three months working with the team to produce the version shown above (</span><a href="https://digital-abacus.vercel.app/" rel="nofollow ugc noopener">here is a demo</a><span> and </span><a href="https://github.com/dnsosebee/digital-abacus/tree/main" rel="nofollow ugc noopener">here is the source code)</a><span>.</span></p><p>I enjoyed this project so much that figured I should write about the tool’s unique technical design and the decisions that went into it. Eventually I decided to split things into a multi-part series, with the following sections:</p><ul><li><p><strong>&gt; Pt. 1: the design of the automatic, recursive constraint solver</strong></p></li><li><p>   Pt. 2: state management, reactivity and persistence</p></li><li><p>   Pt. 3: UI design, numeric inputs and focus states</p></li></ul><p>And you’re coming up on part one. Enjoy!</p><p>Note: we refer to an arrangement of nodes and wires as a ‘construction’.</p><p>First I’ll describe the experience of building and interacting with a construction using the Digital Abacus Tool, then I’ll talk about the underlying state representation of a construction, and finally how the tool solves for dependent values.</p><p><span>Say we want to model and explore </span><a href="https://en.wikipedia.org/wiki/Euler%27s_identity" rel="nofollow ugc noopener">Euler’s identity</a><span> using our tool:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png" width="120" height="51.42857142857143" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:144,&#34;width&#34;:336,&#34;resizeWidth&#34;:120,&#34;bytes&#34;:13396,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F318ca9ca-366b-48fb-b2f1-aa0b85da4036_336x144.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>Euler’s identity, e^(i * pi) = -1</figcaption></figure></div><p><span>To do so, we drag the constants, </span><em>e</em><span>, </span><em>pi</em><span>, and </span><em>i</em><span> into the flowchart workspace. We connect </span><em>pi</em><span> and </span><em>i </em><span>to the input terminals of a </span><em>Multiplier</em><span> to yield the product </span><em>i * pi</em><span>. Finally we connect </span><em>e</em><span> and </span><em>i * pi</em><span> to the input terminals of an </span><em>Exponentiator</em><span> to yield the result, -1. Like so:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png" width="1456" height="713" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:713,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:null,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:null,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0cc8fedf-8962-4466-b1b5-5e6e2ae46263_3352x1642.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>The flowchart on the left represents the equation e^(pi*i) = -1</figcaption></figure></div><p><span>Merely </span><em>solving </em><span>e^(i*pi) is not all that interesting; Google does a good enough job at that. What makes our tool here special is that we can </span><em>see</em><span> our values interacting in the complex plane. And, more importantly, </span><strong>we can drag our input values around, watching dependent values update instantly and continuously</strong><span>. By playing with the system, the user can understand the mechanics underlying the equation. Instead of being a single-shot calculation, our equation has become an </span><a href="https://explorabl.es/" rel="nofollow ugc noopener">explorable explanation</a><span>.</span></p><p>We can even reverse dependencies in the construction to make the output a free variable and solve for one of the inputs, all with a couple of clicks (more on this soon).</p><p>So how does this work under the hood? First, we need to store all of the values and constraints within the construction.</p><p><span>We do so in a graph data structure (</span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/coords/coordGraph.ts#L26" rel="nofollow ugc noopener">called the RelGraph in the code</a><span>). The RelGraph (short for relation-graph) is the single source of truth for all information about a particular model, including the </span><em>shape</em><span> of a model (what components it has in the flowchart) as well as the </span><em>state of values </em><span>within a model.</span></p><p><span>The RelGraph contains Vertices and Edges. A </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/graph/vertex.ts#L26" rel="nofollow ugc noopener">Vertex (code)</a><span> represents a numerical value with real and imaginary parts. With respect to the system as a whole, a Vertex could be an input, output, or intermediate value.</span></p><p><span>An </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/graph/edge.ts#L17" rel="nofollow ugc noopener">Edge (code)</a><span> represents a constraint between two or more values. For example, connecting two values by a wire in the flowchart UI corresponds to an </span><em>equality constraint</em><span> Edge in the RelGraph. Continuing our example, let’s see how Vertices and Edges work together:</span></p><p><span>The image below shows the RelGraph created for our construction of Euler’s Identity. Vertices/values are blue (and are given arbitrary uppercase letters as IDs for the sake of this diagram), while Edges/constraints are green. As you can see, a RelGraph is a </span><a href="https://en.wikipedia.org/wiki/Hypergraph" rel="nofollow ugc noopener">hypergraph</a><span> where Edges can connect multiple Vertices. The messy image further below illustrates how this RelGraph corresponds to the nodes and wires in the flowchart UI.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png" width="500" height="686.6537717601548" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/b18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1420,&#34;width&#34;:1034,&#34;resizeWidth&#34;:500,&#34;bytes&#34;:129412,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb18e0f22-d5a9-48d6-948d-4120aa7cb62c_1034x1420.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>The constraint graph (RelGraph) underlying the construction of Euler’s Identity</figcaption></figure></div><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png" width="1456" height="1033" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1033,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:2541995,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50bb5bae-a02f-4b70-902e-52e6f7514b4d_2948x2092.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>How the constraints graph connects to the flowchart UI for Euler’s Identity.</figcaption></figure></div><p><span>Note that our construction has some extra Vertices at the incoming and outgoing terminals of our </span><em>Multiplier</em><span> and </span><em>Exponentiator</em><span>. That’s because these operators come with their own input and output Vertices. Wiring up two values does not merge them, rather it creates an additional </span><em>equality constraint</em><span> between them.</span></p><p><span>An important affordance of the system is that every single operator can run in reverse; you can turn what used to be an </span><em>output</em><span> into an </span><em>input</em><span>. For example, you can unlock the sum value below an Adder, give up control of one of the addends, and suddenly you can run the Adder in reverse, effectively as a Subtractor. </span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png" width="240" height="337.3333333333333" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/f5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1012,&#34;width&#34;:720,&#34;resizeWidth&#34;:240,&#34;bytes&#34;:216672,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff5546206-bff3-4263-adb0-f2c56bc52551_720x1012.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>The Adder below has been reversed into a Subtractor. The green circles and ‘unlocked’ icons indicate that a variable is free, so, in the subtractor we created we can change the values of ‘5’ and ‘3’ and see how the result ‘2’ reacts.</figcaption></figure></div><p>The UI makes it easy to reverse multiple operators at once; the user can lock and unlock disparate Vertices, and the tool will find a path of Edges (operators and equality-constraints) between them, reversing all of those edges simultaneously.</p><p><span>This allows the user to quickly solve for different variables in a system. For example, a mechanical engineer who is modeling pressure with a headset strap might wonder “if I set pressure and head size to these constants, what is the resulting optimal strap length?” Later, once a strap length is selected, they might </span><em>free up</em><span> the head-size variable, allowing them to ask “given this strap length, what is the smallest head size that yields at least some minimum amount of pressure?”</span></p><p>The screenshots and renderings above show a RelGraph in equilibrium, but the RelGraph is not always in equilibrium. When you first connect an operator to some values, or when you drag a value around, the system will be in a temporary disequilibrium, then will iteratively march towards a solution.</p><p><span>This march happens because the RelGraph is scheduled to regularly </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/graph/relGraph.ts#L131" rel="nofollow ugc noopener">update its values (code)</a><span>. These updates are delegated to the RelGraph’s Edges; each edge updates its dependent Vertex’s value in an attempt to </span><em>bring the Edge’s constraint closer to being satisfied.</em><span> For example, an equality constraint spanning from a 4 to a 3 might update the 3 value to a 3.02 in a single update cycle, then on to 3.04 and 3.06 and so on, such that equality between the two values is closer to being satisfied.</span></p><p>Depending on the speed and granularity of updates that you’ve set, you can see this march in real time as the system solves itself.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png" width="1456" height="313" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/c4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:313,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:202231,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:&#34;&#34;,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc4779a88-4ce1-429b-a936-3d27a661d48e_1896x408.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>UI that let the user configure the speed and granularity of updates.</figcaption></figure></div><p><em>Note: the way in which </em><span>the system marches towards equilibrium is abstracted away from the structure of the graph itself. The team wrote a few versions of those update functions (differential, ideal, and iterative) which live </span><a href="https://github.com/dnsosebee/digital-abacus/tree/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/coords/operations" rel="nofollow ugc noopener">in this folder</a><span>. We’re currently using the iterative updaters within the file </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/coords/operations/iterative.ts" rel="nofollow ugc noopener">iterative.ts</a><span>, which is why the RelGraph doesn’t instantaneously reach equilibrium.</span></p><p>Since you can create cyclic constructions where a value indirectly relies on itself, not every construction is guaranteed to reach equilibrium. Some systems will result in values that spin around in circles, or that gradually spiral towards equilibrium, or that run off towards infinity.</p><p>Note: The team added some special behavior to the updaters in iterative.ts to help guide cyclic constructions towards stable equilibria, which involves calculating the differential of a dependent value with respect to the input being manipulated. A full explanation is out of the scope of this post.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png" width="1456" height="750" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/ee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:750,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:565253,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:&#34;&#34;,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fee6d3a72-ef11-44b6-aebe-a0c453577396_2458x1266.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>A representation of the equation x=(x+9)/4, which has reached equilibrium at x = 3. This construction contains a cycle.</figcaption></figure></div><p>So far we’ve covered the basics of the constraint solver; now on to my favorite part: composite operations.</p><p><span>The Digital Abacus Tool started with only four primitive operators: Adder, Multiplier, Exponentiator, and Conjugator. These building blocks can be used to make basically any mathematical function [citation needed], but we also wanted to give the user a wider menu of operators to work with. Rather than implement update-functions for every single operator we wanted, we decided to support </span><em>Composite Operations</em><span>, meaning that a single node in the flowchart could encapsulate multiple primitive operations in the RelGraph. This would let us add things like logarithms and trig functions.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png" width="86" height="377.3098591549296" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/a63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1246,&#34;width&#34;:284,&#34;resizeWidth&#34;:86,&#34;bytes&#34;:139349,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa63080e8-930d-40c0-9ac8-889609b9f914_284x1246.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>Some of composites available in the tool. Each of these is composed of a subgraph of primitive operators.</figcaption></figure></div><p><span>We discussed two ways to enable composites: One option was to add multiple Edges and Vertices to the main RelGraph graph per composite operation. Another option was for each composite operation to contain its own </span><em>subgraph</em><span>. Each subgraph would itself be a RelGraph, and could contain any of the primitive operators listed above, or could recursively contain more subgraphs (spoiler, we chose this approach).</span></p><p><span>Here’s how subgraph-based composite operations work: suppose we have a Subtractor within our main RelGraph, with input values 5 and 3. When it’s time for the Subtractor to update, that Subtractor pulls the 5 and the 3 down from the main RelGraph into its subgraph, then runs its subgraph’s update function (which contains a reversed Adder), and finally pushes the result, 2, back up into the main graph. </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/coords/operations/composites/compositeOperation.ts#L85" rel="nofollow ugc noopener">Here’s the code that runs those nested updates</a><span>.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png" width="414" height="372.7792207792208" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1248,&#34;width&#34;:1386,&#34;resizeWidth&#34;:414,&#34;bytes&#34;:132878,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F253d2650-4441-483b-ab07-896dad6c2203_1386x1248.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>A diagram showing how a Subtractor can be implemented by encapsulating a reversed Adder</figcaption></figure></div><p><span>We chose the subgraph approach for a few reasons. First of all, it gave us a nice pattern to use for creating composites: We could create a composite in the UI, then serialize it and store it as a configuration file associated with that particular composite’s sidebar menu item (</span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/coords/operations/composites/geometricMean.ts#L9" rel="nofollow ugc noopener">example configuration</a><span>). This serialized configuration represents the initial equilibrium state of the composite operation’s subgraph, and can be deserialized to create a fresh copy of the composite operation whenever a user drags a new composite node into the flowchart.</span></p><p>The subgraph pattern also simplifies batch operations. Deleting a composite is easy: since you just delete its subgraph, you don’t have to go searching the main RelGraph for related Vertices and Edges.</p><p>Some small updates to the UI could allow users to build and edit their own composite operations using the exact same flowchart and plot UIs, giving users a personal component library of math functions relevant to their work. This would be relatively simple, since the RelGraph powering the entire UI could easily be swapped out for the scoped RelGraph that defines any given composite.</p><p><span>This could look similar to </span><a href="https://cuttle.xyz/" rel="nofollow ugc noopener">Cuttle’s</a><span> component system, shown below, where user-defined components are listed in the left sidebar and can be dragged into the current work area.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png" width="1456" height="969" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:969,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:155780,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f41298a-410e-4a15-b0f5-d5356b4bf4dc_1506x1002.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption><span>A screenshot of the Cuttle project for my board game, </span><a href="https://sneakytown.substack.com/" rel="nofollow ugc noopener">Sneaky Town</a><span>, highlighting Cuttle’s component system.</span></figcaption></figure></div><p><span>Thank you for reading. If you haven’t already, please subscribe below for future updates, including the upcoming post: </span><em>Building the Digital Abacus pt. 2: Reactivity &amp; Persistence</em><span>.</span></p><p>P.S. I worked on this project in my capacity as a product development contractor and am open to new clients. Also the Digital Abacus is looking for funding to continue pushing the boundaries of free &amp; open-source math tools. Feel free to reach out for either.</p><p>Best,</p><p>Daniel Sosebee</p></div></div></div></article></div></div></div>
  </body>
</html>
