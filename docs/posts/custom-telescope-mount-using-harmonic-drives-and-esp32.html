<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.svendewaerhert.com/blog/telescope-mount/">Original</a>
    <h1>Custom telescope mount using harmonic drives and ESP32</h1>
    
    <div id="readability-page-1" class="page"><div><p><strong><a href="#manufacturing-and-assembly">TL;DR →</a></strong></p>
<h2 id="the-spark">The Spark</h2>
<div><figure><p><img alt="" loading="lazy" width="600" height="400" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/orion-opt-640.WEBP 1x, /content/blog/telescope-mount/opt/orion-opt-1200.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/orion-opt-1200.WEBP"/></p><figcaption>Early Orion Nebula capture</figcaption></figure></div>
<p>A few years back, I developed an interest in astrophotography thanks to YouTubers like <a href="https://www.youtube.com/c/nebulaphotos">Nebula Photos</a>. Armed with an OM System OM-5 and a 15-140mm Olympus lens, I managed some decent shots of the Orion Nebula from a tripod by taking 300 pictures with a 2-second exposure time and stacking them in <a href="https://siril.org/">Siril</a>.</p>
<p>Knowing I could achieve better results with tracking, I bought a Move Shoot Move tracker for around €200. It delivered longer exposures, but finding targets and achieving proper polar alignment remained challenging. I spent countless hours researching proper telescope mounts with GOTO and tracking capabilities, coming close to pulling the trigger on units ranging from €1,200 to €4,000. For a hobby I was still exploring, that investment always felt like a leap too far.</p>
<h2 id="the-pcb-awakening">The PCB Awakening</h2>
<p>Late 2024 I randomly came across this <a href="https://www.youtube.com/watch?v=EPH23zhPg50">YouTube video about custom PCB design</a> in my feed, and I was hooked immediately.</p>
<p>With a decent collection of microcontroller boards, the idea of ditching messy breadboards for clean, custom, affordable PCBs was revelatory. My first project replaced my home thermostat with an ESP32-based design with e-paper display, interlocking finger patterns for the original carbon rubber dome switches and space for a Bosch BME680 sensor breakout.</p>
<p>After completing that project, I revisited the telescope mount idea - this time armed with newfound PCB design skills. The question emerged: &#34;How hard can it be?&#34;</p>
<h2 id="down-the-research-rabbit-hole">Down the Research Rabbit Hole</h2>
<p>The plan crystallized around harmonic drives (strain wave gears) - the favorite of modern telescope mounts for their excellent performance in compact packages. The concept seemed straightforward: motor, microcontroller, optional gearing, and a strain wave gear, all housed in a sturdy enclosure.</p>
<p>I divided my time between scouring AliExpress for components and studying existing DIY builds. AliExpress proved to have the worst search functionality in e-commerce history. Google&#39;s <code>site:aliexpress.com</code> became my most reliable tool. Hours were spent analyzing technical drawings of every available harmonic drive, searching for workable options and trying to not lose my mind in the myriad of near-identical items from multiple vendors.</p>
<p>Some other DIY projects provided me with invaluable information:</p>
<ul>
<li><a href="https://github.com/polvinc/HEMY">HEMY</a> - Harmonic drive equatorial mount</li>
<li><a href="https://github.com/romanhujer/HrEM">HrEM</a> - Harmonic reduction equatorial mount</li>
<li><a href="https://github.com/polvinc/DHEM">DHEM</a> - Dual harmonic equatorial mount</li>
<li><a href="https://astrophilos.com/diy-eq-mount-v2/">DIY EQ Mount V2</a> - Comprehensive build guide</li>
</ul>
<p>Soon I was looking into the workings of stepper motors, BLDC motors, Field Oriented Control (FOC), and various open source FOC implementations like <a href="https://simplefoc.com/">SimpleFOC</a>.</p>
<h2 id="design-decisions">Design Decisions</h2>
<p>Honestly, this build didn&#39;t require a custom PCB. A FYSETC E4 board or even a breadboarded ESP32 would have worked. But I wanted to create something beautiful from scratch, achieving that &#34;I made this&#34; feeling. The housing, however, absolutely needed to be sturdy and custom-designed.</p>
<p>I started learning <a href="https://www.freecad.org/">FreeCAD</a> alongside <a href="https://www.kicad.org/">KiCad</a>, producing about eight throwaway housing designs before the concept solidified.</p>
<p><img alt="FreeCAD Design" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/freecad-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/freecad-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/freecad-opt-1920.WEBP"/>
<em>Housing design iterations in FreeCAD - multiple attempts to get the geometry right</em></p>
<h3 id="the-architecture">The Architecture</h3>
<ul>
<li><strong>RA Axis</strong>: 42AIM15 Servo motor with Type 17 harmonic drive (100:1 reduction)</li>
<li><strong>DEC Axis</strong>: MKS Servo042D stepper with Type 14 harmonic drive (100:1 reduction)</li>
<li><strong>Mounting</strong>: Arca Swiss plate (compatible with existing Move Shoot Move wedge)</li>
<li><strong>Operation</strong>: GEM or ALTAZ modes</li>
<li><strong>Microcontroller</strong>: ESP32-S3</li>
<li><strong>Power</strong>: USB-C power delivery up to 24V/4A</li>
<li><strong>Motor driving</strong>: step/dir/en ports via the ULN2003 + MODBUS and CANBUS ports</li>
<li><strong>Extra</strong>: Leftover GPIO pins broken out for future use</li>
</ul>
<p>The 42AIM15 provides 32,768 steps per revolution, configurable to 65,536 steps with 2x oversampling. The MKS Servo042D supports microstepping up to 1/256. Both motors were chosen for their integrated drivers, dramatically simplifying PCB design. With FOC and microstepping, other builds demonstrated decent tracking accuracy without intermediate reduction. Via CANBUS I can control the microstepping regime of the stepper motor. During slews I set the microstepping to 128 from 256, allowing a higher slew speed in degrees / second without putting too much load on the microprocessor.</p>
<h2 id="the-pcb-design">The PCB Design</h2>
<p><img alt="KiCad PCB Design" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/kicad-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/kicad-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/kicad-opt-1920.WEBP"/>
<em>PCB layout in KiCad showing the semi-circular form factor and component placement</em></p>
<p>The PCB takes a semi-circular form factor, designed to fit snugly within the housing. This unique shape and placement didn&#39;t significantly increase the size of the mount, which I already felt was becoming quite beefy. I used an ESP32-S3 Microcontroller without the PCB antenna, so I could fit the module anywhere on the board. The first traces I routed were power and the USB differential pair. I managed to place the microcontroller in such a way that the differential pair goes in a straight line.</p>
<p>Power is available through USB-C thanks to the AP33772 IC which negotiates power via the CC pins on the USB-C connector. Power banks supporting USB PD 3.0 and able to deliver 12V are excellent for making this entire setup portable. Major props to the guys from CentyLab for their <a href="https://github.com/CentyLab/PicoPD">PicoPD</a> schematics and PCB designs using the AP33772. This was a big inspiration for laying out my components. The output trace is very wide to support 24V<sup><a href="#v24-note">*</a></sup> and also has 4 large capacitors. In hindsight, those caps were maybe a bit overkill because the motors for this usecase hardly produce any sudden power peaks, and a good USB PD power supply would probably already have a decent enough amount of capacitance.</p>
<p><small><a id="v24-note"></a><p><strong>Correction<sup>*</sup>:</strong> The wide output trace is for <strong>current capacity</strong>, not because it’s <strong>24 V</strong>; voltage primarily sets <strong>spacing</strong>. <em>Hat tip to the astute reader.</em></p></small></p><p>During my research I noticed a lot of integrated motors with CANBUS/MODBUS features, so I added functionality for that as well. The remaining GPIO pins of the ESP32 I simply routed somewhere nearer to the edge of the board so they can be used for other purposes in the future.</p>
<p>Some thought has also gone into choosing the right PCB mounted connectors. I settled on the JST PH series for their compactness and their ability to carry 2A per pin. Matt Millman&#39;s <a href="https://www.mattmillman.com/info/crimpconnectors/common-jst-connector-types/">Common JST Connector Types</a> was a great resource for making the final selection.</p>
<h3 id="the-first-pcb-mistake">The First PCB Mistake</h3>
<p>Initially my design was around the AP33772S IC. A last-minute component substitution at JLCPCB - changing the originally specified IC due to stock issues - should have triggered a complete pin compatibility review. Impatience won, and I ordered anyway, replacing the AP33772S with the AP33772.</p>
<p>The result: I2C communication was impossible due to NO-CONNECT pins erroneously tied to ground, and manually getting the VBUS voltage to 24V using an external PD trigger board caused a sudden tiny hole to appear on the chip package, followed by blue smoke. Lesson learned. Version 2 underwent exhaustive verification, and worked flawlessly when it arrived. I also included significantly more test points throughout the board, whch is a practice I&#39;m going to keep going forward. The version 1 boards still work for controlling the mount, but they lack the intergated power delivery.</p>
<p><img alt="Completed PCB" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/pcb-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/pcb-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/pcb-opt-1920.WEBP"/>
<em>Version 2 of the custom PCB</em></p>
<h2 id="onstepx-integration">OnStepX Integration</h2>
<p><a href="https://github.com/hjd1964/OnStepX">OnStepX</a> is telescope mount firmware supporting multiple microcontroller platforms, originally developed by Howard Dutton to save his mount from obsolescence. It has since grown into a major open source project with substantial community support.</p>
<p>Without OnStepX, DIY telescope mounts like this wouldn&#39;t be feasible for many builders. The ESP32 WiFi support became my preferred communication method, though initial testing revealed WiFi instability during slewing operations. Not surprising once you understand that slewing to a target significantly increases the number of pulses per second sent to the motors, and everything became just too much to handle for our little ESP32.</p>
<p>Two changes resolved the stability issues:</p>
<ol>
<li>Reducing slew rates or increasing step sizes with lower microstep divisions (configurable on-the-fly through OnStepX hooks in the generic motor class)</li>
<li>Configuring the device as a WiFi client rather than access point</li>
</ol>
<p>Apart from adding a custom pin layout file and some code to lower the microstep subdivisions during slewing, OnStepX really just worked out of the box.</p>
<h2 id="manufacturing-and-assembly">Manufacturing and Assembly</h2>
<p>All manufacturing was handled by JLCPCB - both PCB fabrication and CNC machining. Sending CNC production files without 3D printing prototypes first was a calculated gamble that paid off; everything fit (almost) perfectly upon arrival.</p>
<p><img alt="Assembly Process" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/build-8-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/build-8-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/build-8-opt-1920.WEBP"/>
<em>Mount fully assembled. Yes, those are 5 euro rainwater pipe clamps holding the telescope</em></p>
<p>One minor adjustment was required: the red cap at the RA axis rubbed against the harmonic drive. The oversight occurred because I modeled the cup interior without accounting for the harmonic drive mounting screws. I used a simple spacer to fix the problem. I&#39;m very impressed with the manufacturing quality of the components. To assemble everything I just needed to thread the holes with some M3 or M4 taps and bolt everything together. I opted for manual tapping to save on manufacturing cost.</p>
<h2 id="real-world-performance">Real-World Performance</h2>
<p>Countless nights were spent mastering polar alignment, scope setup, and navigating the quirks of <a href="https://kde.org/applications/education/org.kde.kstars/">KStars</a>, <a href="https://docs.kde.org/trunk5/en/kstars/kstars/ekos.html">Ekos</a>, and <a href="https://indilib.org/">INDI server</a>. The first cloudless nights usually ended in frustration: between polar alignment, WiFi issues, indi server issues, camera issues, slipping motor couplings, and software configuration, dawn would arrive before I captured a single frame. At one point, I celebrated achieving 0.1 arcsecond precision! - only to discover <a href="https://openphdguiding.org/">PHD2</a> was configured with incorrect focal length settings and reported skewed results.</p>
<p>The best verified precision achieved so far is 1-2 arcseconds observed with PHD2, more than adequate for 30-second exposures with a 600mm focal length Sigma lens. I continue using my camera in interval mode, ensuring the signal is somewhere in the middle of the histogram. ISO 3200 usually, with sensor stabilization and noise suppression disabled. Stacking is performed in <a href="https://siril.org/">Siril</a>, though multi-night stacking remains a goal requiring significant planning, luck, and consistency.</p>
<p><img alt="Telescope Mount in Action" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/build-7-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/build-7-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/build-7-opt-1920.WEBP"/>
<em>The completed mount setup</em></p>
<h2 id="the-economics">The Economics</h2>
<p>Total project cost reached approximately €1,700, including reusable tools like thread taps, various M3/M4/M5 hardware and JST Connector tools. Sometimes bulk purchases or shipping minimums inflated costs. I also bought 2x unused MS6010v3 motors for experimenting/evaluating for a potential future super compact build. And the extra cost of the PCB revision ofcourse.</p>
<p>Calculating single-unit costs yields approximately €800, with potential for reduction in larger quantities. Compared to commercial GOTO mounts in the €1,200-€4,000 range, the economics are competitive - but economics was never the primary driver.</p>
<h3 id="detailed-cost-breakdown">Detailed Cost Breakdown</h3>
<table><thead><tr><th>Component</th><th>Category</th><th>Total Cost (€)</th><th>Single Unit (€)</th></tr></thead><tbody><tr><td>Cuttin Tap 1/4-20 UNC</td><td>Tools</td><td>2.89</td><td>1</td></tr><tr><td>Cutting Tap Form D - UNC 3/8 x 16</td><td>Tools</td><td>12.88</td><td>1</td></tr><tr><td>220 pieces M5 screw set</td><td>Tools</td><td>10.59</td><td>1</td></tr><tr><td>440 pieces M4 screw set</td><td>Tools</td><td>13.21</td><td>1</td></tr><tr><td>440 pieces M3 screw set</td><td>Tools</td><td>9.14</td><td>1</td></tr><tr><td>Metric tap set MetricssMann M53250-B</td><td>Tools</td><td>27.38</td><td>1</td></tr><tr><td>PEBA JST PH 2.0 Crimping set</td><td>Tools</td><td>31.11</td><td>1</td></tr><tr><td><strong>Tools Subtotal</strong></td><td></td><td><strong>107.2</strong></td><td></td></tr><tr><td>MKS SERVO42D NEMA17 Closed Loop Stepper Motor</td><td>Mount</td><td>73.2</td><td>36.6</td></tr><tr><td>Harmonic drive 2x</td><td>Mount</td><td>144.44</td><td>144</td></tr><tr><td>Import tax harmonic drive 2x</td><td>Mount</td><td>30.24</td><td>15</td></tr><tr><td>Servo motor 2x</td><td>Mount</td><td>216.46</td><td>151.7</td></tr><tr><td>Import tax servo motor x2</td><td>Mount</td><td>86.94</td><td>43</td></tr><tr><td>MS6010v3 (2x)</td><td>Research</td><td>216.94</td><td></td></tr><tr><td>Import tax MS6010v3 (2x)</td><td>Research</td><td>57.05</td><td></td></tr><tr><td>CNC parts</td><td>Mount</td><td>215.76</td><td>215.76</td></tr><tr><td>Import tax CNC</td><td>Mount</td><td>58.04</td><td>58.04</td></tr><tr><td>PCB (5x)</td><td>Mount</td><td>178.74</td><td></td></tr><tr><td>Import tax PCB</td><td>Mount</td><td>33.54</td><td></td></tr><tr><td>PCB2 (5x)</td><td>Mount</td><td>178.74</td><td>42.46</td></tr><tr><td>Import tax PCB2</td><td>Mount</td><td>33.54</td><td>6</td></tr><tr><td>Extra Harmonic wave generator 8mm</td><td>Mount</td><td>44.59</td><td>44.59</td></tr><tr><td>Import customs duty harmonic wave generator</td><td>Mount</td><td>36</td><td>36</td></tr><tr><td><strong>Total Project Cost</strong></td><td></td><td><strong>1711.42</strong></td><td><strong>800.15</strong></td></tr></tbody></table>
<p><em>Single unit costs represent what one mount would cost without bulk purchases, shipping minimums, and reusable tools.</em></p>
<h2 id="anyway">Anyway</h2>
<p>It was totally worth it.</p>
<p>The failed Version 1 PCB taught me never to skip verification steps, regardless my occasional impatience. OnStepX opened up the world of equatorial mount operation and just the joy of watching that thing slew across the sky. FreeCAD modeling skills improved dramatically through multiple housing iterations. I will probably spend more attention to documenting during future builds: writing down thoughts along the way and taking better pictures/screenshots/recordings.</p>
<p>Sure, I spent about as much as a commercially available mount, but I gained so much more. Plus I have a freaking mount that tracks stars!</p>
<p>That feeling when you point at a nebula, watch it track perfectly, and know (almost) exactly how everything works, cause you built it. ✨</p>
<p><img alt="Galaxy Image Captured" loading="lazy" width="800" height="600" decoding="async" data-nimg="1" srcset="/content/blog/telescope-mount/opt/galaxy-opt-828.WEBP 1x, /content/blog/telescope-mount/opt/galaxy-opt-1920.WEBP 2x" src="https://www.svendewaerhert.com/content/blog/telescope-mount/opt/galaxy-opt-1920.WEBP"/>
<em>M51 Whirlpool Galaxy, 23.5 million lightyears away</em></p>
<h2 id="image-gallery">Image Gallery</h2>
</div></div>
  </body>
</html>
