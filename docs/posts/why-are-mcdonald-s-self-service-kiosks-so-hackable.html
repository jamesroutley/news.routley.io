<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ghuntley.com/mcdonalds/">Original</a>
    <h1>Why are McDonald’s Self Service Kiosks so hackable?</h1>
    
    <div id="readability-page-1" class="page"><div>
            <p>McDonalds in Australia do a decent cup of coffee. It’s not great but it’s consistently decent so I often start my day with a cup. Due to my travels around Australia <a href="https://ghuntley.com/soundboks">in a decked out van</a> I have seen how many McDonalds operate and just how many of these terminals are <em>left fucking unlocked</em>.</p><p>Underpaid staff who used to do ordering have been replaced with these self-service kiosks and a process that is based off to tickets. This process completely falls apart when the ticket printer runs out of paper and as McDonalds does A LOT of orders the printers run out of paper often. From what I&#39;ve observed staff across Australia are leaving the Kiosks unlocked to make it easier to replace the paper.</p><p>Inside a kiosk is a standard x86 computer NUC with exposed USB ports. Now I’ve learned since my youth but part <a href="https://www.youtube.com/watch?v=u3CKgkyc7Qo">being a hackerman</a> is having keen observations for really dumb stuff that can be leveraged and you never lose that skill even after you cease practicing. It’s like travelling to a new town with a skater boi - always looking for new lines to skate.</p><p>Three days ago at the Blaxland store my spider senses started tingling when I noticed something quite alarming. It turns out that these kiosks run windows 7 as administrator, touch screen input is enabled and in the recovery operating mode the general public can run any application 😬</p><figure><blockquote><p lang="en" dir="ltr">CVE-2022-244622: A local unauthenticated attacker within a <a href="https://twitter.com/McDonalds?ref_src=twsrc%5Etfw">@McDonalds</a> could exploit this knowledge to pop calc.exe.</p>— GEOFF 🦩🎼🌷 (@GeoffreyHuntley) <a href="https://twitter.com/GeoffreyHuntley/status/1550287484549943296?ref_src=twsrc%5Etfw">July 22, 2022</a></blockquote>

</figure><p>So why am I concerned? Why should you care? There are payment terminals attached to these kiosks. If someone installs malware on here - just insert a usb stick or use the recovery mode - then tada we have the next generation of atm skimming.</p><figure><a href="https://www.watoday.com.au/national/western-australia/revealed--the-machines-behind-the-eftpos-scam-20091111-i9sc.html"><div><p>Revealed - the machines behind the EFTPOS scam</p><p>The skimming scam that has stripped almost $5 million from WA bank accounts was due to old EFTPOS machines easily hacked, a senior industry insider says.</p><p><img src="https://www.watoday.com.au/apple-touch-icons/watoday.png" alt=""/><span>Chalpat Sonti</span></p></div><p><img src="https://static.ffx.io/images/$width_620%2C$height_414/t_crop_fill/q_86%2Cf_auto/t_watoday_no_label_social_wm/l_text:PT%20Sans_41_bold_italic:%20from%20%2Cg_south_west%2Cy_84%2Cx_647%2Cco_rgb:0a1633/l_text:PT%20Sans_41_bold:%20%20%2Cg_south_west%2Cy_90%2Cx_734%2Cco_rgb:0a1633/l_text:AbrilTitling-Bold.ttf_83:%202009%20%2Cg_south_west%2Cy_15%2Cx_633%2Cco_rgb:0a1633/3cd94fd12a3d0ac8c3bb57c2fbeea11a4bd9a414" alt=""/></p></a></figure><p>Today at another McDonald&#39;s I observed the entire bootstrap process and can confirm that the kiosk indeed is responsible for installing “custom firmware” on the card reader and as user interaction is enabled, it is, in theory, possible to force the terminals into recovery mode when they boot by tapping on the screen...</p><figure><div><div><p><img src="https://ghuntley.com/content/images/2022/07/Screen-Shot-2022-07-25-at-7.49.53-am.png" width="990" height="1310" loading="lazy" alt="" srcset="https://ghuntley.com/content/images/size/w600/2022/07/Screen-Shot-2022-07-25-at-7.49.53-am.png 600w, https://ghuntley.com/content/images/2022/07/Screen-Shot-2022-07-25-at-7.49.53-am.png 990w" sizes="(min-width: 720px) 720px"/></p><p><img src="https://ghuntley.com/content/images/2022/07/FYdRGKeVUAAuGTs.jpg" width="1536" height="2048" loading="lazy" alt="" srcset="https://ghuntley.com/content/images/size/w600/2022/07/FYdRGKeVUAAuGTs.jpg 600w, https://ghuntley.com/content/images/size/w1000/2022/07/FYdRGKeVUAAuGTs.jpg 1000w, https://ghuntley.com/content/images/2022/07/FYdRGKeVUAAuGTs.jpg 1536w" sizes="(min-width: 720px) 720px"/></p><p><img src="https://ghuntley.com/content/images/2022/07/FYdRGK3UEAIOg22.jpg" width="1536" height="2048" loading="lazy" alt="" srcset="https://ghuntley.com/content/images/size/w600/2022/07/FYdRGK3UEAIOg22.jpg 600w, https://ghuntley.com/content/images/size/w1000/2022/07/FYdRGK3UEAIOg22.jpg 1000w, https://ghuntley.com/content/images/2022/07/FYdRGK3UEAIOg22.jpg 1536w" sizes="(min-width: 720px) 720px"/></p></div><div><p><img src="https://ghuntley.com/content/images/2022/07/FYdRGKEVQAAbVob.jpg" width="1536" height="2048" loading="lazy" alt="" srcset="https://ghuntley.com/content/images/size/w600/2022/07/FYdRGKEVQAAbVob.jpg 600w, https://ghuntley.com/content/images/size/w1000/2022/07/FYdRGKEVQAAbVob.jpg 1000w, https://ghuntley.com/content/images/2022/07/FYdRGKEVQAAbVob.jpg 1536w" sizes="(min-width: 720px) 720px"/></p><p><img src="https://ghuntley.com/content/images/2022/07/FYdRGLrUsAAFh6O.jpg" width="1536" height="2048" loading="lazy" alt="" srcset="https://ghuntley.com/content/images/size/w600/2022/07/FYdRGLrUsAAFh6O.jpg 600w, https://ghuntley.com/content/images/size/w1000/2022/07/FYdRGLrUsAAFh6O.jpg 1000w, https://ghuntley.com/content/images/2022/07/FYdRGLrUsAAFh6O.jpg 1536w" sizes="(min-width: 720px) 720px"/></p></div></div><figcaption>`</figcaption></figure><p>McDonalds your processes are faulty in the following ways:</p><ul><li>The kiosks are built with the design of “they are physically secure so it’s okay to run as administrator”. This is NOT okay.</li><li>The kiosk user interface has error modals which block visibility of what someone’s order number is which creates customer confusion and process dysfunction with people picking up orders that aren’t theirs cause they don’t know what their order number is. Which results in underpaid staff leaving the machines unlocked so that doing a task that they do often can be done easier.<br/></li></ul><figure><img src="https://ghuntley.com/content/images/2022/07/FYYe_eOVQAAvpTY.jpg" alt="" loading="lazy" width="900" height="1200" srcset="https://ghuntley.com/content/images/size/w600/2022/07/FYYe_eOVQAAvpTY.jpg 600w, https://ghuntley.com/content/images/2022/07/FYYe_eOVQAAvpTY.jpg 900w" sizes="(min-width: 720px) 720px"/></figure><p>Anyway, so here I am sitting here with my cup of so-so coffee and pondering that it is inevitable that these terminals will be used for financial crime in the future whilst opsec (store employees and kiosk machines running as administrator) remains so relaxed.</p><blockquote>Knowing all of above I no longer use these Kiosks and recommend you don&#39;t either.</blockquote><p>What someone does with this knowledge is left as an exercise to the reader but it would be delightful to see b-sides talk where someone who has <em>legally</em> obtained one of these terminals up on stage just as Barnaby Jack did with ATM&#39;s in 2013 at DEFCON.</p><figure><iframe width="200" height="113" src="https://www.youtube.com/embed/FkteGFfvwJ0?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" title="DEF CON 18 - Barnaby Jack - Jackpotting Automated Teller Machines Redux"></iframe></figure><p>ps. If you made it this far then maybe you would also enjoy the following...</p><figure><a href="https://www.smh.com.au/business/companies/extortion-why-web3-is-pissing-off-a-lot-of-software-developers-20220516-p5alqd.html"><div><p>‘Extortion’: Why Web3 is making a lot of software developers angry</p><p>Venture capitalists and entrepreneurs say Web3 will be a decentralised utopia. But engineer Geoffrey Huntley is more than a little sceptical.</p><p><img src="https://www.smh.com.au/apple-touch-icons/smh.png" alt=""/><span>The Sydney Morning Herald</span><span>Dominic Powell</span></p></div><p><img src="https://static.ffx.io/images/$zoom_1.1037%2C$multiply_0.7554%2C$ratio_1.777778%2C$width_1059%2C$x_0%2C$y_12/t_crop_custom/q_86%2Cf_auto/t_smh_no_label_no_age_social_wm/402b605399d648bb2c255822c016a8e91d158507" alt=""/></p></a></figure><figure><a href="https://ghuntley.com/covidsafe/"><div><p>COVIDSafe: Australia’s digital contact tracing failure</p><p>I’m here all by myself reading actual peer-reviewed publications from other countries where appropriate technology was rolled out to assist medical professionals whilst Australia remains in shambles.</p><p><img src="https://ghuntley.com/content/images/size/w256h256/2021/10/android-chrome-192x192.png" alt=""/><span>Geoffrey Huntley</span><span>ghuntley</span></p></div><p><img src="https://ghuntley.com/content/images/2021/09/7CED7DAF-731E-40EC-8A87-27C479FB0221.jpeg" alt=""/></p></a></figure><figure><blockquote><p lang="en" dir="ltr">.<a href="https://twitter.com/maccas?ref_src=twsrc%5Etfw">@maccas</a> does a decent cup of coffee. It’s not great but it’s consistently decent so I often start my day with a cup. Due to my travels around Australia in my van, I have seen how many operate and how many of these terminals are left fucking unlocked.<a href="https://t.co/3QlX9SGd2E">https://t.co/3QlX9SGd2E</a></p>— GEOFF 🦩🎼🌷 (@GeoffreyHuntley) <a href="https://twitter.com/GeoffreyHuntley/status/1551327734126678017?ref_src=twsrc%5Etfw">July 24, 2022</a></blockquote>

</figure><div><p>✏️</p><p><em>update: </em>At initial time of publication I stated that the Kiosks were running Vista, this is incorrect. I&#39;ve re-reviewed the videos taken of the bootscreen and can confirm it&#39;s Windows 7. Apologies for the mistake.</p></div>
          </div></div>
  </body>
</html>
