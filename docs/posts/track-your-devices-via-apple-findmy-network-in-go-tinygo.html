<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/hybridgroup/go-haystack">Original</a>
    <h1>Track your devices via Apple FindMy network in Go/TinyGo</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/hybridgroup/go-haystack/blob/main/images/go-haystack.png"><img src="https://github.com/hybridgroup/go-haystack/raw/main/images/go-haystack.png" alt="Go Haystack gopher"/></a></p>
<p dir="auto">Go Haystack lets you track personal Bluetooth devices via Apple&#39;s massive <a href="https://developer.apple.com/find-my/" rel="nofollow">&#34;Find My&#34;</a> network.</p>
<p dir="auto">It uses <a href="https://github.com/seemoo-lab/openhaystack">OpenHaystack</a> together with <a href="https://github.com/dchristl/macless-haystack">Macless-Haystack</a> to help you setup a custom FindMy network with tools written in Go/TinyGo. No Apple hardware required!</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/hybridgroup/go-haystack/blob/main/images/macless-haystack.png"><img src="https://github.com/hybridgroup/go-haystack/raw/main/images/macless-haystack.png" alt="image of macless-haystack web UI"/></a></p>

<p dir="auto">This package provides firmware written using <a href="https://tinygo.org/" rel="nofollow">TinyGo</a> and the <a href="https://github.com/tinygo-org/bluetooth">TinyGo Bluetooth package</a>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/hybridgroup/go-haystack/blob/main/images/tinygo-beacons.jpg"><img src="https://github.com/hybridgroup/go-haystack/raw/main/images/tinygo-beacons.jpg" alt="tinygo beacons"/></a></p>
<p dir="auto">As a result, any of the following hardware devices should work:</p>
<ul dir="auto">
<li>Adafruit Bluefruit boards using nRF SoftDevice - <a href="https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#adafruit-bluefruit-boards">https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#adafruit-bluefruit-boards</a></li>
<li>BBC Microbit using nRF SoftDevice - <a href="https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#bbc-microbit">https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#bbc-microbit</a></li>
<li>Other Nordic Semi SoftDevice boards - <a href="https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#flashing-the-softdevice-on-other-boards">https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#flashing-the-softdevice-on-other-boards</a></li>
<li>Boards using the NINA-FW with an ESP32 co-processor - <a href="https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#esp32-nina">https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#esp32-nina</a></li>
<li>Boards such as the RP2040 Pico-W using the CYW43439 co-processor - <a href="https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#cyw43439-rp2040-w">https://github.com/tinygo-org/bluetooth?tab=readme-ov-file#cyw43439-rp2040-w</a></li>
</ul>
<p dir="auto">You can also run the beacon code on any Linux that has Bluetooth hardware, such as a Raspberry Pi or other embedded system.</p>
<p dir="auto">The beacon code is located in the <a href="https://github.com/hybridgroup/go-haystack/blob/main/firmware">firmware</a> directory.</p>

<p dir="auto">Go Haystack also includes TinyScan, a hardware scanner for local devices.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/hybridgroup/go-haystack/blob/main/images/tinyscan.gif"><img src="https://github.com/hybridgroup/go-haystack/raw/main/images/tinyscan.gif" alt="tinyscan" data-animated-image=""/></a></p>
<p dir="auto">TinyScan runs on several different microcontrollers boards with Bluetooth and miniature displays, such as those made by <a href="https://www.adafruit.com/" rel="nofollow">Adafruit</a> and <a href="https://shop.pimoroni.com/" rel="nofollow">Pimoroni</a></p>
<p dir="auto">The TinyScan code is located in the <a href="https://github.com/hybridgroup/go-haystack/blob/main/tinyscan">tinyscan</a> directory in this repository.</p>


<p dir="auto">You must have an Apple-ID with 2FA enabled. Only sms/text message as second factor is supported!</p>

<p dir="auto">Start <a href="https://github.com/Dadoum/anisette-v3-server"><code>anisette-v3-server</code></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="docker network create mh-network
docker run -d --restart always --name anisette -p 6969:6969 --volume anisette-v3_data:/home/Alcoholic/.config/anisette-v3 --network mh-network dadoum/anisette-v3-server"><pre>docker network create mh-network
docker run -d --restart always --name anisette -p 6969:6969 --volume anisette-v3_data:/home/Alcoholic/.config/anisette-v3 --network mh-network dadoum/anisette-v3-server</pre></div>

<ol dir="auto">
<li>Start and set up your Macless Haystack endpoint in interactive mode:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -it --restart unless-stopped --name macless-haystack -p 6176:6176 --volume mh_data:/app/endpoint/data --network mh-network christld/macless-haystack"><pre>docker run -it --restart unless-stopped --name macless-haystack -p 6176:6176 --volume mh_data:/app/endpoint/data --network mh-network christld/macless-haystack</pre></div>
<div dir="auto"><h6 tabindex="-1" dir="auto">You will be asked for your Apple-ID, password and your 2FA. If you see <code>serving at port 6176 over HTTP</code> you have all set up correctly</h6><a id="user-content-you-will-be-asked-for-your-apple-id-password-and-your-2fa-if-you-see-serving-at-port-6176-over-http-you-have-all-set-up-correctly" aria-label="Permalink: You will be asked for your Apple-ID, password and your 2FA. If you see serving at port 6176 over HTTP you have all set up correctly" href="#you-will-be-asked-for-your-apple-id-password-and-your-2fa-if-you-see-serving-at-port-6176-over-http-you-have-all-set-up-correctly"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Hit ctrl-C to exit the process once it has been configured.</p>
<ol start="2" dir="auto">
<li>Restart the macless-haystack server</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="docker restart macless-haystack"><pre>docker restart macless-haystack</pre></div>
<p dir="auto">See <a href="https://github.com/dchristl/macless-haystack/blob/main/README.md#server-setup">https://github.com/dchristl/macless-haystack/blob/main/README.md#server-setup</a> for the original instructions.</p>

<p dir="auto">Install the go-haystack command line tool</p>
<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/hybridgroup/go-haystack/cmd/haystack"><pre>go install github.com/hybridgroup/go-haystack/cmd/haystack</pre></div>

<div dir="auto"><h3 tabindex="-1" dir="auto">Scanning for local devices</h3><a id="user-content-scanning-for-local-devices" aria-label="Permalink: Scanning for local devices" href="#scanning-for-local-devices"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<p dir="auto">Should return any local devices within range:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ haystack scan                                                                                                             
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -55 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -56 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -56 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full"><pre>$ haystack scan                                                                                                             
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -55 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -56 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full
FE:B0:67:9B:9A:5C -56 feb0679b9a5c55b1141c5cc6c8f65224ae9bc6bc2d998ccf5c56a02d - battery full
CE:8B:AD:5F:8A:02 -53 ce8bad5f8a0271538ff5afda87498cb067e9a020d6e4167801d55d83 - battery full</pre></div>

<ol dir="auto">
<li>Generate keys for a device</li>
</ol>

<p dir="auto">The keys will be saved in a file named <code>DEVICENAME.keys</code> and the configuration file for Haystack will be saved in <code>DEVICENAME.json</code>. Replace &#34;DEVICENAME&#34; with whatever you want to name the actual device.</p>
<ol start="2" dir="auto">
<li>Flash the hardware with the TinyGo target and the name of your device.</li>
</ol>
<p dir="auto">For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="haystack flash DEVICENAME nano-rp2040"><pre>haystack flash DEVICENAME nano-rp2040</pre></div>
<p dir="auto">This will use TinyGo to compile the firmware using your keys, and then flash it to the device. See <a href="https://tinygo.org/getting-started/overview/" rel="nofollow">https://tinygo.org/getting-started/overview/</a> for more information about TinyGo.</p>
<ol start="3" dir="auto">
<li>Upload the JSON file for that device to your running instance of <code>macless-haystack</code> using the web UI.</li>
</ol>
<p dir="auto">Point your web browser to <a href="https://dchristl.github.io/macless-haystack/" rel="nofollow"><code>https://dchristl.github.io/macless-haystack/</code></a> which is a single-page web application that only reads/writes local data. Click on the link for &#34;Accessories&#34;, then on the &#34;+&#34; button. Choose the <code>DEVICENAME.json</code> file for your device.</p>
<p dir="auto">That&#39;s it, your device is now setup.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Objects in your data may be closer than they appear</h2><a id="user-content-objects-in-your-data-may-be-closer-than-they-appear" aria-label="Permalink: Objects in your data may be closer than they appear" href="#objects-in-your-data-may-be-closer-than-they-appear"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Eventually, if your device is in range of any iPhone, they will appear in your Macless-Haystack data in the web UI.</p>
<p dir="auto">Note that it might take a while for the first data to show up.</p>
<p dir="auto">Have fun, be good!</p>
</article></div></div>
  </body>
</html>
