<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://metaphysic.ai/the-road-to-realistic-full-body-deepfakes/">Original</a>
    <h1>The road to realistic full-body deepfakes</h1>
    
    <div id="readability-page-1" class="page"><div data-id="230321ec" data-element_type="widget" data-widget_type="theme-post-content.default"><div><div data-elementor-type="wp-post" data-elementor-id="2953"><section data-id="9aaf804" data-element_type="section"><div><div data-id="5ecafb3" data-element_type="column"><div><div data-id="682df26" data-element_type="widget" data-widget_type="text-editor.default"><div><p>It’s nearly five years since the <a href="https://www.vice.com/en/article/gydydm/gal-gadot-fake-ai-porn"><span>advent of deepfakes</span></a> released into the public realm the ability to alter people’s facial identities; at first, in recorded video, and now even as a streaming implementation, with <a href="https://metaphysic.ai/to-uncover-a-deepfake-video-call-ask-the-caller-to-turn-sideways/"><span>DeepFaceLive</span></a>.</p><p>You still have to find someone who <a href="https://metaphysic.ai/how-i-became-the-fake-tom-cruise/"><span>looks a bit like</span></a> the person you’re trying to imitate, though. The more they resemble the ‘target’ identity, the more convincing the illusion is going to be.</p></div></div></div></div></div></section><section data-id="7006050" data-element_type="section"><div><div data-id="5d43b15" data-element_type="column"><div><div data-id="565228c" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1000" height="295" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/the-impersonators.jpg" alt="the-impersonators" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/the-impersonators.jpg 1000w, https://metaphysic.ai/wp-content/uploads/2022/09/the-impersonators-300x89.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/the-impersonators-768x227.jpg 768w" sizes="(max-width: 1000px) 100vw, 1000px"/><figcaption>f the face fits, wear it! Left, Miles Fisher is well-suited as a deepfake &#39;canvas&#39; for Tom Cruise, while, right, Alexis Arquette proved an apt subject for Jerry Seinfeld in one deepfake parody, which can be seen at https://www.youtube.com/watch?v=S1MBVXkQbWU.</figcaption></figure></div></div></div></div></div></section><section data-id="40ab819" data-element_type="section"><div><div data-id="69ee4e2" data-element_type="column"><div><div data-id="e147481" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Since <a href="https://metaphysic.ai/future-autoencoder-deepfakes/"><span>autoencoder-based</span></a> deepfake systems are trained at great length on a single and <i>relatively</i> similar ‘opposite’ identity, the authenticity of the subsequent model’s recreation will suffer in accordance to how physically different the ‘host’ is from the personality being superimposed into a video clip.<span> </span></p><p>Therefore it can be hard to find the right person to act as a ‘canvas’ for a deepfake rendition of a personality. Even if hair can be revised, and peripheral features such as ears, neck-height, and basic tone and physique (as well as age) are ‘near enough’, the chances of a full-face and full-body ‘match’ in one person are vanishingly small.</p><p>What if, instead, and in the complete absence of expensive and complex professional CGI techniques, you could recreate the <i>entire person</i> with machine learning?<span> </span></p></div></div></div></div></div></section><section data-id="9347233" data-element_type="section"></section><section data-id="a8ce11c" data-element_type="section"><div><div data-id="4ed908d" data-element_type="column"><div><div data-id="361268a" data-element_type="widget" data-widget_type="text-editor.default"><p><i>1990s-era Jennifer Connelly (and, inset, Henry Cavill) recreated through Stable Diffusion and EbSynth, based on the real movements of a female performer (lower left ‘source’ image). The actors’ entire bodies here have been reinterpreted from that source footage, based on what Stable Diffusion knows about the face and physique of the two personalities recreated here – both of whom are well-represented in the database on which the model was trained. Predictably, the AI has an easier time transforming a woman into another woman than to a muscular man like Henry Cavill.</i></p></div><div data-id="9c7a3ee" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Shortly, we’ll take a look at the possibilities and <i>very</i> severe limitations of attempting photoreal, temporally coherent video with <a href="https://metaphysic.ai/stable-diffusion-is-video-coming-soon/"><span>Stable Diffusion</span></a> and the non-AI ‘tweening’ and style-transfer software <a href="https://ebsynth.com/"><span>EbSynth</span></a>; and also (if you were wondering) why clothing represents such a formidable challenge in such attempts.<span> </span></p><p>For now, we should consider at least a couple of reasons why a truly effective, 100% neural, Stable Diffusion-style text-to-video system for full-body deepfakes may be years or even decades away, rather than months, as many enthused Stable Diffusion fans now seem to believe.</p></div></div></div></div></div></section><section data-id="e415b64" data-element_type="section"><div><div data-id="1060c9c" data-element_type="column"><div><div data-id="7cc1058" data-element_type="widget" data-widget_type="heading.default"><p><h2>The (Slow) Future of 100% Neural Total-Body Deepfakes</h2></p></div></div></div></div></section><section data-id="d3174ab" data-element_type="section"><div><div data-id="74a775d" data-element_type="column"><div><div data-id="ff6fcb9" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Though the above video clip*, with all its rough edges, is just a cheap bag of tricks thrown together with open source software, this type of corporeal ‘deepfake puppetry’ is likely to be the earliest consumer-level incarnation of full-body deepfakes in the Metaverse, and in other potential virtual future environments and contexts (where the body movements and entire physical appearance of participants will eventually be capable of being transformed in real time).</p><p>This is because it’s easy for a human (such as the performer ‘powering’ Jennifer Connelly and Henry Cavill in the above clip) to string together a series of concepts or instructions into a series of movements; and facial/body capture AI systems are already advanced enough to ‘map’ human movements in real time, so that image or video synthesis systems such as DeepFaceLive can ‘overwrite’ the original identity with very low latency.</p><p>But if you want to <i>describe</i> human activities in a text-to-video prompt (instead of using footage of real people as a guideline), and you’re expecting convincing and photoreal results that last more than 2-3 seconds, the system in question is going to need an extraordinary, almost <a href="https://www.britannica.com/topic/Akashic-record"><span>Akashic</span></a> knowledge about many more things than Stable Diffusion (or any other existing or planned deepfake system) knows anything about.<span> </span></p><p>These include anatomy, psychology, basic anthropology, probability, gravity, kinematics, inverse kinematics, and physics, to name but a few. Worse, the system will need <i>temporal</i> understanding of such events and concepts, rather than the fixed and time-static embeddings contained in Stable Diffusion, based on the 4.2 billion static images that it was trained on.</p></div></div></div></div></div></section><section data-id="3e26ea7" data-element_type="section"><div><div data-id="30359b3" data-element_type="column"><div><div data-id="9c189c1" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="797" height="791" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/static-and-temporal-embedding.jpg" alt="static-and-temporal-embedding" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/static-and-temporal-embedding.jpg 797w, https://metaphysic.ai/wp-content/uploads/2022/09/static-and-temporal-embedding-300x298.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/static-and-temporal-embedding-150x150.jpg 150w, https://metaphysic.ai/wp-content/uploads/2022/09/static-and-temporal-embedding-768x762.jpg 768w" sizes="(max-width: 797px) 100vw, 797px"/><figcaption>The several orders of magnitude difference in complexity between &#39;simple&#39; joint representations of images and text (as used in systems such as Stable Diffusion), and the much higher volume of information that must be represented in an equivalent system that embeds movement. The uppermost image above represents classes and domains that have been clustered together in a trained &#39;cloud&#39; of input in a &#39;latent noise&#39; or GAN-style system. In such a case, images have been trained into searchable and retrievable embeddings in the latent space of the model. Underneath, we see just a single example of ONE video clip likely to be found in an equivalent temporal system. The clip, and its related information, needs at least as much text annotation as the &#39;static&#39; system, and likewise has to form relationships with similar clips, classes and domains in the wider dataset, despite its far more complex set of possible parameters. To boot, it requires more storage, processing, and higher compute capacity to derive and assimilate applicable embeddings based on the source data. Sources: https://towardsdatascience.com/tag2image-and-image2tag-joint-representations-for-images-and-text-9ad4e5d0d99 | https://developer.nvidia.com/blog/an-introduction-to-the-nvidia-optical-flow-sdk/</figcaption></figure></div></div></div></div></div></section><section data-id="ebcfec7" data-element_type="section"><div><div data-id="20638f8" data-element_type="column"><div><div data-id="b2337ea" data-element_type="widget" data-widget_type="text-editor.default"><p>And that’s before the hypothetical text-to-video system even starts <i>thinking</i> about what textures, lighting, geometries and other visible factors and facets might suit the scene, or how to generate an apposite accompanying soundtrack (another, almost equally complex database and adjunct model that would need to be developed).</p></div></div></div></div></section><section data-id="b56f0e5" data-element_type="section"><div><div data-id="761f1c3" data-element_type="column"><div><div data-id="08aa9d6" data-element_type="widget" data-widget_type="heading.default"><p><h2>The Business Logistics of Text-To-Video Investment</h2></p></div></div></div></div></section><section data-id="88679ae" data-element_type="section"><div><div data-id="1ac01d8" data-element_type="column"><div><div data-id="f9357e2" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Therefore it’s going to be far more difficult to compile a truly comprehensive and versatile ‘body movement’ equivalent of the <a href="https://laion.ai/blog/laion-5b/"><span>LAION database</span></a> that powers Stable Diffusion, as well as for the academic and private research sectors to develop architectures and protocols that <i>cooperate</i> rather than compete in the race to achieve ‘complete’ deepfake capabilities for VFX and licensed entertainment applications.<span> </span></p><p>It’s one thing to share bare open source architectures on GitHub – quite another to release fully-trained models that cost millions to create, as Stability.ai has done with Stable Diffusion. From the standpoint of market share and general business logic, it’s difficult to say whether such a generous occurrence is likely to ever happen again – and may depend on the extent to which the open-sourcing of Stable Diffusion ultimately undermines OpenAI’s investment in DALL-E 2, and/or brings more financial acumen to Stability.ai than it would likely have achieved by gatekeeping its astounding product behind a commercial API.</p><p>In any case, the earliest such text-to-video system that has gained any ground is the 9-billion parameter transformer-based <a href="https://arxiv.org/pdf/2205.15868.pdf"><span>CogVideo</span></a> architecture, which we covered in our <a href="https://metaphysic.ai/stable-diffusion-is-video-coming-soon/"><span>recent article</span></a> on the future of video in Stable Diffusion, and which launched in May of 2022.<span> </span></p></div></div></div></div></div></section><section data-id="47900ac" data-element_type="section"></section><section data-id="2a80fbf" data-element_type="section"><div><div data-id="2e66ee1" data-element_type="column"><div><div data-id="9df1785" data-element_type="widget" data-widget_type="heading.default"><p><h2>CogVideo Addresses Text-To-Video&#39;s Data Famine</h2></p></div></div></div></div></section><section data-id="936414b" data-element_type="section"><div><div data-id="b2e5734" data-element_type="column"><div><div data-id="ccf5059" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Though CogVideo is the premier text-to-video offering at the moment (and the only way that I am aware of to ‘invent’ fully neural and free-roaming, animated text-to-video humans, without any CGI involvement), the authors observe that it and similar systems are constrained by the cost and logistics of curating and training suitable movement-based datasets – just one factor that means Stable Diffusion fans may need to adjust their current expectations about hyper-realistic text-to-video a little.</p><p>As <a href="https://analyticsindiamag.com/after-text-to-image-now-its-text-to-video/"><span>noted</span></a> elsewhere, the largest current multilingual video description dataset (the movie clips need to be annotated with text descriptions, so that they have <a href="https://ml.berkeley.edu/blog/posts/vq-vae/"><span>semantic meaning</span></a>, a task which OpenAI’s <a href="https://openai.com/blog/clip/"><span>CLIP</span></a> <a href="https://the-decoder.com/new-clip-model-aims-to-make-stable-diffusion-even-better/"><span>performs</span></a> in Stable Diffusion’s architecture) is <a href="https://eric-xw.github.io/vatex-website/"><span>VATEX</span></a>,<span>  </span>which contains a mere 41,250 videos supported by 825,000 captions.<span> </span></p><p>Effectively this means that a task at least ten times more difficult to achieve than Stable Diffusion’s generative power currently has at its disposal far less than a tenth of the necessary data.</p><p>To address this, CogVideo has adapted <a href="https://github.com/THUDM/CogView2"><span>CogView 2</span></a>, a Chinese <i>static</i> generative art transformer, to the task of text-to-video, and the resultant CogVideo dataset contains 5.4 million text/video pairings – still arguably scant data for the enormity of the task.<span> </span></p></div></div></div></div></div></section><section data-id="0e253ac" data-element_type="section"></section><section data-id="bf7e47f" data-element_type="section"><div><div data-id="f4cbf40" data-element_type="column"><div><div data-id="88e0ba0" data-element_type="widget" data-widget_type="text-editor.default"><div><p>However, if I seem a little dubious regarding the enormity of the challenges in creating a really good text-to-video framework without FAANG-level resources (with the inevitable ensuing commercialization and gate-keeping of the final product), my pessimism is not shared by Wenyi Hong, one of CogVideo’s equally-contributing authors, with whom I recently had a chance to speak.<span> </span></p><p>“I think it is not as expensive as you have indicated,” Hong told me<span><sup>†</sup></span>.<span> </span></p><p>Though she concedes that a temporal video synthesis system equivalent to the generative power of Stable Diffusion or DALL-E 2 could possibly be perhaps five or ten times more costly to develop and train, she indicates that initial viral video synthesis clips are likely to be quite short, and to require less exorbitant resources.</p><p>Hong and her colleagues are developing CogVideo integration for a social media platform, and the earliest and widest dissemination of CogVideo output seems likely to come in the form of short videos lasting some seconds, which users might share, and which would not require hyperscale resources from the outset.</p><p>“It’s OK to use a dataset much smaller than LAION,” she says. “to train a video model like CogVideo, which normally generates videos lasting for several seconds. However, if we want to generate much more complicated videos, datasets of larger scale are needed.”</p><p>Hong believes that, as with much of the entire machine learning research sector, the logistics of annotating videos and the availability of GPU memory (VRAM) represent the core challenges:</p><p><i>“If we want to generate videos of high resolution, we have to trade off between the resolution, the frame-rate and the video’s length. This is the biggest problem. We can generate video of any length if we have enough resources, enough memory.<span> </span></i></p><p><i>“But there are also some problems that can crop up if the captions and video are not very closely related, or not extensive enough, or granular enough.<span> </span></i></p><p><i>“Most captions would describe only one action in a video, like ‘a person is holding a cup’. But if the video is very long, maybe a minute, the person won’t hold the object for that long. Maybe they would put it down, or would start doing something else. The need to accommodate that level of complexity will make the whole training process difficult.</i></p><p><i>“However, we have already open-sourced CogVideo on GitHub, and I will try to develop an API where people can input their own sentences. For this, we’re collaborating with Hugging Face, who’ve already created APIs for us.”</i></p><p>So it could transpire that the solution to the development of effective, powerful and <i>purely neural</i> text-to-video systems will be enabled by global participation, and perhaps by federated learning, in some implementation of SETI-style home-folding, now that Ethereum’s <a href="https://decrypt.co/resources/what-merge-ethereum-move-proof-stake"><span>move to proof-of-stake</span></a> promises to <a href="https://seekingalpha.com/article/4541459-nvidia-ethereum-merge-unleashes-tsunami-of-used-graphics-cards"><span>free up</span></a> GPU capacity and <a href="https://www.thegamer.com/ethereum-proof-of-stake-cheap-gpus/"><span>availability</span></a> all over the world.<span> </span></p><p>If we want text-to-video as badly as we seem to, such a system might be eagerly adopted by the growing army of image and video synthesis enthusiasts.</p><p>When I asked Wenyi how far we might be from a neural system that can effectively parse a script or a book into a movie, she responded: “Well, maybe ten to twenty years.”</p></div></div></div></div></div></section><section data-id="06a31e3" data-element_type="section"><div><div data-id="cac7281" data-element_type="column"><div><div data-id="e103e12" data-element_type="widget" data-widget_type="heading.default"><p><h2>Beyond Stylized Transitions in Stable Diffusion Video</h2></p></div></div></div></div></section><section data-id="f390200" data-element_type="section"><div><div data-id="323511f" data-element_type="column"><div><div data-id="6e5283a" data-element_type="widget" data-widget_type="text-editor.default"><div><p>However, because Stable Diffusion is so powerful, and makes it so easy for anyone now to create amazing images; and because it <a href="https://arstechnica.com/information-technology/2022/09/with-stable-diffusion-you-may-never-believe-what-you-see-online-again/"><span>captured the public imagination</span></a> with only a small amount of warning from OpenAI’s earlier and far more ‘locked-down’ DALL-E 2 product, there is a growing public expectation that text-prompted, hyper-realistic video, open to all and running at longer than just a few seconds, is likely to hit sooner than a decade or two.<span> </span></p><p>In fact, AI VFX company Runway, a participant in the development of Stable Diffusion, is <a href="https://twitter.com/runwayml/status/1568220303808991232"><span>currently teasing</span></a> the forthcoming release of a similar, prompt-powered video creation system.</p></div></div></div></div></div></section><section data-id="cac23e8" data-element_type="section"><div><div data-id="63c8cf6" data-element_type="column"><div><div data-id="889c06b" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="542" height="318" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/runway_text-to-video.gif" alt=""/><figcaption>Runway&#39;s teaser for its text-to-video system previews some impressive functionality, but the only people in it appear to be from real source footage, and what remains to be seen is the extent to which neural humans may or may not feature in the system. Source: https://twitter.com/runwayml/status/1568220303808991232</figcaption></figure></div></div></div></div></div></section><section data-id="5c98a67" data-element_type="section"><div><div data-id="643ef18" data-element_type="column"><div><div data-id="e87cce6" data-element_type="widget" data-widget_type="text-editor.default"><div><p>What’s missing from the AI elements of the Runway teaser (and from any mature and usable current product) is <i>people</i> – the domain that we know most about, and the most challenging possible study for AI-based image and video synthesis: <i>whole</i>, walking, acting, interacting, running, tripping up, lying down, standing up, swimming, kissing, punching, slouching, laughing, crying, jumping, posing, talking <i>people</i>.</p><p>Though Stable Diffusion can generate static people and humanoid creatures very convincingly, and even photorealistically, most of the videos that are emerging from the frantic efforts of the SD community are either <a href="https://old.reddit.com/r/StableDiffusion/comments/xj0ti9/hollywood_ending_beforeafter_of_the_video_init/"><span>stylized</span></a> (i.e. cartoon-like, often via <a href="https://old.reddit.com/r/StableDiffusion/comments/xboy90/a_better_way_of_doing_img2img_by_finding_the/"><span>inverting</span></a> the noise-based pipeline in Stable Diffusion), ‘psychedelic’ (often done with <a href="https://www.patreon.com/posts/71681839"><span>Stable WarpFusion</span></a> or <a href="https://replicate.com/deforum/deforum_stable_diffusion"><span>Deforum</span></a>), or display very <a href="https://www.youtube.com/watch?v=CBgguAtH6qM"><span>limited movement</span></a> (often done with EbSynth, which we’ll shortly examine).</p></div></div></div></div></div></section><section data-id="163515d" data-element_type="section"><div><div data-id="48995fb" data-element_type="column"><div><div data-id="bcae733" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="662" height="549" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/trippy_videos-2.gif" alt=""/><figcaption>Some of the more stylized or even trippy implementations of movement in Stable Diffusion. Sources (clockwise): https://www.youtube.com/watch?v=pkEQAKmDMa8 | https://old.reddit.com/r/StableDiffusion/comments/xeuuef/dance_like_no_one_is_watching/ | https://www.youtube.com/watch?v=_MDsKJYqaoY |  https://old.reddit.com/r/StableDiffusion/comments/xev31d/stable_diffusion_experiment_ai_img2img_julie/</figcaption></figure></div></div></div></div></div></section><section data-id="0add675" data-element_type="section"><div><div data-id="a6f041f" data-element_type="column"><div><div data-id="5f5dd32" data-element_type="widget" data-widget_type="text-editor.default"><p>As we’ll see, using EbSynth to animate Stable Diffusion output can produce much more realistic images; however, there are implicit limitations in both Stable Diffusion and EbSynth that curtail the ability of any realistic human (or humanoid) creatures to move about very much – which can too easily put such simulations in the limited class of <i>‘let’s animate that static head a little bit’</i> that typifies the output of <a href="https://www.myheritage.com/deep-nostalgia"><span>DeepNostalgia</span></a>, and a huge raft of scientific attempts over the last 4-5 years to give ‘limited life’ to static human representations:</p></div></div></div></div></section><section data-id="5ab1297" data-element_type="section"><div><div data-id="408d6f7" data-element_type="column"><div><div data-id="215549a" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="521" height="489" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/talking_heads-2.gif" alt="talking_heads"/><figcaption>Some of the GAN-based approaches that can give constrained movement and limited vivacity to human faces. Sources, clockwise: https://www.youtube.com/watch?v=uoftpl3Bj6w  |  https://www.myheritage.com/deep-nostalgia | https://studios.disneyresearch.com/2021/11/30/rendering-with-style-combining-traditional-and-neural-approaches-for-high-quality-face-rendering/</figcaption></figure></div></div></div></div></div></section><section data-id="cd5987a" data-element_type="section"><div><div data-id="1e12b40" data-element_type="column"><div><div data-id="8093451" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Many of these systems rely on interpreting existing, real-world human movement, and using that motion information to power transformations, rather than relying on a database of distilled knowledge about human movement, as CogVideo does.</p><p>For instance, for the Connelly/Cavill full-body deepfakes featured earlier, I used the <a href="https://github.com/CompVis/stable-diffusion/blob/main/scripts/img2img.py"><span>Img2Img</span></a> function of Stable Diffusion to transform footage that I took of a performer into the two personalities. With Img2Img, you provide Stable Diffusion with a source image (anything from a crude sketch to a regular photo), and also provide a text-prompt that suggests to the system the way in which it should alter the image (such as <i>‘Jennifer Connelly in the 1990s’</i>, or <i>‘Henry Cavill, bare-chested</i>).</p></div></div></div></div></div></section><section data-id="840a274" data-element_type="section"><div><div data-id="266075e" data-element_type="column"><div><div data-id="7a19a0c" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1200" height="660" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/cavill-transform.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/cavill-transform.jpg 1200w, https://metaphysic.ai/wp-content/uploads/2022/09/cavill-transform-300x165.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/cavill-transform-1024x563.jpg 1024w, https://metaphysic.ai/wp-content/uploads/2022/09/cavill-transform-768x422.jpg 768w" sizes="(max-width: 1200px) 100vw, 1200px"/><figcaption>A source picture and some text instructions (with negative instructions in the box below) lead to a fairly accurate Img2Img transformation of a woman into the actor Henry Cavill, in the highly popular AUTOMATIC1111 distribution of Stable Diffusion.</figcaption></figure></div></div></div></div></div></section><section data-id="5a18732" data-element_type="section"><div><div data-id="c3944e4" data-element_type="column"><div><div data-id="b2647be" data-element_type="widget" data-widget_type="text-editor.default"><div><p>As with autoencoder-based deepfakes (i.e., the open source system that has been used for making viral deepfake videos for the last five years), it is a lot easier for the machine learning system to effect a transformation when the source and the target have more in common – for instance, in the above image, Henry Cavill has his hands in his pockets, which does not exactly reflect the source pose.<span> </span></p><p>By contrast, the image below shows that Stable Diffusion can transform the yoga woman source picture into a more accurately-posed approximation of Jennifer Connelly:</p></div></div></div></div></div></section><section data-id="f046a87" data-element_type="section"><div><div data-id="f0b23bf" data-element_type="column"><div><div data-id="1b4982a" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1200" height="581" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/connelly_transform.jpg" alt="connelly_transform" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/connelly_transform.jpg 1200w, https://metaphysic.ai/wp-content/uploads/2022/09/connelly_transform-300x145.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/connelly_transform-1024x496.jpg 1024w, https://metaphysic.ai/wp-content/uploads/2022/09/connelly_transform-768x372.jpg 768w" sizes="(max-width: 1200px) 100vw, 1200px"/><figcaption>Even with lower settings, Stable Diffusion has a far easier time transforming the woman in the source picture into another woman, rather than a man – in this case, a representation of actress Jennifer Connelly as she appeared in the late 1990s.</figcaption></figure></div></div></div></div></div></section><section data-id="d23d18c" data-element_type="section"><div><div data-id="8e39cd2" data-element_type="column"><div><div data-id="fda2516" data-element_type="widget" data-widget_type="heading.default"><p><h2>Controlling &#39;Power&#39; and &#39;Restraint&#39; in Stable Diffusion</h2></p></div></div></div></div></section><section data-id="db45a9b" data-element_type="section"><div><div data-id="42e22e9" data-element_type="column"><div><div data-id="226d8ec" data-element_type="widget" data-widget_type="text-editor.default"><p>The two defining forces in a Stable Diffusion transformation are <a href="https://www.youtube.com/watch?v=nbH85I3iRow"><span><i>CFG scale</i></span></a> and <i>Denoising Strength</i>.<span> </span></p></div></div></div></div></section><section data-id="63d44c5" data-element_type="section"><div><div data-id="d46c784" data-element_type="column"><div><div data-id="b6828b6" data-element_type="widget" data-widget_type="image.default"><p><img width="817" height="178" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/cfg-scale-and-denoising-strength.jpg" alt="cfg-scale-and-denoising-strength" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/cfg-scale-and-denoising-strength.jpg 817w, https://metaphysic.ai/wp-content/uploads/2022/09/cfg-scale-and-denoising-strength-300x65.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/cfg-scale-and-denoising-strength-768x167.jpg 768w" sizes="(max-width: 817px) 100vw, 817px"/></p></div></div></div></div></section><section data-id="081eab2" data-element_type="section"><div><div data-id="4989dea" data-element_type="column"><div><div data-id="3190a02" data-element_type="widget" data-widget_type="text-editor.default"><div><p>CFG stands for <a href="https://arxiv.org/pdf/2207.12598.pdf"><span>classifier free guidance</span></a>. The higher you set this scale, the more strictly the system is instructed to follow the instructions in your prompt, even though that can lead to artifacts and other visual anomalies.<span> </span></p><p>In many cases, the LAION dataset on which the model was trained is so authoritative that even short and simple adjunct Img2Img instructions can lead to effective results, removing the need to turn this setting up very high.</p><p>But if you’re trying to make something happen that Stable Diffusion has <i>no prior knowledge of</i>; subtract something from the output which is challenging to isolate in the source image you provided; or to conjoin things, people or concepts that are very difficult to assemble coherently; then you may have to turn up either the CFG scale or the Denoising Strength, which will force Stable Diffusion to act more ‘imaginatively’ – though usually at the cost of some aspect of image quality.</p><p>For instance, though Stable Diffusion can turn a slender woman into a well-generalized muscular man such as Henry Cavill, it has <i>extraordinary</i> difficulty simply changing the color of a dress (part of Stable Diffusion’s general issues with clothing, which we’ll look at later).</p></div></div></div></div></div></section><section data-id="ec225cb" data-element_type="section"><div><div data-id="be06b78" data-element_type="column"><div><div data-id="3087976" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1200" height="574" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/red-evening-dress.jpg" alt="red-evening-dress" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/red-evening-dress.jpg 1200w, https://metaphysic.ai/wp-content/uploads/2022/09/red-evening-dress-300x144.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/red-evening-dress-1024x490.jpg 1024w, https://metaphysic.ai/wp-content/uploads/2022/09/red-evening-dress-768x367.jpg 768w" sizes="(max-width: 1200px) 100vw, 1200px"/><figcaption>Even with CFG at an above-average 13.5 and Denoising Strength at a racy 0.58, and even with &#39;red&#39; as a banned (negative) word, the dress will not change color.</figcaption></figure></div></div></div></div></div></section><section data-id="6bf53ae" data-element_type="section"><div><div data-id="e3edad8" data-element_type="column"><div><div data-id="7c84a81" data-element_type="widget" data-widget_type="text-editor.default"><div><p>In one experiment, I attempted to change the color of the dress that the female performer was wearing in the source shoots, intended for a Stable Diffusion transformation to the actress Salma Hayek.<span> </span></p><p>However, I found that no combination of settings, plugins or other chicanery could accomplish this apparently more minor task. In the end, it was necessary to set both CFG and Denoising almost to maximum settings before Stable Diffusion would transform the dress color – and in the process, 90-95% of the transformation’s pose fidelity, style and coherence was lost:</p></div></div></div></div></div></section><section data-id="a0d1fe7" data-element_type="section"></section><section data-id="6caa4d5" data-element_type="section"><div><div data-id="e9caa61" data-element_type="column"><div><div data-id="1d8416d" data-element_type="widget" data-widget_type="text-editor.default"><div><p>In general, similar to the way that traditional autoencoder deepfakes tend to use hosts that resemble the identity they want to impose, it’s often easier to use source material that’s at least a little closer to what you ultimately want to render (i.e. ask your performer to just wear a red dress in the first place).<span> </span></p><p>Though there is at least one <a href="https://github.com/ThereforeGames/txt2mask"><span>supplementary script</span></a> that can use CLIP to recognize, mask and change a specific element, such as an item of clothing, it’s too inconsistent to generate temporally coherent video for full-body deepfakes.</p></div></div></div></div></div></section><section data-id="bb07b9c" data-element_type="section"><div><div data-id="0190f5c" data-element_type="column"><div><div data-id="0a58a4a" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1657" height="766" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask.jpg 1657w, https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask-300x139.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask-1024x473.jpg 1024w, https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask-768x355.jpg 768w, https://metaphysic.ai/wp-content/uploads/2022/09/txt2mask-1536x710.jpg 1536w" sizes="(max-width: 1657px) 100vw, 1657px"/><figcaption>The Txt2Mask addon for Stable Diffusion can isolate and change clothing, but, characteristic of many of Stable Diffusion&#39;s most &#39;bleeding edge&#39; features, it&#39;s currently a hit-and-miss affair. Source: https://github.com/ThereforeGames/txt2mask</figcaption></figure></div></div></div></div></div></section><section data-id="f751106" data-element_type="section"><div><div data-id="8d1cafa" data-element_type="column"><div><div data-id="9590cb9" data-element_type="widget" data-widget_type="heading.default"><p><h2>Fashion Chaos in Stable Diffusion</h2></p></div></div></div></div></section><section data-id="8265715" data-element_type="section"><div><div data-id="5645d73" data-element_type="column"><div><div data-id="470af0c" data-element_type="widget" data-widget_type="text-editor.default"><div><p>In case you’re wondering why there’s so much bare skin in some of these examples, it’s not least because Stable Diffusion has additional issues with clothes and body adornment.<span> </span></p><p>Surprisingly, there is very little ‘famous clothing’ that has become so resolutely generalized into the LAION-based Stable Diffusion model that you can rely on it to appear, consistently, across a series of sequential rendered frames.<span> </span></p><p>Even Levi 501 jeans (of which there are <a href="https://rom1504.github.io/clip-retrieval/?back=https://knn5.laion.ai&amp;index=laion5B&amp;useMclip=false&amp;query=Levi+501+jeans"><span>numerous examples</span></a> in the LAION database), which were <a href="https://nypost.com/2020/08/21/do-you-own-any-of-the-most-iconic-items-in-fashion-history-list/"><span>voted</span></a> in 2020 as the most iconic item of clothing of all time, can’t be depended on to render consistently for an Img2Img full-body deepfake sequence in Stable Diffusion.</p></div></div></div></div></div></section><section data-id="76b5e81" data-element_type="section"><div><div data-id="321380c" data-element_type="column"><div><div data-id="9c1dfaf" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="384" height="400" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/levi_101_jeans.gif" alt="levi_101_jeans"/><figcaption> In terms of temporal coherence, and with a fixed seed (i.e., Stable Diffusion will not &#39;randomize&#39; how it represents the jeans, but will stick to the settings of a good render that you chose earlier) the most recognizable item of clothing in the world performs way above average – but there are still random rips and glitches.</figcaption></figure></div></div></div></div></div></section><section data-id="28da8ce" data-element_type="section"><div><div data-id="d6ec847" data-element_type="column"><div><div data-id="4bc98e2" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Jennifer Connelly’s face and body? Fine – LAION-trained Stable Diffusion has assimilated nearly forty years of pictures of Connelly – event pictures, paparazzi beach grabs, publicity stills, extracted video frames, and many other sources that have enabled the system to generalize the actress’s core identity, face and physique across a range of ages.<span> </span></p><p>To boot, Connelly’s hair styling is relatively consistent over the years, which is not always the case with women (because of fashion and aging) or men (because of fashion, ageing, and male pattern baldness).</p></div></div></div></div></div></section><section data-id="f2e3f1e" data-element_type="section"><div><div data-id="8b12fbb" data-element_type="column"><div><div data-id="b0b6846" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="176" height="210" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/margot-robbie-changing-hair.gif" alt=""/><figcaption>Despite only fairly recent stardom, Stable Diffusion has internalized a wide range of hairstyles for actress Margot Robbie, many of which can be quite resistant to prompt-based attempts to stabilize them for purposes of coherent temporal video.</figcaption></figure></div></div></div></div></div></section><section data-id="b06f297" data-element_type="section"><div><div data-id="88aa738" data-element_type="column"><div><div data-id="30c2dd2" data-element_type="widget" data-widget_type="text-editor.default"><p>However, not least because of the sheer volume of material in the database, Connelly is wearing something different in nearly all of her LAION photos:</p></div></div></div></div></section><section data-id="3bd19d9" data-element_type="section"><div><div data-id="8be3d5d" data-element_type="column"><div><div data-id="4a47d8c" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1000" height="563" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/LAION_connelly.jpg" alt="LAION_connelly" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/LAION_connelly.jpg 1000w, https://metaphysic.ai/wp-content/uploads/2022/09/LAION_connelly-300x169.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/LAION_connelly-768x432.jpg 768w" sizes="(max-width: 1000px) 100vw, 1000px"/><figcaption> A diversity of sartorial choices for Jennifer Connelly over the years, as represented in the LAION database, and subsequently trained into Stable Diffusion. Source: https://rom1504.github.io/clip-retrieval/?index=laion5B&amp;useMclip=false&amp;query=jennifer+connelly</figcaption></figure></div></div></div></div></div></section><section data-id="9daf862" data-element_type="section"><div><div data-id="0c52576" data-element_type="column"><div><div data-id="49c09e7" data-element_type="widget" data-widget_type="text-editor.default"><p>So if you ask Stable Diffusion for a picture of <i>‘Jennifer Connelly’</i>, does it choose a particular outfit that’s above-averagely represented in her stable of LAION pictures? Might it generalize every single outfit she wears in LAION into something ‘representatively generic’? Does it pick from a range of outfits with the highest <a href="https://laion.ai/blog/laion-aesthetics/"><span>LAION aesthetic score</span></a>? And to what extent will the prompt itself affect the choice or continuity of the clothing that gets depicted in a range of rendered frames?</p></div></div></div></div></section><section data-id="2077bed" data-element_type="section"><div><div data-id="58ef964" data-element_type="column"><div><div data-id="09d001c" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1154" height="774" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/range-of-clothes.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/range-of-clothes.jpg 1154w, https://metaphysic.ai/wp-content/uploads/2022/09/range-of-clothes-300x201.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/range-of-clothes-1024x687.jpg 1024w, https://metaphysic.ai/wp-content/uploads/2022/09/range-of-clothes-768x515.jpg 768w" sizes="(max-width: 1154px) 100vw, 1154px"/><figcaption>Diverse renders from Stable Diffusion prompts related to &#39;Jennifer Connelly&#39;, show a largely random range of attire.</figcaption></figure></div></div></div></div></div></section><section data-id="eebf1be" data-element_type="section"><div><div data-id="26215f8" data-element_type="column"><div><div data-id="39cc642" data-element_type="widget" data-widget_type="text-editor.default"><p>Stable Diffusion was only released to open source little more than a month ago, and these are among the many questions that are yet to be answered; but in practice, even with a <i>fixed seed</i> (which we’ll look at in a moment), it’s hard to obtain temporally consistent clothing in full-body deepfake video derived from a latent diffusion model such as Stable Diffusion or DALL-E 2 – unless the clothing in question is distinct, unchanging over the years, and already well-represented in the model’s training database.</p></div></div></div></div></section><section data-id="96a7e0f" data-element_type="section"><div><div data-id="9592c8f" data-element_type="column"><div><div data-id="c6d29db" data-element_type="widget" data-widget_type="heading.default"><p><h2>Potential Full-Body Deepfake Consistency Through Textual Inversion</h2></p></div></div></div></div></section><section data-id="f3ac4ae" data-element_type="section"><div><div data-id="56a5bd4" data-element_type="column"><div><div data-id="070e9ee" data-element_type="widget" data-widget_type="text-editor.default"><div><p>One solution for consistent clothing in this scenario could be the use of <a href="https://arxiv.org/pdf/2208.01618.pdf"><span>Textual Inversion</span></a> models – small scraps of adjunct code that encapsulate the look and semantic meaning of a custom object, person or entity, via the short training of a limited number of annotated photos.</p><p>Textual inversions can be created by users and placed ‘adjacent’ to the standard trained model at inference time, and can effectively act as if they had originally been trained into the system.<span> </span></p><p>In this way, in theory, it would be possible to summon up a pair of Levi 501s (or a specific hairstyle) with a consistent enough appearance to support temporal video; and also to create truly ‘stable’ models of more obscure items of clothing.</p><p>If this became an established solution, it would be a little like the early heyday of the Renderosity marketplace, where users still trade or sell outfits and ‘mods’ for the CGI-based virtual humans in <a href="https://www.youtube.com/watch?v=Cr4V4-oAO9M"><span>Poser</span></a> and <a href="https://www.youtube.com/watch?v=VzLCge1hW6U"><span>Daz 3D</span></a>.</p><p>Ultimately, Textual Inversion might represent the only rational way to gain temporal consistency for objects in Stable Diffusion, and to easily insert ‘unknown’ people into the system, for the purpose of creating full-body deepfakes via a latent diffusion system. Some Reddit users are <a href="https://old.reddit.com/r/StableDiffusion/comments/x9uol8/adding_new_objects_to_the_model_added_my_face_so/?sort=old"><span>currently</span></a> <a href="https://old.reddit.com/r/StableDiffusion/comments/xjl49b/i_used_textual_inversion_with_stabledifussion_to/"><span>putting</span></a> themselves (and some more obscure public figures) into Stable Diffusion via this route:</p></div></div></div></div></div></section><section data-id="6d03859" data-element_type="section"><div><div data-id="a190c30" data-element_type="column"><div><div data-id="dee631d" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1022" height="1032" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture.jpg 1022w, https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture-297x300.jpg 297w, https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture-1014x1024.jpg 1014w, https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture-150x150.jpg 150w, https://metaphysic.ai/wp-content/uploads/2022/09/textual-inversion-put-yourself-in-the-picture-768x776.jpg 768w" sizes="(max-width: 1022px) 100vw, 1022px"/><figcaption>None of these people are in your copy of Stable Diffusion, either at all, or at this resolution - but rather have been added by enthusiasts using Textual Inversion. The top images are self-portraits of Reddit user &#39;Dalle2Pictures&#39;, who, despite his username, in this case used Textual Inversion with Stable Diffusion; the middle row is another Reddit user, sEi_, who likewise used Textual Inversion to insert his own likeness into the system; the bottom row are Stable Diffusion renders of Former United States Representative Tulsi Gabbard, not featured at this level of detail in a standard Stable Diffusion distribution; in this case Reddit user Visual-Ad-8655 reportedly took just two hours to generate a Textual Inversion for Gabbard. Sources, top to bottom: https://old.reddit.com/r/StableDiffusion/comments/xjl49b/i_used_textual_inversion_with_stabledifussion_to/ | https://old.reddit.com/r/StableDiffusion/comments/x9uol8/adding_new_objects_to_the_model_added_my_face_so/ | https://old.reddit.com/r/StableDiffusion/comments/xdl48y/textual_inversion_test_of_tulsi_gabbard/</figcaption></figure></div></div></div></div></div></section><section data-id="41660bf" data-element_type="section"><div><div data-id="a569ee2" data-element_type="column"><div><div data-id="f7a534e" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Though the creation process currently has high hardware demands, users can create custom Textual Inversion files via web-based <a href="https://colab.research.google.com/github/huggingface/notebooks/blob/main/diffusers/sd_textual_inversion_training.ipynb"><span>Google Colabs</span></a> and Hugging Face APIs.<span> </span></p><p>Additionally, the rapid pace of development and optimization in the Stable Diffusion developer community means that it might become easier to put yourself (or any celebrity that’s absent or under-represented in LAION) into the world of Stable Diffusion via a local, consumer-level video card.</p><p><i>(For more about Textual Inversion, check out our </i><a href="https://metaphysic.ai/stable-diffusion-is-video-coming-soon/"><span><i>August feature</i></span></a><i> on the future of ‘general’ video synthesis in Stable Diffusion).</i></p></div></div></div></div></div></section><section data-id="82fff6e" data-element_type="section"><div><div data-id="ccfe847" data-element_type="column"><div><div data-id="b491e4a" data-element_type="widget" data-widget_type="heading.default"><p><h2>Full-Body Video Deepfakes with Stable Diffusion and EbSynth</h2></p></div></div></div></div></section><section data-id="d1ba536" data-element_type="section"><div><div data-id="2987784" data-element_type="column"><div><div data-id="26aa6ab" data-element_type="widget" data-widget_type="text-editor.default"><div><p>To create the Jennifer Connelly and Henry Cavill Stable Diffusion-based full-body deepfakes shown at the start of the article, I took a brief section of footage from a custom filming session with a performer, and extracted the short video into its constituent frames.<span> </span></p><p>As is clear from the clip, the same brief footage is used for both transformations.</p><p>I then made some tests of some of the original source frames, and eventually found one combination of settings (in this example, for Jennifer Connelly), that seemed to produce a good result.</p></div></div></div></div></div></section><section data-id="6890e4b" data-element_type="section"><div><div data-id="431733b" data-element_type="column"><div><div data-id="1415e66" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="1000" height="640" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/seed-choosing.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/seed-choosing.jpg 1000w, https://metaphysic.ai/wp-content/uploads/2022/09/seed-choosing-300x192.jpg 300w, https://metaphysic.ai/wp-content/uploads/2022/09/seed-choosing-768x492.jpg 768w" sizes="(max-width: 1000px) 100vw, 1000px"/><figcaption>Settings that more or less worked to effect a transformation from the real-world model into the target personality.</figcaption></figure></div></div></div></div></div></section><section data-id="89ac317" data-element_type="section"><div><div data-id="e023fc2" data-element_type="column"><div><div data-id="08c6a74" data-element_type="widget" data-widget_type="text-editor.default"><div><p>We’ve already seen how ‘random’ Stable Diffusion’s interpretations of an Img2Img text prompt can be. In fact, in order to produce novel and diverse results, the system filters the text prompt through a <a href="https://opendatascience.com/properly-setting-the-random-seed-in-ml-experiments-not-as-simple-as-you-might-imagine/"><span>random seed</span></a> for each individual image generation – a single, unique route through the latent space of Stable Diffusion, represented by a hash number. Without this functionality, it would be difficult to explore the potential of the software, or generate variations on a prompt.</p><p>All distributions of Stable Diffusion let you ‘freeze’ this seed, if you find one that really works well – and this ability is absolutely essential for any hope of temporal coherence when working with a contiguous sequence of images, as in this scenario.</p><p>However, if the subject moves around a lot in the video, the seed, which operated so effectively on a single frame, is not likely to work as well on frames that are a little different:<span> </span></p></div></div></div></div></div></section><section data-id="e51baa3" data-element_type="section"><div><div data-id="c7bb5eb" data-element_type="column"><div><div data-id="1878668" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="512" height="677" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/cavill-seed-2.gif" alt="cavill-seed"/><figcaption>The seed that produced the first image transformation proved very effective, and was chosen as the &#39;fixed seed&#39; for the entire sequence. But it&#39;s not as applicable to the second image, which is also part of the video sequence. Here the difference in quality is exaggerated for illustrative purposes – though it can be even worse, depending on how &#39;mobile&#39; the performer is in the clip.</figcaption></figure></div></div></div></div></div></section><section data-id="7a8b20d" data-element_type="section"><div><div data-id="bc4a9e5" data-element_type="column"><div><div data-id="27fe33c" data-element_type="widget" data-widget_type="text-editor.default"><div><p>As I write, a <a href="https://github.com/yownas/seed_trave"><span>new Stable Diffusion script</span></a> has been developed that can ostensibly ‘morph’ between two optimal seeds in a rendered sequence. Though such a solution wouldn’t solve all the problems of ‘seed shift’, it could allow performers to move about a bit more in Stable Diffusion/EbSynth transformations, as most ‘photorealistic’ examples of SD/EbSynth video clips at the moment are characterised by very limited character movement.</p><p>Returning to the celebrity transformations: enter the aforementioned EbSynth – an innovative, obscure, and scantly-documented non-AI application that was originally designed to <a href="https://www.youtube.com/watch?v=0RLtHuu5jV4"><span>apply painterly styles</span></a> to short video clips, but which is gaining popularity as a ‘tweening’ tool for videos that use Stable Diffusion output.</p></div></div></div></div></div></section><section data-id="2a28c79" data-element_type="section"><div><div data-id="8b05d5a" data-element_type="column"><div><div data-id="082d638" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="704" height="847" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/ebsynth_interface.jpg" alt="" data-srcset="https://metaphysic.ai/wp-content/uploads/2022/09/ebsynth_interface.jpg 704w, https://metaphysic.ai/wp-content/uploads/2022/09/ebsynth_interface-249x300.jpg 249w" sizes="(max-width: 704px) 100vw, 704px"/><figcaption>EbSynth in action.</figcaption></figure></div></div></div></div></div></section><section data-id="aff747b" data-element_type="section"><div><div data-id="1d82165" data-element_type="column"><div><div data-id="67347d7" data-element_type="widget" data-widget_type="text-editor.default"><p>To give some idea of the increased smoothness that EbSynth can offer a full-body Stable Diffusion deepfake, compare the original, raw Jennifer Connelly transforms produced by Stable Diffusion, on the left of the video below, to the EbSynth version on the right. A smoother video has been created by EbSynth, by ‘morphing’ between a handful of carefully-selected keyframes, and using only these (24 is apparently the maximum allowed per clip) to recreate the full, though inevitably short runtime of the video:</p></div></div></div></div></section><section data-id="ce0eff9" data-element_type="section"></section><section data-id="ff30d4f" data-element_type="section"><div><div data-id="3dfcf28" data-element_type="column"><div><div data-id="a785f4c" data-element_type="widget" data-widget_type="text-editor.default"><p><i>On the left, the raw output from Stable Diffusion ‘sizzles’, because even with a fixed seed, temporal consistency is hard to achieve by just gluing the raw output frames together. On the right, we see better temporal consistency obtained by EbSynth, which has converted a mere 24 frames (out of the original 200 frames in the clip) into a smoother reconstruction. To improve the facial quality of the final video on the right, a publicly-shared autoencoder was used – though in fact better results can be obtained by zooming in on the face and re-rendering it entirely in Stable Diffusion (a process which is currently rather more time-consuming).</i></p></div></div></div></div></section><section data-id="3dcd75c" data-element_type="section"><div><div data-id="e414992" data-element_type="column"><div><div data-id="2b1e163" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Despite its brilliance, EbSynth is a frustrating tool to use for this purpose, due to a number of confounding interface quirks, the lack of cohesive or centralized documentation, a minimal and restrictive <a href="https://old.reddit.com/r/EbSynth/"><span>Reddit presence</span></a>, and conflicting opinions about what the crucial settings in the application’s ‘advanced’ section actually do, either for the original intent of style transfer, or for this jury-rigged purpose.<span> </span></p><p>Additionally, the very small amount of keyframes you are allowed to set in EbSynth means that a) the clip will probably need to be very short, and b) the person in the clip will probably need to limit any sudden movements, because every additional movement eats up that precious allotment of keyframes.</p><p>As a principle workflow, however, the basic tenets and functionalities of EbSynth could possibly be adapted into new software with greater keyframe capacity, some ability to detect where additional keyframes should be assigned (in EbSynth, you need to curate them quite carefully), and more transparent instrumentality for controlling the interpolation settings.</p></div></div></div></div></div></section><section data-id="6c00ae8" data-element_type="section"><div><div data-id="edee132" data-element_type="column"><div><div data-id="db199a1" data-element_type="widget" data-widget_type="heading.default"><p><h2>Other Routes to Full-Body Deepfakes</h2></p></div></div></div></div></section><section data-id="9074d0b" data-element_type="section"><div><div data-id="c2d6cab" data-element_type="column"><div><div data-id="2c5ae9a" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Besides the tortuous and challenging path to effective CogVideo-style neural text-to-video systems, and these kind of extremely limited ‘hacks’ for temporally coherent Img2Img Stable Diffusion full-body deepfakes, there are certainly other roads forward for extending identity transformation beyond the facial area.</p><p>I have covered most of these alternative methods quite extensively in previous features here at Metaphysic, including each approach’s capacity and potential to generate full-body deepfakes. Therefore I refer you to those features, on <a href="https://metaphysic.ai/future-autoencoder-deepfakes/"><span>The Future of Autoencoder-Based Deepfakes</span></a>; the possibility that Neural Radiance Fields (NeRF) <a href="https://metaphysic.ai/nerf-successor-deepfakes/"><span>might become an eventual successor to autoencoders</span></a>; and <a href="https://metaphysic.ai/the-future-of-generative-adversarial-networks-in-deepfakes/"><span>the future of Generative Adversarial Networks</span></a> (GANs) in regard to deepfakes.</p><p>Nonetheless, let’s briefly review these alternative options.</p></div></div></div></div></div></section><section data-id="2291f4d" data-element_type="section"><div><div data-id="c5e27bc" data-element_type="column"><div><div data-id="61291d6" data-element_type="widget" data-widget_type="heading.default"><p><h3>Neural Radiance Fields (NeRF)</h3></p></div></div></div></div></section><section data-id="74e780c" data-element_type="section"><div><div data-id="c7f19b6" data-element_type="column"><div><div data-id="11aa0ab" data-element_type="widget" data-widget_type="text-editor.default"><div><p>There is no video synthesis technology that deals more extensively with full-body neural representations of people than Neural Radiance Fields. NeRF can recreate temporally-accurate video as well as ‘frozen’, explorable 3D representations, by training images and videos into neural scene and object representations.</p><p>For instance, <a href="https://youngjoongunc.github.io/nhp/"><span>Neural Human Performer</span></a> can perform a style of deepfake puppetry, albeit currently at very low resolution (a limitation common to most NeRF initiatives):</p></div></div></div></div></div></section><section data-id="8d633fd" data-element_type="section"></section><section data-id="f7cb981" data-element_type="section"><div><div data-id="ed6c620" data-element_type="column"><div><div data-id="1b803cc" data-element_type="widget" data-widget_type="text-editor.default"><div><p>As I have mentioned in the previous NeRF article, other projects that deal directly with neural humans in NeRF are numerous, and include <a href="https://arxiv.org/pdf/2104.02607.pdf"><span>MirrorNeRF</span></a>, <a href="https://lemonatsu.github.io/anerf/"><span>A-NeRF</span></a>, <a href="https://zju3dv.github.io/animatable_nerf/"><span>Animatable Neural Radiance Fields</span></a>, <a href="https://arxiv.org/pdf/2106.02019.pdf"><span>Neural Actor</span></a>, <a href="https://arxiv.org/pdf/2201.00791.pdf"><span>DFA-NeRF</span></a>, <a href="https://portrait-nerf.github.io/"><span>Portrait NeRF</span></a>, <a href="https://arxiv.org/pdf/2112.12390.pdf"><span>DD-NeRF</span></a>, <a href="https://arxiv.org/pdf/2110.13746.pdf"><span>H-NeRF</span></a>, and <a href="https://arxiv.org/pdf/2201.01683.pdf"><span>Surface-Aligned Neural Radiance Fields</span></a>. </p><p>A further example of NeRF-based deepfake puppetry is <a href="http://geometrylearning.com/NeRFEditing/"><span>NeRF-Editing</span></a>, which uses Signed Distance Functions/Fields (<a href="https://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/"><span>SDF</span></a>) as an interpretive layer between a human performer (or, in theory, priors taken from a CogVideo-style database) and the usually inaccessible parameters of a NeRF object – or, potentially, a different identity:</p></div></div></div></div></div></section><section data-id="853e127" data-element_type="section"><div><div data-id="5c78bcc" data-element_type="column"><div><div data-id="dfc5f84" data-element_type="widget" data-widget_type="image.default"><div><figure> <img width="515" height="268" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://metaphysic.ai/wp-content/uploads/2022/09/Nerf_Editing-1.gif" alt="Nerf_Editing"/><figcaption>Deepfake puppetry with NeRF-editing. Source: Source: http://geometrylearning.com/NeRFEditing/</figcaption></figure></div></div></div></div></div></section><section data-id="5747b48" data-element_type="section"><div><div data-id="a9c4082" data-element_type="column"><div><div data-id="76e1cac" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Some human synthesis projects are beginning to integrate NeRF into a wider and more complex workflow that includes elements of traditional CGI, such as texturing, including Disney Research’s <a href="https://www.youtube.com/watch?v=GfY--WTmnh4"><span>Morphable Radiance Fields</span></a>, or else are beginning to use NeRF to swap faces rather than render entire bodies. An example of the latter case is <a href="https://shahrukhathar.github.io/2022/06/06/RigNeRF.html"><span>RigNeRF</span></a>, a NeRF-based face-swapping method that offers deepfake puppetry very similar to DeepFaceLive, though it’s not remotely as mature in implementation.</p><p>I could go on all day, because this is a fertile and well-funded strand of video synthesis research. The commercial and academic sectors are very keen to develop neural humans using this technology, while NVIDIA’s <a href="https://developer.nvidia.com/blog/getting-started-with-nvidia-instant-nerfs/"><span>recent foray</span></a> into more efficient NeRF generation has re-invigorated industry interest.</p><p>Nonetheless, NeRF’s challenges and inherent constraints are formidable: Neural Radiance Fields are very difficult to edit, and usually expensive and time-consuming to train, while NeRF-based neural humans are characterized by limited resolution, which tends to undermine the potential of the system to leverage real-world images and videos to create, potentially, the most authentic neural humans possible.</p><p>Nonetheless, as Stable Diffusion has proved, and DALL-E 2 has presaged, quantum leaps in image synthesis technologies tend to take us by surprise, so NeRF may yet improve, at one sweep, its current, struggling position as a practicable method of simulating full-body humans.</p></div></div></div></div></div></section><section data-id="0352e10" data-element_type="section"></section><section data-id="19228b8" data-element_type="section"><div><div data-id="210f5b6" data-element_type="column"><div><div data-id="e02871b" data-element_type="widget" data-widget_type="text-editor.default"><p>Autoencoder-based open source repositories such as <a href="https://github.com/iperov/DeepFaceLab"><span>DeepFaceLab</span></a> and <a href="https://faceswap.dev/"><span>FaceSwap</span></a> (both based on the controversial 2017 code that premiered sensationally on Reddit) are what most of us think of when we hear the term ‘deepfakes’ – models which are trained on thousands of images of celebrities, and which can subsequently impose those learned faces into the central facial area of other people, effectively changing that person’s facial identity.</p></div></div></div></div></section><section data-id="a94a25f" data-element_type="section"></section><section data-id="9860770" data-element_type="section"><div><div data-id="df4b897" data-element_type="column"><div><div data-id="56bdd54" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Autoencoder deepfake systems only swap faces, not bodies. Notwithstanding, there is <a href="https://discord.com/channels/797172242697682985/797172243654115350/900184666680725554"><span>occasional speculation</span></a> among fans and developers that an autoencoder system modeled along the same lines could be devised that uses the kind of full-body motion capture software that can <a href="https://carolineec.github.io/everybody_dance_now/"><span>create deepfaked dancers</span></a>, therefore enabling full-body deepfakes.</p><p>However, even if such a system could be devised, it would face many of the same problems with clothing that Stable Diffusion does when producing temporal deepfake content, making the creation of a usable training dataset practically impossible.</p><p>Unless, of course, clothes don’t enter into the equation, and the putative system were to be trained on images of naked bodies, and intended to produce full-body deepfake porn.<span> </span></p><p>However, whose face would be in those training pictures? If it were a particular celebrity, practically the entire contents of the dataset would need to be synthetic, i.e. Photoshopped; and, after training, the difficulty of finding a ‘body match’ would be effectively doubled. In a best-case scenario, a porn deepfake would now have to be processed <i>twice</i>, with two different frameworks, at double the preliminary effort, and for relatively little gain, compared to what is currently achievable.</p><p>Additionally, truly distinct physiques are relatively rare, and, given the demands and relatively low standards of the deepfake porn community, this kind of effort would arguably qualify as ‘overkill’.</p><p>Taking into consideration those factors, and how improbable it is that any substantial corporate entity would fund such an effort, there seems no obvious road ahead for autoencoders in the production of full-body deepfakes, except as a possible adjunct technology, retaining a focus on face-swapping in the wider context of full-body deepfakes produced by other methods (assuming such methods cannot handle the task at least as well, if not better).</p></div></div></div></div></div></section><section data-id="aeddcf9" data-element_type="section"><div><div data-id="dff6dea" data-element_type="column"><div><div data-id="7e0af30" data-element_type="widget" data-widget_type="heading.default"><p><h3>Generative Adversarial Networks (GANs)</h3></p></div></div></div></div></section><section data-id="9bca47f" data-element_type="section"><div><div data-id="1cf7147" data-element_type="column"><div><div data-id="1332ee8" data-element_type="widget" data-widget_type="text-editor.default"><div><p>The primary use of Generative Adversarial Networks in full-body deepfake initiatives comes in the form of well-funded industry interest in <i>fashion-based</i> body and clothing synthesis – especially in regard to systems that could allow ‘virtual try-ons’, primarily in the women’s clothing market.</p><p>Though projects such as <a href="https://arxiv.org/pdf/2203.07293.pdf"><span>InsetGAN</span></a> and <a href="https://stylegan-human.github.io/"><span>StyleGAN-Human</span></a> (see video below) are keen to develop commercial applications of this nature, the resulting renders are always either static, or nearly-static:</p></div></div></div></div></div></section><section data-id="53bbfb4" data-element_type="section"></section><section data-id="5310df2" data-element_type="section"><div><div data-id="bcd454a" data-element_type="column"><div><div data-id="c8e3a79" data-element_type="widget" data-widget_type="text-editor.default"><div><p>Though GANs have gained public acclaim and notoriety over the past five years for their ability to produce the most realistic faces of any image synthesis system (including DALL-E 2 and Stable Diffusion), a Generative Adversarial Network lacks any temporal architecture or instrumentality that might suit it for the production of full-body deepfakes.<span> </span></p><p>After years of near-fruitless exploration into the possibility of realistically animating faces in the GAN’s latent space via purely neural methods, the research sector, exemplified by Disney Research’s efforts, is increasingly coming to accept that GANs may only be useful as texture generators that are powered by entirely different, often older technologies based around CGI, such as 3D morphable models (3DMM).</p><p>If there is any real ‘race’ to develop effective and versatile full-body deepfakes, Generative Adversarial Networks appear, currently at least, to be stuck at the starting line.</p><p><i>* Though the author is a regular freelance contributor to the Metaphysic blog, he is not an employee of Metaphysic. The original full-body deepfake examples in this feature are the author’s own experiments, and entirely unrelated to the work, technologies and output of Metaphysic.</i></p><p><span><sup>†</sup></span><i> In a Zoom conversation on 10th August 2022.</i></p></div></div></div></div></div></section></div></div></div></div>
  </body>
</html>
