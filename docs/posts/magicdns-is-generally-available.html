<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tailscale.com/blog/magicdns/">Original</a>
    <h1>MagicDNS is generally available</h1>
    
    <div id="readability-page-1" class="page"><div>
      <p><a href="https://tailscale.com/kb/1033/ip-and-dns-addresses/">Tailscale automatically assigns IP addresses</a> for every unique device in your network, giving each device an IP address no matter where it is located. We further improved on this with <a href="https://tailscale.com/kb/1081/magicdns/">MagicDNS</a>, which automatically registers a human-readable, easy-to-remember DNS name for each device —  so you don’t need to use an IP address to access your devices. This means you can access the device <code>monitoring</code>, even if it moves from on-prem to the cloud, without ever needing to know its IP address in the first place.</p>
<p>MagicDNS is <em>such</em> a useful feature that it’s been frustrating for us that not all Tailscale users know about it. We’re surprised that we often get suggestions like, “It would be great if Tailscale could just run a small DNS server for me” — when it already does! So we’re particularly excited to share that as of today, <strong>MagicDNS is generally available, and it’s enabled by default for new tailnets!</strong> (Already a Tailscale user, but not using MagicDNS yet? Click “Enable MagicDNS” in the <a href="https://login.tailscale.com/admin/dns">DNS page</a> of the admin console to get going.)</p>

    
    

<figure>
        <img src="https://tailscale.com/blog/magicdns/magicdns.gif" alt="Animation of enabling MagicDNS and accessing a file server on port 8000 of a device using a human-readable DNS name for a device."/>
    
    <figcaption>
        <p>With MagicDNS enabled, you can access a device with human-readable DNS name.</p>
    </figcaption>
</figure>

<p><strong>If you’re already using MagicDNS, your tailnet has been automatically assigned a new tailnet name of the form <code>tail&lt;hex&gt;.ts.net</code>, in addition to the existing name <code>&lt;domain&gt;.beta.tailscale.net</code></strong>. If you’re sharing nodes with the <code>beta</code> name, we ask you to migrate to the new tailnet name. The existing <code>beta</code> name will be supported until at least November 1, 2023.</p>
<h3 id="magicdns-automatically-creates-a-dns-entry-for-your-device-name">MagicDNS automatically creates a DNS entry for your device name</h3>
<p>“All” MagicDNS does is automatically register a DNS name for every device in your network. With MagicDNS enabled, every device in your tailnet runs its own DNS server, built into the Tailscale client. Then, when you add a new device to your tailnet or modify ACLs, the set of devices the new device can access (known as a <em>netmap</em>) is pushed to your device from the Tailscale coordination server, including registering DNS entries for other devices you can access. If you try to access <code>http://monitoring</code> on your device, it will first check your built-in Tailscale DNS server to see if it’s an address specified by Tailscale. If it is, it will forward the traffic to that device; if it’s not, it will pass the request on to your other DNS servers. This works wherever you’re using the device’s IP address, including in your browser or on the command line. Keeping all of these DNS entries on the device is also great for security and privacy, as unencrypted DNS queries don’t leave your device.</p>
<p>Your device is automatically registered in MagicDNS based on the device name — for example, <code>alices-macbook-pro</code>. If you change your device’s name, the MagicDNS entry will automatically change. If you have a specific machine name you’d like to use to reference your device, then <a href="https://tailscale.com/kb/1098/machine-names/#renaming-a-machine">edit the device’s name in Tailscale</a>, or if you’re scripting servers for easy access, <a href="https://tailscale.com/kb/1080/cli/#up">use <code>tailscale up</code> and pass in the <code>--hostname</code> flag</a>.</p>
<p>To learn more about how MagicDNS works, see <a href="https://tailscale.com/blog/magicdns-why-name">our blog post covering just this</a>.</p>
<h3 id="fixing-a-long-tail-of-dns-bugs">Fixing a long tail of DNS bugs</h3>
<p>We’ve been working heads-down on MagicDNS for several months now. To get to the point where we could call MagicDNS generally available, we had to fix a lot of bugs. (It basically became a rite of passage for new Tailscalars to fix a MagicDNS bug before they could move on to other projects.) We’ve implemented these fixes and improvements in the last several client releases:</p>
<ul>
<li>In <a href="https://tailscale.com/changelog/#2022-01-12-client">v1.20</a>, we removed Android’s dependency on fallback resolvers. An Android device making a DNS query that Tailscale could not resolve now forwards the query to the OS’ DNS server, instead of requiring a global DNS server to be specified in Tailscale.</li>
<li>Also in v1.20, Tailscale clients using an <a href="https://tailscale.com/kb/1103/exit-nodes/">exit node</a> started forwarding DNS queries to the exit node.</li>
<li>In <a href="https://tailscale.com/changelog/#2022-04-22-client">v1.24</a>, we added pointer records for Tailscale services to MagicDNS to return records with Tailscale service IP information.</li>
<li>In <a href="https://tailscale.com/changelog/#2022-06-06-client">v1.26</a>, we made MagicDNS use <a href="https://pkg.go.dev/tailscale.com/wgengine/netstack">the netstack</a> for packet handling, which added DNS-over-TCP and reassembly of fragmented UDP responses to handle particularly large responses.</li>
<li>In v1.26, we also added the built-in DNS server to <a href="https://github.com/tailscale/tailscale/wiki/Tailscaled-on-macOS">tailscaled running on macOS</a>.</li>
<li>In <a href="https://tailscale.com/changelog/#2022-07-18-client">v1.28</a>, we updated the iOS client to use netstack for DNS.</li>
<li>Also in v1.28, we implemented automatic support for servers running on AWS, GCP, and Azure, and removed the requirement for fallback DNS servers.</li>
</ul>
<p>All to say, this has been a long time coming. We’re at a point where we believe (and hope!) that we’ve addressed all the known bugs with MagicDNS. (As always, if you find any issues with Tailscale, please let us know by <a href="https://tailscale.com/contact/support/">contacting support</a> or <a href="https://github.com/tailscale/tailscale">filing an issue on GitHub</a>.)</p>
<p>Just because MagicDNS is <a href="https://tailscale.com/kb/1167/release-stages/#general-availability-ga">generally available</a> doesn’t mean we’re done with MagicDNS. We still have work to do — for example, we know you’d like us to add support for <a href="https://github.com/tailscale/tailscale/issues/1543">custom records</a> and <a href="https://github.com/tailscale/tailscale/issues/3847">subdomains</a> — and it’s <a href="https://tailscale.com/blog/2021-09-private-dns-with-magicdns/#future-work">something we’ve been hoping to do for a long time, too</a>.</p>
<h3 id="magicdns-is-enabled-by-default-for-new-tailnets">MagicDNS is enabled by default for new tailnets</h3>
<p>Now that we feel confident MagicDNS will work in even the most thorny edge cases and haunted networks, we’ve enabled MagicDNS by default for all new tailnets.</p>
<p>If you already have a tailnet but aren’t using MagicDNS, all you have to do is enable it! Given the fixes to the past several client releases, we recommend you first update your devices to at least Tailscale v1.20 (<a href="https://login.tailscale.com/admin/machines?q=version%3A%3C1.20.0">here are your devices that are running older versions</a>), and then turn MagicDNS on in the <a href="https://login.tailscale.com/admin/dns">DNS page</a> of the admin console, by clicking “Enable MagicDNS”.</p>
<h3 id="new-tailhextsnet-tailnet-name-format">New <code>tail&lt;hex&gt;.ts.net</code> tailnet name format</h3>
<p>As we enable MagicDNS for all tailnets, we’re changing how tailnet names are assigned. All tailnets will have a tailnet name of the form <code>tail&lt;hex&gt;.ts.net</code>, with a random hex. This is what will be used for MagicDNS, node sharing, and HTTPS in Tailscale. You can see your tailnet’s name in the <a href="https://login.tailscale.com/admin/dns">DNS page</a> of the admin console. From there, you can also change your tailnet name to a randomly selected set of words (at this time, you can’t customize it further).</p>
<p>If you’ve already enabled MagicDNS, node sharing, or HTTPS, your tailnet already has a name in the form <code>&lt;domain&gt;.beta.tailscale.net</code>, <code>tailnet-&lt;hex&gt;.ts.net</code> or <code>tail-scale.ts.net</code>. Your unique tailnet name is used when registering DNS entries, <a href="https://tailscale.com/kb/1084/sharing/">sharing your device to other tailnets</a>, and <a href="https://tailscale.com/kb/1153/enabling-https/">issuing TLS certificates</a>.</p>
<p>Going forward, if you’re using a <code>beta</code> tailnet name, we ask you to migrate to the newly added tailnet name. For node sharing, this means <a href="https://tailscale.com/kb/1084/sharing/#sharing--magicdns">asking your sharees to use the new tailnet name</a>. The existing <code>beta</code> name will be supported until at least November 1, 2023.</p>
<h3 id="access-a-device-without-remembering-an-ip-address">Access a device without remembering an IP address</h3>
<p>Using MagicDNS, you can access a device on your tailnet by its name on the command line:</p>
<pre tabindex="0"><code>ssh prod-database
</code></pre><p>Or you can just navigate to a web address with the device name:</p>
<pre tabindex="0"><code>http://monitoring
</code></pre><figure>
  <iframe width="100%" height="360" src="https://www.youtube.com/embed/k_MxlYIHAvI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
  <figcaption>Charlotte demonstrates how to use MagicDNS.</figcaption>
</figure>
<p>To live in the magical world where this is possible, <a href="https://login.tailscale.com/admin/dns">enable MagicDNS on your tailnet</a>, and <a href="https://tailscale.com/kb/1081/magicdns/">read more about using MagicDNS in our documentation</a>.</p>
    </div></div>
  </body>
</html>
