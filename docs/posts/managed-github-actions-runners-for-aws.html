<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://news.ycombinator.com/item?id=39930908">Original</a>
    <h1>Show HN: Managed GitHub Actions Runners for AWS</h1>
    
    <div id="readability-page-1" class="page"><div><td colspan="2"></td><td><div><p>Hey HN! I&#39;m Jacob, one of the founders of Depot (<a href="https://depot.dev">https://depot.dev</a>), a build service for Docker images, and I&#39;m excited to show what we’ve been working on for the past few months: run GitHub Actions jobs in AWS, orchestrated by Depot!</p><p>Here&#39;s a video demo: <a href="https://www.youtube.com/watch?v=VX5Z-k1mGc8" rel="nofollow">https://www.youtube.com/watch?v=VX5Z-k1mGc8</a>, and here’s our blog post: <a href="https://depot.dev/blog/depot-github-actions-runners">https://depot.dev/blog/depot-github-actions-runners</a>.</p><p>While GitHub Actions is one of the most prevalent CI providers, Actions is slow, for a few reasons: GitHub uses underpowered CPUs, network throughput for cache and the internet at large is capped at 1 Gbps, and total cache storage is limited to 10GB per repo. It is also rather expensive for runners with more than 2 CPUs, and larger runners frequently take a long time to start running jobs.</p><p>Depot-managed runners solve this! Rather than your CI jobs running on GitHub&#39;s slow compute, Depot routes those same jobs to fast EC2 instances. And not only is this faster, it’s also 1/2 the cost of GitHub Actions!</p><p>We do this by launching a dedicated instance for each job, registering that instance as a self-hosted Actions runner in your GitHub organization, then terminating the instance when the job is finished. Using AWS as the compute provider has a few advantages:</p><p>- CPUs are typically 30%+ more performant than alternatives (the m7a instance type).</p><p>- Each instance has high-throughput networking of up to 12.5 Gbps, hosted in us-east-1, so interacting with artifacts, cache, container registries, or the internet at large is quick.</p><p>- Each instance has a public IPv4 address, so it does not share rate limits with anyone else.</p><p>We integrated the runners with the distributed cache system (backed by S3 and Ceph) that we use for Docker build cache, so jobs automatically save / restore cache from this cache system, with speeds of up to 1 GB/s, and without the default 10 GB per repo limit.</p><p>Building this was a fun challenge; some matrix workflows start 40+ jobs at once, then requiring 40 EC2 instances to launch at once.</p><p>We’ve effectively gotten very good at starting EC2 instances with a &#34;warm pool&#34; system which allows us to prepare many EC2 instances to run a job, stop them, then resize and start them when an actual job request arrives, to keep job queue times around 5 seconds. We&#39;re using a homegrown orchestration system, as alternatives like autoscaling groups or Kubernetes weren&#39;t fast or secure enough.</p><p>There are three alternatives to our managed runners currently:</p><p>1. GitHub offers larger runners: these have more CPUs, but still have slow network and cache. Depot runners are also 1/2 the cost per minute of GitHub&#39;s runners.</p><p>2. You can self-host the Actions runner on your own compute: this requires ongoing maintenance, and it can be difficult to ensure that the runner image or container matches GitHub&#39;s.</p><p>3. There are other companies offering hosted GitHub Actions runners, though they frequently use cheaper compute hosting providers that are bottlenecked on network throughput or geography.</p><p>Any feedback is very welcome! You can sign up at <a href="https://depot.dev/sign-up">https://depot.dev/sign-up</a> for a free trial if you&#39;d like to try it out on your own workflows. We aren&#39;t able to offer a trial without a signup gate, both because using it requires installing a GitHub app, and we&#39;re offering build compute, so we need some way to keep out the cryptominers :)</p></div></td></div></div>
  </body>
</html>
