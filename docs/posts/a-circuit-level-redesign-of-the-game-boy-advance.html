<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Zekfoo/AGZ">Original</a>
    <h1>A circuit-level redesign of the Game Boy Advance</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/AGZ_Front_2.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/AGZ_Front_2.jpg" alt=""/></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/AGZ_Back_2.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/AGZ_Back_2.jpg" alt=""/></a></p>
<p dir="auto">To commemorate the 20th year since the Game Boy Advance’s release, I have designed a full revamp of its PCB, using only the most essential components from the original hardware, and completely redesigning the remainder of its circuits.</p>
<p dir="auto">Although the PCB has a GBA form factor, the CPU is taken from a GBA SP for a greater design challenge. The PCB itself has been entirely assembled and soldered by hand. As a play on the original model numbers <em>“AGB-CPU-01”</em> for the PCB and <em>“AGB-001”</em> for the console itself, I have dubbed my design the <em>“AGZ-CPU-01”</em> and <em>“AGZ-001”</em> respectively (bonus points if you can guess what the Z stands for).</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/PCB_Front.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/PCB_Front.jpg" alt=""/></a></p>
<p dir="auto">This is a one-off production of what I envisioned as my ideal GBA and was an entry to <a href="https://old.reddit.com/r/Gameboy/comments/pyncmb/summer_modding_contest_final_results/" rel="nofollow">r/Gameboy’s Summer 2021 build contest</a>, having been voted the winner in both the Technical and Overall categories. It is a one-of-a-kind Game Boy in the most literal sense.</p>
<h3 dir="auto"><a id="user-content-features" aria-hidden="true" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h3>
<ul dir="auto">
<li>
<p dir="auto">4-layer 1.2mm PCB, blue silkscreen, ENIG surface finish
<a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/PCB_Front_Bare.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/PCB_Front_Bare.jpg" alt=""/></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/PCB_Back_Bare.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/PCB_Back_Bare.jpg" alt=""/></a></p>
</li>
<li>
<p dir="auto">GBA SP CPU (CPU AGB B E)</p>
</li>
<li>
<p dir="auto">1700mAh LiPo battery</p>
<ul dir="auto">
<li>
<p dir="auto">USB-C rechargeable with charge LED indicator</p>
</li>
<li>
<p dir="auto">Supports safe charge-and-play</p>
</li>
<li>
<p dir="auto">On-board battery protections – short-circuit, over-charge, over-discharge, over-temperature</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Completely redesigned power delivery</p>
<ul dir="auto">
<li>
<p dir="auto">Power switch debouncing</p>
</li>
<li>
<p dir="auto">5V boost converter</p>
</li>
<li>
<p dir="auto">3.3V buck converter</p>
</li>
<li>
<p dir="auto">2.5V buck converter + 1.8V linear regulator</p>
</li>
<li>
<p dir="auto">Full ground plane</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Completely redesigned audio circuits</p>
<ul dir="auto">
<li>
<p dir="auto">Stereo volume potentiometer</p>
</li>
<li>
<p dir="auto">2-stage active filtering</p>
</li>
<li>
<p dir="auto">Dedicated speaker and headphone amplifiers</p>
</li>
<li>
<p dir="auto">1W 8-ohm speaker</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Tactile buttons</p>
<ul dir="auto">
<li>
<p dir="auto">Snaptron tactile domes for DPAD and A/B</p>
</li>
<li>
<p dir="auto">Tactile switches for START/SELECT</p>
</li>
</ul>
</li>
<li>
<p dir="auto">FunnyPlaying IPS V2 display</p>
</li>
<li>
<p dir="auto">Hand-polished clear shell, dipped and coated with floor polish</p>
</li>
<li>
<p dir="auto">Blue buttons, bumpers, speaker ring insert, and battery cover</p>
</li>
</ul>
<h2 dir="auto"><a id="user-content-the-lengthy-write-up" aria-hidden="true" href="#the-lengthy-write-up"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The lengthy write-up</h2>
<h3 dir="auto"><a id="user-content-why-redesign-the-gba" aria-hidden="true" href="#why-redesign-the-gba"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why redesign the GBA?</h3>
<p dir="auto">I really want to like the Game Boy Advance. Growing up with a GBA SP, I was spoiled by its clicky buttons, rechargeable battery, and illuminated screen. When I finally got my hands on an original GBA, I couldn’t be more disappointed by the stark difference in feel and function. While today’s retro modding scene has produced many improvements for the GBA (referred to from now on as its codename AGB), the console still has many quirks that simple modding hasn’t been able to fix, but that can be addressed in a circuit redesign. In no particular order, here are the problems I have with the Game Boy Advance:</p>
<p dir="auto"><strong>It runs on AA batteries.</strong> While this certainly wasn’t an issue 20 years ago, and many won’t find it an issue today, we now live in a rechargeable world. The devices I use day-to-day are all plug-in rechargeable, and the idea of having to swap out batteries, even if to recharge them externally, feels very antiquated.</p>
<p dir="auto"><strong>Its buttons are mushy.</strong> Like all the Game Boy iterations before it, the AGB uses conductive button membranes which, when pressed, bridge contacts on the circuit board underneath. Only the GBA SP (AGS) uses actual tactile switches, which are what give it its clicky feel.</p>
<p dir="auto"><strong>Its screen is unlit.</strong> While the AGS comes with either a frontlit (AGS-001) or backlit (AGS-101) screen, the AGB’s screen is neither. Anyone who has owned an AGB would understand the struggle of trying to play under poor lighting. This problem is more-or-less resolved now that IPS screen replacements are commonplace in the modding scene, however the higher power consumption of these IPS screens lead to other problems.</p>
<p dir="auto"><strong>Its power delivery is lacking.</strong> The AGB uses a monolithic power management IC to regulate its system voltages – 2.5V, 3.3V, 5V, as well as +13V and -15V to bias the stock LCD. My measurements show that the 3.3V and 5V rails are regulated at about a 90kHz switching frequency, which is very low for switching regulators by today’s standards (regulators used today typically switch in the 1MHz range). I won’t discuss how switching regulators work here, but it suffices to say that this low switching frequency necessitates large electrolytic capacitors, which aren’t best suited for producing clean voltage supplies.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/3V3_OEM.png"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/3V3_OEM.png" alt=""/></a></p>
<blockquote>
<p dir="auto">90kHz switching frequency on the stock 3.3V rail</p>
</blockquote>
<p dir="auto"><strong>Its audio is noisy.</strong> The AGB is known to have a persistent buzz and hum from its speaker and headphone output. This noise is even more pronounced when the power circuitry is pushed to its limits by power-hungry mods and flash carts. I theorize this to be due to interference caused by the low frequency switching of the power rails. This issue isn’t helped by the fact that the AGB’s PCB has poor ground pours, limited by its 2-layer PCB design, which can exacerbate noise issues.</p>
<h3 dir="auto"><a id="user-content-a-few-last-nitpicks" aria-hidden="true" href="#a-few-last-nitpicks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>A few last nitpicks</h3>
<p dir="auto">The low-battery light on the AGB is powered directly from its battery voltage. This means that as the batteries deplete, the light dims, sometimes to the point of being unlit entirely. While this seems to be a feature intended by the original hardware designers, I frankly don’t like it.</p>
<p dir="auto">The power switch carries the full system current, making it the most common point-of-failure for all Game Boy handhelds, to the extent that the first step in troubleshooting a “dead” Game Boy is cleaning the power switch. Even a small amount of gunk buildup on the switch contacts can cause a considerable voltage drop across the switch, which is commonly the cause of flickering LEDs, reboots upon being bumped, and consoles that won’t turn on.</p>
<h3 dir="auto"><a id="user-content-the-agz-001-design" aria-hidden="true" href="#the-agz-001-design"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The AGZ-001 design</h3>
<p dir="auto">The AGZ-001 design addresses all the above-mentioned issues. First off, the AGZ-CPU-01 is a 4-layer PCB, allowing for simpler power and signal trace routing and a dedicated ground plane layer. The board uses a CPU AGB B E salvaged from a GBA SP, which is functionally identical to a GBA CPU (CPU AGB A) but requires an extra 1.8V supply voltage and has a narrower pin pitch, adding some more challenge to the design and assembly – you could also say that this is a GBA SP in a GBA!</p>
<h5 dir="auto"><a id="user-content-power" aria-hidden="true" href="#power"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Power</h5>
<p dir="auto">The power circuits support a 1700mAh LiPo battery, with USB-C charging and a charge LED indicator like the GBA SP’s. The charge circuit is designed to safely charge the battery while playing – the battery is isolated from the rest of the system when charging, allowing the system to be powered directly from USB voltage. The battery uses a 3-pin connector which includes a thermistor to support overtemperature protection during charging.</p>
<p dir="auto">The AGZ-CPU-01 uses discrete voltage regulators for each power rail, in place of the original power management IC. All the switching regulators switch in the 1MHz range, which greatly reduces the capacitance needed on each rail. A boost converter supplies the 5V rail while the 3.3V and 2.5V rails are generated by buck converters, and a linear regulator is used to further drop from 2.5V to produce the 1.8V rail. This design omits the +13V and -15V rails and the AGB-REG output voltages since they are not needed when using an IPS display. As opposed to the AGB, the AGZ-CPU-01 powers the low-power LED off of the 3.3V rail, so that it no longer dims as the battery voltage drops. The power switch has also been changed to no longer carry the full system current, and instead is part of a larger switch circuit with debouncing to mitigate the effects of a dirty switch.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/Exploded_View.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/Exploded_View.jpg" alt=""/></a></p>
<h5 dir="auto"><a id="user-content-audio" aria-hidden="true" href="#audio"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Audio</h5>
<p dir="auto">I want to preface this next section by saying I am not an audio engineer or even an audiophile, but as an electrical engineer, I know the fundamentals well enough to produce a functional audio circuit. I have no doubt that this design is overkill for the desired outcome. The CPU outputs a 65kHz PWM audio signal. To get a clean audio waveform in the 20Hz-20kHz range, this signal must be low-pass filtered with a steep cut-off between 20kHz and 65kHz. To achieve this cut-off, I opted for a 2-stage active filter (Butterworth Sallen-Key) along with some additional passive RC filters. Overall, this produces the following frequency response curve.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/Audio_FR.png"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/Audio_FR.png" alt=""/></a></p>
<blockquote>
<p dir="auto">Flat frequency response over audible range (20Hz-20kHz), sharp cut-off past 20kHz</p>
</blockquote>
<p dir="auto">The volume of the audio is adjusted using a stereo wheel potentiometer, an aftermarket replacement for those used in Game Boy Colors. Dedicated speaker and headphone amplifier ICs amplify the filtered audio for either output. Here’s a <a href="https://github.com/Zekfoo/AGZ/blob/main/Audio/Line_Out_Sample.wav">line-out recording</a> from the headphone jack.</p>
<h5 dir="auto"><a id="user-content-buttons" aria-hidden="true" href="#buttons"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Buttons</h5>
<p dir="auto">Many tactile button mods exist for the AGB which use tactile switches, including <a href="https://github.com/Zekfoo/tactileAGB">my own attempt at the concept</a>. From my experience, while these tactile switches produce a satisfying click, they tend to be very stiff and fatiguing to play on. For the AGZ-001, I opted instead to use tactile domes from Snaptron for the DPAD and A/B buttons, with ENIG surface finish on the PCB for good electrical contact. These domes have a lower actuation force than typical tactile switches while still producing a strong click when they bottom out. That said, the START and SELECT buttons still use tactile switches since they are what I found to feel the best for these two buttons.</p>
<h5 dir="auto"><a id="user-content-exterior" aria-hidden="true" href="#exterior"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exterior</h5>
<p dir="auto">The AGZ-001 uses a clear aftermarket shell from FunnyPlaying, which has been sanded and polished, then dipped in floor gloss for a smooth transparent finish. Holes were also drilled and filed for the USB-C port and charge LED. Blue components were chosen to accent with the blue PCB, and custom labels printed by <a href="https://bluishsquirrel.co.uk/" rel="nofollow">BluishSquirrel</a> make for a finishing touch on this one-of-a-kind GBA.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Zekfoo/AGZ/blob/main/Images/AGZ_Back_1.jpg"><img src="https://github.com/Zekfoo/AGZ/raw/main/Images/AGZ_Back_1.jpg" alt=""/></a></p>
<h3 dir="auto"><a id="user-content-acknowledgements" aria-hidden="true" href="#acknowledgements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Acknowledgements</h3>
<p dir="auto">Thanks to all the members of the <a href="https://discord.gg/gameboy" rel="nofollow">Gameboy Discord</a> community for their support and encouragement.</p>
<p dir="auto">Special thanks to <a href="https://gekkio.fi/" rel="nofollow">Gekkio</a> for his <a href="https://github.com/Gekkio/gb-schematics">AGS circuit schematics</a>.</p>
<p dir="auto">Special thanks to <a href="https://martinrefseth.com/" rel="nofollow">HDR</a> for compiling the <a href="https://nintenfo.github.io/repository/systems/GBA/documentation/schematics/" rel="nofollow">AGB circuit schematics and board scans</a>.</p>
<p dir="auto">Special thanks to <a href="https://mmm.page/b_2_3_n" rel="nofollow">b23n</a> for sharing his <a href="https://mmm.page/b_2_3_n.mod_polishing" rel="nofollow">shell polishing method</a>.</p>
</article>
        </div></div>
  </body>
</html>
