<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/godotengine/godot/pull/105628">Original</a>
    <h1>Native visionOS platform support</h1>
    
    <div id="readability-page-1" class="page"><div>
        <div>
  
  <task-lists disabled="" sortable="">
    <div>
      <p dir="auto">Dear Godot community,</p>
<p dir="auto">I&#39;m on Apple&#39;s visionOS engineering team, and we would like to contribute Vision Pro support to the Godot engine. This is the first PR that lays the foundation for that.</p>
<p dir="auto">First, I&#39;d like to mention that we&#39;re really excited to be working with the Godot community on adding visionOS support. We&#39;ve attempted to follow Godot&#39;s coding standards and a high-quality bar for our contributions. We hope that our contributions align with Godot&#39;s goals. Lastly, even though we have tried to split the changes into smaller self-contained PRs, we acknowledge that some of these PRs can be of considerable size.</p>
<p dir="auto">We&#39;re very happy to iterate on our PRs after receiving feedback and suggestions from the community.</p>
<h2 dir="auto">High Level Overview</h2>
<p dir="auto">The immediate goals of our contributions are:</p>
<ol dir="auto">
<li>To support current Godot games running natively on a planar window on visionOS.</li>
<li>To support creating Immersive experiences by using a new Godot&#39;s visionOS VR Plugin.</li>
</ol>
<p dir="auto">To achieve that, and in order to make reviewing easier, we have structured our contributions in three incremental PRs.</p>
<ol dir="auto">
<li>Add the native <code>visionOS</code> platform. Uses iOS as the starting point. Reuses as much code as possible between the iOS and Vision Pro platforms. (This PR).</li>
<li>Add ability to compile and link Swift files within Godot, and replace <code>main.mm</code> on the <code>visionOS</code> platform by the SwiftUI app lifecycle. This is a requirement to be able to launch Immersive scenes on visionOS.</li>
<li>Introduce Vision Pro VR plugin for Immersive support.</li>
</ol>
<p dir="auto">Even though we have a working version including points 2 and 3, those PRs are not up yet. Our current plan is to open them sequentially, after each of the previous PRs merge.</p>
<h2 dir="auto">Technical Discussion</h2>
<p dir="auto">This PR implements a new native <code>visionOS</code> platform.</p>
<p dir="auto">It&#39;s very close to the <code>iOS</code> platform in terms of implementation. In order to reuse as much code as possible, it introduces a new <code>drivers/apple_embedded</code> folder, to host code shared between the <code>iOS</code> and <code>visionOS</code> (but not <code>macOS</code>) platforms. We took inspiration from the new <code>drivers/apple</code> folder, which hosts code that applies to all Apple platforms.</p>
<p dir="auto">The platform-specific logic (including app instantiation, client code, display server, os support, and export plugin) was refactored, and now the bulk of the implementation is on <code>drivers/apple_embedded</code>. The platforms provide small subclasses that specialize the concrete aspects that are different between platforms. We did this refactor with care, trying not to alter the existing iOS functionality.</p>
<p dir="auto">The <code>visionOS</code> platform doesn&#39;t have OpenGL support, as it&#39;s not supported by visionOS.</p>
<p dir="auto">In order to make reviewing easier, we have tried to split this PR into individual self-contained commits when that made sense, and we have added detailed descriptions to most of them about what&#39;s contained in each commit. It&#39;s easier to review commit by commit, to see how the changes were incrementally implemented.</p>
<h3 dir="auto">Documentation Considerations</h3>
<p dir="auto">Now, the export plugin for <code>iOS</code> and <code>visionOS</code> share the majority of the code and most of their options (with the exception of launch storyboard support, which is iOS only; and specific platform icon support). Because of this, we have renamed <code>EditorExportPlatformIOS.xml</code> to <code>EditorExportPlatformAppleEmbedded.xml</code>, and moved it to <code>drivers/apple_embedded</code>.</p>
<p dir="auto">We&#39;d like to ask the community if this is appropriate from the docs tooling perspective, and we&#39;re requesting further guidance on how to modify this file or the docs tooling to provide specific documentation for each of the platforms.</p>
<h2 dir="auto">Testing</h2>
<p dir="auto">We have been testing this PR mainly with the <a href="https://github.com/godotengine/godot-demo-projects/tree/master/3d/platformer">Platformer demo project</a>. We have verified the project continues to work on iOS, and it now runs natively on visionOS. We have tested both the Mobile and Forward+ renderers with the Metal rendering driver on both platforms.</p>
<h3 dir="auto">Open Questions</h3>
<p dir="auto">In all our tests, we exported an Xcode project using the corresponding export plugin and template, and we then ran this project directly to an iOS or visionOS device.</p>
<p dir="auto">We&#39;d like to ask the community to provide guidance, or to help testing the following functionality:</p>
<ul dir="auto">
<li>We have not tested the ability of the iOS/visionOS export templates to embed and link plugins at export time. We tried to preserve this functionality on the <code>visionOS</code> platform, and we assume it will work in the same way it works on iOS. If anybody can attach a project using this functionality, we can help test it.</li>
<li>We have not been able to make direct Archive/IPA export, nor One-Click-Deploy to work, not even in <code>master</code>. There are some differences between our developer account and what external developers use, so it&#39;s a bit difficult to pinpoint the problem. We&#39;d appreciate it if anybody that has One-Click-Deploy currently working is able to test on both platforms.</li>
<li>Likewise, we have not tested deploying directly to an iOS device using <code>ios_deploy</code> (used with Xcode versions prior to 14.0). If somebody has a working setup using this, we&#39;d appreciate it if you could test this functionality still works. Alternatively, if <code>ios_deploy</code> support is no longer desired due to its age, we&#39;re happy to remove those codepaths for code simplicity.</li>
</ul>
<h2 dir="auto">Missing Functionality</h2>
<ul dir="auto">
<li>The DPI metrics on visionOS are hardcoded for now. They can change at runtime depending on how close the window is to the viewer. We&#39;ll address this in the PR adding SwiftUI, as the metrics come from SwiftUI APIs.</li>
<li>We have not implemented building a visionOS Icon Asset Catalog into the exporter. If somebody from the community can step in and implement it, that would be awesome. Otherwise, we may submit this as a later PRs. For now, you can work around this by manually creating your visionOS icon after exporting the Xcode project. <a href="https://developer.apple.com/design/human-interface-guidelines/app-icons" rel="nofollow">Here</a> you can read how visionOS icons work. And here&#39;s an example icon showing the Asset Catalog structure: <a href="https://github.com/user-attachments/files/19839704/visionOS-icon.xcassets.zip">visionOS-icon.xcassets.zip</a></li>
<li>The SVG logo for the visionOS platform is just text, it&#39;d be good if somebody could come up with a nice graphic.</li>
</ul>
<hr/>
<p dir="auto">We&#39;re happy to answer any questions or address any concerns. We&#39;re looking forward to collaborating with all of you.</p>
<p dir="auto"><a data-hovercard-type="user" data-hovercard-url="/users/BastiaanOlij/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/BastiaanOlij">@BastiaanOlij</a> <a data-hovercard-type="user" data-hovercard-url="/users/clayjohn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/clayjohn">@clayjohn</a> <a data-hovercard-type="user" data-hovercard-url="/users/coppolaemilio/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/coppolaemilio">@coppolaemilio</a> <a data-hovercard-type="user" data-hovercard-url="/users/stuartcarnie/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/stuartcarnie">@stuartcarnie</a> Feel free to mention anybody who would be interested in this change.</p>
    </div>
  </task-lists>
  
</div>

      </div></div>
  </body>
</html>
