<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/">Original</a>
    <h1>Capturing the Flag with GPT-4</h1>
    
    <div id="readability-page-1" class="page"><div>
    <article>
      
  
  <div>
    
    <p>
      <img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-logo.png"/>
    </p>
    
    
      
    
    <p>
      Posted April 23, 2023
      
        in
        
          <a href="https://micahflee.com/tags/ai">ai</a>
        
          <a href="https://micahflee.com/tags/ctf">ctf</a>
        
      
    </p>
    
      <p>This weekend I went to BSides SF 2023 and had a blast. I went to some really interesting talks (including an <a href="https://bsidessf2023.sched.com/event/1Hztz/sleeping-with-one-ai-open-an-introduction-to-attacks-against-artificial-intelligence-and-machine-learning">excellent one</a> about adversarial machine learning), but mostly I spent my time solving CTF hacking challenges. And this time, I did it with the help of GTP-4, the latest generation of OpenAI&#39;s ChatGPT generative language model. GPT-4 straight up solved some challenges for me, which blew my mind. There were definitely several flags I got that I wouldn&#39;t have gotten without the help of GPT-4. For challenges that GPT-4 didn&#39;t solve on its own, it provided incredibly helpful tips, or quickly wrote scripts that would have been tedious or time consuming for me to write myself. Good thing there&#39;s (almost) no such thing as cheating in CTF!</p>
<p>I also found several situations where ChatGPT simply errored out and refused to give me answers. I think this was the case when it was overtly clear that I was trying to get help with hacking. For example, when I asked it how to write some JavaScript code that would bypass a specific XSS filter, and used language that made it clear that I was trying to bypass an XSS filter, it just failed with an error. It seems that ChatGPT has some nominal safeguards to prevent people from using it for malicious hacking, but if you simply ask detailed technical questions (which could be used for offense or defense), it tends to answer them.</p>
<p>All that said, I wanted to share my experience with a few challenges. This post includes write-ups for:</p>
<ul>
<li>Shamir Secret Sharing</li>
<li>perckel</li>
<li>Shell Hurdles</li>
</ul>
<p>I used GPT-4 for help on several other challenges, but these three especially impressed me. I also solved several challenges without its help--partially because it&#39;s not always easy to give it all the context it needs to answer a question. You can&#39;t, for example, send it a 30MB APK file and then ask for help reverse engineering it, or copy all of the source code for a web app into GPT-4 and ask it to find the vulnerabilities. You can get help with smaller chunks of these problems, but I could see this technology getting way more powerful in the future.</p>
<h2 id="shamir-secret-sharing">Shamir Secret Sharing</h2><p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/sss-challenge.png" alt=""/></p>
<p>In this challenge, I had to walk around the BSides SF venue looking for QR codes to scan. In <a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">Shamir&#39;s Secret Sharing scheme</a>, a secret is divided into a certain number of parts, and if one person has a threshold of those parts they can decrypt the secret. In this case, there were 7 parts with a threshold of 5, and I wandered around and found 6 of them on QR codes. I then simply asked GPT-4 to solve the problem for me:</p>
<blockquote><p>Here are parts for Shamir Secret Sharing:</p>
<p>Share 1 of 7 (min 5): (x1, y1) = (1, 12214173319090360239218007) Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>Share 3 of 7 (min 5): (x3, y3) = (3, 272214528378786743506941922)  Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>Share 4 of 7 (min 5): (x4, y4) = (4, 404905998942651879217397287)  Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>Share 5 of 7 (min 5): (x5, y5) = (5, 589183787842889173793388269)  Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>Share 6 of 7 (min 5): (x6, y6) = (6, 338337360147368973687481536)  Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>Share 7 of 7 (min 5): (x7, y7) = (7, 479528534189573769684386994)  Field prime = 2^89 - 1 Flag = CTF{secretasletters} Secret -&gt; base 27 a = 1, b = 2, ... z = 26 (base 27)</p>
<p>How do I decrypt the secret?</p>
</blockquote>
<p>And GTP-4 delivered.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-sss.png" alt=""/></p>
<p>Wow. Does it work? I copied the Python script into <code>decrypt.py</code> and tried running it.</p>
<pre><code>$ python3 decrypt.py
CTF{perasperaadastra}
</code></pre>
<p>Holy shit. Mind blown. Especially because this challenge actually includes a very tricky part related to base-27, but GPT-4 just solved it all on the first try, without additional prompting.</p>
<p>I submitted the flag and got the points.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/perckel-challenge.png" alt=""/></p>
<p>I downloaded the file <code>flag.bin</code>, and then tried to figure out what this file is by running <code>file</code> on it.</p>
<pre><code>$ file flag.bin
flag.bin: perl Storable (v0.7) data (network-ordered) (major 2) (minor 11)
</code></pre>
<p>I had no idea what this is and it&#39;s been well over a decade since I wrote any code in Perl, so I asked GPT-4.</p>
<blockquote><p>What is this file?</p>
<p>flag.bin: perl Storable (v0.7) data (network-ordered) (major 2) (minor 11)</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-perckel1.png" alt=""/></p>
<p>Huh, cool. Maybe GPT-4 can write a Perl script for me so I can see what&#39;s in that file.</p>
<blockquote><p>Write a Perl script that will display what&#39;s in that file</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-perckel2.png" alt=""/></p>
<p>Nice, I don&#39;t have to re-teach myself Perl. I saved the script as <code>script.pl</code> and tried running it:</p>
<pre><code>$ perl script.pl
Can&#39;t eval, please set $Storable::Eval to a true value at /System/Library/Perl/5.30/darwin-thread-multi-2level/Storable.pm line 421, at script.pl line 9.
</code></pre>
<p>Hmm, it wants to be able to execute arbitrary code. I&#39;ll have to be careful when running this on my computer, but in the meantime let&#39;s see if GPT-4 can help fix this issue.</p>
<blockquote><p>Can&#39;t eval, please set $Storable::Eval to a true value at /System/Library/Perl/5.30/darwin-thread-multi-2level/Storable.pm line 421, at script.pl line 9.</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-perckel3.png" alt=""/></p>
<p>Nice, it fixed the script. I updated <code>script.pl</code>, but I didn&#39;t want to run it directly on my computer though. (It was nice of GPT-4 to warn me three separate times about the security risks.) So I decided to run it in a Docker container. I created a new Ubuntu container, installed the correct Perl dependencies, and ran it:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="c0b2afafb480f2f2a2f7f2a6f4f3a6a3f3a4">[email protected]</a>:/src# perl ./script.pl 
Name &#34;Storable::Eval&#34; used only once: possible typo at ./script.pl line 9.
$VAR1 = {
          &#39;shqa&#39; =&gt; &#39;iryaeuxfc&#39;,
          &#39;jwjepylpxecq&#39; =&gt; &#39;yfebe&#39;,
--snip--
          &#39;iruvqhgdnfstz&#39; =&gt; &#39;smkohnqw&#39;,
          &#39;qcotpliscszql&#39; =&gt; &#39;efzhu&#39;,
          &#39;decode_flag&#39; =&gt; sub { &#34;DUMMY&#34; },
          &#39;htxj&#39; =&gt; &#39;pmifolpyh&#39;,
          &#39;lftq&#39; =&gt; &#39;pxqqgeqy&#39;,
          &#39;adbsjrhouqhgg&#39; =&gt; &#39;srndfdboqqmfc&#39;,
          &#39;avarqfgzrufc&#39; =&gt; &#39;thgzdhdstum&#39;,
          &#39;pdeqoerfqxbro&#39; =&gt; &#39;grugrmrocnekt&#39;,
          &#39;ujlw&#39; =&gt; &#39;ooxnyiyu&#39;,
          &#39;flag&#39; =&gt; &#39;��;���@��(�P��@HTX�Т�@��ڂ���@(!k�8�@��Q�
��@�,��}F�@0Z��W�@��R�J�@���JM��@�#*,�@��E~���@�A����@���Y]��@�v���@@�N

b�@���co6�@������@��
                    �9�D�|�
                           �@�\&#39;Mi�e�@i��^9�@&#39;,
          &#39;lquykkphh&#39; =&gt; &#39;bjyrsce&#39;,
          &#39;ruybrycyo&#39; =&gt; &#39;othebxvqngu&#39;,
--snip--
          &#39;zxyybaaawc&#39; =&gt; &#39;kbzr&#39;,
          &#39;pojhbzugch&#39; =&gt; &#39;dqxiybapwepfh&#39;
        };
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="1b6974746f5b2929792c297d2f287d78287f">[email protected]</a>:/src#
</code></pre>
<p>The script spewed out over 1,000 lines of output, displaying the value of this Perl object. Most of the keys-value pairs seemed to be garbage, but two of the keys were interesting: <code>flag</code> was a block of binary data, and <code>decode_flag</code> was apparently a Perl function. It sounds like maybe the flag is encoded, and I can call <code>decode_flag</code> to decode it.</p>
<blockquote><p>The $data object has two interesting keys, <code>flag</code> which is binary data, and <code>decode_flag</code> which is a function. Update the script to call the <code>decode_flag</code> function and pass in the value of <code>flag</code></p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt-perckel4.png" alt=""/></p>
<p>I updated my script and ran it again:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="35475a5a4175070757020753010653560651">[email protected]</a>:/src# perl script.pl
Name &#34;Storable::Eval&#34; used only once: possible typo at script.pl line 9.
Decoded flag: CTF{ooohhh_purrrrl_&lt;3}
</code></pre>
<h2 id="shell-hurdles">Shell Hurdles</h2><p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/shurdles-challenge.png" alt=""/></p>
<p>The challenge provided a link to a web terminal, or a host that I can netcat into to get a shell. Here&#39;s what the web terminal looked like:</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/shurdles-shell1.png" alt=""/></p>
<p>Here&#39;s the output of a few commands (the hostname is edited for clarity):</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="f7948391b7849f8285939b9284">[email protected]</a>:~$ ls -l
total 2220
-r-x--x--x 1 root ctf 2270141 Apr 16  2020 shurdles
</code></pre>
<p>My home folder has an executable file called <code>shurdles</code> in it. I tried running it.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="d1b2a5b791a2b9a4a3b5bdb4a2">[email protected]</a>:~$ ./shurdles 
shurdle 0 failed: expected at least 1 argument
</code></pre>
<p>It failed with an error message saying it needs at least 1 argument. This was the first shurdle (shell hurdle), but it&#39;s an easy fix--I&#39;ll just pass in an argument.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="0665726046756e7374626a6375">[email protected]</a>:~$ ./shurdles ASDF
shurdle 2 failed: I expected to be called /shurdles, not ./shurdles
</code></pre>
<p>This worked, and I moved onto the next shurdle. This one was pretty hard. This program wants me to run <code>/shurdles</code>, not <code>./shurdles</code>. How can I do that? Let&#39;s ask GPT-4. I asked this:</p>
<blockquote><p>I have a bash shell. There is an executable file called /home/ctf/shurdles. I can run it by running:</p>
<p>/home/ctf/shurdles</p>
<p>Or by changing to the folder /home/ctf, and running:</p>
<p>./shurdles</p>
<p>Is it possible for me to run it with this command though, without creating a symlink?</p>
<p>/shurdles</p>
</blockquote>
<p>It responded with a decent idea: add <code>/home/ctf</code> to my PATH so I can just run <code>shurdles</code>, though it wasn&#39;t perfect.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt1.png" alt=""/></p>
<p>I tried it anyway, and it didn&#39;t work:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="fd9e899bbd8e95888f9991988e">[email protected]</a>:~$ export PATH=$PATH:/home/ctf
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="fc9f889abc8f94898e9890998f">[email protected]</a>:~$ shurdles ASDF
shurdle 2 failed: I expected to be called /shurdles, not shurdles
</code></pre>
<p>So I went back to GPT-4 and pleaded for additional help.</p>
<blockquote><p>That works to run:</p>
<p>shurdles</p>
<p>But how can I run it with:</p>
<p>/shurdles</p>
</blockquote>
<p>It told me in that case to create a symlink, though that requires root.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt2.png" alt=""/></p>
<p>I don&#39;t have root, so I asked for other ideas.</p>
<blockquote><p>Is there any way to do this without using symlinks, and without using root?</p>
</blockquote>
<p>It then came up with a great idea that I might not have thought up on my own: use a shell function.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt3.png" alt=""/></p>
<p>Unfortunately, this didn&#39;t work:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="5a392e3c1a29322f283e363f29">[email protected]</a>:~$ function /shurdles() { /home/ctf/shurdles &#34;<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="624622">[email protected]</a>&#34;; }
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="7f1c0b193f0c170a0d1b131a0c">[email protected]</a>:~$ /shurdles ASDF
shurdle 2 failed: I expected to be called /shurdles, not /home/ctf/shurdles
</code></pre>
<p>It seems that even though I&#39;m running <code>/shurdles</code>, that&#39;s a shell function that&#39;s running <code>/home/ctf/shurdles</code>, so that&#39;s the first argument that the process sees. I asked for more help:</p>
<blockquote><p>That was a great idea, but I actually need the first value of argv to be /shurdles, and that makes the first value /home/ctf/shurdles</p>
</blockquote>
<p>It responded with an idea that I totally wouldn&#39;t have thought of, because I had never even heard of <code>exec -a</code>. Fascinating.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt4.png" alt=""/></p>
<p>I decided to give it a try, but I realized the box I was on didn&#39;t have vim or nano. So, out of laziness, I just asked for the commands to save <code>shurdles_wrapper.sh</code> using echo instead.</p>
<blockquote><p>How can I create that shurdles_wrapper.sh script using echo, instead of a text editor?</p>
</blockquote>
<p>It gave me the exact command to run.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt5.png" alt=""/></p>
<p>I changed it a bit myself--I stored the script in <code>/tmp/wrapper.sh</code> instead of <code>/home/ctf/shurdles_wrapper.sh</code>, because I didn&#39;t have write access to <code>/home/ctf</code>, but it worked:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="eb889f8dab98839e998f878e98">[email protected]</a>:~$ echo -e &#39;#!/bin/bash\nexec -a /shurdles /home/ctf/shurdles &#34;<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="577317">[email protected]</a>&#34;&#39; &gt; /tmp/wrapper.sh
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="3d5e495b7d4e55484f5951584e">[email protected]</a>:~$ chmod +x /tmp/wrapper.sh
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="7211061432011a0700161e1701">[email protected]</a>:~$ /tmp/wrapper.sh ASDF    
shurdle 3 failed: I expected the environment variable &#34;HACKERS&#34; to look like hack the planet on separate lines
</code></pre>
<p>Got past that shurdle! And onto the next. I could totally figure this one out, but why not save time and get GPT-4 to do it for me?</p>
<blockquote><p>How can I set the environment variable &#34;HACKERS&#34; to be &#34;hack the planet&#34;, but with each word on a separate line?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt6.png" alt=""/></p>
<p>And it worked:</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="6f0c1b092f1c071a1d0b030a1c">[email protected]</a>:~$ export HACKERS=$&#39;hack\nthe\nplanet&#39;
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="ed8e998bad9e85989f8981889e">[email protected]</a>:~$ /tmp/wrapper.sh ASDF               
shurdle 5 failed: expected workdir &#34;/run/. -- !!&#34;
</code></pre>
<p>Onto the next shurdle. This one confused me a bit. I asked GPT-4 how I could make my current working directory look like: <code>/run/. -- !!</code>, without actually creating that folder and changing to it. It had some good ideas, including running <code>export PWD=&#39;/run/. -- !!&#39;</code> before running the command, but it didn&#39;t work. I asked it the different ways a command can learn its working directory, and it told me it can use the <code>PWD</code> environment variable, but also the <code>getcwd</code> function. When I asked how <code>getcwd</code> learned the working directory without the <code>PWD</code> environment variable, it gave me a detailed answer.</p>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt7.png" alt=""/></p>
<p>All of this is nitty gritty Linux details that I didn&#39;t know beforehand. And sure, generative language models confidently say things that are false sometimes, so it might not be exactly right... but honestly, it seems about as likely to be right as if I had asked a human Linux nerd. They get things wrong sometimes too.</p>
<p>In the end though, I was barking up the wrong tree. I realized the <code>ctf</code> user had write permission to <code>/run</code>, so I could just create the folder and change to it. So I got past this shurdle on my own.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="b9dacddff9cad1cccbddd5dcca">[email protected]</a>:~$ mkdir &#39;/run/. -- !!&#39;
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="f2918694b2819a8780969e9781">[email protected]</a>:~$ cd /run/.\ --\ \!\!/
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="e7849381a7948f9295838b8294">[email protected]</a>:/run/. -- !!$ /tmp/wrapper.sh ASDF
shurdle 6 failed: fd 3 isn&#39;t open
</code></pre>
<p>I didn&#39;t quite know what this one meant. Did I have to open a file or something? I asked GPT-4.</p>
<blockquote><p>What does &#34;fd 3 isn&#39;t open&#34; mean?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt8.png" alt=""/></p>
<p>Interesting. So the program I&#39;m running needs to open a file, and that will be file descriptor 3... I still had no idea how to make the program open a new file. I tried passing in a valid filename like <code>/home/ctf/.bashrc</code> instead of <code>ASDF</code> as the first argument, but no luck. So I asked GPT-4 for more help:</p>
<blockquote><p>Is there any way I could run the program that&#39;s giving this error in a way that will make it open an additional resource, so that file descriptor 3 will be open?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt9.png" alt=""/></p>
<p>I really ought to learn how to use the <code>exec</code> command... I had no idea about any of this, but I decided to try it.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="a6c5d2c0e6d5ced3d4c2cac3d5">[email protected]</a>:/run/. -- !!$ exec 3&gt;/tmp/fd3_output.txt
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="8deef9ebcdfee5f8ffe9e1e8fe">[email protected]</a>:/run/. -- !!$ /tmp/wrapper.sh ASDF
shurdle 6 failed: expected fd 3 to be a file of 1337 bytes in length
</code></pre>
<p>Progress! So I need <code>/tmp/fd3_output.txt</code> to be 1337 bytes long. I knew how to do this, but thought it would be faster to ask GPT-4 than to look up the specific <code>dd</code> arguments, or write Python code, or however I wanted to do it.</p>
<blockquote><p>How can I make /tmp/fd3_output.txt be 1337 bytes long?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt10.png" alt=""/></p>
<p>When I ran the <code>dd</code> command it made <code>/tmp/fd3_output.txt</code> 1337 bytes long, however when I ran <code>exec 3&gt;/tmp/fd3_output.txt</code> it truncated the file so it was zero bytes. Hmm, how could I solve that?</p>
<blockquote><p>How can I modify the command:</p>
<p>exec 3&gt;/tmp/fd3_output.txt</p>
<p>So that when it creates the file /tmp/fd3_output.txt, it makes it 1337 bytes long?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt11.png" alt=""/></p>
<p>I tried it... but it didn&#39;t work.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="f5968193b5869d808791999086">[email protected]</a>:/run/. -- !!$ dd if=/dev/zero of=/tmp/fd3_output.txt bs=1 count=1337 &amp;&amp; exec 3&gt;/tmp/fd3_output.txt
1337+0 records in
1337+0 records out
1337 bytes (1.3 kB, 1.3 KiB) copied, 0.00219604 s, 609 kB/s
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="a0c3d4c6e0d3c8d5d2c4ccc5d3">[email protected]</a>:/run/. -- !!$ /tmp/wrapper.sh ASDF
shurdle 6 failed: expected fd 3 to be a file of 1337 bytes in length
</code></pre>
<p>I wonder what&#39;s going on.</p>
<blockquote><p>When I run:</p>
<p>dd if=/dev/zero of=/tmp/fd3_output.txt bs=1 count=1337 &amp;&amp; exec 3&gt;/tmp/fd3_output.txt</p>
<p>It seems that /tmp/fd3_output.txt is still 0 bytes.</p>
<p>$ ls -l /tmp/fd3_output.txt
-rw-r--r-- 1 ctf ctf 0 Apr 23 06:17 /tmp/fd3_output.txt</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt12.png" alt=""/></p>
<p>Let&#39;s see...</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="98fbecfed8ebf0edeafcf4fdeb">[email protected]</a>:/run/. -- !!$ dd if=/dev/zero of=/tmp/fd3_output.txt bs=1 count=1337 &amp;&amp; exec 3&lt;&gt;/tmp/fd3_output.txt
1337+0 records in
1337+0 records out
1337 bytes (1.3 kB, 1.3 KiB) copied, 0.0021625 s, 618 kB/s
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="a8cbdccee8dbc0dddaccc4cddb">[email protected]</a>:/run/. -- !!$ /tmp/wrapper.sh ASDF
shurdle 7 failed: tz Local != America/Los_Angeles
</code></pre>
<p>One more shurdle down! Okay, so I need to update the time zone next.</p>
<blockquote><p>How do I set the time zone to &#34;America/Los_Angeles&#34; so that the next command I run recognizes that as the time zone?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt13.png" alt=""/></p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="84e7f0e2c4f7ecf1f6e0e8e1f7">[email protected]</a>:/run/. -- !!$ exec 3&lt;&gt;/tmp/fd3_output.txt &amp;&amp; TZ=&#34;America/Los_Angeles&#34; /tmp/wrapper.sh ASDF
shurdle 8 failed: could not find shurdles-helper
</code></pre>
<p>Another shurdle down! Now it needs to find <code>shurdles-helper</code>. This one I can solve on my own, by creating a new folder, putting an executable file called <code>shurdles-helper</code> into it, and adding it to the PATH.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="6704130127140f1215030b0214">[email protected]</a>:/run/. -- !!$ mkdir /tmp/bin
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="a6c5d2c0e6d5ced3d4c2cac3d5">[email protected]</a>:/run/. -- !!$ echo -e &#39;#!/bin/bash\necho helper&#39; &gt; /tmp/bin/shurdles-helper
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="0360776543706b7671676f6670">[email protected]</a>:/run/. -- !!$ chmod +x /tmp/bin/shurdles-helper
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="0467706244776c717660686177">[email protected]</a>:/run/. -- !!$ export PATH=/tmp/bin:$PATH
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="6704130127140f1215030b0214">[email protected]</a>:/run/. -- !!$ exec 3&lt;&gt;/tmp/fd3_output.txt &amp;&amp; TZ=&#34;America/Los_Angeles&#34; /tmp/wrapper.sh ASDF
shurdle 9 failed: expected /home/ctf/.cache/shurdles, does it exist?
</code></pre>
<p>It worked. Onto the next shurdle. In this case, it needs a file called <code>/home/ctf/.cache/shurdles</code> to exist. I think I can solve this one on my own too by creating that file.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="1e7d6a785e6d766b6c7a727b6d">[email protected]</a>:/run/. -- !!$ mkdir -p /home/ctf/.cache
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="395a4d5f794a514c4b5d555c4a">[email protected]</a>:/run/. -- !!$ touch /home/ctf/.cache/shurdles
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="5e3d2a381e2d362b2c3a323b2d">[email protected]</a>:/run/. -- !!$ exec 3&lt;&gt;/tmp/fd3_output.txt &amp;&amp; TZ=&#34;America/Los_Angeles&#34; /tmp/wrapper.sh ASDF
shurdle 9 failed: /home/ctf/.cache/shurdles was modified in the last day, sorry
</code></pre>
<p>It worked too. Now, it needs to timezone to be set to America/Los_Angeles. How you do update the modified timestamp on a file? GPT-4 will know.</p>
<blockquote><p>How you do update the modified timestamp on a file?</p>
</blockquote>
<p><img src="https://micahflee.com/2023/04/capturing-the-flag-with-gpt-4/chatgpt14.png" alt=""/></p>
<p>Okay, simple enough. I&#39;ll set it to a month ago.</p>
<pre><code><a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="ef8c9b89af9c879a9d8b838a9c">[email protected]</a>:/run/. -- !!$ touch -t 202303231430 /home/ctf/.cache/shurdles
<a href="https://micahflee.com/cdn-cgi/l/email-protection" data-cfemail="3f5c4b597f4c574a4d5b535a4c">[email protected]</a>:/run/. -- !!$ exec 3&lt;&gt;/tmp/fd3_output.txt &amp;&amp; TZ=&#34;America/Los_Angeles&#34; /tmp/wrapper.sh ASDF
Congratulations!!!
CTF{you_made_it_past_the_hurdles}
</code></pre>
<p>I only made it past the hurdles thanks to you, GPT-4.</p>


      
      

      
    
  </div>


    </article>
    
  </div></div>
  </body>
</html>
