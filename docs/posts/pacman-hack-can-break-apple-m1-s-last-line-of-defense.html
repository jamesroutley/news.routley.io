<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://spectrum.ieee.org/pacman-hack-can-break-apple-m1s-last-line-of-defense">Original</a>
    <h1>“PACMAN” hack can break Apple M1’s last line of defense</h1>
    
    <div id="readability-page-1" class="page"><div><template><p>
	While machine learning has been around a long time, deep learning has taken on a life of its own lately. The reason for that has mostly to do with the increasing amounts of computing power that have become widely available—along with the burgeoning quantities of data that can be easily harvested and used to train neural networks.
</p><p>
	The amount of computing power at people&#39;s fingertips started growing in leaps and bounds at the turn of the millennium, when graphical processing units (GPUs) began to be 
	<a href="https://en.wikipedia.org/wiki/General-purpose_computing_on_graphics_processing_units">harnessed for nongraphical calculations</a>, a trend that has become increasingly pervasive over the past decade. But the computing demands of deep learning have been rising even faster. This dynamic has spurred engineers to develop electronic hardware accelerators specifically targeted to deep learning, Google&#39;s <a href="https://cloud.google.com/tpu/docs/tpus">Tensor Processing Unit (TPU)</a> being a prime example.
</p><p>
	Here, I will describe a very different approach to this problem—using optical processors to carry out neural-network calculations with photons instead of electrons. To understand how optics can serve here, you need to know a little bit about how computers currently carry out neural-network calculations. So bear with me as I outline what goes on under the hood.
</p><p><strong>Almost invariably, artificial </strong>neurons are constructed using special software running on digital electronic computers of some sort. That software provides a given neuron with multiple inputs and one output. The state of each neuron depends on the weighted sum of its inputs, to which a nonlinear function, called an activation function, is applied. The result, the output of this neuron, then becomes an input for various other neurons.
</p><p>
  Reducing the energy needs of neural networks might require computing with light
</p><p>
	For computational efficiency, these neurons are grouped into layers, with neurons connected only to neurons in adjacent layers. The benefit of arranging things that way, as opposed to allowing connections between any two neurons, is that it allows certain mathematical tricks of linear algebra to be used to speed the calculations.
</p><p>
	While they are not the whole story, these linear-algebra calculations are the most computationally demanding part of deep learning, particularly as the size of the network grows. This is true for both training (the process of determining what weights to apply to the inputs for each neuron) and for inference (when the neural network is providing the desired results).
</p><p>
	What are these mysterious linear-algebra calculations? They aren&#39;t so complicated really. They involve operations on 
	<a href="https://en.wikipedia.org/wiki/Matrix_(mathematics)">matrices</a>, which are just rectangular arrays of numbers—spreadsheets if you will, minus the descriptive column headers you might find in a typical Excel file.
</p><p>
	This is great news because modern computer hardware has been very well optimized for matrix operations, which were the bread and butter of high-performance computing long before deep learning became popular. The relevant matrix calculations for deep learning boil down to a large number of multiply-and-accumulate operations, whereby pairs of numbers are multiplied together and their products are added up.
</p><p>
	Over the years, deep learning has required an ever-growing number of these multiply-and-accumulate operations. Consider 
	<a href="https://en.wikipedia.org/wiki/LeNet">LeNet</a>, a pioneering deep neural network, designed to do image classification. In 1998 it was shown to outperform other machine techniques for recognizing handwritten letters and numerals. But by 2012 <a href="https://en.wikipedia.org/wiki/AlexNet">AlexNet</a>, a neural network that crunched through about 1,600 times as many multiply-and-accumulate operations as LeNet, was able to recognize thousands of different types of objects in images.
</p><p>
	Advancing from LeNet&#39;s initial success to AlexNet required almost 11 doublings of computing performance. During the 14 years that took, Moore&#39;s law provided much of that increase. The challenge has been to keep this trend going now that Moore&#39;s law is running out of steam. The usual solution is simply to throw more computing resources—along with time, money, and energy—at the problem.
</p><p>
	As a result, training today&#39;s large neural networks often has a significant environmental footprint. One 
	<a href="https://arxiv.org/abs/1906.02243">2019 study</a> found, for example, that training a certain deep neural network for natural-language processing produced five times the CO<sub>2</sub> emissions typically associated with driving an automobile over its lifetime.
</p><p><strong>Improvements in digital </strong>electronic computers allowed deep learning to blossom, to be sure. But that doesn&#39;t mean that the only way to carry out neural-network calculations is with such machines. Decades ago, when digital computers were still relatively primitive, some engineers tackled difficult calculations using analog computers instead. As digital electronics improved, those analog computers fell by the wayside. But it may be time to pursue that strategy once again, in particular when the analog computations can be done optically.
</p><p>
	It has long been known that optical fibers can support much higher data rates than electrical wires. That&#39;s why all long-haul communication lines went optical, starting in the late 1970s. Since then, optical data links have replaced copper wires for shorter and shorter spans, all the way down to rack-to-rack communication in data centers. Optical data communication is faster and uses less power. Optical computing promises the same advantages.
</p><p>
	But there is a big difference between communicating data and computing with it. And this is where analog optical approaches hit a roadblock. Conventional computers are based on transistors, which are highly nonlinear circuit elements—meaning that their outputs aren&#39;t just proportional to their inputs, at least when used for computing. Nonlinearity is what lets transistors switch on and off, allowing them to be fashioned into logic gates. This switching is easy to accomplish with electronics, for which nonlinearities are a dime a dozen. But photons follow Maxwell&#39;s equations, which are annoyingly linear, meaning that the output of an optical device is typically proportional to its inputs.
</p><p>
	The trick is to use the linearity of optical devices to do the one thing that deep learning relies on most: linear algebra.
</p><p>
	To illustrate how that can be done, I&#39;ll describe here a photonic device that, when coupled to some simple analog electronics, can multiply two matrices together. Such multiplication combines the rows of one matrix with the columns of the other. More precisely, it multiplies pairs of numbers from these rows and columns and adds their products together—the multiply-and-accumulate operations I described earlier. My MIT colleagues and I published a paper about how this could be done 
	<a href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.021032">in 2019</a>. We&#39;re working now to build such an optical matrix multiplier.
</p><p>
  Optical data communication is faster and uses less power. Optical computing promises the same advantages.
</p><p>
	The basic computing unit in this device is an optical element called a 
	<a href="https://en.wikipedia.org/wiki/Beam_splitter">beam splitter</a>. Although its makeup is in fact more complicated, you can think of it as a half-silvered mirror set at a 45-degree angle. If you send a beam of light into it from the side, the beam splitter will allow half that light to pass straight through it, while the other half is reflected from the angled mirror, causing it to bounce off at 90 degrees from the incoming beam.
</p><p>
	Now shine a second beam of light, perpendicular to the first, into this beam splitter so that it impinges on the other side of the angled mirror. Half of this second beam will similarly be transmitted and half reflected at 90 degrees. The two output beams will combine with the two outputs from the first beam. So this beam splitter has two inputs and two outputs.
</p><p>
	To use this device for matrix multiplication, you generate two light beams with electric-field intensities that are proportional to the two numbers you want to multiply. Let&#39;s call these field intensities 
	<em>x</em> and <em>y</em>. Shine those two beams into the beam splitter, which will combine these two beams. This particular beam splitter does that in a way that will produce two outputs whose electric fields have values of (<em>x</em> + <em>y</em>)/√2 and (<em>x</em> − <em>y</em>)/√2.
</p><p>
	In addition to the beam splitter, this analog multiplier requires two simple electronic components—photodetectors—to measure the two output beams. They don&#39;t measure the electric field intensity of those beams, though. They measure the power of a beam, which is proportional to the square of its electric-field intensity.
</p><p>
	Why is that relation important? To understand that requires some algebra—but nothing beyond what you learned in high school. Recall that when you square (
	<em>x</em> + <em>y</em>)/√2 you get (<em>x</em><sup>2</sup> + 2<em>xy</em> + <em>y</em><sup>2</sup>)/2. And when you square (<em>x</em> − <em>y</em>)/√2, you get (<em>x</em><sup>2</sup> − 2<em>xy</em> + <em>y</em><sup>2</sup>)/2. Subtracting the latter from the former gives 2<em>xy</em>.
</p><p>
	Pause now to contemplate the significance of this simple bit of math. It means that if you encode a number as a beam of light of a certain intensity and another number as a beam of another intensity, send them through such a beam splitter, measure the two outputs with photodetectors, and negate one of the resulting electrical signals before summing them together, you will have a signal proportional to the product of your two numbers.
</p><p><img alt="Image of simulations of the Mach-Zehnder interferometer." data-rm-shortcode-id="5a6c959452170589d6b44babf8d23bfa" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/image-of-simulations-of-the-mach-zehnder-interferometer.gif?id=27133334&amp;width=980" height="368" id="9ab75" lazy-loadable="true" src="data:image/svg+xml,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 960 368&#39;%3E%3C/svg%3E" width="960"/><small placeholder="Add Photo Caption...">Simulations of the integrated Mach-Zehnder interferometer found in Lightmatter&#39;s neural-network accelerator show three different conditions whereby light traveling in the two branches of the interferometer undergoes different relative phase shifts (0 degrees in a, 45 degrees in b, and 90 degrees in c).</small><small placeholder="Add Photo Credit...">Lightmatter</small></p><p>
	My description has made it sound as though each of these light beams must be held steady. In fact, you can briefly pulse the light in the two input beams and measure the output pulse. Better yet, you can feed the output signal into a capacitor, which will then accumulate charge for as long as the pulse lasts. Then you can pulse the inputs again for the same duration, this time encoding two new numbers to be multiplied together. Their product adds some more charge to the capacitor. You can repeat this process as many times as you like, each time carrying out another multiply-and-accumulate operation.
	<br/></p><p>
	Using pulsed light in this way allows you to perform many such operations in rapid-fire sequence. The most energy-intensive part of all this is reading the voltage on that capacitor, which requires an analog-to-digital converter. But you don&#39;t have to do that after each pulse—you can wait until the end of a sequence of, say, 
	<em>N</em> pulses. That means that the device can perform <em>N</em> multiply-and-accumulate operations using the same amount of energy to read the answer whether <em>N</em> is small or large. Here, <em>N</em> corresponds to the number of neurons per layer in your neural network, which can easily number in the thousands. So this strategy uses very little energy.
</p><p>
	Sometimes you can save energy on the input side of things, too. That&#39;s because the same value is often used as an input to multiple neurons. Rather than that number being converted into light multiple times—consuming energy each time—it can be transformed just once, and the light beam that is created can be split into many channels. In this way, the energy cost of input conversion is amortized over many operations.
</p><p>
	Splitting one beam into many channels requires nothing more complicated than a lens, but lenses can be tricky to put onto a chip. So the device we are developing to perform neural-network calculations optically may well end up being a hybrid that combines highly integrated photonic chips with separate optical elements.
</p><p><strong>I&#39;ve outlined here the strategy</strong> my colleagues and I have been pursuing, but there are other ways to skin an optical cat. Another promising scheme is based on something called a Mach-Zehnder interferometer, which combines two beam splitters and two fully reflecting mirrors. It, too, can be used to carry out matrix multiplication optically. Two MIT-based startups, <a href="https://lightmatter.co/">Lightmatter</a> and <a href="https://www.lightelligence.ai/">Lightelligence</a>, are developing optical neural-network accelerators based on this approach. Lightmatter has already <a href="https://spectrum.ieee.org/computing/software/deep-learning-at-the-speed-of-light">built a prototype</a> that uses an optical chip it has fabricated. And the company expects to begin selling an optical accelerator board that uses that chip later this year.
</p><p>
	Another startup using optics for computing is 
	<a href="https://optalysys.com/">Optalysis</a>, which hopes to revive a rather old concept. One of the first uses of optical computing <a href="https://ieeexplore.ieee.org/document/1446917">back in the 1960s</a> was for the processing of synthetic-aperture radar data. A key part of the challenge was to apply to the measured data a mathematical operation called the Fourier transform. Digital computers of the time struggled with such things. Even now, applying the Fourier transform to large amounts of data can be computationally intensive. But a Fourier transform can be carried out optically with nothing more complicated than a lens, which for some years was how engineers processed synthetic-aperture data. Optalysis hopes to bring this approach up to date and apply it more widely.
</p><p>
  Theoretically, photonics has the potential to accelerate deep learning by several orders of magnitude.
</p><p>
	There is also a company called 
	<a href="https://luminous.co/">Luminous</a>, spun out of <a href="https://www.princeton.edu/">Princeton University</a>, which is working to create spiking neural networks based on something <a href="https://www.researchgate.net/publication/347397868_A_Laser_Spiking_Neuron_in_a_Photonic_Integrated_Circuit">it calls a laser neuron</a>. Spiking neural networks more closely mimic how biological neural networks work and, like our own brains, are able to compute using very little energy. Luminous&#39;s hardware is still in the early phase of development, but the promise of combining two energy-saving approaches—spiking and optics—is quite exciting.
</p><p>
	There are, of course, still many technical challenges to be overcome. One is to improve the accuracy and dynamic range of the analog optical calculations, which are nowhere near as good as what can be achieved with digital electronics. That&#39;s because these optical processors suffer from various sources of noise and because the digital-to-analog and analog-to-digital converters used to get the data in and out are of limited accuracy. Indeed, it&#39;s difficult to imagine an optical neural network operating with more than 8 to 10 bits of precision. While 8-bit electronic deep-learning hardware exists (the Google TPU is a good example), this industry demands higher precision, especially for neural-network training.
</p><p>
	There is also the difficulty integrating optical components onto a chip. Because those components are tens of micrometers in size, they can&#39;t be packed nearly as tightly as transistors, so the required chip area adds up quickly. 
	<a href="https://www.nature.com/articles/nphoton.2017.93.epdf">A 2017 demonstration of this approach</a> by MIT researchers involved a chip that was 1.5 millimeters on a side. Even the biggest chips are no larger than several square centimeters, which places limits on the sizes of matrices that can be processed in parallel this way.
</p><p>
	There are many additional questions on the computer-architecture side that photonics researchers tend to sweep under the rug. What&#39;s clear though is that, at least theoretically, photonics has the potential to accelerate deep learning by several orders of magnitude.
</p><p>
	Based on the technology that&#39;s currently available for the various components (optical modulators, detectors, amplifiers, analog-to-digital converters), it&#39;s reasonable to think that the energy efficiency of neural-network calculations could be made 1,000 times better than today&#39;s electronic processors. Making more aggressive assumptions about emerging optical technology, that factor might be as large as a million. And because electronic processors are power-limited, these improvements in energy efficiency will likely translate into corresponding improvements in speed.
</p><p>
	Many of the concepts in analog optical computing are decades old. Some even predate silicon computers. Schemes for optical matrix multiplication, and 
	<a href="https://www.spiedigitallibrary.org/journals/optical-engineering/volume-26/issue-5/265428/Optical-Associative-Memory-Using-Fourier-Transform-Holograms/10.1117/12.7974093.short?SSO=1">even for optical neural networks</a>, were first demonstrated <a href="https://www.osapublishing.org/ol/abstract.cfm?uri=ol-2-1-1">in the 1970s</a>. But this approach didn&#39;t catch on. Will this time be different? Possibly, for three reasons.
</p><p>
	First, deep learning is genuinely useful now, not just an academic curiosity. Second, 
	<a href="https://spectrum.ieee.org/semiconductors/devices/transistors-could-stop-shrinking-in-2021">we can&#39;t rely on Moore&#39;s Law</a> alone to continue improving electronics. And finally, we have a new technology that was not available to earlier generations: integrated photonics. These factors suggest that optical neural networks will arrive for real this time—and the future of such computations may indeed be photonic.
</p></template></div></div>
  </body>
</html>
