<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.ruby-lang.org/en/news/2025/12/25/ruby-4-0-0-released/">Original</a>
    <h1>Ruby 4.0.0</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
          <p>Posted by <strong>naruse</strong> on 25 Dec 2025</p>

          
<p>We are pleased to announce the release of Ruby 4.0.0.
Ruby 4.0 introduces “Ruby Box” and “ZJIT”, and adds many improvements.</p>

<h2 id="ruby-box">Ruby Box</h2>

<p>Ruby Box is a new (experimental) feature to provide separation about definitions. Ruby Box is enabled when an environment variable <code>RUBY_BOX=1</code> is specified. The class is <code>Ruby::Box</code>.</p>

<p>Definitions loaded in a box are isolated in the box. Ruby Box can isolate/separate monkey patches, changes of global/class variables, class/module definitions, and loaded native/ruby libraries from other boxes.</p>

<p>Expected use cases are:</p>

<ul>
  <li>Run test cases in box to protect other tests when the test case uses monkey patches to override something</li>
  <li>Run web app boxes in parallel to execute blue-green deployment on an app server in a Ruby process</li>
  <li>Run web app boxes in parallel to evaluate dependency updates for a certain period of time by checking response diff using Ruby code</li>
  <li>Used as the foundation (low-level) API to implement kind of “package” (high-level) API (it is not designed yet)</li>
</ul>

<p>For the detail of “Ruby Box”, see  <a href="https://docs.ruby-lang.org/en/master/Ruby/Box.html">Ruby::Box</a>.
[<a href="https://bugs.ruby-lang.org/issues/21311">Feature #21311</a>] [<a href="https://bugs.ruby-lang.org/issues/21385">Misc #21385</a>]</p>

<h2 id="zjit">ZJIT</h2>

<p>ZJIT is a new just-in-time (JIT) compiler, which is developed as the next generation of YJIT. You need Rust 1.85.0 or newer to build Ruby with ZJIT support, and ZJIT is enabled when <code>--zjit</code> is specified.</p>

<p>We’re building a new compiler for Ruby because we want to both raise the performance ceiling (bigger compilation unit size and SSA IR) and encourage more outside contribution (by becoming a more traditional method compiler). See <a href="https://railsatscale.com/2025-12-24-launch-zjit/">our blog post</a> for more details.
<!-- the blog post will be auto-published on 2025-12-24 9:00am UTC. --></p>

<p>ZJIT is faster than the interpreter, but not yet as fast as YJIT. We encourage you to experiment with ZJIT, but maybe hold off on deploying it in production for now. Stay tuned for Ruby 4.1 ZJIT.</p>

<h2 id="ractor-improvements">Ractor Improvements</h2>

<p>Ractor, Ruby’s parallel execution mechanism, has received several improvements. A new class, <code>Ractor::Port</code>, was introduced to address issues related to message sending and receiving (see <a href="https://dev.to/ko1/ractorport-revamping-the-ractor-api-98">our blog post</a>). Additionally, <code>Ractor.shareable_proc</code> makes it easier to share <code>Proc</code> objects between Ractors.</p>

<p>On the performance side, many internal data structures have been improved to significantly reduce contention on a global lock, unlocking better parallelism. Ractors also now share less internal data, resulting in less CPU cache contention when running in parallel.</p>

<p>Ractor was first introduced in Ruby 3.0 as an experimental feature. We aim to remove its “experimental” status next year.</p>

<h2 id="language-changes">Language changes</h2>

<ul>
  <li>
    <p><code>*nil</code> no longer calls <code>nil.to_a</code>, similar to how <code>**nil</code> does
not call <code>nil.to_hash</code>.  [<a href="https://bugs.ruby-lang.org/issues/21047">Feature #21047</a>]</p>
  </li>
  <li>
    <p>Logical binary operators (<code>||</code>, <code>&amp;&amp;</code>, <code>and</code> and <code>or</code>) at the
beginning of a line continue the previous line, like fluent dot.
The following code examples are equal:</p>

    <div><div><pre><code>  <span>if</span> <span>condition1</span>
     <span>&amp;&amp;</span> <span>condition2</span>
    <span>...</span>
  <span>end</span>
</code></pre></div>    </div>

    <p>Previously:</p>

    <div><div><pre><code>  <span>if</span> <span>condition1</span> <span>&amp;&amp;</span> <span>condition2</span>
    <span>...</span>
  <span>end</span>
</code></pre></div>    </div>

    <div><div><pre><code>  <span>if</span> <span>condition1</span> <span>&amp;&amp;</span>
     <span>condition2</span>
    <span>...</span>
  <span>end</span>
</code></pre></div>    </div>

    <p>[<a href="https://bugs.ruby-lang.org/issues/20925">Feature #20925</a>]</p>
  </li>
</ul>

<h2 id="core-classes-updates">Core classes updates</h2>

<p>Note: We’re only listing outstanding class updates.</p>

<ul>
  <li>
    <p>Array</p>

    <ul>
      <li><code>Array#rfind</code> has been added as a more efficient alternative to <code>array.reverse_each.find</code> [<a href="https://bugs.ruby-lang.org/issues/21678">Feature #21678</a>]</li>
      <li><code>Array#find</code> has been added as a more efficient override of <code>Enumerable#find</code> [<a href="https://bugs.ruby-lang.org/issues/21678">Feature #21678</a>]</li>
    </ul>
  </li>
  <li>
    <p>Binding</p>

    <ul>
      <li>
        <p><code>Binding#local_variables</code> does no longer include numbered parameters.
Also, <code>Binding#local_variable_get</code>, <code>Binding#local_variable_set</code>, and
<code>Binding#local_variable_defined?</code> reject to handle numbered parameters.
[<a href="https://bugs.ruby-lang.org/issues/21049">Bug #21049</a>]</p>
      </li>
      <li>
        <p><code>Binding#implicit_parameters</code>, <code>Binding#implicit_parameter_get</code>, and
<code>Binding#implicit_parameter_defined?</code> have been added to access
numbered parameters and “it” parameter. [<a href="https://bugs.ruby-lang.org/issues/21049">Bug #21049</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Enumerator</p>

    <ul>
      <li>
        <p><code>Enumerator.produce</code> now accepts an optional <code>size</code> keyword argument
to specify the size of the enumerator.  It can be an integer,
<code>Float::INFINITY</code>, a callable object (such as a lambda), or <code>nil</code> to
indicate unknown size.  When not specified, the size defaults to
<code>Float::INFINITY</code>.</p>

        <div><div><pre><code>  <span># Infinite enumerator</span>
  <span>enum</span> <span>=</span> <span>Enumerator</span><span>.</span><span>produce</span><span>(</span><span>1</span><span>,</span> <span>size: </span><span>Float</span><span>::</span><span>INFINITY</span><span>,</span> <span>&amp;</span><span>:succ</span><span>)</span>
  <span>enum</span><span>.</span><span>size</span>  <span># =&gt; Float::INFINITY</span>

  <span># Finite enumerator with known/computable size</span>
  <span>abs_dir</span> <span>=</span> <span>File</span><span>.</span><span>expand_path</span><span>(</span><span>&#34;./baz&#34;</span><span>)</span> <span># =&gt; &#34;/foo/bar/baz&#34;</span>
  <span>traverser</span> <span>=</span> <span>Enumerator</span><span>.</span><span>produce</span><span>(</span><span>abs_dir</span><span>,</span> <span>size: </span><span>-&gt;</span> <span>{</span> <span>abs_dir</span><span>.</span><span>count</span><span>(</span><span>&#34;/&#34;</span><span>)</span> <span>+</span> <span>1</span> <span>})</span> <span>{</span>
    <span>raise</span> <span>StopIteration</span> <span>if</span> <span>it</span> <span>==</span> <span>&#34;/&#34;</span>
    <span>File</span><span>.</span><span>dirname</span><span>(</span><span>it</span><span>)</span>
  <span>}</span>
  <span>traverser</span><span>.</span><span>size</span>  <span># =&gt; 4</span>
</code></pre></div>        </div>

        <p>[<a href="https://bugs.ruby-lang.org/issues/21701">Feature #21701</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>ErrorHighlight</p>

    <ul>
      <li>
        <p>When an ArgumentError is raised, it now displays code snippets for
both the method call (caller) and the method definition (callee).
[<a href="https://bugs.ruby-lang.org/issues/21543">Feature #21543</a>]</p>

        <div><div><pre><code>test.rb:1:in &#39;Object#add&#39;: wrong number of arguments (given 1, expected 2) (ArgumentError)

    caller: test.rb:3
    | add(1)
      ^^^
    callee: test.rb:1
    | def add(x, y) = x + y
          ^^^
        from test.rb:3:in &#39;&lt;main&gt;&#39;
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>Fiber</p>

    <ul>
      <li>Introduce support for <code>Fiber#raise(cause:)</code> argument similar to
<code>Kernel#raise</code>. [<a href="https://bugs.ruby-lang.org/issues/21360">Feature #21360</a>]</li>
    </ul>
  </li>
  <li>
    <p>Fiber::Scheduler</p>

    <ul>
      <li>
        <p>Introduce <code>Fiber::Scheduler#fiber_interrupt</code> to interrupt a fiber with a
given exception. The initial use case is to interrupt a fiber that is
waiting on a blocking IO operation when the IO operation is closed.
[<a href="https://bugs.ruby-lang.org/issues/21166">Feature #21166</a>]</p>
      </li>
      <li>
        <p>Introduce <code>Fiber::Scheduler#yield</code> to allow the fiber scheduler to
continue processing when signal exceptions are disabled.
[<a href="https://bugs.ruby-lang.org/issues/21633">Bug #21633</a>]</p>
      </li>
      <li>
        <p>Reintroduce the <code>Fiber::Scheduler#io_close</code> hook for asynchronous <code>IO#close</code>.</p>
      </li>
      <li>
        <p>Invoke <code>Fiber::Scheduler#io_write</code> when flushing the IO write buffer.
[<a href="https://bugs.ruby-lang.org/issues/21789">Bug #21789</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>File</p>

    <ul>
      <li><code>File::Stat#birthtime</code> is now available on Linux via the statx
system call when supported by the kernel and filesystem.
[<a href="https://bugs.ruby-lang.org/issues/21205">Feature #21205</a>]</li>
    </ul>
  </li>
  <li>
    <p>IO</p>

    <ul>
      <li>
        <p><code>IO.select</code> accepts <code>Float::INFINITY</code> as a timeout argument.
[<a href="https://bugs.ruby-lang.org/issues/20610">Feature #20610</a>]</p>
      </li>
      <li>
        <p>A deprecated behavior, process creation by <code>IO</code> class methods
with a leading <code>|</code>, was removed.  [<a href="https://bugs.ruby-lang.org/issues/19630">Feature #19630</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Kernel</p>

    <ul>
      <li>
        <p><code>Kernel#inspect</code> now checks for the existence of a <code>#instance_variables_to_inspect</code> method,
allowing control over which instance variables are displayed in the <code>#inspect</code> string:</p>

        <div><div><pre><code>  <span>class</span> <span>DatabaseConfig</span>
    <span>def</span> <span>initialize</span><span>(</span><span>host</span><span>,</span> <span>user</span><span>,</span> <span>password</span><span>)</span>
      <span>@host</span> <span>=</span> <span>host</span>
      <span>@user</span> <span>=</span> <span>user</span>
      <span>@password</span> <span>=</span> <span>password</span>
    <span>end</span>

    <span>private</span> <span>def</span> <span>instance_variables_to_inspect</span> <span>=</span> <span>[</span><span>:@host</span><span>,</span> <span>:@user</span><span>]</span>
  <span>end</span>

  <span>conf</span> <span>=</span> <span>DatabaseConfig</span><span>.</span><span>new</span><span>(</span><span>&#34;localhost&#34;</span><span>,</span> <span>&#34;root&#34;</span><span>,</span> <span>&#34;hunter2&#34;</span><span>)</span>
  <span>conf</span><span>.</span><span>inspect</span> <span>#=&gt; #&lt;DatabaseConfig:0x0000000104def350 @host=&#34;localhost&#34;, @user=&#34;root&#34;&gt;</span>
</code></pre></div>        </div>

        <p>[<a href="https://bugs.ruby-lang.org/issues/21219">Feature #21219</a>]</p>
      </li>
      <li>
        <p>A deprecated behavior, process creation by <code>Kernel#open</code> with a
leading <code>|</code>, was removed.  [<a href="https://bugs.ruby-lang.org/issues/19630">Feature #19630</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Math</p>

    <ul>
      <li><code>Math.log1p</code> and <code>Math.expm1</code> are added. [<a href="https://bugs.ruby-lang.org/issues/21527">Feature #21527</a>]</li>
    </ul>
  </li>
  <li>
    <p>Pathname</p>

    <ul>
      <li>Pathname has been promoted from a default gem to a core class of Ruby.
[<a href="https://bugs.ruby-lang.org/issues/17473">Feature #17473</a>]</li>
    </ul>
  </li>
  <li>
    <p>Proc</p>

    <ul>
      <li><code>Proc#parameters</code> now shows anonymous optional parameters as <code>[:opt]</code>
instead of <code>[:opt, nil]</code>, making the output consistent with when the
anonymous parameter is required. [<a href="https://bugs.ruby-lang.org/issues/20974">Bug #20974</a>]</li>
    </ul>
  </li>
  <li>
    <p>Ractor</p>

    <ul>
      <li>
        <p><code>Ractor::Port</code> class was added for a new synchronization mechanism
to communicate between Ractors. [<a href="https://bugs.ruby-lang.org/issues/21262">Feature #21262</a>]</p>

        <div><div><pre><code>  <span>port1</span> <span>=</span> <span>Ractor</span><span>::</span><span>Port</span><span>.</span><span>new</span>
  <span>port2</span> <span>=</span> <span>Ractor</span><span>::</span><span>Port</span><span>.</span><span>new</span>
  <span>Ractor</span><span>.</span><span>new</span> <span>port1</span><span>,</span> <span>port2</span> <span>do</span> <span>|</span><span>port1</span><span>,</span> <span>port2</span><span>|</span>
    <span>port1</span> <span>&lt;&lt;</span> <span>1</span>
    <span>port2</span> <span>&lt;&lt;</span> <span>11</span>
    <span>port1</span> <span>&lt;&lt;</span> <span>2</span>
    <span>port2</span> <span>&lt;&lt;</span> <span>12</span>
  <span>end</span>
  <span>2</span><span>.</span><span>times</span><span>{</span> <span>p</span> <span>port1</span><span>.</span><span>receive</span> <span>}</span> <span>#=&gt; 1, 2</span>
  <span>2</span><span>.</span><span>times</span><span>{</span> <span>p</span> <span>port2</span><span>.</span><span>receive</span> <span>}</span> <span>#=&gt; 11, 12</span>
</code></pre></div>        </div>

        <p><code>Ractor::Port</code> provides the following methods:</p>

        <ul>
          <li><code>Ractor::Port#receive</code></li>
          <li><code>Ractor::Port#send</code> (or <code>Ractor::Port#&lt;&lt;</code>)</li>
          <li><code>Ractor::Port#close</code></li>
          <li><code>Ractor::Port#closed?</code></li>
        </ul>

        <p>As a result, <code>Ractor.yield</code> and <code>Ractor#take</code> were removed.</p>
      </li>
      <li>
        <p><code>Ractor#join</code> and <code>Ractor#value</code> were added to wait for the
termination of a Ractor. These are similar to <code>Thread#join</code>
and <code>Thread#value</code>.</p>
      </li>
      <li>
        <p><code>Ractor#monitor</code> and <code>Ractor#unmonitor</code> were added as low-level
interfaces used internally to implement <code>Ractor#join</code>.</p>
      </li>
      <li>
        <p><code>Ractor.select</code> now only accepts Ractors and Ports. If Ractors are given,
it returns when a Ractor terminates.</p>
      </li>
      <li>
        <p><code>Ractor#default_port</code> was added. Each <code>Ractor</code> has a default port,
which is used by <code>Ractor.send</code>, <code>Ractor.receive</code>.</p>
      </li>
      <li>
        <p><code>Ractor#close_incoming</code> and <code>Ractor#close_outgoing</code> were removed.</p>
      </li>
      <li>
        <p><code>Ractor.shareable_proc</code> and <code>Ractor.shareable_lambda</code> are introduced
to make shareable Proc or lambda.
[<a href="https://bugs.ruby-lang.org/issues/21550">Feature #21550</a>], [<a href="https://bugs.ruby-lang.org/issues/21557">Feature #21557</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Range</p>

    <ul>
      <li>
        <p><code>Range#to_set</code> now performs size checks to prevent issues with
endless ranges. [<a href="https://bugs.ruby-lang.org/issues/21654">Bug #21654</a>]</p>
      </li>
      <li>
        <p><code>Range#overlap?</code> now correctly handles infinite (unbounded) ranges.
[<a href="https://bugs.ruby-lang.org/issues/21185">Bug #21185</a>]</p>
      </li>
      <li>
        <p><code>Range#max</code> behavior on beginless integer ranges has been fixed.
[<a href="https://bugs.ruby-lang.org/issues/21174">Bug #21174</a>] [<a href="https://bugs.ruby-lang.org/issues/21175">Bug #21175</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Ruby</p>

    <ul>
      <li>A new toplevel module <code>Ruby</code> has been defined, which contains
Ruby-related constants. This module was reserved in Ruby 3.4
and is now officially defined. [<a href="https://bugs.ruby-lang.org/issues/20884">Feature #20884</a>]</li>
    </ul>
  </li>
  <li>
    <p>Ruby::Box</p>

    <ul>
      <li>A new (experimental) feature to provide separation about definitions.
For the detail of “Ruby Box”, see <a href="https://www.ruby-lang.org/en/news/2025/12/25/ruby-4-0-0-released/doc/language/box.md">doc/language/box.md</a>.
[<a href="https://bugs.ruby-lang.org/issues/21311">Feature #21311</a>] [<a href="https://bugs.ruby-lang.org/issues/21385">Misc #21385</a>]</li>
    </ul>
  </li>
  <li>
    <p>Set</p>

    <ul>
      <li>
        <p><code>Set</code> is now a core class, instead of an autoloaded stdlib class.
[<a href="https://bugs.ruby-lang.org/issues/21216">Feature #21216</a>]</p>
      </li>
      <li>
        <p><code>Set#inspect</code> now uses a simpler display, similar to literal arrays.
(e.g., <code>Set[1, 2, 3]</code> instead of <code>#&lt;Set: {1, 2, 3}&gt;</code>). [<a href="https://bugs.ruby-lang.org/issues/21389">Feature #21389</a>]</p>
      </li>
      <li>
        <p>Passing arguments to <code>Set#to_set</code> and <code>Enumerable#to_set</code> is now deprecated.
[<a href="https://bugs.ruby-lang.org/issues/21390">Feature #21390</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Socket</p>

    <ul>
      <li><code>Socket.tcp</code> &amp; <code>TCPSocket.new</code> accepts an <code>open_timeout</code> keyword argument to specify
the timeout for the initial connection. [<a href="https://bugs.ruby-lang.org/issues/21347">Feature #21347</a>]</li>
      <li>When a user-specified timeout occurred in <code>TCPSocket.new</code>, either <code>Errno::ETIMEDOUT</code>
or <code>IO::TimeoutError</code> could previously be raised depending on the situation.
This behavior has been unified so that <code>IO::TimeoutError</code> is now consistently raised.
(Please note that, in <code>Socket.tcp</code>, there are still cases where <code>Errno::ETIMEDOUT</code>
may be raised in similar situations, and that in both cases <code>Errno::ETIMEDOUT</code> may be
raised when the timeout occurs at the OS level.)</li>
    </ul>
  </li>
  <li>
    <p>String</p>

    <ul>
      <li>
        <p>Update Unicode to Version 17.0.0 and Emoji Version 17.0.
[<a href="https://bugs.ruby-lang.org/issues/19908">Feature #19908</a>][<a href="https://bugs.ruby-lang.org/issues/20724">Feature #20724</a>][<a href="https://bugs.ruby-lang.org/issues/21275">Feature #21275</a>] (also applies to Regexp)</p>
      </li>
      <li>
        <p><code>String#strip</code>, <code>strip!</code>, <code>lstrip</code>, <code>lstrip!</code>, <code>rstrip</code>, and <code>rstrip!</code>
 are extended to accept <code>*selectors</code> arguments. [<a href="https://bugs.ruby-lang.org/issues/21552">Feature #21552</a>]</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Thread</p>

    <ul>
      <li>Introduce support for <code>Thread#raise(cause:)</code> argument similar to
<code>Kernel#raise</code>. [<a href="https://bugs.ruby-lang.org/issues/21360">Feature #21360</a>]</li>
    </ul>
  </li>
</ul>

<h2 id="stdlib-updates">Stdlib updates</h2>

<p>We only list stdlib changes that are notable feature changes.</p>

<p>Other changes are listed in the following sections. We also listed release history from the previous bundled version that is Ruby 3.4.0 if it has GitHub releases.</p>

<p>The following bundled gems are promoted from default gems.</p>

<ul>
  <li>ostruct 0.6.3
    <ul>
      <li>0.6.1 to <a href="https://github.com/ruby/ostruct/releases/tag/v0.6.2">v0.6.2</a>, <a href="https://github.com/ruby/ostruct/releases/tag/v0.6.3">v0.6.3</a></li>
    </ul>
  </li>
  <li>pstore 0.2.0
    <ul>
      <li>0.1.4 to <a href="https://github.com/ruby/pstore/releases/tag/v0.2.0">v0.2.0</a></li>
    </ul>
  </li>
  <li>benchmark 0.5.0
    <ul>
      <li>0.4.0 to <a href="https://github.com/ruby/benchmark/releases/tag/v0.4.1">v0.4.1</a>, <a href="https://github.com/ruby/benchmark/releases/tag/v0.5.0">v0.5.0</a></li>
    </ul>
  </li>
  <li>logger 1.7.0
    <ul>
      <li>1.6.4 to <a href="https://github.com/ruby/logger/releases/tag/v1.6.5">v1.6.5</a>, <a href="https://github.com/ruby/logger/releases/tag/v1.6.6">v1.6.6</a>, <a href="https://github.com/ruby/logger/releases/tag/v1.7.0">v1.7.0</a></li>
    </ul>
  </li>
  <li>rdoc 7.0.2
    <ul>
      <li>6.14.0 to <a href="https://github.com/ruby/rdoc/releases/tag/v6.14.1">v6.14.1</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.14.2">v6.14.2</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.15.0">v6.15.0</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.15.1">v6.15.1</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.16.0">v6.16.0</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.16.1">v6.16.1</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v6.17.0">v6.17.0</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v7.0.0">v7.0.0</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v7.0.1">v7.0.1</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v7.0.2">v7.0.2</a>, <a href="https://github.com/ruby/rdoc/releases/tag/v7.0.3">v7.0.3</a></li>
    </ul>
  </li>
  <li>win32ole 1.9.2
    <ul>
      <li>1.9.1 to <a href="https://github.com/ruby/win32ole/releases/tag/v1.9.2">v1.9.2</a></li>
    </ul>
  </li>
  <li>irb 1.16.0
    <ul>
      <li>1.14.3 to <a href="https://github.com/ruby/irb/releases/tag/v1.15.0">v1.15.0</a>, <a href="https://github.com/ruby/irb/releases/tag/v1.15.1">v1.15.1</a>, <a href="https://github.com/ruby/irb/releases/tag/v1.15.2">v1.15.2</a>, <a href="https://github.com/ruby/irb/releases/tag/v1.15.3">v1.15.3</a>, <a href="https://github.com/ruby/irb/releases/tag/v1.16.0">v1.16.0</a></li>
    </ul>
  </li>
  <li>reline 0.6.3
    <ul>
      <li>0.6.0 to <a href="https://github.com/ruby/reline/releases/tag/v0.6.1">v0.6.1</a>, <a href="https://github.com/ruby/reline/releases/tag/v0.6.2">v0.6.2</a>, <a href="https://github.com/ruby/reline/releases/tag/v0.6.3">v0.6.3</a></li>
    </ul>
  </li>
  <li>readline 0.0.4</li>
  <li>fiddle 1.1.8
    <ul>
      <li>1.1.6 to <a href="https://github.com/ruby/fiddle/releases/tag/v1.1.7">v1.1.7</a>, <a href="https://github.com/ruby/fiddle/releases/tag/v1.1.8">v1.1.8</a></li>
    </ul>
  </li>
</ul>

<p>The following default gem is added.</p>

<ul>
  <li>win32-registry 0.1.2</li>
</ul>

<p>The following default gems are updated.</p>

<ul>
  <li>RubyGems 4.0.3</li>
  <li>bundler 4.0.3</li>
  <li>date 3.5.1
    <ul>
      <li>3.4.1 to <a href="https://github.com/ruby/date/releases/tag/v3.5.0">v3.5.0</a>, <a href="https://github.com/ruby/date/releases/tag/v3.5.1">v3.5.1</a></li>
    </ul>
  </li>
  <li>delegate 0.6.1
    <ul>
      <li>0.4.0 to <a href="https://github.com/ruby/delegate/releases/tag/v0.5.0">v0.5.0</a>, <a href="https://github.com/ruby/delegate/releases/tag/v0.6.0">v0.6.0</a>, <a href="https://github.com/ruby/delegate/releases/tag/v0.6.1">v0.6.1</a></li>
    </ul>
  </li>
  <li>digest 3.2.1
    <ul>
      <li>3.2.0 to <a href="https://github.com/ruby/digest/releases/tag/v3.2.1">v3.2.1</a></li>
    </ul>
  </li>
  <li>english 0.8.1
    <ul>
      <li>0.8.0 to <a href="https://github.com/ruby/english/releases/tag/v0.8.1">v0.8.1</a></li>
    </ul>
  </li>
  <li>erb 6.0.1
    <ul>
      <li>4.0.4 to <a href="https://github.com/ruby/erb/releases/tag/v5.1.2">v5.1.2</a>, <a href="https://github.com/ruby/erb/releases/tag/v5.1.3">v5.1.3</a>, <a href="https://github.com/ruby/erb/releases/tag/v6.0.0">v6.0.0</a>, <a href="https://github.com/ruby/erb/releases/tag/v6.0.1">v6.0.1</a></li>
    </ul>
  </li>
  <li>error_highlight 0.7.1</li>
  <li>etc 1.4.6</li>
  <li>fcntl 1.3.0
    <ul>
      <li>1.2.0 to <a href="https://github.com/ruby/fcntl/releases/tag/v1.3.0">v1.3.0</a></li>
    </ul>
  </li>
  <li>fileutils 1.8.0
    <ul>
      <li>1.7.3 to <a href="https://github.com/ruby/fileutils/releases/tag/v1.8.0">v1.8.0</a></li>
    </ul>
  </li>
  <li>forwardable 1.4.0
    <ul>
      <li>1.3.3 to <a href="https://github.com/ruby/forwardable/releases/tag/v1.4.0">v1.4.0</a></li>
    </ul>
  </li>
  <li>io-console 0.8.2
    <ul>
      <li>0.8.1 to <a href="https://github.com/ruby/io-console/releases/tag/v0.8.2">v0.8.2</a></li>
    </ul>
  </li>
  <li>io-nonblock 0.3.2</li>
  <li>io-wait 0.4.0
    <ul>
      <li>0.3.2 to <a href="https://github.com/ruby/io-wait/releases/tag/v0.3.3">v0.3.3</a>, <a href="https://github.com/ruby/io-wait/releases/tag/v0.3.5.test1">v0.3.5.test1</a>, <a href="https://github.com/ruby/io-wait/releases/tag/v0.3.5">v0.3.5</a>, <a href="https://github.com/ruby/io-wait/releases/tag/v0.3.6">v0.3.6</a>, <a href="https://github.com/ruby/io-wait/releases/tag/v0.4.0">v0.4.0</a></li>
    </ul>
  </li>
  <li>ipaddr 1.2.8</li>
  <li>json 2.18.0
    <ul>
      <li>2.9.1 to <a href="https://github.com/ruby/json/releases/tag/v2.10.0">v2.10.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.10.1">v2.10.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.10.2">v2.10.2</a>, <a href="https://github.com/ruby/json/releases/tag/v2.11.0">v2.11.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.11.1">v2.11.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.11.2">v2.11.2</a>, <a href="https://github.com/ruby/json/releases/tag/v2.11.3">v2.11.3</a>, <a href="https://github.com/ruby/json/releases/tag/v2.12.0">v2.12.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.12.1">v2.12.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.12.2">v2.12.2</a>, <a href="https://github.com/ruby/json/releases/tag/v2.13.0">v2.13.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.13.1">v2.13.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.13.2">v2.13.2</a>, <a href="https://github.com/ruby/json/releases/tag/v2.14.0">v2.14.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.14.1">v2.14.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.15.0">v2.15.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.15.1">v2.15.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.15.2">v2.15.2</a>, <a href="https://github.com/ruby/json/releases/tag/v2.16.0">v2.16.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.17.0">v2.17.0</a>, <a href="https://github.com/ruby/json/releases/tag/v2.17.1">v2.17.1</a>, <a href="https://github.com/ruby/json/releases/tag/v2.18.0">v2.18.0</a></li>
    </ul>
  </li>
  <li>net-http 0.9.1
    <ul>
      <li>0.6.0 to <a href="https://github.com/ruby/net-http/releases/tag/v0.7.0">v0.7.0</a>, <a href="https://github.com/ruby/net-http/releases/tag/v0.8.0">v0.8.0</a>, <a href="https://github.com/ruby/net-http/releases/tag/v0.9.0">v0.9.0</a>, <a href="https://github.com/ruby/net-http/releases/tag/v0.9.1">v0.9.1</a></li>
    </ul>
  </li>
  <li>openssl 4.0.0
    <ul>
      <li>3.3.1 to <a href="https://github.com/ruby/openssl/releases/tag/v3.3.2">v3.3.2</a>, <a href="https://github.com/ruby/openssl/releases/tag/v4.0.0">v4.0.0</a></li>
    </ul>
  </li>
  <li>optparse 0.8.1
    <ul>
      <li>0.6.0 to <a href="https://github.com/ruby/optparse/releases/tag/v0.7.0">v0.7.0</a>, <a href="https://github.com/ruby/optparse/releases/tag/v0.8.0">v0.8.0</a>, <a href="https://github.com/ruby/optparse/releases/tag/v0.8.1">v0.8.1</a></li>
    </ul>
  </li>
  <li>pp 0.6.3
    <ul>
      <li>0.6.2 to <a href="https://github.com/ruby/pp/releases/tag/v0.6.3">v0.6.3</a></li>
    </ul>
  </li>
  <li>prism 1.7.0
    <ul>
      <li>1.5.2 to <a href="https://github.com/ruby/prism/releases/tag/v1.6.0">v1.6.0</a>, <a href="https://github.com/ruby/prism/releases/tag/v1.7.0">v1.7.0</a></li>
    </ul>
  </li>
  <li>psych 5.3.1
    <ul>
      <li>5.2.2 to <a href="https://github.com/ruby/psych/releases/tag/v5.2.3">v5.2.3</a>, <a href="https://github.com/ruby/psych/releases/tag/v5.2.4">v5.2.4</a>, <a href="https://github.com/ruby/psych/releases/tag/v5.2.5">v5.2.5</a>, <a href="https://github.com/ruby/psych/releases/tag/v5.2.6">v5.2.6</a>, <a href="https://github.com/ruby/psych/releases/tag/v5.3.0">v5.3.0</a>, <a href="https://github.com/ruby/psych/releases/tag/v5.3.1">v5.3.1</a></li>
    </ul>
  </li>
  <li>resolv 0.7.0
    <ul>
      <li>0.6.2 to <a href="https://github.com/ruby/resolv/releases/tag/v0.6.3">v0.6.3</a>, <a href="https://github.com/ruby/resolv/releases/tag/v0.7.0">v0.7.0</a></li>
    </ul>
  </li>
  <li>stringio 3.2.0
    <ul>
      <li>3.1.2 to <a href="https://github.com/ruby/stringio/releases/tag/v3.1.3">v3.1.3</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.4">v3.1.4</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.5">v3.1.5</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.6">v3.1.6</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.7">v3.1.7</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.8">v3.1.8</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.1.9">v3.1.9</a>, <a href="https://github.com/ruby/stringio/releases/tag/v3.2.0">v3.2.0</a></li>
    </ul>
  </li>
  <li>strscan 3.1.6
    <ul>
      <li>3.1.2 to <a href="https://github.com/ruby/strscan/releases/tag/v3.1.3">v3.1.3</a>, <a href="https://github.com/ruby/strscan/releases/tag/v3.1.4">v3.1.4</a>, <a href="https://github.com/ruby/strscan/releases/tag/v3.1.5">v3.1.5</a>, <a href="https://github.com/ruby/strscan/releases/tag/v3.1.6">v3.1.6</a></li>
    </ul>
  </li>
  <li>time 0.4.2
    <ul>
      <li>0.4.1 to <a href="https://github.com/ruby/time/releases/tag/v0.4.2">v0.4.2</a></li>
    </ul>
  </li>
  <li>timeout 0.6.0
    <ul>
      <li>0.4.3 to <a href="https://github.com/ruby/timeout/releases/tag/v0.4.4">v0.4.4</a>, <a href="https://github.com/ruby/timeout/releases/tag/v0.5.0">v0.5.0</a>, <a href="https://github.com/ruby/timeout/releases/tag/v0.6.0">v0.6.0</a></li>
    </ul>
  </li>
  <li>uri 1.1.1
    <ul>
      <li>1.0.4 to <a href="https://github.com/ruby/uri/releases/tag/v1.1.0">v1.1.0</a>, <a href="https://github.com/ruby/uri/releases/tag/v1.1.1">v1.1.1</a></li>
    </ul>
  </li>
  <li>weakref 0.1.4
    <ul>
      <li>0.1.3 to <a href="https://github.com/ruby/weakref/releases/tag/v0.1.4">v0.1.4</a></li>
    </ul>
  </li>
  <li>zlib 3.2.2
    <ul>
      <li>3.2.1 to <a href="https://github.com/ruby/zlib/releases/tag/v3.2.2">v3.2.2</a></li>
    </ul>
  </li>
</ul>

<p>The following bundled gems are updated.</p>

<ul>
  <li>minitest 6.0.0</li>
  <li>power_assert 3.0.1
    <ul>
      <li>2.0.5 to <a href="https://github.com/ruby/power_assert/releases/tag/v3.0.0">v3.0.0</a>, <a href="https://github.com/ruby/power_assert/releases/tag/v3.0.1">v3.0.1</a></li>
    </ul>
  </li>
  <li>rake 13.3.1
    <ul>
      <li>13.2.1 to <a href="https://github.com/ruby/rake/releases/tag/v13.3.0">v13.3.0</a>, <a href="https://github.com/ruby/rake/releases/tag/v13.3.1">v13.3.1</a></li>
    </ul>
  </li>
  <li>test-unit 3.7.5
    <ul>
      <li>3.6.7 to <a href="https://github.com/test-unit/test-unit/releases/tag/3.6.8">3.6.8</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.6.9">3.6.9</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.0">3.7.0</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.1">3.7.1</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.2">3.7.2</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.3">3.7.3</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.4">3.7.4</a>, <a href="https://github.com/test-unit/test-unit/releases/tag/3.7.5">3.7.5</a></li>
    </ul>
  </li>
  <li>rexml 3.4.4</li>
  <li>rss 0.3.2
    <ul>
      <li>0.3.1 to <a href="https://github.com/ruby/rss/releases/tag/0.3.2">0.3.2</a></li>
    </ul>
  </li>
  <li>net-ftp 0.3.9
    <ul>
      <li>0.3.8 to <a href="https://github.com/ruby/net-ftp/releases/tag/v0.3.9">v0.3.9</a></li>
    </ul>
  </li>
  <li>net-imap 0.6.2
    <ul>
      <li>0.5.8 to <a href="https://github.com/ruby/net-imap/releases/tag/v0.5.9">v0.5.9</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.5.10">v0.5.10</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.5.11">v0.5.11</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.5.12">v0.5.12</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.5.13">v0.5.13</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.6.0">v0.6.0</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.6.1">v0.6.1</a>, <a href="https://github.com/ruby/net-imap/releases/tag/v0.6.2">v0.6.2</a></li>
    </ul>
  </li>
  <li>net-smtp 0.5.1
    <ul>
      <li>0.5.0 to <a href="https://github.com/ruby/net-smtp/releases/tag/v0.5.1">v0.5.1</a></li>
    </ul>
  </li>
  <li>matrix 0.4.3
    <ul>
      <li>0.4.2 to <a href="https://github.com/ruby/matrix/releases/tag/v0.4.3">v0.4.3</a></li>
    </ul>
  </li>
  <li>prime 0.1.4
    <ul>
      <li>0.1.3 to <a href="https://github.com/ruby/prime/releases/tag/v0.1.4">v0.1.4</a></li>
    </ul>
  </li>
  <li>rbs 3.10.0
    <ul>
      <li>3.8.0 to <a href="https://github.com/ruby/rbs/releases/tag/v3.8.1">v3.8.1</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.0.dev.1">v3.9.0.dev.1</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.0.pre.1">v3.9.0.pre.1</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.0.pre.2">v3.9.0.pre.2</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.0">v3.9.0</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.1">v3.9.1</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.2">v3.9.2</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.3">v3.9.3</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.4">v3.9.4</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.9.5">v3.9.5</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.10.0.pre.1">v3.10.0.pre.1</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.10.0.pre.2">v3.10.0.pre.2</a>, <a href="https://github.com/ruby/rbs/releases/tag/v3.10.0">v3.10.0</a></li>
    </ul>
  </li>
  <li>typeprof 0.31.1</li>
  <li>debug 1.11.1
    <ul>
      <li>1.11.0 to <a href="https://github.com/ruby/debug/releases/tag/v1.11.1">v1.11.1</a></li>
    </ul>
  </li>
  <li>base64 0.3.0
    <ul>
      <li>0.2.0 to <a href="https://github.com/ruby/base64/releases/tag/v0.3.0">v0.3.0</a></li>
    </ul>
  </li>
  <li>bigdecimal 4.0.1
    <ul>
      <li>3.1.8 to <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.2.0">v3.2.0</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.2.1">v3.2.1</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.2.2">v3.2.2</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.2.3">v3.2.3</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.3.0">v3.3.0</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v3.3.1">v3.3.1</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v4.0.0">v4.0.0</a>, <a href="https://github.com/ruby/bigdecimal/releases/tag/v4.0.1">v4.0.1</a></li>
    </ul>
  </li>
  <li>drb 2.2.3
    <ul>
      <li>2.2.1 to <a href="https://github.com/ruby/drb/releases/tag/v2.2.3">v2.2.3</a></li>
    </ul>
  </li>
  <li>syslog 0.3.0
    <ul>
      <li>0.2.0 to <a href="https://github.com/ruby/syslog/releases/tag/v0.3.0">v0.3.0</a></li>
    </ul>
  </li>
  <li>csv 3.3.5
    <ul>
      <li>3.3.2 to <a href="https://github.com/ruby/csv/releases/tag/v3.3.3">v3.3.3</a>, <a href="https://github.com/ruby/csv/releases/tag/v3.3.4">v3.3.4</a>, <a href="https://github.com/ruby/csv/releases/tag/v3.3.5">v3.3.5</a></li>
    </ul>
  </li>
  <li>repl_type_completor 0.1.12</li>
</ul>

<h3 id="rubygems-and-bundler">RubyGems and Bundler</h3>

<p>Ruby 4.0 bundled RubyGems and Bundler version 4. see the following links for details.</p>

<ul>
  <li><a href="https://blog.rubygems.org/2025/12/03/upgrade-to-rubygems-bundler-4.html">Upgrading to RubyGems/Bundler 4 - RubyGems Blog</a></li>
  <li><a href="https://blog.rubygems.org/2025/12/03/4.0.0-released.html">4.0.0 Released - RubyGems Blog</a></li>
  <li><a href="https://blog.rubygems.org/2025/12/09/4.0.1-released.html">4.0.1 Released - RubyGems Blog</a></li>
  <li><a href="https://blog.rubygems.org/2025/12/17/4.0.2-released.html">4.0.2 Released - RubyGems Blog</a></li>
  <li><a href="https://blog.rubygems.org/2025/12/23/4.0.3-released.html">4.0.3 Released - RubyGems Blog</a></li>
</ul>

<h2 id="supported-platforms">Supported platforms</h2>

<ul>
  <li>
    <p>Windows</p>

    <ul>
      <li>Dropped support for MSVC versions older than 14.0 (_MSC_VER 1900).
This means Visual Studio 2015 or later is now required.</li>
    </ul>
  </li>
</ul>

<h2 id="compatibility-issues">Compatibility issues</h2>

<ul>
  <li>
    <p>The following methods were removed from Ractor due to the addition of <code>Ractor::Port</code>:</p>

    <ul>
      <li><code>Ractor.yield</code></li>
      <li><code>Ractor#take</code></li>
      <li><code>Ractor#close_incoming</code></li>
      <li><code>Ractor#close_outgoing</code></li>
    </ul>

    <p>[<a href="https://bugs.ruby-lang.org/issues/21262">Feature #21262</a>]</p>
  </li>
  <li>
    <p><code>ObjectSpace._id2ref</code> is deprecated. [<a href="https://bugs.ruby-lang.org/issues/15408">Feature #15408</a>]</p>
  </li>
  <li>
    <p><code>Process::Status#&amp;</code> and <code>Process::Status#&gt;&gt;</code> have been removed.
They were deprecated in Ruby 3.3. [<a href="https://bugs.ruby-lang.org/issues/19868">Bug #19868</a>]</p>
  </li>
  <li>
    <p><code>rb_path_check</code> has been removed. This function was used for
<code>$SAFE</code> path checking which was removed in Ruby 2.7,
and was already deprecated.
[<a href="https://bugs.ruby-lang.org/issues/20971">Feature #20971</a>]</p>
  </li>
  <li>
    <p>A backtrace for <code>ArgumentError</code> of “wrong number of arguments” now
include the receiver’s class or module name (e.g., in <code>Foo#bar</code>
instead of in <code>bar</code>). [<a href="https://bugs.ruby-lang.org/issues/21698">Bug #21698</a>]</p>
  </li>
  <li>
    <p>Backtraces no longer display <code>internal</code> frames.
These methods now appear as if it is in the Ruby source file,
consistent with other C-implemented methods. [<a href="https://bugs.ruby-lang.org/issues/20968">Bug #20968</a>]</p>

    <p>Before:</p>
    <div><div><pre><code>ruby -e &#39;[1].fetch_values(42)&#39;
&lt;internal:array&gt;:211:in &#39;Array#fetch&#39;: index 42 outside of array bounds: -1...1 (IndexError)
        from &lt;internal:array&gt;:211:in &#39;block in Array#fetch_values&#39;
        from &lt;internal:array&gt;:211:in &#39;Array#map!&#39;
        from &lt;internal:array&gt;:211:in &#39;Array#fetch_values&#39;
        from -e:1:in &#39;&lt;main&gt;&#39;
</code></pre></div>    </div>

    <p>After:</p>
    <div><div><pre><code>$ ruby -e &#39;[1].fetch_values(42)&#39;
-e:1:in &#39;Array#fetch_values&#39;: index 42 outside of array bounds: -1...1 (IndexError)
        from -e:1:in &#39;&lt;main&gt;&#39;
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="stdlib-compatibility-issues">Stdlib compatibility issues</h2>

<ul>
  <li>
    <p>CGI library is removed from the default gems. Now we only provide <code>cgi/escape</code> for
the following methods:</p>

    <ul>
      <li><code>CGI.escape</code> and <code>CGI.unescape</code></li>
      <li><code>CGI.escapeHTML</code> and <code>CGI.unescapeHTML</code></li>
      <li><code>CGI.escapeURIComponent</code> and <code>CGI.unescapeURIComponent</code></li>
      <li><code>CGI.escapeElement</code> and <code>CGI.unescapeElement</code></li>
    </ul>

    <p>[<a href="https://bugs.ruby-lang.org/issues/21258">Feature #21258</a>]</p>
  </li>
  <li>
    <p>With the move of <code>Set</code> from stdlib to core class, <code>set/sorted_set.rb</code> has
been removed, and <code>SortedSet</code> is no longer an autoloaded constant. Please
install the <code>sorted_set</code> gem and <code>require &#39;sorted_set&#39;</code> to use <code>SortedSet</code>.
[<a href="https://bugs.ruby-lang.org/issues/21287">Feature #21287</a>]</p>
  </li>
  <li>
    <p>Net::HTTP</p>

    <ul>
      <li>The default behavior of automatically setting the <code>Content-Type</code> header
to <code>application/x-www-form-urlencoded</code> for requests with a body
(e.g., <code>POST</code>, <code>PUT</code>) when the header was not explicitly set has been
removed. If your application relied on this automatic default, your
requests will now be sent without a Content-Type header, potentially
breaking compatibility with certain servers.
[<a href="https://github.com/ruby/net-http/issues/205">GH-net-http #205</a>]</li>
    </ul>
  </li>
</ul>

<h2 id="c-api-updates">C API updates</h2>

<ul>
  <li>
    <p>IO</p>

    <ul>
      <li><code>rb_thread_fd_close</code> is deprecated and now a no-op. If you need to expose
file descriptors from C extensions to Ruby code, create an <code>IO</code> instance
using <code>RUBY_IO_MODE_EXTERNAL</code> and use <code>rb_io_close(io)</code> to close it (this
also interrupts and waits for all pending operations on the <code>IO</code>
instance). Directly closing file descriptors does not interrupt pending
operations, and may lead to undefined behaviour. In other words, if two
<code>IO</code> objects share the same file descriptor, closing one does not affect
the other. [<a href="https://bugs.ruby-lang.org/issues/18455">Feature #18455</a>]</li>
    </ul>
  </li>
  <li>
    <p>GVL</p>

    <ul>
      <li><code>rb_thread_call_with_gvl</code> now works with or without the GVL.
This allows gems to avoid checking <code>ruby_thread_has_gvl_p</code>.
Please still be diligent about the GVL. [<a href="https://bugs.ruby-lang.org/issues/20750">Feature #20750</a>]</li>
    </ul>
  </li>
  <li>
    <p>Set</p>

    <ul>
      <li>
        <p>A C API for <code>Set</code> has been added. The following methods are supported:
[<a href="https://bugs.ruby-lang.org/issues/21459">Feature #21459</a>]</p>

        <ul>
          <li><code>rb_set_foreach</code></li>
          <li><code>rb_set_new</code></li>
          <li><code>rb_set_new_capa</code></li>
          <li><code>rb_set_lookup</code></li>
          <li><code>rb_set_add</code></li>
          <li><code>rb_set_clear</code></li>
          <li><code>rb_set_delete</code></li>
          <li><code>rb_set_size</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="implementation-improvements">Implementation improvements</h2>

<ul>
  <li><code>Class#new</code> (ex. <code>Object.new</code>) is faster in all cases, but especially when passing keyword arguments. This has also been integrated into YJIT and ZJIT. [<a href="https://bugs.ruby-lang.org/issues/21254">Feature #21254</a>]</li>
  <li>GC heaps of different size pools now grow independently, reducing memory usage when only some pools contain long-lived objects</li>
  <li>GC sweeping is faster on pages of large objects</li>
  <li>“Generic ivar” objects (String, Array, <code>TypedData</code>, etc.) now use a new internal “fields” object for faster instance variable access</li>
  <li>The GC avoids maintaining an internal <code>id2ref</code> table until it is first used, making <code>object_id</code> allocation and GC sweeping faster</li>
  <li><code>object_id</code> and <code>hash</code> are faster on Class and Module objects</li>
  <li>Larger bignum Integers can remain embedded using variable width allocation</li>
  <li><code>Random</code>, <code>Enumerator::Product</code>, <code>Enumerator::Chain</code>, <code>Addrinfo</code>,
<code>StringScanner</code>, and some internal objects are now write-barrier protected,
which reduces GC overhead.</li>
</ul>

<h3 id="ractor">Ractor</h3>

<p>A lot of work has gone into making Ractors more stable, performant, and usable. These improvements bring Ractor implementation closer to leaving experimental status.</p>

<ul>
  <li>Performance improvements
    <ul>
      <li>Frozen strings and the symbol table internally use a lock-free hash set [<a href="https://bugs.ruby-lang.org/issues/21268">Feature #21268</a>]</li>
      <li>Method cache lookups avoid locking in most cases</li>
      <li>Class (and generic ivar) instance variable access is faster and avoids locking</li>
      <li>CPU cache contention is avoided in object allocation by using a per-ractor counter</li>
      <li>CPU cache contention is avoided in xmalloc/xfree by using a thread-local counter</li>
      <li><code>object_id</code> avoids locking in most cases</li>
    </ul>
  </li>
  <li>Bug fixes and stability
    <ul>
      <li>Fixed possible deadlocks when combining Ractors and Threads</li>
      <li>Fixed issues with require and autoload in a Ractor</li>
      <li>Fixed encoding/transcoding issues across Ractors</li>
      <li>Fixed race conditions in GC operations and method invalidation</li>
      <li>Fixed issues with processes forking after starting a Ractor</li>
      <li>GC allocation counts are now accurate under Ractors</li>
      <li>Fixed TracePoints not working after GC [<a href="https://bugs.ruby-lang.org/issues/19112">Bug #19112</a>]</li>
    </ul>
  </li>
</ul>

<h2 id="jit">JIT</h2>

<ul>
  <li>ZJIT
    <ul>
      <li>Introduce an <a href="https://docs.ruby-lang.org/en/master/jit/zjit_md.html">experimental method-based JIT compiler</a>.
 Where available, ZJIT can be enabled at runtime with the <code>--zjit</code> option or by calling <code>RubyVM::ZJIT.enable</code>.
When building Ruby, Rust 1.85.0 or later is required to include ZJIT support.</li>
      <li>As of Ruby 4.0.0, ZJIT is faster than the interpreter, but not yet as fast as YJIT.
We encourage experimentation with ZJIT, but advise against deploying it in production for now.</li>
      <li>Our goal is to make ZJIT faster than YJIT and production-ready in Ruby 4.1.</li>
    </ul>
  </li>
  <li>YJIT
    <ul>
      <li><code>RubyVM::YJIT.runtime_stats</code>
        <ul>
          <li><code>ratio_in_yjit</code> no longer works in the default build.
Use <code>--enable-yjit=stats</code> on <code>configure</code> to enable it on <code>--yjit-stats</code>.</li>
          <li>Add <code>invalidate_everything</code> to default stats, which is
incremented when every code is invalidated by TracePoint.</li>
        </ul>
      </li>
      <li>Add <code>mem_size:</code> and <code>call_threshold:</code> options to <code>RubyVM::YJIT.enable</code>.</li>
    </ul>
  </li>
  <li>RJIT
    <ul>
      <li><code>--rjit</code> is removed. We will move the implementation of the third-party JIT API
to the <a href="https://github.com/ruby/rjit">ruby/rjit</a> repository.</li>
    </ul>
  </li>
</ul>

<p>See <a href="https://docs.ruby-lang.org/en/v4.0.0/NEWS_md.html">NEWS</a>
or <a href="https://github.com/ruby/ruby/compare/v3_4_0...v4.0.0">commit logs</a>
for more details.</p>

<p>With those changes, <a href="https://github.com/ruby/ruby/compare/v3_4_0...v4.0.0#file_bucket">3889 files changed, 230769 insertions(+), 297003 deletions(-)</a>
since Ruby 3.4.0!</p>

<p>Merry Christmas, a Happy New Year, and Happy Hacking with Ruby 4.0!</p>

<h2 id="download">Download</h2>

<ul>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.tar.gz">https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.tar.gz</a></p>

    <div><div><pre><code>SIZE: 23955109
SHA1: 754e39e9ad122e1b6deaed860350bac133a35ed3
SHA256: 2e8389c8c072cb658c93a1372732d9eac84082c88b065750db1e52a5ac630271
SHA512: 688254e939b197d564e896fb951bc1abf07142f489e91c5ed0b11f68f52d6adb6b1f86616fe03f1f0bb434beeef7e75e158b9c616afb39bb34403b0b78d2ee19
</code></pre></div>    </div>
  </li>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.tar.xz">https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.tar.xz</a></p>

    <div><div><pre><code>SIZE: 18008368
SHA1: 05ec670e86f84325c5353ef2f2888e53b6adc602
SHA256: a72bacee9de07283ebc19baa4ac243b193129f21aa4e168c7186fb1fe7d07fe1
SHA512: 2d5b2e566eaf70a5f3ea6ce6afc0611c0415de58a41336ef7a0b855c9a91eda9aa790a5f8b48e40a1eb9d50f8ea0f687216e617f16c8d040a08474f3116518a4
</code></pre></div>    </div>
  </li>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.zip">https://cache.ruby-lang.org/pub/ruby/4.0/ruby-4.0.0.zip</a></p>

    <div><div><pre><code>SIZE: 29253204
SHA1: 0b69f89d1d140157251c0d3a6032f6c45cdf81e8
SHA256: 70cb1bf89279b86ab9a975d504607c051fc05ee03e311d550a5541b65e373455
SHA512: a72e076ef618c0aeb9d20cf22e6fb12fda36809c0064ef0f98153b95a0bac257ef606342444a38f992c4594bf376a4d264686cf597463aa6f111220798784302
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="what-is-ruby">What is Ruby</h2>

<p>Ruby was first developed by Matz (Yukihiro Matsumoto) in 1993,
and is now developed as Open Source. It runs on multiple platforms
and is used all over the world especially for web development.</p>


        </div></div>
  </body>
</html>
