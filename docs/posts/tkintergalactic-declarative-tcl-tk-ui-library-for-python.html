<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/leontrolski/tkintergalactic">Original</a>
    <h1>Show HN: Tkintergalactic - Declarative Tcl/Tk UI Library for Python</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Declarative Tcl/Tk UI library for Python.</p>
<ul dir="auto">
<li>Somewhat React-like (there is effectively a Tk VDOM).</li>
<li>Well typed.</li>
<li>Maps very closely to the underlying Tcl/Tk for ease of debugging.</li>
<li>Zero dependency.</li>
<li>On mac sometimes you have to start by wiggling the window.</li>
<li>Small enough to understand how it works.</li>
<li>In an incomplete state - much functionality missing.</li>
</ul>

<p dir="auto">After <code>pip install tkintergalactic</code>, just run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import tkintergalactic as tk

counter = 0

@tk.command()
def inc_counter() -&gt; None:
    global counter
    counter += 1

tk.Window(
    app=lambda: tk.Frame(
        tk.Button(text=&#34;Hello World!&#34;, onbuttonrelease=inc_counter),
        tk.Text(content=f&#34;Button clicked {counter} times&#34;),
    ),
).run()"><pre><span>import</span> <span>tkintergalactic</span> <span>as</span> <span>tk</span>

<span>counter</span> <span>=</span> <span>0</span>

<span>@<span>tk</span>.<span>command</span>()</span>
<span>def</span> <span>inc_counter</span>() <span>-&gt;</span> <span>None</span>:
    <span>global</span> <span>counter</span>
    <span>counter</span> <span>+=</span> <span>1</span>

<span>tk</span>.<span>Window</span>(
    <span>app</span><span>=</span><span>lambda</span>: <span>tk</span>.<span>Frame</span>(
        <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;Hello World!&#34;</span>, <span>onbuttonrelease</span><span>=</span><span>inc_counter</span>),
        <span>tk</span>.<span>Text</span>(<span>content</span><span>=</span><span>f&#34;Button clicked <span><span>{</span><span>counter</span><span>}</span></span> times&#34;</span>),
    ),
).<span>run</span>()</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/leontrolski/tkintergalactic/blob/main/examples/screenshots/hello.gif"><img src="https://github.com/leontrolski/tkintergalactic/raw/main/examples/screenshots/hello.gif" alt="Hello world screencast" data-animated-image=""/></a></p>

<div dir="auto" data-snippet-clipboard-copy-content="from dataclasses import dataclass, field
import tkintergalactic as tk

@dataclass
class Task:
    description: str
    complete: bool = False

@dataclass
class State:
    tasks: list[Task] = field(default_factory=list)
    new_task_description: str = &#34;&#34;

state = State()

@tk.command()
def add_task() -&gt; None:
    state.tasks.append(Task(state.new_task_description))
    state.new_task_description = &#34;&#34;

@tk.command()
def delete_task(i: int) -&gt; None:
    state.tasks.pop(i)

@tk.command()
def toggle_class_complete(i: int) -&gt; None:
    state.tasks[i].complete = not state.tasks[i].complete

@tk.command(with_event=True)
def set_new_task_description(e: tk.EventKeyRelease) -&gt; None:
    state.new_task_description = e.value

tk.Window(
    title=&#34;TODO List&#34;,
    h=600,
    w=500,
    app=lambda: tk.Frame(
        tk.Frame(
            [
                tk.Frame(
                    tk.Entry(
                        value=task.description,
                        side=&#34;left&#34;,
                        font=tk.Font(styles=[&#34;overstrike&#34;]) if task.complete else tk.Font(),
                        expand=True,
                    ),
                    tk.Button(
                        text=&#34;✗&#34; if task.complete else &#34;✔&#34;,
                        onbuttonrelease=toggle_class_complete.partial(i=i),
                    ),
                    tk.Button(text=&#34;Delete&#34;, onbuttonrelease=delete_task.partial(i=i), side=&#34;right&#34;),
                    fill=&#34;x&#34;,
                    expand=True,
                )
                for i, task in enumerate(state.tasks)
            ],
            fill=&#34;x&#34;,
            expand=True,
        ),
        tk.Frame(
            tk.Entry(
                value=state.new_task_description,
                onkeyrelease=set_new_task_description,
                side=&#34;left&#34;,
                expand=True,
            ),
            tk.Button(
                text=&#34;New Task&#34;,
                onbuttonrelease=add_task,
            ),
            fill=&#34;x&#34;,
        ),
        tk.Text(
            content=f&#34;Total number of tasks: {len(state.tasks)}\nComplete: {sum(t.complete for t in state.tasks)}&#34;,
        ),
    ),
).run()"><pre><span>from</span> <span>dataclasses</span> <span>import</span> <span>dataclass</span>, <span>field</span>
<span>import</span> <span>tkintergalactic</span> <span>as</span> <span>tk</span>

<span>@<span>dataclass</span></span>
<span>class</span> <span>Task</span>:
    <span>description</span>: <span>str</span>
    <span>complete</span>: <span>bool</span> <span>=</span> <span>False</span>

<span>@<span>dataclass</span></span>
<span>class</span> <span>State</span>:
    <span>tasks</span>: <span>list</span>[<span>Task</span>] <span>=</span> <span>field</span>(<span>default_factory</span><span>=</span><span>list</span>)
    <span>new_task_description</span>: <span>str</span> <span>=</span> <span>&#34;&#34;</span>

<span>state</span> <span>=</span> <span>State</span>()

<span>@<span>tk</span>.<span>command</span>()</span>
<span>def</span> <span>add_task</span>() <span>-&gt;</span> <span>None</span>:
    <span>state</span>.<span>tasks</span>.<span>append</span>(<span>Task</span>(<span>state</span>.<span>new_task_description</span>))
    <span>state</span>.<span>new_task_description</span> <span>=</span> <span>&#34;&#34;</span>

<span>@<span>tk</span>.<span>command</span>()</span>
<span>def</span> <span>delete_task</span>(<span>i</span>: <span>int</span>) <span>-&gt;</span> <span>None</span>:
    <span>state</span>.<span>tasks</span>.<span>pop</span>(<span>i</span>)

<span>@<span>tk</span>.<span>command</span>()</span>
<span>def</span> <span>toggle_class_complete</span>(<span>i</span>: <span>int</span>) <span>-&gt;</span> <span>None</span>:
    <span>state</span>.<span>tasks</span>[<span>i</span>].<span>complete</span> <span>=</span> <span>not</span> <span>state</span>.<span>tasks</span>[<span>i</span>].<span>complete</span>

<span>@<span>tk</span>.<span>command</span>(<span>with_event</span><span>=</span><span>True</span>)</span>
<span>def</span> <span>set_new_task_description</span>(<span>e</span>: <span>tk</span>.<span>EventKeyRelease</span>) <span>-&gt;</span> <span>None</span>:
    <span>state</span>.<span>new_task_description</span> <span>=</span> <span>e</span>.<span>value</span>

<span>tk</span>.<span>Window</span>(
    <span>title</span><span>=</span><span>&#34;TODO List&#34;</span>,
    <span>h</span><span>=</span><span>600</span>,
    <span>w</span><span>=</span><span>500</span>,
    <span>app</span><span>=</span><span>lambda</span>: <span>tk</span>.<span>Frame</span>(
        <span>tk</span>.<span>Frame</span>(
            [
                <span>tk</span>.<span>Frame</span>(
                    <span>tk</span>.<span>Entry</span>(
                        <span>value</span><span>=</span><span>task</span>.<span>description</span>,
                        <span>side</span><span>=</span><span>&#34;left&#34;</span>,
                        <span>font</span><span>=</span><span>tk</span>.<span>Font</span>(<span>styles</span><span>=</span>[<span>&#34;overstrike&#34;</span>]) <span>if</span> <span>task</span>.<span>complete</span> <span>else</span> <span>tk</span>.<span>Font</span>(),
                        <span>expand</span><span>=</span><span>True</span>,
                    ),
                    <span>tk</span>.<span>Button</span>(
                        <span>text</span><span>=</span><span>&#34;✗&#34;</span> <span>if</span> <span>task</span>.<span>complete</span> <span>else</span> <span>&#34;✔&#34;</span>,
                        <span>onbuttonrelease</span><span>=</span><span>toggle_class_complete</span>.<span>partial</span>(<span>i</span><span>=</span><span>i</span>),
                    ),
                    <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;Delete&#34;</span>, <span>onbuttonrelease</span><span>=</span><span>delete_task</span>.<span>partial</span>(<span>i</span><span>=</span><span>i</span>), <span>side</span><span>=</span><span>&#34;right&#34;</span>),
                    <span>fill</span><span>=</span><span>&#34;x&#34;</span>,
                    <span>expand</span><span>=</span><span>True</span>,
                )
                <span>for</span> <span>i</span>, <span>task</span> <span>in</span> <span>enumerate</span>(<span>state</span>.<span>tasks</span>)
            ],
            <span>fill</span><span>=</span><span>&#34;x&#34;</span>,
            <span>expand</span><span>=</span><span>True</span>,
        ),
        <span>tk</span>.<span>Frame</span>(
            <span>tk</span>.<span>Entry</span>(
                <span>value</span><span>=</span><span>state</span>.<span>new_task_description</span>,
                <span>onkeyrelease</span><span>=</span><span>set_new_task_description</span>,
                <span>side</span><span>=</span><span>&#34;left&#34;</span>,
                <span>expand</span><span>=</span><span>True</span>,
            ),
            <span>tk</span>.<span>Button</span>(
                <span>text</span><span>=</span><span>&#34;New Task&#34;</span>,
                <span>onbuttonrelease</span><span>=</span><span>add_task</span>,
            ),
            <span>fill</span><span>=</span><span>&#34;x&#34;</span>,
        ),
        <span>tk</span>.<span>Text</span>(
            <span>content</span><span>=</span><span>f&#34;Total number of tasks: <span><span>{</span><span>len</span>(<span>state</span>.<span>tasks</span>)<span>}</span></span><span>\n</span>Complete: <span><span>{</span><span>sum</span>(<span>t</span>.<span>complete</span> <span>for</span> <span>t</span> <span>in</span> <span>state</span>.<span>tasks</span>)<span>}</span></span>&#34;</span>,
        ),
    ),
).<span>run</span>()</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/leontrolski/tkintergalactic/blob/main/examples/screenshots/todo.gif"><img src="https://github.com/leontrolski/tkintergalactic/raw/main/examples/screenshots/todo.gif" alt="TODO list screencast" data-animated-image=""/></a></p>

<p dir="auto">The packer is the main way of arranging Widgets.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import tkintergalactic as tk

tk.Window(
    title=&#34;Packer&#34;,
    w=200,
    h=300,
    app=lambda: tk.Frame(
        tk.Button(text=&#34;t&#34;, side=&#34;top&#34;, fill=&#34;x&#34;),
        tk.Button(text=&#34;b&#34;, side=&#34;bottom&#34;, fill=&#34;x&#34;),
        tk.Button(text=&#34;l&#34;, side=&#34;left&#34;),
        tk.Button(text=&#34;r&#34;, side=&#34;right&#34;),
        tk.Text(content=&#34;mid&#34;, expand=True, fill=&#34;both&#34;),
        fill=&#34;both&#34;,
        expand=True,
    ),
).run()"><pre><span>import</span> <span>tkintergalactic</span> <span>as</span> <span>tk</span>

<span>tk</span>.<span>Window</span>(
    <span>title</span><span>=</span><span>&#34;Packer&#34;</span>,
    <span>w</span><span>=</span><span>200</span>,
    <span>h</span><span>=</span><span>300</span>,
    <span>app</span><span>=</span><span>lambda</span>: <span>tk</span>.<span>Frame</span>(
        <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;t&#34;</span>, <span>side</span><span>=</span><span>&#34;top&#34;</span>, <span>fill</span><span>=</span><span>&#34;x&#34;</span>),
        <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;b&#34;</span>, <span>side</span><span>=</span><span>&#34;bottom&#34;</span>, <span>fill</span><span>=</span><span>&#34;x&#34;</span>),
        <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;l&#34;</span>, <span>side</span><span>=</span><span>&#34;left&#34;</span>),
        <span>tk</span>.<span>Button</span>(<span>text</span><span>=</span><span>&#34;r&#34;</span>, <span>side</span><span>=</span><span>&#34;right&#34;</span>),
        <span>tk</span>.<span>Text</span>(<span>content</span><span>=</span><span>&#34;mid&#34;</span>, <span>expand</span><span>=</span><span>True</span>, <span>fill</span><span>=</span><span>&#34;both&#34;</span>),
        <span>fill</span><span>=</span><span>&#34;both&#34;</span>,
        <span>expand</span><span>=</span><span>True</span>,
    ),
).<span>run</span>()</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/leontrolski/tkintergalactic/blob/main/examples/screenshots/packer.png"><img src="https://github.com/leontrolski/tkintergalactic/raw/main/examples/screenshots/packer.png" alt="Packer screenshot"/></a></p>


<p dir="auto">The majority of the functionality in the <a href="https://www.tcl-lang.org/man/tcl8.6/TkCmd/contents.htm" rel="nofollow">Tk Docs</a> is still not implemented, most of it is just a case of padding out existing functionality in <code>widgets.py</code>, however there are some complicated text buffer bits that would take a lot more work.</p>

<ul dir="auto">
<li>The diffing algorithm could be made more efficient - see eg. the referenced alogrithms in the <code>mithril</code> code.</li>
<li>Could allow passing optional <code>id</code>s to widgets to make diffing long lists more efficient.</li>
<li>More complicated state management a la React could be done. I&#39;d have a preference for a simpler &#34;this widget tree is the same as the other, don&#39;t diff&#34; approach that the user can opt in to.</li>
<li>Potentially a lot of the diffing code coudld be offloaded to Rust.</li>
<li>Before doing any of the above, set up benchmarking.</li>
</ul>

<ul dir="auto">
<li>Sort out distinct naming for custom python commands, TCL commands and subcommands.</li>
</ul>

<div data-snippet-clipboard-copy-content="uv pip install -e &#39;.[dev]&#39;
mypy .
pytest -vv"><pre><code>uv pip install -e &#39;.[dev]&#39;
mypy .
pytest -vv
</code></pre></div>
</article></div></div>
  </body>
</html>
