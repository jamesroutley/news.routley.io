<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sandyuraz.com/blogs/webp/">Original</a>
    <h1>WebP is such a goated format</h1>
    
    <div id="readability-page-1" class="page"><div id="content">

<p title="Sun, 03 Apr 2022">
93; 12022 H.E.
</p>
<p>
<strong>Update:</strong> hi, this page got a <a href="https://news.ycombinator.com/item?id=31010659">little traction</a> on HackerNews. I want to note that there are formats that are meant to supersede WebP, such as AVIF and JPEG XL, however, <a href="https://caniuse.com/avif">AVIF</a> (69.25%) and <a href="https://caniuse.com/jpegxl">JPEG XL</a> (0%) are not as nearly adopted as <a href="https://caniuse.com/webp">WebP</a> is (91.38%). Usage taken on April 13th, 2022. Also, get a browser released after 2013.
</p>
<div>
<h2 id="_motivation">Motivation</h2>
<div>
<p>
I have been toying around with <a href="https://en.wikipedia.org/wiki/WebP">WebP</a> for a couple of weeks now. Convert this image into webp and try to use it instead of traditional png. It was pretty crazy for me to see an up to 10x image size reduction, yet very little to no visual difference with a naked human eye.
</p>
<p>
Some further reading led me to some pleasant discoveries, such as lossy and lossless compression, transparency with an alpha channel, metadata, animation (!) support, and a wide adoption by major browsers and graphics software over the past decade or so.
</p>
<p>
This is truly some state-of-the-art stuff. Even as claiming an average of 45% reduction in file size with wild PNGs found on the web and a 28% reduction compared to PNGs that are recompressed with <a href="https://en.wikipedia.org/wiki/Pngcrush">pngcrush</a> and <a href="https://en.wikipedia.org/wiki/PNGOUT">PNGOUT</a>.

I should try this now!
</p></div>
</div>
<div>
<h2 id="_the_migration">The migration</h2>
<div>
<p>
The process of moving from PNG to WebP was painless. I rigged a quick <code>find</code> and <code>sed</code> script to go through all my directories and convert images with <a href="https://imagemagick.org">ImageMagick</a>. Another quick regex to find corresponding file links and references in org files, and replace them with anew webp format. It all took no more than 15 to 20 minutes. I talked to Darkness to <a href="https://github.com/thecsw/darkness/commit/85a89d871bcb272b9c2b7b36d02af67132dac834">support variable preview files</a> aaaannd <strong>push!</strong>
</p>
<p>
Wow, <em>it just works</em>. Even GitHub Pages deploys it in about halftime now. Let me see if we got any file size gains. I&#39;ll archive the whole website into two tar files: before and after webp changes (<code>.git</code> of course excluded).
</p>
<div>
<div>
<pre><code data-lang="sh">sandyuraz:source* λ ls -lh *.tar
-rw-r--r--  1 thecsw  staff   279M Apr  3 15:33 png.tar
-rw-r--r--  1 thecsw  staff   108M Apr  3 15:33 webp.tar</code></pre>
</div>
</div>

<p>
<strong>This is very nice</strong>. It’s less than half of what it was before! Going through some of the pages, even my eye can’t spot any differences that would be noticeable. WebP is good for all the stuff on the web. Choose your image formats based on your needs and requirements. For now, WebP looks like a great alternative. Thank you!
</p></div>
</div>
<div>
<h2 id="_example_">Example?</h2>

<p>
Let’s try to grab a picture in PNG format, convert it to WebP and see how the file size and image quality differ between those two. I&#39;ll have both examples from an amazing photographer <a href="https://mobile.twitter.com/shnimohus">@shnimohus</a>, whose shots <strong>I absolutely adore</strong>.
</p>
<p>
Below is the ImageMagick version I will be using when simply running <code>convert source.png target.webp</code>
</p>
<div>
<div>
<pre><code data-lang="sh">Version: ImageMagick 7.1.0-29 Q16-HDRI x86_64 19841 https://imagemagick.org
Copyright: (C) 1999 ImageMagick Studio LLC
License: https://imagemagick.org/script/license.php
Features: Cipher DPC HDRI Modules OpenMP(5.0)
Delegates (built-in): bzlib fontconfig freetype gslib heic jng jp2 jpeg lcms lqr ltdl lzma openexr png ps tiff webp xml zlib
Compiler: gcc (4.2)</code></pre>
</div>
</div>

<p>
Let’s see an example!
</p>
<p>
Here is a shot of a bus stop in PNG, weighing at around 2.4MB
</p>
<hr/>
<div>
<p><a href="https://sandyuraz.com/blogs/webp/booth.png"><img src="https://sandyuraz.com/blogs/webp/booth.png" alt="This is the PNG version"/></a>
</p>
<p>This is the PNG version</p>
</div>
<hr/>
<p>
As a comparison, here is the WebP generated from it, which is only about 258KB
</p>
<hr/>
<div>
<p><a href="https://sandyuraz.com/blogs/webp/booth.webp"><img src="https://sandyuraz.com/blogs/webp/booth.webp" alt="This is the WebP version"/></a>
</p>
<p>This is the WebP version</p>
</div>
<hr/>
<p>
For the sake of the experiment, try to dowload both files and see if you can spot any differences.
</p>
<p>
Here is one more example!
</p>
<hr/>
<div>
<p><a href="https://sandyuraz.com/blogs/webp/town.png"><img src="https://sandyuraz.com/blogs/webp/town.png" alt="This PNG is around 3.9MB"/></a>
</p>
<p>This PNG is around 3.9MB</p>
</div>
<hr/>
<p>
With its counterpart generated with <code>convert town.png town.webp</code>
</p>
<hr/>
<div>
<p><a href="https://sandyuraz.com/blogs/webp/town.webp"><img src="https://sandyuraz.com/blogs/webp/town.webp" alt="This WebP is only around 462KB"/></a>
</p>
<p>This WebP is only around 462KB</p>
</div>
<hr/>
<p>
Is this experiment biased? Definitely. I could have used some PNG compression techniques, go through ImageMagick’s documentation to fine-tune the conversion. However, the big point here is that without doing any of that, WebP seems to keep the quality I prefer while also reducing the size (doesn’t matter to me whether it’s lossy or lossless).
</p>
<p>
Thank you!  <b>◼︎</b>
</p>
</div>
</div></div>
  </body>
</html>
