<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://pepijndevos.nl/2023/12/24/lightweight-pure-css-gauge.html">Original</a>
    <h1>Lightweight pure CSS gauge</h1>
    
    <div id="readability-page-1" class="page"><div>
			
<article>
	
	<section>
	<p>The other day I was helping my brother with the second version of his performance installation <a href="http://jurriaandevos.nl/demarrage/">DEMARRAGE</a>, which involves serving a dashboard from an ESP32 that measures the energy produced by two dynamo bikes.</p>

<p>For this dashboard we wanted a simple gauge, so I figured a solution would be an internet search away. But all the examples I found seemed really complicated, with verbose markup, opaque CSS, and sometimes an entire JS library. So I decidede to make my own.</p>

<p><img src="http://pepijndevos.nl/images/gauge/dashboard.jpeg" alt="a dashboard showing a simple CSS gauge"/></p>

<p>My goals were</p>

<ul>
  <li>Very minimal HTML without any extra dummy elements.</li>
  <li>CSS that is easy to understand and modify.</li>
  <li>Easy to update the value from JS.</li>
  <li>A gauge of 270° rather than a semi-circle.</li>
  <li>(browser compat was not a goal)</li>
</ul>

<p>The HTML is as simple as it gets, just a <code>div</code> with custom properties and the textual value.</p>

<div><div><pre><code><span>&lt;div</span> <span>class=</span><span>&#34;gauge&#34;</span> <span>style=</span><span>&#34;--value:0.3; font-size:2rem;&#34;</span><span>&gt;</span>30%<span>&lt;/div&gt;</span>
</code></pre></div></div>

<p>Conceptually, the CSS isn’t very complicated either.</p>
<ul>
  <li>set the size of the gauge <code>div</code></li>
  <li>set a <code>border-radius</code> to make a circle</li>
  <li>draw a <code>conic-gradiant</code> to make a pie-chart</li>
  <li>draw a <code>radial-gradient</code> to cut out the center</li>
  <li>center the text with <code>text-align</code> and <code>line-height</code></li>
</ul>

<p>The code CSS makes use of <code>calc</code> and <code>var</code>, primarily to adjust the <code>conic-gradient</code> angle based on a custom property, but also to parameterize the dimensions of the gauge. This means you can override <code>--size</code> and friends to style the gauge without changing hardcoded values.</p>

<div><div><pre><code><span>.gauge</span> <span>{</span>
  <span>--size</span><span>:</span> <span>200px</span><span>;</span>
  <span>--cutout</span><span>:</span> <span>50%</span><span>;</span>
  <span>--color</span><span>:</span> <span>red</span><span>;</span>
  <span>--background</span><span>:</span> <span>white</span><span>;</span>
  <span>width</span><span>:</span><span>var</span><span>(</span><span>--size</span><span>);</span>
  <span>height</span><span>:</span><span>var</span><span>(</span><span>--size</span><span>);</span>
  <span>border-radius</span><span>:</span><span>calc</span><span>(</span><span>var</span><span>(</span><span>--size</span><span>)</span> <span>/</span> <span>2</span><span>);</span>
  <span>background</span><span>:</span>
    <span>radial-gradient</span><span>(</span>
        <span>var</span><span>(</span><span>--background</span><span>)</span> <span>0</span> <span>var</span><span>(</span><span>--cutout</span><span>),</span>
        <span>transparent</span> <span>var</span><span>(</span><span>--cutout</span><span>)</span> <span>100%</span><span>),</span>
    <span>conic-gradient</span><span>(</span><span>from</span> <span>-135deg</span><span>,</span> 
        <span>var</span><span>(</span><span>--color</span><span>)</span> <span>calc</span><span>(</span><span>270deg</span><span>*</span><span>var</span><span>(</span><span>--value</span><span>)),</span>
        <span>grey</span> <span>calc</span><span>(</span><span>270deg</span><span>*</span><span>var</span><span>(</span><span>--value</span><span>))</span> <span>270deg</span><span>,</span> 
        <span>transparent</span> <span>270deg</span><span>);</span>
  <span>text-align</span><span>:</span> <span>center</span><span>;</span>
  <span>line-height</span><span>:</span> <span>var</span><span>(</span><span>--size</span><span>);</span>
<span>}</span>

</code></pre></div></div>

<p>The JavaScript for changing the gauge value is pretty simple too, given some gauge DOM element <code>el</code> you can change the gauge value and text content by simply doing</p>

<div><div><pre><code><span>el</span><span>.</span><span>style</span><span>.</span><span>setProperty</span><span>(</span><span>&#34;</span><span>--value</span><span>&#34;</span><span>,</span> <span>0.8</span><span>)</span>
<span>el</span><span>.</span><span>innerHTML</span> <span>=</span> <span>&#34;</span><span>80%</span><span>&#34;</span>
</code></pre></div></div>

<p>Below is a codepen to play with the code. I hope it’s useful to someone.</p>

<p data-height="300" data-default-tab="result" data-slug-hash="LYaYMWO" data-user="pepijndevos">
  <span>See the Pen <a href="https://codepen.io/pepijndevos/pen/LYaYMWO">
  Pure CSS gauge</a> by Pepijn de Vos (<a href="https://codepen.io/pepijndevos">@pepijndevos</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>



	</section>
	
</article>


		</div></div>
  </body>
</html>
