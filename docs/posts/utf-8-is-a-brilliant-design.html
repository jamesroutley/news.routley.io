<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://iamvishnu.com/posts/utf8-is-brilliant-design">Original</a>
    <h1>UTF-8 is a brilliant design</h1>
    
    <div id="readability-page-1" class="page"><div><article>
    
    <time datetime="2025-09-12">2025-09-12</time>
    <meta name="format-detection" content="telephone=no"/>


<p>The first time I learned about UTF-8 encoding, I was fascinated by how well-thought and brilliantly it was designed to represent millions of characters from different languages and scripts, and <strong>still be backward compatible with ASCII.</strong></p>
<p>Basically UTF-8 uses 32 bits and the old ASCII uses 7 bits, but UTF-8 is designed in such a way that:</p>
<ul>
<li>Every ASCII encoded file is a valid UTF-8 file.</li>
<li>Every UTF-8 encoded file that has only ASCII characters is a valid ASCII file.</li>
</ul>
<p>Designing a system that scales to millions of characters and still be compatible with the old systems that use just 128 characters is a brilliant design.</p>
<blockquote>
<p>Note: If you are already aware of the UTF-8 encoding, you can explore the <a href="https://utf8-playground.netlify.app/" target="_blank" rel="noopener">UTF-8 Playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a> utility that I built to visualize UTF-8 encoding.</p>
</blockquote>
<h2>How Does UTF-8 Do It?</h2>
<p>UTF-8 is a variable-width character encoding designed to represent every character in the Unicode character set, encompassing characters from most of the world&#39;s writing systems.</p>
<p>It encodes characters using <strong>one to four bytes</strong>. </p>
<p>The first 128 characters (<code>U+0000</code> to <code>U+007F</code>) are encoded with a <strong>single byte,</strong> ensuring backward compatibility with ASCII, and this is the reason why a file with only ASCII characters is a valid UTF-8 file.</p>
<p>Other characters require two, three, or four bytes. The <strong>leading bits of the first byte</strong> determine the total number of bytes that represents the current character. These bits follow one of four specific patterns, which indicate how many continuation bytes follow.</p>
<table>
<thead>
<tr>
<th>1st byte Pattern</th>
<th># of bytes used</th>
<th>Full byte sequence pattern</th>
</tr>
</thead>
<tbody><tr>
<td><span>0xxxxxxx</span></td>
<td>1</td>
<td><span>0xxxxxxx</span></td>
</tr>
<tr>
<td><span>110xxxxx</span></td>
<td>2</td>
<td><span>110xxxxx</span> <span>10xxxxxx</span></td>
</tr>
<tr>
<td><span>1110xxxx</span></td>
<td>3</td>
<td><span>1110xxxx</span> <span>10xxxxxx</span> <span>10xxxxxx</span></td>
</tr>
<tr>
<td><span>11110xxx</span></td>
<td>4</td>
<td><span>11110xxx</span> <span>10xxxxxx</span> <span>10xxxxxx</span> <span>10xxxxxx</span></td>
</tr>
</tbody></table>
<p>Notice that the second, third, and fourth bytes in a multi-byte sequence <strong>always start with 10</strong>. This indicates that these bytes are continuation bytes, following the main byte.</p>
<p>The remaining bits in the main byte, along with the bits in the continuation bytes, are combined to form the character&#39;s code point. A code point serves as a unique identifier for a character in the Unicode character set. A code point is typically represented in hexadecimal format, prefixed with &#34;U+&#34;. For example, the code point for the character &#34;A&#34; is <code>U+0041</code>.</p>
<p>So here is how a software determines the character from the UTF-8 encoded bytes:</p>
<ol>
<li>Read a byte. If it starts with <code>0</code>, it&#39;s a single-byte character (ASCII). Show the character represented by the remaiing 7 bits on the screen. Continue with the next byte.</li>
<li>If the byte didn&#39;t start with a <code>0</code>, then:<ul>
<li>If it starts with <code>110</code>, it&#39;s a two-byte character, so read the next byte as well.</li>
<li>If it starts with <code>1110</code>, it&#39;s a three-byte character, so read the next two bytes.</li>
<li>If it starts with <code>11110</code>, it&#39;s a four-byte character, so read the next three bytes.</li>
</ul>
</li>
<li>Once the number of bytes are determined, read all the remaining bits except the leading bits, and find the binary value (aka. code point) of the character.</li>
<li>Look up the code point in the Unicode character set to find the corresponding character and display it on the screen.</li>
<li>Read the next byte and repeat the process.</li>
</ol>
<h3>Example: Hindi Letter &#34;à¤…&#34; (<a href="https://utf8-playground.netlify.app/0905" target="_blank" rel="noopener">open in UTF-8 Playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</h3>
<p>The Hindi letter &#34;à¤…&#34; (officially &#34;Devanagari Letter A&#34;) is represented in UTF-8 as:</p>
<p><span>11100000</span> <span>10100100</span> <span>10000101</span>
Here:</p>
<p>The first byte <span>11100000</span> indicates that the character is encoded using 3 bytes.</p>
<p>The remaining bits of the three bytes:
<span>xxxx0000</span> <span>xx100100</span> <span>xx000101</span> 
are combined to form the binary sequence <span>00001001</span> <span>00000101</span> (<code>0x0905</code> in hexadecimal). This is the code point of the character, represented as <code>U+0905</code>.</p>
<p>The code point <code>U+0905</code> (<a href="https://www.unicode.org/charts/PDF/U0900.pdf" target="_blank" rel="noopener">see official chart<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>) represents the Hindi letter &#34;à¤…&#34; in the Unicode character set.</p>
<h2>Example Text Files</h2>
<p>Now that we understood the design of UTF-8, let&#39;s look at a file that contains the following text:</p>
<h3>1. Text file contains: <code>HeyðŸ‘‹ Buddy</code></h3>
<p>The text <code>HeyðŸ‘‹ Buddy</code> has both English characters and an emoji character on it. The <a href="https://iamvishnu.com/utf8-samples/text_with_emoji_character.txt">text file</a> with this text saved on the disk will have the following <strong>13 bytes</strong> in it:</p>
<p><span>01001000</span> <span>01100101</span> <span>01111001</span> <span>11110000</span> <span>10011111</span> <span>10010001</span> <span>10001011</span> <span>00100000</span> <span>01000010</span> <span>01110101</span> <span>01100100</span> <span>01100100</span> <span>01111001</span></p>
<p>Let&#39;s evaluate this file byte-by-byte following the UTF-8 decoding rules:</p>
<table>
<thead>
<tr>
<th>Byte</th>
<th>Explanation</th>
</tr>
</thead>
<tbody><tr>
<td><span>01001000</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1001000</code> represent the letter &#39;H&#39;. (<a href="https://utf8-playground.netlify.app/0048" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100101</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100101</code> represent the letter &#39;e&#39;. (<a href="https://utf8-playground.netlify.app/0065" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01111001</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1111001</code> represent the letter &#39;y&#39;. (<a href="https://utf8-playground.netlify.app/0079" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>11110000</span></td>
<td>Starts with <code>11110</code>, indicating it&#39;s the <strong>first byte of a four-byte character.</strong></td>
</tr>
<tr>
<td><span>10011111</span></td>
<td>Starts with <code>10</code>, indicating it&#39;s a continuation byte.</td>
</tr>
<tr>
<td><span>10010001</span></td>
<td>Starts with <code>10</code>, indicating it&#39;s a continuation byte.</td>
</tr>
<tr>
<td><span>10001011</span></td>
<td>Starts with <code>10</code>, indicating it&#39;s a continuation byte.</td>
</tr>
<tr>
<td><span>00100000</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>0100000</code> represent a whitespace character. (<a href="https://utf8-playground.netlify.app/0020" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01000010</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1000010</code> represent the letter &#39;B&#39;. (<a href="https://utf8-playground.netlify.app/0042" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01110101</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1110101</code> represent the letter &#39;u&#39;. (<a href="https://utf8-playground.netlify.app/0075" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100100</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100100</code> represent the letter &#39;d&#39;. (<a href="https://utf8-playground.netlify.app/0064" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100100</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100100</code> represent the letter &#39;d&#39;. (<a href="https://utf8-playground.netlify.app/0064" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01111001</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1111001</code> represent the letter &#39;y&#39;. (<a href="https://utf8-playground.netlify.app/0079" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
</tbody></table>
<p>Now this is a valid UTF-8 file, but it doesn&#39;t have to be &#34;backward compatible&#34; with ASCII because it contains a non-ASCII character (the emoji). Next let&#39;s create a file that contains only ASCII characters.</p>
<h3>2. Text file contains: <code>Hey Buddy</code></h3>
<p>The <a href="https://iamvishnu.com/utf8-samples/text_with_ASCII_only.txt">text file</a> doesn&#39;t have any non-ASCII characters. The file saved on the disk has the following <strong>9 bytes</strong> in it:</p>
<p><span>01001000</span> <span>01100101</span> <span>01111001</span> <span>00100000</span> <span>01000010</span> <span>01110101</span> <span>01100100</span> <span>01100100</span> <span>01111001</span></p>
<p>Let&#39;s evaluate this file byte-by-byte following the UTF-8 decoding rules:</p>
<table>
<thead>
<tr>
<th>Byte</th>
<th>Explanation</th>
</tr>
</thead>
<tbody><tr>
<td><span>01001000</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1001000</code> represent the letter &#39;H&#39;. (<a href="https://utf8-playground.netlify.app/0048" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100101</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100101</code> represent the letter &#39;e&#39;. (<a href="https://utf8-playground.netlify.app/0065" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01111001</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1111001</code> represent the letter &#39;y&#39;. (<a href="https://utf8-playground.netlify.app/0079" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>00100000</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>0100000</code> represent a whitespace character. (<a href="https://utf8-playground.netlify.app/0020" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01000010</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1000010</code> represent the letter &#39;B&#39;. (<a href="https://utf8-playground.netlify.app/0042" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01110101</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1110101</code> represent the letter &#39;u&#39;. (<a href="https://utf8-playground.netlify.app/0075" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100100</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100100</code> represent the letter &#39;d&#39;. (<a href="https://utf8-playground.netlify.app/0064" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01100100</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1100100</code> represent the letter &#39;d&#39;. (<a href="https://utf8-playground.netlify.app/0064" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
<tr>
<td><span>01111001</span></td>
<td>Starts with <code>0</code>, so it&#39;s a single-byte ASCII character. The remaining bits <code>1111001</code> represent the letter &#39;y&#39;. (<a href="https://utf8-playground.netlify.app/0079" target="_blank" rel="noopener">open in playground<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>)</td>
</tr>
</tbody></table>
<p>So this is a valid UTF-8 file, <strong>and it is also a valid ASCII file</strong>. The bytes in this file follows both the UTF-8 and ASCII encoding rules. This is how UTF-8 is designed to be backward compatible with ASCII.</p>
<h2>Other Encodings</h2>
<p>I did a quick research on any other encoding that are backward compatible with ASCII, and there are a few, but they are not as popular as UTF-8, for example GB 18030 (a Chinese government standard). Another one is the ISO/IEC 8859 encodings are single-byte encodings that extend ASCII to include additional characters, but they are limited to 256 characters.</p>
<p>The siblings of UTF-8, like UTF-16 and UTF-32, are not backward compatible with ASCII. For example, the letter &#39;A&#39; in UTF-16 is represented as: <code>00 41</code> (two bytes), while in UTF-32 it is represented as: <code>00 00 00 41</code> (four bytes).</p>
<h2>Bonus: UTF-8 Playground</h2>
<p>When I was exploring the UTF-8 encoding, I couldn&#39;t find any good tool to interactively visualize how UTF-8 encoding works. So I built <strong>UTF-8 Playground</strong> to visualize and play around with UTF-8 encoding. <a href="https://utf8-playground.netlify.app/1F44B" target="_blank" rel="noopener">Give it a try!<svg aria-hidden="true" focusable="false" width="0.6em" height="0.6em" viewBox="0 0 24 24" style="vertical-align:text-top;"><path d="M5 19L19 5M5 5h14v14" stroke="currentColor" fill="none" stroke-width="3"></path></svg></a>.</p>

    <p>
        <a href="https://iamvishnu.com/tags/tech/" rel="tag">#tech</a>
        <a href="https://iamvishnu.com/tags/history/" rel="tag">#history</a>
        <a href="https://iamvishnu.com/tags/programming/" rel="tag">#programming</a>
    </p>
</article>
    </div></div>
  </body>
</html>
