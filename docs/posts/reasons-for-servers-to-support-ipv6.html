<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jvns.ca/blog/2022/01/29/reasons-for-servers-to-support-ipv6/">Original</a>
    <h1>Reasons for servers to support IPv6</h1>
    
    

<p>I&rsquo;ve been having a hard time understanding IPv6. On one hand, the basics initially seem pretty
straightforward (there aren&rsquo;t enough IPv4 addresses for all the devices on the
internet, so people invented IPv6! There are enough IPv6 addresses for
everyone!)</p>

<p>But when I try to actually understand it, I run into a lot of questions. One
question is: <code>twitter.com</code> does not support IPv6. Presumably it can&rsquo;t be causing
them THAT many issues to not support it. So why <em>do</em> websites support IPv6?</p>

<p>I asked people on Twitter <a href="https://twitter.com/b0rk/status/1487156306884636672">why their servers support IPv6</a>
and I got a lot of great answers, which I&rsquo;ll summarize here. These all come
with the disclaimer that I have basically 0 experience with IPv6 so I can&rsquo;t evaluate these reasons very well.</p>

<p>First though, I want to explain why it&rsquo;s possible for <code>twitter.com</code> to not
support IPv6 because I didn&rsquo;t understand that initially.</p>

<h3 id="how-can-you-tell-twitter-com-doesn-t-support-ipv6">how can you tell <code>twitter.com</code> doesn&rsquo;t support IPv6?</h3>

<p>You can tell they don&rsquo;t support IPv6 is because if you look up their AAAA
record (which contains their IPv6 address), there isn&rsquo;t one. Some other big
sites like <code>github.com</code> and <code>stripe.com</code> also don&rsquo;t support IPv6.</p>

<pre><code>$ dig AAAA twitter.com
(empty response)
$ dig AAAA github.com
(empty response)
$ dig AAAA stripe.com
(empty response)
</code></pre>

<h3 id="why-does-twitter-com-still-work-for-ipv6-users">why does <code>twitter.com</code> still work for IPv6 users?</h3>

<p>I found this really confusing, because I&rsquo;ve always heard that lots of internet
users are forced to use IPv6 because we&rsquo;ve run out of IPv4 addresses. But if
that&rsquo;s true, how could twitter.com continue to work for those people without
IPv6 support? Here&rsquo;s what I learned from the Twitter thread yesterday.</p>

<p>There are two kinds of internet service providers (ISPs):</p>

<ol>
<li>ISPs who own enough IPv4 address for all of their customers</li>
<li>ISPs who don&rsquo;t</li>
</ol>

<p>My ISP is in category 1 &ndash; my computer gets its own IPv4 address, and actually
my ISP doesn&rsquo;t even support IPv6 at all.</p>

<p>But lots of ISPs (especially outside of North America) are in category 2: they
don&rsquo;t have enough IPv4 addresses for all their customers. Those ISPs handle the problem by:</p>

<ul>
<li>giving all of their customers a unique IPv6 address, so they can access IPv6 sites directly</li>
<li>making large groups of their customers <em>share</em> IPv4 addresses. This can either be with CGNAT (&rdquo;<a href="https://en.wikipedia.org/wiki/Carrier-grade_NAT">carrier-grade NAT</a>&rdquo;) or &ldquo;464XLAT&rdquo; or maybe something else.</li>
</ul>

<p>All ISPs need <em>some</em> IPv4 addresses, otherwise it would be impossible for their
customers to access IPv4-only sites like twitter.com.</p>

<h3 id="what-are-the-reasons-to-support-ipv6">what are the reasons to support IPv6?</h3>

<p>Now we&rsquo;ve explained why it&rsquo;s possible to <em>not</em> support IPv6. So why support it?
There were a lot of reasons.</p>

<h3 id="reason-cgnat-is-a-bottleneck">reason: CGNAT is a bottleneck</h3>

<p>The argument that was most compelling to me was: CGNAT (carrier-grade NAT) is a
bottleneck and it causes performance issues, and it&rsquo;s going to continue to get
worse over time as access to IPv4 addresses becomes more and more restricted.</p>

<p>Someone also mentioned that because CGNAT is a bottleneck, it&rsquo;s an attractive
DDoS target because you can ruin lots of people&rsquo;s internet experience just by
attacking 1 server.</p>

<p>Servers supporting IPv6 reduces the need for CGNAT (IPv6 users can just connect
directly!) which makes the internet work better for everyone.</p>

<p>I thought this argument was interesting because it&rsquo;s a &ldquo;public commons&rdquo; /
community argument &ndash; it&rsquo;s less that supporting IPv6 will make your site
specifically work better, and more that if <em>almost everyone</em> supports IPv6 then
it&rsquo;ll make the experience of the internet better for everyone, especially in
countries where people don&rsquo;t have easy access to IPv4 addresses.</p>

<p>I don&rsquo;t actually know how much of an issue this is in practice.</p>

<p>There were lots of more selfish arguments to use IPv6 too though, so let&rsquo;s get
into those.</p>

<h3 id="reason-so-ipv6-only-servers-can-access-your-site">reason: so IPv6-only servers can access your site</h3>

<p>I said before that most IPv6 users still have access to IPv4 though some kind
of NAT. But apparently that&rsquo;s not true for everyone &ndash; some people mentioned
that they run some servers which only have IPv6 addresses and which aren&rsquo;t
behind any kind of NAT. So those servers are actually totally unable to access
IPv4-only sites.</p>

<p>I imagine that those servers aren&rsquo;t connecting to arbitrary machines that much
&ndash; maybe they only need to connect to a few hosts with IPv6 support.</p>

<p>But it makes sense to me that a machine should be able to access my site even
if it doesn&rsquo;t have an IPv4 address.</p>

<h3 id="reason-better-performance">reason: better performance</h3>

<p>For users who are using both IPv4 and IPv6 (with a dedicated IPv6 address and a
shared IPv4 address), apparently IPv6 is often faster because it doesn&rsquo;t need
to go through an extra translation layer.</p>

<p>So supporting IPv6 can make the site faster for users sometimes.</p>

<p>In practice clients use an algorithm called &ldquo;Happy Eyeballs&rdquo; which tries to
figure out whether IPv4 or IPv6 will be faster and then uses whichever seems
faster.</p>

<p>Some other performance benefits people mentioned:</p>

<ul>
<li>maybe sometimes using IPv6 can get you a SEO boost because of the better performance.</li>
<li>maybe using IPv6 causes you to go through better (faster) network hardware because it&rsquo;s a newer protocol</li>
</ul>

<h3 id="reason-resilience-against-ipv4-internet-outages">reason: resilience against IPv4 internet outages</h3>

<p>One person said that they&rsquo;ve run into issues where there was an internet outage
that only affected IPv4 traffic, because of accidental BGP poisoining.</p>

<p>So supporting IPv6 means that their site can still stay partially online during
those outages.</p>

<h3 id="reason-to-avoid-nat-issues-with-home-servers">reason: to avoid NAT issues with home servers</h3>

<p>A few people mentioned that it&rsquo;s much easier to use IPv6 with home servers &ndash;
instead of having to do port forwarding through your router, you can just give
every server a unique IPv6 address and then access it directly.</p>

<p>Of course, for this to work the client needs to have IPv6 support, but more and
more clients these days have IPv6 support too.</p>

<h3 id="reason-to-own-your-ip-addresses">reason: to own your IP addresses</h3>

<p>Apparently you can buy IPv6 addresses, use them for the servers on your home
network, and then if you change your ISP, continue to use the same IP
addresses?</p>

<p>I&rsquo;m still not totally sure how this works (I don&rsquo;t know how you would convince
computers on the internet to actually route those IPs to you? I guess you need
to run your own AS or something?).</p>

<h3 id="reason-to-learn-about-ipv6">reason: to learn about IPv6</h3>

<p>One person said they work in security and in security it&rsquo;s very important to
understand how internet protocols work (attackers are using internet
protocols!). So running an IPv6 server helps them learn how it works.</p>

<h3 id="reason-to-push-ipv6-forward-ipv4-is-legacy">reason: to push IPv6 forward / IPv4 is &ldquo;legacy&rdquo;</h3>

<p>A couple of people said that they support IPv6 because it&rsquo;s the current
standard, and so they want to contribute to the success of IPv6 by supporting
it.</p>

<p>A lot of people also said that they support IPv6 because they think sites that only
support IPv4 are &ldquo;behind&rdquo; or &ldquo;legacy&rdquo;.</p>

<h3 id="reason-it-s-easy">reason: it&rsquo;s easy</h3>

<p>I got a bunch of answers along the lines of &ldquo;it&rsquo;s easy, why not&rdquo;. Obviously
adding IPv6 support is not easy in all situations, but a couple of reasons it
might be easy in some cases:</p>

<ul>
<li>you automatically got an IPv6 address from your hosting company, so all you need to do is add an <code>AAAA</code> record pointing to that address</li>
<li>your site is behind a CDN that supports IPv6, so you don&rsquo;t need to do anything extra</li>
</ul>

<h3 id="reason-safer-networking-experimentation">reason: safer networking experimentation</h3>

<p>Because the address space is so big, if you want to try something out you can
just grab an IPv6 subnet, try out some things in it, and then literally never
use that subnet again.</p>

<h3 id="reason-to-run-your-own-autonomous-system-as">reason: to run your own autonomous system (AS)</h3>

<p>A few people said they were running their own autonomous system (I talked about what an AS is a bit in this <a href="https://jvns.ca/blog/2021/10/05/tools-to-look-at-bgp-routes/">BGP post</a>). IPv4 addresses are too expensive so they bought IPv6 addresses for their AS instead.</p>

<h3 id="reason-security-by-obscurity">reason: security by obscurity</h3>

<p>If your server <em>only</em> has a public IPv6 address, attackers can&rsquo;t easily find it
by scanning the whole internet. The IPv6 address space is too big to scan!</p>

<p>Obviously this shouldn&rsquo;t be your only security measure, but it seems like a
nice bonus &ndash; any time I run an IPv4 public server I&rsquo;m always a tiny bit
surprised by how it&rsquo;s constantly being scanned for vulnerabilities (like old versions of WordPress, etc).</p>

<h3 id="very-silly-reason-you-can-put-easter-eggs-in-your-ipv6-address">very silly reason: you can put easter eggs in your IPv6 address</h3>

<p>IPv6 addresses have a lot of extra bits in them that you can do frivolous
things with. For example one of Facebook&rsquo;s IPv6 addresses is
&ldquo;2a03:2880:f10e:83:face:b00c:0:25de&rdquo; (it has <code>face:b00c</code> in it).</p>

<h3 id="there-are-more-reasons-than-i-thought">there are more reasons than I thought</h3>

<p>That&rsquo;s all I&rsquo;ve learned about the &ldquo;why support IPv6?&rdquo; question so far.</p>

<p>I came away from this conversation more motivated to support IPv6 on my
(very small) servers than I had been before. But that&rsquo;s because I think
supporting IPv6 will require very little effort for me. (right now I&rsquo;m using a
CDN that supports IPv6 so it comes basically for free)</p>

<p>I know very little about IPv6 still but my impression is that IPv6 support
often isn&rsquo;t zero-effort and actually can be a lot of work. For example, I have
no idea how much work it would actually be for Twitter to add IPv6 support on
their edge servers.</p>

<h3 id="some-more-ipv6-questions">some more IPv6 questions</h3>

<p>Here are some more IPv6 questions I have that maybe I&rsquo;ll explore later:</p>

<ul>
<li>what are the <em>disadvantages</em> to supporting IPv6? what goes wrong?</li>
<li>what are the incentives for ISPs that own enough IPv4 addresses for their customers to support IPv6? (another way of asking: is it likely that my ISP will move to supporting IPv6 in the next few years? or are they just not incentivized to do it so it&rsquo;s unlikely?)</li>
<li><a href="https://docs.digitalocean.com/products/networking/floating-ips/">digital ocean</a> seems to only support IPv4 floating IPs, not IPv6 floating IPs. Why not? Shouldn&rsquo;t it be
<em>easier</em> to give out IPv6 floating IPs since there are more of them?</li>
<li>when I try to ping an IPv6 address (like example.com&rsquo;s IP <code>2606:2800:220:1:248:1893:25c8:1946</code> for example) I get the error <code>ping: connect: Network is unreachable</code>. Why? (answer: it&rsquo;s because my ISP doesn&rsquo;t support IPv6 so my computer doesn&rsquo;t have a public IPv6 address)</li>
</ul>

<p>This <a href="https://tailscale.com/kb/1134/ipv6-faq/">IPv4 vs IPv6 article from Tailscale</a> looks interesting and answers some of these questions.</p>

  </body>
</html>
