<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.maximeheckel.com/posts/shades-of-halftone/">Original</a>
    <h1>Shades of Halftone</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>There has recently been a newfound excitement for pattern-based post-processing
effects all over my timeline, as softwares such as <a href="https://paper.design/">Paper</a>, <a href="https://efecto.app/">Efecto</a>, or <a href="https://www.unicorn.studio/">Unicorn Studio</a>
are democratizing the use of shaders for both designers and developers. While some of these patterns originated as <em>workarounds</em> due to technical limitations we have since overcome, they now serve as an artistic direction to create distinct designs with self-imposed constraints.</p>
<p>One of those effects that kept coming back over and over again is <strong>halftone</strong>, the classic dot pattern, arranging dots of different sizes in a grid to give the optical illusion of a gradient of color to the observer. This technique was originally used to print images with limited ink colors, while today, it is more a versatile artistic tool used <a href="https://www.youtube.com/watch?v=kIhb5pEo_j0">across media</a>
and the web to give some kind of texture or grain to digital outputs. I personally find this effect <em>very</em> interesting, as it is inherently simple to implement in its classic form, but can quickly branch off to some complex and intricate visuals.</p>

<p>I’ve dedicated a lot of time over the past few months to trying the different flavors that
halftone can take and overlaying them on top of static images, videos, or interactive 3D scenes as shaders.
<strong>Simple dots on a grid</strong>, <strong>ink splatters</strong>, <strong>grids overlapping at an angle yielding some Moiré effects</strong>, <strong>blending colors in interesting ways</strong>, <strong>breaking the grid</strong>, etc.
I even tried my hand at seeing <strong>how halftone could be animated</strong> in a fun yet meaningful way. Every single one of these variants had its own interesting implementation details/shading techniques and aesthetic that I felt were worth writing about and breaking down to make building and designing with halftone more approachable.</p>

<section id="behind-the-dot-pattern-section">
<p>I explored several optical illusions and “trompe l’oeil” post-processing effects in <a href="https://probablydance.com/posts/post-processing-as-a-creative-medium/">Post-Processing Shaders as a Creative Medium</a> that create the illusion of texture or material, like woven crochet or glass. Halftone is, funnily enough, not so different as it is inherently an optical illusion itself.</p>
<p>The effect creates the impression of continuous/smooth tones, much like dithering, by providing a high-frequency grid of dots. Because these dots can be smaller than the <strong>eye&#39;s spatial resolution</strong>, the brain ends up performing <strong>a spatial average of the pattern</strong>. Thus, past a certain dot radius, we stop seeing individual dots composing the grid and instead <em>see</em> the <strong>ratio of &#39;ink&#39; to &#39;empty space&#39;</strong> as smooth tones.</p>
<figure><p><img alt="Classic halftone pattern" loading="lazy" width="663" height="295" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/halftone.png"/></p><figcaption>Classic halftone pattern</figcaption></figure>
<p>We will use those characteristics to guide and break down our implementation of halftone as a shader with GLSL.</p>
<h3 id="rendering-a-grid-of-dots">Rendering a grid of dots<a href="#rendering-a-grid-of-dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>To ensure this article is as approachable as possible to beginners, we’re going to build this effect from the ground up, starting with its most fundamental pieces. The first step is, as you may expect, to render a single dot or circle using GLSL and UV coordinates.</p>
<figure><p><img alt="Diagram breaking down the distance field and masking aspect of drawing a circle in a fragment shader" loading="lazy" width="663" height="399" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/mask-halftone.png"/></p><figcaption>Diagram breaking down the distance field and masking aspect of drawing a circle in a fragment shader</figcaption></figure>
<p>The diagram above illustrates the two key aspects of drawing a circle in a fragment shader:</p>
<ol>
<li><p>A distance <code>d</code> that represents the distance to the center point <code>{0.5, 0.5}</code> of our UV coordinate system. The results this yield is also called a <strong>distance field</strong></p></li>
<li><p>A mask: a threshold from which we decide what is <em>in</em> the dot, and what is outside.</p></li>
</ol>
<div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">step</span><span data-testid="content-line">(</span><span data-testid="content-line">0.35</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>4</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec3</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>By adjusting the mask function, we can also choose whether we prefer a softer or more defined result.</p>
<div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">0.32</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.37</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>4</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec3</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>With that, we now have the fundamental shape for our halftone effect and can focus on its second main characteristic, <strong>the grid</strong>. In GLSL, a grid can be achieved via the <code>fract</code> <sup><a id="ref-1" href="#fn-1">1</a></sup> function, which returns the fractional part of its number argument:</p>
<ul>
<li><p><code>fract(1.1)</code> returns <code>0.1</code></p></li>
<li><p><code>fract(0.9)</code> returns <code>0.9</code></p></li>
<li><p><code>fract(20.3)</code> returns <code>0.3</code></p></li>
</ul>
<p>Essentially, it is equivalent to doing <code>mod(x, 1)</code>, which returns any number after the floating point of <code>x</code>. Of course, if we just do <code>fract(uv)</code>, nothing will change, since our UVs are already defined within the standard <code>0.0 → 1.0</code> range.
What we need to do first is <strong>scale our UV coordinates by multiplying them by our grid size</strong>, and then use the scaled UVs as an argument for <code>fract</code>, which will result in our fragment shader tiling. The diagram below showcases our UV coordinates before and after tiling.</p>
<figure><p><img alt="Diagram showcasing the process of repeating patterns in a fragment shader using the fract function" loading="lazy" width="663" height="354" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-halftone.png"/></p><figcaption>Diagram showcasing the process of repeating patterns in a fragment shader using the fract function</figcaption></figure>
<p>Notice how we now have multiple <em>cells</em>, each with their own UV coordinates ranging from <code>0.0 -&gt; 1.0</code> and essentially running the same fragment shader. If we combine this with our circle code from above, each of these cell will draw its own circle, thus giving us our grid of dots!</p>
<p>The widget below showcases that and lets you:</p>
<ul>
<li><p>Scale up and down the grid.</p></li>
<li><p>Scale up and down the scale of the radius.</p></li>
</ul>
<p>while also displaying some variation in dot size, so you can start seeing the halftone effect at play with this very simple example.</p>
<div data-fullbleed="true"><div><div><div><pre><div data-testid="line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">uniform</span><span data-testid="content-line"> </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>7</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">uniform</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> uGridSize</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellUv </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fract</span><span data-testid="content-line">(</span><span data-testid="content-line">vUv </span><span data-testid="content-line">*</span><span data-testid="content-line"> uGridSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>13</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> radius </span><span data-testid="content-line">=</span><span data-testid="content-line"> uRadius </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">max</span><span data-testid="content-line">(</span><span data-testid="content-line">max</span><span data-testid="content-line">(</span><span data-testid="content-line">vUv</span><span data-testid="content-line">.</span><span data-testid="content-line">x</span><span data-testid="content-line">,</span><span data-testid="content-line"> vUv</span><span data-testid="content-line">.</span><span data-testid="content-line">y</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.2</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>15</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> radius </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>16</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec3</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.4</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.75</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>17</p><p><span><span data-testid="content-line">  fragColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">color</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div></pre></div></div></div></div>
<h3 id="applying-halftone">Applying Halftone<a href="#applying-halftone"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>While playing with dot radii can yield some beautiful patterns, one of the main appeals of halftone is to apply it as a <em>filter</em> on top of a 3D scene, image, or video. The result comes with a loss of details from the underlying media, but what we obtain in return is a kind of microtexture that fills in empty spaces with interesting shapes where we’d normally see flat colors.</p>
<p>If we simply apply the grid of dots from the previous section as a filter and color the dots based on the sampled pixels at that position, we’re only going to see a simple <em>mask</em>. To achieve a true halftone effect, we need to process our underlying texture first by <strong>pixelating</strong> it in such a way that it matches 1:1 our grid of dots.</p>

<p>An interesting aspect of this pixelization logic is how we rely on the <code>floor</code> function to define our <code>pixelatedUV</code> coordinates. This function removes the decimals of our UV coordinates, the opposite effect of <code>fract</code>, and thus ensures that each pixel within a given cell samples the same color, thus resulting in a pixelated look and feel for our texture.</p>
<div><pre><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">=</span><span data-testid="content-line"> uPixelSize </span><span data-testid="content-line">/</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>3</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvPixel </span><span data-testid="content-line">=</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">uv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec4</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvPixel</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>7</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellUv </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fract</span><span data-testid="content-line">(</span><span data-testid="content-line">uv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>8</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">uRadius </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> uRadius </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line">color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">color</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>Combining this with our grid of dots, like in the code snippet above, brings us one step closer to a halftone effect.</p>
<div data-fullbleed="true"><div><div><div><div><p><span>Uniforms</span></p><p><label for="_R_etpu6_-displayCircleMask">Display Circle Mask</label></p><p><label for="_R_etpu6_-usePixelatedUv">Use Pixelated UV</label></p></div></div></div></div></div>
<p>Of course, there’s still something missing here from our original definition of halftone, the variation of dot size! We can implement this easily by using the luma of a given pixel, and tweak the radius based on its value.</p>
<div><pre><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">=</span><span data-testid="content-line"> uPixelSize </span><span data-testid="content-line">/</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>3</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvPixel </span><span data-testid="content-line">=</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">uv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec4</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvPixel</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>6</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> luma </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">dot</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.2126</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.7152</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0722</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> color</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>7</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> radius </span><span data-testid="content-line">=</span><span data-testid="content-line"> uRadius </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">0.1</span><span data-testid="content-line"> </span><span data-testid="content-line">+</span><span data-testid="content-line"> luma</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>9</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellUv </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fract</span><span data-testid="content-line">(</span><span data-testid="content-line">uv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> radius </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>14</p><p><span><span data-testid="content-line">color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">color</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>Moreover, if we wanted to display a grayscale version of our halftone, we could also do so using that same value, which you can see the result below by toggling on the &#34;Luma-based radius&#34; and changing the color mode of the output.</p>
<div data-fullbleed="true"><div><div><div><div><p><span>Uniforms</span></p><p><label for="_R_gtpu6_-displayCircleMask">Display Circle Mask</label></p><p><label for="_R_gtpu6_-usePixelatedUv">Use Pixelated UV</label></p><p><label for="_R_gtpu6_-displayLuma">Use Luma based radius</label></p></div></div></div></div></div>

<p>More interesting variants of halftone can be achieved by introducing a <strong>grid offset</strong>, thus staggering the dots instead of having them perfectly aligned. This allows for a higher density of dots in our pattern, reducing the amount of white space. This offset is defined by tweaking our UVs, thus propagating it not only in how we lay down our dots but also how we sample our texture and pixelize it.</p>
<div><pre><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">=</span><span data-testid="content-line"> pixelSize </span><span data-testid="content-line">/</span><span data-testid="content-line"> resolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> rowIndex </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">.</span><span data-testid="content-line">y </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">.</span><span data-testid="content-line">y</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>6</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">if</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">offset </span><span data-testid="content-line">&amp;&amp;</span><span data-testid="content-line"> </span><span data-testid="content-line">mod</span><span data-testid="content-line">(</span><span data-testid="content-line">rowIndex</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">2.0</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">==</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>7</p><p><span><span data-testid="content-line">    offsetUv</span><span data-testid="content-line">.</span><span data-testid="content-line">x </span><span data-testid="content-line">+=</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">.</span><span data-testid="content-line">x </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvPixel </span><span data-testid="content-line">=</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">offsetUv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>11</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec4</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvPixel</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div></pre></div>
<p>The playground below implements this on top of a React Three Fiber 3D scene, thus letting you not only explore this variant alongside all the
others we’ve seen so far but also play with many of the settings over a dynamic scene where I think halftone shines the most: on top of organic-moving objects, bringing a lovely contrasting aesthetic to the scene.</p>

<h3 id="not-just-dots">Not just dots<a href="#not-just-dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>When the Paper team announced their halftone presets, back in November 2025, they showcased a lot of halftone variants I had not seen before. It turns out that circles are just a part of the wide spectrum of halftone patterns available, and we can allow ourselves to tweak the original definition of the effect with what I dubbed <em>“dot adjacent”</em> shapes.</p>
<div><div><div><p><a href="https://twitter.com/sdothaney" target="_blank" rel="noopener noreferrer"><span><span><img alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2746%27%20height=%2746%27/%3e"/></span><img alt="sdothaney" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic"/></span></a></p></div><a href="https://twitter.com/sdothaney/status/1993021342413991987" target="_blank" rel="noopener noreferrer" aria-label="@sdothaney&#39;s Twitter profile"><svg viewBox="328 355 335 276" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M 630, 425    A 195, 195 0 0 1 331, 600    A 142, 142 0 0 0 428, 570    A  70,  70 0 0 1 370, 523    A  70,  70 0 0 0 401, 521    A  70,  70 0 0 1 344, 455    A  70,  70 0 0 0 372, 460    A  70,  70 0 0 1 354, 370    A 195, 195 0 0 0 495, 442    A  67,  67 0 0 1 611, 380    A 117, 117 0 0 0 654, 363    A  65,  65 0 0 1 623, 401    A 117, 117 0 0 0 662, 390    A  65,  65 0 0 1 630, 425    Z" style="fill:#3BA9EE"></path></svg></a></div><p>Today we launch an iconic new shader in @paper 

Yesterday&#39;s constraints, a portal to the past, what if the classics never faded?

Come play with Halftone Dots. Drop in any image to create an iconic design.

Design can feel like play again... link in the replies https://t.co/xrI6bOhJ2n</p></div>
<p>The first one we can take a look at is directly inspired by the video featured in the tweet above: dots and squares, which is a combination of:</p>
<ul>
<li><p>The classic dot pattern we implemented already</p></li>
<li><p>An inverted pattern where we can find white dots inside colored pixels. The darker the underlying pixel, the bigger the white dot.</p></li>
</ul>
<div data-fullbleed="true"><div><figure><p><img alt="Diagram showcasing the white dot halftone pattern based on the luma of the underlying cell color" loading="lazy" width="663" height="300" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/luma-halftone.png"/></p><figcaption>Diagram showcasing the white dot halftone pattern based on the luma of the underlying cell color</figcaption></figure></div></div>
<p>Those two patterns complement each other very well, and can be mixed and matched based on luma, as showcased in the demo below:</p>
<ul>
<li><p>A darker pixel would yield a “square with white dot.”</p></li>
<li><p>A lighter pixel would yield a standard dot.</p></li>
</ul>
<p>This has the effect of preserving much more of the original texture while still making the brighter parts of it standard halftone.</p>
<p>We can also choose to go all in one of the patterns as showcased below, where I overlaid the different patterns on top of a video so we can see the effect at play on a subtly dynamic media:</p>

<p>Another type of halftone I found interesting to highlight is the <strong>ring variant</strong>. I originally got inspired some of the work of <a href="https://twitter.com/poetengineer__">@poetengineer__</a> who made some beautiful uncommon halftone renders:</p>
<div><p>☁️ https://t.co/P9jKe6NSBj</p></div>
<p>Making a ring is actually simpler than it looks: we just need to define two circles, and combine them using an <code>A AND NOT B</code> combinatory logic.</p>
<figure><p><img alt="Diagram illustrating an arbitrary set of nodes for a given material and a representation of the data they can override." loading="lazy" width="663" height="558" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/ring-halftone.png"/></p><figcaption>Diagram illustrating an arbitrary set of nodes for a given material and a representation of the data they can override.</figcaption></figure>
<div><pre><div data-testid="line"><p>3</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> radius </span><span data-testid="content-line">=</span><span data-testid="content-line"> uRadius </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">0.2</span><span data-testid="content-line"> </span><span data-testid="content-line">+</span><span data-testid="content-line"> luma</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> ringThickness </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">0.1</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>6</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> innerRadius </span><span data-testid="content-line">=</span><span data-testid="content-line"> radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> ringThickness</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>8</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> outerCircle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> radius </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>9</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> innerCircle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">innerRadius </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> innerRadius </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.01</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>11</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> ring </span><span data-testid="content-line">=</span><span data-testid="content-line"> innerCircle </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> outerCircle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>13</p><p><span><span data-testid="content-line">color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> color</span><span data-testid="content-line">,</span><span data-testid="content-line"> ring</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>Applying this effect with a monochromatic palette to a video yields a <code>technical/low-res</code> aesthetic, almost terminal-like,  unlike the more in-your-face and high contrast big bright dots of your standard halftone variant.</p>


</section><section id="multichannel-halftoning-and-interferences-section"><div><h2 id="multichannel-halftoning-and-interferences">Multichannel Halftoning and Interferences<a href="#multichannel-halftoning-and-interferences"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h2></div>
<p>Until now, we have considered the case of a monochromatic halftone, where the tones are defined by the concentration of dots in a single grid. We also tried our hand at “colored” halftone, but we were merely picking up colors from the underlying texture/media and not really pushing the optical illusion of this effect to its full extent.</p>
<p>Indeed, instead of treating halftone as a simple grid, we can also view it as <strong>a stack of grids</strong>, <strong>where each layer corresponds to a specific color channel of the underlying image</strong>. We can derive our layers defined through the Red, Green, and Blue color channels for an RGB look, or Cyan, Magenta, Yellow, and Key for a classic CMYK printing finish. This technique will expand what we can do with regard to building halftone shaders, but it will also come at a cost of visual artifacts and interference, which we must first understand to work around them.</p>
<h3 id="moiré-pattern">Moiré Pattern<a href="#moiré-pattern"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>You may have encountered Moiré patterns in your renders from time to time when experimenting with overlapping repeating patterns. This type of interference manifests when two almost identical patterns are overlaid on top of each other <sup><a id="ref-3" href="#fn-3">3</a></sup>. By <em>almost identical</em>, here I mean:</p>
<ul>
<li><p>They could not be completely identical, for example, different frequencies.</p></li>
<li><p>They could be identical, but need to be displaced or rotated.</p></li>
</ul>
<p>It occurs in both physical and digital media alike, and is yet another optical illusion / perception artifact due to our brain trying to reconcile the intersection of two competing patterns.</p>

<p>The widget below demonstrates this effect on very simple examples for you to try:</p>
<ul>
<li><p>We have a version where two grids are stacked on top of each other. Rotating one will cause quite a few interferences.</p></li>
<li><p>The other example consists of a two stacked Poisson distribution, where the slightest rotation reveals circular interferences.</p></li>
</ul>

<p>The GLSL implementation is rather straightforward and can serve you as a base for your own Moiré-like experiences.</p>
<div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">mat2</span><span data-testid="content-line"> </span><span data-testid="content-line">rotate</span><span data-testid="content-line">(</span><span data-testid="content-line">float</span><span data-testid="content-line"> angle</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>4</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">return</span><span data-testid="content-line"> </span><span data-testid="content-line">mat2</span><span data-testid="content-line">(</span><span data-testid="content-line">c</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line">s</span><span data-testid="content-line">,</span><span data-testid="content-line"> s</span><span data-testid="content-line">,</span><span data-testid="content-line"> c</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>7</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> </span><span data-testid="content-line">circleGrid</span><span data-testid="content-line">(</span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> radius</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> angle</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>8</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> normalizedPixelSize </span><span data-testid="content-line">=</span><span data-testid="content-line"> uPixelSize </span><span data-testid="content-line">/</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>11</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvPx </span><span data-testid="content-line">=</span><span data-testid="content-line"> uv </span><span data-testid="content-line">*</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>12</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> rotatedPx </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">rotate</span><span data-testid="content-line">(</span><span data-testid="content-line">angle</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">*</span><span data-testid="content-line"> uvPx</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>13</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> rotatedUv </span><span data-testid="content-line">=</span><span data-testid="content-line"> rotatedPx </span><span data-testid="content-line">/</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>15</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellUv </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fract</span><span data-testid="content-line">(</span><span data-testid="content-line">rotatedUv </span><span data-testid="content-line">/</span><span data-testid="content-line"> normalizedPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>16</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">cellUv </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>18</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> edgeWidth </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fwidth</span><span data-testid="content-line">(</span><span data-testid="content-line">dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>20</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> edgeWidth</span><span data-testid="content-line">,</span><span data-testid="content-line"> radius </span><span data-testid="content-line">+</span><span data-testid="content-line"> edgeWidth</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>28</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> circleGridA </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">circleGrid</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> uRadius</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>29</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> circleGridB </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">circleGrid</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> uRadius</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">radians</span><span data-testid="content-line">(</span><span data-testid="content-line">uAngle</span><span data-testid="content-line">)</span><span data-testid="content-line">)</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>31</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec3</span><span data-testid="content-line"> colorA </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circleGridA</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>32</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec3</span><span data-testid="content-line"> colorB </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> circleGridB</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>34</p><p><span><span data-testid="content-line">  fragColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">max</span><span data-testid="content-line">(</span><span data-testid="content-line">colorA</span><span data-testid="content-line">,</span><span data-testid="content-line"> colorB</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div></pre></div>
<p>This will inevitably occur in the examples of this section of the article, as we will start building multichannel halftoning. The artifact can be embraced or seen as an issue to mitigate, as the printing industry often does by applying workarounds.
In our case, we&#39;ll solve this problem by <strong>applying specific rotations to each individual layer</strong>, thus reducing the interference to a minimum. We will see this technique in action in our upcoming implementation of CMYK halftone.</p>
<h3 id="digital-vs-physical-color-blending">Digital vs Physical color blending<a href="#digital-vs-physical-color-blending"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>The main use case for our multichannel implementation of halftone is for each layer to hold a specific color channel and blend into one another, <strong>reproducing the optical mixing found in physical print</strong>. We can opt for layers representing either:</p>
<ul>
<li><p>RGB for a more digital-like render.</p></li>
<li><p>CMYK for a more physical look.</p></li>
</ul>
<p>However, the blending of these two color models differs:</p>
<ul>
<li><p>The former one is based on the <em>addition</em> of light starting from a black display. The red, blue, and green color channels add up to white.</p></li>
<li><p>The latter, on the <em>subtraction</em> of color from light being absorbed, starting from a white paper. The cyan, magenta, and yellow “inks” filter the light hitting them. The more of them overlap, the darker the resulting tone as light gets further filtered, eventually reaching black.</p></li>
</ul>
<p>We can see this firsthand below, where I reproduce the RGB and CMY color blending variants on HTML canvases.</p>

<p>Mathematically speaking, here is what is happening. For the RGB variant, we’re simply adding the color intensity of each channel, i.e.,
<code>ColorOut = (Ir, 0, 0) + (0, Ig, 0) + (0, 0, Ib)</code>. Adding/composing color channels is something we do quite often in GLSL for several effects like <a href="https://probablydance.com/posts/refraction-dispersion-and-other-shader-light-effects/">refraction, or dispersion</a>. As the values approach <code>1.0</code>, their combination tends towards <code>(1.0, 1.0, 1.0)</code>, i.e., white, which is represented in the chart below:</p>


<p>For CMY subtractive blending, which mathematically is a bit of a misnomer, it can be represented through a multiplication:
<code>ColorOut = White * (1.0 - C) * (1.0 - M) * (1.0 - Y)</code>. The <em>subtractive</em> nature of this blending  refers to the physics of light absorption: each color channel acts as a filter that absorbs specific wavelengths from white light, only to leave the leftovers to the viewer. That’s why overlapping all the color channels results in black.</p>
<figure><p><img alt="Diagram showcasing subtractive color blending for cyan, magenta, yellow, and all the pairs they can form" loading="lazy" width="663" height="409" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/subtractive-blending2.png"/></p><figcaption>Diagram showcasing subtractive color blending for cyan, magenta, yellow, and all the pairs they can form</figcaption></figure>
<p>The chart below represents the reflectance profile of cyan, magenta, and yellow across the visible spectrum, as well as the resulting filter:</p>

<p>Notice how the resulting color for the blending corresponds to <strong>the overlapping area shared by all the curves</strong>.</p>
<h3 id="cmyk-halftone">CMYK halftone<a href="#cmyk-halftone"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>The halftone variant we’re about to look at is perhaps the main reason I wrote the article in the first place. I originally got inspired by some of the work of <a href="https://twitter.com/floguo">@floguo</a> who produced some renders where this pattern really shone.</p>
<div><p>study no. 03 https://t.co/5V6Kf3fabI</p></div>
<p>This intrigued me, so I tried my hand at reproducing a shader for it, which nerd-snipped me and led me to learn a lot about color blending, Moiré, and halftone in general. Since, to build this effect, we’d need to overlay 4 distinct grids of dots, doing so naively would immediately give us some Moiré patters and make the colors a bit <em>washed out</em>. Instead, we need to rotate each layer at a specific angle set of angles to yield an image with as few artifacts as possible. The widget below reproduces the CMYK halftone variant with preset angle values of:</p>
<ul>
<li><p><code>15.0</code> for cyan</p></li>
<li><p><code>75.0</code> for magenta</p></li>
<li><p><code>0.0</code> for yellow</p></li>
<li><p><code>45.0</code> for key</p></li>
</ul>
<p>I recommend playing with the angle values and dot density to see the differences in output.</p>

<p>As you can see above, the size of the individual dots varies based on the underlying sampled color. With just these 4 colors and the ability to tweak each dots size and density, we can obtain any type of shade necessary to render a colored output, just like print!</p>
<figure><p><img alt="Diagram showcasing the breakdown of red, green, and blue with CMYK dots" loading="lazy" width="663" height="428" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cmyk-halftone.png"/></p><figcaption>Diagram showcasing the breakdown of red, green, and blue with CMYK dots</figcaption></figure>
<p>Implementation-wise, we can work on top of our classic halftone base. However, we’d first need to convert our sampled color from RGB to CMYK. I used a function from <a href="https://www.mattdesl.com/">Matt DesLauriers</a> to do so:</p>
<div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">vec4</span><span data-testid="content-line"> </span><span data-testid="content-line">RGBtoCMYK</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">vec3</span><span data-testid="content-line"> rgb</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>5</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> k </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">min</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> r</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">min</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> g</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> b</span><span data-testid="content-line">)</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>11</p><p><span><span data-testid="content-line">    cmy</span><span data-testid="content-line">.</span><span data-testid="content-line">x </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> r </span><span data-testid="content-line">-</span><span data-testid="content-line"> k</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">/</span><span data-testid="content-line"> invK</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line">    cmy</span><span data-testid="content-line">.</span><span data-testid="content-line">y </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> g </span><span data-testid="content-line">-</span><span data-testid="content-line"> k</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">/</span><span data-testid="content-line"> invK</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>13</p><p><span><span data-testid="content-line">    cmy</span><span data-testid="content-line">.</span><span data-testid="content-line">z </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> b </span><span data-testid="content-line">-</span><span data-testid="content-line"> k</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">/</span><span data-testid="content-line"> invK</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>16</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">return</span><span data-testid="content-line"> </span><span data-testid="content-line">clamp</span><span data-testid="content-line">(</span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">cmy</span><span data-testid="content-line">,</span><span data-testid="content-line"> k</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div></pre></div>
<p>Then, we can generate our grid of dots for each individual channel, and have the coverage/radius of their dots match the intensity of that color channel at that given position on screen.</p>
<div><pre><div data-testid="highlight-line"><p>1</p><p><span><span data-testid="content-line">vec2</span><span data-testid="content-line"> </span><span data-testid="content-line">toGridUV</span><span data-testid="content-line">(</span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>2</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">return</span><span data-testid="content-line"> </span><span data-testid="content-line">rot</span><span data-testid="content-line">(</span><span data-testid="content-line">angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">uv </span><span data-testid="content-line">*</span><span data-testid="content-line"> resolution</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">/</span><span data-testid="content-line"> pixelSize</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>5</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> </span><span data-testid="content-line">getCellCenterUV</span><span data-testid="content-line">(</span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>6</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> gridUV </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">toGridUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>7</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellCenter </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">gridUV</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>8</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> centerScreen </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">rot</span><span data-testid="content-line">(</span><span data-testid="content-line">-</span><span data-testid="content-line">angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">*</span><span data-testid="content-line"> cellCenter </span><span data-testid="content-line">*</span><span data-testid="content-line"> pixelSize</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>9</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">return</span><span data-testid="content-line"> centerScreen </span><span data-testid="content-line">/</span><span data-testid="content-line"> resolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> </span><span data-testid="content-line">halftoneDot</span><span data-testid="content-line">(</span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> angleDeg</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line"> coverage</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>13</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> gridUV </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">toGridUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> angleDeg</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>14</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> distToCenter </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fract</span><span data-testid="content-line">(</span><span data-testid="content-line">gridUV</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>16</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> r </span><span data-testid="content-line">=</span><span data-testid="content-line"> dotSize </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">sqrt</span><span data-testid="content-line">(</span><span data-testid="content-line">clamp</span><span data-testid="content-line">(</span><span data-testid="content-line">coverage</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>17</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> aa </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fwidth</span><span data-testid="content-line">(</span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">distToCenter</span><span data-testid="content-line">)</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>18</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> d </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">distToCenter</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>19</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">return</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">r </span><span data-testid="content-line">-</span><span data-testid="content-line"> aa</span><span data-testid="content-line">,</span><span data-testid="content-line"> r </span><span data-testid="content-line">+</span><span data-testid="content-line"> aa</span><span data-testid="content-line">,</span><span data-testid="content-line"> d</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>22</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">void</span><span data-testid="content-line"> </span><span data-testid="content-line">mainImage</span><span data-testid="content-line">(</span><span data-testid="content-line">const</span><span data-testid="content-line"> </span><span data-testid="content-line">in</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> inputColor</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">const</span><span data-testid="content-line"> </span><span data-testid="content-line">in</span><span data-testid="content-line"> </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">out</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> outputColor</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>23</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvC </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">getCellCenterUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_C</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>24</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvM </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">getCellCenterUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_M</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>25</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvY </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">getCellCenterUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_Y</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>26</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvK </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">getCellCenterUV</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_K</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>28</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> cmykC </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">RGBtoCMYK</span><span data-testid="content-line">(</span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvC</span><span data-testid="content-line">)</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>29</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> cmykM </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">RGBtoCMYK</span><span data-testid="content-line">(</span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvM</span><span data-testid="content-line">)</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>30</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> cmykY </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">RGBtoCMYK</span><span data-testid="content-line">(</span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvY</span><span data-testid="content-line">)</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>31</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> cmykK </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">RGBtoCMYK</span><span data-testid="content-line">(</span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvK</span><span data-testid="content-line">)</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>33</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dotC </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">halftoneDot</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_C</span><span data-testid="content-line">,</span><span data-testid="content-line"> cmykC</span><span data-testid="content-line">.</span><span data-testid="content-line">x</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>34</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dotM </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">halftoneDot</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_M</span><span data-testid="content-line">,</span><span data-testid="content-line"> cmykM</span><span data-testid="content-line">.</span><span data-testid="content-line">y</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>35</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dotY </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">halftoneDot</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_Y</span><span data-testid="content-line">,</span><span data-testid="content-line"> cmykY</span><span data-testid="content-line">.</span><span data-testid="content-line">z</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>36</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">float</span><span data-testid="content-line"> dotK </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">halftoneDot</span><span data-testid="content-line">(</span><span data-testid="content-line">uv</span><span data-testid="content-line">,</span><span data-testid="content-line"> ANGLE_K</span><span data-testid="content-line">,</span><span data-testid="content-line"> cmykK</span><span data-testid="content-line">.</span><span data-testid="content-line">w</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>38</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">vec3</span><span data-testid="content-line"> outColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>39</p><p><span><span data-testid="content-line">  outColor</span><span data-testid="content-line">.</span><span data-testid="content-line">r </span><span data-testid="content-line">*=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> CYAN_STRENGTH </span><span data-testid="content-line">*</span><span data-testid="content-line"> dotC</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>40</p><p><span><span data-testid="content-line">  outColor</span><span data-testid="content-line">.</span><span data-testid="content-line">g </span><span data-testid="content-line">*=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> MAGENTA_STRENGTH </span><span data-testid="content-line">*</span><span data-testid="content-line"> dotM</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>41</p><p><span><span data-testid="content-line">  outColor</span><span data-testid="content-line">.</span><span data-testid="content-line">b </span><span data-testid="content-line">*=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> YELLOW_STRENGTH </span><span data-testid="content-line">*</span><span data-testid="content-line"> dotY</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>42</p><p><span><span data-testid="content-line">  outColor </span><span data-testid="content-line">*=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> BLACK_STRENGTH </span><span data-testid="content-line">*</span><span data-testid="content-line"> dotK</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>44</p><p><span><span data-testid="content-line">  outputColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">outColor</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div></pre></div>

<p>The demo below is my personal attempt at a CMYK halftone effect for React Three Fiber. You can see how the effect shines over scenes featuring intricate details, light effects, and movement:</p>

<p>I truly enjoy the fact that we’re jumping through a lot of hoops here, going from RGB to CMYK to emulate back RGB through subtractive blending, just to get a specific look and feel.</p>
</section><section id="breaking-the-grid-section">
<p>So far, we’ve only explored halftone restricted within the confines of a strictly defined grid. However, what if we wanted to <em>shake</em> things around? Could we have dots within a given grid displaced, overlapping, or even merging together? This last section explores some uncanny variants of halftone that I have encountered throughout my research and seeks to implement them by breaking away from the constraints of the grid.</p>
<h3 id="cell-wall">Cell wall<a href="#cell-wall"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>The main issue with the grid that we created in part 1 of this article is that it restricts the position and size our dots can take. Moving them too much around, or making them too big, will cause them to <strong>clip when they encounter the boundaries of their respective cells</strong>.</p>
<figure><p><img alt="Diagram illustrating dots clipping to the &#39;walls&#39; of their respective cell when offset too much" loading="lazy" width="663" height="548" decoding="async" data-nimg="1" sizes="(max-width: 768px) 120vw, 75vw" srcset="https://images.maximeheckel.com/cdn-cgi/image/width=640,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 640w, https://images.maximeheckel.com/cdn-cgi/image/width=750,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 750w, https://images.maximeheckel.com/cdn-cgi/image/width=828,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 828w, https://images.maximeheckel.com/cdn-cgi/image/width=1080,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 1080w, https://images.maximeheckel.com/cdn-cgi/image/width=1200,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 1200w, https://images.maximeheckel.com/cdn-cgi/image/width=1920,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 1920w, https://images.maximeheckel.com/cdn-cgi/image/width=2048,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 2048w, https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png 3840w" src="https://images.maximeheckel.com/cdn-cgi/image/width=3840,quality=100,format=webp/https://cdn.maximeheckel.com/images/blog/cell-wall.png"/></p><figcaption>Diagram illustrating dots clipping to the &#39;walls&#39; of their respective cell when offset too much</figcaption></figure>
<p>Instead of each pixel being aware of its own cell, we need to tweak our implementation and start looking at the neighboring cells as well. By checking a <code>3x3</code> area around the current pixel, we can allow the dots to <em>leak</em> across cells without being clipped.</p>
<div><div><p data-testid="codesnippet-title">Sampling neighboring cells</p></div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">vec2</span><span data-testid="content-line"> pixelCoord </span><span data-testid="content-line">=</span><span data-testid="content-line"> vUv </span><span data-testid="content-line">*</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>4</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> baseCellIndex </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">floor</span><span data-testid="content-line">(</span><span data-testid="content-line">pixelCoord </span><span data-testid="content-line">/</span><span data-testid="content-line"> uPixelSize</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>6</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec4</span><span data-testid="content-line"> finalColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec4</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">const</span><span data-testid="content-line"> </span><span data-testid="content-line">int</span><span data-testid="content-line"> searchRadius </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">1</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>12</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">for</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">int</span><span data-testid="content-line"> dx </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line">searchRadius</span><span data-testid="content-line">;</span><span data-testid="content-line"> dx </span><span data-testid="content-line">&lt;=</span><span data-testid="content-line"> searchRadius</span><span data-testid="content-line">;</span><span data-testid="content-line"> dx</span><span data-testid="content-line">++</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>13</p><p><span><span data-testid="content-line">  </span><span data-testid="content-line">for</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">int</span><span data-testid="content-line"> dy </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line">searchRadius</span><span data-testid="content-line">;</span><span data-testid="content-line"> dy </span><span data-testid="content-line">&lt;=</span><span data-testid="content-line"> searchRadius</span><span data-testid="content-line">;</span><span data-testid="content-line"> dy</span><span data-testid="content-line">++</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>14</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellIndex </span><span data-testid="content-line">=</span><span data-testid="content-line"> baseCellIndex </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">vec2</span><span data-testid="content-line">(</span><span data-testid="content-line">float</span><span data-testid="content-line">(</span><span data-testid="content-line">dx</span><span data-testid="content-line">)</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">float</span><span data-testid="content-line">(</span><span data-testid="content-line">dy</span><span data-testid="content-line">)</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>15</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> cellCenter </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">cellIndex </span><span data-testid="content-line">+</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">*</span><span data-testid="content-line"> uPixelSize</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>17</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">vec2</span><span data-testid="content-line"> uvPixel </span><span data-testid="content-line">=</span><span data-testid="content-line"> cellCenter </span><span data-testid="content-line">/</span><span data-testid="content-line"> uResolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>18</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">vec4</span><span data-testid="content-line"> texColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture</span><span data-testid="content-line">(</span><span data-testid="content-line">uTexture</span><span data-testid="content-line">,</span><span data-testid="content-line"> uvPixel</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>20</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">float</span><span data-testid="content-line"> dist </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">pixelCoord </span><span data-testid="content-line">-</span><span data-testid="content-line"> cellCenter</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>22</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">float</span><span data-testid="content-line"> radius </span><span data-testid="content-line">=</span><span data-testid="content-line"> uPixelSize </span><span data-testid="content-line">*</span><span data-testid="content-line"> uRadius</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>24</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">float</span><span data-testid="content-line"> aa </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">fwidth</span><span data-testid="content-line">(</span><span data-testid="content-line">dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>25</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">float</span><span data-testid="content-line"> circle </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">radius </span><span data-testid="content-line">-</span><span data-testid="content-line"> aa</span><span data-testid="content-line">,</span><span data-testid="content-line"> radius </span><span data-testid="content-line">+</span><span data-testid="content-line"> aa</span><span data-testid="content-line">,</span><span data-testid="content-line"> dist</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>27</p><p><span><span data-testid="content-line">    </span><span data-testid="content-line">if</span><span data-testid="content-line"> </span><span data-testid="content-line">(</span><span data-testid="content-line">circle </span><span data-testid="content-line">&gt;</span><span data-testid="content-line"> maxCircle</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">{</span><span data-testid="content-line"></span></span></p></div><div data-testid="highlight-line"><p>29</p><p><span><span data-testid="content-line">      finalColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> texColor</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>34</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec3</span><span data-testid="content-line"> bgColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec3</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>35</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec3</span><span data-testid="content-line"> color </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">bgColor</span><span data-testid="content-line">,</span><span data-testid="content-line"> finalColor</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">,</span><span data-testid="content-line"> maxCircle</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<ul>
<li><p>We introduce a nested loop that searches at a 1-cell radius around the current position.</p></li>
<li><p>We define a <code>baseCell</code> as our current cell for the current pixel our fragment shader is processing.</p></li>
<li><p>We calculate the <code>cellCenter</code> of each neighbor in the <code>3x3</code> kernel. This allows us to measure the distance <code>dist</code> between the current pixel and all the neighboring cell centers.</p></li>
<li><p>We check the reachability. We sample the color at that neighbor’s center to determine the dot&#39;s color and check if that specific neighbor&#39;s dot is large enough to &#34;reach&#34; our current pixel.</p></li>
</ul>

<ul>
<li><p>Many neighboring circles may reach our current pixel; we need to ensure we only have one winner, and this is why we store the “biggest” circle in <code>maxCircle</code>.</p></li>
</ul>
<p>This is the mechanism that erases the clipping, as now every cell can get part or all of its pixels colored based on the influence of its neighboring cells. We can do many things with this, the first one being increasing the size of our circles beyond the cell’s size, which yields a beautiful, almost watercolor-y output.</p>

<h3 id="gooey-halftone">Gooey halftone<a href="#gooey-halftone"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>What if we could make our dots look like ink? Or make them look more liquid by simulating some sort of surface tension between neighboring dots?</p>
<p>Now that we know how to render halftone dots beyond their grid cells, there’s nothing preventing us from doing so! By adding leveraging luma-based radius for our dots, as well as blending overlapping circles with a <code>smoothmin</code> function <sup><a id="ref-5" href="#fn-5">5</a></sup>, we can make our dots look more <em>liquid</em>, as if they had some kind of <em>surface tension</em>:</p>

<p>These two small changes allow neighboring circles that are close enough to one another to gracefully merge as if they were ink drops. This yields a more organic-looking halftone variant, one that shines when overlayed on top of an animated 3D scene, as showcased in the demo below, which also features the full code.</p>


<h3 id="displaced-dots">Displaced dots<a href="#displaced-dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" width="16" height="16"><path d="M10 19.0004L9.82843 19.1719C8.26634 20.734 5.73368 20.734 4.17158 19.1719L3.82843 18.8288C2.26634 17.2667 2.26633 14.734 3.82843 13.1719L7.17158 9.8288C8.73368 8.2667 11.2663 8.2667 12.8284 9.8288L13.1716 10.1719C13.8252 10.8256 14.2053 11.6491 14.312 12.5004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.68799 12.5004C9.79463 13.3516 10.1748 14.1752 10.8284 14.8288L11.1715 15.1719C12.7336 16.734 15.2663 16.734 16.8284 15.1719L20.1715 11.8288C21.7336 10.2667 21.7336 7.73404 20.1715 6.17194L19.8284 5.8288C18.2663 4.2667 15.7336 4.2667 14.1715 5.8288L14 6.00037" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a></h3>
<p>As a final variant of halftone, I wanted to take the time to look into ways we could make the effect more dynamic / alive by allowing the dots to be animated and move. We pretty much have the recipe already in place to achieve this through the two previous examples, and all we need now is a good <strong>idea</strong> to implement.</p>
<p>On my end, my original source of inspiration for this section was this artwork by <a href="https://twitter.com/adamfuhrer">@adamfuhrer</a>, a visual artist I’m a big fan of.</p>
<div><p>mona #plottertwitter https://t.co/dFTdoUqNL8</p><p><span><span><img alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%273024%27%20height=%274032%27/%3e"/></span><img alt="mona #plottertwitter https://t.co/dFTdoUqNL8" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic"/></span></p></div>
<ol>
<li><p>It’s leveraging the ring halftone pattern we saw in the first part of this article.</p></li>
<li><p>We have some rings positioned way beyond their original position, which means we’ll need a relatively large kernel when rendering our effect.</p></li>
<li><p>There’s the <strong>trail</strong> left by a swooping movement across the rings. This is what we have yet to implement!</p></li>
</ol>
<p>For this experiment, I reused the <code>MouseTrail</code> component I originally built for the <a href="https://probablydance.com/posts/post-processing-as-a-creative-medium/#pixelating-mouse-trail">Pixelated Mouse Trail effect demo of my post-processing article</a>. As it did for that effect, this standalone component renders the trail of the user’s cursor through:</p>
<ul>
<li><p>Two <strong>Frame Buffer Objects</strong> (FBOs) and ping pong rendering</p></li>
<li><p>The position and velocity of the cursor.</p></li>
</ul>
<p>It is rendered off-screen, and its resulting texture is passed directly to our halftone effect as a uniform. Once sampled, we can get the brightness of the red and green channels, representing the cursor movement alongside the x and y axes, to know the direction and intensity of the displacement.</p>
<div><div><p data-testid="codesnippet-title">Displacement from brush texture</p></div><pre><div data-testid="line"><p>1</p><p><span><span data-testid="content-line">vec2</span><span data-testid="content-line"> brushUV </span><span data-testid="content-line">=</span><span data-testid="content-line"> cellCenter </span><span data-testid="content-line">/</span><span data-testid="content-line"> resolution</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>2</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec4</span><span data-testid="content-line"> brush </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">brushTexture</span><span data-testid="content-line">,</span><span data-testid="content-line"> brushUV</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>3</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> brushVel </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">clamp</span><span data-testid="content-line">(</span><span data-testid="content-line">brush</span><span data-testid="content-line">.</span><span data-testid="content-line">rg</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line">0.45</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.45</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>4</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> brushIntensity </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">length</span><span data-testid="content-line">(</span><span data-testid="content-line">brushVel</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>6</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> forwardDir </span><span data-testid="content-line">=</span><span data-testid="content-line"> brushIntensity </span><span data-testid="content-line">&gt;</span><span data-testid="content-line"> </span><span data-testid="content-line">0.001</span><span data-testid="content-line"> </span><span data-testid="content-line">?</span><span data-testid="content-line"> brushVel </span><span data-testid="content-line">/</span><span data-testid="content-line"> brushIntensity </span><span data-testid="content-line">:</span><span data-testid="content-line"> </span><span data-testid="content-line">vec2</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>7</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> perpDir </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">vec2</span><span data-testid="content-line">(</span><span data-testid="content-line">-</span><span data-testid="content-line">forwardDir</span><span data-testid="content-line">.</span><span data-testid="content-line">y</span><span data-testid="content-line">,</span><span data-testid="content-line"> forwardDir</span><span data-testid="content-line">.</span><span data-testid="content-line">x</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>8</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> side </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">sign</span><span data-testid="content-line">(</span><span data-testid="content-line">random</span><span data-testid="content-line">(</span><span data-testid="content-line">cellCenter</span><span data-testid="content-line">)</span><span data-testid="content-line"> </span><span data-testid="content-line">-</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>10</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> t </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">smoothstep</span><span data-testid="content-line">(</span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">,</span><span data-testid="content-line"> brushIntensity</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>11</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> easeIn </span><span data-testid="content-line">=</span><span data-testid="content-line"> t </span><span data-testid="content-line">*</span><span data-testid="content-line"> t </span><span data-testid="content-line">*</span><span data-testid="content-line"> t</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>12</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">float</span><span data-testid="content-line"> easedIntensity </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">mix</span><span data-testid="content-line">(</span><span data-testid="content-line">easeIn</span><span data-testid="content-line">,</span><span data-testid="content-line"> t</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.5</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>14</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> srcUV </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">clamp</span><span data-testid="content-line">(</span><span data-testid="content-line">cellCenter </span><span data-testid="content-line">/</span><span data-testid="content-line"> resolution</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">0.0</span><span data-testid="content-line">,</span><span data-testid="content-line"> </span><span data-testid="content-line">1.0</span><span data-testid="content-line">)</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>15</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec3</span><span data-testid="content-line"> srcColor </span><span data-testid="content-line">=</span><span data-testid="content-line"> </span><span data-testid="content-line">texture2D</span><span data-testid="content-line">(</span><span data-testid="content-line">inputBuffer</span><span data-testid="content-line">,</span><span data-testid="content-line"> srcUV</span><span data-testid="content-line">)</span><span data-testid="content-line">.</span><span data-testid="content-line">rgb</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>18</p><p><span><span data-testid="content-line"></span><span data-testid="content-line">vec2</span><span data-testid="content-line"> displacement </span><span data-testid="content-line">=</span><span data-testid="content-line"> forwardDir </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">0.75</span><span data-testid="content-line"> </span><span data-testid="content-line">+</span><span data-testid="content-line"> perpDir </span><span data-testid="content-line">*</span><span data-testid="content-line"> side </span><span data-testid="content-line">*</span><span data-testid="content-line"> </span><span data-testid="content-line">0.25</span><span data-testid="content-line">;</span><span data-testid="content-line"></span></span></p></div><div data-testid="line"><p>20</p><p><span><span data-testid="content-line">cellCenter </span><span data-testid="content-line">+=</span><span data-testid="content-line"> displacement </span><span data-testid="content-line">*</span><span data-testid="content-line"> mouseStrength </span><span data-testid="content-line">*</span><span data-testid="content-line"> easedIntensity</span><span data-testid="content-line">;</span></span></p></div></pre></div>
<p>The displacement is then applied to the center of the neighboring cells to shift where the dots/rings are visually rendered. This creates the illusion of movement, which in this case is defined as follows:</p>
<ul>
<li><p>We first define the direction of the movement: <code>vec2 forwardDir = brushIntensity &gt; 0.001 ? brushVel / brushIntensity : vec2(0.0);</code></p></li>
<li><p>We get the perpendicular vector to the direction: <code>vec2 perpDir = vec2(-forwardDir.y, forwardDir.x);</code></p></li>
<li><p>Pick a random side the ring will move towards perpendicularily</p></li>
<li><p>Combine and ease the movement. In our case, it’s more weighted towards moving forward (75%) than on the sides (25%), giving the impression of the rings being gently pushed and slowly drifting sideways</p></li>
</ul>
<p>Once again, this implementation is built on top of what we saw in the first subsection and consists of only a few tactical tweaks. I highly encourage exploring further what can be done with such a pattern.</p>


</section><section id="final-thoughts-section">
<p>As you can see, from a very simple shape like a circle, we can quickly branch off to a diverse set of effects, each more interesting and pleasing than the other. This is also represented in code, as I managed to keep my shaders modular throughout my experiments, reusing the same functions from very simple effects to the more complex ones.</p>
<p>I had a lot of fun writing about my little halftone <em>side quest</em>, as the topic was on my list for quite some time now. I hope this article will serve you well to either introduce you to an accessible application of shaders or to wrap your head around some of the more <em>tedious</em> concepts. It will most likely serve as a base for another article this year that I plan to write on the topic of <strong>real-time shader-based paintings</strong>  were from simple dots randomely rendered on the screen we can get to a shader capable of emulating different types of painting styles like impressionism, pointillism, and watercolor. The building blocks for this shader are very similar to those introduced here, which once again goes to show the versatility of halftone. This will be for another time, though! In the meantime, I’ll leave you with a teaser of what to expect.</p>
<div><p>real-time watercolor painting https://t.co/N9lOWTv1Ym</p></div>
<section><ol><li id="fn-1"><span><p><a href="https://thebookofshaders.com/glossary/?search=fract">Fract - The Book of Shaders</a></p></span></li><li id="fn-2"><span><p><a href="https://rubendv.be/posts/fwidth/">Drawing antialiased circles in OpenGL</a></p></span></li><li id="fn-3"><span><p><a href="https://en.wikipedia.org/wiki/Moir%C3%A9_pattern">Moiré pattern - Wikipedia</a></p></span></li><li id="fn-4"><span><p><a href="https://youtu.be/Xsqtg2yRl8M?si=GfhIalsr3ahkGDzz&amp;t=136">How to fix digital color mixing: Intro to Mixbox</a></p></span></li><li id="fn-5"><span><p><a href="https://probablydance.com/posts/painting-with-math-a-gentle-study-of-raymarching/#sdf-operations-complex-scenes-and-fractals">SDF operations, complex scenes, and fractals</a></p></span></li></ol></section></section></div></div></div>
  </body>
</html>
