<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://spectrum.ieee.org/amd-mi300">Original</a>
    <h1>AMD&#39;s Next GPU Is a 3D-Integrated Superchip</h1>
    
    <div id="readability-page-1" class="page"><div data-headline="AMD’s Next GPU Is a 3D-Integrated Superchip" data-elid="2666454143" data-post-url="https://spectrum.ieee.org/amd-mi300" data-authors="Samuel K. Moore" data-page-title="AMD’s Next GPU Is a 3D-Integrated Superchip - IEEE Spectrum"><div><p><a href="https://spectrum.ieee.org/tag/amd">AMD</a> lifted the hood on its next AI accelerator chip, the Instinct MI300, at the<a href="https://www.amd.com/en/corporate/events/advancing-ai.html" target="_blank"> AMD Advancing AI</a> event today, and it’s an unprecedented feat of <a href="https://spectrum.ieee.org/tag/3d-integration" target="_blank">3D integration</a>. MI300, a version of which will power the <a href="https://en.wikipedia.org/wiki/El_Capitan_(supercomputer)" target="_blank">El Capitan</a> supercomputer, is a layer cake of computing, memory, and communication that’s three slices of silicon high and that can sling as much as 17 terabytes of data vertically between those slices. The result is as much as a 3.4-fold boost in speed for certain machine-learning-critical calculations. The chip offers both contrasts and similarities to competing approaches such as Nvidia’s <a href="https://spectrum.ieee.org/nvidia-supercomputing-cpu-puts-intel-under-pressure" target="_blank">Grace Hopper superchip</a> and Intel’s supercomputer accelerator <a href="https://spectrum.ieee.org/intel-s-exascale-supercomputer-chip-is-a-master-class-in-3d-integration" target="_self">Ponte Vecchio</a>.<br/></p><p>MI300a stacks three CPU <a href="https://spectrum.ieee.org/tag/chiplets" target="_blank">chiplets</a> (called compute complex dies, or CCDs, in AMD’s lingo) and six accelerator chiplets (XCDs) on top of four input-output dies (IODs), all on top of a piece of silicon that links them together to eight stacks of high-bandwidth DRAM that ring the superchip. (The MI300x substitutes the CCDs for two more XCDs, for an accelerator-only system.) With the scaling of transistors in the plane of the silicon slowing down, 3D stacking is seen as a key method to get more transistors into the same area and keep driving Moore’s Law forward.</p><p><img alt="Grey, labeled rectangles with orange and gold vertical lines connecting them." data-rm-shortcode-id="b87acda6384d54374dd4564223f0574f" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/grey-labeled-rectangles-with-orange-and-gold-vertical-lines-connecting-them.jpg?id=50661489&amp;width=980" height="240" id="a7fd1" lazy-loadable="true" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%201057%20240&#39;%3E%3C/svg%3E" width="1057"/><small data-gramm="false" data-lt-tmp-id="lt-246886" placeholder="Add Photo Caption..." spellcheck="false">Compute and AI chiplets are stacked on top of I/O and cache chiplets in the MI300a.</small><small placeholder="Add Photo Credit...">AMD</small></p><p>“It’s a truly amazing silicon stack up that delivers the highest density performance that industry knows how to produce at this time,” says <a href="https://spectrum.ieee.org/chiplet" target="_self">Sam Naffziger</a>, a senior vice president and corporate fellow at AMD. The integration is done using two Taiwan Semiconductor Manufacturing Co. technologies, <a href="https://3dfabric.tsmc.com/english/dedicatedFoundry/technology/SoIC.htm" rel="noopener noreferrer" target="_blank">SoIC (system on integrated chips) and CoWoS (chip on wafer on substrate)</a>. The latter stacks smaller chips on top of larger ones using hybrid bonding, which links copper pads on each chip directly without solder. It is used to produce AMD’s <a href="https://spectrum.ieee.org/amd-3d-stacking-intel-graphcore" target="_self">V-Cache,</a> a cache-memory expanding chiplet that stacks on its highest-end CPU chiplets. The former, CoWos, stacks chiplets on a larger piece of silicon, called an interposer, which is built to contain high-density interconnects.</p><h2>Similarities and differences between AMD and Nvidia</h2><p>There are both similarities and differences to chief rival Nvidia’s approach. Just as Nvidia did in its Hopper architecture, AMD’s accelerator architecture, CDNA3, added the capability of computing with <a href="https://www.nvidia.com/en-us/data-center/h100/#:~:text=AI%2Dfused%20HPC%20applications%20can,operations%2C%20with%20zero%20code%20changes." rel="noopener noreferrer" target="_blank">truncated 32-bit numbers called TF32</a> and with two different forms of 8-bit floating-point numbers. The latter attribute is used to speed the training of certain parts of transformer neural networks, such as large language models. They also both include a <a href="https://spectrum.ieee.org/nvidia-gpu" target="_self">scheme that reduces the size of the neural network</a>, called 4:2 sparsity.</p><p>Another similarity is the inclusion of both CPU and GPU in the same <a href="https://spectrum.ieee.org/tag/3d-packaging" target="_blank">package</a>. In many AI computer systems, GPUs and CPUs are separately packaged chips deployed in a 4 to 1 ratio. One advantage to joining them together in a single superchip is that both CPU and GPU have high-bandwidth access to the same cache and high-bandwidth DRAM (HBM) in a way that won’t trip each other up as they read and write data.</p><p>Nvidia’s <a href="https://developer.nvidia.com/blog/nvidia-grace-hopper-superchip-architecture-in-depth/" target="_blank">Grace Hopper</a> is such a superchip combination linking the Grace CPU to the Hopper GPU through Nvidia’s Nvidia NVLink Chip-2-Chip interconnects. AMD’s MI300a is as well, by integrating three CPU dies designed for its Genoa line and six XCD accelerators using its AMD Infinity Fabric interconnect technology.</p><p>But a casual glance at Grace Hopper and MI300 show some profound differences. Grace and Hopper are each individual dies that integrate all of a system-on-chip’s needed functional blocks—compute, I/O, and cache. They are linked horizontally, and they are large—nearly at the size limit of photolithography technology.</p><p>AMD took a different approach, one that it has followed for several generations of its CPUs and that rival <a href="https://spectrum.ieee.org/tag/intel">Intel</a> used for its 3D-stacked supercomputer accelerator Ponte Vecchio. The concept is called system-technology-co-optimization, or STCO. That means designers started by breaking the chip down into its functions and decided which functions needed which manufacturing technology.</p><p data-rm-resized-container="25%"><img alt="" data-rm-shortcode-id="824acf053d8de4f6c76ec91569d65c78" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/a-slice-of-mi300-stack-from-the-carrier-silicon-at-the-top-to-the-solder-ball-at-the-bottom-of-the-package.jpg?id=50682953&amp;width=980" height="3661" id="cde2e" lazy-loadable="true" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%201126%203661&#39;%3E%3C/svg%3E" width="1126"/><small placeholder="Add Photo Caption...">A slice of MI300 stack from the carrier silicon at the top to the solder ball at the bottom of the package.</small><small placeholder="Add Photo Credit...">AMD</small></p><p>“What we wanted to do with MI300 was to scale beyond what was possible in a single monolithic GPU. So we deconstructed it into pieces and then built it back up,” says <a href="https://www.linkedin.com/in/alan-smith-amd/" rel="noopener noreferrer" target="_blank">Alan Smith</a>, a senior fellow and the chief architect for Instinct. Although it’s been doing so for several generations of CPUs, the MI300 is the first time the company has made GPU chiplets and bound them in a single system.</p><p>“Breaking the GPU into chiplets allowed us to put the compute in the most advanced process node while keeping the rest of the chip in technology that’s more appropriate for cache and I/O,” he says. In the case of the MI300, all the compute was built using TSMC’s N5 process, the most advanced available and the one used for Nvidia’s top-line GPUs. Neither the I/O functions nor the system’s cache memory benefit from N5, so AMD chose a less-expensive technology (N6) for those. Therefore, those two functions could then be built together on the same chiplet.</p><p>With the functions broken up, all the pieces of silicon involved in the MI300 are small. The largest, the I/O dies, are not even half the size of Hopper. And the CCDs are only about one-fifth the size of the I/O die. The small sizes make a big difference. Generally, smaller chips yield better. That is, a single wafer will provide a higher proportion of working small chips than it would large chips. “3D integration isn’t free,” says Naffziger. But the higher yield offsets the cost, he says.</p><h2>Luck and experience</h2><p>The design involved some clever reuse of existing technologies and designs, a few compromises, and a little luck, according to Naffziger, an IEEE Fellow. The reuse came in two instances. First, AMD was able to do the 3D integration with a degree of confidence because it had already been using the exact same pitch of vertical interconnects—9 micrometers—in its V-cache product.</p><p>As an optional add-on that AMD was able to charge extra for, V-cache offers little risk that poor yield or other problems will have a big impact on the company. “It’s been a great thing to enable us to wring out the manufacturing problems and all the design complexities of 3D stacking without endangering the main product line,” says Naffziger.</p><p>The other instance of reuse was a bit chancier. When the MI300 team decided that a CPU/GPU combination was needed, Naffziger “somewhat sheepishly” asked the head of the team designing the Zen4 CCD for the <a href="https://www.amd.com/en/events/epyc4" target="_blank">Genoa CPU</a> if the CCD could be made to fit the MI300’s needs. That team was under pressure to meet an earlier deadline than expected, but a day later they responded. Naffziger was in luck; the Zen4 CCD had a small blank space in just the right spot to make the vertical connections to the MI300 I/O die and their associated circuitry without a disruption to the overall design.</p><p>Nevertheless, there was still some geometry that needed solving. To make all the internal communications work, the four I/O chiplets had to be facing each other on a particular edge. That meant making a mirror-image version of the chiplet. Because it was codesigned with the I/O chiplet, the XCD and its vertical connections were built to link up with both versions of the I/O. But there was no messing with the CCD, which they were lucky to have at all. So instead the I/O was designed with redundant connections, so that no matter which version of the chiplet it sat on, the CCD would connect.</p><p><img alt="Multicolor rectangle with capital lettering in places." data-rm-shortcode-id="fd7dd6159bc9fba3eaf956a11c231d6e" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/multicolor-rectangle-with-capital-lettering-in-places.jpg?id=50662187&amp;width=980" height="412" id="917d3" lazy-loadable="true" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20896%20412&#39;%3E%3C/svg%3E" width="896"/><small placeholder="Add Photo Caption...">To get everything to line up, the IOD chiplets had to be made as mirrors of each other, and the accelerator (XCD) and compute (CCD) chiplets had to be rotated.</small><small placeholder="Add Photo Credit...">AMD</small></p><p>The power grid, which has to deliver hundreds of amperes of current to the compute dies at the top of the stack, faced similar challenges because it too had to accommodate all the various chiplet orientations, Naffziger noted.</p></div></div></div>
  </body>
</html>
