<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/SSHBruteForceAttacksNoMoreHere">Original</a>
    <h1>Large scale Internet SSH brute force attacks seem to have stopped here</h1>
    
    <div id="readability-page-1" class="page"><div><h2>Large scale Internet SSH brute force attacks seem to have stopped here</h2>

	<p><small>August 27, 2022</small></p>
</div><div><p>The last time I paid attention to what happened when you exposed
an SSH port on the Internet was years and years ago, when I gave
up being annoyed by log messages and either stopped paying attention
or firewalled of my SSH ports from the general Internet. Back then,
it was received wisdom (and my general experience) that having an
SSH port open drew a constant stream of SSH brute force attacks
against a revolving cast of whatever logins the attackers could
come up with.</p>

<p>Recently I set up a <a href="https://grafana.com/oss/loki/">Grafana Loki</a>
setup that <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/GrafanaLokiAvoidingJSON">captures our systemd logs</a>.
As part of getting some use out of it (<a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/GrafanaLokiNtpdateQueries">beyond questions about how
server clocks drift</a>), I built a Grafana
dashboard that reports on SSH authentication failures across our
Ubuntu fleet (among other things). What I saw surprised me, because
what our exposed SSH servers experience today seems to be nothing
like it was in the past.</p>

<p>(One caution is that it may be that most attackers no longer direct
their attention against universities at all, and now aim their scans
at, say, cloud providers, which could be much richer territory for
insecure SSH servers.)</p>

<p>For the most part, SSH brute force attacks against <a href="https://support.cs.toronto.edu/">us</a> are gone. When they appear in
some time period, they come in high volume from single IP addresses
(or only a few IP addresses); some of the time these are cloud
server IPs. Almost all of the brute force attacks are directed
against the &#39;<code>root</code>&#39; account, and any single round tends to be
directed against only a single one of our servers rather than being
spread over multiple ones. As mentioned, attacks are bursty; there
are periods with no login attempts and then periods where someone
apparently fires up a single attacking IP address for an hour or a
day.</p>

<p>For some numbers, over the past 7 days we had 24,000 attempts against
&#39;<code>root</code>&#39; and only 749 against the next most popular target, which
is a login name (&#39;<code>admin</code>&#39;) that doesn&#39;t even exist here. Just over
10,000 of those attempts came from a single IP address, and just
four IPs made 1,000 or more attempts against anything. Besides
<code>root</code>, only five login names had more than 100 attempts (and none
of them exist here): &#39;admin&#39;, &#39;user&#39;, &#39;ubuntu&#39;, &#39;debian&#39;, and &#39;pi&#39;.
And only three machines saw more than 1,000 attempts (across all
targeted login names).</p>

<p>One of the things I&#39;ve learned from this is that targeted blocking
of only a few IPs is disproportionately effective at stopping brute
force SSH attacks here. Also, since we already block Internet logins
to &#39;<code>root</code>&#39;, we&#39;re in almost no danger. No matter how many times
they try, they have literally no chance of success.</p>

<p>(It does make me curious about what sort of passwords they&#39;re trying
for &#39;<code>root</code>&#39;. But not curious enough to set up a honeypot SSH server
and then try to give it a hostname that&#39;s interesting enough to
attract attackers.)</p>
</div></div>
  </body>
</html>
