<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rfong.github.io/rflog/2023/04/04/weird-js-fun-facts/">Original</a>
    <h1>Weird Javascript fun facts I stumbled over while building a Bezier curve editor</h1>
    
    <div id="readability-page-1" class="page"><div>
  
	<div>
		<p><span>04 Apr 2023</span>

    
    

		
		
		
  		<span>
      <i></i>
  			
  				<a href="https://rfong.github.io/rflog/tag/hot-tips">hot-tips</a>, 
      	
  				<a href="https://rfong.github.io/rflog/tag/javascript">javascript</a>
      	
      </span>
		

  </p></div>
  
    <p>I spent today and yesterday building a little <a href="https://rfong.github.io/creative-coding/bezier/">educational interactive webpage</a> that helps you get intuition for Bezier curves! Go play with it!</p>



<p><img src="https://rfong.github.io/rflog/assets/images/bezier/1.png"/>
<img src="https://rfong.github.io/rflog/assets/images/bezier/2.png"/>
<img src="https://rfong.github.io/rflog/assets/images/bezier/3.png"/>
<img src="https://rfong.github.io/rflog/assets/images/bezier/4.png"/></p>

<p>While encapsulating, refactoring, modularizing, and generally forcing JS to do horrible things it was never designed for (read: just about anything), to my heart’s content, I dug up many a JS fun fact! Some were new to me, some were old, and all, like JS itself, are weird.</p>



<h2 id="setting-default-values-with-the-nullish-coalescing-operator-">setting default values with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing">nullish coalescing operator <code>??</code></a></h2>

<p>Usage: <code>a ?? b</code>. Returns <code>b</code> if <code>a</code> is <code>null</code> or <code>undefined</code>, otherwise returns <code>a</code>. In other words, <code>b</code> behaves like a default value.</p>

<p>The double question marks evoke just how I feel every time I learn something new about Javascript. Only an interrobang (?!) would be more apt.</p>

<p>A great way to shorthand explicit <code>null</code>/<code>undefined</code> checks while fishing variables out of the hilariously mutable objects that make up the beautiful trashfire that is the Javascript language.</p>

<h2 id="variadic-functions-with-args-and-arguments">variadic functions with <code>...args</code> and <code>arguments</code></h2>

<p>(Or, functions which accept an indefinite or variable number of arguments. My headcanon term is “splat”, since that’s what it’s called in Python.)</p>

<p>There are multiple ways to create a variadic function in JS. One way is the “<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">rest parameter syntax</a>”, which looks like this:</p>

<div><div><pre><code><span>function</span> <span>fn1</span><span>(...</span><span>args</span><span>)</span> <span>{}</span>
<span>function</span> <span>fn2</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>,</span> <span>...</span><span>args</span><span>)</span> <span>{}</span>
</code></pre></div></div>

<p>Another approach is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments"><code>arguments</code></a>, an array-like object (<em>important: not an actual array!!</em>) that you can access from within functions.</p>

<div><div><pre><code><span>function</span> <span>fn</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>,</span> <span>c</span><span>)</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>arguments</span><span>.</span><span>length</span><span>);</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>arguments</span><span>[</span><span>0</span><span>],</span> <span>arguments</span><span>[</span><span>1</span><span>],</span> <span>arguments</span><span>[</span><span>2</span><span>]);</span>
<span>}</span>
</code></pre></div></div>

<p>Although you can index into <code>arguments</code> and call <code>arguments.length</code>, it does not have <code>Array</code>’s other built-in methods, while the “rest parameters” are an actual <code>Array</code>. There are some other edge case distinctions you might care about in the Mozilla documentation pages, such as when named parameters are re-assigned.</p>

<h2 id="dynamically-executing-functions-on-arguments-with-apply-or-call">dynamically executing functions on arguments with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>apply</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>call</code></a></h2>

<p>I love splatting an unknown-length array of arguments onto a variadic function!</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>Function.prototype.apply()</code></a> is a wonderfully useful buddy which calls a function with a given value of <code>this</code> and given arguments.</p>

<div><div><pre><code><span>const</span> <span>numbers</span> <span>=</span> <span>[</span><span>5</span><span>,</span> <span>6</span><span>,</span> <span>2</span><span>,</span> <span>3</span><span>,</span> <span>7</span><span>];</span>
<span>//...</span>
<span>Math</span><span>.</span><span>max</span><span>.</span><span>apply</span><span>(</span><span>null</span><span>,</span> <span>numbers</span><span>);</span>
</code></pre></div></div>

<p><code>p5</code> can be notoriously messy to encapsulate. I ended up using a lot of <code>apply</code> because I was writing a lot of class functions that casually use <code>p5</code> functions. For example:</p>

<div><div><pre><code><span>this</span><span>.</span><span>p</span><span>.</span><span>stroke</span><span>.</span><span>apply</span><span>(</span><span>this</span><span>.</span><span>p</span><span>,</span> <span>args</span><span>);</span>
</code></pre></div></div>
<p>(the <code>p</code> is a <code>p5</code> instance)</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>Function.prototype.call()</code></a> is nearly identical except that you provide the arguments individually instead of in an array. I have never actually used it, because at the point where I need to use <code>apply</code>, I’m probably already passing the arguments around in an array anyways.</p>

<h2 id="functionprototypebind"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>Function.prototype.bind()</code></a></h2>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>bind()</code></a> creates a new function with its <code>this</code> keyword set to the provided value.</p>

<p><code>bind()</code> came in handy quite a lot because I needed to define <code>p5</code> <code>setup()</code> and <code>draw()</code> functions for all my different little sketch environments in <a href="https://rfong.github.io/creative-coding/bezier/">my Bezier explorable</a>, which were scaffolded on a lot of shared functionality.</p>

<p>For example, I have a wrapper class <code>BezierSketch</code> which handles a lot of the functionality which stays the same across my different sketches. Its constructor accepts custom p5 <code>setup()</code> and <code>draw()</code> functions which can be run with knowledge of <code>p5</code> and the <code>BezierSketch</code> instances.</p>

<p>This allowed me to implement lots of different sketches with different setup and draw methods that I had defined externally while still getting to use the <code>p5</code> API and any functionality I had built into <code>BezierSketch</code>.</p>

<p>Here’s an extremely abstract pseudocode outline of what I mean:</p>

<div><div><pre><code><span>class</span> <span>BezierSketch</span> <span>{</span>
    <span>constructor</span><span>(</span><span>p</span><span>,</span> <span>setupFn</span><span>,</span> <span>drawFn</span><span>,</span> <span>...)</span> <span>{</span>
        <span>...</span>
        <span>p</span><span>.</span><span>setup</span> <span>=</span> <span>setupFn</span><span>.</span><span>bind</span><span>(</span><span>this</span><span>,</span> <span>p</span><span>);</span>
        <span>p</span><span>.</span><span>draw</span> <span>=</span> <span>drawFn</span><span>.</span><span>bind</span><span>(</span><span>this</span><span>,</span> <span>p</span><span>);</span>
        <span>...</span>
    <span>}</span>

    <span>function</span> <span>coolFunction</span><span>(...)</span> <span>{</span> <span>...}</span>
<span>}</span>

<span>// sketch 1</span>
<span>new</span> <span>BezierSketch</span><span>(</span><span>p</span><span>,</span>
    <span>// setup function</span>
    <span>function</span><span>(</span><span>p</span><span>)</span> <span>{</span>
        <span>// Set up custom controls</span>
        <span>...</span>
    <span>},</span>
    <span>// draw function</span>
    <span>function</span><span>(</span><span>p</span><span>)</span> <span>{</span>
        <span>// Draw one Bezier curve!</span>
        <span>...</span>
    <span>},</span>
<span>);</span>

<span>// sketch 2</span>
<span>new</span> <span>BezierSketch</span><span>(</span><span>p</span><span>,</span>
    <span>// setup function</span>
    <span>function</span><span>(</span><span>p</span><span>)</span> <span>{},</span>
    <span>// draw function</span>
    <span>function</span><span>(</span><span>p</span><span>)</span> <span>{</span>
        <span>// Do something completely different!</span>
        <span>this</span><span>.</span><span>coolFunction</span><span>(...);</span>
        <span>...</span>
    <span>},</span>
<span>);</span>
</code></pre></div></div>

<h2 id="---ecma-arrow-function-fun-facts"><code>() =&gt; {}</code> ECMA arrow function fun facts</h2>

<p>Before this project, I think I was only using <code>() =&gt; {}</code> to make small anonymous closures, such as when I need to pass a small lambda around for pseudo-functional programming.</p>
<div><div><pre><code><span>// Traditional version</span>
<span>_</span><span>.</span><span>map</span><span>(</span><span>arr</span><span>,</span> <span>function</span><span>(</span><span>x</span><span>)</span> <span>{</span> <span>return</span> <span>...</span> <span>});</span>
<span>// With arrow function</span>
<span>_</span><span>.</span><span>map</span><span>(</span><span>arr</span><span>,</span> <span>(</span><span>x</span><span>)</span> <span>=&gt;</span> <span>{</span> <span>...</span> <span>});</span>
</code></pre></div></div>

<p><a href="https://stackoverflow.com/questions/56503531/what-is-a-good-way-to-automatically-bind-js-class-methods">Today I learned</a> that the ECMA arrow function automatically binds <code>this</code> to the parent scope. (I was tripping over that a lot today before looking up where my mystery <code>this</code> values were coming from.)</p>

<p>From the <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-arrow-function-definitions-runtime-semantics-evaluation">ECMA spec</a>:</p>
<blockquote>
  <p>Any reference to arguments, super, this, or new.target within an ArrowFunction must resolve to a binding in a lexically enclosing environment. Typically this will be the Function Environment of an immediately enclosing function.</p>
</blockquote>

<p><a href="https://stackoverflow.com/questions/22939130/when-should-i-use-arrow-functions-in-ecmascript-6">This Stack Overflow discussion</a> has some nice points about arrow function scoping and when to use or not use it.</p>

<h2 id="so-many-ways-to-iterate-over-an-array"><a href="https://stackoverflow.com/questions/9329446/loop-for-each-over-an-array-in-javascript">so many ways to iterate over an array!</a></h2>

<p>I usually just use a good old-fashioned <code>for</code> loop, performant and <code>async</code>-friendly.</p>
<div><div><pre><code><span>for</span> <span>(</span><span>let</span> <span>i</span><span>=</span><span>0</span><span>;</span> <span>i</span><span>&lt;</span><span>arr</span><span>.</span><span>length</span><span>;</span> <span>i</span><span>++</span><span>)</span> <span>{</span>
    <span>const</span> <span>element</span> <span>=</span> <span>arr</span><span>[</span><span>i</span><span>];</span>
    <span>// ...use `element`...</span>
<span>}</span>
</code></pre></div></div>

<p>I didn’t actually know about the <code>for-of</code> loop until today and am thrilled it finally exists!! Apparently it was implemented in 2015, which tells you how much of a webdev Luddite I am.</p>

<div><div><pre><code><span>for</span> <span>(</span><span>const</span> <span>element</span> <span>of</span> <span>array</span><span>)</span> <span>{</span>
    <span>// ...use `element`...</span>
<span>}</span>
</code></pre></div></div>



<p><a href="https://stackoverflow.com/questions/9329446/loop-for-each-over-an-array-in-javascript">How to fit a div’s height to wrap around its floated children</a> :sobs in clearfix:</p>

  
</div></div>
  </body>
</html>
