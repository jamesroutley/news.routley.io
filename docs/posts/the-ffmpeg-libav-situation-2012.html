<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://blog.pkh.me/p/13-the-ffmpeg-libav-situation.html">Original</a>
    <h1>The FFmpeg/Libav situation (2012)</h1>
    
    <div id="readability-page-1" class="page"><article><p>One year and a half ago, an important part of FFmpeg developers decided to
change the way the project was managed. This led to some kind of
<a href="http://lwn.net/Articles/423703/">takeover</a>, mainly to get rid of the old maintainer dictatorship,
but also to change development methods, redefine objectives, etc. Then, for
various reasons I will quickly explain, these people made a new project called
Libav.</p>
<p>I will try first to summarize the most objectively as I can what was the
situation, why it led to the current one, and basically how things are linked
together. In a second time though, I will try to explain why, as a FFmpeg/Libav
war child, I finally chose one side, and what it means daily.</p>
<h2>How are MPlayer, FFmpeg, VLC, libav*, etc connected?</h2>
<p>To understand well what&#39;s going on, let&#39;s do a quick summary of the tools and
communities.</p>
<p><a href="http://mplayerhq.hu/">MPlayer</a> and <a href="http://ffmpeg.org/">FFmpeg</a> projects are originally two
very close communities; both projects started around the same time (year 2000),
and still share a lot of commons things (MPlayer uses FFmpeg API, a lot of
developers were working on both projects, they were hosted on the same server,
and more).</p>
<p>The FFmpeg project provides a few libraries to convert, play, stream, process
audio and video (more information on <a href="http://ffmpeg.org/about.html">the ffmpeg libraries here</a>),
and a few tools (<code>ffmpeg</code> for transcoding, <code>ffplay</code> for playback, etc), all of
them making obviously use of these libraries.</p>
<p>MPlayer is basically a GPL video player, with its own demuxers, decoders,
filters, etc. but at some point it made use of FFmpeg to lighten the burden of
too much code maintenance.</p>
<p>I don&#39;t know the VLC project very much, though I know enough to say that they
make use of the libav* libraries like MPlayer does, especially the codecs one
(<code>libavcodec</code>). While MPlayer community is very small, VLC seems to have enough
developers to afford for example the cost of writing a better© support for some
formats than <code>libavformat</code> from FFmpeg.</p>
<p>Many other projects make use of these libraries (XBMC, Chromium, ...), you get
the point.</p>
<h2>How was FFmpeg development driven?</h2>
<p>The FFmpeg development model was fairly simple: the <a href="http://guru.multimedia.cx/">biggest FFmpeg
contributor</a> (Michael Niedermayer, see <a href="http://lucy.pkh.me/ffstats/authors.html#cumulated_added_lines_of_code_per_author">stats</a>) was
the &#34;self-proclaimed&#34; maintainer, and basically had the last word in technical
decisions, mainly because he&#39;s been the top contributor of the project. A bunch
of other folks had write access to the repository, sent patches for review on a
mailing-list (or not if it&#39;s trivial enough), and pushed it upstream.</p>
<h2>What went wrong?</h2>
<p>Like in many other FLOSS communities, there are a lot of strong personalities,
huge egos, technical religions, etc. The multimedia community is not an
exception, far from that.</p>
<p>As previously said, I started getting interested into FFmpeg around that time,
so I can&#39;t comment on the exactness of the statements, but the main complaints
I saw mentioned and remember from that time were about the project leader. It
was all about &#34;I do and commit whatever I want to&#34;, &#34;I don&#39;t care about
cosmetics&#34;, &#34;I don&#39;t want to discuss with you in real life, mails are good
enough&#34;, eventually discouraging newcomers, and his general attitude towards
other developers (note: he was of course not an exception).</p>
<p>For more details, see <a href="http://libav.org/about.html">Libav history</a>.</p>
<p>Then, since a lot of active developers wanted to put an end to this, they
decided to change the situation, not by forking to avoid the current state we
are in, but thus, by <a href="http://ffmpeg.org/pipermail/ffmpeg-devel/2011-January/106489.html">removing Michael&#39;s and the other developers from the
project</a> who were not part of the new team. I let you imagine
the problems it caused: some developers didn&#39;t understand, or understood very
well and got angry and aggressive, but also a lot of people not being part of
the team started to give their opinion for one side or another, insult each
other, and basically <a href="http://ffmpeg.org/pipermail/ffmpeg-devel/2011-January/106403.html">a civil war started</a>.</p>
<p>To make things simple, after trying to find a compromise, Michael and the
remaining people in the FFmpeg team later decided to restore ffmpeg.org DNS and
the Libav folks were &#34;forced&#34; to fork to have it their way. Things didn&#39;t go
well, there were a lot of inflamed private exchanges I wasn&#39;t part of, with
various threats.</p>
<p>After the fork, things actually got a bit more peaceful; no less hatred, but
developers were busy bitching and trolling on their side, and then it likely
became a messy and irrecoverable situation everyone finally somehow accepted.</p>
<p>Note that a lot of circumstances are not depicted here, the article would get
way too long, but feel free to read the threads.</p>
<p><img src="https://riskmusings.substack.com/img/war-grave-fireflies.jpg" alt="centerimg"/></p>
<h2>Sexy Libav</h2>
<p>At first, even though I disagreed with the method used, I was actually pretty
appealed by what could come out of this. I wasn&#39;t an FFmpeg developer at that
time, just a MPlayer one, and a small FFmpeg contributor. And to be honest,
being mostly detached from the project, it was actually pretty funny to see
them acting like children, even though the situation was kind of serious.</p>
<p>The fork resulted in a real <a href="https://lists.libav.org/pipermail/libav-devel/2011-April/thread.html">activity burst on Libav</a>, while
FFmpeg&#39;s future was not clear.</p>
<p>The development policy is different in Libav: no leader, every single commit
<em>must</em> be reviewed and approved by a member of the team (even the most trivial
one), with a serious desire of making things perfect. I was sending patches at
that time, because it was worth giving it a try, there was some activity, people
were nice, etc.</p>
<p>Being more active, I tried to stay neutral (actually, that&#39;s not that hard when
you have no opinion on the matter) and sent some patches to both mailing-lists
(mostly depending on the people being able to review my stuff).</p>
<h2>What happened on FFmpeg?</h2>
<p>While Libav left with the server, bug tracker, etc., the FFmpeg project was
restoring itself, with the help of some <a href="http://www.videolan.org/">VideoLAN</a> people (the
<a href="http://git.videolan.org/?p=ffmpeg.git">FFmpeg sources are now hosted on git.videolan.org</a>). Michael also
started to <strong>merge the Libav changes back into FFmpeg every 1-2 day</strong>, with a
lot of forgotten, previously rejected, sometimes controversial features, or in
stand-by such as <a href="http://ffmpeg.org/pipermail/ffmpeg-devel/2011-March/109620.html">ffmpeg-mt</a>.</p>
<p>The main point here is that the fork stimulated the competition, and FFmpeg
became a way better (IMHO) and more complete project. Also, I must say the
leader&#39;s attitude completely changed, in a very good way. This is certainly one
of the most positive thing that came out of that war.</p>
<h2>Technically speaking, what&#39;s wrong with Libav?</h2>
<p>I&#39;m going to be a bit harsh here, sorry about that but I feel it&#39;s important to
express it at least once.</p>
<p>I recommend by the way to read <a href="http://codecs.multimedia.cx/?p=370">Why FFmpeg is “better” than Libav by Numbers
but not in Reality</a> which is a bit outdated but gives an
opposite opinion from what&#39;s being said here. If I remember correctly some
other Libav developers and contributors also expressed their opinion on this,
but I can&#39;t find the links. Anyway, let&#39;s give mine, this is what blogging is
all about anyway.</p>
<p><img src="https://riskmusings.substack.com/img/horse-blinkers.jpg" alt="floatrightimg"/></p>
<p><a href="https://lists.libav.org/pipermail/libav-devel/2012-May/028461.html">Libav is totally ignoring FFmpeg</a> since the beginning (almost 2
years of development now). And this is of course not only related to features,
they also don&#39;t give a damn about <strong>regressions</strong> they introduce, <strong>security
issues</strong> (look for &#34;j00ru&#34; in the FFmpeg history for instance), and overall
<strong>bug fixes</strong>. This is not 3-4 patches, there are hundreds of them.</p>
<p>At times, you can see them picking random stuff from FFmpeg, but they often
re-fix them in their own way, taking the privilege to take the full authorship,
suggesting it&#39;s trivial enough (this might be true, but looking for the bug is a
contribution by itself, and implies recognition since it&#39;s sometimes harder than
fixing the bug). Here are the last examples I spotted:</p>
<ul>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=781fb46c568939c15e4638f9949adb6f2facf7b4">ffmpeg:<code>781fb46c5</code></a> and <a href="http://git.libav.org/?p=libav.git;a=commitdiff;h=12d42cd7a869a58e6308b76f7234701f1d943d93">libav:<code>12d42cd7a8</code></a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=a9011623ea95f051f740bffd2d473f28fd1f250e">ffmpeg:<code>a9011623e</code></a> and <a href="http://git.libav.org/?p=libav.git;a=commitdiff;h=0426c6931070a65a7ec8362d12038ef10fa015ee">libav:<code>0426c69310</code></a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=788a60d9d6ad2b1fb3b6f88baf668e65724a2d9f">ffmpeg:<code>788a60d9d</code></a> and <a href="http://git.libav.org/?p=libav.git;a=commitdiff;h=e58b75f7ff4733b0de17b2b91d1dac364627cb9d">libav:<code>e58b75f7ff</code></a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=e3c26705392e462fabf54366fbad3dbf6ec832d1">ffmpeg:<code>e3c267053</code></a> and <a href="http://git.libav.org/?p=libav.git;a=commitdiff;h=15358ade152ebc28fcc824e09ad9206597c281df">libav:<code>15358ade15</code></a></li>
</ul>
<p>There is basically no recognition at all for FFmpeg, and they rewrite
<strong>everything</strong>. Let&#39;s give some examples:</p>
<ul>
<li><code>ffprobe</code> outputs: last year, Stefano and I worked on a way of improving
<code>ffprobe</code> by making it output something else than the weird INI/XML by
default.  So we developed a simple writer system and provided a <a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=3fdf519e4bd7d14d5335fb618cff0c1cd82f30b2">JSON
output</a>. At the same time, the feature was proposed <a href="https://lists.libav.org/pipermail/libav-devel/2011-September/010686.html">as a hack
on libav</a> (they just hardcoded crappy printf calls all
over the code). Of course, I suggested to just pick the commits in FFmpeg,
but I was likely ignored (the hack patch as well). We then worked on adding
<a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=20ac5849f82282e0566fab6f5a03aedde1b1b7fe">XML</a>, <a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=1f0d937f777a2d4d83200a4d26c7752735eee727">CSV</a>, <a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=fd0c83c6667de5b1ebe40f115a746fddea558168">flat</a> and various
other outputs, most of them <a href="http://ffmpeg.org/ffprobe.html#Writers">customizable through options</a>.
People started to use them, and obviously requested to the Libav folks the
feature. The sane choice would have been to just pick what was already done.
Instead, they decided to rewrite this from scratch, with the argument: &#34;I
don&#39;t like it&#34;. And by the way, they broke the default output &#34;because it&#39;s
evil and it sucks&#34;, and so breaking users scripts (without any version bump
or anything). They also didn&#39;t even care to keep the same option names with
FFmpeg so users could switch between tools easily (FFmpeg added the <code>-of</code>
alias for compatibility).</li>
<li><code>libswresample</code> and <code>libavresample</code>: end of 2011, Michael wrote <a href="http://git.videolan.org/?p=ffmpeg.git;a=commit;h=b5875b91113a0f3de6ad61e9ff8b74b81de94760">an audio
library to do any sample rate, formats, layout, packing conversions he dubbed
libswresample</a>. Later on a few people contributed to it, for example
to document or expose the API properly to the user. It was then integrated to
the whole project (tools, filters), and greatly improved the audio support in
FFmpeg. As usual, Libav completely ignored this for one year, and then
decided to <strong>pay</strong> a developer (with the money of the FFmtech foundation) to
<strong>rewrite completely a library for the exact same purpose</strong>. They <a href="https://lists.libav.org/pipermail/libav-devel/2012-April/026066.html">tried to
justify this</a>. This obviously pissed off the users. Since
FFmpeg has a much better policy toward satisfying the users, we also <a href="https://lists.ffmpeg.org/pipermail/ffmpeg-devel/2012-April/123746.html">provide
the <code>libavresample</code> API</a>.</li>
<li>Audio filtering: during this year FFmpeg integrated a lot of filters,
especially audio ones. We were a handful of developers focusing on the
filtering, so we wrote quite a bunch of useful filters. Nevertheless, they
started to get interested in <code>libavfilter</code> as well, and between one or two
rewrite-from-scratch trolls, they finally decided to just improve the API
instead (smart move for once). Improving the API obviously meant <a href="http://lists.ffmpeg.org/pipermail/ffmpeg-devel/2012-May/124397.html">ignoring
FFmpeg and breaking the API several times</a>. OK, I&#39;m a bit
dishonest since Libav actually brought some really good things in the
process, but what I condemn here is their <a href="https://en.wikipedia.org/wiki/Not_Invented_Here">NIH syndrome</a> (see
for instance af_amix + af_join, and af_pan + af_amerge) which hurts everyone.</li>
</ul>
<p>...and certainly more: I only mentioned things I was directly concerned here,
but it is likely other developers can raise some similar issues.</p>
<p>The main problem is that external projects who want to support both FFmpeg and
Libav are just fucked, and this only because Libav doesn&#39;t care a second about
their users.</p>
<p>I think this is more a pride issue than anything else. They just don&#39;t want to
consider FFmpeg and they want it to disappear. If you want something in Libav,
you have to submit them directly: with FFmpeg&#39;s daily merges and most
developers not wanting to do the work twice, they can afford to just ignore
everything and still have some contributions…</p>
<p>If you want an overview of the amount of things FFmpeg getting in, it&#39;s pretty
easy: since most of work done on FFmpeg is ignored from Libav, it&#39;s safe to say
that the commits listed below are most likely not in Libav:</p>
<ul>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Carl+Eugen+Hoyos;st=author">Carl Eugen Hoyos commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Marton+Balint;st=author">Marton Balint commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Michael+Niedermayer;st=author">Michael Niedermayer commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Nicolas+George;st=author">Nicolas George commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Paul+B+Mahol;st=author">Paul B Mahol commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Stefano+Sabatini;st=author">Stefano Sabatini commits</a></li>
<li><a href="http://git.videolan.org/?p=ffmpeg.git;a=search;s=Cl%C3%A9ment+B%C5%93sch;st=author">mine...</a></li>
<li>...and many others.</li>
</ul>
<h2>Colors preferences</h2>
<p>Also, overall, I don&#39;t agree with the development methods of Libav, but this is
mostly a taste issue. To make it simple, I believe the process of sending a
patch for everything like fixing a trailing whitespace is a complete nonsense.
And this is actually discouraging developers you trusted with a write access to
the repository, and treating them like children. This is not efficient. And I
tend to think that when you maintain some code, it&#39;s good to be able to fix
things quickly without <a href="http://www.bikeshed.com/">bikeshedding</a>.</p>
<p><img src="https://riskmusings.substack.com/img/nonsense.jpg" alt="centerimg"/></p>
<h2>How come Libav is so widely spread then?</h2>
<p>I have a few ideas in mind, the main ones being:</p>
<h3>Packaging</h3>
<p>The Debian/Ubuntu packager is on Libav side (see by the way the <a href="http://libav.org/download.html#distros">distribution
status</a> on their site), and obviously they distribute Libav
packages. But they are also using this to spread a very destructive lie:</p>
<pre><code>ffmpeg version 0.8.3-6:0.8.3-4, Copyright (c) 2000-2012 the Libav developers
  built on Jun 26 2012 09:26:41 with gcc 4.7.1
*** THIS PROGRAM IS DEPRECATED ***
This program is only provided for compatibility and will be removed in a future release. Please use avconv instead.
[...]
</code></pre>
<p>This is obviously false, and even more wrong in the sense that they are still
using the &#34;ffmpeg&#34; name for the package. It <a href="https://bugs.launchpad.net/ubuntu/+source/libav/+bug/939863">looks like it&#39;s been &#34;fixed&#34; on
Ubuntu</a> but it&#39;s still present on Debian here.</p>
<p>This propaganda certainly hurts the FFmpeg project a lot.</p>
<p><em>Note</em>: FFmpeg is providing ff* tools, fully compatible with the av* tools
from Libav (<code>avconv</code>, <code>avplay</code>, ...), with additional features, bug fixes, but
also backward compatibility for some options Libav decided to remove.</p>
<h3>The fork doesn&#39;t exist</h3>
<p><img src="https://riskmusings.substack.com/img/alien-fork.jpg" alt="floatrightimg"/></p>
<p>I believe the fork is not a bad thing, of course assuming Libav accepts being
one. But Libav is presenting itself as a FFmpeg <em>replacement</em>, or <a href="http://lwn.net/Articles/433348/"><em>rename</em> and
not a fork</a>. Basically, the spirit can be summarized with:</p>
<ul>
<li><a href="http://permalink.gmane.org/gmane.comp.video.libav.devel/12232">&#34;Libav is the upstream&#34;</a></li>
<li>&#34;Libav is doing all the work&#34;</li>
<li>&#34;Everyone is on Libav&#34;</li>
<li>&#34;Who cares about FFmpeg? It&#39;s a downstream fork with no important work&#34;</li>
</ul>
<p>(Of course, FFmpeg has 1k+ post per month on <a href="http://lists.ffmpeg.org/pipermail/ffmpeg-devel/">ffmpeg-devel mailing
list</a>, for patches and miscellaneous development discussions).</p>
<p>This attitude makes the users believe FFmpeg is not that an important project in
comparison to Libav.</p>
<h3>Real-life meetings</h3>
<p>The group behind the takeover is basically composed of kinfolks, knowing each
other very well, and actively participating to various &#34;commercial&#34; or
developers meetings. They also believe talking in real life is the way of
solving every human and technical problems (but also like to ignore the mails
and IRC talks they don&#39;t like).</p>
<p>Thus, they are widely known by the mainstream, since the social dimension is an
important thing for some users.</p>
<h2>So what comes next?</h2>
<p>I&#39;m unfortunately not yet able to predict the future, but concerning myself,
I&#39;ll just continue to do the best I can to make FFmpeg a better project, but of
course still following closely all the great things Libav developers are able to
produce.</p>
<p>A project reunification is clearly difficult to reach soon. FFmpeg made choices
Libav will never accept (such as the MPlayer filters wrapper in FFmpeg). On the
other hand I think both projects could be kept in sync somehow (if Libav wakes
up someday), with different methods of development, and even different goals:
FFmpeg can be trying to <a href="http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=53640f42be9f18368a8339116f8abf30616c60b2">support even more crazy exotic formats</a>
while Libav could decide to <a href="http://git.libav.org/?p=libav.git;a=commitdiff;h=db9e00f469d2dd3f43edfdea8eb78a816c87c79b">drop some because it is a &#34;maintenance
burden&#34;</a>. It&#39;s a good thing to affirm these differences for both
sides (&#34;we support everything&#34; vs &#34;we have less crap&#34;), what isn&#39;t is their
contemptuous behaviour towards developers and users.</p>
</article><p>
 For updates and more frequent content you can follow me on <a href="https://fosstodon.org/@bug">Mastodon</a>. Feel also free to
 subscribe to the <a href="https://riskmusings.substack.com/rss.xml">RSS</a> in order to be notified
 of new write-ups. It is also usually possible to reach me through
 other means (check the footer below). Finally, discussions on some of
 the articles can sometimes be found on HackerNews, Lobste.rs and
 Reddit.
</p></div>
  </body>
</html>
