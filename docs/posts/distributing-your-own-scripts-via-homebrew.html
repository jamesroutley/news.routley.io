<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/">Original</a>
    <h1>Distributing your own scripts via Homebrew</h1>
    
    <div id="readability-page-1" class="page"><article data-pagefind-body="">
    <time pubdate="" datetime="2025-09-06" data-pagefind-meta="date:2025-09-06" data-pagefind-sort="date:2025-09-06">
      Saturday, Sep 6, 2025
    </time>
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/">
      
    </a>

    <p>I use <a href="https://brew.sh">Homebrew</a> all the time. Whenever I see a new CLI that offers an <code>npm</code> or <code>uv</code> install path alongside a <code>brew</code> one, I choose brew every single time.</p>
<p>And yet, when it comes time to publish a CLI of my own, I usually just ship it as a Ruby gem or an npm package, because I had (and have!) no fucking clue how Homebrew works. I&#39;m not enough of a neckbeard to peer behind the curtain as soon as root directories like <code>/usr</code> and <code>/opt</code> are involved, so I never bothered before today.</p>
<p>But it&#39;s 2025 and we can consult LLMs to conjure whatever arcane incantations we need. And because he listens to <a href="https://justin.searls.co/casts/breaking-change/">the cast</a>, I can always fall back on texting <a href="https://mikemcquaid.com/about/">Mike McQuaid</a> when <a href="https://github.com/Homebrew/brew/pull/20639">his docs suck</a>.</p>
<p>So, because I&#39;ll never remember any of this shit (it&#39;s already fading from view as I type this), below are the steps involved in publishing your own CLI to Homebrew. The first formula I published is a simple Ruby script, but this guide should be generally applicable.</p>

<h2 id="glossary">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#glossary">Glossary</a>
</h2>
<p>Because Homebrew <em>really fucking leans in</em> to the whole &#34;home brewing as in beer&#34; motif when it comes to naming, it&#39;s easy to get lost in the not-particularly-apt nomenclature they chose.</p>
<p><a href="https://docs.brew.sh/Formula-Cookbook#homebrew-terminology">Translate these</a> in your head when you encounter them:</p>
<ul>
<li>Formula → Package definition</li>
<li>Tap → Git repository of formulae</li>
<li>Cask → Manifest for installing pre-built GUIs or large binaries</li>
<li>Bottle → Pre-built binary packages that are &#34;poured&#34; (copied) instead of built from source</li>
<li>Cellar → Directory containing your installed formulae (e.g. <code>/opt/homebrew/Cellar</code>)</li>
<li>Keg → Directory housing an installed formula (e.g. <code>Cellar/foo/1.2.3</code>)</li>
</ul>

<h2 id="overview">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#overview">Overview</a>
</h2>
<p>First thing to know is that the Homebrew team <a href="https://docs.brew.sh/Acceptable-Formulae#niche-or-self-submitted-stuff">doesn&#39;t want your stupid CLI</a> in the <a href="https://github.com/Homebrew/homebrew-core">core repository</a>.</p>
<p>Instead, the golden path for us non-famous people is to:</p>
<ol>
<li>Make your CLI, push it to GitHub, cut a tagged release</li>
<li><a href="#create-your-tap">Create a Homebrew tap</a></li>
<li><a href="#create-your-formula">Create a Homebrew formula</a></li>
<li><a href="#update-the-formula-for-each-cli-release">Update the formula for each CLI release</a></li>
</ol>
<p>After you complete the steps outlined below, users will be able to install your cool CLI in just two commands:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>brew tap your_github_handle/tap
</span></span><span><span>brew install your_cool_cli
</span></span></code></pre></div><p>Leaving the &#34;make your CLI&#34; step as an exercise for the reader, let&#39;s walk through the three steps required to distribute it on Homebrew. In my case, I slopped up a CLI called <a href="https://github.com/searlsco/imsg">imsg</a> that creates interactive web archives from an iMessage database.</p>

<h2 id="create-your-tap">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#create-your-tap">Create your tap</a>
</h2>
<p>Here&#39;s <a href="https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap">Homebrew&#39;s guide</a> on creating a tap. Let&#39;s follow along how I set things up for myself. Just replace each example with your own username or organization.</p>
<p>For simplicity&#39;s sake, you probably want a single tap for all the command line tools you publish moving forward. If that&#39;s the case, then you want to name the tap <code>homebrew-tap</code>. The <code>homebrew</code> prefix is treated specially by the <code>brew</code> CLI and the <code>tap</code> suffix is conventional.</p>
<p>First, create the tap:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>brew tap-new searlsco/homebrew-tap
</span></span></code></pre></div><p>This creates a scaffold in <code>/opt/homebrew/Library/Taps/searlsco/homebrew-tap</code>. Next, I created a <a href="https://github.com/searlsco/homebrew-tap">matching repository in GitHub</a> and pushed what Homebrew generated:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span><span>cd</span> /opt/homebrew/Library/Taps/searlsco/homebrew-tap
</span></span><span><span>git remote add origin git@github.com:searlsco/homebrew-tap.git
</span></span><span><span>git push -u origin main
</span></span></code></pre></div><p>Congratulations, you&#39;re the proud owner of a tap. Now other homebrew users can run:</p>
<p>It doesn&#39;t contain anything useful, but they can run it. The command will clone your repository into their <code>/opt/homebrew/Library/Taps</code> directory.</p>

<h2 id="create-your-formula">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#create-your-formula">Create your formula</a>
</h2>
<p>Even though Homebrew depends on all manner of git operations to function and fully supports just pointing your formula at a GitHub repository, the <a href="https://docs.brew.sh/Acceptable-Formulae#stable-versions">Homebrew team recommends</a> instead referencing versioned tarballs with checksums. Why? Something something reproducibility, yadda yadda open source supply chain. Whatever, let&#39;s just do it their way.</p>
<p>One nifty feature of GitHub is that they&#39;ll host a tarball archive of any tags you push at a predictable URL. That means if I run these commands in the <a href="https://github.com/searlsco/imsg">imsg repository</a>:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>git tag v0.0.5
</span></span><span><span>git push --tags
</span></span></code></pre></div><p>Then GitHub will host a tarball at <a href="https://github.com/searlsco/imsg/archive/refs/tags/v0.0.5.tar.gz">github.com/searlsco/imsg/archive/refs/tags/v0.0.5.tar.gz</a>.</p>
<p>Once we have that tarball URL, we can use <code>brew create</code> to generate our formula:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>brew create https://github.com/searlsco/imsg/archive/refs/tags/v0.0.5.tar.gz --tap searlsco/homebrew-tap --set-name imsg --ruby
</span></span></code></pre></div><p>The three flags there do the following:</p>
<ul>
<li><code>--tap</code> points it to the custom tap we created in the previous step, and will place the formula in <code>/opt/homebrew/Library/Taps/searlsco/homebrew-tap/Formula</code></li>
<li><code>--set-name imsg</code> will name the formula explicitly, though <code>brew create</code> would have inferred this and confirmed it interactively. The name should be unique so you don&#39;t do something stupid like make a CLI <a href="https://github.com/tendersearls/tldr">named TLDR</a> when there&#39;s already a CLI <a href="https://github.com/tendersearls/tldr/issues/4">named TLDR</a> or a CLI <a href="https://github.com/standardrb/standard">named standard</a> when there&#39;s already a CLI <a href="https://github.com/standardrb/standard/issues/3">named standard</a></li>
<li><code>--ruby</code> is one of <a href="https://docs.brew.sh/Manpage#create-options-url">several template presets</a> provided to simplify the task of customizing your formula</li>
</ul>
<p>Congratulations! You now have a formula for your CLI. It almost certainly doesn&#39;t work and you almost certainly have no clue how to make it work, but it&#39;s yours!</p>
<p>This is where LLMs come in.</p>
<ol>
<li>Run <code>brew install --verbose imsg</code></li>
<li>Paste what broke into ChatGPT</li>
<li>Update formula</li>
<li>GOTO 1 until it works</li>
</ol>
<p>Eventually, I wound up with a working <a href="https://github.com/searlsco/homebrew-tap/blob/main/Formula/imsg.rb">Formula/imsg.rb</a> file. (If you&#39;re publishing a Ruby CLI, feel free to copy-paste it as a starting point.) Importantly, and a big reason to distribute via Homebrew as opposed to a language-specific package manager, is that I could theoretically swap out the implementation for some other language entirely without disrupting users&#39; ability to upgrade.</p>
<p>Key highlights if you&#39;re reading the formula contents:</p>
<ul>
<li><em>All</em> formulae are written in Ruby, not just Ruby-related formulae. Before JavaScript and AI took turns devouring the universe, popular developer tools were often written in Ruby and Homebrew is one of those</li>
<li>You can specify your formula&#39;s git repository with the <code>head</code> method (though I&#39;m unsure this does anything)</li>
<li>Adding a <a href="https://docs.brew.sh/Brew-Livecheck">livecheck</a> seemed easy and worth doing</li>
<li>Adding a test to ensure the binary runs can be as simple as asserting on help output. Don&#39;t let the generated comment scare you off</li>
<li>Run <code>brew style searlsco/tap</code> to make sure you didn&#39;t fuck anything up.</li>
<li>By default, the <code>--ruby</code> template adds <code>uses_from_macos &#34;ruby&#34;</code>, which is currently version 2.6.10 (which was released before the Covid pandemic and <a href="https://endoflife.date/ruby">end-of-life</a>&#39;d over three years ago). You probably want to rely on the <a href="https://formulae.brew.sh/formula/ruby#default">ruby formula</a> with <code>depends_on &#34;ruby@3&#34;</code> instead</li>
</ul>
<p>When you&#39;re happy with it, just <code>git push</code> and your formula is live! Now any homebrew user can install your thing:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>brew tap searlsco/tap
</span></span><span><span>brew install imsg
</span></span></code></pre></div>
<h2 id="update-the-formula-for-each-cli-release">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#update-the-formula-for-each-cli-release">Update the formula for each CLI release</a>
</h2>
<p>Of course, any joy I derived from getting this to work was fleeting, because of this bullshit at the top of the formula:</p>
<div><pre tabindex="0"><code data-lang="ruby"><span><span><span>class</span> <span>Imsg</span> <span>&lt;</span> <span>Formula</span>
</span></span><span><span>  <span>url</span> <span>&#34;https://github.com/searlsco/imsg/archive/refs/tags/v0.0.5.tar.gz&#34;</span>
</span></span><span><span>  <span>sha256</span> <span>&#34;e9166c70bfb90ae38c00c3ee042af8d2a9443d06afaeaf25a202ee8d66d1ca04&#34;</span>
</span></span></code></pre></div><p><em>Who the fuck&#39;s job is it going to be to update these URLs and SHA hashes?</em> Certainly not mine. I barely have the patience to <code>git push</code> my work, much less tag it. And forget about clicking around to create a GitHub release. Now I need to open a <em>second project</em> and update the version there, too? And compute a hash? Get the fuck out of here.</p>
<p>Now, I will grant that Homebrew ships with a <a href="https://docs.brew.sh/Manpage#bump-formula-pr-options-formula">command that opens a PR</a> for each formula update and some guy <a href="https://github.com/dawidd6/action-homebrew-bump-formula">wrapped it in a GitHub action</a>, but both assume you want to daintily fork the tap and humbly submit a pull request to yourself. Clearly all this shit was designed back when Homebrew was letting anybody spam shit into <a href="https://github.com/Homebrew/homebrew-core">homebrew-core</a>. It&#39;s my tap, just give me a way to commit to main, please and thank you.</p>
<p>So anyway, you can jump through all those hoops each time you update your CLI if you&#39;re a sucker. But be honest with yourself, you&#39;re just gonna wind up back at this stupid blog post again, because you&#39;ll have forgotten the process. To avoid this, I asked my AI companion to add a GitHub workflow to my formula repository that automatically commits release updates to my tap repository.</p>
<p>If you want to join me in the fast lane, feel free to <a href="https://github.com/searlsco/imsg/blob/main/.github/workflows/update_homebrew_formula.yml">copy paste my workflow</a> as a starting point. The only things you&#39;ll need to set up yourself:</p>
<ul>
<li>You&#39;ll need a <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">personal-access token</a>:
<ul>
<li>When creating the PAT, add your <code>homebrew-tap</code> repository and <code>Content</code> → <code>Write</code> permissions</li>
<li>In the formula repository&#39;s settings under <code>Secrets and variables</code> → <code>Actions</code> → <code>Repository secrets</code> and name it <code>HOMEBREW_TAP_TOKEN</code> (<a href="https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets">GitHub docs</a>)</li>
</ul>
</li>
<li>You&#39;ll need to specify the <a href="https://github.com/searlsco/imsg/blob/v0.0.5/.github/workflows/update_homebrew_formula.yml#L13-L15">tap and formula environment variables</a></li>
<li>You&#39;ll probably want to update the <a href="https://github.com/searlsco/imsg/blob/v0.0.5/.github/workflows/update_homebrew_formula.yml#L61-L62">GitHub bot account</a>, probably to the <a href="https://api.github.com/users/github-actions%5Bbot%5D">GitHub Actions bot</a> if you don&#39;t <a href="https://github.com/bitsly">have your own</a>:
<ul>
<li><code>GH_EMAIL: 41898282+github-actions[bot]@users.noreply.github.com</code></li>
<li><code>GH_NAME: github-actions[bot]</code></li>
</ul>
</li>
</ul>
<p>Now, whenever you cut a release, your tap will be updated automatically. Within a few seconds of running <code>git push --tags</code> in your formula&#39;s repositories, your users will be able to upgrade their installations with:</p>
<div><pre tabindex="0"><code data-lang="sh"><span><span>brew update
</span></span><span><span>brew upgrade imsg
</span></span></code></pre></div><p>That&#39;s it. Job&#39;s done!</p>

<h2 id="the-best-part">
    <a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/#the-best-part">The best part</a>
</h2>
<p>This was a royal pain in the ass to figure out, so hopefully this guide was helpful. The best part is that once your tap is set up and configured and you have a single working formula to serve as an example, <strong>publishing additional CLI tools in the future becomes almost trivial</strong>.</p>
<p>Now, will I actually ever publish another formula? Beats me. But it feels nice to know it would only take me a few minutes if I wanted to. 🍻</p>
  </article><div>
  <hr/>
  <h2>Got a taste for hot, fresh takes?</h2>
  <p>
    Then you&#39;re in luck, because you&#39;ll pay $0 for my 2¢ when you <a href="https://justin.searls.co/subscribe/">subscribe to my work</a>, whether via <a href="https://justin.searls.co/rss/">RSS</a> or your favorite <a href="https://justin.searls.co/posse/">social network</a>.
  </p>
  <p>
    I also have a monthly <a href="https://justin.searls.co/newsletter">newsletter</a> where I write high-tempo, thought-provoking essays about life, in case that&#39;s more your speed:
  </p>
  
  <p>
    And if you&#39;d rather give your eyes a rest and your ears a workout, might I suggest my long-form solo podcast, <a href="https://justin.searls.co/casts/breaking-change/">Breaking Change</a>? Odds are, you haven&#39;t heard anything quite like it.
  </p>
</div></div>
  </body>
</html>
