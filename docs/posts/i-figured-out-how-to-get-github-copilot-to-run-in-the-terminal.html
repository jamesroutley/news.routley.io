<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/maxwell-bland/copilot-in-the-terminal">Original</a>
    <h1>I figured out how to get GitHub Copilot to run in the terminal</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">

<p dir="auto">So you got tired of AI just suggesting code edits, and now you want it to help
you run code, too. Silly human, you have come to the right place. This will
take five steps.</p>
<p dir="auto">This is a hacky solution to allow for copilot suggestions to work in the
terminal by treating neovim as a thin shell-around-a-shell.</p>
<h2 dir="auto"><a id="user-content-installing" aria-hidden="true" href="#installing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing</h2>
<p dir="auto"><em>I use Astro Vim, so the code snippets below may need slightly different syntax
depending on your neovim setup!</em></p>
<ol dir="auto">
<li>You will want to install and get Github Copilot working with neovim.</li>
<li>The configuration for accepting copilot&#39;s autocomplete looks a bit like this:</li>
</ol>
<p dir="auto">In <code>~/.config/nvim/init.lua</code>, set a desired keymap:</p>
<div data-snippet-clipboard-copy-content="vim.api.nvim_set_keymap(&#34;!&#34;, &#34;&lt;C-]&gt;&#34;, &#39;copilot#Accept(&#34;&lt;CR&gt;&#34;)&#39;, { silent = true, expr = true, noremap=true })
vim.api.nvim_set_var(&#39;copilot_assume_mapped&#39;, true)"><pre><code>vim.api.nvim_set_keymap(&#34;!&#34;, &#34;&lt;C-]&gt;&#34;, &#39;copilot#Accept(&#34;&lt;CR&gt;&#34;)&#39;, { silent = true, expr = true, noremap=true })
vim.api.nvim_set_var(&#39;copilot_assume_mapped&#39;, true)
</code></pre></div>
<ol start="3" dir="auto">
<li>You will want to install the following three plugins (special credit to Shougo, the real legend!!!):</li>
</ol>
<p dir="auto">In <code>~/.config/nvim/lua/core/plugins.lua</code>:</p>
<div data-snippet-clipboard-copy-content="  [&#34;Shougo/vimproc.vim&#34;] = {},
  [&#34;Shougo/vimshell.vim&#34;] = {},
  [&#34;Shougo/unite.vim&#34;] = {},"><pre><code>  [&#34;Shougo/vimproc.vim&#34;] = {},
  [&#34;Shougo/vimshell.vim&#34;] = {},
  [&#34;Shougo/unite.vim&#34;] = {},
</code></pre></div>
<ol start="4" dir="auto">
<li>Build vimproc!</li>
</ol>
<div data-snippet-clipboard-copy-content="cd ~/.local/share/nvim/site/pack/packer/start/vimproc.vim
make"><pre><code>cd ~/.local/share/nvim/site/pack/packer/start/vimproc.vim
make
</code></pre></div>
<ol start="5" dir="auto">
<li>Remove the key mapping conflicts with vimshell!</li>
</ol>
<div data-snippet-clipboard-copy-content="vim ~/.local/share/nvim/site/pack/packer/start/vimshell.vim/autoload/vimshell/mappings.vim"><pre><code>vim ~/.local/share/nvim/site/pack/packer/start/vimshell.vim/autoload/vimshell/mappings.vim
</code></pre></div>
<p dir="auto">and comment out (or remap) the overloaded mappings on line 155, change the following</p>
<div data-snippet-clipboard-copy-content="inoremap &lt;expr&gt; &lt;SID&gt;(bs-ctrl-])
      \ getline(&#39;.&#39;)[col(&#39;.&#39;) - 2] ==# &#34;\&lt;C-]&gt;&#34; ? &#34;\&lt;BS&gt;&#34; : &#39;&#39;
imap &lt;buffer&gt; &lt;C-]&gt;               &lt;C-]&gt;&lt;SID&gt;(bs-ctrl-])
imap &lt;buffer&gt; &lt;CR&gt;                &lt;C-]&gt;&lt;Plug&gt;(vimshell_enter)"><pre><code>inoremap &lt;expr&gt; &lt;SID&gt;(bs-ctrl-])
      \ getline(&#39;.&#39;)[col(&#39;.&#39;) - 2] ==# &#34;\&lt;C-]&gt;&#34; ? &#34;\&lt;BS&gt;&#34; : &#39;&#39;
imap &lt;buffer&gt; &lt;C-]&gt;               &lt;C-]&gt;&lt;SID&gt;(bs-ctrl-])
imap &lt;buffer&gt; &lt;CR&gt;                &lt;C-]&gt;&lt;Plug&gt;(vimshell_enter)
</code></pre></div>
<p dir="auto">to the following</p>
<div data-snippet-clipboard-copy-content="&#34; inoremap &lt;expr&gt; &lt;SID&gt;(bs-ctrl-])
&#34;       \ getline(&#39;.&#39;)[col(&#39;.&#39;) - 2] ==# &#34;\&lt;C-]&gt;&#34; ? &#34;\&lt;BS&gt;&#34; : &#39;&#39;
&#34; imap &lt;buffer&gt; &lt;C-]&gt;               &lt;C-]&gt;&lt;SID&gt;(bs-ctrl-])
imap &lt;buffer&gt; &lt;CR&gt;                &lt;Plug&gt;(vimshell_enter)"><pre><code>&#34; inoremap &lt;expr&gt; &lt;SID&gt;(bs-ctrl-])
&#34;       \ getline(&#39;.&#39;)[col(&#39;.&#39;) - 2] ==# &#34;\&lt;C-]&gt;&#34; ? &#34;\&lt;BS&gt;&#34; : &#39;&#39;
&#34; imap &lt;buffer&gt; &lt;C-]&gt;               &lt;C-]&gt;&lt;SID&gt;(bs-ctrl-])
imap &lt;buffer&gt; &lt;CR&gt;                &lt;Plug&gt;(vimshell_enter)
</code></pre></div>
<h2 dir="auto"><a id="user-content-running" aria-hidden="true" href="#running"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Running</h2>
<p dir="auto">Open up a new vim session and type <code>:VimShell</code>. Github copilot&#39;s autocomplete
will now work in your bash shell. Here&#39;s an example I came up with, where I
typed in <code>echo a random</code> and <code>cat</code>, then autocompleted the rest.</p>
<div data-snippet-clipboard-copy-content="vimshell% # echo a random number between 1 and 10
vimshell% cat /dev/urandom | od -N 1 -An -i | awk &#39;{print $1 % 10 + 1}&#39;"><pre><code>vimshell% # echo a random number between 1 and 10
vimshell% cat /dev/urandom | od -N 1 -An -i | awk &#39;{print $1 % 10 + 1}&#39;
</code></pre></div>
<h2 dir="auto"><a id="user-content-conclusion-and-a-warning" aria-hidden="true" href="#conclusion-and-a-warning"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conclusion and a Warning</h2>
<p dir="auto">Alright, my 1337 buddy. As you know, Copilot will start learning from the
commands you have executed in the current session, and the output. Don&#39;t leak
anything too secret, haha. Roko&#39;s Basilisk thanks you and sees all.</p>
</article>
          </div></div>
  </body>
</html>
