<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://siipo.la/blog/whats-the-best-lossless-image-format-comparing-png-webp-avif-and-jpeg-xl">Original</a>
    <h1>What’s the best lossless image format?</h1>
    
    <div id="readability-page-1" class="page"><div>

        

        <div>

            <div>
                <article id="post-658">
                    <div>
                        <div><p>In <a href="https://siipo.la/blog/is-webp-really-better-than-jpeg">a blog post</a> last year, I took a look at lossy image formats and how they stack up. This time, I thought it might be interesting to do a comparison of lossless image formats.</p></div>

<div><p>
<h2>What is lossless compression?</h2>
</p></div>

<div><p>Lossless compression is a way to make a file smaller so it’s faster to transfer or download, but it can be decompressed back to the exact same original file. ZIP and RAR are popular lossless file formats for file compression. In a web context, GZIP compression is often used to make JavaScript and CSS files smaller. In image compression, PNG is a well-known lossless format.</p></div>

<div><p>An alternative to lossless compression is lossy compression, which is often used when compressing photos. JPEG is probably the most well-known lossy image format. Lossy compression will throw away some detail in the image which will result in a dramatically smaller file size. Since large photos would otherwise be too big to transfer and store, losing some quality is often a good tradeoff.</p></div>




<div><p>
<h2>When to use lossless compression?</h2>
</p></div>

<div><p>While lossy image formats like JPEG and lossy WebP are great for photos, they don’t work so well for graphics. Compression artifacts, such as block artifacts and blurring can be easily visible and distracting on these kinds of images.</p></div>

<div><p>Lossless compression is great for images with large continuous areas of color since they will compress well using lossless compression algorithms. You can think of the classic <a href="https://en.wikipedia.org/wiki/Run-length_encoding">Run-Length Encoding (RLE)</a> algorithm which compresses repetitive data very efficiently. The real algorithms these formats use are of course more complicated.</p></div>

<div><p>Therefore, lossless image compression works best for things like logos, screenshots, charts, and graphics. Compressing these kinds of images with lossless compression can often lead to smaller file sizes with better quality when compared to lossy compression.</p></div>

<div>
    <div>
        <a href="https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression.png" target="_blank">
        
                <div>
                <picture>
                    <source type="image/webp" data-srcset="https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-8zf8vtypjxyi52nfjga58eou9-1460x736.webp 1460w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-1xritv3md2goacqf6n9jplnxd-800x403.webp?ver=ce9b57b5 800w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-1shnawf3sp803gl0ebtpxxvoi-1440x726.webp?ver=ce9b57b5 1440w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-d69ugqz4xd5nxapcqi5l06l2z-1080x544.webp?ver=ce9b57b5 1080w" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-sizes="auto"/>
                    <img loading="lazy" height="736" width="1460" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression.png?ver=ce9b57b5" data-srcset="https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression.png?ver=ce9b57b5 1460w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-9y1dxca4592sq5zgyzd3nrahr-800x403.png?ver=ce9b57b5 800w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-36pbjani8tywzbxuuoadws0nn-1440x726.png?ver=ce9b57b5 1440w, https://cdn.siipo.la/app/uploads/comparing-lossy-and-lossless-compression-2qiby3rqpywr832hsgjqwc8a5-1080x544.png?ver=ce9b57b5 1080w" data-sizes="auto"/>
                </picture>
            </div>
        </a>
    </div>
</div>


<div><p><strong>An example of an image where lossless compression works well. The recycling symbol as a PNG takes up 3 kilobytes. JPEG at the same file size has noticeable compression artifacts. A JPEG with the highest possible quality looks the same as the PNG, but it’s eight times as large.</strong></p></div>



<div><p>To test lossless compression, we’ll first need some images. Since lossless compression is not very effective with photographs, we’ll need some sample images that contain graphics, logos, and text. What I ended up with was downloading a set of images from <a href="https://dribbble.com/">Dribbble</a>, a portfolio site for designers.</p></div>

<div><p>Most of the images depict websites, mobile applications, logos, or illustrations. These kinds of images are perfect for lossless compression. I downloaded around 100 or so most popular “shots”, or images on the site.</p></div>

<div><p>Since many of the images were rather large, scaled the images down to a maximum width of 1000 pixels so compressing them doesn’t take an extremely long time. I also made sure the color space is sRGB.</p></div>

<div>
    <div>
        <a href="https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy.jpg" target="_blank">
        
                <p><img loading="lazy" height="2250" width="3000" alt="An image collage displaying 9 images" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy.jpg?ver=725b234b" data-srcset="https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy.jpg?ver=725b234b 3000w, https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy-9y1dxca4592sq5zgyzd3nrahr-800x600.jpg?ver=725b234b 800w, https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy-9yykar97j0pg3xvsoher1fzpi-1600x1200.jpg?ver=725b234b 1600w, https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy-36pbjani8tywzbxuuoadws0nn-1440x1080.jpg?ver=725b234b 1440w, https://cdn.siipo.la/app/uploads/lossless-comparison-dataset-preview-copy-2qiby3rqpywr832hsgjqwc8a5-1080x810.jpg?ver=725b234b 1080w" data-sizes="auto"/>
            </p>
        </a>
    </div>
</div>




<div><p>You can download the test images <a href="https://drive.google.com/file/d/1fldbQtlrSDUtDFZdAryd7yzkhKBwfqqR/view?usp=sharing">here</a>.</p></div>



<div><p>I decided to test the following image formats: PNG, lossless WebP, AVIF, and JPEG XL. All of them can be used in browsers today, except JPEG XL, which is supported in Chrome and Firefox but first must be enabled using a feature flag. JPEG XL will likely be supported by default in the upcoming versions of these browsers.</p></div>

<div><p>All of these file formats have an option for encoding speed. By specifying a low speed, the encoding takes a longer time but the resulting image will be smaller. At a high encoding speed, it’s the other way around. I have used the slowest possible speed in all of the examples in order to get the most out of the image formats.</p></div>



<div><p>PNG stands for <a href="https://en.wikipedia.org/wiki/Portable_Network_Graphics">Portable Network Graphics</a>. It’s one of the oldest web image formats, first released in 1996. It was originally developed as an alternative to the GIF format which was patent-encumbered at the time. PNG included many advantages compared to GIF, including full 24-bit color (8 bits per channel) and an alpha channel. The GIF format is limited to 256 colors per image and single transparent color.</p></div>

<div><p>PNG file format is based on the <a href="https://en.wikipedia.org/wiki/Deflate">DEFLATE compression algorithm</a> and has a special filter setting which predicts color values. This has led to the development of several PNG optimization tools that test different compression settings to minimize the file size. Some of the most well-known ones are <a href="http://advsys.net/ken/utils.htm">PNGOUT</a>, <a href="http://optipng.sourceforge.net/">OptiPNG</a>, and Rust-based <a href="https://github.com/shssoichiro/oxipng">OxiPNG</a>. It’s also possible to swap the usual DEFLATE compression to Google’s <a href="https://en.wikipedia.org/wiki/Zopfli">Zopfli</a> compression which is compatible with DEFLATE but achieves higher compression at the cost of a much longer compression time.</p></div>

<div><p>PNG format is supported by all browsers.</p></div>

<div><p>I compressed PNG files using OxiPNG v5.0.0, using the maximum possible optimization level with the following command:</p></div>

<div>
    <div>
        <p><code>oxipng /path/to/input/image.png --out /path/to/output/image.png --opt max --strip safe</code>
        </p>
    </div>
</div>


<div><p>I also optimized the same set of images using the Zopfli compression which takes a really long time but results in even smaller files.</p></div>

<div>
    <div>
        <p><code>oxipng /path/to/input/image.png --out /path/to/output/image.png --opt max --strip safe --zopfli</code>
        </p>
    </div>
</div>




<div><p>Google launched <a href="https://en.wikipedia.org/wiki/WebP">WebP</a> in 2010 as a lossy image format, based on the VP8 video codec. WebP 0.3 released in 2012 introduced a lossless mode, which is unrelated to the VP8 codec. While lossy WebP is limited to 4:2:0 Chroma subsampling which discards some color information, lossless WebP will retain all original image data.</p></div>

<div><p>In addition to the lossy and lossless mode, WebP also supports a “near-lossless” mode but I didn’t test that in this article. Such an option might be useful in some cases but I generally don’t find it useful since I would rather choose between lossless and lossy encoding and not something in-between.</p></div>

<div><p>Until very recently Apple’s Safari browser was the only WebP holdout. As of 2021, WebP is now supported by all major browsers.</p></div>

<div><p>For WebP, I used the official cwebp tool, version 1.2.0. For best compression, I defined quality of 100 and method 6.</p></div>

<div>
    <div>
        <p><code>cwebp /path/to/input/image.png -o /path/to/output/image.webp -q 100 -m 6 -lossless</code>
        </p>
    </div>
</div>




<div><p>AVIF stands for <a href="https://en.wikipedia.org/wiki/AV1#AV1_Image_File_Format_(AVIF)">AV1 Image File Format</a>. It is a new image format, based on the AV1 video codec. It has many advanced features, such as support for high bit depth and HDR. The format supports both lossless and lossy compression.</p></div>

<div><p>AVIF is supported in recent versions of Google Chrome and can be enabled in Firefox by using a configuration flag.</p></div>

<div><p>For encoding AVIF files, I used avifenc v0.9.1 from <a href="https://github.com/AOMediaCodec/libavif">libavif</a>. I used the lowest possible speed to get the best compression.</p></div>

<div>
    <div>
        <p><code>avifenc --lossless --speed 0 /path/to/input/image.png /path/to/output/image.avif</code>
        </p>
    </div>
</div>




<div><p><a href="https://en.wikipedia.org/wiki/JPEG_XL">JPEG XL</a> is a new and upcoming image format. JPEG XL was developed by combining two existing image formats, the Google-developed <a href="https://github.com/google/pik">Pik</a> image format and <a href="https://github.com/cloudinary/fuif">FUIF</a> (Free Universal Image Format) developed at Cloudinary.</p></div>

<div><p>The cjxl command-line tool defaults to Pik-based format, named VarDCT, but FUIF-derived Modular mode can be selected by specifying the –modular flag on the command line. JPEG XL supports both lossless and lossy compression.</p></div>

<div><p>JPEG XL is supported in Chrome and Firefox, but it’s not enabled by default. Support for the format must be enabled by using a feature flag.</p></div>

<div><p>To compress JPEG XL files, I used the official cjxl tool, version 0.3.7_1.</p></div>

<div>
    <div>
        <p><code>cjxl /path/to/input/image.png /path/to/output/image.jxl --modular --quality 100 --speed 9 -E 3 </code>
        </p>
    </div>
</div>


<div><p>The command-line flags are otherwise self-explanatory, except the -E flag, which I’ve heard stands for “extra arguments”. I used the value 3, which is recommended for best compression. Using this option shaved off a few kilobytes from the file size while the image took a bit longer to compress.</p></div>



<div><p>Here are the results for the 94 images. The bars depict the median results and the error bars illustrate the 25th and 75th percentiles. You can see the full data as a spreadsheet <a href="https://docs.google.com/spreadsheets/d/16nvtgkukhYpAnsSSLaXty0fbwZ8qKmFN-0VFhGp7i3w/edit?usp=sharing">here</a>.</p></div>



<div>
    <div>
        <a href="https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size.png" target="_blank">
        
                <div>
                <picture>
                    <source type="image/webp" data-srcset="https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-ak9xusm7cafgkf4pqdyfjbk20-1582x1178.webp 1582w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-1xritv3md2goacqf6n9jplnxd-800x596.webp?ver=97874f66 800w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-1shnawf3sp803gl0ebtpxxvoi-1440x1072.webp?ver=97874f66 1440w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-d69ugqz4xd5nxapcqi5l06l2z-1080x804.webp?ver=97874f66 1080w" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-sizes="auto"/>
                    <img loading="lazy" height="1178" width="1582" alt="Median file size (KB). Reference PNG: 252 KB. OxiPNG: 223 KB. OxiPNG + Zopfli: 207 KB. Lossless WebP: 148 KB. Lossless AVIF: 203 KB. Lossless JPEG XL: 131 KB" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size.png?ver=97874f66" data-srcset="https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size.png?ver=97874f66 1582w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-9y1dxca4592sq5zgyzd3nrahr-800x596.png?ver=97874f66 800w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-36pbjani8tywzbxuuoadws0nn-1440x1072.png?ver=97874f66 1440w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-file-size-2qiby3rqpywr832hsgjqwc8a5-1080x804.png?ver=97874f66 1080w" data-sizes="auto"/>
                </picture>
            </div>
        </a>
    </div>
</div>




<div><p>I thought it would be interesting to also compare compression speed between different file formats. For reference, the encoding was done on my 2015 15’ MacBook Pro.</p></div>

<div>
    <div>
        <a href="https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars.png" target="_blank">
        
                <div>
                <picture>
                    <source type="image/webp" data-srcset="https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-ak9xusm7cafgkf4pqdyfjbk20-1582x1032.webp 1582w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-1xritv3md2goacqf6n9jplnxd-800x522.webp?ver=ca79d534 800w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-1shnawf3sp803gl0ebtpxxvoi-1440x939.webp?ver=ca79d534 1440w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-d69ugqz4xd5nxapcqi5l06l2z-1080x705.webp?ver=ca79d534 1080w" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-sizes="auto"/>
                    <img loading="lazy" height="1032" width="1582" alt="Median encoding time per file (seconds). OxiPNG: 0.7 s. OxiPNG + Zopfli: 208 s. Lossless WebP: 3s. Lossless AVIF: 30s. Lossless JPEG XL: 25s" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars.png?ver=ca79d534" data-srcset="https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars.png?ver=ca79d534 1582w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-9y1dxca4592sq5zgyzd3nrahr-800x522.png?ver=ca79d534 800w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-36pbjani8tywzbxuuoadws0nn-1440x939.png?ver=ca79d534 1440w, https://cdn.siipo.la/app/uploads/lossless-comparison-median-encoding-time-no-error-bars-2qiby3rqpywr832hsgjqwc8a5-1080x705.png?ver=ca79d534 1080w" data-sizes="auto"/>
                </picture>
            </div>
        </a>
    </div>
</div>




<div><p>Looking at the test results, the bottom line is that most modern lossless image formats, like WebP and JPEG XL, provide big gains in efficiency compared to even the most optimized PNG.</p></div>



<div><p>Optimizing PNGs with OxiPNG can make them slightly smaller, around 12%, which is not a drastic difference. OxiPNG is very quick, taking around only 700 milliseconds to process one image.</p></div>

<div><p>Using the Zopfli setting with OxiPNG makes optimization extremely slow, on average taking around 208 seconds, or three and a half minutes. The resulting files are about 18% smaller when compared to the original PNGs. I wouldn’t recommend using Zopfli compression because it takes so much time and provides only slightly smaller files. A newer format like WebP or JPEG XL produces much smaller files and the encoding time is a fraction of Zopfli’s.</p></div>

<div><p>Since PNG optimization gains are so small and the process takes so much time, it might not be worthwhile to optimize PNG files at all if you are able to use a more modern format instead. Even unoptimized, PNG can still be a good choice for a source image format since it’s compatible with most software like image editors and content management systems. You can then convert the original PNG files to a more efficient format before displaying them to end-users. PNG can also be a useful fallback format for clients that can’t display modern formats, such as some email clients and old browsers.</p></div>



<div><p>WebP is a good choice for lossless images since it easily wins over PNG when it comes to compression efficiency, having 41% smaller images on average. It’s also widely supported in web browsers and other software. WebP files are quick to encode too, taking only around 3 seconds to compress.</p></div>





<div><p>In the lossless mode, encoding an AVIF file takes 30 seconds on average, but the results aren’t that great compared to other competing formats. At around 20% average reduction, the resulting file sizes are comparable to OxiPNG with Zopfli but noticeably larger compared to WebP or JPEG XL. When using AVIF, I would stick to lossy compression which the format does best.</p></div>



<div><p>JPEG XL is the new kid on the block and makes a strong impression. The average file size reduction is around 48%, which is slightly better than WebP. When looking at the 75th percentile, JPEG XL has the edge over WebP which means JPEG XL does a better job dealing with complex images that are hard to compress. Encoding a JPEG XL image takes around 24 seconds on average, which is on the slow side, but then again, I’m using the slowest settings possible on purpose.</p></div>



<div><p>While these results are informative, keep in mind that these are just results from a single test with a limited amount of images. When evaluating new formats, use your own test data since you might end up with a different conclusion.</p></div>

<div><p>These tests have also been done at the lowest possible speeds and highest possible compression ratio. This is feasible in many cases but sometimes you might need to do the image processing in real-time. In this case, you will need to use a faster image compression setting to achieve the necessary speed.</p></div>

<div><p>The future for lossless image compression looks bright. We already have modern image formats that can easily beat PNG when it comes to compression. Also, there are new and exciting image formats on the way, like JPEG XL, which could be even better.</p></div>



                    </div>
                </article>
            </div>

        </div>



    </div></div>
  </body>
</html>
