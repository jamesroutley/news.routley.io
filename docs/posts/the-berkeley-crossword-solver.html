<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bair.berkeley.edu/blog/2022/05/20/crosswords/">Original</a>
    <h1>The Berkeley Crossword Solver</h1>
    
    <div id="readability-page-1" class="page"><div>
    


    <div role="main">
      <div>
        



<article>
  <!-- twitter -->
<meta name="twitter:title" content="The Berkeley Crossword Solver"/>

<meta name="twitter:card" content="summary_large_image"/>

<meta name="twitter:image" content="https://bair.berkeley.edu/static/blog/crosswords/fig1.png"/>

<meta name="keywords" content="keyword1, keyword2"/>

<meta name="description" content="Building the world&#39;s best automated crossword solver"/>

<meta name="author" content="Eric Wallace, Nicholas Tomlin, Albert Xu, Kevin Yang, Eshaan Pathak"/>

<p>We recently built the Berkeley Crossword Solver (BCS), the first computer program to beat every human competitor in the world’s top crossword tournament. The BCS combines neural question answering and probabilistic inference to achieve near-perfect performance on most American-style crossword puzzles, like the one shown below:</p>

<p>
    <img src="https://bair.berkeley.edu/static/blog/crosswords/fig1.png" width="90%"/>
    </p>

<p>Crosswords are challenging for humans and computers alike. Many clues are vague or underspecified and can’t be answered until crossing constraints are taken into account. While some clues are similar to factoid question answering, others require relational reasoning or understanding difficult wordplay.</p>

<!--more-->

<p>Here are a handful of example clues from our dataset (answers at the bottom of this post):</p>
<ul>
  <li>They’re given out at Berkeley’s HAAS School (4)</li>
  <li>Winter hrs. in Berkeley (3)</li>
  <li>Domain ender that UC Berkeley was one of the first schools to adopt (3)</li>
  <li>Angeleno at Berkeley, say (8)</li>
</ul>


<p>The BCS uses a two-step process to solve crossword puzzles. First, it generates a probability distribution over possible answers to each clue using a question answering (QA) model; second, it uses probabilistic inference, combined with local search and a generative language model, to handle conflicts between proposed intersecting answers.</p>

<p>
    <img src="https://bair.berkeley.edu/static/blog/crosswords/fig2.png" width="90%"/>
    </p>

<p>The BCS’s question answering model is based on DPR [Karpukhin et al., 2020], which is a bi-encoder model typically used to retrieve passages that are relevant to a given question. Rather than passages, however, our approach maps both questions and answers into a shared embedding space and finds answers directly. Compared to the previous state-of-the-art method for answering crossword clues, this approach obtained a 13.4% absolute improvement in top-1000 QA accuracy. We conducted a manual error analysis and found that our QA model typically performed well on questions involving knowledge, commonsense reasoning, and definitions, but it often struggled to understand wordplay or theme-related clues.</p>

<p>After running the QA model on each clue, the BCS runs loopy belief propagation to iteratively update the answer probabilities in the grid. This allows information from high confidence predictions to propagate to more challenging clues. After belief propagation converges, the BCS obtains an initial puzzle solution by greedily taking the highest likelihood answer at each position.</p>

<p>The BCS then refines this solution using a local search that tries to replace low confidence characters in the grid. Local search works by using a guided proposal distribution in which characters that had lower marginal probabilities during belief propagation are iteratively replaced until a locally optimal solution is found. We score these alternate characters using a character-level language model (ByT5, Xue et al., 2022), that handles novel answers better than our closed-book QA model.</p>

<p>
    <img src="https://bair.berkeley.edu/static/blog/crosswords/fig3.png" width="90%"/>
    </p>


<p>We evaluated the BCS on puzzles from five major crossword publishers, including The New York Times. Our system obtains 99.7% letter accuracy on average, which jumps to 99.9% if you ignore puzzles that involve rare themes. It solves 81.7% of puzzles without a single mistake, which is a 24.8% improvement over the previous state-of-the-art system.</p>

<p>
    <img src="https://bair.berkeley.edu/static/blog/crosswords/fig4.png" width="90%"/>
    </p>


<p>The American Crossword Puzzle Tournament (ACPT) is the largest and longest-running crossword tournament and is organized by Will Shortz, the New York Times crossword editor. Two prior approaches to computer crossword solving gained mainstream attention and competed in the ACPT: Proverb and Dr. Fill. Proverb is a 1998 system that ranked 213th out of 252 competitors in the tournament. Dr. Fill’s first competition was in ACPT 2012, and it ranked 141st out of 650 competitors. We teamed up with Dr. Fill’s creator Matt Ginsberg and combined an early version of our QA system with Dr. Fill’s search procedure to win first place in the 2021 ACPT against over a thousand competitors. Our submission solved all seven puzzles in under a minute, missing just three letters across two puzzles.</p>

<p>
    <img src="https://bair.berkeley.edu/static/blog/crosswords/fig5.png" width="90%"/>
    </p>

<p>We are really excited about the challenges that remain in crosswords, including handling difficult themes and more complex wordplay. To encourage future work, we are releasing a dataset of 6.4M question answer clues, a demo of the Berkeley Crossword Solver, and our code at <a href="http://berkeleycrosswordsolver.com">http://berkeleycrosswordsolver.com</a>.</p>

<p>Answers to clues: MBAS, PST, EDU, INSTATER</p>

</article>









      </div>
    </div>
  </div></div>
  </body>
</html>
