<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lwn.net/SubscriberLink/898452/357b195db1ecce28/">Original</a>
    <h1>Introducing PyScript (summary of PyCon keynote)</h1>
    
    <div id="readability-page-1" class="page"><div>
<!-- $Id: slink-none,v 1.2 2005-11-04 22:11:18 corbet Exp $ -->
<blockquote>
<div>
<h3>Welcome to LWN.net</h3>
<p>
The following subscription-only content has been made available to you 
by an LWN subscriber.  Thousands of subscribers depend on LWN for the 
best news from the Linux and free software communities.  If you enjoy this 
article, please consider <a href="https://lwn.net/subscribe/">subscribing to LWN</a>.  Thank you
for visiting LWN.net!
</p></div>
</blockquote>

<p>
In a keynote at <a href="https://us.pycon.org/2022/">PyCon 2022</a> in Salt
Lake City, Utah, Peter Wang introduced another entrant in the field of
in-browser Python interpreters.  The Python community has long sought a way
to be able to write Python—instead of JavaScript—to run in web browsers, and there
have been various efforts to do so over the years.  Wang announced <a href="https://pyscript.net/">PyScript</a> as a new framework, built atop
one of those earlier projects, to allow
Python scripting directly within the browser; those programs have access to
much of the existing Python ecosystem as well as being able to interact
with the browser document object model (DOM) directly. 
In addition, he gave some rather eye-opening demonstrations as part of the talk.
</p>

<p><a href="https://lwn.net/Articles/898646/">
<img src="https://static.lwn.net/images/2022/pycon-wang-sm.png" alt="[Peter Wang]" title="Peter Wang" width="227" height="260"/>
</a></p><p>
Wang began by introducing himself and the company that he runs, <a href="https://www.anaconda.com/">Anaconda</a>, which he co-founded with
Travis Oliphant ten years ago.  Oliphant was the creator of <a href="https://numpy.org/">NumPy</a> and one of the founders of <a href="https://scipy.org/">SciPy</a>, both of which are cornerstones of the
Python scientific-computing ecosystem.  Anaconda has created a number of different
tools that are used widely in the community, as well as founding the <a href="https://numfocus.org/">NumFOCUS non-profit</a> and the <a href="https://pydata.org/">PyData conferences</a>.
</p>

<p>
There were a number of reasons why he and Oliphant chose to focus their efforts around
Python, including that the language is approachable, even by those who lack
a computer-science background.  Another point in its favor is that the
Python community is generally welcoming and pleasant to work in.  That is a
&#34;really big deal if you want to keep growing the user base&#34;. 
</p>

<p>
But there is another aspect of the language that makes it so desirable from
his standpoint: it can be extended with binary extensions that use an API
that is written in C, but can be accessed from other languages.  He likens
Python to &#34;a Honda Civic with mounting bolts for a warp drive&#34;.   So the
language can be picked up by kids who can then pop open the trunk &#34;and bolt
on warp nacelles&#34; that allows the code to run faster than C or C++ in some
cases, Wang said.
</p>

<p>
That aspect is sometimes overlooked, but it means that Python can be used
in ways that other, similar languages cannot.  &#34;It&#39;s not just like Node,
it&#39;s not just an alternative to Ruby&#34;.  The reason Python was picked up by
Wall Street firms ten or 15 years ago was because of this warp-drive
capability, he said.
</p>

<h4>What sucks</h4>

<p>
&#34;Here among friends&#34; we can talk about what sucks about the language as
well, he said.  Even though Anaconda is in the business of providing a
Python distribution, he &#34;will be the first to say&#34; that installing
everything that is needed for Python is too hard.  There are an enormous
number of packages on the <a href="https://pypi.org/">Python Package
Index</a> (PyPI), but getting them to 
work together is difficult.  There are lots of different tools to help solve
that problem, but all of them
are at about 80%, he said, so people are having a bad experience 20% of the
time, which is &#34;not great&#34;.
</p>

<p>
It is odd that, for the world&#39;s most popular language, as Python is reported to
be, it is difficult to write and distribute applications with a user interface.  For
example, you cannot write iOS apps with Python.  You cannot create an
application for Windows—the most popular corporate desktop—with a user
interface; even if you use a web front-end, you have to write JavaScript,
CSS, and HTML, he said.
It&#39;s &#34;kind of weird&#34; that you cannot easily do all of that, but at the same time, it&#39;s &#34;kind of
interesting&#34;.
</p>

<p>
Meanwhile, though, the consequences of those two points,
difficulties in packaging and building user interfaces, make it hard
to share our work with others, he said.  To those who would point to Docker as a
solution for that, he said that when you package an application with
Docker, you are &#34;zipping up a
hard drive and shipping it to someone&#34;.  That &#34;cannot be our way of getting
millions of people to use this stuff&#34;.
</p>

<p>
To a great extent, Python is a victim of its own success.  It is an
excellent glue language, but that means that it got stuck to all of those
things.  So much of what we do in computing is tied to ideas and
architectures from the 1970s and 1980s, he said, starting with the C
language and Unix process model; that also  includes things like the
toolchains and internetworking protocols like TCP/IP.
</p>

<p>
The basics of the Python language proper can be taught to anyone in a
weekend, he said, but it takes a whole lot more effort to get them to the point
where they can create an executable for Windows or an iOS app for an iPad.
&#34;Can we unshackle Python from all of this?&#34;
</p>

<h4>Enter WebAssembly</h4>

<p>
The web browser has clearly won the operating system wars, Wang said.  He
does not know if 2022 will be the year of the Linux desktop, [it won&#39;t
be -ed.] but he does know that  there will be a lot of browsers
on desktops.  JavaScript is the king of some language-popularity surveys
because it is the native language of the browser.  So, if we want to move
into that realm, he said,
<a href="https://webassembly.org/">WebAssembly</a> (or Wasm) is clearly the
right answer.
</p>

<p>
WebAssembly &#34;fundamentally changes the game&#34;.  It is a virtual CPU
instruction set that recently became a W3C standard; it has a 32-bit address
space and can do 64-bit arithmetic.  There is a compiler tool, <a href="https://emscripten.org/">Emscripten</a>, that can be used to compile
most C and C++ code to WebAssembly, which can then run in the browser.
WebAssembly is well-supported by browsers, including mobile browsers, Wang said.
</p>

<p>
CPython is, of course, a C program and much of the Python numerical stack
is written in C or C++.  Over the past few years, projects like <a href="https://pyodide.org/en/stable/">Pyodide</a> (which we <a href="https://lwn.net/Articles/855875/">looked at</a> a little over a year ago) and <a href="https://jupyterlite.readthedocs.io/en/latest/">JupyterLite</a> have
been compiling large parts of the Python scientific and numerical stack to
target WebAssembly.
</p>

<p>
If you go to the Pyodide site, you can get a <a href="https://pyodide.org/en/stable/console.html">Python read-eval-print
loop (REPL) in your browser</a>.  From those &#34;three little friendly angle
brackets&#34;, you can <tt>import</tt> NumPy and <a href="https://pandas.pydata.org/">pandas</a>.   From the JupyterLite site,
you can get a <a href="https://jupyterlite.readthedocs.io/en/latest/_static/lab/index.html">notebook
in the browser</a> running <a href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a> all on your
local system.
</p>

<p>
Python core developer Christian Heimes has been giving talks and doing a
lot of work on getting CPython working with WebAssembly.  It will <a href="https://discuss.python.org/t/status-of-wasm-in-cpythons-main-branch/15542">soon
be</a> a <a href="https://peps.python.org/pep-0011/">tier-2 supported
platform for CPython</a>, Wang said.  WebAssembly simply provides a
another computer architecture, beyond x86, Arm, and others, that the
CPython project can target 
</p>

<h4>PyScript</h4>

<p>
So he and others at Anaconda have been looking at the work that is being
done and have been thinking about ways to make it all more accessible to
&#34;many many more people&#34;.  To that end, he announced PyScript, but he did so
by live-coding a &#34;hello world&#34; demo from the keynote stage. It was his
first PyCon keynote, &#34;maybe my last&#34;, he said with a chuckle as he typed in
a short HTML file that loaded a <tt>pyscript.js</tt> file from
pyscript.net in a <tt>&lt;script&gt;</tt> tag; the body simply contained:
</p><pre>    &lt;py-script&gt;
        print(&#34;Hello PyCon 2022!&#34;)
    &lt;/py-script&gt;
</pre>

<p>
He proceeded to double-click the file and the greeting appeared in a
browser tab; that was met with a round of applause.  But this is all just
HTML, he said, so he surrounded the code 
above with a <tt>&lt;blink&gt;</tt> tag and reloaded.  These days, of course, the
<tt>&lt;blink&gt;</tt> tag has been removed from HTML, perhaps sadly; &#34;now I have
to explain to kids that there is no <tt>&lt;blink&gt;</tt> tag&#34;.
</p>

<p>
So he proceeded to add blinking functionality to the PyScript code, and
demonstrated a few other things along the way.  He created a <tt>&lt;div&gt;</tt>
with a name, that he then targeted for writing the string by accessing the
DOM to retrieve the object for the <tt>&lt;div&gt;</tt>; he also used the <a href="https://docs.python.org/3/library/asyncio.html"><tt>asyncio</tt>
module</a> to sleep for a second, then cleared the <tt>&lt;div&gt;</tt>, and put
that all in a &#34;forever&#34; loop.  That
worked like a charm, of course.  With a laugh, he said:
&#34;What the W3C takes away, PyScript gives you back.&#34;
</p>

<p>
So PyScript is a &#34;framework for creating rich Python apps in the browser&#34;.
It allows interleaving Python and HTML, provides full access to the DOM,
and gives the code access to JavaScript libraries—in both directions.  The
Python code can call JavaScript or be called from JavaScript.  So all of
the application logic and code can be in one language, in the browser—no
web server is needed.  You can put the HTML file on a USB stick and give it
to your friend.  There is the need to download PyScript itself, but that is
done from the HTML file using the <tt>&lt;script&gt;</tt> tag.
</p>

<p>
PyScript is not some kind of fork of CPython, it is the same code as
attendees were running on their laptops and servers, Wang said, just
compiled for Wasm.  It includes all of the work that Pyodide has done to
get the core numerical, scientific, and big data packages working for Wasm
as well.  PyScript is an &#34;opinionated framework&#34; that provides a foreign
function interface (FFI) to talk to JavaScript and the DOM;  Python has
already wrapped C, C++, and Fortran, so JavaScript can also be added to the
list. &#34;This is truly serverless computing.&#34;
</p>

<h4>More demos</h4>

<p>
He gave some other small demonstrations, many of which come from the <a href="https://pyscript.net/examples/">PyScript examples page</a>.  He
started with a <a href="https://pyscript.net/examples/repl.html">REPL</a>,
typing a few simple Python statements before typing in a <tt>print()</tt>
call to display
an <tt>&lt;iframe&gt;</tt> HTML tag, which proceeded to play a video in the
browser window. &#34;This is the most number of people that I&#39;ve simultaneously
<a href="https://en.wikipedia.org/wiki/Rickrolling">Rickrolled</a>&#34;, he
said to laughter and applause.
</p>


<p>
He also showed a simple <a href="https://pyscript.net/examples/todo.html">To-Do application</a> and
poked around in the code a bit.  The <a href="https://github.com/pyscript/pyscript/blob/main/examples/todo.html">HTML
file</a> has some boilerplate, then sets up the text field input and &#34;add
task&#34; button.  The button has a PyScript-specific <tt>pys-onClick</tt>
attribute that has the name of a Python function to call when the button is
clicked.  For convenience,
the Python code lives in a separate <a href="https://github.com/pyscript/pyscript/blob/main/examples/todo.py"><tt>todo.py</tt>
file</a> that contains the function.
</p>

<p>
The application itself allows adding things to the list, which also puts a
checkbox next to them.  When the box is clicked, the list entry also gets a
strike-through line added to it.  All of which can be handled
fairly easily in Python by manipulating the DOM, as can be seen in the
code.
</p>

<p>
The PyScript JavaScript and CSS files can be loaded from a local source or
from pyscript.net.  The output from Python can be routed to different
places, which means that <tt>stdout</tt> and <tt>stderr</tt> can go to
different locations on the page, as is done in the <a href="https://pyscript.net/examples/repl2.html">REPL2 example</a> (note
that shift-enter is used to execute like in <a href="https://jupyter.org/">Jupyter</a> and elsewhere).  Since 
all of Python is being loaded, much more sophisticated applications can be
run directly in the browser, with no installation required.
</p>

<p>
He also showed <a href="https://pyscript.net/examples/panel_kmeans.html">this interactive
demo</a>; note that it takes a rather longer time to load and run than the
earlier ones.  The <a href="https://github.com/pyscript/pyscript/blob/main/examples/panel_kmeans.html">code
for it</a> shows a bunch of stuff in the HTML <tt>&lt;head&gt;</tt>
section, which will be cleaned up eventually, he said, but the core is just standard
Python data-handling code using pandas, <a href="https://scikit-learn.org/stable/">scikit-learn</a> for performing <a href="https://en.wikipedia.org/wiki/K-means_clustering">k-means clustering</a>, <a href="https://panel.holoviz.org/">Panel</a> for creating a dashboard, and so on.
He reiterated that the file could just be handed off to a colleague to run
on their own system—albeit after a moderately lengthy delay to gather and initialize
all of the pieces.
</p>

<p>
Beyond that, there are lots of useful JavaScript libraries available, such
as the &#34;powerful visualization system&#34;, <a href="https://deck.gl/">deck.gl</a>. He showed a <a href="https://pyscript.net/examples/panel_deckgl.html">PyScript example</a>
that displayed data from the New York City taxicab data set using deck.gl
and dashboard created with Panel (seen below).  It showed a
3D histogram of the island of Manhattan, with the height of the hexagonal
bins representing the number of pickups and dropoffs in that part of the
city.  The visualization can be rotated, zoomed, and animated over time; in
addition, the bin size can be
changed to increase or decrease the geographic granularity and clicking on
a point shows the actual trip details.  All of this is
done locally in the browser using Python and JavaScript.
</p>

<blockquote>
<a href="https://lwn.net/Articles/898647/">
<img src="https://static.lwn.net/images/2022/pycon-taxidemo-sm.png" alt="[Taxi data demo]" title="Taxi data demo"/>
</a>
</blockquote>

<p>
But the demo also has Python REPL in its interface, which gives access
to the data more directly.  The pandas dataframe can be accessed as
<tt>df</tt> and the data can be filtered based on various criteria, such as &#34;trips less
than five miles&#34; (in Python), which is then
reflected in the display that can be interacted with as usual.  Once again,
the HTML file is all that is needed to run it.
PyScript provides a &#34;dramatic simplification&#34; of what has been a difficult
problem for Python: bundling up and distributing applications to users.
</p>

<p>
Python has never been about reimplementing the world, he said; instead,
Python binds together existing tools and libraries.  So one of PyScript
developers built a wrapper around the <a href="https://d3js.org/">D3.js</a>
library for &#34;data-driven documents&#34; in two days.  &#34;A lot of Python data
scientists have been lusting for D3 for a very long time.&#34; 
</p>

<p>
Python can also act as the glue between JavaScript libraries using
PyScript.  He mashed up a JavaScript Mario game with a JavaScript
gesture-recognition library, so he had the game running in the browser
along with a feed from his laptop camera that was being analyzed for hand
gestures.  By opening his hand, he could make Mario jump, for example.
</p>

<p>
He showed the <a href="https://github.com/pyscript/pyscript/tree/main/examples/mario">code</a>,
which had a lot of JavaScript that needed to be loaded for the game and
gesture-recognition library.  But the core of the application was in Python
in the HTML file.  It took the return from the gesture library and
determined what that meant in terms of Mario&#39;s movement, which it passed
down to the game. So the Python was used to bind the two
JavaScript libraries together to do &#34;real-time camera video recognition to
play a game&#34;.  All of that is &#34;very cool&#34;.
</p>

<h4>The future</h4>

<p>
&#34;The most accessible language for the web should be the language we already
love and know; let&#39;s make that happen.&#34;  Beyond that, though, traditional
web applications are complex, not just because JavaScript is &#34;kind of a
terrible language&#34; (though he is willing to discuss that assertion over
beer), but because the existing architecture splits the application state
between the client and the server. The current web-development landscape is
a hodgepodge of tools, languages, frameworks, 
and so on that is &#34;much more complex than I think it needs to be&#34;. 
</p>

<p>
That complexity also
means that clients send lots of information back to the server; in the
1980s or 1990s, that state would stay on the client side in the application
itself.  Sending all of that information to the server is &#34;the root of a
lot of the modern evils in tech&#34;.  He wondered if using PyScript in the
browser could eliminate the need for talking to servers in that way, though
there would still be a need to access databases and such; that stuff all needs
to be figured out, he said.  But doing so could perhaps &#34;bring about a version of
web 3—without the NFTs&#34;.  It would allow building applications that are
&#34;properly client-server&#34;, he said to applause.
</p>

<p>
There is still an enormous amount of work to be done, Wang said.  That
includes things like wrapping all of the JavaScript libraries and making
them &#34;even cooler&#34;, possibly adding support for other languages like Julia
or R, and more.  There are also lots of interesting problems to solve, like
what is the nicest native binding for <a href="https://reactjs.org/">React</a> or how memory transfers back and forth between
JavaScript and Python can be more efficient.  The PyScript project is
looking for more developers to collaborate on solving these and other
problems in the future.
</p>

<p>
There are also other Python implementations written in C and C++ that could 
be compiled for Wasm.  Since many of the CPython extensions have been built
for Wasm, that has the potential to level the playing field for the other
Python implementations, most of which are not able to use the C-based
extensions.  That giant ecosystem of extensions is part of what
has kept adoption low for the alternatives, but that could perhaps change. 
</p>

<p>
There are a ton of projects, but the community needs to be thoughtful about
how it approaches developing them.  There is a risk of burning out
developers that needs to be considered.  But Wang thinks that most everyone
agrees there is an &#34;absolutely massive prize&#34; to be won.  It would be a way
to solve the most important problem: programming for the 99%.
</p>

<p>
Because Python has long focused on being easy to learn, and thus is
approachable as a teaching language, it can be—is—learned by lots of
non-programmers.  Python can be used by people who do not consider
themselves programmers but who can do a bit with their computers.  It is this
dynamic that has helped drive Python to a dominant position among computer
languages over the last ten or 15 years, he said.
</p>

<p>
He noted that the number of programmers in the world is around 25
million, which is 0.3% of the population.  So the rest of humanity has
to rely on this tiny sliver for all of the code that is increasingly
pervading everything. &#34;This is not a good state of affairs.&#34;  It will
continue to be that way unless we do something about it.
</p>

<p>
When he lived in Boston, he was inspired by the huge engraving on the
Boston Public Library that says: &#34;The commonwealth requires the education
of the people as the safeguard of order and liberty.&#34;  In his view, the
democratization and literacy, including computational and data literacy,
are &#34;foundational to assure an open and free future for humankind&#34;.  He
would like to see PyScript play a role in that: &#34;computing for the people
and for their communities&#34;.
</p>

<p>
He hopes that kids get their first introduction to programming using
PyScript.  They do not need to install anything on their tablet or
laptop—or they can use the computer at the library.  The existing
educational materials on HTML, CSS, and Python can be used, mostly as they
are today.  The idea would be to focus on productivity and quality of life
for casual programmers rather than experienced software developers.
</p>

<p>
His vision is of a web that is &#34;a friendly, hackable place where anyone can
make interesting things&#34;. They can then share those interesting things with
others easily.  The remix aspect of our community has gotten lost over the
last 20 years, he said, as the stacks have gotten more and more
complicated. 
</p>

<p>
He wants to see a return to the quirky, creative aspects of the web, and to
&#34;put the joy back into it&#34;.   His final &#34;demo&#34; was a PyScript REPL, where
he typed &#34;<tt>import antigravity</tt>&#34;, which led to the <a href="https://xkcd.com/353/">classic xkcd</a> about Python (note that the
import is something of an Easter egg in CPython as well).  But when he typed
&#34;<tt>antigravity.fly()</tt>&#34;, the flying figure rose higher in the sky in a
little mini-animation. &#34;Let&#39;s do more of that&#34;, he said to thunderous applause.
</p>

<p>
It was an interesting and fairly inspiring keynote that I was sadly unable
to write up until now—almost two months after it happened.  Interested
readers will find it worth viewing the <a href="https://www.youtube.com/watch?v=qKfkCY7cmBQ">YouTube video</a> of the
talk to get a look at some of the demos.  Playing with the examples
will be enlightening as well.  It will be interesting to see where PyScript
goes from here.
</p>

<p>
[I would like to thank LWN subscribers for supporting my trip to Salt Lake
City for PyCon.]
</p></div></div>
  </body>
</html>
