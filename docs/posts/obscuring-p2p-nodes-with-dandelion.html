<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2025/12/08/dandelion/">Original</a>
    <h1>Obscuring P2P Nodes with Dandelion</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p>The weakest link in the privacy of cryptocurrency transactions is often outside the blockchain. There are technologies such as <a href="https://www.johndcook.com/blog/2025/11/24/monero-stealth-addresses/">stealth addresses</a> and <a href="https://www.johndcook.com/blog/2025/11/28/monero-subaddresses/">subaddresses</a> to try to thwart attempts to link transactions to individuals. They do a good job of anonymizing transaction data, but the weak link may be metadata, as is often the case.</p>
<p>Cryptocurrency nodes circulate transaction data using a peer-to-peer network. An entity running multiple nodes can compare when data arrived at each of its nodes and triangulate to infer which node first sent a set of transactions. The Dandelion protocol, and its refinement Dandelion++, aims to mitigate this risk. Dandelion++ is currently used in Monero and a few other coins; other cryptocurrencies have considered or are considering using it.</p>
<p><img fetchpriority="high" decoding="async" src="https://www.johndcook.com/dandelion.jpg" alt="Dandelion plant" width="400" height="600"/></p>
<p>The idea behind the Dandelion protocol is to have a “stalk” period and a “diffusion” period. Imagine data working up the stalk of a dandelion plant before diffusing like seeds in the wind. The usual P2P process is analogous to simply blowing on the seed head [1].</p>
<p>During the stalk period, information travels from one node to one node. Then after some number of hops, the diffusion process begins; the final node in the stalk period diffuses the information to all its peers. An observer with substantial but not complete visibility of the network may be able to determine which node initiated the diffusion, but maybe not the node at the other end of the stem.</p>
<p>A natural question is how this differs from something like Tor. In a nutshell, Tor offers identity protection <em>before</em> you enter a P2P network, and Dandelion offers identity protection <em>inside</em> the P2P network.</p>
<p>For more details, see the original paper on Dandelion [2].</p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/statistical-osint/">Statistical OSINT</a></li>
<li><a href="https://www.johndcook.com/blog/2025/08/16/whats-in-your-wallet/">What’s in your wallet?</a></li>
<li><a href="https://www.johndcook.com/blog/2025/07/27/retrofitting-error-detection/">Ethereum address checksum</a></li>
</ul>
<p>[1] The original paper on Dandelion uses a dandelion <em>seed</em> as the metaphor for the protocol. “The name ‘dandelion spreading’ reflects the spreading pattern’s resemblance to a dandelion seed head and refers to the diagram below. However, other sources refer to the stalk and head of the dandelion plant, not just a single seed. Both mental images work since the plant has a slightly fractal structure with a single seed looking something like the plant.</p>
<p><img decoding="async" src="https://www.johndcook.com/dandelion_head.png" alt="Illustration from Dandelion protocol paper" width="300" height="175"/></p>
<p>[2] Shaileshh Bojja Venkatakrishnan, Giulia Fanti, Pramod Viswanath. Dandelion: Redesigning the Bitcoin Network for Anonymity. Proceedings of the ACM on Measurement and Analysis of Computing Systems, Volume 1, Issue 1 Article No.: 22, Pages 1–34. Available here: <a href="https://dl.acm.org/doi/10.1145/3084459">https://doi.org/10.1145/3084459</a>.</p>
			</div></div>
  </body>
</html>
