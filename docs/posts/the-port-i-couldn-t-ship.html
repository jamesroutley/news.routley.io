<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ammil.industries/the-port-i-couldnt-ship/">Original</a>
    <h1>The port I couldn&#39;t ship</h1>
    
    <div id="readability-page-1" class="page"><div data-astro-cid-gjtny2mx=""> <div data-astro-cid-gjtny2mx="">    <a href="https://ammil.industries/" data-astro-cid-cjjlykpo=""> <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-cjjlykpo=""> <path d="M2.5 6.5H9.5C11.1569 6.5 12.5 7.84315 12.5 9.5V9.5C12.5 11.1569 11.1569 12.5 9.5 12.5H7.5M2.5 6.5L5.5 9.5M2.5 6.5L5.5 3.5" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-cjjlykpo=""></path> </svg>
home
</a>        <p>In October I read Simon Willison’s account of bringing a 2001 Perl (and C) library to the web using Claude Code. <a href="https://sourcetarget.email/editions/17/">Back in 2022</a> I wrote about a fantastic little Perl library called <a href="https://metacpan.org/pod/Graph::Easy">Graph::Easy</a> that renders flowcharts as ASCII art.</p>
<p>Inspired by Willison, I set about bringing Graph::Easy to the web.<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup></p>
<h2 id="why-grapheasy">Why Graph::Easy?</h2>
<p>Here’s an example ASCII diagram generated with Graph::Easy.</p>
<div><pre tabindex="0" data-language="plaintext"><code><span><span></span></span>
<span><span>                                                             +----------------------------------------------------------------------------------------+</span></span>
<span><span>                                                             |                                                                                        |</span></span>
<span><span>                                                             |                                                                                        |</span></span>
<span><span>                                    +------------------------+-------------------------------+                                                        |</span></span>
<span><span>                                    |                        |                               v                                                        v</span></span>
<span><span>+ - - - - - - - - - - - - - - - - - - - - - - - - -+     +- - - - - - - - - - - - - - - - - - - - - - - - - +     + - - - - - - - - - - - - - - - - - - - - - - - - -+</span></span>
<span><span>&#39;                     Frontend                     &#39;     &#39;                     Backend                      &#39;     &#39;                     Storage                      &#39;</span></span>
<span><span>&#39;                  192.168.1.0/24                  &#39;     &#39;                  192.168.2.0/24                  &#39;     &#39;                  192.168.3.0/24                  &#39;</span></span>
<span><span>&#39;                                                  &#39;     &#39;                                                  &#39;     &#39;                                                  &#39;</span></span>
<span><span>&#39; +--------------+                +--------------+ &#39;     &#39; +--------------+                +--------------+ &#39;     &#39; +--------------+                +--------------+ &#39;</span></span>
<span><span>&#39; |    nginx     |                |     app      | &#39;     &#39; |     api      |                |    worker    | &#39;     &#39; |   postgres   |                |    redis     | &#39;</span></span>
<span><span>&#39; | 192.168.1.10 | -------------&gt; | 192.168.1.11 | &#39; --&gt; &#39; | 192.168.2.10 | &lt;------------&gt; | 192.168.2.11 | &#39; --&gt; &#39; | 192.168.3.10 | &lt;------------&gt; | 192.168.3.20 | &#39;</span></span>
<span><span>&#39; +--------------+                +--------------+ &#39;     &#39; +--------------+                +--------------+ &#39;     &#39; +--------------+                +--------------+ &#39;</span></span>
<span><span>&#39;                                                  &#39;     &#39;                                                  &#39;     &#39;                                                  &#39;</span></span>
<span><span>+ - - - - - - - - - - - - - - - - - - - - - - - - -+     +- - - - - - - - - - - - - - - - - - - - - - - - - +     + - - - - - - - - - - - - - - - - - - - - - - - - -+</span></span>
<span><span>                                                             |                               |                        ^                               ^</span></span>
<span><span>                                                             +-------------------------------+------------------------+                               |</span></span>
<span><span>                                                                                             |                                                        |</span></span>
<span><span>                                                                                             |                                                        |</span></span>
<span><span>                                                                                             +--------------------------------------------------------+</span></span>
<span><span></span></span></code></pre></div>
<p>These diagrams are inherently portable, timeless, and to my eye more charming than any modern visualisation alternatives. Thirty years on, Graph::Easy remains unmatched at this specific problem. <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="" aria-describedby="footnote-label">2</a></sup></p>
<h2 id="it-was-supposed-to-be-so-grapheasy">It was supposed to be so Graph::Easy</h2>
<p>Like Willison, I was unsurprised yet delighted to find that Claude had no issue using WebPerl to make Graph::Easy run locally in the browser. With a small amount of prodding and guidance I had a slick little webapp that showcased the library.</p>
<a href="https://graph-easy.online">
<figure><img alt="Screenshot of Graph::Easy web interface showing the Seven Bridges of Königsberg problem rendered as ASCII art. The left panel contains Graph::Easy syntax defining the bridges and connections, while the right panel displays the resulting ASCII diagram with bridges represented as dotted-line boxes connected in a network layout." data-preview="true" loading="lazy" decoding="async" fetchpriority="high" width="1920" height="1200" src="https://ammil.industries/_astro/graph-easy-online.coJ8Imzj_Z15OJTR.webp"/><figcaption>Is it a real side project if you don&#39;t buy a new domain name?</figcaption></figure>
</a>
<p>At this point I should have put final touches to the web app, shipped it and written this blog post.</p>
<p>But I didn’t. I got greedy.</p>
<h2 id="chasing-my-own-tail">Chasing my own tail</h2>
<p>One thing irked me. The WebPerl interpreter took a few seconds to initialise.</p>
<p>“You know what?” I thought. “I bet Claude could do a good job simply porting the library over to a different language.”</p>
<p>The early success of the WebPerl app convinced me the model could handle more than it could. I was lazy, curious, and assuming the <a href="https://www.oneusefulthing.org/p/centaurs-and-cyborgs-on-the-jagged">jagged frontier</a> would smooth out if I pushed hard enough.</p>
<p>And thus started a journey both fruitless and frustrating.</p>
<h3 id="attempt-1-one-shot-and-done">Attempt 1 - one-shot and done?</h3>
<p>I didn’t, at first, understand the enormity of the task I had set. I asked Claude to port the Perl library to TypeScript in a new branch and let it rip.</p>
<p>LLMs are notoriously untrustworthy. They require scrutiny, oversight and credulity to spot cases where they gloss over inconvenient implementation details.</p>
<p>I’m human though – it’s hard to calibrate my response to their enthusiasm. Claude seemed to have the implementation in hand, who was I to question it?</p>
<p>Questioning came naturally to me, however, when the generated ASCII graphs from my newly vibed, black box implementation completely failed to match the original Perl versions.</p>
<p><em>Expected:</em></p>
<div><pre tabindex="0" data-language="plaintext"><code><span><span>+---------+     +-----------+</span></span>
<span><span>|  Bonn   | --&gt; |  Berlin   |</span></span>
<span><span>+---------+     +-----------+</span></span>
<span><span>  |</span></span>
<span><span>  |</span></span>
<span><span>  v</span></span>
<span><span>+---------+     +-----------+     +-----+</span></span>
<span><span>| Cottbus | --&gt; | Moselkern | --&gt; | Ulm |</span></span>
<span><span>+---------+     +-----------+     +-----+</span></span></code></pre></div>
<p><em>Actual:</em></p>
<div><pre tabindex="0" data-language="plaintext"><code><span><span>+---+</span></span>
<span><span>+---------++----+-----------+-----+-----+</span></span>
<span><span>|         ||    |           | --&gt; |     |</span></span>
<span><span>| Cottbus || Bon| Moselkern |erlin| Ulm |</span></span>
<span><span>|         -----&gt;            |     |     |</span></span>
<span><span>|          --&gt;              |     +-----+</span></span>
<span><span>+---------++----+-----------+-------+</span></span></code></pre></div>
<h3 id="attempt-2-tdd">Attempt 2 - TDD</h3>
<p>After my initial punt I knew I had to be smarter. Graph::Easy has over 100 reference tests that I needed to wire up to take an approach approximating “Test Driven Development”. Graph description in, ASCII output out, compare it to the reference example. Easy.</p>
<p>At this point most of these tests were failing, but a few basic ones gave me misplaced confidence that I could crank the LLM machine and get a Green test bench within a few hours. In hindsight this was idealistic.</p>
<p>LLMs don’t see ASCII art the same way we do. They see strings made up of letters, punctuation and newlines. The spatial relationships that make Graph::Easy’s output dense and clarifying are invisible to them.</p>
<p>I dabbled with allowing Claude to generate screenshots of the reference inputs and test outputs to let the multimodal capability do their work but this felt slow and comparing pixels seemed counterproductive when considering characters in a rectangle.</p>
<h3 id="attempt-3-separation-of-concerns">Attempt 3 - Separation of Concerns</h3>
<p>I tried again from scratch, attempting the current approximation of prompt engineering best practices and actually using my brain to reduce the complexity:</p>
<ul>
<li>I reduced the scope and made sure we weren’t trying to replicate features we didn’t need (for example, SVG rendering and colour string parsing)</li>
<li>I split the work into parsing, layout, and rendering streams and was assured by Claude that these were independent (when will I learn not to trust the models?). I figured that the context of each agent would do a better job isolated from the concerns of others.</li>
<li>I interrogated each agent about pitfalls and refined the approach until I couldn’t spot holes</li>
</ul>
<p>Running multiple agents at once gave a fresh contact-high of apparent productivity. But asking a final agent to merge the work and test the output I was dismayed (but low-key unsurprised) to find the new run still failed on even the most basic of tests.</p>
<p>I took a long-overdue peek at the source codebase. Over 30,000 lines of battle-tested Perl across 28 modules. A* pathfinding for edge routing, hierarchical group rendering, port configurations for node connections, bidirectional edges, collapsing multi-edges. I hadn’t expected the sheer interwoven complexity.</p>
<h3 id="attempt-4-shopping-around">Attempt 4 - Shopping around</h3>
<p>At this point I was desperate and resented my teammate. Claude’s peppy enthusiasm was grating and the whole project was wearing me down. Over the course of the project it appeared to gain a new skill of being self-aware about its own token use. Recognising the enormity of the task ahead of it, it would seek reassurance after every loop of work.</p>
<div><pre tabindex="0" data-language="plaintext"><code><span><span>(╯°□°）╯︵ ǝpoɔ ǝpnɐlɔ</span></span></code></pre></div>
<p>My guess is that this is an attempt to combat user frustration and perceived degraded capabilities of the models once the context window is saturated. It’s not unique to Claude.</p>
<p>The reward hacking was another problem. If I didn’t pay attention Claude did everything possible to avoid doing the work. I was fatigued from making demands in the CLAUDE.md that it appeared to be ignoring anyway.</p>
<p>Cursor 2.0 was released mid-spiral and gave me an easy way to simultaneously apply multiple models to the problem. I was drawn to the recently <a href="https://jmduke.com/posts/post/cheetah-ii/">unmasked</a>, zippy, Composer model – as if speed was the biggest blocker here.</p>
<p>I found that <code>GPT-Codex-High</code> appeared to read the Perl source more consistently and could explain why certain Perl idioms wouldn’t translate. This bought me another few days of false hope.</p>
<h3 id="attempts-5-6">Attempts 5, 6, ∞</h3>
<p>I don’t recall what happened next. I think I slipped into a malaise of models. 4-way split-paned worktrees, experiments with cloud agents, competing model runs and combative prompting. Drowning in stale markdown plans with no idea who or what had written them, documentation that was supposedly self-updating but never was.</p>
<p>Rituals of asking the models to ensure the documentation was up to date (despite the hooks that were supposed to do that for me) grew tiring and felt futile.</p>
<p>I surfaced for air and gazed back at the mess of incomplete ports.</p>
<h2 id="grapheasy-hardwon">Graph::Easy, Hard::won</h2>
<p>I finally understood: Graph::Easy earned its complexity through decades of tweaking and development. Chewing up decades of careful work and spitting it out with a gaggle of coding agents is disrespectful to the craft.</p>
<p>I spent weeks casually trying to replicate what took years to build. My inability to assess the complexity of the source material was matched by the inability of the models to understand what it was generating.</p>
<p>A reader (or dare I say a wiser version of me), armed with a future model and dedicated to the task, will succeed with this port where I failed and that makes me uneasy.</p>
<hr/>
  </div> </div></div>
  </body>
</html>
