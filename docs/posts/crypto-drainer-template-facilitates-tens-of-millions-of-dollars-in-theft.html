<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.confiant.com/how-one-crypto-drainer-template-facilitates-tens-of-millions-of-dollars-in-theft-66f3794aea4b?gi=b10068d5caa8">Original</a>
    <h1>“Crypto Drainer” Template Facilitates Tens of Millions of Dollars in Theft</h1>
    
    <div id="readability-page-1" class="page"><div><p id="0b3a">Our <a rel="noopener ugc nofollow" target="_blank" href="https://blog.confiant.com/a-whirlwind-tour-of-crypto-phishing-8628da0a9e38">previous blog</a> provided an overview of Web3 phishing techniques and tactics, all of which continue to be relevant despite a recent economic downturn in the crypto markets. Today, we offer a deeper dive into a specific category of Web3 phishing pages called “Crypto Drainers” and one of the more prolific actors behind them. We will see how one Crypto Drainer template was responsible for over 2,000 ETH in losses in a short period of time.</p><p id="b4ee">Crypto Drainers are phishing pages that lure victims into signing malicious transactions that allow the attacker to siphon their crypto and NFTs. Typically these websites piggyback off of well known or emerging NFT projects. The websites themselves are primarily promoted via spam campaigns on social networks and Discord.</p><p id="9782">The way most crypto drainers work is relatively straight forward:</p><ul><li id="4447">Fake NFT minting pages with an artificial countdown to create urgency.</li><li id="3ab6">Victim connects their wallet to “mint”.</li><li id="d6a2">Check if the victim address owns any valuable NFTs.</li><li id="a617">Victim signs transaction(s) to transfer ownership of NFTs.</li><li id="288c">Victim sends a transaction to the attacker for the cost of the fake “mint”, but this transaction is not a contract interaction.</li><li id="2c03">Rinse &amp; repeat.</li></ul><p id="7350">Let’s dig into a real example:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*emPPp1m_nP3uewvyjlp6mw.png" width="700" height="629" loading="lazy" role="presentation"/></p></div><figcaption>hxxps://pandaverse-mint.ml/</figcaption></figure><p id="0597">Here’s the real website for comparison:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*IFIE9pcg2hZk1-c8gtGB5w.png" width="700" height="637" loading="lazy" role="presentation"/></p></div></figure><p id="bda1">When we look at the code under the hood of the malicious site, we find that the whole thing is templated and includes deployment instructions, but more on that later. For now, let’s take a peak at how this thing works.</p><p id="825c">First we have <code>settings.js</code> which acts as a config file. The comments are not ours, but part of the Crypto Drainer template.</p><figure><div></div></figure><p id="28e2">And then we have <code>index.js</code> which includes the code responsible for the actual draining:</p><figure><div></div></figure><p id="b3db">We won’t go over the code line by line, but it’s worth highlighting two sections in particular. First, there is this snippet from the spurious mint function, which just sends ETH from the victim to the attacker:</p><pre><span id="1442">web3.eth.sendTransaction({</span></pre><p id="d1fb">Remember, minting an NFT is almost always a smart contract interaction, and requires invoking at least one function call. It typically requires additional orchestration beyond transfer of value to invoke a smart contract method, which is completely absent from the code above.</p><p id="5009">The second snippet we want to highlight is the <code>askNfts()</code> function in the code above:</p><figure><div></div></figure><p id="e789">Looks fishy doesn’t it? We can see how the attackers leverage the Moralis API in order to pull a record of the victim’s NFT ownership and cycle through them one at a time to siphon them off to a smart contract. Not to mention that pretty damning comment:</p><blockquote><p id="3018">//this is a SMART CONTRACT address, don&#39;t replace or NFTs won&#39;t come :)</p></blockquote><p id="ba0f">The role of the smart contract address here is not entirely clear as the source code is not verified and the bytecode analysis is outside of the scope of this post, furthermore this particular page hasn’t claimed any victims so there are no transactions to trace, but it’s noteworthy nonetheless seeing as we have examples of the same exact template moving NFTs to the attacker’s address directly and not an intermediate proxy contract.</p><p id="e5fb">In a few moments, we’ll see that we can’t take everything at face value in the world of Crypto Drainers, but for now we continue our investigation by trying out some OSINT searches to see what comes up. It’s clear as day that this is a recycled template that is likely being circulated around, so maybe we can find additional instances of it with a search on GitHub.</p><p id="6909">We do a search for <code>askMint</code> and come up with a treasure trove of hits:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*M_N8a-SNRgNsepO7-59G2Q.png" width="700" height="598" loading="lazy" role="presentation"/></p></div></figure><p id="fe34">We see that the same codebase has been employed by several dozen GitHub users and hosted on GitHub Pages:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*FgmGhIRWnH6uIdhI8t9t1Q.png" width="700" height="221" loading="lazy" role="presentation"/></p></div></figure><p id="61ad">Each instance targets a different NFT project as well. For example, the GitHub Page above is a fake METAKAMI mint:</p><figure><p><img alt="" src="https://miro.medium.com/max/772/1*XSa88pQjDTsvrB6w1weEnw.png" width="386" height="346" loading="lazy" role="presentation"/></p></figure><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*l2dXBFRw1xcig1OG4qYaRA.png" width="700" height="577" loading="lazy" role="presentation"/></p></div></figure><p id="418a">Things start heating up as we continue digging through the search results and land on what looks to be the original repo:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*PyrzeW2Nanttid1ZYdKKzQ.png" width="700" height="451" loading="lazy" role="presentation"/></p></div></figure><p id="ece6">Eureka!</p><p id="df65">But remember when we said that everything is not as it seems in the world of Crypto Drainers? Here’s where things get interesting:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*hyH5gUSIefu2yajYX1O_qw.png" width="700" height="459" loading="lazy" role="presentation"/></p></div></figure><p id="2af8">Looks like the old adage “There’s no honor among thieves” holds true especially for cybercrime as we find a GitHub user calling out the first author we found above as a thief that sells backdoored Crypto Drainers!</p><p id="9459">We follow the link to a Crypto Drainers group on Telegram:</p><figure><p><img alt="" src="https://miro.medium.com/max/906/1*S4grT_O3bnYlhLZ4F0Doaw.png" width="453" height="592" loading="lazy" role="presentation"/></p></figure><p id="da0f">Here we find vendors selling these Crypto Drainer templates as a full service, with full support in English and French:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*pdfzkklPOx6EalI7WsqXow.png" width="700" height="703" loading="lazy" role="presentation"/></p></div></figure><p id="b6ef">There’s a demo on YouTube by the way:</p><figure><div></div></figure><p id="0a55">And an e-commerce link where you can buy these hosted templates with white-glove service:</p><figure><div role="button" tabindex="0"><p><img alt="" src="https://miro.medium.com/max/1400/1*o58lADh5jxI5nGQ2sqUaew.png" width="700" height="424" loading="lazy" role="presentation"/></p></div></figure><p id="b412">Now anyone can be an NFT &amp; crypto thief for the low cost of €1499.99!</p></div><div><h2 id="026f">Impact &amp; Scope</h2><p id="dbcc">So how prevalent and how effective are these Crypto Drainers really? Well it depends, as it’s up to the attackers to promote these malicious websites effectively, but considering that this is the template we see used the most in these phishing attacks, it’s safe to say these folks generally do quite well.</p><p id="a360">While we have many examples of Crypto Drainer websites that appear to have never robbed a single victim, we also have plenty that have resulted in very lucrative hauls for the perpetrators.</p><p id="0ab2">For example, we can look at the ETH address associated with <code>mint-moonlanders[.]com</code> which as of this writing has produced over $85k in revenue for the attacker in a 10 day span:</p><figure><p><img alt="" src="https://miro.medium.com/max/1330/1*b8j0g_tuy-th7WsXmfQFNw.png" width="665" height="318" loading="lazy" role="presentation"/></p></figure><p id="e961">While it’s quite difficult to grasp the full impact of these attacks due to the way stolen ETH and NFT tokens are passed around, we can begin to formulate an educated guess by adding up all the inbound transactions coming into the attackers’ addresses.</p><p id="f282">For our analysis, we looked at 227 addresses that we collected over the course of the last few weeks.</p><p id="d016">Here’s what we found:</p><ul><li id="fa64">The average Crypto Drainer sees 33 inbound transactions between ETH &amp; NFTs.</li><li id="abca">Total observable inbound ETH value transferred to these attacker addresses is 695 ETH or approximately $12.5MM at the time of this writing.</li><li id="be40">29.5% of all Crypto Drainers have not claimed a single victim.</li></ul><p id="634a">And with regards to drained NFTs:</p><ul><li id="c30c">The average Crypto Drainer has stolen 9 NFTs, but the top 10 most prolific drainers are responsible for 69% of all NFT thefts.</li><li id="2fe1">61% of Crypto Drainer wallets have not had a single inbound NFT transfer.</li><li id="934b">Based on current floor prices, we estimate the value of the stolen NFTs to be 1517 ETH or approximately $27.5MM at the time of this writing.</li><li id="e692">The most commonly stolen NFTs are ENS names, which makes sense given that most folks in the NFT space use ENS.</li><li id="dde4">Among the stolen NFTs we have tracked, 8 are Bored Ape Yacht Club NFTs.</li></ul><h2 id="34c5">Caveats &amp; Considerations</h2><p id="1542">We want to be explicitly clear that due to the large number of IOCs to sort through for this research, our findings in the section above should be treated as estimates.</p><p id="525c">Our methodology begins with the detection of this specific template and we parse out the ETH address specified as the payment address by the attacker only at the time of discovery. Because of this, there are a few thoughts worthy of careful consideration:</p><ul><li id="efb8">It’s possible that the ETH address is a place holder if observed when the template is first deployed.</li><li id="23dd">Some attackers rotate the ETH address frequently during the course of their spam campaigns to promote these websites, so our view into any particular drainer’s success <em>might </em>be partial.</li></ul><p id="9738">Furthermore, the addresses we have observed have participated in thousands of blockchain transactions, which required us to develop automation to parse out the data to calculate our estimates. Due to the broad scope, it’s impossible to reconcile all of these transactions manually and in some cases transactions that are unrelated to theft might have been a part of the mix. While it’s unlikely that most seasoned criminals will use the same address for personal transactions and for collecting the proceeds of a Crypto Drainer, we have observed that some of the perpetrators do exactly that. However, we are not able to explicitly exclude this type of activity.</p><p id="5735">Finally, seeing as this template is largely open source, we can’t in good faith suggest that all of these instances were deployed by the actor behind the Crypto Drainer marketplace that we mentioned above.</p><h2 id="cba8">Appendix A — Malicious Domains</h2><figure><div></div></figure><h2 id="4fbe">Appendix B — Ethereum Addresses</h2><figure><div></div></figure></div></div>
  </body>
</html>
