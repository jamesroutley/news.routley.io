<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.koi.ai/blog/maliciouscorgi-the-cute-looking-ai-extensions-leaking-code-from-1-5-million-developers">Original</a>
    <h1>MaliciousCorgi: AI Extensions send your code to China</h1>
    
    <div id="readability-page-1" class="page"><div><div><div id="blog-rich-text"><p>AI coding assistants are everywhere. They suggest code, explain errors, write functions, review pull requests. Every developer marketplace is flooded with them - ChatGPT wrappers, Copilot alternatives, code completion tools promising to 10x your productivity.</p><p>We install them without a second thought. They&#39;re in the official marketplace. They have thousands of reviews. They work. So we grant them access to our workspaces, our files, our keystrokes - and assume they&#39;re only using that access to help us code.</p><p>Not all of them are.</p><p>Our risk engine has identified two VS Code extensions, a campaign we&#39;re calling MaliciousCorgi - 1.5 million combined installs, both live in the marketplace right now - that work exactly as promised. They answer your coding questions. They explain your errors. They also capture every file you open, every edit you make, and send it all to servers in China. No consent. No disclosure.</p><h2>The MaliciousCorgi Campaign</h2><p>Both are marketed as AI coding assistants. Both are functional. Both contain identical malicious code - the same spyware infrastructure running under different publisher names.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6971de8767cc5e28194700e6_image%20(7).png" loading="lazy" alt=""/></p><figcaption>Koidex <a href="https://dex.koi.security/reports/vsc/5641bf2c-894b-4e02-b31f-822b15fc43f7/8.0.0">report</a> for ChatGPT - ChatMoss</figcaption></figure><h2>The Perfect Cover</h2><p>These extensions actually work. That&#39;s what makes them dangerous.</p><p>Select code, ask a question, get a helpful AI-powered response. The extension also provides inline autocomplete - just like GitHub Copilot. As you type, it reads about 20 lines of context around your cursor and sends it to the AI server for suggestions:</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751aa1_767f7e8d.png" loading="lazy" alt=""/></p></figure><p>This is normal. This is expected. AI coding assistants need to read some of your code to help you write more code.</p><p>But these extensions go far beyond what&#39;s needed for autocomplete.</p><p>While the autocomplete sends ~20 lines around your cursor when you&#39;re actively typing, three hidden channels are running in parallel - collecting far more data, far more often, without any user interaction.</p><h2>Channel 1: Real-Time File Monitoring</h2><p>The moment you open any file - not interact with it, just open it - the extension reads its entire contents, encodes it as Base64, and sends it to a webview containing a hidden tracking iframe. Not 20 lines. The entire file.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751aa4_ea23a3ca.png" loading="lazy" alt=""/></p></figure><p>And the same mechanism triggers on onDidChangeTextDocument - every single edit:</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751aad_c7fd40ac.png" loading="lazy" alt=""/></p></figure><p>Not just what you&#39;re actively working on. Every file you glance at. Every character you type. Captured and transmitted.</p><h2>Channel 2: Mass File Harvesting (Server-Controlled)</h2><p>And it gets worse.</p><p>The server can remotely trigger mass file collection at any time - without any user interaction.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751aa7_6b6b40fc.png" loading="lazy" alt=""/></p></figure><p>When the server sends {&#34;type&#34;: &#34;getFilesList&#34;}, the extension triggers a full workspace harvest:</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751ab3_6f071600.png" loading="lazy" alt=""/></p></figure><p>The attack chain is simple:</p><ol role="list"><li>Server includes jumpUrl in any API response</li><li>Webview parses it as JSON and forwards to extension</li><li>Extension executes getFilesList command</li><li>Up to 50 files harvested and transmitted</li><li>User sees nothing</li></ol><p>Your codebase is one server command away from full exfiltration. No user interaction required.</p><h2>Channel 3: The Profiling Engine</h2><p>Channels 1 and 2 harvest your code. Channel 3 harvests <em>you</em>.</p><p>The extension&#39;s webview contains a hidden iframe - zero pixels, completely invisible - that loads four commercial analytics SDKs. This isn&#39;t website tracking. This is a profiling engine running inside your code editor.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6970fad3708129fb94751ab0_564fe9b0.png" loading="lazy" alt=""/></p></figure><p>We fetched the content served by this URL. The page title says it all: &#34;ChatMoss数据埋点&#34; - &#34;ChatMoss Data Tracking.&#34; It loads four separate analytics platforms - Zhuge.io, GrowingIO, TalkingData, and Baidu Analytics - each designed to track user behavior, build identity profiles, fingerprint devices, and monitor every interaction.</p><p>Combined, these SDKs build a detailed profile: who you are, where you are, what company you work for, what you&#39;re working on, what projects matter most to you.</p><p>Why collect all this metadata alongside your source code? One possibility: targeting. The server-controlled backdoor in Channel 2 can harvest 50 files on command. Analytics tells them <em>whose</em> files are worth taking - and when you&#39;re most active, profiling first, exfiltration second that&#39;s the MaliciousCorgi playbook.</p><h2>What&#39;s at Risk</h2><p>Think about what&#39;s in your workspace right now.</p><p>Your .env files with API keys and database passwords. Your config files with server endpoints and internal URLs. That credentials.json for your cloud service account. Maybe some SSH keys you added for convenience. The source code itself - your algorithms, your business logic, the features you haven&#39;t shipped yet.</p><p>The file harvesting function grabs everything except images. Up to 50 files at a time, on command. Your secrets, your credentials, your proprietary code - all of it accessible to a server in China whenever they decide to pull the trigger.</p><p>And because Channel 3 is profiling you in the background, they know exactly who has the most valuable code to steal.</p><h2>Final Thoughts</h2><p>We&#39;re in an AI tooling gold rush. Developers are installing extensions faster than ever - and that&#39;s the right call. These tools make you faster, smarter, more productive.</p><p>But there&#39;s a gap between how quickly we adopt and how thoroughly we verify. 1.5 million developers trusted these extensions because they worked. The marketplace approved them. The reviews were positive. The functionality is real. So is the spyware.</p><p>Moving fast with AI tools is good. Moving fast without visibility into what they&#39;re actually doing with your code is how 1.5 million developers ended up with their workspaces harvested.</p><p>Your team shouldn&#39;t have to choose between moving fast and staying safe. </p><p><a href="https://www.koi.ai/chat-with-us">Book a demo</a> to see how Koi protects your developers without slowing them down.</p><h2>IOCs</h2><p>Vscode extensions:</p><ul role="list"><li>whensunset.chatgpt-china</li><li>zhukunpeng.chat-moss</li></ul><p>Domain:</p><ul role="list"><li>aihao123.cn</li></ul></div></div></div></div>
  </body>
</html>
