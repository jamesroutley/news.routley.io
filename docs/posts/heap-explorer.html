<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/heap-exploitation/heap-explorer">Original</a>
    <h1>Show HN: Heap Explorer</h1>
    
    <div id="readability-page-1" class="page"><p dir="auto"><code>explore_heap</code> starts a REPL that allows the user to perform a few different actions, such as <code>free</code>ing chunks, <code>malloc</code>ing chunks, printing freelists, etc.</p><p dir="auto"><code>libheap_explorer.so</code> installs <code>explore_heap</code> as the <code>SIGINT</code> handler at load time, so you can do stuff like this:</p><div data-snippet-clipboard-copy-content="$ LD_PRELOAD=/the/path/to/libheap_explorer.so python3 -c &#39;while True: print(&#34;Dave and Dale are cool cats&#34;)&#39;
Dave and Dale are cool cats
Dave and Dale are cool cats
Dave and Dale are cool cats
...
^C
Welcome to Heap Explorer!
1. Allocate chunk(s).
2. Free a chunk.
3. Print all chunks.
4. Print a tcache list.
5. Print a fastbin list.
6. Print a bin list.
7. Exit Heap Explorer.
&gt; 3
[0]:	0x5fe4fb8ef008, data size: 0x288 (base chunk)
[1]:	0x5fe4fb8ef298, data size: 0x18 (tcache 0)
[2]:	0x5fe4fb8ef2b8, data size: 0x18
[3]:	0x5fe4fb8ef2d8, data size: 0x78
[4]:	0x5fe4fb8ef358, data size: 0x318
[5]:	0x5fe4fb8ef678, data size: 0x68
[6]:	0x5fe4fb8ef6e8, data size: 0x538
[7]:	0x5fe4fb8efc28, data size: 0xd8
[8]:	0x5fe4fb8efd08, data size: 0x1a8
[9]:	0x5fe4fb8efeb8, data size: 0x68
[10]:	0x5fe4fb8eff28, data size: 0x58
[11]:	0x5fe4fb8eff88, data size: 0x78
[12]:	0x5fe4fb8f0008, data size: 0xa8
[13]:	0x5fe4fb8f00b8, data size: 0x68
[14]:	0x5fe4fb8f0128, data size: 0x48
[15]:	0x5fe4fb8f0178, data size: 0xb8
[16]:	0x5fe4fb8f0238, data size: 0x18
[17]:	0x5fe4fb8f0258, data size: 0xb8
[18]:	0x5fe4fb8f0318, data size: 0x18
[19]:	0x5fe4fb8f0338, data size: 0x28
[20]:	0x5fe4fb8f0368, data size: 0xd8
[21]:	0x5fe4fb8f0448, data size: 0xd8
[22]:	0x5fe4fb8f0528, data size: 0x28 (free 2)
[23]:	0x5fe4fb8f0558, data size: 0x18
[24]:	0x5fe4fb8f0578, data size: 0x48 (tcache 3)
[25]:	0x5fe4fb8f05c8, data size: 0x28 (tcache 1)
...

1. Allocate chunk(s).
2. Free a chunk.
3. Print all chunks.
4. Print a tcache list.
5. Print a fastbin list.
6. Print a bin list.
7. Exit the heap explorer.
&gt; 7
Bye!
Dave and Dale are cool cats
Dave and Dale are cool cats
Dave and Dale are cool cats
..."><pre><code>$ LD_PRELOAD=/the/path/to/libheap_explorer.so python3 -c &#39;while True: print(&#34;Dave and Dale are cool cats&#34;)&#39;
Dave and Dale are cool cats
Dave and Dale are cool cats
Dave and Dale are cool cats
...
^C
Welcome to Heap Explorer!
1. Allocate chunk(s).
2. Free a chunk.
3. Print all chunks.
4. Print a tcache list.
5. Print a fastbin list.
6. Print a bin list.
7. Exit Heap Explorer.
&gt; 3
[0]:	0x5fe4fb8ef008, data size: 0x288 (base chunk)
[1]:	0x5fe4fb8ef298, data size: 0x18 (tcache 0)
[2]:	0x5fe4fb8ef2b8, data size: 0x18
[3]:	0x5fe4fb8ef2d8, data size: 0x78
[4]:	0x5fe4fb8ef358, data size: 0x318
[5]:	0x5fe4fb8ef678, data size: 0x68
[6]:	0x5fe4fb8ef6e8, data size: 0x538
[7]:	0x5fe4fb8efc28, data size: 0xd8
[8]:	0x5fe4fb8efd08, data size: 0x1a8
[9]:	0x5fe4fb8efeb8, data size: 0x68
[10]:	0x5fe4fb8eff28, data size: 0x58
[11]:	0x5fe4fb8eff88, data size: 0x78
[12]:	0x5fe4fb8f0008, data size: 0xa8
[13]:	0x5fe4fb8f00b8, data size: 0x68
[14]:	0x5fe4fb8f0128, data size: 0x48
[15]:	0x5fe4fb8f0178, data size: 0xb8
[16]:	0x5fe4fb8f0238, data size: 0x18
[17]:	0x5fe4fb8f0258, data size: 0xb8
[18]:	0x5fe4fb8f0318, data size: 0x18
[19]:	0x5fe4fb8f0338, data size: 0x28
[20]:	0x5fe4fb8f0368, data size: 0xd8
[21]:	0x5fe4fb8f0448, data size: 0xd8
[22]:	0x5fe4fb8f0528, data size: 0x28 (free 2)
[23]:	0x5fe4fb8f0558, data size: 0x18
[24]:	0x5fe4fb8f0578, data size: 0x48 (tcache 3)
[25]:	0x5fe4fb8f05c8, data size: 0x28 (tcache 1)
...

1. Allocate chunk(s).
2. Free a chunk.
3. Print all chunks.
4. Print a tcache list.
5. Print a fastbin list.
6. Print a bin list.
7. Exit the heap explorer.
&gt; 7
Bye!
Dave and Dale are cool cats
Dave and Dale are cool cats
Dave and Dale are cool cats
...
</code></pre></div><p dir="auto">This library has been tested only on programs using Arch&#39;s glibc package, version <code>2.41+r2+g0a7c7a3e283a-1</code>.
It&#39;s pretty easy to port to other modern versions of glibc; just change the <code>*_OFFSET</code> constants in <code>heap_explorer.c</code>.</p></div>
  </body>
</html>
