<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://x61.ar/log/2024/05/06052024135732-openbsd_desktop.html">Original</a>
    <h1>OpenBSD Desktop</h1>
    
    <div id="readability-page-1" class="page"><div id="wrapper">
		
		<p>[x61]</p>
		<hr/>
		<nav>
			
		</nav>
		<hr/>


<p>Yes, this is the year of the <a href="https://openbsd.org">OpenBSD</a> Desktop!</p>

<p>I am a minimalist, and I tend to always keep it as small as I can, so I try to use all
I have in base (if it fits), plus of course some other tools needed.</p>

<p>My general list is:
 </p><ul>
  <li>WM: <a href="https://man.openbsd.org/cwm.1">cwm(1)</a></li>
  <li>Statusbar: <a href="https://github.com/gonzalo-/termbarc">termbar</a></li>
  <li>Mail: <a href="https://openbsd.app/?search=aerc">aerc</a> (now) - <a href="https://openbsd.app/?search=neomutt">neomutt</a> (former)</li>
  <li>Browser: <a href="https://openbsd.app/?search=firefox">Firefox</a> - <a href="https://openbsd.app/?search=ungoogled-chromium">ungoogled-chromium</a></li>
  <li>FileManager: <a href="https://openbsd.app/?search=walk">walk</a> (former llama)</li>
  <li>Editor: <a href="https://openbsd.app/?search=emacs">emacs</a> - <a href="https://man.openbsd.org/mg.1">mg</a></li>
  <li>Photo Viewer: <a href="https://openbsd.app/?search=geeqie">geeqie</a></li>
  <li>PDFs: <a href="https://openbsd.app/?search=mupdf">mupdf</a> and <a href="https://openbsd.app/?search=foliate">foliate</a> (for ebooks or more complex stuff)</li>
  <li>Others: <a href="https://man.openbsd.org/tmux.1">tmux(1)</a>, <a href="https://openbsd.app/?search=got">got</a>, <a href="https://openbsd.app/?search=duf">duf</a>, <a href="https://openbsd.app/?search=sysclean">sysclean</a>, <a href="https://openbsd.app/?search=tor">tor</a>, <a href="https://openbsd.app/?search=remmina">remmina</a>, <a href="https://openbsd.app/?search=feh">feh</a>, <a href="https://openbsd.app/?search=sct">sct</a>, <a href="https://openbsd.app/?search=scrot">scrot</a> among others</li>
</ul>

<p>Finally I unslack myself and tried to write some C code to convert my <a href="https://github.com/gonzalo-/termbar">old termbar</a> into a <a href="https://github.com/gonzalo-/termbarc">new one</a> in C. There is still a lot to fix and adjust, but so far it works on my machines and
it shows all I need and want without any weird error.</p>

<p><a href="https://x61.ar/log/img/termbar.png" target="_blank">
	<img src="https://x61.ar/log/img/termbar.png" alt="termbar in C"/>
</a></p><p>Yes, I like anime and those colours are trying to emulate the <a href="https://x61.ar/log/img/eva01.png">eva 01</a>, my <b>.Xresources</b>
looks something like this:</p>

<pre><code>!!! Colours
*color0: rgb:2a/3b/4d
*color1: rgb:c4/67/6c
*color2: rgb:66/ff/66
*color3: rgb:ff/ff/66
*color4: rgb:15/f4/ee
*color5: rgb:9c/6c/d3
*color6: rgb:4b/8f/77
*color7: rgb:9f/a2/a6
*color8: rgb:55/79/9c
*color9: rgb:c4/67/6c
*color10: rgb:66/ff/66
*color11: rgb:ff/ff/66
*color12: rgb:15/f4/ee
*color13: rgb:9c/6c/d3
*color14: rgb:4b/8f/77
*color15: rgb:ff/ff/ff
*color16: rgb:ff/99/66 # Base 09
*color17: rgb:bb/64/a9 # Base 0F
*color18: rgb:3d/56/6f # Base 01
*color19: rgb:4b/69/88 # Base 02
*color20: rgb:7e/90/a3 # Base 04
*color21: rgb:d6/d7/d9 # Base 06</code></pre>

<p>My console is <a href="https://man.openbsd.org/xterm.1">xterm(1)</a> and I really don&#39;t need
much more than that, my bits for it in the <b>.Xresources</b> are:</p>

<pre><code>!!! Xterm
XTerm*background: black
XTerm*foreground: rgb:9f/a2/a6
XTerm*eightBitInput: false
XTerm*loginShell: true
XTerm*scrollBar: false
XTerm*saveLines: 2000
XTerm*faceName: dejavu sans mono:size=12
XTerm*internalBorder: 10
XTerm*locale: true
XTerm*pointerMode: 2
XTerm*allowTitleOps: true
XTerm*termName: xterm-256color</code></pre>

<p>I also have some love for <a href="https://github.com/gonzalo-/termbarc">termbar</a> in there, which
will show the right font, size, etc:</p>

<pre><code>!!! termbar
termbar*faceName: dejavu sans mono:size=12
termbar*geometry: 3840x1+0+0
termbar*internalBorder: 6
termbar*saveLines: 0
termbar*locale: true
termbar*scrollBar: false
termbar*title: termbar</code></pre>

<p>Those are colours, and I have my &#34;setup&#34; on my <b>.xsession</b>, I have it pretty much all
commented to here it is:</p>

<pre><code>#!/bin/sh -x

## Cleanup stuff on exit
cleanup() {
        pkill -9 sctd
        pkill -9 xidle
        pkill -9 lock
        rm -rf ~/TorBrowser-Data
        rm -f ~/.Xauthority
        rm -rf ~/.local/share/Trash
        chmod 700 ~
}

. $HOME/.profile

## Load colours
xrdb -merge $HOME/.Xresources

## DBus
if [ -x /usr/local/bin/dbus-launch -a -z &#34;${DBUS_SESSION_BUS_ADDRESS}&#34; ]; then
        eval `dbus-launch --sh-syntax --exit-with-x11`
fi

## fonts
xset -b &amp;
for font in /usr/local/share/fonts/*; do
        xset +fp &#34;${font}&#34;
        done
xset fp rehash

## Fix resolution
xrandr --dpi 96

## Turn off mic
sndioctl input.mute=1
sndioctl input.level=0.0

## Turn down sound
sndioctl output.level=0.0

## External Monitor
## this is the output
## of arandr to arrange
## my monitor
~/bin/monitores &amp;

## Select Keyboard layout
## depending on the host
if [ X`hostname` = X&#34;tomato&#34; ]; then
        setxkbmap jp
else
        setxkbmap de
fi

## LANG
export LANG=en_US.UTF-8
export LC_CTYPE=en_US.UTF-8

## Browser shitz
export MOZ_USE_XINPUT2=1
export MOZ_ACCELERATED=1
export MOZ_WEBRENDER=1
## WASM for Chromium
export ENABLE_WASM=1

## jp
## ctrl+space
## F6 &amp; F7 hiragana &lt;-&gt; katakana
export GTK_IM_MODULE=&#34;xim&#34;
export QT_IM_MODULE=&#34;xim&#34;
export XMODIFIERS=&#34;@im=SCIM&#34;
/usr/local/bin/scim -d &amp;

export BLOCKSIZE=1m

## no bell
xset b 0 0 0
xset -dpms
xset s off
xset s noblank

## ~/bin/lock does some protections and runs slock
xidle -timeout 9000 -ne -program ~/bin/lock &amp;

## screen control
~/bin/sctd &amp;

# Termbar
exec xterm -fs 12 -bg &#34;black&#34; -fg &#34;grey&#34; -name termbar -class termbar -T termbar -e ~/bin/termbar &amp;

# Wallpaper
feh --bg-center ~/themes/blade-runner--wallpaper.jpg &amp;

exec cwm

cleanup</code></pre>

<p>My WM is <a href="https://man.openbsd.org/cwm.1">cwm(1)</a> since a long time and combined with <a href="https://github.com/gonzalo-/termbarc">termbar</a>
it fits all my needs, my <a href="https://man.openbsd.org/cwmrc.5">cwmrc(5)</a> looks like:</p>

<pre><code># Autogroups for windows
autogroup       0                   &#34;termbar,termbar&#34;
autogroup       0                   &#34;xconsole,XConsole&#34;
autogroup       0                   &#34;termbar,termbar&#34;
autogroup       1                   &#34;firefox,firefox-bin&#34;
autogroup       9                   &#34;tor-browser,tor-browser&#34;

# Add missing keybindings.
bind-key        M-1                 group-only-1
bind-key        M-2                 group-only-2
bind-key        M-3                 group-only-3
bind-key        M-4                 group-only-4
bind-key        M-5                 group-only-5
bind-key        M-6                 group-only-6
bind-key        M-7                 group-only-7
bind-key        M-8                 group-only-8
bind-key        M-9                 group-only-9
bind-key        MS-1                window-movetogroup-1
bind-key        MS-2                window-movetogroup-2
bind-key        MS-3                window-movetogroup-3
bind-key        MS-4                window-movetogroup-4
bind-key        MS-5                window-movetogroup-5
bind-key        MS-6                window-movetogroup-6
bind-key        MS-7                window-movetogroup-7
bind-key        MS-8                window-movetogroup-8
bind-key        MS-9                window-movetogroup-9

bind-key        MS-space            window-htile
bind-key        M-space             window-vtile

bind-key        C-Up                pointer-move-up
bind-key        C-Down              pointer-move-down
bind-key        C-Right             pointer-move-right
bind-key        C-Left              pointer-move-left

bind-key        CS-Up               pointer-move-up-bigbind-key
bind-key        CS-Down             pointer-move-down-big
bind-key        CS-Right            pointer-move-right-big
bind-key        CS-Left             pointer-move-left-big

bind-key        4-l                 /home/gonzalo/bin/lock
bind-key        4-r                 restart
bind-key        4-q                 quit
bind-key        MS-Return           terminal
bind-key        MS-p                menu-exec
## Windows
borderwidth     4
color           activeborder        &#39;#202060&#39;
color           font                &#39;#000000&#39;
color           selfont             &#39;#e9ffe9&#39;
color           inactiveborder      &#39;rgb:31/31/31&#39;
color           menubg              &#39;#494949&#39;
color           menufg              &#39;#202060&#39;

fontname                            &#34;dejavu sans mono:size=12&#34;
gap                                 35 5 5 5

ignore                              &#34;termbar&#34;

command         firefox             firefox
command         xterm               xterm

moveamount                          4
snapdist                            25
sticky                              yes</code></pre> 

<p>And that is pretty much the &#34;core&#34; of my configs, the rest are probably default or some very basic
changes.</p>

<p>The clean desktop looks a bit like this:</p>

<p><a href="https://x61.ar/log/img/desktop.png" target="_blank">
	<img src="https://x61.ar/log/img/desktop.png" alt="desktop"/>
</a></p><p>And this is busy:</p>

<p><a href="https://x61.ar/log/img/busy.png" target="_blank">
	<img src="https://x61.ar/log/img/busy.png" alt="busy desktop"/>
</a></p><p>As a final note, I saw a lot of people following tutorials on <b>&#34;OpenBSD Desktops&#34;</b> that changed a lot
of flags totally blindly without any real test or comparison after/before. About this, I would say that my user
is part of the <b>staff</b> and I didn&#39;t change anything in the login class, and also my <a href="https://man.openbsd.org/sysctl.conf.5">sysctl.conf(5)</a>
is the default with the normal changes like <b>machdep.allowaperture=2</b> (<b>Update:</b> tb@ made me realize that <a href="https://undeadly.org/cgi?action=article&amp;sid=20140223112426">machdep.allowaperture is not needed anymore</a>, thanks!) or <b>net.inet.ip.forwarding=1</b>,
my daily laptop is a <b>thinkpad x395</b>.</p>
			<hr/>
			
			</div></div>
  </body>
</html>
