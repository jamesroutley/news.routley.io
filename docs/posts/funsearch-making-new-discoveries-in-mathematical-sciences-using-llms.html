<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://deepmind.google/discover/blog/funsearch-making-new-discoveries-in-mathematical-sciences-using-large-language-models/">Original</a>
    <h1>FunSearch: Making new discoveries in mathematical sciences using LLMs</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
      
  <article>
    
  
    
  
  
  
    

    
    
      
        <div>
          
            
            
              
              

<div>
    <div>
      <p>Research</p>
      

      
        <dl>
          
            <dt>Published</dt>
            <dd>
              <time datetime="2023-12-14">
                14 December 2023
              </time>
            </dd>
          
          
            <dt>Authors</dt>
            
          
        </dl>
      

      
    </div>

    
    
    
    <picture>
      <source media="(min-width: 1024px)" type="image/webp" width="1072" height="603" srcset="https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w1072-h603-n-nu-rw 1x, https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w2144-h1206-n-nu-rw 2x"/><source media="(min-width: 600px)" type="image/webp" width="928" height="522" srcset="https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w928-h522-n-nu-rw 1x, https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w1856-h1044-n-nu-rw 2x"/><source type="image/webp" width="528" height="297" srcset="https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w528-h297-n-nu-rw 1x, https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w1056-h594-n-nu-rw 2x"/>
      <img alt="Snippets of code and colourful streams of light" height="603" src="https://lh3.googleusercontent.com/fWc7Wtt0ge3XaM53Dwgbscfc2t7qG9mHLlES7lNwdW8lce9iiJKw_sRcXcaild2ZNm3nIjlvzO-4aMGv8EkLE6usq180w4e7ljHpWMdLQGt0NylmQYQ=w1072-h603-n-nu" width="1072"/>
    </picture>
    
  
  </div>
            
          
            
            
              
              <div>
  <p data-block-key="4lvaj">By searching for “functions” written in computer code, FunSearch made the first discoveries in open problems in mathematical sciences using LLMs</p><p data-block-key="7k21c">Large Language Models (LLMs) are useful assistants - they excel at combining concepts and can read, write and code to help people solve problems. But could they discover entirely new knowledge?</p><p data-block-key="c3ioi">As LLMs have been shown to “hallucinate” factually incorrect information, using them to make verifiably correct discoveries is a challenge. But what if we could harness the creativity of LLMs by identifying and building upon only their very best ideas?</p><p data-block-key="c9jsm">Today, in a <a href="https://www.nature.com/articles/s41586-023-06924-6" rel="noopener" target="_blank">paper published in Nature</a>, we introduce FunSearch, a method to search for new solutions in mathematics and computer science. FunSearch works by pairing a pre-trained LLM, whose goal is to provide creative solutions in the form of computer code, with an automated “evaluator”, which guards against hallucinations and incorrect ideas. By iterating back-and-forth between these two components, initial solutions “evolve” into new knowledge. The system searches for “functions” written in computer code; hence the name FunSearch.</p><p data-block-key="79msm">This work represents the first time a new discovery has been made for challenging open problems in science or mathematics using LLMs. FunSearch discovered new solutions for the cap set problem, a longstanding open problem in mathematics. In addition, to demonstrate the practical usefulness of FunSearch, we used it to discover more effective algorithms for the “bin-packing” problem, which has ubiquitous applications such as making data centers more efficient.</p><p data-block-key="6hrod">Scientific progress has always relied on the ability to share new understanding. What makes FunSearch a particularly powerful scientific tool is that it outputs programs that reveal <i>how</i> its solutions are constructed, rather than just what the solutions are. We hope this can inspire further insights in the scientists who use FunSearch, driving a virtuous cycle of improvement and discovery.</p><h2 data-block-key="cqrj5">Driving discovery through evolution with language models</h2><p data-block-key="3lfpb">FunSearch uses an evolutionary method powered by LLMs, which promotes and develops the highest scoring ideas. These ideas are expressed as computer programs, so that they can be run and evaluated automatically. First, the user writes a description of the problem in the form of code. This description comprises a procedure to evaluate programs, and a seed program used to initialize a pool of programs.</p><p data-block-key="33p7f">FunSearch is an iterative procedure; at each iteration, the system selects some programs from the current pool of programs, which are fed to an LLM. The LLM creatively builds upon these, and generates new programs, which are automatically evaluated. The best ones are added back to the pool of existing programs, creating a self-improving loop. FunSearch uses <a href="https://ai.google/discover/palm2/" rel="noopener" target="_blank">Google’s PaLM 2</a>, but it is compatible with other LLMs trained on code.</p>
</div>
            
          
            
            
              
              




<figure>
  
  
    <figcaption>
      <p data-block-key="8b2b2">The FunSearch process. The LLM is shown a selection of the best programs it has generated so far (retrieved from the programs database), and asked to generate an even better one. The programs proposed by the LLM are automatically executed, and evaluated. The best programs are added to the database, for selection in subsequent cycles. The user can at any point retrieve the highest-scoring programs discovered so far.</p>
    </figcaption>
  
</figure>
            
          
            
            
              
              <div>
  <p data-block-key="4lvaj">Discovering new mathematical knowledge and algorithms in different domains is a notoriously difficult task, and largely beyond the power of the most advanced AI systems. To tackle such challenging problems with FunSearch, we introduced multiple key components. Instead of starting from scratch, we start the evolutionary process with common knowledge about the problem, and let FunSearch focus on finding the most critical ideas to achieve new discoveries. In addition, our evolutionary process uses a strategy to improve the diversity of ideas in order to avoid stagnation. Finally, we run the evolutionary process in parallel to improve the system efficiency.</p><h2 data-block-key="293lm">Breaking new ground in mathematics</h2><p data-block-key="c10fe">We first address the <a href="https://en.wikipedia.org/wiki/Cap_set" rel="noopener" target="_blank">cap set problem</a>, an open challenge, which has vexed mathematicians in multiple research areas for decades. Renowned mathematician Terence Tao once described it as his <a href="https://terrytao.wordpress.com/2007/02/23/open-question-best-bounds-for-cap-sets/" rel="noopener" target="_blank">favorite open question</a>. We collaborated with Jordan Ellenberg, a professor of mathematics at the University of Wisconsin–Madison, and author of an <a href="https://arxiv.org/abs/1605.09223" rel="noopener" target="_blank">important breakthrough on the cap set problem</a>.</p><p data-block-key="6gov3">The problem consists of finding the largest set of points (called a <i>cap set</i>) in a high-dimensional grid, where no three points lie on a line. This problem is important because it serves as a model for other problems in extremal combinatorics - the study of how large or small a collection of numbers, graphs or other objects could be. Brute-force computing approaches to this problem don’t work – the number of possibilities to consider quickly becomes greater than the number of atoms in the universe.</p><p data-block-key="2vb6l">FunSearch generated solutions - in the form of programs - that in some settings discovered the largest cap sets ever found. This represents the <a href="https://link.springer.com/article/10.1023/A:1027365901231" rel="noopener" target="_blank">largest increase</a> in the size of cap sets in the past 20 years. Moreover, FunSearch outperformed state-of-the-art computational solvers, as this problem scales well beyond their current capabilities.</p>
</div>
            
          
            
            
              
              
            
          
            
            
              
              




<figure>
  
  
    <figcaption>
      <p data-block-key="ewhw0">Interactive figure showing the evolution from the seed program (top) to a new higher-scoring function (bottom). Each circle is a program, with its size proportional to the score assigned to it. Only ancestors of the program at the bottom are shown. The corresponding function produced by FunSearch for each node is shown on the right (see full program using this function in the paper).</p>
    </figcaption>
  
</figure>
            
          
            
            
              
              <div>
  <p data-block-key="4lvaj">These results demonstrate that the FunSearch technique can take us beyond established results on hard combinatorial problems, where intuition can be difficult to build. We expect this approach to play a role in new discoveries for similar theoretical problems in combinatorics, and in the future it may open up new possibilities in fields such as communication theory.</p><h2 data-block-key="cc0t2">FunSearch favors concise and human-interpretable programs</h2><p data-block-key="ektms">While discovering new mathematical knowledge is significant in itself, the FunSearch approach offers an additional benefit over traditional computer search techniques. That’s because FunSearch isn’t a black box that merely generates solutions to problems. Instead, it generates programs that describe <i>how</i> those solutions were arrived at. This show-your-working approach is how scientists generally operate, with new discoveries or phenomena explained through the process used to produce them.</p><p data-block-key="6f8qq">FunSearch favors finding solutions represented by highly compact programs - solutions with a low Kolmogorov complexity†. Short programs can describe very large objects, allowing FunSearch to scale to large needle-in-a-haystack problems. Moreover, this makes FunSearch’s program outputs easier for researchers to comprehend. Ellenberg said: “FunSearch offers a completely new mechanism for developing strategies of attack. The solutions generated by FunSearch are far conceptually richer than a mere list of numbers. When I study them, I learn something”.</p><p data-block-key="jp5n">What’s more, this interpretability of FunSearch’s programs can provide actionable insights to researchers. As we used FunSearch we noticed, for example, intriguing symmetries in the code of some of its high-scoring outputs. This gave us a new insight into the problem, and we used this insight to refine the problem introduced to FunSearch, resulting in even better solutions. We see this as an exemplar for a collaborative procedure between humans and FunSearch across many problems in mathematics.</p>
</div>
            
          
            
            
              
              




<figure>
  
  
    <figcaption>
      <p data-block-key="8jaj9">Left: Inspecting code generated by FunSearch yielded further actionable insights (highlights added by us). Right: The raw “admissible” set constructed using the (much shorter) program on the left.</p>
    </figcaption>
  
</figure>
            
          
            
            
              
              <figure>
  <blockquote><p data-block-key="jt2vi">The solutions generated by FunSearch are far conceptually richer than a mere list of numbers. When I study them, I learn something.</p></blockquote>
  <figcaption><p data-block-key="qcni1">Jordan Ellenberg, collaborator and professor of mathematics at the University of Wisconsin–Madison</p></figcaption>
</figure>
            
          
            
            
              
              <div>
  <h2 data-block-key="4lvaj">Addressing a notoriously hard challenge in computing</h2><p data-block-key="a8qqv">Encouraged by our success with the theoretical cap set problem, we decided to explore the flexibility of FunSearch by applying it to an important practical challenge in computer science. The “bin packing” problem looks at how to pack items of different sizes into the smallest number of bins. It sits at the core of many real-world problems, from loading containers with items to allocating compute jobs in data centers to minimize costs.</p><p data-block-key="1n4qj">The online bin-packing problem is typically addressed using algorithmic rules-of-thumb (heuristics) based on human experience. But finding a set of rules for each specific situation - with differing sizes, timing, or capacity – can be challenging. Despite being very different from the cap set problem, setting up FunSearch for this problem was easy. FunSearch delivered an automatically tailored program (adapting to the specifics of the data) that outperformed established heuristics – using fewer bins to pack the same number of items.</p>
</div>
            
          
            
            
              
              




<figure>
  
  
    <figcaption>
      <p data-block-key="n0rzx">Illustrative example of bin packing using existing heuristic – Best-fit heuristic (left), and using a heuristic discovered by FunSearch (right).</p>
    </figcaption>
  
</figure>
            
          
            
            
              
              <div>
  <p data-block-key="4lvaj">Hard combinatorial problems like online bin packing can be tackled using other AI approaches, <a href="https://deepmind.google/impact/optimizing-computer-systems-with-more-generalized-ai-tools/" rel="noopener" target="_blank">such as neural networks</a> and reinforcement learning. Such approaches have proven to be effective too, but may also require significant resources to deploy. FunSearch, on the other hand, outputs code that can be easily inspected and deployed, meaning its solutions could potentially be slotted into a variety of real-world industrial systems to bring swift benefits.</p><h2 data-block-key="1htm1">LLM-driven discovery for science and beyond</h2><p data-block-key="drmg1">FunSearch demonstrates that if we safeguard against LLMs’ hallucinations, the power of these models can be harnessed not only to produce new mathematical discoveries, but also to reveal potentially impactful solutions to important real-world problems.</p><p data-block-key="bd36s">We envision that for many problems in science and industry - longstanding or new - generating effective and tailored algorithms using LLM-driven approaches will become common practice.</p><p data-block-key="8uv2j">Indeed, this is just the beginning. FunSearch will improve as a natural consequence of the wider progress of LLMs, and we will also be working to broaden its capabilities to address a variety of society’s pressing scientific and engineering challenges.</p>
</div>
            
          
            
            
              
              


            
          
            
            
              
              
            
          
            
            
              
              



  
    
  

            
          
        </div>
      
    

    
  
  

  

  </article>

    </div></div>
  </body>
</html>
