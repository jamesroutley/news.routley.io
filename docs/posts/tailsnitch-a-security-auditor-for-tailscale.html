<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Adversis/tailsnitch">Original</a>
    <h1>Show HN: Tailsnitch â€“ A Security Auditor for Tailscale</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A security auditor for Tailscale configurations. Tailsnitch scans your tailnet for 50+ misconfigurations, overly permissive access controls, and security best practice violations.</p>

<div dir="auto" data-snippet-clipboard-copy-content="# 1. Set your Tailscale API credentials
export TSKEY=&#34;tskey-api-...&#34;

# 2. Run audit
tailsnitch

# 3. See only high-severity findings
tailsnitch --severity high

# 4. Fix some issues  ~interactively~ yolo mode
tailsnitch --fix"><pre><span><span>#</span> 1. Set your Tailscale API credentials</span>
<span>export</span> TSKEY=<span><span>&#34;</span>tskey-api-...<span>&#34;</span></span>

<span><span>#</span> 2. Run audit</span>
tailsnitch

<span><span>#</span> 3. See only high-severity findings</span>
tailsnitch --severity high

<span><span>#</span> 4. Fix some issues  ~interactively~ yolo mode</span>
tailsnitch --fix</pre></div>

<div dir="auto"><h3 tabindex="-1" dir="auto">Download Pre-built Binary</h3><a id="user-content-download-pre-built-binary" aria-label="Permalink: Download Pre-built Binary" href="#download-pre-built-binary"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Download the latest release from <a href="https://github.com/Adversis/tailsnitch/releases">GitHub Releases</a>.</p>
<p dir="auto"><strong>macOS users:</strong> Remove quarantine attribute after download:</p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo xattr -rd com.apple.quarantine tailsnitch"><pre>sudo xattr -rd com.apple.quarantine tailsnitch</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/Adversis/tailsnitch@latest"><pre>go install github.com/Adversis/tailsnitch@latest</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/Adversis/tailsnitch.git
cd tailsnitch
go build -o tailsnitch ."><pre>git clone https://github.com/Adversis/tailsnitch.git
<span>cd</span> tailsnitch
go build -o tailsnitch <span>.</span></pre></div>

<p dir="auto">Tailsnitch supports two authentication methods. OAuth is preferred when both are configured.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Option 1: OAuth Client (Recommended)</h3><a id="user-content-option-1-oauth-client-recommended" aria-label="Permalink: Option 1: OAuth Client (Recommended)" href="#option-1-oauth-client-recommended"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">OAuth clients provide scoped, auditable access that doesn&#39;t expire when employees leave.</p>
<div dir="auto" data-snippet-clipboard-copy-content="export TS_OAUTH_CLIENT_ID=&#34;...&#34;
export TS_OAUTH_CLIENT_SECRET=&#34;tskey-client-...&#34;"><pre><span>export</span> TS_OAUTH_CLIENT_ID=<span><span>&#34;</span>...<span>&#34;</span></span>
<span>export</span> TS_OAUTH_CLIENT_SECRET=<span><span>&#34;</span>tskey-client-...<span>&#34;</span></span></pre></div>
<p dir="auto">Create an OAuth client at: <a href="https://login.tailscale.com/admin/settings/oauth" rel="nofollow">https://login.tailscale.com/admin/settings/oauth</a></p>
<p dir="auto"><strong>Required scopes for read-only audit:</strong></p>
<ul dir="auto">
<li><code>all:read</code> (simplest), or individually:</li>
<li><code>policy_file:read</code> - ACL policy</li>
<li><code>devices:core:read</code> - Device list</li>
<li><code>dns:read</code> - DNS configuration</li>
<li><code>auth_keys:read</code> - Auth keys (for AUTH checks)</li>
</ul>
<p dir="auto"><strong>Additional scopes for fix mode:</strong></p>
<ul dir="auto">
<li><code>devices:core</code> - Delete devices, modify tags (requires tag selection)</li>
<li><code>auth_keys</code> - Delete auth keys</li>
</ul>

<p dir="auto">API keys operate as the user who created them and inherit that user&#39;s permissions.</p>
<div dir="auto" data-snippet-clipboard-copy-content="export TSKEY=&#34;tskey-api-...&#34;"><pre><span>export</span> TSKEY=<span><span>&#34;</span>tskey-api-...<span>&#34;</span></span></pre></div>
<p dir="auto">Create an API key at: <a href="https://login.tailscale.com/admin/settings/keys" rel="nofollow">https://login.tailscale.com/admin/settings/keys</a></p>


<div dir="auto" data-snippet-clipboard-copy-content="# Run full audit
tailsnitch

# Show passing checks too (verbose)
tailsnitch --verbose

# Output as JSON for processing
tailsnitch --json

# Audit a specific tailnet (when OAuth client has access to multiple)
tailsnitch --tailnet mycompany.com"><pre><span><span>#</span> Run full audit</span>
tailsnitch

<span><span>#</span> Show passing checks too (verbose)</span>
tailsnitch --verbose

<span><span>#</span> Output as JSON for processing</span>
tailsnitch --json

<span><span>#</span> Audit a specific tailnet (when OAuth client has access to multiple)</span>
tailsnitch --tailnet mycompany.com</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Only show critical and high severity issues
tailsnitch --severity high

# Filter by category
tailsnitch --category access    # ACL issues
tailsnitch --category auth      # Authentication &amp; keys
tailsnitch --category device    # Device security
tailsnitch --category network   # Network exposure
tailsnitch --category ssh       # SSH rules
tailsnitch --category log       # Logging &amp; admin

# Run specific checks only
tailsnitch --checks ACL-001,AUTH-001,DEV-010
tailsnitch --checks stale-devices,tailnet-lock-not-enabled

# List all available checks
tailsnitch --list-checks"><pre><span><span>#</span> Only show critical and high severity issues</span>
tailsnitch --severity high

<span><span>#</span> Filter by category</span>
tailsnitch --category access    <span><span>#</span> ACL issues</span>
tailsnitch --category auth      <span><span>#</span> Authentication &amp; keys</span>
tailsnitch --category device    <span><span>#</span> Device security</span>
tailsnitch --category network   <span><span>#</span> Network exposure</span>
tailsnitch --category ssh       <span><span>#</span> SSH rules</span>
tailsnitch --category log       <span><span>#</span> Logging &amp; admin</span>

<span><span>#</span> Run specific checks only</span>
tailsnitch --checks ACL-001,AUTH-001,DEV-010
tailsnitch --checks stale-devices,tailnet-lock-not-enabled

<span><span>#</span> List all available checks</span>
tailsnitch --list-checks</pre></div>

<p dir="auto">Fix mode allows you to remediate issues directly via the Tailscale API:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Interactive fix mode
tailsnitch --fix

# Preview what would be fixed (dry run)
tailsnitch --fix --dry-run

# Auto-select safe fixes (still requires confirmation)
tailsnitch --fix --auto

# Disable audit logging of fix actions
tailsnitch --fix --no-audit-log"><pre><span><span>#</span> Interactive fix mode</span>
tailsnitch --fix

<span><span>#</span> Preview what would be fixed (dry run)</span>
tailsnitch --fix --dry-run

<span><span>#</span> Auto-select safe fixes (still requires confirmation)</span>
tailsnitch --fix --auto

<span><span>#</span> Disable audit logging of fix actions</span>
tailsnitch --fix --no-audit-log</pre></div>
<p dir="auto"><strong>API-fixable items:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Check</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>AUTH-001, AUTH-002, AUTH-003</td>
<td>Delete auth keys</td>
</tr>
<tr>
<td>AUTH-004</td>
<td>Replace with ephemeral keys</td>
</tr>
<tr>
<td>DEV-002</td>
<td>Remove tags from user devices</td>
</tr>
<tr>
<td>DEV-004</td>
<td>Delete stale devices</td>
</tr>
<tr>
<td>DEV-005</td>
<td>Authorize pending devices</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Fix mode also provides direct links to the admin console for issues that require manual intervention.</p>

<p dir="auto">Generate evidence reports for SOC 2 audits with Common Criteria (CC) control mappings:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Export as JSON
tailsnitch --soc2 json &gt; soc2-evidence.json

# Export as CSV (for spreadsheets)
tailsnitch --soc2 csv &gt; soc2-evidence.csv"><pre><span><span>#</span> Export as JSON</span>
tailsnitch --soc2 json <span>&gt;</span> soc2-evidence.json

<span><span>#</span> Export as CSV (for spreadsheets)</span>
tailsnitch --soc2 csv <span>&gt;</span> soc2-evidence.csv</pre></div>
<p dir="auto">The SOC 2 report includes:</p>
<ul dir="auto">
<li>Per-resource test results (each device, key, ACL rule tested individually)</li>
<li>CC code mappings (CC6.1, CC6.2, CC6.3, CC6.6, CC7.1, CC7.2, etc.)</li>
<li>Pass/Fail/N/A status for each control test</li>
<li>Timestamp for audit trail</li>
</ul>
<p dir="auto"><strong>Example CSV output:</strong></p>
<div data-snippet-clipboard-copy-content="resource_type,resource_id,resource_name,check_id,check_title,cc_codes,status,details,tested_at
device,node123,prod-server,DEV-001,Tagged devices with key expiry disabled,CC6.1;CC6.3,PASS,Tags: [tag:server] key expiry enabled,2025-01-05T10:30:00Z
key,tskey-auth-xxx,tskey-auth-xxx,AUTH-001,Reusable auth keys exist,CC6.1;CC6.2;CC6.3,FAIL,Reusable key expires in 45 days,2025-01-05T10:30:00Z"><pre lang="csv"><code>resource_type,resource_id,resource_name,check_id,check_title,cc_codes,status,details,tested_at
device,node123,prod-server,DEV-001,Tagged devices with key expiry disabled,CC6.1;CC6.3,PASS,Tags: [tag:server] key expiry enabled,2025-01-05T10:30:00Z
key,tskey-auth-xxx,tskey-auth-xxx,AUTH-001,Reusable auth keys exist,CC6.1;CC6.2;CC6.3,FAIL,Reusable key expires in 45 days,2025-01-05T10:30:00Z
</code></pre></div>

<p dir="auto">Create a <code>.tailsnitch-ignore</code> file to suppress findings for known-accepted risks:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# .tailsnitch-ignore
# Ignore informational checks
ACL-008  # We intentionally don&#39;t use groups
ACL-009  # Legacy ACLs are fine for our use case

# Ignore specific medium checks with justification
DEV-006  # External devices are approved contractors
LOG-001  # Flow logs require Enterprise plan"><pre><span><span>#</span> .tailsnitch-ignore</span>
<span><span>#</span> Ignore informational checks</span>
ACL-008  <span><span>#</span> We intentionally don&#39;t use groups</span>
ACL-009  <span><span>#</span> Legacy ACLs are fine for our use case</span>

<span><span>#</span> Ignore specific medium checks with justification</span>
DEV-006  <span><span>#</span> External devices are approved contractors</span>
LOG-001  <span><span>#</span> Flow logs require Enterprise plan</span></pre></div>
<p dir="auto"><strong>Ignore file locations (checked in order):</strong></p>
<ol dir="auto">
<li><code>.tailsnitch-ignore</code> in current directory</li>
<li><code>~/.tailsnitch-ignore</code> in home directory</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="# Use a specific ignore file
tailsnitch --ignore-file /path/to/ignore

# Disable ignore file processing entirely
tailsnitch --no-ignore"><pre><span><span>#</span> Use a specific ignore file</span>
tailsnitch --ignore-file /path/to/ignore

<span><span>#</span> Disable ignore file processing entirely</span>
tailsnitch --no-ignore</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">JSON Export and Processing</h3><a id="user-content-json-export-and-processing" aria-label="Permalink: JSON Export and Processing" href="#json-export-and-processing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Export full report
tailsnitch --json &gt; audit.json

# Extract failed checks as TSV
tailsnitch --json | jq -r &#39;
  .suggestions
  | map(select(.pass == false))
  | .[]
  | [.id, .title, .severity, .remediation]
  | @tsv
&#39; &gt; findings.tsv

# Summary by severity
tailsnitch --json | jq &#39;
  .suggestions
  | map(select(.pass == false))
  | group_by(.severity)
  | map({severity: .[0].severity, count: length})
&#39;

# List critical/high issues with admin links
tailsnitch --json | jq -r &#39;
  .suggestions
  | map(select(.pass == false and (.severity == &#34;CRITICAL&#34; or .severity == &#34;HIGH&#34;)))
  | .[]
  | &#34;\(.id): \(.title)\n  Fix: \(.fix.admin_url // &#34;manual&#34;)\n&#34;
&#39;"><pre><span><span>#</span> Export full report</span>
tailsnitch --json <span>&gt;</span> audit.json

<span><span>#</span> Extract failed checks as TSV</span>
tailsnitch --json <span>|</span> jq -r <span><span>&#39;</span></span>
<span>  .suggestions</span>
<span>  | map(select(.pass == false))</span>
<span>  | .[]</span>
<span>  | [.id, .title, .severity, .remediation]</span>
<span>  | @tsv</span>
<span><span>&#39;</span></span> <span>&gt;</span> findings.tsv

<span><span>#</span> Summary by severity</span>
tailsnitch --json <span>|</span> jq <span><span>&#39;</span></span>
<span>  .suggestions</span>
<span>  | map(select(.pass == false))</span>
<span>  | group_by(.severity)</span>
<span>  | map({severity: .[0].severity, count: length})</span>
<span><span>&#39;</span></span>

<span><span>#</span> List critical/high issues with admin links</span>
tailsnitch --json <span>|</span> jq -r <span><span>&#39;</span></span>
<span>  .suggestions</span>
<span>  | map(select(.pass == false and (.severity == &#34;CRITICAL&#34; or .severity == &#34;HIGH&#34;)))</span>
<span>  | .[]</span>
<span>  | &#34;\(.id): \(.title)\n  Fix: \(.fix.admin_url // &#34;manual&#34;)\n&#34;</span>
<span><span>&#39;</span></span></pre></div>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--json</code></td>
<td>Output as JSON</td>
</tr>
<tr>
<td><code>--severity</code></td>
<td>Filter by minimum severity: <code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code>, <code>info</code></td>
</tr>
<tr>
<td><code>--category</code></td>
<td>Filter by category: <code>access</code>, <code>auth</code>, <code>network</code>, <code>ssh</code>, <code>log</code>, <code>device</code>, <code>dns</code></td>
</tr>
<tr>
<td><code>--checks</code></td>
<td>Run specific checks (comma-separated IDs or slugs)</td>
</tr>
<tr>
<td><code>--list-checks</code></td>
<td>List all available checks and exit</td>
</tr>
<tr>
<td><code>--tailnet</code></td>
<td>Specify tailnet to audit (default: from API key)</td>
</tr>
<tr>
<td><code>--verbose</code></td>
<td>Show passing checks too</td>
</tr>
<tr>
<td><code>--fix</code></td>
<td>Enable interactive fix mode</td>
</tr>
<tr>
<td><code>--auto</code></td>
<td>Auto-select safe fixes (requires <code>--fix</code>)</td>
</tr>
<tr>
<td><code>--dry-run</code></td>
<td>Preview fix actions without executing (requires <code>--fix</code>)</td>
</tr>
<tr>
<td><code>--no-audit-log</code></td>
<td>Disable audit logging of fix actions</td>
</tr>
<tr>
<td><code>--soc2</code></td>
<td>Export SOC 2 evidence: <code>json</code> or <code>csv</code></td>
</tr>
<tr>
<td><code>--tailscale-path</code></td>
<td>Path to tailscale CLI (for Tailnet Lock checks)</td>
</tr>
<tr>
<td><code>--ignore-file</code></td>
<td>Path to ignore file</td>
</tr>
<tr>
<td><code>--no-ignore</code></td>
<td>Disable ignore file processing</td>
</tr>
<tr>
<td><code>--version</code></td>
<td>Show version information</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">Tailsnitch performs 52 security checks across 7 categories. See <a href="https://github.com/Adversis/tailsnitch/blob/main/docs/CHECKS.md">docs/CHECKS.md</a> for detailed documentation of each check.</p>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>ID</th>
<th>Check</th>
<th>Risk</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACL-001</td>
<td>Default &#39;allow all&#39; policy</td>
<td>All devices have unrestricted access</td>
</tr>
<tr>
<td>ACL-002</td>
<td>SSH autogroup:nonroot misconfiguration</td>
<td>SSH as any non-root user</td>
</tr>
<tr>
<td>ACL-006</td>
<td>tagOwners too broad</td>
<td>Privilege escalation via tags</td>
</tr>
<tr>
<td>ACL-007</td>
<td>autogroup:danger-all usage</td>
<td>Access granted to external users</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>ID</th>
<th>Check</th>
<th>Risk</th>
</tr>
</thead>
<tbody>
<tr>
<td>AUTH-001</td>
<td>Reusable auth keys</td>
<td>Unlimited device additions if stolen</td>
</tr>
<tr>
<td>AUTH-002</td>
<td>Long expiry auth keys</td>
<td>Extended exposure window</td>
</tr>
<tr>
<td>AUTH-003</td>
<td>Pre-authorized keys</td>
<td>Bypass device approval</td>
</tr>
<tr>
<td>DEV-001</td>
<td>Tagged devices without key expiry</td>
<td>Indefinite access</td>
</tr>
<tr>
<td>DEV-002</td>
<td>User devices tagged</td>
<td>Persist after user removal</td>
</tr>
<tr>
<td>DEV-010</td>
<td>Tailnet Lock disabled</td>
<td>No protection against stolen keys</td>
</tr>
<tr>
<td>DEV-012</td>
<td>Pending Tailnet Lock signatures</td>
<td>Unsigned nodes need review</td>
</tr>
<tr>
<td>NET-001</td>
<td>Funnel exposure</td>
<td>Public internet access</td>
</tr>
<tr>
<td>NET-003</td>
<td>Subnet router trust boundary</td>
<td>Unencrypted traffic on local network</td>
</tr>
<tr>
<td>SSH-002</td>
<td>Root SSH without check mode</td>
<td>No re-authentication required</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>ID</th>
<th>Check</th>
<th>Risk</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACL-004</td>
<td>autogroup:member usage</td>
<td>External users included</td>
</tr>
<tr>
<td>ACL-005</td>
<td>AutoApprovers configured</td>
<td>Bypass route approval</td>
</tr>
<tr>
<td>AUTH-004</td>
<td>Non-ephemeral CI/CD keys</td>
<td>Stale devices accumulate</td>
</tr>
<tr>
<td>DEV-003</td>
<td>Outdated clients</td>
<td>Potential vulnerabilities</td>
</tr>
<tr>
<td>DEV-004</td>
<td>Stale devices</td>
<td>Unused attack surface</td>
</tr>
<tr>
<td>DEV-005</td>
<td>Unauthorized devices</td>
<td>Pending approval queue</td>
</tr>
<tr>
<td>DEV-007</td>
<td>Sensitive machine names</td>
<td>CT log exposure</td>
</tr>
<tr>
<td>DEV-009</td>
<td>Device approval config</td>
<td>May not be enabled</td>
</tr>
<tr>
<td>NET-004</td>
<td>HTTPS CT log exposure</td>
<td>Machine names public</td>
</tr>
<tr>
<td>NET-005</td>
<td>Exit node traffic visibility</td>
<td>Operator sees all traffic</td>
</tr>
<tr>
<td>NET-006</td>
<td>Serve exposure</td>
<td>Local services on tailnet</td>
</tr>
<tr>
<td>SSH-003</td>
<td>Recorder UI exposure</td>
<td>Sessions visible to network</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">Checks for logging configuration, DNS settings, user roles, and manual verification items.</p>

<div data-snippet-clipboard-copy-content="+=====================================================================+
|                    TAILSNITCH SECURITY AUDIT                        |
|            Tailnet: example.com                                     |
|            Version: 1.0.0 (build: abc123)                           |
+=====================================================================+

  Using ignore file: .tailsnitch-ignore (3 rules)

=== ACCESS CONTROLS ===================================================

[CRITICAL] ACL-001: Default &#39;allow all&#39; policy active
  Your ACL policy omits the &#39;acls&#39; field. Tailscale applies a
  default &#39;allow all&#39; policy, granting all devices full access.

  Remediation:
  Define explicit ACL rules following least privilege principle.

  Source: https://tailscale.com/kb/1192/acl-samples
----------------------------------------------------------------------

=== AUTHENTICATION &amp; KEYS =============================================

[HIGH] AUTH-001: Reusable auth keys exist
  Found 2 reusable auth key(s). These can be reused to add
  multiple devices if compromised.

  Details:
    - Key tskey-auth-xxx (expires in 45 days)
    - Key tskey-auth-yyy (expires in 89 days)

  Remediation:
  Store reusable keys in a secrets manager. Prefer one-off keys.

  Source: https://tailscale.com/kb/1085/auth-keys
----------------------------------------------------------------------

SUMMARY
======================================================================
  Critical: 1  High: 3  Medium: 5  Low: 2  Info: 8
  Total findings: 19  |  Passed: 33"><pre><code>+=====================================================================+
|                    TAILSNITCH SECURITY AUDIT                        |
|            Tailnet: example.com                                     |
|            Version: 1.0.0 (build: abc123)                           |
+=====================================================================+

  Using ignore file: .tailsnitch-ignore (3 rules)

=== ACCESS CONTROLS ===================================================

[CRITICAL] ACL-001: Default &#39;allow all&#39; policy active
  Your ACL policy omits the &#39;acls&#39; field. Tailscale applies a
  default &#39;allow all&#39; policy, granting all devices full access.

  Remediation:
  Define explicit ACL rules following least privilege principle.

  Source: https://tailscale.com/kb/1192/acl-samples
----------------------------------------------------------------------

=== AUTHENTICATION &amp; KEYS =============================================

[HIGH] AUTH-001: Reusable auth keys exist
  Found 2 reusable auth key(s). These can be reused to add
  multiple devices if compromised.

  Details:
    - Key tskey-auth-xxx (expires in 45 days)
    - Key tskey-auth-yyy (expires in 89 days)

  Remediation:
  Store reusable keys in a secrets manager. Prefer one-off keys.

  Source: https://tailscale.com/kb/1085/auth-keys
----------------------------------------------------------------------

SUMMARY
======================================================================
  Critical: 1  High: 3  Medium: 5  Low: 2  Info: 8
  Total findings: 19  |  Passed: 33
</code></pre></div>

<p dir="auto">Tailnet Lock checks (DEV-010, DEV-012) require the local <code>tailscale</code> CLI and run against the <strong>local machine&#39;s daemon</strong>. When auditing a remote tailnet via <code>--tailnet</code>, these checks reflect local status, not the audited tailnet.</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Specify custom tailscale binary path if needed
tailsnitch --tailscale-path /opt/tailscale/bin/tailscale"><pre><span><span>#</span> Specify custom tailscale binary path if needed</span>
tailsnitch --tailscale-path /opt/tailscale/bin/tailscale</pre></div>

<p dir="auto">Run Tailsnitch in CI/CD pipelines to catch security regressions:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# GitHub Actions example
- name: Audit Tailscale Security
  env:
    TS_OAUTH_CLIENT_ID: ${{ secrets.TS_OAUTH_CLIENT_ID }}
    TS_OAUTH_CLIENT_SECRET: ${{ secrets.TS_OAUTH_CLIENT_SECRET }}
  run: |
    tailsnitch --json &gt; audit.json
    # Fail if critical or high severity issues exist
    if tailsnitch --severity high --json | jq -e &#39;.summary.critical + .summary.high &gt; 0&#39; &gt; /dev/null; then
      echo &#34;Critical or high severity issues found!&#34;
      tailsnitch --severity high
      exit 1
    fi"><pre><span><span>#</span> GitHub Actions example</span>
- <span>name</span>: <span>Audit Tailscale Security</span>
  <span>env</span>:
    <span>TS_OAUTH_CLIENT_ID</span>: <span>${{ secrets.TS_OAUTH_CLIENT_ID }}</span>
    <span>TS_OAUTH_CLIENT_SECRET</span>: <span>${{ secrets.TS_OAUTH_CLIENT_SECRET }}</span>
  <span>run</span>: <span>|</span>
<span>    tailsnitch --json &gt; audit.json</span>
<span>    # Fail if critical or high severity issues exist</span>
<span>    if tailsnitch --severity high --json | jq -e &#39;.summary.critical + .summary.high &gt; 0&#39; &gt; /dev/null; then</span>
<span>      echo &#34;Critical or high severity issues found!&#34;</span>
<span>      tailsnitch --severity high</span>
<span>      exit 1</span>
<span>    fi</span></pre></div>

<ul dir="auto">
<li><a href="https://tailscale.com/kb/1196/security-hardening" rel="nofollow">Tailscale Security Hardening Guide</a></li>
<li><a href="https://tailscale.com/kb/1337/policy-syntax" rel="nofollow">ACL Syntax Reference</a></li>
<li><a href="https://tailscale.com/kb/1193/tailscale-ssh" rel="nofollow">Tailscale SSH</a></li>
<li><a href="https://tailscale.com/kb/1203/audit-logging" rel="nofollow">Audit Logging</a></li>
<li><a href="https://tailscale.com/kb/1226/tailnet-lock" rel="nofollow">Tailnet Lock</a></li>
</ul>

<p dir="auto">MIT</p>

<p dir="auto">See <a href="https://github.com/Adversis/tailsnitch/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> for guidelines.</p>
</article></div></div>
  </body>
</html>
