<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/gaming/2024/06/what-kind-of-bug-would-make-machine-learning-suddenly-40-worse-at-nethack/">Original</a>
    <h1>What kind of bug would make machine learning suddenly 40% worse at NetHack?</h1>
    
    <div id="readability-page-1" class="page"><div>
        <header>
            <h4>
      Large Moon Models (LMMs)    —
</h4>
            
            <h2 itemprop="description">One day, a roguelike-playing system just kept biffing it, for celestial reasons.</h2>
            <section>

  


  
</section>        </header>
        <section>
            <div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2024/06/you-are-lucky-moon-800x450.png" alt="Moon rendered in ASCII text, with " you="" are="" lucky="" full="" moon="" tonight="" in="" the="" middle="" yellow.=""/>
      <figcaption><p>Aurich Lawson</p></figcaption>  </figure>

  




<!-- cache hit 265:single/related:75c61e465b8b8ab6d7df68471d10de75 --><!-- empty -->
<p>Members of the Legendary Computer Bugs Tribunal, honored guests, if I may have your attention? I would, humbly, submit a new contender for your esteemed judgment. You may or may not find it novel, you may even deign to call it a &#34;bug,&#34; but I assure you, you will find it entertaining.</p>
<p>Consider <a href="https://www.nethack.org/"><em>NetHack</em></a>. It is one of <a href="https://arstechnica.com/gaming/2020/03/ascii-art-permadeath-the-history-of-roguelike-games/">the all-time roguelike</a> games, and I mean that in the more strict sense of that term. The content is procedurally generated, deaths are permanent, and the only thing you keep from game to game is your skill and knowledge. I do understand that the only thing two roguelike fans can agree on is how wrong the third roguelike fan is in their definition of roguelike, but, please, let us move on.</p>
<h2><em>NetHack</em> is great for machine learning…</h2>
<p>Being a difficult game full of consequential choices and random challenges, as well as a &#34;single-agent&#34; game that can be generated and played at lightning speed on modern computers, <em>NetHack</em> is great for those working in machine learning—or <a href="https://underactuated.mit.edu/imitation.html">imitation learning</a>, actually, as detailed in <a href="https://arxiv.org/abs/2307.09423">Jens Tuyls&#39; paper</a> on how compute scaling affects single-agent game learning. Using Tuyls&#39; model of expert <em>NetHack</em> behavior, Bartłomiej Cupiał and Maciej Wołczyk trained a neural network to play and improve itself using <a href="https://en.wikipedia.org/wiki/Reinforcement_learning">reinforcement learning</a>.
</p><p>By mid-May of this year, the two had their model consistently scoring 5,000 points by their own metrics. Then, on one run, the model suddenly got worse, on the order of 40 percent. It scored 3,000 points. Machine learning generally, gradually, goes in one direction with these types of problems. It didn&#39;t make sense.</p>
<p>Cupiał and Wołczyk tried quite a few things: reverting their code, restoring their entire software stack from a Singularity backup, and rolling back their <a href="https://developer.nvidia.com/cuda-toolkit">CUDA</a> libraries. The result? 3,000 points. They rebuild everything from scratch, and it&#39;s still 3,000 points.</p>                                            
                                                        
<figure><img alt="&lt;em&gt;NetHack&lt;/em&gt;, played by a regular human." src="https://cdn.arstechnica.net/wp-content/uploads/2024/06/13863751533_64654db44e_o.png" width="821" height="506"/><figcaption><p><em>NetHack</em>, played by a regular human.</p></figcaption></figure>
<h2>… except on certain nights</h2>
<p>As <a href="https://x.com/cupiabart/status/1793930355617259811?s=46">detailed</a> in Cupiał&#39;s X (formerly Twitter) thread, this was several hours of confused trial and error by him and Wołczyk. &#34;<span>I am starting to feel like a madman. I can&#39;t even watch a TV show constantly thinking about the bug,&#34; Cupiał wrote. In desperation, he asks model author Tuyls if he knows what could be wrong. He wakes up in Kraków to an answer:</span></p>
<p><span>&#34;Oh yes, it&#39;s probably a full moon today.&#34;</span></p>
<p>In <em>NetHack</em>, the game in which the DevTeam has <a href="https://nethackwiki.com/wiki/The_DevTeam_Thinks_of_Everything">thought of everything</a>, if the game detects from your system clock that it should be a full moon, it will generate a message: &#34;You are lucky! Full moon tonight.&#34; A full moon imparts <a href="https://nethackwiki.com/wiki/Time">a few player benefits</a>: a single point added to Luck, and werecreatures mostly kept to their animal forms.</p>
<p>It&#39;s an easier game, all things considered, so why would the learning agent&#39;s score be lower? It simply doesn&#39;t have data about full moon variables in its training data, so a branching series of decisions likely leads to lesser outcomes, or just confusion. It was indeed a full moon in <span>Kraków</span> when the 3,000-ish scores started showing up. What a terrible night to have a learning model.</p>
<p>Of course, &#34;score&#34; is not a real metric for success in <em>NetHack</em>, as <a href="https://x.com/CupiaBart/status/1794614271281905955">Cupiał himself noted</a>. Ask a model to get the best score, and it will farm the heck out of early-stage monsters because it never gets bored. &#34;<span>Finding items required for [ascension] or even [just] doing a quest is too much for pure RL agent,&#34; Cupiał wrote. Another neural network, <a href="https://github.com/maciej-sypetkowski/autoascend">AutoAscend</a>, does a better job of progressing through the game, but &#34;even it can only solve sokoban and reach mines end,&#34; Cupiał <a href="https://x.com/CupiaBart/status/1794440727117668776">notes</a>.</span></p>
<h2>Is it a bug?</h2>
<p>I submit to you that, although <em>NetHack</em> responded to the full moon in its intended way, this quirky, very hard-to-fathom stop on a machine-learning journey was indeed a bug and a worthy one in the pantheon. It&#39;s not <a href="https://education.nationalgeographic.org/resource/worlds-first-computer-bug/">a Harvard moth</a>, nor a <a href="http://web.mit.edu/jemorris/humor/500-miles">500-mile email</a>, but what is?</p>
<p>Because the team used <a href="https://docs.sylabs.io/guides/3.0/user-guide/installation.html">Singularity</a> to back up and restore their stack, they inadvertently carried forward the machine time and resulting bug each time they tried to solve it. The machine&#39;s resulting behavior was so bizarre, and seemingly based on unseen forces, that it drove a coder into fits. And the story has a beginning, a climactic middle, and a denouement that teaches us something, however obscure.</p>
<p>The <em>NetHack</em> Lunar Learning Bug is, I submit, quite worth memorializing. Thank you for your time.</p>

                                                </div>

            
            
            
        </section>
    </div></div>
  </body>
</html>
