<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sites.gatech.edu/omscsopencourseware/">Original</a>
    <h1>OMSCS Open Courseware</h1>
    
    <div id="readability-page-1" class="page"><div><section><p>I just did a fresh Linux install on a spare computer. After rebooting, I found that it would hang with a blinking cursor before entering GRUB. I&#39;ve seen this before - in a multidisk setup, often it&#39;s caused by a disk that&#39;s marked as bootable that doesn&#39;t actually have a valid bootloader. Seeing as this machine has 2 disks, it seemed like a good thing to check. I boot up a live USB and get to work.</p><p>First, let&#39;s check if the secondary disk is bootable. We could probably do this through fdisk but I don&#39;t care. Let&#39;s just check it manually:</p><pre><span>  </span><span>$</span><span> sudo head</span><span> -c</span><span> 512 /dev/sdb | </span><span>xxd
</span><span>  </span><span>00000000:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000010:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000020:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000030:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000040:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000050:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000060:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000070:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000080:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000090:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000a0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000b0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000c0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000d0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000e0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000000f0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000100:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000110:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000120:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000130:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000140:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000150:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000160:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000170:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000180:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>00000190:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000001a0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000001b0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000001c0:</span><span> 0200 eeff ffff 0100 0000 afd2 3b77 0000  ............;</span><span>w..
</span><span>  </span><span>000001d0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000001e0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>  </span><span>000001f0:</span><span> 0000 0000 0000 0000 0000 0000 0000 55aa  ..............U.
</span></pre>
<p>In BIOS systems, the disk is marked as bootable by the last two bytes of the first sector (512 bytes long) being set to <code>0x55AA</code>. This is a magic number that IBM decided on. The above command prints out a hex dump of the first sector, and we can confirm that, due to the 0x55AA at the end, the disk is indeed marked bootable. Oh no! Luckily it&#39;s easy enough to fix:</p><pre><span>$</span><span> sudo dd if=/dev/zero of=/dev/sdb bs=1 count=2 seek=510 % todo confirm
</span><span>2+0</span><span> records in
</span><span>2+0</span><span> records out
</span><span>2</span><span> bytes copied, 0.000281409 s, 7.1 kB/s
</span></pre>
<p>We use dd to copy zeroes from <code>/dev/zero</code> to our disk. We set our block size to 1 with <code>bs=1</code> so that our blocks are 1 byte long. We only want to copy 2 blocks - that&#39;s <code>count=2</code> - and we want to skip over the first 510 bytes with <code>seek=510</code>.</p><p>And now let&#39;s confirm:</p><pre><span>$</span><span> sudo head</span><span> -c</span><span> 512 /dev/sdb | </span><span>xxd
</span><span>00000000:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000010:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000020:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000030:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000040:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000050:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000060:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000070:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000080:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000090:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000a0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000b0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000c0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000d0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000e0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000000f0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000100:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000110:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000120:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000130:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000140:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000150:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000160:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000170:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000180:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>00000190:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000001a0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000001b0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000001c0:</span><span> 0200 eeff ffff 0100 0000 afd2 3b77 0000  ............;</span><span>w..
</span><span>000001d0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000001e0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span><span>000001f0:</span><span> 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span></pre>
<p>We can see now that the boot flag has been cleared. After a reboot I can confirm my computer is now booting properly - yay!</p><p>fdisk? f your disk :3</p></section></div></div>
  </body>
</html>
