<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/johnma2006/mamba-minimal">Original</a>
    <h1>Implementation of Mamba in one file of PyTorch</h1>
    
    <div id="readability-page-1" class="page"><div data-view-component="true">        
        
        <div>
  
<div>
  <details id="branch-select-menu" data-hydro-click-payload="{&#34;event_type&#34;:&#34;repository.click&#34;,&#34;payload&#34;:{&#34;target&#34;:&#34;REFS_SELECTOR_MENU&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="715dabbefe69e913c3f5be665e168a0abe240de283a5b1421a57c550ba764a9a">
    <summary data-hotkey="w">
      <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
      <span data-menu-button="">master</span>
      <span></span>
    </summary>

    
<div>
  <div>
    <header>
      <span>Switch branches/tags</span>
      
    </header>

    <input-demux data-action="tab-container-change:input-demux#storeInput tab-container-changed:input-demux#updateInput">
      <tab-container>
        

        

        <div role="tabpanel" id="ref-list-branches" data-filter-placeholder="Filter branches/tags" tabindex="">
          <ref-selector type="branch" data-targets="input-demux.sinks" data-action="
              input-entered:ref-selector#inputEntered
              tab-selected:ref-selector#tabSelected
              focus-list:ref-selector#focusFirstListMember
            " query-endpoint="/johnma2006/mamba-minimal/refs" cache-key="v0:1703070932.0" current-committish="bWFzdGVy" default-branch="bWFzdGVy" name-with-owner="am9obm1hMjAwNi9tYW1iYS1taW5pbWFs" prefetch-on-mouseover="">

            <template data-target="ref-selector.fetchFailedTemplate">
              <p>Could not load branches</p>
            </template>

              <template data-target="ref-selector.noMatchTemplate">
    <p>Nothing to show</p>
</template>


            <div data-target="ref-selector.listContainer" role="menu" data-turbo-frame="repo-content-turbo-frame">
              
            </div>

              

<template data-target="ref-selector.itemTemplate">
  <a href="https://github.com/johnma2006/mamba-minimal/tree/{{ urlEncodedRefName }}" role="menuitemradio" rel="nofollow" aria-checked="{{ isCurrent }}" data-index="{{ index }}">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    <span>{{ refName }}</span>
    
  </a>
</template>


              
          </ref-selector>

        </div>

        
      </tab-container>
    </input-demux>
  </div>
</div>

  </details>

</div>


<div data-modal-dialog-overlay="">
  <modal-dialog role="dialog" id="warn-tag-match-create-branch-dialog" aria-modal="true" aria-labelledby="warn-tag-match-create-branch-dialog-header" data-view-component="true">
      <header>
        <div>
          
          
        </div>
      </header>
    <div>
      
          <p>      A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?
</p>

    </div>
      
</modal-dialog></div>



  <div>
    <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/branches">
          <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
          <strong>1</strong>
          <span>branch</span>
    </a>
    <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/tags">
      <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path>
</svg>
        <strong>0</strong>
        <span>tags</span>
    </a>
  </div>

  

  <include-fragment src="/johnma2006/mamba-minimal/overview_actions/master"></include-fragment>


    <p><span>
        
<get-repo>
  <details data-action="
              toggle:get-repo#onDetailsToggle
              keydown:get-repo#onDetailsKeydown">
    <summary data-hydro-click="{&#34;event_type&#34;:&#34;repository.click&#34;,&#34;payload&#34;:{&#34;repository_id&#34;:733879158,&#34;target&#34;:&#34;CLONE_OR_DOWNLOAD_BUTTON&#34;,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="b4b996cb214076e1cdd9e7d492f4bd3e9cd735f5a6d1ade216d1860230b0e340" aria-description="Open clone and codespaces menu" data-view-component="true">  <span>
    <span>Code</span>
  </span>
    <span>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</summary>
    <div>
      <div>
        <div data-target="get-repo.modal">
    <tab-container data-view-component="true">
  <div with_panel="true" data-view-component="true">
    
    <ul role="tablist" aria-label="Choose where to access your code" data-view-component="true">
        <li role="presentation" data-view-component="true">
  </li>
        <li role="presentation" data-view-component="true">
  </li>
</ul>    
</div>    <div id="local-panel" role="tabpanel" tabindex="0" aria-labelledby="local-tab" data-view-component="true">          <ul>
              <li>
  <a href="https://docs.github.com/articles/which-remote-url-should-i-use" rel="noopener" target="_blank" aria-label="Which remote URL should I use?">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</a>

<div>
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M0 2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25Zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM7.25 8a.749.749 0 0 1-.22.53l-2.25 2.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L5.44 8 3.72 6.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.25 2.25c.141.14.22.331.22.53Zm1.5 1.5h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5Z"></path>
</svg><p>
  Clone
</p></div>

<tab-container>

  <div>
    
  </div>

  <div role="tabpanel">
    <div>
  
</div>

    <p>
        Use Git or checkout with SVN using the web URL.
    </p>
  </div>


  
</tab-container>

</li>
<li data-platforms="windows,mac">
  <a data-hydro-click="{&#34;event_type&#34;:&#34;clone_or_download.click&#34;,&#34;payload&#34;:{&#34;feature_clicked&#34;:&#34;OPEN_IN_DESKTOP&#34;,&#34;git_repository_type&#34;:&#34;REPOSITORY&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="43210333fed2521a94e1d75b0e6ffde7a525c74e2c6235f337549a95c94486ac" data-action="click:get-repo#showDownloadMessage" href="https://desktop.github.com">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="m4.927 5.427 2.896 2.896a.25.25 0 0 0 .354 0l2.896-2.896A.25.25 0 0 0 10.896 5H8.75V.75a.75.75 0 1 0-1.5 0V5H5.104a.25.25 0 0 0-.177.427Z"></path><path d="M1.573 2.573a.25.25 0 0 0-.073.177v7.5a.25.25 0 0 0 .25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-3a.75.75 0 1 1 0-1.5h3A1.75 1.75 0 0 1 16 2.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5A1.75 1.75 0 0 1 1.75 1h3a.75.75 0 0 1 0 1.5h-3a.25.25 0 0 0-.177.073ZM6.982 12a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5H6.982Z"></path>
</svg>
    Open with GitHub Desktop
</a></li>
<li>
  <a rel="nofollow" data-hydro-click="{&#34;event_type&#34;:&#34;clone_or_download.click&#34;,&#34;payload&#34;:{&#34;feature_clicked&#34;:&#34;DOWNLOAD_ZIP&#34;,&#34;git_repository_type&#34;:&#34;REPOSITORY&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="cd997773bda974cd6beb4a22cf9994cb9550721166beef8e175eb08a4852967e" data-ga-click="Repository, download zip, location:repo overview" data-open-app="link" data-turbo="false" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/archive/refs/heads/master.zip">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M3.5 1.75v11.5c0 .09.048.173.126.217a.75.75 0 0 1-.752 1.298A1.748 1.748 0 0 1 2 13.25V1.75C2 .784 2.784 0 3.75 0h5.586c.464 0 .909.185 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 12.25 15h-.5a.75.75 0 0 1 0-1.5h.5a.25.25 0 0 0 .25-.25V4.664a.25.25 0 0 0-.073-.177L9.513 1.573a.25.25 0 0 0-.177-.073H7.25a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5h-3a.25.25 0 0 0-.25.25Zm3.75 8.75h.5c.966 0 1.75.784 1.75 1.75v3a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1-.75-.75v-3c0-.966.784-1.75 1.75-1.75ZM6 5.25a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 6 5.25Zm.75 2.25h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM8 6.75A.75.75 0 0 1 8.75 6h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 8 6.75ZM8.75 3h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM8 9.75A.75.75 0 0 1 8.75 9h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 8 9.75Zm-1 2.5v2.25h1v-2.25a.25.25 0 0 0-.25-.25h-.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
    Download ZIP
</a></li>

          </ul>
</div>
    
</tab-container>    
</div>








      </div>
    </div>
  </details>
</get-repo>

    </span>

    <span>
      

    </span>
</p></div>




        


<div>
  <div>
    <h2>Latest commit</h2>
    <div data-issue-and-pr-hovercards-enabled="">
      
  <div>
    
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/johnma2006/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://scientiffic.medium.com/johnma2006">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/8770777?s=48&amp;v=4" width="24" height="24" alt="@johnma2006"/>
</a>  </p>
</div>

  </div>
  <div>
    <div>
          <p><a title="View all commits by johnma2006" data-hovercard-type="user" data-hovercard-url="/users/johnma2006/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commits?author=johnma2006">johnma2006</a>
    
  

        <span>
          <a data-pjax="true" data-test-selector="commit-tease-commit-message" title="Add weights_only=True to torch.load (thanks kit1980)" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f">Add weights_only=True to torch.load (thanks kit1980)</a>
        </span>
    </p></div>
    <div>
        <include-fragment accept="text/fragment+html" src="/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f/rollup?direction=sw"></include-fragment>
      <p><a href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">
        82efa90
      </a></p><a href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">
        <relative-time datetime="2023-12-20T19:15:40Z">Dec 20, 2023</relative-time>
      </a>
    </div>
  </div>
  <div>
      <div>
        <p><a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-test-selector="commit-tease-commit-message" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f">Add weights_only=True to torch.load (thanks kit1980)</a>
      </p></div>
    <p><code>82efa90</code>
    </p>
  </div>
      <div>
        <h2>Git stats</h2>
        <ul>
          <li>
            <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commits/master">
              <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path>
</svg>
              <span>
                    <strong>7</strong>
                    <span>
                      commits
                    </span>
              </span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
    <h2 id="files">Files</h2>
    


      <p><a data-hotkey="y" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/tree/82efa90919c3b5066674216f3edcebb3414a7b8f">Permalink</a></p><div data-view-component="true">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg><p>
    Failed to load latest commit information.


  
</p></div>  <div data-hpc="">
    <div role="grid" aria-labelledby="files">
      <div role="row">
        <p>Type</p>
        <p>Name</p>
        <p>Latest commit message</p>
        <p>Commit time</p>
      </div>
          <div role="row">
            

            <div role="rowheader">
              <p><span><a title="README.md" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/blob/master/README.md">README.md</a></span>
            </p></div>

            <div role="gridcell">
                <p><span>
                      <a data-pjax="true" title="Update README.md" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/32bc32650f941f6e1e4a33cf67491d6dce5d7c12">Update README.md</a>
                </span>
            </p></div>

            <p role="gridcell">
                <relative-time tense="past" datetime="2023-12-20T06:43:38-05:00" data-view-component="true">December 20, 2023 06:43</relative-time>
            </p>

          </div>
          <div role="row">
            

            <div role="rowheader">
              <p><span><a title="demo.ipynb" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/blob/master/demo.ipynb">demo.ipynb</a></span>
            </p></div>

            <div role="gridcell">
                <p><span>
                      <a data-pjax="true" title="Documentation updates" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/3dae67a44e3e542501e8ec20fa6a1004cc97b247">Documentation updates</a>
                </span>
            </p></div>

            <p role="gridcell">
                <relative-time tense="past" datetime="2023-12-20T17:18:23Z" data-view-component="true">December 20, 2023 17:18</relative-time>
            </p>

          </div>
          <div role="row">
            

            <div role="rowheader">
              <p><span><a title="model.py" data-turbo-frame="repo-content-turbo-frame" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/blob/master/model.py">model.py</a></span>
            </p></div>

            <div role="gridcell">
                <p><span>
                      <a data-pjax="true" title="Add weights_only=True to torch.load (thanks kit1980)" href="https://scientiffic.medium.com/johnma2006/mamba-minimal/commit/82efa90919c3b5066674216f3edcebb3414a7b8f">Add weights_only=True to torch.load (thanks kit1980)</a>
                </span>
            </p></div>

            <p role="gridcell">
                <relative-time tense="past" datetime="2023-12-20T19:15:40Z" data-view-component="true">December 20, 2023 19:15</relative-time>
            </p>

          </div>
    </div>
    
  </div>




</div>

  
      <readme-toc>

      <div id="readme" data-tagsearch-path="README.md" data-tagsearch-lang="Markdown">

        <div>
          <div>
              <details data-target="readme-toc.trigger" data-menu-hydro-click="{&#34;event_type&#34;:&#34;repository_toc_menu.click&#34;,&#34;payload&#34;:{&#34;target&#34;:&#34;trigger&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-menu-hydro-click-hmac="2ca7b821db75b10cbba6d8de13b1ee16473eed38368911fd272b8f676ed05cf6">
  <summary aria-haspopup="true" aria-label="Table of Contents">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M5.75 2.5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2 14a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-6a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM2 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
  </summary>


  <details-menu role="menu">
    <div>


      <div>
          <p><a role="menuitem" data-action="click:readme-toc#blur" data-targets="readme-toc.entries" data-hydro-click="{&#34;event_type&#34;:&#34;repository_toc_menu.click&#34;,&#34;payload&#34;:{&#34;target&#34;:&#34;entry&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="eb6b9e8ea2d86f535b80ebe567176362200572db43145f3f9f3a42c770a57ad6" href="#mamba-minimal">mamba-minimal</a>
          <a role="menuitem" data-action="click:readme-toc#blur" data-targets="readme-toc.entries" data-hydro-click="{&#34;event_type&#34;:&#34;repository_toc_menu.click&#34;,&#34;payload&#34;:{&#34;target&#34;:&#34;entry&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="eb6b9e8ea2d86f535b80ebe567176362200572db43145f3f9f3a42c770a57ad6" href="#demo">Demo</a>
          <a role="menuitem" data-action="click:readme-toc#blur" data-targets="readme-toc.entries" data-hydro-click="{&#34;event_type&#34;:&#34;repository_toc_menu.click&#34;,&#34;payload&#34;:{&#34;target&#34;:&#34;entry&#34;,&#34;repository_id&#34;:733879158,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="eb6b9e8ea2d86f535b80ebe567176362200572db43145f3f9f3a42c770a57ad6" href="#references">References</a>
      </p></div>
    </div>
  </details-menu>
</details>

            <h2>
              <a href="#readme" data-view-component="true">README.md</a>
            </h2>
          </div>
        </div>

          <div data-target="readme-toc.content">
            <article itemprop="text"><h2 tabindex="-1" dir="auto"><a id="user-content-mamba-minimal" aria-hidden="true" tabindex="-1" href="#mamba-minimal"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>mamba-minimal</h2>
<p dir="auto">Simple, minimal implementation of Mamba in one file of PyTorch.</p>
<p dir="auto">Featuring:</p>
<ul dir="auto">
<li>Equivalent numerical output as official implementation for both forward and backward pass</li>
<li>Simplified, readable, annotated code</li>
</ul>
<p dir="auto">Does NOT include:</p>
<ul dir="auto">
<li>Speed. The official implementation is heavily optimized, and these optimizations are core contributions of the Mamba paper. I kept most implementations simple for readability.</li>
<li>Proper parameter initialization (though this could be added without sacrificing readability)</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-demo" aria-hidden="true" tabindex="-1" href="#demo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Demo</h2>
<p dir="auto">See <a href="https://scientiffic.medium.com/johnma2006/mamba-minimal/blob/master/demo.ipynb">demo.ipynb</a> for examples of prompt completions.</p>
<div dir="auto" data-snippet-clipboard-copy-content="from model import Mamba
from transformers import AutoTokenizer

model = Mamba.from_pretrained(&#39;state-spaces/mamba-370m&#39;)
tokenizer = AutoTokenizer.from_pretrained(&#39;EleutherAI/gpt-neox-20b&#39;)

generate(model, tokenizer, &#39;Mamba is the&#39;)"><pre><span>from</span> <span>model</span> <span>import</span> <span>Mamba</span>
<span>from</span> <span>transformers</span> <span>import</span> <span>AutoTokenizer</span>

<span>model</span> <span>=</span> <span>Mamba</span>.<span>from_pretrained</span>(<span>&#39;state-spaces/mamba-370m&#39;</span>)
<span>tokenizer</span> <span>=</span> <span>AutoTokenizer</span>.<span>from_pretrained</span>(<span>&#39;EleutherAI/gpt-neox-20b&#39;</span>)

<span>generate</span>(<span>model</span>, <span>tokenizer</span>, <span>&#39;Mamba is the&#39;</span>)</pre></div>
<blockquote>
<p dir="auto">Mamba is the world&#39;s longest venomous snake with an estimated length of over 150 m. With such a large size and a venomous bite, Mamba kills by stabbing the victim (which is more painful and less effective than a single stab of the bite)</p>
</blockquote>
<p dir="auto">150 meters... 🫢 scary!</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-references" aria-hidden="true" tabindex="-1" href="#references"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References</h2>
<p dir="auto">The Mamba architecture was introduced in <a href="https://arxiv.org/abs/2312.00752" rel="nofollow">Mamba: Linear-Time Sequence Modeling with Selective State Spaces</a> by <a href="https://twitter.com/_albertgu?lang=en" rel="nofollow">Albert Gu</a> and <a href="https://twitter.com/tri_dao?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" rel="nofollow">Tri Dao</a>.</p>
<p dir="auto">The official implementation is here: <a href="https://github.com/state-spaces/mamba/tree/main">https://github.com/state-spaces/mamba/tree/main</a></p>
</article>
          </div>
      </div>

  </readme-toc>


</div></div>
  </body>
</html>
