<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.kdab.com/cxx-qt/">Original</a>
    <h1>CXX-Qt: safe Rust bindings for Qt</h1>
    
    <div id="readability-page-1" class="page"><div>
                            

							<p>At KDAB, we have been investigating how to integrate Rust with Qt in a safe and idiomatic way. The solution we are currently working on is called <a href="https://github.com/KDAB/cxx-qt/">CXX-Qt.</a> It’s available in the <a href="https://github.com/KDAB/cxx-qt/">GitHub</a> and on <a href="https://crates.io/crates/cxx-qt">crates.io</a>. This blog post discusses the journey of CXX-Qt — where it started, where it can be used right now, and the future direction of the project. If you would like to get started with code examples, visit our <a href="https://kdab.github.io/cxx-qt/book/">Rust book</a>.</p>
<h2>Why Rust?</h2>
<p>Over the past few years, Rust has been gaining popularity in various sectors, from embedded devices to scalable web services. It brings the promise of performance, reliability, and productivity to every sector into which it has been introduced. In addition, Rust is useful from a security perspective due to its memory safety. For instance, a substantial amount of security issues in large-scale C or C++ projects tends to be <a href="https://www.chromium.org/Home/chromium-security/memory-safety/">memory-related</a>. By using Rust, we reduce these kinds of issues while maintaining a level of performance that is on-par with other native languages, like C or C++, and far faster compared to most other memory-safe languages.</p>
<h2>Where Would Rust Be Useful with Qt?</h2>
<p>Typical Qt QML applications are composed of multiple parts:</p>
<ul>
<li>C++ plugins that provide models and represent the business logic</li>
<li>QML, which defines the layout and components of the GUI</li>
<li>JavaScript, for scripting in QML</li>
</ul>
<p>Rust has a rich ecosystem of libraries for (de)serialization, async futures, parsing unsafe inputs, threading, etc. The ability to integrate these Rust libraries into your Qt application makes a compelling story. Therefore, enhancing your C++ plugins and business logic is the most suitable use case for Rust. Due to QML’s fast iteration speed and flexibility, we recommend sticking with it for the layout and components of the GUI.</p>
<p><img loading="lazy" src="https://www.kdab.com/wp-content/uploads/stories/1-1-300x146.png" alt="Rust Qt" width="981" height="477" srcset="https://www.kdab.com/wp-content/uploads/stories/1-1-300x146.png 300w, https://www.kdab.com/wp-content/uploads/stories/1-1-1024x499.png 1024w, https://www.kdab.com/wp-content/uploads/stories/1-1-1536x748.png 1536w, https://www.kdab.com/wp-content/uploads/stories/1-1-2048x997.png 2048w, https://www.kdab.com/wp-content/uploads/stories/1-1-300x146@2x.png 600w" sizes="(max-width: 981px) 100vw, 981px"/></p>
<h2>Existing Solutions</h2>
<p>There are many techniques for combining Rust with Qt, each utilizing different ways to bind between Rust and Qt. We found that most solutions tend to have one or more of these problems:</p>
<ul>
<li>Direct bindings that are not idiomatic to Rust and only provide direct access to the C++ API</li>
<li>Calls between C++ and Rust that are unsafe</li>
<li>They don’t make use of Rust’s strong multi-threading guarantees or features</li>
<li>They don’t have a license that suits the Rust ecosystem</li>
<li>The attempt to use Rust for the whole application rather than just a plugin</li>
<li>No code generation; developers need to manually define the bindings</li>
</ul>
<p><img loading="lazy" src="https://www.kdab.com/wp-content/uploads/stories/2-300x148.png" alt="Rust Qt" width="969" height="478" srcset="https://www.kdab.com/wp-content/uploads/stories/2-300x148.png 300w, https://www.kdab.com/wp-content/uploads/stories/2-1024x506.png 1024w, https://www.kdab.com/wp-content/uploads/stories/2-1536x759.png 1536w, https://www.kdab.com/wp-content/uploads/stories/2-2048x1011.png 2048w, https://www.kdab.com/wp-content/uploads/stories/2-300x148@2x.png 600w" sizes="(max-width: 969px) 100vw, 969px"/></p>
<h2>Our Solution</h2>
<p>Rather than simply providing bindings for the existing C++ API, <a href="https://github.com/KDAB/cxx-qt/">CXX-Qt</a> makes use of Qt’s strong object orientation and meta object system. The library allows you to define new QObject subclasses in Rust as a module. These can then be instantiated like any other QObject in QML, or even C++, if needed.</p>
<p>Every QObject defined by CXX-Qt is made up of two parts:</p>
<ul>
<li>A C++-based QObject instance that stores and exposes properties and invokable methods</li>
<li>A Rust struct that implements any invokables, manages internal state, and handles change requests from properties or background threads</li>
</ul>
<p><a href="https://github.com/KDAB/cxx-qt/">CXX-Qt</a> then uses a library called <a href="https://cxx.rs/">CXX</a> to communicate between Rust and C++. CXX is also being explored by large companies, such as Google, with <a href="https://github.com/google/autocxx">autocxx</a>. In comparison to normal bindings, <a href="https://cxx.rs/">CXX</a> creates a bridge between Rust and C++ that is based on a safe subset of the two languages. By using procedural macros, we hide the details of the <a href="https://cxx.rs/">CXX</a> bridge from you as a developer. We also provide a library of common Qt types that can cross the C++ &lt;-&gt; Rust bridge safely. We furthermore provide mechanisms for Rust background threads to notify and safely update the Qt state on the Qt thread.</p>
<p>All of this results in very idiomatic and safe Rust code that can seamlessly interact with existing Qt/C++ and Rust code.</p>
<p>The disadvantage of this approach is that we do not provide one-to-one bindings. Therefore, <a href="https://github.com/KDAB/cxx-qt/">CXX-Qt</a> needs to expose and implement every feature across the bridge. However, as the main focus of our solution is moving a C++ module to Rust, we believe that, for a majority of cases, we will be providing either a QObject or a model to QML and then exposing properties, invokables, and signals on these objects.</p>
<p><img loading="lazy" src="https://www.kdab.com/wp-content/uploads/stories/3-1-300x128.png" alt="Rust Qt" width="968" height="413" srcset="https://www.kdab.com/wp-content/uploads/stories/3-1-300x128.png 300w, https://www.kdab.com/wp-content/uploads/stories/3-1-1024x438.png 1024w, https://www.kdab.com/wp-content/uploads/stories/3-1-1536x657.png 1536w, https://www.kdab.com/wp-content/uploads/stories/3-1-2048x876.png 2048w, https://www.kdab.com/wp-content/uploads/stories/3-1-300x128@2x.png 600w" sizes="(max-width: 968px) 100vw, 968px"/></p>
<h2>Current State and Future Direction</h2>
<p><a href="https://github.com/KDAB/cxx-qt">CXX-Qt</a> is not production-ready or stable and is still a work-in-progress. We welcome any feedback on the direction of the project and features and/or any suggestions you may have.</p>
<p>Currently, the existing code is able to perform the following tasks:</p>
<ul>
<li>Define properties and invokables, exposing them onto a QObject</li>
<li>Use common Qt types</li>
<li>Listen for property changes or handle update requests from background Rust threads</li>
</ul>
<p>In the future, we plan to add the following tasks/features:</p>
<ul>
<li>Other Qt base classes (such as QAbstractItemModel)</li>
<li>Stabilize the API of macros and improve the API of Qt types</li>
<li>Define and emit signals</li>
<li>Expand the documentation to include tutorials and examples</li>
</ul>
<p>If you would like to contribute, the code is available at <a href="https://github.com/KDAB/cxx-qt">https://github.com/KDAB/cxx-qt</a> and documentation can be found at <a href="https://kdab.github.io/cxx-qt/book">https://kdab.github.io/cxx-qt/book</a>.</p>
<p>Please feel free to share any suggestions or questions in the blog comments or, if you prefer, send us an email at <a href="mailto:info@kdab.com">info@kdab.com</a>.</p>
<div>
	<p>About KDAB</p>
	<div>
	<p>If you like this article and want to read similar material, consider subscribing via <a href="https://www.kdab.com/category/blogs/feed/">our RSS feed</a>.</p>
	
	<p>Subscribe to <a href="https://www.youtube.com/kdabtv">KDAB TV</a> for similar informative short video content. </p>
	
	<p>KDAB provides market leading software consulting and development <a href="https://www.kdab.com/software-services/">services</a>  and <a href="https://www.kdab.com/software-services/scheduled-training/programming-with-qt/">training</a> in Qt, C++ and 3D/OpenGL. <a href="mailto:sales@kdab.com?subject=Blog callout enquiry">Contact us</a>.</p>
	</div>
</div> 

							

							
							
						</div></div>
  </body>
</html>
