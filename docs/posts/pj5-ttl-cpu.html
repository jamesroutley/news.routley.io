<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pj5cpu.wordpress.com/">Original</a>
    <h1>PJ5 TTL CPU</h1>
    
    <div id="readability-page-1" class="page"><div id="content">

	<div id="primary">
		<main id="main" role="main">

		
						
				
<article id="post-429">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>We‚Äôve managed to do some more work on the display and I‚Äôm really happy to say we‚Äôve got two bits of code running on it, the game of life and the Mandelbrot generator.</p>



<figure><div>
<div><p><iframe title="PJ5 CPU running Game of Life &amp; Mandelbrot" width="842" height="474" src="https://www.youtube.com/embed/z2ul44h0-m8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div></figure>



<p>We do have a problem with the display, currently sending data faster than 500KHz causes random junk to appear, we also get corrupt memory, we think some of this is due to the long ribbon cable (~500mm in length) so we need to do more investigation on this. So we‚Äôve been using the speed switching capability of the CPU so that the calculations can be done at 2MIPS and then switch to the slower 500KIPS for writing to the display. The calculations are being done at 2MIPS to decrease the corruption in RAM, at 4MIPS with the display attached a lot of corruption happens, even at 2MIPS you can still see some.</p>



<p>I‚Äôve also built a second set of main boards and tested them, so we should soon be able to have two of these CPUs, one at my house and one at Jons. We need to rework the bus board, the clock and the code memory boards which shouldn‚Äôt take long, but work is starting on planning the peripherals now. </p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-416">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>Things have been a little hectic for both Jon and myself lately, we both work for Space Forge and as you may be aware we had our first Launch with Virgin Orbit from Cornwall earlier in January and sadly it didn‚Äôt go well.</p>



<p>But, we‚Äôre back doing various bits and bobs. Jon has made a programmer and tester for his TL311 compatible ‚Äúchips‚Äù.</p>



<figure data-carousel-extra="{&#34;blog_id&#34;:178577373,&#34;permalink&#34;:&#34;https:\/\/pj5cpu.wordpress.com\/2023\/01\/28\/its-been-a-while-an-update\/&#34;}">
<figure><img data-attachment-id="420" data-permalink="https://pj5cpu.wordpress.com/2023/01/28/its-been-a-while-an-update/20221209_213938/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg" data-orig-size="2312,1734" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1670621979&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;1250&#34;,&#34;shutter_speed&#34;:&#34;0.05&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20221209_213938" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=842" width="1024" height="768" data-id="420" src="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=2048 2048w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20221209_213938.jpg?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>
<figcaption>TIL311 programmer and tester</figcaption></figure>



<p>You can see one of his TIL311 replacements in the ZIF socket. As you may be aware TIL311s aren‚Äôt easily available, they‚Äôre also red in colour, Jon wants his to be the same orange as the LEDs on our PCBs, so that‚Äôs what he‚Äôs done. They work really well and look great. He may chose to open source them and perhaps even make a few to sell. The challenge though is the resin casting, I‚Äôm not sure how we‚Äôll accomplish that, if at all.</p>



<p>I‚Äôve also been working on the display as you can see from previous posts, and I‚Äôm happy to report that after a bit of debugging we managed to get a picture up.</p>



<figure data-carousel-extra="{&#34;blog_id&#34;:178577373,&#34;permalink&#34;:&#34;https:\/\/pj5cpu.wordpress.com\/2023\/01\/28\/its-been-a-while-an-update\/&#34;}">
<figure><img data-attachment-id="423" data-permalink="https://pj5cpu.wordpress.com/2023/01/28/its-been-a-while-an-update/20230126_215950/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg" data-orig-size="1734,2312" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1674770390&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;50&#34;,&#34;shutter_speed&#34;:&#34;0.02&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20230126_215950" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=768" width="768" height="1024" data-id="423" src="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=768" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=1536 1536w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_215950.jpg?w=225 225w" sizes="(max-width: 768px) 100vw, 768px"/></figure>
<figcaption>sort of a fox in very trippy colours</figcaption></figure>



<p>And yes, it‚Äôs our fox, but it‚Äôs a bit of a mess, this we traced down to a dodgy ‚Äúamazon‚Äù socket, when Jon puts his finger on the board we get the correct colours. Lesson learned, cheap on amazon means it‚Äôs not going to be 100%. The timing isn‚Äôt quite right so we are getting some artefacts which we‚Äôll look at and hopefully resolved. But for now I need to make another PCB with decent quality connectors!</p>



<figure data-carousel-extra="{&#34;blog_id&#34;:178577373,&#34;permalink&#34;:&#34;https:\/\/pj5cpu.wordpress.com\/2023\/01\/28\/its-been-a-while-an-update\/&#34;}">
<figure><img data-attachment-id="425" data-permalink="https://pj5cpu.wordpress.com/2023/01/28/its-been-a-while-an-update/20230126_214927/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg" data-orig-size="1734,2312" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1674769767&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;50&#34;,&#34;shutter_speed&#34;:&#34;0.01&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20230126_214927" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=768" width="768" height="1024" data-id="425" src="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=768" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=1536 1536w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2023/01/20230126_214927.jpg?w=225 225w" sizes="(max-width: 768px) 100vw, 768px"/></figure>
<figcaption>Almost a correct fox</figcaption></figure>



<p>So, we‚Äôre going to finish doing all the mods to the various boards and then we‚Äôre going to figure out what peripherals we want on the peripheral section, we know we want a joystick interface, a sound card and also a true random number generator, I‚Äôm sure there will be more bits (possibly UART?) but more on that at a later date.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-402">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>The display board arrived and I built it up, and I‚Äôm really happy to say that the picture is now rock solid and stable, no ghosting or jittering, I knew that breadboard was the cause üôÇ</p>



<p>Here are some pictures, starting with a colour palette showing all 256 colours, and then how it looks with the filter on.</p>



<figure data-carousel-extra="{&#34;blog_id&#34;:178577373,&#34;permalink&#34;:&#34;https:\/\/pj5cpu.wordpress.com\/2022\/10\/25\/display-2nd-board-builds\/&#34;}">
<figure><img data-attachment-id="407" data-permalink="https://pj5cpu.wordpress.com/2022/10/25/display-2nd-board-builds/20221022_160737/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg" data-orig-size="6928,9248" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1666454852&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;50&#34;,&#34;shutter_speed&#34;:&#34;0.0053763440860215&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20221022_160737" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=767" loading="lazy" width="767" height="1023" data-id="407" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=767" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=767 767w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=1534 1534w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160737.jpg?w=225 225w" sizes="(max-width: 767px) 100vw, 767px"/><figcaption>RGB palette</figcaption></figure>
</figure>



<figure data-carousel-extra="{&#34;blog_id&#34;:178577373,&#34;permalink&#34;:&#34;https:\/\/pj5cpu.wordpress.com\/2022\/10\/25\/display-2nd-board-builds\/&#34;}">
<figure><img data-attachment-id="406" data-permalink="https://pj5cpu.wordpress.com/2022/10/25/display-2nd-board-builds/20221022_161110/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg" data-orig-size="6928,9248" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1666455067&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;250&#34;,&#34;shutter_speed&#34;:&#34;0.02&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20221022_161110" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=767" loading="lazy" width="767" height="1023" data-id="406" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=767" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=767 767w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=1534 1534w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_161110.jpg?w=225 225w" sizes="(max-width: 767px) 100vw, 767px"/><figcaption>With the filter</figcaption></figure>



<figure><img data-attachment-id="408" data-permalink="https://pj5cpu.wordpress.com/2022/10/25/display-2nd-board-builds/20221022_160802/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg" data-orig-size="6928,9248" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1666454879&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;125&#34;,&#34;shutter_speed&#34;:&#34;0.02&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20221022_160802" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=767" loading="lazy" width="767" height="1023" data-id="408" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=767" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=767 767w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=1534 1534w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20221022_160802.jpg?w=225 225w" sizes="(max-width: 767px) 100vw, 767px"/><figcaption>With the Filter</figcaption></figure>
</figure>



<p>I have to say the filter just makes this display look utterly stunning. The next steps are for me to finish the display board and then hook it up to the hardware and run some tests on it, exciting!</p>



<p>Currently only one PJ5 CPU exists and it‚Äôs at Jons house, so I‚Äôve begun assembling my set of boards (register board, special register, program counter, instruction decode and divider currently) and as I build them I‚Äôll be testing them with the system at Jons and then begin assembling my own PJ5.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-395">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>We‚Äôve not been quite so busy of late, Work for me has been busy and also for Jon, so we‚Äôve kind of slipped a bit. The chip shortage also isn‚Äôt helping as we need to remake a couple of boards to remove mod wires but until we can get parts again, it‚Äôs sort of difficult.</p>



<p>In the meantime I have been working on the 64√ó64 256 colour display and have managed to get it displaying something from it‚Äôs RAM. Yes it‚Äôs our fox üôÇ</p>



<figure><img data-attachment-id="398" data-permalink="https://pj5cpu.wordpress.com/2022/10/08/delays-and-progress/20220917_155456/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg" data-orig-size="6928,9248" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;SM-A536B&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1663430093&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;5.23&#34;,&#34;iso&#34;:&#34;50&#34;,&#34;shutter_speed&#34;:&#34;0.0075187969924812&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="20220917_155456" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=225" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=767" loading="lazy" width="767" height="1023" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=767" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=767 767w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=1534 1534w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=112 112w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/10/20220917_155456.jpg?w=225 225w" sizes="(max-width: 767px) 100vw, 767px"/></figure>



<p>It‚Äôs not quite correct as the length of the wires and also the breadboard are causing problems, so I need to make a PCB that will interface directly with the display, but I‚Äôm happy to see the fox there üôÇ</p>



<p>Jon has also made some major improvements to the emulator, including a significant boost in speed and some extra debug features. I made a little video here.</p>



<figure><div>
<div><p><iframe title="PJ5CPU Emulation Update" width="842" height="632" src="https://www.youtube.com/embed/p3HfSq0c9HY?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div></figure>



<p>So we haven‚Äôt abonded the project we are still working on it but all be it slightly slower due to a lot of other things going on in our day to day lives.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-389">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>I finished modifying the Clock board and we finally had a chance to test it. It all works aside from one feature.</p>



<p>We also implemented a Hellorld (knight rider edition) in homage the excellent work that <a href="https://www.youtube.com/c/Nakazoto">Usagi electric</a> is doing on his channel with his centurion mini computer.</p>



<p>Here‚Äôs a video, enjoy üôÇ</p>



<figure><div>
<div><p><iframe title="PJ5 Clock Board and Hellorld!" width="842" height="474" src="https://www.youtube.com/embed/-qPy9ntTjf0?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div></figure>



<p>The emulator is now running at around 640Khz in real time, which will make debugging and testing code a little easier.</p>



<p>Next steps, fix the clock on reset bug, then remove the mod wires on various boards with redesigns and then work on the 64 x 64 RGB display.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-381">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>The new clock board arrived and, well, I made a few mistakes. But over all it functions as expected. So lets run through it</p>



<figure><img data-attachment-id="382" data-permalink="https://pj5cpu.wordpress.com/2022/06/19/clock-board/img_20220618_1738074/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg" data-orig-size="3176,1232" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;1.8&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;BBF100-6&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1655573887&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;3.89&#34;,&#34;iso&#34;:&#34;250&#34;,&#34;shutter_speed&#34;:&#34;0.03030303030303&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="img_20220618_1738074" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=842" loading="lazy" width="1024" height="397" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=2048 2048w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/06/img_20220618_1738074.jpg?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>The big difference you‚Äôll notice is that we‚Äôve gone for a simpler select of speed. Rather than having a low/hi switch and 16 sub divisions, we‚Äôve picked 10 speeds, ranging from 0.3Hz up to 4MHz. Now we have two speeds and you can select between them by pushing the speed button (the speed changes once the result has been stored, so there‚Äôs no risk of corruption). We‚Äôve also added CPU control of the speed, the original idea was to be able to drop to a lower speed when writing to certain peripherals and then switch back to a high speed for the maincalculations.</p>



<p>We‚Äôve also implemented the ‚ÄúBoot Pause‚Äù function, as our SRAM based program memory takes a second or so to copy from flash to RAM the main clock has to be paused whilst this is happening, so a line comes in from the program memory board which does this.</p>



<p>The ‚Äúsuspend‚Äù instruction now drops the clock from RUN mode to pause mode, from where you can single step. This should help with debugging code, particularly where you only get a problem after a long portion of code or number of loop iterrations.</p>



<p>We also improved the debouncing of the switches using a simple transistor monostable circuit.</p>



<p>There are a few mod wires on this board as you can see, but the board now functions as we wanted. The next step will be to hook it up to the hardware and try it üôÇ</p>




			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
	<figure>
		<a href="https://pj5cpu.wordpress.com/2022/04/17/part-supplies-and-game-of-life/" rel="bookmark"><img width="842" height="304" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=842" alt="" decoding="async" loading="lazy" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=842 842w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=1684 1684w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=1024 1024w" sizes="(max-width: 842px) 100vw, 842px" data-attachment-id="370" data-permalink="https://pj5cpu.wordpress.com/clock-pcb-v2-1/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png" data-orig-size="2981,1077" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="clock-pcb-v2-1" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=842"/></a>
	</figure>
<article id="post-365">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>Well, things were going so well, but sadly the part shortages have caught up with us.</p>



<p>Let‚Äôs explain where we are, we now have a fully functioning PJ5 CPU, however starting it requires a bit of jiggery pokery as you have to let the Fast Rom boot first before you can excute code, this is do-able on the existing one, but far from practical.</p>



<p>So we designed a new Clock board with all these wizzy new features;</p>



<figure><img data-attachment-id="370" data-permalink="https://pj5cpu.wordpress.com/clock-pcb-v2-1/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png" data-orig-size="2981,1077" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="clock-pcb-v2-1" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=842" loading="lazy" width="1024" height="369" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=1021 1021w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=2043 2043w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/clock-pcb-v2-1.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>New improved clock board</figcaption></figure>



<p>Now we‚Äôve hit a supply problem, I‚Äôm struggling to find some of the gates we use (1G57, 1G58 and 1G74), all of which seem to be out of stock and on lead times that reach to November, so at this stage I‚Äôm unsure what to do next. I might be able to salvage some of these from old boards, but is there enough? Do we redesign the board using quad logic gates?</p>



<p>Whilst I‚Äôm well aware of the part shortages in the world, I wasn‚Äôt expecting it in such low level logic parts.</p>



<p>I‚Äôve taken a picture of PJ5 as it stands from above and then annotated it for everyone who‚Äôs interested.</p>



<figure><img data-attachment-id="372" data-permalink="https://pj5cpu.wordpress.com/pj5_above_words_202204/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg" data-orig-size="2048,1365" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="pj5_above_words_202204" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=842" loading="lazy" width="1024" height="682" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=2046 2046w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/pj5_above_words_202204.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>Annotated PJ5</figcaption></figure>



<p>The plan is to redo the bus board and move the Bus displays back on it, then move the instruction decode, program counters, etc up giving us a nice even form factor again.</p>



<p>In other news I have managed to complete game of life in assenbly on the PJ5 emulator which I‚Äôm really pleased about, here are some pictures; </p>



<figure><img data-attachment-id="374" data-permalink="https://pj5cpu.wordpress.com/gol_start-gen/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png" data-orig-size="424,450" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="gol_start-gen" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png?w=283" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png?w=424" loading="lazy" width="424" height="450" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png?w=424" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png 424w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png?w=141 141w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_start-gen.png?w=283 283w" sizes="(max-width: 424px) 100vw, 424px"/><figcaption>Starting image</figcaption></figure>



<figure><img data-attachment-id="376" data-permalink="https://pj5cpu.wordpress.com/gol_1st-gen/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png" data-orig-size="419,449" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="gol_1st-gen" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png?w=280" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png?w=419" loading="lazy" width="419" height="449" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png?w=419" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png 419w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png?w=140 140w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_1st-gen.png?w=280 280w" sizes="(max-width: 419px) 100vw, 419px"/><figcaption>1st generation</figcaption></figure>



<figure><img data-attachment-id="377" data-permalink="https://pj5cpu.wordpress.com/gol_2nd-gen/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png" data-orig-size="425,448" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="gol_2nd-gen" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png?w=285" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png?w=425" loading="lazy" width="425" height="448" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png?w=425" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png 425w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png?w=142 142w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_2nd-gen.png?w=285 285w" sizes="(max-width: 425px) 100vw, 425px"/><figcaption>2nd generation</figcaption></figure>



<figure><img data-attachment-id="378" data-permalink="https://pj5cpu.wordpress.com/gol_3rd-gen/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png" data-orig-size="422,447" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="gol_3rd-gen" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png?w=283" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png?w=422" loading="lazy" width="422" height="447" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png?w=422" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png 422w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png?w=142 142w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/04/gol_3rd-gen.png?w=283 283w" sizes="(max-width: 422px) 100vw, 422px"/><figcaption>3rd Generation</figcaption></figure>



<p>We‚Äôll post updates when we find a solution to the chip shortages which are preventing us from making the clock boards, stay tuned!</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-358">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>My apologies for the late posting, it‚Äôs been a busy few months. But we have been busy.</p>



<p>First up we got the Fast ROM board and programmer working, which is wonderful.</p>



<figure><div>
<div><p><iframe title="PJ5 CPU Fast ROM and Programmer" width="842" height="474" src="https://www.youtube.com/embed/4TA18U0P3uA?list=PLqTn11YkMSMxu0p4yKBcYW34_R2fK80yI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div><figcaption><em>Fast Rom board and programmer</em></figcaption></figure>



<p>The board works by having a piece of flash which holds the code when powered off, there are then 3 fast 8bit SRAMs which are filled when you power up. </p>



<p>Now Jon decided that the programmer we needed should also be a TTL based CPU. So we have a USB to parallel chip from FTDI and from there Jons code allows us to upload to the flash and read from the flash.</p>



<p>The other really nice thing is that it seems to run faster than the FPGA based ROM we were using before, it‚Äôs also a lot more convenient to write code, assemble it, then upload it (rather than having to wrap it in VHDL and build the FPGA files and program it).</p>



<p>We‚Äôve also been busy with the emulator!</p>



<p>Jon has done a superb job of reworking it and added a whole bunch of features.</p>



<figure><img data-attachment-id="362" data-permalink="https://pj5cpu.wordpress.com/emulator/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png" data-orig-size="1851,1646" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="emulator" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=842" loading="lazy" width="1024" height="910" src="https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2022/03/emulator.png 1851w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>PJ5 Emulator</figcaption></figure>



<p>Firstly we can now see the disassembled code, with labels.</p>



<p>All of these make the emulator really great for debugging complex programs (i‚Äôve been battling with game of life).</p>



<p>Next up is the Clock PCB rework to include the interaction needed to work with the new fast ROM board.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-349">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>One of the two things we wanted to do with our PJ5 CPU is generate a Mandelbrot set, now keep in mind we don‚Äôt have a C compiler yet and this is an 8bit CPU.</p>



<p>So I speant a long time (many many evenings and weekends) trying to get the Mandebrot to generate on our emulator. I mean, a lot of time.</p>



<figure><img src="https://pbs.twimg.com/media/FFTxoE8WYAINi6x?format=jpg&amp;name=small" alt="Image"/><figcaption>Errr, not right</figcaption></figure>



<p>Some of the bugs where in the emulator and some in the code (oh the joy of debugging two bits of code that depend on the other!).</p>



<figure><img data-attachment-id="353" data-permalink="https://pj5cpu.wordpress.com/emulator-screenshot/" data-orig-file="https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png" data-orig-size="1378,1363" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="emulator-screenshot" data-image-description="" data-image-caption="" data-medium-file="https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=300" data-large-file="https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=842" loading="lazy" width="1024" height="1012" src="https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=1024" alt="" srcset="https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=1024 1024w, https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=150 150w, https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=300 300w, https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png?w=768 768w, https://pj5cpu.wordpress.com/wp-content/uploads/2021/12/emulator-screenshot.png 1378w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>YAY! successful on on the emulator</figcaption></figure>



<p>So next up was getting it to run on the actual hardware, and after finding a small bug with the hardware (the busboard was missing a link as it was designed for the older Special register board) and it lived! and what a surprise, it‚Äôs blindingly fast, under 3 seconds at 2MIPS!!! I expected it to take like 10 minutes!</p>



<figure><div>
<div><p><iframe title="PJ5 TTL CPU running Mandelbrot + update on our fast ROM board" width="842" height="474" src="https://www.youtube.com/embed/8j01IAWs7I0?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div><figcaption>Youtube video</figcaption></figure>



<p>Now this was done in assembler rather than C or basic, and we‚Äôre not using floating point. But we are using 16bit signed math, without any lookup tables and this is still an 8bit processor built from discrete logic chips.</p>



<p>Why so fast compared to a 6502/Z80 ? several reasons really, firstly we have 16 registers, (though a large portion of thevariables where stored in RAM as we just didn‚Äôt have enough), secondly we run one instruction per clock cycle (for a 6502 there is at least 2 clock cycles per instruction) and thirdly we have a hardware 8√ó8 multiplier. I suspect the latter is the primary reason for the speed.</p>



<h2 id="fast-rom-board">Fast ROM board</h2>



<p>In the video we also show Fast ROM board, this uses a peice of flash and when the PJ5 is reset it copies the flash to RAM and then allows the CPU to run. Now it‚Äôs not quite working yet, but it‚Äôs a revision one board so that‚Äôs to be expected. So we‚Äôll debug it, add mod wires and then spin a new version.</p>



<p>This is a really important board for us as it will remove the FPGA we‚Äôre currently using for the ROM.</p>



<h2 id="next-steps">Next steps</h2>



<p>We‚Äôre busy working on the fast ROM board, we‚Äôre also going to respin the clock board, with a bigger knob and to include the extra functionality (pause until fast ROM is ready and speed switch). </p>



<p>We‚Äôre also looking at a better display, again using logic, but something with more consistant colour and brightness matching.</p>



<p>Then there‚Äôs things like audio, joystick, serial and so on to add in. So we have a way to go yet, but I‚Äôm super pleased with where we have gotten to in 18 months.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				
<article id="post-342">
			<span></span>
		<!-- .entry-header -->

		<div>
		
<p>Well, we did it‚Ä¶ we cracked 4MIPS on our TTL CPU.</p>



<p>I have to admit I‚Äôm both relieved and surprised. The key parts to achieving this was to decrease the latency for the instruction decode and also the flag register writing. The time to decode an instruction, perform a bit of math and then write to the flags was at around 270nS.</p>



<p>However (you knew there was a ‚Äúbut‚Äù coming didn‚Äôt you?) the external display (text and RGB dot matrix) does sometimes ‚Äúglitch‚Äù at 4MIPS, but at 2MIPs is rock solid.</p>



<figure><div>
<div><p><iframe title="PJ5 TTL CPU Hits 4 million instructions per second!" width="842" height="474" src="https://www.youtube.com/embed/pi9lUlTTbj8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p></div>
</div><figcaption>PJ5 CPU running at 4MIPS</figcaption></figure>



<p>The new instruction board includes a few new commands, things like storeimm which stores an immediate value to a location in memory (rather than a regular store which stores the value of a register to memory) and also more branch options, things like branch if greater, branch if less than and so on.</p>



<p>So the next bits we need to work on are;</p>



<p>After that, we need to look at the display and make it brighter, possibly see if we can improve it‚Äôs speed.</p>



<p>Then we need to build some more code (other than our test code).</p>



<p>it‚Äôs take us nearly 18 months to get here, and it‚Äôs been an adventure with lots of ups and downs, but it‚Äôs so wonderful to see it finally working at a speed we never imagined and with zero mod wires.</p>
			</div><!-- .entry-content -->
	
	<!-- .entry-meta -->
</article><!-- #post-## -->

			
				<nav role="navigation">
		
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div></div>
  </body>
</html>
