<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/richardhapb/pytest.nvim">Original</a>
    <h1>Pytest for Neovim</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/138641726/415509747-4405219d-1c18-4086-9f84-a47dd60c67c5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDM4Nzc2MjksIm5iZiI6MTc0Mzg3NzMyOSwicGF0aCI6Ii8xMzg2NDE3MjYvNDE1NTA5NzQ3LTQ0MDUyMTlkLTFjMTgtNDA4Ni05Zjg0LWE0N2RkNjBjNjdjNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDA1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQwNVQxODIyMDlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mMTExZTE1MmFhMzRkZjMyNDNhYzM1MWM2NzkzMGM0OWRmYWYwZDdmMWM5Y2RhZWZkMDM2YjBkZTM4NWM4OTZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.pPlV4cEPOxUSqpsrV4I2ugxrz3FzmUAKAovZYMk2O3A"><img width="885" alt="image" src="https://private-user-images.githubusercontent.com/138641726/415509747-4405219d-1c18-4086-9f84-a47dd60c67c5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDM4Nzc2MjksIm5iZiI6MTc0Mzg3NzMyOSwicGF0aCI6Ii8xMzg2NDE3MjYvNDE1NTA5NzQ3LTQ0MDUyMTlkLTFjMTgtNDA4Ni05Zjg0LWE0N2RkNjBjNjdjNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDA1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQwNVQxODIyMDlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mMTExZTE1MmFhMzRkZjMyNDNhYzM1MWM2NzkzMGM0OWRmYWYwZDdmMWM5Y2RhZWZkMDM2YjBkZTM4NWM4OTZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.pPlV4cEPOxUSqpsrV4I2ugxrz3FzmUAKAovZYMk2O3A"/></a>

<p dir="auto">Testing integrated in neovim with pytest. Include Docker support. This project is in progress, I will be adding more features in the future and I open to contributions.</p>

<p dir="auto">These instructions will help you set up and use <code>pytest.nvim</code> in your Neovim environment.</p>

<ul dir="auto">
<li>Neovim 0.5.0 or later</li>
<li>pytest in your environment (pip install pytest)</li>
</ul>

<ol dir="auto">
<li>
<p dir="auto">Install the <code>pytest.nvim</code> plugin using your preferred plugin manager:</p>
<p dir="auto">Lazyvim:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;richardhapb/pytest.nvim&#34;,
  opts = {}
}"><pre>{
  <span><span>&#34;</span>richardhapb/pytest.nvim<span>&#34;</span></span>,
  <span>opts</span> <span>=</span> {}
}</pre></div>
<p dir="auto">Packer:</p>
<div dir="auto" data-snippet-clipboard-copy-content="use {
  &#34;richardhapb/pytest.nvim&#34;,
  opt = true
}"><pre><span>use</span> {
  <span><span>&#34;</span>richardhapb/pytest.nvim<span>&#34;</span></span>,
  <span>opt</span> <span>=</span> <span>true</span>
}</pre></div>
<p dir="auto">Vim-Plug:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plug &#39;richardhapb/pytest.nvim&#39;"><pre>Plug <span><span>&#39;</span>richardhapb/pytest.nvim<span>&#39;</span></span></pre></div>
</li>
</ol>

<ol dir="auto">
<li>
<p dir="auto">Load the <code>pytest</code> plugin in your Neovim configuration if you haven&#39;t already done so. For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="require(&#39;pytest&#39;).setup()"><pre><span>require</span>(<span><span>&#39;</span>pytest<span>&#39;</span></span>).<span>setup</span>()</pre></div>
</li>
<li>
<p dir="auto">Use the <code>:Pytest</code> command to run the tests in the current buffer.</p>
<ul dir="auto">
<li>
<p dir="auto">To check the entire buffer:</p>

</li>
<li>
<p dir="auto">To check the output of the tests:</p>

</li>
<li>
<p dir="auto">You can attach the test to the current buffer, this runs test on save:</p>

</li>
<li>
<p dir="auto">You can detach the test from the current buffer:</p>

</li>
<li>
<p dir="auto">Docker enable on the way</p>

</li>
<li>
<p dir="auto">Docker disabled on the way</p>

</li>
</ul>
</li>
</ol>
<p dir="auto">The default keybinding that runs <code>:Pytest</code> is <code>&lt;leader&gt;T</code>.</p>

<p dir="auto">The plugin provides the following default keymap:</p>
<ul dir="auto">
<li><code>&lt;leader&gt;TT</code> - Run pytest for the current file (normal mode)</li>
<li><code>&lt;leader&gt;Ta</code> - Attach pytest to the current buffer (normal mode)</li>
<li><code>&lt;leader&gt;Td</code> - Detach pytest from the current buffer (normal mode)</li>
</ul>
<hr/>
<p dir="auto">Default settings, is not necessary to set up, but you can change the settings in your configuration file.</p>
<div dir="auto" data-snippet-clipboard-copy-content="require &#39;pytest&#39;.setup {
   docker = {
      enabled = true,  -- Enable docker support
      container = &#39;app-1&#39;,  -- Container where the tests will be run
      docker_path = &#39;/usr/src/app&#39;,  -- This is the default path, if you use docker compose this is obtained from the docker compose file
      docker_path_prefix = &#39;app&#39;, -- This is the prefix for the path in the cwd in your local, for example: root/app/&lt;docker_app_content&gt;
      docker_compose_file = &#39;docker-compose.yml&#39;,  -- This is the default docker compose file name
      docker_compose_service = &#39;app&#39;,  -- This is for looking for the docker path in docker compose
      enable_docker_compose = true,  -- Enable docker compose support
   },

   -- You can overwrite this callback with your custom keymaps,
   -- this is called when open a Python file and buffer number is passed as an argument
   keymaps_callback = function(bufnr)
      vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;TT&#39;, &#39;&lt;CMD&gt;Pytest&lt;CR&gt;&#39;, { buffer = bufnr, desc = &#39;Run Pytest&#39; })
      vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;Ta&#39;, &#39;&lt;CMD&gt;PytestAttach&lt;CR&gt;&#39;, { buffer = bufnr, desc = &#39;Attach Pytest to buffer&#39; })
      vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;Td&#39;, &#39;&lt;CMD&gt;PytestDetach&lt;CR&gt;&#39;, { buffer = bufnr, desc = &#39;Detach Pytest&#39; })
   end
}"><pre><span>require</span> <span><span>&#39;</span>pytest<span>&#39;</span></span>.<span>setup</span> {
   <span>docker</span> <span>=</span> {
      <span>enabled</span> <span>=</span> <span>true</span>,  <span><span>--</span> Enable docker support</span>
      <span>container</span> <span>=</span> <span><span>&#39;</span>app-1<span>&#39;</span></span>,  <span><span>--</span> Container where the tests will be run</span>
      <span>docker_path</span> <span>=</span> <span><span>&#39;</span>/usr/src/app<span>&#39;</span></span>,  <span><span>--</span> This is the default path, if you use docker compose this is obtained from the docker compose file</span>
      <span>docker_path_prefix</span> <span>=</span> <span><span>&#39;</span>app<span>&#39;</span></span>, <span><span>--</span> This is the prefix for the path in the cwd in your local, for example: root/app/&lt;docker_app_content&gt;</span>
      <span>docker_compose_file</span> <span>=</span> <span><span>&#39;</span>docker-compose.yml<span>&#39;</span></span>,  <span><span>--</span> This is the default docker compose file name</span>
      <span>docker_compose_service</span> <span>=</span> <span><span>&#39;</span>app<span>&#39;</span></span>,  <span><span>--</span> This is for looking for the docker path in docker compose</span>
      <span>enable_docker_compose</span> <span>=</span> <span>true</span>,  <span><span>--</span> Enable docker compose support</span>
   },

   <span><span>--</span> You can overwrite this callback with your custom keymaps,</span>
   <span><span>--</span> this is called when open a Python file and buffer number is passed as an argument</span>
   <span>keymaps_callback</span> <span>=</span> <span>function</span>(<span>bufnr</span>)
      <span>vim</span>.<span>keymap</span>.<span>set</span>(<span><span>&#39;</span>n<span>&#39;</span></span>, <span><span>&#39;</span>&lt;leader&gt;TT<span>&#39;</span></span>, <span><span>&#39;</span>&lt;CMD&gt;Pytest&lt;CR&gt;<span>&#39;</span></span>, { <span>buffer</span> <span>=</span> <span>bufnr</span>, <span>desc</span> <span>=</span> <span><span>&#39;</span>Run Pytest<span>&#39; </span></span>})
      <span>vim</span>.<span>keymap</span>.<span>set</span>(<span><span>&#39;</span>n<span>&#39;</span></span>, <span><span>&#39;</span>&lt;leader&gt;Ta<span>&#39;</span></span>, <span><span>&#39;</span>&lt;CMD&gt;PytestAttach&lt;CR&gt;<span>&#39;</span></span>, { <span>buffer</span> <span>=</span> <span>bufnr</span>, <span>desc</span> <span>=</span> <span><span>&#39;</span>Attach Pytest to buffer<span>&#39; </span></span>})
      <span>vim</span>.<span>keymap</span>.<span>set</span>(<span><span>&#39;</span>n<span>&#39;</span></span>, <span><span>&#39;</span>&lt;leader&gt;Td<span>&#39;</span></span>, <span><span>&#39;</span>&lt;CMD&gt;PytestDetach&lt;CR&gt;<span>&#39;</span></span>, { <span>buffer</span> <span>=</span> <span>bufnr</span>, <span>desc</span> <span>=</span> <span><span>&#39;</span>Detach Pytest<span>&#39; </span></span>})
   <span>end</span>
}</pre></div>
<p dir="auto">Options can be callbacks, for example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="require &#39;pytest&#39;.setup {
   docker = {
      enabled = function()
         return vim.fn.getcwd():match(&#34;.*/(.*)$&#34;) == &#34;work&#34;  -- Only enable docker if the last dir of cwd is &#34;work&#34;
      end,

      container = function()
         local app = utils.get_my_awesome_app()
         return app .. &#39;-version-2&#39;
      end
   },
}"><pre><span>require</span> <span><span>&#39;</span>pytest<span>&#39;</span></span>.<span>setup</span> {
   <span>docker</span> <span>=</span> {
      <span>enabled</span> <span>=</span> <span>function</span>()
         <span>return</span> <span>vim</span>.<span>fn</span>.<span>getcwd</span>():<span>match</span>(<span><span>&#34;</span>.*/(.*)$<span>&#34;</span></span>) <span>==</span> <span><span>&#34;</span>work<span>&#34;  </span></span><span><span>--</span> Only enable docker if the last dir of cwd is &#34;work&#34;</span>
      <span>end</span>,

      <span>container</span> <span>=</span> <span>function</span>()
         <span>local</span> <span>app</span> <span>=</span> <span>utils</span>.<span>get_my_awesome_app</span>()
         <span>return</span> <span>app</span> <span>..</span> <span><span>&#39;</span>-version-2<span>&#39;</span></span>
      <span>end</span>
   },
}</pre></div>
</article></div></div>
  </body>
</html>
