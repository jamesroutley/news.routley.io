<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://deno.com/blog/2023-06-25-outage-post-mortem">Original</a>
    <h1>June 25th, 2023 Deno Deploy Postmortem</h1>
    
    <div id="readability-page-1" class="page"><div><p>On June 25th, 2023, at 09:42 UTC a large chunk of Deno Deploy services
experienced a service disruption until approximately 10:26 UTC (44 minutes).
During this period users could not access projects hosted on Deno Deploy, access
Deno web properties such as deno.com, or download modules hosted on <code>deno.land</code>.</p>
<p>Customers making use of Deno Deploy Subhosting were not affected by this outage.</p>
<p>Our commitment to providing a stable and robust platform to our users is our
topmost priority. We deeply regret this incident and sincerely apologize for any
disruption caused. This report provides an overview of the event, the cause of
the outage, and measures we plan to take to prevent such instances in the
future.</p>
<h2 id="impact"><a aria-hidden="true" tabindex="-1" href="#impact"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Impact</h2><p>During a 44-minute period, users experienced a service disruption and could not
access key Deno web properties and deployments on Deno Deploy, including
<code>deno.com</code> and <code>deno.land</code>.</p>
<h2 id="timeline-of-events"><a aria-hidden="true" tabindex="-1" href="#timeline-of-events"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Timeline of Events</h2><p><em>All times in UTC, on June 25th 2023.</em></p>
<ul>
<li>09:42 - DDOS attack begins</li>
<li>09:43 - Alerts are triggered and teams are paged</li>
<li>09:46 - Team member get online to find root issue.</li>
<li>09:47 - Logs indicate queries to database are rate limited.</li>
<li>10:14 - DDOS attack ends</li>
<li>10:26 - All alerts are resolved. Majority of our systems were recovered.</li>
<li>11:02 - Incident is marked as resolved.</li>
</ul>
<p>We estimate a downtime of approximately 44 minutes from when our systems first
started failing until full recovery was achieved.</p>
<h2 id="root-cause"><a aria-hidden="true" tabindex="-1" href="#root-cause"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Root cause</h2><p>On Sunday, June 25, a DDOS attack was mounted agains one of the web properties
hosted on Deno Deploy. During this time we saw a request rate that is about 10
times higher than normal during this time of day. Our systems responded to this
by initially rejecting requests to the affected domain, and by scaling up. Due
to the attack volume, a large number of processing nodes had to be brought
online at the same time. Each of these nodes require a small amount of metadata
that gets pulled from a central database. Unfortunately our database was unable
to handle the query load associated with this, which resulted in some nodes
coming online much slower than expected, while others would time out while
waiting for their start-up payload and subsequently rebooted themselves, which
exacerbated the load on our database further.</p>
<h2 id="whats-next"><a aria-hidden="true" tabindex="-1" href="#whats-next"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What’s next?</h2><p>We’re taking some steps to prevent this problem in the future:</p>
<ul>
<li>The processing capacity of the central database has been increased
significantly.</li>
<li>The start-up payload will be cached across the globe to remove the
single-point-of-failure dependency on our central database.</li>
<li>Processing nodes will be allowed to operate from (slightly) stale data in case
the latest boot payload is unavailable for any reason.</li>
<li>In the coming weeks, we will conduct additional load tests to ensure that our
systems can withstand a sudden load spike of the magnitude that we saw during
this event.</li>
</ul>
<p><em>Have questions, suggestions or other thoughts?
<a href="https://github.com/denoland/deploy_feedback/issues" rel="noopener noreferrer">Feel free to drop us a line</a>.</em></p>
</div></div>
  </body>
</html>
