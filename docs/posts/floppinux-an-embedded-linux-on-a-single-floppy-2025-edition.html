<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://krzysztofjankowski.com/floppinux/floppinux-2025.html">Original</a>
    <h1>Floppinux ‚Äì An Embedded Linux on a Single Floppy, 2025 Edition</h1>
    
    <div id="readability-page-1" class="page"><div>
      <header>
        
        <h2>An Embedded üêßLinux on a Single üíæFloppy</h2>
        <h2>2025 Edition (v0.3.1)</h2>
        
        <nav>
          <span>December 21, 2025</span> |
          <a href="https://krzysztofjankowski.com/floppinux/">back to home</a>
        </nav>
<blockquote>
<p>FLOPPINUX was released in 2021. After four years people find it
helpful. Because of that I decided to revisit FLOPPINUX in 2025 and make
updated tutorial. This brings bunch of updates like latest kernel and
persistent storage.</p>
</blockquote>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#main-project-goals">Main Project Goals</a></li>
<li><a href="#linux-kernel">Linux Kernel</a></li>
<li><a href="#64-bit-base-os">64-bit Base OS</a></li>
<li><a href="#working-directory">Working Directory</a></li>
<li><a href="#system-requirements">System Requirements</a></li>
<li><a href="#kernel">Kernel</a></li>
<li><a href="#toolset">Toolset</a></li>
<li><a href="#filesystem">Filesystem</a></li>
<li><a href="#boot-image">Boot Image</a></li>
<li><a href="#floppy-disk">Floppy Disk</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#download">Download</a></li>
</ul>
<h2 id="main-project-goals">Main Project Goals</h2>
<p>Think of this as Linux From Scratch but for making single floppy
distribution.</p>
<blockquote>
<p>It is meant to be a full workshop (tutorial) that you can follow
easily and modify it to your needs. It is a learning exercise. Some base
Linux knowledge is needed.</p>
</blockquote>
<p>The final distribution is very simple and consists only of minimum of
tools and hardware support. As a user you will be able to boot any PC
with a floppy drive to a Linux terminal, edit files, and create simple
scripts. There is 264KB of space left for your newly created files.</p>
<h3 id="core-features">Core features:</h3>
<ul>
<li>Fully working distribution booting from the single floppy</li>
<li>Latest* Linux kernel</li>
<li>Supporting all 32-bit x86 CPUs since Intel 486DX</li>
<li>Have a working text editor (Vi) and basic file manipulation commands
(move, rename, delete, etc.)</li>
<li>Support for simple scripting</li>
<li>Persistent storage on the floppy to actualy save files (264KB)</li>
<li>Works on real hardware and emulation</li>
</ul>
<h3 id="minimum-hardware-requirements">Minimum Hardware
Requirements:</h3>
<ul>
<li>Intel 486DX 33MHz</li>
<li>20MB RAM</li>
<li>Internal floppy disk</li>
</ul>
<h2 id="linux-kernel">Linux Kernel</h2>
<p>The Linux kernel drops i486 support in 6.15 (released May 2025), so
<strong>6.14</strong> (released March 2025) is the latest version with
full compatibility.</p>
<h2 id="bit-base-os">64-bit Base OS</h2>
<p>This time I will do everything on <strong>Omarchy</strong> Linux. It
is 64-bit operating system based on Arch Linux. Instructions should work
on all POSIX systems. Only difference is getting needed packages.</p>
<h2 id="working-directory">Working Directory</h2>
<p>Create directory where you will keep all the files.</p>
<div id="cb1"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span>mkdir</span> ~/my-linux-distro/</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span>BASE</span><span>=</span>~/my-linux-distro/</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span>cd</span> <span>$BASE</span></span></code></pre></div>
<h2 id="host-os-requirements">Host OS Requirements</h2>
<blockquote>
<p>You need supporting software to build things. This exact list may
vary depending on the system you have.</p>
</blockquote>
<p>Install needed software/libs. On Arch/Omarchy 3.1:</p>
<div id="cb2"><pre><code><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span>sudo</span> pacman <span>-S</span> ncurses bc flex bison syslinux cpio</span></code></pre></div>
<p>Cross-compiler:</p>
<div id="cb3"><pre><code><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span>wget</span> https://musl.cc/i486-linux-musl-cross.tgz</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span>tar</span> xvf i486-linux-musl-cross.tgz</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span>rm</span> i486-linux-musl-cross.tgz</span></code></pre></div>
<h3 id="emulation">Emulation</h3>
<blockquote>
<p>86Box is also good but slower. Bochs is the best but for debugging,
not needed here.</p>
</blockquote>
<p>For emulation I will be using qemu.</p>

<h2 id="kernel">Kernel</h2>
<p>Get the sources for the latest compatible <strong>kernel
6.14.11</strong>:</p>
<div id="cb5"><pre><code><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span>git</span> clone <span>--depth</span><span>=</span>1 <span>--branch</span> v6.14.11 https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span>cd</span> linux</span></code></pre></div>
<p>Now, that you have them in <strong>linux/</strong> directory lets
configure and build our custom kernel. First create tiniest base
configuration:</p>

<blockquote>
<p>This is a bootstrap with absolute minimum features. Just enough to
boot the system. We want a little bit more.</p>
</blockquote>
<p>Add additonal config settings on top of it:</p>

<p>Important: Do not uncheck anything in options unless specified so.
Some of those options are important. You can uncheck but on your own
risk.</p>
<p>From menus choose those options:</p>
<ul>
<li>General Setup
<ul>
<li>Configure standard kernel features (expert users)
<ul>
<li>Enable support for printk</li>
</ul></li>
<li>Initial RAM filesystem and RAM disk (initramfs/initrd)
<ul>
<li>Support initial ramdisk/ramfs compressed using XZ and
<strong>uncheck everything else</strong></li>
</ul></li>
</ul></li>
<li>Processor type and features
<ul>
<li>x86 CPU resources control support</li>
<li>Processor family
<ul>
<li>486DX</li>
</ul></li>
</ul></li>
<li>Enable the block layer</li>
<li>Executable file formats
<ul>
<li>Kernel support for ELF binaries</li>
<li>Kernel support for scripts starting with #!</li>
</ul></li>
<li>Device Drivers
<ul>
<li>Block devices
<ul>
<li>Normal floppydisk support</li>
<li>RAM block device support
<ul>
<li>Default number of RAM disk: 1</li>
</ul></li>
</ul></li>
<li>Character devices
<ul>
<li>Enable TTY</li>
</ul></li>
</ul></li>
<li>File systems
<ul>
<li>DOS/FAT/EXFAT/NT Filesystems
<ul>
<li>MSDOS fs support</li>
</ul></li>
<li>Pseudo filesystems
<ul>
<li>/proc file system support</li>
<li>sysfs file system support</li>
</ul></li>
<li>Native language support
<ul>
<li>Codepage 437</li>
</ul></li>
</ul></li>
<li>Library routines
<ul>
<li>XZ decompression and <strong>uncheck everything under
it</strong></li>
</ul></li>
</ul>
<p>Exit configuration (yes, save settings to .config).</p>
<p>Time for compiling!</p>
<h3 id="compile-kernel">Compile Kernel</h3>
<div id="cb8"><pre><code><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span>make</span> ARCH=x86 bzImage <span>-j</span><span>$(</span><span>nproc</span><span>)</span></span></code></pre></div>
<p>This will take a while depending on the speed of your CPU. In the end
the kernel will be created in <strong>arch/x86/boot/</strong> as
<strong>bzImage</strong> file.</p>
<p>Move kernel to our <strong>main directory</strong> and <strong>go
back to it</strong>:</p>
<div id="cb9"><pre><code><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span>mv</span> arch/x86/boot/bzImage ../</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span>cd</span> ..</span></code></pre></div>

<p>Without tools kernel will just boot and you will not be able to do
anything. One of the most popular lightweight tools is BusyBox. It
replaces the standard GNU utilities with way smaller but still
functional alternatives, perfect for embedded needs.</p>
<p>Get the <strong>1.36.1</strong> version from busybox.net or Github
mirror. Download the file, extract it, and change directory:</p>
<blockquote>
<p>Remember to be in the working directory.</p>
</blockquote>
<div id="cb10"><pre><code><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span>wget</span> https://github.com/mirror/busybox/archive/refs/tags/1_36_1.tar.gz</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span>tar</span> xzvf 1_36_1.tar.gz</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span>rm</span> 1_36_1.tar.gz</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span>cd</span> busybox-1_36_1/</span></code></pre></div>
<p>As with kernel you need to create starting configuration:</p>
<div id="cb11"><pre><code><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span>make</span> ARCH=x86 allnoconfig</span></code></pre></div>
<blockquote>
<p>You may skip this following fix if you are building on
Debian/Fedora</p>
</blockquote>
<p>Fix for <strong>Arch Linux based distributions</strong>:</p>
<div id="cb12"><pre><code><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span>sed</span> <span>-i</span> <span>&#39;s/main() {}/int main() {}/&#39;</span> scripts/kconfig/lxdialog/check-lxdialog.sh</span></code></pre></div>
<blockquote>
<p>Now the fun part. You need to <strong>choose what tools you
want</strong>. Each menu entry will show how much more KB will be taken
if you choose it. So choose it wisely :) For the first time use my
selection.</p>
</blockquote>
<p>Run the configurator:</p>

<p>Choose the following options. Remember to <strong>do not
uncheck</strong> anything if not stated here.</p>
<ul>
<li>Settings
<ul>
<li>Support files
<ul>
<li>2GB</li>
</ul></li>
<li>Build static binary (no shared libs)</li>
</ul></li>
<li>Coreutils
<ul>
<li>cat</li>
<li>cp</li>
<li>df</li>
<li>echo</li>
<li>ls</li>
<li>mkdir</li>
<li>mv</li>
<li>rm</li>
<li>sync</li>
<li>test
<ul>
<li>test as [</li>
<li>test as [[</li>
</ul></li>
</ul></li>
<li>Console Utilities
<ul>
<li>clear</li>
</ul></li>
<li>Editors
<ul>
<li>vi</li>
</ul></li>
<li>Init Utilities
<ul>
<li>init
<ul>
<li><strong>uncheck</strong> everything else (inside init: keep [*] only
on init in this page)</li>
</ul></li>
</ul></li>
<li>Linux System Utilities
<ul>
<li>mdev</li>
<li>mount
<ul>
<li>Support lots of -o flags</li>
<li><strong>uncheck</strong> evrything else</li>
</ul></li>
<li>umount</li>
</ul></li>
<li>Miscellaneous Utilities
<ul>
<li><strong>uncheck</strong> readahead</li>
</ul></li>
<li>Shells
<ul>
<li>Choose alias as (ash)</li>
<li>ash</li>
<li>Optimize for size instead of speed</li>
<li>Alias support <!--- Help support--></li>
</ul></li>
</ul>
<p>Now exit with save config.</p>
<h3 id="cross-compiler-setup">Cross Compiler Setup</h3>
<blockquote>
<p>Our target system needs to be 32-bit. To compile it on 64-bit system
we need a cross compiler. You can setup this by hand in the menuconfig
or just copy and paste those four lines.</p>
</blockquote>
<p>Setup paths:</p>
<div id="cb14"><pre><code><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span>sed</span> <span>-i</span> <span>&#34;s|.*CONFIG_CROSS_COMPILER_PREFIX.*|CONFIG_CROSS_COMPILER_PREFIX=</span><span>\&#34;</span><span>${BASE}</span><span>/i486-linux-musl-cross/bin/i486-linux-musl-</span><span>\&#34;</span><span>|&#34;</span> .config</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span>sed</span> <span>-i</span> <span>&#34;s|.*CONFIG_SYSROOT.*|CONFIG_SYSROOT=</span><span>\&#34;</span><span>${BASE}</span><span>/i486-linux-musl-cross</span><span>\&#34;</span><span>|&#34;</span> .config</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span>sed</span> <span>-i</span> <span>&#34;s|.*CONFIG_EXTRA_CFLAGS.*|CONFIG_EXTRA_CFLAGS=-I</span><span>$BASE</span><span>/i486-linux-musl-cross/include|&#34;</span> .config</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span>sed</span> <span>-i</span> <span>&#34;s|.*CONFIG_EXTRA_LDFLAGS.*|CONFIG_EXTRA_LDFLAGS=-L</span><span>$BASE</span><span>/i486-linux-musl-cross/lib|&#34;</span> .config</span></code></pre></div>
<h3 id="compile-busybox">Compile BusyBox</h3>
<p>Build tools and create base filesystem (‚Äúinstall‚Äù). It will ask for
options, just <strong>press enter</strong> for default for all of
them.</p>
<div id="cb15"><pre><code><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span>make</span> ARCH=x86 <span>-j</span><span>$(</span><span>nproc</span><span>)</span> <span>&amp;&amp;</span> <span>make</span> ARCH=x86 install</span></code></pre></div>
<p>This will create a filesystem with all the files at **_install/**.
Move it to our main directory. I like to rename it to.</p>
<p>Lastly to to that new directory.</p>
<div id="cb16"><pre><code><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span>mv</span> _install ../filesystem</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span>cd</span> ../filesystem</span></code></pre></div>
<h2 id="filesystem">Filesystem</h2>
<p>You got kernel and basic tools but the system still needs some
additional directory structure.</p>
<blockquote>
<p>This created minimum viable directory structure for satisfying the
basic requirements of a Linux system.</p>
</blockquote>
<blockquote>
<p>Remember to be in the filesystem/ directory.</p>
</blockquote>
<div id="cb17"><pre><code><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span>mkdir</span> <span>-pv</span> <span>{dev</span><span>,</span><span>proc</span><span>,</span><span>etc/init.d</span><span>,</span><span>sys</span><span>,</span><span>tmp</span><span>,</span><span>home}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span>sudo</span> mknod dev/console c 5 1</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span>sudo</span> mknod dev/null c 1 3</span></code></pre></div>
<p>Next step is to add minimum configuration files. First one is a
welcome message that will be shown after booting.</p>
<blockquote>
<p>Here is the first real opportunity to go wild and make this your own
signature.</p>
</blockquote>
<div id="cb18"><pre><code><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span>cat</span> <span>&gt;&gt;</span> welcome <span>&lt;&lt; EOF</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span>Your welome message or ASCII art.</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span>EOF</span></span></code></pre></div>
<p>Or download my welcome file.</p>
<div id="cb19"><pre><code><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span>wget</span> https://krzysztofjankowski.com/floppinux/downloads/0.3.1/welcome</span></code></pre></div>
<p>It looks like that:</p>
<pre><code>$ cat welcome

                _________________
               /_/ FLOPPINUX  /_/;
              / &#39; boot disk  &#39; //
             / &#39;------------&#39; //
            /   .--------.   //
           /   /         /  //
          .___/_________/__//   1440KiB
          &#39;===\_________\==&#39;   3.5&#34;

_______FLOPPINUX_V_0.3.1 __________________________________
_______AN_EMBEDDED_SINGLE_FLOPPY_LINUX_DISTRIBUTION _______
_______BY_KRZYSZTOF_KRYSTIAN_JANKOWSKI ____________________
_______2025.12 ____________________________________________</code></pre>
<blockquote>
<p>Back to serious stuff. Inittab tells the system what to do in
critical states like starting, exiting and restarting. It points to the
initialization script rc that is the first thing that our OS will run
before dropping into the shell.</p>
</blockquote>
<p>Create an inittab file:</p>
<div id="cb21"><pre><code><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span>cat</span> <span>&gt;&gt;</span> etc/inittab <span>&lt;&lt; EOF</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span>::sysinit:/etc/init.d/rc</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span>::askfirst:/bin/sh</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span>::restart:/sbin/init</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span>::ctrlaltdel:/sbin/reboot</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span>::shutdown:/bin/umount -a -r</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span>EOF</span></span></code></pre></div>
<p>And the init rc script:</p>
<div id="cb22"><pre><code><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span>cat</span> <span>&gt;&gt;</span> etc/init.d/rc <span>&lt;&lt; EOF</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span>#!/bin/sh</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span>mount -t proc none /proc</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span>mount -t sysfs none /sys</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span>mdev -s</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span>ln -s /proc/mounts /etc/mtab</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span>mkdir -p /mnt /home</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span>mount -t msdos -o rw /dev/fd0 /mnt</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span>mkdir -p /mnt/data</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span>mount --bind /mnt/data /home</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span>clear</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span>cat welcome</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span>cd /home</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span>/bin/sh</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span>EOF</span></span></code></pre></div>
<p>Make the script executable and owner of all files to root:</p>
<div id="cb23"><pre><code><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span>chmod</span> +x etc/init.d/rc</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span>sudo</span> chown <span>-R</span> root:root .</span></code></pre></div>
<p>Compress this directory into one file. Then go back to working
directory.</p>
<div id="cb24"><pre><code><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span>find</span> . <span>|</span> <span>cpio</span> <span>-H</span> newc <span>-o</span> <span>|</span> <span>xz</span> <span>--check</span><span>=</span>crc32 <span>--lzma2</span><span>=</span>dict=512KiB <span>-e</span> <span>&gt;</span> ../rootfs.cpio.xz</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span>cd</span> ..</span></code></pre></div>
<p>Create booting configuration.</p>
<blockquote>
<p>Another place to tweak parameters for your variant. Text after SAY is
what will be displayed on the screen as first, usualy a name of the
OS.</p>
</blockquote>
<blockquote>
<p>The tsc=unstable is useful on some (real) computers to get rid of
randomly shown warnings about Time Stamp Counter.</p>
</blockquote>
<blockquote>
<p>Remember to be in the working directory.</p>
</blockquote>
<div id="cb25"><pre><code><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span>cat</span> <span>&gt;&gt;</span> syslinux.cfg <span>&lt;&lt; EOF</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span>DEFAULT floppinux</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span>LABEL floppinux</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span>SAY [ BOOTING FLOPPINUX VERSION 0.3.1 ]</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span>KERNEL bzImage</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span>INITRD rootfs.cpio.xz</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span>APPEND root=/dev/ram rdinit=/etc/init.d/rc console=tty0 tsc=unstable</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span>EOF</span></span></code></pre></div>
<p>Make it executable:</p>

<p>Create sample file</p>
<blockquote>
<p>To make the system a little bit more user friendly I like to have a
sample file that user will be able to read and edit. You can put
anything you want in it. A simple help would be also a good idea to
include.</p>
</blockquote>
<div id="cb27"><pre><code><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span>cat</span> <span>&gt;&gt;</span> hello.txt <span>&lt;&lt; EOF</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span>Hello, FLOPPINUX user!</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span>EOF</span></span></code></pre></div>
<p>Filesystem is ready. Final step is to <strong>put this all on a
floppy</strong>!</p>
<h2 id="boot-image">Boot Image</h2>
<p>First we need an empty file in exact size of a floppy disk. Then
format and make it bootable.</p>
<p>Create empty floppy image:</p>
<div id="cb28"><pre><code><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span>dd</span> if=/dev/zero of=floppinux.img bs=1k count=1440</span></code></pre></div>
<p>Format it and create bootloader:</p>
<div id="cb29"><pre><code><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span>mkdosfs</span> <span>-n</span> FLOPPINUX floppinux.img</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span>syslinux</span> <span>--install</span> floppinux.img</span></code></pre></div>
<p>Mount it and copy syslinux, kernel, and filesystem onto it:</p>
<div id="cb30"><pre><code><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span>sudo</span> mount <span>-o</span> loop floppinux.img /mnt</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span>sudo</span> mkdir /mnt/data</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span>sudo</span> cp hello.txt /mnt/data/</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span>sudo</span> cp bzImage /mnt</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span>sudo</span> cp rootfs.cpio.xz /mnt</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span>sudo</span> cp syslinux.cfg /mnt</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span>sudo</span> umount /mnt</span></code></pre></div>
<p>Done!</p>
<h3 id="test-in-emulator">Test in emulator</h3>
<p>It‚Äôs good to test before wasting time for the real floppy to
burn.</p>
<p>Boot the new OS in qemu:</p>
<div id="cb31"><pre><code><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span>qemu-system-i386</span> <span>-fda</span> floppinux.img <span>-m</span> 20M <span>-cpu</span> 486</span></code></pre></div>
<p>If it worked that means You have successfully created your own
distribution! Congratulations!</p>
<p>The <strong>floppinux.img</strong> image is ready to burn onto a
floppy and boot on real hardware!</p>
<h2 id="floppy-disk">Floppy Disk</h2>
<h3 id="important">&lt;!&gt; Important &lt;!&gt;</h3>
<p>Change XXX to floppy drive name in your system. In my case it is
<strong>sdb</strong>. Choosing wrongly will NUKE YOUR PARTITION and
REMOVE all of your files! Think twice. Or use some GUI application for
that.</p>
<div id="cb32"><pre><code><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span>sudo</span> dd if=floppinux.img of=/dev/XXX bs=512 conv=notrunc,sync,fsync oflag=direct status=progress</span></code></pre></div>
<p>After 5 minutes I got freshly burned floppy.</p>
<h2 id="summary">Summary</h2>
<ul>
<li>FLOPPINUX: <strong>0.3.1</strong> (December 2025)</li>
<li>Linux Kernel: <strong>6.14.11</strong></li>
<li>Busybox: <strong>1.36.1</strong></li>
<li>Image size: 1440KiB / 1.44MiB</li>
<li>Kernel size: 881KiB (bzImage)</li>
<li>Tools: 137KiB (rootfs.cpio.xz)</li>
<li>Free space left (df -h): <strong>253KiB</strong></li>
</ul>
<h3 id="system-tools">System Tools</h3>
<h4 id="file-directory-manipulation">File &amp; Directory
Manipulation</h4>
<ul>
<li><code>cat</code> - display file contents</li>
<li><code>cp</code> - copy files and directories</li>
<li><code>mv</code> - move/rename files and directories</li>
<li><code>rm</code> - remove files and directories</li>
<li><code>ls</code> - list directory contents</li>
<li><code>mkdir</code> - creates directory</li>
</ul>
<h4 id="system-information-management">System Information &amp;
Management</h4>
<ul>
<li><code>df -h</code> - display filesystem disk space usage</li>
<li><code>sync</code> - force write of buffered data to disk - use this
after any changes to the floppy filesystem</li>
<li><code>mount</code> - mount filesystems</li>
<li><code>umount</code> - unmount filesystems</li>
</ul>
<h4 id="text-processing-output">Text Processing &amp; Output</h4>
<ul>
<li><code>echo</code> - display text output</li>
<li><code>more</code> - page through text output</li>
</ul>
<h4 id="utilities">Utilities</h4>
<ul>
<li><code>clear</code> - clear terminal screen</li>
<li><code>test</code> - evaluate conditional expressions</li>
</ul>
<h3 id="applications">Applications</h3>
<ul>
<li><code>vi</code> - text editor</li>
</ul>
<h2 id="download">Download</h2>
<ul>
<li><a href="http://krzysztofjankowski.com/floppinux/downloads/0.3.1/floppinux.img">FLOPPINUX
0.3.1 Floppy Image 1.44MB</a></li>
</ul>
<hr/>
</header></div></div>
  </body>
</html>
