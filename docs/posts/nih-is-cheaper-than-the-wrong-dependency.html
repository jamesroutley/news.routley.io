<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lewiscampbell.tech/blog/250718.html">Original</a>
    <h1>NIH is cheaper than the wrong dependency</h1>
    
    <div id="readability-page-1" class="page"><div>
				
				<p>(Title written with apologies to <a href="https://sandimetz.com/blog/2016/1/20/the-wrong-abstraction">Sandi Metz.</a>)</p>
<p>One of the biggest fallacies in coding is that dependencies have zero downsides. It&#39;s treated as free functionality you don&#39;t have to write yourself. Wow, what a deal!</p>
<p>But dependencies absolutely have a cost.</p>
<ul>
<li>They may require a significant time investment to learn to use. Often they&#39;re so large and complex that simply writing the functionality yourself is faster than learning. Sometimes it&#39;s easier to write it yourself than <em>install</em> the dependency...</li>
<li>Their breaking changes can trigger expensive re-writes of your own code to handle a new interface.</li>
<li>You need to ensure they end up on your clients&#39; machine.</li>
</ul>
<p>Let us consider this last point; how many absurdly complicated containerisation or bundling setups do we encounter in our work because someone does not want to &#34;reinvent the wheel&#34; and instead opts to use large, complex dependencies? How many times did people take the time to appreciate they&#39;ve re-invented an entirely different wheel that has nothing to do with their apps core functionality, just to deploy and run the bloody thing?</p>
<p>Instructive here is <a href="https://github.com/tigerbeetle/tigerbeetle/blob/main/docs/TIGER_STYLE.md?trk=public_post_comment-text#dependencies">Tigerbeetle</a>, a financial database written entirely with Vanilla Zig:</p>
<blockquote>
<p>TigerBeetle <strong>has a “zero dependencies” policy</strong>, apart from the Zig toolchain. Dependencies, in general, inevitably lead to supply chain attacks, safety and performance risk, and slow install times. For foundational infrastructure in particular, the cost of any dependency is further amplified throughout the rest of the stack.</p>
</blockquote>
<blockquote>
<p>Similarly, tools have costs. A small standardized toolbox is simpler to operate than an array of specialized instruments each with a dedicated manual. Our primary tool is Zig. It may not be the best for everything, but it&#39;s good enough for most things. We invest into our Zig tooling to ensure that we can tackle new problems quickly, with a minimum of accidental complexity in our local development environment.</p>
</blockquote>
<h2>A Framework for Evaluating Dependencies</h2>
<p>I am aware this post is a <em>reductio ad absurdum</em> magnet. &#34;What so you make your own silicon wafers?&#34;, etc, etc. (Programmers of a certain generation might bring up a webcomic and butterflies).
Ultimately, we all depend on something. But not all dependencies are created equal. Allow me to introduce my Framework for Evaluating Dependencies.</p>
<p>We have five categories:</p>
<dl>
  <dt>Ubiquity</dt>
  <dd>How widely available is it? Are target environments likely to have it pre-installed? Will we need to complicate deployment with containerisation or bundling?</dd>
  
  <dt>Stability</dt>
  <dd>How frequent are breaking changes, deprecations, or shifts in the &#34;meta&#34;?</dd>
  
  <dt>Depth</dt>
  <dd>How much functionality lies beneath the API/interface? How much harder would it be to do without the dependency?</dd>
  
  <dt>Ergonomics</dt>
  <dd>Is the abstraction provided declarative? Is the API pleasant to use?</dd>
  
  <dt>Watertightness</dt>
  <dd>Does the abstraction leak? How often must you consider the underlying technology?</dd>
</dl>

<p>Dependency peddlers typically only talk about ergonomics, and ignore other criteria.</p>
<p>With that in mind, let&#39;s evaluate some dependencies:</p>
<h2>Good Dependencies</h2>
<h3>POSIX System Calls</h3>
<dl>
  <dt>Ubiquity</dt>
  <dd>Can be used on Linux, Android, macOS, BSDs, etc.</dd>
  <dt>Stability</dt>
  <dd>Extremely stable, breaking changes are rare.</dd>
  <dt>Depth</dt>
  <dd>Incredibly deep. A single <code>open</code> call hides hundreds of thousands of lines of kernel code.</dd>
  <dt>Ergonomics</dt>
  <dd>Mediocre. Uses many flags and old school C conventions, but not terrible.</dd>
  <dt>Watertightness</dt>
  <dd>Mostly good, though storage devices can have their own conception of what &#34;persisted&#34; means.</dd>
</dl>

<h3>ECMA-48 Terminal Control Codes</h3>
<dl>
  <dt>Ubiquity</dt>
  <dd>Other than cmd.exe in windows I can&#39;t think of a major terminal emulator that doesn&#39;t respond to these.</dd>
  <dt>Stability</dt>
  <dd>No changes to the standard since 1991.</dd>
  <dt>Depth</dt>
  <dd>The alternative I think would be to make your own standard for a character framebuffer. Not an impossible task but a bit much to spin off for a project.</dd>
  <dt>Ergonomics</dt>
  <dd>Not all that bad, if you can ignore the line noise of the Esc character.</dd>
  <dt>Watertightness</dt>
  <dd>Very good. Very rarely do you need to care about what hardware your terminal emulator is running on.</dd>
</dl>

<h3>The Web Platform (Web APIs, HTML, JS, CSS etc)</h3>
<dl>
  <dt>Ubiquity</dt>
  <dd>The web browser is the most widely deployed document rendered/app platform/virtual machine on earth. They&#39;re everywhere and these days largely evergreen.</dd>
  <dt>Stability</dt>
  <dd>Fairly big commitment to backwards compatibility.</dd>
  <dt>Depth</dt>
  <dd>Very deep, writing your own browser to render your page or website is not feasible.</dd>
  <dt>Ergonomics</dt>
  <dd>They&#39;re alright. Some cruft, but the documentation and developer tooling is excellent.</dd>
  <dt>Watertightness</dt>
  <dd>Outside of maybe interacting with files, audio, video, it&#39;s a pretty water tight abstraction.</dd>
</dl>

<h2>Bad Dependencies</h2>
<p>I will leave this as an exercise for the reader!</p>
<p>But remember; think critically, evaluate the costs as well of the benefits, and choose wisely.</p>

			</div></div>
  </body>
</html>
