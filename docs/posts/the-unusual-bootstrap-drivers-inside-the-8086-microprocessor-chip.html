<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.righto.com/2022/11/the-unusual-bootstrap-drivers-inside.html">Original</a>
    <h1>The unusual bootstrap drivers inside the 8086 microprocessor chip</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-1996368623502805997" itemprop="description articleBody">


<p>The 8086 microprocessor is one of the most important chips ever created; it started the x86 architecture that still
dominates desktop and server computing today.
I&#39;ve been reverse-engineering its circuitry by studying its silicon die.
One of the most unusual circuits I found is a &#34;bootstrap driver&#34;, a way to boost internal signals
to improve performance.<span id="fnref:8008"><a href="#fn:8008">1</a></span></p>
<p><a href="https://static.righto.com/images/8086-bootstrap/circuit.jpg"><img alt="The bootstrap driver circuit from the 8086 processor." height="250" src="https://static.righto.com/images/8086-bootstrap/circuit-w250.jpg" title="The bootstrap driver circuit from the 8086 processor." width="250"/></a></p><p>The bootstrap driver circuit from the 8086 processor.</p>
<p>This circuit consists of just three NMOS transistors, amplifying an input signal to produce an output signal, but
it doesn&#39;t resemble typical NMOS logic circuits and puzzled me for a long time.
Eventually, I stumbled across an explanation:<span id="fnref:dram"><a href="#fn:dram">2</a></span> the &#34;bootstrap driver&#34; uses the transistor&#39;s
capacitance to boost its voltage. It produces control pulses with higher current and higher voltage than otherwise possible,
increasing performance.
In this blog post, I&#39;ll attempt to explain how the tricky bootstrap driver circuit works.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/metal.jpg"><img alt="A die photo of the 8086 processor. The metal layer on top of the silicon is visible. Around the edge of the chip, bond wires provide connections to the chip&#39;s external pins. Click this image (or any other) for a larger version." height="579" src="https://static.righto.com/images/8086-bootstrap/metal-w600.jpg" title="A die photo of the 8086 processor. The metal layer on top of the silicon is visible. Around the edge of the chip, bond wires provide connections to the chip&#39;s external pins. Click this image (or any other) for a larger version." width="600"/></a></p><p>A die photo of the 8086 processor. The metal layer on top of the silicon is visible. Around the edge of the chip, bond wires provide connections to the chip&#39;s external pins. Click this image (or any other) for a larger version.</p>
<h2>NMOS transistors</h2>
<p>The 8086 is built from MOS transistors (MOSFETs), specifically NMOS transistors.
Understanding the bootstrap driver requires some understanding of these transistors.
If you&#39;re familiar with MOSFETs as components, they have source and drain pins and current flows from the drain to the source, controlled by the gate pin.
Most of the time I treat an NMOS transistor as a digital switch between the drain and the source: a 1 input turns the transistor on, closing the switch, while a 0 turns the transistor off.
However, for the bootstrap driver, we must consider the MOSFET in a bit more detail.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/mosfet1.jpg"><img alt="A MOSFET switches current from the drain to the source, under control of the gate." height="171" src="https://static.righto.com/images/8086-bootstrap/mosfet1-w200.jpg" title="A MOSFET switches current from the drain to the source, under control of the gate." width="200"/></a></p><p>A MOSFET switches current from the drain to the source, under control of the gate.</p>
<p>The important aspect of the gate is the difference between the gate voltage and the (typically lower) source voltage;
this is denoted as V<sub>gs</sub>.
Without going into semiconductor physics, a slightly more accurate model is that the transistor turns on when the 
voltage between the gate and the source
exceeds the fixed <a href="https://en.wikipedia.org/wiki/Threshold_voltage">threshold voltage</a>, V<sub>th</sub>.
This creates a conducting channel between the transistor&#39;s source and drain.
Thus, if V<sub>gs</sub> &gt; V<sub>th</sub>,
the transistor turns on and current flows.
Otherwise, the transistor turns off and no current flows.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/mosfet2.jpg"><img alt="The voltage between the gate and the source (Vgs) controls the transistor." height="182" src="https://static.righto.com/images/8086-bootstrap/mosfet2-w170.jpg" title="The voltage between the gate and the source (Vgs) controls the transistor." width="170"/></a></p><p>The voltage between the gate and the source (V<sub>gs</sub>) controls the transistor.</p>
<p>The threshold voltage has an important consequence for a chip such as the 8086.
The 8086, like most chips of that era, used a 5-volt power supply.
The threshold voltage depends on manufacturing characteristics, but I&#39;ll use 1 volt as a typical value.<span id="fnref:threshold"><a href="#fn:threshold">3</a></span>
The result is that if you put 5 volts on the drain and on the gate, the transistor
can pull the source up to about 4 volts, but then V<sub>gs</sub> falls to the threshold voltage and the transistor stops
conducting. Thus, the transistor can&#39;t pull the source all the way up to the 5-volt supply, but falls short by a volt on the output.
In some circumstances this is a problem, and this is the problem that the bootstrap driver fixes.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/mosfet3.jpg"><img alt="Due to the threshold voltage, the transistor doesn&#39;t pull the source all the way to the drain&#39;s voltage, but &#34;loses&#34; a volt." height="156" src="https://static.righto.com/images/8086-bootstrap/mosfet3-w200.jpg" title="Due to the threshold voltage, the transistor doesn&#39;t pull the source all the way to the drain&#39;s voltage, but &#34;loses&#34; a volt." width="200"/></a></p><p>Due to the threshold voltage, the transistor doesn&#39;t pull the source all the way to the drain&#39;s voltage, but &#34;loses&#34; a volt.</p>
<p>If you get a transistor as a physical component, the source and drain are not interchangeable. 
However, in an integrated circuit, there is no difference between the source and the drain, and this will be important.<span id="fnref:substrate"><a href="#fn:substrate">4</a></span>
The diagram below shows how a MOSFET is constructed on the silicon die. The source and drain consist of regions of silicon doped with impurities to change their property. 
Between them is a channel of undoped silicon, which normally does not conduct. Above the channel is the gate, made of a special
type of silicon called polysilicon.
The voltage on the gate controls the conductivity of the channel.
A very thin insulating layer separates the gate from the channel. As a side effect, the insulating layer creates some capacitance between the gate and the underlying silicon.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/mosfet.jpg"><img alt="Diagram of an NMOS transistor in an integrated circuit." height="234" src="https://static.righto.com/images/8086-bootstrap/mosfet-w400.jpg" title="Diagram of an NMOS transistor in an integrated circuit." width="400"/></a></p><p>Diagram of an NMOS transistor in an integrated circuit.</p>
<h2>Basic NMOS circuits</h2>
<p>Before getting to the bootstrap driver, I&#39;ll explain how a basic inverter is implemented in an NMOS chip like the 8086.
The inverter is built from two transistors: a normal transistor on the bottom, and a special load transistor on top that acts
like a pull-up resistor, providing a small constant current.<span id="fnref:load"><a href="#fn:load">5</a></span>
With a 1 input, the lower transistor turns on, pulling the output to ground to produce a 0 output.
With a 0 input, the lower transistor turns off and the current from the upper transistor drives the output high to produce a 1 output.
Thus, the circuit implements an inverter: producing a 1 when the input is 0 and vice versa.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/inverter.jpg"><img alt="A standard NMOS inverter is built from two transistors. The upper transistor is a &#34;depletion load&#34; transistor." height="262" src="https://static.righto.com/images/8086-bootstrap/inverter-w500.jpg" title="A standard NMOS inverter is built from two transistors. The upper transistor is a &#34;depletion load&#34; transistor." width="500"/></a></p><p>A standard NMOS inverter is built from two transistors. The upper transistor is a &#34;depletion load&#34; transistor.</p>
<p>The disadvantage of this inverter circuit is that when it produces a 0 output, current continuously flows through the load transistor
and the lower transistor to ground.
This wastes power, leading to high power consumption for NMOS circuitry. (To solve this, CMOS circuitry took over in the
1980s and is used in modern microprocessors.)
This also limits the current that the inverter can provide.</p>
<p>If a gate needs to provide a relatively large current, for instance to drive a long bus inside the chip, a more complex
circuit is used, the &#34;superbuffer&#34;.
The superbuffer uses one transistor to pull the output high and a second transistor to pull the output low.<span id="fnref:superbuffer"><a href="#fn:superbuffer">6</a></span>
Because only one transistor is on at a time, a high-current output can be produced without wasting power.
There are two disadvantages of the superbuffer, though.
First, the superbuffer requires an inverter to control the high-side transistor, so it uses considerably more space on the die.
Second, the superbuffer can&#39;t pull the high output all the way up; it loses a volt due to the threshold voltage as described earlier.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/superbuffer.jpg"><img alt="Combining two output transistors with an inverter produces a higher-current output, known as a superbuffer." height="229" src="https://static.righto.com/images/8086-bootstrap/superbuffer-w250.jpg" title="Combining two output transistors with an inverter produces a higher-current output, known as a superbuffer." width="250"/></a></p><p>Combining two output transistors with an inverter produces a higher-current output, known as a superbuffer.</p>
<!--
Another place that the threshold voltage is important is in a pass transistor, where the transistor is used as a switch to
pass or block a signal, rather than as an element in a logic gate.
Pass transistors are extensively used in the 8086; one key role is selecting the signal that enters or exits a bus.
If you try to send a "1" signal through a pass transistor, the threshold voltage causes you to lose a volt due to the threshold voltage.
Normally, this isn't a problem because the next logic gate will "restore" the signal to its proper level.
But this limits the use of pass transistors to at most two in sequence, or else the voltage loss becomes two large.

For instance, the ALU bus connects the 8086's registers to the ALU (arithmetic-logic unit).
Pass transistors select which register is connected to the bus, and control signals energize specific pass transistors.
For instance, one signal connects the program counter to the ALU bus, while other signals connect segment registers to the ALU bus.
Since the 8086 is a 16-bit processor, the ALU bus is 16 bits wide and there are 16 pass transistors that must be energized for
each connection.
A standard NMOS logic gate generates a relatively weak "1" output due to the pull-up transistor, not enough to rapidly drive 16 pass transistors with their associated capacitance.
The obvious solution would be to use a superbuffer to create a high-current output.
However, the threshold voltage becomes a problem: the superbuffer's output is down one volt, and then the pass transistor loses another volt, so the signal on the bus is weak, sensitive to noise and changing the bus's state too slowly.
What we want is a high-current pulse at the full 5 volts, sufficient to quickly drive the pass transistors.
The bootstrap driver is the solution.
-->

<h2>The bootstrap driver</h2>
<p>In some circumstances, you want both a high-current output, and the full output voltage.
One example is connecting a register to an internal bus.
Since the 8086 is a 16-bit chip, it uses 16 transistors for the bus connection. Driving 16 transistors in parallel requires
a fairly high current.
But the bus transistors are &#34;pass&#34; transistors, which lose a volt due to the threshold voltage, so you want to start with the
full voltage, not already down one volt.
To provide both high current and the full voltage, bootstrap drivers are used to control the buses, as well as similar tasks
such as ALU control.</p>
<p>The concept behind the bootstrap driver is to drive the gate voltage significantly higher than 5 volts,
so even after losing the threshold voltage, the transistor can produce the full 5-volt output.<span id="fnref:pump"><a href="#fn:pump">7</a></span>
The higher voltage is generated by a charge pump, as illustrated below.
Suppose you charge a capacitor with 5 volts. Now, disconnect the bottom of the capacitor from ground, and connect it to +5 volts.
The capacitor is still charged with 5 volts, so now the high side is at +10 volts with respect to ground.
Thus, a capacitor can be used to create a higher voltage by &#34;pumping&#34; the charge to a higher level.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/flying-capacitor.jpg"><img alt="On the left, the &#34;flying capacitor&#39; is charged to 5 volts. By switching the lower terminal to +5 volts, the capacitor now outputs +10 volts" height="210" src="https://static.righto.com/images/8086-bootstrap/flying-capacitor-w400.jpg" title="On the left, the &#34;flying capacitor&#39; is charged to 5 volts. By switching the lower terminal to +5 volts, the capacitor now outputs +10 volts" width="400"/></a></p><p>On the left, the &#34;flying capacitor&#39; is charged to 5 volts. By switching the lower terminal to +5 volts, the capacitor now outputs +10 volts</p>
<p>The idea of the bootstrap driver is to attach a capacitor to the gate and charge it to 5 volts. Then, the low side of the capacitor is raised to 5 volts,
boosting the gate side of the capacitor to 10 volts.
With this high voltage on the gate, the threshold voltage is easily exceeded and the transistor can pass the full 5 volts
from the drain to the source, producing a 5-volt output.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/mosfet4.jpg"><img alt="With a large voltage on the gate, the threshold voltage is exceeded and the transistor remains on until the source reaches 5 volts." height="158" src="https://static.righto.com/images/8086-bootstrap/mosfet4-w200.jpg" title="With a large voltage on the gate, the threshold voltage is exceeded and the transistor remains on until the source reaches 5 volts." width="200"/></a></p><p>With a large voltage on the gate, the threshold voltage is exceeded and the transistor remains on until the source reaches 5 volts.</p>
<p>In the 8086 bootstrap driver,<span id="fnref:history"><a href="#fn:history">8</a></span> an explicit capacitor is not used.<span id="fnref:capacitor"><a href="#fn:capacitor">9</a></span>
Instead, the transistor&#39;s inherent capacitance is sufficient.
Due to the thin insulating oxide layer between the gate and the underlying silicon, the gate acts as the plate of a capacitor
relative to the source and drain.
This &#34;parasitic&#34; capacitance is usually a bad thing, but the bootstrap driver takes advantage of it.</p>
<p>The diagrams below show how the bootstrap driver works.
Unlike an inverter, the bootstrap driver is controlled by the chip&#39;s clock, generating an output only when the clock is high.
In the first diagram, we assume that the input is a 1 and the clock is low (0).
Two things happen.
First, the inverted clock turns on the bottom transistor, pulling the output to ground.
Second, the 5V input passes through the first transistor; the left side of the transistor acts as the drain and the right
side as the source.
Due to the threshold voltage, a volt is &#34;lost&#34; so about 4 volts reaches the gate of the second transistor.
Since the source and drain of the second transistor are at 0 volts, 
the gate capacitors are charged with 4 volts.
(Recall that these are not explicit capacitors, but are parasitic capacitors.)
gate and the underlying silicon.)</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/circuit-1.jpg"><img alt="The first step in the operation of the bootstrap driver. The gate capacitance is charged by the input." height="284" src="https://static.righto.com/images/8086-bootstrap/circuit-1-w400.jpg" title="The first step in the operation of the bootstrap driver. The gate capacitance is charged by the input." width="400"/></a></p><p>The first step in the operation of the bootstrap driver. The gate capacitance is charged by the input.</p>
<p>In the next step, the clock switches state and things become more interesting.
The second transistor is on due to the voltage on the gate, so current flows from the clock to the output.
In a &#34;normal&#34; circuit, the output would rise to 4 volts, losing a volt due to the threshold voltage of the second transistor.
However, as the output voltage rises, it boosts the voltage on the gate capacitors and thus raises the gate voltage.
The increased gate voltage allows the output voltage to rise above 4 volts, pushing the gate voltage even higher, until
the output reaches 5 volts.<span id="fnref:gate-voltage"><a href="#fn:gate-voltage">10</a></span>
Thus, the bootstrap driver produces a high-current output with the full 5 volts.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/circuit-2.jpg"><img alt="The second step in the operation of the bootstrap driver. As the output rises, it boosts the gate voltage even higher." height="270" src="https://static.righto.com/images/8086-bootstrap/circuit-2-w400.jpg" title="The second step in the operation of the bootstrap driver. As the output rises, it boosts the gate voltage even higher." width="400"/></a></p><p>The second step in the operation of the bootstrap driver. As the output rises, it boosts the gate voltage even higher.</p>
<p>An important factor is that the first transistor now has a higher voltage on the right than on the left, so the source and drain switch roles.
Since the transistor has 5 volts on the gate and on the (now) source, V<sub>gs</sub> is 0 and current can&#39;t flow.
Thus the first transistor blocks current flow from the gate, keeping the gate at its higher voltage.
This is the critical role of the first transistor in the bootstrap driver, acting as a diode to block current flow out of the gate.</p>
<p>The diagram below shows what happens when the clock switches state again, assuming a low input.
Now the first transistor&#39;s source voltage drops, making V<sub>gs</sub> large and turning the transistor on.
This allows the second transistor&#39;s gate voltage to flow out.
Note that the first transistor is no longer acting as a diode, since current can flow in the &#34;reverse&#34; direction.
The other important action in this clock phase is that the bottom transistor turns on, pulling the output low.
These actions discharge the gate capacitance, preparing it for the next bootstrap cycle.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/circuit-3.jpg"><img alt="When the clock switches off, the driver is discharged, preparing it for the next cycle." height="291" src="https://static.righto.com/images/8086-bootstrap/circuit-3-w400.jpg" title="When the clock switches off, the driver is discharged, preparing it for the next cycle." width="400"/></a></p><p>When the clock switches off, the driver is discharged, preparing it for the next cycle.</p>
<h2>The 8086 die</h2>
<p>Now that I&#39;ve explained the theory, how do bootstrap drivers appear on the silicon die of the 8086?
The diagram below shows six drivers that control the ALU operation.<span id="fnref:alu"><a href="#fn:alu">11</a></span>
There&#39;s a lot happening in this diagram, but I&#39;ll try to explain what&#39;s going on.
For this photo, I removed the metal layer with acid to reveal the silicon underneath; the yellow lines show where the metal wiring was.
The large pinkish regions are doped silicon, while the gray speckled lines are polysilicon on top.
The greenish and reddish regions are undoped silicon, which doesn&#39;t conduct and can be ignored.
A transistor is formed where a polysilicon line crosses silicon, with the source and drain on opposite sides. Note that
some transistors share the source or drain region with a neighboring transistor, saving space.
The circles are vias, connections between the metal and a lower layer.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/die-layout.jpg"><img alt="Six bootstrap drivers as they appear on the chip." height="322" src="https://static.righto.com/images/8086-bootstrap/die-layout-w600.jpg" title="Six bootstrap drivers as they appear on the chip." width="600"/></a></p><p>Six bootstrap drivers as they appear on the chip.</p>
<p>The drivers start with six inputs at the right. Each input goes through a &#34;diode&#34; transistor with the gate tied to +5V.
I&#39;ve labeled two of these transistors and the other four are scattered around the image.
Next, each signal goes to the gate of one of the drive transistors. These six large transistors pass the clock to the
output when turned on. Note that the clock signal flows through large silicon regions, rather than &#34;wires&#34;.
Finally, each output has a pull-down transistor on the left, connecting it to ground (another large silicon region) under control
of the inverted clock.
The drive transistors are much larger than the other transistors, so they can provide much more current.
Their size also provides the gate capacitance necessary for the operation of the bootstrap driver.</p>
<p>Although the six drivers in this diagram are electrically identical, each one has a different layout instead of repeating the
same layout six times.
This demonstrates how the layout has been optimized, moving transistors around to use space most efficiently.</p>
<p>In total, the 8086 has 81 bootstrap drivers, mostly controlling the register file and the ALU (arithmetic-logic unit).
The die photo below shows the location of the drivers, indicated with red dots.
Most of them are in the center-left of the chip, between the registers and ALU on the left and the control circuitry in the center.</p>
<p><a href="https://static.righto.com/images/8086-bootstrap/die-labeled.jpg"><img alt="The 8086 die with main functional blocks labeled. The bootstrap drivers are indicated with red dots." height="586" src="https://static.righto.com/images/8086-bootstrap/die-labeled-w600.jpg" title="The 8086 die with main functional blocks labeled. The bootstrap drivers are indicated with red dots." width="600"/></a></p><p>The 8086 die with main functional blocks labeled. The bootstrap drivers are indicated with red dots.</p>
<h2>Conclusions</h2>
<p>For the most part, the 8086 uses standard NMOS logic circuits.
However, a few of its circuits are unusual, and the bootstrap driver is one of them.
This driver is a tricky circuit, depending on some subtle characteristics of MOS transistors, so I hope my explanation made sense.
This driver illustrates how Intel used complex, special-case circuitry when necessary to get as much performance from the chip as possible.</p>
<p>If you&#39;re interested in the 8086, I wrote about the <a href="https://www.righto.com/2020/06/a-look-at-die-of-8086-processor.html">8086 die</a>, its <a href="https://www.righto.com/2020/06/die-shrink-how-intel-scaled-down-8086.html">die shrink process</a> and the <a href="https://www.righto.com/2020/07/the-intel-8086-processors-registers.html">8086 registers</a> earlier.
I plan to write more about the 8086 so
follow me on Twitter <a href="https://twitter.com/kenshirriff">@kenshirriff</a> or <a href="https://www.righto.com/feeds/posts/default">RSS</a> for updates.</p>
<h2>Notes and references</h2>


</div></div>
  </body>
</html>
