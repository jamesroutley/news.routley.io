<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bleepingcomputer.com/news/security/millions-of-github-repos-likely-vulnerable-to-repojacking-researchers-say/">Original</a>
    <h1>Millions of GitHub repos likely vulnerable to RepoJacking, researchers say</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><img alt="GitHub" height="900" src="https://www.bleepstatic.com/content/hl-images/2022/04/08/GitHub__headpic.jpg" width="1600"/></p>
<p>Millions of GitHub repositories may be vulnerable to dependency repository hijacking, also known as &#34;RepoJacking,&#34; which could help attackers deploy supply chain attacks impacting a large number of users.</p>
<p>The warning comes from <a href="https://blog.aquasec.com/github-dataset-research-reveals-millions-potentially-vulnerable-to-repojacking" target="_blank" rel="nofollow noopener">AquaSec&#39;s security team</a>, &#39;Nautilus,&#39; who analyzed a sample of 1.25 million GitHub repositories and found that about 2.95% of them to be vulnerable to RepoJacking.</p>
<p>By extrapolating this percentage to GitHub&#39;s entire repository base of more than 300 million, the researchers estimate that the issue affects approximately 9 million projects.</p>
<p><img alt="Test diagram" height="465" src="https://www.bleepstatic.com/images/news/u/1220909/2023/Security/21/tested.jpg" width="613"/></p>
<h2>What is RepoJacking</h2>
<p>Username and repository name changes are frequent on GitHub, as organizations can get new management through acquisition or merger, or they can switch to a new brand name.</p>
<p>When this happens, a redirection is created to avoid breaking dependencies for projects using code from repositories that changed their name; however, if someone registers the old name, that redirection becomes invalid.</p>
<p>RepoJacking is an attack where a malicious actor registers a username and creates a repository used by an organization in the past but which has since changed its name.</p>
<p>Doing so results in any project or code that relies on the dependencies of the attacked project to fetch dependencies and code from the attacker-controlled repository, which could contain malware.</p>
<p><img alt="Gif" height="600" src="https://blog.aquasec.com/hs-fs/hubfs/repoijacking%20gif.gif?width=1920&amp;height=1080&amp;name=repoijacking%20gif.gif" width="1067"/></p>
<p>GitHub knows about this possibility and implemented some defenses for RepoJacking attacks. However, AquaSec reports that the solutions have so far been incomplete and easily bypassed.</p>
<p>For example, GitHub only protects highly popular projects, but those projects may use a dependency from a less popular, vulnerable repository that isn&#39;t covered, so the supply chain compromise impacts them too.</p>
<p>Also, GitHub protects repositories with over 100 clones the week before changing name, indicating malicious preparations. This protection doesn&#39;t cover projects that became popular after their rename or transfer of ownership.</p>
<h2>Exploitation potential</h2>
<p>To highlight the importance of the problem, AquaSec scanned renowned organizations for vulnerable repositories and found exploitable cases in repos managed by Google and Lyft.</p>
<p>In Google&#39;s case, a readme file containing instructions on building the fairly popular project &#34;Mathsteps&#34; pointed to a GitHub repository belonging to Socratic, a company that Google acquired and assimilated in 2018 and no longer exists.</p>
<p>Since an attacker can clone that repository to break the redirection, users following the readme instructions could have downloaded malicious code from the rogue repository.</p>
<p>Also, because the instructions included an &#34;npm install&#34; command for the dependency, the attacker&#39;s code would achieve arbitrary code execution on the devices of unsuspecting users.</p>
<div>
<figure><img alt="Instructions in Google&#39;s readme file" height="437" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" width="789" data-src="https://www.bleepstatic.com/images/news/u/1220909/2023/Security/21/google.jpg"/><figcaption><strong>Build instructions in Google&#39;s readme file</strong> <em>(AquaSec)</em></figcaption></figure></div>
<p>In the case of Lyft, the attack would be more automated, as AquaSec found an installation script on the company&#39;s repository that fetches a ZIP archive from another repository, which is vulnerable to RepoJacking.</p>
<p>An attacker registering a new username and repository with the right names (&#34;YesGraph&#34; and &#34;Dominus&#34; in this case) could inject their code to anyone executing Lyft&#39;s &#34;install.sh&#34; script.</p>
<div>
<figure><img alt="Lyft script pointing to an external repository vulnerable to RepoJacking" height="600" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" width="880" data-src="https://www.bleepstatic.com/images/news/u/1220909/2023/Security/21/lyft.jpg"/><figcaption><strong>Lyft script pointing to an external repository vulnerable to RepoJacking</strong> <em>(AquaSec)</em></figcaption></figure></div>
<h2>Conclusion</h2>
<p>Unfortunately, the risk of RepoJacking is widespread, hard to mitigate, and can have severe repercussions for organizations and users.</p>
<p>Project owners should minimize the resources they fetch from external repositories as much as possible.</p>
<p>Additionally, owners should consider keeping control of repositories of old brands or of acquired entities, just to prevent dependency hijacking attacks on themselves and their users.</p>

</div></div>
  </body>
</html>
