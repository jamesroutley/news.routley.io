<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/">Original</a>
    <h1>Bullshit graph database performance benchmarks</h1>
    
    <div id="readability-page-1" class="page"><div>
						<div>
<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png"><img loading="lazy" data-attachment-id="7591" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/memgraph-benchmark/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png" data-orig-size="763,540" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="memgraph-benchmark" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=763" alt="" width="572" height="405" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=572 572w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark.png 763w" sizes="(max-width: 572px) 100vw, 572px"/></a></figure></div>


<p>Hey <a rel="noreferrer noopener" href="https://news.ycombinator.com/item?id=34342371" target="_blank">HackerNews</a>, let me just drop my <a rel="noreferrer noopener" href="http://ragedb.com/" target="_blank">mixtape</a>, checkout my <a rel="noreferrer noopener" href="https://github.com/ragedb/ragedb" target="_blank">soundcloud</a> and “Death Row” is the <a href="https://relational.ai/" target="_blank" rel="noreferrer noopener">label that pays me</a>.</p>



<p>How is the Graph Database category supposed to grow when vendors keep spouting off complete <a rel="noreferrer noopener" href="https://www.youtube.com/watch?v=XPrRxhYJMkQ" target="_blank">bullshit</a>? I <a rel="noreferrer noopener" href="https://maxdemarzi.com/2022/12/06/khop-baby-one-more-time/" target="_blank">wrote a bit</a> about the <a rel="noreferrer noopener" href="https://memgraph.com/benchgraph" target="_blank">ridiculous benchmark</a> Memgraph published last month hoping they would do the right thing and make an attempt at a real analysis. Instead these clowns put it on a banner on top of their home page. So let’s tear into it.</p>



<p>At first I considered replicating it using their own <a href="https://github.com/memgraph/memgraph/tree/master/tests/mgbench" target="_blank" rel="noreferrer noopener">repository</a>, but it’s about 2000 lines of Python and I don’t know Python. Worse still, the work is under a “Business Source License” which states:</p>



<blockquote>
<p>“Authorised Purpose” means any of the following, provided always that (a) you do not embed or otherwise distribute the Licensed Work to third parties; and (b) you do not provide third parties direct access to operate or control the Licensed Work as a standalone solution or service:</p>



<p>1…</p>



<p>2….</p>



<p>3. using the Licensed Work to create a work or solution which competes (or might reasonably be expected to compete) with the Licensed Work.</p>
<cite><a href="https://github.com/memgraph/memgraph/blob/master/licenses/BSL.txt" rel="nofollow">https://github.com/memgraph/memgraph/blob/master/licenses/BSL.txt</a></cite></blockquote>



<p><a href="https://en.wikipedia.org/wiki/IANAL" target="_blank" rel="noreferrer noopener">IANAL</a>, but that sounds like you aren’t allowed to use their benchmark code if you provide a competing solution. Which means the other database vendors can’t actually use this anyway. Why would they do this? Because it’s a bullshit benchmark and they don’t actually want anybody looking too deeply at it.</p>



<p>So I decided to just do a simple project using <a rel="noreferrer noopener" href="https://gatling.io/" target="_blank">Gatling</a>. An industry standard tool to test performance. Why doesn’t everybody just do that instead of creating their own weird thing that is probably full of problems? Oh right, because everyone produces bullshit benchmarks.</p>



<p>They decided to provide the data not in a CSV file like a normal human being would, but instead in <a rel="noreferrer noopener" href="https://s3.eu-west-1.amazonaws.com/deps.memgraph.io/dataset/pokec/benchmark/pokec_medium_import.cypher" target="_blank">a giant cypher file</a> performing individual transactions for each node and each relationship created. Not <a rel="noreferrer noopener" href="https://neo4j.com/developer-blog/updated-efficient-neo4j-data-import-using-cypher-scripts/" target="_blank">batches of transactions</a>… but rather painful, individual, one at a time transactions one point 8 million times. So instead of the import taking 2 minutes, it takes hours. Why would they do this? I keep forgetting… because they don’t actually want anybody trying this.</p>



<p>Ok, what’s their hardware for the benchmark results?</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png"><img data-attachment-id="7604" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/memgraph-spec/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png" data-orig-size="394,159" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="memgraph-spec" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png?w=394" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png?w=394" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png 394w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-spec.png?w=300 300w" sizes="(max-width: 394px) 100vw, 394px"/></a></figure>



<p>A G6? <a rel="noreferrer noopener" href="https://www.youtube.com/watch?v=w4s6H4ku6ZY" target="_blank">I’m feeling so fly like a G6</a>. Those <a rel="noreferrer noopener" href="https://proliant.blogspot.com/2009/04/proliant-g6-launch-information.html" target="_blank">came out in 2009</a>. I would go on <a rel="noreferrer noopener" href="https://www.ebay.com/sch/i.html?_from=R40&amp;_trksid=p2380057.m570.l1313&amp;_nkw=HP+DL360+G6&amp;_sacat=0" target="_blank">ebay</a> and buy a refurbished one for $50 bucks, but I don’t have a rack to put it in and no guarantee it won’t catch on fire the second I turn it on. I’ll just use my <a rel="noreferrer noopener" href="https://nzxt.com/" target="_blank">gaming pc</a> with an Intel® Core™ i7-10700K CPU @ 3.80GHz × 8 cores. Debian 4.19… uh… they can’t mean that, they probably mean <a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/Debian_version_history#Debian_10_(Buster)" target="_blank">Debian 10</a> with Linux kernel 4.19. I’ll stick with Ubuntu 22.04 with Linux kernel 6.0.5.</p>



<p>Well use the medium dataset (which already takes hours to import the way they set it up) from a “hot engine”. Has anyone ever tried testing the performance of a sports car with a “cold engine”? No, because that’s stupid, so we won’t do that here. Alright the first 4 queries are:</p>


<div><pre title="">Q1: MATCH (n:User) RETURN n.age, COUNT(*)
Q2: MATCH (n) RETURN count(n), count(n.age)
Q3: MATCH (n:User) WHERE n.age &gt;= 18 RETURN n.age, COUNT(*)
Q4: MATCH (n) RETURN min(n.age), max(n.age), avg(n.age)
</pre></div>


<p>Those are not “graphy” queries at all, why are they in a graph database benchmark? Ok, whatever. Let’s take a look at the raw data for the first query [<a rel="noreferrer noopener" href="https://github.com/memgraph/benchgraph/blob/main/results/neo4j_hot.json" target="_blank">neo4j</a> and <a rel="noreferrer noopener" href="https://github.com/memgraph/benchgraph/blob/main/results/memgraph_hot.json" target="_blank">memgraph</a>]:</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png"><img data-attachment-id="7612" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/q1-side-by-side/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png" data-orig-size="1083,584" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="q1-side-by-side" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=1024" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=1024 1024w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png?w=768 768w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-side-by-side.png 1083w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>On the left we have Neo4j, on the right we have Memgraph. Neo4j executed the query 195 times, taking 1.75 seconds and Memgraph 183 times taking 1.04 seconds. Why would you execute the query for different amount of times or different durations of time? That makes no sense. In a proper benchmark you would run each and every query for at least 60 seconds, preferably more and then compare. They do a little division and come up with 112 requests per second for Neo4j and 175 for Memgraph:</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png"><img data-attachment-id="7609" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/memgraph-benchmark-q1-q4/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png" data-orig-size="804,296" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="memgraph-benchmark-q1-q4" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=804" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png 804w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4.png?w=768 768w" sizes="(max-width: 804px) 100vw, 804px"/></a></figure>



<p>However, the CPUs of both systems were not at 100% meaning they were not fully utilized. The query statistics part is also weird. <strong>“iterations”:100.</strong>.. wait a minute, no they didn’t… they did not take 100 additional queries with a single worker separate from the queries they used for throughput and generate “p” latencies in the most idiotic way possible. Yes they did. But of course <a rel="noreferrer noopener" href="https://github.com/memgraph/memgraph/blob/eda5213d950e4cf4f8c81d6eee8963fa0596ffa6/tests/mgbench/benchmark.py#L243" target="_blank">they did</a>:</p>


<div><pre title="">    for i in range(0, iteration):
        ret = client.execute(queries=[query_list[i]], num_workers=1)
        latency.append(ret[0][&#34;duration&#34;])
    latency.sort()
    query_stats = {
        &#34;iterations&#34;: iteration,
        &#34;min&#34;: latency[0],
        &#34;max&#34;: latency[iteration - 1],
        &#34;mean&#34;: statistics.mean(latency),
        &#34;p99&#34;: latency[math.floor(iteration * 0.99) - 1],
        &#34;p95&#34;: latency[math.floor(iteration * 0.95) - 1],
        &#34;p90&#34;: latency[math.floor(iteration * 0.90) - 1],
        &#34;p75&#34;: latency[math.floor(iteration * 0.75) - 1],
        &#34;p50&#34;: latency[math.floor(iteration * 0.50) - 1],
    }
</pre></div>


<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png"><img data-attachment-id="7620" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/memgraph-benchmark-q1-q4-latencies/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png" data-orig-size="812,298" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="memgraph-benchmark-q1-q4-latencies" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=812" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png 812w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/memgraph-benchmark-q1-q4-latencies.png?w=768 768w" sizes="(max-width: 812px) 100vw, 812px"/></a></figure>



<p>You know what’s also weird? They reported the <em>p99</em> of only 100 queries which could be high for any number of reasons, but not the <em>mean</em> latency. Why not? Because in the <em>mean</em> latency Neo4j comes in at <em>39.6ms</em> vs <em>46.6ms</em> for Memgraph. <strong>Neo4j is actually faster</strong> if we look at the other metrics. The <em>p95</em>, <em>p90</em>, <em>p50</em> and <em>min</em> are all faster for Neo4j. Talk about an <a rel="noreferrer noopener" href="https://www.youtube.com/watch?v=2QCB8KA2NdI" target="_blank">egg on your face</a>.</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png"><img data-attachment-id="7624" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/q1-mean/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png" data-orig-size="780,27" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="q1-mean" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=780" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png 780w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-mean.png?w=768 768w" sizes="(max-width: 780px) 100vw, 780px"/></a></figure>



<p>At this point I haven’t even ran a single of my own tests and I can dismiss this benchmark as <a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/Gigli" target="_blank">Gigli bad</a>. Ok, let’s try running query 1 for 60 seconds using 8 workers since I only have 8 cores vs their 12 and see what Gatling tells us:</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png"><img data-attachment-id="7637" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/q1-neo-max/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png" data-orig-size="1017,178" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="q1-neo-max" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=1017" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png 1017w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q1-neo-max.png?w=768 768w" sizes="(max-width: 1017px) 100vw, 1017px"/></a></figure>



<p>Instead of 112 queries per second, I get 531q/s. Instead of a p99 latency of 94.49ms, I get 28ms with a min, mean, p50, p75 and p95 of 14ms to 18ms. Alright, what about query 2? Same story.</p>



<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png"><img data-attachment-id="7640" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/q2-neo-max/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png" data-orig-size="1015,175" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="q2-neo-max" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=580" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=1015" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png 1015w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=300 300w, https://maxdemarzidotcom.files.wordpress.com/2023/01/q2-neo-max.png?w=768 768w" sizes="(max-width: 1015px) 100vw, 1015px"/></a></figure>



<p>Let’s see the rest:</p>



<pre><code>                        Requests       Response Time (ms)
                        Total   Cnt/s  Min 50th 75th 95th 99th   Max Mean
Q1 - aggregate          31866   531.1   14  14   15   18    28    82   15
Q2 - aggregate_count    41888   698.133 10  11   11   14    22    48   11
Q3 - aggregate_with_f…  30820   505.246 14  15   15   18    28    95   16
Q4 - min_max_avg        31763   529.383 14  14   15   19    28    81   15
Q5 - expansion_1       615698 10093.41   0   1    1    1     2    90    1
Q6 - expansion_1_with… 615168 10084.721  0   1    1    1     2    64    1
Q7 - expansion_2        57683   945.623  0   2    7   41    81   583    8
Q8 - expansion_2_with… 109390  1793.279  0   1    4   17    41   252    4
Q9 - expansion_3         3027    49.623  0  95  233  552   733  1028  159
Q10 - expansion_3_wit…   4832    79.213  0  59  148  328   479   803   99
Q11 - expansion_4         226     3.054  1 888 2157 9194 22886 25890 2261
Q12 - expansion_4_wit…    247     3.087  1 679 2026 8584 21703 24169 2138
Q13 - neighbours_2      56106   919.77   0   2    8   42    84   367    8
Q14 - neighbours_2_wit 105232  1725.115  0   1    5   18    43   328    4
Q15 - neighbours_2_wi…  32580   534.098  0   5   15   68   121   385   15
Q16 - neighbours_2_wi…  60791   996.574  0   4   10   27    61   414    8
Q17 - pattern_cycle    523845  8587.623  0   1    1    2     3    82    1
Q18 - pattern_long     602254  9873.016  0   1    1    1     2    31    1
Q19 - pattern_short    616306 10103.377  0   1    1    1     2    20    1
Q20 - single_edge_wri… 242302  3972.164  1   2    2    3     6    32    2
Q21 - single_vertex_w… 284782  4668.557  1   2    2    2     5    75    2
Q22 - single_vertex_p…   9646   158.131 39  49   51   58    71   139   49
Q23 - single_vertex_r… 614535 10074.344  0   1    1    1     2   109    1
</code></pre>



<p>Those numbers are wildly different than the numbers Memgraph calculated for Neo4j in their benchmark. Let’s see the breakdown:</p>



<pre><code>                                   Neo4j
                        Memgraph   reported   mine  Winner     By
Q1 - aggregate               175        112    531   Neo4j     3.03*
Q2 - aggregate_count         272        129    698   Neo4j     2.56* 
Q3 - aggregate_with_filter   137         88    505   Neo4j     3.68*
Q4 - min_max_avg             125         97    529   Neo4j     4.23*
Q5 - expansion_1           29648        517  10093   Memgraph  2.93 
Q6 - exp_1_with_filter     31553        467  10085   Memgraph  3.12
Q7 - expansion_2            2164         30    946   Memgraph  2.29
Q8 - exp_3_with_filter      3603         61   1793   Memgraph  2.01
Q9 - expansion_3             134          7     50   Memgraph  2.68
Q10 - exp_3_with_filter      159         12     79   Memgraph  2.01
Q11 - expansion_4              4          1      3   Memgraph  1.33
Q12 - exp_4_with_filter        5          2      3   Memgraph  1.66
Q13 - neighbours_2          2171         59    920   Memgraph  2.36
Q14 - n2_with_filter         727         48   1725   Neo4j     2.37*
Q15 - n2_with_data          1286         43    534   Memgraph  2.40
Q16 - n2_w_data_and_filter  3453         83    997   Memgraph  3.46
Q17 - pattern_cycle        21718        371   8588   Memgraph  2.53
Q18 - pattern_long         33130       1127   9873   Memgraph  3.36
Q19 - pattern_short        36187       1508  10103   Memgraph  3.58
Q20 - single_edge_write    32211        337   3972   Memgraph  8.11
Q21 - single_vertex_write  35172        557   4669   Memgraph  7.53
Q22 - s_v_property_update    239        106    158   Memgraph  1.51
Q23 - single_vertex_read   36843       1841  10074   Memgraph  3.66</code></pre>



<p>It looks like Neo4j is faster than Memgraph in the Aggregate queries by about 3 times. Memgraph is faster than Neo4j for the queries they selected by about 2-3x except for <em>query 14</em> where Neo4j plays the <a rel="noreferrer noopener" href="https://knowyourmeme.com/memes/uno-reverse-card" target="_blank">Uno Reverse card</a>. I checked it multiple times, it is correct. </p>



<p>So there you have it folks. Memgraph is not up to 120 times faster than Neo4j… let’s fix their home page:</p>


<div>
<figure><a href="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png"><img data-attachment-id="7671" data-permalink="https://maxdemarzi.com/2023/01/11/bullshit-graph-database-performance-benchmarks/cover/" data-orig-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png" data-orig-size="485,432" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="cover" data-image-description="" data-image-caption="" data-medium-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png?w=300" data-large-file="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png?w=485" src="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png?w=485" alt="" srcset="https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png 485w, https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png?w=150 150w, https://maxdemarzidotcom.files.wordpress.com/2023/01/cover.png?w=300 300w" sizes="(max-width: 485px) 100vw, 485px"/></a></figure></div>


<p>The <a href="https://github.com/maxdemarzi/memgraph_benchmark" target="_blank" rel="noreferrer noopener">source code</a> and instructions for recreating this benchmark is on github.</p>
		</div></div>
  </body>
</html>
