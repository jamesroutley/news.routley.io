<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/snesrev/zelda3">Original</a>
    <h1>Zelda: A Link to the Past (SNES) re-implemented in C</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">A reimplementation of Zelda 3.</p>
<p dir="auto">Our discord server is: <a href="https://discord.gg/AJJbJAzNNJ" rel="nofollow">https://discord.gg/AJJbJAzNNJ</a></p>
<h2 dir="auto"><a id="user-content-about" aria-hidden="true" href="#about"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>About</h2>
<p dir="auto">This is a reverse engineered clone of Zelda 3 - A Link to the Past.</p>
<p dir="auto">It&#39;s around 70-80kLOC of C code, and reimplements all parts of the original game. The game is playable from start to end.</p>
<p dir="auto">You need a copy of the ROM to extract game resources (levels, images). Then once that&#39;s done, the ROM is no longer needed.</p>
<p dir="auto">It uses the PPU and DSP implementation from <a href="https://github.com/elzo-d/LakeSnes">LakeSnes</a>, but with lots of speed optimizations.
Additionally, it can be configured to also run the original machine code side by side. Then the RAM state is compared after each frame, to verify that the C implementation is correct.</p>
<p dir="auto">I got much assistance from spannerism&#39;s Zelda 3 JP disassembly and the other ones that documented loads of function names and variables.</p>
<h2 dir="auto"><a id="user-content-additional-features" aria-hidden="true" href="#additional-features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Additional features</h2>
<p dir="auto">A bunch of features have been added that are not supported by the original game. Some of them are:</p>
<p dir="auto">Support for pixel shaders.</p>
<p dir="auto">Support for enhanced aspect ratios of 16:9 or 16:10.</p>
<p dir="auto">Higher quality world map.</p>
<p dir="auto">Support for MSU audio tracks.</p>
<p dir="auto">Secondary item slot on button X (Hold X in inventory to select).</p>
<p dir="auto">Switching current item with L/R keys.</p>
<h2 dir="auto"><a id="user-content-installing-python--libraries-on-windows-required-for-asset-extraction-steps" aria-hidden="true" href="#installing-python--libraries-on-windows-required-for-asset-extraction-steps"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing Python &amp; libraries on Windows (required for asset extraction steps)</h2>
<ol dir="auto">
<li>Download <a href="https://www.python.org/ftp/python/3.10.7/python-3.10.7-amd64.exe" rel="nofollow">Python</a> installer and install</li>
<li>Open the command prompt</li>
<li>Upgrade pip &amp; install <code>pillow</code> and <code>pyyaml</code> by typing <code>python -m pip install --upgrade pip pillow pyyaml</code> and hit enter</li>
<li>Close the command prompt</li>
</ol>
<h2 dir="auto"><a id="user-content-compiling-on-windows-with-tcc-1mb-tiny-c-compiler" aria-hidden="true" href="#compiling-on-windows-with-tcc-1mb-tiny-c-compiler"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compiling on Windows with TCC (1mb Tiny C Compiler)</h2>
<ol dir="auto">
<li>Download the project by clicking &#34;Code &gt; Download ZIP&#34; on the github page</li>
<li>Extract the ZIP to your hard drive</li>
<li>Place the USA rom named <code>zelda3.sfc</code> in the &#34;\tables&#34; subfolder</li>
<li>Open the command prompt and navigate to that folder</li>
<li>Extract resources by typing <code>python extract_resources.py</code> and hit enter</li>
<li>Compile the extracted resources by typing <code>python compile_resources.py</code> and hit enter</li>
<li>Close the command prompt</li>
<li>Download <a href="https://github.com/FitzRoyX/tinycc/releases/download/tcc_20221020/tcc_20221020.zip">TCC</a> and extract to the &#34;\third_party&#34; subfolder</li>
<li>Download <a href="https://github.com/libsdl-org/SDL/releases/download/release-2.24.1/SDL2-devel-2.24.1-VC.zip">SDL2</a> and extract to the &#34;\third_party&#34; subfolder</li>
<li>Double-click <code>run_with_tcc.bat</code> in the main dir to create <code>zelda3.exe</code> in that same dir</li>
<li>Configure with <code>zelda3.ini</code> in the main dir</li>
</ol>
<h2 dir="auto"><a id="user-content-compiling-on-windows-with-visual-studio-45gb-ide-and-compiler" aria-hidden="true" href="#compiling-on-windows-with-visual-studio-45gb-ide-and-compiler"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compiling on Windows with Visual Studio (4.5gb IDE and compiler)</h2>
<p dir="auto">Same Steps 1-7 above</p>
<h2 dir="auto"><a id="user-content-installing-libraries-on-linuxmacos" aria-hidden="true" href="#installing-libraries-on-linuxmacos"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing libraries on Linux/MacOS</h2>
<ol dir="auto">
<li>Open a terminal</li>
<li>Install pip if not already installed</li>
</ol>

<ol start="3" dir="auto">
<li>Clone the repo and <code>cd</code> into it</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/snesrev/zelda3
cd zelda3"><pre>git clone https://github.com/snesrev/zelda3
<span>cd</span> zelda3</pre></div>
<ol start="4" dir="auto">
<li>Install requirements using pip</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="python3 -m pip install -r requirements.txt"><pre>python3 -m pip install -r requirements.txt</pre></div>
<ol start="5" dir="auto">
<li>Install SDL2</li>
</ol>
<ul dir="auto">
<li>Ubuntu/Debian <code>sudo apt install libsdl2-dev</code></li>
<li>Fedora Linux <code>sudo dnf in sdl2-devel</code></li>
<li>Arch Linux <code>sudo pacman -S sdl2</code></li>
<li>macOS: <code>brew install sdl2</code> (you can get homebrew <a href="https://brew.sh/" rel="nofollow">here</a>)</li>
</ul>
<h2 dir="auto"><a id="user-content-compiling-on-linuxmacos" aria-hidden="true" href="#compiling-on-linuxmacos"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compiling on Linux/MacOS</h2>
<ol dir="auto">
<li>Place your US ROM file named <code>zelda3.sfc</code> in <code>zelda3/tables</code></li>
<li>Compile</li>
</ol>

<details>
<summary>
Advanced make usage ...
</summary>
<div dir="auto" data-snippet-clipboard-copy-content="make -j$(nproc) # run on all core
make clean all  # clear gen+obj and rebuild
CC=clang make   # specify compiler"><pre>make -j<span><span>$(</span>nproc<span>)</span></span> <span><span>#</span> run on all core</span>
make clean all  <span><span>#</span> clear gen+obj and rebuild</span>
CC=clang make   <span><span>#</span> specify compiler</span></pre></div>
</details>
<h2 dir="auto"><a id="user-content-nintendo-switch" aria-hidden="true" href="#nintendo-switch"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Nintendo Switch</h2>
<p dir="auto">You need <a href="https://devkitpro.org/wiki/Getting_Started" rel="nofollow">DevKitPro</a> and <a href="https://github.com/Atmosphere-NX/Atmosphere">Atmosphere</a> installed.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(dkp-)pacman -S git switch-dev switch-sdl2 switch-tools
cd platform/switch
make # Add -j$(nproc) to build using all cores ( Optional )
# You can test the build directly onto the switch ( Optional )
nxlink -s zelda3.nro"><pre>(dkp-)pacman -S git switch-dev switch-sdl2 switch-tools
<span>cd</span> platform/switch
make <span><span>#</span> Add -j$(nproc) to build using all cores ( Optional )</span>
<span><span>#</span> You can test the build directly onto the switch ( Optional )</span>
nxlink -s zelda3.nro</pre></div>
<h2 dir="auto"><a id="user-content-more-compilation-help" aria-hidden="true" href="#more-compilation-help"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>More Compilation Help</h2>
<p dir="auto">Look at the wiki at <a href="https://github.com/snesrev/zelda3/wiki">https://github.com/snesrev/zelda3/wiki</a> for more help.</p>
<p dir="auto">The ROM needs to be named <code>zelda3.sfc</code> and has to be from the US region with this exact SHA256 hash
<code>66871d66be19ad2c34c927d6b14cd8eb6fc3181965b6e517cb361f7316009cfb</code></p>
<p dir="auto">In case you&#39;re planning to move the executable to a different location, please include the file <code>tables/zelda3_assets.dat</code>.</p>
<h2 dir="auto"><a id="user-content-usage-and-controls" aria-hidden="true" href="#usage-and-controls"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage and controls</h2>
<p dir="auto">The game supports snapshots. The joypad input history is also saved in the snapshot. It&#39;s thus possible to replay a playthrough in turbo mode to verify that the game behaves correctly.</p>
<p dir="auto">The game is run with <code>./zelda3</code> and takes an optional path to the ROM-file, which will verify for each frame that the C code matches the original behavior.</p>
<table>
<thead>
<tr>
<th>Button</th>
<th>Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>Up</td>
<td>Up arrow</td>
</tr>
<tr>
<td>Down</td>
<td>Down arrow</td>
</tr>
<tr>
<td>Left</td>
<td>Left arrow</td>
</tr>
<tr>
<td>Right</td>
<td>Right arrow</td>
</tr>
<tr>
<td>Start</td>
<td>Enter</td>
</tr>
<tr>
<td>Select</td>
<td>Right shift</td>
</tr>
<tr>
<td>A</td>
<td>X</td>
</tr>
<tr>
<td>B</td>
<td>Z</td>
</tr>
<tr>
<td>X</td>
<td>S</td>
</tr>
<tr>
<td>Y</td>
<td>A</td>
</tr>
<tr>
<td>L</td>
<td>C</td>
</tr>
<tr>
<td>R</td>
<td>V</td>
</tr>
</tbody>
</table>
<p dir="auto">The keys can be reconfigured in zelda3.ini</p>
<p dir="auto">Additionally, the following commands are available:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tab</td>
<td>Turbo mode</td>
</tr>
<tr>
<td>W</td>
<td>Fill health/magic</td>
</tr>
<tr>
<td>Shift+W</td>
<td>Fill rupees/bombs/arrows</td>
</tr>
<tr>
<td>Ctrl+E</td>
<td>Reset</td>
</tr>
<tr>
<td>P</td>
<td>Pause (with dim)</td>
</tr>
<tr>
<td>Shift+P</td>
<td>Pause (without dim)</td>
</tr>
<tr>
<td>Ctrl+Up</td>
<td>Increase window size</td>
</tr>
<tr>
<td>Ctrl+Down</td>
<td>Decrease window size</td>
</tr>
<tr>
<td>T</td>
<td>Toggle replay turbo mode</td>
</tr>
<tr>
<td>O</td>
<td>Set dungeon key to 1</td>
</tr>
<tr>
<td>K</td>
<td>Clear all input history from the joypad log</td>
</tr>
<tr>
<td>L</td>
<td>Stop replaying a shapshot</td>
</tr>
<tr>
<td>R</td>
<td>Toggle between fast and slow renderer</td>
</tr>
<tr>
<td>F</td>
<td>Display renderer performance</td>
</tr>
<tr>
<td>F1-F10</td>
<td>Load snapshot</td>
</tr>
<tr>
<td>Alt+Enter</td>
<td>Toggle Fullscreen</td>
</tr>
<tr>
<td>Shift+F1-F10</td>
<td>Save snapshot</td>
</tr>
<tr>
<td>Ctrl+F1-F10</td>
<td>Replay the snapshot</td>
</tr>
<tr>
<td>1-9</td>
<td>run a dungeons playthrough snapshots</td>
</tr>
<tr>
<td>Ctrl+1-9</td>
<td>run a dungeons playthrough in turbo mode</td>
</tr>
</tbody>
</table>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">This project is licensed under the MIT license. See &#39;LICENSE.txt&#39; for details.</p>
</article>
          </div></div>
  </body>
</html>
