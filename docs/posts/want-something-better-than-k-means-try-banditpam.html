<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/motiwari/BanditPAM">Original</a>
    <h1>Show HN: Want something better than k-means? Try BanditPAM</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://github.com/motiwari/BanditPAM/actions/workflows/run_linux_tests.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/run_linux_tests.yml/badge.svg?branch=main" alt="Linux - build package and run tests"/></a>
<a href="https://github.com/motiwari/BanditPAM/actions/workflows/build_linux_wheels.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/build_linux_wheels.yml/badge.svg" alt="Linux - build source distribution and wheels"/></a>
<a href="https://github.com/motiwari/BanditPAM/actions/workflows/run_mac_tests.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/run_mac_tests.yml/badge.svg" alt="MacOS - build package and run tests"/></a>
<a href="https://github.com/motiwari/BanditPAM/actions/workflows/build_mac_wheels.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/build_mac_wheels.yml/badge.svg" alt="MacOS - build wheels"/></a>
<a href="https://github.com/motiwari/BanditPAM/actions/workflows/run_cmake_build.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/run_cmake_build.yml/badge.svg" alt="Run CMake build on MacOS"/></a>
<a href="https://github.com/motiwari/BanditPAM/actions/workflows/run_style_checks.yml"><img src="https://github.com/motiwari/BanditPAM/actions/workflows/run_style_checks.yml/badge.svg" alt="Run style checks"/></a></p>
<p dir="auto">This repo contains a high-performance implementation of BanditPAM from <a href="https://proceedings.neurips.cc/paper/2020/file/73b817090081cef1bca77232f4532c5d-Paper.pdf" rel="nofollow">BanditPAM: Almost Linear-Time k-Medoids Clustering</a>. The code can be called directly from Python, R, or C++.</p>
<p dir="auto">If you use this software, please cite:</p>
<p dir="auto">Mo Tiwari, Martin Jinye Zhang, James Mayclin, Sebastian Thrun, Chris Piech, Ilan Shomorony. &#34;BanditPAM: Almost Linear Time <em>k</em>-medoids Clustering via Multi-Armed Bandits&#34; Advances in Neural Information Processing Systems (NeurIPS) 2020.</p>
<div dir="auto" data-snippet-clipboard-copy-content="@inproceedings{BanditPAM,
  title={BanditPAM: Almost Linear Time k-medoids Clustering via Multi-Armed Bandits},
  author={Tiwari, Mo and Zhang, Martin J and Mayclin, James and Thrun, Sebastian and Piech, Chris and Shomorony, Ilan},
  booktitle={Advances in Neural Information Processing Systems},
  pages={368--374},
  year={2020}
}"><pre><span>@<span>inproceedings</span>{<span>BanditPAM</span>,</span>
<span>  <span>title</span><span>=</span>{<span>BanditPAM</span>: <span>Almost</span> <span>Linear</span> <span>Time</span> <span>k</span><span>-</span><span>medoids</span> <span>Clustering</span> <span>via</span> <span>Multi</span><span>-</span><span>Armed</span> <span>Bandits</span>},</span>
<span>  <span>author</span><span>=</span>{<span>Tiwari</span>, <span>Mo</span> <span>and</span> <span>Zhang</span>, <span>Martin</span> <span>J</span> <span>and</span> <span>Mayclin</span>, <span>James</span> <span>and</span> <span>Thrun</span>, <span>Sebastian</span> <span>and</span> <span>Piech</span>, <span>Chris</span> <span>and</span> <span>Shomorony</span>, <span>Ilan</span>},</span>
<span>  <span>booktitle</span><span>=</span>{<span>Advances</span> <span>in</span> <span>Neural</span> <span>Information</span> <span>Processing</span> <span>Systems</span>},</span>
<span>  <span>pages</span><span>=</span>{<span>368</span><span>-</span><span>-</span><span>374</span>},</span>
<span>  <span>year</span><span>=</span>{<span>2020</span>}</span>
<span>}</span></pre></div>


<p dir="auto">If you have any difficulties, please see the <a href="https://github.com/motiwari/BanditPAM#platform-specific-installation-guides">platform-specific guides</a> and file a Github issue if you have additional trouble.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-further-reading" aria-hidden="true" href="#further-reading"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Further Reading</h2>
<ul dir="auto">
<li><a href="https://proceedings.neurips.cc/paper/2020/file/73b817090081cef1bca77232f4532c5d-Paper.pdf" rel="nofollow">Full paper</a></li>
<li><a href="https://crossminds.ai/video/bandit-pam-almost-linear-time-k-medoids-clustering-via-multi-armed-bandits-5fb88782b0a3f6412973b646/" rel="nofollow">3-minute summary video</a></li>
<li><a href="https://ai.stanford.edu/blog/banditpam/" rel="nofollow">Blog post</a></li>
<li><a href="https://github.com/motiwari/BanditPAM">Code</a></li>
<li><a href="https://pypi.org/project/banditpam/" rel="nofollow">PyPI</a></li>
<li><a href="https://banditpam.readthedocs.io/en/latest" rel="nofollow">Documentation</a></li>
</ul>

<h2 tabindex="-1" dir="auto"><a id="user-content-install-the-repo-and-its-dependencies" aria-hidden="true" href="#install-the-repo-and-its-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Install the repo and its dependencies:</h2>
<p dir="auto">This can be done either through PyPI (recommended)</p>
<div dir="auto" data-snippet-clipboard-copy-content="/BanditPAM/: pip install -r requirements.txt
/BanditPAM/: pip install banditpam"><pre><span>/</span><span>BanditPAM</span><span>/</span>: <span>pip</span> <span>install</span> <span>-</span><span>r</span> <span>requirements</span>.<span>txt</span>
<span>/</span><span>BanditPAM</span><span>/</span>: <span>pip</span> <span>install</span> <span>banditpam</span></pre></div>
<p dir="auto">OR through the source code via</p>
<div dir="auto" data-snippet-clipboard-copy-content="/BanditPAM/: git submodule update --init --recursive
/BanditPAM/: cd headers/carma
/BanditPAM/: mkdir build &amp;&amp; cd build &amp;&amp; cmake -DCARMA_INSTALL_LIB=ON .. &amp;&amp; sudo cmake --build . --config Release --target install
/BanditPAM/: cd ../../..
/BanditPAM/: pip install -r requirements.txt
/BanditPAM/: sudo pip install ."><pre><span>/</span><span>BanditPAM</span><span>/</span>: <span>git</span> <span>submodule</span> <span>update</span> <span>-</span><span>-</span><span>init</span> <span>-</span><span>-</span><span>recursive</span>
<span>/</span><span>BanditPAM</span><span>/</span>: <span>cd</span> <span>headers</span><span>/</span><span>carma</span>
<span>/</span><span>BanditPAM</span><span>/</span>: <span>mkdir</span> <span>build</span> <span>&amp;</span><span>&amp;</span> <span>cd</span> <span>build</span> <span>&amp;</span><span>&amp;</span> <span>cmake</span> <span>-</span><span>DCARMA_INSTALL_LIB</span><span>=</span><span>ON</span> .. <span>&amp;</span><span>&amp;</span> <span>sudo</span> <span>cmake</span> <span>-</span><span>-</span><span>build</span> . <span>-</span><span>-</span><span>config</span> <span>Release</span> <span>-</span><span>-</span><span>target</span> <span>install</span>
<span>/</span><span>BanditPAM</span><span>/</span>: <span>cd</span> ..<span>/</span>..<span>/</span>..
<span>/</span><span>BanditPAM</span><span>/</span>: <span>pip</span> <span>install</span> <span>-</span><span>r</span> <span>requirements</span>.<span>txt</span>
<span>/</span><span>BanditPAM</span><span>/</span>: <span>sudo</span> <span>pip</span> <span>install</span> .</pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-example-1-synthetic-data-from-a-gaussian-mixture-model" aria-hidden="true" href="#example-1-synthetic-data-from-a-gaussian-mixture-model"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example 1: Synthetic data from a Gaussian Mixture Model</h3>
<div dir="auto" data-snippet-clipboard-copy-content="from banditpam import KMedoids
import numpy as np
import matplotlib.pyplot as plt

# Generate data from a Gaussian Mixture Model with the given means:
np.random.seed(0)
n_per_cluster = 40
means = np.array([[0,0], [-5,5], [5,5]])
X = np.vstack([np.random.randn(n_per_cluster, 2) + mu for mu in means])

# Fit the data with BanditPAM:
kmed = KMedoids(n_medoids=3, algorithm=&#34;BanditPAM&#34;)
kmed.fit(X, &#39;L2&#39;)

print(kmed.average_loss)  # prints 1.2482391595840454
print(kmed.labels)  # prints cluster assignments [0] * 40 + [1] * 40 + [2] * 40

# Visualize the data and the medoids:
for p_idx, point in enumerate(X):
    if p_idx in map(int, kmed.medoids):
        plt.scatter(X[p_idx, 0], X[p_idx, 1], color=&#39;red&#39;, s = 40)
    else:
        plt.scatter(X[p_idx, 0], X[p_idx, 1], color=&#39;blue&#39;, s = 10)

plt.show()"><pre><span>from</span> <span>banditpam</span> <span>import</span> <span>KMedoids</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
<span>import</span> <span>matplotlib</span>.<span>pyplot</span> <span>as</span> <span>plt</span>

<span># Generate data from a Gaussian Mixture Model with the given means:</span>
<span>np</span>.<span>random</span>.<span>seed</span>(<span>0</span>)
<span>n_per_cluster</span> <span>=</span> <span>40</span>
<span>means</span> <span>=</span> <span>np</span>.<span>array</span>([[<span>0</span>,<span>0</span>], [<span>-</span><span>5</span>,<span>5</span>], [<span>5</span>,<span>5</span>]])
<span>X</span> <span>=</span> <span>np</span>.<span>vstack</span>([<span>np</span>.<span>random</span>.<span>randn</span>(<span>n_per_cluster</span>, <span>2</span>) <span>+</span> <span>mu</span> <span>for</span> <span>mu</span> <span>in</span> <span>means</span>])

<span># Fit the data with BanditPAM:</span>
<span>kmed</span> <span>=</span> <span>KMedoids</span>(<span>n_medoids</span><span>=</span><span>3</span>, <span>algorithm</span><span>=</span><span>&#34;BanditPAM&#34;</span>)
<span>kmed</span>.<span>fit</span>(<span>X</span>, <span>&#39;L2&#39;</span>)

<span>print</span>(<span>kmed</span>.<span>average_loss</span>)  <span># prints 1.2482391595840454</span>
<span>print</span>(<span>kmed</span>.<span>labels</span>)  <span># prints cluster assignments [0] * 40 + [1] * 40 + [2] * 40</span>

<span># Visualize the data and the medoids:</span>
<span>for</span> <span>p_idx</span>, <span>point</span> <span>in</span> <span>enumerate</span>(<span>X</span>):
    <span>if</span> <span>p_idx</span> <span>in</span> <span>map</span>(<span>int</span>, <span>kmed</span>.<span>medoids</span>):
        <span>plt</span>.<span>scatter</span>(<span>X</span>[<span>p_idx</span>, <span>0</span>], <span>X</span>[<span>p_idx</span>, <span>1</span>], <span>color</span><span>=</span><span>&#39;red&#39;</span>, <span>s</span> <span>=</span> <span>40</span>)
    <span>else</span>:
        <span>plt</span>.<span>scatter</span>(<span>X</span>[<span>p_idx</span>, <span>0</span>], <span>X</span>[<span>p_idx</span>, <span>1</span>], <span>color</span><span>=</span><span>&#39;blue&#39;</span>, <span>s</span> <span>=</span> <span>10</span>)

<span>plt</span>.<span>show</span>()</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/motiwari/BanditPAM/blob/main/README_files/README_7_0.png"><img src="https://github.com/motiwari/BanditPAM/raw/main/README_files/README_7_0.png" alt="png"/></a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-example-2-mnist-and-its-medoids-visualized-via-t-sne" aria-hidden="true" href="#example-2-mnist-and-its-medoids-visualized-via-t-sne"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example 2: MNIST and its medoids visualized via t-SNE</h3>
<div dir="auto" data-snippet-clipboard-copy-content="# Start in the repository root directory, i.e. &#39;/BanditPAM/&#39;.
from banditpam import KMedoids
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.manifold import TSNE

# Load the 1000-point subset of MNIST and calculate its t-SNE embeddings for visualization:
X = pd.read_csv(&#39;data/MNIST_1k.csv&#39;, sep=&#39; &#39;, header=None).to_numpy()
X_tsne = TSNE(n_components=2).fit_transform(X)

# Fit the data with BanditPAM:
kmed = KMedoids(n_medoids=10, algorithm=&#34;BanditPAM&#34;)
kmed.fit(X, &#39;L2&#39;)

# Visualize the data and the medoids via t-SNE:
for p_idx, point in enumerate(X):
    if p_idx in map(int, kmed.medoids):
        plt.scatter(X_tsne[p_idx, 0], X_tsne[p_idx, 1], color=&#39;red&#39;, s = 40)
    else:
        plt.scatter(X_tsne[p_idx, 0], X_tsne[p_idx, 1], color=&#39;blue&#39;, s = 5)

plt.show()"><pre><span># Start in the repository root directory, i.e. &#39;/BanditPAM/&#39;.</span>
<span>from</span> <span>banditpam</span> <span>import</span> <span>KMedoids</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
<span>import</span> <span>pandas</span> <span>as</span> <span>pd</span>
<span>import</span> <span>matplotlib</span>.<span>pyplot</span> <span>as</span> <span>plt</span>
<span>from</span> <span>sklearn</span>.<span>manifold</span> <span>import</span> <span>TSNE</span>

<span># Load the 1000-point subset of MNIST and calculate its t-SNE embeddings for visualization:</span>
<span>X</span> <span>=</span> <span>pd</span>.<span>read_csv</span>(<span>&#39;data/MNIST_1k.csv&#39;</span>, <span>sep</span><span>=</span><span>&#39; &#39;</span>, <span>header</span><span>=</span><span>None</span>).<span>to_numpy</span>()
<span>X_tsne</span> <span>=</span> <span>TSNE</span>(<span>n_components</span><span>=</span><span>2</span>).<span>fit_transform</span>(<span>X</span>)

<span># Fit the data with BanditPAM:</span>
<span>kmed</span> <span>=</span> <span>KMedoids</span>(<span>n_medoids</span><span>=</span><span>10</span>, <span>algorithm</span><span>=</span><span>&#34;BanditPAM&#34;</span>)
<span>kmed</span>.<span>fit</span>(<span>X</span>, <span>&#39;L2&#39;</span>)

<span># Visualize the data and the medoids via t-SNE:</span>
<span>for</span> <span>p_idx</span>, <span>point</span> <span>in</span> <span>enumerate</span>(<span>X</span>):
    <span>if</span> <span>p_idx</span> <span>in</span> <span>map</span>(<span>int</span>, <span>kmed</span>.<span>medoids</span>):
        <span>plt</span>.<span>scatter</span>(<span>X_tsne</span>[<span>p_idx</span>, <span>0</span>], <span>X_tsne</span>[<span>p_idx</span>, <span>1</span>], <span>color</span><span>=</span><span>&#39;red&#39;</span>, <span>s</span> <span>=</span> <span>40</span>)
    <span>else</span>:
        <span>plt</span>.<span>scatter</span>(<span>X_tsne</span>[<span>p_idx</span>, <span>0</span>], <span>X_tsne</span>[<span>p_idx</span>, <span>1</span>], <span>color</span><span>=</span><span>&#39;blue&#39;</span>, <span>s</span> <span>=</span> <span>5</span>)

<span>plt</span>.<span>show</span>()</pre></div>

<p dir="auto">Please see <a href="https://github.com/motiwari/BanditPAM/tree/main/R_package/banditpam">here</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-documentation" aria-hidden="true" href="#documentation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Documentation</h2>
<p dir="auto">Documentation for BanditPAM can be found on <a href="https://banditpam.readthedocs.io/" rel="nofollow">read the docs</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-building-the-c-executable-from-source" aria-hidden="true" href="#building-the-c-executable-from-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Building the C++ executable from source</h2>
<p dir="auto">Please note that it is <em>NOT</em> necessary to build the C++ executable from source to use the Python code above. However, if you would like to use the C++ executable directly, follow the instructions below.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-option-1-building-with-docker" aria-hidden="true" href="#option-1-building-with-docker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Option 1: Building with Docker</h3>
<p dir="auto">We highly recommend building using Docker. One can download and install Docker by following instructions at the <a href="https://docs.docker.com/get-docker/" rel="nofollow">Docker install page</a>. Once you have Docker installed and the Docker Daemon is running, run the following commands:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM/scripts/docker$ chmod +x env_setup.sh
/BanditPAM/scripts/docker$ ./env_setup.sh
/BanditPAM/scripts/docker$ ./run_docker.sh"><pre><code>/BanditPAM/scripts/docker$ chmod +x env_setup.sh
/BanditPAM/scripts/docker$ ./env_setup.sh
/BanditPAM/scripts/docker$ ./run_docker.sh
</code></pre></div>
<p dir="auto">which will start a Docker instance with the necessary dependencies. Then:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM$ mkdir build &amp;&amp; cd build
/BanditPAM/build$ cmake .. &amp;&amp; make"><pre><code>/BanditPAM$ mkdir build &amp;&amp; cd build
/BanditPAM/build$ cmake .. &amp;&amp; make
</code></pre></div>
<p dir="auto">This will create an executable named <code>BanditPAM</code> in <code>BanditPAM/build/src</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-option-2-installing-requirements-and-building-directly" aria-hidden="true" href="#option-2-installing-requirements-and-building-directly"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Option 2: Installing requirements and building directly</h3>
<p dir="auto">Building this repository requires four external requirements:</p>
<ul dir="auto">
<li><a href="https://cmake.org/download/" rel="nofollow">CMake</a> &gt;= 3.17</li>
<li><a href="http://arma.sourceforge.net/download.html" rel="nofollow">Armadillo</a> &gt;= 10.5.3</li>
<li><a href="https://www.openmp.org/resources/openmp-compilers-tools/" rel="nofollow">OpenMP</a> &gt;= 2.5 (OpenMP is supported by default on most Linux platforms, and can be downloaded through <a href="https://brew.sh/" rel="nofollow">homebrew</a> on MacOS)</li>
<li><a href="https://github.com/RUrlus/carma">CARMA</a> &gt;= 0.6.2</li>
</ul>
<p dir="auto">If installing these requirements from source, one can generally use the following procedure to install each requirement from the library&#39;s root folder (with <code>armadillo</code> used as an example here):</p>
<div data-snippet-clipboard-copy-content="/armadillo$ mkdir build &amp;&amp; cd build
/armadillo/build$ cmake .. &amp;&amp; make &amp;&amp; sudo make install"><pre><code>/armadillo$ mkdir build &amp;&amp; cd build
/armadillo/build$ cmake .. &amp;&amp; make &amp;&amp; sudo make install
</code></pre></div>
<p dir="auto">Note that <code>CARMA</code> has different installation instructions; see <a href="https://github.com/RUrlus/carma#installation">its instructions</a>.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-platform-specific-installation-guides" aria-hidden="true" href="#platform-specific-installation-guides"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Platform-specific installation guides</h4>
<p dir="auto">Further installation information for <a href="https://github.com/motiwari/BanditPAM/blob/main/docs/install_mac.md">MacOS</a>, <a href="https://github.com/motiwari/BanditPAM/blob/main/docs/install_linux.md">Linux</a>, and <a href="https://github.com/motiwari/BanditPAM/blob/main/docs/install_windows.md">Windows</a> is available in the <a href="https://github.com/motiwari/BanditPAM/blob/main/docs">docs folder</a>. Ensure all the requirements above are installed and then run:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM$ mkdir build &amp;&amp; cd build
/BanditPAM/build$ cmake .. &amp;&amp; make"><pre><code>/BanditPAM$ mkdir build &amp;&amp; cd build
/BanditPAM/build$ cmake .. &amp;&amp; make
</code></pre></div>
<p dir="auto">This will create an executable named <code>BanditPAM</code> in <code>BanditPAM/build/src</code>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-c-usage" aria-hidden="true" href="#c-usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>C++ Usage</h2>
<p dir="auto">Once the executable has been built, it can be invoked with:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM/build/src/BanditPAM -f [path/to/input.csv] -k [number of clusters]"><pre><code>/BanditPAM/build/src/BanditPAM -f [path/to/input.csv] -k [number of clusters]
</code></pre></div>
<ul dir="auto">
<li><code>-f</code> is mandatory and specifies the path to the dataset</li>
<li><code>-k</code> is mandatory and specifies the number of clusters with which to fit the data</li>
</ul>
<p dir="auto">For example, if you ran <code>./env_setup.sh</code> and downloaded the MNIST dataset, you could run:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM/build/src/BanditPAM -f ../data/MNIST_1k.csv -k 10"><pre><code>/BanditPAM/build/src/BanditPAM -f ../data/MNIST_1k.csv -k 10
</code></pre></div>
<p dir="auto">The expected output in the command line will be:</p>
<div data-snippet-clipboard-copy-content="Medoids: 694,168,306,714,324,959,527,251,800,737"><pre><code>Medoids: 694,168,306,714,324,959,527,251,800,737
</code></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-implementing-a-custom-distance-metric" aria-hidden="true" href="#implementing-a-custom-distance-metric"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Implementing a custom distance metric</h2>
<p dir="auto">One of the advantages of <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="a7beadeea10913847caf837b5c45c433">$k$</math-renderer>-medoids is that it works with arbitrary distance metrics; in fact, your &#34;metric&#34; need not even be a real metric -- it can be negative, asymmetric, and/or not satisfy the triangle inequality or homogeneity. Any pairwise dissimilarity function works with <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="a7beadeea10913847caf837b5c45c433">$k$</math-renderer>-medoids.</p>
<p dir="auto">This also allows for clustering of &#34;exotic&#34; objects like trees, graphs, natural language, and more -- settings where running <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="a7beadeea10913847caf837b5c45c433">$k$</math-renderer>-means wouldn&#39;t even make sense. We talk about one such setting in the <a href="https://proceedings.neurips.cc/paper/2020/file/73b817090081cef1bca77232f4532c5d-Paper.pdf" rel="nofollow">full paper</a>.</p>
<p dir="auto">The package currently supports a number of distance metrics, including all <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="a7beadeea10913847caf837b5c45c433">$L_p$</math-renderer> losses and cosine distance.</p>
<p dir="auto">If you&#39;re willing to write a little C++, you only need to add a few lines to <a href="https://github.com/motiwari/BanditPAM/blob/main/src/kmedoids_algorithm.cpp#L560-L615">kmedoids_algorithm.cpp</a> and <a href="https://github.com/motiwari/BanditPAM/blob/main/headers/kmedoids_algorithm.hpp#L136-L142">kmedoids_algorithm.hpp</a> to implement your distance metric / pairwise dissimilarity!</p>
<p dir="auto">Then, be sure to re-install the repository with a <code>pip install .</code> (note the trailing <code>.</code>).</p>
<p dir="auto">The maintainers of this repository are working on permitting arbitrary dissimilarity metrics that users write in Python, as well; see <a href="https://github.com/motiwari/BanditPAM/issues/4" data-hovercard-type="issue" data-hovercard-url="/motiwari/BanditPAM/issues/4/hovercard">#4</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-testing" aria-hidden="true" href="#testing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Testing</h2>
<p dir="auto">To run the full suite of tests, run in the root directory:</p>
<div data-snippet-clipboard-copy-content="/BanditPAM$ python -m unittest discover -s tests"><pre><code>/BanditPAM$ python -m unittest discover -s tests
</code></pre></div>
<p dir="auto">Alternatively, to run a &#34;smaller&#34; set of tests, from the main repo folder run <code>python tests/test_smaller.py</code> or <code>python tests/test_larger.py</code> to run a set of longer, more intensive tests.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-credits" aria-hidden="true" href="#credits"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Credits</h2>
<p dir="auto">Mo Tiwari wrote the original Python implementation of BanditPAM and many features of the C++ implementation. Mo now maintains the C++ implementation.</p>
<p dir="auto">James Mayclin developed the initial C++ implementation of BanditPAM.</p>
<p dir="auto">The original BanditPAM paper was published by Mo Tiwari, Martin Jinye Zhang, James Mayclin, Sebastian Thrun, Chris Piech, and Ilan Shomorony.</p>
<p dir="auto">We would like to thank Jerry Quinn, David Durst, Geet Sethi, and Max Horton for helpful guidance regarding the C++ implementation.</p>
</article>
          </div></div>
  </body>
</html>
