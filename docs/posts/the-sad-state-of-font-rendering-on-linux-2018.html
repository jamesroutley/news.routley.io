<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pandasauce.org/post/linux-fonts/">Original</a>
    <h1>The sad state of font rendering on Linux (2018)</h1>
    
    <div id="readability-page-1" class="page"><div>
      <p><strong>Preamble</strong></p>
<p>As it turns out, font rendering is a highly controversial topic. If you don’t see anything wrong with Linux font rendering, please disregard this as a shitpost. Thanks.</p>
<p>I spent the first 25 years of my life on Windows and therefore I am biased towards Windows font rendering with ClearType. I also agree with <a href="https://blogs.msdn.microsoft.com/e7/2009/06/23/engineering-changes-to-cleartype-in-windows-7/">research which suggests that</a> <a href="https://blogs.msdn.microsoft.com/fontblog/2008/07/16/cleartype-improves-the-efficiency-of-typical-office-tasks/">this rendering approach</a> <a href="https://docs.microsoft.com/en-gb/typography/cleartype/index">makes reading easier on the eyes</a>. There are also some facts you can’t argue with, such as non-linear rendering without anti-aliasing looking awful.</p>
<p>With that out of the way, let’s proceed.</p>

<p>Fonts are vector data that gets rasterized when displayed to the user. Computer displays are low-DPI devices for complex reasons, and such DPI (96) is not enough to display fonts without a myriad of trade-offs. Most notable are sub-pixel rendering, sub-pixel positioning, font hinting and anti-aliasing. You can read up more <a href="https://freddie.witherden.org/pages/font-rasterisation/">here</a> and <a href="http://www.antigrain.com/research/font_rasterization/">here</a> if you want the full background.</p>
<p>Each operating system approaches font rendering differently. To get Windows-like rendering that I prefer, anti-aliasing, sub-pixel rendering, sub-pixel positioning and font hinting based on byte code embedded into fonts - basically, every step of the technological progress made in the last 30 years - need to be active.</p>

<p>Simply put, Windows uses every font rendering improvement technology available <em>and</em> goes a step further to use fonts specifically designed to look great when combined with this technology. It is state of the art and then some.</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-3.png" alt=""/></p>
<p>One obvious thing you can see on the zoomed in part of the image is that black and white text is not actually black and white on Windows 7. Since sub-pixel rendering relies on toggling red, green and blue parts of a single pixel, it introduces <em>colour fringing</em>. A small percentage of people can see so well, that they actually notice this when reading. They can disable this feature at the cost of less sharp fonts or migrate to Windows 8 or newer.</p>
<p>Windows font rendering keeps changing with every new version of the OS. Windows 7 had the sharpest fonts, while from Windows 8 onwards Microsoft went back to grayscale font smoothing, resulting in blurrier fonts without colour fringing. This is how FreeType code in <code>/include/freetype/ftdriver.h</code> documents Windows font rendering evolution over time:</p>
<table>
<thead>
<tr>
<th>GETINFO</th>
<th>framework</th>
<th>version</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>GDI (Win 3.1),</td>
<td>v1.0</td>
<td>16-bit, first version</td>
</tr>
<tr>
<td>TrueImage</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>33</td>
<td>GDI (Win NT 3.1),</td>
<td>v1.5</td>
<td>32-bit</td>
</tr>
<tr>
<td>HP Laserjet</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>34</td>
<td>GDI (Win 95)</td>
<td>v1.6</td>
<td>font smoothing,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>new SCANTYPE opcode</td>
<td></td>
</tr>
<tr>
<td>35</td>
<td>GDI (Win 98, 2000)</td>
<td>v1.7</td>
<td>(UN)SCALED_COMPONENT_OFFSET</td>
</tr>
<tr>
<td></td>
<td></td>
<td>bits in composite glyphs</td>
<td></td>
</tr>
<tr>
<td>36</td>
<td>MGDI (Win CE 2)</td>
<td>v1.6+</td>
<td>classic ClearType</td>
</tr>
<tr>
<td>37</td>
<td>GDI (XP and later),</td>
<td>v1.8</td>
<td>ClearType</td>
</tr>
<tr>
<td>GDI+ old (before Vista)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>38</td>
<td>GDI+ old (Vista, Win 7),</td>
<td>v1.9</td>
<td>subpixel ClearType,</td>
</tr>
<tr>
<td>WPF</td>
<td></td>
<td>Y-direction ClearType,</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>additional error checking</td>
<td></td>
</tr>
<tr>
<td>39</td>
<td>DWrite (before Win 8)</td>
<td>v2.0</td>
<td>subpixel ClearType flags</td>
</tr>
<tr>
<td></td>
<td></td>
<td>in GETINFO opcode,</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>bug fixes</td>
<td></td>
</tr>
<tr>
<td>40</td>
<td>GDI+ (after Win 7),</td>
<td>v2.1</td>
<td>Y-direction ClearType flag</td>
</tr>
<tr>
<td>DWrite (Win 8)</td>
<td></td>
<td>in GETINFO opcode,</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Gray ClearType</td>
<td></td>
</tr>
</tbody>
</table>
<p>I don’t see colour fringing, so my preference is 39/DWrite/v2.0 rendering of Windows 7.</p>

<p><strong>OS X</strong> has the absolute worst font rendering from the readability aspect. It does not use hinting at all and relies only on grayscale anti-aliasing. This combination makes everything appear very bold and blurry:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-1.png" alt=""/></p>
<p>There is not even a hint of any consistency in the rendering either, thickness is all over the place even within a single glyph, with different strokes “sticking” together because of the lack of pixels:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-2.png" alt=""/></p>
<p>This distracts your subconsciousness and wastes attention on just recognizing glyphs and their edges, resulting in massive eye strain. Don’t believe me? Do a controlled reading speed experiment against Windows.</p>
<p>When this blog post got featured on Reddit and HackerNews, a number of people pointed out that prior to Mojave, which was the latest release at the time the post was written, OS X used to have sub-pixel anti-aliasing, text rendering was great, I was wrong and Apple did not deserve the hate. To verify this, I temporarily got my hands on a box running High Sierra and did some comparisons.</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-4.png" alt=""/></p>
<p>As you can see here, indeed, OS X had sub-pixel anti-aliasing in High Sierra, which provided less boldness and bluriness with somewhat better consistency in glyph thickness. However, colour fringing on High Sierra is rather apparent. Rendering is still rather blurry, closer to the FreeType auto-hinter than to what <em>I</em> would consider an optimal result.</p>
<p>I have not reverse-engineered Apple’s font rendering code, but this would explain what I am seeing:</p>
<ul>
<li>Microsoft patented ClearType rendering and Apple took care not to step on their toes</li>
<li>Sub-pixel rendering techniques patented in ClearType may have a better trade-off between colour fringing and sharpness than those used in Apple’s Quartz</li>
<li>Apple uses sub-pixel positioning and anti-aliasing, but does not use hinting or uses something akin to FreeType’s autohinter</li>
<li>In case of grayscale anti-aliasing, everything is extra bold because full pixels instead of sub-pixels have to be used for font smoothing, and this distorts the glyph massively as horizontal resolution now is roughly 3 times smaller</li>
<li>In case of sub-pixel positioning without respecting the sub-pixel grid, as is the case with grayscale anti-aliasing and no hinting on Mojave, stroke thickness consistency goes out of the window, because you have just increased the number of stroke thickness variations that you need to render while also reducing your ability to render them accurately</li>
</ul>
<p>For decades OS X remained a very ugly baby, until in 2015 Apple just gave us <del>courage</del> HiDPI in form of Retina. This was a bid to make all hinting technology obsolete and put everyone else to shame with their old fashioned sub-pixel hacks.</p>
<p>Here is what Apple didn’t account for, or <a href="https://www.youtube.com/watch?v=9IG3zqvUqJY">accepted the risk for</a>:</p>
<ul>
<li>An overwhelming majority of legacy software has 96 DPI hardcoded into it</li>
<li>Software maintainers didn’t buy into the idea of massive code rewrites and UI tinkering to support DPIs other than 96, because the costs are high and incentives are nil</li>
<li>In the case of mixed use of HiDPI and non-HiDPI displays, you need to somehow scale the entire UI back-and-forth when moved between displays, which introduces more hacks and corner cases where end result is more suboptimal than before</li>
<li>Windows never had the font rendering problems that Apple did, so:
<ul>
<li>Majority of screens currently in use are non-HiDPI, meaning you are almost guaranteed to run into the mixed DPI use case</li>
<li>Majority of screens currently in use will not be upgraded to HiDPI until they break or corporate hardware upgrade cycles kick in, because majority of the market share is covered by Microsoft’s approach, which doesn’t need HiDPI to produce easily readable text</li>
<li>Majority of screens currently in use will not be upgraded to HiDPI even when they get replaced, because HiDPI costs extra for no obvious benefit to your average consumer or corporation</li>
</ul>
</li>
</ul>
<p>As a result, all major operating systems have introduced (OS X, Windows) or are working on introducing (Linux) a workaround for cases where HiDPI either is not supported by the application or mixed DPI screens are used.</p>
<p>It boils down to having a primary DPI, used to rasterize fonts, and a per-display DPI, which the operating system uses to resize applications when they enter that display. For applications that don’t support HiDPI, their entire UI just gets upscaled.</p>
<p>Resizing happens using the image already rasterized at a different DPI. This results in the entire UI of that application being blurry, both for scaling down and for scaling up.</p>
<p>Sometimes the operating system also needs to make a guess whether the application in question supports HiDPI or not, which can result in further cases of poor rendering where it shouldn’t be poor.</p>
<p>Finally, we have the use case of applications spanning multiple displays, either because the user needs it, or just because at that point in time the window is being dragged between screens.</p>
<p>If you embraced the Apple ecosystem lock-in and Retina-only setups, you are probably loving it. Everyone else, likely to include Apple developers supporting these corner cases and users experiencing those cases, not so much.</p>
<p>As of 2019, HiDPI experience is still a mixed bag that solves one simple problem at the cost of introducing multiple complex problems. It made rendering code more complex than ever before while providing a user experience that is worse than ever before.</p>

<p>Linux distros use the <strong>FreeType</strong> library for rendering fonts. FreeType comes with 3 different engines for interpreting TrueType hinting instructions: v35, v38, v40. It also includes an autohinter (a.k.a. autofitter), which ignores the byte code instructions embedded into the fonts and tries to hint fonts automatically.</p>
<p><strong>v35</strong> is the legacy engine that is used by default on more risk-averse distros, notably RHEL derivatives. Usually it is compiled without the use of any patent-infringing technologies. It used to be the default in the mainline code base before v40 came around. This is what it looks like:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v35-1.png" alt=""/></p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v35-2.png" alt=""/></p>
<p>While it looks fantastic on the first image, once you put different font sizes next to it on the second image, you can immediately see the problem with this engine.</p>
<p><strong>v38</strong> is the “Infinality” engine. Infinality was a set of patches for earlier versions of FreeType that focused on ignoring patent issues and just getting the best possible font rendering in. Some of those were merged into mainline FreeType, but not enabled by default. The author of the patches eventually vanished and I can’t vouch for how much of it is in and how actively it is maintained by the man behind FreeType. This is what it looks like:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v38-1.png" alt=""/></p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v38-2.png" alt=""/></p>
<p>It is somewhat less sharp, but more smooth. The issues on the second image are less apparent, but still very obviously there.</p>
<p>There is widespread criticism stating that font rendering is <em>visibly</em> slower on v38 because of all those patches, supported by <a href="https://www.freetype.org/freetype2/docs/subpixel-hinting.html">this post on FreeType website</a>. I couldn’t find any profiling with comparisons and for the life of me I can’t see the <em>visibly</em> slower rendering.</p>
<p><strong>v40</strong> is the new engine, based on stripped down Infinality code, as described <a href="https://www.freetype.org/freetype2/docs/subpixel-hinting.html">in the same blog post</a>. This engine uses Microsoft patented technology where the patents have expired and is usually compiled with patent infringing code activated. This is what it looks like:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v40-1.png" alt=""/></p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-v40-2.png" alt=""/></p>
<p>There are some differences if you compare pixel by pixel and obviously the kerning is different.</p>
<p>Ubuntu also enables other patented technologies disabled by default in FreeType: ClearType sub-pixel rendering and “GX/AAT table validation”. You can read more about the patents in <a href="http://david.freetype.org/cleartype-patents.html">David Turner’s blog post</a>, but I haven’t noticed any impact of table validation code on the fonts that I see every day.</p>
<p>Finally, the <strong>autohinter</strong>:</p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-autohint-1.png" alt=""/></p>
<p><img src="https://pandasauce.org/images/fonts/exhibit-autohint-2.png" alt=""/></p>
<p>Thickness linearity between font sizes on the second image is fantastic. But compare the overall thickness at standard web font size (16px) to any other option and you will see that this comes at the cost of making everything bold by default:</p>
<p><img src="https://pandasauce.org/images/fonts/all-compared.png" alt=""/></p>
<p><em>Note: I am working on an updated version of this comparison that includes FreeType Harmony sub-pixel rendering, Windows 10 and OS X samples.</em></p>
<p>It is also very easy to tell which option is the most blurry and difficult to read on this image.</p>
<p>With all these side-by-side, my preferred Linux option is v38 engine. In less perfect conditions (e.g. non black-and-white text), v40 seems easier on the eyes.</p>
<p>If anyone wants more screenshots to compare, here are some:</p>
<ul>
<li><a href="https://pandasauce.org/images/fonts/more-hires/HighSierra-LCD.png">High Sierra, LCD font smoothing enabled</a></li>
<li><a href="https://pandasauce.org/images/fonts/more-hires/HighSierra-noLCD.png">High Sierra, LCD font smoothing disabled</a></li>
<li><a href="https://pandasauce.org/images/fonts/more-hires/Mojave.png">Mojave</a></li>
<li><a href="https://pandasauce.org/images/fonts/more-hires/Windows7.png">Windows 7</a></li>
<li><a href="https://pandasauce.org/images/fonts/more-hires/Linux.png">Linux (v38, sub-pixel, ClearType branch, sub-pixel positioning, Skia)</a></li>
</ul>
<p>Funnily enough, in my adventures I learned that some people prefer the fuzzy and blurry rendering of OS X defaults on Windows. They found a way to replace the Windows rendering engine with FreeType for this purpose and the tool is called <a href="https://github.com/snowie2000/mactype">MacType</a>. Since FreeType is highly configurable, it allows you to disable hinting and mimic OS X approach to rendering fonts. You will see below why this actually makes for a worse user experience without even talking about stability issues that this is bound to introduce.</p>
<p>Some users even disable all sub-pixel rendering and anti-aliasing, <a href="https://ledstrain.org/d/47-anti-aliased-fonts-can-damage-eyesight-writeup">claiming that it reduces eyestrain and that anti-aliasing damages eyesight</a>. It’s kind of like anti-vaxxing (hello from 2019 if you are reading this in the future).</p>
<h2 id="the-ugliest-part">The ugliest part</h2>
<p>With current state of Linux, it does not matter which engine you pick. <a href="https://savannah.nongnu.org/bugs/?54555">They all are broken in the same way</a>:</p>
<p><a href="https://pandasauce.org/images/fonts/widths-merged-boxes.png"><img src="https://pandasauce.org/images/fonts/widths-bci-boxed.png" alt=""/></a></p>
<p>There is a pixel or less of extra space between kerning pairs and the problem grows exponentially when letter-spacing values are fiddled with:</p>
<p><img src="https://pandasauce.org/images/fonts/72-zoomed-in-whitespace-1px.png" alt=""/></p>
<p><img src="https://pandasauce.org/images/fonts/zoomed-in-remove-1px.png" alt=""/></p>
<p>Before someone jumps in and says “stop using Microsoft fonts”, here is the exact same behaviour exhibited when rendering Liberation Sans, the font most commonly recommended to replace standard web ones:</p>
<p><img src="https://pandasauce.org/images/fonts/72-liberation-browser.png" alt=""/></p>
<p>This is because for a very long time Linux did not support the sub-pixel grid at any level and a lot of assumptions were made. One of such assumptions was that glyph positions have to be whole integers, and those integers were mapped to whole pixels. Of course, with sub-pixel rendering that is no longer the case, so poor rounding decisions result in what you see above.</p>
<p>The solution to this is to position glyphs with sub-pixel precision. For a ridiculously long time, Google’s Skia <a href="https://savannah.nongnu.org/bugs/?54555#comment12">was the only rendering library that supported it</a>.</p>
<p>Even now, Chromium still has it disabled by default, but <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=824153#c39">this awesome <del>bug</del> feature</a> lets you enable it by starting Chromium-based applications with <code>--disable-font-subpixel-positioning</code> flag. Yes, I know, it says “disable”, but it does the opposite as of v76. I’ve <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=824153#c38">submitted patches</a> to make this the default behaviour, but I have no idea how to get them merged and how long it will take for these patches to trickle down into all apps that use Chromium: Electron, Spotify and Slack come to mind.</p>
<p><del>The problem with this is that Google’s Skia <a href="https://savannah.nongnu.org/bugs/?54555#comment12">is the only rendering library that supports it</a>, and even there <a href="https://chromium.googlesource.com/chromium/src/+/0b71f14/ui/gfx/font_render_params_linux.cc#283">it is disabled by default</a>. I am maintaining a <a href="https://gist.github.com/pandasauce/398c080f9054f05bee6e1c465416b53b">gist with binary patches for Chrome</a> until <a href="https://crbug.com/824153#c7">my proposal to enable it</a> gets accepted upstream, but it doesn’t help with the rest of the system.</del></p>
<p><del>More about it can be read in <a href="https://docs.google.com/document/d/14IQEWrVS0wydzpTAMbvJep7HnX9t-ljuxFwTToSbOVk/edit#heading=h.bjsw53t8jqke">Behdad Esfahbod’s whitepaper</a> on linear rendering. He also <a href="https://lists.cairographics.org/archives/cairo/2008-May/014149.html">documented how to fix it</a> back in 2008, and the amount of effort required pretty much meant that we may be stuck with it forever. GTK maintainers <a href="https://lists.cairographics.org/archives/cairo/2018-November/028796.html">attempted to pick this up</a> recently, but it broke some tests that they <a href="https://gitlab.gnome.org/GNOME/gtk/issues/7#note_444385">could not quite figure out</a> and thus Cairo team ignored the patch.</del></p>
<p>By the time I was updating this post in August 2019, Cairo received support for sub-pixel positioning in both <a href="https://gitlab.freedesktop.org/cairo/cairo/commit/e4a79db0108be6a2b06dfce51a44bcbdead66ebd">xlib</a> and <a href="https://gitlab.freedesktop.org/cairo/cairo/commit/ea9329215d3431ded51a71b724baf0edc25ad633">image</a> compositors. This means that <a href="https://gitlab.gnome.org/GNOME/gtk/issues/7">GTK will soon have it too</a>, as well as <a href="https://blogs.gnome.org/mclasen/2019/08/07/pango-1-44-wrap-up/">Pango</a> and basically anything that relies on Cairo to render text. I am looking forward to the next Ubuntu LTS and might make a separate post about compiling this into the current Ubuntu LTS.</p>
<p>On top of sub-pixel positioning, we have this kind of <del>bullshit</del> weird behaviour in some programs, and that has nothing to do with sub-pixels:</p>
<p><img src="https://pandasauce.org/images/fonts/reader.png" alt=""/></p>
<p>This has to do with how those particular programs treat system font rendering settings and reconfigure the underlying libraries. It is on <a href="https://pandasauce.org/get-fonts-done/">my TODO list</a> to look into this too, but not with a particularly high priority ranking.</p>
<p><del>At this point, I give up. Font rendering on Linux is broken, very few people care, and those that do (like myself) are too busy with our day jobs to figure out all the prerequisite knowledge needed to fix it, let alone actually fix it.</del></p>

<p>Whichever engine you go with on Linux, there will be a few more things to address.</p>
<h2 id="fontconfig">Fontconfig</h2>
<p>On top of FreeType there is the <code>fontconfig</code> configuration layer that allows to toggle the technologies mentioned above on or off for different fonts, their size ranges and so on. Technically, you could have two completely opposite settings for two different font sizes or weights of the same font. You can <a href="https://www.freedesktop.org/software/fontconfig/fontconfig-user.html">read the official docs</a> for the full details.</p>
<h2 id="microsoft-fonts">Microsoft Fonts</h2>
<p>When you are browsing the internet, a lot of websites make implicit assumptions about your default fonts. If you are coming from the Windows world, a lot of websites will look weird to you and page rendering may be downright broken if the fonts are missing from your system, e.g. plain text files opened in Chrome will have overlapping lines. To fix it, you need to get Windows fonts installed.</p>
<p>The traditional way of achieving this is through installing <code>ttf-mscorefonts-installer</code> or <code>msttcorefonts</code>. The <code>msttcorefonts</code> package looks like some Shenzhen basement knockoff that renders poorly and doesn’t support Unicode. I suspect that these fonts have gone through multiple iterations in every Windows release and that the versions available through the repositories must be from around Windows 95 days.</p>
<p>Try generating some <a href="http://www.eeemo.net/">Zalgo</a> and see the empty boxes for yourself. These are <em>not</em> the same fonts included in your Windows installation. If you have these packages installed, ditch them prior to continuing.</p>
<p>The workaround is to grab the fonts from your Windows installation. I Am Not A Lawyer and if you are worried about this going against Microsoft licensing, get legal advice. I just know that it would be illegal for me to provide you with the files, therefore: the fonts are available in <code>C:\Windows\Fonts</code>. You need the following files:</p>
<pre><code>arialbd.ttf   ARIALNB.TTF  ariblk.ttf    consolai.ttf  courbi.ttf    georgiai.ttf  segoeprb.ttf  segoeuib.ttf  segoeuiz.ttf  timesbi.ttf   trebucbi.ttf  verdanai.ttf
arialbi.ttf   ARIALNI.TTF  comicbd.ttf   consola.ttf   couri.ttf     georgia.ttf   segoepr.ttf   segoeuii.ttf  tahomabd.ttf  timesi.ttf    trebucit.ttf  verdana.ttf
ariali.ttf    ARIALN.TTF   comic.ttf     consolaz.ttf  cour.ttf      georgiaz.ttf  segoescb.ttf  segoeuil.ttf  tahoma.ttf    times.ttf     trebuc.ttf    verdanaz.ttf
ARIALNBI.TTF  arial.ttf    consolab.ttf  courbd.ttf    georgiab.ttf  impact.ttf    segoesc.ttf   segoeui.ttf   timesbd.ttf   trebucbd.ttf  verdanab.ttf  webdings.ttf
</code></pre><p>Depending on how you access that directory, you may have to copy the files based on font family names:</p>
<ul>
<li>Arial</li>
<li>Comic Sans MS</li>
<li>Consolas</li>
<li>Courier New</li>
<li>Georgia</li>
<li>Segoe UI</li>
<li>Times New Roman</li>
<li>Trebuchet MS</li>
<li>Impact</li>
<li>Verdana</li>
<li>Webdings</li>
</ul>
<p>The files go in <code>/usr/share/fonts/MAKE_UP_A_FOLDER_NAME</code>.</p>
<h2 id="gimp">GIMP</h2>
<p>If you use GIMP, you may notice weird artifacts in the Text Tool. Create <code>/etc/gimp/2.0/fonts.conf</code>:</p>
<div><pre><code data-lang="xml"><span>&lt;fontconfig&gt;</span>
  <span>&lt;match</span> <span>target=</span><span>&#34;font&#34;</span><span>&gt;</span>
    <span>&lt;edit</span> <span>name=</span><span>&#34;rgba&#34;</span> <span>mode=</span><span>&#34;assign&#34;</span><span>&gt;</span>
      <span>&lt;const&gt;</span>none<span>&lt;/const&gt;</span>
    <span>&lt;/edit&gt;</span>
  <span>&lt;/match&gt;</span>
<span>&lt;/fontconfig&gt;</span>
</code></pre></div><h2 id="noto-font">Noto Font</h2>
<p><a href="https://www.google.com/get/noto/">Noto</a> font family is an excellent font that supports all the different languages and symbols. It generally provides a better experience on Linux than the standard Microsoft fonts, without looking too different. It comes in sans, serif and monospace editions, which covers all the OS needs. Install it like this:</p>
<div><pre><code data-lang="shell">$ sudo apt install fonts-noto
</code></pre></div>
<ul>
<li>Hinting: <code>Slight</code>, which translates to “autohint”. I suggest it because it exhibits the advance widths rounding issue in kerning pairs the least. Personally, I use full hinting with v38.</li>
<li>Anti-aliasing: <code>Subpixel</code></li>
<li>Window Titles: <code>Noto Sans UI Regular 11</code> or <code>Noto Sans Display Regular 11</code> (renamed in newer versions)</li>
<li>Interface: <code>Noto Sans UI Regular 10</code> or <code>Noto Sans Display Regular 10</code> (renamed in newer versions)</li>
<li>Documents: <code>Noto Serif Regular 11</code></li>
<li>Monospace: <code>Noto Mono Regular 13</code></li>
</ul>
<h2 id="application-settings">Application Settings</h2>
<p>I find that different applications render best with certain font sizes set. Most likely, this is because it forces the least broken glyph form in absence of subpixel positioning which would give me a non-broken glyph.</p>
<p>Here they are:</p>
<ul>
<li>Terminator: <code>Ubuntu Mono 13.5</code></li>
<li>Sublime Text: <code>Ubuntu Mono 13.4</code>, <code>padding-top 4</code>, <code>padding-bottom 4</code></li>
<li>IntelliJ: <code>Ubuntu Mono 18</code>, <code>line height 1.4</code></li>
<li>Chrome, Spotify, Slack, Electron apps: add <code>--disable-font-subpixel-positioning</code> to the shortcut. I used to <a href="https://gist.github.com/pandasauce/398c080f9054f05bee6e1c465416b53b">manually patch every binary release of Chrome</a> to enable subpixel positioning, but thanks to <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=824153#c39">this bug in Chromium</a> that turned out to be not necessary.</li>
</ul>

<p>Whether it was this post gaining traction or just the natural flow of life, but things have improved since the first edition of this post. I am grateful to everyone who contributed code, to everyone who reached out to point out inaccuracies in earlier editions of this post and to everyone who reached out suggesting workarounds for me to try out.</p>
    </div></div>
  </body>
</html>
