<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gist.github.com/aileftech/dd4f5598b1f3837651fdf16e5abc3ffb">Original</a>
    <h1>Bash one-liner to produce a list of HEX color codes that read like English words</h1>
    
    <div id="readability-page-1" class="page"><div>
  <task-lists disabled="" sortable="">
    <div>
      <p dir="auto">Pretty gosh darn happy with this now c:</p>
<p dir="auto">Not pure bash, I think that the <code>coreutils</code>&#39;s conciseness (<code>tr</code>, <code>fold</code>, <code>xargs</code>) is indispensable and grep is just so much faster (something does feel a little slow, donno if it&#39;s the sub-shells, or the arrays, haven&#39;t put my finger on it). I think it&#39;s concise, and clear... so long as one knows <code>&lt;&lt;&lt;</code>, <code>&lt;()</code>, <code>IFS</code>, and overlooks the entire <code>BG_RGB</code> pipeline (for which one ought to know a relatively obscure feature of <code>printf</code>, <code>xargs</code>, and (new to me) <code>fold</code>). Gotta love shell.</p>
<div dir="auto"><pre><span>while</span> <span>read</span> -r WORD<span>;</span> <span>do</span>
  <span>while</span> <span>read</span> -r HEX<span>;</span> <span>do</span>
    IFS=<span><span>&#34;</span> <span>&#34;</span></span>
    <span>read</span> -r -a BG_RGB <span>&lt;&lt;&lt;</span> <span><span>&#34;</span>$(fold -w2 &lt;&lt;&lt; $HEX | xargs -I {} printf &#39;%d &#39; 0x{})<span>&#34;</span></span>
    <span>read</span> -r -a FG_RGB <span>&lt;&lt;&lt;</span> <span><span>&#34;</span>$(for component in ${BG_RGB[*]}; do printf &#39;%d &#39; $((255 - $component)); done)<span>&#34;</span></span>
    IFS=<span><span>&#34;</span>;<span>&#34;</span></span>
    <span>printf</span> <span><span>&#39;</span>\033[48;2;<span>&#39;</span></span><span><span>&#34;</span><span>${BG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m\033[38;2;<span>&#39;</span></span><span><span>&#34;</span><span>${FG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m <span>&#39;</span></span><span><span>&#34;</span><span>$HEX</span><span>&#34;</span></span><span><span>&#39;</span> \033[0m %s\n<span>&#39;</span></span>
  <span>done</span> <span>&lt;</span> <span><span>&lt;(</span>tr <span><span>&#39;</span>IOS<span>&#39;</span></span> <span><span>&#39;</span>105<span>&#39;</span></span> <span>&lt;&lt;&lt;</span> <span><span>${WORD^^}</span></span><span>)</span></span>
<span>done</span> <span>&lt;</span> <span><span>&lt;(</span>grep -Pi <span><span>&#34;</span>^[A-FIOS]{6,6}$<span>&#34;</span></span> /usr/share/dict/words<span>)</span></span>
<span><span>#</span> time for a in {1..10}; do ... ; done</span>
<span><span>#</span> real  0m7.699s</span>
<span><span>#</span> user  0m8.047s</span>
<span><span>#</span> sys   0m1.301s</span></pre></div>
<p dir="auto">Edit:</p>
<blockquote>
<p dir="auto">something does feel a little slow</p>
</blockquote>
<p dir="auto">It was <code>xargs</code>, &#39;bout 50% faster without it (specifically not because of any other change I made to refactor it out, though most tweaks do push it over <code>real 0m4s</code>).</p>
<div dir="auto"><pre><span>while</span> <span>read</span> -r WORD<span>;</span> <span>do</span>
  <span>while</span> <span>read</span> -r HEX<span>;</span> <span>do</span>
    IFS=<span><span>$&#39;</span><span>\n</span><span>&#39;</span></span>
    BG_RGB=( <span><span>$(</span>fold -w2 <span>&lt;&lt;&lt;</span> <span><span>$HEX</span></span> <span>|</span> <span>while</span> <span>read</span> -r COMP<span>;</span> <span>do</span> <span>printf</span> <span><span>&#39;</span>%d\n<span>&#39;</span></span> 0x<span>$COMP</span><span>;</span> done) )</span>
<span>    FG_RGB=( <span><span>$(</span>for COMP <span>in</span> <span>${BG_RGB[*]}</span><span>;</span> <span>do</span> <span>printf</span> <span><span>&#39;</span>%d\n<span>&#39;</span></span> <span><span>$((</span><span>255</span> <span>-</span> <span>$COMP</span><span>))</span></span><span>;</span> done<span>)</span></span> )</span>
<span>    IFS=<span><span>&#34;</span>;<span>&#34;</span></span></span>
<span>    <span>printf</span> <span><span>&#39;</span>\033[48;2;<span>&#39;</span></span><span><span>&#34;</span><span>${BG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m\033[38;2;<span>&#39;</span></span><span><span>&#34;</span><span>${FG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m <span>&#39;</span></span><span><span>&#34;</span><span>$HEX</span><span>&#34;</span></span><span><span>&#39;</span> \033[0m %s\n<span>&#39;</span></span></span>
<span>  <span>done</span> <span>&lt;</span> <span><span>&lt;(</span>tr <span><span>&#39;</span>IOS<span>&#39;</span></span> <span><span>&#39;</span>105<span>&#39;</span></span> <span>&lt;&lt;&lt;</span> <span><span>${WORD^^}</span></span><span>)</span></span></span>
<span><span>done</span> <span>&lt;</span> <span><span>&lt;(</span>grep -Pi <span><span>&#34;</span>^[A-FIOS]{6,6}$<span>&#34;</span></span> /usr/share/dict/words<span>)</span></span></span>
<span><span><span>#</span> time for a in {1..10}; do ... ; done</span></span>
<span><span><span>#</span> real  0m3.908s</span></span>
<span><span><span>#</span> user  0m3.711s</span></span>
<span><span><span>#</span> sys   0m0.716s</span></span></pre></div>
<p dir="auto">Edit: <code>sed</code> is slightly faster than <code>grep</code> (for this, on my machine), and dropping the nested while loop into what is now <code>sed</code>&#39;s pipeline saves a ton of time. This is as fast as I think it gets, at least without using <code>awk</code> or <code>sed</code> for more than just what <code>grep</code> can do.</p>
<div dir="auto"><pre><span>while</span> <span>read</span> -r HEX<span>;</span> <span>do</span>
  IFS=<span><span>$&#39;</span><span>\n</span><span>&#39;</span></span>
  BG_RGB=( <span><span>$(</span>fold -w2 <span>&lt;&lt;&lt;</span> <span><span>$HEX</span></span> <span>|</span> <span>while</span> <span>read</span> -r COMP<span>;</span> <span>do</span> <span>printf</span> <span><span>&#39;</span>%d\n<span>&#39;</span></span> 0x<span>$COMP</span><span>;</span> done) )</span>
<span>  FG_RGB=( <span><span>$(</span>for COMP <span>in</span> <span>${BG_RGB[*]}</span><span>;</span> <span>do</span> <span>printf</span> <span><span>&#39;</span>%d\n<span>&#39;</span></span> <span><span>$((</span><span>255</span> <span>-</span> <span>$COMP</span><span>))</span></span><span>;</span> done<span>)</span></span> )</span>
<span>  IFS=<span><span>&#34;</span>;<span>&#34;</span></span></span>
<span>  <span>printf</span> <span><span>&#39;</span>\033[48;2;<span>&#39;</span></span><span><span>&#34;</span><span>${BG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m\033[38;2;<span>&#39;</span></span><span><span>&#34;</span><span>${FG_RGB[*]}</span><span>&#34;</span></span><span><span>&#39;</span>m <span>&#39;</span></span><span><span>&#34;</span><span>$HEX</span><span>&#34;</span></span><span><span>&#39;</span> \033[0m %s\n<span>&#39;</span></span></span>
<span><span>done</span> <span>&lt;</span> <span><span>&lt;(</span>sed -n <span><span>&#39;</span>s/^[a-fios]\{6\}$/\U&amp;/p<span>&#39;</span></span> /usr/share/dict/words <span>|</span> tr <span><span>&#39;</span>IOS<span>&#39;</span></span> <span><span>&#39;</span>105<span>&#39;</span></span><span>)</span></span> \</span>
<span><span><span>#</span> time for a in {1..10}; do ... ; done</span></span>
<span><span><span>#</span> real	0m2.318s</span></span>
<span><span><span>#</span> user	0m2.227s</span></span>
<span><span><span>#</span> sys	0m0.464s</span></span></pre></div>
    </div>
  </task-lists>
  
</div></div>
  </body>
</html>
