<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nicole.express/2023/im-gonna-open-the-doom-gate-now.html">Original</a>
    <h1>My Dearest Data East: Why? Gate of Doom/Dark Seal</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>I like it when hardware is a little weird. Give me <a href="https://nicole.express/2022/the-sega-master-system-yet-again.html">two Master System VDPs overlaid on top of each other</a>, <a href="https://nicole.express/2021/mvs-wasnt-mvs.html">a Neo Geo MVS with no cartridge</a>, or even a modern device that outputs <a href="https://nicole.express/2023/that-blasted-rgb.html">video via a cartridge port</a>. But sometimes companies make decisions on their hardware that I just don’t understand. I’m not an expect, and I’m sure they have good reasons. <em>Fun fact: This is a stealth PC Engine blog post!</em></p>

<h2 id="gate-of-doom"><em>Gate of Doom</em></h2>

<p><img src="https://nicole.express/assets/img/doomed/title.jpg" title="doooooooooooom" alt="Gate of Doom title screen"/></p>

<p>Have you heard of <em>Gate of Doom</em>? No? But it was the most successful table arcade unit in June 1990 in Japan (under the name <em>Dark Seal</em>, not to be confused with evil marine life) according to <em>Game Machine</em> magazine!</p>

<p><img src="https://nicole.express/assets/img/doomed/4chara.jpg" title="RAMPANT NINJA RELATED CRIMES THESE DAYS... MEDIEVALFANTASYSETTING IS NOT THE EXCEPTION..." alt="Gate of Doom character select. You can choose a Knight, Wizard, Bard, or Ninja. Ninja has Hi-Speed move."/></p>

<p>Alright yeah, it’s not a well-known title these days. It kind of reminds me of an isometric take on the <em>Gauntlet</em> gameplay, but zoomed in a lot, and with two players max, so maybe it’s not much like <em>Gauntlet</em> at all.</p>

<p><img src="https://nicole.express/assets/img/doomed/battle.jpg" title="eyy you missed pal" alt="Gate of Doom gameplay. The wizard fires a beam of fire at the dragon, but the dragon is above it."/></p>

<p>Like with many games, the <a href="https://www.arcade-museum.com/dipswitch-settings/7921.html">International Arcade Museum</a> has a copy of the manual. Interestingly, the conversion kit manual suggests installing four buttons (for the two actions) in front of two eight-way joysticks, which seems like an uncomfortable arrangement. I guess Data East are the experts here. Or were.</p>

<p><img src="https://nicole.express/assets/img/doomed/controls.png" title="The manual says this is to accomodate both left-handed and right-handed people, which admittedly is a nice gesture towards accessibility, especially for 1990" alt="A suggestion to install four buttons in front of joysticks"/></p>

<p>Note that the JAMMA-standard edge connector only has one button each for attack and magic for each player, but I guess the included wiring harness would’ve been wired properly so that either button would work. I don’t have that wiring harness, but I do have the marquee, so that’s cool. You rarely find them with PCBs; if I happen to get an empty western-style cabinet, it’d be nice to give this a permanent home.</p>

<p><img src="https://nicole.express/assets/img/doomed/marquee.JPEG" title="maybe i&#39;ll put this on the doorway to my office" alt="GATE OF DOOM marquee, featuring a smiling skull man and some orcs"/></p>

<h2 id="hardware">Hardware</h2>

<p>Much like Konami’s <a href="https://nicole.express/2023/the-best-take-on-iran-contra.html"><em>Contra</em></a>, the <em>Gate of Doom</em> arcade board is purpose-built for the task. Well, <a href="http://www.system16.com/hardware.php?id=944&amp;gid=18915#18915">System16</a> claims it as part of a <em>Caveman Ninja</em> hardware family, but just like <em>Contra</em>, this is a pretty loose grouping, not something like the System E where I swapped games just by rewriting some EPROMs.</p>

<p><img src="https://nicole.express/assets/img/doomed/board.JPEG" title="it&#39;s a big one" alt="The large Data East circuitboard that powers Gate of Doom"/></p>

<p>So to me the first and most obvious thing is that Data East, even moreso than Capcom, really likes custom labeled and numbered chips. Like, apparently this has a 68000 CPU, but I can’t find it. They did let Yamaha keep their labels, though, so we know this uses both a YM2151 (OPM, eight four-operator channels) and a YM2203 (OPN, three four-operator channels, used in my <a href="https://nicole.express/2021/valuestar-in-the-valuesky.html#pc-98-sound-cards">PC98</a>) fm synthesizer chip.</p>

<p><img src="https://nicole.express/assets/img/doomed/yamaha.JPEG" title="gee gate of doom, how come mom lets you have two synthesizers?" alt="Two YAMAHA-branded synthesizer chips"/></p>

<p>This game uses a lot of sampled voices. Thankfully, with a lot more variety than <a href="https://nicole.express/2022/ganging-up-on-the-alpha.html"><i>Gang Wars</i></a> with its one laugh used everywhere. Instead, two OKI M6295 ADPCM chips are used.</p>

<p><img src="https://nicole.express/assets/img/doomed/oki.JPEG" title="The surface mount chips are coming..." alt="Two surface-mount OKI M6295 chips"/></p>

<p>As for video, the star of the show are the two DECO 55 chips. (DECO, in this case, is a common acronym for Data East Co., and these chips are actually just labeled as being by Data East) These provide sprites and tilemaps, as you’d expect for an arcade game of this vintage. Somewhat surprisingly, they’re on opposite sides of the board. Perhaps most of that discrete logic is the glue logic?</p>

<p><img src="https://nicole.express/assets/img/doomed/255.JPEG" title="I mean they&#39;re not even oriented the same direction how am I supposed to photograph this" alt="The board showing only the top half, with the two Data East 55 chips"/></p>

<p>The chips labeled MAC apparently are just mask ROMs. According to <a href="https://www.mikesarcade.com/cgi-bin/spies.cgi?action=url&amp;type=info&amp;page=DECOBoardList.txt">Mike’s Arcade</a>, MAC is the Data East mask ROM code for both this game and its <em>Dark Seal</em> incarnation.</p>

<p>But what’s this weird chip hanging out by the audio circuit?</p>

<p><img src="https://nicole.express/assets/img/doomed/mystery1.JPEG" title="this chip is labeled &#39;45&#39; because it was manufactured in 1945" alt="A chip with a Data East copyright and the number 45"/></p>

<p>Hiding chip names is a common scheme to make arcade boards harder to clone. Well, Data East must have been really worried about this one, because even underneath, the chip’s markings are scratched off. I was able to get a little bit of a view by putting a bubble of isopropyl alcohol on the chip and adjusting the lighting.</p>

<p><img src="https://nicole.express/assets/img/doomed/mystery2.JPEG" title="chip from the void" alt="The chip from above, heavily scratched. Numbers &#39;280A&#39; can be made out"/></p>

<p>Not good enough for you? Well, maybe breaking out the <a href="https://nicole.express/2020/super-ultra-mega-tera-grafx.html">SuperGrafx</a> will help.</p>

<p><img src="https://nicole.express/assets/img/doomed/mystery3.jpg" title="ENHANCE" alt="The chip from above compared to the SuperGrafx&#39;s HuC6280A."/></p>



<h2 id="the-huc6280a">The HuC6280A</h2>

<p>So what is the HuC6280A? It’s the CPU, featuring a WDC 65C02 core, but it’s a bit more than that. It’s not quite a system on a chip, but it gets there:</p>

<ul>
  <li>CPU, featuring a variable-frequency 65C02 core</li>
  <li>Primitive DMA (Direct Memory Access); built-in as block transfer instructions</li>
  <li>MMU (Memory Management Unit), featuring a 21-bit external address bus, mapped into the 16-bit address range of the 65C02</li>
  <li>Stereo APU, featuring six channels of wavetable sound</li>
  <li>8-bit input port</li>
  <li>8-bit output port</li>
  <li>PIC (Programmable Interrupt Controller), featuring an additional IRQ line not present on the 65C02</li>
  <li>Timer, with interrupt</li>
</ul>

<p>If acquiring one in 2023 didn’t involve sacrificing a PC Engine, it might be a fun project to build a single board computer out of one of these with some RAM. You could definitely drive a character LCD screen and read some buttons, could make a simple PC Engine music player.</p>

<p>Back in the 1990’s, Hudson did sell these separately from the system, and also marketed the TurboGrafx chipset to several comers. But as far as I know, this is the only case where someone other than NEC took them up on it.</p>

<h3 id="cpu-and-memory-mapping">CPU and memory mapping</h3>

<p>The 65C02, much like its NMOS predecessor, the 6502, has a 64kiB address bus. Everything has to fit in that bus, not only data, but also RAM, and the special registers used by hardware. The HuC6280 divides this into eight pages, each 8kiB. Interestingly, the zero page is moved to the <em>second</em> page. Unlike every other 6502-based system, zero page is at <code>0x2000</code> rather than <code>0x0000</code>. This is because the first page is usually used for hardware registers. (The stack is also moved, from <code>0x0100</code> to <code>0x2100</code>) Confusing, the <em>physical</em> “page” for hardware registers is <code>0xFF</code>.</p>

<p>It’s worth noting these are all virtual addresses. The <em>real</em> addresses might be elsewhere; the processor only sees what the mapper allows it to see. The exception is the reset vector, which has to put everything into a known state, including the mapper; it’s at address <code>00x001FFF</code>, because the chip maps page <code>00</code> into that last slot where the vectors are.</p>

<p>You might wonder why someone would bother with all this. Well, it’s because otherwise, your ROM sizes would be extremely limited. Even <a href="https://nicole.express/2022/the-nes-as-an-artifact.html">the NES</a> had memory mapping capability; it’s just a lot easier to wrap your head around, since half the memory map could never change.</p>

<p>Anyway, the ROM for <em>Gate of Doom</em> is 64kiB on its own, so it definitely required <em>some</em> sort of memory map for use with a 6502. But not necessarily something this elaborate.</p>

<h3 id="other-features">Other features</h3>

<p>The APU outputs its audio from pins 17 and 18. These aren’t connected; all the sound is generated from the Yamaha and OKI sounds above. So right away, the hope that this was being used for its sound channels, which made sense on a sound CPU, is dashed.</p>

<p>The input port is pins 24-30, and the output port is pins 31-38. These are used for joystick reading on the PC Engine. Here, they’re not connected; the sound chips are attached in the usual way, through memory mapping.</p>

<p>The interrupts are used as well, with an 8-bit latch hooked up for communication to the main CPU, and another line hooked up to the YM2151. This does technically use the HuC6280-exclusive <code>IRQ2</code>, but <code>NMI</code> isn’t used. The timer interrupt is used, though.</p>

<p>Still, it really surprised me that so many of the defining features of the HuC6280A aren’t used here!</p>

<h3 id="secret-messages">Secret messages?</h3>

<p>Running the standard UNIX <code>strings</code> tool on the audio ROM, you get a lot of garbage, but it also reveals a number of strings hidden in the ROM. It reveals a few things about Data East’s development process, like that the individual game music tracks had names like <code>message.bgm</code>, typical of MS-DOS based systems. There are many instrument names as well, like <code>piano_1</code> through <code>piano_8</code>, followed by <code>pia_casio</code>. I’m not sure if these are Data East-developed instrument patches or a library they used.</p>

<h3 id="the-letter-a">The letter A</h3>

<p>I’m pretty happy that I was able to make out the letter “A” on the HuC6280A. That might not mean much to you, but let’s crack open another PC Engine I have, the PC Engine Duo-R. This is more or less the final model released; the later Duo-RX just changed the pack-in controller.</p>

<p><img src="https://nicole.express/assets/img/doomed/turbo-r.JPEG" title="no bloody a, b, c, or d!" alt="A Hudson Soft HuC6280, no A"/></p>

<p>So there’s something interesting about the Hu6280A. I don’t want to go into it too much, but here’s a quick, roughly chronological order of major models of PC Engine hardware: (excluding weird things like the Shuttle or the TurboExpress)</p>

<table>
  <thead>
    <tr>
      <th>Release year</th>
      <th>Model</th>
      <th>CPU</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1987</td>
      <td>PC Engine</td>
      <td>HuC6280</td>
    </tr>
    <tr>
      <td>1989</td>
      <td>CoreGrafx</td>
      <td>HuC6280A</td>
    </tr>
    <tr>
      <td>1991</td>
      <td>CoreGrafx II</td>
      <td>HuC6280</td>
    </tr>
    <tr>
      <td>1991</td>
      <td>PC Engine Duo</td>
      <td>HuC6280</td>
    </tr>
    <tr>
      <td>1993</td>
      <td>PC Engine Duo R</td>
      <td>HuC6280</td>
    </tr>
    <tr>
      <td>1993</td>
      <td>PC Engine Duo RX</td>
      <td>HuC6280</td>
    </tr>
  </tbody>
</table>

<p>The HuC6280 was used in every model, except for the CoreGrafx, which was contemporary to the SuperGrafx I have. It’s pretty unclear what the difference is, but it’s usually attributed to having no pops in the APU when changing frequencies while the sound is playing, which would’ve allowed the APU to play samples more cleanly using tricks like <a href="https://nicole.express/2022/let-me-show-you-the-sound-of-my-master.html">the Master System</a>. But I’m not sure anyone’s produced a demo with an audible difference.</p>

<p>The thing is, not just 1990’s <em>Gate of Doom</em>, but every Data East circuit board I’ve seen that uses this CPU uses the “A” variant. It makes me wonder, if there is in fact a case where the APU change breaks things badly enough that Hudson decided to return to the original and sold their excess stock to Data East. But I’m pretty much making that up without any evidence whatsoever, so don’t go repeating that.</p>

<h2 id="thats-the-question">That’s the question</h2>

<p>So Data East used a HuC6280 as a sound CPU. They didn’t just use it on <em>Gate of Doom</em>, either. It was their go-to sound CPU in many games up to their demise really, and I’m not sure they ever used its on-board audio.</p>



<p>It’s worth noting that Data East did do some development for the PC Engine; the port of <em>Bloody Wolf</em> is generally reported to have been done in-house. And that makes bloody sense: the arcade version of <em>Bloody Wolf</em> uses PC Engine based hardware; except, the APU is again not used in favor of external Yamaha and OKI synthesizers. (It apparently also doesn’t use the Video Color Encoder from the PC Engine chipset; I’m going to keep an eye out for this board, it sounds fascinating)</p>

<p><img src="https://nicole.express/assets/img/doomed/bw-a.png" title="Same video chip. Different art, and different color encoding" alt="Bloody Wolf title screens on arcade and PC engine."/></p>

<p>So, why did they keep using this particular CPU? I think there are a few reasons:</p>

<ul>
  <li>Relatively obscure chip would be harder for pirates to reverse-engineer (clearly a high priority for Data East)</li>
  <li>Familiarity with the chip through work on <em>Bloody Wolf</em></li>
  <li>Convenient timer interrupt</li>
  <li>You need to map memory anyways, so why not use a thorough built-in mapper</li>
  <li>Possibly some unknown APU issues with the “A” variant made Hudson give them away cheap?</li>
</ul>

<p>Have a better idea than me? Or maybe you worked at Data East and know for certain– let me know if so! That’s all for today, though.</p>

<p><img src="https://nicole.express/assets/img/doomed/gameover2.jpg" title="a pretty quick game over tbh" alt="Gate of Doom death scene. The player sprite is gone and their score is replaced with GAME OVER"/></p>

  </div>

  
</article>

      </div>
    </div></div>
  </body>
</html>
