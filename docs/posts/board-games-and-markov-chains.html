<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kevingal.com/blog/boardgame.html">Original</a>
    <h1>Board Games and Markov Chains</h1>
    
    <div id="readability-page-1" class="page">
    <header>
        
    </header>


<h3>2022-08-28</h3>
<h3>Using Markov chains to model simple board games.</h3>
<p>Tags: <a href="https://kevingal.com/blog/tag/probability.html">probability</a> </p>
<hr/>
<p>Children of a certain age are drawn to mindless board games like Snakes &amp; Ladders, which involve no skill or decision-making or social engineering or anything that a reasonable human might associate with the word &#34;fun&#34;. The outcome is determined entirely by chance, in the form of dice rolls. The only pleasure I can imagine being derived from such games is the trickle of dopamine that comes from winning and the schadenfreude that comes from seeing a snake devour your opponent, which in my considered opinion is setting children up to become inveterate gamblers and psychopaths, respectively.</p>
<p>While that may be the case, there may be one redeeming aspect to these games, which is that they can be analysed using simple tools from probability. The state of the game, such as the position of the players, changes each round based on the output of a random number generator, such as a die ðŸŽ². The next state depends only on the random output and the current state. This is a <a href="https://en.wikipedia.org/wiki/Markov_chain">Markov process</a>, and it can be analysed using nothing more than some matrix math!</p>
<p>To illustrate what a Markov process (or Markov chain) is, let&#39;s consider a simple board game.</p>
<figure>
<img src="https://kevingal.com/static/img/boardgame/boardgame.png" alt="A simple board game with 3 positions (A, B and C) and a 6-sided die."/>
<figcaption>The best board game ever.</figcaption>
</figure>

<p>It has 3 squares: the start square A, the middle square B, and the end square C. Each turn, you roll a 6-sided die. If 1 comes up, you move back to A or stay on it if you&#39;re already there. If 2-5 come up, you advance to the next square. If 6 comes up, you go straight to C, no matter which square you&#39;re currently on. Once you&#39;re at C, the game is over and the state doesn&#39;t change anymore.</p>
<p>The states of the Markov chain that corresponds to this board game, and the probability of moving from one state to another (the transition probability), can be visualised as follows.</p>
<figure>
<img src="https://kevingal.com/static/img/boardgame/chain.png" alt="The Markov chain corresponding to the example board game. There are 3 states: A, B and C. There are arrows between the states, labelled with the probability of going from one state to another."/>
<figcaption>The Markov chain corresponding to that board game.</figcaption>
</figure>

<p>The circles are the states, which represent which square you&#39;re on. The arrows are labelled with the transition probability from one state to another. Based on the rules above, the transition probabilities for state A are: 1/6 to A, 4/6 to B, and 1/6 to C. They add up to 1/6 + 1/6 + 4/6 = 1, which makes sense because those are all the possible options and the probability of all possible options must be 1. From state B, there is a 1/6 chance of going back to A and a 5/6 chance of going to C, and 1/6 + 5/6 = 1. Finally, the probability of staying in C once you reach it is 1, because at that point the game is over.</p>
<p>The transition matrix <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span></span></span></span> expresses all of these probabilities at once:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>B</mi><mi>A</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>B</mi><mi>B</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>B</mi><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>C</mi><mi>C</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>5</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
P = \left[ {\begin{array}{ccc}
        p_{AA} &amp; p_{BA} &amp; p_{CA} \\
        p_{AB} &amp; p_{BB} &amp; p_{CB} \\
        p_{AC} &amp; p_{BC} &amp; p_{CC} \\
    \end{array} } \right]
  = \left[ {\begin{array}{ccc}
        1/6 &amp; 1/6 &amp; 0 \\
        4/6 &amp; 0 &amp; 0 \\
        1/6 &amp; 5/6 &amp; 1 \\
    \end{array} } \right],
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>âŽ£</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span><span></span><span><span>âŽ¡</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>AA</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>A</span><span>B</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>A</span><span>C</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>B</span><span>A</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>BB</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>BC</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>C</span><span>A</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>CB</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>CC</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>âŽ¦</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span><span></span><span><span>âŽ¤</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>âŽ£</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span><span></span><span><span>âŽ¡</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span>1/6</span></span></span><span><span></span><span><span>4/6</span></span></span><span><span></span><span><span>1/6</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span></span><span><span><span><span><span><span></span><span><span>1/6</span></span></span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>5/6</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span></span><span><span><span><span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>1</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>âŽ¦</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span><span></span><span><span>âŽ¤</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>,</span></span></span></span></span></p>
<p>where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{ij}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the probability of going from state <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span> to state <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>j</span></span></span></span>. Each column in the transition matrix contains the transition probabilities for a state. The transition probabilites from A are in the first column, from B are in the second column, and from C are in the third column. Each row in the matrix contains the transition probabilities TO a state.</p>
<p>Let&#39;s say that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(k)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span> is a vector containing the probabilities that you will be in state A, B or C after <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> rounds of the game. Since we start off in state A with 100% probability,</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>p</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>p</mi><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>p</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
x^{(0)} = \left[ {\begin{array}{c}
    p_A^{(0)} \\ p_B^{(0)} \\ p_C^{(0)} \\
    \end{array} } \right]

    = \left[ {\begin{array}{c}
    1 \\ 0 \\ 0
    \end{array} } \right],
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>âŽ£</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V616 H319z M319 0 H403 V616 H319z"></path></svg></span></span><span><span></span><span><span>âŽ¡</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>A</span></span></span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>B</span></span></span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>C</span></span></span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>âŽ¦</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V616 H263z M263 0 H347 V616 H263z"></path></svg></span></span><span><span></span><span><span>âŽ¤</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>âŽ£</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span><span></span><span><span>âŽ¡</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span>1</span></span></span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>0</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>âŽ¦</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewBox="0 0 666.67 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span><span></span><span><span>âŽ¤</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>,</span></span></span></span></span></p>
<p>where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">p_i^{(k)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>i</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the probability of being in state <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span> after <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> rounds. To get the probabilities for the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-th round, multiply the transition matrix by the probabilities for the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k-1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>k</span><span></span><span>âˆ’</span><span></span></span><span><span></span><span>1</span><span>)</span></span></span></span>-th round:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>P</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>P</mi><mi>P</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>=</mo><msup><mi>P</mi><mi>k</mi></msup><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">
x^{(k)} = P x^{(k-1)} = P P x^{(k-2)} = ... = P^{k} x^{(0)}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>P</span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>PP</span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>2</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>...</span><span></span><span>=</span><span></span></span><span><span></span><span><span>P</span><span><span><span><span><span><span></span><span><span><span>k</span></span></span></span></span></span></span></span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k&gt;0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>&gt;</span><span></span></span><span><span></span><span>0</span></span></span></span>. So there is a fixed probability of being in any state after <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> rounds of the game, which is determined entirely by matrix multiplication. Why does multiplying by the transition matrix give us the probabilities for the next round? If you multiply it out, you&#39;ll see that</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>P</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>p</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>B</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>B</mi><mi>A</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>p</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>B</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>B</mi><mi>B</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>p</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>B</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>B</mi><mi>C</mi></mrow></msub><mo>+</mo><msubsup><mi>p</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>p</mi><mrow><mi>C</mi><mi>C</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
x^{(k)} = P x^{(k-1)} = \left[ {\begin{array}{c}
    p_A^{(k-1)}p_{AA} + p_B^{(k-1)}p_{BA} + p_C^{(k-1)}p_{CA} \\
    p_A^{(k-1)}p_{AB} + p_B^{(k-1)}p_{BB} + p_C^{(k-1)}p_{CB} \\
    p_A^{(k-1)}p_{AC} + p_B^{(k-1)}p_{BC} + p_C^{(k-1)}p_{CC} \\
    \end{array} } \right].
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>P</span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>âŽ£</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V616 H319z M319 0 H403 V616 H319z"></path></svg></span></span><span><span></span><span><span>âŽ¡</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>A</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>AA</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>B</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>B</span><span>A</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>C</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>C</span><span>A</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>A</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>A</span><span>B</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>B</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>BB</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>C</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>CB</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>A</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>A</span><span>C</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>B</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>BC</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span>C</span></span></span><span><span></span><span><span><span>(</span><span>k</span><span>âˆ’</span><span>1</span><span>)</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>CC</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>âŽ¦</span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.616em" style="width:0.6667em" viewBox="0 0 666.67 616" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V616 H263z M263 0 H347 V616 H263z"></path></svg></span></span><span><span></span><span><span>âŽ¤</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>.</span></span></span></span></span></p>
<p>The probability of being in state A in the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-th round is the probability that we were in state A in the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k-1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>k</span><span></span><span>âˆ’</span><span></span></span><span><span></span><span>1</span><span>)</span></span></span></span>-th round and stayed in A, plus the probability that we were in state B and transitioned to A, plus the probability that were were in state C and transitioned to A. The same applies to the other states. It alllllll makes sense when you multiply it out.</p>
<p>With these newfound powers, we can plot the probability distribution of being in any of the states on a given turn.</p>
<figure>
<img src="https://kevingal.com/static/img/boardgame/simple-game-prob-distr.png" alt="A plot with 3 lines: 1 for state A, 1 for B and 1 for C. On the x-axis is the number of turns and on the y-axis is the probability."/>
<figcaption>Probability distribution of being in state A, B or C on each turn.</figcaption>
</figure>

<p>The probability of being in the end state, C, very quickly converges to 1. It&#39;s a short game. But how many turns should we expect it to take for the game to end? Will the game be over in time for tea, or will we be driven to blow our brains out by the pointless monotony of it all? This can be resolved using... linear algebra<sup id="fnref:algebra"><a href="#fn:algebra">1</a></sup>!</p>
<p>First, let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>a</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>i</mi><mo>:</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S_a=\{i:p_{ii}=1\}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>S</span><span><span><span><span><span><span></span><span><span>a</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>{</span><span>i</span><span></span><span>:</span><span></span></span><span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ii</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>}</span></span></span></span> be the set of <em>absorbing states</em>, which are the states we can&#39;t escape from once we&#39;ve entered them. In the case of our example game, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>a</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>C</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S_a = \{C\}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>S</span><span><span><span><span><span><span></span><span><span>a</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>{</span><span>C</span><span>}</span></span></span></span>. Also let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">X</mi></mrow><annotation encoding="application/x-tex">\Chi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>X</span></span></span></span> be the set of all states and let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>âˆ’</mo><msub><mi>S</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">S= \Chi - S_a</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span>X</span><span></span><span>âˆ’</span><span></span></span><span><span></span><span><span>S</span><span><span><span><span><span><span></span><span><span>a</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> be the set of non-absorbing states.</p>
<p>Now let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> denote the expected number of turns to finish the game once we&#39;ve reached state <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>. <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_i=0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span> for absorbing states <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><msub><mi>S</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">i \in S_a</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span><span>S</span><span><span><span><span><span><span></span><span><span>a</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, because the game is already finished and there are no more turns left! For <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">i \in S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span>S</span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is 1 (the next turn) plus the expected number of turns from the state we end up in after the next turn. When weighed by the probability of going to each state, this can be expressed as</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>Î¼</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>Î¼</mi><mi>j</mi></msub><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>+</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>Î¼</mi><mi>j</mi></msub><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\mu_i = \sum_j (1+\mu_j) p_{ij} = \sum_j p_{ij} + \sum_j \mu_j p_{ij} = 1 + \sum_j \mu_j p_{ij}.
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>j</span></span></span><span><span></span><span><span>âˆ‘</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>j</span></span></span><span><span></span><span><span>âˆ‘</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>j</span></span></span><span><span></span><span><span>âˆ‘</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>j</span></span></span><span><span></span><span><span>âˆ‘</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span>.</span></span></span></span></span></p>
<p>We&#39;ve already said that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_i=0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span> for absorbing states, so this can be rearranged as:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><mi>S</mi><mi mathvariant="normal">\</mi><mi>i</mi></mrow></munder><msub><mi>Î¼</mi><mi>j</mi></msub><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>âˆ’</mo><mn>1.</mn></mrow><annotation encoding="application/x-tex">
\mu_i(p_{ii} - 1) + \sum_{j\in S \backslash i} \mu_j p_{ij} = -1.
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ii</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>âˆ’</span><span></span></span><span><span></span><span>1</span><span>)</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>j</span><span>âˆˆ</span><span>S</span><span>\</span><span>i</span></span></span></span><span><span></span><span><span>âˆ‘</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>âˆ’</span><span>1.</span></span></span></span></span></p>
<p>What this gives us is one linear equation and one unknown <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> for each of the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> non-absorbing states. And we can solve the equations to find the average number of turns that the game will last!</p>
<p>To write the equations in matrix form, let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>S</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>:</mo><mi>i</mi><mo>âˆˆ</mo><mi>S</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆˆ</mo><mi>S</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">P_S = [p_{ij} : i\in S,j\in S]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>P</span><span><span><span><span><span><span></span><span><span>S</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>[</span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>:</span><span></span></span><span><span></span><span>i</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span>S</span><span>,</span><span></span><span>j</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span>S</span><span>]</span></span></span></span>. Basically, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">P_S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>P</span><span><span><span><span><span><span></span><span><span>S</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k \times k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>Ã—</span><span></span></span><span><span></span><span>k</span></span></span></span> submatrix of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span></span></span></span> where we&#39;ve removed all the rows and columns that correspond to absorbing states. And now our system of equations can be represented as</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>S</mi><mi>T</mi></msubsup><mo>âˆ’</mo><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><msub><mi>Î¼</mi><mi>i</mi></msub><mo>:</mo><mi>i</mi><mo>âˆˆ</mo><mi>S</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
(P_S^T - I)[\mu_i : i \in S] = [-1],
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>P</span><span><span><span><span><span><span></span><span><span>S</span></span></span><span><span></span><span><span>T</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>âˆ’</span><span></span></span><span><span></span><span>I</span><span>)</span><span>[</span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>:</span><span></span></span><span><span></span><span>i</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span>S</span><span>]</span><span></span><span>=</span><span></span></span><span><span></span><span>[</span><span>âˆ’</span><span>1</span><span>]</span><span>,</span></span></span></span></span></p>
<p>where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>I</span></span></span></span> is the identity matrix, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>Î¼</mi><mi>i</mi></msub><mo>:</mo><mi>i</mi><mo>âˆˆ</mo><mi>S</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mu_i : i \in S]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>[</span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>:</span><span></span></span><span><span></span><span>i</span><span></span><span>âˆˆ</span><span></span></span><span><span></span><span>S</span><span>]</span></span></span></span> is the column vector of unknowns, and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>[</span><span>âˆ’</span><span>1</span><span>]</span></span></span></span> is a column vector of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> -1s.</p>
<p>I have probably committed an atrocity of math notation there, but anyway. Solving this system of equations for our example game gives <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>A</mi></msub><mo>=</mo><mn>2.3</mn></mrow><annotation encoding="application/x-tex">\mu_A=2.3</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>A</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>2.3</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>B</mi></msub><mo>=</mo><mn>1.39</mn></mrow><annotation encoding="application/x-tex">\mu_B=1.39</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>Î¼</span><span><span><span><span><span><span></span><span><span>B</span></span></span></span><span>â€‹</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1.39</span></span></span></span>. Homework for the reader: verify this result by hand or by plugging the equations into a linear algebra solver of your choice. Or, grab a die, play the game a bunch of times, track how many turns each game takes, and average them afterwards to get an estimate.</p>
<p>The techniques I&#39;ve covered here also apply to Snakes &amp; Ladders, Monopoly (<a href="https://www.youtube.com/watch?v=ubQXz5RBBtU&amp;t=904s">which are the best properties to buy?</a>), the number of times you need to flip a coin before getting 5 heads in a row, and any other situation that can be modelled as a Markov process!</p>
<h3 id="appendix-the-code">Appendix: The Code</h3>
<p>The supporting code for this article is available <a href="https://gist.github.com/Kevinpgalligan/8c1065e1c7f61caf7d048d96e3c5076f">as a GitHub gist</a>. I wrote it in the <a href="https://www.jsoftware.com">J programming language</a>, which is (in)famous for looking like gobbledygook if you&#39;re not familiar with it. I was originally planning to walk through the code line by line, but I will instead write about J another time.</p>

<hr/>
<ul>
<li><a href="https://kevingal.com/blog.html">Back to blog</a></li>
<li><a href="https://kevingal.com/feed.xml">RSS feed</a></li>
</ul>
<p>I&#39;d be happy to hear from you at <i>galligankevinp@gmail.com</i>.</p>


</div>
  </body>
</html>
