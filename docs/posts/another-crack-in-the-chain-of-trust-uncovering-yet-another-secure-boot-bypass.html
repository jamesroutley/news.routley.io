<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.binarly.io/blog/another-crack-in-the-chain-of-trust">Original</a>
    <h1>Another Crack in the Chain of Trust: Uncovering (Yet Another) Secure Boot Bypass</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><div><h6><em>By Binarly REsearch</em></h6><p>In this blog post, the Binarly Research team documents a Secure Boot bypass that likely impacts most devices supporting UEFI. At the center of this discovery is <a href="https://interjectedfuture.com/advisories/brly-dva-2025-001">CVE-2025-3052 (BRLY-2025-001)</a>, a memory corruption vulnerability in a module signed with Microsoft’s third-party UEFI certificate. Attackers can exploit this vulnerability to run unsigned code during the boot process, effectively bypassing Secure Boot and compromising the system’s chain of trust. Because the attacker’s code executes before the operating system even loads, it opens the door for attackers to install bootkits and undermine OS-level security defenses. </p><p>The story behind this discovery begins with a UEFI application we found on VirusTotal, signed with Microsoft’s third-party UEFI certificate. This application has been publicly available since November 2024 when it was first submitted. However, the signature data indicates it was actually signed in October 2022, suggesting it may have been circulating for much longer. </p><p>The application is a BIOS flashing tool for devices sold by DT Research, a company specializing in rugged mobile devices. Although this module was originally developed for DT Research devices only, it can run on any device that trusts the certificate with subject &#34;<strong>Microsoft Corporation UEFI CA 2011</strong>&#34; certificate. This includes the vast majority of systems, as the same certificate is widely used to sign the Linux bootloader shim, significantly increasing the potential impact of this vulnerability.</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/6843694d5c893ab5cff2eefb_image1.png" loading="lazy" alt=""/></p><figcaption><em>Figure 1. The vulnerable module signed with the Microsoft UEFI CA 2011 certificate</em></figcaption></figure><p>The root cause of this bug, once again, lies in the unsafe handling of NVRAM variables. Issues involving NVRAM variables have been a persistent problem in the UEFI ecosystem, <a href="https://www.binarly.io/advisories">with Binarly alone responsibly disclosing hundreds of related vulnerabilities</a> over the past few years. Because these bugs have been so widespread and impactful, our Binarly Transparency Platform performs multiple analyses to detect these bug classes. One of these checks looks specifically for any unsafe usage of data read from NVRAM variables, and this analysis is what automatically discovered CVE-2025-3052. </p><p>As shown in the image below, the signed application reads the content of the <em>IhisiParamBuffer</em> variable and directly uses it as a pointer for multiple memory write operations, without performing any validation or sanity checks on its value. This allows an attacker to set the <em>IhisiParamBuffer</em> variable to any arbitrary address in memory, effectively granting them an arbitrary memory write primitive.</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/68436b2c089cba16f0d50471_image2.png" loading="lazy" alt=""/></p><figcaption><em>Figure 2. The signed module blindly trusting an NVRAM variable for memory writes  (CVE-2025-3052)</em></figcaption></figure><p>We reported this finding to CERT/CC on February 26, 2025. During our disclosure with Microsoft, it became clear that this issue wasn’t limited to a single module, but it actually affected 14 different modules. For this reason, to address CVE-2025-3052, Microsoft added 14 new hashes to the Secure Boot dbx as a mitigation measure, which was delivered as part of Patch Tuesday on June 10, 2025.</p><p><strong>Secure Boot and Microsoft Certificates</strong></p><p>Before delving into the details of CVE-2025-3052, let’s recap what Secure Boot is and what security problems it solves. First of all, Secure Boot plays a crucial role in the chain of trust built by UEFI. It can be thought of as a bridge connecting the system’s firmware to the operating system, carrying trust from one bank to the other. At the end of the DXE phase, with the platform initialized, the firmware is ready to boot the OS. With Secure Boot, the firmware cryptographically verifies the integrity and authenticity of the OS loader before handing over control. This check stops attackers from replacing the legitimate OS loader with a malicious component, such as a bootkit. Without Secure Boot, it is trivial for attackers to gain early execution, compromising OS defenses before the OS even has a chance to install them.</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/68436b65a6fcb3dcd3042f62_image3.png" loading="lazy" alt=""/></p><figcaption><em>Figure 3. Summary of the UEFI Secure Boot signing and verification process</em></figcaption></figure><p>UEFI applications are signed with the private part of a signing certificate (leaf certificate on the image) that chains through one or more intermediate certificates to a trusted, root CA certificate from <em>db</em>. This is for example what happens with applications signed by Microsoft, where the private key of the certificate with subject “Microsoft Corporation UEFI CA 2011” signs the signing/leaf certificate, whose private key is in turn used to sign the Authentocode hash of the UEFI Application.</p><p>The verification process is instead based on two signature databases: <em>db</em> and <em>dbx</em>. The <em>db</em> contains a list of trusted Authenticode hashes and root certificates:</p><ul role="list"><li>if any Authenticode hash in the <em>db</em> matches the application’s Authenticode hash, the application is allowed to run</li><li>if any root certificate in the <em>db</em> successfully verifies the application’s certificate chain, the application is allowed to run</li></ul><p>The dbx instead contains Authenticode hashes and certificates that are untrusted or revoked.</p><p>Depending on whether the application is signed, the firmware allows execution based on either its Authenticode hash or CA certificate being present in the <em>db</em> and not present in the <em>dbx</em>. By default, most devices are shipped with at least these trusted certificates present in <em>db</em>:</p><ol role="list"><li><em>Microsoft Windows Production PCA 2011</em> — used to sign the Windows bootloader.</li><li><em>Microsoft Corporation UEFI CA 2011</em> — used to validate third-party bootloaders and components.</li><li><em>OEM-owned certificate(s)</em> — specific to the hardware manufacturer, typically used for hardware-related or servicing modules.</li></ol><p>The second certificate is the one used to sign the vulnerable application. As previously mentioned, this certificate is widely trusted and present in <em>db</em>, since it’s used to sign components like the Linux’s shim, the EFI application responsible for booting Linux systems.</p><p><strong>The Beginning: Module Discovery and Reconnaissance</strong></p><p>This REsearch began after the discovery of the vulnerable <a href="https://www.virustotal.com/gui/file/a11996aaf7f32aa09f78db608106e25a47970bfeeec76d49af743eee71b55f06/">UEFI module on VirusTotal</a>. The first submission on VT was done in November 2024 but the signing time dates back to October 2022, meaning that this module may have been around for a longer time. The original submission filename was Dtbios-efi64-71.22.efi.The filename, combined with details from the Authenticode certificate and strings found within the binary itself, led us to conclude that the module has been developed by “DT Research, Inc”. </p><p>Additionally, the name of the vulnerable NVRAM variable immediately pointed to Insyde as the Independent BIOS Vendor (IBV) involved. This same variable had already been at the center of two vulnerabilities we previously reported: <a href="https://www.binarly.io/advisories/brly-2022-023">BRLY-2022-023</a> and <a href="https://www.binarly.io/advisories/brly-2023-005">BRLY-2023-005</a>.</p><p>After some reversing, we also conclude that the module is a BIOS update utility, as it reads a BIOS image from a file and attempts to flash it onto the device’s ROM.</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/68436bb53f9e1ed4d4bdc755_image7.png" loading="lazy" alt=""/></p><figcaption><em>Figure 4. A screenshot from VirusTotal of the vulnerable module</em></figcaption></figure><p><strong>The Intermezzo: Finding and Exploiting CVE-2025-3052</strong></p><p>Our Binarly Transparency Platform can automatically detect a wide range of UEFI-related vulnerabilities, including issues involving NVRAM variable handling. As a result, <strong>identifying the vulnerability behind CVE-2025-3052 was as simple as uploading the affected module to our platform</strong>. </p><p>The generated report (shown in the image below) immediately revealed the impact of this finding: the root cause behind the vulnerability is the use of untrusted pointers originating from an NVRAM variable. Additionally, our <a href="https://www.binarly.io/news/binarly-patents-new-method-for-reachability-analysis-for-binary-executables">patented reachability metric</a> confirmed that the vulnerable function is directly accessible from the module&#39;s entry point, thus likely exploitable.</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/68436baad14dbc25aaa3c1f8_image9.png" loading="lazy" alt=""/></p><figcaption><em>Figure 5. The report generated by the Binarly Transparency Platform.</em></figcaption></figure><p>The pseudocode shown in the next image, generated by our platform as evidence of the issue, enabled quick and effective triaging of the vulnerability. This pseudocode is generated using Binarly’s program analysis framework delivering comprehensive static analysis techniques. </p><p>The vulnerable function reads the value of the <em>IhisiParamBuffer</em> NVRAM variable and stores it in a global variable located at address <em>0xf7a0</em>. Later, the value of this global variable plus 0x18 is used as the target address for a memory write operation, setting it to zero. Subsequent writes are also attacker-controlled, since <em>var2</em> points to the same NVRAM variable (our platform generates independent findings for these additional write operations as well).</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/68436cdccdac3447a48504c5_image5.webp" loading="lazy" alt=""/></p><figcaption><em>Figure 6. The pseudo-code generated as evidence of the finding.</em></figcaption></figure><p>While this write capability is constrained, as it only allows writing zeros or a few constants to an arbitrary address, it provides a powerful primitive that can be exploited in a variety of creative ways. For our proof of concept (PoC), we chose to overwrite the global variable <a href="https://github.com/tianocore/edk2/blob/62cd7d338b389aa21c00f0fc35f14a6fa9ba23b0/MdeModulePkg/Core/Dxe/DxeMain.h#L250" target="_blank">gSecurity2</a>. This variable holds a pointer to the Security2 Architectural Protocol, which the LoadImage function uses to enforce Secure Boot. By setting it to zero, we <a href="https://github.com/tianocore/edk2/blob/f75e6952ca29c9d496c9d6fadaddb4c71cd0c4ed/MdeModulePkg/Core/Dxe/Image/Image.c#L1272" target="_blank">effectively disable Secure Boot</a>, allowing the execution of any unsigned UEFI modules.</p><p>One prerequisite for this vulnerability is that the IhisiParamBuffer variable must be writable. On Insyde-based devices, this variable is often locked and read-only. Therefore, unless there is another vulnerability (such as <a href="https://www.binarly.io/advisories/brly-2023-005">BRLY-2023-005</a>, which allows setting arbitrary variables even if locked) Insyde-based devices are not vulnerable. </p><p>All other devices, however, remain vulnerable. Thinking about it, this situation is <em>quite unique</em> and it highlights, once again, the complexities surrounding the UEFI supply chain security, where a mistake by one vendor can affect the entire ecosystem, <em>except for the vendor itself!</em></p><p>The following figure provides a high-level overview of an attack leveraging CVE-2025-3052. A privileged attacker can set the <em>IhisiParamBuffer</em> variable from the operating system (Step 1) and register the vulnerable module in the UEFI Boot Manager, or replace an existing OS loader with the malicious module. </p><p>Additionally, the attacker registers a second unsigned module containing the actual payload they intend to execute (Step 2). After the victim&#39;s device reboots (Step 3) and the firmware enters the Boot Device Selection (BDS) phase, the vulnerable module is executed. Its arbitrary write capability allows the attacker to overwrite <em>gSecurity2</em>, effectively disabling Secure Boot. With Secure Boot disabled, the second unsigned module is then loaded and executed by the firmware, granting the attacker arbitrary code execution at the end of the DXE phase (Step 4).</p><figure><p><img src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/6843692488f7dc517d59d828_image4.png" loading="lazy" alt=""/></p><figcaption><em>Figure 7. The high-level overview of a PoC exploiting CVE-2025-3052</em></figcaption></figure><p>Based on the previous description, we recorded a demo video demonstrating the different stages of this PoC. One important aspect is that the PoC is transparent to the operating system: as shown at the end of the video (at minute 1:07), Secure Boot still appears to be enabled from the OS, even though it has been effectively bypassed.</p><figure><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://www.youtube.com/embed/bX6TfPcccXk" title="Proof of Concept for CVE-2025-3052"></iframe></p></figure><p><strong>The Conclusion: Disclosure and Remediation for CVE-2025-3052</strong></p><p>After discovering this vulnerability, we opened a case with CERT/CC on February 26, 2025 to notify the affected parties and help provide a fix and detection for impacted Binarly customers. </p><p>During the triage process, Microsoft determined that the issue did not affect just a single module as initially believed, but actually 14 different modules. For this reason, the updated dbx released during the Patch Tuesday on June 10, 2025 contains 14 new hashes. </p><div><table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Authenticode SHA256 hash</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BiosFlashShell-efi64-80.02.efi</td>
      <td>C54A4060B3A76FA045B7B60EEAEBC8389780376BA3EF1F63D417BA1B5528E95</td>
    </tr>
    <tr>
      <td>BiosFlashShell-efi64-81.02.efi</td>
      <td>CBFAA286144EB2D165A6B17245BAD4F73058436C7292BE56DC6EBA29A369ADDF</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.17.efi</td>
      <td>9D7E7174C281C6526B44C632BAA8C3320ADDD0C77DC90778CC14893882D74618</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.18.efi</td>
      <td>9B1F35052CFC5FB06DABE5E8F7B747F081DA28D722DB59ADE253B9E38A7A3C76</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.19.efi</td>
      <td>E3CE55E584371D3F2FBCA2241EF0711FF80876EBF71BAB07D8ECEE645A40DCFC</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.20.efi</td>
      <td>EE093913ABBD34CB8B5EA31375179A8B55A298353C03AFE5055AA4E8E3F705EF</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.21.efi</td>
      <td>B4E1880425F7857B741B921D04FD9276130927CF90A427C454B970E7A2F442F9</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-70.22.efi</td>
      <td>CDA0B4A59390B36E1B654850428CBB5B4C7B5E4349E87ACDE97FB543736FF1D4</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.17.efi</td>
      <td>C87EFD057497F90321D62A69B311912B8EF8A045FE9C5E6BD5C8C1A4E6F39629</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.18.efi</td>
      <td>9E19DD645235341A555D6AC0665591453AE13918ECD37DF22DFBEE91EAA9A2DA</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.19.efi</td>
      <td>63F67824FDA998798964FF33B87441857DA92F3A8EE3E04166EEC3156E4E6B82</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.20.efi</td>
      <td>0BC4F078388D41AB039F87AE84CF8D39302CCBDD70C4ADEE02263EBF6A2DD328</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.21.efi</td>
      <td>E2AEC271B9596A461EB6D54DB81785E4E4C615CFDA5F4504BCC0A329248A4D36</td>
    </tr>
    <tr>
      <td>Dtbios-efi64-71.22.efi</td>
      <td>6B4328EBCBE46ED9118FF2D4472DE329D70BA83016DF7A6F50F8AF92342160A1</td>
    </tr>
  </tbody>
</table></div><p>In terms of remediation, we recommend that impacted users update the <em>dbx</em> as soon as possible. In our previous research blog “<a href="https://www.binarly.io/blog/from-trust-to-trouble-the-supply-chain-implications-of-a-broken-dbx">From Trust to Trouble: The Supply Chain Implications of a Broken DBX</a>,” we described in detail the potential impact of outdated and inconsistent <em>dbx.</em></p><figure><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://www.youtube.com/embed/TnECRMf2CoQ" title="Combining a Secure Boot Bypass with a Bootkit on Windows 11"></iframe></p></figure><p><strong>Detecting CVE-2025-3052</strong></p><p>Secure Boot bypasses continue to be a persistent issue within the UEFI ecosystem, with new vulnerabilities surfacing a few times each year. For example, in January 2025, <a href="https://www.welivesecurity.com/en/eset-research/under-cloak-uefi-secure-boot-introducing-cve-2024-7344/">ESET researchers disclosed</a> the details of another Secure Boot bypass  (CVE-2024-7344). In addition, following the <a href="https://www.binarly.io/blog/from-trust-to-trouble-the-supply-chain-implications-of-a-broken-dbx">discrepancies we uncovered in the dbx</a> and their supply-chain implications that we discussed earlier this year, we decided to implement a new feature in our product specifically focused on Secure Boot security. This addition ensures that the Binarly Transparency Platform users are promptly informed with precise findings about any issues affecting Secure Boot, so that they can quickly remediate them.</p><p>Here is a demonstration of the Binarly Transparency Platform detecting and reporting on this Secure Boot bypass issue.</p><p>Binarly Deep Vulnerability Analysis (DVA) technology detects automatically CVE-2025-3052 as a previously unknown vulnerability (0-day):</p><p>Binarly Mitigate technology proactively detects signed vulnerable modules in DB/DBX databases to highlight potential high-impact risks:</p></div></div></div></div></div>
  </body>
</html>
