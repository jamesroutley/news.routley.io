<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.agwa.name/projects/git-crypt/">Original</a>
    <h1>Git-crypt – transparent file encryption in Git</h1>
    
    <div id="readability-page-1" class="page"><div>
			

			<p><strong>git-crypt</strong> enables transparent encryption and decryption of files in a git repository.  Files which you choose to protect are encrypted when committed, and decrypted when checked out.  git-crypt lets you freely share a repository containing a mix of public and private content.  git-crypt gracefully degrades, so developers without the secret key can still clone and commit to a repository with encrypted files.  This lets you store your secret material (such as keys or passwords) in the same repository as your code, without requiring you to lock down your entire repository.</p>

			<div>
				<h3>Using git-crypt</h3>

				<div>
					<h4>Setting up git-crypt</h4>

					<p>Configure a repository to use git-crypt:</p>

					<p><kbd>
						<p><span>cd repo</span></p>
						<p><span>git-crypt init</span></p>
					</kbd></p><p>Specify files to encrypt by creating a <code>.gitattributes</code> file in the repository, like this:</p>

					<p><code>
						<p><span>secretfile filter=git-crypt diff=git-crypt</span></p>
						<p><span>*.key filter=git-crypt diff=git-crypt</span></p>
						<p><span>secretdir/** filter=git-crypt diff=git-crypt</span></p>
					</code></p><p>Like a .gitignore file, it can match wildcards and should be checked into the repository.  See the <a href="https://www.agwa.name/git/git-crypt.git/raw/master/README">README</a> for more information about .gitattributes.  Make sure you don&#39;t accidentally encrypt the .gitattributes file itself (or other git files like .gitignore or .gitmodules).  Make sure your .gitattributes rules are in place <em>before</em> you add sensitive files, or those files won&#39;t be encrypted!</p>
				</div>

				<div>
					<h4>GPG Mode</h4>
					<p>Share the repository with others (or with yourself) using GPG:</p>

					<p><kbd>
						<p><span>git-crypt add-gpg-user <span>USER_ID</span></span></p>
					</kbd></p><p><span>USER_ID</span> can be a key ID, a full fingerprint, an email address, or anything else that uniquely identifies a public key to GPG (see &#34;HOW TO SPECIFY A USER ID&#34; in the gpg man page).  Note: <kbd><span>git-crypt add-gpg-user</span></kbd> will add and commit a GPG-encrypted key file in the .git-crypt directory of the root of your repository.</p>

					<p>After cloning a repository with encrypted files, unlock with:</p>

					<p><kbd>
						<p><span>git-crypt unlock</span></p>
					</kbd>
				</p></div>

				<div>
					<h4>Symmetric Mode</h4>

					<p>Alternatively, you can export a symmetric secret key, which you must securely convey to collaborators (GPG is not required, and no files are added to your repository):</p>

					<p><kbd>
						<p><span>git-crypt export-key /path/to/keyfile</span></p>
					</kbd></p><p>After cloning a repository with encrypted files, unlock with:</p>

					<p><kbd>
						<p><span>git-crypt unlock /path/to/keyfile</span></p>
					</kbd>
				</p></div>

				<p>That&#39;s all you need to do - after git-crypt is set up (either with <kbd><span>git-crypt init</span></kbd> or <kbd><span>git-crypt unlock</span></kbd>), you can use git normally - encryption and decryption happen transparently.</p>
			</div>

			<div>
				<h3>Motivation</h3>

				<p>I wanted to make a configuration management repository open for others to look at and contribute to (à la <a href="http://blog.wikimedia.org/2011/09/19/ever-wondered-how-the-wikimedia-servers-are-configured/" rel="external">Wikimedia&#39;s Puppet repository</a>).  However, the repository contained secret material, like SSL keys and passwords.  git-crypt was developed so the secret material could be protected without having to remove it from the repository (which is what Wikimedia had to do).</p>
			</div>

			<div>
				<h3>Getting git-crypt</h3>

				<div>
					<h4>Building from Source (latest official release)</h4>

					<p>
						Download and extract <a href="https://www.agwa.name/projects/git-crypt/downloads/git-crypt-0.7.0.tar.gz">git-crypt-0.7.0.tar.gz</a>
						
						and run:
					</p>

					<p><kbd>
						<p><span>cd git-crypt-0.7.0</span></p>
						<p><span>make</span></p>
						<p><span>make install</span></p>
					</kbd></p><p>
						To install to a specific location:
					</p>
					<p><kbd>
						<p><span>make install PREFIX=/usr/local</span></p>
					</kbd>
				</p></div>

				

				<div>
					<h4>Building from Git (development version; less stable and with no compatibility guarantee)</h4>

					<p><kbd>
						<p><span>git clone https://www.agwa.name/git/git-crypt.git</span></p>
						<p><span>cd git-crypt</span></p>
						<p><span>make</span></p>
						<p><span>make install</span></p>
					</kbd>
				</p></div>

				

				
			</div>

			<div>
				<h3>Dependencies</h3>

				<p>To use git-crypt, you need:</p>

				<ul><li>Git 1.7.2 or newer (Git 1.8.5 or newer is recommended for best performance)</li><li>OpenSSL</li></ul>

				<p>To build git-crypt, you need a C++ compiler, and OpenSSL development headers.  The Makefile is tailored for g++, but other compilers should work too.</p>
			</div>

			<div>
				<h3>Current Status</h3>

				<p>The latest version of git-crypt is <strong>0.7.0</strong>, released on 2022-04-21.  git-crypt aims to be bug-free and reliable, meaning it shouldn&#39;t crash, malfunction, or expose your confidential data.  However, it has not yet reached maturity, meaning it is not as documented, featureful, or easy-to-use as it should be.  Additionally, there may be backwards-incompatible changes introduced before version 1.0.</p>
			</div>

			<div>
				<h3>Security</h3>

				<p>git-crypt is more secure than other transparent git encryption systems.  git-crypt encrypts files using AES-256 in CTR mode with a synthetic IV derived from the SHA-1 HMAC of the file.  This mode of operation provides semantic security under deterministic chosen-plaintext attack.  That means that although the encryption is deterministic (which is required so git can distinguish when a file has and hasn&#39;t changed), it leaks no information beyond whether two files are identical or not.  Other proposals for transparent git encryption use ECB or CBC with a fixed IV.  These systems are not semantically secure and leak information.</p>
			</div>

			<div>
				<h3>Limitations</h3>

				<p>git-crypt relies on git filters, which were not designed with encryption in mind.  As such, git-crypt is not the best tool for encrypting most or all of the files in a repository. Where git-crypt really shines is where most of your repository is public, but you have a few files (perhaps private keys named *.key, or a file with API credentials) which you need to encrypt.  For encrypting an entire repository, consider using a system like <a href="https://spwhitton.name/tech/code/git-remote-gcrypt/" rel="external">git-remote-gcrypt</a> instead.  (Note: no endorsement is made of git-remote-gcrypt&#39;s security.)</p>

				<p>git-crypt does not encrypt file names, commit messages, symlink targets, gitlinks, or other metadata.</p>

				<p>git-crypt does not hide when a file does or doesn&#39;t change, the length of a file, or the fact that two files are identical (see &#34;Security&#34; section above).</p>

				<p>git-crypt does not support revoking access to an encrypted repository which was previously granted. This applies to both multi-user GPG mode (there&#39;s no del-gpg-user command to complement add-gpg-user) and also symmetric key mode (there&#39;s no support for rotating the key).  This is because it is an inherently complex problem in the context of historical data. For example, even if a key was rotated at one point in history, a user having the previous key can still access previous repository history. This problem is discussed in more detail in <a href="https://github.com/AGWA/git-crypt/issues/47" rel="external">Issue #47</a>.</p>

				<p>Files encrypted with git-crypt are not compressible.  Even the smallest change to an encrypted file requires git to store the entire changed file, instead of just a delta.</p>

				<p>Although git-crypt protects individual file contents with a SHA-1 HMAC, git-crypt cannot be used securely unless the entire repository is protected against tampering (an attacker who can mutate your repository can alter your .gitattributes file to disable encryption).  If necessary, use git features such as signed tags instead of relying solely on git-crypt for integrity.</p>
			</div>
			
			
		</div></div>
  </body>
</html>
