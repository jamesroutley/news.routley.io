<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/QuadrupleA/sqlite-page-explorer">Original</a>
    <h1>Show HN: SQLite disk page explorer</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A small GUI application built in <a href="https://redbean.dev/" rel="nofollow">redbean</a> that lets you explore your <a href="https://sqlite.com/" rel="nofollow">SQLite</a> databases &#34;page by page&#34; the way SQLite sees them.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/QuadrupleA/sqlite-page-explorer/blob/github_media/github_media/top_view.png"><img src="https://github.com/QuadrupleA/sqlite-page-explorer/raw/github_media/github_media/top_view.png" alt="Top-level view"/></a></p>
<hr/>

<p dir="auto">SQLite (and most databases) store data in disk-block-sized pages, usually 4KB, which helps make reads and writes as fast as possible.</p>
<p dir="auto">Normally developers interact with databases on the &#34;schema level&#34; - tables, rows, and SQL. But taking a peek at the &#34;page level&#34; can give you some interesting insights:</p>
<ul dir="auto">
<li>What your indexes actually look like on disk (they&#39;re basically separate little tables).</li>
<li>How to store things more compactly (and thus make your queries and applications faster).</li>
<li>Spot problems and inefficiencies you might not see on the schema level.</li>
<li>Gain an intuition for B-Trees, one of computing&#39;s most important data structures, the foundation of most filesystems and databases.</li>
</ul>

<p dir="auto">Thanks to the magic of redbean, <a href="https://github.com/jart/cosmopolitan">cosmopolitan</a> and <a href="https://justine.lol/ape.html" rel="nofollow">αcτµαlly pδrταblε εxεcµταblε</a>, it&#39;s just a single 6.5 MB executable that runs natively on Windows, Linux, MacOS, various BSDs, on both ARM64 and x64.</p>
<p dir="auto">It&#39;s also a zip file that contains the Lua code that runs the app, parses the database binary format, etc.</p>

<ul dir="auto">
<li>Download <code>sqlite-page-explorer.com</code> from the <a href="https://github.com/QuadrupleA/sqlite-page-explorer/releases/">releases</a>.</li>
<li>On Unix-likes, <code>chmod +x</code>.</li>
<li>Drag a database file to it, or run it on the console: <code>sqlite-page-explorer.com mySqliteDatabase.db</code>. The app should open in a browser tab.</li>
<li>When you&#39;re done, hit Ctrl-C twice in the console.</li>
</ul>
<p dir="auto">You might get virus warnings - αcτµαlly pδrταblε εxεcµταblεs seem to freak out browsers, operating system virus detection, etc. and generate false positives. I trust <a href="https://github.com/jart/">jart</a> is not propagating malware here, and some notable projects like <a href="https://github.com/Mozilla-Ocho/llamafile">llamafile</a> are using these same polyglot binary techniques, but take your usual precautions with anything you download off the internet.</p>
<p dir="auto">Also if you throw a large database at it (500 MB or more) it will likely be slow to load the top-level view, which reads every page.</p>

<p dir="auto">To build, you just need to <code>zip</code> the contents of <code>files/</code> into the stock <code>redbean-3.0.0-cosmos.com</code> which I downloaded from <a href="https://cosmo.zip/pub/cosmos/bin/" rel="nofollow">https://cosmo.zip/pub/cosmos/bin/</a> (click &#34;redbean&#34; on the list). You might need <code>zip</code> from there too if your system doesn&#39;t have it.</p>
<p dir="auto">Or just run the <code>zipitup.py</code> python (3.6+) script that&#39;s included.</p>
<p dir="auto">If you want to hack on it, you can run <code>redbean-3.0.0-cosmos.com -D files</code> to serve the app from the <code>files</code> subdirectory, so you don&#39;t have to rebuild the zip on every change.</p>

<p dir="auto">This was partly an experiment to try out redbean, and also my first time using Lua, so the code is probably klunkier than it could be. It might benefit from a templating system, ala Jinja or bottle.py&#39;s native templates, rather than so many string concatenations and Write() statements. Would be nice to auto-close the console when the last tab closes, and maybe stop at page 10,000 or so for huge databases, unless the user confirms. PR&#39;s welcome!</p>
</article></div></div>
  </body>
</html>
