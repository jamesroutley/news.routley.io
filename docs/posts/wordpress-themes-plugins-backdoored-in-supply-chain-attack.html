<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bleepingcomputer.com/news/security/over-90-wordpress-themes-plugins-backdoored-in-supply-chain-attack/">Original</a>
    <h1>WordPress themes, plugins backdoored in supply chain attack</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><img alt="chain" height="928" src="https://www.bleepstatic.com/content/hl-images/2021/02/08/supply-chain.jpg?rand=179594257" width="1862"/></p>
<p>A massive supply chain attack compromised 93 WordPress themes and plugins to contain a backdoor, giving threat-actors full access to websites.</p>
<p>In total, threat actors compromised 40 themes and 53 plugins belonging to AccessPress, a developer of WordPress add-ons used in over 360,000 active websites.</p>
<p>The attack was discovered by researchers at Jetpack, the creators of a security and optimization tool for WordPress sites, who discovered that a PHP backdoor had been added to the themes and plugins.</p>
<p>Jetpack believes an external threat actor breached the AccessPress website to compromise the software and infect further WordPress sites.</p>
<h2>A backdoor to give complete control</h2>
<p>As soon as admins installed a compromised AccessPress product on their site, the actors added a new “initial.php” file into the main theme directory and included it in the main “functions.php” file.</p>
<p>This file contained a base64 encoded payload that writes a webshell into the “./wp-includes/vars.php” file.</p>
<div>
<figure><img alt="Encoded payload writing the webshell" height="600" src="https://www.bleepstatic.com/images/news/u/1220909/Code%20and%20Details/backdoor.png" width="675"/><figcaption><strong>Encoded payload writing the webshell</strong></figcaption></figure></div>
<p>The malicious code completed the backdoor installation by decoding the payload and injecting it into the “vars.php” file, essentially giving the threat actors remote control over the infected site.</p>
<p>The only way to detect this threat is to use a core file integrity monitoring solution, as the malware deletes the “initial.php” file dropper to cover its tracks.</p>
<p>According to <a href="https://blog.sucuri.net/2022/01/accesspress-themes-hit-with-targeted-supply-chain-attack.html" target="_blank" rel="nofollow noopener">Sucuri</a> researchers who investigated the case to figure out the actors’ goal, threat actors used the backdoor to redirect visitors to malware-dropping and scam sites. Therefore, the campaign wasn’t very sophisticated.</p>
<p>It’s also possible that the actor used this malware to sell access to backdoored websites on the dark web, which would be an effective way to monetize such a large-scale infection.</p>
<h2>Am I affected?</h2>
<p>If you have installed one of the compromised plugins or themes on your site, removing/replacing/updating them won’t uproot any webshells that may have been planted through it.</p>
<p>As such, website administrators are advised to scan their sites for signs of compromise by doing the following:</p>
<ul><li>Check your wp-includes/vars.php file around lines 146-158. If you see a “wp_is_mobile_fix” function there with some obfuscated code, you’ve been compromised.</li>
<li>Query your file system for “wp_is_mobile_fix” or “wp-theme-connect” to see if there are any affected files</li>
<li>Replace your core WordPress files with fresh copies.</li>
<li>Upgrade the affected plugins and switch to a different theme.</li>
<li>Change the wp-admin and database passwords.</li>
</ul><p>Jetpack has provided the following YARA rule that can be used to check if a site has been infected and detect both the dropper and the installed webshell.</p>
<pre><code>rule accesspress_backdoor_infection
{
strings:
 
   // IoC&#39;s for the dropper
   $inject0 = &#34;$fc = str_replace(&#39;function wp_is_mobile()&#39;,&#34;
   $inject1 = &#34;$b64($b) . &#39;function wp_is_mobile()&#39;,&#34;
   $inject2 = &#34;$fc);&#34;
   $inject3 = &#34;@file_put_contents($f, $fc);&#34;
 
   // IoC&#39;s for the dumped payload
   $payload0 = &#34;function wp_is_mobile_fix()&#34;
   $payload1 = &#34;$is_wp_mobile = ($_SERVER[&#39;HTTP_USER_AGENT&#39;] == &#39;wp_is_mobile&#39;);&#34;
   $payload2 = &#34;$g = $_COOKIE;&#34;
   $payload3 = &#34;(count($g) == 8 &amp;&amp; $is_wp_mobile) ?&#34;
 
   $url0 = /https?:\/\/(www\.)?wp\-theme\-connect\.com(\/images\/wp\-theme\.jpg)?/
 
condition:
 
   all of ( $inject* )
   or all of ( $payload* )
   or $url0
}</code></pre>
<h2>Backdoors detected in September</h2>
<p>Jetpack first detected the backdoor in September 2021, and soon after, the researchers discovered that threat actors had compromised all free plugins and themes belonging to the vendor.</p>
<p>Jetpack believes that the paid AccessPress add-ons were likely compromised but didn’t test those, so this cannot be confirmed.</p>
<p>Most of the products had likely been compromised in early September from the timestamps.</p>
<p>On October 15, 2021, the vendor removed the extensions from the official download portal until the point of the compromise was located and fixed.</p>
<p>On January 17, 2022, AccessPress released new, “cleaned” versions for all the affected plugins.</p>
<p>However, the affected themes haven’t been cleaned yet, so migrating to a different theme is the only way to mitigate the security risks.</p>
<p>Users of AccessPress plugins and themes can read <a href="https://jetpack.com/2022/01/18/backdoor-found-in-themes-and-plugins-from-accesspress-themes/" target="_blank" rel="nofollow noopener">Jetpack’s post</a> for a complete list of the fixed products.</p>
<p>BleepingComputer attempted to contact AccessPress about the compromise, but the contact form is not working.</p>
<div>
<h3>Related Articles:</h3>
<p><a href="https://www.bleepingcomputer.com/news/security/wordpress-plugin-flaw-puts-users-of-20-000-sites-at-phishing-risk/">WordPress plugin flaw puts users of 20,000 sites at phishing risk</a></p><p><a href="https://www.bleepingcomputer.com/news/security/800k-wordpress-sites-still-impacted-by-critical-seo-plugin-flaw/">800K WordPress sites still impacted by critical SEO plugin flaw</a></p><p><a href="https://www.bleepingcomputer.com/news/security/massive-attack-against-16-million-wordpress-sites-underway/">Massive attack against 1.6 million WordPress sites underway</a></p><p><a href="https://www.bleepingcomputer.com/news/security/hackers-infect-random-wordpress-plugins-to-steal-credit-cards/">Hackers infect random WordPress plugins to steal credit cards</a></p><p><a href="https://www.bleepingcomputer.com/news/security/dev-corrupts-npm-libs-colors-and-faker-breaking-thousands-of-apps/">Dev corrupts NPM libs &#39;colors&#39; and &#39;faker&#39; breaking thousands of apps</a></p>
</div>
</div></div>
  </body>
</html>
