<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://krebsonsecurity.com/2023/08/how-malicious-android-apps-slip-into-disguise/">Original</a>
    <h1>Malicious Android Apps Slip into Disguise</h1>
    
    <div id="readability-page-1" class="page"><div>
												<p><img decoding="async" src="https://krebsonsecurity.com/wp-content/uploads/2023/08/grandroidude.png" alt="" width="750" height="481"/></p>
<p>Researchers say mobile malware purveyors have been abusing a bug in the <strong>Google Android</strong> platform that lets them sneak malicious code into mobile apps and evade security scanning tools. Google says it has updated its app malware detection mechanisms in response to the new research.</p>
<p>At issue is a mobile malware obfuscation method identified by researchers at <a href="https://www.threatfabric.com" target="_blank" rel="noopener">ThreatFabric</a>, a security firm based in Amsterdam. <strong>Aleksandr Eremin</strong>, a senior malware analyst at the company, told KrebsOnSecurity they recently encountered a number of mobile banking trojans abusing a bug present in all Android OS versions that involves corrupting components of an app so that its new evil bits will be ignored as invalid by popular mobile security scanning tools, while the app as a whole gets accepted as valid by Android OS and successfully installed.</p>
<p>“There is malware that is patching the .apk file [the app installation file], so that the platform is still treating it as valid and runs all the malicious actions it’s designed to do, while at the same time a lot of tools designed to unpack and decompile these apps fail to process the code,” Eremin explained.</p>
<p>Eremin said ThreatFabric has seen this malware obfuscation method used a few times in the past, but in April 2023 it started finding many more variants of known mobile malware families leveraging it for stealth. The company has since attributed this increase to a semi-automated malware-as-a-service offering in the cybercrime underground that will obfuscate or “crypt” malicious mobile apps for a fee.</p>
<p>Eremin said Google flagged their initial May 9, 2023 report as “high” severity. More recently, Google awarded them a $5,000 bug bounty, even though it did not technically classify their finding as a security vulnerability.</p>
<p>“This was a unique situation in which the reported issue was not classified as a vulnerability and did not impact the Android Open Source Project (AOSP), but did result in an update to our malware detection mechanisms for apps that might try to abuse this issue,” Google said in a written statement.</p>
<p>Google also acknowledged that some of the tools it makes available to developers — including <a href="https://developer.android.com/tools/apkanalyzer" target="_blank" rel="noopener">APK Analyzer</a> — currently fail to parse such malicious applications and treat them as invalid, while still allowing them to be installed on user devices.</p>
<p>“We are investigating possible fixes for developer tools and plan to update our documentation accordingly,” Google’s statement continued.</p>
<div id="attachment_64470"><p><img aria-describedby="caption-attachment-64470" decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2023/08/tf-apk.png" alt="" width="701" height="399"/></p><p id="caption-attachment-64470">Image: ThreatFabric.</p></div>

<p>According to ThreatFabric, there are a few telltale signs that app analyzers can look for that may indicate a malicious app is abusing the weakness to masquerade as benign. For starters, they found that apps modified in this way have <a href="https://maldr0id.blogspot.com/2014/09/having-fun-with-androidmanifestxml.html" target="_blank" rel="noopener">Android Manifest files</a> that contain newer timestamps than the rest of the files in the software package.</p>
<p>More critically, the Manifest file itself will be changed so that the number of “strings” — plain text in the code, such as comments — specified as present in the app does match the actual number of strings in the software.</p>
<p>One of the mobile malware families known to be abusing this obfuscation method has been dubbed <strong>Anatsa</strong>, which is a sophisticated Android-based banking trojan that typically is disguised as a harmless application for managing files. Last month, ThreatFabric <a href="https://www.threatfabric.com/blogs/anatsa-hits-uk-and-dach-with-new-campaign" target="_blank" rel="noopener">detailed</a> how the crooks behind Anatsa will purchase older, abandoned file managing apps, or create their own and let the apps build up a considerable user base before updating them with malicious components.</p>
<p>ThreatFabric says Anatsa poses as PDF viewers and other file managing applications because these types of apps already have advanced permissions to remove or modify other files on the host device. The company estimates the people behind Anatsa have delivered more than 30,000 installations of their banking trojan via ongoing Google Play Store malware campaigns.</p>
<p>Google has come under fire in recent months for failing to more proactively police its Play Store for malicious apps, or for once-legitimate applications that later go rogue. <a href="https://arstechnica.com/information-technology/2023/05/app-with-50000-google-play-installs-sent-attackers-mic-recordings-every-15-minutes/" target="_blank" rel="noopener">This May 2023 story</a> from <em>Ars Technica</em> about a formerly benign screen recording app that turned malicious after garnering 50,000 users notes that Google doesn’t comment when malware is discovered on its platform, beyond thanking the outside researchers who found it and saying the company removes malware as soon as it learns of it.</p>
<p>“The company has never explained what causes its own researchers and automated scanning process to miss malicious apps discovered by outsiders,” Ars’ <strong>Dan Goodin</strong> wrote. “Google has also been reluctant to actively notify Play users once it learns they were infected by apps promoted and made available by its own service.”</p>
<p>The Ars story mentions one potentially positive change by Google of late: A preventive measure available in Android versions 11 and higher that implements “app hibernation,” which puts apps that have been dormant into a hibernation state that removes their previously granted runtime permissions.</p>
											</div></div>
  </body>
</html>
