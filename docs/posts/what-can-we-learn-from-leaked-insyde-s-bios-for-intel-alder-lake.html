<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hardenedvault.net/blog/2022-10-08-alderlake_fw-leak/">Original</a>
    <h1>What can we learn from leaked Insyde&#39;s BIOS for Intel Alder Lake</h1>
    
    <div id="readability-page-1" class="page"><div><h2 id="leaked-story-timeline">Leaked story timeline</h2>
<p>According to the timestamp of the github <a href="https://github.com/LCFCASD/ICE_TEA_BIOS">repository</a>, an unidentified user uploaded the Insyde’s partial firmware solution (4.8GB) only for Intel Alder Lake platform, which contains Intel reference implementation, OEM implementation, IBV solution, and related documentation on September 30, 2022.</p>



















































 














<p><img title="" loading="lazy" decoding="async" width="925" height="96" src="https://hardenedvault.net/images/blog/intel-leak/fw-leak1_hu800ae1508fa08e91c888eaa6178d5b14_20571_925x96_fit_q100_h2_box_3.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/intel-leak\/fw-leak1_hu800ae1508fa08e91c888eaa6178d5b14_20571_925x96_fit_q100_box_3.png&#39;"/></p><p>On October 8 2022, the leaks attracted <a href="https://www.tomshardware.com/news/intels-alder-lake-bios-source-code-reportedly-leaked-online">media tom’sHardware attention and reports</a>, followed by <a href="https://github.com/LCFCASD/ICE_TEA_BIOS">the original repository deleted</a>. Security researchers can still get leaked content via <a href="https://web.archive.org/web/20221007235925/https://codeload.github.com/LCFCASD/ICE_TEA_BIOS/zip/refs/heads/master%5D">Internet Archive</a> or forked repositories.</p>
<h2 id="leaked-content">Leaked content</h2>
<table>
<thead>
<tr>
<th>IBV</th>
<th>OEM</th>
<th>Support platform</th>
<th>Host firmware</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insyde</td>
<td>Lenovo</td>
<td>Intel Alder Lake</td>
<td>UEFI</td>
</tr>
</tbody>
</table>



















































 














<p><img title="" loading="lazy" decoding="async" width="800" height="364" src="https://hardenedvault.net/images/blog/ibv-oem_hu1451baedc29557cc415e9ecc1dcd66d7_103662_800x364_fit_q100_h2_box_3.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/ibv-oem_hu1451baedc29557cc415e9ecc1dcd66d7_103662_800x364_fit_q100_box_3.png&#39;"/></p><p>Insyde is an IBV (Independent BIOS Vendor) developer and integrator of the firmware solution for various platforms. The leaked content is only part of the Insyde solution, which only supports Alder Lake. But there are several interesting finds:</p>
<ul>
<li>Toolings from Insyde, that’d make OEM’s work easier like provisioning or tweaking BIOS images</li>
<li>Insyde’s framework for customization, which wrapped into EDK2-compatible interfaces, makes it easier for ODM/OEMs to integrate platform components such as Intel FSP</li>
<li>Intel reference implementation as well as the OEM implementation. Lenovo as an OEM vendor plays the main role in the leaked story.</li>
</ul>



















































 














<p><img title="" loading="lazy" decoding="async" width="592" height="528" src="https://hardenedvault.net/images/blog/intel-leak/fw-leak4_hudeb05bb8f6b8199e24dec444cb1c9841_91144_592x528_fit_q100_h2_box_3.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/intel-leak\/fw-leak4_hudeb05bb8f6b8199e24dec444cb1c9841_91144_592x528_fit_q100_box_3.png&#39;"/></p><ul>
<li>Binary blobs: It’s worth noting that in addition to the binary blobs required by various devices (Bluetooth BLE, WiFi, Ethernet, etc.), there are three different ACMs for security features: BiosGuard, BootGuard, and TXT</li>
</ul>
<p>In addition, one thing should be noted that the key pairs required by BootGuard during provisioning stage is also included in the leaked content:</p>



















































 














<p><img title="" loading="lazy" decoding="async" width="692" height="368" src="https://hardenedvault.net/images/blog/intel-leak/fw-leak2_huc18a204b044b3f64596977894870b8bd_73067_692x368_fit_q100_h2_box_3.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/intel-leak\/fw-leak2_huc18a204b044b3f64596977894870b8bd_73067_692x368_fit_q100_box_3.png&#39;"/></p><p>In x86, the ACMs is signed by Intel while the OEM controls the latter part:</p>



















































 














<p><img title="" loading="lazy" decoding="async" width="536" height="451" src="https://hardenedvault.net/images/blog/intel-leak/fw-leak3_hu5df628001e4d8f8898fd0393c3b397dc_14932_536x451_fit_q100_h2_box_3.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/intel-leak\/fw-leak3_hu5df628001e4d8f8898fd0393c3b397dc_14932_536x451_fit_q100_box_3.png&#39;"/></p><p>Let’s pray for Lenovo didn’t use any of those keys in the production (Prove us wrong!)!</p>
<h2 id="risk-assessment-of-the-leak-to-users">Risk assessment of the leak to users</h2>
<p>UEFI is highly rely on SMM (System Management Mode) that has greater priviledges than operating system and <a href="https://hardenedvault.net/blog/2021-09-19-vaultboot/">complexity of the firmware supply chain</a> have led to higher security risks. The current <a href="https://github.com/hardenedvault/bootkit-samples">disclosed massive exploitation of malicious firmware/bootkits</a> and those not yet being disclosed is a big risk for both individual and data centers. We do not have comprehensive review of the leaked content. The attacker/bug hunter can hugely benefit from the leaks even if leaked OEM implementation is only partially used in the production. The Insyde’s solution can help the security researchers, bug hunters (and the attackers) find the vulnerablity and understand the result of reverse engineering easily, which adds up to the long-term high risk to the users.</p>
<h2 id="can-open-source-firmware-projects-benefit-from-leaked-content">Can open source firmware projects benefit from leaked content?</h2>
<p>Unfortunately, no or rarely. These materials could theoretically help two groups of people:</p>
<pre><code>* Individuals or organizations that are not eligible to sign CNDA with Intel, such as open source firmware maintainers. Please note that open source firmware projects cannot directly benefit/reuse from leaked content due to legal risks
* Researchers trying to understand complex supply chains
</code></pre>
<h2 id="whos-the-leaker">Who’s the leaker</h2>
<p>The few pieces of information come from the <a href="https://twitter.com/SttyK/status/1578582946352488448">git log</a>:</p>



















































 














<p><img title="" loading="lazy" decoding="async" width="350" height="331" src="https://hardenedvault.net/images/blog/intel-leak/fw-leak5_hu1800da0668ad25bd6af62c0d789875a9_39710_350x331_fit_q100_h2_box.webp" alt="alter-text" onerror="this.onerror=&#39;null&#39;;this.src=&#39;\/images\/blog\/intel-leak\/fw-leak5_hu1800da0668ad25bd6af62c0d789875a9_39710_350x331_fit_q100_box.jpeg&#39;"/></p><p>But it is still impossible to confirm the person who leaked it. The leak is part of Insyde solution which integrate Intel’s resources. Perhaps Insyde knows more than we do.</p>
<h2 id="how-data-center-react">How data center react</h2>
<p>Server models are not affected by the leaked content directly but there may be some shared code base of firmware between server and desktop, so the data center should prepare:</p>
<ul>
<li>
<p>Short-term plan:</p>
<ul>
<li>Security team and patch management team should work together to ensure critical devices are upgraded to the latest version</li>
<li>The security operation team keep monitoring the priviledge escalation in operating system</li>
<li>Threat detection and auditing against existing firmware</li>
</ul>
</li>
<li>
<p>Long-term solution:</p>
<ul>
<li>Replace UEFI with <a href="https://coreboot.org/">coreboot</a>/oreboot-based next-generation firmware</li>
<li>Integrate with security payloads (such as <a href="https://github.com/hardenedvault/vaultboot">VaultBoot</a>, LinuxBoot, etc.) to implement provisioning of hardware security features</li>
</ul>
</li>
</ul>
</div></div>
  </body>
</html>
