<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/arp242/goatcounter/releases/tag/v2.5.0">Original</a>
    <h1>GoatCounter creator is hoping to raise at least €1k for basic living expense</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="">
  <div data-view-component="true">
  
  <div data-view-component="true">      

  <div data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">
    <div>
  <div>
      <p><img src="https://avatars.githubusercontent.com/u/1032692?s=40&amp;v=4" alt="@arp242" size="20" height="20" width="20" data-view-component="true"/>
      <a data-hovercard-type="user" data-hovercard-url="/users/arp242/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/arp242">arp242</a>

    released this

      </p><relative-time prefix="" datetime="2023-12-14T02:58:03Z">
        14 Dec 02:58
      </relative-time>
  </div>

  
        <p>
          ·
          <a href="https://github.com/arp242/goatcounter/compare/v2.5.0...master">
            8 commits
          </a>
          to master
          since this release
        </p>

        
        

</div>
  </div>
        <div data-pjax="true" data-test-selector="body-content" data-view-component="true"><p>The funding goal was reached, <em>and</em> I&#39;m starting a job next week. So things should be grand!</p>
<p>Of course, you can still donate if you want to; it&#39;s just no longer &#34;needed-needed&#34;.</p>
<p><a href="https://github.com/sponsors/arp242">https://github.com/sponsors/arp242</a></p>
<p>Many thanks,</p>
<hr/>
<p>And then now for the actual changelog:</p>
<p>This release requires Go 1.21.</p>
<p>Features:</p>
<ul>
<li>
<p>Quite a few tables are rewritten to a more efficient format. For small to medium instances this will take a few minutes at the most, but if you have very large instances this may take a few hours. It also requires enough free disk space to rewrite the <code>hits</code> table.</p>
<p>If you want to run steps manually then you can view the migration with:</p>
<div data-snippet-clipboard-copy-content="% goatcounter db migrate -show 2023-05-16-1-hits"><pre><code>% goatcounter db migrate -show 2023-05-16-1-hits
</code></pre></div>
<p>Or if you use PostgreSQL:</p>
<div data-snippet-clipboard-copy-content="% goatcounter db migrate -show -db postgresql+dbname=goatcounter 2023-05-16-1-hits"><pre><code>% goatcounter db migrate -show -db postgresql+dbname=goatcounter 2023-05-16-1-hits
</code></pre></div>
</li>
<li>
<p>The <code>User-Agent</code> header is no longer stored; only the browser and system parsed out of there. It&#39;s pretty reliable, and especially mobile browser User-Agents are ridiculously unique. It was always stored only &#34;in case the detection got it horribly wrong&#34;, but this has never been needed.</p>
</li>
<li>
<p>Add <code>proxy</code> option in <code>serve -tls</code> flag,  to give a hint that a secure connection will be used, so we know what value to use for the cookie secure/samesite flags.</p>
</li>
<li>
<p>Add <em>experimental</em> &#34;dark mode&#34;; this needs to be enabled explicitly in the user settings. I need help to make this decent:</p>
</li>
<li>
<p>Show difference of pageviews compared to previous period on the dashboard.</p>
</li>
<li>
<p>Make setup of a new installation a bit easier: instead of telling people to use the CLI, display a form when the database is 100% empty.</p>
</li>
</ul>
<p>Fixes:</p>
<ul>
<li>
<p>Collecting stats was broken when &#34;sessions&#34; was disabled in the site settings.</p>
</li>
<li>
<p>Use navigator.sendBeacon by default in count.js. This will allow using click events on things like PDF files and external URLs:</p>
<div data-snippet-clipboard-copy-content="&lt;a href=&#34;file.pdf&#34; data-goatcounter-event=&#34;file.pdf&#34;&gt;
&lt;a href=&#34;http://example.com&#34; data-goatcounter-event=&#34;ext-example.com&#34;&gt;"><pre><code>&lt;a href=&#34;file.pdf&#34; data-goatcounter-event=&#34;file.pdf&#34;&gt;
&lt;a href=&#34;http://example.com&#34; data-goatcounter-event=&#34;ext-example.com&#34;&gt;
</code></pre></div>
</li>
<li>
<p>Sometimes the order of pages was wrong when using PostgreSQL.</p>
</li>
<li>
<p>Few smaller bugfixes.</p>
</li>
</ul></div>
</div>
  
</div></div></div>
  </body>
</html>
