<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/security/2023/12/hackers-can-break-ssh-channel-integrity-using-novel-data-corruption-attack/">Original</a>
    <h1>SSH protects the most sensitive networks. It just got a lot weaker</h1>
    
    <div id="readability-page-1" class="page"><div>
        <header>
            <h4>
      MESSING WITH SSH DATA STREAMS    —
</h4>
            
            <h2 itemprop="description">Novel Terrapin attack uses prefix truncation to downgrade the security of SSH channels.</h2>
            <section>

  


  
</section>        </header>
        <section>
            <div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2023/12/terrapin-data-attack-800x450.jpg" alt="Terrapin is coming for your data."/>
      <figcaption><p><a href="https://cdn.arstechnica.net/wp-content/uploads/2023/12/terrapin-data-attack.jpg" data-height="1440" data-width="2560">Enlarge</a> <span>/</span> Terrapin is coming for your data.</p><p>Aurich Lawson | Getty Images</p></figcaption>  </figure>

  




<!-- cache hit 212:single/related:09b2b1ce1005fdee05d0fb775004de6c --><!-- empty -->
<p>Sometime around the start of 1995, an unknown person planted a password sniffer on the network backbone of Finland’s Helsinki University of Technology (now known as Aalto University). Once in place, this piece of dedicated hardware surreptitiously inhaled thousands of user names and passwords before it was finally discovered. Some of the credentials belonged to employees of a company run by Tatu Ylönen, who was also a database researcher at the university.</p>
<p>The event proved to be seminal, not just for Ylönen&#39;s company but for the entire world. Until that point, people like Ylönen connected to networks using tools which implemented protocols such as Telnet, rlogin, rcp, and rsh. All of these transmitted passwords (and all other data) as plaintext, providing an endless stream of valuable information to sniffers. Ylönen, who at the time knew little about implementing strong cryptography in code, set out to develop the <a href="https://en.wikipedia.org/wiki/Secure_Shell">Secure Shell Protocol (SSH)</a> in early 1995, about three months after the discovery of the password sniffer.</p>
<p>As one of the first network tools to route traffic through an impregnable tunnel fortified with a still-esoteric feature known as &#34;public key encryption,&#34; SSH quickly caught on around the world. Besides its unprecedented security guarantees, SSH was easy to install on a wide array of operating systems, including the myriad ones that powered the devices administrators used—and the servers those devices connected to remotely. SSH also supported <a href="https://goteleport.com/blog/x11-forwarding/">X11 forwarding</a>, which allowed users to run graphical applications on a remote server.</p>
<p>Ylönen submitted SSH to the Internet Engineering Taskforce in 1996, and it quickly became an almost ubiquitous tool for remotely connecting computers. Today, it’s hard to overstate the importance of the protocol, which underpins the security of apps used inside millions of organizations, including cloud environments crucial to Google, Amazon, Facebook, and other large companies.</p>                                            
                                                        
<p>“Password sniffing attacks were very common at that time, with new incidents reported almost weekly, and arguably it was the biggest security problem on the Internet at the time,” Ylönen wrote in an online interview. “I did intend SSH to become as widely used as possible. It was critically needed for securing networks and computing systems, and it for the most part solved the password sniffing problem.”</p>
<p>Now, nearly 30 years later, researchers have devised an attack with the potential to undermine, if not cripple, cryptographic SSH protections that the networking world takes for granted.</p>
<h2>Meet Terrapin</h2>
<p>Named Terrapin, the new hack works only when an attacker has an active adversary-in-the middle position on the connection between the admins and the network they remotely connect to. Also known as a man-in-the-middle or MitM attack, this occurs when an attacker secretly positioned between two parties intercepts communications and assumes the identity of both the recipient and the sender. This provides the ability to both intercept and to alter communications. While this position can be difficult for an attacker to achieve, it’s one of the scenarios from which SSH was thought to have immunity.</p>
<p>For Terrapin to be viable, the connection it interferes with also must be secured by either &#34;ChaCha20-Poly1305&#34; or &#34;CBC with Encrypt-then-MAC,&#34; both of which are cipher modes added to the SSH protocol (in 2013 and 2012, respectively). A scan performed by the researchers found that 77 percent of SSH servers exposed to the Internet support at least one of the vulnerable encryption modes, while 57 percent of them list a vulnerable encryption mode as the preferred choice.</p>
<p>At its core, Terrapin works by altering or corrupting information transmitted in the SSH data stream during the handshake—the earliest stage of a connection, when the two parties negotiate the encryption parameters they will use to establish a secure connection. The attack targets the BPP, short for <a href="https://www.scribd.com/document/59627915/Ssh-Security">Binary Packet Protocol</a>, which is designed to ensure that adversaries with an active position can&#39;t add or drop messages exchanged during the handshake. Terrapin relies on prefix truncation, a class of attack that removes specific messages at the very beginning of a data stream.</p>

                                                </div>

            
            
                            <nav>Page: <span>1 <a href="https://arstechnica.com/security/2023/12/hackers-can-break-ssh-channel-integrity-using-novel-data-corruption-attack/2/">2</a> <a href="https://arstechnica.com/security/2023/12/hackers-can-break-ssh-channel-integrity-using-novel-data-corruption-attack/3/">3</a> <a href="https://arstechnica.com/security/2023/12/hackers-can-break-ssh-channel-integrity-using-novel-data-corruption-attack/4/">4</a> <a href="https://arstechnica.com/security/2023/12/hackers-can-break-ssh-channel-integrity-using-novel-data-corruption-attack/2/"><span>Next <span>→</span></span></a></span></nav>
            
        </section>
    </div></div>
  </body>
</html>
