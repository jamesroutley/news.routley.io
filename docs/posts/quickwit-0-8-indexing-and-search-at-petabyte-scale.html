<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://quickwit.io/blog/quickwit-0.8">Original</a>
    <h1>Quickwit 0.8: Indexing and Search at Petabyte Scale</h1>
    
    <div id="readability-page-1" class="page"><div><main><p><strong><em>Quickwit, the OSS Cloud Native Search Engine for Logs and Traces, now scales to petabytes of data!</em></strong></p><p>We&#39;re excited to unveil Quickwit 0.8! Compared to previous versions, this version brings a rather short list of new &#34;visible&#34; features. Most of the improvements are in the invisible realms of scalability, efficiency, and performance.</p><p>In the last few months, we have been working hard with Quickwit customers, partners, and open-source users on different use cases presenting challenges.</p><p>Together, these use cases have stretched Quickwit&#39;s capability in:</p><ul><li>number of nodes (up to 200)</li><li>indexing speed (up to 1PB/day, or 13GiB/s)</li><li>number of indexes (up to 3,000)</li><li>and total amount of searchable data (several PBs of data).</li></ul><p>In the process, we uncovered a chain of unexpected bottlenecks and inefficiencies that we tackled one after the other.</p><p>Thanks to these efforts, Quickwit has reached a significant milestone: Quickwit is now running at petabyte scale!</p><p>On the visible side, we have also greatly enhanced our <a href="https://grafana.com/grafana/plugins/quickwit-quickwit-datasource/" target="_blank" rel="noopener noreferrer">Grafana plugin</a> to deliver a seamless search experience within Grafana Explore and Dashboards. It packs features like autocomplete hints, a context query editor, and support for ad-hoc filters. The new plugins will require you to run Quickwit 0.8.</p><p>Last but not least, we&#39;re introducing our distributed ingest API in beta and looking for feedback from our users.</p><p>Let&#39;s unpack this before looking at what&#39;s coming next.</p><p>Scalability has always been a primary focus at Quickwit.
Unfortunately, we do not have the data or the finances to play with petabytes. Our largest tests typically stop at 400MB/s of indexing throughput and 100TB of data overall. Quickwit handles this amount of data like a champ, so we were expecting Quickwit to behave properly at a petabyte scale, but we never had the chance to confirm that.</p><p>We stayed cautious and resisted the sirens of modern marketing. No premature claims. We would only call Quickwit petabyte-scale when someone has a Quickwit cluster in production with that data.</p><p>This is now done!</p><p>Our largest user reached an indexing throughput of over 1 PB per day, equivalent to 13.4 GiB/s or 14 million docs/s, using 200 pods, each equipped with 6 vCPUs and 8GB of RAM.</p><p><img loading="lazy" alt="Indexing 1PB/day" src="https://quickwit.io/assets/images/qw-indexing-1pb-a-day-f191a9c0976a51f1b55ac8f2d3cbdf21.png" width="2002" height="676"/></p><center><i>Screenshot shared by the user (please share yours!)</i></center><p>It is one thing to index at 1 PB/day; it is another to search through the amassed data, which can quickly reach tens of petabytes. Once again, on paper, Quickwit is supposed to scale well, but we had never tested Quickwit above 100TB.</p><p>The largest Quickwit production search cluster has around 40 PB of uncompressed logs, over 10 indexes, 50 trillion (5x10¹³) log entries, and an index of 7.5 PB stored on S3. User feedback has been very positive. With 30 beefy searcher pods, users are very happy with the search performance.</p><p>Most object storage providers (e.g. Amazon S3, Azure Blob storage, Google Storage...) have the same cost models :</p><ul><li>$25 per TB x month,</li><li>$0.005 per 1000 PUT requests.</li><li>$0.0004 per 1000 GET requests,</li></ul><p>The last two points are too often overlooked.</p><p>Let&#39;s have a look at what they mean for Quickwit.
Quickwit will run 1 PUT request every time you add a split. With a <a href="https://quickwit.io/docs/configuration/index-config" target="_blank" rel="noopener noreferrer"><code>commit_timeout_secs</code></a> set to 30s, you should expect less than <code>200,000 PUT</code> requests per index per month (including merges). In other words, each index with a single pipeline will cost us around $1 per month.
This is usually not an issue manageable.</p><p>The cost associated with GET requests on the hand can become a problem.
A single request will typically emit half a dozen GET requests per split.
One split is about 10 million documents.</p><p>For a reasonable index of 1 billion documents, a single query could induce 600 GET requests, which would cost $0.00024 per request.</p><p>Whether this is a lot depends on the number of queries per second (<code>QPS</code>) you need to address.
For an index of this size, Quickwit is cost-efficient if you have less than 0.1 QPS.
At this point, you will pay $60 just to run GET requests.</p><p>With introducting local disk caching for split files in Quickwit 0.7, we have unlocked the potential for higher QPS search use cases.</p><p>Several users reported impressive QPS on moderate datasets of 100 million / 1 billion records, and we also made our own benchmarks and reached 300 QPS with one instance. This opens up new possibilities across various domains, including financial services with large transaction datasets. We are eager to see new use cases on this front.</p><p>Version 0.8 includes several extensive search optimizations affecting all types of queries.
Regardless of your workload, you can expect a significant performance improvement by upgrading.</p><p>Here is a breakdown of our internal benchmark, comparing Quickwit 0.7 and Quickwit 0.8.
We hope green is your favorite color.</p><p><img loading="lazy" alt="Quickwit 0.7 vs Quickwit 0.8" src="https://quickwit.io/assets/images/2024-03-18-quickwit-bench-0.8-7e648c3d86bbd0c333df56328a18aba2.png" width="1242" height="3188"/></p><p>In Quickwit Grafana Plugin 0.4.0, we added several features to enhance the search experience. The main ones are:</p><ul><li>Autocomplete hint on field names and values. This can be critical especially if you have unstructured data with field names that you don&#39;t know.</li><li>A new context query editor to explore before and after a pinned log line.</li><li>Adhoc Filters support: this is very handy when you want to filter all the panels of your dashboard easily.</li></ul><p>Quickwit Grafana plugin 0.4.x will require you to use Quickwit 0.8.</p><p>Find more details in the GitHub <a href="https://github.com/quickwit-oss/quickwit-datasource" target="_blank" rel="noopener noreferrer">repository</a>.</p><p><img loading="lazy" src="https://quickwit.io/assets/images/2024-03-19-one-more-thing-04799a36d96f262d82353840d47400fb.jpeg" width="1021" height="759"/></p><p>One more thing... We have worked with several partners on a new distributed ingest API. It is now in beta, and we are looking for feedback from our users. This new ingest API, coupled with some work around distributed and local scheduling, is designed to efficiently handle a large number of indexes. So far, our largest use case runs 3,000 indexes on a cluster with 10 indexer nodes with 10 vCPUs each.</p><p>It is a game changer for multi-tenant use cases. We are already working with several PaaS to back their tenants&#39; log search. If you want to test Quickwit for such a service, get in touch with us to build a partnership.</p><p>To get a taste of the feature, you can activate the distributed ingest API by setting the <code>QW_ENABLE_INGEST_V2</code> environment variable to <code>true</code>. To activate the cooperative indexing feature, you need to set <code>enable_cooperative_indexing</code> to true in the Quickwit config file:</p><div><div><pre tabindex="0"><code><span><span>indexer</span><span>:</span><span></span><br/></span><span><span>  </span><span>enable_cooperative_indexing</span><span>:</span><span> </span><span>true</span><br/></span></code></pre></div></div><p>Shipping the distributed ingest API in the 0.9 is our top priority.
We have also started working on index configuration and schema update, as well as the support of OpenSearch Dashboards.</p><p>We are also cooking exciting partnerships with cool cloud providers to power their log services. We can&#39;t say more for now but we are very excited about it and we will keep you posted.</p><p>And if you are at Kubecon EU next week, we should meet there! We are sponsoring the great <a href="https://party.kubetrain.io/" target="_blank" rel="noopener noreferrer">Kubetrain party</a>, drop me a message on <a href="https://twitter.com/francoismassot" target="_blank" rel="noopener noreferrer">Twitter</a> or <a href="https://www.linkedin.com/in/fran%C3%A7ois-massot-473006b/" target="_blank" rel="noopener noreferrer">LinkedIn</a> if you want to meet.</p><p>Happy searching!</p></main></div></div>
  </body>
</html>
