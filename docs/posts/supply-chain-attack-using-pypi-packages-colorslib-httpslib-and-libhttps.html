<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.fortinet.com/blog/threat-research/supply-chain-attack-using-identical-pypi-packages-colorslib-httpslib-libhttps">Original</a>
    <h1>Supply Chain Attack Using PyPI Packages “Colorslib”, “Httpslib”, and “Libhttps”</h1>
    
    <div id="readability-page-1" class="page"><div>


<div>
    
    
<p>The <a href="https://www.fortinet.com/fortiguard/labs?utm_source=blog&amp;utm_campaign=fortiguardlabs">FortiGuard Labs</a> team has discovered a new 0-day attack embedded in three PyPI packages (Python Package Index) called ‘colorslib’, ‘httpslib’, and “libhttps”. They were found on January 10, 2023, by monitoring an open-source ecosystem. The Python packages “colorslib” and “httpslib” were published on January 7, 2023, and “libhttps” was published on January 12, 2023. All three were published by the same author, ‘Lolip0p’, as shown in the official PyPI repository.  ‘Lolip0p’ joined the repository close to the publish date.</p>
<p><span>Figure 1: Package author information</span>


    

</p>
<p>The author puts the project description that may look legitimate and clean as shown below.</p>
<p><span>Figure 2: Project description of colorslib</span>


    

</p>
<p><span>Figure 3: Project description of httpslib</span>


    

</p>
<p><span>Figure 4: Project description of libhttps</span>


    

</p>
<p>All versions of these packages are malicious.</p>
<p><span>Figure 5: Release history of colorslib</span>


    

</p>
<p><span>Figure 6: Release history of httpslib</span>


    

</p>
<p><span>Figure 7: Release history of libhttps</span>


    

</p>
<p>Interestingly, when we look at the setup.py script for these packages, we find they are identical.</p>
<p><span>Figure 8: setup.py from all packages</span>


    

</p>
<div>
  <p>They try to run a PowerShell with a suspicious URL that needs further analysis:</p>
<p>https://dl[.]dropbox[.]com/s/mkd3enun97s8zag/Oxzy[.]exe?dl=0</p>
<p>As shown in the VirusTotal entry below, the download URL includes the following binary exe (SHA 256):</p>
<p><i>8dc8a9f5b5181911b0f4a051444c22e12d319878ea2a9eaaecab9686e876690b</i></p>
<p>While this download URL has not previously been detected by any other threat researchers, some vendors do flag the downloaded executable file as malicious.</p>


</div>
<p><span>Figure 9: This URL has not been detected by VirusTotal</span>


    

</p>
<p><span>Figure 10: Vendors that detect the downloaded executable Oxzy.exe</span>


    

</p>
<div>
  
<p>The downloaded executable is called ‘Oxyz.exe’. It drops another executable, ‘update.exe’, that runs in the folder ‘%USER%\AppData\Local\Temp\’</p>


</div>
<p><span>Figure 11: Dropped file update.exe</span>


    

</p>
<div>
  <p>As shown in the VirusTotal entry below, several vendors flag this binary exe as malicious (SHA 256):</p>
<p><i>293a3a2c8992636a5dba58ce088feb276ba39cf1b496b336eb7b6f65b1ddb757</i></p>


</div>
<p><span>Figure 12: Vendors that detect the dropped executable update.exe</span>


    

</p>
<div>
  
<p>When running ‘update.exe’, it drops a series of files to the folder ‘%USER%\AppData\Local\Temp\onefile_%PID_%TIME%’.</p>


</div>
<p><span>Figure 13: update.exe running</span>


    

</p>
<p><span>Figure 14: Dropped files</span>


    

</p>
<div>
  <p>The dropped file, ‘SearchProtocolHost.exe’, is flagged as malicious by several vendors (SHA 256):</p>
<p><i>123fd1c46a166c54ad66e66a10d53623af64c4b52b1827dfd8a96fdbf7675638</i></p>


</div>
<p><span>Figure 15: Vendors that detect SearchProtocolHost.exe</span>


    

</p>
<div>
  <h2>Conclusion</h2>
<p>In this blog, we showed a single author posting separate Python packages that use the same code to launch an attack. The author also positions each package as legitimate and clean by including a convincing project description. However, these packages download and run a malicious binary executable.</p>
<p>Python end users should always perform due diligence before downloading and running any packages, especially from new authors. And as can be seen, publishing more than one package in a short time period is no indication that an author is reliable.</p>

<h2>Fortinet Protections</h2>
<p>FortiGuard AntiVirus detects the malicious executables identified in this report as</p>
<p>Oxzy.exe: <b>Malicious_Behavior.SB</b></p>
<p>update.exe: <b>PossibleThreat.PALLASNET.H</b></p>
<p>SearchProtocolHost.exe: <b>Malicious_Behavior.SB</b></p>
<p>The <a href="https://www.fortiguard.com/updates/antivirus?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=antivirus">FortiGuard AntiVirus</a> service is supported by <a href="https://www.fortinet.com/products/next-generation-firewall.html?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortigate">FortiGate</a>, <a href="https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortimail-main-page">FortiMail</a>, <a href="https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=endpoint-web-page">FortiClient</a>, and <a href="https://www.fortinet.com/products/endpoint-security/fortiedr?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=endpoint-security%2Ffortiedr">FortiEDR</a>. Customers running current AntiVirus updates are protected.</p>
<p>The FortiGuard Web Filtering Service detects the download URLs cited in this report as Malicious and blocks them.</p>

<h2>IOCs</h2>
<p><b>Oxzy.exe</b></p>
<p><b>            </b>8dc8a9f5b5181911b0f4a051444c22e12d319878ea2a9eaaecab9686e876690b</p>
<p><b>update.exe</b></p>
<p><b>            </b>293a3a2c8992636a5dba58ce088feb276ba39cf1b496b336eb7b6f65b1ddb757</p>
<p><b>SearchProtocolHost.exe</b></p>
<p><b>            </b>123fd1c46a166c54ad66e66a10d53623af64c4b52b1827dfd8a96fdbf7675638</p>
<p><b>Malicious URLs</b></p>
<p>https://dl[.]dropbox[.]com/s/mkd3enun97s8zag/Oxzy[.]exe?dl=0</p>

<p><i>Learn more about Fortinet’s <a href="https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/fortiguard-subscriptions?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortiguard-subscriptions">FortiGuard Labs</a> threat research and global intelligence organization and Fortinet’s FortiGuard AI-powered Security <a href="https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/fortiguard-subscriptions?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortiguard-subscriptions">Services portfolio</a>. <a href="https://www.fortinet.com/blog/threat-research?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=threat-research">Sign up</a> to receive our threat research blogs.</i></p>



</div>


    
</div>
</div></div>
  </body>
</html>
