<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.openwall.com/lists/oss-security/2022/08/02/1">Original</a>
    <h1>Rsync client-side arbitrary file write vulnerability</h1>
    
    <div id="readability-page-1" class="page">







<a href="https://jvns.ca/blog/2022/2022/07/28/2">[&lt;prev]</a> <a href="https://jvns.ca/blog/2022/07/28/toy-remote-login-server/">[day]</a> <a href="https://jvns.ca/blog/2022/07/28/">[month]</a> <a href="https://jvns.ca/blog/2022/07/">[year]</a> <a href="https://jvns.ca/blog/2022/">[list]</a>
<pre>Date: Tue, 2 Aug 2022 11:53:25 +0300
From: EGE BALCI &lt;ege@...daft.com&gt;
To: oss-security@...ts.openwall.com
Subject: CVE-2022-29154: Rsync client-side arbitrary file write vulnerability.

Date reported           : July 25, 2022
CVE identifiers         : CVE-2022-29154.
------------------------------------------------------------------------
Rsync client-side arbitrary file write vulnerability. (CVE-2022-29154)
------------------------------------------------------------------------

 &gt;&gt;&gt;&gt; We have discovered a critical arbitrary file write vulnerability 
in the
 &gt;&gt;&gt;&gt; rsync utility that allows malicious remote servers to write arbitrary
 &gt;&gt;&gt;&gt; files inside the directories of connecting peers. The server chooses
 &gt;&gt;&gt;&gt; which files/directories are sent to the client. Due to the 
insufficient
 &gt;&gt;&gt;&gt; controls inside the
 &gt;&gt;&gt;&gt; [do_server_recv](
 &gt;&gt;&gt; 
<a href="https://github.com/WayneD/rsync/blob/85c56b2603d97c225889175797ffff6745a4d305/main.c#L1118" rel="nofollow">https://github.com/WayneD/rsync/blob/85c56b2603d97c225889175797ffff6745a4d305/main.c#L1118</a>
 &gt;&gt;&gt; )
 &gt;&gt;&gt;&gt; function, a malicious rysnc server (or Man-in-The-Middle attacker) can
 &gt;&gt;&gt;&gt; overwrite arbitrary files in the rsync client target directory and
 &gt;&gt;&gt;&gt; subdirectories. An attacker abusing this vulnerability can overwrite
 &gt;&gt;&gt;&gt; critical files under the target rsync directory and subdirectories 
(for
 &gt;&gt;&gt;&gt; example, to overwrite the .ssh/authorized_keys file). This issue 
is very
 &gt;&gt;&gt;&gt; similar with the
 &gt;&gt;&gt;&gt; [CVE-2019-6111](<a href="https://www.youtube.com/watch?v=fcesKgfSPq4" rel="nofollow">https://www.youtube.com/watch?v=fcesKgfSPq4</a>).
 &gt;&gt;&gt;&gt;
 &gt;&gt;&gt;&gt; Best regards, Ege BALCI, Taha HAMAD.

The vulnerability was addressed with the developer of the rsync project 
and necessary patches are made. Related commit and details can be found 
in the following links,
- <a href="https://download.samba.org/pub/rsync/NEWS" rel="nofollow">https://download.samba.org/pub/rsync/NEWS</a>
- <a href="https://download.samba.org/pub/rsync/rsync.1#MULTI-HOST_SECURITY" rel="nofollow">https://download.samba.org/pub/rsync/rsync.1#MULTI-HOST_SECURITY</a>
- 
<a href="https://github.com/WayneD/rsync/commit/b7231c7d02cfb65d291af74ff66e7d8c507ee871" rel="nofollow">https://github.com/WayneD/rsync/commit/b7231c7d02cfb65d291af74ff66e7d8c507ee871</a>

We recommend updating to the latest stable versions of rsync.

-- 
*Ege BALCI*
Threat Intelligence Team Lead

*PRODAFT Cyber Security Technologies INC.*
*CH:* Y-Parc, rue Galilée 7, 1400 Yverdon-les-Bains, Switzerland
*NL:* Wilhelmina van Pruisenweg 104, 2595 AN Den Haag, Netherlands
*E.:*ege[at]prodaft.com
*IN:*/egebalci

In case you think you’re not the designated recipient of the e-mail 
hereby; please delete it accordingly. *This e-mail may have been sent 
from a mobile device. Please contact me from my mobile, in case you 
notice an error in the content. PS. Feel free to contact me via Signal, 
Threema or Telegram; or ask for my public PGP key for high-profile cases 
that may require higher confidentiality.

<span><strong>Content of type &#34;</strong>text/html<strong>&#34; skipped</strong></span>

<span><strong>Download attachment &#34;</strong><a href="https://jvns.ca/blog/2022/07/28/toy-remote-login-server/1/1" rel="nofollow" download="">OpenPGP_0xCDCA0F4B4445AA39.asc</a><strong>&#34; of type &#34;</strong>application/pgp-keys<strong>&#34; (649 bytes)</strong></span>

<span><strong>Download attachment &#34;</strong><a href="https://jvns.ca/blog/2022/07/28/toy-remote-login-server/1/2" rel="nofollow" download="">OpenPGP_signature</a><strong>&#34; of type &#34;</strong>application/pgp-signature<strong>&#34; (237 bytes)</strong></span>
</pre>
<p><a href="http://www.openwall.com/blists/">Powered by blists</a> - <a href="http://lists.openwall.net">more mailing lists</a>


</p><p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
</p><p>
Confused about <a href="https://jvns.ca/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
</p><p>

<a href="https://jvns.ca/Owl/" title="Powered by Openwall GNU/*/Linux - security-enhanced &#34;Linux distribution&#34;"><img src="https://jvns.ca/Owl/artwork/buttons/80x15/Owl-80x15-4.png" width="80" height="15" alt="Powered by Openwall GNU/*/Linux"/></a>
<a href="https://openvz.org" title="Powered by OpenVZ - OS virtualization solution for Linux"><img src="https://jvns.ca/images/OpenVZ-80x15-cd.png" width="80" height="15" alt="Powered by OpenVZ"/></a>





</p></div>
  </body>
</html>
