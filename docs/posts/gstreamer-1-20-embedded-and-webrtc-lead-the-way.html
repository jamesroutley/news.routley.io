<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.collabora.com/news-and-blog/news-and-events/gstreamer-120-embedded-webrtc-lead-the-way.html">Original</a>
    <h1>GStreamer 1.20: Embedded and WebRTC lead the way</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Made available earlier this month, GStreamer 1.20 is the fruitful result of 17 months of hard work from the entire community. Over 250 developers contributed code to make this release happen, and once again, Collabora had more contributors than any other organization.</p>
<p>Our work focused on the two areas in which we believe GStreamer shines the brightest: embedded systems, and network streaming, in particular WebRTC. Below is a summary of the impact our team of engineers had on this latest release.</p>
<p>As usual, you can also learn more about the enhancements done by the rest of the community by looking at the project&#39;s 1.20 <a href="https://gstreamer.freedesktop.org/releases/1.20/" target="_blank" rel="noopener noreferrer">release notes</a>.</p>
<h3>Contributions related to embedded systems</h3>
<p>GStreamer is already the pre-eminent media framework for embedded systems, and this is an area where Collabora has been very active over the last release cycle. Here are some of the improvements that we&#39;ve made.</p>
<p>After many years of efforts by Guillaume, Nicolas, Stéphane, and Aaron, we finally landed the support for sub-frame decoding. This has made it possible to start decoding video frames before the entire frame has been received from the network if the decoder supports this. We&#39;ve implemented this for JPEG2000 with OpenJPEG, with H.264 with ffmpeg, as well as in gst-omx when using the Allegro extensions present on the Xilinx Zynq UltraScale+ MPSoC EV processors.</p>
<p>In partnership with Huawei, we also improved the GStreamer build system to make it possible to create a library containing only the specific parts of GStreamer used by a particular application or a set of applications. Take a look at this <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/news-and-blog/news-and-events/generate-mininal-gstreamer-build-tailored-to-your-needs.html" target="_blank" rel="noopener noreferrer">blog post</a> to learn more.</p>
<p>Nicolas added <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/news-and-blog/blog/2021/06/23/adding-vp9-and-mpeg2-stateless-support-in-v4l2codecs-for-gstreamer/" target="_blank" rel="noopener noreferrer">MPEG2 and VP9 Stateless Linux support</a> and contributed to enhancing the VP9 parser. The H264 Stateless Linux decoder also gained support for interlaced video streams, though only for slice-based decoders and not for frame-based decoders since no driver in the mainline Linux kernel supports that.  Nicolas also added support for a rendering delay that allows multiple frames to be queued in a stateless decoder and enhances throughput at the cost of higher latency. He implemented this for the MPEG 2 Video, VP8, and VP9 decoders. He also added support for HEVC decoding to the new &#34;va&#34; plug-in that uses the new GStreamer common decoder implementation to support VA-API-based decoders.</p>
<p>Nicolas also implemented videocodectestsink: a small element that computes the checksum of incoming frames to compare them against a known good reference. This is useful for creating tests that ensure no regression in decoder implementations. He also added the necessary code in GStreamer to react to resolution changes in Video4Linux source. This is primarily relevant if the source is, for example, an HDMI input.</p>
<h3>WebRTC and network streaming</h3>
<p>For much of the framework’s history, GStreamer’s principal focus has been on streaming media over a network. This is an area in which we&#39;ve also made several contributions over this cycle.</p>
<p>We&#39;ve contributed many improvements related to GStreamer&#39;s WebRTC stack, which is one of the most complete and flexible independent implementations of the WebRTC protocols. I&#39;ve worked on GStreamer&#39;s WebRTC stack and have added many features. I included support for explicit notification of the end of candidates so that failing connections can be recognized faster. I reworked the WebRTC library API to ensure it is thread-safe by hiding all information behind properties. I also added support for the &#34;priority&#34; to media streams; setting the various priorities now adds the correct DSCP markings making it possible for network administrators to prioritize the traffic accordingly. I significantly improved the WebRTC statistics to expose most statistics that existed somewhere in the GStreamer RTP stack through the convenient WebRTC API, particularly those coming from the RTP jitter buffer.</p>
<p>Jakub has implemented an RTP Header extension making it possible to send colorspace information per frame; this enables GStreamer to share Dynamic HDR content over RTP. The extension we implemented is compatible with the proposal from Google&#39;s libwebrtc team. The basic specification for sending Opus over RTP only supports mono and stereo. The Google libwebrtc team has created an extension called &#34;multiopus,&#34; making it possible to send multiple stereo Opus streams together to serve more than two channels. Jakub implemented this in GStreamer&#39;s Opus RTP payloader and depayloader. We&#39;ve implemented RFC 6464, an RTP header extension allowing a client to send the server the relative level (volume) of the audio in the packet; this allows the server to prioritize clients who are speaking over others without having to decode all audio. We&#39;ve also added support for the iSAC codec; it is a legacy audio codec that was open-sourced by Google in libwebrtc a couple of years ago. We&#39;ve added a plug-in that wraps the reference implementation of the codec, and we&#39;ve also written an RTP payloader and depayloader to enable GStreamer to send and receive audio encoded with this codec over RTP.</p>
<p>As part of the <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/news-and-blog/news-and-events/low-latency-streaming-of-security-feeds-with-srt-and-gstreamer.html" target="_blank" rel="noopener noreferrer">Hwangsaeul project sponsored by SK Telecom</a>, we&#39;ve improved the <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/news-and-blog/blog/2018/02/16/srt-in-gstreamer/" target="_blank" rel="noopener noreferrer">SRT support</a>. Raghavendra added support for authentication, while Jakub added a way for the application to be notified of broken connections and added more options to the URI in a way that is compatible with the SRT demo application.</p>
<h3>Other improvements</h3>
<p>GStreamer being an incredibly flexible cross-platform framework, we&#39;ve also made several improvements that fall outside of the two main categories.</p>
<p>Nicolas implemented support for decoding alpha channels in WebM videos. This is a bit special as the alpha channel is carried as a second video stream. He&#39;s also added support for decoding those using hardware-accelerated decoders such as V4L2 based decoders.</p>
<p>Aaron added the first element specifically for machine learning to the core GStreamer plug-in collection. It uses the ONNX library to do object detection; we hope to add more elements using the ONNX library in the future.</p>
<p>Aaron also helped Rabindra Harlalka from NICE to contribute upstream elements that can encrypt a stream using AES encryption. This just applies the AES in CBC mode to the incoming stream with the key provided by the application.</p>
<p>Xavier again made numerous improvements to the Meson build system; in particular, he replaced GStreamer&#39;s custom pkg-config file generator with one he contributed to Meson itself. This ensures that the generated pkg-config files match the libraries that are in the build system.</p>
<p>I added a &#34;stats&#34; property to the identity element; this makes it easier to instrument pipeline to get statistics for monitoring. I added support for the newer &#34;constrained high&#34; and &#34;progressive high&#34; H.264 profiles to the various GStreamer elements where those are relevant. Those profiles are just a subset of the existing High profile.</p>
<p>Jakub improved the d3d11desktopup plug-in to capture the Windows desktop to DirectX 11 textures. He implemented support to follow dynamic resolution changes of the desktop and also for capture Windows User Account Control (UAC) prompts.</p>
<p>I improved GstAudioAggregator base class used by elements such as the audiomixer and audiointerleave elements, it now emit a QoS message telling the application whenever it drops incoming buffers because they are late.</p>
<p>Stéphane fixed the MXF and Matroska demuxers to seek precisely to a frame; this makes it possible to use them as a source for video editing.</p>
<p>Xavier spent quite some time helping with the merge of the GStreamer repositories <a href="https://blogs.gnome.org/tsaunier/2021/09/29/gstreamer-one-repository-to-rule-them-all/" target="_blank" rel="noopener noreferrer">into a single one</a>. This was an effort of the whole community, making our <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/news-and-blog/blog/2021/10/26/run-your-own-ci-with-gstreamer-new-monorepo/" target="_blank" rel="noopener noreferrer">CI system more simple</a> and generally makes life easier for GStreamer developers.</p>
<p>As usual, we have also contributed a large number of bug fixes across the board, but we won’t list them all out here.</p>
<h3>Looking ahead</h3>
<p>Our team of engineers already has a number of contributions planned for the next release. These include a rework of the MPEG PS demuxer for more accurate seeking, improvements to the Wayland support like a GTK3 sink that can take advantage of Wayland&#39;s support for hardware video overlays, and support for DRM modifiers to enable higher performance zero-copy between hardware decoders and display.</p>
<p>If you are ready to explore GStreamer 1.20, or have any questions about how to take advantage of its exciting new features to get the maximum performance from your hardware, please do not hesitate to <a href="https://aos.github.io/2022/02/12/using-nix-shell-for-embedded-rust-development/contact-us.html" target="_blank" rel="noopener noreferrer">contact us</a>. Collabora&#39;s multimedia team is always available to assist you to leverage or implement the latest feature releases of GStreamer.</p>

<!-- Related Blogs -->



<!-- end of Related Blogs -->





<!-- Optional comments block -->

<!-- end of Optional comments block -->

</div></div>
  </body>
</html>
