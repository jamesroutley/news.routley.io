<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/kepano/defuddle">Original</a>
    <h1>Show HN: Defuddle, an HTML-to-Markdown alternative to Readability</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><blockquote>
<p dir="auto">de·​fud·dle /diˈfʌdl/ <em>transitive verb</em></p>
</blockquote>
<p dir="auto"><strong>Beware! Defuddle is very much a work in progress!</strong></p>
<p dir="auto">Defuddle extracts the main content from web pages. It cleans up web pages by removing clutter like comments, sidebars, headers, footers, and other non-essential elements, leaving only the primary content.</p>
<p dir="auto"><a href="https://kepano.github.io/defuddle/" rel="nofollow">Try the Defuddle Playground →</a></p>

<p dir="auto">Defuddle aims to output clean and consistent HTML documents. It was written for <a href="https://github.com/obsidianmd/obsidian-clipper">Obsidian Web Clipper</a> with the goal of creating a more useful input for HTML-to-Markdown converters like <a href="https://github.com/mixmark-io/turndown">Turndown</a>.</p>
<p dir="auto">Defuddle can be used as a replacement for <a href="https://github.com/mozilla/readability">Mozilla Readability</a> with a few differences:</p>
<ul dir="auto">
<li>More forgiving, removes fewer uncertain elements.</li>
<li>Provides a consistent output for footnotes, math, code blocks, etc.</li>
<li>Uses a page&#39;s mobile styles to guess at unnecessary elements.</li>
<li>Extracts more metadata from the page, including schema.org data.</li>
</ul>


<p dir="auto">For Node.js usage, you&#39;ll also need to install JSDOM:</p>



<div dir="auto" data-snippet-clipboard-copy-content="import { Defuddle } from &#39;defuddle&#39;;

// Parse the current document
const defuddle = new Defuddle(document);
const result = defuddle.parse();

// Access the content and metadata
console.log(result.content);
console.log(result.title);
console.log(result.author);"><pre><span>import</span> <span>{</span> <span>Defuddle</span> <span>}</span> <span>from</span> <span>&#39;defuddle&#39;</span><span>;</span>

<span>// Parse the current document</span>
<span>const</span> <span>defuddle</span> <span>=</span> <span>new</span> <span>Defuddle</span><span>(</span><span>document</span><span>)</span><span>;</span>
<span>const</span> <span>result</span> <span>=</span> <span>defuddle</span><span>.</span><span>parse</span><span>(</span><span>)</span><span>;</span>

<span>// Access the content and metadata</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>content</span><span>)</span><span>;</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>title</span><span>)</span><span>;</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>author</span><span>)</span><span>;</span></pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="import { JSDOM } from &#39;jsdom&#39;;
import { Defuddle } from &#39;defuddle/node&#39;;

// Parse HTML from a string
const html = &#39;&lt;html&gt;&lt;body&gt;&lt;article&gt;...&lt;/article&gt;&lt;/body&gt;&lt;/html&gt;&#39;;
const result = await Defuddle(html);

// Parse HTML from a URL
const dom = await JSDOM.fromURL(&#39;https://example.com/article&#39;);
const result = await Defuddle(dom);

// With options
const result = await Defuddle(dom, {
  debug: true, // Enable debug mode for verbose logging
  markdown: true, // Convert content to markdown
  url: &#39;https://example.com/article&#39; // Original URL of the page
});

// Access the content and metadata
console.log(result.content);
console.log(result.title);
console.log(result.author);"><pre><span>import</span> <span>{</span> <span>JSDOM</span> <span>}</span> <span>from</span> <span>&#39;jsdom&#39;</span><span>;</span>
<span>import</span> <span>{</span> <span>Defuddle</span> <span>}</span> <span>from</span> <span>&#39;defuddle/node&#39;</span><span>;</span>

<span>// Parse HTML from a string</span>
<span>const</span> <span>html</span> <span>=</span> <span>&#39;&lt;html&gt;&lt;body&gt;&lt;article&gt;...&lt;/article&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span>;</span>
<span>const</span> <span>result</span> <span>=</span> <span>await</span> <span>Defuddle</span><span>(</span><span>html</span><span>)</span><span>;</span>

<span>// Parse HTML from a URL</span>
<span>const</span> <span>dom</span> <span>=</span> <span>await</span> <span>JSDOM</span><span>.</span><span>fromURL</span><span>(</span><span>&#39;https://example.com/article&#39;</span><span>)</span><span>;</span>
<span>const</span> <span>result</span> <span>=</span> <span>await</span> <span>Defuddle</span><span>(</span><span>dom</span><span>)</span><span>;</span>

<span>// With options</span>
<span>const</span> <span>result</span> <span>=</span> <span>await</span> <span>Defuddle</span><span>(</span><span>dom</span><span>,</span> <span>{</span>
  <span>debug</span>: <span>true</span><span>,</span> <span>// Enable debug mode for verbose logging</span>
  <span>markdown</span>: <span>true</span><span>,</span> <span>// Convert content to markdown</span>
  <span>url</span>: <span>&#39;https://example.com/article&#39;</span> <span>// Original URL of the page</span>
<span>}</span><span>)</span><span>;</span>

<span>// Access the content and metadata</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>content</span><span>)</span><span>;</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>title</span><span>)</span><span>;</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>result</span><span>.</span><span>author</span><span>)</span><span>;</span></pre></div>
<p dir="auto"><em>Note: for <code>defuddle/node</code> to import properly, the module format in your <code>package.json</code> has to be set to <code>{ &#34;type&#34;: &#34;module&#34; }</code></em></p>

<p dir="auto">Defuddle returns an object with the following properties:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>author</code></td>
<td>string</td>
<td>Author of the article</td>
</tr>
<tr>
<td><code>content</code></td>
<td>string</td>
<td>Cleaned up string of the extracted content</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>Description or summary of the article</td>
</tr>
<tr>
<td><code>domain</code></td>
<td>string</td>
<td>Domain name of the website</td>
</tr>
<tr>
<td><code>favicon</code></td>
<td>string</td>
<td>URL of the website&#39;s favicon</td>
</tr>
<tr>
<td><code>image</code></td>
<td>string</td>
<td>URL of the article&#39;s main image</td>
</tr>
<tr>
<td><code>metaTags</code></td>
<td>object</td>
<td>Meta tags</td>
</tr>
<tr>
<td><code>parseTime</code></td>
<td>number</td>
<td>Time taken to parse the page in milliseconds</td>
</tr>
<tr>
<td><code>published</code></td>
<td>string</td>
<td>Publication date of the article</td>
</tr>
<tr>
<td><code>site</code></td>
<td>string</td>
<td>Name of the website</td>
</tr>
<tr>
<td><code>schemaOrgData</code></td>
<td>object</td>
<td>Raw schema.org data extracted from the page</td>
</tr>
<tr>
<td><code>title</code></td>
<td>string</td>
<td>Title of the article</td>
</tr>
<tr>
<td><code>wordCount</code></td>
<td>number</td>
<td>Total number of words in the extracted content</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">Defuddle is available in three different bundles:</p>
<ol dir="auto">
<li>Core bundle (<code>defuddle</code>): The main bundle for browser usage. No dependencies.</li>
<li>Full bundle (<code>defuddle/full</code>): Includes additional features for math equation parsing.</li>
<li>Node.js bundle (<code>defuddle/node</code>): Optimized for Node.js environments using JSDOM. Includes full capabilities for math and Markdown conversion.</li>
</ol>
<p dir="auto">The core bundle is recommended for most use cases. It still handles math content, but doesn&#39;t include fallbacks for converting between MathML and LaTeX formats. The full bundle adds the ability to create reliable <code>&lt;math&gt;</code> elements using <code>mathml-to-latex</code> and <code>temml</code> libraries.</p>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>debug</code></td>
<td>boolean</td>
<td>Enable debug logging</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>URL of the page being parsed</td>
</tr>
<tr>
<td><code>markdown</code></td>
<td>boolean</td>
<td>Convert <code>content</code> to Markdown</td>
</tr>
<tr>
<td><code>separateMarkdown</code></td>
<td>boolean</td>
<td>Keep <code>content</code> as HTML and return <code>contentMarkdown</code> as Markdown</td>
</tr>
<tr>
<td><code>removeExactSelectors</code></td>
<td>boolean</td>
<td>Whether to remove elements matching exact selectors like ads, social buttons, etc. Defaults to true.</td>
</tr>
<tr>
<td><code>removePartialSelectors</code></td>
<td>boolean</td>
<td>Whether to remove elements matching partial selectors like ads, social buttons, etc. Defaults to true.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">You can enable debug mode by passing an options object when creating a new Defuddle instance:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const article = new Defuddle(document, { debug: true }).parse();"><pre><span>const</span> <span>article</span> <span>=</span> <span>new</span> <span>Defuddle</span><span>(</span><span>document</span><span>,</span> <span>{</span> <span>debug</span>: <span>true</span> <span>}</span><span>)</span><span>.</span><span>parse</span><span>(</span><span>)</span><span>;</span></pre></div>
<ul dir="auto">
<li>More verbose console logging about the parsing process</li>
<li>Preserves HTML class and id attributes that are normally stripped</li>
<li>Retains all data-* attributes</li>
<li>Skips div flattening to preserve document structure</li>
</ul>

<p dir="auto">Defuddle attempts to standardize HTML elements to provide a consistent input for subsequent manipulation such as conversion to Markdown.</p>

<ul dir="auto">
<li>The first H1 or H2 heading is removed if it matches the title.</li>
<li>H1s are converted to H2s.</li>
<li>Anchor links in H1 to H6 elements are removed and become plain headings.</li>
</ul>

<p dir="auto">Code block are standardized. If present, line numbers and syntax highlighting are removed, but the language is retained and added as a data attribute and class.</p>
<div dir="auto" data-snippet-clipboard-copy-content="&lt;pre&gt;
  &lt;code data-lang=&#34;js&#34; class=&#34;language-js&#34;&gt;
    // code
  &lt;/code&gt;
&lt;/pre&gt;"><pre><span>&lt;</span><span>pre</span><span>&gt;</span>
  <span>&lt;</span><span>code</span> <span>data-lang</span>=&#34;<span>js</span>&#34; <span>class</span>=&#34;<span>language-js</span>&#34;<span>&gt;</span>
    // code
  <span>&lt;/</span><span>code</span><span>&gt;</span>
<span>&lt;/</span><span>pre</span><span>&gt;</span></pre></div>

<p dir="auto">Inline references and footnotes are converted to a standard format:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Inline reference&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.

&lt;div id=&#34;footnotes&#34;&gt;
  &lt;ol&gt;
    &lt;li class=&#34;footnote&#34; id=&#34;fn:1&#34;&gt;
      &lt;p&gt;
        Footnote content.&amp;nbsp;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34;&gt;↩&lt;/a&gt;
      &lt;/p&gt;
    &lt;/li&gt;
    &lt;/ol&gt;
&lt;/div&gt;"><pre>Inline reference<span>&lt;</span><span>sup</span> <span>id</span>=&#34;<span>fnref:1</span>&#34;<span>&gt;</span><span>&lt;</span><span>a</span> <span>href</span>=&#34;<span>#fn:1</span>&#34;<span>&gt;</span>1<span>&lt;/</span><span>a</span><span>&gt;</span><span>&lt;/</span><span>sup</span><span>&gt;</span>.

<span>&lt;</span><span>div</span> <span>id</span>=&#34;<span>footnotes</span>&#34;<span>&gt;</span>
  <span>&lt;</span><span>ol</span><span>&gt;</span>
    <span>&lt;</span><span>li</span> <span>class</span>=&#34;<span>footnote</span>&#34; <span>id</span>=&#34;<span>fn:1</span>&#34;<span>&gt;</span>
      <span>&lt;</span><span>p</span><span>&gt;</span>
        Footnote content.&amp;nbsp;<span>&lt;</span><span>a</span> <span>href</span>=&#34;<span>#fnref:1</span>&#34; <span>class</span>=&#34;<span>footnote-backref</span>&#34;<span>&gt;</span>↩<span>&lt;/</span><span>a</span><span>&gt;</span>
      <span>&lt;/</span><span>p</span><span>&gt;</span>
    <span>&lt;/</span><span>li</span><span>&gt;</span>
    <span>&lt;/</span><span>ol</span><span>&gt;</span>
<span>&lt;/</span><span>div</span><span>&gt;</span></pre></div>

<p dir="auto">Math elements, including MathJax and KaTeX, are converted to standard MathML:</p>
<div dir="auto" data-snippet-clipboard-copy-content="&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;inline&#34; data-latex=&#34;a \neq 0&#34;&gt;
  &lt;mi&gt;a&lt;/mi&gt;
  &lt;mo&gt;≠&lt;/mo&gt;
  &lt;mn&gt;0&lt;/mn&gt;
&lt;/math&gt;"><pre><span>&lt;</span><span>math</span> <span>xmlns</span>=&#34;<span>http://www.w3.org/1998/Math/MathML</span>&#34; <span>display</span>=&#34;<span>inline</span>&#34; <span>data-latex</span>=&#34;<span>a \neq 0</span>&#34;<span>&gt;</span>
  <span>&lt;</span><span>mi</span><span>&gt;</span>a<span>&lt;/</span><span>mi</span><span>&gt;</span>
  <span>&lt;</span><span>mo</span><span>&gt;</span>≠<span>&lt;/</span><span>mo</span><span>&gt;</span>
  <span>&lt;</span><span>mn</span><span>&gt;</span>0<span>&lt;/</span><span>mn</span><span>&gt;</span>
<span>&lt;/</span><span>math</span><span>&gt;</span></pre></div>


<p dir="auto">To build the package, you&#39;ll need Node.js and npm installed. Then run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Install dependencies
npm install

# Clean and build
npm run build"><pre><span><span>#</span> Install dependencies</span>
npm install

<span><span>#</span> Clean and build</span>
npm run build</pre></div>
</article></div></div>
  </body>
</html>
