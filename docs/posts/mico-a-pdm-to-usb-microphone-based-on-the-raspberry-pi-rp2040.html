<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://electronut.in//mico/">Original</a>
    <h1>Mico: A PDM to USB Microphone Based on the Raspberry Pi RP2040</h1>
    
    <div id="readability-page-1" class="page"><div>
  
  <p><span>20 Dec 2021</span></p><p><img src="https://electronut.in/images/2021/12/mico.png" alt="mico"/></p>

<p>Earlier this year, I was doing audio experiments with Machine Learning (ML) on the Raspberry Pi, and was looking for a 
compact USB microphone. The one which is commonly available is shown below.</p>

<p><img src="https://electronut.in/images/2021/12/cheap_mic.png" alt="cheap mic"/></p>

<p>While it was convenient to plug this in and access it from Python using <em>pyaudio</em>, the sound quality from this mic 
was terrible. Extremely noisy with poor (distance) sensitivity.</p>

<p><img src="https://electronut.in/images/2021/12/noisy_mic.png" alt="nosiy mic"/></p>

<p>Ultimately I completed my <a href="https://electronut.in/audio-recongnition-ml/">audio recognition project</a> using an I2S microphone which had a much better audio quality.</p>

<p>But I kept thinking about this problem, and did some research on I2S to USB bridge ICs. I found a couple of ICs like 
the Si Labs CP2615, but they looked obsolete. I also looked at the Cypress FX2 series with I2S support, and that 
seemed like a possible option, provided I was willing to put in a fair amount of work.</p>

<p>Recently, I’ve been working with the Raspberry Pi Pico. I’ve been dazzled with the RP2040 - especially with the PIO 
and the documentation and software support provided by the company. The Pico uses <a href="https://github.com/raspberrypi/tinyusb">TinyUSB</a> which has audio support, 
which got me thinking - surely someone must have thought of making a USB mic with this? And sure enough, Sandeep 
Mistry has done just that, with his <a href="https://github.com/ArmDeveloperEcosystem/microphone-library-for-pico">Microphone Library for Pico</a> open source project. So I already had firmware for 
my project. Now I just needed to make the hardware. Thus the idea of <strong>Mico</strong> was born.</p>



<p>I wanted a compact design for the mic, but I knew it was difficult to make it as small as the noisy mic shown above, due 
to the size of the RP2040 chip and mechanical design considerations. So I opted for a simple design with a reliable USB Type-A 
plug. I initially toyed with the idea of making the USB connector as part of the PCB, but that meant a thicker PCB and 
higher costs, so I dropped the idea. I also added an LED to the board for ease of testing.</p>

<p>The RP2040 needs very few extra components to get going, so Mico has a simple schematic.</p>

<p><img src="https://electronut.in/images/2021/12/mico_sch.png" alt="mico schematic"/></p>

<p>I did some research on PDM microphones and chose MP23DB01HPTR which seems to have a good range. I chose a bottom-ported once because I wanted the top side of Mico to be bare for the title and logo.</p>

<p><img src="https://electronut.in/images/2021/12/mics_comp.png" alt="mics comparison"/></p>

<p>Here’s the PCB design.</p>

<p><img src="https://electronut.in/images/2021/12/mico_pcb.png" alt="mico design"/></p>



<p>I adapted the firmware for Mico from Sandeep Mistry’s project mentioned earlier. The only minor addition I did is 
to add a PIO based blinky program and change some description strings.</p>



<p>Here’s Mico in action:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/G_soM9alIGk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>Here’s a comparison of the noisy mic and Mico in Audacity on Windows 10, with both 
recordings from the same distance.</p>

<p><img src="https://electronut.in/images/2021/12/comp.png" alt="comparision"/></p>

<p>You can see how low the sensitivity is for the first mic. Now let’s normalize the
audio.</p>

<p><img src="https://electronut.in/images/2021/12/comp_norm.png" alt="comparision normalised"/></p>

<p>You can see the high level of noise in the first mic. The contrast tool in Audacity 
shows about 36 dB RMS foreground/background separation for Mico vs. 21 dB RMS 
for the other mic.</p>

<p><img src="https://electronut.in/images/2021/12/contrast.png" alt="contrast"/></p>

<p>The audio quality from Mico is quite good, so I am very happy with this project.</p>



<p>This was a very quick project, and I was very happy that the PCB worked in the very first run. This project also reaffirmed 
my faith in Open Source projects. I could build on top of prior work, and in turn, I am open sourcing Mico so others 
can learn and adapt it for their projects.</p>



<p>I am grateful to Sivaprakash. S for the PCB design assembly of the Mico prototypes. I also thank 
Sandeep Mistry for open sourcing his RP2040 PDM microphone project, without which this project would have never taken off.</p>



<p>Mico is an Open Source Hardware Project. You can download design files and code for Mico from my github repo below:</p>

<p><a href="https://github.com/mkvenkit/mico">https://github.com/mkvenkit/mico</a></p>


</div></div>
  </body>
</html>
