<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bootlin.com/blog/ext2-filesystem-driver-now-marked-as-deprecated/">Original</a>
    <h1>Linux ext2 filesystem driver now marked as deprecated</h1>
    
    <div id="readability-page-1" class="page"><article id="post-18155">
	<!-- .entry-header -->

	
	
	<div>
		<p><a href="https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated.png"><img fetchpriority="high" decoding="async" src="https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-1024x345.png" alt="" width="840" height="283" srcset="https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-1024x345.png 1024w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-300x101.png 300w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-768x259.png 768w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-1200x404.png 1200w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-24x8.png 24w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-36x12.png 36w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated-48x16.png 48w, https://bootlin.com/wp-content/uploads/2024/02/ext2-deprecated.png 1371w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 1362px) 62vw, 840px"/></a></p>
<p>31 years after the start of its career in 1993, it’s time for ext2 to retire. Here we are talking about the <b>driver</b> for this filesystem, not exactly the filesystem itself. Continue reading to understand the subtle difference.</p>
<p>It’s the <b>ext2 filesystem driver</b> that will be <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b960e8093e7a57de98724931d17b2fa86ff1105f">marked as deprecated</a> in the upcoming 6.9 Linux kernel. The main issue is that even if the filesystem is created with 256 byte inodes (<code>mkfs.ext2 -I 256</code>), the filesystem driver will stick to 32 bit dates. Because of this, the driver does not support inode timestamps beyond 03:14:07 UTC on 19 January 2038.</p>

<p>By the way, if you are still using ext2 and its driver, and your system date is set correctly to a date at most 30 years before the deadline, you will get this warning:</p>
<pre># mount -t ext2 /dev/sda1 /mnt
[  441.680685] ext2 filesystem being mounted at /mnt supports timestamps until 2038-01-19 (ox7fffffff)
</pre>
<p>I checked this by myself, by setting my system date to several dates in the future:</p>
<pre># date -s &#34;2029-02-24 03:13:30&#34;
Sat Feb 24 03:13:30 UTC 2029
# touch /mnt/foo1
# date -s &#34;2038-01-18 03:13:30&#34;
Mon Jan 18 03:13:30 UTC 2038
# touch /mnt/foo2
# date -s &#34;2038-01-20 03:13:30&#34;
Wed Jan 20 03:13:30 UTC 2038
# touch /mnt/foo3
# date -s &#34;2048-01-20 03:13:30&#34;
Mon Jan 20 03:13:30 UTC 2048
# touch /mnt/foo4
# ls -la /mnt
drwxr-xr-x    3 0        0             4096 Jan 19  2038 .
drwxrwxr-x   13 1000     1000          4096 Feb 20  2024 ..
-rw-r--r--    1 0        0                0 Feb 24  2029 foo1
-rw-r--r--    1 0        0                0 Jan 18  2038 foo2
-rw-r--r--    1 0        0                0 Jan 19  2038 foo3
-rw-r--r--    1 0        0                0 Jan 19  2038 foo4
</pre>
<p>As you can see, the last files created after the deadline are stuck with the same date. This will most certainly cause problems in several programs.</p>
<p>Users are advised to mount their filesystem with the ext4 driver. The ext4 filesystem <b>driver</b> is fully compatible with ext2, though the filesystem will remain an ext2 one.</p>
<p>First, make sure that you don’t have a 128 bytes inode size, which corresponds to 32 bit dates:</p>
<pre># sudo tune2fs -l /dev/sda1 | grep &#34;Inode size&#34;
Inode size:	          128
</pre>
<p>If that’s the case, it is possible to increase the inode size:</p>
<pre># sudo e2fsck -f /dev/sda1
e2fsck 1.46.5 (30-Dec-2021)
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
ext2test: 14/477664 files (0.0% non-contiguous), 19254/1904816 blocks

# sudo tune2fs -I 256 /dev/sda1 
tune2fs 1.46.5 (30-Dec-2021)
Resizing inodes could take some time.
Proceed anyway (or wait 5 seconds to proceed) ? (y,N) y
Setting inode size 256
</pre>
<p>Note that if you create your filesystem with <code>mkfs.ext2</code> (at least from <code>e2fsprogs</code> version 1.46.5 in Ubuntu 22.04), the filesystem is created with 256 bit inodes anyway:</p>
<pre>mkfs.ext2 /dev/sda1
</pre>
<p>So, if you mount it with the ext4 driver, it will remain an ext2 filesystem but will support 64 bit dates!</p>
<p>By the way, using the ext4 filesystem directly (instead of mounting ext2 through the ext4 driver), is also a relevant option, as it can work without a journal and extents for small partitions. For example, pass the <code>-O ^has_journal</code> option to <code>mkfs.ext4</code> to create an ext4 filesystem without a journal.</p>
<p>Note that if you really miss the ext2 driver and its simplicity, it’s not too late to make it support 64 bit dates. Kernel developer Ted T’so said <a href="https://lore.kernel.org/linux-ext4/20240221211136.GA633176@mit.edu/T/#m698c62a6458d6d5bde3c8b3ebf2453075676f575">it wouldn’t be so difficult to implement</a>.</p>
<p>See <a href="https://lore.kernel.org/linux-ext4/20240221211136.GA633176@mit.edu/T/#t">the whole discussion</a> that led to this change.</p>

<div>
	<p><img alt="" src="https://secure.gravatar.com/avatar/685f68e2065f2878576f743031bf3a8f?s=42&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/685f68e2065f2878576f743031bf3a8f?s=84&amp;d=mm&amp;r=g 2x" height="42" width="42" decoding="async"/>	</p><!-- .author-avatar -->

	<!-- .author-description -->
</div><!-- .author-info -->
	</div><!-- .entry-content -->

	<!-- .entry-footer -->
</article></div>
  </body>
</html>
