<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.freecodecamp.org/news/what-is-nmap-and-how-to-use-it-a-tutorial-for-the-greatest-scanning-tool-of-all-time/">Original</a>
    <h1>What is NMAP and how to use it? (2020)</h1>
    
    <div id="readability-page-1" class="page"><div id="site-main">
        <div>
            <article>
                
                
                
                    <figure>
                        
    <picture>
      <source media="(max-width: 700px)" sizes="1px" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w"/>
      <source media="(min-width: 701px)" sizes="(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px" srcset="https://www.freecodecamp.org/news/content/images/size/w300/2020/09/wall-6.jpeg 300w,https://www.freecodecamp.org/news/content/images/size/w600/2020/09/wall-6.jpeg 600w,https://www.freecodecamp.org/news/content/images/size/w1000/2020/09/wall-6.jpeg 1000w,https://www.freecodecamp.org/news/content/images/size/w2000/2020/09/wall-6.jpeg 2000w"/>
      <img onerror="this.style.display=&#39;none&#39;" src="https://www.freecodecamp.org/news/content/images/size/w2000/2020/09/wall-6.jpeg" alt="What is Nmap and How to Use it – A Tutorial for the Greatest Scanning Tool of All Time" ,="" width="600" height="400"/>
    </picture>
  
                    </figure>
                
                <section>
                    <div>
                        <section>
                            
<p>Nmap is the most famous scanning tool used by penetration testers. In this article, we will look at some core features of Nmap along with a few useful commands.</p><p>Nmap is short for Network Mapper. It is an open-source Linux command-line tool that is used to scan IP addresses and ports in a network and to detect installed applications. </p><p>Nmap allows network admins to find which devices are running on their network, discover open ports and services, and detect vulnerabilities.</p><p><a href="https://en.wikipedia.org/wiki/Gordon_Lyon" rel="noopener nofollow">Gordon Lyon (pseudonym Fyodor)</a> wrote Nmap as a tool to help map an entire network easily and to find its open ports and services. </p><p>Nmap has become hugely popular, being featured in movies like The Matrix and the popular series Mr. Robot.</p><p>There are a number of reasons why security pros prefer Nmap over other scanning tools. </p><p>First, Nmap helps you to quickly map out a network without sophisticated commands or configurations. It also supports simple commands (for example, to check if a host is up) and complex scripting through the Nmap scripting engine.</p><p>Other features of Nmap include:</p><ul><li>Ability to quickly recognize all the devices including servers, routers, switches, mobile devices, etc on single or multiple networks.</li><li>Helps identify services running on a system including web servers, DNS servers, and other common applications. Nmap can also detect application versions with reasonable accuracy to help detect existing vulnerabilities.</li><li>Nmap can find information about the operating system running on devices. It can provide detailed information like OS versions, making it easier to plan additional approaches during penetration testing.</li><li>During security auditing and vulnerability scanning, you can use Nmap to attack systems using existing scripts from the Nmap Scripting Engine.</li><li>Nmap has a graphical user interface called Zenmap. It helps you develop visual mappings of a network for better usability and reporting.</li></ul><p>Let&#39;s look at some Nmap commands. If you don&#39;t have Nmap installed, you can <a href="https://nmap.org/download.html" rel="noopener nofollow">get it from here</a>.</p><h2 id="basic-scans">Basic scans</h2><p>Scanning the list of active devices on a network is the first step in network mapping. There are two types of scans you can use for that:</p><ul><li><strong><strong>Ping scan — </strong></strong>Scans the list of devices up and running on a given subnet.</li></ul><pre><code>&gt; nmap -sp 192.168.1.1/24</code></pre><ul><li><strong><strong>Scan a single host — </strong></strong>Scans a single host for 1000 well-known ports. These ports are the ones used by popular services like SQL, SNTP, apache, and others.</li></ul><pre><code>&gt; nmap scanme.nmap.org</code></pre><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-3.png" alt="1-3" width="600" height="400" loading="lazy"/></figure><h2 id="stealth-scan">Stealth scan</h2><p>Stealth scanning is performed by sending an SYN packet and analyzing the response. If SYN/ACK is received, it means the port is open, and you can open a TCP connection. </p><p>However, a stealth scan never completes the <a href="https://www.geeksforgeeks.org/tcp-3-way-handshake-process/" rel="noopener nofollow">3-way handshake</a>, which makes it hard for the target to determine the scanning system.</p><pre><code>&gt; nmap -sS scanme.nmap.org</code></pre><p>You can use the <strong><strong>‘-sS’</strong></strong> command to perform a stealth scan. Remember, stealth scanning is slower and not as aggressive as the other types of scanning, so you might have to wait a while to get a response.</p><h2 id="version-scanning">Version scanning</h2><p>Finding application versions is a crucial part in penetration testing. </p><p>It makes your life easier since you can find an existing vulnerability from the <a href="https://cve.mitre.org/" rel="noopener nofollow">Common Vulnerabilities and Exploits (CVE)</a> database for a particular version of the service. You can then use it to attack a machine using an exploitation tool like <a href="https://en.wikipedia.org/wiki/Metasploit_Project" rel="noopener nofollow">Metasploit</a>.</p><pre><code>&gt; nmap -sV scanme.nmap.org</code></pre><p>To do a version scan, use the ‘-sV’ command. Nmap will provide a list of services with its versions. Do keep in mind that version scans are not always 100% accurate, but it does take you one step closer to successfully getting into a system.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-5.png" alt="1-5" width="600" height="400" loading="lazy"/></figure><h2 id="os-scanning">OS Scanning</h2><p>In addition to the services and their versions, Nmap can provide information about the underlying operating system using TCP/IP fingerprinting. Nmap will also try to find the system uptime during an OS scan.</p><pre><code>&gt; nmap -sV scanme.nmap.org</code></pre><p>You can use the additional flags like osscan-limit to limit the search to a few expected targets. Nmap will display the confidence percentage for each OS guess. </p><p>Again, OS detection is not always accurate, but it goes a long way towards helping a pen tester get closer to their target.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-6.png" alt="1-6" width="600" height="400" loading="lazy"/></figure><h2 id="aggressive-scanning">Aggressive Scanning</h2><p>Nmap has an aggressive mode that enables OS detection, version detection, script scanning, and traceroute. You can use the -A argument to perform an aggressive scan.</p><pre><code>&gt; nmap -A scanme.nmap.org</code></pre><p>Aggressive scans provide far better information than regular scans. However, an aggressive scan also sends out more probes, and it is more likely to be detected during security audits.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-7.png" alt="1-7" width="600" height="400" loading="lazy"/></figure><h2 id="scanning-multiple-hosts">Scanning Multiple Hosts</h2><p>Nmap has the capability of scanning multiple hosts simultaneously. This feature comes in real handy when you are managing vast network infrastructure.</p><p>You can scan multiple hosts through numerous approaches:</p><ul><li>Write all the IP addresses in a single row to scan all of the hosts at the same time.</li></ul><pre><code>&gt; nmap 192.164.1.1 192.164.0.2 192.164.0.2</code></pre><ul><li>Use the asterisk (*) to scan all of the subnets at once.</li></ul><pre><code>&gt; nmap 192.164.1.*</code></pre><ul><li>Add commas to separate the addresses endings instead of typing the entire domains.</li></ul><pre><code>&gt; nmap 192.164.0.1,2,3,4</code></pre><ul><li>Use a hyphen to specify a range of IP addresses</li></ul><pre><code>&gt; nmap 192.164.0.0–255</code></pre><h2 id="port-scanning">Port Scanning</h2><p>Port scanning is one of the most fundamental features of Nmap. You can scan for ports in several ways.</p><ul><li>Using the -p param to scan for a single port</li></ul><pre><code>&gt; nmap -p 973 192.164.0.1</code></pre><ul><li>If you specify the type of port, you can scan for information about a particular type of connection, for example for a TCP connection.</li></ul><pre><code>&gt; nmap -p T:7777, 973 192.164.0.1</code></pre><ul><li>A range of ports can be scanned by separating them with a hyphen.</li></ul><pre><code>&gt; nmap -p 76–973 192.164.0.1</code></pre><ul><li>You can also use the <strong><strong>-top-ports </strong></strong>flag to specify the top n ports to scan.</li></ul><pre><code>&gt; nmap --top-ports 10 scanme.nmap.org</code></pre><h2 id="scanning-from-a-file">Scanning from a File</h2><p>If you want to scan a large list of IP addresses, you can do it by importing a file with the list of IP addresses.</p><pre><code>&gt; nmap -iL /input_ips.txt</code></pre><p>The above command will produce the scan results of all the given domains in the “input_ips.txt” file. Other than simply scanning the IP addresses, you can use additional options and flags as well.</p><h2 id="verbosity-and-exporting-scan-results">Verbosity and Exporting Scan Results</h2><p>Penetration testing can last days or even weeks. Exporting Nmap results can be useful to avoid redundant work and to help with creating final reports. Let’s look at some ways to export Nmap scan results.</p><h3 id="verbose-output">Verbose Output</h3><pre><code>&gt; nmap -v scanme.nmap.org</code></pre><p>The verbose output provides additional information about the scan being performed. It is useful to monitor step by step actions Nmap performs on a network, especially if you are an outsider scanning a client’s network.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-8.png" alt="1-8" width="600" height="400" loading="lazy"/></figure><h3 id="normal-output">Normal output</h3><p>Nmap scans can also be exported to a text file. It will be slightly different from the original command line output, but it will capture all the essential scan results.</p><pre><code>&gt; nmap -oN output.txt scanme.nmap.org</code></pre><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-9.png" alt="1-9" width="600" height="400" loading="lazy"/></figure><h3 id="xml-output">XML output</h3><p>Nmap scans can also be exported to XML. It is also the preferred file format of most pen-testing tools, making it easily parsable when importing scan results.</p><pre><code>&gt; nmap -oX output.xml scanme.nmap.org</code></pre><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-10.png" alt="1-10" width="600" height="400" loading="lazy"/></figure><h3 id="multiple-formats">Multiple Formats</h3><p>You can also export the scan results in all the available formats at once using the -oA command.</p><pre><code>&gt; nmap -oA output scanme.nmap.org</code></pre><p>The above command will export the scan result in three files — output.xml, output. Nmap and output.gnmap.</p><h2 id="nmap-help">Nmap Help</h2><p>Nmap has a built-in help command that lists all the flags and options you can use. It is often handy given the number of command-line arguments Nmap comes with.</p><pre><code>&gt; nmap -h</code></pre><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-12.png" alt="1-12" width="600" height="400" loading="lazy"/></figure><p>Nmap Scripting Engine (NSE) is an incredibly powerful tool that you can use to write scripts and automate numerous networking features. </p><p>You can find plenty of scripts distributed across Nmap, or write your own script based on your requirements. You can even modify existing scripts using the <a href="https://en.wikipedia.org/wiki/Lua_(programming_language)" rel="noopener nofollow">Lua programming language</a>.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-13.png" alt="1-13" width="600" height="400" loading="lazy"/></figure><p>NSE also has attack scripts that are used in attacking the network and various networking protocols. </p><p>Going through the scripting engine in-depth would be out-of-scope for this article, so <a href="https://nmap.org/book/nse.html" rel="noopener nofollow">here is more information about the Nmap scripting engine.</a></p><h2 id="zenmap">Zenmap</h2><p>Zenmap is a graphical user interface for Nmap. It is a free and open-source software that helps you get up and running with Nmap.</p><figure><img src="https://www.freecodecamp.org/news/content/images/2020/09/1-15.png" alt="1-15" width="600" height="400" loading="lazy"/></figure><p>In addition to providing visual network mappings, Zenmap also allows you to save and search your scans for future use. </p><p>Zenmap is great for beginners who want to test the capabilities of Nmap without going through a command-line interface.</p><p>Nmap is clearly the “Swiss Army Knife” of networking, thanks to its inventory of versatile commands. </p><p>It lets you quickly scan and discover essential information about your network, hosts, ports, firewalls, and operating systems. </p><p>Nmap has numerous settings, flags, and preferences that help system administrators analyze a network in detail.</p><p>If you want to learn Nmap in-depth, <a href="https://github.com/jasonniebauer/Nmap-Cheatsheet" rel="noopener nofollow">here is a great resource for you</a>.</p><p><em><em>Loved this article? </em></em><a href="http://tinyletter.com/manishmshiva" rel="noopener nofollow"><strong><strong><em><em>Join my Newsletter</em></em></strong></strong></a><strong><strong><em><em> </em></em></strong></strong><em><em>and get a summary of my articles and videos every Monday.</em></em></p>

                        </section>
                        
                            
                        
                    </div>
                    <hr/>
                    
                        
                        <hr/>
                    

                    
                    
                        
    





    
    


                        

<p>
        Learn to code for free. freeCodeCamp&#39;s open source curriculum has helped more than 40,000 people get jobs as developers. <a href="https://www.freecodecamp.org/learn/" id="learn-to-code-cta" rel="noopener noreferrer" target="_blank">Get started</a>
    </p>

                    
                </section>
                
                    
                
            </article>
        </div>
    </div></div>
  </body>
</html>
