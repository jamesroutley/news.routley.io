<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.inversecos.com/2022/07/heap-overflows-on-ios-arm64-heap.html">Original</a>
    <h1>Heap Overflows on iOS ARM64</h1>
    
    <div id="readability-page-1" class="page"><div>

<main id="main" role="main" tabindex="-1">
<div id="page_body" name="Page body">
<div data-version="2" id="Blog1">
<div>
<article>
<div>
<div>

<h3>
Heap Overflows on iOS ARM64: Heap Grooming, Use-After-Free (Part 3)
</h3>


<div id="post-body-8711754518468811379">
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhIMr2yftYRYAA1M0OdFCbz-lXqGlBR9MVRSyBIK2qbTQGZaSZAaNq6pENYaxcQTHHNV7SqaEG9390dfhEu1Eh5gunp-Kyhdc0ilwqgQCZAJedrAc-QYTwTrtjkHxUtQHIKvOWAGtUEVYf-jyIaryikkij7nkmrm_lqV5teilVKlatKNC4ScRDDqpQP6g/s2730/Screen%20Shot%202022-07-11%20at%201.18.46%20pm.png"><span><img data-original-height="1466" data-original-width="2730" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhIMr2yftYRYAA1M0OdFCbz-lXqGlBR9MVRSyBIK2qbTQGZaSZAaNq6pENYaxcQTHHNV7SqaEG9390dfhEu1Eh5gunp-Kyhdc0ilwqgQCZAJedrAc-QYTwTrtjkHxUtQHIKvOWAGtUEVYf-jyIaryikkij7nkmrm_lqV5teilVKlatKNC4ScRDDqpQP6g/s16000/Screen%20Shot%202022-07-11%20at%201.18.46%20pm.png"/></span></a></p><p><span><b>Welcome back to part 3 of my iOS arm64 exploitation series! </b>If you’ve missed the blogs in the series, check them out below ^_^</span></p><p><span>If you’re more of a visual learner – I have filmed a YouTube video on this that you can check out! The YouTube video does not go into the same level of depth as this blog post will, so just keep that in mind.</span></p><p><iframe allowfullscreen="" height="596" src="https://www.youtube.com/embed/CmTA05bcawk" width="716" youtube-src-id="CmTA05bcawk"></iframe></p></div>

</div>
</div>


</article>
</div>
</div><div data-version="2" id="PopularPosts1">
<h3>
Popular posts from this blog
</h3>
<div>
<div role="feed">
<article role="article">
<h3><a href="https://www.inversecos.com/2021/09/office365-attacks-bypassing-mfa.html">Office365 Attacks: Bypassing MFA, Achieving Persistence and More - Part I</a></h3>

<div>
<p><a href="https://www.inversecos.com/2021/09/office365-attacks-bypassing-mfa.html">
<img alt="Image" sizes="72px" src="https://1.bp.blogspot.com/-uWt0Nh427IU/YUQi3qIgGLI/AAAAAAAACHs/AmuKnzEheyYExr58SyDTwqwDjZqc9KnYgCLcBGAsYHQ/s16000/Screen%2BShot%2B2021-09-17%2Bat%2B2.59.05%2Bpm.png" srcset="https://1.bp.blogspot.com/-uWt0Nh427IU/YUQi3qIgGLI/AAAAAAAACHs/AmuKnzEheyYExr58SyDTwqwDjZqc9KnYgCLcBGAsYHQ/w72-h72-p-k-no-nu/Screen%2BShot%2B2021-09-17%2Bat%2B2.59.05%2Bpm.png 72w, https://1.bp.blogspot.com/-uWt0Nh427IU/YUQi3qIgGLI/AAAAAAAACHs/AmuKnzEheyYExr58SyDTwqwDjZqc9KnYgCLcBGAsYHQ/w144-h144-p-k-no-nu/Screen%2BShot%2B2021-09-17%2Bat%2B2.59.05%2Bpm.png 144w"/>
</a>
</p>
<div>
<p>
APTs are actively attacking Office 365 (O365) – finding mechanisms to bypass MFA and to impersonate users regardless of whether you reset their passwords. When I was looking through the Mitre mapping of O365 attacks , I noticed that it didn’t include many methods of intrusion and actions on objectives that can occur with O365. In conversations with several clients, I couldn’t help but notice that there’s still a heavy focus on “endpoint” style attacks and not much resource / thought put into attacks that can occur in the cloud. Attacking O365 gives an attacker many benefits… it allows an attacker to impersonate users, alter MFA settings, register malicious devices, access Teams messages, download sensitive emails, access SharePoint, OneDrive, register malicious applications and various other actions that could allow them to maintain persistence in your environment. This blog post explores the various ways O365 can be attacked. I will be writing a Part II follow up that describes the me
</p>
</div>

</div>
</article>
<article role="article">
<h3><a href="https://www.inversecos.com/2021/02/forensic-analysis-of-anydesk-logs.html">Forensic Analysis of AnyDesk Logs</a></h3>

<div>
<p><a href="https://www.inversecos.com/2021/02/forensic-analysis-of-anydesk-logs.html">
<img alt="Image" sizes="72px" src="https://lh3.googleusercontent.com/-0d69NkZ3LH8/YCSCZbXqnbI/AAAAAAAAB7Y/TiELQO71_R8N0oDPg4m7w2_DcZpK_1dOACLcBGAsYHQ/s16000/Screen%2BShot%2B2021-02-11%2Bat%2B11.53.45%2Bam.png" srcset="https://lh3.googleusercontent.com/-0d69NkZ3LH8/YCSCZbXqnbI/AAAAAAAAB7Y/TiELQO71_R8N0oDPg4m7w2_DcZpK_1dOACLcBGAsYHQ/w72-h72-p-k-no-nu/Screen%2BShot%2B2021-02-11%2Bat%2B11.53.45%2Bam.png 72w, https://lh3.googleusercontent.com/-0d69NkZ3LH8/YCSCZbXqnbI/AAAAAAAAB7Y/TiELQO71_R8N0oDPg4m7w2_DcZpK_1dOACLcBGAsYHQ/w144-h144-p-k-no-nu/Screen%2BShot%2B2021-02-11%2Bat%2B11.53.45%2Bam.png 144w"/>
</a>
</p>
<div>
<p>
Most threat actors during ransomware incidents utilise some type of remote access tools - one of them being AnyDesk. This is a free remote access tool that threat actors download onto hosts to access them easily and also for bidirectional file transfer.  There are two locations for where AnyDesk logs are stored on the Windows file system: %programdata%\AnyDesk\ad_svc.trace %appdata%\Anydesk\ad.trace The AnyDesk logs can be found under the appdata located within each users&#39; directory where the tool has been installed. Forensic analysis of these logs reveal interesting pieces of information inside the &#34;ad.trace&#34; log: Remote IP where the actor connected from File transfer activity Locating the Remote IP Connecting to AnyDesk Inside the &#34;ad.trace&#34; log you can grep for the following term &#34;External address&#34; and this should reveal the following line pasted below. I have redacted the IP for privacy&#39;s sake:   info 2021-02-04 23:25:10.500       lsvc   9988  
</p>
</div>

</div>
</article>
<article role="article">
<h3><a href="https://www.inversecos.com/2021/09/backdooring-office-365-and-active.html">Backdoor Office 365 and Active Directory - Golden SAML</a></h3>

<div>
<p><a href="https://www.inversecos.com/2021/09/backdooring-office-365-and-active.html">
<img alt="Image" sizes="72px" src="https://lh3.googleusercontent.com/-vYuq9ZWoKko/YTGai7gDLAI/AAAAAAAACG4/YKVLcgE5-ygiB80pUsILdS3BVArdh3FfQCLcBGAsYHQ/w640-h196/Screen%2BShot%2B2021-09-03%2Bat%2B1.46.13%2Bpm.png" srcset="https://lh3.googleusercontent.com/-vYuq9ZWoKko/YTGai7gDLAI/AAAAAAAACG4/YKVLcgE5-ygiB80pUsILdS3BVArdh3FfQCLcBGAsYHQ/w72-h72-p-k-no-nu/Screen%2BShot%2B2021-09-03%2Bat%2B1.46.13%2Bpm.png 72w, https://lh3.googleusercontent.com/-vYuq9ZWoKko/YTGai7gDLAI/AAAAAAAACG4/YKVLcgE5-ygiB80pUsILdS3BVArdh3FfQCLcBGAsYHQ/w144-h144-p-k-no-nu/Screen%2BShot%2B2021-09-03%2Bat%2B1.46.13%2Bpm.png 144w"/>
</a>
</p>
<div>
<p>
Backdoors can bypass all MFA requirements put in place by an organisation. Earlier this year, I worked an engagement with an APT group that had a keen interest on the client’s Office 365 environment, where this group found a way to bypass authentication controls to access the environment. Given that most clients either have a hybrid authentication model set-up or are fully in the cloud – I think it’s important that most blue teams / defenders / hunters are aware of the various techniques threat actors are using against Azure AD. Compromise of the AD FS server token-signing certificate could result in access to the Azure/Office365 environment by the attacker. By default, this certificate is valid for a year and will allow an attacker to log into Azure/Office365 as any user within AD regardless of any password resets and MFA. The implication of this, is that the attacker maintains persistence and has a means to re-enter into the environment, escaping detection. This blog post will cover 
</p>
</div>

</div>
</article>
</div>
</div>
</div></div>
</main>
</div></div>
  </body>
</html>
