<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://moonbase.lgbt/blog/100m-accelerated-backhopping/">Original</a>
    <h1>Gordon Freeman at the Olympic Games</h1>
    
    <div id="readability-page-1" class="page"><article>
	
	<div>
		
		
		<p>Since the dawn of <a href="https://twitter.com/lunasorcery/status/1576008439586648065">October 1st 2022</a>, the world has been plagued by the question:</p>
<p><strong><em>Would accelerated backhopping give you a competitive advantage in the 100m dash?</em></strong></p>
<p>In this <s>deranged ramble</s> blog article we shall attempt to answer the question once and for all.</p>
<hr/>
<blockquote>
“Gordon! You must get out of here! Run!”
<cite>— Dr. Kleiner, Half-Life 2</cite>
</blockquote>

<hr/>
<h2 id="initial-parameters">Initial Parameters</h2>
<p>Our investigation into the viability of accelerated backhopping as a competitive strategy in the 100m dash will use the following parameters:</p>
<ul>
<li>Movement physics will be as present in Half-Life 2.</li>
<li>The 100m dash will be as defined in the IAAF Competition Rules.</li>
</ul>
<hr/>
<h2 id="what-is-accelerated-backhopping">What is Accelerated Backhopping?</h2>
<p><em>Note: the technical aspects of this section are largely adapted from <a href="https://wiki.sourceruns.org/wiki/Accelerated_Back_Hopping">the SourceRuns wiki</a>.</em></p>
<p>Accelerated backhopping (henceforth referred to as ABH) is a bug in the Source engine movement code, allowing the player to move far faster than the developers intended.</p>
<p>When the player performs a jump, the game tries to give the player a little extra speed boost, based on their current velocity, state (crouching, sprinting, etc), movement input, and look direction. It also attempts to cap the player’s speed, but an oversight in the programming causes the player to accelerate far beyond that speed limit under certain circumstances.</p>
<hr/>
<p>Let’s look at <a href="https://github.com/ValveSoftware/source-sdk-2013/blob/56accfdb9c4abd32ae1dc26b2e4cc87898cf4dc1/sp/src/game/shared/gamemovement.cpp#L2469-L2495">the code</a>; this is executed when a player is on the ground and makes a jump input:</p>
<p>Calculate the boost multiplier <code>flSpeedBoostPerc</code> to determine how much of a boost we want to give. If the player is sprinting or ducking, they get a 10% boost, otherwise they get a 50% boost.</p>
<pre><code>float flSpeedBoostPerc = ( !pMoveData-&gt;m_bIsSprinting &amp;&amp; !player-&gt;m_Local.m_bDucked ) ? 0.5f : 0.1f;
</code></pre>
<p>Calculate <code>flSpeedAddition</code>, the additional velocity we want to apply to our player’s speed, by scaling the player’s forward movement input <code>mv-&gt;m_flForwardMove</code> by our boost multiplier, and taking the absolute value so it’s positive.</p>
<pre><code>float flSpeedAddition = fabs( mv-&gt;m_flForwardMove * flSpeedBoostPerc );
</code></pre>
<p>Calculate <code>flMaxSpeed</code>, the maximum speed the player should be travelling at. We take <code>mv-&gt;m_flMaxSpeed</code>, the maximum speed expected for the player’s current state, and increase it by our boost multiplier.</p>
<pre><code>float flMaxSpeed = mv-&gt;m_flMaxSpeed + ( mv-&gt;m_flMaxSpeed * flSpeedBoostPerc );
</code></pre>
<p>Calculate <code>flNewSpeed</code>, the speed we expect the player to have after jumping, by adding <code>flSpeedAddition</code> to the player’s current lateral velocity <code>mv-&gt;m_vecVelocity.Length2D</code>.</p>
<pre><code>float flNewSpeed = ( flSpeedAddition + mv-&gt;m_vecVelocity.Length2D() );
</code></pre>
<p>If the player’s new speed is higher than the maximum speed, subtract the difference from <code>flSpeedAddition</code>.</p>
<pre><code>if ( flNewSpeed &gt; flMaxSpeed )
{
    flSpeedAddition -= flNewSpeed - flMaxSpeed;
}
</code></pre>
<p>If the player is providing a backwards movement input, negate <code>flSpeedAddition</code>:</p>
<pre><code>if ( mv-&gt;m_flForwardMove &lt; 0.0f )
    flSpeedAddition *= -1.0f;
</code></pre>
<p>Apply the speed addition to the player’s velocity, by adding it in the forward look direction <code>vecForward</code>:</p>
<pre><code>VectorAdd( (vecForward*flSpeedAddition), mv-&gt;m_vecVelocity, mv-&gt;m_vecVelocity );
</code></pre>
<hr/>
<p>The critical flaw in the code resides in the assumption that the movement input and the current velocity are correlated.</p>
<p>Consider the following situation: The player is sprinting along at 320ups (units per second). They jump forwards, and the boost increases their speed to 352ups, by design. While in the air, they spin around 180 degrees (so they’re now facing where they came from, and moving backwards), release all movement inputs, and begin crouching. Upon touching the ground, still moving at 352ups, they immediately jump again.</p>
<p>The player is crouching, so the boost multiplier is set to 10%.</p>
<p>Since the player isn’t providing any forward movement input, <code>flSpeedAddition</code> becomes 0:</p>
<pre><code>float flSpeedAddition = fabs( mv-&gt;m_flForwardMove * flSpeedBoostPerc ) 
                      = fabs(0 * 0.1) 
                      = 0
</code></pre>
<p>The max speed <code>flMaxSpeed</code> is calculated based on <em>crouching</em> speed limit of 190ups, and comes out as 209:</p>
<pre><code>float flMaxSpeed = mv-&gt;m_flMaxSpeed + ( mv-&gt;m_flMaxSpeed * flSpeedBoostPerc ) 
                 = 190 + (190 * 0.1) 
                 = 209
</code></pre>
<p>Since <code>flSpeedAddition</code> is 0, the new speed <code>flNewSpeed</code> does not change from the player’s current velocity.</p>
<pre><code>float flNewSpeed = ( flSpeedAddition + mv-&gt;m_vecVelocity.Length2D() ) 
                 = 0 + 352 
                 = 352
</code></pre>
<p><code>flNewSpeed</code> is now far in excess of <code>flMaxSpeed</code>, so the difference is subtracted from <code>flSpeedAddition</code>, giving -143:</p>
<pre><code>flSpeedAddition -= flNewSpeed - flMaxSpeed;
                = 0 - (352 - 209)
                = -143
</code></pre>
<p>The player is not providing any backwards movement input, so <code>flSpeedAddition</code> remains negative.</p>
<pre><code>if ( mv-&gt;m_flForwardMove &lt; 0.0f ) // false
    flSpeedAddition *= -1.0f; // doesn&#39;t execute
</code></pre>
<p>This negative value then gets multiplied by the player’s <em>forward</em> look direction, producing a vector pointing 143 units <em>behind</em> them. This gets applied to the player’s velocity vector — remember, since spinning in mid-air they’re already moving backwards — increasing their speed by 143ups for a new speed of 495ups.</p>
<p>On the next jump, this effect is compounded, creating a speed boost of 286ups, then 572ups, then 1144ups, and so on.</p>
<hr/>
<h2 id="rules-of-engagement">Rules of Engagement</h2>
<p>We will now consult the <a href="https://worldathletics.org/about-iaaf/documents/book-of-rules">IAAF Book of Rules</a> to determine the conditions under which we will compete. The following excerpts are all taken from IAAF Book C, C2.1 Technical Rules.</p>
<h3 id="attire">Attire</h3>
<blockquote>
<p>Assistance not Allowed</p>
<p><strong>6.3</strong>   For the purpose of this Rule, the following examples shall be considered assistance, and are therefore not allowed:</p>
</blockquote>
<p>Wearing the HEV suit allows the player to sprint, allowing for a much faster initial ABH speed than would otherwise be possible (495ups with the suit, 285ups without). We believe it is a reasonable interpretation that the HEV suit constitutes a mechanical aid, and would therefore not be permitted for use. Our runner will thus compete without the suit.</p>
<h3 id="race-start">Race Start</h3>
<blockquote>
<p><strong>16.3</strong>  In races up to and including 400m (including the first leg of 4 × 200m, the Medley Relay and 4 × 400m), <strong>a crouch start and the use of starting blocks are compulsory</strong>. After the “On your marks” command, an athlete shall approach the start line, assume a position completely within their allocated lane and behind the start line. An athlete shall not touch either the start line or the ground in front of it with their hands or their feet when on their mark. Both hands and at least one knee shall be in contact with the ground and both feet in contact with the foot plates of the starting blocks. At the “Set” command, an athlete shall immediately rise to their final starting position retaining the contact of the hands with the ground and of the feet with the foot plates of the blocks. Once the Starter is satisfied that all athletes are steady in the “Set” position, the gun shall be fired.</p>
</blockquote>
<p>Within the bounds of Half-Life 2’s movement, the use of starting blocks and placing hands on the ground are not possible, so we will assume reasonable exemption from these rules. However, we can still abide by the requirement of a crouching start.</p>
<h3 id="lanes">Lanes</h3>
<blockquote>
<p><strong>14.4</strong>  In all races up to and including 400m, each athlete shall have a separate lane, with a width of 1.22m ± 0.01m, including the lane line on the right, marked by white lines 50mm in width. All lanes shall be of the same nominal width. The inner lane shall be measured as stated in Rule 14.2, but the remaining lanes shall be measured 0.20m from the outer edges of the lines.</p>
</blockquote>
<!-- -->

<blockquote>
<p><strong>17.3</strong>  In all races:</p>
<p><strong>17.3.1</strong>    run in lanes, each athlete shall keep within their allocated lane from start to finish. This shall also apply to any portion of a race run in lanes;</p>
</blockquote>
<!-- -->

<blockquote>
<p><strong>17.4</strong>  An athlete, or in the case of a relay race, their team, shall not be disqualified if the athlete:</p>
</blockquote>
<p>In summary, the lane is 1.22m wide, and we must be careful to stay within that lane. We are only permitted to leave the lane if no material advantage would be gained by doing so; as such we cannot use any maneuvers that depend on us leaving the lane.</p>
<h3 id="the-finish">The Finish</h3>
<blockquote>
<p><strong>18.2</strong>  The athletes shall be placed in the order in which any part of their bodies (i.e. torso, as distinguished from the head, neck, arms, legs, hands or feet) reaches the vertical plane of the nearer edge of the finish line as defined above.</p>
</blockquote>
<p>In summary, our aim is to:</p>
<ul>
<li>Travel 100 meters as quickly as possible,</li>
<li>from a stationary crouching start,</li>
<li>without leaving the 1.22m-wide lane,</li>
<li>and without wearing an HEV suit.</li>
</ul>
<hr/>
<h2 id="a-matter-of-scale">A Matter of Scale</h2>
<p>Contemporary game engines typically base their unit systems on the metric system.<sup id="fnref:cite-unity-units"><a href="#fn:cite-unity-units">[1]</a></sup><sup id="fnref:cite-unreal-units"><a href="#fn:cite-unreal-units">[2]</a></sup> Source engine, however, is an unusual beast, and its units are based on the imperial system. Maps are modelled at a scale of 16 units = 1 foot, or 1 unit = 3/4 inch.<sup id="fnref:cite-source-units"><a href="#fn:cite-source-units">[3]</a></sup> From this, we can calculate that our 100m run is 5,249.34 units.</p>
<hr/>
<h2 id="the-run">The Run</h2>
<p><em>Note: The following timings and speeds are theoretical based on a crude analysis of the game code, and may not necessarily be reproducible under practical testing.</em></p>
<p>The player begins from a crouching position at the start line. Since an ABH cannot be performed from a crouching start, they spend 200ms returning to a standing position.<sup id="fnref:cite-unduck"><a href="#fn:cite-unduck">[4]</a></sup> Once standing, they begin walking forward, quickly reaching their maximum walking speed of 150ups. Once at speed, they make their first jump facing forwards. They get the <em>intended</em> jump-speed bonus, accelerating them to 225ups. While in the air, they release all forward input, turn 180 degrees, and crouch. Roughly 510ms after jumping,<sup id="fnref:cite-jumptime"><a href="#fn:cite-jumptime">[5]</a></sup> they make their first landing. Still crouching and providing no lateral movement input, they jump again, ABH accelerating them from 225ups to a new speed of 285ups. A further 510ms later, they hit the ground again, and with another jump, ABH accelerates them to 405ups. This continues as follows:</p>
<table>
<thead>
<tr>
<th>Time*</th>
<th>Distance*</th>
<th>Speed**</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.00s</td>
<td>0.00u</td>
<td>225ups</td>
</tr>
<tr>
<td>0.51s</td>
<td>114.75u</td>
<td>285ups</td>
</tr>
<tr>
<td>1.02s</td>
<td>260.10u</td>
<td>405ups</td>
</tr>
<tr>
<td>1.53s</td>
<td>466.65u</td>
<td>645ups</td>
</tr>
<tr>
<td>2.04s</td>
<td>795.60u</td>
<td>1125ups</td>
</tr>
<tr>
<td>2.55s</td>
<td>1369.35u</td>
<td>2085ups</td>
</tr>
<tr>
<td>3.06s</td>
<td>2432.70u</td>
<td>3500ups</td>
</tr>
<tr>
<td>3.57s</td>
<td>4217.70u</td>
<td>3500ups</td>
</tr>
<tr>
<td>4.08s</td>
<td>6002.70u</td>
<td>3500ups</td>
</tr>
</tbody>
</table>
<p><small>* from initial jump</small></p>
<p>On the seventh jump, ABH <em>would</em> give a velocity of 4005ups, but this gets hard-capped to 3500ups, and remains as such for the remainder of the run. 3.865s after the first jump, the player flies across the finish line, and shortly afterwards at 4.08s, they land some 753.36u (14.35m) beyond it.</p>
<p>Note that these timings and distances are relative to the first jump. After the starting pistol is fired, the player takes 200ms to stand from crouching, and an unspecified amount of time and distance (dependent on the ground friction) to reach their 150ups walking speed. However, given the acceleration the player is able to achieve once jumping, this pre-jump phase would have to last at least 5.715s in order for 100m record-holder Usain Bolt to still have a chance of outrunning them.</p>
<p>We hereby propose that the IAAF add a rule explicitly banning the use of ABH in competitions, and submit this article as justification.</p>
<hr/>
<h2 id="addendum">Addendum</h2>
<p>Lyren from the SourceRuns team provided two practical runs, one with human inputs [<a href="https://moonbase.lgbt/blog/100m-accelerated-backhopping/100-scriptless.mp4">video</a>], and one with <a href="https://wiki.sourceruns.org/wiki/Host_timescale">host_timescale</a> to slow down time, along with an autojumping script [<a href="https://moonbase.lgbt/blog/100m-accelerated-backhopping/100-scripted.mp4">video</a>].</p>
<p>It could be argued that since the player cannot sprint without the HEV suit, this would constitute an impairment and the suit may be permitted under the Mechanical Aids Regulations. However, as shown, even without the suit, the player clearly has an unfair advantage over conventional human runners; the addition of the suit would just add further insult to injury.</p>
<p>The observant among you will notice that the blog’s accent colors have been changed specifically for this article, to a shade of orange taken from <a href="https://web.archive.org/web/20070803003812fw_/http://orange.half-life2.com/">the Orange Box website</a> circa 2007.</p>

	</div>
</article></div>
  </body>
</html>
