<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2023/11/27/sitefinder/">Original</a>
    <h1>That time Verisign typo-squatted all of .com and .net</h1>
    
    
<p>
A little over 20 years ago, Verisign did something mighty evil: they 
effectively typosquatted every single unregistered domain in the .com 
and .net top-level domains.  They could do this because they controlled 
those from the registry side of things, and it was trivial to slam 
something that would make it resolve.
</p>
<p>
Reactions from people like me who had systems to run and spam to 
block were swift and universally negative due to all of the collateral 
damage it caused.  Here&#39;s one situation it created: sometimes you&#39;d 
have a user who thought they were being clever, and they&#39;d put 
something like &#34;nospam&#34; in the from address in their e-mail client.  
Thus, they&#39;d try to send mail as luser@nospam-example.com instead of 
just @example.com.
</p>
<p>
Before Verisign pulled that crap, the mail servers of the day would have 
just rejected it as an invalid domain that didn&#39;t resolve (in DNS).  
Once it was online, it WOULD resolve, and so the mail system would 
accept it.  Utter chaos.
</p>
<p>
Or, how about all of the random people who would mistype something?  
Instead of getting a failure to resolve error from their browser and/or 
organization&#39;s web proxy, it would just pop out to that stupid Verisign 
site.
</p>
<p>
It should surprise nobody that a bunch of us sour sysadmin types did 
things about it rather quickly over the next day or so.  I still have 
the snippet of cruft to drop into a sendmail.cf in my notes from back 
then.  I got this from Usenet, apparently:
</p>
<pre class="terminal">Local_check_mail
R$*                     $: $&gt;canonify $1
R$*&lt;@$*.&gt;               $: $1&lt;@$2&gt; strip the trailing . if present
R$*&lt;@$+&gt;                $: $(verisign $2 $)
R64.94.110.11           $#error $: &#34;550 Real domain name required for sender address&#34;
</pre>
<p>
Incidentally, if any of you can still parse that syntax in your heads 
just by reading it, I&#39;m so sorry.  Take it from me - that ability does 
go away eventually, but you have to stop supplying it with new data.
</p>
<p>
Anyway, what that did was to exploit the
<a href="https://www.99-bottles-of-beer.net/language-sendmail-588.html">limitless programmability</a> of 
sendmail&#39;s config language to resolve the supplied domain.  If it came 
back to 64.94.110.11, it would reject it right then and there.  That was 
the IP address they were using for their little marketdroid-fueled fever 
dream, and I bet there are *still* systems blocking it 20 years later 
(and they probably have no idea why).
</p>
<p>
Over the next couple of days, a bunch of other things happened.  ISC 
wrote a &#34;delegation-only&#34; feature for BIND (aka named, the 
occasional remote sudo implementation).  You could use this to say that 
the &#34;com.&#34; or &#34;net.&#34; zones were only allowed to provide delegation to 
other zones.  That is, within the bailiwick of &#34;com.&#34;, it could say that 
&#34;example.com.&#34; has a nameserver at &lt;foo&gt; with IP address &lt;bar&gt;, but 
that&#39;s it.  It couldn&#39;t come right out and say that something had an A 
record outright.
</p>
<p>
Now, this worked great, but it wouldn&#39;t have been terribly difficult for 
them to sidestep it.  They could have had it delegate all of those 
things down to some other level which then would have had a blanket 
answer for any incoming questions.  Fortunately, this did not happen.
</p>
<p>
This whole bout of stupidity lasted about three weeks, and then it 
disappeared.  They&#39;ve never done it again, but plenty of other providers 
of recursive resolver action have pulled it since then as a matter of 
course.  Screw up the way DNS works in order to fellate the advertisers?  
Brilliant!
</p>
<p>
<a href="https://rachelbythebay.com/w/2019/10/05/nxdomain/">Remember this?  That was 2019.</a>
</p>
<p>
I find it strangely fulfilling that this event has garnered a 
<a href="https://en.wikipedia.org/wiki/Site_Finder">Wikipedia article</a> in
the years since.  Hopefully people will never forget what happened back 
in 2003 with the DNS.
</p>

  </body>
</html>
