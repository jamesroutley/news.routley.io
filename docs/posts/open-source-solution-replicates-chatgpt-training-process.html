<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.hpc-ai.tech/blog/colossal-ai-chatgpt">Original</a>
    <h1>Open source solution replicates ChatGPT training process</h1>
    
    <div id="readability-page-1" class="page"><div id="main-content">
        



<div>

  

  <div>

    
  
    <div>
      <article>
        <time datetime="2023-02-14 15:33:23">
          February 14, 2023
        </time>
        
        
        
        <p><img src="https://www.hpc-ai.tech/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png" width="100%" loading="eager" alt=""/>
        </p>
        
        <p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>ChatGPT, which has been considered as part of &#34;the generative-AI eruption&#34; by Dereck Thompson in The Atlantic magazine’s &#34;Breakthroughs of the Year&#34; for 2022, has increased significant interest and competition in the space. Along with this trend, many tech giants around the world like Google, Microsoft are launching a ChatGPT-style service to join the competition with ChatGPT.</p>
<!--more-->
<p>However, since OpenAI has not released the code for ChatGPT, how to effectively replicate ChatGPT has become a huge problem faced by everyone, and an open-source ChatGPT equivalent is in great demand.</p>
<p>The good news is that now Colossal-AI, as one of the hottest open-source solutions for large AI models, presents <strong>an open-source low-cost ChatGPT equivalent implementation process first</strong>, with highlights including:</p>
<ul>
<li><strong>An open-source complete PyTorch-based ChatGPT equivalent implementation process</strong>, covering all 3 stages, which can help you build the ChatGPT-style service based on pre-trained models.</li>
<li>We offer a mini demo training process for users to play around, which <strong>requires only 1.62GB of GPU memory</strong> and would possibly be achieved on a single consumer-grade GPU, with up to <strong>10.3x growth in model capacity on one GPU</strong>.</li>
<li>Compared to the original PyTorch, single-machine training process can be <strong>7.73 times faster</strong> and single-GPU inference can be 1.42 times faster, which can be achieved in <strong>a single line of code</strong>.</li>
<li>Regarding fine-tuning task, <strong>with one line of code</strong>, you are able to increase the capacity of the fine-tuning model by up to <strong>3.7 times</strong> on a single GPU while keeping a sufficiently <strong>high running speed</strong>.</li>
<li>We provide <strong>multiple versions</strong> of a single-GPU scale, a multiple-GPUs scale on a single node, and an original 175-billion-parameter scale. We also support importing OPT, GPT-3, BLOOM and many other pre-trained large models from Hugging Face to your training process.</li>
<li>Verification of convergence is in progress, and all users are invited to <strong>build up the community together</strong>.</li>
<li>GitHub Repo: <a href="https://github.com/hpcaitech/ColossalAI" rel="noopener">https://github.com/hpcaitech/ColossalAI</a></li>
</ul>
<h2>ChatGPT - the industrial revolution led by AIGC</h2>
<p>You may wonder, at the beginning of the new year, what is the most popular technology in AI? That should be ChatGPT.</p>
<p>It behaves like a hexagonal warrior that’s able to chat, write code, fix bugs, create forms, publish papers, do homework, translate, and even be a good competitor to Google search engine.</p>
<p>Since its release, ChatGPT has gained fame in all industries, catching the attention of millions of users in 5 days, hitting 100 million monthly active users 2 months after its launch. It has become the fastest growing application in history, far surpassing other well-known applications today, such as Twitter taking 5 years to hit 100M users , Meta (Facebook) taking 4 and a half years, TikTok taking 9 months and even 16 years were taken for mobile phones to reach 100M users.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=529&amp;height=673&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png" title="" width="529" height="673" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=265&amp;height=337&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 265w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=529&amp;height=673&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 529w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=794&amp;height=1010&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 794w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=1058&amp;height=1346&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 1058w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=1323&amp;height=1683&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 1323w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png?width=1587&amp;height=2019&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-2.png 1587w" sizes="(max-width: 529px) 100vw, 529px"/></p>
<p>Bill Gates praised <strong>ChatGPT as significant as the invention of the Internet</strong>, while Microsoft CEO Satya Nadella was more outspoken in saying, &#34;<strong>AI will fundamentally change every software category</strong>.&#34; As a major investor with tens of billions of dollars investment in OpenAI, Microsoft has quickly integrated ChatGPT into its own search engine Bing and Edge browser, with plans of adding to Teams, Office and other office suites. Its stock soared more than 80 billion dollars overnight.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=624&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png" title="" width="624" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=312&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 312w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=624&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 624w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=936&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 936w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=1248&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 1248w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=1560&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 1560w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png?width=1872&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-7608-PM.png 1872w" sizes="(max-width: 624px) 100vw, 624px"/></p>
<p><em>Google Stock vs. Microsoft Stock after both AI Presentations</em></p>
<p>Worried about being beaten by ChatGPT at search, Google swiftly released the competitive product Bard. Yet its stock immediately evaporated by $100 billion because of the failure of its demo debut.</p>
<p>Overnight, the global tech giants are trying to be the first to launch their own ChatGPT-like service to dominate the market in this area.</p>
<p>Although ChatGPT has been released for several months, <strong>neither open-source pre-training weight nor a complete open source training process at low cost is available to the public</strong>. In fact, it’s difficult to realize the efficient replication of the whole process of ChatGPT-style service based on kinds of 100-billion-parameter models. Recently, a bunch of ChatGPT alternatives have been temporarily launched. But it is difficult to tell the difference because they are closed source.</p>
<p>Why is ChatGPT so magical? What are the difficulties in replicating it?</p>
<h2>ChatGPT technical analysis</h2>
<p>The important feature of ChatGPT&#39;s amazing results is the introduction of human feedback reinforcement learning (RLHF) in the training process, to better capture human preferences.</p>
<p>The training process of ChatGPT is divided into three main stages.</p>
<ol>
<li>Sampling from the Prompt library, collecting its human responses, and using these data to fine-tune the pre-trained large language model.</li>
<li>Sampling from the Prompt library, generating multiple responses using the large language model, manually ranking these responses, and training a reward model (RM) to fit human preference.</li>
<li>Based on the supervised fine-tuning model in stage 1 and the reward model in stage 2, the large language model is further trained using reinforcement learning algorithms.</li>
</ol>
<p>In stage 3, which is the core part of RLHF training, OpenAI adopts the Proximal Policy Optimization (PPO) algorithm in reinforcement learning to introduce the reward signal so that the language model generates content more in line with human preference.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=624&amp;height=360&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png" title="" width="624" height="360" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=312&amp;height=180&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 312w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=624&amp;height=360&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 624w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=936&amp;height=540&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 936w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=1248&amp;height=720&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 1248w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=1560&amp;height=900&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 1560w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png?width=1872&amp;height=1080&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-1380-PM.png 1872w" sizes="(max-width: 624px) 100vw, 624px"/></p>
<p><em>The three stages of RLHF</em></p>
<p>The complexity of the ChatGPT model which comes from the introduction of reinforcement learning will bring more model calls. For example, using PPO algorithm based on Actor-Critic (AC) structure, we need to conduct forward inference and back-propagation of Actor and Critical models, as well as multiple forward inference of supervised fine-tuning model and reward model during training. Regarding the paper of InstructGPT, which’s the basis of ChatGPT, Actor and the supervised fine-tuning model both use the GPT-3 series model with 175 billion parameters, while the critical and reward models use the GPT-3 series model with 6 billion parameters.</p>
<p>With such a large number of model parameters, <strong>to start the original ChatGPT training process</strong> requires thousands of GB of GPU memory, which is obviously far beyond the capacity of a single GPU, and the common data parallel technology is also not enough. However, even if tensor parallelism and pipelining parallelism are introduced to partition parameters, <strong>at least 64 80GB A100 GPU</strong> are still required as the hardware basis.What’s worse, pipelining is not suitable for AIGC&#39;s generative tasks because of its complexity and efficiency due to its bubble and scheduling. Stage 3 involves the complex reinforcement learning and training process of four models, which further brings difficulties and challenges for ChatGPT&#39;s code reproduction.</p>
<h2>Low-cost replication of ChatGPT training process using Colossal-AI</h2>
<p>Colossal-AI replicates the basic process of ChatGPT training in an open source way, including stage 1 pre-training, stage 2 reward model training, and stage 3 reinforcement learning training, the most complicated stage in the process.</p>
<p>Additionally, Colossal-AI greatly reduces the GPU memory overhead of ChatGPT training by using ZeRO, Gemini, LoRA, AutoChunk memory management, etc. It <strong>only requires half the hardware resources to start 175 billion parameter model training </strong>(from 64 cards to 32 cards), significantly reducing the cost of ChatGPT-style applications. With the same hardware resources mentioned above, Colossal-AI is able to train in less time, saving training costs and accelerating product iterations.</p>
<p>To allow more developers to run through ChatGPT training process, in addition to the original 175 billion parameter version, Colossal-AI also provides efficient <strong>single GPU, stand-alone 4/8-GPUs ChatGPT-like versions </strong>to reduce hardware restrictions.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=855&amp;height=235&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png" title="" width="855" height="235" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=428&amp;height=118&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 428w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=855&amp;height=235&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 855w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=1283&amp;height=353&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 1283w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=1710&amp;height=470&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 1710w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=2138&amp;height=588&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 2138w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png?width=2565&amp;height=705&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-1.png 2565w" sizes="(max-width: 855px) 100vw, 855px"/></p>
<p>On a single multi-GPUs server, even with the highest-end A100 80GB GPU, PyTorch can only launch ChatGPT based on small models like GPT-L (774M), due to the complexity and memory fragmentation of ChatGPT. Hence, multi-GPUs parallel scaling to 4 or 8 GPUs with PyTorch&#39;s DistributedDataParallel (DDP) results in limited performance gains.</p>
<p>Colossal-AI not only has significant training and inference advantages in the speedup on single GPU, but can be further improved as parallelism scales up, up to <strong>7.73 times faster</strong> for single server training and 1.42 times faster for single-GPU inference, and is able to continue to scale to large scale parallelism, <strong>significantly reducing the cost of ChatGPT replication</strong>.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=606&amp;height=337&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png" title="" width="606" height="337" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=303&amp;height=169&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 303w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=606&amp;height=337&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 606w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=909&amp;height=506&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 909w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=1212&amp;height=674&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 1212w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=1515&amp;height=843&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 1515w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png?width=1818&amp;height=1011&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-5123-PM.png 1818w" sizes="(max-width: 606px) 100vw, 606px"/></p>
<p>To minimize training costs and ease of use, Colossal-AI also offers a ChatGPT training process that can be tried on a single GPU. Compared to PyTorch, which can only start up to 780 million parameter models on the $14,999 A100 80GB, Colossal-AI boosts the capacity of a single GPU by <strong>10.3 times</strong> to 8 billion parameters. For ChatGPT training based on a small model with 120 million parameters, <strong>a minimum of 1.62GB of GPU memory is required</strong>, which can be satisfied by any single consumer-level GPU.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=624&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png" title="" width="624" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=312&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 312w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=624&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 624w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=936&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 936w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=1248&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 1248w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=1560&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 1560w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png?width=1872&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-4165-PM.png 1872w" sizes="(max-width: 624px) 100vw, 624px"/></p>
<p>In addition, Colossal-AI is always trying to reduce the cost of fine-tuning tasks based on pre-trained large models. For example, the fine-tuning tasks regarding ChatGPT on OPT model, Colossal-AI is able to increase the capacity of the fine-tuning model on a single GPU by up to <strong>3.7 times</strong> compared to PyTorch, while working at a <strong>sufficiently high speed</strong>.</p>
<h2>One line of code to kickstart</h2>
<p>Colossal-AI provides out-of-the-box ChatGPT training code. Users would find it easy to train the mainstream pre-trained models such as GPT, OPT and BLOOM from the Hugging Face community in ChatGPT-like method using Colossal-AI. In the case of GPT, for example, <strong>only one line of code</strong> is needed to specify the usage of Colossal-AI as a system strategy to kickstart.</p>
<pre data-line="5"><code>from chatgpt.nn import GPTActor, GPTCritic, RewardModel
from chatgpt.trainer import PPOTrainer
from chatgpt.trainer.strategies import ColossalAIStrategy

<strong>strategy = ColossalAIStrategy(stage=3, placement_policy=&#39;cuda&#39;)</strong>

with strategy.model_init_context():
    actor = GPTActor().cuda()
    critic = GPTCritic().cuda()
    initial_model = deepcopy(actor).cuda()
    reward_model = RewardModel(deepcopy(critic.model)).cuda()

trainer = PPOTrainer(strategy, actor, critic, reward_model, initial_model, ...)
trainer.fit(prompts)
</code></pre>
<p>Using the following commands, you can quickly start the training of the single-GPU scale, single machine multi-GPUs scale, the original 175-billion-parameter scale version, and have an evaluation on various performance indicators (including maximum GPU memory usage, throughput, and TFLOPS):</p>
<pre><code># Training GPT2-S using a single card, a minimum batch size, Colossal-AI Gemini CPU strategy
torchrun --standalone --nproc_pero_node 1 benchmark_gpt_dummy.py --model s --strategy colossalai_gemini_cpu --experience_batch_size 1 --train_batch_size 1
# Training GPT2-XL with a 4-GPU machine, Colossal-AI Zero2 strategy
torchrun --standalone --nproc_per_node 4 benchmark_gpt_dummy.py --model xl --strategy colossalai_zero2
# Training GPT-3 with 4 8-GPU servers, Colossal-AI Gemini CPU strategy
torchrun --nnodes 4 --nproc_per_node 8 \
 --rdzv_id=$JOB_ID --rdzv_backend=c10d --rdzv_endpoint=$HOST_NODE_ADDR \
 benchmark_gpt_dummy.py --model 175b --strategy colossalai_gemini_cpu --experience_batch_size 1 --train_batch_size 1
</code></pre>
<h2>Underlying optimization</h2>
<h3>Core system: Colossal-AI</h3>
<p>Replicating ChatGPT implementation process typically relies on Colossal-AI, a deep learning system for the big AI model era, which supports efficient and fast training and inference of large AI models based on PyTorch, and reduces the cost of large AI model deployment. Since open-source, Colossal-AI has ranked first on the GitHub Trending multiple times and has gained over 8,000 Stars. It has been chosen as the official tutorial for top AI and HPC conferences such as SC, AAAI, PPoPP and CVPR. Besides the optimizations above, Colossal-AI also provides various efficient solutions for massively parallelized and distributed training of big AI models, and has demonstrated superiority in cutting-edge models such as Stable Diffusion, OPT, and AlphaFold.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=782&amp;height=371&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png" title="" width="782" height="371" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=391&amp;height=186&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 391w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=782&amp;height=371&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 782w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=1173&amp;height=557&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 1173w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=1564&amp;height=742&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 1564w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=1955&amp;height=928&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 1955w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png?width=2346&amp;height=1113&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-8742-PM.png 2346w" sizes="(max-width: 782px) 100vw, 782px"/><em>Comparison between Colossal-AI and current major open source projects in the same period</em></p>
<p>Colossal-AI is being led by Mr. James Demmel, a Distinguished Professor at the University of California, Berkeley, and Mr. You Yang, a Presidential Young Professor at the National University of Singapore. Its solutions have been successfully applied and acclaimed by some well-known tech giants in the fields of autonomous driving, cloud computing, retail, medicine, and chips. For example, Colossal-AI has successfully helped a Fortune-500 enterprise to develop a ChatGPT-like chatbot model with enhanced online searching capabilities.</p>
<h3>Low-cost fine-tuning of LoRA</h3>
<p>Colossal-AI supports efficient fine-tuning via the Low-Rank Adaptation (LoRA) method. The method assumes that large language models are over-parameterized and the change in parameters during fine-tuning can be represented as a low-rank matrix, which can be decomposed into the product of two smaller matrices</p>
<p><img alt="" src="https://www.hpc-ai.tech/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process.png" title="" loading="lazy"/></p>
<p>With the parameters of large language models fixed, only the parameters of the decomposed matrices are being adjusted during fine-tuning; hence this method significantly reduces the amount of training parameters. To deploy for inference, the matrix product is added back to the original matrix, as<img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=111&amp;height=22&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png" title="" width="111" height="22" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=56&amp;height=11&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 56w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=111&amp;height=22&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 111w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=167&amp;height=33&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 167w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=222&amp;height=44&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 222w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=278&amp;height=55&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 278w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png?width=333&amp;height=66&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-4.png 333w" sizes="(max-width: 111px) 100vw, 111px"/>, without affecting inference latency.<img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=503&amp;height=453&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png" title="" width="503" height="453" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=252&amp;height=227&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 252w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=503&amp;height=453&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 503w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=755&amp;height=680&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 755w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=1006&amp;height=906&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 1006w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=1258&amp;height=1133&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 1258w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png?width=1509&amp;height=1359&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-47-6862-PM.png 1509w" sizes="(max-width: 503px) 100vw, 503px"/></p>
<p>​​<em>LoRA structure, we only train A and B.</em></p>
<h3>Zero+Gemini to reduce memory redundancy</h3>
<p>Colossal-AI uses Zero Redundancy Optimizer (ZeRO) to eliminate memory redundancy and enhance memory usage compared to traditional data parallelism, without compromising computational granularity and communication speed. Colossal-AI also puts forward chunk-based memory management, which further improves the performance of ZeRO. Chunk-based memory management stores consecutive sets of parameters in operational order in a continuous, evenly-partitioned memory space called chunks, for more efficient use of network bandwidth (between PCI-e and GPUs), reduced communication cost, and avoidance of potential memory fragmentation.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=624&amp;height=189&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png" title="" width="624" height="189" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=312&amp;height=95&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 312w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=624&amp;height=189&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 624w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=936&amp;height=284&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 936w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=1248&amp;height=378&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 1248w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=1560&amp;height=473&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 1560w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png?width=1872&amp;height=567&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-45-4522-PM.png 1872w" sizes="(max-width: 624px) 100vw, 624px"/></p>
<p><em>Chunk strategy</em></p>
<p>Furthermore, Colossal-AI&#39;s heterogeneous memory manager, Gemini, reduces GPU memory footprint by offloading optimizer states to CPU, allowing for simultaneous use of GPU memory and CPU memory (including CPU DRAM or NVMe SSD memory) to train larger-scale models beyond the memory limit of a single GPU.</p>
<p><img alt="" src="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=890&amp;height=241&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png" title="" width="890" height="241" loading="lazy" srcset="https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=445&amp;height=121&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 445w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=890&amp;height=241&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 890w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=1335&amp;height=362&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 1335w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=1780&amp;height=482&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 1780w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=2225&amp;height=603&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 2225w, https://www.hpc-ai.tech/hs-fs/hubfs/Google%20Drive%20Integration/Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png?width=2670&amp;height=723&amp;name=Open%20source%20solution%20replicates%20ChatGPT%20training%20process-Feb-14-2023-02-23-46-2832-PM.png 2670w" sizes="(max-width: 890px) 100vw, 890px"/></p>
<p><em>Increased Model Capacity with the Same Hardware by ZeRO + Gemini</em></p>
<h2>Invitation to open-source contribution</h2>
<p>Although having open-sourced the complete algorithmic and software designs to replicate ChatGPT implementation process, for such a giant AI model, it demands more data and computing resources to actually take effect and deploy. After all, training a GPT-3 with 175 billion parameters requires millions of dollars worth of computing power. Therefore, <strong>large pre-trained models have long been owned by only a few big-tech companies</strong>.</p>
<p>Good news is that the open source community has made a few successful trials. For example, the BLOOM model of 176 billion parameters with completely open-source codes, datasets, and model weights has involved more than 250 institutions from 60 countries around the world, and more than 1,000 developers, including employees of Meta, Google, and other major companies who participated personally. The open-source text-to-image generation model Stable Diffusion that went viral a few months ago, was also a joint effort by organizations such as Stability AI, EleutherAI, LAION, etc.</p>
<p>Referring to the above successful attempts, any and all <strong>developers and partners with computing powers, datasets, models</strong> are welcome to join and build an ecosystem with Colossal-AI, making efforts towards the era of big AI models from the starting point of replicating ChatGPT!</p>
<p>You may contact us or participate in the following ways:</p>
<ol start="1">
<li>Posting an issue or submitting a PR on GitHub</li>
<li>Join Colossal-AI WeChat or Slack group to communicate</li>
<li>Check out and fill in the<a href="https://www.hpc-ai.tech/partners"> </a><a href="https://www.hpc-ai.tech/partners">cooperation proposal</a></li>
<li>Send your proposal to email contact@hpcaitech.com</li>
</ol>
<h2>GitHub Repo</h2>
<p><a href="https://github.com/hpcaitech/ColossalAI">https://github.com/hpcaitech/ColossalAI</a></p>
<h2>Reference</h2>
<p>[1]https://twitter.com/ArtificialAva/status/1623346998928723971</p>
<p>[2]https://finance.yahoo.com/news/chatgpt-on-track-to-surpass-100-million-users-faster-than-tiktok-or-instagram-ubs-214423357.html</p>
<p>[3]<span>https://blogs.microsoft.com/blog/2023/02/07/reinventing-search-with-a-new-ai-powered-microsoft-bing-and-edge-your-copilot-for-the-web/</span></p>
<p>[4]<em>https://arxiv.org/abs/2106.09685</em></p>
<p>[5]https://arxiv.org/pdf/2203.02155</p>
<p>[6]https://openai.com/blog/chatgpt/</p>
<p>[7]https://en.wikipedia.org/wiki/ChatGPT</p>
<p>[8]https://www.benzinga.com/news/23/02/30850547/bill-gates-says-chatgpt-as-big-an-invention-as-the-internet-will-make-many-office-jobs</p></span>
        </p>     
        
        
        
      </article>
    </div>

  </div>

</div>

      </div></div>
  </body>
</html>
