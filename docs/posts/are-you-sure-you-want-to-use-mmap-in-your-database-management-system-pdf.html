<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://db.cs.cmu.edu/papers/2022/p13-crotty.pdf">Original</a>
    <h1>Are you sure you want to use MMAP in your database management system? [pdf]</h1>
    
    <div id="readability-page-1" class="page"><div>
            <p>
                <i>Memory-mapped</i> (<tt>MMAP</tt>) file I/O is an OS-provided feature that
                maps the contents of a file on secondary storage into a program‚Äôs
                address space. The program then accesses pages via pointers as if
                the file resided entirely in memory. The OS transparently loads
                pages only when the program references them and automatically evicts
                pages if memory fills up.
            </p>
            <p>
                <tt>MMAP</tt>‚Äòs perceived ease of use has seduced <i>database management system</i>
                (DBMS) developers for decades as a viable alternative to
                implementing a buffer pool. There are, however, severe correctness
                and performance issues with <tt>MMAP</tt> that are not immediately apparent.
                Such problems make it difficult, if not impossible, to use <tt>MMAP</tt>
                correctly and efficiently in a modern DBMS. In fact, several popular
                DBMSs initially used <tt>MMAP</tt> to support larger-than-memory databases
                but soon encountered these hidden perils, forcing them to switch to
                managing file I/O themselves after significant engineering costs.
            </p>
            <p>
                In this way, <tt>MMAP</tt> and DBMSs are like coffee and spicy food: an
                unfortunate combination that becomes obvious after the fact.
            </p>
            <p>
                Since developers keep trying to use <tt>MMAP</tt> in new DBMSs, we wrote this
                paper to provide a warning to others that <tt>MMAP</tt> is not a suitable
                replacement for a traditional buffer pool. We discuss the main
                shortcomings of <tt>MMAP</tt> in detail, and our experimental analysis
                demonstrates clear performance limitations. Based on these findings,
                we conclude with a prescription for when DBMS developers might
                consider using <tt>MMAP</tt> for file I/O.
            </p>
            <p><small><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"> <path d="M14.5.5a.5.5 0 0 0-1 0V2H1a1 1 0 0 0-1 1v2h16V3a1 1 0 0 0-1-1h-.5V.5ZM2.5 4a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1Zm2 0a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1Zm7.5-.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm1.5.5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1Zm-7-1h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Zm-2 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm.5-1.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm6.5 1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0-1a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1Z"></path> <path d="M16 6H0v8a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V6ZM4.5 13a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Zm7 0a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"></path> </svg> Recommended Music for this Paper:</small></p>
          </div><div>
            <div>
                <h3>Citation</h3>
                <pre>@inproceedings{crotty22-mmapüí©,
  author = {Crotty, Andrew and Leis, Viktor and Pavlo, Andrew},
  title = {Are You Sure You Want to Use MMAP in Your Database Management System?},
  booktitle = {{CIDR} 2022, Conference on Innovative Data Systems Research},
  year = {2022},
}</pre>
            </div>
          </div><div>
            <h3>Acknowledgments</h3>
            <p>
                This paper is the culmination of an unhealthy, years-long obsession with the idea of developers incorrectly using mmap in their DBMSs. The authors would like to thank everyone who contributed and provided helpful feedback: <a href="https://lcy.im/">Chenyao Lou</a> (PKU), <a href="https://en.wikipedia.org/wiki/File:David_Andersen_-_Professor_Street_Urchin.jpg">David ‚ÄúGreasy‚Äù Andersen</a> (CMU), <a href="https://www.cs.cmu.edu/~kaminsky/">Michael Kaminsky</a> (BrdgAI), <a href="https://db.in.tum.de/~neumann/">Thomas Neumann</a> (TUM), <a href="https://osg.tuhh.de/People/dietrich/">Christian Dietrich</a> (TUHH), <a href="https://www.linkedin.com/in/toddlipcon/">Todd Lipcon</a> (<a href="https://lipcon.org/">lipcon.org</a>), and <a href="https://people.ece.ubc.ca/sasha/">Sasha Fedorova</a> (UBC).
            </p>
            <p>
                This work was supported (in part) by the NSF (<a href="http://www.nsf.gov/awardsearch/showAward?AWD_ID=1846158">IIS-1846158</a>, <a href="http://www.nsf.gov/awardsearch/showAward?AWD_ID=1423210">III-1423210</a>, <a href="http://www.nsf.gov/awardsearch/showAward?AWD_ID=1252522">DGE-1252522</a>), research grants from Google and Snowflake, and the <a href="https://sloan.org/grant-detail/8638">Alfred P. Sloan Research Fellowship</a> program.
            </p>
            
        </div></div>
  </body>
</html>
