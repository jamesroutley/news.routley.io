<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ekzhang/rustpad">Original</a>
    <h1>Rustpad is an efficient and minimal open-source collaborative text editor</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://hub.docker.com/r/ekzhang/rustpad/" rel="nofollow"><img src="https://camo.githubusercontent.com/0b0fe65531035430295e02ef977b5d68db9dc3d0f3c580f08fed4eddcae0cc37/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f656b7a68616e672f72757374706164" alt="Docker Pulls" data-canonical-src="https://img.shields.io/docker/pulls/ekzhang/rustpad"/></a>
<a href="https://hub.docker.com/r/ekzhang/rustpad/" rel="nofollow"><img src="https://camo.githubusercontent.com/b2d3ce804d9503f8fcbbc2026e192ece59b0577566c545922c3996200eb90719/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f696d6167652d73697a652f656b7a68616e672f727573747061642f6c6174657374" alt="Docker Image Size" data-canonical-src="https://img.shields.io/docker/image-size/ekzhang/rustpad/latest"/></a>
<a href="https://github.com/ekzhang/rustpad/actions/workflows/ci.yml"><img src="https://camo.githubusercontent.com/75873b1f4d6e2148df4cde79c3a86d3c0f30c90d8963262c3c05a33c9f5a05b8/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f656b7a68616e672f727573747061642f63692e796d6c" alt="GitHub Workflow Status" data-canonical-src="https://img.shields.io/github/actions/workflow/status/ekzhang/rustpad/ci.yml"/></a></p>
<p dir="auto"><strong>Rustpad</strong> is an <em>efficient</em> and <em>minimal</em> open-source collaborative text
editor based on the operational transformation algorithm. It lets users
collaborate in real time while writing code in their browser. Rustpad is
completely self-hosted and fits in a tiny Docker image, no database required.</p>
<p dir="auto">
<a href="https://rustpad.io/" rel="nofollow">
<img src="https://camo.githubusercontent.com/62fb8df383639dd5f3f399bbbaaff53aff9ef4c0a9981af8bbc3bab231591d42/68747470733a2f2f692e696d6775722e636f6d2f576a55355572502e706e67" width="800" data-canonical-src="https://i.imgur.com/WjU5UrP.png"/></a>
</p>
<p dir="auto">The server is written in Rust using the
<a href="https://github.com/seanmonstar/warp">warp</a> web server framework and the
<a href="https://github.com/spebern/operational-transform-rs">operational-transform</a>
library. We use <a href="https://github.com/rustwasm/wasm-bindgen">wasm-bindgen</a> to
compile text operation logic to WebAssembly code, which runs in the browser. The
frontend is written in TypeScript using <a href="https://reactjs.org/" rel="nofollow">React</a> and
interfaces with <a href="https://github.com/microsoft/monaco-editor">Monaco</a>, the text
editor that powers VS Code.</p>
<p dir="auto">Architecturally, client-side code communicates via WebSocket with a central
server that stores in-memory data structures. This makes the editor very fast,
allows us to avoid provisioning a database, and makes testing much easier. The
tradeoff is that documents are transient and lost between server restarts, or
after 24 hours of inactivity.</p>

<p dir="auto">To run this application, you need to install Rust, <code>wasm-pack</code>, and Node.js.
Then, build the WebAssembly portion of the app:</p>
<div data-snippet-clipboard-copy-content="wasm-pack build rustpad-wasm"><pre><code>wasm-pack build rustpad-wasm
</code></pre></div>
<p dir="auto">When that is complete, you can install dependencies for the frontend React
application:</p>

<p dir="auto">Next, compile and run the backend web server:</p>

<p dir="auto">While the backend is running, open another shell and run the following command
to start the frontend portion.</p>

<p dir="auto">This command will open a browser window to <code>http://localhost:5173</code>, with hot
reloading on changes.</p>

<p dir="auto">To run integration tests for the server, use the standard <code>cargo test</code> command.
For the WebAssembly component, you can run tests in a headless browser with</p>
<div data-snippet-clipboard-copy-content="wasm-pack test --chrome --headless rustpad-wasm"><pre><code>wasm-pack test --chrome --headless rustpad-wasm
</code></pre></div>

<p dir="auto">Although the default behavior of Rustpad is to store documents solely in memory
and collect garbage after 24 hours of inactivity, this can be configured by
setting the appropriate variables. The application server looks for the
following environment variables on startup:</p>
<ul dir="auto">
<li><code>EXPIRY_DAYS</code>: An integer corresponding to the number of days that inactive
documents are kept in memory before being garbage collected by the server
(default 1 day).</li>
<li><code>SQLITE_URI</code>: A SQLite connection string used for persistence. If provided,
Rustpad will snapshot document contents to a local file, which enables them to
be retained between server restarts and after their in-memory data structures
expire. (When deploying a Docker container, this should point to the path of a
mounted volume.)</li>
<li><code>PORT</code>: Which local port to listen for HTTP connections on (defaults to 3030).</li>
<li><code>RUST_LOG</code>: Directives that control application logging, see the
<a href="https://docs.rs/env_logger/#enabling-logging" rel="nofollow">env_logger</a> docs for more
information.</li>
</ul>

<p dir="auto">Rustpad is distributed as a single 6 MB Docker image, which is built
automatically from the <code>Dockerfile</code> in this repository. You can pull the latest
version of this image from Docker Hub. It has multi-platform support for
<code>linux/amd64</code> and <code>linux/arm64</code>.</p>
<div data-snippet-clipboard-copy-content="docker pull ekzhang/rustpad"><pre><code>docker pull ekzhang/rustpad
</code></pre></div>
<p dir="auto">(You can also manually build this image with <code>docker build -t rustpad .</code> in the
project root directory.) To run locally, execute the following command, then
open <code>http://localhost:3030</code> in your browser.</p>
<div data-snippet-clipboard-copy-content="docker run --rm -dp 3030:3030 ekzhang/rustpad"><pre><code>docker run --rm -dp 3030:3030 ekzhang/rustpad
</code></pre></div>
<p dir="auto">We deploy a public instance of this image using <a href="https://fly.io/" rel="nofollow">Fly.io</a>.</p>

<ul dir="auto">
<li><strong>July 11, 2021:</strong> Featured in
<a href="https://console.substack.com/p/console-61" rel="nofollow">Console 61 - The open-source newsletter</a>.</li>
<li><strong>June 5, 2021:</strong> Front-page
<a href="https://news.ycombinator.com/item?id=27408326" rel="nofollow">Hacker News post</a>. Reddit
discussions in <a href="https://www.reddit.com/r/rust/comments/nt4p9f/" rel="nofollow">r/rust</a> and
<a href="https://www.reddit.com/r/programming/comments/nt4ws7/" rel="nofollow">r/programming</a>.</li>
</ul>
</article></div></div>
  </body>
</html>
