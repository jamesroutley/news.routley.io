<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hkust-nlp.notion.site/simplerl-reason">Original</a>
    <h1>Emerging reasoning with reinforcement learning</h1>
    
    <div id="readability-page-1" class="page"><div><p id="18439bdc-1c6b-80c7-832a-f833e2497347"><strong><a href="https://github.com/Zeng-WH">Weihao Zeng</a></strong><span data-token-index="0" contenteditable="false"><span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo>âˆ—</mo></msup></mrow><annotation encoding="application/x-tex">^*</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>âˆ—</span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span><mark><strong>,</strong></mark><strong> </strong><strong><a href="https://hyz17.github.io">Yuzhen Huang</a></strong><span data-token-index="0" contenteditable="false"><span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo>âˆ—</mo></msup></mrow><annotation encoding="application/x-tex">^*</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>âˆ—</span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span><mark><strong>,</strong></mark><strong> </strong><strong><a href="https://vpeterv.github.io">Wei Liu</a></strong><mark><strong>, Keqing He,</strong></mark><strong> </strong><strong><a href="https://siviltaram.github.io">Qian Liu</a></strong><mark><strong>, </strong></mark><mark><strong><a href="https://scholar.google.com/citations?hl=zh-CN&amp;authuser=1&amp;user=XwY9LXoAAAAJ">Zejun Ma</a></strong></mark><mark><strong>,</strong></mark><strong> </strong><strong><a href="https://jxhe.github.io">Junxian He</a></strong><span data-token-index="0" contenteditable="false"><span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo>âˆ—</mo></msup></mrow><annotation encoding="application/x-tex">^*</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>âˆ—</span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span></p><p id="18439bdc-1c6b-80a0-a64e-c5d2664e1801"><span data-token-index="0" contenteditable="false"><span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo>âˆ—</mo></msup></mrow><annotation encoding="application/x-tex">^*</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>âˆ—</span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>: Project lead</p><p id="18439bdc-1c6b-8029-a4c9-cd73db226bd8">Github: <a href="https://github.com/hkust-nlp/simpleRL-reason">https://github.com/hkust-nlp/simpleRL-reason</a></p><p id="18639bdc-1c6b-8076-8621-fe0dd70e8c21">â€” Jan 25, 2025</p><figure id="18339bdc-1c6b-8026-b505-f95ce29031c0"><p><span>ðŸ’¡</span></p><div><p id="18339bdc-1c6b-8016-b6a4-ea99cf7d529a">This blog will present a replicate of the  <a href="https://github.com/deepseek-ai/DeepSeek-R1">DeepSeek-R1-Zero and DeepSeek-R1</a> training on small models with limited data, <mark>many of the experiments were developed and performed by us independently before DeepSeek-R1â€™s release</mark><mark>.</mark> <strong>We show that long Chain-of-Thought (CoT) and self-reflection can emerge on a 7B model with only 8K MATH examples, and we achieve surprisingly strong results on complex mathematical reasoning.</strong>  Importantly, we fully open-source our training code and details to the community to inspire more works on reasoning.</p><p id="18439bdc-1c6b-80b7-89e3-c649a2cb5ebd">Starting from Qwen2.5-Math-7B (base model), we perform reinforcement learning on it directly with only 8K examples from the MATH dataset. <strong>No reward model, no SFT,</strong><strong> just 8K MATH examples for verification, the resultant model achieves (pass@1 accuracy) 33.3% on AIME, 62.5% on AMC, and 77.2% on MATH, outperforming Qwen2.5-math-7B-instruct and being comparable to </strong><strong><a href="https://github.com/PRIME-RL/PRIME">PRIME</a></strong><strong> and </strong><strong><a href="https://arxiv.org/abs/2501.04519">rStar-MATH</a></strong><strong> that use &gt;50x more data and more complicated </strong><strong>components. </strong>We also try performing a long CoT SFT with the same 8K examples before the RL stage and obtain even better performance.</p></div></figure><figure id="18639bdc-1c6b-807e-9894-ecc5f144fc06"><p><span>ðŸ‘‰</span></p><p id="18639bdc-1c6b-80b5-841c-df8c2c226897">Many of our experiments were completed prior to the release of DeepSeek-R1. Interestingly, we independently converged on a similar and straightforward RL approach as DeepSeek-R1, finding it to be highly effective. The primary difference lies in our use of PPO instead of GRPO. While this research is still ongoing, we believe it is valuable to share our intermediate findings with the community. We hope our work serves as a simple yet effective replication of DeepSeek-R1 Zero and DeepSeek-R1, tailored for smaller models and limited datasets.</p></figure><nav id="18439bdc-1c6b-8099-8898-e8d898fd8bae"></nav><figure id="18639bdc-1c6b-8096-911d-d5692b1b883e"><a href="https://hkust-nlp.notion.site/image/attachment%3A55e42b69-8668-4d88-9e27-7af252642994%3Aimage_(7).png?table=block&amp;id=18639bdc-1c6b-8096-911d-d5692b1b883e&amp;userId=&amp;cache=v2"><img src="https://hkust-nlp.notion.site/image/attachment%3A55e42b69-8668-4d88-9e27-7af252642994%3Aimage_(7).png?table=block&amp;id=18639bdc-1c6b-8096-911d-d5692b1b883e&amp;userId=&amp;cache=v2"/></a><figcaption>Training dynamics of our Qwen2.5-SimpleRL-Zero training starting from the Qwen2.5-Math-7B base model, without SFT or reward models. The average benchmark accuracy and length are on 8 complex math reasoning benchmarks. We observe a length decrease in the initial stage because we found the Qwen2.5-Math-7B base model tended to generate both language and code in the response, resulting in lengthy outputs. This default pattern is quickly discouraged throughout RL and the model learns to output in a more appropriate format, and then the length starts to increase regularly. After just a few training steps, we also experienced the &#34;aha moment&#34; described in the DeepSeek-R1 paper â€” the emergence of self reflection in the model&#39;s responses.</figcaption></figure><p id="18439bdc-1c6b-809e-97e4-e0b283fe1674">Many researchers are exploring possible paths towards learning o-style models, such as distillation, MCTS, process-based reward models, and reinforcement learning. Recently, both <a href="https://github.com/deepseek-ai/DeepSeek-R1">DeepSeek-R1</a> and <a href="https://github.com/MoonshotAI/Kimi-k1.5">Kimi-k1.5</a> demonstrate an extremely simple recipe on this path, using simple RL algorithms to learn emerging long CoT and self-reflection patterns and leading to strong results, where no MCTS and reward models are used. However, their experiments are based on  huge models in a large-scale RL setting. It remains unknown whether small models can demonstrate similar behaviors, how much data is needed, and how would the quantitative results compare with other approaches. This blog reproduces the training of DeepSeek-R1-Zero and DeepSeek-R1 for complex mathematical reasoning, <strong>starting from Qwen-2.5-Math-7B (base model), and only using 8K (query, final answer) examples from </strong><strong>the original MATH dataset</strong><strong> for rule-based reward modeling in RL.</strong> We are surprised how far the 8K MATH examples lift this 7B base model without any other external signals:</p><p id="18639bdc-1c6b-809f-b911-e823c611ee1e"><em><strong>All re</strong></em><em><strong>sults are in pass@1 accuracy</strong></em> </p><table id="18639bdc-1c6b-8013-9366-de36509b9f27"><tbody><tr id="18639bdc-1c6b-8024-bbfd-c34c06004d26"><td id="GUpp"></td><td id="j\T{">AIME 2024</td><td id="Q`Ks">MATH 500</td><td id="Z@Xd">AMC</td><td id="A:yD">Minerva Math</td><td id="GDG&gt;">OlympiadBench</td><td id="@BQx">Avg.</td></tr><tr id="18639bdc-1c6b-80fa-b12e-d7077e9411f9"><td id="GUpp">Qwen2.5-Math-7B-Base</td><td id="j\T{">16.7</td><td id="Q`Ks">52.4</td><td id="Z@Xd">52.5</td><td id="A:yD">12.9</td><td id="GDG&gt;">16.4</td><td id="@BQx">30.2</td></tr><tr id="18639bdc-1c6b-8019-a48b-deac60131cd9"><td id="GUpp">Qwen2.5-Math-7B-Base + 8K MATH SFT</td><td id="j\T{">3.3</td><td id="Q`Ks">54.6</td><td id="Z@Xd">22.5</td><td id="A:yD">32.7</td><td id="GDG&gt;">19.6</td><td id="@BQx">26.5</td></tr><tr id="18639bdc-1c6b-80ee-b367-fd3fddf6e2a1"><td id="GUpp">Qwen-2.5-Math-7B-Instruct</td><td id="j\T{">13.3</td><td id="Q`Ks">79.8</td><td id="Z@Xd">50.6</td><td id="A:yD">34.6</td><td id="GDG&gt;">40.7</td><td id="@BQx">43.8</td></tr><tr id="18639bdc-1c6b-8099-89dc-d7ba3c3e0a49"><td id="GUpp">Llama-3.1-70B-Instruct</td><td id="j\T{">16.7</td><td id="Q`Ks">64.6</td><td id="Z@Xd">30.1</td><td id="A:yD">35.3</td><td id="GDG&gt;">31.9</td><td id="@BQx">35.7</td></tr><tr id="18639bdc-1c6b-80ab-92f7-e3e54932c5d3"><td id="GUpp">rStar-Math-7B</td><td id="j\T{">26.7</td><td id="Q`Ks">78.4</td><td id="Z@Xd">47.5</td><td id="A:yD">-</td><td id="GDG&gt;">47.1</td><td id="@BQx">-</td></tr><tr id="18639bdc-1c6b-804d-9570-d4de1b3a95d9"><td id="GUpp">Eurus-2-7B-PRIME</td><td id="j\T{">26.7</td><td id="Q`Ks">79.2</td><td id="Z@Xd">57.8</td><td id="A:yD">38.6</td><td id="GDG&gt;">42.1</td><td id="@BQx">48.9</td></tr><tr id="18639bdc-1c6b-803a-9d5f-c187b947186a"><td id="GUpp">Qwen2.5-7B-SimpleRL-Zero</td><td id="j\T{">33.3</td><td id="Q`Ks">77.2</td><td id="Z@Xd">62.5</td><td id="A:yD">33.5</td><td id="GDG&gt;">37.6</td><td id="@BQx">48.8</td></tr><tr id="18639bdc-1c6b-8056-9737-eba311110569"><td id="GUpp">Qwen2.5-7B-SimpleRL</td><td id="j\T{">26.7</td><td id="Q`Ks">82.4</td><td id="Z@Xd">62.5</td><td id="A:yD">39.7</td><td id="GDG&gt;">43.3</td><td id="@BQx">50.9</td></tr></tbody></table><p id="18639bdc-1c6b-8092-b391-ea8961fc3e22">Qwen2.5-7B-SimpleRL-Zero is the simple RL training from the base model directly, using only 8K MATH examples. It achieves gains of nearly 20 absolute points on average compared to the base model. Compared to Qwen2.5-Math-7B-Base with the same 8K data SFT, RL enjoys much better generalization being 22% higher absolutely. Moreover, Qwen2.5-7B-SimpleRL-Zero outperforms Qwen-2.5-Math-7B-Instruct on average, and is roughly comparable to the recently released <a href="https://github.com/PRIME-RL/PRIME">Eurus-2-7B-PRIME</a> and <a href="https://arxiv.org/abs/2501.04519">rStar-Math-7B</a> which are also based on Qwen-2.5-Math-7B. These baselines contain much more complicated components such as reward models and use at least 50x more and advanced data:</p><p id="18639bdc-1c6b-802e-82c4-f397e0b0d09e"><em><strong>Data c</strong></em><em><strong>omparison of different approaches</strong></em></p><table id="18639bdc-1c6b-8063-a4ad-ed7b00986974"><tbody><tr id="18639bdc-1c6b-8000-9f0f-dbb2889daea2"><td id="BhvA"></td><td id="ZIYl">Qwen2.5-Math-7B-Instruct</td><td id="@mHa">rStar-Math-7B</td><td id="B:Ez">Eurus-2-7B-PRIME</td><td id="\f~|">Qwen2.5-7B-SimpleRL-Zero</td></tr><tr id="18639bdc-1c6b-80c9-97d6-f35316145bd6"><td id="BhvA">Base Model</td><td id="ZIYl">Qwen2.5-Math-7B</td><td id="@mHa">Qwen2.5-Math-7B</td><td id="B:Ez">Qwen2.5-Math-7B</td><td id="\f~|">Qwen2.5-Math-7B</td></tr><tr id="18639bdc-1c6b-80f1-8987-f77a85f66127"><td id="BhvA">SFT Data</td><td id="ZIYl">2.5M (open-source and in-house)</td><td id="@mHa">ï½ž7.3â€‰MÂ (MATH, NuminaMath, etc.)</td><td id="B:Ez">230K</td><td id="\f~|">0</td></tr><tr id="18639bdc-1c6b-80ea-98ce-fd657667b5d5"><td id="BhvA">RM Data</td><td id="ZIYl">618K (in-house)</td><td id="@mHa">ï½ž7â€‰kÂ (in-house)</td><td id="B:Ez">0</td><td id="\f~|">0</td></tr><tr id="18639bdc-1c6b-8038-8a7c-fc656243a97f"><td id="BhvA">RM</td><td id="ZIYl">Qwen2.5-Math-RM (72B)</td><td id="@mHa">None</td><td id="B:Ez">Eurus-2-7B-SFT</td><td id="\f~|">None</td></tr><tr id="18639bdc-1c6b-804b-9fc5-f28ed8368b79"><td id="BhvA">RL Data</td><td id="ZIYl">66K queries Ã— 32 samples</td><td id="@mHa">ï½ž3.647 M Ã— 16</td><td id="B:Ez">150K queries Ã— 4 samples</td><td id="\f~|">8K queries Ã— 8 samples</td></tr></tbody></table><p id="18639bdc-1c6b-80a5-9a54-e80eebb07d8c">We are both excited and surprised by the significant gains achieved using only 8K MATH examples. Notably, <strong>while the MATH queries are considerably easier than many challenging benchmarks such as AIME and AMC, this simple RL recipe demonstrates remarkable generalization, with performance increasing by at least 10 absolute points compared to the base model</strong>. This easy-to-hard generalization effect is something we could not have envisioned with standard SFT training on the same dataset. We fully open-source our training code and details, hopefully as a strong baseline setup for the community to further explore the potential of RL for reasoning.</p></div></div>
  </body>
</html>
