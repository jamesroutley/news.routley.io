<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://doordash.engineering/2022/03/01/why-apples-new-m1-chips-are-essential-for-rapid-ios-development/">Original</a>
    <h1>Why Apple’s new M1 chips are essential for rapid iOS development</h1>
    
    <div id="readability-page-1" class="page"><div>
					<!-- wp:paragraph -->
<p>It’s never been easier to get into iOS development than it is today. The tools are largely free, and there is a plethora of quality educational content available online, including some from Apple itself. As anyone who has done iOS for a long time will tell you, there is a magical feeling of starting a new project and quickly creating something from scratch.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, as the size of a codebase increases and the number of contributing developers multiplies, that feeling of rapid progress can degrade into a slow trudge. Software development is a very iterative process, so the amount of time between making a small code change and being able to test/experience that change is very important to overall developer productivity. At DoorDash, we’ve been working to minimize this latency, keeping our development fast and our engineers happy.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We’ll talk about a few of the approaches we’re taking to increase development velocity, but the first one is also the easiest: buy your iOS engineers new M1 Max Macbook Pros!!</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>New M1 MacBooks make everything faster</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Apple released the <a href="https://www.apple.com/newsroom/2020/11/introducing-the-next-generation-of-mac/">consumer-grade M1 chips</a> in the Mac Mini and MacBook Air in late 2020 (with <a href="https://www.tomsguide.com/reviews/mac-mini-m1">impressive performance</a>), and was widely rumored to be releasing the new MacBook Pros soon after. We wanted to get ahead of the game, so we started to make a business case for upgrading our entire iOS team to these new laptops as soon as possible.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>From a business standpoint, the math is straightforward: An investment in developer productivity has a “payback period”. It’s simply a function of the expected time savings and the engineering cost. Instead of recovering the investment in dollars, it can be recovered in engineering time that would have been otherwise lost. In our case, that required estimating how much time these new laptops would likely save the average engineer each day and multiplying out appropriately.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Based on rough usage patterns, we assumed an average iOS engineer does around five clean builds and 30 incremental builds each day... We multiply that by our average build times to get a sense for how much time each engineer spends “waiting for the compiler” each day. A certain <a href="https://xkcd.com/303/">xkcd comic</a> comes to mind.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Similarly, we needed to measure how much faster the new laptops are, to calculate time saved. Doing this in advance of the hardware being available, we had to do some guesstimates based off of the consumer-grade chips as well as Apple’s marketing information—with a bit of a haircut applied.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In our case, we were able to estimate that upgrading an iOS engineer would result in about 35 minutes of “saved time” each and every day. Multiplying that by the average cost of employing an iOS engineer, we found a “payback period” of less than two months!</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":6787,"sizeSlug":"large","linkDestination":"none","className":"is-style-default"} -->
<figure><img src="https://doordash.engineering/wp-content/uploads/2022/02/upgrade-laptop-11-1024x582.jpg" alt=""/><figcaption><em>Figure 1: Plotting the cost of “time spent compiling” of the old vs. new laptops shows the one-time cost of the hardware upgrade quickly pays for itself.</em></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Importantly, this rough napkin math was so overwhelmingly positive that we didn’t need to account for a bunch of the less-obvious or harder-to-measure advantages from these faster machines. For example, we didn’t quantitatively take into account how engineers would be less frustrated, how Xcode would be more responsive, that auto-complete would work faster, or that there would be reduced context-switching while waiting for compile times.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With a solid business case, we placed an order to upgrade all current and upcoming iOS engineers to a 16-inch MacBook Pro with M1 Max and 64 GB RAM. </p>
<!-- /wp:paragraph -->

<!-- wp:shortcode -->

						<div id="subscribeform1">
							<h4>Subscribe for weekly updates</h4>
							
						</div>

<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2>What are the actual results?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Fast forward a couple of months, and we’ve finally got our first shipment of these new machines. We wasted no time setting up a side-by-side build speed comparison between the new and old laptops and eagerly awaited the results.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":6788,"sizeSlug":"large","linkDestination":"none","className":"is-style-default"} -->
<figure><img src="https://doordash.engineering/wp-content/uploads/2022/02/xcode-build-12-1024x560.jpg" alt=""/><figcaption><em>Figure 2: Timing multiple “clean” builds of our benchmark project on a 2019 Intel i9 MacBook Pro and a 2021 M1 Max MacBook Pro showed consistent performance improvements.</em></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>we made in our pitch. All told, our benchmark build went from 7:46 min. to 3:48 min. That’s almost twice as fast!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Twice. As. Fast. </strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We found that to be especially impressive. If you think through what other changes you might make to a large codebase to speed it up by the same percentage — a bunch of micro optimizations that can be done here, some obsolete code to be removed there, etc.— you would not see anywhere near the same relative speedup, even with months of work.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, not everything is good news. With the strong demand for these laptops and the ongoing global supply chain issues, we have yet to receive the replacement laptops for all of our engineers—but they’re en route. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>How else to speed up compile times?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Even with all this extra horsepower, it still takes minutes for the average build to complete. Not terrible, but not exactly the rapid iteration we’re aiming for. And as our team and codebase continues to grow, our time spent compiling will continue to increase — probably faster than Apple can decrease it with faster laptops. So what else can we do?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can modularize our codebase. Instead of having to compile a million lines of code, we break the app down into many smaller chunks of code, mapping out the dependencies between them. Individual engineers and teams can then work on subsets of the codebase, dramatically improving development iteration speed. This is still a work in progress for us, but we’re starting to see some of the benefits and will have more to say about it in the future.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In parallel with our modularization effort, we’re also adopting new technologies like <a href="https://developer.apple.com/xcode/swiftui/">SwiftUI</a> and <a href="https://developer.apple.com/documentation/swiftui/previews-in-xcode">Xcode Previews</a>. These technologies allow us to almost entirely remove the tweak-compile-and-run loop when developing user interfaces. Instead, we can define our preview data and “live code” the actual view’s code, getting nearly instantaneous feedback right in the Xcode canvas. While this only helps “view” development, we’ve found that to be an area where the fast iteration is especially helpful.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We hope to have more articles that go into depth on these alternative methods of speeding up our iOS development so stay tuned. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":1} -->

<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>At the end of the day, if you’re doing professional development in Xcode all day, there is little doubt that upgrading to one of these new M1 MacBook Pros is a great choice. And if working in a large iOS codebase with a bunch of other passionate developers sounds interesting to you, <a href="https://boards.greenhouse.io/doordash/jobs/19450">come join us</a>. We’ll have an M1 Max MacBook Pro waiting for you.</p>
<!-- /wp:paragraph -->				</div></div>
  </body>
</html>
