<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.reversinglabs.com/blog/secure-your-development-secrets-3-essential-steps">Original</a>
    <h1>How to mitigate risk from secrets leaks</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p><img src="https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=700&amp;height=366&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg" alt="How to mitigate risk from secrets leaks — and prevent future breaches" loading="lazy" width="700" height="366" srcset="https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=350&amp;height=183&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 350w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=700&amp;height=366&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 700w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=1050&amp;height=549&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 1050w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=1400&amp;height=732&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 1400w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=1750&amp;height=915&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 1750w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/How-to-mitigate-risk-from-secrets-leaks-.jpg?width=2100&amp;height=1098&amp;name=How-to-mitigate-risk-from-secrets-leaks-.jpg 2100w" sizes="(max-width: 700px) 100vw, 700px"/></p>
<p>Leaks and exposures of sensitive information in open source and proprietary code repositories are approaching epidemic proportions. Hardly a week goes by without reports of attacks on firms that leverage credentials, tokens or signing keys found lurking in code repositories. </p>
<!--more-->
<p>There were more than 10 million secrets leaked to the GitHub source code repository in 2022 — and one in 10 GitHub code authors exposed a secret in 2022, said the recent <a href="https://blog.gitguardian.com/the-state-of-secrets-sprawl-2023/"><span>State of Secrets Sprawl Report</span></a><span>,</span><a href="https://blog.gitguardian.com/the-state-of-secrets-sprawl-2023/"><span> </span></a>released by the firm GitGuardian. The prevalence of sensitive information in code repositories has <a href="https://www.reversinglabs.com/blog/the-state-of-software-supply-chain-security" rel="noopener">turned platforms like GitHub and PyPI in recent years from developer playgrounds with a low risk profile, to popular hunting grounds</a> for ransomware gangs, nation-state actors and other malicious groups looking for an unobstructed path into sensitive IT environments. </p>
<p>ReversingLabs also tracks sensitive information detected in analyzed packages. To date, its automated systems have detected more than 112,000 exposed secrets in packages in the npm repository, more than 30,000 in the Python Package Index (PyPI) and more than 10,000 in the RubyGems open source repository. Affected packages are concentrated on popular platforms such as Microsoft’s Azure, Google Cloud, GitHub, Slack, and Salesforce. Other exposed access credentials include OAuth tokens, JSON Web Tokens (JWT), and thousands more. </p>
<p><strong><img src="https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=2646&amp;height=1593&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png" alt="RL Secrets by Service and Platform v2" loading="lazy" width="2646" height="1593" srcset="https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=1323&amp;height=797&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 1323w, https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=2646&amp;height=1593&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 2646w, https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=3969&amp;height=2390&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 3969w, https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=5292&amp;height=3186&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 5292w, https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=6615&amp;height=3983&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 6615w, https://www.reversinglabs.com/hs-fs/hubfs/RL%20Secrets%20by%20Service%20and%20Platform%20v2.png?width=7938&amp;height=4779&amp;name=RL%20Secrets%20by%20Service%20and%20Platform%20v2.png 7938w" sizes="(max-width: 2646px) 100vw, 2646px"/></strong><em>Figure: Secrets detected in packages residing on four major code repositories, broken down by the affected service. Source: ReversingLabs analysis.</em></p>
<p>The question is how to avoid falling victim, and how to respond should sensitive information inadvertently find its way to public repositories or otherwise be exposed. Fortunately, software development teams have several options for responding to secrets leaks and managing both short- and long-term risks. </p>
<p>Addressing the risks of secrets exposure via source code is a multi-pronged endeavor. You’ll need to <a href="https://www.reversinglabs.com/blog/introducing-new-secrets-management-capabilities-for-mitigating-software-supply-chain-risk" rel="noopener">invest in tooling to assist with secrets discovery</a>. You’ll also need to change development practices with an eye to addressing risks at the design and architecture stage, in order to minimize the risk of secrets leaks going forward.</p>
<p>Here are three essential steps that your organization should take to mitigate risk from development secrets leaks — and best practices for preventing future secrets leaks from happening.</p>
<p>[ Learn more with our special report, <a href="https://www.reversinglabs.com/secrets-exposed" rel="noopener">Secrets Exposed: <span>A Modern Guide</span></a></p>
<h2>1. Achieve situational awareness for secrets</h2>
<p>Situational awareness means discovering what secrets are hiding in your application code, understanding their purpose, and grasping who or what has permission to use those secrets. </p>
<p>Secrets discovery tools are commonplace. GitHub, CircleCI and other vendors offer free tools to scan public and private repositories, and you can find a range of tools that search for hidden authentication tokens, environmental variables, signing keys and so on. Unfortunately, secrets <span>scanning tools are often “noisy.” And they</span> uncover many leaked credentials, some of which are placeholders or decoys that offer no advantage to cyber adversaries. </p>
<p>These false positives include commonly distributed keys for testing online services or application programming interfaces (APIs), placeholder credentials for accessing network services, and so called “canary” or “honeypot” tokens that are deliberately placed in code and monitored to alert security teams of malicious activity. However, data collected from observations of canary tokens deployed in the wild also suggest that the grace period to respond for organizations that accidentally publish secrets to public repositories can be measured in minutes, or even seconds - so speed is of the essence. </p>
<p>Organizations need to invest in tooling that can filter out that noise and <a href="https://www.reversinglabs.com/blog/introducing-new-secrets-management-capabilities-for-mitigating-software-supply-chain-risk" rel="noopener">allow staff to zero in on instances of active tokens and secrets that have been leaked</a>. And prioritizing leaked credentials based on the level of access they provide is key. </p>
<h2>2. Rotate exposed secrets</h2>
<p>In the context of a secrets leak, development teams must work alongside security incident response teams to quickly understand how severe an exposure is.</p>
<p>You should assume that any exposed secrets, including authentication credentials, API tokens, and encryption keys, have been discovered and immediately suspend and reissue them. Hardcoded credentials should, at a minimum, be updated to deny adversaries access. In the medium term, you should rotate those credentials out of your code altogether. </p>
<p>Determining which secrets have been discovered and exploited and the level of access they provide is a different matter. That requires mapping credentials back to IT assets and data, as well as scrutinizing the logs maintained by access management systems to spot use of the leaked credentials. Finally, organizations need to tie back any activity involving the exposed secret to a source to determine whether it is authorized, suspicious or malicious. Scrutinizing exposed credentials in this way is key, said Karlo Zanki, a threat researcher at ReversingLabs. </p>
<blockquote>
<p><em> “You need to see if the credentials were discovered and used by a remote or untrusted source.&#34;</em></p>
</blockquote>
<p>Any suspicious activity connected with the exposed secret should prompt the team to further investigate what users and IT assets may be affected. Supply chain attacks that leverage leaked or stolen secrets, environment variables, and other sensitive data are often the first step toward larger, targeted attacks. </p>
<p>The length of time between when secrets are exposed and when they’re discovered by the affected organization figures heavily into the severity of the incident. SSH Keys or AWS tokens that are inadvertently published to a public repository and immediately detected and revoked pose little risk to protected systems and data. </p>
<p>At the other end of the spectrum are <a href="https://www.reversinglabs.com/blog/leaky-app-exposes-toyota-supplier-network" rel="noopener">leaks like the one associated with Toyota Motor Corp.’s T-Connect telematics application</a>. In this case, a contractor accidentally published T-Connect source code to a public GitHub repository that included a Toyota database access token. That leak went undetected for five years, during which time the access token was never rotated. After the lapse was discovered, Toyota was<a href="https://www.reuters.com/technology/toyota-says-information-about-296000-users-its-t-connect-service-leaked-2022-10-07/" rel="noopener" target="_blank"><span> forced to admit</span></a> that “third-party access could not be confirmed from the access history of the data server where the information was stored” and that information on close to 300,000 T-Connect users may have been accessed during that period. </p>
<p>Even secrets leaks that are quickly remediated are cause for some concern. Malicious actors don’t need years to discover and make use of stolen secrets. The CircleCI secrets exposure lasted only a matter of weeks, but several of its customers were victimized after secrets and credentials were pilfered from private code repositories they hosted on CircleCI’s platform, the company indicated.</p>
<p>Also, in 2019 the cloud security vendor Imperva <a href="https://krebsonsecurity.com/2019/08/cybersecurity-firm-imperva-discloses-breach/"><span>admitted that it spilled email addresses, passwords, SSL certificates and API keys</span></a> for some of its customers after malicious actors found an improperly configured cloud computing server used for testing was accessible from the public Internet. A stolen API key was subsequently used to access the company&#39;s customer data. </p>
<p>That’s why, in addition to rotating exposed secrets, organizations should check to ensure that they haven’t found their way into the hands of cybercriminal groups or malicious actors. Using tools that provide <a href="https://www.reversinglabs.com/detect-prioritize-manage-exposed-secrets-in-software" rel="noopener">automated scanning for secrets in open source packages, third party libraries, commercial applications</a> and elsewhere can help organizations maintain situational awareness by following the path of leaked and stolen credentials on the digital underground. </p>
<h2>3. Manage your secrets going forward</h2>
<p>Whether development secrets exposures are detected during an audit or in response to a leak, your organization will eventually need to move past the situational awareness and crisis phase of secrets management. Your focus should then turn to managing development secrets in a responsible manner going forward. “Each company that does software development should have clear rules for handling and incorporating secrets into code, and they need to communicate that process and the rules to developers,” said Zanki of ReversingLabs.</p>
<p>Here are secrets best practices every organization should take to protect features.</p>
<h2>Stop hard-coding secrets</h2>
<p>Removing high value/high risk hard-coded secrets from application code should be at the top of your list of rules and policies. You can achieve this in several ways. The most common is to closely audit code and, where appropriate, require developers to manage high-value secrets using secret management vaults, rather than simply embedding them in code. In this way, applications can access secrets in separate files that can be isolated from the application code, provided only when needed during runtime, and left out of code builds. </p>
<p>Also, removing things like certificates, keys, tokens and credentials utilized for automated code testing can help eliminate “noise,” making it easier for your organization to identify and track exposed secrets that are a real threat.  </p>
<p>Finally, to avoid inadvertent leaks during builds, development organizations should establish policies and processes that require developers to inform those who write and maintain configuration files about the location of any secrets so that, where appropriate, they can add those files to a list that will exclude them from build packages. </p>
<h2>Promote developer best practices — and monitor compliance</h2>
<p>Given the pressure of modern, agile development organizations, there are powerful incentives for developers not to address issues such as stored secrets, which may appear - to them - to be remote risks. “If I develop something and it works, I won’t want to touch it any more,” said Zanki. “Either I forget about the access token or I just choose not to fix it because it&#39;s not important to me.” </p>
<p>DevOps organizations need to account for those negative incentives and promote behaviors that limit the security risk posed by secrets. Even experienced developers, when under pressure to deliver, can make mistakes or lapses in judgment that expose credentials, tokens and other development secrets.</p>
<p>What is clear is that secret leaks are more likely to occur in development organizations that lack clear guidelines for how to properly manage secrets in their code. DevOps teams should formulate policies based on an understanding of how secrets are generated within their development environment; how those secrets are protected once deployed; and how (hopefully) they are eventually cycled out of use. </p>
<p>Practically speaking, the division of labor within modern DevOps organizations leaves different individuals responsible for managing GIT operations and overseeing builds. Managing secrets may, likewise, require someone specifically tasked with that responsibility. Whatever the case, the days of leaving it to individual developers to track and manage their own secrets in code are over. </p>
<h2>Revamp how you design applications</h2>
<p>Get your team to design applications in a way that eliminates the reliance on access tokens that reside in code. There are several design steps developers can take to avoid storing credentials and other secrets in their code. Those include using technologies like <a href="https://developer.okta.com/blog/2017/07/25/oidc-primer-part-1"><span>OAuth OpenID Connect (OIDC) tokens</span></a>, that allow developers to authenticate users without directly exposing user credentials in code. </p>
<p>Taking steps to strengthen authentication security within applications is also critical. Using multi-factor authentication, leveraging identity and access management platforms, and setting IP ranges that limit inbound connections for APIs to known addresses or address ranges can reduce the risk that exposed secrets will be abused by malicious actors.</p>
<h2>Establish end-to-end security</h2>
<p>Finally, take steps to ensure that efforts to search for and prevent secret leaks don’t end with code scanning, but encompass the entire development pipeline. <a href="https://develop.secure.software/its-not-a-secret-if-you-publish-it-on-pypi"><span>Misconfigurations in CI/CD tooling </span></a>or developer oversight can result in the inclusion of secrets during final builds, even when DevOps teams have taken steps to protect them.  </p>
<p>Organizations also should implement binary analysis as part of the standard build-and-release pipeline in order to extend visibility into leaked secrets beyond raw code and into software packages and containers that are ready for release. This capability can expose secrets disclosed as a result of build or packaging mistakes that might otherwise escape notice during a code audit. </p>
<h2>Secrets protection requires a holistic approach</h2>
<p>Unfortunately, there is no “silver bullet” fix for software supply chain risks and attacks, nor for development secrets leaks and exposures. Instead, development organizations need to respond to actual or potential leaks holistically. Begin by understanding the scope of the problem, proceed to addressing the short-term risks posed by leaked credentials, and then extend your efforts out to larger changes in application design and development processes with an eye toward snuffing out secrets leaks — and the supply chain attacks that often follow — before they can happen.</p>
<p>[ Learn more with our special report, <a href="https://www.reversinglabs.com/secrets-exposed" rel="noopener">Secrets Exposed: <span>A Modern Guide</span></a></p></span></p>

<ul>
<li>Tags: </li>  
<li><a href="https://www.reversinglabs.com/blog/tag/software-supply-chain-security">Software Supply Chain Security</a></li>
<li><a href="https://www.reversinglabs.com/blog/tag/secrets-security">Secrets Security</a></li>
<li><a href="https://www.reversinglabs.com/blog/tag/rsac2023">RSAC2023</a></li>
</ul>
</div></div>
  </body>
</html>
