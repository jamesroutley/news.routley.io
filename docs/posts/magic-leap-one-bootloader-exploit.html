<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/EliseZeroTwo/ml1hax">Original</a>
    <h1>Magic Leap One Bootloader Exploit</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">

<p dir="auto">This repository contains a (messy) implementation of my research of exploiting the Magic Leap One.</p>
<p dir="auto">I will add writeups eventually, but for now, I just wanted to publish my code and give a simple explanation.</p>
<p dir="auto">The <code>fastbooted</code> folder contains the code that runs on the Magic Leap console.</p>
<p dir="auto">The <code>fastbootrs</code> folder contains a Rust implementation of a Fastboot client, and is the code that runs on the host.</p>
<p dir="auto"><code>SHA256(ML1 SBK)=25861920c4b750caaa851de7f92edbcf5fa3dfc396c54a871edff250ada8aa97</code></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/EliseZeroTwo/ml1hax/blob/main/images/success.jpg"><img src="https://github.com/EliseZeroTwo/ml1hax/raw/main/images/success.jpg" alt="Success"/></a></p>

<p dir="auto">This repository contains implementations of two vulns:</p>
<ol dir="auto">
<li>Code Execution in CBoot over Fastboot USB by smashing the stack in NVidia&#39;s SparseFS parser (<code>sparsehax</code>)</li>
<li>Overwriting CBoot in memory using an oversized <code>kernel-dtb</code> implementation on the storage to gain persistant code execution (<code>dtbhax</code>)</li>
</ol>
<p dir="auto">Both of these may effect more than just the ML1. I&#39;ve not researched it much but there&#39;s a decent chance the <code>kernel-dtb</code> vuln can be used for persistence on the Autopilot units of certain cars using the TX2.</p>

<p dir="auto">Warning: It&#39;s your responsibility if you brick your console.</p>
<p dir="auto">You need a signed signature context (list of hashes with a small header and a signature) from a firmware update for your device (this is device unique), any partition works as long as it&#39;s for your device, I&#39;ve been using the one from the system image. Place it in <code>fastbootrs/system-sparse-sig.bin</code>.</p>
<p dir="auto">Inside the <code>fastbooted/payload</code> directory:</p>
<ol dir="auto">
<li>Copy <code>sparsehax.ld</code> to <code>ccplex.ld</code></li>
<li>Run <code>cargo build-usb-bin</code></li>
<li>Copy the generated <code>payload.bin</code> file to <code>fastbootrs/src/payload.bin</code></li>
</ol>
<p dir="auto">Put your ML1 console into Fastboot by powering it off, and holding the Vol-Down button whilst powering the console on.</p>
<p dir="auto">Inside the <code>fastbootrs</code> directory:</p>
<ol dir="auto">
<li>Run <code>cargo run --release -- exploit</code></li>
<li>Success?</li>
</ol>
<p dir="auto">If these instructions aren&#39;t clear enough, this probably is not ready for you currently.</p>

<p dir="auto">Coming soon</p>
</article></div></div>
  </body>
</html>
