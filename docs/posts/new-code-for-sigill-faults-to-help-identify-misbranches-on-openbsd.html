<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.undeadly.org/cgi?action=article;sid=20240222183703">Original</a>
    <h1>New code for SIGILL faults to help identify misbranches on OpenBSD</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Contributed by
<a href="http://www.inet6.se">Janne Johansson</a>
on <time datetime="2024-02-22T06:39:46Z">2024-02-22</time>
from the don&#39;t pee on the electric fence dept.</p>
<p>If you run recent OpenBSD on certain amd64 or aarch64 platforms, indirect branching to an &#34;unexpected&#34; location will crash your program, in order to prevent ROP attacks and similar ways to have your program execute code where it shouldn&#39;t.</p>
<p>The OpenBSD compiler will insert an extra instruction in all the places where a branch is supposed to land, and if it lands anywhere else, a CPU fault is raised and your program gets an &#34;Illegal Instruction&#34;.</p>
<p>Previously, crashes of this kind have looked more or less like any other kind of fault where code is executing random data or from random locations, but since the kernel knows when this has happened, we can make it explicit that the fault is due to missing branch target instructions, which will help a lot when debugging.</p>
<p>Link to the commit <a href="https://marc.info/?l=openbsd-cvs&amp;m=170853069811439&amp;w=2">here</a>.</p>


</div></div>
  </body>
</html>
