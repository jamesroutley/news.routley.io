<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/kevinslin/safe-npm">Original</a>
    <h1>Show HN: Safe-NPM – only install packages that are &#43;90 days old</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A security-focused npm installer that protects your projects from newly compromised packages.</p>

<p dir="auto">Supply chain attacks on npm packages are a growing threat. Attackers sometimes compromise legitimate packages by:</p>
<ul dir="auto">
<li>Stealing maintainer credentials</li>
<li>Publishing malicious updates to popular packages</li>
<li>Taking over abandoned packages</li>
</ul>
<p dir="auto">These attacks often happen suddenly—a package that was safe yesterday might be compromised today. <strong>safe-npm</strong> protects you by only installing package versions that have been publicly available for a minimum amount of time (90 days by default). This gives the security community time to discover and report malicious releases before they reach your project.</p>

<p dir="auto">When you run <code>safe-npm install</code>, it:</p>
<ol dir="auto">
<li>Reads your dependencies from <code>package.json</code> or command-line arguments</li>
<li>Queries the npm registry to find all available versions</li>
<li>Filters out versions published more recently than your minimum age threshold</li>
<li>Selects the newest version that meets both your semver requirements AND age requirements</li>
<li>Installs the safe versions using npm</li>
</ol>
<p dir="auto">For example, if you specify <code>react@^18</code> and a malicious <code>react@18.5.0</code> was published yesterday, safe-npm will install the latest version that&#39;s at least 90 days old instead.</p>

<div dir="auto"><h3 tabindex="-1" dir="auto">Install from npm (recommended)</h3><a id="user-content-install-from-npm-recommended" aria-label="Permalink: Install from npm (recommended)" href="#install-from-npm-recommended"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Install globally
npm install -g @dendronhq/safe-npm

# Now you can use it anywhere
safe-npm install"><pre><span><span>#</span> Install globally</span>
npm install -g @dendronhq/safe-npm

<span><span>#</span> Now you can use it anywhere</span>
safe-npm install</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Clone and build
git clone &lt;repository-url&gt;
cd safe-npm
npm install
npm run build

# Link the binary globally
npm link"><pre><span><span>#</span> Clone and build</span>
git clone <span>&lt;</span>repository-url<span>&gt;</span>
<span>cd</span> safe-npm
npm install
npm run build

<span><span>#</span> Link the binary globally</span>
npm link</pre></div>

<div dir="auto"><h3 tabindex="-1" dir="auto">Install dependencies from package.json</h3><a id="user-content-install-dependencies-from-packagejson" aria-label="Permalink: Install dependencies from package.json" href="#install-dependencies-from-packagejson"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Use the minimum age of 90 days (default)
safe-npm install

# Or specify your own minimum age
safe-npm install --min-age-days 120"><pre><span><span>#</span> Use the minimum age of 90 days (default)</span>
safe-npm install

<span><span>#</span> Or specify your own minimum age</span>
safe-npm install --min-age-days 120</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Install specific packages</h3><a id="user-content-install-specific-packages" aria-label="Permalink: Install specific packages" href="#install-specific-packages"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Install packages directly with version constraints
safe-npm install react@^18 lodash@^4.17.0

# These will be filtered to only use versions at least 90 days old
safe-npm install express --min-age-days 60"><pre><span><span>#</span> Install packages directly with version constraints</span>
safe-npm install react@^18 lodash@^4.17.0

<span><span>#</span> These will be filtered to only use versions at least 90 days old</span>
safe-npm install express --min-age-days 60</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Dry run to see what would be installed</h3><a id="user-content-dry-run-to-see-what-would-be-installed" aria-label="Permalink: Dry run to see what would be installed" href="#dry-run-to-see-what-would-be-installed"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Preview which versions would be installed without actually installing
safe-npm install --dry-run"><pre><span><span>#</span> Preview which versions would be installed without actually installing</span>
safe-npm install --dry-run</pre></div>


<p dir="auto"><strong>Default:</strong> <code>90</code></p>
<p dir="auto">The minimum number of days a package version must have been published before it can be installed.</p>
<p dir="auto"><strong>Example:</strong> <code>--min-age-days 120</code> requires packages to be at least 4 months old.</p>
<p dir="auto"><strong>When to adjust:</strong></p>
<ul dir="auto">
<li>Increase for maximum security (e.g., 180 days for critical production systems)</li>
<li>Decrease if you need newer features and accept slightly more risk (e.g., 30 days)</li>
</ul>

<p dir="auto">A comma-separated list of packages that bypass the age requirement. These packages will still respect semver ranges but ignore the minimum age.</p>
<p dir="auto"><strong>Example:</strong> <code>--ignore typescript,@types/node</code></p>
<p dir="auto"><strong>When to use:</strong></p>
<ul dir="auto">
<li>Fast-moving packages you trust (like TypeScript or build tools)</li>
<li>Internal packages from your organization</li>
<li>Packages where you need the latest features urgently</li>
</ul>

<p dir="auto">Exit with an error if ANY dependency cannot be resolved to a version meeting the age requirement.</p>
<p dir="auto"><strong>Example:</strong> <code>safe-npm install --strict</code></p>
<p dir="auto"><strong>When to use:</strong></p>
<ul dir="auto">
<li>CI/CD pipelines where you want builds to fail rather than skip problematic packages</li>
<li>Production deployments where you need certainty</li>
</ul>

<p dir="auto">Control which dependencies from <code>package.json</code> are processed.</p>
<p dir="auto"><strong>Examples:</strong></p>
<ul dir="auto">
<li><code>safe-npm install --dev</code> - Only install devDependencies</li>
<li><code>safe-npm install --prod-only</code> - Only install production dependencies</li>
</ul>
<p dir="auto"><strong>When to use:</strong></p>
<ul dir="auto">
<li>Installing development tools with stricter requirements</li>
<li>Production builds where you want different age policies for dev vs prod dependencies</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>--strategy &lt;direct|overrides&gt;</code></h3><a id="user-content---strategy-directoverrides" aria-label="Permalink: --strategy &lt;direct|overrides&gt;" href="#--strategy-directoverrides"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Default:</strong> <code>direct</code></p>
<p dir="auto">How safe-npm installs the resolved versions:</p>
<p dir="auto"><strong><code>direct</code></strong> - Directly installs the resolved versions using <code>npm install package@version</code></p>
<ul dir="auto">
<li>Simple and straightforward</li>
<li>Good for one-time installs or scripts</li>
</ul>
<p dir="auto"><strong><code>overrides</code></strong> - Writes resolved versions to <code>package.json</code> overrides field, then runs <code>npm install</code></p>
<ul dir="auto">
<li>Enforces versions across your entire dependency tree (including transitive dependencies)</li>
<li><strong>Note:</strong> This feature is currently disabled as it doesn&#39;t work correctly yet</li>
</ul>

<p dir="auto"><strong>Default:</strong> <code>https://registry.npmjs.org</code></p>
<p dir="auto">Specify an alternate npm registry.</p>
<p dir="auto"><strong>Example:</strong> <code>--registry https://registry.company.com</code></p>
<p dir="auto"><strong>When to use:</strong></p>
<ul dir="auto">
<li>Private npm registries</li>
<li>Mirrors or caches</li>
</ul>

<p dir="auto">Show what would be installed without making any changes.</p>
<p dir="auto"><strong>Example:</strong> <code>safe-npm install --dry-run</code></p>
<p dir="auto"><strong>When to use:</strong></p>
<ul dir="auto">
<li>Testing your configuration</li>
<li>Understanding what versions are available</li>
<li>Before making changes to production systems</li>
</ul>


<div dir="auto" data-snippet-clipboard-copy-content="# Create a new project
mkdir my-project &amp;&amp; cd my-project
npm init -y

# Install dependencies safely
safe-npm install express@^4 lodash

# This creates package-lock.json with versions at least 90 days old"><pre><span><span>#</span> Create a new project</span>
mkdir my-project <span>&amp;&amp;</span> <span>cd</span> my-project
npm init -y

<span><span>#</span> Install dependencies safely</span>
safe-npm install express@^4 lodash

<span><span>#</span> This creates package-lock.json with versions at least 90 days old</span></pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Audit an existing project</h3><a id="user-content-audit-an-existing-project" aria-label="Permalink: Audit an existing project" href="#audit-an-existing-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Check what versions would be installed with age requirements
safe-npm install --dry-run

# If you&#39;re happy, install them
safe-npm install"><pre><span><span>#</span> Check what versions would be installed with age requirements</span>
safe-npm install --dry-run

<span><span>#</span> If you&#39;re happy, install them</span>
safe-npm install</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# In your CI pipeline, fail the build if any package can&#39;t meet age requirements
safe-npm install --strict --min-age-days 120

# Or allow newer packages for dev dependencies only
safe-npm install --prod-only --strict"><pre><span><span>#</span> In your CI pipeline, fail the build if any package can&#39;t meet age requirements</span>
safe-npm install --strict --min-age-days 120

<span><span>#</span> Or allow newer packages for dev dependencies only</span>
safe-npm install --prod-only --strict</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Need to urgently update a specific package? Add it to ignore list
safe-npm install --ignore package-with-critical-fix"><pre><span><span>#</span> Need to urgently update a specific package? Add it to ignore list</span>
safe-npm install --ignore package-with-critical-fix</pre></div>

<p dir="auto">The project includes a test suite that you can run:</p>

<p dir="auto">For automated testing, you can mock registry responses using fixtures:</p>
<div dir="auto" data-snippet-clipboard-copy-content="export SAFE_NPM_FIXTURES=/path/to/fixtures.json
safe-npm install"><pre><span>export</span> SAFE_NPM_FIXTURES=/path/to/fixtures.json
safe-npm install</pre></div>
<p dir="auto">The fixtures file should contain JSON that mirrors npm registry responses for each package.</p>

<p dir="auto"><strong>Real-world scenario:</strong></p>
<ol dir="auto">
<li>A popular package <code>popular-lib</code> is maintained by a trusted developer</li>
<li>Attacker compromises the maintainer&#39;s npm credentials</li>
<li>Attacker publishes <code>popular-lib@5.0.0</code> with malware</li>
<li>Projects using <code>^5.0.0</code> would immediately install the malicious version</li>
<li>With safe-npm, you&#39;d keep using <code>4.9.0</code> (the latest version from 90+ days ago)</li>
<li>Security researchers discover the compromise and report it</li>
<li>The malicious version is unpublished</li>
<li>You never installed the compromised version</li>
</ol>

<ul dir="auto">
<li>Won&#39;t protect against packages that were malicious from the start</li>
<li>Delays access to legitimate new features and bug fixes</li>
<li>Requires trust that older versions don&#39;t have undiscovered vulnerabilities</li>
<li>Age-based filtering is a heuristic, not a guarantee</li>
</ul>

<p dir="auto">Security is about trade-offs. safe-npm trades bleeding-edge updates for protection against sudden supply chain compromises. It&#39;s one layer in a defense-in-depth strategy that should also include:</p>
<ul dir="auto">
<li>Regular security audits (<code>npm audit</code>)</li>
<li>Dependency review before adding new packages</li>
<li>Monitoring for security advisories</li>
<li>Using lock files to ensure reproducible builds</li>
<li>Running in sandboxed or containerized environments</li>
</ul>

<ul dir="auto">
<li>Node.js 18 or higher</li>
<li>npm (for the underlying installation)</li>
</ul>

<p dir="auto">ISC</p>
</article></div></div>
  </body>
</html>
