<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/zigzap/zap">Original</a>
    <h1>Zap ‚Äì Fast backends in Zig</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/zigzap/zap/actions/workflows/mastercheck.yml/badge.svg"><img src="https://github.com/zigzap/zap/actions/workflows/mastercheck.yml/badge.svg" alt=""/></a> <a href="https://discord.gg/jQAAN6Ubyj" rel="nofollow"><img src="https://camo.githubusercontent.com/f68dc33292a51409a5e649ae0d054c9d1ea3a964f5b566d2602808fc06b13a4d/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f313130373833353839363335363637353730363f6c6162656c3d63686174266c6f676f3d646973636f7264267374796c653d706c6173746963" alt="Discord" data-canonical-src="https://img.shields.io/discord/1107835896356675706?label=chat&amp;logo=discord&amp;style=plastic"/></a></p>
<p dir="auto">Zap is intended to become the <a href="https://ziglang.org" rel="nofollow">zig</a> replacement for the
kind of REST APIs I used to write in <a href="https://python.org" rel="nofollow">python</a> with
<a href="https://flask.palletsprojects.com" rel="nofollow">Flask</a> and
<a href="https://www.mongodb.com" rel="nofollow">mongodb</a>, etc. It can be considered to be a
microframework for web applications.</p>
<p dir="auto">What I need for that is a blazingly fast, robust HTTP server that I can use with
zig. While facil.io supports TLS, I don&#39;t care about HTTPS support. In
production, I use <a href="https://www.nginx.com" rel="nofollow">nginx</a> as a reverse proxy anyway.</p>
<p dir="auto">Zap wraps and patches <a href="https://facil.io" rel="nofollow">facil.io - the C web application
framework</a>.</p>
<p dir="auto"><strong><g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji>ZAP<g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji> IS SUPER ALPHA</strong></p>
<p dir="auto"><em>Under the hood, everything is super robust and fast. My zig wrappers are fresh,
juicy, and alpha.</em></p>
<p dir="auto">Here&#39;s what works:</p>
<ul dir="auto">
<li><strong>Super easy build process</strong>: zap&#39;s <code>build.zig</code> now uses the up-and-coming zig
package manager for its C-dependencies, no git submodules anymore.
<ul dir="auto">
<li><em>tested on Linux and macOS (arm, M1)</em></li>
</ul>
</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/hello/hello.zig">hello</a></strong>: welcomes you with some static HTML</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/routes/routes.zig">routes</a></strong>: a super easy example dispatching on
the HTTP path</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/serve/serve.zig">serve</a></strong>: the traditional static web server with
optional dynamic request handling</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/sendfile/sendfile.zig">sendfile</a></strong>: simple example of how to send
a file, honoring compression headers, etc.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/hello_json/hello_json.zig">hello_json</a></strong>: serves you json
dependent on HTTP path</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/endpoint">endpoint</a></strong>: a simple JSON REST API example featuring a
<code>/users</code> endpoint for PUTting/DELETE-ing/GET-ting/POST-ing and listing users,
together with a static HTML and JavaScript frontend to play with.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/mustache/mustache.zig">mustache</a></strong>: a simple example using
<a href="https://mustache.github.io/" rel="nofollow">mustache</a> templating.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/endpoint_auth/endpoint_auth.zig">endpoint authentication</a></strong>: a
simple authenticated endpoint. Read more about authentication
<a href="https://github.com/zigzap/zap/blob/master/doc/authentication.md">here</a>.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/http_params/http_params.zig">http parameters</a></strong>: a simple example
sending itself query parameters of all supported types.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/cookies/cookies.zig">cookies</a></strong>: a simple example sending itself a
cookie and responding with a session cookie.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/websockets">websockets</a></strong>: a simple websockets chat for the
browser.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/userpass_session_auth">Username/Password Session
Authentication</a></strong>: A convenience
authenticator that redirects un-authenticated requests to a login page and
sends cookies containing session tokens based on username/password pairs
received via POST request.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/middleware/middleware.zig">MIDDLEWARE support</a></strong>: chain together
request handlers in middleware style. Provide custom context structs, totally
type-safe, using <strong><a href="https://github.com/zigzap/zap/blob/master/doc/zig-ception.md">ZIG-CEPTION</a></strong>. If you come from GO
this might appeal to you.</li>
<li><strong><a href="https://github.com/zigzap/zap/blob/master/examples/middleware_with_endpoint/middleware_with_endpoint.zig">MIDDLEWARE with endpoint
support</a></strong>:
Same as the example above, but this time we use an endpoint at the end of the
chain, by wrapping it via <code>zap.Middleware.EndpointHandler</code>. Mixing endpoints
in your middleware chain allows for usage of Zap&#39;s authenticated endpoints and
your custom endpoints. Since Endpoints use a simpler API, you have to use
<code>r.setUserContext()</code> and <code>r.getUserContext()</code> with the request if you want to
access the middleware context from a wrapped endpoint. Since this mechanism
uses an <code>*anyopaque</code> pointer underneath (to not break the Endpoint API), it is
less type-safe than <code>zap.Middleware</code>&#39;s use of contexts.</li>
<li><a href="https://github.com/zigzap/zap/blob/master/src/zap.zig#L102"><strong>Per Request Contexts</strong></a> : With the introduction of
<code>setUserContext()</code> and <code>getUserContext()</code>, you can, of course use those two in
projects that don&#39;t use <code>zap.SimpleEndpoint</code> or <code>zap.Middleware</code>, too, if you
really, really, absolutely don&#39;t find another way to solve your context
problem. <strong>We recommend using a <code>zap.SimpleEndpoint</code></strong> inside of a struct that
can provide all the context you need <strong>instead</strong>. You get access to your
struct in the callbacks via the <code>@fieldParentPtr()</code> trick that is used
extensively in Zap&#39;s examples, like the <a href="https://github.com/zigzap/zap/blob/master/examples/endpoint/endpoint.zig">endpoint
example</a>.</li>
<li><a href="https://github.com/zigzap/zap/blob/master/examples/senderror/senderror.zig"><strong>Error Trace Responses</strong></a>: You can now
call <code>r.sendError(err, status_code)</code> when you catch an error and a stack trace
will be returned to the client / browser.</li>
</ul>
<p dir="auto">I&#39;ll continue wrapping more of facil.io&#39;s functionality and adding stuff to zap
to a point where I can use it as the JSON REST API backend for real research
projects, serving thousands of concurrent clients.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-blazingly-fast" aria-hidden="true" href="#blazingly-fast"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji>blazingly fast<g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji></h2>
<p dir="auto">Claiming to be blazingly fast is the new black. At least, zap doesn&#39;t slow you
down and if your server performs poorly, it&#39;s probably not exactly zap&#39;s fault.
Zap relies on the <a href="https://facil.io" rel="nofollow">facil.io</a> framework and so it can&#39;t really
claim any performance fame for itself. In this initial implementation of zap,
I didn&#39;t care about optimizations at all.</p>
<p dir="auto">But, how fast is it? Being blazingly fast is relative. When compared with a
simple GO HTTP server, a simple zig zap HTTP server performed really good on my
machine:</p>
<ul dir="auto">
<li>zig zap was nearly 30% faster than GO</li>
<li>zig zap had over 50% more throughput than GO</li>
</ul>
<p dir="auto"><strong>Elephant in the room</strong>: I was intrigued comparing to a basic rust HTTP server.
Unfortunately, knowing nothing at all about rust, I couldn&#39;t find one and hence
tried to go for the one in <a href="https://doc.rust-lang.org/book/ch20-00-final-project-a-web-server.html" rel="nofollow">The Rust Programming
Language</a>.
Wanting it to be of a somewhat fair comparison, I opted for the multi-threaded
example. It didn&#39;t work out-of-the-box, but I got it to work and changed it to
not read files but outputting a static text just like in the other examples.
<strong>Maybe someone with rust experience</strong> can have a look at my
<a href="https://github.com/zigzap/zap/blob/master/wrk/rust/hello">wrk/rust/hello</a> code and tell me why it&#39;s surprisingly slow, as
I expected it to be faster than the basic GO example. I&#39;ll enable the
GitHub discussions for this matter. My suspicion is bad performance of the
mutexes.</p>
<p dir="auto"><strong>Update</strong>: Thanks to @felipetrz, I got to test against more realistic Python
and Rust examples. Both python <code>sanic</code> and rust <code>axum</code> were easy enough to
integrate.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/zigzap/zap/blob/master/wrk_table_summary.png"><img src="https://github.com/zigzap/zap/raw/master/wrk_table_summary.png" alt=""/></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/zigzap/zap/blob/master/wrk_charts_summary.png"><img src="https://github.com/zigzap/zap/raw/master/wrk_charts_summary.png" alt=""/></a></p>
<p dir="auto">So, being somewhere in the ballpark of basic GO performance, zig zap seems to be
... of reasonable performance <g-emoji alias="sunglasses" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60e.png">üòé</g-emoji>.</p>
<p dir="auto">See more details in <a href="https://github.com/zigzap/zap/blob/master/blazingly-fast.md">blazingly-fast.md</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-getting-started" aria-hidden="true" href="#getting-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Getting started</h2>
<div dir="auto" data-snippet-clipboard-copy-content="$ git clone https://github.com/zigzap/zap.git
$ cd zap
$ zig build run-hello
$ # open http://localhost:3000 in your browser"><pre>$ git clone https://github.com/zigzap/zap.git
$ <span>cd</span> zap
$ zig build run-hello
$ <span><span>#</span> open http://localhost:3000 in your browser</span></pre></div>
<p dir="auto">... and open <a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a> in your browser.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-using-zap-in-your-own-projects" aria-hidden="true" href="#using-zap-in-your-own-projects"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using <g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji>zap<g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji> in your own projects</h2>
<p dir="auto">If you don&#39;t have an existing zig project, create one like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ mkdir zaptest &amp;&amp; cd zaptest
$ zig init-exe
$ git init      ## (optional)"><pre>$ mkdir zaptest <span>&amp;&amp;</span> <span>cd</span> zaptest
$ zig init-exe
$ git init      <span><span>#</span># (optional)</span></pre></div>
<p dir="auto"><strong>Note 1</strong>: Zap is developed with zig master. This version of zig has the
package management features in place that are used in the following
instructions. Nix users are lucky; you can use the existing <code>flake.nix</code> and run
<code>nix develop</code> to get a development shell providing zig, and also all
dependencies to build the and run the GO, python, and rust examples for the
<code>wrk</code> performance tests. For mere building, <code>nix develop .#build</code> will only
fetch zig master.</p>
<p dir="auto">With an existing zig project, adding zap to it is easy:</p>
<ol dir="auto">
<li>Add zap to your <code>build.zig.zon</code></li>
<li>Add zap to your <code>build.zig</code></li>
</ol>
<p dir="auto">To add zap to <code>build.zig.zon</code>:</p>

<div dir="auto" data-snippet-clipboard-copy-content=".{
    .name = &#34;My example project&#34;,
    .version = &#34;0.0.1&#34;,

    .dependencies = .{
        // zap v0.1.6-pre
        .zap = .{
            .url = &#34;https://github.com/zigzap/zap/archive/refs/tags/v0.1.6-pre.tar.gz&#34;,
            .hash = &#34;1220a3eab193523b30721dae56a763468b7348b3d1f0b3364d68f6d548c753a72c5a&#34;,
        }
    }
}"><pre>.{
    .<span>name</span> <span>=</span> <span>&#34;My example project&#34;</span>,
    .<span>version</span> <span>=</span> <span>&#34;0.0.1&#34;</span>,

    .<span>dependencies</span> <span>=</span> .{
        <span>// zap v0.1.6-pre</span>
        .<span>zap</span> <span>=</span> .{
            .<span>url</span> <span>=</span> <span>&#34;https://github.com/zigzap/zap/archive/refs/tags/v0.1.6-pre.tar.gz&#34;</span>,
            .<span>hash</span> <span>=</span> <span>&#34;1220a3eab193523b30721dae56a763468b7348b3d1f0b3364d68f6d548c753a72c5a&#34;</span>,
        }
    }
}</pre></div>

<p dir="auto">Then, in your <code>build.zig</code>&#39;s <code>build</code> function, add the following before
`b.installArtifact(exe)``:</p>
<div dir="auto" data-snippet-clipboard-copy-content="    const zap = b.dependency(&#34;zap&#34;, .{
        .target = target,
        .optimize = optimize,
    });
    exe.addModule(&#34;zap&#34;, zap.module(&#34;zap&#34;));
    exe.linkLibrary(zap.artifact(&#34;facil.io&#34;));"><pre>    <span>const</span> <span>zap</span> <span>=</span> <span>b</span>.<span>dependency</span>(<span>&#34;zap&#34;</span>, .{
        .<span>target</span> <span>=</span> <span>target</span>,
        .<span>optimize</span> <span>=</span> <span>optimize</span>,
    });
    <span>exe</span>.<span>addModule</span>(<span>&#34;zap&#34;</span>, <span>zap</span>.<span>module</span>(<span>&#34;zap&#34;</span>));
    <span>exe</span>.<span>linkLibrary</span>(<span>zap</span>.<span>artifact</span>(<span>&#34;facil.io&#34;</span>));</pre></div>
<p dir="auto">From then on, you can use the zap package in your project. Check out the
examples to see how to use zap.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-updating-your-project-to-the-latest-version-of-zap" aria-hidden="true" href="#updating-your-project-to-the-latest-version-of-zap"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Updating your project to the latest version of zap</h2>
<p dir="auto">You can change the URL to zap in your <code>build.zig.zon</code></p>
<ul dir="auto">
<li>easiest: use a tagged release</li>
<li>or to one of the tagged versions, e.g. <code>0.0.9</code></li>
<li>or to the latest commit of <code>zap</code></li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-a-tagged-release" aria-hidden="true" href="#using-a-tagged-release"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using a tagged release</h3>
<p dir="auto">Go to the <a href="https://github.com/zigzap/zap/releases">release page</a>. Every release
will state its version number and also provide instructions for changing
<code>build.zig.zon</code> and <code>build.zig</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-a-tagged-version" aria-hidden="true" href="#using-a-tagged-version"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using a tagged version</h3>
<p dir="auto">Go to <a href="https://github.com/zigzap/zap/tags">to the tags page</a> to view all
available tagged versions of zap. From there, right click on the <code>tar.gz</code> link
to copy the URL to put into your <code>build.zig.zon</code>.</p>
<p dir="auto">After changing the <code>.url</code> field, you will get an error like this at the next
attempt to <code>zig build</code>:</p>
<div data-snippet-clipboard-copy-content=".../build.zig.zon:8:21: error: hash mismatch:
expected: 12205fd0b60720fb2a40d82118ee75c15cb5589bb9faf901c8a39a93551dd6253049,
found: 1220f4ea8be4a85716ae1362d34c077dca10f10d1baf9196fc890e658c56f78b7424
.hash = &#34;12205fd0b60720fb2a40d82118ee75c15cb5589bb9faf901c8a39a93551dd6253049&#34;,
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"><pre><code>.../build.zig.zon:8:21: error: hash mismatch:
expected: 12205fd0b60720fb2a40d82118ee75c15cb5589bb9faf901c8a39a93551dd6253049,
found: 1220f4ea8be4a85716ae1362d34c077dca10f10d1baf9196fc890e658c56f78b7424
.hash = &#34;12205fd0b60720fb2a40d82118ee75c15cb5589bb9faf901c8a39a93551dd6253049&#34;,
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre></div>
<p dir="auto"><strong>Note:</strong> If you don&#39;t get this error, clean your global zig cache: <code>rm -fr ~/.cache/zig</code>. This shouldn&#39;t happen with current zig master anymore.</p>
<p dir="auto">With the new URL, the old hash in the <code>build.zig.zon</code> is no longer valid. You
need to take the hash value displayed after <code>found: </code> in the error message as
the <code>.hash</code> value in <code>build.zig.zon</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-an-arbitrary-last-commit" aria-hidden="true" href="#using-an-arbitrary-last-commit"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using an arbitrary (last) commit</h3>
<p dir="auto">Use the same workflow as above for tags, excpept for the URL, use this schema:</p>
<div dir="auto" data-snippet-clipboard-copy-content=".url = &#34;https://github.com/zigzap/zap/archive/[COMMIT-HASH].tar.gz&#34;,"><pre>.<span>url</span> <span>=</span> <span>&#34;https://github.com/zigzap/zap/archive/[COMMIT-HASH].tar.gz&#34;</span>,</pre></div>
<p dir="auto">Replace <code>[COMMIT-HASH]</code> with the full commit hash as provided, e.g. by <code>git log</code>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-contribute-to-zap---blazingly-fast" aria-hidden="true" href="#contribute-to-zap---blazingly-fast"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contribute to <g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji>zap<g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji> - blazingly fast</h2>
<p dir="auto">At the current time, I can only add to zap what I need for my personal and
professional projects. While this happens <strong>blazingly fast</strong>, some if not all
nice-to-have additions will have to wait. You are very welcome to help make the
world a blazingly fast place by providing patches or pull requests, add
documentation or examples, or interesting issues and bug reports - you&#39;ll know
what to do when you receive your calling <g-emoji alias="angel" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f47c.png">üëº</g-emoji>.</p>
<p dir="auto">Check out <a href="https://github.com/zigzap/zap/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a> for more details.</p>
<p dir="auto">See also <a href="https://github.com/zigzap/zap/blob/master/introducing.md">introducing.md</a> for more on the state and progress of
this project.</p>
<p dir="auto"><strong>We now have our own <a href="https://discord.gg/jQAAN6Ubyj" rel="nofollow">ZAP discord</a> server!!!</strong></p>
<p dir="auto">You can also reach me on <a href="https://discord.gg/CBzE3VMb" rel="nofollow">the zig showtime discord
server</a> under the handle renerocksai
(renerocksai#1894).</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-support-zap" aria-hidden="true" href="#support-zap"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Support <g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji>zap<g-emoji alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">‚ö°</g-emoji></h2>
<p dir="auto">Being blazingly fast requires a constant feed of caffeine. I usually manage to
provide that to myself for myself. However, to support keeping the juices
flowing and putting a smile on my face and that warm and cozy feeling into my
heart, you can always <a href="https://buymeacoffee.com/renerocksai" rel="nofollow">buy me a coffee</a>
<g-emoji alias="coffee" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2615.png">‚òï</g-emoji>. All donations are welcomed <g-emoji alias="pray" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f64f.png">üôè</g-emoji> blazingly fast! That being said, just saying
&#34;hi&#34; also works wonders with the smiles, warmth, and coziness <g-emoji alias="blush" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60a.png">üòä</g-emoji>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-examples" aria-hidden="true" href="#examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h2>
<p dir="auto">You build and run the examples via:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ zig build [EXAMPLE]
$ ./zig-out/bin/[EXAMPLE]"><pre>$ zig build [EXAMPLE]
$ ./zig-out/bin/[EXAMPLE]</pre></div>
<p dir="auto">... where <code>[EXAMPLE]</code> is one of <code>hello</code>, <code>routes</code>, or <code>serve</code>.</p>
<p dir="auto">Example: building and running the hello example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ zig build hello
$ ./zig-out/bin/hello"><pre>$ zig build hello
$ ./zig-out/bin/hello</pre></div>
<p dir="auto">To just run an example, like <code>routes</code>, without generating an executable, run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ zig build run-[EXAMPLE]"><pre>$ zig build run-[EXAMPLE]</pre></div>
<p dir="auto">Example: building and running the routes example:</p>

<h3 tabindex="-1" dir="auto"><a id="user-content-hello" aria-hidden="true" href="#hello"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a href="https://github.com/zigzap/zap/blob/master/examples/hello/hello.zig">hello</a></h3>
<div dir="auto" data-snippet-clipboard-copy-content="const std = @import(&#34;std&#34;);
const zap = @import(&#34;zap&#34;);

fn on_request(r: zap.SimpleRequest) void {
    if (r.path) |the_path| {
        std.debug.print(&#34;PATH: {s}\n&#34;, .{the_path});
    }

    if (r.query) |the_query| {
        std.debug.print(&#34;QUERY: {s}\n&#34;, .{the_query});
    }
    r.sendBody(&#34;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello from ZAP!!!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#34;) catch return;
}

pub fn main() !void {
    var listener = zap.SimpleHttpListener.init(.{
        .port = 3000,
        .on_request = on_request,
        .log = true,
    });
    try listener.listen();

    std.debug.print(&#34;Listening on 0.0.0.0:3000\n&#34;, .{});

    // start worker threads
    zap.start(.{
        .threads = 2,
        .workers = 2,
    });
}"><pre><span>const</span> <span>std</span> <span>=</span> <span>@import</span>(<span>&#34;std&#34;</span>);
<span>const</span> <span>zap</span> <span>=</span> <span>@import</span>(<span>&#34;zap&#34;</span>);

<span>fn</span> <span>on_request</span>(<span>r</span>: <span>zap.SimpleRequest</span>) <span>void</span> {
    <span>if</span> (<span>r</span>.<span>path</span>) <span>|</span><span>the_path</span><span>|</span> {
        <span>std</span>.<span>debug</span>.<span>print</span>(<span>&#34;PATH: {s}<span>\n</span>&#34;</span>, .{<span>the_path</span>});
    }

    <span>if</span> (<span>r</span>.<span>query</span>) <span>|</span><span>the_query</span><span>|</span> {
        <span>std</span>.<span>debug</span>.<span>print</span>(<span>&#34;QUERY: {s}<span>\n</span>&#34;</span>, .{<span>the_query</span>});
    }
    <span>r</span>.<span>sendBody</span>(<span>&#34;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello from ZAP!!!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span>) <span>catch</span> <span>return</span>;
}

<span>pub</span> <span>fn</span> <span>main</span>() <span>!</span><span>void</span> {
    <span>var</span> <span>listener</span> <span>=</span> <span>zap</span>.<span>SimpleHttpListener</span>.<span>init</span>(.{
        .<span>port</span> <span>=</span> <span>3000</span>,
        .<span>on_request</span> <span>=</span> <span>on_request</span>,
        .<span>log</span> <span>=</span> <span>true</span>,
    });
    <span>try</span> <span>listener</span>.<span>listen</span>();

    <span>std</span>.<span>debug</span>.<span>print</span>(<span>&#34;Listening on 0.0.0.0:3000<span>\n</span>&#34;</span>, .{});

    <span>// start worker threads</span>
    <span>zap</span>.<span>start</span>(.{
        .<span>threads</span> <span>=</span> <span>2</span>,
        .<span>workers</span> <span>=</span> <span>2</span>,
    });
}</pre></div>
</article>
          </div></div>
  </body>
</html>
