<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.kolide.com/blog/malvertising-on-google-ads-it-s-hiding-in-plain-site">Original</a>
    <h1>Malvertising on Google Ads</h1>
    
    <div id="readability-page-1" class="page"><div>
          <p>Let’s start with a hypothetical: If I asked you to download a piece of open
source software, what would you do? Chances are you’d open your browser, go to
Google, and type in the name of the software.</p>

<p>Then you’d proceed to click on the first official-looking link you saw, even if
it’s an ad. After all, it doesn’t really make a difference if you click on an ad
or an organic link as long as you wind up on the site you’re looking for.</p>

<p>You won’t think too hard about clicking a Google ad because you have no reason
to be suspicious of them–they’re just part of the background noise of your
digital life. It’s the same reason you don’t check to make sure that gas, and
not water, is coming out of the pump when you fill up your car.</p>

<p>But that assumption of safety is exactly what cybercriminals are counting on.
It’s at the heart of the latest form of malvertising, in which bad actors
purchase Google ads that sit at the top of search results and masquerade as
legitimate open source software. But when you click the download button, what
you’re getting is malware.</p>

<p>Open source software seems like a curious choice as an attack vector until you
understand how much the technology has permeated corporations. In <a href="https://www.openlogic.com/success/2023-state-open-source-report" target="_blank">OpenLogic’s
2023 State of Open Source Report</a>,
80% of those surveyed reported that their organization increased the use of open
source software over the last 12 months.</p>

<p>With little mainstream news coverage, malvertising has evolved to become an
extremely worrisome attack vector. And as open source software becomes more
common in the business world, the threat is shifting from individuals to
organizations. To protect not only your end-users, but your corporate fleet, IT
and security folks need to start figuring out how to guard against this threat.</p>
<h2 id="what-is-malvertising"><a href="#what-is-malvertising"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>What Is Malvertising?</a></h2>

<p>Malvertising is a broad term that encompasses any time bad actors use digital
advertisements to deliver malware. Malicious advertising has taken many forms
over the years–display ads, <a href="https://www.malwarebytes.com/glossary/drive-by-download" target="_blank">drive-by downloads</a>,
and forced redirects–with <a href="https://www.theguardian.com/technology/2016/mar/16/major-sites-new-york-times-bbc-ransomware-malvertising" target="_blank">headline-worthy results</a>
affecting organizations from the New York Times to the NFL.</p>

<p>The goal of these past malvertising campaigns was to get users to inadvertently
download ransomware. Some malvertising required a click; some didn’t; some took
the form of urgent looking pop-ups; some looked like regular ads. Regardless,
they all had the same effect:  encrypting the user’s device until the ransom was
paid.</p>

<p>However, all these variations can be seen as <em>traditional</em> malvertising, which
peaked in the 2010s. In this article we’re going to focus on malvertising’s
newest form, which has some unique characteristics. For one thing, in open
source malvertising, users aren’t unknowingly downloading a file; they’re doing
it on purpose. And paradoxically, that makes it more dangerous.</p>
<h3 id="how-open-source-malvertising-works"><a href="#how-open-source-malvertising-works"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>How open source malvertising works</a></h3>

<p>Victims of Google ad malware typically follow this flow:</p>

<p><img loading="lazy" srcset="https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUh5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--dc496a6fcfd336efa33f6a1427e1cd778a4d78de/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFLOEFqQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--aa1821da797a1d7a5f0ed4c03e77435e02d69050/malvertising-flow-chart.png 350w, https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUh5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--dc496a6fcfd336efa33f6a1427e1cd778a4d78de/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFMSUJUQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--d2328d2e54fab2fadecccecd4e7668ffa681d461/malvertising-flow-chart.png 740w, https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUh5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--dc496a6fcfd336efa33f6a1427e1cd778a4d78de/malvertising-flow-chart.png " src="https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUh5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--dc496a6fcfd336efa33f6a1427e1cd778a4d78de/malvertising-flow-chart.png" data-zoomable="true"/></p>

<p>First, users see the promoted search result, which most likely features a
<a href="https://www.csoonline.com/article/3600594/what-is-typosquatting-a-simple-but-effective-attack-technique.html" target="_blank">typosquatted URL</a>
that’s easy to miss if you’re not paying close attention. (In the example below,
“audacity” becomes “audacite.”) Next, they click on the URL that takes them to a
web page that’s nearly identical to the real company’s homepage.</p>

<p><img loading="lazy" srcset="https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUx5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--7e617a991900a84077e046c3f13ee6b77f4390e4/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFLOEFqQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--aa1821da797a1d7a5f0ed4c03e77435e02d69050/real-audacity-website.png 350w, https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUx5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--7e617a991900a84077e046c3f13ee6b77f4390e4/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFMSUJUQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--d2328d2e54fab2fadecccecd4e7668ffa681d461/real-audacity-website.png 740w, https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUx5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--7e617a991900a84077e046c3f13ee6b77f4390e4/real-audacity-website.png " src="https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMUx5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--7e617a991900a84077e046c3f13ee6b77f4390e4/real-audacity-website.png" data-zoomable="true"/></p>

<figcaption>Legitimate Audacity Website</figcaption>

<p><img loading="lazy" srcset="https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMVB5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2b255d11ecc752466dfb55b6d1394bc35d8ab3d5/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFLOEFqQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--aa1821da797a1d7a5f0ed4c03e77435e02d69050/audacity-malvertising-website.png 350w, https://www-assets.kolide.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMVB5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2b255d11ecc752466dfb55b6d1394bc35d8ab3d5/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFMSUJUQT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--d2328d2e54fab2fadecccecd4e7668ffa681d461/audacity-malvertising-website.png 740w, https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMVB5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2b255d11ecc752466dfb55b6d1394bc35d8ab3d5/audacity-malvertising-website.png " src="https://www-assets.kolide.com/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMVB5REE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2b255d11ecc752466dfb55b6d1394bc35d8ab3d5/audacity-malvertising-website.png" data-zoomable="true"/></p>

<figcaption>
  Threat Actor Website Mimicking Audacity Source: <a href="https://threatresearch.ext.hp.com/adverts-mimicking-popular-software-leads-to-malware/" target="_blank">HP</a>
</figcaption>

<p>And that’s where the trouble begins. Once victims download the fake Audacity
software they’re met with <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.vidar" target="_blank">Vidar Stealer</a>—an
information-stealing malware capable of gathering passwords and information
from two-factor authentication software.</p>

<p>When the user opens the downloaded file, they find a malware file named
“update.zip” that is wrapped in a bloated file–<a href="https://threatresearch.ext.hp.com/adverts-mimicking-popular-software-leads-to-malware/" target="_blank">343MB</a>!–
which mimics the size of a real installer to avoid initial suspicion from users
and malware detectors.</p>
<h3 id="malvertising-examples"><a href="#malvertising-examples"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Malvertising Examples</a></h3>

<p>Search engine malvertisements have proliferated to such an extent that the <a href="https://www.ic3.gov/Media/Y2022/PSA221221?=8324278624" target="_blank">FBI
released a bulletin</a>
about it (among other things, they recommend individuals protect themselves by
using ad blockers).</p>

<p>To become so notorious, Vidar Stealer can’t be the only malware distributed in
these targeted attacks. <a href="https://riskybiznews.substack.com/p/risky-biz-news-google-search-and" target="_blank">Risky Business News</a>
has collected a comprehensive list of malware attached to Google Ad malvertising
over the past year, including (get ready):
<a href="https://www.trendmicro.com/en_us/research/22/l/icedid-botnet-distributors-abuse-google-ppc-to-distribute-malware.html" target="_blank">IcedID</a>,
<a href="https://www.mandiant.com/resources/blog/seo-poisoning-batloader-atera" target="_blank">BatLoader</a>,
<a href="https://intel471.com/blog/privateloader-malware" target="_blank">PrivateLoader</a>,
<a href="https://securelist.com/nullmixer-oodles-of-trojans-in-a-single-dropper/107498/" target="_blank">NullMixer</a>,
<a href="https://blog.avast.com/fakecrack-campaign" target="_blank">FakeCrack</a>,
<a href="https://cyber-anubis.github.io/malware%20analysis/redline/" target="_blank">RedLine Stealer</a>,
<a href="https://www.malware-traffic-analysis.net/2023/01/03/index.html" target="_blank">Rhadamanthys Stealer</a>,
<a href="https://redcanary.com/threat-detection-report/threats/yellow-cockatoo/" target="_blank">Yellow Cockatoo</a>,
<a href="https://www.cyfirma.com/outofband/vagusrat-a-new-entrant-in-the-external-threat-landscape/" target="_blank">VagusRAT</a>,
and <a href="https://labs.guard.io/masquerads-googles-ad-words-massively-abused-by-threat-actors-targeting-organizations-gpus-42ae73ee8a1e" target="_blank">MasquerAds</a>.</p>

<p>This generation of malware delivers many types of malicious code: credential
stealing, remote access installation, ransomware, additional loaders, and even
the ability to steal cryptocurrency.</p>

<p>Audacity isn’t the only open source tool being used in malvertisements. Bleeping
Computer <a href="https://www.bleepingcomputer.com/news/security/hackers-push-malware-via-google-search-ads-for-vlc-7-zip-ccleaner/" target="_blank">reports</a>
that tools such as Rufus, Notepad++, 7-Zip, Blender 3D, and others have been
used as vehicles in this malware delivery method.</p>

<p>If you’re overwhelmed by all the possible permutations of this type of attack, I
think I can speak for the threat actors—that’s the point.</p>
<h2 id="why-malvertising-is-a-threat-to-corporate-security"><a href="#why-malvertising-is-a-threat-to-corporate-security"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Why Malvertising Is a Threat To Corporate Security</a></h2>

<p>With the proliferation of search engine malvertising, end-users run the risk of
their personal <em>and</em> work information being stolen any time they open up a browser.
And it’s not because end-users are dumb. It’s not because you’re not doing your
job as a security practitioner. And it’s certainly not because these bad actors
are geniuses.</p>

<p>It’s because these malvertisements combine unexpected and tried-but-true tactics
that have morphed into a malware snowball rushing down exploit mountain. Let’s
break it down.</p>
<h3 id="malvertising-is-a-surprisingly-popular-attack-vector"><a href="#malvertising-is-a-surprisingly-popular-attack-vector"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Malvertising is a surprisingly popular attack vector</a></h3>

<p>Part of the reason malvertising is so effective as a delivery vector for malware
is that it gets comparatively little attention compared to email.</p>

<p>In HP Wolf Security’s <a href="https://threatresearch.ext.hp.com/wp-content/uploads/2022/11/HP-Wolf-Security-Threat-Insights-Report-Q3-2022.pdf" target="_blank">Q3 2022 Threat Insights Report</a>,
69% of the malware campaigns they analyzed occurred through email, making it by
far the most popular method.</p>

<p>However, taking the silver medal are web browser downloads at 18%. “In total, we
found 92 typosquatted domains likely related to the IcedID campaign, indicating
the growing popularity of this delivery mechanism among threat actors,” says
<a href="https://threatresearch.ext.hp.com/adverts-mimicking-popular-software-leads-to-malware/" target="_blank">HP malware analyst Patrick Schläpfer</a>
when his team analyzed a recent malvertising campaign affecting established software.</p>

<p>While email is efficient at targeting a specific business or individual, search
engine malvertising has a broader scope that can affect many businesses in one
deployment. As the Vidar Stealer malware exemplifies, hackers can steal
information from users and find themselves with a treasure trove of both personal
and business logins. They’ll be able to quickly deduce what company a user works
for, crack 2FAs nearly effortlessly, and access your systems.</p>

<p>While not an example of malvertising, the LastPass data breach is a case study
in how consumer-facing software can be used for corporate cybercrime. In this
attack, a hacker accessed a senior DevOps engineer’s home computer through
<a href="https://arstechnica.com/information-technology/2023/02/lastpass-hackers-infected-employees-home-computer-and-stole-corporate-vault/" target="_blank">media player Plex</a>,
and used it to install a keylogging malware that was able to scrape the
engineer’s credentials. The hacker could then access LastPass’ customer database
and make off with the sensitive information of their users.</p>
<h3 id="malvertising-is-to-evade-traditional-detection-methods"><a href="#malvertising-is-to-evade-traditional-detection-methods"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Malvertising is to evade traditional detection methods</a></h3>

<p>As we mentioned earlier, one reason open source malware has been so successful
is artificial inflation of file size.</p>

<blockquote>
<p>“First, a larger file size is more likely for a software installer. Secondly,
and more importantly, extremely large file sizes can be used to bypass the
automatic scanning of some antivirus software.”
-<a href="https://threatresearch.ext.hp.com/adverts-mimicking-popular-software-leads-to-malware/" target="_blank">HP Threat Research Blog</a></p>
</blockquote>

<p>So, not only are malware detection tools fooled, but most end-users won’t notice
the difference until it’s too late. And even when the software they thought they
were downloading fails to install, plenty of users will think it’s a harmless
glitch or a problem with their computer.</p>
<h3 id="users-arent-trained-to-detect-malvertising"><a href="#users-arent-trained-to-detect-malvertising"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Users aren’t trained to detect malvertising</a></h3>

<p>In order to avoid falling for a malvertising scheme, users have to know what to
look for. That requires being skeptical about websites, closely looking at URLs,
and not simply trusting a link because it’s the first result on Google.</p>

<p>Users aren’t taught this, especially not at work. Phishing emails and social
engineering attacks are well-covered in most corporate security trainings. But
these courses usually skip over malvertising, since in the past it wasn’t aimed
at businesses.</p>
<h3 id="malvertising-is-difficult-to-keep-up-with"><a href="#malvertising-is-difficult-to-keep-up-with"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Malvertising is difficult to keep up with</a></h3>

<p>Since malvertising isn’t new, you’d think it would be easy to alert your
end-users of the mechanism. But when you have an ever-moving target, it becomes
a game of cat and mouse.</p>

<p>IT teams and security practitioners would be hard-pressed to hunt down
individual ads, since the ads on search engine result pages (SERPs) change
often. So getting ahead of this problem isn’t even whack-a-mole–it’s more like
whack-a-ghost.</p>

<p>Despite the difficulty of keeping track of all the search engine malvertisement
campaigns, the cybersecurity community has taken it into their own hands to
report on it. Security researchers such as <a href="https://twitter.com/wdormann" target="_blank">Will Dormann</a>,
<a href="https://twitter.com/1ZRR4H" target="_blank">Germán Fernández</a>, and <a href="https://twitter.com/malwrhunterteam" target="_blank">MalwareHunterTeam</a>
have been especially diligent about sourcing and relaying Google ad
malvertisements to the public. But as long as bad actors can buy a spot on
Google, the security world will always be playing catch-up.</p>
<h3 id="the-rising-popularity-of-free-and-open-source-software"><a href="#the-rising-popularity-of-free-and-open-source-software"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>The rising popularity of free and open source software</a></h3>

<p>As we’ve noted, more and more companies are adding open source software to
their tech stacks. Companies have also taken to utilizing free or low-cost
password managers such as Bitwarden and 1Password to protect their end-users’
credentials. And threat actors have taken notice.</p>

<p>A recent phishing campaign spoofed Bitwarden’s login page for users who clicked
the wrong Google link. While this isn’t strictly malvertising–the goal was to 
trick users into giving away their credentials, not install malware–the technique
is essentially the same. The Bitwarden community surfaced this <a href="https://www.reddit.com/r/Bitwarden/comments/10kswt8/god_damn_in_situations_like_this_how_can_i_detect/" target="_blank">convincing imitation</a>
of Bitwarden’s landing page, and many concluded that the only way to be safe is to 
add the real page to their bookmarks, and bypass Google altogether.</p>

<p>Companies know they are at a disadvantage and <a href="https://www.openlogic.com/success/2023-state-open-source-report" target="_blank">41.97% of organizations</a>
already admit that maintaining security policies or compliance for open
source software is their biggest challenge–and this there’s a chance tha malvertising
could make some companies conclude that it’s just not worth the risk.</p>
<h2 id="how-to-protect-your-users-from-malvertisements"><a href="#how-to-protect-your-users-from-malvertisements"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>How To Protect Your Users From Malvertisements</a></h2>

<p>Most articles related to search engine malvertising are geared toward end-users,
not admins, so they offer basic tips about adopting a think-before-you-click 
mentality. However, in a business setting, you may want stronger safeguards.</p>

<p>To protect your endpoints from malvertisements, you must implement scalable,
reliable, and secure practices. And that’s easier said than done, since, as the
saying goes: users be downloadin’.</p>

<p>Nevertheless, here are some actionable steps you as an IT administrator and
security practitioner can take to protect your end-users and business.</p>
<h3 id="create-blocklists-for-commonly-used-malicious-tlds"><a href="#create-blocklists-for-commonly-used-malicious-tlds"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Create blocklists for commonly used malicious-TLDs</a></h3>

<p>Preventing exposure to malicious websites is key to maintaining a safe fleet.
Users have traditionally used ad blockers to prevent being exposed to Google ads;
however, Google has announced an <a href="https://developer.chrome.com/blog/more-mv2-transition/" target="_blank">update to their extension manifest</a>
that will effectively make Chrome ad blockers obsolete as Chrome will now have
the ability to severely limit extensions from making network request
modifications. To prepare for that upcoming reality, the
<a href="https://media.defense.gov/2019/Jul/16/2002158057/-1/-1/0/CSI-BLOCKING-UNNECESSARY-ADVERTISING-WEB-CONTENT.PDF" target="_blank">National Security Agency</a>
recommends using your existing network functions such as your firewall to allow
DNS traffic through corporate servers only.</p>

<p>The NSA also recommends utilizing DNS to block malicious ad domains. While it
may be a daunting task to compile a blocklist of top-level domains (TLDs), the
key is to just start. Fortunately, IT teams can use regularly updated,
reputable, and <a href="https://blocklistproject.github.io/Lists/malware.txt" target="_blank">community-maintained blocklists</a>
to catch malware. And for max coverage, ensure domains such as .site, .tk, and
recently, <a href="https://threatresearch.ext.hp.com/adverts-mimicking-popular-software-leads-to-malware/" target="_blank">.top</a>
domains that have been featured in these malvertising attacks are part of your
growing blocklist as well. Create a weekly or even monthly task of updating the
blocklist and your team can stay ahead of the game.</p>
<h3 id="implement-an-application-whitelisting-process"><a href="#implement-an-application-whitelisting-process"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Implement an application whitelisting process</a></h3>

<p>Installing new software is usually a pretty solitary activity: you pick the
software you want, you download it, you use it. Pretty simple. However, as we’ve
learned, with malvertisements, that user flow needs a bit of an adjustment—a
democratic one.</p>

<p>Take <a href="https://github.com/google/santa#screenshots" target="_blank">Santa</a>, for example. A binary
authorization system for macOS, Santa allows organizations to monitor install
executions and alerts users if a binary is malicious. If a user wants to install
an unknown binary, they must apply for it to be whitelisted internally. However,
tasking your IT team to look over each execution can be inefficient and arduous.
Enter “<a href="https://github.com/google/upvote_py2/blob/master/docs/basics.md" target="_blank">social voting</a>.”</p>

<p>The now-defunct <a href="https://github.com/google/upvote_py2" target="_blank">Upvote</a>, also a binary
whitelisting solution, allowed organizations to create an application control
policy server where users vote on and share software they’re trying to run. Once
a certain threshold is reached, the software in question gets whitelisted and
approved. Although the open source project is no longer being actively worked
on, security teams can take the existing code and iterate on it based on their
company’s needs. You can also find a similar social voting system to use in
tandem with a process like Santa.</p>
<h3 id="create-update-end-user-security-training"><a href="#create-update-end-user-security-training"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>Create/update end-user security training</a></h3>

<p>Let’s face it. Annual cybersecurity trainings are traditionally an hour-long
chore that end-users only half pay attention to. They watch the videos, fill out
three question quizzes per module, and the course tells them they “passed.” And
usually, these trainings are outdated or repeating the same phishing stories.</p>

<p>To break out of this model and get your team’s attention, find time during the
next all hands, team meeting, or catch-up call to talk about malvertising. Since
malvertising affects all end-users, it’d behoove your organization to be
proactive.</p>

<p>Show your colleagues examples of what malvertising looks like, explain what
steps the organization is taking to mitigate exposure, provide tips on what
they can do to protect themselves on their personal devices, what they can do
if they think they’ve been infected, and of course, share this blog with them.</p>
<h2 id="what-is-google-doing-about-it"><a href="#what-is-google-doing-about-it"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>What is Google Doing About it?</a></h2>

<p>We’ve talked about how IT teams and end-users can protect themselves from
malvertising, but let’s be real: a lot of responsibility for this epidemic
belongs to Google.</p>

<p>Google knows they have a problem and that their advertising network can be
abused. Their <a href="https://blog.google/products/ads-commerce/ads-safety-report-2021/" target="_blank">2021 Ads Safety Report</a>
says as much, as they:</p>

<ul>
<li><p>Removed over 3.4 billion ads, restricted over 5.7 billion ads and suspended
over 5.6 million advertiser accounts</p></li>
<li><p>Blocked or restricted ads from serving on 1.7 billion publisher pages</p></li>
<li><p>Took broader site-level enforcement action on approximately 63,000 publisher sites</p></li>
</ul>

<p>Yet even with millions of advertiser accounts suspended, the problem isn’t going
away. And as bad as malvertising is for users, it’s even more alarming to the
businesses being mimicked, since they risk being branded as “unsafe.” Some of
these companies are actively pleading for Google to do something.</p>

<p>Here are a few tweets about the issue:</p>

<ul>
<li><p><a href="https://archive.ph/xF1D9" target="_blank">1Password</a> alerting followers that there’s
impersonations going around.</p></li>
<li><p><a href="https://archive.is/cdlhz" target="_blank">Bitwarden</a> calling out search engines for being the
location of malicious links.</p></li>
<li><p>Open source broadcast software <a href="https://archive.is/DVZIj" target="_blank">OBS</a> relaying to
users that they do not run Google ads and directing them to know what scams
look like.</p></li>
<li><p>Open source multimedia tool <a href="https://archive.is/H6DK5" target="_blank">VideoLAN</a> explicitly
stating how much trouble they’re having with Google taking down the malicious
ads.</p></li>
</ul>

<p>You can certainly sense VideoLAN’s frustration when they ask Google “how are
those things a grey area?!?” The answer can be found in Google’s <a href="https://support.google.com/adspolicy/answer/6020954?hl=en&amp;ref_topic=1626336#" target="_blank">advertising
policies</a>,
which seem to prioritize advertiser experience (and revenue) over user safety.</p>

<blockquote>
<p lang="en" dir="ltr">Google: “We have robust policies prohibiting ads that attempt to circumvent our enforcement by disguising the advertiser’s identity and impersonating other brands, and we enforce them vigorously.”</p>— Will Dormann (@wdormann) <a href="https://twitter.com/wdormann/status/1616497407390355456?ref_src=twsrc%5Etfw">January 20, 2023</a>
</blockquote> 

<figcaption>
  Malicious Blender 3D ads in Google search results. Source:
  <a href="https://archive.is/lLxEx" target="_blank">Will Dormann</a>
</figcaption>

<p>Google classifies four things as “abusing the ad network:”</p>

<ul>
<li>Malicious or unwanted software</li>
<li>Unfair advantage</li>
<li>Evasive ad content</li>
<li>Circumventing systems</li>
</ul>

<p>From the list, malvertising falls directly into two categories: malicious
software and evasive ad content, which is described as “manipulation of ad
components (text, image, videos, domain, or subdomains) in an attempt to bypass
detection and / or enforcement action.” With those boxes ticked, malvertisers
are in clear violation of Google policy. So what’s the punishment? Per Google:</p>

<blockquote>
<p>Violations of this policy will not lead to immediate account suspension
without prior warning. A warning will be issued, at least 7 days, prior to any
suspension of your account.</p>
</blockquote>

<p>Sure, mistakes happen. Sure, your website could be hacked and injected with
malicious content. But these threat actors are actively mimicking popular
websites, exploiting the loopholes of the ad network, and reaping the
reward–including a 7 day grace period. You’d think to yourself: there has to be
a safeguard for extreme violators, right? You’d be correct – sort of.
Per <a href="https://support.google.com/adspolicy/answer/7187501" target="_blank">Google</a>:</p>

<blockquote>
<p>If we detect an egregious violation your account will be suspended immediately
and without prior warning. An egregious violation of the Google Ads policies
is a violation so serious that it is unlawful or poses significant harm to our
users or our digital advertising ecosystem. Egregious violations often reflect
that the advertiser’s overall business does not adhere to Google Ads policies
or that one violation is so severe that we cannot risk future exposure to our
users.</p>
</blockquote>

<p>Unfortunately, the search engine does not provide a definition nor examples of
what falls under “egregious violations.” And given how easy it is for bad actors
to simply make a new account when a new one is shut down, this approach doesn’t
meet the requirements for reliability or scalability. Still, when you look at
things from Google’s perspective, these policies make sense.</p>

<p>In Q4 of 2022, Google search advertising accounted for <a href="https://abc.xyz/investor/static/pdf/2022Q4_alphabet_earnings_release.pdf" target="_blank">$42.6 billion in revenue</a>.
There’s an understandable reluctance to put restrictive policies on a revenue
stream as lucrative as ads are. So, until there’s a bigger outcry that forces
Google’s hand, they’ll probably continue to respond to one business complaint at
a time, instead of the issue as a whole.</p>
<h2 id="if-you-educate-them-they-will-avoid-it"><a href="#if-you-educate-them-they-will-avoid-it"><span><svg viewBox="0 0 24 24" version="1.1" width="24" height="24" aria-hidden="true"><path d="M12.935 11.26a1 1 0 1 1 1.2-1.6 5.336 5.336 0 0 1 .572 8.043l-1.964 1.964a4.536 4.536 0 1 1-6.415-6.414l.5-.5a1 1 0 0 1 1.415 1.414l-.5.5a2.536 2.536 0 0 0 3.585 3.586l1.965-1.965a3.336 3.336 0 0 0-.358-5.028zm-.87 1.476a1 1 0 0 1-1.2 1.6 5.336 5.336 0 0 1-.572-8.043l1.965-1.965a4.536 4.536 0 1 1 6.414 6.415l-.5.5a1 1 0 1 1-1.414-1.415l.5-.5a2.536 2.536 0 1 0-3.586-3.585l-1.964 1.964a3.336 3.336 0 0 0 .357 5.029z"></path></svg></span>If You Educate Them, They Will Avoid It</a></h2>

<p>The war against malware is neverending, and the solution is <em>not</em> to lock down
every device so users can’t download anything.
(<a href="https://www.kolide.com/blog/what-is-shadow-it-you-can-t-solve-it-by-blocking-it">That approach will just drive them to shadow IT.</a>)</p>

<p>What you <em>can</em> do is guard against known malicious software, make sure every
employee’s malware blockers are up-to-date and running, and that employees
aren’t accessing company resources on vulnerable, personal devices. And
conveniently, you can do all that with <a href="https://www.kolide.com/">Kolide</a>!
(You knew I had to plug the product in at some point.)</p>

<p>Finally, whether you use Kolide or not, don’t neglect the important role of
end-user education. In the end, the easiest vulnerability to patch here might be
ignorance. Because your end-users will continue to use Google every day. It’s
about as inevitable as the <a href="https://www.darkreading.com/threat-intelligence/convincing-malicious-google-ads-password-managers" target="_blank">search engine stating</a>
it has “put in place new certification policies and advertiser verification
policies to better detect malvertising scams.”</p>

<p>Education and detection can prevent one bad click from turning into a security
nightmare. All you need is the right mindset and the right tools. (Just
double-check you’re downloading them from the right source.)</p>

<hr/>

<p>Want to see how Kolide can get your entire fleet updated, patched and compliant?
Watch <a href="https://lp.kolide.co/demo" target="_blank">Kolide’s on-demand demo</a> today.</p>

        </div></div>
  </body>
</html>
