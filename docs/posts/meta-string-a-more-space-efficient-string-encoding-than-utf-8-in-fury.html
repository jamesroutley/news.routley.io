<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://fury.apache.org/blog/fury_meta_string_37_5_percent_space_efficient_encoding_than_utf8/">Original</a>
    <h1>Meta String: A more space-efficient string encoding than UTF-8 in Fury</h1>
    
    <div id="readability-page-1" class="page"><div id="__blog-post-container" itemprop="articleBody"><h2 id="background">Background<a href="#background" aria-label="Direct link to Background" title="Direct link to Background">​</a></h2>
<p>In rpc/serialization systems, we often need to send <strong><code>namespace/path/filename/fieldName/packageName/moduleName/className/enumValue</code></strong> string between processes.</p>
<p>Those strings are mostly ascii strings. In order to transfer between processes, we encode such strings using utf-8 encodings. Such encoding
will take one byte for every char, which is not space efficient actually.</p>
<p>If we take a deeper look, we will found that most chars are <strong>lowercase chars,  <code>.</code>, <code>$</code> and <code>_</code></strong>, which can be expressed in a much
smaller range <strong><code>0~32</code></strong>. But one byte can represent range <code>0~255</code>, the significant bits are wasted, and this cost is not ignorable. In a dynamic serialization
framework, such meta will take considerable cost compared to actual data.</p>
<p>So we proposed a new string encoding algorithm which we called <strong>meta string encoding</strong> in Fury. It will encode most chars using <code>5</code> bits instead of <code>8</code> bits in utf-8 encoding, which can bring <strong>37.5% space cost savings</strong> compared to utf-8 encoding.</p>

<p>Meta string encoding algorithm is mainly used to encode meta strings such as <strong>field names, namespace, packageName, className, path and filename</strong>.
Such a string is enumerated and limited, so the encoding performance is not important since we can cache the encoding result.</p>
<p>Meta string encoding uses <code>5/6</code> bits instead of <code>8</code> bits in utf-8 encoding for every chars. Since it uses less bits than utf8, it can bring
<strong>37.5% space cost savings</strong> compared to utf-8 and has a smaller encoded binary size, which uses less storage and makes the network transfer faster.</p>
<p>More details about meta string spec can be found in <a href="https://fury.apache.org/docs/specification/fury_xlang_serialization_spec/#meta-string" target="_blank" rel="noopener noreferrer">Fury xlang serialization specification</a>.</p>
<h2 id="encoding-algorithms">Encoding Algorithms<a href="#encoding-algorithms" aria-label="Direct link to Encoding Algorithms" title="Direct link to Encoding Algorithms">​</a></h2>
<p>String binary encoding algorithm:</p>
<table><thead><tr><th>Algorithm</th><th>Pattern</th><th>Description</th></tr></thead><tbody><tr><td>LOWER_SPECIAL</td><td><code>a-z._$|</code></td><td>every char is written using 5 bits, <code>a-z</code>: <code>0b00000~0b11001</code>, <code>._$|</code>: <code>0b11010~0b11101</code>, prepend one bit at the start to indicate whether strip last char since last byte may have 7 redundant bits(1 indicates strip last char)</td></tr><tr><td>LOWER_UPPER_DIGIT_SPECIAL</td><td><code>a-zA-Z0~9._</code></td><td>every char is written using 6 bits, <code>a-z</code>: <code>0b00000~0b11001</code>, <code>A-Z</code>: <code>0b11010~0b110011</code>, <code>0~9</code>: <code>0b110100~0b111101</code>, <code>._</code>: <code>0b111110~0b111111</code>,  prepend one bit at the start to indicate whether strip last char since last byte may have 7 redundant bits(1 indicates strip last char)</td></tr><tr><td>UTF-8</td><td>any chars</td><td>UTF-8 encoding</td></tr></tbody></table>
<p>If we use <code>LOWER_SPECIAL/LOWER_UPPER_DIGIT_SPECIAL</code>, we must add a strip last char flag in encoded data. This is because every char will be encoded using <code>5/6</code> bits, and the last char may have <code>1~7</code> bits which are unused by encoding, such bits may cause an extra char to be read, which we must strip off.</p>
<p>Here is encoding code snippet in java, see <a href="https://github.com/apache/incubator-fury/blob/93800888595065b2690fec093ab0cbfd6ac7dedc/java/fury-core/src/main/java/org/apache/fury/meta/MetaStringEncoder.java#L235" target="_blank" rel="noopener noreferrer"><code>org.apache.fury.meta.MetaStringEncoder#encodeGeneric(char[], int)</code></a> for more details:</p>
<div><div><pre tabindex="0"><code><span><span>private</span><span> </span><span>byte</span><span>[</span><span>]</span><span> </span><span>encodeGeneric</span><span>(</span><span>char</span><span>[</span><span>]</span><span> chars</span><span>,</span><span> </span><span>int</span><span> bitsPerChar</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>  </span><span>int</span><span> totalBits </span><span>=</span><span> chars</span><span>.</span><span>length </span><span>*</span><span> bitsPerChar </span><span>+</span><span> </span><span>1</span><span>;</span><span></span><br/></span><span><span>  </span><span>int</span><span> byteLength </span><span>=</span><span> </span><span>(</span><span>totalBits </span><span>+</span><span> </span><span>7</span><span>)</span><span> </span><span>/</span><span> </span><span>8</span><span>;</span><span> </span><span></span><br/></span><span><span>  </span><span>byte</span><span>[</span><span>]</span><span> bytes </span><span>=</span><span> </span><span>new</span><span> </span><span>byte</span><span>[</span><span>byteLength</span><span>]</span><span>;</span><span></span><br/></span><span><span>  </span><span>int</span><span> currentBit </span><span>=</span><span> </span><span>1</span><span>;</span><span></span><br/></span><span><span>  </span><span>for</span><span> </span><span>(</span><span>char</span><span> c </span><span>:</span><span> chars</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>int</span><span> value </span><span>=</span><span></span><br/></span><span><span>        </span><span>(</span><span>bitsPerChar </span><span>==</span><span> </span><span>5</span><span>)</span><span> </span><span>?</span><span> </span><span>charToValueLowerSpecial</span><span>(</span><span>c</span><span>)</span><span> </span><span>:</span><span> </span><span>charToValueLowerUpperDigitSpecial</span><span>(</span><span>c</span><span>)</span><span>;</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>for</span><span> </span><span>(</span><span>int</span><span> i </span><span>=</span><span> bitsPerChar </span><span>-</span><span> </span><span>1</span><span>;</span><span> i </span><span>&gt;=</span><span> </span><span>0</span><span>;</span><span> i</span><span>--</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>      </span><span>if</span><span> </span><span>(</span><span>(</span><span>value </span><span>&amp;</span><span> </span><span>(</span><span>1</span><span> </span><span>&lt;&lt;</span><span> i</span><span>)</span><span>)</span><span> </span><span>!=</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>        </span><span></span><br/></span><span><span>        </span><span>int</span><span> bytePos </span><span>=</span><span> currentBit </span><span>/</span><span> </span><span>8</span><span>;</span><span></span><br/></span><span><span>        </span><span>int</span><span> bitPos </span><span>=</span><span> currentBit </span><span>%</span><span> </span><span>8</span><span>;</span><span></span><br/></span><span><span>        bytes</span><span>[</span><span>bytePos</span><span>]</span><span> </span><span>|=</span><span> </span><span>(</span><span>byte</span><span>)</span><span> </span><span>(</span><span>1</span><span> </span><span>&lt;&lt;</span><span> </span><span>(</span><span>7</span><span> </span><span>-</span><span> bitPos</span><span>)</span><span>)</span><span>;</span><span></span><br/></span><span><span>      </span><span>}</span><span></span><br/></span><span><span>      currentBit</span><span>++</span><span>;</span><span></span><br/></span><span><span>    </span><span>}</span><span></span><br/></span><span><span>  </span><span>}</span><span></span><br/></span><span><span>  </span><span>boolean</span><span> stripLastChar </span><span>=</span><span> bytes</span><span>.</span><span>length </span><span>*</span><span> </span><span>8</span><span> </span><span>&gt;=</span><span> totalBits </span><span>+</span><span> bitsPerChar</span><span>;</span><span></span><br/></span><span><span>  </span><span>if</span><span> </span><span>(</span><span>stripLastChar</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    bytes</span><span>[</span><span>0</span><span>]</span><span> </span><span>=</span><span> </span><span>(</span><span>byte</span><span>)</span><span> </span><span>(</span><span>bytes</span><span>[</span><span>0</span><span>]</span><span> </span><span>|</span><span> </span><span>0x80</span><span>)</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span></span><br/></span><span><span>  </span><span>return</span><span> bytes</span><span>;</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>private</span><span> </span><span>int</span><span> </span><span>charToValueLowerSpecial</span><span>(</span><span>char</span><span> c</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>  </span><span>if</span><span> </span><span>(</span><span>c </span><span>&gt;=</span><span> </span><span>&#39;a&#39;</span><span> </span><span>&amp;&amp;</span><span> c </span><span>&lt;=</span><span> </span><span>&#39;z&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> c </span><span>-</span><span> </span><span>&#39;a&#39;</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> </span><span>&#39;.&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>26</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> </span><span>&#39;_&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>27</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> </span><span>&#39;$&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>28</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> </span><span>&#39;|&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>29</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>throw</span><span> </span><span>new</span><span> </span><span>IllegalArgumentException</span><span>(</span><span>&#34;Unsupported character for LOWER_SPECIAL encoding: &#34;</span><span> </span><span>+</span><span> c</span><span>)</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>private</span><span> </span><span>int</span><span> </span><span>charToValueLowerUpperDigitSpecial</span><span>(</span><span>char</span><span> c</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>  </span><span>if</span><span> </span><span>(</span><span>c </span><span>&gt;=</span><span> </span><span>&#39;a&#39;</span><span> </span><span>&amp;&amp;</span><span> c </span><span>&lt;=</span><span> </span><span>&#39;z&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> c </span><span>-</span><span> </span><span>&#39;a&#39;</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>&gt;=</span><span> </span><span>&#39;A&#39;</span><span> </span><span>&amp;&amp;</span><span> c </span><span>&lt;=</span><span> </span><span>&#39;Z&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>26</span><span> </span><span>+</span><span> </span><span>(</span><span>c </span><span>-</span><span> </span><span>&#39;A&#39;</span><span>)</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>&gt;=</span><span> </span><span>&#39;0&#39;</span><span> </span><span>&amp;&amp;</span><span> c </span><span>&lt;=</span><span> </span><span>&#39;9&#39;</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>52</span><span> </span><span>+</span><span> </span><span>(</span><span>c </span><span>-</span><span> </span><span>&#39;0&#39;</span><span>)</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> specialChar1</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>62</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>c </span><span>==</span><span> specialChar2</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>return</span><span> </span><span>63</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span><span></span><br/></span><span><span>    </span><span>throw</span><span> </span><span>new</span><span> </span><span>IllegalArgumentException</span><span>(</span><span></span><br/></span><span><span>        </span><span>&#34;Unsupported character for LOWER_UPPER_DIGIT_SPECIAL encoding: &#34;</span><span> </span><span>+</span><span> c</span><span>)</span><span>;</span><span></span><br/></span><span><span>  </span><span>}</span><span></span><br/></span><span><span></span><span>}</span><br/></span></code></pre></div></div>
<p>Here is decoding code snippet in golang, see <a href="https://github.com/apache/incubator-fury/blob/93800888595065b2690fec093ab0cbfd6ac7dedc/go/fury/meta/meta_string_decoder.go#L70" target="_blank" rel="noopener noreferrer"><code>go/fury/meta/meta_string_decoder.go:70</code></a> for more details:</p>
<div><div><pre tabindex="0"><code><span><span>func</span><span> </span><span>(</span><span>d </span><span>*</span><span>Decoder</span><span>)</span><span> </span><span>decodeGeneric</span><span>(</span><span>data </span><span>[</span><span>]</span><span>byte</span><span>,</span><span> algorithm Encoding</span><span>)</span><span> </span><span>(</span><span>[</span><span>]</span><span>byte</span><span>,</span><span> </span><span>error</span><span>)</span><span> </span><span>{</span><span></span><br/></span><span><span>	bitsPerChar </span><span>:=</span><span> </span><span>5</span><span></span><br/></span><span><span>	</span><span>if</span><span> algorithm </span><span>==</span><span> LOWER_UPPER_DIGIT_SPECIAL </span><span>{</span><span></span><br/></span><span><span>		bitsPerChar </span><span>=</span><span> </span><span>6</span><span></span><br/></span><span><span>	</span><span>}</span><span></span><br/></span><span><span>	</span><span></span><br/></span><span><span>	</span><span></span><br/></span><span><span>	</span><span></span><br/></span><span><span></span><br/></span><span><span>	</span><span></span><br/></span><span><span>	</span><span></span><br/></span><span><span>	stripLastChar </span><span>:=</span><span> </span><span>(</span><span>data</span><span>[</span><span>0</span><span>]</span><span> </span><span>&amp;</span><span> </span><span>0x80</span><span>)</span><span> </span><span>&gt;&gt;</span><span> </span><span>7</span><span></span><br/></span><span><span>	totBits </span><span>:=</span><span> </span><span>len</span><span>(</span><span>data</span><span>)</span><span>*</span><span>8</span><span> </span><span>-</span><span> </span><span>1</span><span> </span><span>-</span><span> </span><span>int</span><span>(</span><span>stripLastChar</span><span>)</span><span>*</span><span>bitsPerChar</span><br/></span><span><span>	totChars </span><span>:=</span><span> totBits </span><span>/</span><span> bitsPerChar</span><br/></span><span><span>	chars </span><span>:=</span><span> </span><span>make</span><span>(</span><span>[</span><span>]</span><span>byte</span><span>,</span><span> totChars</span><span>)</span><span></span><br/></span><span><span>	bitPos</span><span>,</span><span> bitCount </span><span>:=</span><span> </span><span>6</span><span>,</span><span> </span><span>1</span><span> </span><span></span><br/></span><span><span>	</span><span>for</span><span> i </span><span>:=</span><span> </span><span>0</span><span>;</span><span> i </span><span>&lt;</span><span> totChars</span><span>;</span><span> i</span><span>++</span><span> </span><span>{</span><span></span><br/></span><span><span>		</span><span>var</span><span> val </span><span>byte</span><span> </span><span>=</span><span> </span><span>0</span><span></span><br/></span><span><span>		</span><span>for</span><span> i </span><span>:=</span><span> </span><span>0</span><span>;</span><span> i </span><span>&lt;</span><span> bitsPerChar</span><span>;</span><span> i</span><span>++</span><span> </span><span>{</span><span></span><br/></span><span><span>			</span><span>if</span><span> data</span><span>[</span><span>bitCount</span><span>/</span><span>8</span><span>]</span><span>&amp;</span><span>(</span><span>1</span><span>&lt;&lt;</span><span>bitPos</span><span>)</span><span> </span><span>&gt;</span><span> </span><span>0</span><span> </span><span>{</span><span></span><br/></span><span><span>				val </span><span>|=</span><span> </span><span>1</span><span> </span><span>&lt;&lt;</span><span> </span><span>(</span><span>bitsPerChar </span><span>-</span><span> i </span><span>-</span><span> </span><span>1</span><span>)</span><span></span><br/></span><span><span>			</span><span>}</span><span></span><br/></span><span><span>			bitPos </span><span>=</span><span> </span><span>(</span><span>bitPos </span><span>-</span><span> </span><span>1</span><span> </span><span>+</span><span> </span><span>8</span><span>)</span><span> </span><span>%</span><span> </span><span>8</span><span></span><br/></span><span><span>			bitCount</span><span>++</span><span></span><br/></span><span><span>		</span><span>}</span><span></span><br/></span><span><span>		ch</span><span>,</span><span> err </span><span>:=</span><span> d</span><span>.</span><span>decodeChar</span><span>(</span><span>val</span><span>,</span><span> algorithm</span><span>)</span><span></span><br/></span><span><span>		</span><span>if</span><span> err </span><span>!=</span><span> </span><span>nil</span><span> </span><span>{</span><span></span><br/></span><span><span>			</span><span>return</span><span> </span><span>nil</span><span>,</span><span> err</span><br/></span><span><span>		</span><span>}</span><span></span><br/></span><span><span>		chars</span><span>[</span><span>i</span><span>]</span><span> </span><span>=</span><span> ch</span><br/></span><span><span>	</span><span>}</span><span></span><br/></span><span><span>	</span><span>return</span><span> chars</span><span>,</span><span> </span><span>nil</span><span></span><br/></span><span><span></span><span>}</span><br/></span></code></pre></div></div>
<h2 id="select-best-encoding">Select Best Encoding<a href="#select-best-encoding" aria-label="Direct link to Select Best Encoding" title="Direct link to Select Best Encoding">​</a></h2>
<p>For most lowercase characters, meta string will use <code>5</code> bits to encode every char. For string containing uppercase chars, meta string will try to convert the string into a lower case representation by inserting some markers, and compare used bytes with <code>6</code> bits encoding, then select the encoding which has smaller encoded size.</p>
<p>Here is the common encoding selection strategy:</p>
<table><thead><tr><th>Encoding Flag</th><th>Pattern</th><th>Encoding Algorithm</th></tr></thead><tbody><tr><td>LOWER_SPECIAL</td><td>every char is in <code>a-z._|</code></td><td><code>LOWER_SPECIAL</code></td></tr><tr><td>FIRST_TO_LOWER_SPECIAL</td><td>every char is in <code>a-z._</code> except first char is upper case</td><td>replace first upper case char to lower case, then use <code>LOWER_SPECIAL</code></td></tr><tr><td>ALL_TO_LOWER_SPECIAL</td><td>every char is in <code>a-zA-Z._</code></td><td>replace every upper case char by <code>|</code> + <code>lower case</code>, then use <code>LOWER_SPECIAL</code>, use this encoding if it&#39;s smaller than Encoding <code>LOWER_UPPER_DIGIT_SPECIAL</code></td></tr><tr><td>LOWER_UPPER_DIGIT_SPECIAL</td><td>every char is in <code>a-zA-Z._</code></td><td>use <code>LOWER_UPPER_DIGIT_SPECIAL</code> encoding if it&#39;s smaller than Encoding <code>FIRST_TO_LOWER_SPECIAL</code></td></tr><tr><td>UTF8</td><td>any utf-8 char</td><td>use <code>UTF-8</code> encoding</td></tr><tr><td>Compression</td><td>any utf-8 char</td><td>lossless compression</td></tr></tbody></table>
<p>For package name, module name or namespace, <code>LOWER_SPECIAL</code> will be used mostly. <code>ALL_TO_LOWER_SPECIAL</code> can be used too, since it can represent the same chars as <code>LOWER_SPECIAL</code> without using more bits, but also support string with uppercase chars.</p>
<p>For className, <code>FIRST_TO_LOWER_SPECIAL</code> will be used mostly. If there are multiple uppercase chars, then <code>ALL_TO_LOWER_SPECIAL</code> will be used instead.
If a string contains digits, then <code>LOWER_UPPER_DIGIT_SPECIAL</code> will be used.</p>
<p>Finally, utf8 will be the fallback encoding if the string contains some chars which is not in range <code>a-z0-9A-Z</code>.</p>
<h2 id="encoding-flags-and-data-jointly">Encoding Flags and Data jointly<a href="#encoding-flags-and-data-jointly" aria-label="Direct link to Encoding Flags and Data jointly" title="Direct link to Encoding Flags and Data jointly">​</a></h2>
<ul>
<li>Depending on the case, one can choose encoding <code>flags + data</code> jointly, using 3 bits of first byte for flags and other bytes for data. This can be useful since there are some holes remaining in last byte, adding flags in data doesn&#39;t always increase serialized bytes size.</li>
<li>Or one can use a header to encode such flags with other meta such as encoded size, this is what Fury does in <a href="https://github.com/apache/incubator-fury/pull/1556" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-fury/pull/1556</a></li>
</ul>
<h2 id="benchmark">Benchmark<a href="#benchmark" aria-label="Direct link to Benchmark" title="Direct link to Benchmark">​</a></h2>
<p>utf8 encoding uses <code>30</code> bytes for string <code>org.apache.fury.benchmark.data</code>, fury meta string uses only <code>19</code> bytes.
utf8 encoding uses <code>12</code> bytes for string <code>MediaContent</code>, but fury meta string uses only <code>9</code> bytes.</p>
<div><div><pre tabindex="0"><code><span><span></span><br/></span><span><span></span><span>assertEquals</span><span>(</span><span>encoder</span><span>.</span><span>encode</span><span>(</span><span>&#34;org.apache.fury.benchmark.data&#34;</span><span>)</span><span>.</span><span>getBytes</span><span>(</span><span>)</span><span>.</span><span>length</span><span>,</span><span> </span><span>19</span><span>)</span><span>;</span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span>assertEquals</span><span>(</span><span>encoder</span><span>.</span><span>encode</span><span>(</span><span>&#34;MediaContent&#34;</span><span>)</span><span>.</span><span>getBytes</span><span>(</span><span>)</span><span>.</span><span>length</span><span>,</span><span> </span><span>9</span><span>)</span><span>;</span><br/></span></code></pre></div></div></div></div>
  </body>
</html>
