<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.thestack.technology/rfc9420-ietf-mls-standard/">Original</a>
    <h1>RFC 9420 – A Messaging Layer Security Overview</h1>
    
    <div id="readability-page-1" class="page"><article>
    <div>
      <p>Today, the Messaging Layer Security (MLS) protocol has been published as <a href="https://datatracker.ietf.org/doc/html/rfc9420?ref=thestack.technology">RFC 9420</a>, a standards track document by the Internet Engineering Task Force (IETF). MLS is the first standardized and fully specified end-to-end encryption protocol. The specification is freely accessible, and its security has been analyzed in a series of academic publications.</p><p>Our team has been involved in the design and development of the MLS protocol since the very beginning. Over the course of five years, along with others from the MLS IETF working group, we have iterated to combine modern academic proposals with real-life requirements from the industry. The protocol has already proven its aptitude in large-scale deployments with major companies like Cisco and RingCentral having already integrated an early version of MLS into their products, serving millions of users.</p><p>This blog post gives a high-level overview of MLS, its practical applications, and why it matters.</p><figure><img src="https://www.thestack.technology/content/images/2023/07/Header-MLS-RFC.png" alt="" loading="lazy" width="1140" height="690" srcset="https://www.thestack.technology/content/images/size/w600/2023/07/Header-MLS-RFC.png 600w, https://www.thestack.technology/content/images/size/w1000/2023/07/Header-MLS-RFC.png 1000w, https://www.thestack.technology/content/images/2023/07/Header-MLS-RFC.png 1140w" sizes="(min-width: 720px) 720px"/></figure><h2 id="the-early-days-and-the-standardization-process">The early days and the standardization process</h2><p>Prior to MLS, a comprehensive specification of a protocol for end-to-end encryption informed by industry-wide input did not exist.</p><p>Protocols like the <a href="https://otr.cypherpunks.ca/?ref=thestack.technology">Off-the-Record protocol</a>, the <a href="https://wickr.com/wickrs-messaging-protocol/?ref=thestack.technology">Wickr protocol</a>, and the <a href="https://www.signal.org/docs/?ref=thestack.technology">Signal protocol</a> paved the way with modern security properties and asynchronous messaging capabilities.</p><p>The Signal protocol introduced the asynchronous mode of operation the Off-the-Record protocol was lacking and has made end-to-end encryption available to mobile messaging. It has since become the reference for practical and high-quality end-to-end encryption. However, a <a href="https://github.com/SilentCircle/libzina?ref=thestack.technology">few</a> <a href="https://github.com/wireapp/proteus?ref=thestack.technology">derivatives</a> <a href="https://gitlab.matrix.org/matrix-org/olm?ref=thestack.technology">emerged</a> due to the lack of both a full specification and permissively licensed implementations. These derivatives have seen different levels of analysis and every provider has had to maintain their own libraries.</p><p>Generally, existing protocols were typically focused on end-to-end encryption between two peers. Using them to protect group chats with many peers proved difficult and either meant compromising on security properties or accepting high computational and bandwidth costs.</p><p><a href="https://www.mozilla.org/?ref=thestack.technology">Various</a> <a href="http://cisco.com/?ref=thestack.technology">stakeholders</a> <a href="http://facebook.com/">from</a> <a href="http://google.com/?ref=thestack.technology">the</a> <a href="http://wire.com/?ref=thestack.technology">industry</a> <a href="https://www.ox.ac.uk/?ref=thestack.technology">and</a> <a href="http://inria.fr/?ref=thestack.technology">academia</a> identified these gaps and started initial talks for an open standard for asynchronous group messaging with modern security properties solving an entire range of issues. In March 2018, these “<a href="https://datatracker.ietf.org/meeting/101/materials/minutes-101-mls-00?ref=thestack.technology">Birds of a Feather” finally flocked together</a> and the MLS working group was subsequently established.</p><p>During the protocol design process, the working group followed an iterative approach that involved multiple rounds of review, feedback, and refinement. Regular members of the working group, as well as other interested individuals, carefully reviewed the Internet-Drafts, providing feedback, suggesting changes, and engaging in technical discussions. Numerous cryptographic experts from academia and industry analyzed MLS and the different security guarantees it aims to provide, sharing their findings in <a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-10?ref=thestack.technology#name-cryptographic-analysis-of-t">several academic publications</a>. This was particularly beneficial to mitigate security issues before deploying it in production environments.</p><p>Compared to existing protocols such as the Off-the-Record and the Signal protocol, MLS offers improvements in multiple ways.</p><h2 id="efficiency-do-more-with-less">Efficiency: Do more with less</h2><p>Secure messaging protocols in use today were designed as one-to-one protocols, with group messaging functionality built directly from one-to-one channels between all group members. This leaves the sender of a message to encrypt and upload a message for each other group member individually, leading to a complexity of O(n), where n is the number of members in a group. In contrast, MLS typically has costs of O(log n) for the same scenario, making it well-suited even for large groups.</p><p>Constructions such as <a href="https://www.whatsapp.com/security/WhatsApp-Security-Whitepaper.pdf?ref=thestack.technology">Sender Keys</a> improve the efficiency of the approach of one-to-one protocols, however, their security guarantees do not reach those of the base protocol. In particular, achieving good <em>Post-Compromise Security</em> guarantees is prohibitively expensive with Sender Keys. In other words, removing users from a group chat or ensuring a compromised device has no long-term negative impact incurs high bandwidth and computation costs for all members of the group. To recover from a compromise of a single member of the group, all other members have to broadcast an update of their key material. This leads to an overall cost of computation and bandwidth of O(n^2) for a group size of n and requires all group members to come online at least once. In contrast, MLS has an update operation with complexity of O(log n)  that requires only the compromised member to be online for the group to recover from the compromise.</p><p>MLS achieves its low complexity through the use of a binary tree. This means that the number of required operations and the payload size do not increase linearly with the group size but rather only logarithmically after a short warm-up period. Example: In a group with 1000 members, the number of required operations to calculate new group keys would only be 10 as opposed to 1000 with existing protocols. With an assumed base payload size of 100 B per key negotiation, the total payload size would only be 1 KB instead of 100 KB.</p><figure><img src="https://blog.phnx.im/content/images/2023/07/MLS-performance-projection-1.png" alt="" loading="lazy" width="2000" height="1600"/><figcaption>Performance projection: Number of operations required to calculate new group keys with MLS (blue) versus existing group messaging protocols (red).</figcaption></figure><h2 id="a-new-security-notion-group-integrity">A new security notion: Group Integrity</h2><p>As existing protocols don’t have a notion of groups, messaging apps either manage group membership on the server side in plain text or combine the end-to-end encryption protocol with an additional group management protocol such as <a href="https://eprint.iacr.org/2019/1416.pdf?ref=thestack.technology">Signal’s Private Group System</a>.</p><p>In MLS, all group members cryptographically agree on the current state of the group, including who is a part of it. As a consequence, a group member can only decrypt messages from other group members if the sender and the receiver generally agree on the group state and specifically on who is in the group. In other words, it becomes impossible for a third party to add a member to a group without all existing members of the group being aware of it.</p><h2 id="synchronizing-data-in-a-distributed-system-a-hard-problem-becomes-easier">Synchronizing data in a distributed system: A hard problem becomes easier</h2><p>Distributing and synchronizing data across multiple clients can be a daunting task. Aside from confidentiality, MLS also addresses the issue of synchronizing data between members of a group. The corresponding mechanism is directly derived from the group integrity property. Instead of only agreeing on a member list, members of a group can agree on arbitrary data. MLS relies on a component called Delivery Service that ensures an in-order delivery of MLS messages. This ordering then dictates how clients move incrementally from one group state to the next.</p><p>With that, an MLS group can become a distribution channel for whatever data needs to be synchronized between different entities by guaranteeing cryptographical agreement on previous extension messages. In other words, this simply means that members of a group can be sure all other members saw the same messages previously.</p><h2 id="extensible-tune-it-for-your-needs">Extensible: Tune it for your needs</h2><p>MLS is also extensible, which means that the protocol can be modified, or additional data can be added to the state of a group. The latter can be used, for example, to attach data such as a group name or an image to the group state.</p><p>The protocol has a negotiation mechanism that ensures that extensions are only used if they are supported by all members of a group. Group members also agree on which extensions are mandatory in a group.</p><p>Since MLS is fundamentally also a group key negotiation protocol, additional cryptographic key material can be exported by all members of a group. This mechanism – called Exporter – can be used to derive encryption keys. For example, participants of audio/video calls or conferences can use MLS to generate encryption keys for end-to-end encryption of the media streams.</p><h2 id="future-proof-version-and-cipher-suite-agility">Future-proof: Version and cipher suite agility</h2><p>In contrast to many existing end-to-end encryption protocols, MLS allows members to signal which versions of MLS and which MLS cipher suites they support. In the future, this lets applications safely transition to a newer version of MLS or gradually roll out support for new cipher suites without confusion between individual clients. An example of such a transition could be that a secure messaging application rolls out MLS and later wants to transition to a post-quantum secure cipher suite.</p><p>Now that the standard is established, we focus more on making end-to-end encryption ubiquitous. We believe that accessibility to the technology is paramount, and we want to complement the specification with a general-purpose implementation published under a permissive license: <a href="https://openmls.tech/?ref=thestack.technology">OpenMLS</a>. Along with our partners at <a href="https://cryspen.com/?ref=thestack.technology">Cryspen</a>, we have evolved OpenMLS over the years into a software library that can be used in various projects. OpenMLS is licensed under the <a href="https://opensource.org/license/mit/?ref=thestack.technology">MIT license</a> to minimize friction and make it broadly accessible.</p><ul><li>See the full specification: <a href="https://datatracker.ietf.org/doc/html/rfc9420?ref=thestack.technology">RFC 9420</a></li><li>Don’t want to read anymore? Listen to the <a href="https://scw.quest/2023/04/22/mls/?ref=thestack.technology">Security Cryptography Whatever Podcast episode about MLS</a></li><li>Tired of listening? Watch the <a href="https://www.youtube.com/watch?v=zrjmpyc8YrE&amp;ref=thestack.technology">Black Hat talk on MLS: Towards a New Era of Secure Group Messaging</a></li></ul><hr/><p>Our team has been active in the secure messaging field for over a decade and co-authored the MLS protocol specification. If you are interested in using MLS in general or our MLS implementation (<a href="https://openmls.tech/?ref=thestack.technology">OpenMLS</a>) in particular in your application, do not hesitate to <a href="mailto:hello@phnx.im">contact us</a> and let us know how we can help. We offer consulting services around MLS and messaging architecture as well as development services related to OpenMLS.</p><p><em>This blog first appeared <a href="https://blog.phnx.im/rfc-9420-mls?ref=thestack.technology">here</a>. </em></p>
    </div>


      </article></div>
  </body>
</html>
