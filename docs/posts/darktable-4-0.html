<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.darktable.org/2022/07/darktable-4.0.0-released/">Original</a>
    <h1>Darktable 4.0</h1>
    
    <div id="readability-page-1" class="page"><div><p>
            posted on
            <time title="2022-07-02T07:00:00+00:00">Sat 2 July 2022</time></p><address>by
  <a rel="author" href="https://www.darktable.org/author/pascal-obry/">Pascal Obry</a>
</address>
          </div><div>
            <p>We’re proud to announce the new feature release of darktable, 4.0.0!</p>
<p>The github release is here: <a href="https://github.com/darktable-org/darktable/releases/tag/release-4.0.0">https://github.com/darktable-org/darktable/releases/tag/release-4.0.0</a>.</p>
<p>As always, please don’t use the autogenerated tarball provided by
github, but only our tar.xz file. The checksums are:</p>
<pre tabindex="0"><code>$ sha256sum darktable-4.0.0.tar.xz
1416f8f59717e65a6220541aaa12eacca93888ce5176f2c9ab6c17b9cc53cc2d  darktable-4.0.0.tar.xz
$ sha256sum darktable-4.0.0.dmg
addab784af18bafa303340e754c00084c126e61c3d5b93006f8e6d602f838203  darktable-4.0.0.dmg
$ sha256sum darktable-4.0.0-win64.exe
d0e09efb2f74beae9f5387a296d366c160d9fb87e571c9559c53cd0111b7b955  darktable-4.0.0-win64.exe
</code></pre><p>When updating from the stable 3.8.x series, please bear in
mind that your edits will be preserved during this process, but the new
library and configuration will no longer be usable with 3.8.x.</p>
<p>You are strongly advised to take a backup first.</p>
<h4 id="important-note-to-make-sure-that-darktable-can-keep-on-supporting-the-raw-file-format-for-your-camera-please-read-this-posthttpsdiscusspixlsustraw-samples-wanted5420ulebedevri-on-howwhat-raw-samples-you-can-contribute-to-ensure-that-we-have-the-full-raw-sample-set-for-your-camera-under-cc0-license">Important note: to make sure that darktable can keep on supporting the raw file format for your camera, <em>please</em> read <a href="https://discuss.pixls.us/t/raw-samples-wanted/5420?u=lebedevri">this post</a> on how/what raw samples you can contribute to ensure that we have the <em>full</em> raw sample set for your camera under CC0 license!</h4>
<p>Since darktable 3.8:</p>
<ul>
<li>Almost 1600 commits to darktable+rawspeed</li>
<li>586 pull requests handled</li>
<li>123 issues closed</li>
</ul>
<h2 id="the-big-ones">The Big Ones</h2>
<p>The following is a summary of the main features added to darktable 4.0. These features
are described more fully in the user manual and accompanying blog post.</p>
<ul>
<li>
<p>Color and exposure mapping</p>
<p>A new feature in the “exposure” and “color calibration” modules allows you to
define and save a target color/exposure for the color pickers, in order to
match any source object in the image against an arbitrary target
color. This can be used to perform white balance
(chromatic adaptation) against non-gray objects of known color, or to
ensure the color consistency of an object across a series of images.</p>
</li>
<li>
<p>Filmic v6</p>
<p>Filmic v6 introduces new color science. This change removes the mandatory desaturation
close to medium white and black and replaces it with a true gamut
mapping against the output (or export) color space. This allows for more
saturated colors, notably in blue skies.</p>
<p>For users who still prefer the “desaturated highlights” look,
you can still do this by disabling chroma preservation, but v6 adds a
hue handcuff to prevent the traditional hue shift that comes with this
method (where saturated blue skies degrade to cyan and saturated red to yellow).</p>
<p>This gamut sanitization is the third and last to be added to darktable,
which now has a fully-sanitized color pipeline from input (color calibration),
through artistic changes (color balance rgb) to output (filmic v6). Users
can now color-grade pictures safely in the knowledge that invalid input
colors can be recovered in the least destructive fashion possible early
in the pipeline, and valid colors can’t be pushed out of gamut along the pipeline.</p>
<p>Note: If modules are applied after filmic in the pipeline, they
don’t benefit from this gamut mapping and rely on LittleCMS2 (if
enabled) at the final export stage, which does not gamut map as it
should, and probably never did.</p>
</li>
<li>
<p>Guided laplacian highlight reconstruction</p>
<p>A new “guided laplacian” method has been added to the “highlight
reconstruction” module. This uses an iterative and multi-scale wavelet
scheme to extract valid details from non-clipped RGB channel(s) if any,
uses these details to guide the reconstruction of clipped channels, and finally
propagates the color gradients from neighboring valid regions using
edge-aware color diffusion. This limits color bleeding through edges
(preventing green leaves from bleeding color in the reconstruction of clipped
blue sky, for example).</p>
<p>A noise setting allows Poisson noise to be added to reconstructed highlights,
in order to help blend them into noisy high-ISO images.</p>
<p>This method is only available for Bayer sensors and cannot be adapted
to X-Trans sensors.</p>
</li>
<li>
<p>Introducing the darktable Uniform Color Space 2022</p>
<p>The darktable UCS 22 is a perceptually uniform color space designed
from psychoperceptual experimental data specifically for the purpose
of artistic saturation changes, as performed in the <em>color balance RGB</em> module.
It uses a brightness-saturation scheme that compensates for the Helmholtz-Kohlraush effect
(accounting for the contribution of colorfulness in perceived brightness)
and allows an efficient gamut-mapping against pipeline RGB at constant
brightness. It will make the saturation control in <em>color balance RGB</em>
better behaved.</p>
</li>
<li>
<p>UI Rewrite</p>
<p>The UI has been completely revamped again to improve look and consistency.
Padding, margins, color, contrast, alignment, and icons have been reworked
throughout.</p>
<p>Collapsible sections within modules have also been redesigned so that
their functionality is more obvious and better-looking.
New collapsible sections have been added to avoid
cluttering the UI in the following modules:</p>
<ul>
<li>channel mixer rgb</li>
<li>exposure</li>
<li>color calibration</li>
</ul>
<p>The vignetting module has been split into two sections for clarity.</p>
<p>Superfluous sections have been removed from the “crop” and “white balance”.</p>
<p>Support has been added for the IPAPGothic font.</p>
<p>The module-description tooltips have been reworked to ensure better layout.</p>
<p>Finally the default theme has been changed to Elegant Grey. The
darktable default is now in line with the theme recommended by the
team.</p>
</li>
<li>
<p>Performance and OpenCL support changes</p>
<p>All performance and OpenCL settings and pixelpipe optimizations have been
fully reviewed and updated. Many new optimizations have been
added and the user preferences have been simplified.</p>
<p>All configurations are now per-device allowing each OpenCL
device to be tuned separately.</p>
<p>Performance configuration is now applied at runtime and no longer
requires darktable to be restarted when changed.</p>
<p>Some modules had incorrect or overly conservative tiling factors, which made
darktable unnecessarily slow (since tiling was used when it was not required)
The followimg modules have been updated</p>
<ul>
<li>demosaic (X-Trans)</li>
<li>retouch</li>
</ul>
</li>
</ul>
<h2 id="other-changes">Other Changes</h2>
<ul>
<li>
<p>Color glossary</p>
<p>The global color picker tool (in the darkroom’s left sidebar) now displays
the name of the picked color in the tooltip. This feature was
requested by several color-disabled photographers, to assert the
perceptual validity of their editing for an average observer.</p>
<p>The color vocabulary contains 76 entries: 15 hues × 5 lightnesses +
neutral (gray). It does not separate across the chroma axis, so all
colors are registered the same no matter their colorfulness.</p>
<p>The vocabulary also contains average skin colors for 3 body
parts (forearm, forehead and cheek) of 6 ethnicities (Chinese, Thai,
Kurdish, Mexican, Caucasian, African-American). These values come from
the academic databases of cosmetology and dermatology available at the
time of programming. They are only valid for a D65 illuminant and for
an exposure setting that anchors diffuse white at 92% relative
luminance.</p>
</li>
<li>
<p>A new “contrast” parameter has been added to the guide line overlay
settings, allowing for better visibility of the lines over images.</p>
</li>
<li>
<p>A new “collection filters” module has been introduced, designed to be easier
to use than the filtering in the current “collections” module.</p>
<p>The new module allows the current collection to be sorted and filtered using multiple
criteria. Each sort/filter rule can be pinned, which duplicates the appropriate control
on the top tool bar for quick access.</p>
<p>The following filters have been implemented (more to come in the next version):
color labels, text search, date-time filters, exposure, ISO,
focal length, aperture, aspect ratio, filename and extension,
grouping, history, local copy, module order</p>
<p>Presets can be created and a history button also allows previous configuration to be retrieved.</p>
<p>All-new text and color filter widgets have been implemented.</p>
</li>
<li>
<p>The “recently used collections” module is now incorporated into the
“collections” module as a “history” button</p>
</li>
<li>
<p>The darkroom’s module search facility has been enhanced to also match on
any user-defined module names.</p>
</li>
<li>
<p>Support for EXR 16-bit (half) float export has been added.</p>
</li>
<li>
<p>All usage of dates/times have been reworked to better support
time-zones and differing operating systems. Support for
milliseconds has also been added.</p>
</li>
<li>
<p>All presets in the “tone equalizer” module have been updated to use
scene-referred blending modes.</p>
</li>
<li>
<p>The new input system introduced in version 3.8 now handles
simultaneous shortcut presses and the responsiveness is
greatly improved.</p>
<p>MIDI configuration parameters are now specified in darktable
resource files.</p>
<p>Slider step sizes have been standardized and can now be
configured individually.</p>
<p>Extra pen tablet button clicks are now treated as key presses so that
they can be used in shortcuts.</p>
<p>Support for gamepad triggers has been added (treating them as buttons)
allowing them to be used as shortcuts.</p>
</li>
<li>
<p>Modifiers (<kbd>Ctrl</kbd>/<kbd>Shift</kbd>/<kbd>Ctrl+Shift</kbd>)
can now be used when dragging sliders, to modify the precision of the
value changes.</p>
</li>
<li>
<p>When using the “copy” and “move” functionality in the lighttable, the last
directories are remembered independently for each operation.</p>
</li>
<li>
<p>It is now possible to scroll over a tabbed module to switch tabs.</p>
</li>
<li>
<p>Improved monochrome images support:</p>
<p>True monochrome images (like those from Leica) and images from cameras
that have the color matrix filter in front of the sensor removed,
are now treated the same in the user interface as much as possible.</p>
</li>
<li>
<p>The tagging suggestion mode has been improved.</p>
</li>
<li>
<p>The overlay layout in the print view has been enhanced.</p>
</li>
<li>
<p>The “retouch” module’s heal iteration limit has been increased for new edits.</p>
</li>
<li>
<p>It is now possible to edit a single node on a brush path. You can
change the size, opacity and hardness of each node independently.</p>
</li>
<li>
<p>A new button in the “highlight reconstruction” module allows clipped pixels
to be better visualized.</p>
</li>
<li>
<p>The raw overexposure function now shows actual sensor clipping rather than being
adjusted according to the white balance of the image. This is better
suited to the default scene-referred workflow.</p>
</li>
<li>
<p>Shortcuts can now be directed to the currently-focused processing module
instance instead of the currently-expanded one.</p>
</li>
<li>
<p>The control of the lighttable view has been improved by ensuring the up/down
and left/right keys have the expected behavior.</p>
</li>
<li>
<p>Apply a blur when color picking in area mode. This ensures that color picker
measurements aren’t overly influenced by image noise. This change particularly
improves the stability of filmic’s black relative exposure measurement.</p>
</li>
<li>
<p>Add support for DNG GainMap EXIF information and update the pixel
gain in raw-prepare module. This gives a better initial exposure
to the imported DNG pictures.</p>
</li>
</ul>
<h2 id="bug-fixes">Bug Fixes</h2>
<ul>
<li>
<p>Check for total memory on Linux is now more portable.</p>
</li>
<li>
<p>MIDI buttons with light status are now properly updated.</p>
</li>
<li>
<p>Tab shortcut tooltips are correctly displayed on tabbed modules.</p>
</li>
<li>
<p>Misalignments between source and target patches in the retouch module
have been resolved. “Jumpy” movements are also improved when adjusting
nodes or segments.</p>
</li>
<li>
<p>The start of culling mode is improved, especially where no images are
selected and/or under the mouse.</p>
</li>
<li>
<p>Local-copy status icon position fixed in block overlay.</p>
</li>
<li>
<p>Crop handle positions fixed when using fast movements.</p>
</li>
<li>
<p>RCD OpenCL tiling issues resolved.</p>
</li>
<li>
<p>Tile stitching for X-Trans sensors</p>
</li>
<li>
<p>Filmstrip update fixed if crop is left open when moving to next
image.</p>
</li>
<li>
<p>“collections” module now correctly updated when new images are imported.</p>
</li>
<li>
<p>Landscape/portrait print handling was broken due to a recent CUPS change. We
now rely on the CUPS filter for the proper orientation.</p>
</li>
<li>
<p>Fixed possible PDF corruption in export and print modules due to
duplicate written byte count.</p>
</li>
<li>
<p>Fixed a possible race conditions in retouch and color reconstruction
OpenCL code making darktable crash.</p>
</li>
<li>
<p>Properly transform points for the rotation computation in
perspective correction. This fixes an issue when the image is
flipped making it impossible to use the rotation control.</p>
</li>
<li>
<p>Removed RatingPercent in EXIF data as it is not standardized and
can confuse the Windows image viewer.</p>
</li>
<li>
<p>Fixed label/reject behavior when multiple images are selected:</p>
<p>When attempting to reject multiple images, they will now be set to rejected if
<strong>any</strong> of them are not currently rejected. They will be set to un-rejected if
<strong>all</strong> of them are currently rejected.</p>
<p>This allows for more predictable handling of images with inconsistent reject statuses.</p>
<p>Similar changes have also been made when toggling color labels on/off.</p>
</li>
<li>
<p>Fixed white balance preset lookup in the “white balance” module.</p>
</li>
<li>
<p>Fixed some possible missing refresh of the metadata editor.</p>
</li>
<li>
<p>Fixed possible translation issue on Windows.</p>
</li>
</ul>
<h2 id="lua">Lua</h2>
<h2 id="notes">Notes</h2>
<h2 id="changed-dependencies">Changed Dependencies</h2>
<p>N/A</p>
<h2 id="rawspeed-changes">RawSpeed changes</h2>
<h2 id="camera-support-compared-to-38">Camera support, compared to 3.8</h2>
<h3 id="base-support">Base Support</h3>
<h3 id="white-balance-presets">White Balance Presets</h3>
<ul>
<li>Nikon D4S</li>
<li>Panasonic DC-S5</li>
<li>Sony ILCE-7M4</li>
</ul>
<h3 id="noise-profiles">Noise Profiles</h3>
<h3 id="custom-color-matrices">Custom Color Matrices</h3>
<h3 id="suspended-support">Suspended Support</h3>
<p>No samples on raw.pixls.us</p>
<ul>
<li>Canon EOS M2</li>
<li>Creo/Leaf Aptus 22(LF3779)/Hasselblad H1</li>
<li>Fujifilm FinePix HS50EXR</li>
<li>Fujifilm FinePix S6000fd</li>
<li>Fujifilm FinePix S9600fd</li>
<li>Fujifilm IS-1</li>
<li>GoPro FUSION</li>
<li>Kodak EasyShare Z980</li>
<li>Leaf Aptus-II 5(LI300059)/Mamiya 645 AFD</li>
<li>Leaf Credo 60</li>
<li>Leaf Credo 80</li>
<li>Leica D-LUX 6</li>
<li>Minolta DiMAGE 5</li>
<li>Nikon 1 J4</li>
<li>Nikon 1 S1</li>
<li>Nikon Coolpix P7700</li>
<li>Nikon D1H</li>
<li>Nikon D2H</li>
<li>Nikon D3S</li>
<li>Olympus E-10</li>
<li>Olympus SP320</li>
<li>Olympus SP570UZ</li>
<li>Panasonic DMC-FX150</li>
<li>Panasonic DMC-G2</li>
<li>Pentax K200D</li>
<li>Pentax K2000</li>
<li>Pentax Q10</li>
<li>Phase One IQ250</li>
<li>Samsung GX10</li>
<li>Samsung GX20</li>
<li>Samsung NX5</li>
<li>Samsung NX10</li>
<li>Samsung NX11</li>
<li>Samsung NX20</li>
<li>Samsung NX2000</li>
<li>Samsung EK-GN120</li>
<li>Samsung SM-G920F</li>
<li>Samsung SM-G935F</li>
<li>Sinar Hy6/ Sinarback eXact</li>
<li>Sony DSLR-A380</li>
<li>Sony DSLR-A560</li>
<li>ST Micro STV680</li>
</ul>
<h2 id="translations">Translations</h2>
<ul>
<li>Czech</li>
<li>German</li>
<li>Esperanto</li>
<li>European Spanish</li>
<li>Finnish</li>
<li>French</li>
<li>Hebrew</li>
<li>Hungarian</li>
<li>Italian</li>
<li>Japanese</li>
<li>Dutch</li>
<li>Brazilian Portuguese</li>
<li>Russian</li>
<li>Slovenian</li>
<li>Turkish</li>
<li>Ukrainian</li>
<li>Chinese - China</li>
</ul>

          </div></div>
  </body>
</html>
