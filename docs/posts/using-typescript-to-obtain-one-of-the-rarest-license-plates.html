<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.jack.bio/blog/licenseplate">Original</a>
    <h1>Using TypeScript to Obtain One of the Rarest License Plates</h1>
    
    <div id="readability-page-1" class="page"><article><p>Most people never think twice about the random mix of letters and numbers the DMV assigns them.</p>
<p>I&#39;m not one of those people.</p>
<p>Online, I&#39;ve always chased having a clean and memorable digital identity. Over the years, I&#39;ve been able to pick up handles like my first + last name on Instagram (@jlaf) and full words across platforms (@explain, @discontinue). So when the DMV mailed me my third reminder to renew my registration, that same instinct kicked in: why <em>hadn&#39;t</em> I considered getting a distinctive plate combination of my own?</p>
<p>In the world of license plates exists a rarity hierarchy:</p>
<ul>
<li>Single number license plates (10 possible)</li>
<li>Repeating number license plates (10 possible)</li>
<li>Single letter license plates (26 possible)</li>
<li>Repeating letter combinations (??? possible)</li>
<li>Two letter plate combinations (676 possible)</li>
</ul>
<p>After some research about the history these rare plates, my curiosity got the best of me. How rare could you really go? And how far can you push a state&#39;s public lookup tools to find out?</p>
<h2>PlateRadar &amp; the Monopoly</h2>
<p>As it stands right now, there&#39;s a single resource to find mass information on license plate availability: PlateRadar. PlateRadar, like any smart website, recognizes that this data is definitely worth something to someone - and as a result, hides any information that might be deemed rare behind a 20 dollar a month paywall. The site also refreshes every 24 hours, and from my history with rare usernames I know that time is of the absolute essence when snagging something rare. 24 hours wasn&#39;t going to cut it.</p>
<p><img src="https://www.jack.bio/images/licenseplate/one.png" alt="Image.png"/></p>
<p><img src="https://www.jack.bio/images/licenseplate/two.png" alt="Image.png"/></p>
<p>Unfortunately for PlateRadar, I&#39;m an engineer and not a normal human being, so I decided to dig in on how vanity plates are deemed available or unavailable.</p>
<h2>Florida&#39;s Vanity Plate Checker</h2>
<p>Florida, unlike some states (!), provides a website that allows you to check a license plate configuration (meaning the custom sequence of letters/numbers that you want printed on your plate) before you waste your time sitting in line at the tax collector&#39;s office. The tool also provides the plate types that support that combination, as different plates also allow different character limits (for example, some only permit 5 characters while allow others up to 7 characters).</p>
<p><img src="https://www.jack.bio/images/licenseplate/three.png" alt="Image.png"/></p>
<p>Thankfully, the site had the nifty feature to check more than a single combination at a time, with no additional delay in the request. I was submitting some combinations manually before realizing that I was able to make requests pretty fast manually - so what if I just automated this whole process?</p>
<h3>The Rate is Limitless</h3>
<p>I fired up Burp Suite and proxied a request to the service. What came through looked like this:</p>
<pre data-theme="unknown" data-lang="txt" data-ch="true"><div><p><span>POST https://services.flhsmv.gov/mvcheckpersonalplate/ HTTP/1.1</span>
</p><p><span>__VIEWSTATE=/wEPDwULLTE2Nzg2NjE0NDgPZBYCZg9kFgICAw9kFgICAQ9kFgwCBQ8PFgIeBFRleHQFCUFWQUlMQUJMRWRkAgcPDxYCHgdWaXNpYmxlZ2RkAgsPDxYCHwAFASBkZAIRDw8WAh8ABQEgZGQCFw8PFgIfAAUBIGRkAh0PDxYCHwAFASBkZGQZj5Nowpt7uQW4i5K8gYM8k2+WSv9Zz0wpvFKj57zF0w==</span>
</p><p><span>__VIEWSTATEGENERATOR=0719FE0A</span>
</p><p><span>__EVENTVALIDATION=/wEdAAlM0TkirL0XIlY9Dw0k/5tSphigSR1TLsx/PgGne7pkToFkrQPgalhmo+FySJy6U4iQeyzYgJga2PpZFeMkYbpKuFA0Lbs4tsi+aCEe29qpNhTkiCU5GKYk9WuPyhuiSM5sZFBTNc+Q1lCok0SfYOt8+CHI2KGhrgOke/DbhB4LDccabLrTZbd0ckqhWOrhQ2MjwxuXnk/njUGbYQbYHdP4Ds+OFyUVKVe45DGbH/0quQ==</span>
</p><p><span>ctl00$MainContent$txtInputRowOne=MYPLATE</span>
</p><p><span>ctl00$MainContent$txtInputRowTwo</span>
</p><p><span>ctl00$MainContent$txtInputRowThree</span>
</p><p><span>ctl00$MainContent$txtInputRowFour</span>
</p><p><span>ctl00$MainContent$txtInputRowFive</span>
</p><p><span>ctl00$MainContent$btnSubmit=Submit</span></p></div></pre>
<p><code><span>__VIEWSTATE</span></code>, <code><span>__VIEWSTATEGENERATOR</span></code>, and <code><span>__EVENTVALIDATION</span></code> immediately tipped me off that this was an ASP.NET Web Form. Granted, this is a government website, so honestly, what else was I expecting?</p>
<p>EVENTVALIDATION is (was?) a novel security measure implemented in 2006 by the ASP.NET team to <em>&#34;prevents unauthorized requests sent by potentially malicious users from the client [..] to ensure that each and every postback and callback event originates from the expected user interface elements, the page adds an extra layer of validation on events&#34;.</em></p>
<p>In practice, it&#39;s meant to stop forged form submissions, which theoretically sounds like a scraping killer. If I had to fetch a fresh set of these variables before making any form of a request, I&#39;d quickly overwhelm the system with round-trips and get rate-limited almost immediately.</p>
<p>... except there was no ratelimiting. At all.</p>
<p>See, the website had absolutely zero CAPTCHA, IP ratelimiting, or web application firewall stopping an influx of requests from coming in. I quickly verified this by using Burp Repeater to make a number of null payload requests, which all returned a status code of 200 Successful.</p>
<p>Once I realized this, I quickly threw a script together to automate the entire process. The workflow looks something like this:</p>
<ol>
<li>Fetch the page once using real browser headers, which loads the ASP.NET form and gives me <code><span>__VIEWSTATE</span></code>, <code><span>__VIEWSTATEGENERATOR</span></code> and <code><span>__EVENTVALIDATION</span></code> - and the power to make a legitimate POST request.</li>
<li>Extract the values from the form using a Regex helper.</li>
</ol>
<pre data-theme="unknown" data-lang="typescript" data-ch="true"><div><p><span>function</span> <span>extractFormFields</span><span>(</span><span>html</span><span>:</span> <span>string</span><span>)</span><span>:</span> <span>{</span>
</p><p><span>viewState</span><span>:</span> <span>string</span><span>;</span>
</p><p><span>viewStateGenerator</span><span>:</span> <span>string</span><span>;</span>
</p><p><span>eventValidation</span><span>:</span> <span>string</span><span>;</span>
</p><p><span>} {</span>
</p><p><span>const</span> <span>viewStateMatch</span> <span>=</span> <span>html</span><span>.</span><span>match</span><span>(</span><span>/id=&#34;__VIEWSTATE&#34;\s</span><span>+</span><span>value=&#34;([</span><span>^</span><span>&#34;]</span><span>+</span><span>)&#34;/</span><span>)</span><span>;</span>
</p><p><span>const</span> <span>viewStateGeneratorMatch</span> <span>=</span> <span>html</span><span>.</span><span>match</span><span>(</span>
</p><p><span>/id=&#34;__VIEWSTATEGENERATOR&#34;\s</span><span>+</span><span>value=&#34;([</span><span>^</span><span>&#34;]</span><span>+</span><span>)&#34;/</span>
</p><p><span>)</span><span>;</span>
</p><p><span>const</span> <span>eventValidationMatch</span> <span>=</span> <span>html</span><span>.</span><span>match</span><span>(</span>
</p><p><span>/id=&#34;__EVENTVALIDATION&#34;\s</span><span>+</span><span>value=&#34;([</span><span>^</span><span>&#34;]</span><span>+</span><span>)&#34;/</span>
</p><p><span>)</span><span>;</span>
</p><p><span>if</span> <span>(</span><span>!</span><span>viewStateMatch</span> <span>|| !</span><span>viewStateGeneratorMatch</span> <span>|| !</span><span>eventValidationMatch) {</span>
</p><p><span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>&#34;Failed to extract required form fields from page&#34;</span><span>)</span><span>;</span>
</p><p><span>}</span>
</p><p><span>return</span> <span>{</span>
</p><p><span>viewState</span><span>:</span> <span>viewStateMatch[</span><span>1</span><span>]</span><span>,</span>
</p><p><span>viewStateGenerator</span><span>:</span> <span>viewStateGeneratorMatch[</span><span>1</span><span>]</span><span>,</span>
</p><p><span>eventValidation</span><span>:</span> <span>eventValidationMatch[</span><span>1</span><span>]</span><span>,</span>
</p><p><span>}</span><span>;</span>
</p><p><span>}</span></p></div></pre>
<ol start="3">
<li>Build the POST request with all necessary fields. The actual plate combinations were submitted through <code><span>ctl00$MainContent$txtInputRowXXX</span></code>, where XXX was <code><span>one</span></code> through <code><span>five</span></code>. Using this let me check plate availability 5x faster - and when checking thousands of license plate combinations at a time, it definitely matters.</li>
</ol>
<pre data-theme="unknown" data-lang="typescript" data-ch="true"><div><p><span>function</span> <span>buildFormData</span><span>(</span>
</p><p><span>plates</span><span>:</span> <span>string</span><span>[]</span><span>,</span>
</p><p><span>viewState</span><span>:</span> <span>string</span><span>,</span>
</p><p><span>viewStateGenerator</span><span>:</span> <span>string</span><span>,</span>
</p><p><span>eventValidation</span><span>:</span> <span>string</span>
</p><p><span>)</span><span>:</span> <span>string</span> <span>{</span>
</p><p><span>const</span> <span>params</span> <span>= new</span> <span>URLSearchParams</span><span>()</span><span>;</span>
</p><p><span>params</span><span>.</span><span>append</span><span>(</span><span>&#34;__VIEWSTATE&#34;</span><span>,</span> <span>viewState)</span><span>;</span>
</p><p><span>params</span><span>.</span><span>append</span><span>(</span><span>&#34;__VIEWSTATEGENERATOR&#34;</span><span>,</span> <span>viewStateGenerator)</span><span>;</span>
</p><p><span>params</span><span>.</span><span>append</span><span>(</span><span>&#34;__EVENTVALIDATION&#34;</span><span>,</span> <span>eventValidation)</span><span>;</span>
</p><p><span>const</span> <span>fieldNames</span> <span>=</span> <span>[</span>
</p><p><span>&#34;ctl00$MainContent$txtInputRowOne&#34;</span><span>,</span>
</p><p><span>&#34;ctl00$MainContent$txtInputRowTwo&#34;</span><span>,</span>
</p><p><span>&#34;ctl00$MainContent$txtInputRowThree&#34;</span><span>,</span>
</p><p><span>&#34;ctl00$MainContent$txtInputRowFour&#34;</span><span>,</span>
</p><p><span>&#34;ctl00$MainContent$txtInputRowFive&#34;</span><span>,</span>
</p><p><span>]</span><span>;</span>
</p><p><span>for</span> <span>(</span><span>let</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>5</span><span>;</span> <span>i</span><span>++</span><span>) {</span>
</p><p><span>params</span><span>.</span><span>append</span><span>(</span>
</p><p><span>fieldNames[i]</span><span>,</span>
</p><p><span>i</span> <span>&lt;</span> <span>plates</span><span>.</span><span>length</span> <span>?</span> <span>plates[i]</span><span>.</span><span>toUpperCase</span><span>()</span> <span>:</span> <span>&#34;&#34;</span>
</p><p><span>)</span><span>;</span>
</p><p><span>}</span>
</p><p><span>params</span><span>.</span><span>append</span><span>(</span><span>&#34;ctl00$MainContent$btnSubmit&#34;</span><span>,</span> <span>&#34;Submit&#34;</span><span>)</span><span>;</span>
</p><p><span>return</span> <span>params</span><span>.</span><span>toString</span><span>()</span><span>;</span>
</p><p><span>}</span></p></div></pre>
<ol start="4">
<li>Submit the POST request and parse the body! Thankfully, the site returned a big ol&#39; <code><span>AVAILABLE</span></code> or <code><span>NOT AVAILABLE</span></code> for each plate combo, so that was easy enough to check in code:</li>
</ol>
<pre data-theme="unknown" data-lang="typescript" data-ch="true"><div><p><span>function</span> <span>extractPlateStatuses</span><span>(</span>
</p><p><span>html</span><span>:</span> <span>string</span><span>,</span>
</p><p><span>plates</span><span>:</span> <span>string</span><span>[]</span>
</p><p><span>)</span><span>:</span> <span>PlateCheckResult</span><span>[] {</span>
</p><p><span>const</span> <span>results</span><span>:</span> <span>PlateCheckResult</span><span>[]</span> <span>=</span> <span>[]</span><span>;</span>
</p><p><span>const</span> <span>labelIds</span> <span>=</span> <span>[</span>
</p><p><span>&#34;MainContent_lblOutPutRowOne&#34;</span><span>,</span>
</p><p><span>&#34;MainContent_lblOutPutRowTwo&#34;</span><span>,</span>
</p><p><span>&#34;MainContent_lblOutputRowThree&#34;</span><span>,</span>
</p><p><span>&#34;MainContent_lblOutputRowFour&#34;</span><span>,</span>
</p><p><span>&#34;MainContent_lblOutputRowFive&#34;</span><span>,</span>
</p><p><span>]</span><span>;</span>
</p><p><span>for</span> <span>(</span><span>let</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>plates</span><span>.</span><span>length</span><span>;</span> <span>i</span><span>++</span><span>) {</span>
</p><p><span>const</span> <span>labelId</span> <span>=</span> <span>labelIds[i]</span><span>;</span>
</p><p><span>const</span> <span>regex</span> <span>= new</span> <span>RegExp</span><span>(</span><span>`id=&#34;</span><span>${</span><span>labelId</span><span>}</span><span>&#34;[^&gt;]*&gt;([^&lt;]*)&lt;`</span><span>,</span> <span>&#34;i&#34;</span><span>)</span><span>;</span>
</p><p><span>const</span> <span>match</span> <span>=</span> <span>html</span><span>.</span><span>match</span><span>(regex)</span><span>;</span>
</p><p><span>const</span> <span>status</span> <span>=</span> <span>match</span> <span>?</span> <span>match[</span><span>1</span><span>]</span><span>.</span><span>trim</span><span>()</span> <span>:</span> <span>&#34;&#34;</span><span>;</span>
</p><p><span>const</span> <span>available</span> <span>=</span> <span>status</span><span>.</span><span>toUpperCase</span><span>()</span> <span>===</span> <span>&#34;AVAILABLE&#34;</span><span>;</span>
</p><p><span>results</span><span>.</span><span>push</span><span>({</span>
</p><p><span>plate</span><span>:</span> <span>plates[i]</span><span>,</span>
</p><p><span>available</span><span>,</span>
</p><p><span>status</span><span>:</span> <span>status</span> <span>||</span> <span>&#34;UNKNOWN&#34;</span><span>,</span>
</p><p><span>})</span><span>;</span>
</p><p><span>}</span>
</p><p><span>return</span> <span>results</span><span>;</span>
</p><p><span>}</span></p></div></pre>
<h2>The Plate War of &#39;25</h2>
<p>Once the script was running smoothly, I created a small microservice that added the results to a Postgres database with the plate combination, along with the last time it was checked. For smaller, high-value combinations (eg, any of the single letter / double letter combinations), I constantly polled every hour or two to check availability. What I <em>didn&#39;t</em> realize at the time was the system updated in real time. The moment someone reserved a plate, the Florida DMV&#39;s backend reflected the change on the next lookup.</p>
<p>To visualize the data I had scraped, I built a quick Next.js frontend that let me browse through results, filter combinations, and batch-upload plate lists from a text file for quick checking.</p>
<p><img src="https://www.jack.bio/images/licenseplate/four.png" alt="Image.png"/></p>
<p>I found some really cool plate combinations, like <code><span>WEBSITE</span></code>, <code><span>SITE</span></code>, and <code><span>CAPTCHA</span></code> . But nothing compared to the spotting one of the only remaining two-letter combination I had seen during my search: <code><span>EO</span></code>.</p>
<p>I saw that <code><span>EO</span></code> was available on November 26th. With Thanksgiving, Black Friday, and the entire weekend shutting down state offices, I assumed I had plenty of time to stroll into the Tax Collector&#39;s office and grab it.</p>
<p>December 1st rolled around and I hopped in my car at 9:30am to head towards the tax collector&#39;s office. While driving, I got a notification from my service that <code><span>EO</span></code> was no longer available. Someone had the same idea as me, and clearly must have arrived when their doors opened right at 8am. I turned the car around, defeated, and went home.</p>
<p>When I had gotten home, out of spite (and curiosity) I decided to re-run a full check on all two letter license plates.</p>
<p><img src="https://www.jack.bio/images/licenseplate/five.png" alt="Image.png"/></p>
<p>Just like that, by some weird divine timing alignment, another two-letter combination had popped back into availability.</p>
<p>My wallowing quickly ended, and I got right back in my car and drove straight to the office. After almost an hour long wait (and a conversation with a slightly confused but very patient office clerk listening to my explanation), I was able to make the reservation. HY was officially my license plate.</p>
<p><img src="https://www.jack.bio/images/licenseplate/six.png" alt="Image.png"/></p>
<p>I&#39;d show you a picture, but unfortunately Florida runs on a 60-day delivery timeline for custom plates. Still: it exists, it&#39;s paid for, and it&#39;s proof that with a little TypeScript and an unreasonable amount of determination, you can claim just about anything.</p></article></div>
  </body>
</html>
