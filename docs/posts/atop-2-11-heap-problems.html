<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://openwall.com/lists/oss-security/2025/03/29/1">Original</a>
    <h1>Atop 2.11 heap problems</h1>
    
    <div id="readability-page-1" class="page">







<a href="https://openwall.com/lists/oss-security/2025/03/28/2">[&lt;prev]</a> <a href="https://openwall.com/lists/oss-security/2025/03/28/2">[&lt;thread-prev]</a> <a href="https://openwall.com/lists/oss-security/2025/03/29/">[day]</a> <a href="https://openwall.com/lists/oss-security/2025/03/">[month]</a> <a href="https://openwall.com/lists/oss-security/2025/">[year]</a> <a href="https://openwall.com/lists/oss-security/">[list]</a>
<pre>Message-ID: &lt;53411a5a-3b7f-4993-a66e-8e93cd2efb1c@atoptool.nl&gt;
Date: Sat, 29 Mar 2025 18:39:29 +0100
From: Gerlof Langeveld &lt;gerlof.langeveld@...ptool.nl&gt;
To: oss-security@...ts.openwall.com
Subject: CVE-2025-31160 Atop 2.11 heap problems

Introduction:
Atop mainly reads the system level and process level from the /proc and
/sys directories. However, certain counters might be obtained from other
optional sources, that have to be activated explicitly.

One of these sources is the &#39;atopgpud&#39; daemon, which permanently gathers
metrics about the utilization of GPUs. It offers a local TCP port to which
atop can connect to retrieve GPU-related counters. These counters are
provided as strings that have to be parsed by atop.


Vulnerability:
The vulnerability is caused by the fact that atop always tries to connect
to the TCP port of &#39;atopgpud&#39; during initialization. When another local
program has been started (instead of &#39;atopgpud&#39;) that listens to this TCP
port, atop connects to that program. Such program is able then to send
unexpected strings that may lead to parsing failures in atop. These failures
result in heap problems and segmentation faults.

Although no additional information has been received about these heap
problems, the described heap problems were reproduced with a custom
developed test program.

The vulnerability is present since the introduction of &#39;atopgpud&#39;
in atop 2.4.0.


Solution:
1) Most systems will not explicitly activate the &#39;atopgpud&#39; daemon.
    Therefore, the default behavior of atop is now not to connect to the TCP
    port at all. Only when atop is started with the &#39;-k&#39; flag it will try to
    connect to the TCP port (in case you know that &#39;atopgpud&#39; is running).

2) When the &#39;-k&#39; flag is used, the parsing of the strings is improved to
    avoid that heap problems can occur.

3) Another optional source for atop might be &#39;netatop&#39; or &#39;netatop-bpf&#39;.
    Since most systems will not explicitly install/use these sources, 
the default
    behavior of atop is now not to try to find these sources. Only when 
atop is
    started with the &#39;-K&#39; flag it will try to find &#39;netatop&#39; or 
&#39;netatop-bpf&#39;.

</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


</p><p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
</p><p>
Confused about <a href="https://openwall.com/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
</p></div>
  </body>
</html>
