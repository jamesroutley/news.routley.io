<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.os2museum.com/wp/first-dual-channel-ide/">Original</a>
    <h1>First Dual-Channel IDE?</h1>
    
    <div id="readability-page-1" class="page"><div>
						
<p>The OS/2 Museum recently came into possession of what may be the first adapter with support for two IDE channels… sort of:</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009.jpg"><img loading="lazy" width="640" height="480" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009-640x480.jpg" alt="" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009-640x480.jpg 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009-300x225.jpg 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009-768x576.jpg 768w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009-1536x1152.jpg 1536w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280009.jpg 2048w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>Two-cable IDE adapter, 1989</figcaption></figure></div>



<p>The adapter was made by Plus Development Corporation, a subsidiary of the disk maker Quantum. This particular specimen was manufactured in 1989, though its BIOS has a 1988 copyright.</p>



<p>The adapter is quite obscure for something made by a well known company. I could not find <em>any</em> information about it whatsoever. The only public reference to its existence is its FCC ID, EU95T8IMPULSE80-2 (note that Plus Impulse was a brand name under which some Quantum drives were sold). The <a href="https://fccid.io/EU95T8IMPULSE80-2">FCC application</a> is from March 17, 1989, and it mentions a “hard disk controller card for internal &amp; external hard disk drives”.</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007.jpg"><img loading="lazy" width="640" height="479" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007-640x479.jpg" alt="" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007-640x479.jpg 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007-300x224.jpg 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007-768x575.jpg 768w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007-1536x1149.jpg 1536w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280007.jpg 2048w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>FCC sticker on the card</figcaption></figure></div>



<p>The OS/2 Museum’s adapter is clearly for internal disks only, though the PCB looks like it was designed to have an external connector, too.</p>



<h3>What’s on It</h3>



<p>There’s not a lot on the adapter. Two IDE connectors, a DIP switch block, a bunch of latches, a 64Kbit (8KB) EPROM, and surprisingly also a 16Kbit (2KB) SRAM.</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005.jpg"><img loading="lazy" width="640" height="480" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005-640x480.jpg" alt="" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005-640x480.jpg 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005-300x225.jpg 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005-768x576.jpg 768w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005-1536x1152.jpg 1536w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280005.jpg 2048w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>Not a typical ISA IDE adapter</figcaption></figure></div>



<p>The adapter’s BIOS is mapped into an 8KB block on the host system, but the last 2KB is in fact the SRAM which the BIOS uses for storing various run-time information.</p>



<p>The DIP switches allow the adapter to be configured to one of three I/O address ranges (1F0-1F7, 170-177, or 320-327), four BIOS addresses (C800h, CA00h, CC00h, or CE00h), and one of two IRQs (11 or 12).</p>



<p>Fortunately the DIP switch settings are silkscreened on the PCB, so the utter lack of documentation is not as painful as it otherwise would be.</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006.jpg"><img loading="lazy" width="640" height="480" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006-640x480.jpg" alt="" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006-640x480.jpg 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006-300x225.jpg 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006-768x576.jpg 768w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006-1536x1152.jpg 1536w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/PC280006.jpg 2048w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>A real life saver</figcaption></figure></div>



<h3>How It Works</h3>



<p>To be clear: This adapter is not what one would normally understand to be a dual-channel IDE adapter. Instead of using two address ranges, such as 1F0-1F7 and 170-177 (the standard primary and secondary IDE I/O address bases), it only uses one. How, you may ask, does the adapter use two IDE channels with a single address range?</p>



<p>As it turns out, the 1F0-1F7 I/O port range silkscreened on the PCB is a lie. In reality there is another register at 1F8h, which appears to do several things, but one of them is switching between primary and secondary IDE channels.</p>



<p>When the low bit (i.e. bit 0) in register 1F8h is clear, the registers at 1F0-1F7 map to the first IDE channel. When the low bit in register 1F8h is set, the registers at 1F0-1F7 map to the second IDE channel. When bit 1 in register 1F8h is set, the registers at 1F0-1F7 map neither the first nor the second IDE channel.</p>



<p>For typical BIOS operation, this is not a limitation, since only one disk can be used at a time anyway.</p>



<p>Note that the adapter’s POST routine appears to search for drives in 8 “enclosures”, each with 8 “cables”. It is possible that an external enclosure might host a number of drives with a shared cable. Enclosure 0 is the “internal enclosure”. This terminology is visible in the adapter’s error messages:</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-adperr.png"><img loading="lazy" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-adperr-640x356.png" alt="" width="640" height="356" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-adperr-640x356.png 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-adperr-300x167.png 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-adperr.png 720w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>The adapter did not like the attached drive</figcaption></figure></div>



<p>Since the adapter can use the standard IDE I/O port range, it is possible to boot a regular operating system. I happened to have an old IBM disk with Caldera Linux lying around and it was able to boot off the Plus Development adapter, as long as it was set to use the 1F0-1F7 range. When set to the 320-327 range, Linux started to boot but then failed to find the root file system (since it couldn’t see the hard disk).</p>



<p>Oddly, all my attempts to boot hard disks with DOS initially failed, even though the controller clearly did see the drives.</p>



<h3>Booting is… yeah</h3>



<p>Trying to boot DOS would only get me this:</p>



<div><figure><a href="https://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-nonsys.png"><img loading="lazy" width="640" height="356" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-nonsys-640x356.png" alt="" data-lazy-srcset="http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-nonsys-640x356.png 640w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-nonsys-300x167.png 300w, http://www.os2museum.com/wp/wp-content/uploads/2021/12/plusdev-ide-nonsys.png 720w" data-lazy-sizes="(max-width: 640px) 100vw, 640px"/></a><figcaption>This is a lie</figcaption></figure></div>



<p>Now, that is rather interesting because the error message comes from the DOS boot sector. To get there, the system was clearly able to load the MBR, run it, load the boot sector for the active partition, start it, and only then fail.</p>



<p>After a lot of head scratching, I remembered that <a href="https://www.os2museum.com/wp/booting-is-hard/" data-type="post" data-id="3606">booting is hard</a>. As it turns out, the Plus Development IDE adapter BIOS has the same subtle bug that Adaptec’s SCSI HBA has. The indirect cause is that for whatever compatibility reason, resetting the hard disk subsystem (via INT 13h/function 0) also needs to reset the floppy.</p>



<p>The BIOS on the PC/AT does the following when resetting the hard disk (INT 13h, function 0, DL = 80h or above:</p>



<ul><li>Check if INT 13h is directed to hard disk or floppy</li><li>If directed to hard disk, check if it is function 0</li><li>If so, reset the floppy (via INT 40h)</li><li>Execute hard disk reset and return its result</li></ul>



<p>The Plus Development BIOS is slightly different:</p>



<ul><li>Check if INT 13h is directed to hard disk or floppy</li><li>If directed to hard disk, check if it is function 0</li><li>If so, reset the floppy (via INT 40h)</li><li>If floppy reset failed, return</li><li>Execute hard disk reset and return its result</li></ul>



<p>The difference is obvious… if there’s no floppy drive, resetting the hard disk will fail with the Plus Development BIOS but not with the PC/AT BIOS.</p>



<p>That was exactly my problem. After connecting a floppy drive to my test system, DOS started booting normally.</p>



<h3>PnP Before Anyone Knew It</h3>



<p>There is one quite remarkable thing about the Plus Development adapter. It is entirely self-configuring. There is in fact no way at all to change the disk configuration, and the adapter does not use any information from the system BIOS (the system BIOS must not be used for disks attached to the Plus Development adapter, otherwise the machine will see the same disk twice).</p>



<p>The Plus Development adapter BIOS scans the IDE channels for attached disks and runs the <a href="https://www.os2museum.com/wp/whence-identify-drive/" data-type="post" data-id="5328">IDENTIFY DRIVE</a> command to obtain disk geometry. This is by far the oldest use of IDENTIFY DRIVE for that purpose that I’m aware of. Plus Development did it in 1989 while system BIOSes did not automatically configure disks before about 1993, or in some cases even later.</p>



<p>For obvious reasons, the adapter will not work with larger IDE drives because it has no chance of using LBA and does not attempt to do any geometry translation. But of course it was made at a time when 80 megabytes was a good size drive.</p>



<p>The adapter may also have trouble with smaller disks if they were moved from another system where they were used with geometry that differs from what IDENTIFY DRIVE reports. That was somewhat common.</p>



<h3>But What’s It For?</h3>



<p>It still escapes me what this adapter was really intended for. Users who needed more than two hard disks probably weren’t going to use the BIOS to access them. Most likely they’d run NetWare, SCO UNIX, OS/2, or something similar. But given the way the adapter works, the OS would need to use a driver which understands the custom control register that switches between IDE channels.</p>



<p>I’m not entirely certain but it is likely that at least two of these Plus Development adapters should be able to coexist in a system, possibly with external enclosures hosting dozens of drives.</p>



<p>Alternatively, the adapter can run two IDE drives each on its own channel, without having to pray that they can coexist as master and slave on a single channel. But I doubt that was worth building a special adapter for.</p>



<p>If anyone knows anything about the Plus Development dual IDE adapter, please share the information.</p>
											</div></div>
  </body>
</html>
