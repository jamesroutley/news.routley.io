<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://juniper.github.io/libxo/libxo-manual.html">Original</a>
    <h1>Libxo: Easy way to generate text, XML, JSON, and HTML</h1>
    
    <div id="readability-page-1" class="page"><p id="doc_section_3_p_1">Most unix commands emit text output aimed at humans. It is designed to be parsed and understood by a user. Humans are gifted at extracting details and pattern matching in such output. Often programmers need to extract information from this human-oriented output. Programmers use tools like grep, awk, and regular expressions to ferret out the pieces of information they need. Such solutions are fragile and require maintenance when output contents change or evolve, along with testing and validation.</p><p id="doc_section_3_p_2">Modern tool developers favor encoding schemes like XML and JSON, which allow trivial parsing and extraction of data. Such formats are simple, well understood, hierarchical, easily parsed, and often integrate easier with common tools and environments. Changes to content can be done in ways that do not break existing users of the data, which can reduce maintenance costs and increase feature velocity.</p><p id="doc_section_3_p_3">In addition, modern reality means that more output ends up in web browsers than in terminals, making HTML output valuable.</p><p id="doc_section_3_p_4">libxo allows a single set of function calls in source code to generate traditional text output, as well as XML and JSON formatted data. HTML can also be generated; &#34;&lt;div&gt;&#34; elements surround the traditional text output, with attributes that detail how to render the data.</p><div>
<h2 id="doc_section_3_1">

<a id="encoding-styles" href="#encoding-styles">Encoding Styles</a>
</h2>
<p id="doc_section_3_1_p_1">There are four encoding styles supported by libxo:</p>

<ul>
<li>TEXT output can be display on a terminal session, allowing compatibility with traditional command line usage.</li>
<li>XML output is suitable for tools like XPath and protocols like NETCONF.</li>
<li>JSON output can be used for RESTful APIs and integration with languages like Javascript and Python.</li>
<li>HTML can be matched with a small CSS file to permit rendering in any HTML5 browser.</li>
</ul>
<p id="doc_section_3_1_p_3">In general, XML and JSON are suitable for encoding data, while TEXT is suited for terminal output and HTML is suited for display in a web browser (see <a href="#xohtml" title="xohtml">Section 8</a>).</p>
<p id="doc_section_3_1_p_4">Section Contents: </p>
<ul>
<li><a href="#text-output" title="Text Output">Section 3.1.1</a></li>
<li><a href="#xml-output" title="XML Output">Section 3.1.2</a></li>
<li><a href="#json-output" title="JSON Output">Section 3.1.3</a></li>
<li><a href="#html-output" title="HTML Output">Section 3.1.4</a></li>
</ul>
<div>
<h3 id="doc_section_3_1_1">

<a id="text-output" href="#text-output">Text Output</a>
</h3>
<p id="doc_section_3_1_1_p_1">Most traditional programs generate text output on standard output, with contents like:</p>
 <pre>    36      ./src
    40      ./bin
    90      .
            </pre> <p id="doc_section_3_1_1_p_3">In this example (taken from du source code), the code to generate this data might look like:</p>
 <pre>    printf(&#34;%d\t%s\n&#34;, num_blocks, path);
            </pre> <p id="doc_section_3_1_1_p_5">Simple, direct, obvious. But it&#39;s only making text output. Imagine using a single code path to make TEXT, XML, JSON or HTML, deciding at run time which to generate.</p>
<p id="doc_section_3_1_1_p_6">libxo expands on the idea of printf format strings to make a single format containing instructions for creating multiple output styles:</p>
 <pre>    xo_emit(&#34;{:blocks/%d}\t{:path/%s}\n&#34;, num_blocks, path);
            </pre> <p id="doc_section_3_1_1_p_8">This line will generate the same text output as the earlier printf call, but also has enough information to generate XML, JSON, and HTML.</p>
<p id="doc_section_3_1_1_p_9">The following sections introduce the other formats.</p>
</div>
<div>
<h3 id="doc_section_3_1_2">

<a id="xml-output" href="#xml-output">XML Output</a>
</h3>
<p id="doc_section_3_1_2_p_1">XML output consists of a hierarchical set of elements, each encoded with a start tag and an end tag. The element should be named for data value that it is encoding:</p>
 <pre>    &lt;item&gt;
      &lt;blocks&gt;36&lt;/blocks&gt;
      &lt;path&gt;./src&lt;/path&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;blocks&gt;40&lt;/blocks&gt;
      &lt;path&gt;./bin&lt;/path&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;blocks&gt;90&lt;/blocks&gt;
      &lt;path&gt;.&lt;/path&gt;
    &lt;/item&gt;
            </pre> <p id="doc_section_3_1_2_p_3">XML is a W3C standard for encoding data. See w3c.org/TR/xml for additional information.</p>
</div>
<div>
<h3 id="doc_section_3_1_3">

<a id="json-output" href="#json-output">JSON Output</a>
</h3>
<p id="doc_section_3_1_3_p_1">JSON output consists of a hierarchical set of objects and lists, each encoded with a quoted name, a colon, and a value. If the value is a string, it must be quoted, but numbers are not quoted. Objects are encoded using braces; lists are encoded using square brackets. Data inside objects and lists is separated using commas:</p>
 <pre>    items: [
        { &#34;blocks&#34;: 36, &#34;path&#34; : &#34;./src&#34; },
        { &#34;blocks&#34;: 40, &#34;path&#34; : &#34;./bin&#34; },
        { &#34;blocks&#34;: 90, &#34;path&#34; : &#34;./&#34; }
    ]
            </pre> </div>
<div>
<h3 id="doc_section_3_1_4">

<a id="html-output" href="#html-output">HTML Output</a>
</h3>
<p id="doc_section_3_1_4_p_1">HTML output is designed to allow the output to be rendered in a web browser with minimal effort. Each piece of output data is rendered inside a &lt;div&gt; element, with a class name related to the role of the data. By using a small set of class attribute values, a CSS stylesheet can render the HTML into rich text that mirrors the traditional text content.</p>
<p id="doc_section_3_1_4_p_2">Additional attributes can be enabled to provide more details about the data, including data type, description, and an XPath location.</p>
 <pre>    &lt;div class=&#34;line&#34;&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;blocks&#34;&gt;36&lt;/div&gt;
      &lt;div class=&#34;padding&#34;&gt;      &lt;/div&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;path&#34;&gt;./src&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;line&#34;&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;blocks&#34;&gt;40&lt;/div&gt;
      &lt;div class=&#34;padding&#34;&gt;      &lt;/div&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;path&#34;&gt;./bin&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;line&#34;&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;blocks&#34;&gt;90&lt;/div&gt;
      &lt;div class=&#34;padding&#34;&gt;      &lt;/div&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;path&#34;&gt;./&lt;/div&gt;
    &lt;/div&gt;
            </pre> </div>
</div><div>
<h2 id="doc_section_3_2">

<a id="format-strings" href="#format-strings">Format Strings</a>
</h2>
<p id="doc_section_3_2_p_1">libxo uses format strings to control the rendering of data into the various output styles. Each format string contains a set of zero or more field descriptions, which describe independent data fields. Each field description contains a set of modifiers, a content string, and zero, one, or two format descriptors. The modifiers tell libxo what the field is and how to treat it, while the format descriptors are formatting instructions using printf-style format strings, telling libxo how to format the field. The field description is placed inside a set of braces, with a colon (&#34;:&#34;) after the modifiers and a slash (&#34;/&#34;) before each format descriptors. Text may be intermixed with field descriptions within the format string.</p>
<p id="doc_section_3_2_p_2">The field description is given as follows:</p>
 <pre>    &#39;{&#39; [ role | modifier ]* [&#39;,&#39; long-names ]* &#39;:&#39; [ content ]
            [ &#39;/&#39; field-format [ &#39;/&#39; encoding-format ]] &#39;}&#39;
            </pre> <p id="doc_section_3_2_p_4">The role describes the function of the field, while the modifiers enable optional behaviors. The contents, field-format, and encoding-format are used in varying ways, based on the role. These are described in the following sections.</p>
<p id="doc_section_3_2_p_5">In the following example, three field descriptors appear. The first is a padding field containing three spaces of padding, the second is a label (&#34;In stock&#34;), and the third is a value field (&#34;inâ€‘stock&#34;). The in-stock field has a &#34;%u&#34; format that will parse the next argument passed to the xo_emit function as an unsigned integer.</p>
 <pre>    xo_emit(&#34;{P:   }{Lwc:In stock}{:in-stock/%u}\n&#34;, 65);
            </pre> <p id="doc_section_3_2_p_7">This single line of code can generate text (&#34; In stock: 65\n&#34;), XML (&#34;&lt;inâ€‘stock&gt;65&lt;/inâ€‘stock&gt;&#34;), JSON (&#39;&#34;inâ€‘stock&#34;: 6&#39;), or HTML (too lengthy to be listed here).</p>
<p id="doc_section_3_2_p_8">While roles and modifiers typically use single character for brevity, there are alternative names for each which allow more verbose formatting strings. These names must be preceded by a comma, and may follow any single-character values:</p>
 <pre>    xo_emit(&#34;{L,white,colon:In stock}{,key:in-stock/%u}\n&#34;, 65);
            </pre> <p id="doc_section_3_2_p_10">Section Contents: </p>
<ul>
<li><a href="#field-roles" title="Field Roles">Section 3.2.1</a></li>
<li><a href="#field-modifiers" title="Field Modifiers">Section 3.2.2</a></li>
<li><a href="#field-formatting" title="Field Formatting">Section 3.2.3</a></li>
<li><a href="#utf-8-and-locale-strings" title="UTF-8 and Locale Strings">Section 3.2.4</a></li>
<li><a href="#characters-outside-of-field-definitions" title="Characters Outside of Field Definitions">Section 3.2.5</a></li>
<li><a href="#m-is-supported" title="&#34;%m&#34; Is Supported">Section 3.2.6</a></li>
<li><a href="#n-is-not-supported" title="&#34;%n&#34; Is Not Supported">Section 3.2.7</a></li>
<li><a href="#the-encoding-format-eformat" title="The Encoding Format (eformat)">Section 3.2.8</a></li>
<li><a href="#content-strings" title="Content Strings">Section 3.2.9</a></li>
<li><a href="#printf-like" title="Argument Validation">Section 3.2.10</a></li>
<li><a href="#retain" title="Retaining Parsed Format Information">Section 3.2.11</a></li>
<li><a href="#example" title="Example">Section 3.2.12</a></li>
</ul>
<div>
<h3 id="doc_section_3_2_1">

<a id="field-roles" href="#field-roles">Field Roles</a>
</h3>
<p id="doc_section_3_2_1_p_1">Field roles are optional, and indicate the role and formatting of the content. The roles are listed below; only one role is permitted:</p>
<div id="doc_table_u.1"><table summary="">
<thead><tr>
<th>R</th>
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>C</td>
<td>color</td>
<td>Field has color and effect controls</td>
</tr>
<tr>
<td>D</td>
<td>decoration</td>
<td>Field is non-text (e.g., colon, comma)</td>
</tr>
<tr>
<td>E</td>
<td>error</td>
<td>Field is an error message</td>
</tr>
<tr>
<td>G</td>
<td>gettext</td>
<td>Call gettext(3) on the format string</td>
</tr>
<tr>
<td>L</td>
<td>label</td>
<td>Field is text that prefixes a value</td>
</tr>
<tr>
<td>N</td>
<td>note</td>
<td>Field is text that follows a value</td>
</tr>
<tr>
<td>P</td>
<td>padding</td>
<td>Field is spaces needed for vertical alignment</td>
</tr>
<tr>
<td>T</td>
<td>title</td>
<td>Field is a title value for headings</td>
</tr>
<tr>
<td>U</td>
<td>units</td>
<td>Field is the units for the previous value field</td>
</tr>
<tr>
<td>V</td>
<td>value</td>
<td>Field is the name of field (the default)</td>
</tr>
<tr>
<td>W</td>
<td>warning</td>
<td>Field is a warning message</td>
</tr>
<tr>
<td>[</td>
<td>start-anchor</td>
<td>Begin a section of anchored variable-width text</td>
</tr>
<tr>
<td>]</td>
<td>stop-anchor</td>
<td>End a section of anchored variable-width text</td>
</tr>
</tbody>
</table></div>
 <pre>    EXAMPLE:
        xo_emit(&#34;{L:Free}{D::}{P:   }{:free/%u} {U:Blocks}\n&#34;,
                free_blocks);
            </pre> <p id="doc_section_3_2_1_p_3">When a role is not provided, the &#34;value&#34; role is used as the default.</p>
<p id="doc_section_3_2_1_p_4">Roles and modifiers can also use more verbose names, when preceded by a comma:</p>
 <pre>    EXAMPLE:
        xo_emit(&#34;{,label:Free}{,decoration::}{,padding:   }&#34;
                &#34;{,value:free/%u} {,units:Blocks}\n&#34;,
                free_blocks);
            </pre> <p id="doc_section_3_2_1_p_6">Section Contents: </p>
<ul>
<li><a href="#color-role" title="The Color Role ({C:})">Section 3.2.1.1</a></li>
<li><a href="#the-decoration-role-d" title="The Decoration Role ({D:})">Section 3.2.1.2</a></li>
<li><a href="#gettext-role" title="The Gettext Role ({G:})">Section 3.2.1.3</a></li>
<li><a href="#the-label-role-l" title="The Label Role ({L:})">Section 3.2.1.4</a></li>
<li><a href="#the-note-role-n" title="The Note Role ({N:})">Section 3.2.1.5</a></li>
<li><a href="#padding-role" title="The Padding Role ({P:})">Section 3.2.1.6</a></li>
<li><a href="#the-title-role-t" title="The Title Role ({T:})">Section 3.2.1.7</a></li>
<li><a href="#the-units-role-u" title="The Units Role ({U:})">Section 3.2.1.8</a></li>
<li><a href="#the-value-role-v-and-" title="The Value Role ({V:} and {:})">Section 3.2.1.9</a></li>
<li><a href="#anchor-role" title="The Anchor Roles ({[:} and {]:})">Section 3.2.1.10</a></li>
</ul>
<div>
<h4 id="doc_section_3_2_1_1">

<a id="color-role" href="#color-role">The Color Role ({C:})</a>
</h4>
<p id="doc_section_3_2_1_1_p_1">Colors and effects control how text values are displayed; they are used for display styles (TEXT and HTML).</p>
 <pre>    xo_emit(&#34;{C:bold}{:value}{C:no-bold}\n&#34;, value);
            </pre> <p id="doc_section_3_2_1_1_p_3">Colors and effects remain in effect until modified by other &#34;C&#34;-role fields.</p>
 <pre>    xo_emit(&#34;{C:bold}{C:inverse}both{C:no-bold}only inverse\n&#34;);
            </pre> <p id="doc_section_3_2_1_1_p_5">If the content is empty, the &#34;reset&#34; action is performed.</p>
 <pre>    xo_emit(&#34;{C:both,underline}{:value}{C:}\n&#34;, value);
            </pre> <p id="doc_section_3_2_1_1_p_7">The content should be a comma-separated list of zero or more colors or display effects.</p>
 <pre>    xo_emit(&#34;{C:bold,inverse}Ugly{C:no-bold,no-inverse}\n&#34;);
            </pre> <p id="doc_section_3_2_1_1_p_9">The color content can be either static, when placed directly within the field descriptor, or a printf-style format descriptor can be used, if preceded by a slash (&#34;/&#34;):</p>
 <pre>   xo_emit(&#34;{C:/%s%s}{:value}{C:}&#34;, need_bold ? &#34;bold&#34; : &#34;&#34;,
           need_underline ? &#34;underline&#34; : &#34;&#34;, value);
            </pre> <p id="doc_section_3_2_1_1_p_11">Color names are prefixed with either &#34;fgâ€‘&#34; or &#34;bgâ€‘&#34; to change the foreground and background colors, respectively.</p>
 <pre>    xo_emit(&#34;{C:/fg-%s,bg-%s}{Lwc:Cost}{:cost/%u}{C:reset}\n&#34;,
            fg_color, bg_color, cost);
            </pre> <p id="doc_section_3_2_1_1_p_13">The following table lists the supported effects:</p>
<div id="doc_table_u.2"><table summary="">
<thead><tr>
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>bg-XXXXX</td>
<td>Change background color</td>
</tr>
<tr>
<td>bold</td>
<td>Start bold text effect</td>
</tr>
<tr>
<td>fg-XXXXX</td>
<td>Change foreground color</td>
</tr>
<tr>
<td>inverse</td>
<td>Start inverse (aka reverse) text effect</td>
</tr>
<tr>
<td>no-bold</td>
<td>Stop bold text effect</td>
</tr>
<tr>
<td>no-inverse</td>
<td>Stop inverse (aka reverse) text effect</td>
</tr>
<tr>
<td>no-underline</td>
<td>Stop underline text effect</td>
</tr>
<tr>
<td>normal</td>
<td>Reset effects (only)</td>
</tr>
<tr>
<td>reset</td>
<td>Reset colors and effects (restore defaults)</td>
</tr>
<tr>
<td>underline</td>
<td>Start underline text effect</td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_1_1_p_14">The following color names are supported:</p>
<div id="doc_table_u.3"><table summary="">
<thead><tr>
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>black</td>
<td></td>
</tr>
<tr>
<td>blue</td>
<td></td>
</tr>
<tr>
<td>cyan</td>
<td></td>
</tr>
<tr>
<td>default</td>
<td>Default color for foreground or background</td>
</tr>
<tr>
<td>green</td>
<td></td>
</tr>
<tr>
<td>magenta</td>
<td></td>
</tr>
<tr>
<td>red</td>
<td></td>
</tr>
<tr>
<td>white</td>
<td></td>
</tr>
<tr>
<td>yellow</td>
<td></td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_1_1_p_15">When using colors, the developer should remember that users will change the foreground and background colors of terminal session according to their own tastes, so assuming that &#34;blue&#34; looks nice is never safe, and is a constant annoyance to your dear author. In addition, a significant percentage of users (1 in 12) will be color blind. Depending on color to convey critical information is not a good idea. Color should enhance output, but should not be used as the sole means of encoding information.</p>
</div>
<div>
<h4 id="doc_section_3_2_1_2">

<a id="the-decoration-role-d" href="#the-decoration-role-d">The Decoration Role ({D:})</a>
</h4>
<p id="doc_section_3_2_1_2_p_1">Decorations are typically punctuation marks such as colons, semi-colons, and commas used to decorate the text and make it simpler for human readers. By marking these distinctly, HTML usage scenarios can use CSS to direct their display parameters.</p>
 <pre>    xo_emit(&#34;{D:((}{:name}{D:))}\n&#34;, name);
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_3">

<a id="gettext-role" href="#gettext-role">The Gettext Role ({G:})</a>
</h4>
<p id="doc_section_3_2_1_3_p_1">libxo supports internationalization (i18n) through its use of gettext(3). Use the &#34;{G:}&#34; role to request that the remaining part of the format string, following the &#34;{G:}&#34; field, be handled using gettext().</p>
<p id="doc_section_3_2_1_3_p_2">Since gettext() uses the string as the key into the message catalog, libxo uses a simplified version of the format string that removes unimportant field formatting and modifiers, stopping minor formatting changes from impacting the expensive translation process. A developer change such as changing &#34;/%06d&#34; to &#34;/%08d&#34; should not force hand inspection of all .po files.</p>
<p id="doc_section_3_2_1_3_p_3">The simplified version can be generated for a single message using the &#34;xopo -s &lt;text&gt;&#34; command, or an entire .pot can be translated using the &#34;xopo -f &lt;input&gt; -o &lt;output&gt;&#34; command.</p>
 <pre>   xo_emit(&#34;{G:}Invalid token\n&#34;);
            </pre> <p id="doc_section_3_2_1_3_p_5">The {G:} role allows a domain name to be set. gettext calls will continue to use that domain name until the current format string processing is complete, enabling a library function to emit strings using it&#39;s own catalog. The domain name can be either static as the content of the field, or a format can be used to get the domain name from the arguments.</p>
 <pre>   xo_emit(&#34;{G:libc}Service unavailable in restricted mode\n&#34;);
            </pre> <p id="doc_section_3_2_1_3_p_7">See <a href="#howto-i18n" title="Howto: Internationalization (i18n)">Section 11.5</a> for additional details.</p>
</div>
<div>
<h4 id="doc_section_3_2_1_4">

<a id="the-label-role-l" href="#the-label-role-l">The Label Role ({L:})</a>
</h4>
<p id="doc_section_3_2_1_4_p_1">Labels are text that appears before a value.</p>
 <pre>    xo_emit(&#34;{Lwc:Cost}{:cost/%u}\n&#34;, cost);
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_5">

<a id="the-note-role-n" href="#the-note-role-n">The Note Role ({N:})</a>
</h4>
<p id="doc_section_3_2_1_5_p_1">Notes are text that appears after a value.</p>
 <pre>    xo_emit(&#34;{:cost/%u} {N:per year}\n&#34;, cost);
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_6">

<a id="padding-role" href="#padding-role">The Padding Role ({P:})</a>
</h4>
<p id="doc_section_3_2_1_6_p_1">Padding represents whitespace used before and between fields.</p>
<p id="doc_section_3_2_1_6_p_2">The padding content can be either static, when placed directly within the field descriptor, or a printf-style format descriptor can be used, if preceded by a slash (&#34;/&#34;):</p>
 <pre>    xo_emit(&#34;{P:        }{Lwc:Cost}{:cost/%u}\n&#34;, cost);
    xo_emit(&#34;{P:/%30s}{Lwc:Cost}{:cost/%u}\n&#34;, &#34;&#34;, cost);
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_7">

<a id="the-title-role-t" href="#the-title-role-t">The Title Role ({T:})</a>
</h4>
<p id="doc_section_3_2_1_7_p_1">Title are heading or column headers that are meant to be displayed to the user. The title can be either static, when placed directly within the field descriptor, or a printf-style format descriptor can be used, if preceded by a slash (&#34;/&#34;):</p>
 <pre>    xo_emit(&#34;{T:Interface Statistics}\n&#34;);
    xo_emit(&#34;{T:/%20.20s}{T:/%6.6s}\n&#34;, &#34;Item Name&#34;, &#34;Cost&#34;);
            </pre> <p id="doc_section_3_2_1_7_p_3">Title fields have an extra convenience feature; if both content and format are specified, instead of looking to the argument list for a value, the content is used, allowing a mixture of format and content within the field descriptor:</p>
 <pre>    xo_emit(&#34;{T:Name/%20s}{T:Count/%6s}\n&#34;);
            </pre> <p id="doc_section_3_2_1_7_p_5">Since the incoming argument is a string, the format must be &#34;%s&#34; or something suitable.</p>
</div>
<div>
<h4 id="doc_section_3_2_1_8">

<a id="the-units-role-u" href="#the-units-role-u">The Units Role ({U:})</a>
</h4>
<p id="doc_section_3_2_1_8_p_1">Units are the dimension by which values are measured, such as degrees, miles, bytes, and decibels. The units field carries this information for the previous value field.</p>
 <pre>    xo_emit(&#34;{Lwc:Distance}{:distance/%u}{Uw:miles}\n&#34;, miles);
            </pre> <p id="doc_section_3_2_1_8_p_3">Note that the sense of the &#39;w&#39; modifier is reversed for units; a blank is added before the contents, rather than after it.</p>
<p id="doc_section_3_2_1_8_p_4">When the XOF_UNITS flag is set, units are rendered in XML as the &#34;units&#34; attribute:</p>
 <pre>    &lt;distance units=&#34;miles&#34;&gt;50&lt;/distance&gt;
            </pre> <p id="doc_section_3_2_1_8_p_6">Units can also be rendered in HTML as the &#34;dataâ€‘units&#34; attribute:</p>
 <pre>    &lt;div class=&#34;data&#34; data-tag=&#34;distance&#34; data-units=&#34;miles&#34;
         data-xpath=&#34;/top/data/distance&#34;&gt;50&lt;/div&gt;
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_9">

<a id="the-value-role-v-and-" href="#the-value-role-v-and-">The Value Role ({V:} and {:})</a>
</h4>
<p id="doc_section_3_2_1_9_p_1">The value role is used to represent the a data value that is interesting for the non-display output styles (XML and JSON). Value is the default role; if no other role designation is given, the field is a value. The field name must appear within the field descriptor, followed by one or two format descriptors. The first format descriptor is used for display styles (TEXT and HTML), while the second one is used for encoding styles (XML and JSON). If no second format is given, the encoding format defaults to the first format, with any minimum width removed. If no first format is given, both format descriptors default to &#34;%s&#34;.</p>
 <pre>    xo_emit(&#34;{:length/%02u}x{:width/%02u}x{:height/%02u}\n&#34;,
            length, width, height);
    xo_emit(&#34;{:author} wrote \&#34;{:poem}\&#34; in {:year/%4d}\n,
            author, poem, year);
            </pre> </div>
<div>
<h4 id="doc_section_3_2_1_10">

<a id="anchor-role" href="#anchor-role">The Anchor Roles ({[:} and {]:})</a>
</h4>
<p id="doc_section_3_2_1_10_p_1">The anchor roles allow a set of strings by be padded as a group, but still be visible to xo_emit as distinct fields. Either the start or stop anchor can give a field width and it can be either directly in the descriptor or passed as an argument. Any fields between the start and stop anchor are padded to meet the minimum width given.</p>
<p id="doc_section_3_2_1_10_p_2">To give a width directly, encode it as the content of the anchor tag:</p>
 <pre>    xo_emit(&#34;({[:10}{:min/%d}/{:max/%d}{]:})\n&#34;, min, max);
            </pre> <p id="doc_section_3_2_1_10_p_4">To pass a width as an argument, use &#34;%d&#34; as the format, which must appear after the &#34;/&#34;. Note that only &#34;%d&#34; is supported for widths. Using any other value could ruin your day.</p>
 <pre>    xo_emit(&#34;({[:/%d}{:min/%d}/{:max/%d}{]:})\n&#34;, width, min, max);
            </pre> <p id="doc_section_3_2_1_10_p_6">If the width is negative, padding will be added on the right, suitable for left justification. Otherwise the padding will be added to the left of the fields between the start and stop anchors, suitable for right justification. If the width is zero, nothing happens. If the number of columns of output between the start and stop anchors is less than the absolute value of the given width, nothing happens.</p>
<p id="doc_section_3_2_1_10_p_7">Widths over 8k are considered probable errors and not supported. If XOF_WARN is set, a warning will be generated.</p>
</div>
</div>
<div>
<h3 id="doc_section_3_2_2">

<a id="field-modifiers" href="#field-modifiers">Field Modifiers</a>
</h3>
<p id="doc_section_3_2_2_p_1">Field modifiers are flags which modify the way content emitted for particular output styles:</p>
<div id="doc_table_u.4"><table summary="">
<thead><tr>
<th>M</th>
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>a</td>
<td>argument</td>
<td>The content appears as a &#39;const char *&#39; argument</td>
</tr>
<tr>
<td>c</td>
<td>colon</td>
<td>A colon (&#34;:&#34;) is appended after the label</td>
</tr>
<tr>
<td>d</td>
<td>display</td>
<td>Only emit field for display styles (text/HTML)</td>
</tr>
<tr>
<td>e</td>
<td>encoding</td>
<td>Only emit for encoding styles (XML/JSON)</td>
</tr>
<tr>
<td>g</td>
<td>gettext</td>
<td>Call gettext on field&#39;s render content</td>
</tr>
<tr>
<td>h</td>
<td>humanize (hn)</td>
<td>Format large numbers in human-readable style</td>
</tr>
<tr>
<td></td>
<td>hn-space</td>
<td>Humanize: Place space between numeric and unit</td>
</tr>
<tr>
<td></td>
<td>hn-decimal</td>
<td>Humanize: Add a decimal digit, if number &lt; 10</td>
</tr>
<tr>
<td></td>
<td>hn-1000</td>
<td>Humanize: Use 1000 as divisor instead of 1024</td>
</tr>
<tr>
<td>k</td>
<td>key</td>
<td>Field is a key, suitable for XPath predicates</td>
</tr>
<tr>
<td>l</td>
<td>leaf-list</td>
<td>Field is a leaf-list</td>
</tr>
<tr>
<td>n</td>
<td>no-quotes</td>
<td>Do not quote the field when using JSON style</td>
</tr>
<tr>
<td>p</td>
<td>plural</td>
<td>Gettext: Use comma-separated plural form</td>
</tr>
<tr>
<td>q</td>
<td>quotes</td>
<td>Quote the field when using JSON style</td>
</tr>
<tr>
<td>t</td>
<td>trim</td>
<td>Trim leading and trailing whitespace</td>
</tr>
<tr>
<td>w</td>
<td>white</td>
<td>A blank (&#34; &#34;) is appended after the label</td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_2_p_2">Roles and modifiers can also use more verbose names, when preceded by a comma. For example, the modifier string &#34;Lwc&#34; (or &#34;L,white,colon&#34;) means the field has a label role (text that describes the next field) and should be followed by a colon (&#39;c&#39;) and a space (&#39;w&#39;). The modifier string &#34;Vkq&#34; (or &#34;:key,quote&#34;) means the field has a value role (the default role), that it is a key for the current instance, and that the value should be quoted when encoded for JSON.</p>
<p id="doc_section_3_2_2_p_3">Section Contents: </p>
<ul>
<li><a href="#the-argument-modifier-a" title="The Argument Modifier ({a:})">Section 3.2.2.1</a></li>
<li><a href="#the-colon-modifier-c" title="The Colon Modifier ({c:})">Section 3.2.2.2</a></li>
<li><a href="#the-display-modifier-d" title="The Display Modifier ({d:})">Section 3.2.2.3</a></li>
<li><a href="#e-modifier" title="The Encoding Modifier ({e:})">Section 3.2.2.4</a></li>
<li><a href="#gettext-modifier" title="The Gettext Modifier ({g:})">Section 3.2.2.5</a></li>
<li><a href="#the-humanize-modifier-h" title="The Humanize Modifier ({h:})">Section 3.2.2.6</a></li>
<li><a href="#the-key-modifier-k" title="The Key Modifier ({k:})">Section 3.2.2.7</a></li>
<li><a href="#the-leaf-list-modifier-l" title="The Leaf-List Modifier ({l:})">Section 3.2.2.8</a></li>
<li><a href="#the-no-quotes-modifier-n" title="The No-Quotes Modifier ({n:})">Section 3.2.2.9</a></li>
<li><a href="#plural-modifier" title="The Plural Modifier ({p:})">Section 3.2.2.10</a></li>
<li><a href="#the-quotes-modifier-q" title="The Quotes Modifier ({q:})">Section 3.2.2.11</a></li>
<li><a href="#the-trim-modifier-t" title="The Trim Modifier ({t:})">Section 3.2.2.12</a></li>
<li><a href="#the-white-space-modifier-w" title="The White Space Modifier ({w:})">Section 3.2.2.13</a></li>
</ul>
<div>
<h4 id="doc_section_3_2_2_1">

<a id="the-argument-modifier-a" href="#the-argument-modifier-a">The Argument Modifier ({a:})</a>
</h4>
<p id="doc_section_3_2_2_1_p_1">The argument modifier indicates that the content of the field descriptor will be placed as a UTF-8 string (const char *) argument within the xo_emit parameters.</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{La:} {a:}\n&#34;, &#34;Label text&#34;, &#34;label&#34;, &#34;value&#34;);
    TEXT:
      Label text value
    JSON:
      &#34;label&#34;: &#34;value&#34;
    XML:
      &lt;label&gt;value&lt;/label&gt;
            </pre> <p id="doc_section_3_2_2_1_p_3">The argument modifier allows field names for value fields to be passed on the stack, avoiding the need to build a field descriptor using snprintf. For many field roles, the argument modifier is not needed, since those roles have specific mechanisms for arguments, such as &#34;{C:fgâ€‘%s}&#34;.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_2">

<a id="the-colon-modifier-c" href="#the-colon-modifier-c">The Colon Modifier ({c:})</a>
</h4>
<p id="doc_section_3_2_2_2_p_1">The colon modifier appends a single colon to the data value:</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{Lc:Name}{:name}\n&#34;, &#34;phil&#34;);
    TEXT:
      Name:phil
            </pre> <p id="doc_section_3_2_2_2_p_3">The colon modifier is only used for the TEXT and HTML output styles. It is commonly combined with the space modifier (&#39;{w:}&#39;). It is purely a convenience feature.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_3">

<a id="the-display-modifier-d" href="#the-display-modifier-d">The Display Modifier ({d:})</a>
</h4>
<p id="doc_section_3_2_2_3_p_1">The display modifier indicated the field should only be generated for the display output styles, TEXT and HTML.</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{Lcw:Name}{d:name} {:id/%d}\n&#34;, &#34;phil&#34;, 1);
    TEXT:
      Name: phil 1
    XML:
      &lt;id&gt;1&lt;/id&gt;
            </pre> <p id="doc_section_3_2_2_3_p_3">The display modifier is the opposite of the encoding modifier, and they are often used to give to distinct views of the underlying data.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_4">

<a id="e-modifier" href="#e-modifier">The Encoding Modifier ({e:})</a>
</h4>
<p id="doc_section_3_2_2_4_p_1">The display modifier indicated the field should only be generated for the display output styles, TEXT and HTML.</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{Lcw:Name}{:name} {e:id/%d}\n&#34;, &#34;phil&#34;, 1);
    TEXT:
      Name: phil
    XML:
      &lt;name&gt;phil&lt;/name&gt;&lt;id&gt;1&lt;/id&gt;
            </pre> <p id="doc_section_3_2_2_4_p_3">The encoding modifier is the opposite of the display modifier, and they are often used to give to distinct views of the underlying data.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_5">

<a id="gettext-modifier" href="#gettext-modifier">The Gettext Modifier ({g:})</a>
</h4>
<p id="doc_section_3_2_2_5_p_1">The gettext modifier is used to translate individual fields using the gettext domain (typically set using the &#34;{G:}&#34; role) and current language settings. Once libxo renders the field value, it is passed to gettext(3), where it is used as a key to find the native language translation.</p>
<p id="doc_section_3_2_2_5_p_2">In the following example, the strings &#34;State&#34; and &#34;full&#34; are passed to gettext() to find locale-based translated strings.</p>
 <pre>    xo_emit(&#34;{Lgwc:State}{g:state}\n&#34;, &#34;full&#34;);
            </pre> <p id="doc_section_3_2_2_5_p_4">See <a href="#gettext-role" title="The Gettext Role ({G:})">Section 3.2.1.3</a>, <a href="#plural-modifier" title="The Plural Modifier ({p:})">Section 3.2.2.10</a>, and <a href="#howto-i18n" title="Howto: Internationalization (i18n)">Section 11.5</a> for additional details.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_6">

<a id="the-humanize-modifier-h" href="#the-humanize-modifier-h">The Humanize Modifier ({h:})</a>
</h4>
<p id="doc_section_3_2_2_6_p_1">The humanize modifier is used to render large numbers as in a human-readable format. While numbers like &#34;44470272&#34; are completely readable to computers and savants, humans will generally find &#34;44M&#34; more meaningful.</p>
<p id="doc_section_3_2_2_6_p_2">&#34;hn&#34; can be used as an alias for &#34;humanize&#34;.</p>
<p id="doc_section_3_2_2_6_p_3">The humanize modifier only affects display styles (TEXT and HMTL). The &#34;noâ€‘humanize&#34; option (See <a href="#options" title="Command-line Arguments">Section 4</a>) will block the function of the humanize modifier.</p>
<p id="doc_section_3_2_2_6_p_4">There are a number of modifiers that affect details of humanization. These are only available in as full names, not single characters. The &#34;hnâ€‘space&#34; modifier places a space between the number and any multiplier symbol, such as &#34;M&#34; or &#34;K&#34; (ex: &#34;44 K&#34;). The &#34;hnâ€‘decimal&#34; modifier will add a decimal point and a single tenths digit when the number is less than 10 (ex: &#34;4.4K&#34;). The &#34;hnâ€‘1000&#34; modifier will use 1000 as divisor instead of 1024, following the JEDEC-standard instead of the more natural binary powers-of-two tradition.</p>
 <pre>    EXAMPLE:
        xo_emit(&#34;{h:input/%u}, {h,hn-space:output/%u}, &#34;
            &#34;{h,hn-decimal:errors/%u}, {h,hn-1000:capacity/%u}, &#34;
            &#34;{h,hn-decimal:remaining/%u}\n&#34;,
            input, output, errors, capacity, remaining);
    TEXT:
        21, 57 K, 96M, 44M, 1.2G
            </pre> <p id="doc_section_3_2_2_6_p_6">In the HTML style, the original numeric value is rendered in the &#34;dataâ€‘number&#34; attribute on the &lt;div&gt; element:</p>
 <pre>    &lt;div class=&#34;data&#34; data-tag=&#34;errors&#34;
         data-number=&#34;100663296&#34;&gt;96M&lt;/div&gt;
            </pre> </div>
<div>
<h4 id="doc_section_3_2_2_7">

<a id="the-key-modifier-k" href="#the-key-modifier-k">The Key Modifier ({k:})</a>
</h4>
<p id="doc_section_3_2_2_7_p_1">The key modifier is used to indicate that a particular field helps uniquely identify an instance of list data.</p>
 <pre>    EXAMPLE:
        xo_open_list(&#34;user&#34;);
        for (i = 0; i &lt; num_users; i++) {
            xo_open_instance(&#34;user&#34;);
            xo_emit(&#34;User {k:name} has {:count} tickets\n&#34;,
               user[i].u_name, user[i].u_tickets);
            xo_close_instance(&#34;user&#34;);
        }
        xo_close_list(&#34;user&#34;);
            </pre> <p id="doc_section_3_2_2_7_p_3">Currently the key modifier is only used when generating XPath value for the HTML output style when XOF_XPATH is set, but other uses are likely in the near future.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_8">

<a id="the-leaf-list-modifier-l" href="#the-leaf-list-modifier-l">The Leaf-List Modifier ({l:})</a>
</h4>
<p id="doc_section_3_2_2_8_p_1">The leaf-list modifier is used to distinguish lists where each instance consists of only a single value. In XML, these are rendered as single elements, where JSON renders them as arrays.</p>
 <pre>    EXAMPLE:
        for (i = 0; i &lt; num_users; i++) {
            xo_emit(&#34;Member {l:user}\n&#34;, user[i].u_name);
        }
    XML:
        &lt;user&gt;phil&lt;/user&gt;
        &lt;user&gt;pallavi&lt;/user&gt;
    JSON:
        &#34;user&#34;: [ &#34;phil&#34;, &#34;pallavi&#34; ]
            </pre> <p id="doc_section_3_2_2_8_p_3">The name of the field must match the name of the leaf list.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_9">

<a id="the-no-quotes-modifier-n" href="#the-no-quotes-modifier-n">The No-Quotes Modifier ({n:})</a>
</h4>
<p id="doc_section_3_2_2_9_p_1">The no-quotes modifier (and its twin, the &#39;quotes&#39; modifier) affect the quoting of values in the JSON output style. JSON uses quotes for string value, but no quotes for numeric, boolean, and null data. xo_emit applies a simple heuristic to determine whether quotes are needed, but often this needs to be controlled by the caller.</p>
 <pre>    EXAMPLE:
      const char *bool = is_true ? &#34;true&#34; : &#34;false&#34;;
      xo_emit(&#34;{n:fancy/%s}&#34;, bool);
    JSON:
      &#34;fancy&#34;: true
            </pre> </div>
<div>
<h4 id="doc_section_3_2_2_10">

<a id="plural-modifier" href="#plural-modifier">The Plural Modifier ({p:})</a>
</h4>
<p id="doc_section_3_2_2_10_p_1">The plural modifier selects the appropriate plural form of an expression based on the most recent number emitted and the current language settings. The contents of the field should be the singular and plural English values, separated by a comma:</p>
 <pre>    xo_emit(&#34;{:bytes} {Ngp:byte,bytes}\n&#34;, bytes);
            </pre> <p id="doc_section_3_2_2_10_p_3">The plural modifier is meant to work with the gettext modifier ({g:}) but can work independently. See <a href="#gettext-modifier" title="The Gettext Modifier ({g:})">Section 3.2.2.5</a>.</p>
<p id="doc_section_3_2_2_10_p_4">When used without the gettext modifier or when the message does not appear in the message catalog, the first token is chosen when the last numeric value is equal to 1; otherwise the second value is used, mimicking the simple pluralization rules of English.</p>
<p id="doc_section_3_2_2_10_p_5">When used with the gettext modifier, the ngettext(3) function is called to handle the heavy lifting, using the message catalog to convert the singular and plural forms into the native language.</p>
</div>
<div>
<h4 id="doc_section_3_2_2_11">

<a id="the-quotes-modifier-q" href="#the-quotes-modifier-q">The Quotes Modifier ({q:})</a>
</h4>
<p id="doc_section_3_2_2_11_p_1">The quotes modifier (and its twin, the &#39;noâ€‘quotes&#39; modifier) affect the quoting of values in the JSON output style. JSON uses quotes for string value, but no quotes for numeric, boolean, and null data. xo_emit applies a simple heuristic to determine whether quotes are needed, but often this needs to be controlled by the caller.</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{q:time/%d}&#34;, 2014);
    JSON:
      &#34;year&#34;: &#34;2014&#34;
            </pre> <p id="doc_section_3_2_2_11_p_3">The heuristic is based on the format; if the format uses any of the following conversion specifiers, then no quotes are used:</p>
 <pre>    d i o u x X D O U e E f F g G a A c C p
            </pre> </div>
<div>
<h4 id="doc_section_3_2_2_12">

<a id="the-trim-modifier-t" href="#the-trim-modifier-t">The Trim Modifier ({t:})</a>
</h4>
<p id="doc_section_3_2_2_12_p_1">The trim modifier removes any leading or trailing whitespace from the value.</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{t:description}&#34;, &#34;   some  input   &#34;);
    JSON:
      &#34;description&#34;: &#34;some input&#34;
            </pre> </div>
<div>
<h4 id="doc_section_3_2_2_13">

<a id="the-white-space-modifier-w" href="#the-white-space-modifier-w">The White Space Modifier ({w:})</a>
</h4>
<p id="doc_section_3_2_2_13_p_1">The white space modifier appends a single space to the data value:</p>
 <pre>    EXAMPLE:
      xo_emit(&#34;{Lw:Name}{:name}\n&#34;, &#34;phil&#34;);
    TEXT:
      Name phil
            </pre> <p id="doc_section_3_2_2_13_p_3">The white space modifier is only used for the TEXT and HTML output styles. It is commonly combined with the colon modifier (&#39;{c:}&#39;). It is purely a convenience feature.</p>
<p id="doc_section_3_2_2_13_p_4">Note that the sense of the &#39;w&#39; modifier is reversed for the units role ({Uw:}); a blank is added before the contents, rather than after it.</p>
</div>
</div>
<div>
<h3 id="doc_section_3_2_3">

<a id="field-formatting" href="#field-formatting">Field Formatting</a>
</h3>
<p id="doc_section_3_2_3_p_1">The field format is similar to the format string for printf(3). Its use varies based on the role of the field, but generally is used to format the field&#39;s contents.</p>
<p id="doc_section_3_2_3_p_2">If the format string is not provided for a value field, it defaults to &#34;%s&#34;.</p>
<p id="doc_section_3_2_3_p_3">Note a field definition can contain zero or more printf-style &#39;directives&#39;, which are sequences that start with a &#39;%&#39; and end with one of following characters: &#34;diouxXDOUeEfFgGaAcCsSp&#34;. Each directive is matched by one of more arguments to the xo_emit function.</p>
<p id="doc_section_3_2_3_p_4">The format string has the form:</p>
 <pre>  &#39;%&#39; format-modifier * format-character
            </pre> <p id="doc_section_3_2_3_p_6">The format- modifier can be:</p>

<ul>
<li>a &#39;#&#39; character, indicating the output value should be prefixed with &#39;0x&#39;, typically to indicate a base 16 (hex) value.</li>
<li>a minus sign (&#39;â€‘&#39;), indicating the output value should be padded on the right instead of the left.</li>
<li>a leading zero (&#39;0&#39;) indicating the output value should be padded on the left with zeroes instead of spaces (&#39; &#39;).</li>
<li>one or more digits (&#39;0&#39; - &#39;9&#39;) indicating the minimum width of the argument. If the width in columns of the output value is less than the minimum width, the value will be padded to reach the minimum.</li>
<li>a period followed by one or more digits indicating the maximum number of bytes which will be examined for a string argument, or the maximum width for a non-string argument. When handling ASCII strings this functions as the field width but for multi-byte characters, a single character may be composed of multiple bytes. xo_emit will never dereference memory beyond the given number of bytes.</li>
<li>a second period followed by one or more digits indicating the maximum width for a string argument. This modifier cannot be given for non-string arguments.</li>
<li>one or more &#39;h&#39; characters, indicating shorter input data.</li>
<li>one or more &#39;l&#39; characters, indicating longer input data.</li>
<li>a &#39;z&#39; character, indicating a &#39;size_t&#39; argument.</li>
<li>a &#39;t&#39; character, indicating a &#39;ptrdiff_t&#39; argument.</li>
<li>a &#39; &#39; character, indicating a space should be emitted before positive numbers.</li>
<li>a &#39;+&#39; character, indicating sign should emitted before any number.</li>
</ul>
<p id="doc_section_3_2_3_p_8">Note that &#39;q&#39;, &#39;D&#39;, &#39;O&#39;, and &#39;U&#39; are considered deprecated and will be removed eventually.</p>
<p id="doc_section_3_2_3_p_9">The format character is described in the following table:</p>
<div id="doc_table_u.5"><table summary="">
<thead><tr>
<th>Ltr</th>
<th>Argument Type</th>
<th>Format</th>
</tr></thead>
<tbody>
<tr>
<td>d</td>
<td>int</td>
<td>base 10 (decimal)</td>
</tr>
<tr>
<td>i</td>
<td>int</td>
<td>base 10 (decimal)</td>
</tr>
<tr>
<td>o</td>
<td>int</td>
<td>base 8 (octal)</td>
</tr>
<tr>
<td>u</td>
<td>unsigned</td>
<td>base 10 (decimal)</td>
</tr>
<tr>
<td>x</td>
<td>unsigned</td>
<td>base 16 (hex)</td>
</tr>
<tr>
<td>X</td>
<td>unsigned long</td>
<td>base 16 (hex)</td>
</tr>
<tr>
<td>D</td>
<td>long</td>
<td>base 10 (decimal)</td>
</tr>
<tr>
<td>O</td>
<td>unsigned long</td>
<td>base 8 (octal)</td>
</tr>
<tr>
<td>U</td>
<td>unsigned long</td>
<td>base 10 (decimal)</td>
</tr>
<tr>
<td>e</td>
<td>double</td>
<td>[-]d.ddde+-dd</td>
</tr>
<tr>
<td>E</td>
<td>double</td>
<td>[-]d.dddE+-dd</td>
</tr>
<tr>
<td>f</td>
<td>double</td>
<td>[-]ddd.ddd</td>
</tr>
<tr>
<td>F</td>
<td>double</td>
<td>[-]ddd.ddd</td>
</tr>
<tr>
<td>g</td>
<td>double</td>
<td>as &#39;e&#39; or &#39;f&#39;</td>
</tr>
<tr>
<td>G</td>
<td>double</td>
<td>as &#39;E&#39; or &#39;F&#39;</td>
</tr>
<tr>
<td>a</td>
<td>double</td>
<td>[-]0xh.hhhp[+-]d</td>
</tr>
<tr>
<td>A</td>
<td>double</td>
<td>[-]0Xh.hhhp[+-]d</td>
</tr>
<tr>
<td>c</td>
<td>unsigned char</td>
<td>a character</td>
</tr>
<tr>
<td>C</td>
<td>wint_t</td>
<td>a character</td>
</tr>
<tr>
<td>s</td>
<td>char *</td>
<td>a UTF-8 string</td>
</tr>
<tr>
<td>S</td>
<td>wchar_t *</td>
<td>a unicode/WCS string</td>
</tr>
<tr>
<td>p</td>
<td>void *</td>
<td>&#39;%#lx&#39;</td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_3_p_10">The &#39;h&#39; and &#39;l&#39; modifiers affect the size and treatment of the argument:</p>
<div id="doc_table_u.6"><table summary="">
<thead><tr>
<th>Mod</th>
<th>d, i</th>
<th>o, u, x, X</th>
</tr></thead>
<tbody>
<tr>
<td>hh</td>
<td>signed char</td>
<td>unsigned char</td>
</tr>
<tr>
<td>h</td>
<td>short</td>
<td>unsigned short</td>
</tr>
<tr>
<td>l</td>
<td>long</td>
<td>unsigned long</td>
</tr>
<tr>
<td>ll</td>
<td>long long</td>
<td>unsigned long long</td>
</tr>
<tr>
<td>j</td>
<td>intmax_t</td>
<td>uintmax_t</td>
</tr>
<tr>
<td>t</td>
<td>ptrdiff_t</td>
<td>ptrdiff_t</td>
</tr>
<tr>
<td>z</td>
<td>size_t</td>
<td>size_t</td>
</tr>
<tr>
<td>q</td>
<td>quad_t</td>
<td>u_quad_t</td>
</tr>
</tbody>
</table></div>
</div>
<div>
<h3 id="doc_section_3_2_4">

<a id="utf-8-and-locale-strings" href="#utf-8-and-locale-strings">UTF-8 and Locale Strings</a>
</h3>
<p id="doc_section_3_2_4_p_1">For strings, the &#39;h&#39; and &#39;l&#39; modifiers affect the interpretation of the bytes pointed to argument. The default &#39;%s&#39; string is a &#39;char *&#39; pointer to a string encoded as UTF-8. Since UTF-8 is compatible with ASCII data, a normal 7-bit ASCII string can be used. &#39;%ls&#39; expects a &#39;wchar_t *&#39; pointer to a wide-character string, encoded as a 32-bit Unicode values. &#39;%hs&#39; expects a &#39;char *&#39; pointer to a multi-byte string encoded with the current locale, as given by the LC_CTYPE, LANG, or LC_ALL environment varibles. The first of this list of variables is used and if none of the variables are set, the locale defaults to &#34;UTFâ€‘8&#34;.</p>
<p id="doc_section_3_2_4_p_2">libxo will convert these arguments as needed to either UTF-8 (for XML, JSON, and HTML styles) or locale-based strings for display in text style.</p>
 <pre>   xo_emit(&#34;All strings are utf-8 content {:tag/%ls}&#34;,
           L&#34;except for wide strings&#34;);
            </pre> <p id="doc_section_3_2_4_p_4">&#34;%S&#34; is equivalent to &#34;%ls&#34;.</p>
<div id="doc_table_u.7"><table summary="">
<thead><tr>
<th>Format</th>
<th>Argument Type</th>
<th>Argument Contents</th>
</tr></thead>
<tbody>
<tr>
<td>%s</td>
<td>const char *</td>
<td>UTF-8 string</td>
</tr>
<tr>
<td>%S</td>
<td>const char *</td>
<td>UTF-8 string (alias for &#39;%s&#39;)</td>
</tr>
<tr>
<td>%ls</td>
<td>const wchar_t *</td>
<td>Wide character UNICODE string</td>
</tr>
<tr>
<td>%hs</td>
<td>const char *</td>
<td>locale-based string</td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_4_p_5">For example, a function is passed a locale-base name, a hat size, and a time value. The hat size is formatted in a UTF-8 (ASCII) string, and the time value is formatted into a wchar_t string.</p>
 <pre>    void print_order (const char *name, int size,
                      struct tm *timep) {
        char buf[32];
        const char *size_val = &#34;unknown&#34;;

        if (size &gt; 0)
            snprintf(buf, sizeof(buf), &#34;%d&#34;, size);
            size_val = buf;
        }

        wchar_t when[32];
        wcsftime(when, sizeof(when), L&#34;%d%b%y&#34;, timep);

        xo_emit(&#34;The hat for {:name/%hs} is {:size/%s}.\n&#34;,
                name, size_val);
        xo_emit(&#34;It was ordered on {:order-time/%ls}.\n&#34;,
                when);
    }
            </pre> <p id="doc_section_3_2_4_p_7">It is important to note that xo_emit will perform the conversion required to make appropriate output. Text style output uses the current locale (as described above), while XML, JSON, and HTML use UTF-8.</p>
<p id="doc_section_3_2_4_p_8">UTF-8 and locale-encoded strings can use multiple bytes to encode one column of data. The traditional &#34;precision&#39;&#34; (aka &#34;maxâ€‘width&#34;) value for &#34;%s&#34; printf formatting becomes overloaded since it specifies both the number of bytes that can be safely referenced and the maximum number of columns to emit. xo_emit uses the precision as the former, and adds a third value for specifying the maximum number of columns.</p>
<p id="doc_section_3_2_4_p_9">In this example, the name field is printed with a minimum of 3 columns and a maximum of 6. Up to ten bytes of data at the location given by &#39;name&#39; are in used in filling those columns.</p>
 <pre>    xo_emit(&#34;{:name/%3.10.6s}&#34;, name);
            </pre> </div>
<div>
<h3 id="doc_section_3_2_5">

<a id="characters-outside-of-field-definitions" href="#characters-outside-of-field-definitions">Characters Outside of Field Definitions</a>
</h3>
<p id="doc_section_3_2_5_p_1">Characters in the format string that are not part of a field definition are copied to the output for the TEXT style, and are ignored for the JSON and XML styles. For HTML, these characters are placed in a &lt;div&gt; with class &#34;text&#34;.</p>
 <pre>  EXAMPLE:
      xo_emit(&#34;The hat is {:size/%s}.\n&#34;, size_val);
  TEXT:
      The hat is extra small.
  XML:
      &lt;size&gt;extra small&lt;/size&gt;
  JSON:
      &#34;size&#34;: &#34;extra small&#34;
  HTML:
      &lt;div class=&#34;text&#34;&gt;The hat is &lt;/div&gt;
      &lt;div class=&#34;data&#34; data-tag=&#34;size&#34;&gt;extra small&lt;/div&gt;
      &lt;div class=&#34;text&#34;&gt;.&lt;/div&gt;
            </pre> </div>
<div>
<h3 id="doc_section_3_2_6">

<a id="m-is-supported" href="#m-is-supported">&#34;%m&#34; Is Supported</a>
</h3>
<p id="doc_section_3_2_6_p_1">libxo supports the &#39;%m&#39; directive, which formats the error message associated with the current value of &#34;errno&#34;. It is the equivalent of &#34;%s&#34; with the argument strerror(errno).</p>
 <pre>    xo_emit(&#34;{:filename} cannot be opened: {:error/%m}&#34;, filename);
    xo_emit(&#34;{:filename} cannot be opened: {:error/%s}&#34;,
            filename, strerror(errno));
            </pre> </div>
<div>
<h3 id="doc_section_3_2_7">

<a id="n-is-not-supported" href="#n-is-not-supported">&#34;%n&#34; Is Not Supported</a>
</h3>
<p id="doc_section_3_2_7_p_1">libxo does not support the &#39;%n&#39; directive. It&#39;s a bad idea and we just don&#39;t do it.</p>
</div>
<div>
<h3 id="doc_section_3_2_8">

<a id="the-encoding-format-eformat" href="#the-encoding-format-eformat">The Encoding Format (eformat)</a>
</h3>
<p id="doc_section_3_2_8_p_1">The &#34;eformat&#34; string is the format string used when encoding the field for JSON and XML. If not provided, it defaults to the primary format with any minimum width removed. If the primary is not given, both default to &#34;%s&#34;.</p>
</div>
<div>
<h3 id="doc_section_3_2_9">

<a id="content-strings" href="#content-strings">Content Strings</a>
</h3>
<p id="doc_section_3_2_9_p_1">For padding and labels, the content string is considered the content, unless a format is given.</p>
</div>
<div>
<h3 id="doc_section_3_2_10">

<a id="printf-like" href="#printf-like">Argument Validation</a>
</h3>
<p id="doc_section_3_2_10_p_1">Many compilers and tool chains support validation of printf-like arguments. When the format string fails to match the argument list, a warning is generated. This is a valuable feature and while the formatting strings for libxo differ considerably from printf, many of these checks can still provide build-time protection against bugs.</p>
<p id="doc_section_3_2_10_p_2">libxo provide variants of functions that provide this ability, if the &#34;â€‘â€‘enableâ€‘printflike&#34; option is passed to the &#34;configure&#34; script. These functions use the &#34;_p&#34; suffix, like &#34;xo_emit_p()&#34;, xo_emit_hp()&#34;, etc.</p>
<p id="doc_section_3_2_10_p_3">The following are features of libxo formatting strings that are incompatible with printf-like testing:</p>

<ul>
<li>implicit formats, where &#34;{:tag}&#34; has an implicit &#34;%s&#34;;</li>
<li>the &#34;max&#34; parameter for strings, where &#34;{:tag/%4.10.6s}&#34; means up to ten bytes of data can be inspected to fill a minimum of 4 columns and a maximum of 6;</li>
<li>percent signs in strings, where &#34;{:filled}%&#34; makes a single, trailing percent sign;</li>
<li>the &#34;l&#34; and &#34;h&#34; modifiers for strings, where &#34;{:tag/%hs}&#34; means locale-based string and &#34;{:tag/%ls}&#34; means a wide character string;</li>
<li>distinct encoding formats, where &#34;{:tag/#%s/%s}&#34; means the display styles (text and HTML) will use &#34;#%s&#34; where other styles use &#34;%s&#34;;</li>
</ul>
<p id="doc_section_3_2_10_p_5">If none of these features are in use by your code, then using the &#34;_p&#34; variants might be wise.</p>
<div id="doc_table_u.8"><table summary="">
<thead><tr>
<th>Function</th>
<th>printf-like Equivalent</th>
</tr></thead>
<tbody>
<tr>
<td>xo_emit_hv</td>
<td>xo_emit_hvp</td>
</tr>
<tr>
<td>xo_emit_h</td>
<td>xo_emit_hp</td>
</tr>
<tr>
<td>xo_emit</td>
<td>xo_emit_p</td>
</tr>
<tr>
<td>xo_emit_warn_hcv</td>
<td>xo_emit_warn_hcvp</td>
</tr>
<tr>
<td>xo_emit_warn_hc</td>
<td>xo_emit_warn_hcp</td>
</tr>
<tr>
<td>xo_emit_warn_c</td>
<td>xo_emit_warn_cp</td>
</tr>
<tr>
<td>xo_emit_warn</td>
<td>xo_emit_warn_p</td>
</tr>
<tr>
<td>xo_emit_warnx_</td>
<td>xo_emit_warnx_p</td>
</tr>
<tr>
<td>xo_emit_err</td>
<td>xo_emit_err_p</td>
</tr>
<tr>
<td>xo_emit_errx</td>
<td>xo_emit_errx_p</td>
</tr>
<tr>
<td>xo_emit_errc</td>
<td>xo_emit_errc_p</td>
</tr>
</tbody>
</table></div>
</div>
<div>
<h3 id="doc_section_3_2_11">

<a id="retain" href="#retain">Retaining Parsed Format Information</a>
</h3>
<p id="doc_section_3_2_11_p_1">libxo can retain the parsed internal information related to the given format string, allowing subsequent xo_emit calls, the retained information is used, avoiding repetitive parsing of the format string.</p>
 <pre>    SYNTAX:
      int xo_emit_f(xo_emit_flags_t flags, const char fmt, ...);
    EXAMPLE:
      xo_emit_f(XOEF_RETAIN, &#34;{:some/%02d}{:thing/%-6s}{:fancy}\n&#34;,
                     some, thing, fancy);
            </pre> <p id="doc_section_3_2_11_p_3">To retain parsed format information, use the XOEF_RETAIN flag to the xo_emit_f() function. A complete set of xo_emit_f functions exist to match all the xo_emit function signatures (with handles, varadic argument, and printf-like flags):</p>
<div id="doc_table_u.9"><table summary="">
<thead><tr>
<th>Function</th>
<th>Flags Equivalent</th>
</tr></thead>
<tbody>
<tr>
<td>xo_emit_hv</td>
<td>xo_emit_hvf</td>
</tr>
<tr>
<td>xo_emit_h</td>
<td>xo_emit_hf</td>
</tr>
<tr>
<td>xo_emit</td>
<td>xo_emit_f</td>
</tr>
<tr>
<td>xo_emit_hvp</td>
<td>xo_emit_hvfp</td>
</tr>
<tr>
<td>xo_emit_hp</td>
<td>xo_emit_hfp</td>
</tr>
<tr>
<td>xo_emit_p</td>
<td>xo_emit_fp</td>
</tr>
</tbody>
</table></div>
<p id="doc_section_3_2_11_p_4">The format string must be immutable across multiple calls to xo_emit_f(), since the library retains the string. Typically this is done by using static constant strings, such as string literals. If the string is not immutable, the XOEF_RETAIN flag must not be used.</p>
<p id="doc_section_3_2_11_p_5">The functions xo_retain_clear() and xo_retain_clear_all() release internal information on either a single format string or all format strings, respectively. Neither is required, but the library will retain this information until it is cleared or the process exits.</p>
 <pre>    const char *fmt = &#34;{:name}  {:count/%d}\n&#34;;
    for (i = 0; i &lt; 1000; i++) {
        xo_open_instance(&#34;item&#34;);
        xo_emit_f(XOEF_RETAIN, fmt, name[i], count[i]);
    }
    xo_retain_clear(fmt);
            </pre> <p id="doc_section_3_2_11_p_7">The retained information is kept as thread-specific data.</p>
</div>
<div>
<h3 id="doc_section_3_2_12">

<a id="example" href="#example">Example</a>
</h3>
<p id="doc_section_3_2_12_p_1">In this example, the value for the number of items in stock is emitted:</p>
 <pre>        xo_emit(&#34;{P:   }{Lwc:In stock}{:in-stock/%u}\n&#34;,
                instock);
            </pre> <p id="doc_section_3_2_12_p_3">This call will generate the following output:</p>
 <pre>  TEXT: 
       In stock: 144
  XML:
      &lt;in-stock&gt;144&lt;/in-stock&gt;
  JSON:
      &#34;in-stock&#34;: 144,
  HTML:
      &lt;div class=&#34;line&#34;&gt;
        &lt;div class=&#34;padding&#34;&gt;   &lt;/div&gt;
        &lt;div class=&#34;label&#34;&gt;In stock&lt;/div&gt;
        &lt;div class=&#34;decoration&#34;&gt;:&lt;/div&gt;
        &lt;div class=&#34;padding&#34;&gt; &lt;/div&gt;
        &lt;div class=&#34;data&#34; data-tag=&#34;in-stock&#34;&gt;144&lt;/div&gt;
      &lt;/div&gt;
            </pre> <p id="doc_section_3_2_12_p_5">Clearly HTML wins the verbosity award, and this output does not include XOF_XPATH or XOF_INFO data, which would expand the penultimate line to:</p>
 <pre>       &lt;div class=&#34;data&#34; data-tag=&#34;in-stock&#34;
          data-xpath=&#34;/top/data/item/in-stock&#34;
          data-type=&#34;number&#34;
          data-help=&#34;Number of items in stock&#34;&gt;144&lt;/div&gt;
            </pre> </div>
</div><div>
<h2 id="doc_section_3_3">

<a id="representing-hierarchy" href="#representing-hierarchy">Representing Hierarchy</a>
</h2>
<p id="doc_section_3_3_p_1">For XML and JSON, individual fields appear inside hierarchies which provide context and meaning to the fields. Unfortunately, these encoding have a basic disconnect between how lists is similar objects are represented.</p>
<p id="doc_section_3_3_p_2">XML encodes lists as set of sequential elements:</p>
 <pre>    &lt;user&gt;phil&lt;/user&gt;
    &lt;user&gt;pallavi&lt;/user&gt;
    &lt;user&gt;sjg&lt;/user&gt;
            </pre> <p id="doc_section_3_3_p_4">JSON encodes lists using a single name and square brackets:</p>
 <pre>    &#34;user&#34;: [ &#34;phil&#34;, &#34;pallavi&#34;, &#34;sjg&#34; ]
            </pre> <p id="doc_section_3_3_p_6">This means libxo needs three distinct indications of hierarchy: one for containers of hierarchy appear only once for any specific parent, one for lists, and one for each item in a list.</p>
<p id="doc_section_3_3_p_7">Section Contents: </p>
<ul>
<li><a href="#containers" title="Containers">Section 3.3.1</a></li>
<li><a href="#lists-and-instances" title="Lists and Instances">Section 3.3.2</a></li>
<li><a href="#dtrt-mode" title="DTRT Mode">Section 3.3.3</a></li>
<li><a href="#markers" title="Markers">Section 3.3.4</a></li>
</ul>
<div>
<h3 id="doc_section_3_3_1">

<a id="containers" href="#containers">Containers</a>
</h3>
<p id="doc_section_3_3_1_p_1">A &#34;container&#34; is an element of a hierarchy that appears only once under any specific parent. The container has no value, but serves to contain other nodes.</p>
<p id="doc_section_3_3_1_p_2">To open a container, call xo_open_container() or xo_open_container_h(). The former uses the default handle and the latter accepts a specific handle.</p>
 <pre>    int xo_open_container_h (xo_handle_t *xop, const char *name);
    int xo_open_container (const char *name);
            </pre> <p id="doc_section_3_3_1_p_4">To close a level, use the xo_close_container() or xo_close_container_h() functions:</p>
 <pre>    int xo_close_container_h (xo_handle_t *xop, const char *name);
    int xo_close_container (const char *name);
            </pre> <p id="doc_section_3_3_1_p_6">Each open call must have a matching close call. If the XOF_WARN flag is set and the name given does not match the name of the currently open container, a warning will be generated.</p>
 <pre>    Example:

        xo_open_container(&#34;top&#34;);
        xo_open_container(&#34;system&#34;);
        xo_emit(&#34;{:host-name/%s%s%s&#34;, hostname,
                domainname ? &#34;.&#34; : &#34;&#34;, domainname ?: &#34;&#34;);
        xo_close_container(&#34;system&#34;);
        xo_close_container(&#34;top&#34;);

    Sample Output:
      Text:
        my-host.example.org
      XML:
        &lt;top&gt;
          &lt;system&gt;
              &lt;host-name&gt;my-host.example.org&lt;/host-name&gt;
          &lt;/system&gt;
        &lt;/top&gt;
      JSON:
        &#34;top&#34; : {
          &#34;system&#34; : {
              &#34;host-name&#34;: &#34;my-host.example.org&#34;
          }
        }
      HTML:
        &lt;div class=&#34;data&#34;
             data-tag=&#34;host-name&#34;&gt;my-host.example.org&lt;/div&gt;
            </pre> </div>
<div>
<h3 id="doc_section_3_3_2">

<a id="lists-and-instances" href="#lists-and-instances">Lists and Instances</a>
</h3>
<p id="doc_section_3_3_2_p_1">A list is set of one or more instances that appear under the same parent. The instances contain details about a specific object. One can think of instances as objects or records. A call is needed to open and close the list, while a distinct call is needed to open and close each instance of the list:</p>
 <pre>    xo_open_list(&#34;item&#34;);

    for (ip = list; ip-&gt;i_title; ip++) {
        xo_open_instance(&#34;item&#34;);
        xo_emit(&#34;{L:Item} &#39;{:name/%s}&#39;:\n&#34;, ip-&gt;i_title);
        xo_close_instance(&#34;item&#34;);
    }

    xo_close_list(&#34;item&#34;);
            </pre> <p id="doc_section_3_3_2_p_3">Getting the list and instance calls correct is critical to the proper generation of XML and JSON data.</p>
</div>
<div>
<h3 id="doc_section_3_3_3">

<a id="dtrt-mode" href="#dtrt-mode">DTRT Mode</a>
</h3>
<p id="doc_section_3_3_3_p_1">Some users may find tracking the names of open containers, lists, and instances inconvenient. libxo offers a &#34;Do The Right Thing&#34; mode, where libxo will track the names of open containers, lists, and instances so the close function can be called without a name. To enable DTRT mode, turn on the XOF_DTRT flag prior to making any other libxo output.</p>
 <pre>    xo_set_flags(NULL, XOF_DTRT);
            </pre> <p id="doc_section_3_3_3_p_3">Each open and close function has a version with the suffix &#34;_d&#34;, which will close the open container, list, or instance:</p>
 <pre>    xo_open_container(&#34;top&#34;);
    ...
    xo_close_container_d();
            </pre> <p id="doc_section_3_3_3_p_5">This also works for lists and instances:</p>
 <pre>    xo_open_list(&#34;item&#34;);
    for (...) {
        xo_open_instance(&#34;item&#34;);
        xo_emit(...);
        xo_close_instance_d();
    }
    xo_close_list_d();
            </pre> <p id="doc_section_3_3_3_p_7">Note that the XOF_WARN flag will also cause libxo to track open containers, lists, and instances. A warning is generated when the name given to the close function and the name recorded do not match.</p>
</div>
<div>
<h3 id="doc_section_3_3_4">

<a id="markers" href="#markers">Markers</a>
</h3>
<p id="doc_section_3_3_4_p_1">Markers are used to protect and restore the state of open constructs. While a marker is open, no other open constructs can be closed. When a marker is closed, all constructs open since the marker was opened will be closed.</p>
<p id="doc_section_3_3_4_p_2">Markers use names which are not user-visible, allowing the caller to choose appropriate internal names.</p>
<p id="doc_section_3_3_4_p_3">In this example, the code whiffles through a list of fish, calling a function to emit details about each fish. The marker &#34;fishâ€‘guts&#34; is used to ensure that any constructs opened by the function are closed properly.</p>
 <pre>    for (i = 0; fish[i]; i++) {
        xo_open_instance(&#34;fish&#34;);
        xo_open_marker(&#34;fish-guts&#34;);
        dump_fish_details(i);
        xo_close_marker(&#34;fish-guts&#34;);
    }
            </pre> </div>
</div></div>
  </body>
</html>
