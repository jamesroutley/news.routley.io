<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lwn.net/Articles/989629/">Original</a>
    <h1>Vanilla OS 2: an immutable distribution to run all software</h1>
    
    <div id="readability-page-1" class="page"><div>

<p><a href="https://vanillaos.org">Vanilla OS</a>, an immutable desktop
Linux distribution designed for developers and advanced users, has
recently published its <a href="https://vanillaos.org/blog/article/2024-07-28/vanilla-os-2-orchid---stable-release">2.0
&#34;Orchid&#34; release</a>. Previously based on Ubuntu, Vanilla OS has now
shifted to Debian unstable (&#34;sid&#34;). The release has made it easier to
install software from other distributions&#39; package repositories, and it
is now theoretically possible to install and run Android applications as well.</p>

<p>The idea behind Vanilla OS is to maintain a small, immutable core
operating system while isolating additional software from that core
through containerization or sandboxing. The core of Vanilla OS is based
on <a href="https://opencontainers.org">Open Container Initiative</a>
(OCI) images composed of packages from Debian sid. These images are
updated and managed by the <a href="https://abroot.vanillaos.org">ABRoot</a> utility. Rather than
handling system updates through a package manager, Vanilla OS
downloads a new OCI image, and then uses the new image when it
reboots. This is similar to other image-based operating systems, like
<a href="https://lwn.net/Articles/977987/">Aeon</a> and <a href="https://lwn.net/Articles/954059/">Bluefin</a> that use <a href="https://source.android.com/docs/core/ota/ab">A/B image
update</a> strategiesâ€”though each distribution has its own
method of doing so. All of this happens under the hood, so users don&#39;t
have to be aware of how updates work.</p>

<p>One of the reasons that Vanilla OS <a href="https://lwn.net/Articles/929124/">shifted from Ubuntu to
Debian</a> was that the latter offers a more vanilla GNOME experience by
providing the software without significant customizations. As the
project&#39;s <a href="https://vanillaos.org/blog/article/2023-03-07/vanilla-os-20-orchid---initial-work">announcement</a>
from last year said:

</p><blockquote>
Ubuntu provides a modified version of the GNOME desktop, that does not
match how GNOME envisions its desktop. One of the high-level goals of
Vanilla OS is to be as vanilla as possible, so we reverted many of
these changes to reach that goal.
</blockquote>

<p>Another concern cited in the announcement was Ubuntu&#39;s
reliance on the <a href="https://ubuntu.com/core/services/guide/snaps-intro">Snap</a> packaging
format, with problems like slow startups and Canonical&#39;s control over the
official <a href="https://snapcraft.io">Snap store</a>.</p>

<h4>Installing the system and applications</h4>

<p>The project offers an <a href="https://vanillaos.org/download/orchid/stable">ISO image</a> for
x86-64 systems, with no support for other architectures. Only UEFI systems are
supported, and even on those systems, the installer seems quite finicky.
On two physical test machines, the installer seemed to run fine until it
aborted with a generic error message. I managed to install Vanilla OS in
a virtual machine (using <a href="https://apps.gnome.org/Boxes/">GNOME Boxes</a>) only after selecting Debian testing
as the operating system (and choosing UEFI, of course).</p>

<p>When the installer works, it is straightforward to use. After the first reboot, a
configuration wizard guides the user through creating an account and
selecting applications to install. After a second reboot, the user is
prompted to choose a password, followed by the installation of the
selected applications using <a href="https://flatpak.org">Flatpak</a>.</p>

<p>Upon installation of these applications, a stock GNOME desktop
environment appears. The recommended way to install applications in
Vanilla OS is through the GNOME application <a href="https://apps.gnome.org/Software/">Software</a>, which is
configured to install applications as Flatpaks from <a href="https://flathub.org">Flathub</a>. By default, Flatpaks installed
this way are updated automatically. Vanilla OS also checks for system
updates weekly, by default. Users can change this to daily, weekly, or
never if they choose. To minimize any impact on the user experience, the
updater considers factors such as system load, battery level, and
network connection before applying system updates. With the core operating system
and applications set for automatic updates, Vanilla OS aims to relieve
users of the often tedious task of keeping all packages updated.</p>

<h4>Installing non-Flatpak packages</h4>

<p>Although Flatpak has gained popularity, many applications are still
not available as Flatpaks. Given that Vanilla OS is based on Debian,
users might be tempted to install a <tt>.deb</tt> package directly into the core
operating system when there&#39;s no Flatpak version for it. However,
Vanilla OS doesn&#39;t offer that possibility. It addresses the need for
Debian packages with the <a href="https://vanillaos.org/blog/article/2024-07-16/discover-vso-v2-managing-your-vanilla-os-installation-like-never-before">Vanilla
System Operator</a> (VSO v2), a container where users can safely install
any <tt>.deb</tt> package.</p>

<p>VSO integrates software installed in a container with the desktop
so that it appears just like any other desktop application. After downloading a <tt>.deb</tt>
package, double-clicking on the file in the <a href="https://apps.gnome.org/Nautilus/">GNOME Files</a> application
launches the <a href="https://github.com/Vanilla-OS/sideload-utility">Sideload</a> utility, which installs the <tt>.deb</tt> package into
the VSO container. Once installed, the application is displayed among
other applications in GNOME&#39;s activities overview.
Launching the application runs it in a container, isolated from the
operating system but integrated with the user&#39;s home directory. Thus, an
application installed via a <tt>.deb</tt> package behaves similarly to one
installed via Flatpak.</p>

<p>There&#39;s also a command-line method for installing <tt>.deb</tt> files. The
default terminal emulator in Vanilla OS is <a href="https://gitlab.gnome.org/raggesilver/blackbox">Black Box</a>. When
launched, this application takes the user to a shell within the VSO
container rather than the core operating system. Packages can be
installed in this container using Debian&#39;s <tt>apt</tt> package manager.</p>

<p>This method is also useful for troubleshooting dependency issues. For
instance, I decided to install an open-source ChatGPT alternative
called <a href="https://jan.ai">Jan</a> on Vanilla OS. 
When I attempted to install its <tt>.deb</tt> package with Sideload, the
application failed to start without any
clear indication of what was wrong. Opening Black Box and running the
<code>jan</code> command in the shell revealed an error message
regarding a missing library: <tt>libasound2.so</tt>. It turned out that Jan&#39;s
<tt>.deb</tt> package didn&#39;t list this library as a dependency. After executing
<code>sudo apt install libasound2</code> in Black Box, I was able to run
Jan successfully.</p>

<p>Vanilla OS offers a similar method for installing Android apps by
running them in a <a href="https://waydro.id">Waydroid</a> container.
However, the developers caution that this is still an experimental
feature. I was able to initialize the Android subsystem with
<tt>vso android init</tt> in the VSO shell but encountered issues
when trying to manually open an Android <tt>.apk</tt> file with Sideload. Despite
several troubleshooting attempts, I was unable to get the Android
functionality running. This was possibly due to my test system running
in a virtual machine, a scenario that the project has not tested.</p>

<h4>Linux subsystems</h4>

<p>While VSO is the default container in Vanilla OS, the operating
system allows users to install separate &#34;subsystems&#34; based on various
Linux distributions through <a href="https://docs.vanillaos.org/docs/en/apx-manpage">Apx</a>, a wrapper
around <a href="https://distrobox.it">Distrobox</a>. The latter, in
turn, is a wrapper around <a href="https://podman.io">Podman</a>, <a href="https://www.docker.com">Docker</a>, or the simple container
manager <a href="https://github.com/89luca89/lilipod?tab=readme-ov-file">lilipod</a>
to create containers that are highly integrated with the host operating
system. Incidentally, Luca Di Maio, the creator of Distrobox and
lilipod, is also part of the <a href="https://vanillaos.org/team">Vanilla OS team</a> and one of its
co-founders.</p>

<p>Vanilla OS includes a graphical user interface for Apx, enabling
users to easily create a subsystem based on a <a href="https://docs.vanillaos.org/handbook/en/install-and-manage-applications#installing-applications-from-other-linux-distributions">stack</a> (Alpine, Arch
Linux, Fedora, openSUSE, Ubuntu, and Vanilla OS are supported by
default) and a package manager (apk, apt, dnf, pacman, or zypper). After
creating and starting the subsystem, the user can search its packages
and install them using commands in the VSO shell, such as:

</p><pre>    <tt>apx gecko search qucs</tt>
    <tt>apx gecko install qucs-s</tt>
</pre>

<p>Here <tt>gecko</tt> is the name I gave to the subsystem in this example, based on an openSUSE
container.</p>

<p>Applications installed this way are &#34;<a href="https://github.com/89luca89/distrobox/blob/main/docs/usage/distrobox-export.md">exported</a>&#34;,
which is a feature of
Distrobox. The application then appears in GNOME&#39;s activities overview.
When clicking on the icon, the subsystem&#39;s container is automatically
started, and the application launches. This provides an easy way to
install software available in specific distribution repositories.
Furthermore, the <tt>apx</tt> package management commands are
consistent, regardless of the underlying package manager, so users don&#39;t
need to remember the differences between apt, dnf, or zypper, for
example.</p>

<blockquote>
<a href="https://lwn.net/Articles/990072/">
<img src="https://static.lwn.net/images/2024/vanillaos-software-and-apx-sm.png" alt="[Vanilla OS 2 screenshot]" title="Vanilla OS 2 screenshot"/></a>
</blockquote>

<p>Apx offers a lot of flexibility. Users can add other package
managers, such as <a href="https://github.com/Jguer/yay#yay">yay</a>
instead of pacman for an Arch Linux subsystem. This involves mapping
each <tt>apx</tt> package management command to the corresponding
<tt>yay</tt> command. Similarly, users can create their own stack by
referencing an image from one of the well-known container repositories.
A stack can also have a list of pre-installed packages. This is useful
for setting up a complete <a href="https://docs.vanillaos.org/handbook/en/develop-in-vanilla-os">development stack</a> in a container.</p>

<h4>Development and documentation</h4>

<p>Development is happening in the <a href="https://github.com/Vanilla-OS">Vanilla OS GitHub organization</a>,
which has 24 members. Its <a href="https://github.com/orgs/Vanilla-OS/repositories">more than 100
repositories</a> include numerous container files and various custom
tools. Although many of these tools were specifically created for Vanilla
OS, the developers try to make them as distribution-independent as
possible. For instance, there are instructions for <a href="https://github.com/Vanilla-OS/apx?tab=readme-ov-file#instructions-for-using-apx-in-other-distributions">using
Apx in other distributions</a>.</p>

<p>There&#39;s no fixed release cadence, but the <a href="https://vanillaos.org/components-lifecycle">lifecycle</a> of
Vanilla OS is clear: when a major version is released, the previous
major release enters the maintenance state. This means that it only gets
important bug fixes and security fixes. After six months in the
maintenance state, the release is declared end of life. <a href="https://vanillaos.org/updates">Updates</a> are released at
irregular intervals with detailed descriptions of bug fixes and
enhancements. The project does not have a separate
security-announcement list.</p>

<p>The transition from Vanilla OS 1 to 2 was significant, not only due
to the shift from an Ubuntu base to Debian, but also because tools like
ABRoot, VSO, and Apx were completely rewritten. However, the Vanilla OS
documentation site still primarily covers <a href="https://docs.vanillaos.org/docs/en/abroot">ABRoot v1</a>, <a href="https://docs.vanillaos.org/docs/en/vso">VSO v1</a>, and <a href="https://docs.vanillaos.org/docs/en/apx">Apx v1</a>. While the man
pages seem to have been updated, information about the new features in
Vanilla OS 2 remains fragmented, scattered across the project&#39;s web
site, <a href="https://vanillaos.org/blog">blog</a>, and GitHub repositories.</p>

<p>Overall, Vanilla OS appears to be a good choice for advanced users
who need applications from multiple distributions without risking
system instability. Major applications can be easily installed as
Flatpaks, while others can be installed in subsystems from various
distributions. Thanks to the tight integration of the VSO and Apx
containers with the host operating system, users can seamlessly work
with all those applications without worrying about the underlying
differences. And when something goes wrong with one of the
applications, the core operating system isn&#39;t impacted and the VSO or
Apx container can simply be recreated.</p></div></div>
  </body>
</html>
