<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://yuanchuan.dev/dreamy-blur">Original</a>
    <h1>Dreamy Blur</h1>
    
    <div id="readability-page-1" class="page"><article>
  <p>
    One day I saw a few pictures shared
    by my friend <a href="https://twitter.com/uestcdq">Fish</a>.
    I was attracted by their slight blur and the subtle glowing effects, and wondered what kind of
    filter function was used. But then she told me it&#39;s just because the camera lens wasn&#39;t wiped clean.
  </p>
  <!--more-->

  <figure>
    <img alt="A river in Chengdu" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/dreamy.jpeg"/>
    <figcaption><span>Chengdu. By Fish</span></figcaption>
  </figure>

  <p>
    I really liked this effect, afterwards I tried to create it with CSS,
    mixing two identical images together with one of them blurred and semi-transparent.
  </p>

  <p>
    Now I look back and find two other ways to do so.
  </p>

  <h2>Original image</h2>

  <p>
    I&#39;ll use this photo in the examples below, which was taken in the park last April.
  </p>

  <figure>
    <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
    <figcaption><span>Cycling path in the park</span></figcaption>
  </figure>

  <h2>Blend mode</h2>

  <p>
    In fact, all those methods are based on the concept of <em>stacking multiple layers</em> like in Photoshop.
  </p><p>
    The first method I mentioned above was to use a blurred layer on top of the original image,
    and then merged them with <code><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode">mix-blend-mode</a></code>.
  </p>

  <figure>
    <picture>
      <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
      <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
    </picture>
    <figcaption><span>Using mix-blend-mode</span></figcaption>
  </figure>

<figure><pre><code data-lang="html"><span>&lt;picture&gt;</span>
  <span>&lt;img</span> <span>src=</span><span>&#34;url.png&#34;</span> <span>/&gt;</span>
  <span>&lt;img</span> <span>src=</span><span>&#34;url.png&#34;</span> <span>class=</span><span>&#34;blur&#34;</span> <span>/&gt;</span>
<span>&lt;/picture&gt;</span>

<span>&lt;style&gt;</span>
  <span>picture</span> <span>{</span>
    <span>position</span><span>:</span> <span>relative</span><span>;</span>
    <span>display</span><span>:</span> <span>block</span><span>;</span>
    <span>overflow</span><span>:</span> <span>hidden</span><span>;</span>
  <span>}</span>
  <span>picture</span> <span>.blur</span> <span>{</span>
    <span>position</span><span>:</span> <span>absolute</span><span>;</span>
    <span>inset</span><span>:</span> <span>0</span><span>;</span>
    <span>mix-blend-mode</span><span>:</span> <span>normal</span><span>;</span>
    <span>filter</span><span>:</span> <span>blur</span><span>(</span><span>3px</span><span>)</span> <span>opacity</span><span>(</span><span>.5</span><span>)</span> <span>brightness</span><span>(</span><span>1.3</span><span>);</span>
  <span>}</span>
<span>&lt;/style&gt;</span></code></pre></figure>
  <p>(I learned later from HN comments that the <code>mix-blend-mode</code> is not needed.)</p>


  <h2>Backdrop filter</h2>
  <p>
    The <code><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter">backdrop-filter</a></code>
    property is quite special, it&#39;ll use its underneath layer as the filter source if the background of itself is transparent.
    And it seems to be able to merge layers automatically. We could reduce one <code>img</code> tag with this approach.
  </p>

  <figure>
    <picture>
      <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
    </picture>
    <figcaption><span>Using backdrop-filter</span></figcaption>
  </figure>

<figure><pre><code data-lang="html"><span>&lt;picture&gt;</span>
  <span>&lt;img</span> <span>src=</span><span>&#34;url.png&#34;</span> <span>/&gt;</span>
<span>&lt;/picture&gt;</span>

<span>&lt;style&gt;</span>
  <span>picture</span> <span>{</span>
    <span>position</span><span>:</span> <span>relative</span><span>;</span>
    <span>display</span><span>:</span> <span>block</span><span>;</span>
  <span>}</span>
  <span>picture</span><span>::after</span> <span>{</span>
    <span>content</span><span>:</span> <span>&#39;&#39;</span><span>;</span>
    <span>position</span><span>:</span> <span>absolute</span><span>;</span>
    <span>inset</span><span>:</span> <span>0</span><span>;</span>
    <span>backdrop-filter</span><span>:</span> <span>blur</span><span>(</span><span>3px</span><span>)</span> <span>opacity</span><span>(</span><span>.5</span><span>)</span> <span>brightness</span><span>(</span><span>1.3</span><span>);</span>
  <span>}</span>
<span>&lt;/style&gt;</span></code></pre></figure>

  <h2>SVG filter</h2>
  <p>
    <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/filter">SVG filter</a>
    is hard to understand for most people. But once you&#39;ve learned how it works you&#39;ll see how straightforward it is.
  </p>

  <h3>Step 1</h3>
  <p>
    First we need to clone the source image and make it blurry with command <code>feGaussianBlur</code>.
  </p>

<figure><pre><code data-lang="html"><span>&lt;filter&gt;</span>
  <span>&lt;feGaussianBlur</span> <span>stdDeviation=</span><span>&#34;3&#34;</span> <span>/&gt;</span>
<span>&lt;/filter&gt;</span></code></pre></figure>

  <p>
    In SVG filter, each command will use the output of its previous command as input by default.
    The head command will use the element which it applies to as the source input.
    In this case, the original image.
  </p>

  <h3>Step 2</h3>
  <p>
    Continue to adjust the blurred result to make it semi-transparent and a little more bright.
    By achieving that we use command <code>feComponentTransfer</code> to modify its RGBA channel.
  </p>
<figure><pre><code data-lang="html"><span>&lt;filter&gt;</span>
  <span>&lt;feGaussianBlur</span> <span>stdDeviation=</span><span>&#34;3&#34;</span> <span>/&gt;</span>
  <span>&lt;feComponentTransfer&gt;</span>
    <span>&lt;feFuncR</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncG</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncB</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncA</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;.5&#34;</span> <span>/&gt;</span>
  <span>&lt;/feComponentTransfer&gt;</span>
<span>&lt;/filter&gt;</span></code></pre></figure>

  <h3>Step 3</h3>
  <p>
    In the end, merge the transformed result with the original image by using command <code>feBlend</code>.
  </p>

<figure><pre><code data-lang="html"><span>&lt;filter&gt;</span>
  <span>&lt;feGaussianBlur</span> <span>stdDeviation=</span><span>&#34;3&#34;</span> <span>/&gt;</span>
  <span>&lt;feComponentTransfer&gt;</span>
    <span>&lt;feFuncR</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncG</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncB</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncA</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;.5&#34;</span> <span>/&gt;</span>
  <span>&lt;/feComponentTransfer&gt;</span>
  <span>&lt;feBlend</span> <span>in2=</span><span>&#34;SourceGraphic&#34;</span> <span>/&gt;</span>
<span>&lt;/filter&gt;</span></code></pre></figure>

  <p>
    The <code>feBlend</code> command accepts two sources, <code>in2</code> and the omitted <code>in</code>.
    The original image is specified with <code>SourceGraphic</code>, while the <code>in</code> is passed by default
    with the result of its previous command. Of course, we may also give each result a name, which would be more readable.
  </p>

<figure><pre><code data-lang="html"><span>&lt;filter&gt;</span>
  <span>&lt;feGaussianBlur</span> <span>stdDeviation=</span><span>&#34;3&#34;</span> <span>result=</span><span>&#34;blur&#34;</span> <span>/&gt;</span>
  <span>&lt;feComponentTransfer</span> <span>in=</span><span>&#34;blur&#34;</span> <span>result=</span><span>&#34;transformed&#34;</span><span>&gt;</span>
    <span>&lt;feFuncR</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncG</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncB</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
    <span>&lt;feFuncA</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;.5&#34;</span> <span>/&gt;</span>
  <span>&lt;/feComponentTransfer&gt;</span>
  <span>&lt;feBlend</span> <span>in=</span><span>&#34;transformed&#34;</span> <span>in2=</span><span>&#34;SourceGraphic&#34;</span> <span>/&gt;</span>
<span>&lt;/filter&gt;</span></code></pre></figure>

  <p>
    So there is the final result.
  </p>

  <figure>
    <picture>
      <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
    </picture>
    <figcaption><span>Using SVG filter</span></figcaption>
  </figure>

<figure><pre><code data-lang="html"><span>&lt;img</span> <span>src=</span><span>&#34;url.png&#34;</span> <span>style=</span><span>&#34;filter: url(#dreamy-blur)&#34;</span><span>/&gt;</span>

<span>&lt;svg</span> <span>height=</span><span>&#34;0&#34;</span><span>&gt;</span>
  <span>&lt;filter</span> <span>id=</span><span>&#34;dreamy-blur&#34;</span><span>&gt;</span>
    <span>&lt;feGaussianBlur</span> <span>stdDeviation=</span><span>&#34;3&#34;</span> <span>/&gt;</span>
    <span>&lt;feComponentTransfer&gt;</span>
      <span>&lt;feFuncR</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
      <span>&lt;feFuncG</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
      <span>&lt;feFuncB</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;1.3&#34;</span> <span>/&gt;</span>
      <span>&lt;feFuncA</span> <span>type=</span><span>&#34;linear&#34;</span> <span>slope=</span><span>&#34;.5&#34;</span> <span>/&gt;</span>
    <span>&lt;/feComponentTransfer&gt;</span>
    <span>&lt;feBlend</span> <span>in2=</span><span>&#34;SourceGraphic&#34;</span> <span>/&gt;</span>
  <span>&lt;/filter&gt;</span>
<span>&lt;/svg&gt;</span></code></pre></figure>

  <h2>Applying the effect</h2>

  <p>
    The above methods are basically only one, but interpreted in different ways.
    The SVG filter is my favorite since it&#39;s most applicable.
  </p>
  <p>
    I&#39;ve used it once in one of my artwork.
  </p>

  <blockquote><p lang="qme" dir="ltr"><a href="https://twitter.com/hashtag/generative?src=hash&amp;ref_src=twsrc%5Etfw">#generative</a> <a href="https://twitter.com/hashtag/CSS?src=hash&amp;ref_src=twsrc%5Etfw">#CSS</a> <a href="https://twitter.com/hashtag/SVG?src=hash&amp;ref_src=twsrc%5Etfw">#SVG</a> <a href="https://t.co/aKEpsbqYKX">pic.twitter.com/aKEpsbqYKX</a></p>â€” yuanchuan (@yuanchuan23) <a href="https://twitter.com/yuanchuan23/status/1530032259234930689?ref_src=twsrc%5Etfw">May 27, 2022</a></blockquote> 

  

  <p>
    Some camera effects will emerge together with the <code>mask</code> property.
    And I think there are more use cases.
  </p>

  <figure>
    <picture>
      <img alt="Cycling path in the park" src="https://yuanchuan.dev/assets/images/post/dreamy-blur/trees.jpg"/>
    </picture>
    <figcaption><span>Together with mask</span></figcaption>
  </figure>

<figure><pre><code data-lang="css"><span>.with-mask</span><span>::after</span> <span>{</span>
  <span>backdrop-filter</span><span>:</span> <span>blur</span><span>(</span><span>5px</span><span>)</span> <span>brightness</span><span>(</span><span>1.3</span><span>);</span>
  <span>mask</span><span>:</span> <span>radial-gradient</span><span>(</span><span>circle</span> <span>at</span> <span>50%</span> <span>67%</span><span>,</span> <span>#0006</span><span>,</span> <span>#000</span> <span>50%</span><span>);</span>
<span>}</span></code></pre></figure>




</article></div>
  </body>
</html>
