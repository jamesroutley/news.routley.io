<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hachibu.net/posts/2023/2-ways-to-identify-email-leaks/">Original</a>
    <h1>2 Ways to Identify Email Leaks</h1>
    
    <div id="readability-page-1" class="page"><div><figure><img height="1200" width="1200" src="https://hachibu.net/posts/2023/2-ways-to-identify-email-leaks/images/featured_huc28301ed7b7aa5d6a2e81f074f23cc10_1056688_1200x0_resize_q75_h2_box_3.webp" alt="Illustration: Hachibu"/><figcaption><p>Illustration: Hachibu</p></figcaption></figure><h4 id="introduction">Introduction</h4><p>After reading <a href="https://www.ndtv.com/world-news/elon-musk-explains-how-tesla-caught-employee-leaking-data-3433802">this article</a> about Tesla using a clever algorithm to catch an employee leaking data, I thought it would be interesting to analyze their algorithm and see if I could design a better one.</p><h4 id="the-tesla-algorithm">The Tesla Algorithm</h4><p>According to <a href="https://twitter.com/elonmusk/status/1579101966453858305?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1579101966453858305%7Ctwgr%5E8e3c32bd71877812bc6533ee7e2c20be6b00c907%7Ctwcon%5Es1_&amp;ref_url=https%3A%2F%2Fwww.ndtv.com%2Fworld-news%2Felon-musk-explains-how-tesla-caught-employee-leaking-data-3433802">this Tweet by Elon Musk</a>, “We sent what appeared to be identical emails to all, but each was actually coded with either one or two spaces between sentences, forming a binary signature that identified the leaker.”</p><picture><img src="https://hachibu.net/posts/2023/2-ways-to-identify-email-leaks/images/tesla-algorithm-diagram_hue5f7d5a0133734e6bfb39bb445ce086c_132742_1200x0_resize_q75_h2_box_3.webp" height="367" width="1200" loading="lazy"/></picture><h5 id="pros">Pros</h5><ul><li>The algorithm is easy to understand, implement and validate.</li><li>The signature can be detected from a screenshot.</li><li>The number of unique signatures grows exponentially with the number of sentences. So, an email with 32 sentences can identify 2<sup>32</sup> or 4.29 billion email addresses—which is roughly every email address in existence according to <a href="https://financesonline.com/number-of-email-users">this estimate</a>.</li></ul><h5 id="cons">Cons</h5><ul><li>The signature is visible to the human eye making it easy to detect.</li><li>The mapping between email address and signature must be stored in a database and storing sensitive user information comes with additional storage costs, privacy and compliance considerations and security risks.</li></ul><h4 id="the-zero-width-hash-algorithm">The Zero-Width Hash Algorithm</h4><ol><li>Using <a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a>, cryptographically hash the email address with a secret key to generate a unique signature.</li><li>Using the zero-width encoding scheme described below, encode the signature into invisible text.</li><li>Finally, embed the invisible signature into an email message.</li></ol><picture><img src="https://hachibu.net/posts/2023/2-ways-to-identify-email-leaks/images/zero-width-hash-algorithm-diagram_hu4d7864817ba98a41840dd2efa5758aee_109492_1200x0_resize_q75_h2_box_3.webp" height="687" width="1200" loading="lazy"/></picture><h5 id="what-is-zero-width-encoding">What is zero-width encoding?</h5><p>Zero-width encoding is a bespoke text-to-invisible-text encoding scheme that encodes text in binary using the invisible characters zero-width space, zero-width non-joiner and zero-width joiner to represent 0, 1 and the end of each byte respectively. The reference implementation is freely available on GitHub <a href="https://github.com/hachibu/zero-width-encoding">here</a>.</p><picture><img src="https://hachibu.net/posts/2023/2-ways-to-identify-email-leaks/images/zero-width-encoding-diagram_hub9f31180708984267deee58fa1bfc5df_95635_1200x0_resize_q75_h2_box_3.webp" height="1122" width="1200" loading="lazy"/></picture><h5 id="pros-1">Pros</h5><ul><li>The signature is invisible to the human eye.</li><li>The number of unique signatures is a function of the underlying cryptographic hash function. For example, with SHA-256 we can identify up to 10<sup>77</sup> email addresses—which is close to the <a href="https://en.wikipedia.org/wiki/Observable_universe#Matter_content%E2%80%94number_of_atoms">total number of atoms in the known universe</a>.</li><li>With HMAC, we don’t need to store the mapping between email address and signature thus eliminating the costs and risks associated with storing sensitive user information.</li></ul><h5 id="cons-1">Cons</h5><ul><li>The algorithm is hard to understand, implement and validate.</li><li>The signature cannot be detected from a screenshot.</li></ul><h4 id="conclusion">Conclusion</h4><p>After considering the pros and cons of each algorithm, I would choose the Tesla algorithm for its simple design and because it has more than enough capacity to uniquly identify every email address currently in existence—which is a number far greater than any single company will ever employ.</p></div></div>
  </body>
</html>
