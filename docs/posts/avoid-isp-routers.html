<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://routersecurity.org/ISProuters.php">Original</a>
    <h1>Avoid ISP Routers</h1>
    
    <div id="readability-page-1" class="page"><div>  

<p>In my opinion, you are <b>safest</b> using <i>both</i> a modem and a router that <i>you purchased</i> on your own. That is, <b>avoid  
  equipment from your ISP</b>. I say this for a number of reasons:   </p><ul>
  
<li> The devices shipped by ISPs suffer from a general level of incompetence both in their initial configuration and ongoing maintenance. 
	  If nothing else, just the fact that an ISP would install a device with the default password, tells you everything you need to know about 
	  their  interest in your security.</li>
<li>Security and convenience are always at odds with each other. Most likely an ISP will configure a router for maximum convenience to cut down on tech support calls, which cost them money. </li>
<li>Spying: We have seen that ISPs, at times, co-operate with spy agencies and governments. Even without outside influence, an ISP may well put a 
	        backdoor in the devices they give to their customers, if for no other reason than to make their life easier in some way. In this article, <a href="https://harrisonsand.com/your-isp-is-spying-on-you/">Your ISP is Probably Spying On You</a> (Feb. 2018) Harrison Sand found his router 
			was collecting information about LAN side devices and sending it the ISP.</li>		
<li>Don&#39;t be a prime target. Any router provided by an ISP to millions of customers is a prime target for bad guys and spies. More 
	     bang for the hacking buck. You are safer using a less popular device.</li>

		 <li>Many ISPs want to implement public WiFi networks in your home and there is no reason to assume these are done securely.  For my 
	    take on Comcast see <a href="http://www.computerworld.com/article/2476444/mobile-security/comcast-xfinity-wifi--just-say-no.html">Comcast XFINITY WiFi: 
		  Just say no</a>.    Cablevision is <a href="https://www.techdirt.com/articles/20150721/10254131714/cablevision-follows-comcast-down-compulsory-wifi-hotspot-rabbit-hole.shtml">doing
		   the same thing</a>, which prompted Timothy Geigner to write: &#34;This sort of news should serve to do nothing other than compel anyone who wishes
		   to remain a Cablevision customer to buy their own router and modem&#34;. See also <a href="http://betanews.com/2016/01/27/one-in-three-home-routers-will-double-as-a-public-hotspot-by-2017/">One in three home routers will double as a public
		   hotspot by 2017</a>.  According to <a href="https://www.juniperresearch.com/press/press-releases/1-in-3-home-wi-fi-routers-to-double-as-public-hots">Juniper  Research</a> the term for this is a &#34;homespot router&#34;.</li>		   
<li>Sometimes equipment from an ISP is locked down. I have heard of cases where customers could not change a password  and where the DNS servers could not be 	 changed. I am told that in England, BT Business Hub and Sky Broadband prevent you from modifying the DNS servers and that much of France is also prevented from changing them. I ran into a Comcast-provided Arris TG1682G gateway where I could not <a href="http://m.setuprouter.com/router/arris/tg1682g/ip-address.htm">change the LAN IP address</a> of the box. I could change the subnet, but the router was always device number one which makes it a sitting duck for assorted router attacks.</li>	  
	<li>The ability to update the firmware may also be locked down. You should have full control over firmware updates.</li>	 
	<li>Backup: an ISP will give one device. Should it fail at an inopportune time, you will be off-line until you get them to issue a replacement. When you own your own 
	      hardware, you can buy a second modem and/or a router for emergency backup.</li> 
	<li>It may well be cheaper in the long run to buy your own hardware</li></ul>  

<p>As to the last point,  some ISPs charge a rental fee for the box they provide, be it just a modem or a full fledged gateway.  
     Buying your own will pay for itself soon enough. Time Warner customers looking to buy their own modem can purchase one from <a href="http://www.timewarnercable.com/en/support/internet/topics/buy-your-modem.html">this list</a> or <a href="http://www.timewarnercable.com/en/enjoy/better-twc/internet/internet-modems.html">this one</a>. Comcast users should 
   review <a href="http://mydeviceinfo.comcast.net">mydeviceinfo.comcast.net</a>. </p> 
   
<p>October 11, 2024: My opinion is that of someone in the US and thus it may only be valid in the US. As a country, we are trending to very big companies in many different areas.  Internet Service Providers are part of this trend. Many (very likely most) people in the US are served by a single ISP. Different areas of the US have virtual monopolies when it comes to high speed Internet access. An ISP with a virtual monopoly has no motivation to do a good job. Their customers are captives. Their only goal is making money, so it is to be expected that they would provide the cheapest hardware that does the job. And, since added security will always result in more tech support calls, and these calls cost the ISP money, it is reasonable to expect that security is not a priority. If you live in a country with real competition for high speed Internet access, things might be better. </p> 
   
<p>In June 2022, on a financial Forum, someone asked <a href="https://www.bogleheads.org/forum/viewtopic.php?p=6722588">Which is the best (most secure) home internet router for the money?</a>. One response hit home: 
 <i>&#34;I&#39;ve been on the vendor side selling networking equipment to carriers and cable companies. Their priorities for customer premises equipment (consumer) are cost, remote management and cost. Not to say their routers are bad, but you can do better.&#34;</i> To re-phrase that, ISPs want cheap routers that they can control.</p> 
 
   
<h3>ISPs SCREWING UP</h3>

<p>May 2, 2023: This is not about security, but it does show how little Spectrum cares about the boxes they give out to customers</p>  

 <p>In November 2021, we learned of a DNS rebinding flaw in <a href="https://www.bbc.com/news/technology-59332840">six million</a> Sky routers (they are a large ISP in the U.K.). Adding insult to injury, Sky took 18 months to fix the problem and often ignored the company that found and reported the flaw, Pen Test Partners. See <a href="https://www.pentestpartners.com/security-blog/skyfail-6-million-routers-left-exposed/">SkyFail. 6 million routers left exposed</a>. </p> 
 
<p>In September 2021 we learned that  Virgin Media failed to fix a reported flaw in their routers for over two years. See: <a href="https://www.pcmag.com/news/virgin-media-routers-left-vpn-users-vulnerable-since-at-least-2019">Virgin Media Routers Left VPN Users Vulnerable Since at Least 2019</a> by   Nathaniel Mott for PC Magazine. </p>
	
<p>A privacy issue with IP Version 6 (IPv6) was disclosed at a <a href="https://www.blackhat.com/us-21/briefings/schedule/#ipvseeyou-exploiting-leaked-identifiers-in-ipv-for-street-level-geolocation-22889">BlackHat presentation</a> in August 2021. It is not a flaw in IPv6, instead it is lazy, stupid, ignorant choices made by assorted ISPs that continue to include a MAC address as part of the public IPv6 address. We have known for 20 years that this is a bad idea. Yet, ISPs continue to do it. For the details see <a href="https://www.tomsguide.com/news/home-gateway-geolocation-bh21">Your Wi-Fi router could tell everyone where you live - here&#39;s what you can do about it</a> by Paul Wagenseil of Toms Guide. Researchers found over 12 million routers/gateways that included a MAC address (which should be private) in the public IPv6 address. In the US they found more than 1 million Comcast Xfinity gateway routers with this design flaw. </p>
 
<p>  In May 2019, British ISP Sky Broadband updated their broadband hubs and knocked some customers off-line. Specifically, if the customer had configured the device to use DNS servers not from Sky Broadband. It seems the latest update also removed the ability to change DNS servers altogether. See <a href="https://www.theregister.co.uk/2019/04/29/sky_bricks_broadband_hubs/">Sky customers moan: Our broadband hubs are bricking it</a> and read the many comments.</p>

<p>In December 2018, <a href="https://www.tenable.com/security/research/tra-2019-17">Tenable found three bugs</a> in a Verizon FIOS router/gateway. Reading the Disclosure Timeline tells you all you need to know - not to use hardware provided by Verizon. For one thing, Verizon did not write the firmware, so they have to farm out the bug fix. Then, two bugs are dealt with by one group, while the third bug is dealt with by another group. Two bugs were already known but had not been fixed. Verizon&#39;s response was slow and bureaucratic and they have no plans to say anything publicly about the bugs.</p>
 
<p>In May 2018, we learned that <a href="https://www.zdnet.com/article/comcast-bug-leaks-xfinity-home-addresses-wireless-passwords/">Comcast website bug leaks Xfinity customer data</a>. The Comcast website (register.be.xfinity.com/activate), which was/is used by customers to set up their home services, could be hacked to display a customers home address, Wi-Fi network name and Wi-Fi password. And, not just display, an attacker could also change the SSID and/or Wi-Fi password. But, the issue was only for customers using equipment from Comcast. Those with their own routers were safe. An attacker only need to provide the  customer account number and their house or apartment number. If you lived at 123 Main Street, all the attacker needed to know was 123. Comcast claimed they fixed the problem, but we have no idea how long this vulnerability has existed.</p> 

<p>Then, in June 2018, we learned of <a href="https://www.zdnet.com/article/comcast-fixes-another-xfinity-website-data-leak/">another data leak by Comcast</a>. Any device on the network of a Comcast customer, could call an API and learn the account number, the customer&#39;s home address, the account type, and any services enabled on the line. </p>

<p><a href="https://motherboard.vice.com/en_us/article/mbkgn8/dont-rent-a-modem-from-comcast">For the Love of God, Stop Renting Routers From Comcast</a> by 
Karl Bode May 24 2018. On the one hand, this article brings up many different and valid points, both financial and technical. On the other hand, the author seems clueless about the difference between a router a modem and a gateway.</p>

<p>Talk Talk is a British ISP and telco. In May 2018, their routers were <a href="https://www.indigofuzz.com/article.php?docid=talktalk1430">confirmed vulnerable</a>    to the classic WPS pin code attack, first seen back in 2011. You can&#39;t make this stuff up. The flaw was discovered by a company called IndigoFuzz using a Windows program called Dumpper.</p>


<p>Another British ISP, EE, distributes gateways (combination modem and router) with a backdoor account. This came to light in October 2018, see  <a href="https://www.theregister.co.uk/2018/10/26/ee_4gee_hh70_ssh_backdoor/">this article</a> from The Register. The backdoor account in their 4GEE HH70 gateways was accessible via SSH from the LAN (inside) side of the router. Worse, when the problem was reported to EE they blew it off, until The Register got involved. Even after the bad publicity, it was still not clear whether a patch had been rolled out or not. Eventually, The Register learned that EE had issued a patch, but customers have to install the new firmware themselves.</p> 
   
<p>In November 2017, a <a href="https://arstechnica.com/information-technology/2017/11/internet-paralyzing-mirai-botnet-comes-roaring-back-with-new-strain/">new botnet was discovered</a> that abused flaws in ZyXEL devices. Bad guys could remotely login to the routers/gateways using a default userid/password because a port was left open. In addition, the devices also had a hard coded superuser password, which gave attackers root privileges. Roughly 100,000 infected devices were detected, almost all of them in Argentina, specifically in the network of Telefonica de Argentina. Obviously, the ISP is at fault for giving so many of their customers devices with the same passwords.</p> 

<p>In September 2017, ESET reported that some ISPs (in two countries they refused to name) appear to be co-operating in the distribution of spyware. 
 <a href="https://www.welivesecurity.com/2017/09/21/new-finfisher-surveillance-campaigns/">New FinFisher surveillance campaigns: Internet providers involved?</a> by Filip Kafka Sept. 21,  2017. Quoting: <i>&#34;New surveillance campaigns utilizing FinFisher, infamous spyware known also as FinSpy and sold to governments and their agencies worldwide, are in the wild ... some of these variants have been using a cunning, previously-unseen infection vector with strong indicators of major internet service provider (ISP) involvement ...  FinFisher is marketed as a law enforcement tool and is believed to have been used also by oppressive regimes ... What’s new ... in terms of distribution is the attackers&#39; use of a man-in-the-middle attack with the &#34;man&#34; in the middle most likely operating at the ISP level ... When the ...  target of surveillance is about to download one of several popular (and legitimate) applications, they are redirected to a version of that application infected with FinFisher. The applications we have seen being misused to spread FinFisher are WhatsApp, Skype, Avast, WinRAR, VLC Player and some others ...  the legitimate download link [is] being replaced by a malicious one ... &#34;</i></p>
   
<p><img src="https://routersecurity.org/pix/isp.box.hacking.sm.jpg"/>At the DEF CON 25 conference in the summer of 2017  Marc Newlin, Logan Lamb and Chris Grayson spoke about <a href="https://www.youtube.com/watch?v=LxfsT4wLAfU">Wirelessly Tapping Home Networks</a>. They found 26 bugs in ISP provided hardware, both gateways and set-top boxes. Bugs were found in devices from Cisco, Arris, Technicolor, Motorola and Xfinity.  They found multiple un-authenticated remote code execution flaws, the worst of all possible bugs. Software maintenance of the devices was also poor: patches take months to deploy, official bug reports are not filed and, of course, customers (victims?) are told nothing about the problems.<br clear="all"/></p>

<p>&#34;Securing home routers is not an easy task and may require some technical knowledge. A good start is properly selecting a home router - this means avoiding free routers included in internet plans... &#34; from <a href="https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-securing-your-home-routers.pdf">Securing 
  Your Home Routers</a> by Trend Micro sometime in 2017.</p>   
   
 <p>In December 2016, Scott Helme wrote <a href="https://scotthelme.co.uk/my-ubiquiti-home-network/">My Ubiquiti Home Network</a> about upgrading from consumer routers to Ubiquiti. But, he lead with his thoughts about ISP provided equipment. </p>
 <p> <i>&#34;I&#39;ve never used the equipment provided by my ISP and have always used my own ... I&#39;ve always been a bit of a tech geek and I like having things with extra features ... but there are some other more genuine needs. ISP (Internet Service Provider) provided equipment usually has one main factor driving the choice of hardware, <b>cost</b>. They want it to be as cheap as possible because purchasing the device and giving it to you is eating into their profits ... low cost usually means low quality in other areas than hardware too, like security. My previous ISP, EE, sent me a BrightBox router when I signed up that [had] several <a href="https://scotthelme.co.uk/ee-brightbox-router-hacked/">serious security vulnerabilities</a> ... Following their (very late) patching efforts there were <a href="https://scotthelme.co.uk/ee-brightbox-router-patched-still-vulnerable/">yet more vulnerabilities</a>. 
 I could go on and on listing the issues with ISP kit, a story even popped up on The Register about 1 million German routers being compromised whilst writing this blog, but I think you get the idea. This isn&#39;t to say other hardware will be perfect, of course it won&#39;t be, but I&#39;d seen enough and wanted rid.&#34;</i></p> 
   
<p>In Australia in <b>October 2016</b> an ISP gave out <a href="http://www.theregister.co.uk/2016/10/27/good_luck_securing_things_when_users_assume_stuff_just_works/">routers with default userid/passwords</a>  and &#34;remarkably similar SSIDs.&#34; The article argues that: &#34;It isn&#39;t terribly difficult to load up factory firmware that generates a random password, assigns it to a device, then prints a label with that information to go into the box with the gadget. It&#39;s more work than just slapping a default username and password into the software - but not much. And the cost, amortised against tens of thousands of units, can&#39;t be more than a penny or two.&#34;</p>  
 
 <p>Lucian Constantin, of IDG News Service, has been covering routers for Computerworld, PC World and others for a few years. On June 2, 2015, <a href="http://www.itworld.com/article/2930295/security/new-soho-router-security-audit-uncovers-over-60-flaws-in-22-models.html">writing in ITworld</a>,  about a bunch of router flaws he said:</p>
<p> <i>&#34;Past research has shown that the security of ISP-provided routers is often worse than that  of off-the-shelf  ones. Many such devices are configured for remote administration to allow ISPs to remotely update their settings or troubleshoot connection problems.  This exposes the routers&#39; management interfaces along with any vulnerabilities in them to the Internet, increasing the risk of exploitation. Even though  ISPs have the ability to remotely update the firmware on the routers they distribute to customers, they often don&#39;t and in some cases the users can&#39;t  do it either because they only have restricted access on the devices.&#34;</i></p> 

<p>In Nov. 2015 Bernardo Rodrigues wrote <a href="https://w00tsec.blogspot.com.au/2015/11/arris-cable-modem-has-backdoor-in.html">ARRIS Cable Modem has a Backdoor in the Backdoor</a>. The buggy devices are the Arris TG862A, TG860A, and DG860A. To be clear, these are not modems, they are gateways (combination modem and router). They suffer from XSS and CSRF vulnerabilities, hard-coded passwords, and a backdoor in a backdoor.  The backdoor can be used to enable Telnet and SSH remotely via a hidden HTTP interface or with custom SNMP MIBs. Estimates are that more than 600,000 externally accessible devices are vulnerable. Initially, Arris blew this off. Eventually CERT/CC was able to get their attention. For more, see the <a href="https://routersecurity.org/bugs.php">Router Bugs</a> page under November 2015.</p>  
 
<p>Verizon was giving new customers routers configured to use WEP years and years and years after WEP was known to be insecure. It&#39;s nice to be a monopoly. In November 2014 the FTC <a href="https://www.ftc.gov/system/files/documents/closing_letters/verizon-communications-inc./141112verizonclosingletter.pdf">wrote a letter</a> to a Verizon rep saying &#34;<i>... the Division of Privacy and Identity Protection has conducted an investigation into possible violations of Section 5 of the Federal Trade Commission Act by ...   Verizon Communications.  The investigation considered whether Verizon engaged in unfair or deceptive acts or practices by failing to secure, in a reasonable and appropriate manner, the routers it provided to its High Speed Internet (DSL) and FiOS customers ...  Verizon regularly shipped routers to consumers with the default security set to an outdated encryption standard known as WEP. Due to certain weaknesses in WEP, the IEEE deprecated this standard in 2004 in favor of a new
standard known as WPA and later, WPA2. However, until recently, Verizon continued to ship some router models with the WEP encryption standard. As a result, many Verizon customers ... [are] vulnerable to hackers.</i>&#34; Writing the letter was all the FTC did.  Clearly you can&#39;t trust Verizon with your router security.</p>

 
<h3>TR-069</h3>

<p>Another big security issue involves remote configuration of the router/modem provided by an ISP. Assorted mechanisms used by ISPs to update their devices in your home or office have been abused by bad guys to hack the devices. One remote update mechanism is a protocol with two names: TR-069 and CWMP. More than once, bugs in this protocol have been abused. </p>

<p>In November 2016, about 900,000 customers of Deutsche Telekom were knocked off-line by router problems. <a href="http://www.computerworld.com/article/3145003/internet/blame-the-isps-rather-than-the-routers.html">My blog on this attack</a>, which started with a new variant of the Mirai malware, detailed the mistakes ISPs made to get to the point where Mirai could cause so much damage. They left an open TCP/IP port undefended, and then quickly blocked it once the s..t hit the fan. Some ISP-supplied routers were running a TR-064 server that was open to the public, a huge configuration mistake. And, some routers locked up when the had to deal with the many incoming connection attempts created by the malware.</p> 
 
<p>Another example of TR-069 incompetence came to light in April 2017. <a href="https://www.wordfence.com/blog/2017/04/check-your-router/">Wordfence wrote</a> that &#34;Your ISP should not allow someone from the public internet to connect to your router&#39;s port 7547.&#34; Well, duh. They wrote that Shoden reports over 41 million home routers with port 7547 open to the public internet. They also found over 10,000 infected home routers in Algeria and over 11,000 hacked home routers in India that they attribute to port 7547 being open.</p> 
   
<p>TR-069 was also abused in 2014. A story, by Lucian Constantin back in August  2014 is frightening. See <a href="http://www.computerworld.com/article/2491042/malware-vulnerabilities/home-routers-supplied-by-isps-can-be-compromised-en-masse.html">Home routers supplied by ISPs can be compromised en masse</a>. As of 2011, there are 147 million TR-069-enabled devices online listening on TCP port 7547.  These devices communicate with Auto Configuration Servers (ACS) operated by ISPs for assorted network management tasks. Many times a router can not close the port. If an attacker hacks into an ACS server then lots of bad stuff can happen. According to Shahar Tal, a security researcher at Check Point Software, ACS servers can be easily taken over by bad guys. The TR-069 specification recommends the use of HTTPS  but he found that insecure HTTP is used about 80 percent of the time, opening routers up to man-in-the-middle attacks. TR-069 requires authentication from the device to the ACS, but the username and password is typically shared and easily extracted. Check Point also tested several ACS servers and found critical remote code execution vulnerabilities in them. </p> 
  
<p>Open ports on ISP provided hardware are not limited to the TR-069 protocol. In September 2017, security firm Nomotion blogged about AT&amp;T U-Verse gateway devices with two open ports. One was for SSH, the other (TCP port 49152) allowed WAN side attackers to bypass the firewall. This was in addition to three hard coded backdoor accounts they discovered. The blog has a great title: <a href="https://www.nomotion.net/blog/sharknatto/">SharknAT&amp;To</a>. Adding insult to injury, was the reaction from AT&amp;T. Despite being publicly shamed, they said nothing about these security problems for two weeks (as of Sept 13, 2017). They have no shame and are doing their best to keep their customers ignorant of this. Arris, said they are looking into it and then went silent. For more see the <a href="https://routersecurity.org/bugs.php">Router Bugs</a> page under September 2017.</p>   

<p>HD Moore, chief security architect at Rapid7, and the creator of Metasploit, also <a href="http://www.darkreading.com/vulnerabilities---threats/no-end-in-sight-for-exposed-internet-of-things-other-devices/d/d-id/1320913">weighed  in on this</a>  on June 17, 2015. Rapid7 runs  Project Sonar, which scans the Internet for vulnerable devices. They find that things are getting worse.   On reason, cited by Moore is   <i>&#34;that a few dozen Internet service providers are rolling out broadband devices such as home routers without  properly vetting or properly configuring the security...&#34;</i></p>
  
  <p> ------------------ </p>

<p>Besides security, there is the issue of <b>honesty</b>. Time Warner Cable, a.k.a Spectrum and Charter was <a href="https://ag.ny.gov/sites/default/files/summons_and_complaint.pdf">sued in New York State</a> in early 2017 for lying about the download speeds their customers were getting. In <a href="https://backchannel.com/the-alternate-facts-of-cable-companies-f0cd1e10e66">The Alternate Facts of Cable Companies</a> Harvard professor Susan Crawford writes:</p>
<p><i>&#34;Based on the company&#39;s own documents and statements, it appears that just about everything it has been saying since 2012 to New York State residents about their internet access and data services is untrue. And not untrue in some grey, shadowy way - just untrue. The company&#39;s 2.5 million New York subscribers (of its 22 million nationwide) have been told they are getting X (in terms of download and upload speeds) when actually they are getting a lot less than X.&#34;</i></p>
<p>How was Charter/Spectrum/Time Warner Cable cheating? Three ways: <i>&#34; ... squeezing more households into an inadequate number of narrow, shared neighborhood data connections; squeezing connections between Spectrum&#39;s network and other networks; and squeezing consumers who should have gotten upgraded household equipment.&#34;</i></p><p> 

The lawsuit was settled in December 2018 with Charter/Spectrum coughing up $176 Million. In an <a href="https://www.techdirt.com/articles/20181218/07445741254/nys-record-176-million-settlement-with-charter-crap-broadband-highlights-cables-growing-monopoly.shtml">article about this</a>, Karl Bode, of Techdirt wrote: <i>&#34;The suit also highlights how Charter at least considered gaming the results of a program the FCC has traditionally used to measure real-world broadband speeds using custom-firmware embedded routers in consumer volunteer homes.&#34;</i>. 


</p><p>In the U.S., high speed broadband is <a href="https://www.techdirt.com/articles/20180314/09251639423/cable-industry-is-quietly-securing-massive-monopoly-over-american-broadband.shtml">pretty much a monopoly</a> everywhere. An ISP without competition has no motivation to do a good job, they are only motivated by profit. Yet another reason not to use their hardware, when possible.</p>

<p>One advantage of the new consumer focused mesh routers,  like eero, AmpliFi and Google Wifi, is that the routers themselves can run speed tests. Eero seems to do one every day. AmpliFi and Google Wifi keep a history of the speed tests, so trends are easily spotted. Eero does not keep a history. </p>
   
<p>Finally, there is a big difference between routers so don&#39;t expect to buy the perfect router for your needs right out of the box. If possible, buy a 
  router from a place that will take it back.</p>
   
</div></div>
  </body>
</html>
