<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ntietz.com/blog/that-time-i-wrote-malware/">Original</a>
    <h1>That time I wrote malware and got caught</h1>
    
    <div id="readability-page-1" class="page"><div><p>Most of us make some bad decisions in high school.
While other people were drinking, going to parties, and who knows what else, I was doing some experimentation of my own.
I was writing my first (and only) piece of malware.</p>
<hr/>
<p>From as early as I can remember, I&#39;ve had a fascination with security.
In games, I would play rogues and try to pickpocket people or pick open locks.
This came from two inner drives.</p>
<p>The first one is the obvious one: getting access to things you&#39;re not supposed to.
I was a curious kid
 and wanted to know everything.
Nothing seemed like it should not be my business.
So playing as a character who could get into any room was just my cup of tea: unfettered access to know what was going on.</p>
<p>The second one was less obvious and took me a while to realize in myself: a deep desire to know how things work.
More precisely, a deep desire to <em>figure out</em> how things work.
If I read a book about something, that&#39;s fun and I learn something.
But if I poke at a system enough to figure out how it works and why it works that way, that&#39;s deeply satisfying and such a <em>thrill</em>.</p>
<hr/>
<p>Our high school had computers in most classrooms, and we had a few computer labs
.
Like is common with computer labs, these required logging in with your school credentials
.
Once you logged in, you had access to your personal drive (mounted at <code>P:\\</code>, I assume for &#34;personal&#34;) as well as a few shared drives.
Students could read files on some of these drives, and could read and write to one of them.
Is this foreshadowing? Is it ever.</p>
<p>Another thing that our computers had was <del>spyware</del> &#34;monitoring software&#34; so that the lab supervisor could see what we were doing.
On the one hand, high school students do many unwise things so this is probably a reasonable practice.
But on the other hand, it inures people to being spied on, and it definitely didn&#39;t prevent me from doing naughty things, soooo... it wasn&#39;t very effective.
To prevent us from killing the process that monitored us, we had no access to Task Manager.</p>
<p>My junior year, I was in a programming class, and we used .NET languages (VB.NET and C#) in our classes.
Since we were using Visual Studio, we had access to a fun drag-and-drop builder, and we also had hooks into Windows APIs to do convenient things.
You could capture keystrokes, like Ctrl-C for copy if you want to do something different with it.</p>
<p>Naturally, I wanted to explore the limts of these APIs.
What would it let me capture, and what would it not?
Unfortunately, they let me capture almost everything.
From here, I created my malware: Fluffy, Destroyer of Worlds.</p>
<hr/>
<p>Fluffy was a simple program.
When you ran it, it would expand itself to full screen and display a picture of a kitten jumping through a field, labeled with &#34;Fluffy, Destroyer of Worlds&#34;—in Comic Sans, of course.
Below that was a loading bar which started out quick but would slow down exponentially, so you would get to 90% quickly but then would never get to 100%.</p>
<p>Users would sit there and wait expectantly for this program that Nicole wrote to do something cool, presumably.
But eventually they&#39;d pick up on the gag, maybe because I was giggling.
So they would try to close it.
But I was able to capture Alt-Tab and prevent the user from changing windows.
And I was able to capture Ctrl-Q and Alt-F4 and prevent the user from closing the program.
I was <em>not</em> able to capture Ctrl-Alt-Delete.. but that took you to a login screen that only had options to resume, log out, or restart the computer (no admin controls could even override this, shocking to me to this day).</p>
<p>They had no choice but to log out or restart, which would make them lose any work they had open.</p>
<hr/>
<p>Like any good hacker, I developed my malware in my parents&#39; basement.
And like any good hacker, I tested it on my friend first.
Shoutout to Andrew for running something I sent him without really questioning it.
He got off easy because his home computer did <em>not</em> have Ctrl-Alt-Delete blocked.
We tried to transfer it to him by AIM or email, but .exe files were blocked, so naturally we transferred it by pretending it was a .zip file.</p>
<p>Once Andrew had confirmed that it did work as expected, I carried Fluffy, Destroyer of Worlds to school with me on a flash drive.
Our computers didn&#39;t prevent running arbitrary executables, so I was able to just copy it onto my personal drive and run it.
But it was more fun if someone else ran it, so I put it on that shared drive.
(It returned!)</p>
<p>Then I told my friends to run it.
They thought it was funny.
I had my Latin teacher run it, and she lost half a period of notes; I felt slightly bad about that.
My English teacher ran it, and he thought it was <em>hilarious</em> even though he lost notes too.
I thought that was the end of it, I&#39;d had my fun.</p>
<hr/>
<p>The next day my programming teacher asked me about the program.
Apparently, some other people had run it, because they found it on the shared drive.
And some of them had our librarian run it, and hoo boy she did <em>not</em> find it funny in the slightest.
She wanted me to immediately lose all computer privileges which, honestly, fair.</p>
<p>My programming teacher went to bat for me, and struck a deal with IT to keep my computer privileges
.
The deal was that I had to get rid of the program and monitor for it coming back, and make sure (as far as I could) no one else was affected by it.
I deleted that copy from the shared drive but people <em>kept putting it back</em>.
Why???
So I kept deleting it over and over, until the novelty wore off and we all forgot about it.</p>
<p>Side note, can we just say how shocking it is that everyone ran a random executable?
That we just ran things we found?
Security understanding sure has changed over the last two decades.</p>
<p>High school was a weird time.</p>
<hr/>
<p>By writing some very unsophisticated malware, I learned quite a bit.</p>
<p>I was able to explore the bounds of a system and what it was able to do.
But more importantly, I learned that writing malware wasn&#39;t harmless and could hurt other people and could also put my own activities at risk.
It scared me out of doing any sort of security work for a while.</p>
<p>It taught me how much privilege I had.
What I did was not legal and violated school rules, and some people may have had the book thrown at them.
Instead, I had a teacher and mentor go to bat for me and ensure I could keep on learning.</p>
<p>It also taught me about the boundaries of systems, and the ways that security features can be abused.
The ways that the systems we put in place can be exploited.
Exploring systems, boundaries, what you can and cannot do—such a great way to learn.
Just, do it with consent.</p>
</div><p>
    If this post was enjoyable or useful for you, <strong>please share it!</strong>
    If you have comments, questions, or feedback, you can email <a href="mailto:me@ntietz.com">my personal email</a>.
    To get new posts, subscribe to the <a href="https://www.tortoisemedia.com/newsletter">newsletter</a> or use the <a href="https://www.tortoisemedia.com/atom.xml">RSS feed</a>.
  </p></div>
  </body>
</html>
