<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://paraxial.io/blog/still-safe">Original</a>
    <h1>Elixir is still safe</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><img src="https://archive.ph/cheetah.jpeg" width="700"/></p>
<p>
In March 2021 Nathan Long published <a href="https://dockyard.com/blog/2021/03/30/elixir-is-safe">Elixir is Safe</a>, a post about the security benefits of using Elixir, which focused on memory and thread safety. It is an excellent article for programmers and executives about the security benefits of Elixir. In July 2023 I googled “Elixir is Safe”, and the first result was a snippet from the paper, “Vision for a Secure Elixir Ecosystem: An Empirical Study of Vulnerabilities in Elixir Programs”, which was <a href="https://dl.acm.org/doi/10.1145/3476883.3520204">published by the ACM in April 2022.</a></p>
<p><img src="https://archive.ph/google.png" width="550"/></p><p>
Several of the paper’s authors are students, and this post is not meant to criticize them as researchers. The paper is written as a reaction to Nathan’s article, which accurately describes the security benefits of Elixir. The paper’s claims are misleading, and the fact that it currently ranks above the original article on Google, and was published in a reputable journal, warrants a response.</p>
<p>
<em>“Practitioners perceive Elixir to be a ‘safe’ language, as the language allows practitioners to write fast software programs without introducing vulnerabilities, unlike other languages, such as C[16]. Positive perception of practitioners about the safety and security Elixir programs is subject to empirical validation. Practitioner perceptions are formed through personal experience, and not based on empirical evidence [9]. A systematic empirical investigation that quantifies reported security vulnerabilities can shed light on the state of security of Elixir programs. Such empirical investigation can also yield recommendations for practitioners and researchers on how to securely develop Elixir programs.”</em></p>
<p>
<em>[16] Nathan Long. 2021. Elixir is Safe. <a href="https://dockyard.com/blog/2021/03/30/elixir-is-safe">https://dockyard.com/blog/2021/03/30/elixir-is-safe</a></em></p>
<p>
Nobody thinks Elixir “allows practitioners to write fast software programs without introducing vulnerabilities”. The article “Elixir is Safe” never makes that claim, rather it mentions that Elixir is a memory safe language, which C is not, and discusses the thread safety benefits of Elixir. These are both important topics, for example Elixir completely eliminates <a href="https://paraxial.io/blog/data-race">security issues due to data races</a>, a severe vulnerability that can lead to users being logged into the wrong account, a disaster for banking and medical portals. </p>
<p>
An empirical study showing that Elixir programs contain vulnerabilities is not surprising, because software written in every language has them. Imagine Elixir as a type of asphalt which reduces the rate of potholes in roads, and Nathan’s article is explaining this benefit. Then a paper is published saying, “roads paved with Elixir still have potholes”, ignoring that it results in fewer potholes. The paper does not mention memory or thread safety at all, which are the specific security benefits Nathan discusses. Rather, it surveys popular open-source Elixir projects for vulnerability related commits. </p>
<p><img src="https://archive.ph/repo_set.png" width="500"/></p><p>
Which repos were selected for the dataset? The paper does not mention them, below is a list pulled from the <a href="https://figshare.com/articles/dataset/Elixir_Vulnerability_Dataset/15078573/1">dataset</a>. The unix command <code>awk -F &#34;,&#34; &#39;{print $1}&#39; ELIXIR_FINAL_SECURITY_BUG_DATASET.csv | sort | uniq</code> was used to get this list.</p>
<pre><code>1. 30-days-of-elixir
2. absinthe
3. analytics
4. awesome-elixir
5. credo
6. curlconverter
7. distillery
8. edeliver
9. elixir
10. elixir-koans
11. guardian
12. httpoison
13. papercups
14. phoenix
15. phoenix-trello
16. poison
17. quantum-core
18. realtime
19. rustler</code></pre>
<p>
It is surprising to only see 19 repos, when the paper says 25. The inclusion of <code>30-days-of-elixir</code>, <code>awesome-elixir</code>, and <code>elixir-koans</code> is debatable, considering these repos do not store projects intended to be run in production. The counts for “Elixir Files” and “Elixir-related Commits” in the dataset do match the paper. </p>
<p><img src="https://archive.ph/table2.png" width="500"/></p><p>
These numbers do match the dataset, but the definition of “program” is misleading. For example, commit <code>2d68e9c</code> maps to two files in the dataset:</p>
<pre><code>absinthe/test/absinthe/phase/document/complexity_test.exs
absinthe/lib/absinthe/phase/document/complexity/result.ex</code></pre>
<p>
<a href="https://github.com/absinthe-graphql/absinthe/pull/800/commits/2d68e9c4d6540a200cd134661c23400d26631f75">View this commit on Github.</a> Both of these files are considered a “program” in the paper. It is misleading to say the dataset has “319 programs with vulnerability related commits”, the paper came to that number by counting files per commit classified as vulnerable. </p>
<p>
In the paper’s dataset, the repo for <a href="https://plausible.io/">Plausible Analytics</a> is included, with commit <code>f7b37fe</code>. You can <a href="https://github.com/plausible/analytics/commit/f7b37fe9eac54336f7a61a6b4d2378a381637b5b">view this commit on Github</a>, but it is for a PR with 32 changed files, so the commit alone is not enough information to determine what vulnerability the dataset is referring to. The paper mentions that commits were found via a keyword search for terms often used to describe vulnerabilities, one of which is “sql”.</p>
<pre><code>lib/plausible_web/controllers/api/external_controller.ex</code></pre>
<pre><code><span>postgres_health</span><span> </span><span>=</span><span>
  </span><span>case</span><span> </span><span>Ecto.Adapters.SQL</span><span>.</span><span>query</span><span data-group-id="7394294953-1">(</span><span>Plausible.Repo</span><span>,</span><span> </span><span>&#34;SELECT 1&#34;</span><span>,</span><span> </span><span data-group-id="7394294953-2">[</span><span data-group-id="7394294953-2">]</span><span data-group-id="7394294953-1">)</span><span> </span><span data-group-id="7394294953-3">do</span><span>
    </span><span data-group-id="7394294953-4">{</span><span>:ok</span><span>,</span><span> </span><span>_</span><span data-group-id="7394294953-4">}</span><span> </span><span>-&gt;</span><span> </span><span>&#34;ok&#34;</span><span>
    </span><span>e</span><span> </span><span>-&gt;</span><span> </span><span>&#34;error: </span><span data-group-id="7394294953-5">#{</span><span>inspect</span><span data-group-id="7394294953-6">(</span><span>e</span><span data-group-id="7394294953-6">)</span><span data-group-id="7394294953-5">}</span><span>&#34;</span><span>
  </span><span data-group-id="7394294953-3">end</span></code></pre>
<p>
Sobelow will flag this code as vulnerable, even though it is not, because no user input is being passed to the SQL query. </p>
<pre><code>lib/plausible_release.ex</code></pre>
<pre><code><span>  </span><span>defp</span><span> </span><span>do_create_ch_db</span><span data-group-id="8989898227-1">(</span><span data-group-id="8989898227-1">)</span><span> </span><span data-group-id="8989898227-2">do</span><span>
    </span><span>db_to_create</span><span> </span><span>=</span><span> </span><span>Keyword</span><span>.</span><span>get</span><span data-group-id="8989898227-3">(</span><span>Application</span><span>.</span><span>get_env</span><span data-group-id="8989898227-4">(</span><span>:plausible</span><span>,</span><span> </span><span>:clickhouse</span><span data-group-id="8989898227-4">)</span><span>,</span><span> </span><span>:database</span><span data-group-id="8989898227-3">)</span><span>
    </span><span>IO</span><span>.</span><span>puts</span><span data-group-id="8989898227-5">(</span><span>&#34;create </span><span data-group-id="8989898227-6">#{</span><span>inspect</span><span data-group-id="8989898227-7">(</span><span>db_to_create</span><span data-group-id="8989898227-7">)</span><span data-group-id="8989898227-6">}</span><span> clickhouse database/tables if it doesn&#39;t exist&#34;</span><span data-group-id="8989898227-5">)</span><span>
    </span><span>Clickhousex</span><span>.</span><span>query</span><span data-group-id="8989898227-8">(</span><span>:clickhouse</span><span>,</span><span> </span><span>&#34;CREATE DATABASE IF NOT EXISTS </span><span data-group-id="8989898227-9">#{</span><span>db_to_create</span><span data-group-id="8989898227-9">}</span><span>&#34;</span><span>,</span><span> </span><span data-group-id="8989898227-10">[</span><span data-group-id="8989898227-10">]</span><span data-group-id="8989898227-8">)</span><span>
  </span><span data-group-id="8989898227-2">end</span></code></pre>
<p>
The string interpolation in a Clickhouse DB query looks suspicious, but the <code>db_to_create</code> value is not set by user input, so there is no vulnerability. The keywords “security” and “vulnerability” also appear in the PR. Link to sub-commits:</p>
<p>
<a href="https://github.com/plausible/analytics/pull/209/commits/b3f783edb698c273cfa13271be3a74c9f226d65a"><code>b3f783e</code></a> - Adds a container security tool, not related to Elixir. </p>
<p>
<a href="https://github.com/plausible/analytics/pull/209/commits/57171f893aa762d02eeea5130f6e84f739f447a3"><code>57171f8</code></a> - The text of this comment says, “fixing some vulnerabilities identified by the scanning tools”, however it involved a Debian upgrade, not related to Elixir.</p>
<p>
The paper counts <code>f7b37fe</code> as “28 programs with vulnerability related commits”, because it involves 28 Elixir source code files, which is not correct. The lack of clarity around the vulnerable code in the dataset is concerning, making it impossible to truly replicate the paper’s findings, because you have to guess which specific lines the dataset is referring to as vulnerable. The dataset contains no labels for the type of security issue found (DoS, XSS, CSRF, etc), no information on the severity of each issue, and no discussion on how an attacker would use each vulnerability. This limits its utility in discussing the security of Elixir applications.</p>
<p>
It is highly unlikely that the dataset from this paper includes vulnerabilities related to thread or memory safety, which is the main point Nathan correctly makes in his article <a href="https://dockyard.com/blog/2021/03/30/elixir-is-safe">Elixir is Safe</a>.</p>
<hr/>
<p>
<em><a href="https://paraxial.io/">Paraxial.io</a> secures Elixir and Phoenix applications. Professional services, including Elixir developer security training and penetration testing, are also available. <a href="https://calendly.com/paraxial/paraxial-io">Schedule a call today</a>.</em></p>
<meta property="og:image" content="https://paraxial.io/blog/cheetah.jpeg"/>
<meta name="twitter:image" content="https://paraxial.io/blog/cheetah.jpeg"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="Elixir is (Still) Safe"/>
<meta name="twitter:description" content="Examining the misleading claims in a published paper about Elixir security"/>
<meta name="twitter:site" content="@paraxialio"/>

    </div></div>
  </body>
</html>
