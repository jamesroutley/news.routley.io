<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Shelf-nu/shelf.nu">Original</a>
    <h1>Shelf ‚Äì open-source asset management software</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://twitter.com/ShelfQR" rel="nofollow"><img src="https://camo.githubusercontent.com/529b5acd0d1cbf3a3cfaba6ed41f98eebdba9a4f0b8136b1bcd9ffad15b2ed68/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f75726c2f68747470732f747769747465722e636f6d2f636c6f7564706f7373652e7376673f7374796c653d736f6369616c266c6162656c3d466f6c6c6f772532302534305368656c665152" alt="Twitter" data-canonical-src="https://img.shields.io/twitter/url/https/twitter.com/cloudposse.svg?style=social&amp;label=Follow%20%40ShelfQR"/></a>
<a href="https://github.com/Shelf-nu/shelf.nu/actions/workflows/deploy.yml"><img src="https://github.com/Shelf-nu/shelf.nu/actions/workflows/deploy.yml/badge.svg?branch=dev" alt="üöÄ Deploy"/></a></p>
<p dir="auto">Shelf <g-emoji alias="label" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3f7.png">üè∑Ô∏è</g-emoji> Asset Management infrastructure for absolutely everyone (open source).</p>
<p dir="auto">Shelf is a simple and visual asset management and location tracking system that allows people to track their physical assets with ease.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-core-features-and-benefits" aria-hidden="true" href="#core-features-and-benefits"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Core Features and Benefits</h2>
<p dir="auto">With Shelf, you can take a picture of any item you own and store it in your own database. From there, you can generate a printable code (QR) that you can tag onto the item, making it easy to identify and locate in the future. Shelf has a handy code printing area where you can add as many QR codes as you can on an A4 sticker paper sheet. You can also add detailed information about the item, including its purchase date, purchase price, warranty information, and more.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-once-your-assets-are-online-you-will-be-able-to" aria-hidden="true" href="#once-your-assets-are-online-you-will-be-able-to"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Once your assets are online, you will be able to:</h3>
<ul dir="auto">
<li>Generate printable PDFs sheets from assets you select, so you can stick them onto anything</li>
<li>Check the last known location of your assets</li>
<li>Instant Search through your assets database</li>
<li>Use &#39;lost mode&#39; for emergencies (offer a bounty for a return of an item)</li>
<li>Get notified of assets you are not using</li>
<li>Share your asset vault with other users</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-use-shelf-alone-or-as-a-team-and-these-questions-will-be-a-thing-of-the-past" aria-hidden="true" href="#use-shelf-alone-or-as-a-team-and-these-questions-will-be-a-thing-of-the-past"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use Shelf alone, or as a team. And, these questions will be a thing of the past.</h3>
<ul dir="auto">
<li>Who was the last person that took X,Y or Z?</li>
<li>What gear does X have currently?</li>
<li>Which assets did we appoint to our team member abroad?</li>
<li>What do we have in our storage facility now?</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-shelfs-vision-and-ambition" aria-hidden="true" href="#shelfs-vision-and-ambition"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Shelf&#39;s vision and ambition</h2>
<p dir="auto">To enable and facilitate the tagging of 1 Billion assets by 2023. Shelf therefore allows users to create unlimited assets on their environments. We will fund the growth and further development of the tool by releasing premium features. However, Shelf core will be forever free for individuals.</p>
<hr/>
<h3 tabindex="-1" dir="auto"><a id="user-content-shelfs-current-stack" aria-hidden="true" href="#shelfs-current-stack"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Shelf&#39;s current stack</h3>
<p dir="auto">We have decided to give RemixJS a try.</p>
<p dir="auto">For the purpose of shipping asap, we have opted into using a template: <a href="https://github.com/rphlmr/supa-fly-stack">https://github.com/rphlmr/supa-fly-stack</a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-getting-started-with-shelf" aria-hidden="true" href="#getting-started-with-shelf"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Getting started with Shelf</h3>

<blockquote>
<p dir="auto">This Readme will be re-written soon</p>
</blockquote>
<div data-snippet-clipboard-copy-content="npx create-remix --template rphlmr/supa-fly-stack"><pre><code>npx create-remix --template rphlmr/supa-fly-stack
</code></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-whats-in-the-stack" aria-hidden="true" href="#whats-in-the-stack"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What&#39;s in the stack</h2>
<ul dir="auto">
<li><a href="https://fly.io" rel="nofollow">Fly app deployment</a> with <a href="https://www.docker.com/products/docker-desktop/" rel="nofollow">Docker</a></li>
<li>Production-ready <a href="https://supabase.com/" rel="nofollow">Supabase Database</a></li>
<li>Healthcheck endpoint for <a href="https://fly.io/docs/reference/configuration/#services-http_checks" rel="nofollow">Fly backups region fallbacks</a></li>
<li><a href="https://github.com/features/actions">GitHub Actions</a> to deploy on merge to production and staging environments</li>
<li>Email/Password Authentication / Magic Link, with <a href="https://remix.run/docs/en/v1/api/remix#createcookiesessionstorage" rel="nofollow">cookie-based sessions</a></li>
<li>Database ORM with <a href="https://prisma.io" rel="nofollow">Prisma</a></li>
<li>Forms Schema (client and server sides !) validation with <a href="https://github.com/kiliman/remix-params-helper">Remix Params Helper</a></li>
<li>Styling with <a href="https://tailwindcss.com/" rel="nofollow">Tailwind</a></li>
<li>End-to-end testing with <a href="https://cypress.io" rel="nofollow">Cypress</a></li>
<li>Local third party request mocking with <a href="https://mswjs.io" rel="nofollow">MSW</a></li>
<li>Unit testing with <a href="https://vitest.dev" rel="nofollow">Vitest</a> and <a href="https://testing-library.com" rel="nofollow">Testing Library</a></li>
<li>Code formatting with <a href="https://prettier.io" rel="nofollow">Prettier</a></li>
<li>Linting with <a href="https://eslint.org" rel="nofollow">ESLint</a></li>
<li>Static Types with <a href="https://typescriptlang.org" rel="nofollow">TypeScript</a></li>
</ul>
<p dir="auto">Not a fan of bits of the stack? Fork it, change it, and use <code>npx create-remix --template your/repo</code>! Make it your own.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-development" aria-hidden="true" href="#development"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Development</h2>
<ul dir="auto">
<li>
<p dir="auto">Create a <a href="https://supabase.com/" rel="nofollow">Supabase Database</a> (free tier gives you 2 databases)</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> Only one for playing around with Supabase or 2 for <code>staging</code> and <code>production</code></p>
</blockquote>
<blockquote>
<p dir="auto"><strong>Note:</strong> Used all your free tiers ? Also works with <a href="https://github.com/supabase/cli">Supabase CLI</a> and local self-hosting</p>
</blockquote>
<blockquote>
<p dir="auto"><strong>Note:</strong> Create a strong database password, but prefer a passphrase, it&#39;ll be more easy to use in connection string (no need to escape special char)</p>
<p dir="auto"><em>example : my_strong_passphrase</em></p>
</blockquote>
</li>
<li>
<p dir="auto">Go to <a href="https://app.supabase.io/project/%7BPROJECT%7D/settings/api" rel="nofollow">https://app.supabase.io/project/{PROJECT}/settings/api</a> to find your secrets</p>
</li>
<li>
<p dir="auto">&#34;Project API keys&#34;</p>
</li>
<li>
<p dir="auto">Add your <code>MAPTILER_TOKEN</code>, <code>SUPABASE_URL</code>, <code>SERVER_URL</code>, <code>SUPABASE_SERVICE_ROLE</code> (aka <code>service_role</code> <code>secret</code>), <code>SUPABASE_ANON_PUBLIC</code> (aka <code>anon</code> <code>public</code>) and <code>DATABASE_URL</code> in the <code>.env</code> file</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> <code>SERVER_URL</code> is your localhost on dev. It&#39;ll work for magic link login</p>
</blockquote>
</li>
</ul>
<div data-snippet-clipboard-copy-content="DATABASE_URL=&#34;postgres://postgres:{STAGING_POSTGRES_PASSWORD}@db.{STAGING_YOUR_INSTANCE_NAME}.supabase.co:5432/postgres&#34;
SUPABASE_ANON_PUBLIC=&#34;{ANON_PUBLIC}&#34;
SUPABASE_SERVICE_ROLE=&#34;{SERVICE_ROLE}&#34;
SUPABASE_URL=&#34;https://{STAGING_YOUR_INSTANCE_NAME}.supabase.co&#34;
SESSION_SECRET=&#34;super-duper-s3cret&#34;
SERVER_URL=&#34;http://localhost:3000&#34;
MAPTILER_TOKEN=&#34;someToken&#34;
SMTP_HOST=&#34;smtp.yourhost.com&#34;
SMTP_USER=&#34;you@example.com&#34;
SMTP_PWD=&#34;yourSMTPpassword&#34;"><pre lang="en"><code>DATABASE_URL=&#34;postgres://postgres:{STAGING_POSTGRES_PASSWORD}@db.{STAGING_YOUR_INSTANCE_NAME}.supabase.co:5432/postgres&#34;
SUPABASE_ANON_PUBLIC=&#34;{ANON_PUBLIC}&#34;
SUPABASE_SERVICE_ROLE=&#34;{SERVICE_ROLE}&#34;
SUPABASE_URL=&#34;https://{STAGING_YOUR_INSTANCE_NAME}.supabase.co&#34;
SESSION_SECRET=&#34;super-duper-s3cret&#34;
SERVER_URL=&#34;http://localhost:3000&#34;
MAPTILER_TOKEN=&#34;someToken&#34;
SMTP_HOST=&#34;smtp.yourhost.com&#34;
SMTP_USER=&#34;you@example.com&#34;
SMTP_PWD=&#34;yourSMTPpassword&#34;
</code></pre></div>
<ul dir="auto">
<li>
<p dir="auto">This step only applies if you&#39;ve opted out of having the CLI install dependencies for you:</p>

</li>
<li>
<p dir="auto">Initial setup:</p>

</li>
<li>
<p dir="auto">Start dev server:</p>

</li>
</ul>
<p dir="auto">This starts your app in development mode, rebuilding assets on file changes.</p>
<p dir="auto">The database seed script creates a new user with some data you can use to get started:</p>
<ul dir="auto">
<li>Email: <code>hello@supabase.com</code></li>
<li>Password: <code>supabase</code></li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-relevant-code" aria-hidden="true" href="#relevant-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Relevant code:</h3>
<p dir="auto">This is a pretty simple note-taking app, but it&#39;s a good example of how you can build a full-stack app with Prisma, Supabase, and Remix. The main functionality is creating users, logging in and out (handling access and refresh tokens + refresh on expiration), and creating and deleting notes.</p>
<ul dir="auto">
<li>auth / session <a href="https://github.com/Shelf-nu/shelf.nu/blob/main/app/modules/auth">./app/modules/auth</a></li>
<li>creating, and deleting notes <a href="https://github.com/Shelf-nu/shelf.nu/blob/main/app/modules/note">./app/modules/note</a></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-deployment" aria-hidden="true" href="#deployment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Deployment</h2>
<blockquote>
<p dir="auto">Do what you know if you are a Fly.io expert.</p>
</blockquote>
<p dir="auto">This Remix Stack comes with two GitHub Actions that handle automatically deploying your app to production and staging environments.</p>
<p dir="auto">Prior to your first deployment, you&#39;ll need to do a few things:</p>
<ul dir="auto">
<li>
<p dir="auto"><a href="https://fly.io/docs/getting-started/installing-flyctl/" rel="nofollow">Install Fly</a></p>
</li>
<li>
<p dir="auto">Sign up and log in to Fly</p>

<blockquote>
<p dir="auto"><strong>Note:</strong> If you have more than one Fly account, ensure that you are signed into the same account in the Fly CLI as you are in the browser. In your terminal, run <code>fly auth whoami</code> and ensure the email matches the Fly account signed into the browser.</p>
</blockquote>
</li>
<li>
<p dir="auto">Create two apps on Fly, one for staging and one for production:</p>
<div dir="auto" data-snippet-clipboard-copy-content="fly apps create supa-fly-stack-template
fly apps create supa-fly-stack-template-staging  # ** not mandatory if you don&#39;t want a staging environnement **"><pre>fly apps create supa-fly-stack-template
fly apps create supa-fly-stack-template-staging  <span><span>#</span> ** not mandatory if you don&#39;t want a staging environnement **</span></pre></div>
<blockquote>
<p dir="auto"><strong>Note:</strong> For production app, make sure this name matches the <code>app</code> set in your <code>fly.toml</code> file. Otherwise, you will not be able to deploy.</p>
</blockquote>
<ul dir="auto">
<li>Initialize Empty Git repository.</li>
</ul>

</li>
<li>
<p dir="auto">Create a new <a href="https://repo.new" rel="nofollow">GitHub Repository</a>, and then add it as the remote for your project. <strong>Do not push your app yet!</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="git remote add origin &lt;ORIGIN_URL&gt;"><pre>git remote add origin <span>&lt;</span>ORIGIN_URL<span>&gt;</span></pre></div>
</li>
<li>
<p dir="auto">Add <code>MAPTILER_TOKEN</code> which is needed for rendering the map which shows the last scanned location. For more info and to get an account and token: <a href="https://www.maptiler.com/" rel="nofollow">https://www.maptiler.com/</a></p>
</li>
<li>
<p dir="auto">Add a <code>FLY_API_TOKEN</code> to your GitHub repo. To do this, go to your user settings on Fly and create a new <a href="https://web.fly.io/user/personal_access_tokens/new" rel="nofollow">token</a>, then add it to <a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">your repo secrets</a> with the name <code>FLY_API_TOKEN</code>.</p>
</li>
<li>
<p dir="auto">Add a <code>SESSION_SECRET</code>, <code>SUPABASE_URL</code>, <code>SUPABASE_SERVICE_ROLE</code>,<code>SUPABASE_ANON_PUBLIC</code>, <code>SERVER_URL</code> and <code>DATABASE_URL</code> to your fly app secrets</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> To find your <code>SERVER_URL</code>, go to <a href="https://fly.io/apps/supa-fly-stack-template-3a36" rel="nofollow">your fly.io dashboard</a></p>
</blockquote>
<p dir="auto">To do this you can run the following commands:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# production (--app name is resolved from fly.toml)
fly secrets set SESSION_SECRET=$(openssl rand -hex 32)
fly secrets set SUPABASE_URL=&#34;https://{YOUR_INSTANCE_NAME}.supabase.co&#34;
fly secrets set SUPABASE_SERVICE_ROLE=&#34;{SUPABASE_SERVICE_ROLE}&#34;
fly secrets set SUPABASE_ANON_PUBLIC=&#34;{SUPABASE_ANON_PUBLIC}&#34;
fly secrets set DATABASE_URL=&#34;postgres://postgres:{POSTGRES_PASSWORD}@db.{YOUR_INSTANCE_NAME}.supabase.co:5432/postgres&#34;
fly secrets set SERVER_URL=&#34;https://{YOUR_STAGING_SERVEUR_URL}&#34;
fly secrets set MAPTILER_TOKEN=&#34;{YOUR_MAPTILER_TOKEN}&#34;

fly secrets set SMTP_HOST=&#34;smtp.yourhost.com&#34;
fly secrets set SMTP_USER=&#34;you@example.com&#34;
fly secrets set SMTP_PWD=&#34;yourSMTPpassword&#34;


# staging (specify --app name) ** not mandatory if you don&#39;t want a staging environnement **
fly secrets set SESSION_SECRET=$(openssl rand -hex 32) --app supa-fly-stack-template-staging
fly secrets set SUPABASE_URL=&#34;https://{YOUR_STAGING_INSTANCE_NAME}.supabase.co&#34; --app supa-fly-stack-template-staging
fly secrets set SUPABASE_SERVICE_ROLE=&#34;{STAGING_SUPABASE_SERVICE_ROLE}&#34; --app supa-fly-stack-template-staging
fly secrets set SUPABASE_ANON_PUBLIC=&#34;{STAGING_SUPABASE_ANON_PUBLIC}&#34; --app supa-fly-stack-template-staging
fly secrets set DATABASE_URL=&#34;postgres://postgres:{STAGING_POSTGRES_PASSWORD}@db.{STAGING_YOUR_INSTANCE_NAME}.supabase.co:5432/postgres&#34; --app supa-fly-stack-template-staging
fly secrets set SERVER_URL=&#34;https://{YOUR_STAGING_SERVEUR_URL}&#34; --app supa-fly-stack-template-staging
"><pre><span><span>#</span> production (--app name is resolved from fly.toml)</span>
fly secrets <span>set</span> SESSION_SECRET=<span><span>$(</span>openssl rand -hex 32<span>)</span></span>
fly secrets <span>set</span> SUPABASE_URL=<span><span>&#34;</span>https://{YOUR_INSTANCE_NAME}.supabase.co<span>&#34;</span></span>
fly secrets <span>set</span> SUPABASE_SERVICE_ROLE=<span><span>&#34;</span>{SUPABASE_SERVICE_ROLE}<span>&#34;</span></span>
fly secrets <span>set</span> SUPABASE_ANON_PUBLIC=<span><span>&#34;</span>{SUPABASE_ANON_PUBLIC}<span>&#34;</span></span>
fly secrets <span>set</span> DATABASE_URL=<span><span>&#34;</span>postgres://postgres:{POSTGRES_PASSWORD}@db.{YOUR_INSTANCE_NAME}.supabase.co:5432/postgres<span>&#34;</span></span>
fly secrets <span>set</span> SERVER_URL=<span><span>&#34;</span>https://{YOUR_STAGING_SERVEUR_URL}<span>&#34;</span></span>
fly secrets <span>set</span> MAPTILER_TOKEN=<span><span>&#34;</span>{YOUR_MAPTILER_TOKEN}<span>&#34;</span></span>

fly secrets <span>set</span> SMTP_HOST=<span><span>&#34;</span>smtp.yourhost.com<span>&#34;</span></span>
fly secrets <span>set</span> SMTP_USER=<span><span>&#34;</span>you@example.com<span>&#34;</span></span>
fly secrets <span>set</span> SMTP_PWD=<span><span>&#34;</span>yourSMTPpassword<span>&#34;</span></span>


<span><span>#</span> staging (specify --app name) ** not mandatory if you don&#39;t want a staging environnement **</span>
fly secrets <span>set</span> SESSION_SECRET=<span><span>$(</span>openssl rand -hex 32<span>)</span></span> --app supa-fly-stack-template-staging
fly secrets <span>set</span> SUPABASE_URL=<span><span>&#34;</span>https://{YOUR_STAGING_INSTANCE_NAME}.supabase.co<span>&#34;</span></span> --app supa-fly-stack-template-staging
fly secrets <span>set</span> SUPABASE_SERVICE_ROLE=<span><span>&#34;</span>{STAGING_SUPABASE_SERVICE_ROLE}<span>&#34;</span></span> --app supa-fly-stack-template-staging
fly secrets <span>set</span> SUPABASE_ANON_PUBLIC=<span><span>&#34;</span>{STAGING_SUPABASE_ANON_PUBLIC}<span>&#34;</span></span> --app supa-fly-stack-template-staging
fly secrets <span>set</span> DATABASE_URL=<span><span>&#34;</span>postgres://postgres:{STAGING_POSTGRES_PASSWORD}@db.{STAGING_YOUR_INSTANCE_NAME}.supabase.co:5432/postgres<span>&#34;</span></span> --app supa-fly-stack-template-staging
fly secrets <span>set</span> SERVER_URL=<span><span>&#34;</span>https://{YOUR_STAGING_SERVEUR_URL}<span>&#34;</span></span> --app supa-fly-stack-template-staging
</pre></div>
<p dir="auto">If you don&#39;t have openssl installed, you can also use <a href="https://1password.com/generate-password" rel="nofollow">1password</a> to generate a random secret, just replace <code>$(openssl rand -hex 32)</code> with the generated secret.</p>
</li>
</ul>
<p dir="auto">Now that everything is set up you can commit and push your changes to your repo. Every commit to your <code>main</code> branch will trigger a deployment to your production environment, and every commit to your <code>dev</code> branch will trigger a deployment to your staging environment.</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> To deploy manually, just run <code>fly deploy</code> (It&#39;ll deploy app defined in fly.toml)</p>
</blockquote>
<h2 tabindex="-1" dir="auto"><a id="user-content-file-storage" aria-hidden="true" href="#file-storage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>File Storage</h2>
<p dir="auto">For File storage we use the S3 buckets service provided by supabase. We do this as it makes it easier to manage permissions in relation to our users which are also stored on supabase. To set it up you need to do the following steps:</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-profile-pictures" aria-hidden="true" href="#profile-pictures"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Profile pictures</h3>
<ol dir="auto">
<li>Create a bucket called <code>profile-pictures</code></li>
<li>Make it a public bucket</li>
<li>Implement a policy for <code>INSERT</code>, <code>UPDATE</code> &amp; <code>DELETE</code>. The policy expression is: <code>((bucket_id = &#39;profile-pictures&#39;::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))</code> and target roles should be set to <code>authenticated</code></li>
</ol>
<h3 tabindex="-1" dir="auto"><a id="user-content-items" aria-hidden="true" href="#items"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Items</h3>
<ol dir="auto">
<li>Create a bucket called <code>items</code></li>
<li>Implement a policy for <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code> &amp; <code>DELETE</code>. The policy expression is: <code>((bucket_id = &#39;items&#39;::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))</code> and target roles should be set to <code>authenticated</code></li>
</ol>
<h2 tabindex="-1" dir="auto"><a id="user-content-github-actions" aria-hidden="true" href="#github-actions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>GitHub Actions</h2>
<blockquote>
<p dir="auto">DISCLAIMER : Github actions ==&gt; I&#39;m not an expert about that. Read carefully before using it</p>
</blockquote>
<p dir="auto">We use GitHub Actions for continuous integration and deployment. Anything that gets into the <code>main</code> branch will be deployed to production after running tests/build/etc. Anything in the <code>dev</code> branch will be deployed to staging.</p>
<p dir="auto"><g-emoji alias="point_right" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f449.png">üëâ</g-emoji> <strong>You have to add some env secrets for cypress.</strong> <g-emoji alias="point_left" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f448.png">üëà</g-emoji></p>
<p dir="auto">Add a <code>SESSION_SECRET</code>, <code>SUPABASE_URL</code>, <code>SUPABASE_SERVICE_ROLE</code>,<code>SUPABASE_ANON_PUBLIC</code>, <code>SERVER_URL</code> and <code>DATABASE_URL</code> to <a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">your repo secrets</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-testing" aria-hidden="true" href="#testing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Testing</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-cypress" aria-hidden="true" href="#cypress"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Cypress</h3>
<p dir="auto">We use Cypress for our End-to-End tests in this project. You&#39;ll find those in the <code>cypress</code> directory. As you make changes, add to an existing file or create a new file in the <code>cypress/e2e</code> directory to test your changes.</p>
<p dir="auto">We use <a href="https://testing-library.com/cypress" rel="nofollow"><code>@testing-library/cypress</code></a> for selecting elements on the page semantically.</p>
<p dir="auto">To run these tests in development, complete your <code>.env</code> and run <code>npm run test:e2e:dev</code> which will start the dev server for the app as well as the Cypress client. Make sure the database is running in docker as described above.</p>
<p dir="auto">We also have a utility to auto-delete the user at the end of your test. Just make sure to add this in each test file:</p>
<div dir="auto" data-snippet-clipboard-copy-content="afterEach(() =&gt; {
  cy.cleanupUser();
});"><pre><span>afterEach</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>cy</span><span>.</span><span>cleanupUser</span><span>(</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></pre></div>
<p dir="auto">That way, we can keep your test db clean and keep your tests isolated from one another.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-vitest" aria-hidden="true" href="#vitest"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Vitest</h3>
<p dir="auto">For lower level tests of utilities and individual components, we use <code>vitest</code>. We have DOM-specific assertion helpers via <a href="https://testing-library.com/jest-dom" rel="nofollow"><code>@testing-library/jest-dom</code></a>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-type-checking" aria-hidden="true" href="#type-checking"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Type Checking</h3>
<p dir="auto">This project uses TypeScript. It&#39;s recommended to get TypeScript set up for your editor to get a great in-editor experience with type checking and auto-complete. To run type checking across the whole project, run <code>npm run typecheck</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-linting" aria-hidden="true" href="#linting"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Linting</h3>
<p dir="auto">This project uses ESLint for linting. That is configured in <code>.eslintrc.js</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-formatting" aria-hidden="true" href="#formatting"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Formatting</h3>
<p dir="auto">We use <a href="https://prettier.io/" rel="nofollow">Prettier</a> for auto-formatting in this project. It&#39;s recommended to install an editor plugin (like the <a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode" rel="nofollow">VSCode Prettier plugin</a>) to get auto-formatting on save. There&#39;s also a <code>npm run format</code> script you can run to format all files in the project.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-start-working-with-supabase" aria-hidden="true" href="#start-working-with-supabase"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Start working with Supabase</h2>
<p dir="auto">You are now ready to go further, congrats!</p>
<p dir="auto">To extend your Prisma schema and apply changes on your supabase database :</p>
<ul dir="auto">
<li>
<p dir="auto">Make your changes in <a href="https://github.com/Shelf-nu/shelf.nu/blob/main/app/database/schema.prisma">./app/database/schema.prisma</a></p>
</li>
<li>
<p dir="auto">Prepare your schema migration</p>
<div dir="auto" data-snippet-clipboard-copy-content="npm run db:prepare-migration"><pre>npm run db:prepare-migration</pre></div>
</li>
<li>
<p dir="auto">Check your migration in <a href="https://github.com/Shelf-nu/shelf.nu/blob/main/app/database">./app/database/migrations</a></p>
</li>
<li>
<p dir="auto">Apply this migration to production</p>
<div dir="auto" data-snippet-clipboard-copy-content="npm run db:deploy-migration"><pre>npm run db:deploy-migration</pre></div>
</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-if-your-token-expires-in-less-than-1-hour-3600-seconds-in-supabase-dashboard" aria-hidden="true" href="#if-your-token-expires-in-less-than-1-hour-3600-seconds-in-supabase-dashboard"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>If your token expires in less than 1 hour (3600 seconds in Supabase Dashboard)</h2>
<p dir="auto">If you have a lower token lifetime than me (1 hour), you should take a look at <code>REFRESH_ACCESS_TOKEN_THRESHOLD</code> in <a href="https://github.com/Shelf-nu/shelf.nu/blob/main/app/modules/auth/session.server.ts">./app/modules/auth/session.server.ts</a> and set what you think is the best value for your use case.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-supabase-rls" aria-hidden="true" href="#supabase-rls"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Supabase RLS</h2>
<p dir="auto">You may ask &#34;can I use RLS with Remix&#34;.</p>
<p dir="auto">The answer is &#34;Yes&#34; but It has a cost.</p>
<p dir="auto">Using Supabase SDK server side to query your database (for those using RLS features) adds an extra delay due to calling a Gotrue rest API instead of directly calling the Postgres database (and this is fine because at first Supabase SDK is for those who don&#39;t have/want backend).</p>
<p dir="auto">In my benchmark, it makes my pages twice slower. (~+200ms compared to a direct query with Prisma)</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-supabase-login-with-magic-link" aria-hidden="true" href="#supabase-login-with-magic-link"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Supabase login with magic link</h2>
<p dir="auto">In order to make the register/login with magic link work, you will need to add some configuration to your Supabase.
You need to add the site url as well as the redirect urls of your local, test and live app that will be used for oauth
To do that navigate to Authentication &gt; URL configiration and add the folowing values:</p>
<ul dir="auto">
<li>
<p dir="auto"><a href="https://localhost:3000/oauth/callback" rel="nofollow">https://localhost:3000/oauth/callback</a></p>
</li>
<li>
<p dir="auto"><a href="https://localhost:3000/reset-password" rel="nofollow">https://localhost:3000/reset-password</a></p>
</li>
<li>
<p dir="auto"><a href="https://staging-domain.com/oauth/callback" rel="nofollow">https://staging-domain.com/oauth/callback</a></p>
</li>
<li>
<p dir="auto"><a href="https://staging-domain.com/reset-password" rel="nofollow">https://staging-domain.com/reset-password</a></p>
</li>
<li>
<p dir="auto"><a href="https://live-domain.com/oauth/callback" rel="nofollow">https://live-domain.com/oauth/callback</a></p>
</li>
<li>
<p dir="auto"><a href="https://live-domain.com/reset-password" rel="nofollow">https://live-domain.com/reset-password</a></p>
</li>
</ul>
</article>
          </div></div>
  </body>
</html>
