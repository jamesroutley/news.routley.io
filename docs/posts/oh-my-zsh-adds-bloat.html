<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rushter.com/blog/zsh-shell/">Original</a>
    <h1>Oh My Zsh adds bloat</h1>
    
    <div id="readability-page-1" class="page"><div><p>Oh My Zsh is still getting recommended a lot.
The main problem with Oh My Zsh is that it adds a lot of unnecessary bloat that affects shell startup time.</p>
<p>Since OMZ is written in shell scripts, every time you open a new terminal tab, it has to interpret all those scripts.
Most likely, you don&#39;t need OMZ at all.</p>
<p>Here are the timings from the default setup with a few plugins (git, zsh-autosuggestions, zsh-autocomplete) that are usually recommended:</p>
<div><pre><span></span><code>➜<span>  </span>~<span> </span>/usr/bin/time<span> </span>-f<span> </span><span>&#34;%e seconds&#34;</span><span> </span>zsh<span> </span>-i<span> </span>-c<span> </span><span>exit</span>
<span>0</span>.38<span> </span>seconds
</code></pre></div>

<p>And that&#39;s only for prompt and a new shell instance, without actually measuring the git plugin and virtual env plugins (which are often used for Python).
Creating a new tab takes some time for your terminal, too.
It feels like a whole second to me when opening a new tab in a folder with a git repository.</p>
<p>My workflows involve opening and closing up to hundreds of terminal or tmux tabs a day. I do everything from the terminal.
Just imagine that opening a new tab in a text editor would take half a second every time.</p>
<p>Once in a while, it also checks for updates, which can take up to a few seconds when you open a new tab.</p>
<p>I see no reason in frequent updates for my shell configuration.
Especially, when a lot of third-party plugins are getting updates too.
Why would you want you shell to fetch updates?</p>
<p>My advice is to start simple and only add what you really need.</p>
<h3>Minimal Zsh configuration</h3>
<p>Here is the minimal Zsh configuration that works well as a starting point:</p>
<div><pre><span></span><code><span>export</span><span> </span><span>HISTSIZE</span><span>=</span><span>1000000000</span>
<span>export</span><span> </span><span>SAVEHIST</span><span>=</span><span>$HISTSIZE</span>
setopt<span> </span>EXTENDED_HISTORY
setopt<span> </span>autocd
autoload<span> </span>-U<span> </span>compinit<span>;</span><span> </span>compinit
</code></pre></div>

<p>It&#39;s an already pretty good setup with completions!</p>
<p>Some details about this configuration:</p>
<ul>
<li><code>HISTSIZE</code> and <code>SAVEHIST</code> set the size of your history.</li>
<li><code>EXTENDED_HISTORY</code> adds timestamps to your history entries.</li>
<li><code>autocd</code> allows you to change directories without typing <code>cd</code>.</li>
<li><code>compinit</code> initializes the Zsh completion system.</li>
</ul>
<h3>Prompt customization</h3>
<p>You also want to customize your prompt.
For prompts, I&#39;m using <a href="https://starship.rs/" target="_blank">starship</a> which is a fast and minimal prompt packed into a single binary.</p>
<p>The very old way of doing this in Oh My Zsh was to use plugins and custom themes.
With starship, it&#39;s very simple and easy now. It replaces git, virtual environment and language specific plugins.</p>
<p>Here is my config for starship:</p>
<div><pre><span></span><code><span>[aws]</span>
<span>disabled</span><span> </span><span>=</span><span> </span><span>true</span>

<span>[package]</span>
<span>disabled</span><span> </span><span>=</span><span> </span><span>true</span>

<span>[gcloud]</span>
<span>disabled</span><span> </span><span>=</span><span> </span><span>true</span>

<span>[azure]</span>
<span>disabled</span><span> </span><span>=</span><span> </span><span>true</span>


<span>[nodejs]</span>
<span>disabled</span><span> </span><span>=</span><span> </span><span>true</span>

<span>[character]</span>
<span>success_symbol</span><span> </span><span>=</span><span> </span><span>&#39;[➜](bold green)&#39;</span>

<span>[cmd_duration]</span>
<span>min_time</span><span> </span><span>=</span><span> </span><span>500</span>
<span>format</span><span> </span><span>=</span><span> </span><span>&#39;underwent [$duration](bold yellow)&#39;</span>

<span>[directory]</span>
<span>truncation_length</span><span> </span><span>=</span><span> </span><span>255</span>
<span>truncate_to_repo</span><span> </span><span>=</span><span> </span><span>false</span>
<span>use_logical_path</span><span> </span><span>=</span><span> </span><span>false</span>
</code></pre></div>

<p>Because cloud services are available globally, I&#39;ve disabled them.
I don&#39;t want them to be displayed on every prompt, since this adds visual noise.</p>
<p>Here is how my prompt looks like now:
<img src="https://rushter.com/static/uploads/img/2026/prompt.png"/></p>
<p>This project uses both Python and Rust, they are highlighted in the prompt.
When you run a command, it also shows how long it took to execute.</p>
<p>To enable it, add the following line to your <code>.zshrc</code>:</p>
<div><pre><span></span><code><span>eval</span><span> </span><span>&#34;</span><span>$(</span>starship<span> </span>init<span> </span>zsh<span>)</span><span>&#34;</span>
</code></pre></div>

<h3>History search</h3>
<p>A lot of people use <code>zsh-autosuggestions</code> plugin for history search.
I find it distracting, because it shows all suggestions as you type.</p>
<p>Instead, I prefer using <a href="https://github.com/junegunn/fzf" target="_blank">fzf</a> binded to <code>Ctrl+R</code> for searching history.
It gives an interactive fuzzy search.</p>
<p><img src="https://rushter.com/static/uploads/img/2026/fzf.png"/></p>
<p>To enable it, add the following lines to your <code>.zshrc</code>:</p>


<h3>Final startup time</h3>
<p>After these changes, the startup should look as follows:</p>
<div><pre><span></span><code>❯<span> </span>/usr/bin/time<span> </span>-f<span> </span><span>&#34;%e seconds&#34;</span><span> </span>zsh<span> </span>-i<span> </span>-c<span> </span><span>exit</span>
<span>0</span>.07<span> </span>seconds
</code></pre></div>

<h3>Miscellaneous tips</h3>
<p>For Vim users, I also suggest enabling Vim mode in Zsh. It makes editing commands much faster.</p>
<div><pre><span></span><code><span>set</span><span> </span>-o<span> </span>vi
<span># Fix for backspace in vi mode</span>
bindkey<span> </span>-v<span> </span><span>&#39;^?&#39;</span><span> </span>backward-delete-char
</code></pre></div>

<p>It works the same way as in Vim. By default, <code>zle</code> (the library that reads the shell input) uses Emacs keybindings.</p>
<h3>Conclusion</h3>
<p>After switching from OMZ a year ago, it only took me a few days to get used to the new workflow.
If you still missing some of the plugins, you can always load them manually.</p>
<p>Update:</p>
<p>Some people wonder why I open so many tabs.
I use tmux and a terminal-based editor (<code>helix</code>).
In tmux, I have popups for <code>lazygit</code> and <code>yazi</code> file manager.
Every time I need to check git history or browse files, I just open them.
They open on top of the current session as an overlay. You can view them as windows in IDEs.</p>
<p>I also use temporary splits to quickly run the code/tests and see the output. They count as separate shell sessions.
I want to see code and output side by side, but I don&#39;t need it all the time.</p></div><p><span>
                    <hr/>
                    <p>If you have any questions, feel free to ask them via e-mail displayed in the footer.</p>
                </span></p></div>
  </body>
</html>
