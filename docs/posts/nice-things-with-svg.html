<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://fuma-nama.vercel.app/blog/svg-art">Original</a>
    <h1>Nice things with SVG</h1>
    
    <div id="readability-page-1" class="page"><article><a href="#svg"><h2 id="svg"><span>#</span>SVG</h2></a>
<p>More about SVG.
Note that the example code is written in JSX (or React), not ordinary HTML.</p>
<a href="#animated-wires"><h3 id="animated-wires"><span>#</span>Animated Wires</h3></a>
<p>Make the line, using <code>line</code> or <code>path</code>.</p>
<svg viewBox="0 0 50 50"><g><line x1="0" y1="0" x2="0" y2="50" stroke="white" stroke-width="1"></line></g></svg>
<pre tabindex="0"><code><span><span>&lt;</span><span>svg</span><span> viewBox</span><span>=</span><span>&#34;0 0 50 50&#34;</span><span> className</span><span>=</span><span>&#34;bg-neutral-900 max-w-[100px] mx-auto&#34;</span><span>&gt;</span></span>
<span><span>  &lt;</span><span>g</span><span>&gt;</span></span>
<span><span>    &lt;</span><span>line</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;50&#34;</span><span> stroke</span><span>=</span><span>&#34;white&#34;</span><span> strokeWidth</span><span>=</span><span>&#34;1&#34;</span><span> /&gt;</span></span>
<span><span>  &lt;/</span><span>g</span><span>&gt;</span></span>
<span><span>&lt;/</span><span>svg</span><span>&gt;</span></span>
<span></span></code></pre>
<p>Make it a mask.</p>
<svg viewBox="0 0 50 50"><g><rect x="0" y="0" width="50" height="10" fill="red" mask="url(#line)"></rect><mask id="line"><line id="" x1="0" y1="0" x2="0" y2="50" stroke="white" stroke-width="1"></line></mask></g></svg>
<pre tabindex="0"><code><span><span>&lt;</span><span>svg</span><span> viewBox</span><span>=</span><span>&#34;0 0 50 50&#34;</span><span> className</span><span>=</span><span>&#34;bg-neutral-900 max-w-[100px] mx-auto&#34;</span><span>&gt;</span></span>
<span><span>  &lt;</span><span>g</span><span>&gt;</span></span>
<span><span>    &lt;</span><span>rect</span><span> x</span><span>=</span><span>&#34;0&#34;</span><span> y</span><span>=</span><span>&#34;0&#34;</span><span> width</span><span>=</span><span>&#34;50&#34;</span><span> height</span><span>=</span><span>&#34;10&#34;</span><span> fill</span><span>=</span><span>&#34;red&#34;</span><span> mask</span><span>=</span><span>&#34;url(#line)&#34;</span><span> /&gt;</span></span>
<span><span>    &lt;</span><span>mask</span><span> id</span><span>=</span><span>&#34;line&#34;</span><span>&gt;</span></span>
<span><span>      &lt;</span><span>line</span><span> id</span><span>=</span><span>&#34;&#34;</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;50&#34;</span><span> stroke</span><span>=</span><span>&#34;white&#34;</span><span> strokeWidth</span><span>=</span><span>&#34;1&#34;</span><span> /&gt;</span></span>
<span><span>    &lt;/</span><span>mask</span><span>&gt;</span></span>
<span><span>  &lt;/</span><span>g</span><span>&gt;</span></span>
<span><span>&lt;/</span><span>svg</span><span>&gt;</span></span>
<span></span></code></pre>
<p>Add animation.</p>
<svg viewBox="0 0 50 50"><g><rect x="0" y="0" width="50" height="10" fill="red" mask="url(#animated_line)" style="animation:to-down linear infinite 2s"></rect><mask id="animated_line"><line x1="0" y1="0" x2="0" y2="50" stroke="white" stroke-width="1"></line></mask></g></svg>

<pre tabindex="0"><code><span><span>&lt;</span><span>svg</span><span> viewBox</span><span>=</span><span>&#34;0 0 50 50&#34;</span><span> className</span><span>=</span><span>&#34;bg-neutral-900 max-w-[100px] mx-auto&#34;</span><span>&gt;</span></span>
<span><span>  &lt;</span><span>g</span><span>&gt;</span></span>
<span><span>    &lt;</span><span>rect</span></span>
<span><span>      x</span><span>=</span><span>&#34;0&#34;</span></span>
<span><span>      y</span><span>=</span><span>&#34;0&#34;</span></span>
<span><span>      width</span><span>=</span><span>&#34;50&#34;</span></span>
<span><span>      height</span><span>=</span><span>&#34;10&#34;</span></span>
<span><span>      fill</span><span>=</span><span>&#34;red&#34;</span></span>
<span><span>      mask</span><span>=</span><span>&#34;url(#animated_line)&#34;</span></span>
<span><span>      style</span><span>=</span><span>{{</span></span>
<span><span>        animation: </span><span>&#34;to-down linear infinite 2s&#34;</span><span>,</span></span>
<span><span>      }}</span></span>
<span><span>    /&gt;</span></span>
<span><span>    &lt;</span><span>mask</span><span> id</span><span>=</span><span>&#34;animated_line&#34;</span><span>&gt;</span></span>
<span><span>      &lt;</span><span>line</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;50&#34;</span><span> stroke</span><span>=</span><span>&#34;white&#34;</span><span> strokeWidth</span><span>=</span><span>&#34;1&#34;</span><span> /&gt;</span></span>
<span><span>    &lt;/</span><span>mask</span><span>&gt;</span></span>
<span><span>  &lt;/</span><span>g</span><span>&gt;</span></span>
<span><span>&lt;/</span><span>svg</span><span>&gt;</span></span>
<span></span></code></pre>
<pre tabindex="0"><code><span><span>@keyframes</span><span> to-down</span><span> {</span></span>
<span><span>  0%</span><span> {</span></span>
<span><span>    transform</span><span>: </span><span>translateY</span><span>(</span><span>-10</span><span>px</span><span>);</span></span>
<span><span>  }</span></span>
<span></span>
<span><span>  100%</span><span> {</span></span>
<span><span>    transform</span><span>: </span><span>translateY</span><span>(</span><span>50</span><span>px</span><span>);</span></span>
<span><span>  }</span></span>
<span><span>}</span></span>
<span></span></code></pre>
<p>Make styles.</p>
<svg viewBox="0 0 50 50"><g><line x1="0" y1="0" x2="0" y2="50" stroke="rgb(50,50,50)" stroke-width="2"></line><rect x="0" y="0" width="100%" height="20" fill="url(#line_color)" mask="url(#animated_line_fancy)" style="--height:20px;animation:to-down-2 linear infinite 3s"></rect><defs><linearGradient id="line_color" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stop-color="rgba(255,0,255,0.1)"></stop><stop offset="100%" stop-color="rgb(255,100,255)"></stop></linearGradient></defs><mask id="animated_line_fancy"><line x1="0" y1="0" x2="0" y2="50" stroke="white" stroke-width="2"></line></mask></g></svg>

<pre tabindex="0"><code><span><span>&lt;</span><span>svg</span><span> viewBox</span><span>=</span><span>&#34;0 0 50 50&#34;</span><span> className</span><span>=</span><span>&#34;bg-neutral-900 max-w-[100px] mx-auto&#34;</span><span>&gt;</span></span>
<span><span>  &lt;</span><span>g</span><span>&gt;</span></span>
<span><span>    &lt;</span><span>line</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;50&#34;</span><span> stroke</span><span>=</span><span>&#34;rgb(50,50,50)&#34;</span><span> strokeWidth</span><span>=</span><span>&#34;2&#34;</span><span> /&gt;</span></span>
<span><span>    &lt;</span><span>rect</span></span>
<span><span>      x</span><span>=</span><span>&#34;0&#34;</span></span>
<span><span>      y</span><span>=</span><span>&#34;0&#34;</span></span>
<span><span>      width</span><span>=</span><span>&#34;100%&#34;</span></span>
<span><span>      height</span><span>=</span><span>&#34;20&#34;</span></span>
<span><span>      fill</span><span>=</span><span>&#34;url(#line_color)&#34;</span></span>
<span><span>      mask</span><span>=</span><span>&#34;url(#animated_line_fancy)&#34;</span></span>
<span><span>      style</span><span>=</span><span>{{</span></span>
<span><span>        &#34;--height&#34;</span><span>: </span><span>&#34;20px&#34;</span><span>,</span></span>
<span><span>        animation: </span><span>&#34;to-down-2 linear infinite 3s&#34;</span><span>,</span></span>
<span><span>      }}</span></span>
<span><span>    /&gt;</span></span>
<span><span>    &lt;</span><span>defs</span><span>&gt;</span></span>
<span><span>      &lt;</span><span>linearGradient</span><span> id</span><span>=</span><span>&#34;line_color&#34;</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;1&#34;</span><span>&gt;</span></span>
<span><span>        &lt;</span><span>stop</span><span> offset</span><span>=</span><span>&#34;0%&#34;</span><span> stopColor</span><span>=</span><span>&#34;rgba(255,0,255,0.1)&#34;</span><span> /&gt;</span></span>
<span><span>        &lt;</span><span>stop</span><span> offset</span><span>=</span><span>&#34;100%&#34;</span><span> stopColor</span><span>=</span><span>&#34;rgb(255,100,255)&#34;</span><span> /&gt;</span></span>
<span><span>      &lt;/</span><span>linearGradient</span><span>&gt;</span></span>
<span><span>    &lt;/</span><span>defs</span><span>&gt;</span></span>
<span><span>    &lt;</span><span>mask</span><span> id</span><span>=</span><span>&#34;animated_line_fancy&#34;</span><span>&gt;</span></span>
<span><span>      &lt;</span><span>line</span><span> x1</span><span>=</span><span>&#34;0&#34;</span><span> y1</span><span>=</span><span>&#34;0&#34;</span><span> x2</span><span>=</span><span>&#34;0&#34;</span><span> y2</span><span>=</span><span>&#34;50&#34;</span><span> stroke</span><span>=</span><span>&#34;white&#34;</span><span> strokeWidth</span><span>=</span><span>&#34;2&#34;</span><span> /&gt;</span></span>
<span><span>    &lt;/</span><span>mask</span><span>&gt;</span></span>
<span><span>  &lt;/</span><span>g</span><span>&gt;</span></span>
<span><span>&lt;/</span><span>svg</span><span>&gt;</span></span>
<span></span></code></pre>
<pre tabindex="0"><code><span><span>@keyframes</span><span> to-down-2</span><span> {</span></span>
<span><span>  0%</span><span> {</span></span>
<span><span>    transform</span><span>: </span><span>translateY</span><span>(</span><span>calc</span><span>(</span><span>var</span><span>(</span><span>--height</span><span>) </span><span>*</span><span> -1</span><span>));</span></span>
<span><span>  }</span></span>
<span></span>
<span><span>  100%</span><span> {</span></span>
<span><span>    transform</span><span>: </span><span>translateY</span><span>(</span><span>100</span><span>%</span><span>);</span></span>
<span><span>  }</span></span>
<span><span>}</span></span>
<span></span></code></pre>
<p>Most of these similar things are using the same technique.
Mask out an animated block, putting some animations and probably designed some parts in Figma or other SVG editors.</p>
<p><a href="https://unkey.dev" target="_blank" rel="noreferrer noopener">Unkey</a>&#39;s landing page is a nice example.</p>
<a href="#clerk-toc"><h3 id="clerk-toc"><span>#</span>Clerk TOC</h3></a>
<p>I made a clerk-like style Table Of Contents (TOC) on <a href="https://fumadocs.vercel.app" target="_blank" rel="noreferrer noopener">Fumadocs</a>, you can try it out and play with the nice TOC.</p>
<div><p><img src="https://fuma-nama.vercel.app/blog/fumadocs-toc.png" alt="preview"/></p></div>
<p>To implement it, we have to render the TOC outline on server, without client-side JavaScript to make it compatible with SSR.</p>
<p>Since we&#39;re on server, we don&#39;t know the exact positions of elements.
My approach is to use <code>absolute</code> positions, render the outline as different &#34;components&#34;, and snitch them together.</p>
<p><img src="https://fuma-nama.vercel.app/blog/toc.png" alt="toc"/></p>
<p>This isn&#39;t hard, but we also want to render a highlighted part of outline where the items are active, or their corresponding heading is visible in the viewport.</p>
<p>Like:</p>
<p><img src="https://fuma-nama.vercel.app/blog/clerk-toc-highlight.png" alt="example"/></p>
<p>I&#39;ll call it the <strong>thumb</strong>. It has to be animated, so we can&#39;t just change the color of these outline components.</p>
<p><img src="https://fuma-nama.vercel.app/blog/toc-2.png" alt="toc"/></p>
<p>We cannot animate the thumb with simple CSS solutions, lucky we have the exact rendered positions of TOC items, since the thumb is meant to be interactive, it is <strong>rendered on client!</strong></p>
<p>Using the information from our browser, we can construct a &#34;mask map&#34; on client, look like this:</p>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 236"><path d="M1 0 L1 20 L13 36 L13 56 L1 72 L1 92 L13 108 L13 128 L1 144 L1 164 L1 180 L1 200 L13 216 L13 236" stroke="white" stroke-width="1" fill="none"></path></svg>
<p>The method to construct this map is <strong>SVG</strong> - yes, our old friend.</p>
<pre tabindex="0"><code><span><span>&lt;</span><span>svg</span><span> xmlns</span><span>=</span><span>&#34;http://www.w3.org/2000/svg&#34;</span><span> viewBox</span><span>=</span><span>&#34;0 0 14 236&#34;</span><span>&gt;</span></span>
<span><span>  &lt;</span><span>path</span></span>
<span><span>    d</span><span>=</span><span>&#34;M1 0 L1 20 L13 36 L13 56 L1 72 L1 92 L13 108 L13 128 L1 144 L1 164 L1 180 L1 200 L13 216 L13 236&#34;</span></span>
<span><span>    stroke</span><span>=</span><span>&#34;white&#34;</span></span>
<span><span>    strokeWidth</span><span>=</span><span>&#34;1&#34;</span></span>
<span><span>    fill</span><span>=</span><span>&#34;none&#34;</span></span>
<span><span>  /&gt;</span></span>
<span><span>&lt;/</span><span>svg</span><span>&gt;</span></span>
<span></span></code></pre>
<p>The <code>d</code> property of SVG <code>&lt;path /&gt;</code> isn&#39;t a nonsense auto-generated string, it&#39;s a list of commands.
See the <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths" target="_blank" rel="noreferrer noopener">Web Docs</a> for more details, it&#39;s quite a powerful tool.</p>
<p>With our new tool, we can tell SVG to render a line connecting each point of the outline.</p>
<p><img src="https://fuma-nama.vercel.app/blog/toc-3.png" alt="toc"/></p>
<p>This constructed a SVG that&#39;s <em>identical</em> to our original TOC outline pre-rendered on server.</p>
<p>Similar to the technique we&#39;ve learnt from Animated Wires, we can use the CSS <code>mask-image</code> property to mask an animated <code>div</code> block to render the thumb - a highlighted part of outline.</p>
<pre tabindex="0"><code><span><span>&lt;</span><span>div</span></span>
<span><span>  style</span><span>=</span><span>{{</span></span>
<span><span>    maskImage: </span><span>`url(&#34;data:image/svg+xml,${</span></span>
<span><span>      // URI encoded SVG image</span></span>
<span><span>      encodeURIComponent</span><span>(</span></span>
<span><span>        `&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 14 236&#34;&gt;...&lt;/svg&gt;`</span></span>
<span><span>      )</span></span>
<span><span>    })`</span><span>,</span></span>
<span><span>  }}</span></span>
<span><span>&gt;</span></span>
<span><span>  &lt;</span><span>div</span></span>
<span><span>    style</span><span>=</span><span>{{</span></span>
<span><span>      width: </span><span>1</span><span>,</span></span>
<span><span>      height: thumb.height,</span></span>
<span><span>      transform: </span><span>`translateY(${</span><span>thumb</span><span>.</span><span>top</span><span>}px)`</span><span>,</span></span>
<span><span>      transition: </span><span>&#34;all 500ms&#34;</span><span>,</span></span>
<span><span>      backgroundColor: </span><span>&#34;white&#34;</span><span>,</span></span>
<span><span>    }}</span></span>
<span><span>  /&gt;</span></span>
<span><span>&lt;/</span><span>div</span><span>&gt;</span></span>
<span></span></code></pre>
<p>Check the <a href="https://github.com/fuma-nama/fumadocs/blob/755554d6acbb22efcdedf31d40b1a83f54e2cf1a/packages/ui/src/components/layout/toc-clerk.tsx" target="_blank" rel="noreferrer noopener">source code</a> to see my implementation in React.js.</p>
<p>Huge thanks to Clerk for inspiring me on this, I&#39;ve never thought the TOC of a documentation site can be that interesting to play with.</p></article></div>
  </body>
</html>
