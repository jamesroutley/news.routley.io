<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://maknee.github.io/blog/2025/League-Data-Scraping/">Original</a>
    <h1>League of Legends data scraping the hard and tedious way for fun</h1>
    
    <div id="readability-page-1" class="page"><article> <div id="markdown-content">  <ul> <li>Most of the work was done a couple years back (during COVID), so significant parts may have changed since then</li> </ul>  <p>This work isn’t endorsed by Riot Games and doesn’t reflect the views or opinions of Riot Games or anyone officially involved in producing or managing League of Legends. League of Legends and Riot Games are trademarks or registered trademarks of Riot Games, Inc.</p>  <ul> <li><a href="#overview">Overview</a></li> <li><a href="#current-datasets-and-their-issues">Current Datasets And Their Issues</a></li> <li><a href="#at-10000-feet">At 10000 feet</a></li> <li><a href="#replays">Replays</a></li> <li><a href="#reverse-engineering">Reverse Engineering</a></li> <li><a href="#performance">Performance</a></li> <li><a href="#other-tidbits">Other Tidbits</a></li> <li><a href="#thoughts">Thoughts</a></li> </ul>  <p><a href="https://en.wikipedia.org/wiki/League_of_Legends" rel="external nofollow noopener" target="_blank">League of Legends</a> is one of the world’s most popular competitive games, with millions of players generating vast amounts of gameplay data daily. Basic match statistics are available, but accessing moment-by-moment gameplay data is near impossible. This article demonstrates how to create a high-fidelity dataset by reverse engineering the game engine, capturing information such as precise player positions to ability usage timings and damage calculations.</p> <p>Current League of Legends datasets and analytics tools face several limitations:</p> <ul> <li>Granularity: Most available data comes from Riot’s public APIs, which only provide aggregated statistics (total kills, gold earned, etc.) rather than detailed gameplay events</li> <li>Precision: Existing tools that sample game state often miss critical micro-interactions</li> <li>Completeness: Important gameplay elements like exact ability used, hiding in fog, positions data are missing</li> </ul> <p>Because of this third-party developers can only build basic tools and datasets. We haven’t seen announcements with regards to game-playing agents unlike other games where high fidelity data has enabled breakthoughs in reinforcement learning ~ <a href="https://openai.com/index/openai-five/" rel="external nofollow noopener" target="_blank">OpenAI5</a>, <a href="https://deepmind.google/discover/blog/alphastar-grandmaster-level-in-starcraft-ii-using-multi-agent-reinforcement-learning/" rel="external nofollow noopener" target="_blank">AlphaStar</a>.</p> <p>I built a tool that can create high fidelity datasets. It directly decrypts and processes the game’s internal replay files, but keeps the game’s native data format. It can capture precise details like ability usage, movement, and state changes at millisecond intervals and can scale efficiently.</p> <p>I’ll walk through the technical challenges involved in reverse engineering League’s proprietary game engine and replay format. These methods can be applied to similar problems in data extraction.</p> <details> <summary>Expand to show sample of data scraped from a game</summary> <div> <div><pre><code><span>{</span><span>
  </span><span>[</span><span>
    </span><span>{</span><span>
      </span><span>&#34;CreateSummoner&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>0.0</span><span>,</span><span>
        </span><span>&#34;id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>,</span><span>
        </span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;SomeUserName&#34;</span><span>,</span><span>
        </span><span>&#34;champion&#34;</span><span>:</span><span> </span><span>&#34;akali&#34;</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;CastSpell&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>10.23234</span><span>,</span><span>
        </span><span>&#34;champion_caster_id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>,</span><span>
        </span><span>&#34;spell_name&#34;</span><span>:</span><span> </span><span>&#34;AkaliE&#34;</span><span>,</span><span>
        </span><span>&#34;level&#34;</span><span>:</span><span> </span><span>1</span><span>,</span><span>
        </span><span>&#34;source_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>14045.15</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>13559.334</span><span>
        </span><span>},</span><span>
        </span><span>&#34;target_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>14400.824</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>14443.168</span><span>
        </span><span>},</span><span>
        </span><span>&#34;target_end_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>0.0</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>0.0</span><span>
        </span><span>},</span><span>
        </span><span>&#34;target_ids&#34;</span><span>:</span><span> </span><span>[],</span><span>
        </span><span>&#34;windup_time&#34;</span><span>:</span><span> </span><span>0.25</span><span>,</span><span>
        </span><span>&#34;cooldown&#34;</span><span>:</span><span> </span><span>14.5</span><span>,</span><span>
        </span><span>&#34;mana_cost&#34;</span><span>:</span><span> </span><span>30.0</span><span>,</span><span>
        </span><span>&#34;slot&#34;</span><span>:</span><span> </span><span>2</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;UpdateState&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>721.11426</span><span>,</span><span>
        </span><span>&#34;1073741859&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>[</span><span>
            </span><span>{</span><span>
              </span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;health&#34;</span><span>,</span><span>
              </span><span>&#34;data&#34;</span><span>:</span><span> </span><span>1516.6107</span><span>
            </span><span>},</span><span>
            </span><span>{</span><span>
              </span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;movement_speed&#34;</span><span>,</span><span>
              </span><span>&#34;data&#34;</span><span>:</span><span> </span><span>270.777</span><span>
            </span><span>},</span><span>
          </span><span>]</span><span>
        </span><span>}</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;BasicAttackAtTarget&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>122.12</span><span>,</span><span>
        </span><span>&#34;source_id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>,</span><span>
        </span><span>&#34;target_id&#34;</span><span>:</span><span> </span><span>1073741858</span><span>,</span><span>
        </span><span>&#34;source_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>9222.389</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>2501.3594</span><span>
        </span><span>},</span><span>
        </span><span>&#34;target_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>9266.0</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>2522.0</span><span>
        </span><span>},</span><span>
        </span><span>&#34;slot&#34;</span><span>:</span><span> </span><span>49</span><span>,</span><span>
        </span><span>&#34;spell_name&#34;</span><span>:</span><span> </span><span>&#34;AkaliP&#34;</span><span>,</span><span>
        </span><span>&#34;level&#34;</span><span>:</span><span> </span><span>0</span><span>,</span><span>
        </span><span>&#34;target_end_position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>0.0</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>0.0</span><span>
        </span><span>},</span><span>
        </span><span>&#34;target_ids&#34;</span><span>:</span><span> </span><span>[</span><span>
          </span><span>1073741858</span><span>
        </span><span>],</span><span>
        </span><span>&#34;windup_time&#34;</span><span>:</span><span> </span><span>1.3504388</span><span>,</span><span>
        </span><span>&#34;cooldown&#34;</span><span>:</span><span> </span><span>0.0</span><span>,</span><span>
        </span><span>&#34;mana_cost&#34;</span><span>:</span><span> </span><span>0.0</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;CreateEntity&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>722.9974</span><span>,</span><span>
        </span><span>&#34;id&#34;</span><span>:</span><span> </span><span>1073770044</span><span>,</span><span>
        </span><span>&#34;position&#34;</span><span>:</span><span> </span><span>{</span><span>
          </span><span>&#34;x&#34;</span><span>:</span><span> </span><span>9326.244</span><span>,</span><span>
          </span><span>&#34;z&#34;</span><span>:</span><span> </span><span>2522.7634</span><span>
        </span><span>},</span><span>
        </span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;TwilightShroud&#34;</span><span>,</span><span>
        </span><span>&#34;level&#34;</span><span>:</span><span> </span><span>1</span><span>,</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;BecomeVisibleInFogOfWar&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>862.4249</span><span>,</span><span>
        </span><span>&#34;id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>
      </span><span>}</span><span>
    </span><span>},</span><span>
    </span><span>{</span><span>
      </span><span>&#34;Death&#34;</span><span>:</span><span> </span><span>{</span><span>
        </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>860.31085</span><span>,</span><span>
        </span><span>&#34;id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>,</span><span>
      </span><span>}</span><span>
    </span><span>}</span><span>
  </span><span>]</span><span>
</span><span>}</span><span>
</span></code></pre></div> </div> </details>  <p><a href="https://en.wikipedia.org/wiki/League_of_Legends" rel="external nofollow noopener" target="_blank">League of Legends</a> is a popular <a href="https://en.wikipedia.org/wiki/Multiplayer_online_battle_arena" rel="external nofollow noopener" target="_blank">MOBA game</a>. With millions of games played daily, several companies<span></span><span><a href="https://www.backseat.gg/" rel="external nofollow noopener" target="_blank">Backseat.gg</a></span><span></span><span><a href="https://www.blitz.gg/" rel="external nofollow noopener" target="_blank">blitz.gg</a></span><span></span><span><a href="https://mobalytics.gg/lol?int_source=homepage&amp;int_medium=mainbutton" rel="external nofollow noopener" target="_blank">Mobalytics</a></span> have invested significant effort in analyzing gameplay data to improve the player experience. However, detailed, fine-grained data remains relatively hard to obtain.</p> <p>Typical data sources provide only limited, high-level information. Despite these limitations, people build basic models use this data to build basic win prediction models <span></span><span><a href="https://www.kaggle.com/code/neelkudu28/league-of-legends-win-prediction-using-pycaret" rel="external nofollow noopener" target="_blank">Kaggle</a></span> or create user interfaces for gameplay analysis<span></span><span><a href="https://mobalytics.gg/lol?int_source=homepage&amp;int_medium=mainbutton" rel="external nofollow noopener" target="_blank">Mobalytics</a></span>.</p> <p>The following section provides different ways to fetch data and what datasets exist out there. I’ll show and explain what these datasets contain.</p> <p>Most existing datasets are created by scraping recent games through the <a href="https://developer.riotgames.com/apis#match-v5/GET_getMatch" rel="external nofollow noopener" target="_blank">official RIOT matches API</a>. When provided with a match ID, this API returns a list of participating players and various game statistics and metrics.</p> <details> <summary>Expand to show match description<span></span><span>https://developer.riotgames.com/apis#match-v5/GET_getMatch</span></summary> <table> <thead> <tr> <th>Name</th> <th>Data Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>endOfGameResult</td> <td>string</td> <td>Refer to indicate if the game ended in termination.</td> </tr> <tr> <td>gameCreation</td> <td>long</td> <td>Unix timestamp for when the game is created on the game server (i.e., the loading screen).</td> </tr> <tr> <td>gameDuration</td> <td>long</td> <td>Prior to patch 11.20, this field returns the game length in milliseconds calculated from gameEndTimestamp - gameStartTimestamp. Post patch 11.20, this field returns the max timePlayed of any participant in the game in seconds.</td> </tr> <tr> <td>gameEndTimestamp</td> <td>long</td> <td>Unix timestamp for when match ends on the game server. This timestamp can occasionally be significantly longer than when the match “ends”.</td> </tr> <tr> <td>gameId</td> <td>long</td> <td> </td> </tr> <tr> <td>gameMode</td> <td>string</td> <td>Refer to the Game Constants documentation.</td> </tr> <tr> <td>gameName</td> <td>string</td> <td> </td> </tr> <tr> <td>gameStartTimestamp</td> <td>long</td> <td>Unix timestamp for when match starts on the game server.</td> </tr> <tr> <td>gameType</td> <td>string</td> <td> </td> </tr> <tr> <td>gameVersion</td> <td>string</td> <td>The first two parts can be used to determine the patch a game was played on.</td> </tr> <tr> <td>mapId</td> <td>int</td> <td>Refer to the Game Constants documentation.</td> </tr> <tr> <td>participants</td> <td>List[ParticipantDto]</td> <td> </td> </tr> <tr> <td>platformId</td> <td>string</td> <td>Platform where the match was played.</td> </tr> <tr> <td>queueId</td> <td>int</td> <td>Refer to the Game Constants documentation.</td> </tr> <tr> <td>teams</td> <td>List[TeamDto]</td> <td> </td> </tr> <tr> <td>tournamentCode</td> <td>string</td> <td>Tournament code used to generate the match. This field was added to match-v5 in patch 11.13 on June 23rd, 2021.</td> </tr> <tr> <td>allInPings</td> <td>int</td> <td>Yellow crossed swords</td> </tr> <tr> <td>assistMePings</td> <td>int</td> <td>Green flag</td> </tr> <tr> <td>assists</td> <td>int</td> <td> </td> </tr> <tr> <td>baronKills</td> <td>int</td> <td> </td> </tr> <tr> <td>bountyLevel</td> <td>int</td> <td> </td> </tr> <tr> <td>champExperience</td> <td>int</td> <td> </td> </tr> <tr> <td>champLevel</td> <td>int</td> <td> </td> </tr> <tr> <td>championId</td> <td>int</td> <td>Prior to patch 11.4, on Feb 18th, 2021, this field returned invalid championIds.</td> </tr> <tr> <td>championName</td> <td>string</td> <td> </td> </tr> <tr> <td>commandPings</td> <td>int</td> <td>Blue generic ping (ALT+click)</td> </tr> <tr> <td>championTransform</td> <td>int</td> <td>This field is currently only utilized for Kayn’s transformations. (Legal values: 0 - None, 1 - Slayer, 2 - Assassin)</td> </tr> <tr> <td>consumablesPurchased</td> <td>int</td> <td> </td> </tr> <tr> <td>challenges</td> <td>ChallengesDto</td> <td> </td> </tr> <tr> <td>damageDealtToBuildings</td> <td>int</td> <td> </td> </tr> <tr> <td>damageDealtToObjectives</td> <td>int</td> <td> </td> </tr> <tr> <td>damageDealtToTurrets</td> <td>int</td> <td> </td> </tr> <tr> <td>damageSelfMitigated</td> <td>int</td> <td> </td> </tr> <tr> <td>deaths</td> <td>int</td> <td> </td> </tr> <tr> <td>detectorWardsPlaced</td> <td>int</td> <td> </td> </tr> <tr> <td>doubleKills</td> <td>int</td> <td> </td> </tr> <tr> <td>dragonKills</td> <td>int</td> <td> </td> </tr> <tr> <td>eligibleForProgression</td> <td>boolean</td> <td> </td> </tr> <tr> <td>enemyMissingPings</td> <td>int</td> <td>Yellow questionmark</td> </tr> <tr> <td>enemyVisionPings</td> <td>int</td> <td>Red eyeball</td> </tr> <tr> <td>firstBloodAssist</td> <td>boolean</td> <td> </td> </tr> <tr> <td>firstBloodKill</td> <td>boolean</td> <td> </td> </tr> <tr> <td>firstTowerAssist</td> <td>boolean</td> <td> </td> </tr> <tr> <td>firstTowerKill</td> <td>boolean</td> <td> </td> </tr> <tr> <td>gameEndedInEarlySurrender</td> <td>boolean</td> <td> </td> </tr> <tr> <td>fistBumpParticipation</td> <td>int</td> <td> </td> </tr> <tr> <td>voidMonsterKill</td> <td>int</td> <td> </td> </tr> <tr> <td>abilityUses</td> <td>int</td> <td> </td> </tr> <tr> <td>acesBefore15Minutes</td> <td>int</td> <td> </td> </tr> <tr> <td>alliedJungleMonsterKills</td> <td>float</td> <td> </td> </tr> <tr> <td>baronTakedowns</td> <td>int</td> <td> </td> </tr> <tr> <td>blastConeOppositeOpponentCount</td> <td>int</td> <td> </td> </tr> <tr> <td>bountyGold</td> <td>int</td> <td> </td> </tr> <tr> <td>buffsStolen</td> <td>int</td> <td> </td> </tr> <tr> <td>completeSupportQuestInTime</td> <td>int</td> <td> </td> </tr> <tr> <td>controlWardsPlaced</td> <td>int</td> <td> </td> </tr> <tr> <td>damagePerMinute</td> <td>float</td> <td> </td> </tr> <tr> <td>damageTakenOnTeamPercentage</td> <td>float</td> <td> </td> </tr> <tr> <td>dancedWithRiftHerald</td> <td>int</td> <td> </td> </tr> <tr> <td>deathsByEnemyChamps</td> <td>int</td> <td> </td> </tr> <tr> <td>dodgeSkillShotsSmallWindow</td> <td>int</td> <td> </td> </tr> <tr> <td>doubleAces</td> <td>int</td> <td> </td> </tr> <tr> <td>dragonTakedowns</td> <td>int</td> <td> </td> </tr> <tr> <td>legendaryItemUsed</td> <td>List[int]</td> <td> </td> </tr> <tr> <td>effectiveHealAndShielding</td> <td>float</td> <td> </td> </tr> <tr> <td>elderDragonKillsWithOpposingSoul</td> <td>int</td> <td> </td> </tr> <tr> <td>elderDragonMultikills</td> <td>int</td> <td> </td> </tr> <tr> <td>enemyChampionImmobilizations</td> <td>int</td> <td> </td> </tr> <tr> <td>enemyJungleMonsterKills</td> <td>float</td> <td> </td> </tr> <tr> <td>epicMonsterKillsNearEnemyJungler</td> <td>int</td> <td> </td> </tr> <tr> <td>epicMonsterKillsWithin30SecondsOfSpawn</td> <td>int</td> <td> </td> </tr> <tr> <td>epicMonsterSteals</td> <td>int</td> <td> </td> </tr> <tr> <td>epicMonsterStolenWithoutSmite</td> <td>int</td> <td> </td> </tr> <tr> <td>firstTurretKilled</td> <td>int</td> <td> </td> </tr> <tr> <td>firstTurretKilledTime</td> <td>float</td> <td> </td> </tr> <tr> <td>flawlessAces</td> <td>int</td> <td> </td> </tr> <tr> <td>fullTeamTakedown</td> <td>int</td> <td> </td> </tr> <tr> <td>gameLength</td> <td>float</td> <td> </td> </tr> </tbody> </table> </details> <p>These fields provide coarse, post-processed data from Riot, typically containing aggregate statistics like total kills, wards placed, and other cumulative events.</p> <p>The <a href="https://developer.riotgames.com/docs/lol#game-client-api_live-client-data-api" rel="external nofollow noopener" target="_blank">Live Client API (LCU)</a> offers a more detailed alternative, but requires running the game client. While it provides event timestamps (like deaths, destroyed turrets, and objective kills), it still lacks crucial data points such as player positions and ability usage timestamps.</p> <details> <summary>Expand to show LCU API json example<span></span><span>https://static.developer.riotgames.com/docs/lol/liveclientdata_sample.json</span></summary> <div> <div><pre><code><span>{</span>
  <span>&#34;</span><span>activePlayer</span><span>&#34;</span><span>:</span> <span>{</span>
    <span>&#34;</span><span>abilities</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>E</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Molten Shield</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>AnnieE</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieE_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieE_DisplayName</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>Passive</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Pyromania</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>AnniePassive</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Passive_AnniePassive_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Passive_AnniePassive_DisplayName</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>Q</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Disintegrate</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>AnnieQ</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieQ_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieQ_DisplayName</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>R</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Summon: Tibbers</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>AnnieR</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieR_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieR_DisplayName</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>W</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Incinerate</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>AnnieW</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieW_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_AnnieW_DisplayName</span><span>&#34;</span>
      <span>}</span>
    <span>},</span>
    <span>&#34;</span><span>championStats</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>abilityPower</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>armor</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>armorPenetrationFlat</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>armorPenetrationPercent</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>attackDamage</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>attackRange</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>attackSpeed</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>bonusArmorPenetrationPercent</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>bonusMagicPenetrationPercent</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>cooldownReduction</span><span>&#34;</span><span>:</span> <span>-</span><span>0.00</span><span>,</span>
      <span>&#34;</span><span>critChance</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>critDamage</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>currentHealth</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>healthRegenRate</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>lifeSteal</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>magicLethality</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>magicPenetrationFlat</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>magicPenetrationPercent</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>magicResist</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>maxHealth</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>moveSpeed</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>physicalLethality</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>resourceMax</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>resourceRegenRate</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>resourceType</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>MANA</span><span>&#34;</span><span>,</span>
      <span>&#34;</span><span>resourceValue</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
      <span>&#34;</span><span>spellVamp</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
      <span>&#34;</span><span>tenacity</span><span>&#34;</span><span>:</span> <span>0.0</span>
    <span>},</span>
    <span>&#34;</span><span>currentGold</span><span>&#34;</span><span>:</span> <span>0.00000000000000</span><span>,</span>
    <span>&#34;</span><span>fullRunes</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>generalRunes</span><span>&#34;</span><span>:</span> <span>[{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Electrocute</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8112</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_Electrocute</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_Electrocute</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Cheap Shot</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8126</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_CheapShot</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_CheapShot</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Eyeball Collection</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8138</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_EyeballCollection</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_EyeballCollection</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Relentless Hunter</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8105</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_8105</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_8105</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Celerity</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8234</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_Celerity</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_Celerity</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Gathering Storm</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8236</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_GatheringStorm</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_GatheringStorm</span><span>&#34;</span>
        <span>}</span>
      <span>],</span>
      <span>&#34;</span><span>keystone</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Electrocute</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8112</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_Electrocute</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_Electrocute</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>primaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Domination</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8100</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7200</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7200</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>secondaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Sorcery</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8200</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7202</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7202</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>statRunes</span><span>&#34;</span><span>:</span> <span>[{</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5008</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModAdaptive</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5003</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModMagicResist</span><span>&#34;</span>
        <span>},</span>
        <span>{</span>
          <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5003</span><span>,</span>
          <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModMagicResist</span><span>&#34;</span>
        <span>}</span>
      <span>]</span>
    <span>},</span>
    <span>&#34;</span><span>level</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
    <span>&#34;</span><span>summonerName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Riot Tuxedo</span><span>&#34;</span>
  <span>},</span>
  <span>&#34;</span><span>allPlayers</span><span>&#34;</span><span>:</span> <span>[{</span>
    <span>&#34;</span><span>championName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Annie</span><span>&#34;</span><span>,</span>
    <span>&#34;</span><span>isBot</span><span>&#34;</span><span>:</span> <span>false</span><span>,</span>
    <span>&#34;</span><span>isDead</span><span>&#34;</span><span>:</span> <span>false</span><span>,</span>
    <span>&#34;</span><span>items</span><span>&#34;</span><span>:</span> <span>[],</span>
    <span>&#34;</span><span>level</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
    <span>&#34;</span><span>position</span><span>&#34;</span><span>:</span> <span>&#34;&#34;</span><span>,</span>
    <span>&#34;</span><span>rawChampionName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>game_character_displayname_Annie</span><span>&#34;</span><span>,</span>
    <span>&#34;</span><span>respawnTimer</span><span>&#34;</span><span>:</span> <span>0.0</span><span>,</span>
    <span>&#34;</span><span>runes</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>keystone</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Electrocute</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8112</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_Electrocute</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_Electrocute</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>primaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Domination</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8100</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7200</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7200</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>secondaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Sorcery</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8200</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7202</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7202</span><span>&#34;</span>
      <span>}</span>
    <span>},</span>
    <span>&#34;</span><span>scores</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>assists</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
      <span>&#34;</span><span>creepScore</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
      <span>&#34;</span><span>deaths</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
      <span>&#34;</span><span>kills</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
      <span>&#34;</span><span>wardScore</span><span>&#34;</span><span>:</span> <span>0.0</span>
    <span>},</span>
    <span>&#34;</span><span>skinID</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
    <span>&#34;</span><span>summonerName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Riot Tuxedo</span><span>&#34;</span><span>,</span>
    <span>&#34;</span><span>summonerSpells</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>summonerSpellOne</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Flash</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_SummonerSpell_SummonerFlash_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_SummonerSpell_SummonerFlash_DisplayName</span><span>&#34;</span>
      <span>},</span>
      <span>&#34;</span><span>summonerSpellTwo</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Ignite</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_SummonerSpell_SummonerDot_Description</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_SummonerSpell_SummonerDot_DisplayName</span><span>&#34;</span>
      <span>}</span>
    <span>},</span>
    <span>&#34;</span><span>team</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>ORDER</span><span>&#34;</span>
  <span>}],</span>
  <span>&#34;</span><span>events</span><span>&#34;</span><span>:</span> <span>{</span>
    <span>&#34;</span><span>Events</span><span>&#34;</span><span>:</span> <span>[{</span>
      <span>&#34;</span><span>EventID</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
      <span>&#34;</span><span>EventName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GameStart</span><span>&#34;</span><span>,</span>
      <span>&#34;</span><span>EventTime</span><span>&#34;</span><span>:</span> <span>0.00000000000000000</span>
    <span>}]</span>
  <span>},</span>
  <span>&#34;</span><span>gameData</span><span>&#34;</span><span>:</span> <span>{</span>
    <span>&#34;</span><span>gameMode</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>CLASSIC</span><span>&#34;</span><span>,</span>
    <span>&#34;</span><span>gameTime</span><span>&#34;</span><span>:</span> <span>0.000000000</span><span>,</span>
    <span>&#34;</span><span>mapName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Map11</span><span>&#34;</span><span>,</span>
    <span>&#34;</span><span>mapNumber</span><span>&#34;</span><span>:</span> <span>11</span><span>,</span>
    <span>&#34;</span><span>mapTerrain</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Default</span><span>&#34;</span>
  <span>}</span>
<span>}</span>
</code></pre></div> </div> </details> <p>The Live Client API provides more granular data than the Match API by including timestamps for key events like deaths, turret destructions, and objective kills. However, it still lacks crucial gameplay details such as player positions, ability usage, and combat interactions.</p> <p>Several public datasets are available, with Kaggle being a prominent source. A <a href="https://www.kaggle.com/code/servietsky/league-of-legends-what-to-do-in-first-10-min#1.-Libraries-for-Fun-" rel="external nofollow noopener" target="_blank">popular Kaggle example</a> demonstrates typical data granularity ~ per-game totals (dragon/baron kills, champion kills, wards placed), and per-minute metrics (CS/gold rates). These datasets generally rely on the RIOT Match API, inheriting its limitations.</p> <details> <summary>Expand to show detailed data</summary> <table> <thead> <tr> <th>gameId</th> <th>blueWins</th> <th>blueWardsPlaced</th> <th>blueWardsDestroyed</th> <th>blueFirstBlood</th> <th>blueKills</th> <th>blueDeaths</th> <th>blueAssists</th> <th>blueEliteMonsters</th> <th>blueDragons</th> <th>blueHeralds</th> <th>blueTowersDestroyed</th> <th>blueTotalGold</th> <th>blueAvgLevel</th> <th>blueTotalExperience</th> <th>blueTotalMinionsKilled</th> <th>blueTotalJungleMinionsKilled</th> <th>blueGoldDiff</th> <th>blueExperienceDiff</th> <th>blueCSPerMin</th> <th>blueGoldPerMin</th> <th>redWardsPlaced</th> <th>redWardsDestroyed</th> <th>redFirstBlood</th> <th>redKills</th> <th>redDeaths</th> <th>redAssists</th> <th>redEliteMonsters</th> <th>redDragons</th> <th>redHeralds</th> <th>redTowersDestroyed</th> <th>redTotalGold</th> <th>redAvgLevel</th> <th>redTotalExperience</th> <th>redTotalMinionsKilled</th> <th>redTotalJungleMinionsKilled</th> <th>redGoldDiff</th> <th>redExperienceDiff</th> <th>redCSPerMin</th> <th>redGoldPerMin</th> </tr> </thead> <tbody> <tr> <td>4519157822</td> <td>0</td> <td>28</td> <td>2</td> <td>1</td> <td>9</td> <td>6</td> <td>11</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>17210</td> <td>6.6</td> <td>17039</td> <td>195</td> <td>36</td> <td>643</td> <td>-8</td> <td>19.5</td> <td>1721.0</td> <td>15</td> <td>6</td> <td>0</td> <td>6</td> <td>9</td> <td>8</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16567</td> <td>6.8</td> <td>17047</td> <td>197</td> <td>55</td> <td>-643</td> <td>8</td> <td>19.7</td> <td>1656.7</td> </tr> <tr> <td>4523371949</td> <td>0</td> <td>12</td> <td>1</td> <td>0</td> <td>5</td> <td>5</td> <td>5</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>14712</td> <td>6.6</td> <td>16265</td> <td>174</td> <td>43</td> <td>-2908</td> <td>-1173</td> <td>17.4</td> <td>1471.2</td> <td>12</td> <td>1</td> <td>1</td> <td>5</td> <td>5</td> <td>2</td> <td>2</td> <td>1</td> <td>1</td> <td>1</td> <td>17620</td> <td>6.8</td> <td>17438</td> <td>240</td> <td>52</td> <td>2908</td> <td>1173</td> <td>24.0</td> <td>1762.0</td> </tr> <tr> <td>4521474530</td> <td>0</td> <td>15</td> <td>0</td> <td>0</td> <td>7</td> <td>11</td> <td>4</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>16113</td> <td>6.4</td> <td>16221</td> <td>186</td> <td>46</td> <td>-1172</td> <td>-1033</td> <td>18.6</td> <td>1611.3</td> <td>15</td> <td>3</td> <td>1</td> <td>11</td> <td>7</td> <td>14</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>17285</td> <td>6.8</td> <td>17254</td> <td>203</td> <td>28</td> <td>1172</td> <td>1033</td> <td>20.3</td> <td>1728.5</td> </tr> <tr> <td>4524384067</td> <td>0</td> <td>43</td> <td>1</td> <td>0</td> <td>4</td> <td>5</td> <td>5</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>15157</td> <td>7.0</td> <td>17954</td> <td>201</td> <td>55</td> <td>-1321</td> <td>-7</td> <td>20.1</td> <td>1515.7</td> <td>15</td> <td>2</td> <td>1</td> <td>5</td> <td>4</td> <td>10</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16478</td> <td>7.0</td> <td>17961</td> <td>235</td> <td>47</td> <td>1321</td> <td>7</td> <td>23.5</td> <td>1647.8</td> </tr> <tr> <td>4436033771</td> <td>0</td> <td>75</td> <td>4</td> <td>0</td> <td>6</td> <td>6</td> <td>6</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16400</td> <td>7.0</td> <td>18543</td> <td>210</td> <td>57</td> <td>-1004</td> <td>230</td> <td>21.0</td> <td>1640.0</td> <td>17</td> <td>2</td> <td>1</td> <td>6</td> <td>6</td> <td>7</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>17404</td> <td>7.0</td> <td>18313</td> <td>225</td> <td>67</td> <td>1004</td> <td>-230</td> <td>22.5</td> <td>1740.4</td> </tr> <tr> <td>4475365709</td> <td>1</td> <td>18</td> <td>0</td> <td>0</td> <td>5</td> <td>3</td> <td>6</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>15899</td> <td>7.0</td> <td>18161</td> <td>225</td> <td>42</td> <td>698</td> <td>101</td> <td>22.5</td> <td>1589.9</td> <td>36</td> <td>5</td> <td>1</td> <td>3</td> <td>5</td> <td>2</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>15201</td> <td>7.0</td> <td>18060</td> <td>221</td> <td>59</td> <td>-698</td> <td>-101</td> <td>22.1</td> <td>1520.1</td> </tr> <tr> <td>4493010632</td> <td>1</td> <td>18</td> <td>3</td> <td>1</td> <td>7</td> <td>6</td> <td>7</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>16874</td> <td>6.8</td> <td>16967</td> <td>225</td> <td>53</td> <td>2411</td> <td>1563</td> <td>22.5</td> <td>1687.4</td> <td>57</td> <td>1</td> <td>0</td> <td>6</td> <td>7</td> <td>9</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>14463</td> <td>6.4</td> <td>15404</td> <td>164</td> <td>35</td> <td>-2411</td> <td>-1563</td> <td>16.4</td> <td>1446.3</td> </tr> <tr> <td>4496759358</td> <td>0</td> <td>16</td> <td>2</td> <td>0</td> <td>5</td> <td>13</td> <td>3</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>15305</td> <td>6.4</td> <td>16138</td> <td>209</td> <td>48</td> <td>-2615</td> <td>-800</td> <td>20.9</td> <td>1530.5</td> <td>15</td> <td>0</td> <td>1</td> <td>13</td> <td>5</td> <td>11</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>17920</td> <td>6.6</td> <td>16938</td> <td>157</td> <td>54</td> <td>2615</td> <td>800</td> <td>15.7</td> <td>1792.0</td> </tr> <tr> <td>4443048030</td> <td>0</td> <td>16</td> <td>3</td> <td>0</td> <td>7</td> <td>7</td> <td>8</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16401</td> <td>7.2</td> <td>18527</td> <td>189</td> <td>61</td> <td>-1979</td> <td>-771</td> <td>18.9</td> <td>1640.1</td> <td>15</td> <td>2</td> <td>1</td> <td>7</td> <td>7</td> <td>5</td> <td>2</td> <td>1</td> <td>1</td> <td>0</td> <td>18380</td> <td>7.2</td> <td>19298</td> <td>240</td> <td>53</td> <td>1979</td> <td>771</td> <td>24.0</td> <td>1838.0</td> </tr> <tr> <td>4509433346</td> <td>1</td> <td>13</td> <td>1</td> <td>1</td> <td>4</td> <td>5</td> <td>5</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>15057</td> <td>6.8</td> <td>16805</td> <td>220</td> <td>39</td> <td>-1548</td> <td>-1574</td> <td>22.0</td> <td>1505.7</td> <td>16</td> <td>2</td> <td>0</td> <td>5</td> <td>4</td> <td>4</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16605</td> <td>6.8</td> <td>18379</td> <td>247</td> <td>43</td> <td>1548</td> <td>1574</td> <td>24.7</td> <td>1660.5</td> </tr> <tr> <td>4452162573</td> <td>0</td> <td>20</td> <td>3</td> <td>1</td> <td>4</td> <td>4</td> <td>6</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>15474</td> <td>6.6</td> <td>16611</td> <td>231</td> <td>28</td> <td>331</td> <td>-1585</td> <td>23.1</td> <td>1547.4</td> <td>15</td> <td>2</td> <td>0</td> <td>4</td> <td>4</td> <td>5</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>15143</td> <td>7.2</td> <td>18196</td> <td>216</td> <td>51</td> <td>-331</td> <td>1585</td> <td>21.6</td> <td>1514.3</td> </tr> <tr> <td>4453038156</td> <td>0</td> <td>33</td> <td>2</td> <td>1</td> <td>11</td> <td>11</td> <td>7</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>16695</td> <td>7.0</td> <td>18507</td> <td>157</td> <td>40</td> <td>-1505</td> <td>-635</td> <td>15.7</td> <td>1669.5</td> <td>17</td> <td>1</td> <td>0</td> <td>11</td> <td>11</td> <td>9</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>18200</td> <td>7.0</td> <td>19142</td> <td>188</td> <td>52</td> <td>1505</td> <td>635</td> <td>18.8</td> <td>1820.0</td> </tr> <tr> <td>4515594785</td> <td>1</td> <td>18</td> <td>1</td> <td>1</td> <td>7</td> <td>1</td> <td>11</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>17865</td> <td>7.4</td> <td>19102</td> <td>238</td> <td>53</td> <td>3274</td> <td>1659</td> <td>23.8</td> <td>1786.5</td> <td>12</td> <td>1</td> <td>0</td> <td>1</td> <td>7</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>14591</td> <td>6.8</td> <td>17443</td> <td>240</td> <td>50</td> <td>-3274</td> <td>-1659</td> <td>24.0</td> <td>1459.1</td> </tr> <tr> <td>4524924257</td> <td>0</td> <td>14</td> <td>3</td> <td>0</td> <td>4</td> <td>9</td> <td>1</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>14979</td> <td>6.6</td> <td>17213</td> <td>210</td> <td>52</td> <td>-3414</td> <td>-1141</td> <td>21.0</td> <td>1497.9</td> <td>20</td> <td>3</td> <td>1</td> <td>9</td> <td>4</td> <td>11</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>18393</td> <td>7.2</td> <td>18354</td> <td>229</td> <td>51</td> <td>3414</td> <td>1141</td> <td>22.9</td> <td>1839.3</td> </tr> <tr> <td>4516505202</td> <td>1</td> <td>15</td> <td>3</td> <td>1</td> <td>4</td> <td>4</td> <td>4</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>15722</td> <td>6.8</td> <td>17896</td> <td>224</td> <td>51</td> <td>-470</td> <td>-187</td> <td>22.4</td> <td>1572.2</td> <td>102</td> <td>1</td> <td>0</td> <td>4</td> <td>4</td> <td>3</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16192</td> <td>7.0</td> <td>18083</td> <td>242</td> <td>48</td> <td>470</td> <td>187</td> <td>24.2</td> <td>1619.2</td> </tr> <tr> <td>4482120064</td> <td>0</td> <td>17</td> <td>1</td> <td>0</td> <td>3</td> <td>7</td> <td>3</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>15015</td> <td>6.8</td> <td>16974</td> <td>209</td> <td>53</td> <td>-1996</td> <td>-1804</td> <td>20.9</td> <td>1501.5</td> <td>18</td> <td>3</td> <td>1</td> <td>7</td> <td>3</td> <td>13</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>17011</td> <td>7.2</td> <td>18778</td> <td>237</td> <td>51</td> <td>1996</td> <td>1804</td> <td>23.7</td> <td>1701.1</td> </tr> <tr> <td>4523758462</td> <td>1</td> <td>14</td> <td>1</td> <td>1</td> <td>10</td> <td>2</td> <td>8</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>19733</td> <td>7.6</td> <td>20862</td> <td>263</td> <td>56</td> <td>5228</td> <td>3378</td> <td>26.3</td> <td>1973.3</td> <td>13</td> <td>2</td> <td>0</td> <td>2</td> <td>10</td> <td>2</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>14505</td> <td>6.8</td> <td>17484</td> <td>210</td> <td>64</td> <td>-5228</td> <td>-3378</td> <td>21.0</td> <td>1450.5</td> </tr> <tr> <td>4503636905</td> <td>0</td> <td>43</td> <td>3</td> <td>0</td> <td>3</td> <td>7</td> <td>3</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>14852</td> <td>6.8</td> <td>16888</td> <td>203</td> <td>54</td> <td>-1975</td> <td>-1345</td> <td>20.3</td> <td>1485.2</td> <td>17</td> <td>14</td> <td>1</td> <td>7</td> <td>3</td> <td>6</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16827</td> <td>6.8</td> <td>18233</td> <td>218</td> <td>53</td> <td>1975</td> <td>1345</td> <td>21.8</td> <td>1682.7</td> </tr> <tr> <td>4486384947</td> <td>1</td> <td>21</td> <td>4</td> <td>1</td> <td>5</td> <td>4</td> <td>11</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>16282</td> <td>6.8</td> <td>17378</td> <td>213</td> <td>49</td> <td>882</td> <td>512</td> <td>21.3</td> <td>1628.2</td> <td>19</td> <td>3</td> <td>0</td> <td>4</td> <td>5</td> <td>3</td> <td>2</td> <td>1</td> <td>1</td> <td>0</td> <td>15400</td> <td>6.6</td> <td>16866</td> <td>228</td> <td>52</td> <td>-882</td> <td>-512</td> <td>22.8</td> <td>1540.0</td> </tr> <tr> <td>4457103291</td> <td>0</td> <td>11</td> <td>3</td> <td>0</td> <td>5</td> <td>9</td> <td>5</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>14994</td> <td>7.0</td> <td>17924</td> <td>188</td> <td>48</td> <td>-3155</td> <td>-2773</td> <td>18.8</td> <td>1499.4</td> <td>15</td> <td>1</td> <td>1</td> <td>9</td> <td>5</td> <td>9</td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> <td> </td> </tr> </tbody> </table> </details> <p>Some third-party vendors partnered with RIOT offer additional APIs. For instance, the <a href="https://dev.overwolf.com/ow-native/reference/live-game-data-gep/supported-games/league-of-legends" rel="external nofollow noopener" target="_blank">Overwolf API</a> combines features from both RIOT APIs but doesn’t provide significant additional granularity beyond the official sources.</p> <details> <summary>Expand to show detailed data</summary> <div> <div><pre><code><span>{</span>
  <span>&#34;</span><span>info</span><span>&#34;</span><span>:</span> <span>{</span>
    <span>&#34;</span><span>live_client_data</span><span>&#34;</span><span>:</span> <span>{</span>
      <span>&#34;</span><span>active_player</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>abilities</span><span>&#34;</span><span>:</span> <span>{</span>
          <span>&#34;</span><span>E</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Stacked Deck</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>CardmasterStack</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_CardmasterStack_Description</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_CardmasterStack_DisplayName</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>Passive</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Loaded Dice</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>SecondSight</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Passive_SecondSight_Description</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Passive_SecondSight_DisplayName</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>Q</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Wild Cards</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>WildCards</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_WildCards_Description</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_WildCards_DisplayName</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>R</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Destiny</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Destiny</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_Destiny_Description</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_Destiny_DisplayName</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>W</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>abilityLevel</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Pick a Card</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>PickACard</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_PickACard_Description</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>GeneratedTip_Spell_PickACard_DisplayName</span><span>&#34;</span>
          <span>}</span>
        <span>},</span>
        <span>&#34;</span><span>championStats</span><span>&#34;</span><span>:</span> <span>{</span>
          <span>&#34;</span><span>abilityHaste</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>abilityPower</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>armor</span><span>&#34;</span><span>:</span> <span>21</span><span>,</span>
          <span>&#34;</span><span>armorPenetrationFlat</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>armorPenetrationPercent</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
          <span>&#34;</span><span>attackDamage</span><span>&#34;</span><span>:</span> <span>25</span><span>,</span>
          <span>&#34;</span><span>attackRange</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>attackSpeed</span><span>&#34;</span><span>:</span> <span>0.6510000228881836</span><span>,</span>
          <span>&#34;</span><span>bonusArmorPenetrationPercent</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
          <span>&#34;</span><span>bonusMagicPenetrationPercent</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
          <span>&#34;</span><span>cooldownReduction</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>critChance</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>critDamage</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>currentHealth</span><span>&#34;</span><span>:</span> <span>534</span><span>,</span>
          <span>&#34;</span><span>healthRegenRate</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>lifeSteal</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>magicLethality</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>magicPenetrationFlat</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>magicPenetrationPercent</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
          <span>&#34;</span><span>magicResist</span><span>&#34;</span><span>:</span> <span>30</span><span>,</span>
          <span>&#34;</span><span>maxHealth</span><span>&#34;</span><span>:</span> <span>534</span><span>,</span>
          <span>&#34;</span><span>moveSpeed</span><span>&#34;</span><span>:</span> <span>330</span><span>,</span>
          <span>&#34;</span><span>physicalLethality</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>resourceMax</span><span>&#34;</span><span>:</span> <span>333</span><span>,</span>
          <span>&#34;</span><span>resourceRegenRate</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>resourceType</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>MANA</span><span>&#34;</span><span>,</span>
          <span>&#34;</span><span>resourceValue</span><span>&#34;</span><span>:</span> <span>333</span><span>,</span>
          <span>&#34;</span><span>spellVamp</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
          <span>&#34;</span><span>tenacity</span><span>&#34;</span><span>:</span> <span>0</span>
        <span>},</span>
        <span>&#34;</span><span>currentGold</span><span>&#34;</span><span>:</span> <span>0</span><span>,</span>
        <span>&#34;</span><span>fullRunes</span><span>&#34;</span><span>:</span> <span>{</span>
          <span>&#34;</span><span>generalRunes</span><span>&#34;</span><span>:</span> <span>[</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Dark Harvest</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8128</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_DarkHarvest</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_DarkHarvest</span><span>&#34;</span>
            <span>},</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Taste of Blood</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8139</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_TasteOfBlood</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_TasteOfBlood</span><span>&#34;</span>
            <span>},</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Eyeball Collection</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8138</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_EyeballCollection</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_EyeballCollection</span><span>&#34;</span>
            <span>},</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Ravenous Hunter</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8135</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_RavenousHunter</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_RavenousHunter</span><span>&#34;</span>
            <span>},</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Presence of Mind</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8009</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_PresenceOfMind</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_PresenceOfMind</span><span>&#34;</span>
            <span>},</span>
            <span>{</span>
              <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Coup de Grace</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8014</span><span>,</span>
              <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_CoupDeGrace</span><span>&#34;</span><span>,</span>
              <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_CoupDeGrace</span><span>&#34;</span>
            <span>}</span>
          <span>],</span>
          <span>&#34;</span><span>keystone</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Dark Harvest</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8128</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_DarkHarvest</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_displayname_DarkHarvest</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>primaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Domination</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8100</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7200</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7200</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>secondaryRuneTree</span><span>&#34;</span><span>:</span> <span>{</span>
            <span>&#34;</span><span>displayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Precision</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>8000</span><span>,</span>
            <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_tooltip_7201</span><span>&#34;</span><span>,</span>
            <span>&#34;</span><span>rawDisplayName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perkstyle_displayname_7201</span><span>&#34;</span>
          <span>},</span>
          <span>&#34;</span><span>statRunes</span><span>&#34;</span><span>:</span> <span>[</span>
            <span>{</span> <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5008</span><span>,</span> <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModAdaptive</span><span>&#34;</span> <span>},</span>
            <span>{</span> <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5008</span><span>,</span> <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModAdaptive</span><span>&#34;</span> <span>},</span>
            <span>{</span> <span>&#34;</span><span>id</span><span>&#34;</span><span>:</span> <span>5003</span><span>,</span> <span>&#34;</span><span>rawDescription</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>perk_tooltip_StatModMagicResist</span><span>&#34;</span> <span>}</span>
          <span>]</span>
        <span>},</span>
        <span>&#34;</span><span>level</span><span>&#34;</span><span>:</span> <span>1</span><span>,</span>
        <span>&#34;</span><span>summonerName</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>Sh4rgaas</span><span>&#34;</span>
      <span>}</span>
    <span>}</span>
  <span>},</span>
  <span>&#34;</span><span>feature</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>live_client_data</span><span>&#34;</span>
<span>}</span>
</code></pre></div> </div> </details> <h2 id="using-the-datasets">Using The Datasets</h2> <p>Startups currently use these datasets to provide player analysis and insights. Access to more granular data would enable significantly deeper and more sophisticated analysis tools.</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/blitz.png" width="80% 50% " alt=""/> </center> <center> <em>Example of overlays provided in game (Image source: <a href="https://blitz.gg/overlays/lol" rel="external nofollow noopener" target="_blank">blitz.gg</a>) </em> </center> </center> <p>Blitz.gg that give timers and pathing for players which is pretty cool!</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/backseat_help.png" width="80% 50% " alt=""/> </center> <center> <em>AI voice suggestions (Image source: <a href="https://www.backseat.gg/#features" rel="external nofollow noopener" target="_blank">backseat.gg</a>) </em> </center> </center> <p>Some startups give AI suggestions to help with gameplay.</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/ugg_analysis.png" width="80% 50% " alt=""/> </center> <center> <em>U.GG post game analysis (Image source: <a href="https://www.u.gg/" rel="external nofollow noopener" target="_blank">u.gg</a>) </em> </center> </center> <p>Others give deep analysis to one’s gameplay.</p>  <h2 id="overview-1">Overview</h2> <p>Here’s a high level overview of the system, which I’ll describe each part in the following sections</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/league_overview.svg" width="100% 50% " alt=""/> </center> <center> <em>Overview of the system </em> </center> </center> <h2 id="replays-and-packets">Replays And Packets</h2> <p>The process begins by fetching encrypted replay files from a data source. These replays contain compressed gameplay state data that the League of Legends client uses to reconstruct game sessions for viewing. After decryption and decompression, the system processes individual encrypted packets through an emulator, which converts them into structured JSON format. The complete process and replay format are detailed in the <a href="#rofl-replay">rofl format section</a>.</p> <h2 id="emulator-and-decryption-background">Emulator And Decryption Background</h2> <p>The emulator<span></span><span>Emulator is software that runs an architecture. It’s used here to run specific parts of league of legends binary without running the entire game (useful for debugging and seeing what variables are important). An example of an emulator is <a href="https://www.unicorn-engine.org/" rel="external nofollow noopener" target="_blank">unicorn engine</a></span> inspects and debugs the League of Legends binary to handle encrypted packets. Packet data is decrypted when accessed and immediately re-encrypted afterward<span></span><span>You also might say: you still don’t need an emulator because you can figure out how decryption works and write your own code to decrypt the entire packet buffer without running an emulator. </span>.</p> <p>Here’s a simple Python example demonstrating packet decryption using XOR:</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/league_emulator_python.svg" width="100% 50% " alt=""/> </center> <center> <em>TakeDamagePacket has two fields we&#39;re interested in extracting information out of </em> </center> </center> <p>The TakeDamage packet contains two encrypted fields: the target object and damage amount. For this example, we’ll use a simple XOR operation with 0x69 to decrypt these values.</p>  <details> <summary>Expand to show code (in-case above python doesn&#39;t show)</summary> <div> <div><pre><code><span># Champion has hp and other fields
</span><span>class</span> <span>Champion</span><span>:</span>
  <span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>name</span><span>,</span> <span>id</span><span>,</span> <span>hp</span><span>):</span>
    <span>self</span><span>.</span><span>name</span> <span>=</span> <span>name</span>
    <span>self</span><span>.</span><span>id</span> <span>=</span> <span>id</span>
    <span>self</span><span>.</span><span>hp</span> <span>=</span> <span>hp</span>
    
  <span>def</span> <span>__str__</span><span>(</span><span>self</span><span>):</span>
    <span>return</span> <span>f</span><span>&#39;</span><span>{</span><span>self</span><span>.</span><span>name</span><span>}</span><span>: id [</span><span>{</span><span>self</span><span>.</span><span>id</span><span>}</span><span>] has </span><span>{</span><span>self</span><span>.</span><span>hp</span><span>}</span><span> hp remaining</span><span>\n</span><span>&#39;</span>
    
<span># Encryption/Decryption using XOR -- not real thing
</span><span>KEY</span><span>=</span><span>0x69</span>
<span>def</span> <span>decrypt</span><span>(</span><span>data</span><span>:</span> <span>bytes</span><span>)</span> <span>-&gt;</span> <span>bytes</span><span>:</span>
    <span>return</span> <span>bytes</span><span>(</span><span>data</span><span>[</span><span>i</span><span>]</span> <span>^</span> <span>KEY</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>len</span><span>(</span><span>data</span><span>)))</span>

<span>def</span> <span>encrypt</span><span>(</span><span>data</span><span>:</span> <span>bytes</span><span>)</span> <span>-&gt;</span> <span>bytes</span><span>:</span>
    <span>return</span> <span>bytes</span><span>(</span><span>data</span><span>[</span><span>i</span><span>]</span> <span>^</span> <span>KEY</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>len</span><span>(</span><span>data</span><span>)))</span>

<span>class</span> <span>TakeDamagePacket</span><span>:</span>
  <span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>buffer</span><span>):</span>
    <span>self</span><span>.</span><span>buffer</span> <span>=</span> <span>buffer</span>
  
  <span>def</span> <span>target_id_bytes</span><span>(</span><span>self</span><span>)</span> <span>-&gt;</span> <span>bytes</span><span>:</span>
    <span>return</span> <span>self</span><span>.</span><span>buffer</span><span>[</span><span>12</span><span>:</span><span>16</span><span>]</span>
    
  <span>def</span> <span>damage_bytes</span><span>(</span><span>self</span><span>)</span> <span>-&gt;</span> <span>bytes</span><span>:</span>
    <span>return</span> <span>self</span><span>.</span><span>buffer</span><span>[</span><span>16</span><span>:</span><span>20</span><span>]</span>

<span># Helper functions
</span><span>def</span> <span>convert_bytes_to_int</span><span>(</span><span>data</span><span>:</span> <span>bytes</span><span>)</span> <span>-&gt;</span> <span>int</span><span>:</span>
  <span>return</span> <span>int</span><span>.</span><span>from_bytes</span><span>(</span><span>data</span><span>,</span> <span>byteorder</span><span>=</span><span>&#39;</span><span>big</span><span>&#39;</span><span>)</span>

<span>name</span> <span>=</span> <span>&#39;</span><span>Ezreal</span><span>&#39;</span>
<span>id</span> <span>=</span> <span>10</span>
<span>hp</span> <span>=</span> <span>1000</span>
<span>ezreal</span> <span>=</span> <span>Champion</span><span>(</span><span>name</span><span>,</span> <span>id</span><span>,</span> <span>hp</span><span>)</span>
<span>print</span><span>(</span><span>ezreal</span><span>)</span>

<span># example data from rofl file...
</span><span>buffer</span> <span>=</span> <span>b</span><span>&#39;</span><span>\xeb\x9d\x65\x38\xd3\x0e\x47\xfa\xa1\x29\x13\x9b\x69\x69\x69\x63\x69\x69\x68\x45\x75\xe2\x3e\x9f\x50\xfb\xa8\x26\x1f\xc7\x47\x47\x47</span><span>&#39;</span>

<span>packet</span> <span>=</span> <span>TakeDamagePacket</span><span>(</span><span>buffer</span><span>)</span>

<span># First, check if the target is ezreal
</span>
<span># Fetch the offset in packet to target id
</span><span>encrypted_target_id_bytes</span> <span>=</span> <span>packet</span><span>.</span><span>target_id_bytes</span><span>()</span>
<span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Encrypted target id bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>encrypted_target_id_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>

<span># Decrypt the bytes and convert to int
</span><span>target_id_bytes</span> <span>=</span> <span>decrypt</span><span>(</span><span>encrypted_target_id_bytes</span><span>)</span>
<span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Decrypted target id bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>target_id_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>

<span>target_id</span> <span>=</span> <span>convert_bytes_to_int</span><span>(</span><span>target_id_bytes</span><span>)</span>
<span>print</span><span>(</span><span>f</span><span>&#39;</span><span>\n</span><span>Target id [</span><span>{</span><span>target_id</span><span>}</span><span>] == Ezreal id [</span><span>{</span><span>ezreal</span><span>.</span><span>id</span><span>}</span><span>]?</span><span>&#39;</span><span>)</span>

<span>if</span> <span>target_id</span> <span>==</span> <span>ezreal</span><span>.</span><span>id</span><span>:</span>
  <span># After access, remove variable and encrypt bytes
</span>  <span>del</span> <span>target_id</span>
  <span>target_id_bytes</span> <span>=</span> <span>encrypt</span><span>(</span><span>target_id_bytes</span><span>)</span>
  <span>print</span><span>(</span><span>&#39;</span><span>Damage target is Ezreal</span><span>\n</span><span>&#39;</span><span>)</span>
  <span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Reencrypt target id bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>target_id_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>

  <span># Ezreal took some damage
</span>  <span>encrypted_damage_bytes</span> <span>=</span> <span>packet</span><span>.</span><span>damage_bytes</span><span>()</span>
  <span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Encrypted damage bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>encrypted_damage_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>
  <span>damage_bytes</span> <span>=</span> <span>decrypt</span><span>(</span><span>encrypted_damage_bytes</span><span>)</span>
  <span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Decrypted damage bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>damage_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>
  <span>damage</span> <span>=</span> <span>convert_bytes_to_int</span><span>(</span><span>damage_bytes</span><span>)</span>

  <span>print</span><span>(</span><span>f</span><span>&#39;</span><span>\n</span><span>Oh no, id [</span><span>{</span><span>id</span><span>}</span><span>] (Ezreal) took </span><span>{</span><span>damage</span><span>}</span><span> damage!</span><span>&#39;</span><span>)</span>
  <span>ezreal</span><span>.</span><span>hp</span> <span>-=</span> <span>damage</span>
  <span>print</span><span>(</span><span>ezreal</span><span>)</span>

  <span>del</span> <span>damage</span>
  <span>damage_bytes</span> <span>=</span> <span>encrypt</span><span>(</span><span>damage_bytes</span><span>)</span>
  <span>print</span><span>(</span><span>f</span><span>&#39;</span><span>Reencrypt damage bytes[</span><span>&#39;</span> <span>+</span> <span>&#39;&#39;</span><span>.</span><span>join</span><span>(</span><span>f</span><span>&#39;</span><span>\\</span><span>x</span><span>{</span><span>b</span><span>:</span><span>02</span><span>x</span><span>}</span><span>&#39;</span> <span>for</span> <span>b</span> <span>in</span> <span>damage_bytes</span><span>)</span> <span>+</span> <span>&#39;</span><span>]</span><span>&#39;</span><span>)</span>
</code></pre></div> </div> </details> <p>Each packet field undergoes a decrypt-access-release cycle. In the TakeDamagePacket example, when checking if Ezreal is the target, the <code>id</code> field is decrypted, compared, and immediately re-encrypted and deleted. Once the comparison is complete, the decrypted reference is deleted. The same process applies to the damage field. This pattern (unintentionally) is a good defense against memory scanners<span></span><span>Memory scanners such as Cheat Engine allows reverse engineers to find determinstic values in memory and be able to trace them back to the code that modifies or reads the values. By deleting the value, it makes it harder for reverse engineers to find important values and thus, important sections of code that produces that value</span>.</p>  <h2 id="data-sources">Data sources</h2> <p>Replays files are available through the official league client or third-party websites such as <a href="https://www.op.gg/" rel="external nofollow noopener" target="_blank">op.gg</a> or <a href="https://mobalytics.gg/" rel="external nofollow noopener" target="_blank">Mobalytics</a>. The replays end in the <a href="https://dictionary.cambridge.org/us/dictionary/english/rofl" rel="external nofollow noopener" target="_blank">.rofl</a> <span></span><span>Interesting name to choose for the file extension</span>.</p> <h3 id="how-replays-are-viewed">How Replays Are Viewed</h3> <p>Players can watch replays through either the League client interface or command line.</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/replay_client.png" width="100% 50% " alt=""/> </center> <center> <em>Example of how to view a replay through the client </em> </center> </center> <h2 id="rofl-replay">ROFL Replay</h2> <p>While the ROFL replay format is undocumented, <a href="https://github.com/fraxiinus/roflxd.cs/tree/master/Rofl.Extract.Data/Models/Rofl" rel="external nofollow noopener" target="_blank">community efforts have reverse-engineered its structure</a>. Here’s a simplified version of the format:</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/league_rolf_format.svg" width="100% 50% " alt=""/> </center> <center> <em>The ROFL file format </em> </center> </center> <p>The key components are the <code>encrypted chunks</code>. Each <code>chunk</code> contains packet metadata (<code>time</code>, <code>type</code>, <code>size</code>) and encrypted packet data. While the timestamps tell us when events occur, we still need to figure out what the packets actually do.</p> <h2 id="visually-tracing-how-packets-are-used">Visually Tracing How Packets Are Used</h2> <p>To understand packet structures, we can analyze what the client must process during replay playback. Let’s examine a specific game frame:</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/replay.png" width="100% 50% " alt=""/> </center> <center> <em>Example of viewing a replay (Image source: <a href="https://na.leagueoflegends.com/en/featured/preseason-2017/replays-and-practice" rel="external nofollow noopener" target="_blank">League Of Legends</a>) </em> </center> </center> <p>Frame Analysis (Timestamp 4:02):</p> <p>There are four champions in the image.</p> <ul> <li>Jhin, champion with blue hp on bottom left</li> <li>Braum,</li> <li>Thresh,</li> <li>Ezreal,</li> </ul> <p>Two key actions are occurring:</p> <ul> <li>Jhin is taking damage (as indicated by a small red indicator of his health bar).</li> <li>Ezreal and Thresh (red health bars) moving leftward</li> </ul> <p>We should expect at least two packets:</p> <ul> <li>Damage Packet <ul> <li>Jhin’s id</li> <li>float value for damage taken</li> </ul> </li> <li>Movement packet <ul> <li>Ezreal or Thresh’s id</li> <li>X, Y, Z coordinates</li> <li>Start and end positions</li> </ul> </li> </ul> <p>These packets should align with the timestamp and visible game state. The next section will explore their detailed implementation.</p>  <h2 id="some-background">Some Background</h2> <p>League of Legends runs on a custom game engine developed in <a href="(https://en.wikipedia.org/wiki/League_of_Legends)">2009</a>. At that time, Unreal Engine was the primary commercial option, as Unity hadn’t yet emerged. This means we’re working with a closed-source game engine.</p> <p>While RIOT’s technical blogs offer insights into their engine<span><a href="https://technology.riotgames.com/news/future-leagues-engine" rel="external nofollow noopener" target="_blank">Planning a future game engine for league which discusses the issues with the current game engine</a></span><span></span><span><a href="https://technology.riotgames.com/news/trip-down-lol-graphics-pipeline" rel="external nofollow noopener" target="_blank">Graphics pipeline</a></span>, they don’t reveal the implementation details we need.</p> <p>Our analysis focuses on the I/O and networking layers where packet processing occurs. We’re particularly interested in the pipeline<span></span><span>In this context, a pipeline as a process that takes an input, transforms the input and splits out an output</span> that transforms raw packet data into game state:</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/league_packet_to_game_state.svg" width="100% 50% " alt=""/> </center> <center> <em>A stream of packets flows through a game engine to update game state </em> </center> </center> <h2 id="packet-processing">Packet Processing</h2> <p>Packets are done in 3 steps:</p> <ul> <li>Memory Allocation (<code>Packet::Packet</code>) <ul> <li>Sets up packet metadata</li> <li>Allocates space for packet data</li> </ul> </li> <li>Deserialization (<code>DeserializePacket</code>) <ul> <li>Converts chunk data to in-memory representation</li> <li>Extracts some information from the chunk data as packet fields</li> </ul> </li> <li>Game State Update (<code>UsePacket</code>) <ul> <li>Applies packet data to game state</li> </ul> </li> </ul> <div><div><pre><code><span>GameState</span> <span>game_state</span><span>;</span>

<span>int</span> <span>ParseBufferAndUpdateGameState</span><span>(</span><span>char</span><span>*</span> <span>buffer</span><span>,</span> <span>uint64_t</span> <span>buffer_size</span><span>)</span>
<span>{</span>
  <span>// Read the packet type from the buffer</span>
  <span>uint16_t</span> <span>packet_type</span> <span>=</span> <span>*</span><span>(</span><span>uint16_t</span><span>*</span><span>)</span><span>buffer</span><span>;</span>

  <span>// Allocate an empty packet data structure</span>
  <span>Packet</span> <span>packet</span><span>(</span><span>packet_type</span><span>);</span>

  <span>// Parse buffer into packet data structure</span>
  <span>int</span> <span>status_ok</span> <span>=</span> <span>packet</span><span>.</span><span>deserialize</span><span>(</span><span>buffer</span><span>,</span> <span>buffer_size</span><span>);</span>

  <span>// Update game state with packet</span>
  <span>if</span> <span>(</span><span>status_ok</span><span>)</span>
    <span>game_state</span><span>.</span><span>use_packet</span><span>(</span><span>&amp;</span><span>packet</span><span>);</span>

  <span>// At this point, the packet is deallocated,</span>
  <span>// invoking the destructor Packet::~Packet()</span>
  <span>return</span> <span>status_ok</span><span>;</span>
<span>}</span>
</code></pre></div></div> <p>Here’s an example of <code>TakeDamagePacket</code>’s DeserializePacket function</p> <div><div><pre><code><span>enum</span> <span>PacketType</span> <span>:</span> <span>uint16_t</span>
<span>{</span>
  <span>TAKE_DAMAGE</span> <span>=</span> <span>0x2385</span><span>,</span>
<span>};</span>

<span>struct</span> <span>TakeDamagePacket</span> <span>:</span> <span>public</span> <span>Packet</span>
<span>{</span>
  <span>PacketType</span> <span>packet_type</span><span>;</span>
  <span>char</span><span>*</span> <span>data</span><span>;</span> <span>// To be parsed later by game state (this contains the source and target id and how much damage was applied)</span>
  <span>int</span> <span>expected_size</span> <span>=</span> <span>12</span><span>;</span> <span>// Should expect this left in the buffer</span>
  <span>bool</span> <span>flag1</span> <span>=</span> <span>false</span><span>;</span> <span>// Other misc data parsed</span>
<span>}</span>

<span>virtual</span> <span>bool</span> <span>TakeDamagePacket</span><span>::</span><span>deserialize</span><span>(</span><span>char</span><span>*</span> <span>buffer</span><span>,</span> <span>uint64_t</span> <span>buffer_size</span><span>)</span>
<span>{</span>
  <span>// Skip the packet type from buffer</span>
  <span>char</span><span>*</span> <span>start_buffer</span> <span>=</span> <span>buffer</span> <span>+</span> <span>sizeof</span><span>(</span><span>PacketType</span><span>);</span>

  <span>// Check if buffer has enough size to read into this packet</span>
  <span>if</span> <span>(</span><span>buffer_size</span> <span>-</span> <span>sizeof</span><span>(</span><span>PacketType</span><span>)</span> <span>&lt;</span> <span>expected_size</span><span>)</span>
  <span>{</span>
    <span>return</span> <span>false</span><span>;</span>
  <span>}</span>

  <span>// Copy the data over</span>
  <span>memcpy</span><span>(</span><span>this</span><span>-&gt;</span><span>data</span><span>,</span> <span>start_buffer</span><span>,</span> <span>this</span><span>-&gt;</span><span>expected_size</span><span>);</span>

  <span>// See if certain flag is set</span>
  <span>if</span> <span>(</span><span>start_buffer</span><span>[</span><span>3</span><span>]</span> <span>==</span> <span>79</span><span>)</span>
    <span>this</span><span>-&gt;</span><span>flag1</span> <span>=</span> <span>true</span><span>;</span>

  <span>return</span> <span>true</span><span>;</span>
<span>}</span>
</code></pre></div></div> <details> <summary>Click to expand to see how we got to packet decompiled code</summary> <p>The first decompiled code snippet below shows the parent function that takes in the raw chunk data, instantiates a specific packet object using a factory class to make a packet object based on its type. At this point, the packet object doesn’t hold any information from the chunk data, so it deserializes the packet data called from its vtable (<code>(*(_QWORD *)packet + 8LL)(packet, &amp;v19, (char *)v6 + v4)</code>, which is <code>DeserializePacket</code>). Now, the packet object contains metadata and the chunk data. Then, it uses it by calling from its vtable again (<code>(*(_QWORD *)v11 + 16LL))(v11, packet_, v20))</code>), which calls <code>UsePacket</code> to update the game state.</p> <div> <div><pre><code><span>__int64</span> <span>__fastcall</span> <span>CallPacketsInOrder</span><span>(</span><span>__int64</span> <span>a1</span><span>,</span> <span>__int16</span> <span>**</span><span>raw_data</span><span>,</span> <span>__int64</span> <span>a3</span><span>,</span> <span>double</span> <span>a4</span><span>)</span>
<span>{</span>
  <span>__int64</span> <span>packet</span><span>;</span> <span>// [rsp+18h] [rbp-38h] BYREF</span>
  <span>__int16</span> <span>packet_type</span><span>;</span> <span>// [rsp+24h] [rbp-2Ch] BYREF</span>

  <span>packet_type</span> <span>=</span> <span>**</span><span>raw_data</span><span>;</span>
  <span>Packet</span><span>::</span><span>Packet</span><span>(</span><span>&amp;</span><span>packet</span><span>,</span> <span>(</span><span>unsigned</span> <span>__int16</span><span>)</span><span>packet_type</span><span>);</span><span>// Packet::Packet(&amp;packet, packet_type);</span>
  <span>if</span> <span>(</span> <span>!</span><span>packet</span> <span>)</span>
    <span>return</span> <span>0</span><span>;</span>
  <span>v7</span> <span>=</span> <span>(</span><span>*</span><span>(</span><span>__int64</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>,</span> <span>__int16</span> <span>**</span><span>,</span> <span>char</span> <span>*</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>packet</span> <span>+</span> <span>8LL</span><span>))(</span><span>packet</span><span>,</span> <span>&amp;</span><span>v19</span><span>,</span> <span>(</span><span>char</span> <span>*</span><span>)</span><span>v6</span> <span>+</span> <span>v4</span><span>);</span><span>// Calls Packet::Deserialize from packet&#39;s vtable</span>
  <span>packet_</span> <span>=</span> <span>packet</span><span>;</span>
  <span>*</span><span>(</span><span>double</span> <span>*</span><span>)(</span><span>a1</span> <span>+</span> <span>688</span><span>)</span> <span>=</span> <span>v20</span><span>;</span>
  <span>...</span>
          <span>v11</span> <span>=</span> <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>a1</span> <span>+</span> <span>696</span><span>)</span> <span>+</span> <span>8</span> <span>*</span> <span>v10</span><span>);</span>
          <span>v12</span> <span>=</span> <span>(</span><span>*</span><span>(</span><span>__int64</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>,</span> <span>__int64</span><span>,</span> <span>double</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v11</span> <span>+</span> <span>16LL</span><span>))(</span><span>v11</span><span>,</span> <span>packet_</span><span>,</span> <span>v20</span><span>);</span><span>// Calling UsePacket from Packet&#39;s VTable</span>
  <span>...</span>
  <span>if</span> <span>(</span> <span>packet</span> <span>)</span>
    <span>(</span><span>*</span><span>(</span><span>void</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>packet</span> <span>+</span> <span>32LL</span><span>))(</span><span>packet</span><span>);</span> <span>// Call destructor to packet</span>
  <span>return</span> <span>v7</span><span>;</span>
<span>}</span>
</code></pre></div> </div> <h3 id="decompiled-packet-code">Decompiled Packet Code</h3> <details> <summary>Expand to show decompiled code for allocating memory</summary> <div> <div><pre><code><span>int64</span> <span>*</span><span>fastcall</span> <span>Packet</span><span>::</span><span>Packet</span><span>(</span><span>PacketStruct</span> <span>*</span><span>packet</span><span>,</span> <span>int</span> <span>packet_type</span><span>)</span>
<span>{</span>
  <span>switch</span> <span>(</span> <span>a2</span> <span>)</span>
  <span>{</span>
    <span>case</span> <span>2</span><span>:</span>
      <span>v4</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0xEuLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>2</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>v5</span> <span>=</span> <span>off_101BECE88</span><span>;</span>
      <span>goto</span> <span>LABEL_639</span><span>;</span>
    <span>case</span> <span>3</span><span>:</span>
      <span>v101</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0x28uLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v101</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>3</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v101</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v101</span> <span>=</span> <span>off_101BED530</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v101</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>0LL</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v101</span> <span>+</span> <span>24</span><span>)</span> <span>=</span> <span>0LL</span><span>;</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v101</span> <span>+</span> <span>32</span><span>)</span> <span>=</span> <span>-</span><span>22610</span><span>;</span>
      <span>*</span><span>packet</span> <span>=</span> <span>v101</span><span>;</span>
      <span>return</span> <span>packet</span><span>;</span>
    <span>case</span> <span>5</span><span>:</span>
      <span>v4</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0x20uLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>5</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>v31</span> <span>=</span> <span>off_101BEA880</span><span>;</span>
      <span>goto</span> <span>LABEL_578</span><span>;</span>
    <span>case</span> <span>9</span><span>:</span>
      <span>v4</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0x20uLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>9</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>v31</span> <span>=</span> <span>off_101BE9618</span><span>;</span>
      <span>goto</span> <span>LABEL_578</span><span>;</span>
    <span>case</span> <span>10</span><span>:</span>
      <span>v4</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0xEuLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>10</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v4</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>v5</span> <span>=</span> <span>off_101BECF80</span><span>;</span>
      <span>goto</span> <span>LABEL_639</span><span>;</span>
    <span>case</span> <span>11</span><span>:</span>
      <span>v381</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0x1CuLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v381</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>11</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v381</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v381</span> <span>=</span> <span>off_101BEDDC0</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v381</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>0xE7E7E7E7E7E7E7E7LL</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v381</span> <span>+</span> <span>24</span><span>)</span> <span>=</span> <span>-</span><span>404232217</span><span>;</span>
      <span>*</span><span>packet</span> <span>=</span> <span>v381</span><span>;</span>
      <span>return</span> <span>packet</span><span>;</span>
    <span>case</span> <span>12</span><span>:</span>
      <span>v6</span> <span>=</span> <span>operator</span> <span>new</span><span>(</span><span>0x38uLL</span><span>);</span>
      <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>12</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>0</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v6</span> <span>=</span> <span>off_101BEEA98</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>off_101BEEA60</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>24</span><span>)</span> <span>=</span> <span>320017171</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>32</span><span>)</span> <span>=</span> <span>0xBBBBBBBBBBBBBBBBLL</span><span>;</span>
      <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>40</span><span>)</span> <span>=</span> <span>0xCECECECE2E2E2E2ELL</span><span>;</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v6</span> <span>+</span> <span>48</span><span>)</span> <span>=</span> <span>-</span><span>235802127</span><span>;</span>
      <span>*</span><span>packet</span> <span>=</span> <span>v6</span><span>;</span>
      <span>return</span> <span>a1</span><span>;</span>
</code></pre></div> </div> </details> <details> <summary>Expand to show decompiled code for decrypting packet</summary> <div> <div><pre><code><span>char</span> <span>__fastcall</span> <span>DeserializePacket</span><span>(</span><span>Packet</span><span>*</span> <span>packet</span><span>,</span> <span>unsigned</span> <span>__int64</span> <span>*</span><span>a2</span><span>,</span> <span>unsigned</span> <span>__int64</span> <span>a3</span><span>)</span>
<span>{</span>
  <span>v3</span> <span>=</span> <span>*</span><span>a2</span><span>;</span>
  <span>if</span> <span>(</span> <span>a3</span> <span>-</span> <span>*</span><span>a2</span> <span>&lt;</span> <span>6</span> <span>)</span>
    <span>return</span> <span>0</span><span>;</span>
  <span>v5</span> <span>=</span> <span>a2</span><span>;</span>
  <span>v6</span> <span>=</span> <span>packet</span><span>;</span>
  <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>8</span><span>)</span> <span>=</span> <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)</span><span>v3</span><span>;</span>
  <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>10</span><span>)</span> <span>=</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>v3</span> <span>+</span> <span>2</span><span>);</span>
  <span>v7</span> <span>=</span> <span>(</span><span>__int16</span> <span>*</span><span>)</span><span>*</span><span>a2</span><span>;</span>
  <span>v8</span> <span>=</span> <span>(</span><span>_BYTE</span> <span>*</span><span>)(</span><span>*</span><span>a2</span> <span>+</span> <span>6</span><span>);</span>
  <span>*</span><span>a2</span> <span>=</span> <span>(</span><span>unsigned</span> <span>__int64</span><span>)</span><span>v8</span><span>;</span>
  <span>if</span> <span>(</span> <span>a3</span> <span>-</span> <span>(</span><span>unsigned</span> <span>__int64</span><span>)</span><span>v8</span> <span>&lt;</span> <span>3</span> <span>)</span>
    <span>return</span> <span>0</span><span>;</span>
  <span>*</span><span>a2</span> <span>=</span> <span>(</span><span>unsigned</span> <span>__int64</span><span>)</span><span>v7</span> <span>+</span> <span>9</span><span>;</span>
  <span>v10</span> <span>=</span> <span>86</span><span>;</span>
  <span>if</span> <span>(</span> <span>(</span><span>v7</span><span>[</span><span>3</span><span>]</span> <span>&amp;</span> <span>8</span><span>)</span> <span>==</span> <span>0</span> <span>)</span>
    <span>v10</span> <span>=</span> <span>114</span><span>;</span>
  <span>*</span><span>(</span><span>_BYTE</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>14</span><span>)</span> <span>=</span> <span>v10</span><span>;</span>
  <span>switch</span> <span>(</span> <span>(</span><span>*</span><span>((</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)</span><span>v7</span> <span>+</span> <span>7</span><span>)</span> <span>&gt;&gt;</span> <span>4</span><span>)</span> <span>&amp;</span> <span>7</span> <span>)</span>
  <span>{</span>
    <span>case</span> <span>0</span><span>:</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>-</span><span>1027423577</span><span>;</span>
      <span>goto</span> <span>LABEL_20</span><span>;</span>
    <span>case</span> <span>1</span><span>:</span>
      <span>if</span> <span>(</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>sub_100D8D2F0</span><span>(</span><span>packet</span> <span>+</span> <span>16</span><span>,</span> <span>a2</span><span>,</span> <span>a3</span><span>)</span> <span>)</span>
        <span>goto</span> <span>LABEL_20</span><span>;</span>
      <span>return</span> <span>0</span><span>;</span>
    <span>case</span> <span>2</span><span>:</span>
      <span>if</span> <span>(</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>sub_100D8CFB0</span><span>(</span><span>packet</span> <span>+</span> <span>16</span><span>,</span> <span>a2</span><span>,</span> <span>a3</span><span>)</span> <span>)</span>
        <span>goto</span> <span>LABEL_20</span><span>;</span>
      <span>return</span> <span>0</span><span>;</span>
    <span>case</span> <span>3</span><span>:</span>
      <span>if</span> <span>(</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>sub_100D8D490</span><span>(</span><span>packet</span> <span>+</span> <span>16</span><span>,</span> <span>a2</span><span>,</span> <span>a3</span><span>)</span> <span>)</span>
        <span>goto</span> <span>LABEL_20</span><span>;</span>
      <span>return</span> <span>0</span><span>;</span>
    <span>case</span> <span>4</span><span>:</span>
      <span>if</span> <span>(</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>sub_100D8D150</span><span>(</span><span>packet</span> <span>+</span> <span>16</span><span>,</span> <span>a2</span><span>,</span> <span>a3</span><span>)</span> <span>)</span>
        <span>goto</span> <span>LABEL_20</span><span>;</span>
      <span>return</span> <span>0</span><span>;</span>
    <span>case</span> <span>5</span><span>:</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>-</span><span>1027423550</span><span>;</span>
      <span>goto</span> <span>LABEL_20</span><span>;</span>
    <span>case</span> <span>6</span><span>:</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>-</span><span>1027423610</span><span>;</span>
      <span>goto</span> <span>LABEL_20</span><span>;</span>
    <span>case</span> <span>7</span><span>:</span>
      <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)</span> <span>=</span> <span>1852730990</span><span>;</span>
</code></pre></div> </div> </details> <details> <summary>Expand to show decompiled code for updating game state</summary> <div> <div><pre><code><span>__int64</span> <span>__fastcall</span> <span>UsePacket</span><span>(</span>
        <span>__int64</span> <span>a1</span><span>,</span>
        <span>__int64</span> <span>a2</span><span>,</span>
        <span>__m128</span> <span>a3</span><span>,</span>
        <span>__m128</span> <span>a4</span><span>,</span>
        <span>double</span> <span>a5</span><span>,</span>
        <span>double</span> <span>a6</span><span>,</span>
        <span>double</span> <span>a7</span><span>,</span>
        <span>double</span> <span>a8</span><span>,</span>
        <span>double</span> <span>a9</span><span>)</span>
<span>{</span>
 <span>v9</span> <span>=</span> <span>*</span><span>(</span><span>double</span> <span>*</span><span>)</span><span>&amp;</span><span>a2</span><span>;</span>
  <span>v10</span> <span>=</span> <span>1</span><span>;</span>
  <span>switch</span> <span>(</span> <span>*</span><span>(</span><span>_WORD</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>8</span><span>)</span> <span>)</span>
  <span>{</span>
    <span>case</span> <span>0xA</span><span>:</span>
      <span>sub_100384590</span><span>(</span><span>d</span><span>);</span>
      <span>return</span> <span>v10</span><span>;</span>
    <span>case</span> <span>0xE</span><span>:</span>
      <span>v564</span> <span>=</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>16</span><span>);</span>
      <span>v565</span> <span>=</span> <span>((</span><span>187</span>
             <span>-</span> <span>((</span><span>65793</span>
               <span>*</span> <span>((</span><span>2050</span>
                 <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span>
                                     <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v564</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span>
                                                                                         <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v564</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v564</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v564</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>))</span> <span>^</span> <span>0xED</span><span>)</span>
           <span>+</span> <span>244</span><span>;</span>
      <span>v566</span> <span>=</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span>
                              <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>HIBYTE</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span>
                                                                                          <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>HIBYTE</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>;</span>
      <span>v567</span> <span>=</span> <span>c</span><span>(</span>
               <span>d</span><span>,</span>
               <span>((</span><span>unsigned</span> <span>__int16</span><span>)(((</span><span>-</span><span>17664</span>
                                   <span>-</span> <span>(((</span><span>65793</span>
                                      <span>*</span> <span>((</span><span>2050</span>
                                        <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span>
                                                            <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE1</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE1</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE1</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE1</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>8</span><span>)</span> <span>&amp;</span> <span>0xFF00</span><span>))</span> <span>^</span> <span>0xED00</span><span>)</span>
                                 <span>-</span> <span>3072</span><span>)</span>
              <span>+</span> <span>((</span><span>-</span><span>1157627904</span> <span>-</span> <span>((</span><span>16843008</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v566</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v566</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>))</span> <span>&amp;</span> <span>0xFF000000</span><span>))</span> <span>^</span> <span>0xED000000</span> <span>|</span> <span>(((</span><span>12255232</span> <span>-</span> <span>((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE2</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE2</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE2</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>BYTE2</span><span>(</span><span>v564</span><span>)</span> <span>-</span> <span>86</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>^</span> <span>0xE6</span><span>))</span> <span>&amp;</span> <span>0x88440</span><span>))</span> <span>&amp;</span> <span>0xFF0000</span><span>))</span> <span>^</span> <span>0xED0000</span><span>)</span> <span>+</span> <span>15990784</span><span>)</span> <span>&amp;</span> <span>0xFF0000</span><span>)</span>
              <span>-</span> <span>201326592</span><span>)</span> <span>|</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>v565</span><span>);</span>
      <span>if</span> <span>(</span> <span>v567</span> <span>)</span>
      <span>{</span>
        <span>v568</span> <span>=</span> <span>sub_1002F12F0</span><span>(</span><span>d</span><span>,</span> <span>*</span><span>(</span><span>unsigned</span> <span>int</span> <span>*</span><span>)(</span><span>v567</span> <span>+</span> <span>16</span><span>));</span>
        <span>if</span> <span>(</span> <span>v568</span> <span>)</span>
        <span>{</span>
          <span>v569</span> <span>=</span> <span>v568</span><span>;</span>
          <span>v570</span> <span>=</span> <span>(</span><span>*</span><span>(</span><span>__int64</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v568</span> <span>+</span> <span>16LL</span><span>))(</span><span>v568</span><span>);</span>
          <span>v571</span> <span>=</span> <span>sub_1000EE9E0</span><span>();</span>
          <span>v</span> <span>=</span> <span>sub_123</span><span>(</span><span>v570</span><span>,</span> <span>v569</span><span>,</span> <span>v571</span><span>);</span>
          <span>if</span> <span>(</span> <span>v</span> <span>)</span>
            <span>(</span><span>*</span><span>(</span><span>void</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>,</span> <span>_QWORD</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>v</span> <span>+</span> <span>2960LL</span><span>))(</span>
              <span>v</span><span>,</span>
              <span>(</span><span>unsigned</span> <span>__int8</span><span>)((((</span><span>65793</span>
                                 <span>*</span> <span>((</span><span>2050</span>
                                   <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span>
                                                      <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>15</span><span>)</span> <span>&amp;</span> <span>0xAA</span><span>)</span>
                              <span>+</span> <span>(((</span><span>65793</span>
                                 <span>*</span> <span>((</span><span>2050</span>
                                   <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span>
                                                      <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>__int8</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>))</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>17</span><span>)</span> <span>&amp;</span> <span>0x55</span><span>)</span>
                              <span>+</span> <span>51</span><span>));</span>
        <span>}</span>
      <span>}</span>
      <span>return</span> <span>v10</span><span>;</span>
    <span>case</span> <span>0x14</span><span>:</span>
      <span>v27</span> <span>=</span> <span>__ROL1__</span><span>(</span><span>*</span><span>(</span><span>_BYTE</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>14</span><span>),</span> <span>5</span><span>);</span>
      <span>v28</span> <span>=</span> <span>__ROL1__</span><span>(((</span><span>v27</span> <span>&gt;&gt;</span> <span>1</span><span>)</span> <span>&amp;</span> <span>0x55</span> <span>|</span> <span>(</span><span>2</span> <span>*</span> <span>v27</span><span>)</span> <span>&amp;</span> <span>0xAA</span><span>)</span> <span>+</span> <span>50</span><span>,</span> <span>3</span><span>);</span>
      <span>sub_100384E20</span><span>(</span>
        <span>d</span><span>,</span>
        <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v28</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v28</span><span>)</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>!=</span> <span>0</span><span>);</span>
      <span>return</span> <span>v10</span><span>;</span>
    <span>case</span> <span>0x15</span><span>:</span>
      <span>sub_101153C40</span><span>();</span>
      <span>if</span> <span>(</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>24</span><span>)</span> <span>)</span>
      <span>{</span>
        <span>v930</span> <span>=</span> <span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>16</span><span>);</span>
        <span>v931</span> <span>=</span> <span>60LL</span> <span>*</span> <span>*</span><span>(</span><span>unsigned</span> <span>int</span> <span>*</span><span>)(</span><span>a2</span> <span>+</span> <span>24</span><span>);</span>
        <span>do</span>
        <span>{</span>
          <span>sub_100170F20</span><span>(</span><span>v930</span><span>);</span>
          <span>v930</span> <span>+=</span> <span>60LL</span><span>;</span>
          <span>v931</span> <span>-=</span> <span>60LL</span><span>;</span>
        <span>}</span>
        <span>while</span> <span>(</span> <span>v931</span> <span>);</span>
      <span>}</span>
      <span>sub_1001BCB10</span><span>(</span><span>0LL</span><span>);</span>
      <span>return</span> <span>v10</span><span>;</span>
</code></pre></div> </div> </details> <p>As you may notice, all three functions is composed of a big switch statement: it’s because it runs each <code>case</code> statement based on the packet type.</p> </details> <p>We’re interested in how the packet is used to update game state. Let’s take a look into that.</p> <h2 id="reading-the-packet">Reading The Packet</h2> <p>After deserialization, we still can’t directly read the packet data. The packet object maintains encrypted chunk data, only decrypting fields when they’re accessed - as explained in the <a href="#emulator-and-decrypytion-background">emulator and decryption section</a>. Let’s examine how this works in practice by analyzing the TakeDamage function, focusing on two key pieces of information that we want to extract: who is taking damage and how much damage they’ve taken.</p> <details> <summary>Click to expand to view the raw decompiled TakeDamage function</summary> <div> <div><pre><code><span>char</span> <span>__fastcall</span> <span>TakeDamage</span><span>(</span><span>__int64</span> <span>idk</span><span>,</span> <span>__int64</span> <span>packet</span><span>)</span>
<span>{</span>
  <span>v3</span> <span>=</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>);</span>
  <span>v4</span> <span>=</span> <span>HIWORD</span><span>(</span><span>v3</span><span>);</span>
  <span>v5</span> <span>=</span> <span>HIBYTE</span><span>(</span><span>v3</span><span>);</span>
  <span>LOBYTE</span><span>(</span><span>v3</span><span>)</span> <span>=</span> <span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v3</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>);</span>
  <span>v6</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span>
                                          <span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>BYTE1</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)),</span> <span>4</span><span>)],</span>
                                          <span>4</span><span>)</span>
                                      <span>-</span> <span>54</span><span>)];</span>
  <span>v7</span> <span>=</span> <span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v6</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v6</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>);</span>
  <span>v8</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v4</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>)</span> <span>-</span> <span>54</span><span>)];</span>
  <span>v9</span> <span>=</span> <span>(</span><span>2050</span> <span>*</span> <span>v8</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v8</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>;</span>
  <span>v10</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v5</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>)</span> <span>-</span> <span>54</span><span>)];</span>
  <span>target_object</span> <span>=</span> <span>GetInternalObjectFromID</span><span>(</span>
                    <span>qword_101C60850</span><span>,</span>
                    <span>(</span><span>16843008</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v10</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v10</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>))</span> <span>&amp;</span> <span>0xFF000000</span> <span>|</span> <span>(</span><span>65793</span> <span>*</span> <span>v9</span><span>)</span> <span>&amp;</span> <span>0xFF0000</span> <span>|</span> <span>(</span><span>v7</span> <span>&gt;&gt;</span> <span>8</span><span>)</span> <span>&amp;</span> <span>0xFF00</span> <span>|</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v3</span> <span>-</span> <span>54</span><span>)])</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v3</span> <span>-</span> <span>54</span><span>)])</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>));</span>
  <span>...</span>
  <span>source_object</span> <span>=</span> <span>GetInternalObjectFromID</span><span>(</span>
                    <span>qword_101C60850</span><span>,</span>
                    <span>((</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROR1__</span><span>(</span>
                                         <span>byte_1019891E0</span><span>[</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>-</span><span>113</span>
                                                                                       <span>-</span> <span>HIBYTE</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>36</span><span>)))]],</span>
                                         <span>1</span><span>)</span>
                                     <span>+</span> <span>89</span><span>)</span> <span>&lt;&lt;</span> <span>24</span><span>)</span> <span>|</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROR1__</span><span>(</span>
                                                                         <span>byte_1019891E0</span><span>[</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>-</span><span>113</span> <span>-</span> <span>HIWORD</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>36</span><span>)))]],</span>
                                                                         <span>1</span><span>)</span>
                                                                     <span>+</span> <span>89</span><span>)</span> <span>&lt;&lt;</span> <span>16</span><span>)</span> <span>|</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROR1__</span><span>(</span><span>byte_1019891E0</span><span>[</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>-</span><span>113</span> <span>-</span> <span>BYTE1</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>36</span><span>)))]],</span> <span>1</span><span>)</span> <span>+</span> <span>89</span><span>)</span> <span>&lt;&lt;</span> <span>8</span><span>)</span> <span>|</span> <span>(</span><span>unsigned</span> <span>int</span><span>)(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROR1__</span><span>(</span><span>byte_1019891E0</span><span>[</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>-</span><span>113</span> <span>-</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>36</span><span>))]],</span> <span>1</span><span>)</span> <span>+</span> <span>89</span><span>));</span>
  <span>...</span>
  <span>v46</span> <span>=</span> <span>(</span><span>HIWORD</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>))</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>;</span>
  <span>(</span><span>*</span><span>(</span><span>void</span> <span>(</span><span>__fastcall</span> <span>**</span><span>)(</span><span>__int64</span><span>,</span> <span>double</span><span>))(</span><span>*</span><span>(</span><span>_QWORD</span> <span>*</span><span>)</span><span>obj</span> <span>+</span> <span>1920LL</span><span>))(</span>
    <span>obj</span><span>,</span>
    <span>*</span><span>(</span><span>double</span> <span>*</span><span>)</span><span>_mm_cvtsi32_si128</span><span>(</span><span>__ROL1__</span><span>(</span>      <span>// float that represents damage taken</span>
                                   <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>)</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>)</span> <span>&gt;&gt;</span> <span>1</span><span>)</span> <span>&amp;</span> <span>0x55</span> <span>|</span> <span>(</span><span>2</span> <span>*</span> <span>((</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>)</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>))</span> <span>&amp;</span> <span>0xAA</span><span>,</span>
                                   <span>5</span><span>)</span> <span>^</span> <span>4</span> <span>|</span> <span>((</span><span>__ROL1__</span><span>(</span>
                                                <span>((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>BYTE1</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>))</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>)</span> <span>&gt;&gt;</span> <span>1</span><span>)</span> <span>&amp;</span> <span>0x55</span> <span>|</span> <span>(</span><span>2</span> <span>*</span> <span>((</span><span>BYTE1</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>))</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>))</span> <span>&amp;</span> <span>0xAA</span><span>,</span>
                                                <span>5</span><span>)</span> <span>^</span> <span>4</span><span>)</span> <span>&lt;&lt;</span> <span>8</span><span>)</span> <span>|</span> <span>((</span><span>__ROL1__</span><span>((</span><span>v46</span> <span>&gt;&gt;</span> <span>1</span><span>)</span> <span>&amp;</span> <span>0x55</span> <span>|</span> <span>(</span><span>2</span> <span>*</span> <span>v46</span><span>)</span> <span>&amp;</span> <span>0xAA</span><span>,</span> <span>5</span><span>)</span> <span>^</span> <span>4</span><span>)</span> <span>&lt;&lt;</span> <span>16</span><span>)</span> <span>|</span> <span>((</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(((</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>HIBYTE</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>))</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>)</span> <span>&gt;&gt;</span> <span>1</span><span>)</span> <span>&amp;</span> <span>0x55</span> <span>|</span> <span>(</span><span>2</span> <span>*</span> <span>((</span><span>HIBYTE</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>24</span><span>))</span> <span>^</span> <span>0xF2</span><span>)</span> <span>+</span> <span>9</span><span>))</span> <span>&amp;</span> <span>0xAA</span><span>,</span> <span>5</span><span>)</span> <span>^</span> <span>4</span><span>)</span> <span>&lt;&lt;</span> <span>24</span><span>)).</span><span>i64</span><span>);</span>
  <span>...</span>
  <span>return</span> <span>1</span><span>;</span>
<span>}</span>
</code></pre></div> </div> <p>Tthe second parameter to <code>GetInternalObjectFromID</code> is the id that are the source and target network ids. The functions converts the network ids to the game engine objects by looking through a map of <code>[id -&gt; object pointer]</code>. Then, to apply damage to the target object, there’s a call to obj, using its vtable at offset <code>0x1920</code> to apply damage. The conversion using <code>_mm_cvtsi32_si128</code> just puts the bytes into the <code>xmm0</code> register because the function takes in a float.</p> </details> <p>The code can be boiled down to this</p> <div><div><pre><code><span>void</span> <span>TakeDamage</span><span>(</span><span>__int64</span> <span>idk</span><span>,</span> <span>char</span><span>*</span> <span>packet_buffer</span><span>)</span>
<span>{</span>
  <span>target_object</span> <span>=</span> <span>GetInternalObjectFromID</span><span>(</span><span>DECRYPT_VALUE1</span><span>((</span><span>uint32_t</span><span>)</span><span>packet_buffer</span> <span>+</span> <span>16</span><span>));</span>
  <span>source_object</span> <span>=</span> <span>GetInternalObjectFromID</span><span>(</span><span>DECRYPT_VALUE2</span><span>((</span><span>uint32_t</span><span>)</span><span>packet_buffer</span> <span>+</span> <span>36</span><span>));</span>

  <span>target_object</span><span>-&gt;</span><span>take_damage</span><span>(</span><span>DECRYPT_FLOAT1</span><span>((</span><span>float</span><span>)</span><span>packet</span> <span>+</span> <span>24</span><span>));</span>
<span>}</span>
</code></pre></div></div> <p><code>GetInternalObjectFromID</code> converts an id <code>(uint32_t)</code> to an internal object in the game. <code>DECRYPT_VALUE1</code> and <code>DECRYPT_VALUE2</code> are different inlined functions that decrypts a value that I’ll explain in the next section.</p> <p>Below is the an emulator for <code>GetInternalObjectFromID</code> for the <code>target object</code>. Feel free to try to it out. In the end, you should expect the value <code>265086324</code> in <code>RSI register</code>, which matches the second argument to <code>GetInternalObjectFromID</code>. <code>RDI</code> is the first argument, which is a global map of id -&gt; object and <code>RSI</code> the is the second argument containing the network id.</p>          <h2 id="how-does-the-decryption-work">How Does The Decryption Work</h2> <p>Let’s break down this decompiled code: <code>target_object = GetInternalObjectFromID(DECRYPT_VALUE1((uint32_t)packet_buffer + 16));</code>? At first glance it’s hard to read, so let’s examine what’s happening step by step:</p> <div><div><pre><code>  <span>v3</span> <span>=</span> <span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>);</span>
  <span>v4</span> <span>=</span> <span>HIWORD</span><span>(</span><span>v3</span><span>);</span>
  <span>v5</span> <span>=</span> <span>HIBYTE</span><span>(</span><span>v3</span><span>);</span>
  <span>LOBYTE</span><span>(</span><span>v3</span><span>)</span> <span>=</span> <span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v3</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>);</span>
  <span>v6</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span>
                                          <span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>BYTE1</span><span>(</span><span>*</span><span>(</span><span>_DWORD</span> <span>*</span><span>)(</span><span>packet</span> <span>+</span> <span>16</span><span>)),</span> <span>4</span><span>)],</span>
                                          <span>4</span><span>)</span>
                                      <span>-</span> <span>54</span><span>)];</span>
  <span>v7</span> <span>=</span> <span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v6</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v6</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>);</span>
  <span>v8</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v4</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>)</span> <span>-</span> <span>54</span><span>)];</span>
  <span>v9</span> <span>=</span> <span>(</span><span>2050</span> <span>*</span> <span>v8</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v8</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>;</span>
  <span>v10</span> <span>=</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>__ROL1__</span><span>(</span><span>~</span><span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)</span><span>~</span><span>__ROL1__</span><span>(</span><span>v5</span><span>,</span> <span>4</span><span>)],</span> <span>4</span><span>)</span> <span>-</span> <span>54</span><span>)];</span>
  <span>target_object</span> <span>=</span> <span>GetInternalObjectFromID</span><span>(</span>
                    <span>qword_101C60850</span><span>,</span>
                    <span>(</span><span>16843008</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>v10</span><span>)</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>v10</span><span>)</span> <span>&amp;</span> <span>0x88440</span><span>))</span> <span>&amp;</span> <span>0xFF000000</span> <span>|</span> <span>(</span><span>65793</span> <span>*</span> <span>v9</span><span>)</span> <span>&amp;</span> <span>0xFF0000</span> <span>|</span> <span>(</span><span>v7</span> <span>&gt;&gt;</span> <span>8</span><span>)</span> <span>&amp;</span> <span>0xFF00</span> <span>|</span> <span>(</span><span>unsigned</span> <span>__int8</span><span>)((</span><span>65793</span> <span>*</span> <span>((</span><span>2050</span> <span>*</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v3</span> <span>-</span> <span>54</span><span>)])</span> <span>&amp;</span> <span>0x22110</span> <span>|</span> <span>(</span><span>32800</span> <span>*</span> <span>byte_1019891E0</span><span>[(</span><span>unsigned</span> <span>__int8</span><span>)(</span><span>v3</span> <span>-</span> <span>54</span><span>)])</span> <span>&amp;</span> <span>0x88440u</span><span>))</span> <span>&gt;&gt;</span> <span>16</span><span>));</span>
</code></pre></div></div> <p>The decryption process uses a 255-byte lookup table combined with arithmetic operations. It’s an enhanced version of XOR obfuscation: instead of a simple XOR, each byte goes through multiple transformations:</p> <ul> <li>Initial lookup in the 255-byte table</li> <li>Series of arithmetic operations (multiply, add, subtract)</li> <li>Additional table lookups</li> <li>Final transformation to produce the decrypted value</li> </ul> <p>Boiling this down, it looks like this:</p> <div><div><pre><code>  <span>char</span> <span>lookup_table</span><span>[</span><span>255</span><span>]</span> <span>=</span> <span>{</span> <span>0x56</span><span>,</span> <span>0x82</span><span>,</span> <span>0xDC</span><span>,</span> <span>0x83</span><span>,</span> <span>0x02</span><span>,</span> <span>0x8F</span><span>,</span> <span>0x29</span><span>,</span> <span>0x35</span><span>,</span> <span>0x04</span><span>,</span> <span>0x21</span><span>,</span> <span>0x71</span><span>,</span> <span>0x79</span><span>,</span> <span>0x9E</span><span>,</span> <span>0x92</span><span>,</span> <span>0x7F</span><span>,</span> <span>...</span> <span>};</span>
  <span>uint32_t</span> <span>enc_data</span> <span>=</span> <span>*</span><span>(</span><span>uint32_t</span><span>*</span><span>)((</span><span>char</span><span>*</span><span>)</span><span>packet</span> <span>+</span> <span>16</span><span>);</span>
  <span>uint8_t</span> <span>lookup_byte1</span> <span>=</span> <span>enc_data</span> <span>&amp;</span> <span>0xFF</span><span>;</span>
  <span>uint8_t</span> <span>lookup_byte2</span> <span>=</span> <span>(</span><span>enc_data</span> <span>&gt;&gt;</span> <span>8</span><span>)</span> <span>&amp;</span> <span>0xFF</span><span>;</span>
  <span>uint8_t</span> <span>lookup_byte3</span> <span>=</span> <span>(</span><span>enc_data</span> <span>&gt;&gt;</span> <span>16</span><span>)</span> <span>&amp;</span> <span>0xFF</span><span>;</span>

  <span>// Here are the operations for 1 byte</span>
  <span>uint8_t</span> <span>lookup_byte3_intermediate</span> <span>=</span> <span>lookup_table</span><span>[</span><span>~</span><span>lookup_byte3</span> <span>&gt;&gt;=</span> <span>4</span><span>];</span>
  <span>// lookup again</span>
  <span>uint8_t</span> <span>value3</span> <span>=</span> <span>lookup_table</span><span>[</span><span>lookup_byte3_intermediate</span><span>];</span>
  <span>uint32_t</span> <span>transform_value3</span> <span>=</span> <span>(</span><span>16843008</span> <span>*</span> <span>(</span><span>2050</span> <span>*</span> <span>value3</span><span>)</span> <span>&amp;</span> <span>0x22110</span><span>)</span> <span>|</span> <span>(</span><span>value3</span> <span>*</span> <span>32800</span><span>);</span>
  <span>// Extract the first byte out of it to place in our resulting value (network id)</span>
  <span>uint32_t</span> <span>high_byte</span> <span>=</span> <span>transform_value3</span> <span>&amp;</span> <span>0xFF000000</span>

  <span>// Repeat for other bytes...</span>

  <span>uint32_t</span> <span>network_id</span> <span>=</span> <span>0</span><span>;</span> <span>// To fill in</span>
  <span>network_id</span> <span>|=</span> <span>high_byte</span><span>;</span>
</code></pre></div></div> <p>Here’s the emulator for taking damage <code>target_object-&gt;take_damage(DECRYPT_FLOAT1((float)packet + 24));</code> where performs the decryption and finally the damage value appears. At the end, you should get <code>000000003e874000</code> in <code>RAX</code> which is <code>0.26416015625</code></p>          <h2 id="so-whats-the-catch">So what’s the catch?</h2> <p>While it might seem feasible to reimplement these functions in Python without running the client, several factors make this approach impractical<span></span><span>Actually, a more seasoned reverse engineer may know better tools for doing such things.</span>:</p> <ul> <li>the encryption and decryption methods changes <ul> <li>lookup table might be different</li> <li>the operations after the lookup might be different</li> <li>there’s not a single global lookup table <ul> <li>a different lookup table associated with every function</li> </ul> </li> </ul> </li> <li>the chunk layout (fields) get shuffled per patch <ul> <li>What may be in 0x10 offset of the packet may now be at offset 0x38</li> </ul> </li> <li>the packet types switch up each patch</li> </ul> <h2 id="beating-the-obfuscation">“Beating” The Obfuscation</h2> <p>Instead of reverse-engineering each encryption function, I chose a pragmatic approach: reading values directly from registers. This method requires an emulator, which typically runs rather slow (<a href="https://github.com/unicorn-engine/unicorn" rel="external nofollow noopener" target="_blank">unicorn emulator</a>). Instead, I developed an “exception emulator” that runs natively (detailed in the <a href="#performance">performance section</a>).</p> <p>For example, in the TakeDamage function, I intercept two key values:</p> <ul> <li>The network id from the RSI register before target_object creation</li> <li>The damage value from RAX before it’s applied</li> </ul> <p>This interception uses a trampoline hook<span></span><span>If you’re not familiar with trampoline hook, it’s essentially a callback that you add or similar to breakpointing in gdb and editing the program’s variables before continuing</span>:</p> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/hooking.png" width="85% 50% " alt=""/> </center> <center> <em>Visually demonstrating what a trampoline hook does (Image source: <a href="https://www.codereversing.com/archives/593" rel="external nofollow noopener" target="_blank">codereversing.com</a>) </em> </center> </center> <details> <summary>Click to expand to view how the trampoline hook works</summary> <p>The process has two parts:</p> <p>Save original bytes and insert jump:</p> <div> <div><pre><code><span>movd</span> <span>xmm0</span><span>,</span><span>eax</span>
<span>jmp</span> <span>FFF90000</span> <span>#</span> <span>Insert</span> <span>my</span> <span>trampoline</span> <span>hook</span> <span>here</span>
</code></pre></div> </div> <p>Create trampoline:</p> <ul> <li>Save all register states</li> <li>Call <code>MY_FUNCTION</code> to expose registers as a struct</li> <li>Allow high-level language access to register values</li> <li>Restore registers</li> <li>Execute original instructions</li> <li>Return to normal code flow</li> </ul> <div> <div><pre><code><span>push</span> <span>rsp</span>                               
<span>pushfq</span>                                 
<span>...</span>     
<span>push</span> <span>r8</span>                                
<span>push</span> <span>r9</span>                                
<span>push</span> <span>r10</span>                               
<span>push</span> <span>r11</span>                               
<span>push</span> <span>r12</span>                               
<span>push</span> <span>r13</span>                               
<span>push</span> <span>r14</span>                               
<span>push</span> <span>r15</span>                               
<span>push</span> <span>rbx</span>                               
<span>push</span> <span>rcx</span>                               
<span>push</span> <span>rdx</span>                               
<span>push</span> <span>rsi</span>                               
<span>push</span> <span>rdi</span>                               
<span>push</span> <span>rbp</span>                               
<span>sub</span> <span>rsp</span><span>,</span><span>40</span>                             
<span>movaps</span> <span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>],</span><span>xmm0</span>       
<span>movaps</span> <span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>10</span><span>],</span><span>xmm1</span>    
<span>movaps</span> <span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>20</span><span>],</span><span>xmm2</span>    
<span>movaps</span> <span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>30</span><span>],</span><span>xmm3</span>    
<span>...</span>
<span>mov</span> <span>rax</span><span>,</span> <span>MY_FUNCTION</span> <span>#</span> <span>This</span> <span>is</span> <span>what</span> <span>we</span> <span>redirect</span> <span>to</span><span>,</span> <span>to</span> <span>read</span> <span>RAX</span>
<span>call</span> <span>rax</span>                               
<span>...</span>
<span>movaps</span> <span>xmm0</span><span>,</span><span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>]</span>       
<span>movaps</span> <span>xmm1</span><span>,</span><span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>10</span><span>]</span>    
<span>movaps</span> <span>xmm2</span><span>,</span><span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>20</span><span>]</span>    
<span>movaps</span> <span>xmm3</span><span>,</span><span>xmmword</span> <span>ptr</span> <span>ss</span><span>:[</span><span>rsp</span><span>+</span><span>30</span><span>]</span>    
<span>add</span> <span>rsp</span><span>,</span><span>40</span>                             
<span>pop</span> <span>rbp</span>                                
<span>pop</span> <span>rdi</span>                                
<span>pop</span> <span>rsi</span>                                
<span>pop</span> <span>rdx</span>                                
<span>pop</span> <span>rcx</span>                                
<span>pop</span> <span>rbx</span>                                
<span>pop</span> <span>r15</span>                                
<span>pop</span> <span>r14</span>                                
<span>pop</span> <span>r13</span>                                
<span>pop</span> <span>r12</span>                                
<span>pop</span> <span>r11</span>                                
<span>pop</span> <span>r10</span>                                
<span>pop</span> <span>r9</span>                                 
<span>pop</span> <span>r8</span>                      
<span>...</span>            <span>#</span> <span>Execute</span> <span>original</span> <span>function</span> <span>somewhere</span> <span>here</span>        
<span>jmp</span> <span>qword</span> <span>ptr</span> <span>ds</span><span>:[</span><span>FFF90105</span><span>]</span> 
<span>xchg</span> <span>esp</span><span>,</span><span>eax</span>                           
<span>ret</span> <span>far</span>        <span>#</span> <span>Jump</span> <span>back</span>
</code></pre></div> </div> </details> <p>At the high level, Rust code interfaces with these hooks to read and modify program state:</p> <div><div><pre><code><span>emulator</span><span>.hook_address</span><span>(</span><span>TakeDamageAddress</span><span>,</span> <span>move</span> <span>|</span><span>emulator</span><span>,</span> <span>context</span><span>|</span> <span>{</span>
    <span>let</span> <span>damage_float</span> <span>=</span> <span>convert_xmm_to_float</span><span>(</span><span>context</span><span>.xmm0</span><span>);</span>
    <span>obj</span><span>.take_damage</span><span>(</span><span>damage_float</span><span>);</span>
<span>});</span>
</code></pre></div></div> <p>By applying similar hooks to other game events (ability casts, movement, resource changes, etc.), we can reconstruct the complete gameplay state.</p> <h2 id="why-do-it-this-way">Why do it this way?</h2> <ul> <li>Works directly with compressed ROFL files</li> <li>Uses fewer resources than running the game <ul> <li>Ignores irrelevant game systems</li> </ul> </li> <li>Provides precise value extraction</li> </ul> <h2 id="why-not-do-it-this-way">Why not do it this way?</h2> <ul> <li>Requires hooking undocumented packet structures <ul> <li>Have deep understanding of packet structures</li> </ul> </li> <li>System breaks with unexpected packet changes</li> <li>Potential for value extraction errors</li> <li>No game engine validation</li> </ul> <h2 id="alternative-approach-direct-game-state-reading">Alternative Approach: Direct Game State Reading</h2> <p><a href="https://github.com/MiscellaneousStuff/tlol-scraper-pandoras" rel="external nofollow noopener" target="_blank">MiscellaneousStuff</a>’s approach avoids packet analysis entirely by reading game state directly:</p> <center>  <center> <img src="https://miscellaneousstuff.github.io/assets/arch/tlol-replay-scraping-arch.svg" width="50% 50% " alt=""/> </center> <center> <em>Replay extraction by running the game and reading game state per interval (Image source: <a href="https://miscellaneousstuff.github.io/project/2021/11/19/tlol-part-6-dataset-generation.html" rel="external nofollow noopener" target="_blank">miscellaneousstuff.github.io</a>) </em> </center> </center> <p>This method works by running the full game client (sound, graphics, network, etc) in replay mode, sampling the game at fixed time intervals and dumping the game state snapshots to disk.</p> <p>While simpler to maintain, this sampling approach trades precision for simplicity. Lower sampling intervals increase precision but increases data usage, similar to <a href="https://stackoverflow.com/questions/40305096/difference-between-android-trace-based-and-sampling-based-method-profiling-and-i" rel="external nofollow noopener" target="_blank">sample-based profilers</a>.</p>  <p>Since we’re scraping, perfomance matters a little bit. We don’t want it to be running at a snail’s pace (hours+ per replay).</p> <p>I’ve written the emulator originally with the <a href="https://github.com/unicorn-engine/unicorn" rel="external nofollow noopener" target="_blank">unicorn emulator</a><span></span><span>If you’re unfamiliar with unicorn emulator, it’s a CPU emulator. I like to think of it as GDB with much more powerful scripting capabilities</span> in python. It was a good for bootstrapping, but it was terribly slow (by how much? somewhere like 5 minutes per replay).</p> <p>I’ve since rewritten it in rust with an api similar to unicorn emulator’s api. I called it the <code>exception emulator</code> because it runs natively and any exceptions (ex, out of bounds memory accesses) are routed and handled by a hook similar to unicorn’s api. It works by inserting a software breakpoint (<a href="https://en.wikipedia.org/wiki/INT_(x86_instruction)" rel="external nofollow noopener" target="_blank">INT3 instruction on x86 CPUs</a>) and creating an exception handler that lookups the corresponding the function to call that is mapped to the breakpoint. I use this to reverse functions where the game state is not properly initialized.</p> <p>My very simple methodology for evaluating my program using a single replay with a machine setup:</p> <ul> <li>Input: <ul> <li>~15 minute replay (11.5mb rofl file)</li> <li>“Gaming” machine</li> <li>NVME device</li> <li>Windows 11</li> <li>Other applications are running like chrome and discord</li> </ul> </li> <li>Output: <ul> <li>prettified json ~(135MB)</li> </ul> </li> </ul> <div><div><pre><code>PS&gt; Measure-Command {start-process cargo &#34;run --release -- -file test.rofl&#34; -Wait}


Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 3
Milliseconds      : 33
Ticks             : 30338426
TotalDays         : 3.51139189814815E-05
TotalHours        : 0.000842734055555556
TotalMinutes      : 0.0505640433333333
TotalSeconds      : 3.0338426
TotalMilliseconds : 3033.8426
</code></pre></div></div> <p>Running with one replay of ~15 minutes finishes in 3 seconds. Eyeballing task manager, it takes around 400MB up when running. Output is 135MB of prettified json.</p> <h2 id="comparison-to-miscellaneousstuffs-approach">Comparison to MiscellaneousStuff’s approach</h2> <p>Author also does some napkin math ~ <a href="https://miscellaneousstuff.github.io/project/2021/11/19/tlol-part-6-dataset-generation.html" rel="external nofollow noopener" target="_blank"><code>26 / 16 + 0.25</code></a> = 1.6 minutes = 96 seconds for 26 minute replay. So accounting for the replay, I’m running at 5 seconds, which is a bit faster than the author’s approach. The memory might bit a bit higher (running the game), which I’ve eyeballed at 1GB. Space utilization is ~820MB unpacking one game from <a href="https://github.com/MiscellaneousStuff/tlol/blob/main/EUW1-5270795542.rofl.7z" rel="external nofollow noopener" target="_blank">his repo</a> compared to 300MB - 500MB.</p> <p>While this does show that my approach has better performance, this is definitely eyeballing the results. I haven’t ran the author’s code.</p> <p>In either case, both should scale decently. Both can run multiple instances of the game/emulator.</p>  <h2 id="packet-optimizations">Packet Optimizations</h2> <p>If you are working at RIOT, I’ve listed some optimizations that could be applied to the packets. I don’t have a full view of how the game engine/server works, so some of these optimizations may not apply.</p> <h3 id="repeat-packets">Repeat Packets</h3> <p>Packets of leaving the fog appear multiple times (20+ repeats sometimes!) at the same time for the same id. I don’t see why this should be done unless there’s an engine specific issue or an issue when generating a replay.</p> <div><div><pre><code><span>{</span><span>
  </span><span>&#34;LeaveFromFog&#34;</span><span>:</span><span> </span><span>{</span><span>
    </span><span>&#34;time&#34;</span><span>:</span><span> </span><span>862.4249</span><span>,</span><span>
    </span><span>&#34;id&#34;</span><span>:</span><span> </span><span>1073741859</span><span>
  </span><span>}</span><span>
</span><span>}</span><span>
</span></code></pre></div></div> <p>A look into a single replay file shows the following:</p> <div><div><pre><code>Repeat packets: 21762
Total packets: 770650
Percentage of repeat packets: 2.82%
Repeat packet total bytes: 65370
Packet total bytes: 3399813
Percentage of bytes used up by repeat packets: 1.92%
</code></pre></div></div> <center>  <center> <img src="https://probablydance.com/assets/images/posts/2024-11-02/repeat_packets.png" width="100% 50% " alt=""/> </center> <center> <em>A graph showing the breakdown of repeat packets per packet type </em> </center> </center> <p>Removing these repeats in the replay could reduce the amount of data used per replay by around ~2%, which could save cost for hosting the space and bandwidth saved using the cloud (perhaps AWS).</p> <p>Doing some quick estimates only for storage writes cost</p> <p><a href="https://turbosmurfs.gg/article/league-of-legends-player-count-and-statistics" rel="external nofollow noopener" target="_blank">~30 million active players per day</a> and a player plays at least 2 games per day</p> <div><div><pre><code>average replay size = 10MB = 10 MB
optimization = 0.02
daily active users = 30 million / day = 30M/day
number of games = daily active users × 2 / 10 = 6M/day
data written in a day = number of games × average replay size to GB/day = 60,000 GB/day
data saved = optimization × data written in a day = 1,200 GB/day
aws S3 cost = $0.02 per GB  = $0.02/GB
money saved per day = data saved × aws S3 cost = $24.00/day
money saved per day per month = $730.49
money saved per day per year = $8,765.82
</code></pre></div></div> <h3 id="integer-values">Integer Values</h3> <p>For integer values (ids, hashes, etc), consider using <a href="hhttps://en.wikipedia.org/wiki/LEB128">variable integer compression</a>, which is commonly used in serialization frameworks such as <a href="https://github.com/protocolbuffers/protobuf" rel="external nofollow noopener" target="_blank">protobuf</a> and <a href="https://webassembly.github.io/spec/core/binary/values.html" rel="external nofollow noopener" target="_blank">wasm</a> to save more space.</p> <p>The chunk format already does this for single byte versus 4 byte integer, the variable integer compression can be used to create 2 byte or 3 byte integers.</p> <h3 id="same-ish-packets">Same-ish Packets</h3> <p>Some packets have different ids, but mostly do the same thing <span></span><span>For example, there could be a MovementPacket1 and MovementPacket2, and they both have the same fields, except for 1 or 2 extra fields in MovementPacket2</span>. I believe that merging them could reduce complexity, but I do not know how the game server is structured or how the code base is structured</p> <h3 id="repeat-of-different-packets">Repeat of Different Packets</h3> <p>Some packets encompass the same meaning. For example, typically, a damage packet is applied (by the same id) followed by a death packet at the same time. The damage packet is not necessary. However, due to the game engine and the way it is structured, it may be difficult to remove this.</p> <h3 id="replay-time-offset">Replay Time offset</h3> <p>An optimization I observed for each packet is using a byte (instead of a float) to represent the time offset for the next packet. This is quite neat.</p> <h2 id="game-engine-optimizations">Game Engine Optimizations</h2> <p>I’m going to suggest some game engine optimizations below. However, consider that the game engine itself is quite old, it may be difficult to near impossible to change how the engine is structured.</p> <h3 id="single-threadedness">Single Threadedness</h3> <p>Packets are handled as follows:</p> <div><div><pre><code>Create/Allocate packet -&gt; Deserialize buffer into packet -&gt; Update game state with packet
</code></pre></div></div> <p>Instead, multiple threads could be used to split the work</p> <div><div><pre><code>Thread 1: Create/Allocate packet -&gt; Deserialize buffer into packet
Thread 2: Create/Allocate packet -&gt; Deserialize buffer into packet
Thread 3: Create/Allocate packet -&gt; Deserialize buffer into packet
Thread 4: Create/Allocate packet -&gt; Deserialize buffer into packet

Thread 5: Update game state with packet
</code></pre></div></div> <p>The packets may be out of order, so have another thread order the packets with queues:</p> <div><div><pre><code>Thread 1: Create/Allocate packet -&gt; Deserialize buffer into packet -&gt; Unordered packet queue
Thread 2: Create/Allocate packet -&gt; Deserialize buffer into packet -&gt; Unordered packet queue
Thread 3: Create/Allocate packet -&gt; Deserialize buffer into packet -&gt; Unordered packet queue
Thread 4: Create/Allocate packet -&gt; Deserialize buffer into packet -&gt; Unordered packet queue

Thread 6: Unordered packet queue -&gt; Order packets -&gt; Ordered packet queue

Thread 5: Ordered Packet queue -&gt; Update game state with packet
</code></pre></div></div> <h3 id="buffer-pools">Buffer Pools</h3> <p>Instead of allocating/freeing memory for each packet, use a buffer/memory pool for commonly used packets to reduce CPU overhead.</p>  <h2 id="improvements">Improvements</h2> <p>One idea is to lift the assembly to LLVM, perform static analysis to generate or extract the decryption mechanism or the functions themselves into a different language such as C++, but that would take way too much time.</p> <p>Lastly, the bottleneck in the system is most likely replay aggregation (which I haven’t measure yet, but I would assume so given that downloading the replay takes seconds).</p> <h2 id="wrapping-up">Wrapping Up</h2> <p>Fun project. Captured hundred of thousands of replays and did some analysis on them, but got busy. Learned a bit more about reversing and rust.</p> </div> </article></div>
  </body>
</html>
