<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rgoswami.me/posts/doc-cpp-dox-sph-doxyrest/">Original</a>
    <h1>Documenting C&#43;&#43; with Doxygen and Sphinx - doxyrest</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>This post is part of the <a href="https://rgoswami.me/series/c++-documentation-practices/">C++ Documentation Practices</a> series.</p></div><blockquote><p>Unifying C++ and Python documentation.</p></blockquote><h2 id="background">Background</h2><p>For almost half a decade my C++ projects have been either scoped to where plain
Doxygen works well enough <sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>, or largely
undocumented at the C++ API level <sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>. While integrating with Sphinx via <code>exhale</code> or <code>breathe</code> <a href="https://qwen.ai/posts/doc-cpp-dox-sph-exhale/">shown earlier</a> <sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup> works well, it often
fails to provide a seamless source code view or struggles with modern C++
constructs.</p><p>For smaller, well formed libraries, the drawbacks of not being able to read the
source are manifold, tending towards over-verbose documentation strings. Back in
2020 during the <a href="https://qwen.ai/posts/symengine-gsod20/">season of docs for Symengine</a>, I
stuck to pure <code>doxygen</code> with a <a href="https://github.com/HaoZeke/doxyYoda">custom theme, doxyYoda</a>, a setup which served me
well for Fortran projects like <a href="https://haozeke.github.io/GaussJacobiQuad/">GaussJacobiQuad</a> <sup id="fnref:4"><a href="#fn:4" role="doc-noteref">4</a></sup>, and continues to be attractive.</p><p>Given the advent of <code>pixi</code>, however, it is worth revisiting the <code>doxyrest</code> setup
<sup id="fnref:5"><a href="#fn:5" role="doc-noteref">5</a></sup>. For the most part, the
focus will be on implementation within a <code>meson</code> based project, <a href="https://rgpot.rgoswami.me">rgpot</a>, which
defines an RPC interface for accessing forces and energies, typically for an
atomistic calculation, before demonstrating the benefit for a much larger
project, <a href="https://docs.metatensor.org/metatomic/">metatomic</a>.</p><div><p><strong>Note</strong></p><p>For before/after images see:</p><ul><li><a href="https://github.com/OmniPotentRPC/rgpot/pull/25">rgpot (gh-25)</a></li><li><a href="https://github.com/metatensor/metatomic/pull/148">metatomic (gh-148)</a></li></ul></div><h2 id="baseline-rgpot">Baseline – <code>rgpot</code></h2><p>In general, the pipeline relies on Doxygen emitting XML, which <code>doxyrest</code> parses
via Lua templates to generate reStructuredText, finally consumed by Sphinx. This
allows the C++ API to sit seamlessly alongside Python documentation in a single
Sphinx project, utilizing modern themes like <code>furo</code> or <code>pydata-sphinx-theme</code>.</p><figure><img src="https://qwen.ai/ox-hugo/dot-doxyrest-workflow.png" alt="Figure 1: Overview of the doxyrest build process"/><figcaption><p><span>Figure 1: </span>Overview of the <code>doxyrest</code> build process</p></figcaption></figure><h3 id="the-pixi-task-workflow">The <code>pixi</code> task workflow</h3><p>For <code>rgpot</code>, I opted to encapsulate the build complexity within <code>pixi</code> tasks.
This avoids polluting the repository with git submodules for tooling that is
essentially a build-time dependency, and has better support for managing
dependencies.</p><p>The workflow is broken down into dependency retrieval, patching, and generation:</p><div><pre tabindex="0"><code data-lang="toml"><span><span>1</span><span><span>[</span><span>feature</span><span>.</span><span>docs</span><span>.</span><span>tasks</span><span>.</span><span>setup-doxyrest</span><span>]</span>
</span></span><span><span>2</span><span><span>description</span> <span>=</span> <span>&#34;Clones the doxyrest dependency into the subprojects directory&#34;</span>
</span></span><span><span>3</span><span><span>cmd</span> <span>=</span> <span>&#34;&#34;&#34;
</span></span></span><span><span>4</span><span><span>test -d subprojects/doxyrest || \
</span></span></span><span><span>5</span><span><span>(mkdir -p subprojects &amp;&amp; \
</span></span></span><span><span>6</span><span><span>git clone --depth 1 --single-branch \
</span></span></span><span><span>7</span><span><span>https://github.com/vovkos/doxyrest subprojects/doxyrest)
</span></span></span><span><span>8</span><span><span>&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>The <code>setup-doxyrest</code> task handles the “shallow clone” approach to keep the
checkout light.</p><h3 id="the-build-cycle">The Build Cycle</h3><p>With the infrastructure in place, the actual build is a two-step process defined
in <code>doxybuild</code>:</p><div><pre tabindex="0"><code data-lang="toml"><span><span>1</span><span><span>[</span><span>feature</span><span>.</span><span>docs</span><span>.</span><span>tasks</span><span>.</span><span>doxybuild</span><span>]</span>
</span></span><span><span>2</span><span><span>description</span> <span>=</span> <span>&#34;Generates XML via Doxygen and converts it to RST via Doxyrest&#34;</span>
</span></span><span><span>3</span><span><span>cwd</span> <span>=</span> <span>&#34;docs/source&#34;</span>
</span></span><span><span>4</span><span><span>depends-on</span> <span>=</span> <span>[</span><span>&#34;setup-doxyrest&#34;</span><span>]</span>
</span></span><span><span>5</span><span><span>cmd</span> <span>=</span> <span>&#34;doxygen Doxyfile_potlib.cfg &amp;&amp; doxyrest -c doxyrest-config.lua&#34;</span>
</span></span></code></pre></div><p>We first generate the XML blobs with Doxygen. Immediately after, <code>doxyrest</code> is
invoked with a Lua configuration file, which defines the files used to map the
generated XML into frames. Internally, <code>doxyrest</code> relies on <strong>Lua Frames</strong> which
are templates that mix standard <code>reStructuredText</code> with injected Lua logic
(delimited by <code>%{ ... }</code>) and variable substitution (via <code>$var</code>).</p><p>In principle, one could write custom frames to radically alter the output, for
C++ projects we simply point <code>FRAME_DIR_LIST</code> to the standard “C-family” frames
provided by the repo we cloned earlier.</p><div><pre tabindex="0"><code data-lang="lua"><span><span> 1</span><span><span>INPUT_FILE</span> <span>=</span> <span>&#34;xml/index.xml&#34;</span>
</span></span><span><span> 2</span><span><span>OUTPUT_FILE</span> <span>=</span> <span>&#34;api/index.rst&#34;</span>
</span></span><span><span> 3</span><span><span>INDEX_TITLE</span> <span>=</span> <span>&#34;API Reference&#34;</span>
</span></span><span><span> 4</span><span>
</span></span><span><span> 5</span><span><span>FRAME_DIR_LIST</span> <span>=</span> <span>{</span>
</span></span><span><span> 6</span><span>    <span>&#34;../../subprojects/doxyrest/frame/common&#34;</span><span>,</span>
</span></span><span><span> 7</span><span>    <span>&#34;../../subprojects/doxyrest/frame/cfamily&#34;</span>
</span></span><span><span> 8</span><span><span>}</span>
</span></span><span><span> 9</span><span>
</span></span><span><span>10</span><span><span>LANGUAGE</span> <span>=</span> <span>&#34;cpp&#34;</span>
</span></span><span><span>11</span><span><span>ESCAPE_ASTERISKS</span> <span>=</span> <span>true</span>
</span></span><span><span>12</span><span><span>ESCAPE_TRAILING_UNDERSCORES</span> <span>=</span> <span>true</span>
</span></span></code></pre></div><p>With this, <code>doxyrest</code> digests the Doxygen XML into produce RST files that Sphinx
can ingest.</p><h3 id="sphinx-configuration">Sphinx Configuration</h3><p>For <code>Sphinx</code> to process the generated RST correctly, it needs to load the
<code>doxyrest</code> extension. Since we are downloading/cloning this into a local
subdirectory, we must explicitly update the python path in <code>docs/src/conf.py</code> so
Sphinx can find it.</p><div><pre tabindex="0"><code data-lang="python"><span><span> 1</span><span><span># For doxyrest, the location of this can change</span>
</span></span><span><span> 2</span><span><span>sys</span><span>.</span><span>path</span><span>.</span><span>insert</span><span>(</span><span>0</span><span>,</span> <span>os</span><span>.</span><span>path</span><span>.</span><span>abspath</span><span>(</span><span>&#34;subprojects/doxyrest/sphinx&#34;</span><span>))</span>
</span></span><span><span> 3</span><span>
</span></span><span><span> 4</span><span><span>extensions</span> <span>=</span> <span>[</span>
</span></span><span><span> 5</span><span>    <span># ... other extensions</span>
</span></span><span><span> 6</span><span>    <span># c++ helpers</span>
</span></span><span><span> 7</span><span>    <span>&#34;doxyrest&#34;</span><span>,</span>
</span></span><span><span> 8</span><span>    <span>&#34;cpplexer&#34;</span><span>,</span>
</span></span><span><span> 9</span><span>    <span># ...</span>
</span></span><span><span>10</span><span><span>]</span>
</span></span></code></pre></div><p>Finally, the standard Sphinx build can pick up the artifacts:</p><div><pre tabindex="0"><code data-lang="toml"><span><span>1</span><span><span>[</span><span>feature</span><span>.</span><span>docs</span><span>.</span><span>tasks</span><span>.</span><span>sphinxbld</span><span>]</span>
</span></span><span><span>2</span><span><span>depends-on</span> <span>=</span> <span>[</span> <span>{</span> <span>task</span> <span>=</span> <span>&#34;mkrst&#34;</span><span>,</span> <span>environment</span> <span>=</span> <span>&#34;docs&#34;</span> <span>},</span> <span>]</span>
</span></span><span><span>3</span><span><span>cmd</span> <span>=</span> <span>&#34;&#34;&#34; sphinx-build docs/source/ docs/build &#34;&#34;&#34;</span>
</span></span></code></pre></div><h3 id="ci-deployment">CI deployment</h3><p>The primary advantage of encapsulating the build logic within <code>pixi</code> tasks lies
in the simplification of Continuous Integration (CI) pipelines. Since the
environment and build steps reside within <code>pixi.toml</code>, the CI configuration need
only setup <code>pixi</code> and invoke the target task.</p><div><pre tabindex="0"><code data-lang="yaml"><span><span>1</span><span>- <span>uses</span><span>:</span><span> </span><span>prefix-dev/setup-pixi@v0.8.10</span><span>
</span></span></span><span><span>2</span><span><span>  </span><span>with</span><span>:</span><span>
</span></span></span><span><span>3</span><span><span>    </span><span>activate-environment</span><span>:</span><span> </span><span>true</span><span>
</span></span></span><span><span>4</span><span><span>    </span><span>environments</span><span>:</span><span> </span><span>docs</span><span>
</span></span></span><span><span>5</span><span><span></span>- <span>name</span><span>:</span><span> </span><span>Generate Docs</span><span>
</span></span></span><span><span>6</span><span><span>  </span><span>run</span><span>:</span><span> </span><span>pixi r docbld</span><span>
</span></span></span></code></pre></div><p>This reduces the friction of maintenance significantly, as local reproduction of
CI failures becomes a matter of running <code>pixi r docbld</code>, and integrates easily
with other actions, like the <a href="https://github.com/HaoZeke/doc-previewer">doc-previewer</a> to post artifact links directly on
Pull Requests, facilitating easier review of the generated output without
digging through Action logs.</p><h2 id="metatomic-integration">Metatomic integration</h2><p>For larger projects like <a href="https://github.com/metatensor/metatomic">metatomic</a> which do not use <code>pixi</code>, the process requires a
bit more manual orchestration. Here, the challenge is replacing the declarative
task runner with a robust script that ensures dependencies (like the <code>doxyrest</code>
<code>lua</code> frames) are present before invoking the build.</p><p>While a <code>Makefile</code> or <code>bash</code> script is the traditional route, using <a href="https://www.nushell.sh/">nushell</a>
provides a nice balance of readability and cross-platform handling without the
foot-guns of strict POSIX shell scripting, which are best avoided, despite my
<a href="https://qwen.ai/posts/back-to-bash/">return to bash</a>.</p><h3 id="the-ideal-orchestrator-script">The ideal orchestrator script</h3><p>Instead of relying solely on <code>tox</code> and file driven configurations to do the
heavy lifting of environment setup, we use a <code>nu</code> script to bootstrap the
documentation build.</p><p>First, we define our environment and ensure the local directory structure exists.
We check if <code>doxyrest</code> is available in the path (useful for local development)
or if we need to fetch it.</p><div><pre tabindex="0"><code data-lang="fallback"><span><span>1</span><span>let root = ($env.PWD)
</span></span><span><span>2</span><span>let deps_dir = ($root | path join &#34;docs/subprojects&#34;)
</span></span><span><span>3</span><span>let doxyrest_src = ($deps_dir | path join &#34;doxyrest&#34;)
</span></span><span><span>4</span><span>let install_dir = ($deps_dir | path join &#34;install&#34;)
</span></span><span><span>5</span><span>let has_doxyrest = (which doxyrest | is-not-empty)
</span></span><span><span>6</span><span>
</span></span><span><span>7</span><span>if not ($deps_dir | path exists) { mkdir $deps_dir }
</span></span></code></pre></div><p>Next, if the binary is missing, we download the pre-compiled release. This avoids
the complexity of setting up a C++ build chain in the CI environment just for a
doc tool.</p><div><pre tabindex="0"><code data-lang="gdscript3"><span><span> 1</span><span><span>if</span> <span>not</span> <span>$</span><span>has_doxyrest</span> <span>and</span> <span>not</span> <span>(</span><span>$</span><span>install_dir</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span>
</span></span><span><span> 2</span><span>    <span>print</span> <span>&#34;Downloading Doxyrest binary release...&#34;</span>
</span></span><span><span> 3</span><span>    <span>let</span> <span>version</span> <span>=</span> <span>&#34;2.1.3&#34;</span>
</span></span><span><span> 4</span><span>    <span>let</span> <span>target</span> <span>=</span> <span>&#34;linux-amd64&#34;</span>
</span></span><span><span> 5</span><span>    <span>let</span> <span>archive</span> <span>=</span> <span>$</span><span>&#34;doxyrest-($version)-($target).tar.xz&#34;</span>
</span></span><span><span> 6</span><span>    <span>let</span> <span>url</span> <span>=</span> <span>$</span><span>&#34;https://github.com/vovkos/doxyrest/releases/download/doxyrest-($version)/($archive)&#34;</span>
</span></span><span><span> 7</span><span>
</span></span><span><span> 8</span><span>    <span>cd</span> <span>$</span><span>deps_dir</span>
</span></span><span><span> 9</span><span>    <span>http</span> <span>get</span> <span>$</span><span>url</span> <span>|</span> <span>save</span> <span>$</span><span>archive</span>
</span></span><span><span>10</span><span>    <span>tar</span> <span>-</span><span>xJf</span> <span>$</span><span>archive</span>
</span></span><span><span>11</span><span>
</span></span><span><span>12</span><span>    <span>if</span> <span>(</span><span>$</span><span>install_dir</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span> <span>rm</span> <span>-</span><span>rf</span> <span>$</span><span>install_dir</span> <span>}</span>
</span></span><span><span>13</span><span>    <span>mv</span> <span>$</span><span>&#34;doxyrest-($version)-($target)&#34;</span> <span>$</span><span>install_dir</span>
</span></span><span><span>14</span><span>    <span>rm</span> <span>$</span><span>archive</span>
</span></span><span><span>15</span><span>    <span>cd</span> <span>$</span><span>root</span>
</span></span><span><span>16</span><span><span>}</span>
</span></span></code></pre></div><p>Even with the binary, we still need the Lua frames (themes/templates) from the
source repository. We clone this shallowly.</p><div><pre tabindex="0"><code data-lang="fallback"><span><span>1</span><span>if not ($doxyrest_src | path exists) {
</span></span><span><span>2</span><span>    print $&#34;Cloning doxyrest frames into ($doxyrest_src)...&#34;
</span></span><span><span>3</span><span>    git clone --depth 1 --single-branch https://github.com/vovkos/doxyrest $doxyrest_src
</span></span><span><span>4</span><span>}
</span></span></code></pre></div><p>Finally, we run the pipeline. Note that we prepend the local install directory
to the <code>PATH</code> only for the <code>doxyrest</code> execution block.</p><div><pre tabindex="0"><code data-lang="fallback"><span><span> 1</span><span>print &#34;Generating XML with Doxygen...&#34;
</span></span><span><span> 2</span><span>cd docs
</span></span><span><span> 3</span><span>if not (&#34;build/doxygen/xml&#34; | path exists) { mkdir build/doxygen/xml }
</span></span><span><span> 4</span><span>doxygen Doxyfile.metatomic
</span></span><span><span> 5</span><span>
</span></span><span><span> 6</span><span>print &#34;Generating RST with local Doxyrest...&#34;
</span></span><span><span> 7</span><span>with-env { PATH: ($env.PATH | prepend ($install_dir | path join &#34;bin&#34;)) } {
</span></span><span><span> 8</span><span>    doxyrest -c doxyrest-config.lua
</span></span><span><span> 9</span><span>}
</span></span><span><span>10</span><span>
</span></span><span><span>11</span><span>print &#34;Building HTML with Sphinx (tox)...&#34;
</span></span><span><span>12</span><span>tox -e docs
</span></span></code></pre></div><p>Sphinx and CI configurations are similar to the previous project, with the
complete including a <code>bash</code> orchestrator in the <a href="https://github.com/metatensor/metatomic/pull/148">PR here</a>.</p><details><summary>Click to see the full <code>scripts/mkdoc.nu</code> script</summary><div><div><pre tabindex="0"><code data-lang="gdscript3"><span><span> 1</span><span><span>#!/usr/bin/env nu</span>
</span></span><span><span> 2</span><span>
</span></span><span><span> 3</span><span><span>def</span> <span>main</span> <span>[]</span> <span>{</span>
</span></span><span><span> 4</span><span>    <span>let</span> <span>root</span> <span>=</span> <span>(</span><span>$</span><span>env</span><span>.</span><span>PWD</span><span>)</span>
</span></span><span><span> 5</span><span>    <span>let</span> <span>deps_dir</span> <span>=</span> <span>(</span><span>$</span><span>root</span> <span>|</span> <span>path</span> <span>join</span> <span>&#34;docs/subprojects&#34;</span><span>)</span>
</span></span><span><span> 6</span><span>    <span>let</span> <span>doxyrest_src</span> <span>=</span> <span>(</span><span>$</span><span>deps_dir</span> <span>|</span> <span>path</span> <span>join</span> <span>&#34;doxyrest&#34;</span><span>)</span>
</span></span><span><span> 7</span><span>    <span>let</span> <span>install_dir</span> <span>=</span> <span>(</span><span>$</span><span>deps_dir</span> <span>|</span> <span>path</span> <span>join</span> <span>&#34;install&#34;</span><span>)</span>
</span></span><span><span> 8</span><span>    <span>let</span> <span>has_doxyrest</span> <span>=</span> <span>(</span><span>which</span> <span>doxyrest</span> <span>|</span> <span>is</span><span>-</span><span>not</span><span>-</span><span>empty</span><span>)</span>
</span></span><span><span> 9</span><span>
</span></span><span><span>10</span><span>    <span>if</span> <span>not</span> <span>(</span><span>$</span><span>deps_dir</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span> <span>mkdir</span> <span>$</span><span>deps_dir</span> <span>}</span>
</span></span><span><span>11</span><span>
</span></span><span><span>12</span><span>    <span># 1. Grab Doxyrest Binary if missing</span>
</span></span><span><span>13</span><span>    <span>if</span> <span>not</span> <span>$</span><span>has_doxyrest</span> <span>and</span> <span>not</span> <span>(</span><span>$</span><span>install_dir</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span>
</span></span><span><span>14</span><span>        <span>print</span> <span>&#34;Downloading Doxyrest binary release...&#34;</span>
</span></span><span><span>15</span><span>        <span>let</span> <span>version</span> <span>=</span> <span>&#34;2.1.3&#34;</span>
</span></span><span><span>16</span><span>        <span>let</span> <span>target</span> <span>=</span> <span>&#34;linux-amd64&#34;</span>
</span></span><span><span>17</span><span>        <span>let</span> <span>archive</span> <span>=</span> <span>$</span><span>&#34;doxyrest-($version)-($target).tar.xz&#34;</span>
</span></span><span><span>18</span><span>        <span>let</span> <span>url</span> <span>=</span> <span>$</span><span>&#34;https://github.com/vovkos/doxyrest/releases/download/doxyrest-($version)/($archive)&#34;</span>
</span></span><span><span>19</span><span>
</span></span><span><span>20</span><span>        <span>cd</span> <span>$</span><span>deps_dir</span>
</span></span><span><span>21</span><span>        <span>http</span> <span>get</span> <span>$</span><span>url</span> <span>|</span> <span>save</span> <span>$</span><span>archive</span>
</span></span><span><span>22</span><span>        <span>tar</span> <span>-</span><span>xJf</span> <span>$</span><span>archive</span>
</span></span><span><span>23</span><span>
</span></span><span><span>24</span><span>        <span>if</span> <span>(</span><span>$</span><span>install_dir</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span> <span>rm</span> <span>-</span><span>rf</span> <span>$</span><span>install_dir</span> <span>}</span>
</span></span><span><span>25</span><span>        <span>mv</span> <span>$</span><span>&#34;doxyrest-($version)-($target)&#34;</span> <span>$</span><span>install_dir</span>
</span></span><span><span>26</span><span>        <span>rm</span> <span>$</span><span>archive</span>
</span></span><span><span>27</span><span>        <span>cd</span> <span>$</span><span>root</span>
</span></span><span><span>28</span><span>    <span>}</span>
</span></span><span><span>29</span><span>
</span></span><span><span>30</span><span>    <span># 2. Clone the frames (still needed for the Lua templates)</span>
</span></span><span><span>31</span><span>    <span>if</span> <span>not</span> <span>(</span><span>$</span><span>doxyrest_src</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span>
</span></span><span><span>32</span><span>        <span>print</span> <span>$</span><span>&#34;Cloning doxyrest frames into ($doxyrest_src)...&#34;</span>
</span></span><span><span>33</span><span>        <span>git</span> <span>clone</span> <span>--</span><span>depth</span> <span>1</span> <span>--</span><span>single</span><span>-</span><span>branch</span> <span>https</span><span>:</span><span>//</span><span>github</span><span>.</span><span>com</span><span>/</span><span>vovkos</span><span>/</span><span>doxyrest</span> <span>$</span><span>doxyrest_src</span>
</span></span><span><span>34</span><span>    <span>}</span>
</span></span><span><span>35</span><span>
</span></span><span><span>36</span><span>    <span># 3. Run the Pipeline</span>
</span></span><span><span>37</span><span>    <span>print</span> <span>&#34;Generating XML with Doxygen...&#34;</span>
</span></span><span><span>38</span><span>    <span>cd</span> <span>docs</span>
</span></span><span><span>39</span><span>    <span>if</span> <span>not</span> <span>(</span><span>&#34;build/doxygen/xml&#34;</span> <span>|</span> <span>path</span> <span>exists</span><span>)</span> <span>{</span> <span>mkdir</span> <span>build</span><span>/</span><span>doxygen</span><span>/</span><span>xml</span> <span>}</span>
</span></span><span><span>40</span><span>    <span>doxygen</span> <span>Doxyfile</span><span>.</span><span>metatomic</span>
</span></span><span><span>41</span><span>
</span></span><span><span>42</span><span>    <span>print</span> <span>&#34;Generating RST with local Doxyrest...&#34;</span>
</span></span><span><span>43</span><span>    <span>with</span><span>-</span><span>env</span> <span>{</span> <span>PATH</span><span>:</span> <span>(</span><span>$</span><span>env</span><span>.</span><span>PATH</span> <span>|</span> <span>prepend</span> <span>(</span><span>$</span><span>install_dir</span> <span>|</span> <span>path</span> <span>join</span> <span>&#34;bin&#34;</span><span>))</span> <span>}</span> <span>{</span>
</span></span><span><span>44</span><span>        <span>doxyrest</span> <span>-</span><span>c</span> <span>doxyrest</span><span>-</span><span>config</span><span>.</span><span>lua</span>
</span></span><span><span>45</span><span>    <span>}</span>
</span></span><span><span>46</span><span>
</span></span><span><span>47</span><span>    <span>print</span> <span>&#34;Building HTML with Sphinx (tox)...&#34;</span>
</span></span><span><span>48</span><span>    <span>tox</span> <span>-</span><span>e</span> <span>docs</span>
</span></span><span><span>49</span><span><span>}</span>
</span></span></code></pre></div></div></details><h2 id="conclusions">Conclusions</h2><p>Personally, I like the look of Doxygen still, and for some themes like <a href="https://shibuya.lepture.com/">shibuya</a>,
manual patches are required (e.g. <a href="https://github.com/OmniPotentRPC/rgpot/pull/25">monkeypatch @ rgpot</a>). Nevertheless there are
multi-language projects <sup id="fnref:6"><a href="#fn:6" role="doc-noteref">6</a></sup> which benefit from having a
consistent style across languages, so this works out quite well. Probably the
next step would consistency across even more languages and esoteric builds, like
those in <a href="https://metatensor.org/">Metatensor</a>.</p><hr/><div><h2>Series info</h2><h3>C++ Documentation Practices series</h3><ol><li><a href="https://rgoswami.me/posts/doc-cpp-dox-sph-exhale/">Documenting C++ with Doxygen and Sphinx - Exhale</a></li><li><a href="https://rgoswami.me/posts/pub-doc-cpp-dox-sph-nix/">Publishing Doxygen and Sphinx with Nix and Rake</a></li><li><b>Documenting C++ with Doxygen and Sphinx - doxyrest</b> &lt;-- You are here!</li></ol></div></div></div>
  </body>
</html>
