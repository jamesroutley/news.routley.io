<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/dolthub/doltgresql">Original</a>
    <h1>Show HN: DoltgreSQL â€“ Version-Controlled DB, Like Git and PostgreSQL had a baby</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">From the creators of <a href="https://www.doltdb.com" rel="nofollow">Dolt</a>, the world&#39;s first version controlled SQL database,
DoltgreSQL (aka Doltgres) is a Postgres-flavored version of Dolt. Doltgres offers all the Git-style log,
diff, branch, and merge functionality of Dolt on your Postgres database schema and data. Instead of
connecting with a MySQL client and using MySQL SQL, you connect to Doltgres with a Postgres client and
use Postgres SQL. Doltgres is like Git and Postgres had a baby.</p>

<p dir="auto">Dolt <a href="https://www.dolthub.com/blog/2022-03-28-have-postgres-want-dolt/#why-is-dolt-mysql-flavored-anyway" rel="nofollow">was built MySQL-flavored</a>.
There is no MySQL code in Dolt. In 2019, when we were conceiving of Dolt, MySQL was the most popular
SQL-flavor. Over the past 5 years, the tide has shifted more towards Postgres, especially among
young companies, Dolt&#39;s target market. Potential customers
<a href="https://github.com/dolthub/dolt/issues/4840" data-hovercard-type="issue" data-hovercard-url="/dolthub/dolt/issues/4840/hovercard">have been clamoring for a Postgres version of Dolt</a>.</p>
<p dir="auto">Moreover, Dolt was conceived of and built as <a href="https://www.dolthub.com/blog/2020-03-06-so-you-want-git-for-data/" rel="nofollow">Git for Data</a>.
Dolt later became a <a href="https://www.dolthub.com/blog/2021-09-17-database-version-control/" rel="nofollow">version controlled database</a>.
DoltgreSQL gives us the opportunity to strip out some of the Git for Data pieces like the CLI
and build directly for the version controlled database use case. With Doltgres, you start a server,
connect a client, and do everything with SQL, a familiar experience for Postgres users.</p>
<p dir="auto">Doltgres will diverge from Dolt over time to be a focused database version control solution.
That said, we have a five year head start with Dolt. Dolt is a production-grade version
controlled database today. <a href="https://www.dolthub.com/blog/2023-05-05-dolt-1-dot-0/" rel="nofollow">Dolt is 1.0</a>.
If you are ok with using a MySQL-client, we recommend using Dolt for all use cases. Doltgres
is <a href="#limitations">experimental</a>.</p>

<p dir="auto">Doltgres is experimental. We need your feedback to understand how much we should invest in it.
If you are interested in using Doltgres now or in the future, please:</p>
<ul dir="auto">
<li>Star this repo to tell us you are interested.</li>
<li><a href="#getting-started">Try Doltgres</a></li>
<li>Create <a href="https://github.com/dolthub/doltgresql/issues">issues</a> if you find bugs</li>
<li>Create <a href="https://github.com/dolthub/doltgresql/issues">issues</a> for missing functionality you want</li>
<li>Contribute Code for features you want (see <a href="#building-from-source">Building From Source</a>)</li>
</ul>
<p dir="auto">Contribution Guide coming soon.</p>

<ol dir="auto">
<li>
<p dir="auto">Download the latest release of <code>doltgres</code></p>
</li>
<li>
<p dir="auto">Put <code>doltgres</code> on your <code>PATH</code></p>
</li>
<li>
<p dir="auto">Navigate to a directory you want your database data stored (ie. <code>~/doltgresql</code>).</p>
</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="$ mkdir ~/doltgresql
$ cd ~/doltgresql"><pre>$ mkdir <span>~</span>/doltgresql
$ <span>cd</span> <span>~</span>/doltgresql</pre></div>
<ol start="4" dir="auto">
<li>Run <code>doltgres</code>. This will create a <code>doltgres</code> user and a <code>doltgres</code> database.</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="$ doltgres
Successfully initialized dolt data repository.
Starting server with Config HP=&#34;localhost:5432&#34;|T=&#34;28800000&#34;|R=&#34;false&#34;|L=&#34;info&#34;|S=&#34;/tmp/mysql.sock&#34;"><pre>$ doltgres
Successfully initialized dolt data repository.
Starting server with Config HP=<span><span>&#34;</span>localhost:5432<span>&#34;</span></span><span>|</span>T=<span><span>&#34;</span>28800000<span>&#34;</span></span><span>|</span>R=<span><span>&#34;</span>false<span>&#34;</span></span><span>|</span>L=<span><span>&#34;</span>info<span>&#34;</span></span><span>|</span>S=<span><span>&#34;</span>/tmp/mysql.sock<span>&#34;</span></span></pre></div>
<ol start="5" dir="auto">
<li>Make sure you have Postgres version 15 or higher installed. I used Homebrew to install Postgeres on my Mac.
This requires I manually add <code>/opt/homebrew/opt/postgresql@15/bin</code> to my path. On Postgres version 14 or lower,
<code>\</code> commands (ie. <code>\d</code>, <code>\l</code>) do not work with Doltgres.</li>
</ol>
<div data-snippet-clipboard-copy-content="export PATH=&#34;/opt/homebrew/opt/postgresql@15/bin:$PATH&#34;"><pre><code>export PATH=&#34;/opt/homebrew/opt/postgresql@15/bin:$PATH&#34;
</code></pre></div>
<ol start="6" dir="auto">
<li>Open a new terminal. Connect with the following command: <code>psql -h localhost -U doltgres</code>. This will connect to the <code>doltgres</code> database with the <code>doltgres</code> user.</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="$ psql -h 127.0.0.1 -U doltgres                  
psql (15.4 (Homebrew), server 15.0)
Type &#34;help&#34; for help.

doltgres=&gt;"><pre>$ psql -h 127.0.0.1 -U doltgres                  
psql (15.4 (Homebrew), server 15.0)
Type <span><span>&#34;</span>help<span>&#34;</span></span> <span>for</span> help.

doltgres=<span>&gt;</span></pre></div>
<ol start="7" dir="auto">
<li>Create a <code>getting_started</code> database. Create the <code>getting_started</code> example tables.</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="doltgres=&gt; create database getting_started;
--
(0 rows)

doltgres=&gt; \c getting_started;
psql (15.4 (Homebrew), server 15.0)
You are now connected to database &#34;getting_started&#34; as user &#34;doltgres&#34;.
getting_started=&gt; create table employees (
    id int8,
    last_name text,
    first_name text,
    primary key(id));
--
(0 rows)

getting_started=&gt; create table teams (
    id int8,
    team_name text,
    primary key(id));
--
(0 rows)

getting_started=&gt; create table employees_teams(
    team_id int8,
    employee_id int8,
    primary key(team_id, employee_id),
    foreign key (team_id) references teams(id),
    foreign key (employee_id) references employees(id));
--
(0 rows)

getting_started=&gt; \d
              List of relations
 Schema |      Name       | Type  |  Owner   
--------+-----------------+-------+----------
 public | employees       | table | postgres
 public | employees_teams | table | postgres
 public | teams           | table | postgres
(3 rows)"><pre>doltgres<span>=&gt;</span> create database getting_started;
<span><span>--</span></span>
(<span>0</span> rows)

doltgres<span>=&gt;</span> \c getting_started;
psql (<span>15</span>.<span>4</span> (Homebrew), server <span>15</span>.<span>0</span>)
You are now connected to database <span><span>&#34;</span>getting_started<span>&#34;</span></span> <span>as</span> user <span><span>&#34;</span>doltgres<span>&#34;</span></span>.
getting_started<span>=&gt;</span> create table employees (
    id int8,
    last_name <span>text</span>,
    first_name <span>text</span>,
    <span>primary key</span>(id));
<span><span>--</span></span>
(<span>0</span> rows)

getting_started<span>=&gt;</span> create table teams (
    id int8,
    team_name <span>text</span>,
    <span>primary key</span>(id));
<span><span>--</span></span>
(<span>0</span> rows)

getting_started<span>=&gt;</span> create table employees_teams(
    team_id int8,
    employee_id int8,
    <span>primary key</span>(team_id, employee_id),
    <span>foreign key</span> (team_id) <span>references</span> teams(id),
    <span>foreign key</span> (employee_id) <span>references</span> employees(id));
<span><span>--</span></span>
(<span>0</span> rows)

getting_started<span>=&gt;</span> \d
              List of relations
 Schema |      Name       | Type  |  Owner   
<span><span>--</span>------+-----------------+-------+----------</span>
 public | employees       | table | postgres
 public | employees_teams | table | postgres
 public | teams           | table | postgres
(<span>3</span> rows)</pre></div>
<ol start="8" dir="auto">
<li>Make a Dolt Commit.</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="getting_started=&gt; select * from dolt_status;
   table_name    | staged |  status   
-----------------+--------+-----------
 employees       | 0      | new table
 employees_teams | 0      | new table
 teams           | 0      | new table
(3 rows)

getting_started=&gt; call dolt_add(&#39;teams&#39;, &#39;employees&#39;, &#39;employees_teams&#39;);
 status 
--------
      0
(1 row)
getting_started=&gt; select * from dolt_status; 
   table_name    | staged |  status   
-----------------+--------+-----------
 employees       | 1      | new table
 employees_teams | 1      | new table
 teams           | 1      | new table
(3 rows)

getting_started=&gt; call dolt_commit(&#39;-m&#39;, &#39;Created initial schema&#39;);
               hash               
----------------------------------
 peqq98e2dl5gscvfvic71e7j6ne34533
(1 row)"><pre>getting_started<span>=&gt;</span> <span>select</span> <span>*</span> <span>from</span> dolt_status;
   table_name    | staged |  status   
<span><span>--</span>---------------+--------+-----------</span>
 employees       | <span>0</span>      | new table
 employees_teams | <span>0</span>      | new table
 teams           | <span>0</span>      | new table
(<span>3</span> rows)

getting_started<span>=&gt;</span> call dolt_add(<span><span>&#39;</span>teams<span>&#39;</span></span>, <span><span>&#39;</span>employees<span>&#39;</span></span>, <span><span>&#39;</span>employees_teams<span>&#39;</span></span>);
 status 
<span><span>--</span>------</span>
      <span>0</span>
(<span>1</span> row)
getting_started<span>=&gt;</span> <span>select</span> <span>*</span> <span>from</span> dolt_status; 
   table_name    | staged |  status   
<span><span>--</span>---------------+--------+-----------</span>
 employees       | <span>1</span>      | new table
 employees_teams | <span>1</span>      | new table
 teams           | <span>1</span>      | new table
(<span>3</span> rows)

getting_started<span>=&gt;</span> call dolt_commit(<span><span>&#39;</span>-m<span>&#39;</span></span>, <span><span>&#39;</span>Created initial schema<span>&#39;</span></span>);
               hash               
<span><span>--</span>--------------------------------</span>
 peqq98e2dl5gscvfvic71e7j6ne34533
(<span>1</span> row)</pre></div>
<ol start="9" dir="auto">
<li>View the Dolt log.</li>
</ol>
<div data-snippet-clipboard-copy-content="getting_started=&gt; select * from dolt_log;
           commit_hash            | committer |       email        |        date         |          message           
----------------------------------+-----------+--------------------+---------------------+----------------------------
 peqq98e2dl5gscvfvic71e7j6ne34533 | doltgres  | doltgres@127.0.0.1 | 2023-11-01 22:08:04 | Created initial schema
 in7bk735qa6p6rv6i3s797jjem2pg4ru | timsehn   | tim@dolthub.com    | 2023-11-01 22:04:03 | Initialize data repository
(2 rows)"><pre><code>getting_started=&gt; select * from dolt_log;
           commit_hash            | committer |       email        |        date         |          message           
----------------------------------+-----------+--------------------+---------------------+----------------------------
 peqq98e2dl5gscvfvic71e7j6ne34533 | doltgres  | doltgres@127.0.0.1 | 2023-11-01 22:08:04 | Created initial schema
 in7bk735qa6p6rv6i3s797jjem2pg4ru | timsehn   | tim@dolthub.com    | 2023-11-01 22:04:03 | Initialize data repository
(2 rows)
</code></pre></div>
<ol start="10" dir="auto">
<li>Continue with <a href="https://docs.dolthub.com/introduction/getting-started/database#insert-some-data" rel="nofollow">Dolt Getting Started</a>
to test out more Doltgres versioning functionality.</li>
</ol>

<p dir="auto">Due to the rapid pace of development at this early stage, building from source will guarantee that you&#39;re always working
with the latest improvement and features.</p>
<ol dir="auto">
<li>Clone the repository to your local drive</li>
<li>Run <code>./postgres/parser/build.sh</code> to generate the parser</li>
<li>Run <code>go build .</code> in the root directory</li>
</ol>

<ul dir="auto">
<li>No Git-style CLI for version control, only a SQL interface.</li>
<li>Can&#39;t push to DoltHub or DoltLab, only custom remotes.</li>
<li>Limited support of Postgres-specific types and functions.</li>
<li>No Postgres system tables.</li>
<li>No authentication or users.</li>
<li>Database and schema models are merged.</li>
<li>Limited support for SSL connections (non-verified connections only).</li>
<li>No GSSAPI support.</li>
<li>No PostgreSQL functions have been implemented, therefore only MySQL functions may be used.</li>
</ul>

<p dir="auto">Dolt is <a href="https://docs.dolthub.com/sql-reference/benchmarks/latency" rel="nofollow">1.7X slower than MySQL</a> as measured by
a standard suite of Sysbench tests.</p>
<p dir="auto">Similar tests for Doltgres vs Postgres coming soon.</p>

<p dir="auto">Dolt is <a href="https://docs.dolthub.com/sql-reference/benchmarks/correctness" rel="nofollow">99.99% compatible</a> with MySQL based on a
standard suite of correctness tests called <code>sqllogictest</code>.</p>
<p dir="auto">A similar comparison for Doltgres coming soon.</p>

<p dir="auto">Doltgres emulates a Postgres server, including parsing Postgres SQL into an Abstract Syntax Tree (AST). This AST is
converted to a form that can be interpreted by the Dolt engine. Doltgres uses the same SQL engine and storage format as Dolt.</p>
<p dir="auto"><a href="https://docs.dolthub.com/architecture/architecture" rel="nofollow">Dolt has a unique architecure</a> that allows for version control
features at OLTP database performance. Doltgres uses the same architecture.</p>
</article>
          </div></div>
  </body>
</html>
