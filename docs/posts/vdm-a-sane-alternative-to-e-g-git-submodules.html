<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/opensourcecorp/vdm">Original</a>
    <h1>Show HN: Vdm, a sane alternative to e.g. Git submodules</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><code>vdm</code> is an alternative to e.g. Git Submodules for managing arbitrary external
dependencies for the same reasons, in a more sane way. Unlike some other tools
that try to solve this problem, <code>vdm</code> is language-agnostic, and can be used for
any purpose that you would need remote development resources.</p>
<p dir="auto"><code>vdm</code> can be used for many different purposes, but most commonly as a way to
track external dependencies that your own code might need, but that you don&#39;t
have a language-native way to specify. Some examples might be:</p>
<ul dir="auto">
<li>
<p dir="auto">You have a shared CI repo from which you need to access common shell scripts,
hosted build tasks, etc.</p>
</li>
<li>
<p dir="auto">You&#39;re building &amp; testing a backend application and need to test serving
frontend code from it, and your team has that frontend code in another
repository.</p>
</li>
<li>
<p dir="auto">Your team uses protocol buffers and you need to be able to import other loose
<code>.proto</code> files to generate your own code.</p>
</li>
</ul>
<p dir="auto"><code>vdm</code> lets you clearly specify all those remote dependencies &amp; more, and
retrieve them whenever you need them.</p>


<p dir="auto"><code>vdm</code> can be installed from <a href="https://github.com/opensourcecorp/vdm/releases">its GitHub Releases
page</a>. There is a zipped binary
for major platforms &amp; architectures, and those are indicated in the Asset file
name. For example, if you have an M2 macOS laptop, you would download the
<code>vdm_darwin-arm64.tar.gz</code> file, and extract it to somewhere on your <code>$PATH</code>.</p>
<p dir="auto">If you have a recent version of the Go toolchain available, you can also install
or run <code>vdm</code> using <code>go</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/opensourcecorp/vdm@&lt;vX.Y.Z|latest&gt;
# or
go run github.com/opensourcecorp/vdm@&lt;vX.Y.Z|latest&gt; ..."><pre>go install github.com/opensourcecorp/vdm@<span>&lt;</span>vX.Y.Z<span>|</span>latest<span>&gt;</span>
<span><span>#</span> or</span>
go run github.com/opensourcecorp/vdm@<span>&lt;</span>vX.Y.Z<span>|</span>latest<span>&gt;</span> ...</pre></div>

<p dir="auto">To get started, you&#39;ll need a <code>vdm</code> spec file, which is just a YAML (or JSON)
file specifying all your external dependencies along with (usually) their
revisions &amp; where you want them to live on your filesystem:</p>
<div dir="auto" data-snippet-clipboard-copy-content="remotes:

  - type:       &#34;git&#34; # the default, and so can be omitted if desired
    remote:     &#34;https://github.com/opensourcecorp/go-common&#34; # can specify as &#39;git@...&#39; to use SSH instead
    local_path: &#34;./deps/go-common&#34;
    version:    &#34;v0.2.0&#34; # tag example; can also be a branch, commit hash, or the word &#39;latest&#39;

  - type:       &#34;file&#34; # the &#39;file&#39; type assumes the version is in the remote field itself somehow, so &#39;version&#39; can be omitted
    remote:     &#34;https://raw.githubusercontent.com/googleapis/googleapis/master/google/api/http.proto&#34;
    local_path: &#34;./deps/proto/http/http.proto&#34;"><pre><span>remotes</span>:

  - <span>type</span>:       <span><span>&#34;</span>git<span>&#34;</span></span> <span><span>#</span> the default, and so can be omitted if desired</span>
    <span>remote</span>:     <span><span>&#34;</span>https://github.com/opensourcecorp/go-common<span>&#34;</span></span> <span><span>#</span> can specify as &#39;git@...&#39; to use SSH instead</span>
    <span>local_path</span>: <span><span>&#34;</span>./deps/go-common<span>&#34;</span></span>
    <span>version</span>:    <span><span>&#34;</span>v0.2.0<span>&#34;</span></span> <span><span>#</span> tag example; can also be a branch, commit hash, or the word &#39;latest&#39;</span>

  - <span>type</span>:       <span><span>&#34;</span>file<span>&#34;</span></span> <span><span>#</span> the &#39;file&#39; type assumes the version is in the remote field itself somehow, so &#39;version&#39; can be omitted</span>
    <span>remote</span>:     <span><span>&#34;</span>https://raw.githubusercontent.com/googleapis/googleapis/master/google/api/http.proto<span>&#34;</span></span>
    <span>local_path</span>: <span><span>&#34;</span>./deps/proto/http/http.proto<span>&#34;</span></span></pre></div>
<p dir="auto">You can have as many dependency specifications in that array as you want, and
they can be stored wherever you want. By default, this spec file is called
<code>vdm.yaml</code> and lives at the calling location (which is probably your repo&#39;s
root), but you can call it whatever you want and point to it using the
<code>--spec-file</code> flag to <code>vdm</code>.</p>
<p dir="auto">Once you have a spec file, just run:</p>

<p dir="auto">and <code>vdm</code> will process the spec file, retrieve your dependencies as specified,
and put them where you told them to go. By default, <code>vdm sync</code> also removes the
local <code>.git</code> directories for each <code>git</code> remote, so as to not upset your local
Git tree. If you want to change the version/revision of a remote, just update
your spec file and run <code>vdm sync</code> again.</p>
<p dir="auto">After running <code>vdm sync</code> with the above example spec file, your directory tree
would look something like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./vdm.yaml
./deps/
    go-common/
        &lt;stuff in that repo&gt;
    http.proto"><pre>./vdm.yaml
./deps/
    go-common/
        &lt;stuff in that repo&gt;
    http.proto</pre></div>

<p dir="auto"><code>vdm</code> is distributed as a statically-linked binary per platform that has no
language-specific dependencies. However, note that at the time of this writing,
<code>vdm</code> <em>does</em> depends on <code>git</code> being installed if you specify any <code>git</code> remote
types. <code>vdm</code> will fail with an informative error if it can&#39;t find <code>git</code> on your
<code>$PATH</code>.</p>

<p dir="auto"><code>vdm</code> has zero goals to be an authN/authZ manager. If a remote in your spec file
depends on a certain auth setup (an SSH key, something for HTTP basic auth like
a <code>.netrc</code> file, an <code>.npmrc</code> config file, etc.), that setup is out of <code>vdm</code>&#39;s
scope. If required, you will need to ensure proper auth is configured before
running <code>vdm</code> commands.</p>

<ul dir="auto">
<li>
<p dir="auto">Make the sync mechanism more robust, such that if your spec file changes to
remove remotes, they&#39;ll get cleaned up automatically.</p>
</li>
<li>
<p dir="auto">Add <code>--keep-git-dir</code> flag so that <code>git</code> remote types don&#39;t wipe the <code>.git</code>
directory at clone-time.</p>
</li>
<li>
<p dir="auto">Support more than just <code>git</code> and <code>file</code> types, and make <code>file</code> better</p>
</li>
</ul>
</article></div></div>
  </body>
</html>
