<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ohshitgit.com/">Original</a>
    <h1>Oh Shit, Git?!?</h1>
    
    <div id="readability-page-1" class="page"><div>
                <section>
                    
                    
                    <p>Git is hard: screwing up is easy, and figuring out how to fix your mistakes is fucking impossible. Git documentation has this chicken and egg problem where you can&#39;t search for how to get yourself out of a mess, <em>unless you already know the name of the thing you need to know about</em> in order to fix your problem.</p>

<p>So here are some bad situations I&#39;ve gotten myself into, and how I eventually got myself out of them <em>in plain english</em>.</p>

                </section>

                
                
                    <section>
                        <h2><a href="#magic-time-machine" id="magic-time-machine">Oh shit, I did something terribly wrong, please tell me git has a magic time machine!?!</a></h2>
                        <pre><code>git reflog
# you will see a list of every thing you&#39;ve 
# done in git, across all branches!
# each one has an index HEAD@{index}
# find the one before you broke everything
git reset HEAD@{index}
# magic time machine
</code></pre>
<p>You can use this to get back stuff you accidentally deleted, or just to remove some stuff you tried that broke the repo, or to recover after a bad merge, or just to go back to a time when things actually worked. I use <code>reflog</code> A LOT. Mega hat tip to the many many many many many people who suggested adding it!</p>

                    </section>
                
                    <section>
                        <h2><a href="#change-last-commit" id="change-last-commit">Oh shit, I committed and immediately realized I need to make one small change!</a></h2>
                        <pre><code># make your change
git add . # or add individual files
git commit --amend --no-edit
# now your last commit contains that change!
# WARNING: never amend public commits
</code></pre>
<p>This usually happens to me if I commit, then run tests/linters... and FML, I didn&#39;t put a space after an equals sign. You could also make the change as a new commit and then do <code>rebase -i</code> in order to squash them both together, but this is about a million times faster.</p>
<p><em>Warning: You should never amend commits that have been pushed up to a public/shared branch! Only amend commits that only exist in your local copy or you&#39;re gonna have a bad time.</em></p>

                    </section>
                
                    <section>
                        <h2><a href="#change-last-commit-message" id="change-last-commit-message">Oh shit, I need to change the message on my last commit!</a></h2>
                        <pre><code>git commit --amend
# follow prompts to change the commit message
</code></pre>
<p>Stupid commit message formatting requirements.</p>

                    </section>
                
                    <section>
                        <h2><a href="#accidental-commit-master" id="accidental-commit-master">Oh shit, I accidentally committed something to master that should have been on a brand new branch!</a></h2>
                        <pre><code># create a new branch from the current state of master
git branch some-new-branch-name
# remove the last commit from the master branch
git reset HEAD~ --hard
git checkout some-new-branch-name
# your commit lives in this branch now :)
</code></pre>
<p>Note: this doesn&#39;t work if you&#39;ve already pushed the commit to a public/shared branch, and if you tried other things first, you might need to <code>git reset HEAD@{number-of-commits-back}</code> instead of <code>HEAD~</code>. Infinite sadness. Also, many many many people suggested an awesome way to make this shorter that I didn&#39;t know myself. Thank you all!</p>

                    </section>
                
                    <section>
                        <h2><a href="#accidental-commit-wrong-branch" id="accidental-commit-wrong-branch">Oh shit, I accidentally committed to the wrong branch!</a></h2>
                        <pre><code># undo the last commit, but leave the changes available
git reset HEAD~ --soft
git stash
# move to the correct branch
git checkout name-of-the-correct-branch
git stash pop
git add . # or add individual files
git commit -m &#34;your message here&#34;;
# now your changes are on the correct branch
</code></pre>
<p>A lot of people have suggested using <code>cherry-pick</code> for this situation too, so take your pick on whatever one makes the most sense to you!</p>
<pre><code>git checkout name-of-the-correct-branch
# grab the last commit to master
git cherry-pick master
# delete it from master
git checkout master
git reset HEAD~ --hard
</code></pre>

                    </section>
                
                    <section>
                        <h2><a href="#dude-wheres-my-diff" id="dude-wheres-my-diff">Oh shit, I tried to run a diff but nothing happened?!</a></h2>
                        <p>If you know that you made changes to files, but <code>diff</code> is empty, you probably <code>add</code>-ed your files to staging and you need to use a special flag.</p>
<pre><code>git diff --staged
</code></pre>
<p>File under ¯\_(ツ)_/¯ (yes, I know this is a feature, not a bug, but it&#39;s fucking baffling and non-obvious the first time it happens to you!)</p>

                    </section>
                
                    <section>
                        <h2><a href="#undo-a-commit" id="undo-a-commit">Oh shit, I need to undo a commit from like 5 commits ago!</a></h2>
                        <pre><code># find the commit you need to undo
git log
# use the arrow keys to scroll up and down in history
# once you&#39;ve found your commit, save the hash
git revert [saved hash]
# git will create a new commit that undoes that commit
# follow prompts to edit the commit message 
# or just save and commit
</code></pre>
<p>Turns out you don&#39;t have to track down and copy-paste the old file contents into the existing file in order to undo changes! If you committed a bug, you can undo the commit all in one go with <code>revert</code>.</p>
<p>You can also revert a single file instead of a full commit! But of course, in true git fashion, it&#39;s a completely different set of fucking commands...</p>

                    </section>
                
                    <section>
                        <h2><a href="#undo-a-file" id="undo-a-file">Oh shit, I need to undo my changes to a file!</a></h2>
                        <pre><code># find a hash for a commit before the file was changed
git log
# use the arrow keys to scroll up and down in history
# once you&#39;ve found your commit, save the hash
git checkout [saved hash] -- path/to/file
# the old version of the file will be in your index
git commit -m &#34;Wow, you don&#39;t have to copy-paste to undo&#34;
</code></pre>
<p>When I finally figured this out it was HUGE. HUGE. H-U-G-E. But seriously though, on what fucking planet does <code>checkout --</code> make sense as the best way to undo a file? :shakes-fist-at-linus-torvalds:</p>

                    </section>
                
                    <section>
                        <h2><a href="#fuck-this-noise" id="fuck-this-noise">Fuck this noise, I give up.</a></h2>
                        <pre><code>cd ..
sudo rm -r fucking-git-repo-dir
git clone https://some.github.url/fucking-git-repo-dir.git
cd fucking-git-repo-dir
</code></pre>
<p>Thanks to Eric V. for this one. All complaints about the use of <code>sudo</code> in this joke can be directed to him.</p>
<p>For real though, if your branch is sooo borked that you need to reset the state of your repo to be the same as the remote repo in a &#34;git-approved&#34; way, try this, but beware these are destructive and unrecoverable actions!</p>
<pre><code># get the lastest state of origin
git fetch origin
git checkout master
git reset --hard origin/master
# delete untracked files and directories
git clean -d --force
# repeat checkout/reset/clean for each borked branch
</code></pre>

                    </section>
                

                <section>
                    
                    <p>*Disclaimer: This site is not intended to be an exhaustive reference. And yes, there are other ways to do these same things with more theoretical purity or whatever, but I&#39;ve come to these steps through trial and error and lots of swearing and table flipping, and I had this crazy idea to share them with a healthy dose of levity and profanity. Take it or leave it as you will!</p>
                </section>

                <section>
                    
                    <p>Many thanks to everyone who has volunteered to translate the site into new languages, you rock!

    
        <a href="https://github.com/michaeljabotha">
          Michael Botha
          </a> (<a href="https://slowernews.substack.com/af">af</a>) · 
    
        <a href="https://github.com/sheralam">
          Khaja Md Sher E Alam
          </a> (<a href="https://slowernews.substack.com/bn">bn</a>) · 
    
        <a href="https://github.com/edee111">
          Eduard Tomek
          </a> (<a href="https://slowernews.substack.com/cs">cs</a>) · 
    
        <a href="https://github.com/pReya">
          Moritz Stückler
          </a> (<a href="https://slowernews.substack.com/de">de</a>) · 
    
        <a href="https://github.com/francofantini">
          Franco Fantini
          </a> (<a href="https://slowernews.substack.com/es">es</a>) · 
    
        <a href="https://github.com/hamidmoheb1">
          Hamid Moheb
          </a> (<a href="https://slowernews.substack.com/fa">fa</a>) · 
    
        <a href="https://github.com/sjarva">
          Senja Jarva
          </a> (<a href="https://slowernews.substack.com/fi">fi</a>) · 
    
        <a href="https://github.com/michelc">
          Michel
          </a> (<a href="https://slowernews.substack.com/fr">fr</a>) · 
    
        <a href="https://github.com/Tzal3x">
          Alex Tzimas
          </a> (<a href="https://slowernews.substack.com/gr">gr</a>) · 
    
        <a href="https://github.com/eladleev">
          Elad Leev
          </a> (<a href="https://slowernews.substack.com/he">he</a>) · 
    
        <a href="https://github.com/aryansarkar13">
          Aryan Sarkar
          </a> (<a href="https://slowernews.substack.com/hi">hi</a>) · 
    
        <a href="https://github.com/quellcrist-falconer">
          Ricky Gultom
          </a> (<a href="https://slowernews.substack.com/id">id</a>) · 
    
        <a href="https://github.com/fedemcmac">
          fedemcmac
          </a> (<a href="https://slowernews.substack.com/it">it</a>) · 
    
        <a href="https://github.com/meih">
          Meiko Hori
          </a> (<a href="https://slowernews.substack.com/ja">ja</a>) · 
    
        <a href="https://github.com/zshanabek">
          Zhunisali Shanabek
          </a> (<a href="https://slowernews.substack.com/kk">kk</a>) · 
    
        <a href="https://github.com/ryanking13">
          Gyeongjae Choi
          </a> (<a href="https://slowernews.substack.com/ko">ko</a>) · 
    
        <a href="https://github.com/rahuldahal">
          Rahul Dahal
          </a> (<a href="https://slowernews.substack.com/ne">ne</a>) · 
    
        <a href="https://github.com/MartijntenHeuvel">
          Martijn ten Heuvel
          </a> (<a href="https://slowernews.substack.com/nl">nl</a>) · 
    
        <a href="https://github.com/lwojcik">
          Łukasz Wójcik
          </a> (<a href="https://slowernews.substack.com/pl">pl</a>) · 
    
        <a href="https://github.com/davialexandre">
          Davi Alexandre
          </a> (<a href="https://slowernews.substack.com/pt_BR">pt_BR</a>) · 
    
        <a href="https://github.com/catalinafox">
          Catalina Focsa
          </a> (<a href="https://slowernews.substack.com/ro">ro</a>) · 
    
        <a href="https://github.com/dadyarri">
          Daniil Golubev
          </a> (<a href="https://slowernews.substack.com/ru">ru</a>) · 
    
        <a href="https://github.com/GoodbyePlanet">
          Nemanja Vasić
          </a> (<a href="https://slowernews.substack.com/sr">sr</a>) · 
    
        <a href="https://github.com/cybear">
          Björn Söderqvist
          </a> (<a href="https://slowernews.substack.com/sv">sv</a>) · 
    
        <a href="https://github.com/kitt-tientanopajai">
          Kitt Tientanopajai
          </a> (<a href="https://slowernews.substack.com/th">th</a>) · 
    
        <a href="https://github.com/tpaksu">
          Taha Paksu
          </a> (<a href="https://slowernews.substack.com/tr">tr</a>) · 
    
        <a href="https://github.com/LastGenius-edu">
          Andriy Sultanov
          </a> (<a href="https://slowernews.substack.com/ua">ua</a>) · 
    
        <a href="https://github.com/taojy123">
          Tao Jiayuan
          </a> (<a href="https://slowernews.substack.com/zh">zh</a>)
    
. With additional help from 
    
        <a href="https://github.com/alliejones">Allie Jones</a> · 
    
        <a href="https://github.com/vorot93">Artem Vorotnikov</a> · 
    
        <a href="https://github.com/davidfyffe">David Fyffe</a> · 
    
        <a href="https://github.com/DirtyF">Frank Taillandier</a> · 
    
        <a href="https://github.com/imurray">Iain Murray</a> · 
    
        <a href="https://github.com/LucasLarson">Lucas Larson</a> · 
    
        <a href="https://github.com/mvrzvbvk">Myrzabek Azil</a>
    
</p>

<p>If you&#39;d like to help add a translation into your language, submit a PR on <a href="https://github.com/ksylor/ohshitgit"><svg xmlns="http://www.w3.org/2000/svg" fill="#222222" viewBox="0 0 1024 1024"><path fill-rule="evenodd" clip-rule="evenodd" d="M512 0C229.12 0 0 229.12 0 512c0 226.56 146.56 417.92 350.08 485.76 25.6 4.48 35.2-10.88 35.2-24.32 0-12.16-.64-52.48-.64-95.36-128.64 23.68-161.92-31.36-172.16-60.16-5.76-14.72-30.72-60.16-52.48-72.32-17.92-9.6-43.52-33.28-.64-33.92 40.32-.64 69.12 37.12 78.72 52.48 46.08 77.44 119.68 55.68 149.12 42.24 4.48-33.28 17.92-55.68 32.64-68.48-113.92-12.8-232.96-56.96-232.96-252.8 0-55.68 19.84-101.76 52.48-137.6-5.12-12.8-23.04-65.28 5.12-135.68 0 0 42.88-13.44 140.8 52.48 40.96-11.52 84.48-17.28 128-17.28 43.52 0 87.04 5.76 128 17.28 97.92-66.56 140.8-52.48 140.8-52.48 28.16 70.4 10.24 122.88 5.12 135.68 32.64 35.84 52.48 81.28 52.48 137.6 0 196.48-119.68 240-233.6 252.8 18.56 16 34.56 46.72 34.56 94.72 0 68.48-.64 123.52-.64 140.8 0 13.44 9.6 29.44 35.2 24.32C877.44 929.92 1024 737.92 1024 512 1024 229.12 794.88 0 512 0z" fill="#1B1F23"></path></svg>GitHub</a></p>
                </section>
            </div></div>
  </body>
</html>
