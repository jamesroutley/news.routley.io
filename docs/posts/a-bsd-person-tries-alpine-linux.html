<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rubenerd.com/a-bsd-pserson-trying-alpine-linux/">Original</a>
    <h1>A BSD person tries Alpine Linux</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>In February last year I wrote about <a href="https://rubenerd.com/its-worth-running-a-freebsd-or-netbsd-desktop/">running a FreeBSD desktop</a>, and concluded that sometimes you need to give yourself permission to tinker.</p>
<p>Well recently I’ve started tinkering with <a href="https://www.alpinelinux.org/">Alpine Linux</a>! It’s been recommended to me for years, so I’m finally getting around to checking it out. There’s a lot to like if you come from BSD, which we’ll dig into here.</p>
<figure><p><a target="_BLANK" href="https://rubenerd.com/files/2024/alpine-ovm-boot.png"><img src="https://rubenerd.com/files/2024/alpine-ovm-boot.png" alt="Booting a new Alpine ISO on OrionVM"/></a></p></figure>
<h3 id="a-potted-history">A potted history</h3>
<p>The Alpine website <a href="https://www.alpinelinux.org/about/">describes it as</a>:</p>
<blockquote>
<p>an independent, non-commercial, general purpose Linux distribution designed for power users who appreciate security, simplicity and resource efficiency.</p>
</blockquote>
<p>Its small footprint and design decisions also make it more secure:</p>
<blockquote>
<p>All userland binaries are compiled as Position Independent Executables (PIE) with stack smashing protection. These proactive security features prevent exploitation of entire classes of zero-day and other vulnerabilities.</p>
</blockquote>
<p>Natanael Copa discussed the genesis of the project back in 2005, making it older than I realised. Like the BSDs, it’s found its way into embedded systems, routers, and mobile devices, as well as general purpose servers and desktops.</p>
<p>Alpine is also a popular base for use in Linux containers, owing to its compact size and limited dependencies. There are also <a href="https://github.com/alpinelinux/alpine-chroot-install/">toolchains</a> for easily running it in a <code>chroot(8)</code>, which is interesting for someone who uses <a href="https://man.netbsd.org/chroot.8">NetBSD chroots(8)</a> and <a href="https://docs.freebsd.org/en/books/handbook/jails/">FreeBSD jails</a> extensively for testing and deployments.</p>
<h3 id="installation">Installation</h3>
<p>Alpine comes in a <a href="https://alpinelinux.org/downloads/">few different versions</a>, including builds for ARM, PPC64, x86, and x86_64.</p>
<p>I downloaded the Xen ISO image because I was booting it on a VM at work, before realising I misread <em>Dom0</em> as <em>DomU</em>. The former refers to a Xen hypervisor, not a guest. Either way, it booted and installed the same as a standard ISO.</p>
<p>The install process is about as simple as you could make it. You log into the live environment with <code>root</code> and no password, then execute <code>setup-alpine</code>.</p>
<p>You’re asked basic questions for your keymap, networking, timezone, and root authentication. You can also inject an SSH key from the start, which is useful if you’re deploying a fleet of VMs or servers with an orchestration tool after the fact, or you’re deploying to a mediocre hosting provider that doesn’t give you an OOB console.</p>
<p>You’re also given the choice of a few different SSH servers and ntp clients, which let me choose my preferred OpenSSH and openntpd. It also correctly identified it was operating under Xen.</p>
<figure><p><a target="_BLANK" href="https://rubenerd.com/files/2024/alpine-install.png"><img src="https://rubenerd.com/files/2024/alpine-install.png" alt="Screenshot of a portion of the Alpine Linux installer, showing the mirror selection, user config, and Xen installation."/></a></p></figure>
<p>It can also configure an LVM, but I stuck with what Alpine calls standard <code>sys</code> partitions for now. This uses <code>ext4</code>.</p>
<h3 id="post-install-and-exploration">Post-install and exploration</h3>
<p>Booting into Alpine for the first time, your given a hint as to why it’s special: <code>dmesg(1)</code> informs you you’re running <a href="https://github.com/OpenRC/openrc">OpenRC</a>! It’s portable, small, fast, efficient, transparent, and secure. It’s also very familiar to a BSD person used to writing rc scripts. <code>/etc/rc.conf</code> and <code>crond(8)</code>!? <strong>Yes!!!</strong></p>
<p>At the risk of embellishing my feelings about this, it is <em>such</em> a relief that there are Linux distros like Devuan, Gentoo, and Alpine using this. It’s a breath of alpine air, and has legitimately made Linux fun again.</p>
<figure><p><a target="_BLANK" href="https://rubenerd.com/files/2024/alpine-openrc.png"><img src="https://rubenerd.com/files/2024/alpine-openrc.png" alt="Screenshot showing dmesg output on first boot."/></a></p></figure>
<p>Along with OpenRC, Alpine is bundled with <a href="https://wiki.alpinelinux.org/wiki/Musl">musl</a>, and runs busybox. Both are obviously more limited than GCC and the GNU coreutils, but they further contribute to the base system’s smaller size and attack surface. <a href="https://pkgs.alpinelinux.org/package/edge/main/x86_64/llvm-runtimes">llvm</a> is also available, as is the <a href="https://pkgs.alpinelinux.org/package/edge/main/x86_64/mksh">MirBSD Korn shell</a>, one of my two preferred interactive shells.</p>
<blockquote>
<p>Um, Ruben, I’d like to interject for a moment. What you are referring to as Linux, is in fact, GNU/Linux, or as I’ve recently taken to calling it, a GNU grilled cheese sandwich merely featuring Linux as the…</p>
</blockquote>
<p>… nope!</p>
<h3 id="packages">Packages</h3>
<p>Speaking of installing packages, let’s take a look at that. Alpine’s default package manager is <a href="https://docs.alpinelinux.org/user-handbook/0.1a/Working/apk.html" title="Working with the Alpine Package Keeper">apk</a>. As is normal on Linux, this handles updating the base system and all packages, because it makes no distinction. I’d be interested to see if I could also run an unprivileged copy of this as I like to do on the BSDs, but I haven’t checked yet. There’s also <a href="https://www.pkgsrc.org/#index2h3">pkgsrc</a>, so no biggie.</p>
<p>Configuration is in <code>/etc/apk/repositories</code>, where you can enable the community repo by uncommenting the second URL supplied by the installer. Alpine also has a <code>testing</code> repo, and you can add your own.</p>
<p>Usage is easy, though I’ve still been mistyping <code>apt install</code> instead of <code>apk add</code>, because old habits die hard. There’s an official <a href="https://pkgs.alpinelinux.org">web interface</a>, and Alpine repos are on <a href="https://alpine.pkgs.org/">pkgs.org</a>.</p>
<p>A few packages later, and I had my “essentials” going, like I do on my <a href="https://rubenerd.com/my-freebsd-laptop-with-just-tmux/" title="My FreeBSD laptop... without a GUI!?">console-only laptop</a>:</p>
<figure><p><a href="https://rubenerd.com/files/2024/alpine-stuff.png"><img src="https://rubenerd.com/files/2024/alpine-stuff.png" alt="Alpine running tmux, htop, zpool, and cmatrix."/></a></p></figure>
<p>Perhaps the package I was most surprised about was zfs. It was literally two commands to install and load the kernel module (though obviously root on ZFS would be more involved). What that would look like after an upgrade I’d have to see, but thus far I’m impressed.</p>
<pre><code># apk add zfs zfs-lts
# modprobe zfs
</code></pre>
<h3 id="conclusion">Conclusion</h3>
<p>I’ve barely scratched the surface, but there’s enough here for me to seriously consider a switch to it as my primary Linux distro for testing and servers. I love that <code>htop(1)</code> and <code>lsof(1)</code> only shows a small list of recognisable processes, that it uses OpenRC, that package management seems straight forward, and that it’s so simple to configure. I’ve wondered what a modern, functional “Occam’s Linux” would look like. This is it.</p>
<p>I’d be interested in seeing if <a href="https://github.com/uutils/coreutils">uutils</a> runs if I need something more than busybox, but for a server I doubt it.</p>
<figure><p><img src="https://rubenerd.com/files/2024/alpine-alpine.png" alt="Alpine running the Alpine mail client"/></p></figure>
<p><em>I heard you liked Alpine, so I etc…</em></p>
</div></div>
  </body>
</html>
