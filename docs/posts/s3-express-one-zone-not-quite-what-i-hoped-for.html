<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jack-vanlightly.com/blog/2023/11/29/s3-express-one-zone-not-quite-what-i-hoped-for">Original</a>
    <h1>S3 Express One Zone, not quite what I hoped for</h1>
    
    <div id="readability-page-1" class="page"><div id="siteWrapper">

      

      

      
        
          
            
              
                
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" data-content-field="main-content" data-collection-id="56894f3ea12f44306f8afde0" data-edit-main-image="">
         <div>

  
  <article id="article-6567362db2cf1f28e3b26f23" data-item-id="6567362db2cf1f28e3b26f23">

    

    <div>
      
        <div data-layout-label="Post Body" data-type="item" data-updated-on="1701262960108" id="item-6567362db2cf1f28e3b26f23"><div><div><div data-block-type="2" id="block-a804046e74aa11a0efdc"><div>

<div>
  <p>AWS just announced a new <a href="https://aws.amazon.com/s3/storage-classes/express-one-zone/">lower-latency S3 storage class</a> and for those of us in the data infrastructure business, this is big news. It’s not a secret that a low-latency object storage primitive has the potential to change how we build cloud data systems forever. So has this new world arrived with S3 Express One Zone?</p><p>The answer is no, but this is a good time to talk about cloud object storage, its role in modern cloud data systems and the potential future role it can take.</p><p>Please note that when I say S3, I’m talking about cloud object storage in general unless specifically S3 Express 1Z.</p><p>The holy grail of storage is simply:</p><ol data-rte-list="default"><li><p>Cheap.</p></li><li><p>Durable and consistent.</p></li><li><p>Low-latency and high throughput.</p></li></ol><p>S3 Standard can be cheap and most definitely is highly durable. It’s Achilles heel is the high, unpredictable latency. Cheap, durable storage makes it the best place to store large volumes of data and many systems today already do that. However, the high latency is a problem and depending on the workload, data system builders must go through many hoops to integrate S3 into the architecture to benefit from the economical storage but dodging the latency bullet.</p><p>I wrote about this topic in my opening post on <a href="https://jack-vanlightly.com/blog/2023/11/14/the-architecture-of-serverless-data-systems">The Architecture of Serverless Data Systems</a>. Quoting myself:</p><blockquote><p>Engineers can choose to include object storage in their low-latency system but counter the latency issues of object storage by placing a durable, fault-tolerant write-cache and predictive read-cache that sits in front of the slower object storage. This durable write-cache is essentially a cluster of servers that implement a replication protocol and write data to block storage. In the background, the cluster uploads data asynchronously to object storage obeying the economic pattern of writing fewer, larger files.</p></blockquote>
</div>






















</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1701262961415_60396"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          
        

        
          
          <figcaption>
            <p>Fig 1. The data systems from chapters 1-5 of Architecture of Serverless Data Systems, and their choices for integrating cloud object storage.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1701262961415_60747"><div>

<div>
  <p>Building a replication layer in front of S3 is frankly, a lot of work but many systems take this approach because they want all three properties from their storage layer. This is actually what Kora (<a href="https://jack-vanlightly.com/analyses/2023/11/14/kora-serverless-kafka-asds-chapter-2">chapter 2</a>) and Neon (<a href="https://jack-vanlightly.com/analyses/2023/11/15/neon-serverless-postgresql-asds-chapter-3">chapter 3</a>) chose to implement: a highly available, fault-tolerant, write-through, read-through cache in front of S3. In the case of Kora, this replicated cache is formed by the Kora brokers (Kafka Replication protocol); and in the case of Neon, it is the Safekeepers (Multi-Paxos) and Pageservers.</p><p>There are downsides to this approach:</p><ol data-rte-list="default"><li><p>Implementing Paxos, Raft or the Kafka replication protocol is a tremendous amount of work.</p></li><li><p>Replicating data across availability zones is expensive.</p></li></ol><p>But there is an major upside: These replicated, fault tolerant caches provide predictable low latency operations. These caches simply make some workloads possible that would not be possible with S3 Standard alone. This upside is the difference between having a viable infrastructure business and not.</p><p>Of course some systems are able to speak only to S3, such as Clickhouse Cloud (chapter 5 WIP) but CHC has much looser latency and data consistency requirements. For CHC, S3 Standard makes an excellent primary (and only) data store. For those of us that build systems with tighter constraints, we are waiting for the holy grail: an S3 storage class that is cheap, durable AND low-latency.</p>
</div>






















</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1701262961415_58572"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          
        

        
          
          <figcaption>
            <p>Fig 2. The holy grail is still out there.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1701262961415_58950"><div>

<div>
  <p>Express One Zone does not tick the “cheap” checkbox and so the replicated, fault-tolerant cache implementations can continue to sleep easy that they are still relevant and highly valuable.</p><p>As of today, S3 Express One Zone is not so compelling to data systems that offer low-latency workloads using replicated caches. The costs of Express 1Z is very similar to that of the existing cross-AZ charges and yet most data system vendors can apply significant discounts to their AZ charges. Some choose to deploy to a single-zone, avoiding the cross-AZ charges completely, making the cost imbalance between the replicated cache and this S3 storage class even greater.</p><p>So it doesn’t make much sense to replace replication with S3 as it would end-up far more expensive. Then there’s the cost of the storage itself which is 8 times more expensive than S3 standard.</p><p>However, a low-latency S3, while being expensive, might be attractive to the new start-up. Not having to build the replication layer is a significant time saver and if the start-up can eat the higher costs of this storage class, then may be it makes sense.</p>
</div>






















</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1701262961415_87951"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          
        

        
          
          <figcaption>
            <p>Fig 3. System builders have a 4th choice for integrating cloud object storage.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1701262961415_88308"><div>

<p>My feeling on S3 Express One Zone is it’s the right technology, at the right time with the wrong price. The holy grail of cloud storage is still out there, the only question is how long we’ll have to wait.</p>






















</div></div></div></div></div>
      
    </div>

    

    

  </article>

  

  

  
  
  

</div>
        </div><!--
        -->
        
        
      </main>

      

      

    </div></div>
  </body>
</html>
