<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jrhawley.ca/2023/08/07/blocked-by-cloudflare">Original</a>
    <h1>Blocked by Cloudflare</h1>
    
    <div id="readability-page-1" class="page"><div>
    

    <div id="post">
      
      <article id="post-content">
        <p>Well, it finally happened to me.
I was blocked out of a website I need for work because of Cloudflare.
And I have no idea if or when I’ll be let back in.</p>

<h2 id="cloudflares-secure-connection-loop">Cloudflare’s secure connection loop</h2>

<p>The story begins with Cloudflare.
<a href="https://cloudflare.net">Cloudflare</a> is a company that provides <a href="https://en.wikipedia.org/wiki/Content_delivery_network">content delivery networking</a>, <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">distributed denial-of-service prevention</a>, and other networking infrastructure services to large parts of the internet.
The decisions that this company makes have broad impacts for individuals, companies, and anything that relies on the internet, as their <a href="https://web.archive.org/web/20230731093909/https://cloudflare.net/home/default.aspx">homepage describes</a>.</p>

<p><img src="https://0x539.lol/assets/data/blocked-by-cloudflare/cloudflare-homepage.png" alt="Cloudflare&#39;s homepage demonstrating how broad their reach on the internet is -60%"/></p>

<p>Many websites that use Cloudflare’s services deploy a <a href="https://developers.cloudflare.com/fundamentals/security/browser-integrity-check/">“browser integrity check”</a> before you can access their site.
In theory, this is to keep bad actors, unscrupulous bots, and other undesirables off of your website to keep your traffic costs down and ensure your website is interacting with a genuine human using your site for a purpose you intended.
But often there are issues with these security pages that cause problems for users who are just minding their own business and genuinely trying to access the site with good intentions.</p>

<p>One such issue is the “secure connection loop”.
You type the URL for the site you want to visit in the address bar, Cloudflare intercepts that request, and puts up a security page that says “Checking if the site connection is secure”.
That page looks like this:</p>

<p><img src="https://0x539.lol/assets/data/blocked-by-cloudflare/secure-connection-loop.png" alt="Cloudflare&#39;s secure connection loop -60%"/></p>

<p>The issue is that sometimes you can never get past this page.
The loading symbol just keeps spinning, but the check never completes.
Or maybe the page refreshes and asks you to verify you are a human for a second time.
Then it refreshes again, and again, and again.
So even though you are a human who is jumping through the hoops Cloudflare demands you jump through, they throw away that hoop and ask you to jump through another one, or else they won’t let you through.</p>

<p>This is a common enough problem that when you search for “Cloudflare checking if the site connection is secure”, you see one result for Cloudflare’s official documentation and every other result asking about how to get around these pages because users are stuck at them.</p>

<p><img src="https://0x539.lol/assets/data/blocked-by-cloudflare/cloudflare-browser-integrity-check-loop.png" alt="Cloudflare&#39;s browser integrity check causes lots of problems for lots of users -60%"/></p>

<p>This is what happened to me when I tried to access a page on <a href="https://gitlab.com">GitLab</a> for some scientific software I was checking out for work on my work computer.
<a href="https://web.archive.org/web/20230603165446/https://about.gitlab.com/blog/2020/01/16/gitlab-changes-to-cloudflare/">GitLab starting using Cloudflare in 2020</a>, so naturally I was met their their “browser integrity check page”.
But no matter what I did, I was stuck in that “secure connection loop”.
I have no idea why.
I checked the developer console for errors and tried to fix them.
I temporarily disabled extensions.
I opened a private browsing window.
I restarted my computer.
Nothing worked.</p>

<h2 id="getting-around-the-secure-connection-loop">Getting around the secure connection loop</h2>

<p>Because I needed to check out this software, I read a bunch of those search results to see if I could get around Cloudflare’s check.
Eventually, I found some suggestions that if you’re using Firefox you can disable the <code>privacy.resistFingerprinting</code> option in the <code>about:config</code> page.
But that was already listed as <code>false</code> for me when I got stuck, so I switched the value to <code>true</code> just to see if that would do anything.</p>

<p>And that worked!
I navigated straight through the browser integrity check and was able to check out the software I wanted to look at.
Problem solved.</p>



<p>Just kidding, my problem was only temporarily relieved.
And this, in fact, made my situation much worse.</p>

<p>The next day, I tried accessing a web page internal to my company that I need for my work and I was met with this page:</p>

<p><img src="https://0x539.lol/assets/data/blocked-by-cloudflare/access-denied.png" alt="Cloudflare denying me access to an internal work website -80%"/></p>

<p>To recap: I couldn’t get past a security check page because of issues in Cloudflare’s software.
Because of that, I enabled a single privacy-preserving feature in my browser to bypass the faulty page.
As a result, I was then blocked on an <em>unrelated</em> website that I need for work.</p>

<p>The silliness of it all is that I was on my work device the whole time, which was behind my workplace VPN.
And you can’t access this VPN without specific security certificates being installed on the device.
Worse yet, I know that Cloudflare knows I have those certificates.
Why?
Because it asked for them!</p>

<p><img src="https://0x539.lol/assets/data/blocked-by-cloudflare/certificate-check.png" alt="Cloudflare&#39;s browser integrity check asking for certificates -60%"/></p>

<p>Cloudflare has extremely reliable data to attest that I am in fact the person I say I am:</p>

<ul>
  <li>user-specific security certificates</li>
  <li>corporate VPN IP addresses</li>
  <li><del>MAC IP address of my machine that I have previously used to access this site</del> <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup></li>
</ul>

<p>But it actively ignores this information in favour of a <em>hint that maybe, there is a possibility that I might, in some possible universe, be doing something I wouldn’t normally do</em>.</p>

<p>I didn’t install some sketchy extension.
I’m not connecting over a headless browser.
I didn’t change the user agent string.
I didn’t try to access the website over Tor or some unconventional protocol.
I only changed one privacy-preserving setting in my browser.
Even reverting the setting to its previous value didn’t change anything.
But now resources that I absolutely need for work are in jeopardy and there’s no easy recourse for me to resolve these issues.
And need I remind you that the only reason I enabled this option in the first place was to get around Cloudflare’s faulty security in the first place?</p>

<h2 id="what-i-think-happened">What I think happened</h2>

<p>What I suspect happened is that the secure connection loop caused my browser to request access to a single page many times in a short time span.
Cloudflare detected the high frequency of requests and denials (but not their faulty loop that caused this pattern of requests, of course), and tagged my browser as suspicious.
When I then blocked fingerprinting to get around the page, it worked initially, but Cloudflare eventually identified the series of events as nefarious and marked me with their scarlet letter.
So now I have no idea when that page will work for me again.
Maybe I’ll have to dig through the corporate directory to find the sysadmin responsible for this page to see if they can enable my access again.
Who knows how much time that will waste.</p>

<h2 id="what-about-google-chrome">What about Google Chrome?</h2>

<p>I tried all of the above in Firefox.
So I naturally tried to access the same page in Google Chrome to see if I’d still be blocked.
Thankfully, I wasn’t.</p>

<p>But of course I wasn’t because Chrome doesn’t have the same privacy- and security-enhancing designs that Firefox does.
Chrome will happily collect as much private information about me and my browsing history and share them with select parties, as needed.
It also doesn’t resist fingerprinting or let me modify settings to the same degree that Firefox does because Chrome relies on those fingerprinting technologies to ensure that I am targeted by ads it deems necessary for me to see.</p>

<p>Being blocked on Firefox and not blocked on Chrome also tells me that Cloudflare is blocking me based on the fingerprint (or lackthereof) of my browser.
Everything about my connection is identical between the two requests, aside from the browser being used.
It’s the same security certificates, same corporate VPN, same machine, even the same timeframe when I try to access the site.</p>

<h2 id="what-next">What next?</h2>

<p>For the foreseeable future, I have to use Chrome to access this internal work site.
I may also have to do this for other sites, because I don’t know how many internal and external websites are “secured” by Cloudflare that may block me, now.
I could try reinstalling Firefox and to see if that changes anything.
But at this point I’m just guessing what I could do to solve my problems.
And if I’ve learned anything from the events above it’s that guessing with stuff like this can make my situation much worse with little to no recourse.</p>

<h2 id="implications-for-the-web-in-general">Implications for the web, in general</h2>

<p>These types of experiences are precisely the things that worry me about the future of the web.
I have strong proof that I am who I say I am, but because I took <em>one step out of lockstep with what was expected of me by others that I can’t communicate with</em>, I’m blocked from accessing resources that I need.
My case is obviously only one small example.
But it is an example that makes my livelihood more difficult and fragmented.</p>

<p>Similar remote attestation and “security” measures could just as easily target things like online banking, which would interfere with just about every aspect of a person’s life.
And this isn’t just hypothetical examples, mind you.
Anyone who uses a de-Googled Android  phone has to go to great lengths to ensure hardware attestation is working correctly, like <a href="https://web.archive.org/web/20230804211102/https://grapheneos.org/articles/attestation-compatibility-guide">GrapheneOS documents here</a>, or else they can’t using banking apps.
There is scant middle ground between accessing your money on your device and letting Google monitor your every interaction with that device.</p>

<p>Proposals for the future of the web that leave more power with unaccountable corporations and less with the individual will inevitably lead to more situations like this where individuals are left scrambling to figure out the Kafka-esque and invisible rules that they must follow to meet the ever-changing whims of these corporate entities.
I feel confident in making bold statements like this because companies, governments, and regulatory bodies across the world have repeatedly and overwhelmingly made decisions that favour corporate and governmental control over individual freedoms, rights, and privacy over the past 20 years.
Only in the last few years have legal frameworks with actual teeth started going after companies that routinely violate privacy laws, <a href="https://web.archive.org/web/20230806213720/https://edpb.europa.eu/news/news/2023/12-billion-euro-fine-facebook-result-edpb-binding-decision_en">like the 1.2 B EUR fine levied against Facebook due to its GDPR violations</a>.
But these legal decisions don’t happen without huge fights and blowbacks from tech companies.</p>

<p>The <a href="https://web.archive.org/web/20230806074908/https://github.com/RupertBenWiser/Web-Environment-Integrity">Web Integrity API proposal</a> that has <a href="https://news.ycombinator.com/item?id=36817305">so</a> <a href="https://vivaldi.com/blog/googles-new-dangerous-web-environment-integrity-spec/">many</a> <a href="https://news.ycombinator.com/item?id=36875940">people</a> <a href="https://web.archive.org/web/20230805180900/https://arstechnica.com/gadgets/2023/07/googles-web-integrity-api-sounds-like-drm-for-the-web/">and</a> <a href="https://web.archive.org/web/20230805183646/https://github.com/mozilla/standards-positions/issues/852">companies</a> in uproar about the future of the web is precisely this kind of proposal.
If and when financial companies opt in to remote attestation policies for their websites, it will place greater restrictions on the types of hardware, operating systems, and software individuals can use.
I understand that there are legitimately good reasons to block certain combinations of hardware and software, say old devices with known vulnerabilities that cannot get patched.
But decisions like this from corporate entities always seem to have <a href="https://en.wikipedia.org/wiki/Motivated_reasoning">motivated reasoning</a> that increases the control of corporations at the cost of the freedoms or rights of individuals.</p>

<p>Take the first example of the Web Integrity API proposal:</p>

<blockquote>
  <p>Users like visiting websites that are expensive to create and maintain, but they often want or need to do it without paying directly.
These websites fund themselves with ads, but the advertisers can only afford to pay for humans to see the ads, rather than robots.
This creates a need for human users to prove to websites that they’re human, sometimes through tasks like challenges or logins.</p>
</blockquote>

<p>Within two sentences, the authors are able to present the needs of advertisers as if they were synonymous with the needs of individuals.
And in the third sentence they put the onus on the individual to do something about it.
Is it relevant that the authors all work for Google, which makes most of its money from advertising?</p>

<p>Similarly, the <a href="https://web.archive.org/web/20230525235848/https://arstechnica.com/information-technology/2022/10/passkeys-microsoft-apple-and-googles-password-killer-are-finally-here/">introduction of passkeys</a> is a useful proposal that could go multiple ways.
More secure access to websites that also provides a simpler user experience is undoubtedly a win-win.
But like I mentioned above in my experience with Cloudflare, I already had very strong data to prove that I was who I said I was and they blocked me anyway.
How am I to know whether these synced SSH keys that are unique to a single domain won’t get overlooked by Cloudflare or similar service providers?
And if these passkeys are going to form the backbone of how I interact with almost any website, how much control over them will I have?
A small list of important questions I have about using passkeys are:</p>

<ul>
  <li>Will I be able to create and sync these passkeys myself?</li>
  <li>Can only certain types of software use passkeys? If so, who decides what software meets this standard?</li>
  <li>Will I only be able to generate passkeys on a device with specific hardware/software requirements like a <a href="https://web.archive.org/web/20230315091828/https://support.microsoft.com/en-us/topic/what-is-tpm-705f241d-025d-4470-80c5-4feeb24fa1ee">TPM</a>, <a href="https://web.archive.org/web/20230720061011/https://developer.apple.com/documentation/devicecheck">DeviceCheck</a>, or <a href="https://web.archive.org/web/20230802195352/https://developer.android.com/google/play/integrity">Integrity API</a>?</li>
  <li>Can I, at any time, export my passkeys from one service provider and switch to another provider?</li>
  <li>If a passkey is invovled in a suspicious event, will that suspicious mark propogate to any other device that uses that same passkey?</li>
  <li>Do devices that contain suspicious passkeys also get marked as suspicious? If so, would that impact the ability of that device to access other independent websites?</li>
</ul>

<p>I’m not a sysadmin or network engineer, so answers to these questions are simply beyond my expertise.
There are other, more important questions I focus on in my day job and I simply do not have the time to become a computer security expert as well.
As much as I’d love to use a simpler and standardized authentication method that is more secure than passwords, the central question of how much control I have over my data and how that is respected by others is critical when considering the benefits of ceding control over to corporate entities.
And that is a separate question from how much it will even matter if, at the end of the day, some other company with <a href="https://www.devever.net/~hl/cloudflare">dubious practices and origins</a> will just do their own thing anyway?</p>

<p>Passwords, for all their faults, have one fundamentally stellar property by nature: <strong>individuals make them for themselves</strong>.
Individuals can make them on whatever device they own.
Individuals can make them how they want.
Individuals can manage them how they like.
Certain people or tools or companies can make it easier to manage and use your passwords, but ultimately passwords are made by, and belong to, the individual.</p>

<p>VPNs, certificates, fingerprinting, and other technologies are ways of addressing the shortcomings of passwords and computer security.
But if I have to give up all pretense of privacy to do basic things, and might still get blocked anyway, how much is any of this stuff helping?</p>





      </article>
      <!-- <div id="post-comments">
          
          <div class="comments">
  <script src="/assets/js/webmention.min.js" async></script>
  <div id="webmentions"></div>
</div>

          
        </div> -->
    </div>

    
  </div></div>
  </body>
</html>
