<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://research.google/blog/unlocking-the-power-of-time-series-data-with-multimodal-models/">Original</a>
    <h1>Unlocking the power of time-series data with multimodal models</h1>
    
    <div id="readability-page-1" class="page"><div data-gt-publish-date="20241125">
                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    




    <p data-block-key="h3lap">The successful application of machine learning to understand the behavior of complex real-world systems from healthcare to climate requires robust methods for processing <a href="https://en.wikipedia.org/wiki/Time_series" target="_blank" rel="noopener noreferrer">time series</a> data. This type of data is made up of streams of values that change over time, and can represent topics as varied as a patient’s <a href="https://en.wikipedia.org/wiki/Electrocardiography" target="_blank" rel="noopener noreferrer">ECG</a> signal in the <a href="https://en.wikipedia.org/wiki/Intensive_care_unit" target="_blank" rel="noopener noreferrer">ICU</a> or a <a href="https://cloud.google.com/blog/topics/sustainability/weather-prediction-with-ai" target="_blank" rel="noopener noreferrer">storm system moving across the Earth</a>.</p><p data-block-key="djbhr">Highly capable multimodal foundation models, such as <a href="https://deepmind.google/technologies/gemini/pro/" target="_blank" rel="noopener noreferrer">Gemini Pro</a>, have recently burst onto the scene and are able to reason not only about text, like the large language models (LLMs) that preceded them, but also about other modalities of input, including images. These new models are powerful in their abilities to consume and understand different kinds of data for real-world use cases, such as <a href="https://arxiv.org/abs/2404.18416v2" target="_blank" rel="noopener noreferrer">demonstrating expert medical knowledge</a> or <a href="https://arxiv.org/abs/2312.11805" target="_blank" rel="noopener noreferrer">answering physics questions</a>, but haven’t yet been leveraged to make sense of time-series data at scale, despite the clear importance of this type of data. As chat interfaces mature generally across industries and data modalities, products will need the ability to interrogate time series data via natural language to meet user needs. When working with time series data, previous attempts to improve performance of LLMs have included <a href="https://arxiv.org/pdf/2305.15525" target="_blank" rel="noopener noreferrer">sophisticated prompt tuning and engineering</a> or <a href="https://arxiv.org/pdf/2408.07773" target="_blank" rel="noopener noreferrer">training a domain specific encoder</a>.</p><p data-block-key="99bn3">Today we present work from our recent paper, “<a href="https://arxiv.org/abs/2410.02637" target="_blank" rel="noopener noreferrer">Plots Unlock Time-Series Understanding in Multimodal Models</a>”, in which we show that for multimodal models, much like for humans, it is easier to make sense of the data visually by looking at plots of the data rather than sifting through the raw time-series values themselves. Importantly, we show that this does not require any expensive additional training, and instead relies on the native multimodal capabilities of these foundation models. Compared to only using a text format for prompting a multimodal model, we demonstrate that using plots of the time series data can increase performance on classification tasks up to 120%.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h2>Investigation overview</h2>
            
        
        
    </p>



    <p data-block-key="h3lap">We investigated the hypothesis that multimodal models understand time-series data better through their vision encoders than through the textual representation of long arrays of floating point numbers. We tested both synthetic tasks that we devised to allow us to probe specific types of reasoning, and real-world tasks that contain representatively noisy data whose analysis is important for advancing digital health. For each task we ran experiments using a <i>text method</i> and a <i>plot method</i> to prompt the model with the time-series data. The text method used the raw time-series data to create a series of numbers that were used directly to prompt the model. The plot method took the raw time-series data, created a visual plot of that data and then used an image of the plot to prompt the model. To show that this generalizes across different foundation models, we performed experiments on both small and large models of two best-of-class families of frontier models: <a href="https://deepmind.google/technologies/gemini/pro/" target="_blank" rel="noopener noreferrer">Gemini Pro 1.5</a> and <a href="https://openai.com/index/hello-gpt-4o/" target="_blank" rel="noopener noreferrer">GPT4o</a>, and two smaller models <a href="https://deepmind.google/technologies/gemini/flash/" target="_blank" rel="noopener noreferrer">Gemini Flash 1.5</a> and <a href="https://openai.com/index/gpt-4o-mini-advancing-cost-efficient-intelligence/" target="_blank" rel="noopener noreferrer">GPT4o-mini</a>.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h2>Real world digital health tasks</h2>
            
        
        
    </p>



    <p data-block-key="h3lap">We tested our approach on anonymized real world data collected from research study participants through mobile or wearable devices for health-relevant tasks.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h3>Detecting falls</h3>
            
        
        
    </p>



    <p data-block-key="h3lap">One such task that we explored was using a publicly available <a href="https://www.frdr-dfdr.ca/repo/dataset/6998d4cd-bd13-4776-ae60-6d80221e0365" target="_blank" rel="noopener noreferrer">IMU (Inertial Measurement Unit) dataset</a> curated and labeled for fall detection, since <a href="https://link.springer.com/article/10.1186/1475-925X-12-66" target="_blank" rel="noopener noreferrer">falls are an important health risk</a>, especially amongst the older and more vulnerable people. <a href="https://en.wikipedia.org/wiki/Inertial_measurement_unit" target="_blank" rel="noopener noreferrer">IMU sensors</a> report six dimensions of acceleration and angular velocity data sampled at over 100Hz and are commonly found in today&#39;s smartphones and smartwatches. In this task, we instruct the models to classify the sensor data into normal daily living without a fall, near falls, or actual falls. A <a href="https://pilotfeasibilitystudies.biomedcentral.com/articles/10.1186/s40814-020-00748-1#:~:text=A%20near%2Dfall%20is%20defined,recovery%20manoeuvres%20are%20not%20executed." target="_blank" rel="noopener noreferrer">near fall</a> is characterized as a loss of balance that would result in a fall if sufficient balance recovery maneuvers are not executed. Identifying when a near fall is occurring is important, since older adults may not recognize it as one; <a href="https://www.sciencedirect.com/science/article/abs/pii/S0003999309000860" target="_blank" rel="noopener noreferrer">near falls may also predict the risk of true falls</a>. This particular dataset was deliberately curated to include examples where the user had a near fall, such as a recovering from a slip without actually falling, making it more challenging to determine whether the user actually had a fall.</p><p data-block-key="945oe">This task was structured as a few-shot task, where the model was shown a number of IMU time-series examples for each outcome before being asked to classify an IMU time-series example that it had not seen before.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <p data-block-key="h3lap">Overall the plot method outperformed the text method on this task and, in general, improved as more few-shot examples were provided. This indicated that the models were able to extract additional information from the few-shot examples when they were presented as plots.</p>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h3>Recognizing physical activity</h3>
            
        
        
    </p>



    <p data-block-key="h3lap">We also used IMU data for a different task, in which we tested the models’ abilities to discriminate the type of physical activity being performed by a user between sitting, standing, using stairs, walking or biking. This kind of <a href="https://ieeexplore.ieee.org/abstract/document/7742959" target="_blank" rel="noopener noreferrer">activity recognition is regularly used</a> in fitness and wellbeing products that users rely on to track and improve their physical health. The <a href="https://dl.acm.org/doi/10.1145/2809695.2809718" target="_blank" rel="noopener noreferrer">publicly available dataset we used</a> was designed to collect IMU data from a variety of different devices such as phones and smartwatches, with this heterogeneity of data sources increasing the difficulty of the classification task.</p><p data-block-key="bemnk">We presented this as a few-shot prompt to the models and, like the fall detection task, we find that the plot-based approach outperforms the text-based method. Again increasing the number of few-shot examples generally increased the plot performance in most models.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h2>Synthetic tasks</h2>
            
        
        
    </p>



    <p data-block-key="h3lap">Having shown that plots improve model performance in contexts that are relevant to digital health, we also investigated model performance in synthetic experiments of our own design. We did this to probe performance generally on tasks of increasing difficulty and reasoning sophistication, ranging from naming the pattern being plotted to multiple choice questions a university calculus student might encounter.</p><p data-block-key="18jce">The simplest synthetic task we used was functional form identification, where the model had to classify a series of data points into the type of underlying function that created it, such as a linear or quadratic. With this relatively simple task the median classification accuracy of the plot method was up to 120% better than the text method, indicating that when presented visually as a plot, the multimodal foundation models could more easily understand the overall trend and discern the underlying function than when they were just provided the raw data.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <p data-block-key="h3lap">A harder task involved synthetic data series where the data was clustered in 1 to 9 discrete clusters and the model was asked to count the number of clusters in the data. The plot method had a 55-85% lower mean absolute error than the text method.</p>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <p data-block-key="h3lap">Additional synthetic tasks we tested include classifying linear correlations and identifying derivatives, which also generally showed that the plot performance was better than, or at least as good as, the text performance.</p>

    </div>
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h3>The art of the chart</h3>
            
        
        
    </p>



    <p data-block-key="h3lap">Having shown that for time-series data, the reasoning power of these foundation models are best leveraged through plots, we also investigated whether the models preferred any specific style of plot. We tried many different aesthetic choices such as changing the color scheme, marker size and axis display, but in the end found that there wasn’t a strong dependence of the results on these choices.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h3>A picture is worth 1,000 words</h3>
            
        
        
    </p>



    <p data-block-key="h3lap">Beyond the performance gain of the models ingesting plots over text, we also found that using plots made more efficient use of the limited context window of the models we studied. The fundamental reason for this is the mechanism in which multimodal models ingest either textual or visual information – when presented as numeric strings, time series data must be split into many granular tokens that the model ingests, while a plotted image is more efficiently represented with fewer tokens. As a result, plotting a time-series made more efficient use of available model context lengths, especially in cases where passing the full textual form of a time-series would generate more tokens than the model can ingest.</p><p data-block-key="3jcsh">We also found that the cost of reasoning about a plotted time-series could be up to 10x cheaper than reasoning about its textual representation, as model API cost increases with the number of input tokens.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h2>Conclusion</h2>
            
        
        
    </p>



    <p data-block-key="h3lap">Our results show that plotting as an approach amplifies the capabilities of multimodal models currently available to consumers to make sense of complicated time-series data. Our work sets the stage for increasing the power of tools and assistants powered by multimodal models to incorporate time-series data for end-user benefit.</p>
</div>

    </div>
</section>

                    
                    
    


<section>
    <div>
        
  <div data-gt-id="rich_text" data-gt-component-name="">
    


    <p>
        
            
                <h2>Acknowledgements</h2>
            
        
        
    </p>



    <p data-block-key="h3lap"><i>We would like to acknowledge Mayank Daswani for leading this work and all the collaborators across Google including Desislav Ivanov, Mikhail Papkov, Eva Schnider, Jing Tang, Kay Lamerigts, Gabriela Botea, Michael Sanchez, Yojan Patel, Shruthi Prabhakara, Shravya Shetty and Umesh Telang for contributing to the research and to Sebastien Baur, Yun Liu and Diego Ardila for their valuable input. We also want to thank Tiya Tiyasirichokchai for designing the graphic for this post and Dr. Stephen Robinovitch for granting permission to include plots of examples from the IMU Fall Detection dataset.</i></p>
</div>

    </div>
</section>

                    
                </div></div>
  </body>
</html>
