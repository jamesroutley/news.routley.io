<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.airgradient.com/open-airgradient/instructions/diy-pro-v37/">Original</a>
    <h1>AirGradient Open Source Air Quality Monitor for CO2 and PM2.5 Measurements</h1>
    
    <div id="readability-page-1" class="page"><div>

<p><strong>Please note that these are the instruction for the DIY PRO PCB Version 3.7+ that has a configuration button. If you have the older version without button, please follow <a href="https://www.airgradient.com/open-airgradient/instructions/diy-pro/">these instructions</a>.</strong></p>
<h2 id="intro">Introduction</h2>
<p>The AirGradient Pro DIY monitor measures PM2.5, CO2, temperature and humidity. These measures can be shown on the display and sent to a server (e.g. the AirGradient platform or any other cloud backend) for data logging.</p>
<p>The AirGradient Pro version has the following advantages compared to the DIY Basic Kit:</p>
<ul>
<li>Highly extendable e.g. with a TVOC or barometric pressure sensor, a battery charger, RGB LEDs, etc.</li>
<li>More accurate measurement for temperature as the enclosure has been designed for enhanced airflow and the temperature sensor is separated from the other components.</li>
<li>Larger OLED display allowing more information to be displayed.</li>
</ul>
<p>You can completely build the monitor on your own with the instructions below and open-source code or, optionally you can go to our <a href="https://www.airgradient.com/open-airgradient/shop">online shop</a> and purchase it as a kit that includes a professional enclosure. We also offer the kit as a <a href="https://www.airgradient.com/open-airgradient/shop">pre-soldered version</a> for a very easy assembly.</p>
<p>IMPORTANT: For the pre-soldered version, follow these <a href="https://www.airgradient.com/open-airgradient/instructions/diy-pro-presoldered/">instructions</a>.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/pro_overview.jpg"/></p><p>Fully assembled AirGradient DIY PRO kit.</p>
</div>
<h2 id="skills">Skills And Equipment Required</h2>
<p>For this project you should be familiar with the following:</p>
<table>
<thead>
<tr>
<th>Skill</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Soldering skills</td>
<td>Most of the components we use need <a href="https://www.makerspaces.com/how-to-solder/">soldering</a>. The USB and PMS connectors are small and therefore difficult to solder but these connectors are optional and the monitor can also be built without them.</td>
</tr>
<tr>
<td>Soldering Iron &amp; Solder</td>
<td>To solder the component pins and cables.</td>
</tr>
<tr>
<td>Breadboard</td>
<td>A breadboard is helpful to fix the components in place during soldering.</td>
</tr>
<tr>
<td>Computer</td>
<td>A Linux, Mac, or Windows computer with the Arduino IDE installed to flash the software onto the D1 Mini. You can also flash the software directly from the browser.</td>
</tr>
<tr>
<td>USB-C Data Cable</td>
<td>A USB-C cable for flashing the microcontroller and later powering it. If you use the enclosure, you need a 90 degree USB-C cable plug.</td>
</tr>
</tbody>
</table>
<p>In case you are unfamiliar with soldering or want to get the monitoring working as quickly as possible, we also have <a href="https://www.airgradient.com/open-airgradient/shop">pre-soldered</a> kits available, which can be assembled in just a few minutes with no soldering needed.</p>
<h2 id="components">Components</h2>
<p>Below is the list of components that you need to source, with a link to AliExpress and typical price ranges. Please note we have no association with the linked sellers and only provide the links as an example of the components, not an endorsement of a seller or a guarantee of the linked product quality.</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Approx. Price</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.aliexpress.com/item/32529101036.html">Wemos D1 Mini v4 USB-C</a></td>
<td>USD 4 - 6</td>
</tr>
<tr>
<td><a href="https://aliexpress.com/item/32787898780.html">1.3&#34; OLED display</a></td>
<td>USD 3 - 5</td>
</tr>
<tr>
<td><a href="https://www.aliexpress.com/item/32944660534.html">Plantower PMS5003 PM Sensor</a></td>
<td>USD 15 - 20</td>
</tr>
<tr>
<td><a href="https://www.aliexpress.com/item/1005004123170360.html">Senseair S8 CO2 Sensor</a></td>
<td>USD 25 - 30</td>
</tr>
<tr>
<td><a href="https://www.aliexpress.com/item/32678741657.html">SHT31 Temperature and Humidity Sensor Module</a></td>
<td>USD 3 - 5</td>
</tr>
<tr>
<td><a href="https://www.lcsc.com/product-detail/_Omron-Electronics-_C93157.html">Button</a></td>
<td>&lt; USD 1</td>
</tr>
<tr>
<td>USB-C Connector 6 Pin</td>
<td>&lt; USD 1</td>
</tr>
<tr>
<td>JST Connector 1.25mm 8 Pin for PMS</td>
<td>&lt; USD 1</td>
</tr>
<tr>
<td>Resistors 5.1KΩ (2x) and 10KΩ (1x)</td>
<td>&lt; USD 1</td>
</tr>
<tr>
<td>Female Pin Headers</td>
<td>&lt; USD 1</td>
</tr>
<tr>
<td>Screws</td>
<td>PMS Sensor: M2*4.5 (Torx M6), PCB: M1.7x5 (Philips/Torx M6), Enclosure: M1.7x10 (Philips/Torx M6). The longest screws are for the enclosure. The screws with the washer are for the PCB and the remaining screws for the PMS Sensor.</td>
</tr>
<tr>
<td>USB-C Cable 90 degrees</td>
<td>USD 3 - 6</td>
</tr>
<tr>
<td>PCB</td>
<td>See <a href="#pcb">below</a> on how to make a PCB</td>
</tr>
<tr>
<td>Enclosure</td>
<td>See <a href="#enclosure">below</a> on how to 3D print the enclosure</td>
</tr>
<tr>
<td>SGP 30 TVOC Sensor (Optional)</td>
<td>USD 8 - 15 (not included in the AirGradient Kit)</td>
</tr>
</tbody>
</table>
<p>AliExpress might not ship to all countries. In case they do not ship to your country, please try and source the exact same component from elsewhere.</p>
<p>You can also purchase the kit with all required components from our <a href="https://www.airgradient.com/open-airgradient/shop">Online Store</a> and be sure that everything fits. We ship world-wide.</p>
<h2 id="schematics">Schematics</h2>
<p>You can use the following schematics:</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/schematicpro37.png"/></p><p>The schematics</p>
</div>
<h2 id="pcb">Make Your Own PCBs</h2>
<p>In case you want to make your own PCB you can use our <a href="https://www.airgradient.com/documents/gerber/gerber_diy_pro_v37.zip">Gerber files</a>.</p>
<h2 id="software">Direct Flashing Through The Browser</h2>
<p>You can either manually flash the code through the Arduino software or use the more simple buttons below.</p>
<p>Connect the D1 Mini to your computer through a data-capable cable and press the button below. Make sure you use the Chrome or Edge browsers on your computer for this to work.</p>


<table>
<thead>
<tr>
</tr></thead>
<tbody>
<tr>
<td>
Firmware for PCB Version 3.7+ including code for optional AirGradient SGP41 TVOC / NOx Module
</td>
<td>
<esp-web-install-button manifest="/documents/fw/37/diypro_37.json">

<span slot="unsupported">Your browser doesn&#39;t support this. Please use Chrome or Edge on Mac or PC.</span>
<span slot="not-allowed">You are not allowed to use this on HTTP!</span>
</esp-web-install-button>
</td>
</tr>
</tbody>
</table>
<p>Once the code is flashed, it will open a hotspot for 60 seconds to which you can connect and then set your Wi-Fi credentials. By default it will connect to the AirGradient Dashboard. If you want to use another endpoint you can change the code with the manual flashing method below.</p>
<p>If you do not connect it to Wi-Fi within the 60 seconds after startup it will go into the offline mode and show the air quality parameters without sending the data.</p>
<p>If you flash with the method above, you can skip the next section and continue at the section <a href="#instructions">“Soldering the Components”</a>.</p>
<h2 id="software">Manual Flashing With The Arduino Software</h2>
<p>The above direct flashing is the easiest way to get the firmware onto the D1 Mini but if you want to make changes to the code, you can also flash the code through the Arduino software environment. All software for the AirGradient DIY sensor is open source and thus you can make any changes you’d like.</p>
<p>Please read the following blog post on how to install the Arduino software, set up the D1 Mini board and the AirGradient Arduino library.</p>
<p><a href="https://www.airgradient.com/open-airgradient/instructions/basic-setup-skills-and-equipment-needed-to-build-our-airgradient-diy-sensor/">AirGradient Arduino Software Setup Instructions</a></p>
<h2 id="software">Flashing Of The AirGradient Firmware</h2>
<p>Once you have the Arduino Software setup for the D1 Mini, you can flash it with the AirGradient firmware.</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Go to Tools, Manage Libraries, and then search for AirGradient and install the AirGradient library.</td>
</tr>
<tr>
<td>2</td>
<td>Once it is installed, go to File, Example, AirGradient and select the DIY_PRO_V3_7 code</td>
</tr>
<tr>
<td>3</td>
<td><strong>Read the instructions on top of the example code</strong> and install the additional libraries</td>
</tr>
<tr>
<td>4</td>
<td>Then flash this code the same way you flashed the BLINK example</td>
</tr>
<tr>
<td>5</td>
<td>Once you have successfully uploaded the code you can continue building the hardware</td>
</tr>
</tbody>
</table>
<h2 id="software">Configuration</h2>
<p>With the button, you can set the configuration of the display. Press the button on start up and it will enter a menu. In the menu you can set the unit for PM2.5 (μg/m³ or US AQI), the temperature unit (°C or °F) and also rotate the display.</p>
<h2 id="instructions">Soldering The Components</h2>
<p>Now that you have the firmware flashed, you can solder the components onto the PCB. Make sure you solder the pins in the correct direction.</p>
<div>
<p><img src="https://www.airgradient.com/images/pro_parts_on_pcb.jpg"/></p><p>Location of the Components on the PCB</p>
</div>
<p>We recommend you start in the following order:</p>
<h3 id="instructions">OLED Display Soldering</h3>
<p>To fit the OLED display perfectly into the enclosure, the pins need to be adjusted because they reach out too far. Please follow these three steps:</p>
<ol>
<li>Remove the black spacer with a small screwdriver or with a small pair of pliers (see Step 1 in the figure below)</li>
<li>Take the hot soldering iron and push the pins inwards so that they do not stand out too much anymore (see Step 2)</li>
<li>To ensure that the pins still have strong contact with the display, add some solder on the backside around the pins (see Step 3)</li>
</ol>
<div>
<p><img src="https://www.airgradient.com/images/diy/oled_preparation.jpg"/></p><p>Steps to adjust the Display Pins</p>
</div>
<ol start="4">
<li>Put the OLED display through the PCB and mount it into the enclosure. Make sure you tighten all four screws of the PCB. Move the OLED so that it is correctly aligned and use tape to temporarily fix it in place.</li>
<li>From the opposite side, check that the display is properly aligned.</li>
<li>Solder the display as quickly as possible to prevent damage to the enclosure (melting or deformation from the soldering heat). Put the soldering iron at the lowest temperature that still ensures proper contact. After the soldering is done, immediately use a fan to cool down the solder points as fast as possible.</li>
<li>Clip off the outstanding pins and carefully remove the tape without damaging the display cable.</li>
</ol>
<div>
<p><img src="https://www.airgradient.com/images/diy/oled_to_pcb.jpg"/></p><p>
Soldering the OLED Display onto the PCB
</p>
</div>
<h3 id="instructions">D1 Mini Soldering</h3>
<p>We recommend to solder all components with pin sockets so that it is easier to replace components or troubleshoot if something does not work.</p>
<p>Important: If you solder the D1 directly on the board, leave enough space between the D1 and the PCB so that you can plug in the USB cable.</p>
<p>First solder the female pin headers onto the PCB where it says: “Microcontroller”.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/wemos2.jpg"/></p><p>Pin Sockets on PCB</p>
</div>
<p>Then solder the male pins onto the D1 Mini.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/wemos1.jpg"/></p><p>D1 Mini soldering</p>
</div>
<p>Then you can put the D1 Mini onto the PCB. Make sure that the orientation is correct and that all pins go into the socket.</p>
<h3 id="instructions">Soldering The SHT31 Module (Temperature and Humidity)</h3>
<p>To solder the small pins onto the SHT31 module, you can use a breadboard to fix the pins into place. No need to do anything with the two pins on the top of the sensor. Only solder the four pins at the bottom of the module.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/sht31pins.jpg"/></p><p>Soldering Pins onto the SHT Module</p>
</div>
<p>Then solder female pin headers onto the board. The SHT is located at the far isolated corner of the PCB to help ensure accurate temperature measurement.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/sht1.jpg"/></p><p>SHT placement with pin sockets</p>
</div>
<p>Then put the SHT31 module onto the pin socket and make sure you have it on in the correct direction.</p>
<h3 id="instructions">Soldering The Senseair S8 Module (CO2 Sensor)</h3>
<p>To solder the small pins onto the S8 module, you can use a breadboard to fix the pins into place.</p>
<p>Make sure that the pins face upwards as can be seen on below image.</p>
<p>Important: Compared to the smaller DIY Basic kit, the pins here are soldered the opposite way to enhance the accuracy and airflow around the sensor.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/s8.jpg"/></p><p>Senseair S8 pin header soldering</p>
</div>
<p>Solder female pin headers onto the PCB. Then put the S8 onto the pin headers.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/s8_2.jpg"/></p><p>Female pin headers soldering for the Senseair S8</p>
</div>
<h3 id="instructions">Connecting The PMS5003 (PMS Sensor) Cable </h3>
<p>The PMS Sensor is connected with a cable to the PCB. There are two ways to connect it. If you can solder the small JST connector, then solder it on the board:</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/pms1.jpg"/></p><p>PMS JST Connector</p>
</div>
<p>Make sure it is soldered in the correct way (as indicated with the silkscreen and can be seen in the image above).</p>
<p>In case you cannot solder these small pins, you can also cut and splice the cable and solder it directly onto the PCB.</p>
<p>Prepare the following four wires as per this image. Please make sure you cut the correct wires.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/ag_diy_pms_cable.jpg"/></p><p>PMS Cable Wiring</p>
</div>
<p>NOTE: It can be confusing that the default cable of the PMS has a black cable for VCC as normally VCC uses red color.</p>
<p>Solder the cable onto the PCB. Please make sure that you solder the correct cable to the correct pin.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/pms2.jpg"/></p><p>PMS PCB Connection</p>
</div>
<p>After you have soldered the cable onto the PCB, connect the PMS5003 with the other end of the cable. Then screw the PMS5003 onto the PCB.</p>
<h3 id="instructions">USB-C Connector</h3>
<p>If you are confident with soldering the small pads, you can solder the USB-C connector onto the board.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/usbc.jpg"/></p><p>USB C Connector and Resistors</p>
</div>
<p>Note that you cannot flash the device through this USB-C port. It only provides power. To flash the D1, you need to connect the cable directly to the MCU.</p>
<p>If you want to use the monitor with smart power adapters (e.g. ones providing a range of voltages), you need to also solder two 5.1k resistors onto the board. If you just want to use a normal 5V power adapter you do not need to do this.</p>
<p>Alternatively, you can use the bigger hole on the back of the enclosure to feed the cable in and connect it directly to the D1. Then you do not need to solder the USB-C connector. Please note that only a straight USB-C cable fits through the hole. So if you get the 90-degree cable from our kit but do NOT want to solder the USB-C connector, you either need to make the hole larger or get a straight USB-C cable.</p>
<h3 id="instructions">Button</h3>
<p>It is important that you solder the button so that you can use our software and are able to switch different configurations (e.g. Fahrenheit, Celcius etc.). A 10k resistors is also required so that the button works.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/probutton.png"/></p><p>Button and Resistor</p>
</div>
<h3 id="instructions">Optional SGP41 AirGradient TVOC / NOx Module</h3>
<p>If you purchased the AirGradient TVOC / NOx module, you can solder female pin headers onto one of the top I2C slots and plug the module in there.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/i2ctvoc.png"/></p><p>Slot for AirGradient TVOC / NOx Module</p>
</div>
<p>Please note that if you want to use some 3rd party TVOC modules, you might need to remove the pull-up resistors as the I2C bus already has the SHT and OLED module which both already have pull ups. We strongly recommend you use the AirGradient module which does not have pull-up resistors.</p>
<h3 id="instructions">Testing And Putting It Into The Enclosure</h3>
<p>Now you can power on the device and you should be able to see the display lighting up. If you flashed the Wi-Fi version, you need to connect it to the Wi-Fi. To do this open you Wi-Fi settings on the phone and look for a hot spot called “AirGradient______”. Then connect to it and enter your Wi-Fi network credentials. It will then connect to Wi-Fi and start displaying and sending the air quality data.</p>
<p>In case you have any issue, check this guide or get help from the <a href="https://forum.airgradient.com">Open AirGradient Forum</a>.</p>
<p>If everything works, you can screw the PCB into the top cover of the enclosure and close the enclosure.</p>
<h2 id="enclosure">3D Enclosure</h2>
<p>You can download STL 3D printer files to print an enclosure that exactly fits the PCB. The 3D enclosure consists of three parts: a top, a bottom and a back cable connection part. The ZIP file also contains the STEP file so that you can make adjustments.</p>
<p><a href="https://www.airgradient.com/open-airgradient/instructions/diy-pro/diy_pro_3d.zip">Download Enclosure STL Files</a></p>
<p>If you do not want to print, our <a href="https://www.airgradient.com/open-airgradient/kits">DIY PRO Kit</a> includes a high-quality UV-resistant injection molded plastic enclosure.</p>
<div>
<p><img src="https://www.airgradient.com/images/diy/diy_pro_3d_front.jpg"/></p><p>3D printable PRO enclosure</p>
</div>
<h2 id="enclosure">Solutions For Schools</h2>
<p>AirGradient offers a sophisticated, powerful and responsive <a href="https://www.airgradient.com/">Air Quality Monitoring Solution for Schools</a>. You can connect these DIY monitors to the AirGradient platform, integrate with many existing brands or use our professional AirGradient ONE monitor.</p>
<p>If you are interested in a free trial of the solution for schools, please contact us.</p>
<h2 id="dashboard">AirGradient Dashboard</h2>
<p>Our kits come with several months of free subscription to the AirGradient dashboard. To connect your monitor to the dashboard, please follow these <a href="https://www.airgradient.com/open-airgradient/instructions/diy-connect-to-dashboard/">instructions</a>.</p>
<h2 id="license">CC BY-NC 4.0 Attribution-NonCommercial 4.0 International</h2>
<p>This work is licensed under <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1">CC BY-NC 4.0</a>.</p>
<p>This license requires that reusers give credit to the creator. It allows reusers to distribute, remix, adapt, and build upon the material in any medium or format, for noncommercial purposes only.</p>
<p>Copyright AirGradient Co. Ltd.</p>
<p><a href="https://github.com/airgradienthq/arduino" target="_blank">Find the code on GitHub
</a>
</p></div></div>
  </body>
</html>
