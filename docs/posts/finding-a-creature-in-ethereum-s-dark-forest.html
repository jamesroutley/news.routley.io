<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bertcmiller.com/2021/12/28/glimpse_nonce_reuse.html">Original</a>
    <h1>Finding a Creature in Ethereum&#39;s Dark Forest</h1>
    
    <div id="readability-page-1" class="page"><article itemscope="" itemtype="http://schema.org/BlogPosting">

    
  
    <div>
  <p>Last week a monster in Ethereum’s dark forest revealed itself to me. 16 hours prior to their reveal I had laid down cryptographic bait after hearing of its existence from <a href="https://twitter.com/__tux">tux</a>. I expected it, but it was still surprising to refresh Etherscan and see that all my Ether was gone.</p>
  
  <p>This monster was watching Ethereum for an obscure mistake deep in the process of creating a transaction: the reuse of a number while signing a transaction. I went searching for this creature, laid bait, saw it in the wild, and found unexplained tracks. To understand how this bot works, we need to begin by reviewing ECDSA and digital signatures.</p>
  
  <p><i><p>(You can also read this post on <a href="https://twitter.com/bertcmiller/status/1475844939816833032">Twitter</a>)</p></i></p>
  
  <p>Underpinning the two largest cryptocurrencies - Bitcoin and Ethereum - is the elliptic curve digital signature algorithm, or ECDSA. As the name suggests ECDSA is a scheme for producing digital signatures. These signatures are how we prove ownership of our accounts and assets. Each signature proves two things:</p>
  <ol><li>That you possess some secret called a private key. Every private key is tied to a publicly known key called a public key. Your crypto “address” is a public key.</li><li>That you used your private key to sign a particular message. In our case messages are transactions.</li></ol>
  
  <p>ECDSA works because of the fact that you can easily use a private key to generate a public key, but you can’t use a public key to derive a private key. You can, however, use a signature to back out a private key under some limited conditions. This gets somewhat technical, but bear with me.</p>
  
  <p>To generate signatures ECDSA takes a private key <i>d</i>, a random number <i>k</i>, and the hash of a message <i>h</i>. It combines these with <i>Q</i> the public key associated with the private key <i>d</i>, as well as two numbers that are standardized by the ECDSA algorithm, <i>G</i> and <i>n</i>. Together these are used to compute a digital signature with the following algorithm:</p>
  
  <p><img src="https://latex.codecogs.com/svg.image?r&amp;space;=&amp;space;k&amp;space;*&amp;space;G&amp;space;\mod&amp;space;n" title="r = k * G \mod n"/></p></div></article></div>
  </body>
</html>
