<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sprocketfox.io/xssfox/2025/02/09/ido/">Original</a>
    <h1>Bad Smart Watch Authentication</h1>
    
    <div id="readability-page-1" class="page"><article class="blog-post">
      
  <p>(tl;dr - If you are using a cheap smart watch, probably don’t. If you want to skip to the juicy bit  jump to <a href="#Authentication">“Authentication”</a>)</p>
<p>As with most complicated things in my life, it started with a simple question.</p>
<blockquote>
<p>Do you know how to get the data off this watch?</p>
</blockquote>
<p>Surely there’s an export feature in the app to a common file format like GPX, TCX or FIT. That’s pretty standard. Yet we couldn’t find a way. The only share and export functionality just provided an image with some stats on it.</p>
<p>Also given Android’s lockdown on the file system (to the point that you can no longer backup your phone!) there was no way to access the DB to obtain data (without root anyway).</p>
<p>Investigating the Ryze Android app I quickly discovered that this is a white label of an <a href="https://www.idoosmart.com">IDO smart watch</a>.</p>
<figure>
    <img src="https://sprocketfox.io/xssfox/images/d8af747d4b0edba65a0b3c0029911821.png" alt="Screenshot of the IDO and Ryze website showing practically the same watch"/>
    <figcaption></figcaption>
</figure>
<figure>
    <img src="https://sprocketfox.io/xssfox/images/ff03975d5f7b71bcbf7f43cb9e1e439e.png" alt="Screenshot of the IDO and Ryze website showing the same smart band"/>
    <figcaption></figcaption>
</figure>
<p>It got me thinking - could I pick up one of these watches for a lot cheaper to play with. Eventually I landed on searching Amazon. The hardest part was working out if it was actually an IDO based device. I discovered what worked well was looking for watches that use the “VeryFit” app which is the IDOs stock app. There’s actually a bunch of watches that use this app. I found one for a low price of $39 (AUD) and free next day shipping.</p>
<figure>
    <img src="https://sprocketfox.io/xssfox/images/e6ffd88e21a4c957a49aff8ba15c1afc.png" alt="Telegram message : So why did you buy a knockoff apple watch from amazon?"/>
    <figcaption></figcaption>
</figure>
My partner however was a little confused. The watch came in some shiny packaging without mentioning its brand. To be honest I’m pretty impressed with what you can get for $39 these days.
<figure>
    <img src="https://sprocketfox.io/xssfox/images/891a8f6a954fb8b49cfcab0fedc44332.png" alt="Box with shiny logo that says Smart Watch on my desk"/>
    <figcaption></figcaption>
</figure>
<figure>
    <img src="https://sprocketfox.io/xssfox/images/0d40043d2ab1a20aefde00236d6e9248.png" alt="The watch on my wrist"/>
    <figcaption></figcaption>
</figure>
<p>Hilariously I paired my IDO watch with the Ryze app and it just worked fine. I wasn’t actually expecting that to work but it seemed ok with it.</p>
<p>Would I buy one? yes - as a Bluetooth Low Energy reverse engineering example device otherwise no. Onwards to reverse engineering!</p>
<h3 id="to-the-cloud">To the cloud</h3>
<p>The first thing I looked at was syncing data from the cloud. This was pretty easy and basically just required following the same request flow as the phone. It however has some drawbacks, you still need to use the app, and you need to have an account. I didn’t really progress any further with this - but it is a viable way forward with those limitations.</p>
<h3 id="getting-data-off-watch-directly">Getting data off watch directly</h3>
<p>I’m going to skip past dealing with authentication for the moment as that gets a little spicy and we don’t want to ruin the standard story telling plot framework.</p>
<p>Once connected and authenticated the device presents a bluetooth service at <code>0AF0</code> which provides several characteristics. The import ones to us are a subscription to <code>0AF7</code>  - this is where data from the watch to the phone is sent while <code>0AF6</code> allows us to send commands.</p>
<p><code>adb logcat</code> and <code>BlueSee.app</code> were lifesavers here. The app logs a lot of information about what its doing and how its working. You can pretty much work out everything from using the app with <code>adb logcat</code> running then emulating that flow with <code>BlueSee.app</code>. Also what helps is that the developers seemed to have a scattering of their documentation and source code on GitHub and some of the other vendors shipping these have done the same. Not all the source code is available which would have made reverse engineering just a little bit easier but its a good start.</p>
<p>So we send commands by writing to <code>0AF6</code>. The easiest first set is <code>0x0201</code> which provides some basic device info. The device will write back to <code>0AF7</code> with the returned data. For these <code>0x02....</code> commands the return data will be structured like:</p>
<pre tabindex="0"><code>02 - Header
01 - CMD (get basic info)
.. - Reply data structure (device)
.. -                      (firmware version )
..
..
</code></pre><p>Data is little endian.</p>
<h4 id="v3-protocol">V3 protocol</h4>
<p>Getting activity data we need to use the “v3” protocol. These commands have the first byte a <code>0x33</code> or “3” in ASCII.</p>
<p>The v3 protocol can have data be split over multiple transmissions - a requirement of using this style BLE. So that the watch and phone can know that a new command has started rather than a continuation there’s a preamble <code>DAADDAAD</code>. This is just an utterly weird design choice given all the other features in BLE  that could have been used. There’s then a service selectorish thing,  length, command, sequence fields, followed by data and eventually a CRC.</p>
<p>To send a request to get the last activity I use the following command:</p>
<pre tabindex="0"><code>0x33 - &#39;3&#39; version protocol
0xDA - this is preamble to detect new command midway through
0xAD - preamble
0xDA - preamble
0xAD - preamble
0x01 - health?
0x10 - length (without &#39;3&#39; and checksum (last two bytes) - aka minus 3 on single packets)
0x00 - length
0x04 - cmd
0x00
0x0B - sequence - can just pick anything
0x01 - sequence
0x00 - start / stop
0x04 - cmd
0x00
0x00
0x00 - checksum
0x00 - checksum
</code></pre><h4 id="checksum-calculation">Checksum calculation</h4>
<p>I think its just some sort of CRC16 however I’m not sure which because the device I have never checked it so I never bothered working it out.</p>
<h4 id="v3-return-data">V3 return data</h4>
<p>The return contains much of the same header. You can use the sequence numbers to line things up with you have to handle queueing of data and multiple requests.</p>
<p>Activity data is nearly always split over multiple packets so just read in the subscription until the data received matches the provided length in the header or until you see another preamble.</p>
<p>Then its a matter of unpacking the data. Noting that you’ll have arrays of varying lengths.</p>
<p>You might be thinking that this protocol will be stripped down to save transfer speed, however the protocol sends stuff like pace in several different units.</p>
<h3 id="online-activity-downloader">Online activity downloader</h3>
<p>I built a really rough and dirty website for talking to my device and getting the health data off it. You can play around with it at <a href="https://sprocketfox.io/ido/">https://sprocketfox.io/ido/</a>. It’s happy path’d for my $39 crappy watch so probably won’t work for most people. It generates a  TCX file that can be used on Strava or Garmin.</p>
<figure>
    <img src="https://sprocketfox.io/xssfox/images/f37de48c9b5f7898c9f2af899cc38da7.png" alt="Screenshot showing an activity being downloaded from the watch"/>
    <figcaption></figcaption>
</figure>
<h3 id="Authentication">Authentication</h3>
When I originally paired the device I scanned a QR code on the watch. Turns out this probably just had the mac address on it or something because after several hours of getting device info and pulling activity data I realised that I had never performed any authentication step. Resetting the app and repairing also revealed that there&#39;s no pairing code. Nothing. The device isn&#39;t locked or secured once connected. Anyone can connect to the device at any time and start issuing commands.
<p>You can pull activity data, sleep data, heart rate data, menstrual data. You can perform firmware updates. I don’t have GPS in my version of the watch but I bet you can access that as well. Whatever you want you can get it - there’s no protection. I can only test with my watch, but I suspect this applies to most devices that have been white labeled.</p>
<p>The watch I bought off Amazon has 5000+ ratings and the VeryFit app has over 5 million downloads. There’s 10k Ryze Connect app downloads according to Google Play. From what I can tell Cove, BoAT and bfit Move are also using the same app/protocol - I imagine there is a lot more as well. These are sold in retail stores like JB Hifi and Harvey Norman. There’s even kids versions of these watches which adds to a creepyness factor.</p>
<p>I pondered about how to disclose this and decided to go with the “fuck it” approach. The reasoning is that it’s going to be hard to find all the different vendors to let them know and I suspect they won’t care. I just don’t have the time go talk to AI chat bots, lodge support forms, have support people not understand my concern, have multiple generic replies saying “it’s not an issue our vendor said its secure” ect…. Is “JJMJKJ” (yes thats who sells it on Amazon) going to do anything - no. Not a chance. So rather than go through that entire process, get burnt out, and still be left with no actual device security I’m taking the approach of letting people know as soon as possible.</p>
<p>If you’re in Australia you can request a refund as the device isn’t fit for purpose or of acceptable quality.</p>
<h3 id="git">Git</h3>
<p>Details about this can be found at <a href="https://github.com/xssfox/idowatch">https://github.com/xssfox/idowatch</a></p>
<h3 id="unexplored-security-fun">Unexplored security fun</h3>
<ul>
<li>File transfer / bluetooth serial endpoints: There’s some file upload for firmware features that could be interesting</li>
<li>Hijacking the app by pretending to be a watch: Perform attacks the reverse way, pretend to be someone else’s watch. Maybe can make phone calls, take pictures.</li>
<li>Overflows: There’s lots of places that smell like overflows can happen.</li>
</ul>




      
        
      
    </article></div>
  </body>
</html>
