<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.understandingai.org/p/metas-llama-31-can-recall-42-percent">Original</a>
    <h1>Meta&#39;s Llama 3.1 can recall 42 percent of the first Harry Potter book</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><article><div><div><div dir="auto"><p><span>In recent years, numerous plaintiffs—including publishers of books, newspapers, computer code, and photographs—have </span><a href="https://www.understandingai.org/p/the-ai-community-needs-to-take-copyright" rel="">sued AI companies</a><span> for training models using copyrighted material. A key question in all of these lawsuits has been how easily AI models produce verbatim excerpts from the plaintiffs’ copyrighted content.</span></p><p><span>For example, in its </span><a href="https://www.understandingai.org/p/why-the-new-york-times-sued-microsoft" rel="">December 2023 lawsuit</a><span> against OpenAI, the New York Times Company produced dozens of examples where GPT-4 exactly reproduced significant passages from </span><em>Times</em><span> stories. In its </span><a href="https://www.courthousenews.com/wp-content/uploads/2025/01/open-ai-motion-to-dismiss-ny-times.pdf" rel="">response</a><span>, OpenAI described this as a “fringe behavior” and a “problem that researchers at OpenAI and elsewhere work hard to address.”</span></p><p><span>But is it actually a fringe behavior? And have leading AI companies addressed it? </span><a href="https://arxiv.org/abs/2505.12546" rel="">New research</a><span>—focusing on books rather than newspaper articles and on different companies—provides surprising insights into this question. Some of the findings should bolster plaintiffs’ arguments, while others may be more helpful to defendants.</span></p><p>The paper was published last month by a team of computer scientists and legal scholars from Stanford, Cornell, and West Virginia University. They studied whether five popular open-weight models—three from Meta and one each from Microsoft and EleutherAI—were able to reproduce text from Books3, a collection of books that is widely used to train LLMs. Many of the books are still under copyright.</p><p>This chart illustrates their most surprising finding:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png" width="1072" height="1154" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1154,&#34;width&#34;:1072,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:null,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:null,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;topImage&#34;:true,&#34;internalRedirect&#34;:null,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1d9755f9-cfad-48cc-a4cb-482c0f9c3bb5_1072x1154.png 1456w" sizes="100vw" fetchpriority="high"/></picture><div><div></div></div></div></a></figure></div><p><span>The chart shows how easy it is to get a model to generate 50-token excerpts from various parts of </span><em>Harry Potter and the Sorcerer&#39;s Stone</em><span>. The darker a line is, the easier it is to reproduce that portion of the book.</span></p><p>Each row represents a different model. The three bottom rows are Llama models from Meta. And as you can see, Llama 3.1 70B—a mid-sized model Meta released in July 2024—is far more likely to reproduce Harry Potter text than any of the other four models.</p><p><span>Specifically, the paper estimates that Llama 3.1 70B has memorized </span><em>42 percent</em><span> of the first Harry Potter book well enough to reproduce 50-token excerpts at least half the time. (I’ll unpack how this was measured in the next section.)</span></p><p><span>Interestingly, Llama 1 65B, a similar-sized model released in February 2023, had memorized only 4.4 percent of </span><em>Harry Potter and the Sorcerer&#39;s Stone</em><span>. This suggests that despite the potential legal liability, Meta did not do much to prevent memorization as it trained Llama 3. At least for this book, the problem got much worse between Llama 1 and Llama 3.</span></p><p><em>Harry Potter and the Sorcerer&#39;s Stone</em><span> was one of dozens of books tested by the researchers. They found that Llama 3.1 70B was far more likely to reproduce popular books—such as </span><em>The Hobbit</em><span> and George Orwell’s </span><em>1984</em><span>—than obscure ones. And for most books, Llama 3.1 70B memorized more than any of the other models.</span></p><p>“There are really striking differences among models in terms of how much verbatim text they have memorized,” said James Grimmelmann, a Cornell law professor who has collaborated with several of the paper’s authors.</p><p><span>The results surprised the study’s authors, including Mark Lemley, a law professor at Stanford.</span></p><p>“We&#39;d expected to see some kind of low level of replicability on the order of one or two percent,” Lemley told me. “The first thing that surprised me is how much variation there is.”</p><p>These results give everyone in the AI copyright debate something to latch on to. For AI industry critics, the big takeaway is that—at least for some models and some books—memorization is not a fringe phenomenon.</p><p><span>On the other hand, the study only found significant memorization of a few popular books. For example, the researchers found that Llama 3.1 70B only memorized 0.13 percent of </span><em>Sandman Slim</em><span>, a 2009 novel by author Richard Kadrey. That’s a tiny fraction of the 42 percent figure for </span><em>Harry Potter</em><span>.</span></p><p>This could be a headache for law firms that have filed class-action lawsuits against AI companies. Kadrey is the lead plaintiff in a class-action lawsuit against Meta. To certify a class of plaintiffs, a court must find that the plaintiffs are in largely similar legal and factual situations.</p><p>Divergent results like these could cast doubt on whether it makes sense to lump J.K. Rowling, Richard Kadrey, and thousands of other authors together in a single mass lawsuit. And that could work in Meta’s favor, since most authors lack the resources to file individual lawsuits.</p><p>The broader lesson of this study is that the details will matter in these copyright cases. Too often, online discussions have treated “do generative models copy their training data or merely learn from it?” as a theoretical or even philosophical question. But it’s a question that can be tested empirically—and the answer might differ across models and across copyrighted works.</p><p><span>It’s common to talk about LLMs predicting the next token. But under the hood, what the model actually does is generate a probability distribution over </span><em>all</em><span> possibilities for the next token. For example, if you prompt an LLM with the phrase “Peanut butter and ”, it will respond with a probability distribution that might look like this made-up example:</span></p><ul><li><p>P(“jelly”) = 70 percent</p></li><li><p>P(“sugar”) = 9 percent</p></li><li><p>P(“peanut”) = 6 percent</p></li><li><p>P(“chocolate”) = 4 percent</p></li><li><p>P(“cream”) = 3 percent</p></li></ul><p>And so forth.</p><p>After the model generates a list of probabilities like this, the system will select one of these options at random, weighted by their probabilities. So 70 percent of the time the system will generate “Peanut butter and jelly.” Nine percent of the time we’ll get “Peanut butter and sugar.” Six percent of the time it will be “Peanut butter and peanut.” You get the idea.</p><p>The study’s authors didn’t have to actually generate multiple outputs to estimate the likelihood of a particular response. Instead, they could calculate probabilities for each token and then multiply them together.</p><p>Suppose someone wants to estimate the probability that a model will respond to “My favorite sandwich is” with “peanut butter and jelly.” Here’s how to do that:</p><ul><li><p><span>Prompt the model with “My favorite sandwich is” and look up the probability of “peanut” (let’s say it’s </span><strong>20 percent</strong><span>).</span></p></li><li><p><span>Prompt the model with “My favorite sandwich is peanut” and look up the probability of “butter” (let’s say it’s </span><strong>90 percent</strong><span>).</span></p></li><li><p><span>Prompt the model with “My favorite sandwich is peanut butter” and look up the probability of “and” (let’s say it’s </span><strong>80 percent</strong><span>).</span></p></li><li><p><span>Prompt the model with “My favorite sandwich is peanut butter and” and look up the probability of “jelly” (let’s say it’s </span><strong>70 percent</strong><span>).</span></p></li></ul><p>Then we just have to multiply the probabilities like this:</p><p>0.2 * 0.9 * 0.8 * 0.7 = 0.1008</p><p>So we can predict that the model will produce “peanut butter and jelly” about 10 percent of the time—without actually generating 100 or 1,000 outputs and counting how many of them were that exact phrase.</p><p>This technique greatly reduced the cost of the research, allowed the authors to analyze more books, and made it feasible to precisely estimate very low probabilities.</p><p>For example, the authors estimated that it would take more than 10 million billion samples to exactly reproduce some 50-token sequences from some books. Obviously, it wouldn’t be feasible to actually generate that many outputs. But it wasn’t necessary: the probability could be estimated just by multiplying together probabilities for the 50 tokens.</p><p><span>A key thing to notice is that probabilities can get really small really fast. In my made-up example, the probability that the model will produce the four tokens “peanut butter and jelly” is just 10 percent. If we added more tokens, the probability would get even lower. If we added </span><em>46 more tokens</em><span>, the probability could fall by several orders of magnitude.</span></p><p>For any language model, the probability of generating any given 50-token sequence “by accident” is vanishingly small. If a model generates 50 tokens from a copyrighted work, that is strong evidence the tokens “came from” the training data. This is true even if it only generates those tokens 10 percent, 1 percent, or 0.01 percent of the time.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg" width="1456" height="969" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:969,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:1764273,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://www.understandingai.org/i/165810194?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F16e0b685-bc31-4920-9078-e27eb76fff9c_4791x3189.jpeg 1456w" sizes="100vw" loading="lazy"/></picture><div><div></div></div></div></a><figcaption>Meta CEO Mark Zuckerberg. (Photo by Andrej Sokolow/picture alliance via Getty Images)</figcaption></figure></div><p>The study authors took 36 books and broke each of them up into overlapping 100-token passages. Using the first 50 tokens as a prompt, they calculated the probability that the next 50 tokens will be identical to the original passage. They counted a passage as “memorized” if the model had a greater than 50 percent chance of reproducing it word for word.</p><p>This definition is quite strict. For a 50-token sequence to have a probability greater than 50 percent, the average token in the passage needs a probability of at least 98.5 percent! Moreover, the authors only counted exact matches. They didn’t try to count cases where—for example—the model generates 48 or 49 tokens from the original passage but got one or two tokens wrong. If these cases were counted, the amount of memorization would be even higher.</p><p><span>This research provides strong evidence that significant portions of </span><em>Harry Potter and the Sorcerer&#39;s Stone</em><span> got copied into the weights of Llama 3.1 70B. But this finding doesn’t tell us why or how this happened. I suspect that part of the answer is that Llama 3 70B was trained on 15 trillion tokens—more than 10 times the 1.4 trillion tokens used to train Llama 1 65B.</span></p><p><span>The more times a model is trained on a particular example, the more likely it is to memorize that example. Maybe Meta had trouble finding 15 trillion distinct tokens, so it trained on the Books3 dataset multiple times. Or maybe Meta added third-party sources—such as online Harry Potter fan forums, consumer book reviews, or student book reports—that included quotes from </span><em>Harry Potter</em><span> and other popular books.</span></p><p>I’m not sure that either of these explanations fully fits the facts. The fact that memorization was a much bigger problem for the most popular books does suggest Llama may have been trained on secondary sources that quote these books rather than the books themselves. There are likely exponentially more online discussions of Harry Potter than Sandman Slim.</p><p><span>On the other hand, it’s surprising that Llama memorized</span><em> </em><span>so much of </span><em>Harry Potter and the Sorcerer&#39;s Stone</em><span>.</span></p><p>“If it were citations and quotations, you&#39;d expect it to concentrate around a few popular things that everyone quotes or talks about,” Lemley said. The fact that Llama 3 memorized almost half the book suggests that the entire text was well represented in the training data.</p><p>Or there could be another explanation entirely. Maybe Meta made subtle changes in its training recipe that accidentally worsened the memorization problem. I emailed Meta for comment on Tuesday but haven’t heard back.</p><p>“It doesn&#39;t seem to be all popular books,” Mark Lemley told me. “Some popular books have this result and not others. It’s hard to come up with a clear story that says why that happened.”</p><p>There are actually three distinct theories of how training a model on copyrighted works could infringe copyright:</p><ol><li><p>Training on a copyrighted work is inherently infringing because the training process involves making a digital copy of the work.</p></li><li><p>The training process copies information from the training data into the model, making the model a derivative work under copyright law.</p></li><li><p>Infringement occurs when a model generates (portions of) a copyrighted work.</p></li></ol><p>A lot of discussion so far has focused on the first theory because it is the most threatening to AI companies. If the courts uphold this theory, most current LLMs would be illegal whether or not they have memorized any training data.</p><p><span>The AI industry has some pretty strong arguments that </span><a href="https://www.understandingai.org/p/the-ai-community-needs-to-take-copyright" rel="">using copyrighted works during the training process is fair use</a><span> under the 2015 Google Books ruling. But the fact that Llama 3.1 70B memorized large portions of </span><em>Harry Potter</em><span> could color how the courts think about these fair use questions.</span></p><p><span>A key part of fair use analysis is whether a use is “transformative”—whether a company has made something new or is merely profiting from the work of others. The fact that language models are capable of regurgitating substantial portions of popular works like </span><em>Harry Potter</em><span>, </span><em>1984</em><span>, and </span><em>The Hobbit</em><span> could cause judges to look at these fair use arguments more skeptically.</span></p><p><span>Moreover, one of Google’s key arguments in the books case was that its system was designed to never return more than a short excerpt from any book. If the judge in the Meta lawsuit wanted to distinguish Meta’s arguments from the ones Google made in the books case, he could point to the fact that Llama can generate far more than a few lines of </span><em>Harry Potter</em><span>.</span></p><p>The new study “complicates the story that the defendants have been telling in these cases,” co-author Mark Lemley told me. “Which is ‘we just learn word patterns. None of that shows up in the model.’”</p><p>But the Harry Potter result creates even more danger for Meta under that second theory—that Llama itself is a derivative copy of J.K. Rowling’s masterpiece.</p><p>“It&#39;s clear that you can in fact extract substantial parts of Harry Potter and various other books from the model,” Lemley said. “That suggests to me that probably for some of those books there&#39;s something the law would call a copy of part of the book in the model itself.”</p><p>The Google Books precedent probably can’t protect Meta against this second legal theory because Google never made its books database available for users to download—Google almost certainly would have lost the case if it had done that.</p><p>In principle, Meta could still convince a judge that copying 42 percent of Harry Potter was allowed under the flexible, judge-made doctrine of fair use. But it would be an uphill battle.</p><p>“The fair use analysis you&#39;ve gotta do is not just ‘is the training set fair use,’ but ‘is the incorporation in the model fair use?’” Lemley said. “That complicates the defendants&#39; story.”</p><p>Grimmelmann also said there’s a danger that this research could put open-weight models in greater legal jeopardy than closed-weight ones. The Cornell and Stanford researchers could only do their work because the authors had access to the underlying model—and hence to the token probability values that allowed efficient calculation of probabilities for sequences of tokens.</p><p>Most leading labs, including OpenAI, Anthropic, and Google, have increasingly restricted access to these so-called logits, making it more difficult to study these models.</p><p>Moreover, if a company keeps model weights on its own servers, it can use filters to try to prevent infringing output from reaching the outside world. So even if the underlying OpenAI, Anthropic, and Google models have memorized copyrighted works in the same way as Llama 3.1 70B, it might be difficult for anyone outside the company to prove it.</p><p>Moreover, this kind of filtering makes it easier for companies with closed-weight models to invoke the Google Books precedent. In short, copyright law might create a strong disincentive for companies to release open-weight models.</p><p>“It&#39;s kind of perverse,” Mark Lemley told me. “I don&#39;t like that outcome.”</p><p>On the other hand, judges might conclude that it would be bad to effectively punish companies for publishing open-weight models.</p><p>“There&#39;s a degree to which being open and sharing weights is a kind of public service,” Grimmelmann told me. “I could honestly see judges being less skeptical of Meta and others who provide open-weight models.”</p></div></div></div></article></div></div></div><div><div id="discussion"><div><h4>Discussion about this post</h4></div></div></div></div>
  </body>
</html>
