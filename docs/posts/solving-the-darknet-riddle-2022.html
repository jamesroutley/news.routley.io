<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sizeof.life/posts/darknet-riddle/">Original</a>
    <h1>Solving the darknet riddle (2022)</h1>
    
    <div id="readability-page-1" class="page"><div>
      
      <p>An ‘.onion’ link was posted on Reddit back in June 2020 with a suspected riddle. It got me curious.</p>
<p>Some random characters and a sentence: “How deep can you enter?”</p>
<p>Within the page source-code a comment was present with a series of numbers/letters that looked like a hexadecimal.</p>

  <figure>
    <img src="https://sizeof.life/img/hex.png"/>
    
  </figure>


<p>After converting the hex to ASCII it read: ‘chaos is the key’.</p>
<p>I noticed that when the page is refreshed, every time a different letter is highlighted in yellow.</p>
<p>When the ‘x’ char was highlighted a link was appended to the word ‘enter’…

  </p><figure>
    <img src="https://sizeof.life/img/x.png"/>
    
  </figure>


<p>The link was to an image (below).</p>

  <figure>
    <img src="https://sizeof.life/img/hidden_message01.png"/>
    
  </figure>


<p>After google translating the text in the image which did not reveal anything useful, it was time to examine the image file itself.</p>
<p>I suspected the next “message” would be hidden in image metadata or perhaps a pixel analysis would need to be done but after downloading the file and opening it, the message was already visible.</p>
<p>See the image area below, it may not be visible in the browser but if you download it and look closely enough you’ll see it.</p>

  <figure>
    <img src="https://sizeof.life/img/hidden_message02.png"/>
    
  </figure>


<blockquote>
<p>The hidden message contained another riddle:
Congrats! You passed level 1
#2 Send an email
TO: A000668(9)@8,41235641483227
SUBJECT: hello world</p>
</blockquote>
<p>The domain part of the email was easier to figure out, after a quick google it was apparent that it’s ‘protonmail.com’.</p>
<p>The first part of the email turned out to be a the 9th <a href="https://en.wikipedia.org/wiki/Mersenne_prime">Mersenne prime</a> number. Making the email address <a href="https://sizeof.life/cdn-cgi/l/email-protection#bf8d8c8f8a878b8c8f8f868d8e8c89868c868a8effcfcdd0cbd0d1d2ded6d391dcd0d2"><span data-cfemail="17252427222f232427272e252624212e242e2226576765786378797a767e7b3974787a">[email protected]</span></a>.</p>
<p>Few hours after sending the email I received a response with a binary code in the message.</p>

  <figure>
    <img src="https://sizeof.life/img/binary.png"/>
    
  </figure>


<p>Binary conversion revealed an URL that contained a text file called ‘haystack.txt’.</p>

   <figure>
     <img src="https://sizeof.life/img/haystack.png"/>
     
   </figure>
 

<p>There was also an instruction in another file that stated:</p>

  <figure>
    <img src="https://sizeof.life/img/hint.png"/>
    
  </figure>


<p>At this point it was apparent that there is a ‘needle in a haystack’ file.</p>
<p>The numbers in the text file appeared to be prime numbers and my next thought was to check if there are any non-primes in the file.</p>
<p>There was 1000000 numbers in the file. Manually checking each one was out of the question so I turned for help to Python. I wrote a quick script to check for primes, output non-prime numbers (if any) and left it running.</p>
<p>After a while one non-prime number was returned.
<img src="https://sizeof.life/img/script.png" alt="script"/></p>
<p>Next part of the puzzle was to navigate to the provided URL and use the needle somehow. The URL contained a a short message:</p>
<blockquote>
<p>‘If you can not get me what I need,
maybe you must start at Level 0‘</p>
</blockquote>
<p><img src="https://sizeof.life/img/needle.png" alt="nedle"/></p>
<p>There was no inputs or buttons on the page but there was some clues left. It took me a short while to figure it out. The clues were hidden in the following parts of the puzzle:</p>
<p>Clue 1:
<img src="https://sizeof.life/img/clue1.png" alt="clue1"/></p>
<p>Clue 2:
<img src="https://sizeof.life/img/clue2.png" alt="clue2"/></p>
<p>Clue 3:
<img src="https://sizeof.life/img/clue3.png" alt="clue3"/></p>
<p>The ‘get‘ word was chosen purposely and it referred to a http GET request.</p>
<p>After making the GET request while passing the non-prime ‘needle’ as the parameter another message appeared.
<img src="https://sizeof.life/img/get.png" alt="get-request"/></p>
<p>The message was in hexadecimal and after converting it, another puzzle was revealed:</p>
<blockquote>
<p>uonlyneed3dovetails2findwhere2go
mfcJE9adl3v7z/Tuxeo5XqM.eTzKB/Y#nsglRevPnr7atQ</p>
</blockquote>
<p><strong>‘You only need 3 dovetails 2 find where 2 go’</strong></p>

  <figure>
    <img src="https://sizeof.life/img/640px-Riffle_shuffle.jpg"/>
    
  </figure>


<p>This took me a while to figure out. At first I though it may have something to do with the ‘ / ‘ but after a quick research I realized that <a href="https://en.wikipedia.org/wiki/Shuffling#Riffle">dovetail</a> is also a thing in card games and it’s a riffle-shuffle technique.</p>
<p>This would mean that the provided string needs to be riffle-shuffled 3 times to reveal <em>where to go</em>.</p>
<p>I seem to have lost the python script I wrote back then to do this for me but after it has done shuffling, the string has formed another URL.</p>
<p>After entering the URL, it seemed like it was the last puzzle (at least until more parts are developed):</p>
<p><img src="https://sizeof.life/img/end.png" alt="get-request"/></p>
<p>That was FUN!</p>
<p>To whoever designed this puzzle: well done! It was very interesting.</p>

    </div></div>
  </body>
</html>
