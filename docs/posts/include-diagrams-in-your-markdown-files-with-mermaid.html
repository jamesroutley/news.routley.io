<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/">Original</a>
    <h1>Include diagrams in your Markdown files with Mermaid</h1>
    
    <div id="readability-page-1" class="page"><div><div>


<div id="post-63053">
	<p>A picture tells a thousand words, but up until now the only way to include pictures and diagrams in your Markdown files on GitHub has been to embed an image. We added <a href="https://github.blog/changelog/2022-01-21-allow-to-upload-svg-files-to-markdown/">support for embedding SVGs recently</a>, but sometimes you want to keep your diagrams up to date with your docs and create something as easily as doing ASCII art, but a lot prettier.</p>
<h2>Enter Mermaid üßú‚Äç‚ôÄÔ∏èüßú‚Äç‚ôÇÔ∏è</h2>
<p><a href="https://github.com/mermaid-js/mermaid#readme">Mermaid</a> is a JavaScript based diagramming and charting tool that takes Markdown-inspired text definitions and creates diagrams dynamically in the browser. Maintained by <a href="https://github.com/knsv">Knut Sveidqvist</a>, it supports a bunch of different common diagram types for software projects, including flowcharts, UML, Git graphs, user journey diagrams, and even the dreaded Gantt chart.</p>
<p>Working with Knut and also the wider community at <a href="https://commonmark.org/">CommonMark</a>, we‚Äôve rolled out a change that will allow you to create graphs inline using <a href="https://mermaid-js.github.io/mermaid/#/n00b-syntaxReference?id=syntax-structure">Mermaid syntax</a>, for example:</p>
<pre>```mermaid
  graph TD;
      A--&gt;B;
      A--&gt;C;
      B--&gt;D;
      C--&gt;D;
```
</pre>
<p>The raw code block above will appear as this diagram in the rendered Markdown:</p>
<p><img loading="lazy" src="https://github.blog/wp-content/uploads/2022/02/rendered-diagram.png?w=300&amp;resize=300%2C251" alt="rendered diagram example" width="300" height="251" data-recalc-dims="1" data-lazy-srcset="https://github.blog/wp-content/uploads/2022/02/rendered-diagram.png?w=984 984w, https://github.blog/wp-content/uploads/2022/02/rendered-diagram.png?w=300&amp;resize=300%2C251 300w, https://github.blog/wp-content/uploads/2022/02/rendered-diagram.png?w=768 768w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://github.blog/wp-content/uploads/2022/02/rendered-diagram.png?w=300&amp;is-pending-load=1#038;resize=300%2C251" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></p>
<h2>How it works</h2>
<p>When we encounter code blocks marked as <code>mermaid</code>, we generate an iframe that takes the raw Mermaid syntax and passes it to Mermaid.js, turning that code into a diagram in your local browser.</p>
<p>We achieve this through a two-stage process‚ÄîGitHub‚Äôs <a href="https://github.blog/2012-11-27-html-pipeline-chainable-content-filters/">HTML pipeline</a> and Viewscreen, our internal file rendering service.</p>
<p>First, we add a filter to the HTML pipeline that looks for raw <code>pre</code> tags with the <code>mermaid</code> language designation and substitutes it with a template that works progressively, such that clients requesting content with embedded Mermaid in a non-JavaScript environment (such as a screen reader or an API request) will see the original Markdown code.</p>
<p>Next, assuming the content is viewed in a JavaScript-enabled environment, we inject an iframe into the page, pointing the <code>src</code> attribute to the Viewscreen service. This has several advantages:</p>
<ul>
<li>It offloads the library to an external service, keeping the JavaScript payload we need to serve from Rails smaller.</li>
<li>Rendering the charts asynchronously helps eliminate the overhead of potentially rendering several charts before sending the compiled ERB view to the client.</li>
<li>User-supplied content is locked away in an iframe, where it has less potential to cause mischief on the GitHub page that the chart is loaded into.</li>
</ul>

<p>The net result is fast, easily editable, and vector-based diagrams right in your documentation where you need them.</p>
<p>Mermaid has been getting increasingly popular with developers and has a <a href="https://github.com/knsv/mermaid/graphs/contributors">rich community of contributors</a> led by the maintainer <a href="https://github.com/knsv">Knut Sveidqvist</a>. We are very grateful for Knut‚Äôs support in bringing this feature to everyone on GitHub. If you‚Äôd like to learn more about the Mermaid syntax, head over to the <a href="http://mermaid-js.github.io/mermaid/">Mermaid website</a> or check out Knut‚Äôs first official <a href="https://amzn.to/339uQRn">Mermaid book</a>.</p>

    

</div>


</div></div></div>
  </body>
</html>
