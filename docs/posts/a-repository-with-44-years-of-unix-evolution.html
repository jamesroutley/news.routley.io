<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.spinellis.gr/pubs/conf/2015-MSR-Unix-History/html/Spi15c.html">Original</a>
    <h1>A Repository with 44 Years of Unix Evolution</h1>
    
    <div id="readability-page-1" class="page"><div>
 






<h2> Abstract</h2><p>
The evolution of the Unix operating system is made available as a
version-control repository, covering the period from its inception in
1972 as a five thousand line kernel,
to 2015 as a widely-used 26 million line system.
The repository contains 659 thousand commits and
2306 merges.
The repository employs the commonly used Git system for its storage, and
is hosted on the popular GitHub archive.
It has been created by synthesizing with custom software 24 snapshots of
systems developed at Bell Labs, Berkeley University, and the 386BSD team,
two legacy repositories, and the modern repository of the open source
FreeBSD system.
In total, 850 individual contributors are identified,
the early ones through primary research.
The data set can be used for empirical research in software engineering,
information systems, and software archaeology.
</p>
 <h2>
1  Introduction</h2><p> The Unix operating system stands out as a major engineering breakthrough
due to
its exemplary design,
its numerous technical contributions,
its development model, and
its widespread use.
The design of the Unix programming environment has been characterized as
one offering unusual simplicity, power, and elegance [<a href="#MPT78" id="CITEMPT78">1</a>].
On the technical side,
features that can be directly attributed to Unix or were popularized by it
include [<a href="#RT78" id="CITERT78">2</a>]:
the portable implementation of the kernel in a high level language;
a hierarchical file system;
compatible file, device, networking, and inter-process I/O;
the pipes and filters architecture;
virtual file systems; and
the shell as a user-selectable regular process.
A large community contributed software to Unix from its early
days [<a href="#Rit84" id="CITERit84">3</a>], [<a href="#Sal94" id="CITESal94">4</a>,pp. 65-72].
This community grew immensely over time and worked using what are now termed
open source software development methods [<a href="#Ray03" id="CITERay03">5</a>,pp. 440-442].
Unix and its intellectual descendants have also helped the spread of
the C and C++ programming languages,
parser and lexical analyzer generators (<em>yacc</em>, <em>lex</em>),
document preparation tools (<em>troff</em>, <em>eqn</em>, <em>tbl</em>),
scripting languages (<em>awk</em>, <em>sed</em>, <em>Perl</em>),
TCP/IP networking, and
configuration management systems (<em>SCCS</em>, <em>RCS</em>, <em>Subversion</em>, <em>Git</em>),
while also forming a large part of the modern internet infrastructure and
the web.
</p><p>
Luckily, important Unix material of historical importance has survived
and is nowadays openly available.
Although Unix was initially distributed with relatively restrictive licenses,
the most significant parts of its early development have been released by
one of its right-holders (Caldera International) under a liberal license.
Combining these parts with software that was developed or released
as open source software by the University of California, Berkeley
and the FreeBSD Project provides coverage of the system&#39;s development
over a period ranging from June 20th 1972 until today.
</p><p>
Curating and processing available snapshots
as well as old and modern configuration management repositories
allows the reconstruction of a new synthetic Git repository that combines
under a single roof most of the available data.
This repository documents in a digital form the detailed evolution of an
important digital artefact over a period of 44 years.
The following sections describe
the repository&#39;s structure and contents (Section <a href="#sec:data">II</a>),
the way it was created (Section <a href="#sec:dev">III</a>),
and how it can be used (Section <a href="#sec:use">IV</a>).
</p>
 <h2>
2  Data Overview</h2> <p><a id="sec:data">
</a>
The 1GB Unix history Git repository is made available for cloning on
<a href="https://github.com/dspinellis/unix-history-repo">GitHub</a>.<a href="#tthFtNtAAB" id="tthFrefAAB"><sup>1</sup></a>
Currently<a href="#tthFtNtAAC" id="tthFrefAAC"><sup>2</sup></a>
the repository contains 659 thousand commits and
2306 merges
from about 850 contributors.
The contributors include 23 from the Bell Labs staff,
158 from Berkeley&#39;s Computer Systems Research Group (CSRG),
and 660 from the FreeBSD Project.
</p><p>
The repository starts its life at a tag identified as <em>Epoch</em>,
which contains only licensing information and its modern README file.
Various tag and branch names identify points of significance.
</p><ul>
<li> <em>Research-VX</em> tags
correspond to six research editions that came out of Bell Labs.
These start with
<em>Research-V1</em> (4768 lines of PDP-11 assembly) and end with
<em>Research-V7</em> (1820 mostly C files, 324kLOC).

</li>
<li> <em>Bell-32V</em> is the port of the 7th Edition Unix to the DEC/VAX
architecture.

</li>
<li> <em>BSD-X</em> tags correspond to 15 snapshots released from Berkeley.

</li>
<li> <em>386BSD-X</em> tags correspond to two open source versions of the system,
with the Intel 386 architecture kernel code mainly written
by Lynne and William Jolitz.

</li>
<li> <em>FreeBSD-release/X</em> tags and branches mark 116 releases coming from
the FreeBSD project.

</li>
</ul><p>
In addition,
branches with a <em>-Snapshot-Development</em> suffix denote commits
that have been synthesized from a time-ordered sequence of a snapshot&#39;s files,
while tags with a <em>-VCS-Development</em> suffix mark the point along an
imported version control history branch where a particular release occurred.
</p><p>
The repository&#39;s history includes commits from the earliest days of
the system&#39;s development, such as the following.
<span>
<pre>commit c9f643f59434f14f774d61ee3856972b8c3905b1
Author: Dennis Ritchie &lt;research!dmr&gt;
Date:   Mon Dec 2 18:18:02 1974 -0500
    Research V5 development
    Work on file usr/sys/dmr/kl.c
</pre>
</span>
Merges between releases that happened along the system&#39;s evolution,
such as the development of BSD 3 from BSD 2 and Unix 32/V,
are also correctly represented in the Git repository as graph nodes
with two parents.
</p><p>
More importantly, the repository is constructed in a way that allows
<em>git blame</em>, which annotates source code lines with the version, date,
and author associated with their first appearance,
to produce the expected code provenance results.
For example,
checking out the <em>BSD-4</em> tag,
and running <em>git blame</em> on the kernel&#39;s <em>pipe.c</em> file
will show lines written by
Ken Thompson in 1974, 1975, and 1979, and by Bill Joy in 1980.
This allows the automatic (though computationally expensive)
detection of the code&#39;s provenance at any point of time.
</p>

<p><a id="tth_fIg1">
</a> <img src="https://www.spinellis.gr/pubs/conf/2015-MSR-Unix-History/html/provenance.png" alt="provenance.png"/></p><p>Figure 1: Code provenance across significant Unix releases.</p>
<p>
As can be seen in Figure <a href="#fig:provenance">1</a>, a modern version of Unix
(FreeBSD 9) still contains visible chunks of code from BSD 4.3,
BSD 4.3 Net/2, and FreeBSD 2.0.
Interestingly, the Figure shows that
code developed during the frantic dash to
create an open source operating system out of the code released by
Berkeley (386BSD and FreeBSD 1.0) does not seem to have survived.
The oldest code in FreeBSD 9 appears to be an 18-line sequence
in the C library file </p><tt>timezone.c</tt><p>,
which can also be found in the 7th Edition Unix file
with the same name and a time stamp of January 10th, 1979 -
36 years ago.
</p>
 <h2>
3  Data Collection and Processing</h2> <p><a id="sec:dev">
</a>
The goal of the project is to
consolidate data concerning the evolution of Unix
in a form that helps the study of the system&#39;s evolution,
by entering them into a modern revision repository.
This involves collecting the data,
curating them, and
synthesizing them into a single Git repository.
</p>

<p><a id="tth_fIg2">
</a> <img src="https://www.spinellis.gr/pubs/conf/2015-MSR-Unix-History/html/branches.png" alt="branches.png"/></p><p>Figure 2: Imported Unix snapshots, repositories, and their mergers.</p>
<p>
The project is based on three types of data (see Figure <a href="#fig:branches">2</a>).
First, <b>snapshots of early released versions</b>,
which were obtained
from the <a href="http://www.tuhs.org/archive_sites.html">Unix Heritage Society archive</a>,<a href="#tthFtNtAAD" id="tthFrefAAD"><sup>3</sup></a>
the <a href="https://www.mckusick.com/csrg/">CD-ROM images</a> containing the full source archives of
CSRG,<a href="#tthFtNtAAE" id="tthFrefAAE"><sup>4</sup></a>
the <a href="http://www.oldlinux.org/Linux.old/distributions/386BSD">OldLinux site</a>,<a href="#tthFtNtAAF" id="tthFrefAAF"><sup>5</sup></a>
and the <a href="http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/">FreeBSD archive</a>.<a href="#tthFtNtAAG" id="tthFrefAAG"><sup>6</sup></a>
Second, <b>past and current repositories</b>, namely
the CSRG SCCS [<a href="#SCCS" id="CITESCCS">6</a>] repository,
the FreeBSD 1 CVS repository,
and the <a href="https://github.com/freebsd/freebsd">Git mirror of modern FreeBSD development</a>.<a href="#tthFtNtAAH" id="tthFrefAAH"><sup>7</sup></a>
The first two were obtained from the same sources as the corresponding snapshots.
</p><p>
The last, and most labour intensive, source of data was <b>primary research</b>.
The release snapshots do not provide information regarding their ancestors
and the contributors of each file.
Therefore, these pieces of information had to be determined through
primary research.
The authorship information was mainly obtained
by reading author biographies, research papers, internal memos, and old documentation scans;
by reading and automatically processing source code and manual page markup;
by communicating via email with people who were there at the time;
by posting a query on the Unix <em>StackExchange</em> site;
by looking at the location of files (in early editions the kernel source
code was split into </p><tt>usr/sys/dmr</tt><p> and </p><tt>/usr/sys/ken</tt><p>); and
by propagating authorship from research papers and manual pages to source code
and from one release to others.
(Interestingly, the 1st and 2nd Research Edition manual pages
have an &#34;owner&#34; section, listing the person (e.g. <em>ken</em>) associated with the
corresponding system command, file, system call, or library function.
This section was not there in the 4th Edition, and
resurfaced as the &#34;Author&#34; section in BSD releases.)
Precise details regarding the source of the authorship information are
documented in the project&#39;s files that are used for mapping
Unix source code files to their authors and the corresponding commit messages.
Finally, information regarding merges between source code bases was
obtained from a <a href="http://ftp.netbsd.org/pub/NetBSD/NetBSD-current/src/share/misc/bsd-family-tree">BSD family tree maintained by the NetBSD project</a>.<a href="#tthFtNtAAI" id="tthFrefAAI"><sup>8</sup></a></p><p>
The software and data files that were developed as part of this project,
are
<a href="https://github.com/dspinellis/unix-history-make">available online</a>,<a href="#tthFtNtAAJ" id="tthFrefAAJ"><sup>9</sup></a>
and, with appropriate network, CPU and disk resources, they can be used
to recreate the repository from scratch.
The authorship information for major releases is stored in files under the
project&#39;s </p><tt>author-path</tt><p> directory.
These contain lines with a
regular expressions for a file path followed by the identifier of the
corresponding author.
Multiple authors can also be specified.
The regular expressions are processed sequentially, so that a catch-all
expression at the end of the file can specify a release&#39;s default authors.
To avoid repetition, a separate file with a </p><tt>.au</tt><p> suffix is used
to map author identifiers into their names and emails.
One such file has been created for every community associated with
the system&#39;s evolution:
Bell Labs, Berkeley, 386BSD, and FreeBSD.
For the sake of authenticity, emails for the early Bell Labs releases are listed
in UUCP notation (e.g. </p><tt>research!ken</tt><p>).
The FreeBSD author identifier map,
required for importing the early CVS repository,
was constructed by extracting the corresponding data from the project&#39;s
modern Git repository.
In total the commented authorship files (828 rules) comprise
1107 lines, and there are another 640 lines mapping author identifiers to names.
</p><p>
The curation of the project&#39;s data sources has been codified into a
168-line </p><tt>Makefile</tt><p>.
It involves the following steps.
</p>
<p><b>Fetching  </b>
Copying and cloning about 11GB of images, archives,
and repositories from remote sites.
</p>
<p><b>Tooling  </b>
Obtaining an archiver for old PDP-11 archives from 2.9 BSD,
and adjusting it to compile under modern versions of Unix;
compiling the 4.3 BSD <em>compress</em> program,
which is no longer part of modern Unix systems,
in order to decompress the 386BSD distributions.
</p>
<p><b>Organizing  </b>
Unpacking archives using <em>tar</em> and <em>cpio</em>;
combining three 6th Research Edition directories;
unpacking all 1 BSD archives using the old PDP-11 archiver;
mounting CD-ROM images so that they can be processed as
file systems;
combining the 8 and 62 386BSD floppy disk images into two separate
files.
</p>
<p><b>Cleaning  </b>
Restoring the 1st Research Edition kernel source code files,
which were obtained from printouts through optical character recognition,
into a format close to their original state;
patching some 7th Research Edition source code files;
removing metadata files and other files that were added after
a release, to avoid obtaining erroneous time stamp information;
patching corrupted SCCS files;
processing the early FreeBSD CVS repository by
removing CVS symbols assigned to multiple revisions
with a custom Perl script,
deleting CVS <em>Attic</em> files clashing with live ones,
and converting the CVS repository into a Git one using <em>cvs2svn</em>.
</p><p>
An interesting part of the repository representation is how snapshots
are imported and linked together in a way that allows <em>git blame</em>
to perform its magic.
Snapshots are imported into the repository as sequential commits based on the
time stamp of each file.
When all files have been imported the repository is tagged with the name
of the corresponding release.
At that point one could delete those files, and begin the import of the
next snapshot.
Note that the <em>git blame</em> command
works by traversing backwards a repository&#39;s history, and using
heuristics to detect code moving and being copied within or across
files.
Consequently, deleted snapshots would create a discontinuity between them,
and prevent the tracing of code between them.
</p><p>
Instead, before the next snapshot is imported, all the files of the
preceding snapshot are moved into a hidden look-aside directory named </p><tt>.ref</tt><p>
(reference).
They remain there, until all files of the next snapshot have been imported,
at which point they are deleted.
Because every file in the </p><tt>.ref</tt><p> directory matches exactly an original
file, <em>git blame</em> can determine how source code moves from one version
to the next via the </p><tt>.ref</tt><p> file, without ever displaying the </p><tt>.ref</tt><p>
file.
To further help the detection of code provenance,
and to increase the representation&#39;s realism,
each release is represented as a merge between the branch with
the incremental file additions (<em>-Development</em>)
and the preceding release.
</p><p>
For a period in the 1980s, only a subset of the files developed at Berkeley
were under SCCS version control.
During that period our unified repository contains imports of both the
SCCS commits, and the snapshots&#39; incremental additions.
At the point of each release, the SCCS commit with the nearest
time stamp is found and is marked as a merge
with the release&#39;s incremental import branch.
These merges can be seen in the middle of Figure <a href="#fig:branches">2</a>.
</p><p>
The synthesis of the various data sources into a single repository is
mainly performed by two scripts.
A 780-line Perl script (</p><tt>import-dir.pl</tt><p>)
can export the (real or synthesized) commit history from a single data source
(snapshot directory, SCCS repository, or Git repository) in the
<em>Git fast export</em> format.
The output is a simple text format that Git tools use to import and export
commits.
Among other things, the script takes as arguments
the mapping of files to contributors,
the mapping between contributor login names and their full names,
the commit(s) from which the import will be merged,
which files to process and which to ignore, and
the handling of &#34;reference&#34; files.
A 450-line shell script creates the Git repository and calls the
Perl script with appropriate arguments to import each one of the 27 available
historical data sources.
The shell script also runs 30 tests that
compare the repository at specific tags against the corresponding data sources,
verify the appearance and disappearance of look-aside directories, and
look for regressions in the count of tree branches and merges and
the output of <em>git blame</em> and <em>git log</em>.
Finally, <em>git</em> is called to garbage-collect and compress the repository
from its initial 6GB size down to the distributed 1GB.
</p>
 <h2>
4  Data Uses</h2><p> The data set can be used for empirical research in software engineering,
information systems, and software archeology.
Through its unique uninterrupted coverage of a period of more than 40 years,
it can inform work on software evolution and handovers across generations.
With thousandfold increases in processing speed and million-fold increases
in storage capacity during that time, the data set can also be used to study
the co-evolution of software and hardware technology.
The move of the software&#39;s development from research labs,
to academia, and to the open source community can be used to study
the effects of organizational culture on software development.
The repository can also be used to study how notable individuals,
such as Turing Award winners (Dennis Ritchie and Ken Thompson)
and captains of the IT industry (Bill Joy and Eric Schmidt),
actually programmed.
Another phenomenon worthy of study concerns the longevity of code,
either at the level of individual lines,
or as complete systems that were at times distributed with Unix
(Ingres, Lisp, Pascal, Ratfor, Snobol, TMG),
as well as the factors that lead to code&#39;s survival or demise.
Finally, because the data set stresses Git,
the underlying software repository storage technology, to its limits,
it can be used to drive engineering progress in the field of
revision management systems.
</p>

<p><a id="tth_fIg3">
</a> <img src="https://www.spinellis.gr/pubs/conf/2015-MSR-Unix-History/html/metrics.png" alt="metrics.png"/></p><p>Figure 3: Code style evolution along Unix releases.</p>
<p>
Figure <a href="#fig:metrics">3</a>,
which depicts trend lines
(obtained with R&#39;s local polynomial regression fitting function)
of some interesting code metrics along 36 major releases of Unix,
demonstrates the evolution of code style and
programming language use over very long timescales.
This evolution can be driven by software and hardware technology
affordances and requirements,
software construction theory, and even
social forces.
The dates in the Figure have been calculated as the average date of all files
appearing in a given release.
As can be seen in it, over the past 40 years the mean
length of identifiers and file names has steadily increased from 4
and 6 characters to 7 and 11 characters, respectively.
We can also see less steady increases in the number of comments and
decreases in the use of the <em>goto</em> statement, as well as the virtual
disappearance of the <em>register</em> type modifier.
</p>
 <h2>
5  Further Work</h2><p> Many things can be done to increase the repository&#39;s faithfulness
and usefulness.
Given that the build process is shared as open source code,
it is easy to contribute additions and fixes through GitHub pull requests.
The most useful community contribution would be to increase the
coverage of imported snapshot files that are attributed to a
specific author.
Currently, about 90 thousand files (out of a total of 160 thousand)
are getting assigned an author through a default rule.
Similarly, there are about 250 authors (primarily early FreeBSD ones)
for which only the identifier is known.
Both are listed in the build repository&#39;s </p><tt>unmatched</tt><p> directory,
and contributions are welcomed.
Furthermore,
the BSD SCCS and the FreeBSD CVS commits that share the same
author and time-stamp can be coalesced into a single Git commit.
Support can be added for importing the SCCS file comment fields,
in order to bring into the repository the corresponding metadata.
Finally, and most importantly,
more branches of open source systems can be added, such as NetBSD
OpenBSD, DragonFlyBSD, and <em>illumos</em>.
Ideally, current right holders of other important historical Unix releases,
such as System III, System V, NeXTSTEP, and SunOS, will release their systems under a license that would allow  their incorporation
into this repository for study.
</p>
<h3>Acknowledgements</h3> <p><span>
The author thanks the many individuals who contributed to the effort.
Brian W. Kernighan,
Doug McIlroy, and
Arnold D. Robbins
helped with Bell Labs login identifiers.
Clem Cole,
Era Eriksson,
Mary Ann Horton,
Kirk McKusick,
Jeremy C. Reed,
Ingo Schwarze, and
Anatole Shaw
helped with BSD login identifiers.
The BSD SCCS import code is based on work by
H. Merijn Brand and
Jonathan Gray.

This research has been co-financed by the European Union
(European Social Fund - ESF) and Greek national funds
through the Operational Program &#34;Education and Lifelong Learning&#34;
of the National Strategic Reference Framework (NSRF) -
Research Funding Program: Thalis -
Athens University of Economics and Business -
Software Engineering Research Platform.

</span></p>



<h2>References</h2>
<dl>
 <dt><a href="#CITEMPT78" id="MPT78">[1]</a></dt><dd>
M. D. McIlroy, E. N. Pinson, and B. A. Tague, &#34;UNIX time-sharing system:
  Foreword,&#34; <em>The Bell System Technical Journal</em>, vol. 57, no. 6, pp.
  1899-1904, July-August 1978.

</dd>
 <dt><a href="#CITERT78" id="RT78">[2]</a></dt><dd>
D. M. Ritchie and K. Thompson, &#34;The UNIX time-sharing system,&#34; <em>Bell
  System Technical Journal</em>, vol. 57, no. 6, pp. 1905-1929, July-August 1978.

</dd>
 <dt><a href="#CITERit84" id="Rit84">[3]</a></dt><dd>
D. M. Ritchie, &#34;The evolution of the UNIX time-sharing system,&#34; <em>AT&amp;T
  Bell Laboratories Technical Journal</em>, vol. 63, no. 8, pp. 1577-1593, Oct.
  1984.

</dd>
 <dt><a href="#CITESal94" id="Sal94">[4]</a></dt><dd>
P. H. Salus, <em>A Quarter Century of UNIX</em>.    Boston, MA: Addison-Wesley, 1994.

</dd>
 <dt><a href="#CITERay03" id="Ray03">[5]</a></dt><dd>
E. S. Raymond, <em>The Art of Unix Programming</em>.    Addison-Wesley, 2003.

</dd>
 <dt><a href="#CITESCCS" id="SCCS">[6]</a></dt><dd>
M. J. Rochkind, &#34;The source code control system,&#34; <em>IEEE Transactions
  on Software Engineering</em>, vol. SE-1, no. 4, pp. 255-265, 1975.</dd>
</dl>
<hr/><h3>Footnotes:</h3>

<p><a id="tthFtNtAAB"></a><a href="#tthFrefAAB"><sup>1</sup></a></p><a href="https://github.com/dspinellis/unix-history-repo"><tt>https://github.com/dspinellis/unix-history-repo</tt></a>

<p><a id="tthFtNtAAC"></a><a href="#tthFrefAAC"><sup>2</sup></a>Updates may add or modify material.
To ensure replicability the repository&#39;s users are encouraged to fork it
or archive it.
</p>
<p><a id="tthFtNtAAD"></a><a href="#tthFrefAAD"><sup>3</sup></a></p><a href="http://www.tuhs.org/archive_sites.html"><tt>http://www.tuhs.org/archive_sites.html</tt></a>

<p><a id="tthFtNtAAE"></a><a href="#tthFrefAAE"><sup>4</sup></a></p><a href="https://www.mckusick.com/csrg/"><tt>https://www.mckusick.com/csrg/</tt></a>

<p><a id="tthFtNtAAF"></a><a href="#tthFrefAAF"><sup>5</sup></a></p><a href="http://www.oldlinux.org/Linux.old/distributions/386BSD"><tt>http://www.oldlinux.org/Linux.old/distributions/386BSD</tt></a>

<p><a id="tthFtNtAAG"></a><a href="#tthFrefAAG"><sup>6</sup></a></p><a href="http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/"><tt>http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/</tt></a>

<p><a id="tthFtNtAAH"></a><a href="#tthFrefAAH"><sup>7</sup></a></p><a href="https://github.com/freebsd/freebsd"><tt>https://github.com/freebsd/freebsd</tt></a>

<p><a id="tthFtNtAAI"></a><a href="#tthFrefAAI"><sup>8</sup></a></p><a href="http://ftp.netbsd.org/pub/NetBSD/NetBSD-current/src/share/misc/bsd-family-tree"><tt>http://ftp.netbsd.org/pub/NetBSD/NetBSD-current/src/share/misc/bsd-family-tree</tt></a>

<p><a id="tthFtNtAAJ"></a><a href="#tthFrefAAJ"><sup>9</sup></a></p><a href="https://github.com/dspinellis/unix-history-make"><tt>https://github.com/dspinellis/unix-history-make</tt></a>
</div></div>
  </body>
</html>
