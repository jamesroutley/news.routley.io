<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/rochus-keller/LeanQt/releases/tag/2022-11-11">Original</a>
    <h1>LeanQt â€“ GUI is here, Widgets are near</h1>
    
    <div id="readability-page-1" class="page"><div data-pjax="true" data-test-selector="body-content" data-view-component="true"><p>This is an important release on the way to a full GUI toolkit. Due to the great demand, I have advanced this. The QtGui module, most of which is now migrated to LeanQt, offers cross-platform windows, 2D graphics, fonts, rich text, image handling and format conversion. The next step is the migration of widgets and some other GUI features.</p>
<p>In the original Qt, the platform backends are in separate plugins. I have never understood the advantage of this, but it makes the deployment more complicated. LeanQt puts both the front and the backend in the same library. It is even easy to merge all parts of LeanQt into just one static or shared library.</p>
<p>The external dependencies were kept very minimal. To compile the LeanQt gui module on Linux, you only need the standard libraries and libxcb, which you can install on Ubuntu, for example, with the package libxcb1-dev. On Mac and Windows, LeanQt only needs standard system libraries installed with the operating system.</p>
<p>The mime module is required by the gui module when compiled on macOS; that&#39;s why I also had to migrate it for this release.</p>
<p>The release has been successfully tested on Linux x86 &amp; x86_64, Win x86 &amp; AMD64, and Mac x86_64 &amp; M1. There is the clock application in the examples folder, which displays a digital and analog clock in a window that you can use to try out the gui module.</p>
<h4>How to build</h4>
<p>LeanQt can be built easily. By default, the sample applications that match the selected options are also built. Proceed as follows.</p>
<ol>
<li>Create a new directory; let&#39;s call it new_build (the name doesn&#39;t matter).</li>
<li>Download <a href="https://github.com/rochus-keller/BUSY/archive/refs/heads/master.zip">https://github.com/rochus-keller/BUSY/archive/refs/heads/master.zip</a> and unpack it to the new_build directory; rename the new subdirectory to e.g. BUSY (the name doesn&#39;t matter, but must correspond to the following commands).</li>
<li>Download <a href="https://github.com/rochus-keller/LeanQt/archive/refs/heads/master.zip">https://github.com/rochus-keller/LeanQt/archive/refs/heads/master.zip</a> and unpack it to the new_build directory; rename the new subdirectory to e.g. LeanQt (the name doesn&#39;t matter, but must correspond to the following commands).</li>
<li>Open a command line in the BUSY subdirectory and type <code>cc *.c -O2 -lm -O2 -o lua</code> or <code>cl /O2 /MD /Fe:lua.exe *.c</code> depending on whether you are on a Unix or Windows machine; wait a few seconds until the <code>lua</code> executable is built.</li>
<li>Now type <code>./lua build.lua ../LeanQt -P HAVE_GUI</code> (or <code>lua build.lua ../LeanQt -P HAVE_GUI</code> on Windows); wait a few minutes until the build finishes; you find the clock executable in the BUSY/output subdirectory.</li>
</ol>
<p>When you start the clock application (e.g. via <code>output/clock</code> or by double clicking), you should see something like this:</p>
<h4>Reducing the size of the source tree</h4>
<p>With the new gui, image and thirdparty modules, the uncompressed size of the source tree has grown to ~43 MB (10 MB zip compressed), with close to 3000 C/C++ files and more than 700 kSLOC.</p>
<p>LeanQt is designed to build only the modules you actually need. Unlike original Qt, the QImage and QImageReader/Writer classes can be built separately, independently of the gui module.</p>
<p>For the modules that are not needed, the source code doesn&#39;t have to be there either. The BUSY build system offers the possibility to simply remove the subdirectories that are not needed (see <a href="http://software.rochus-keller.ch/busy_spec.html#12707" rel="nofollow">here</a> for how this works). If you remove a BUSY module too much, the build will notify you with an according message.</p>
<p>For example, my <a href="https://github.com/rochus-keller/Oberon">Oberon+ OBXMC</a> tool only requires the core module of LeanQt. If I therefore want to deploy a minimal LeanQt source tree together with my OBXMC source code, I can just delete the concurrent, gui, image, mime, net, and xml subdirectories, as well as the freetype, harfbuzz, libjpeg, libpng, openssl, xcb, xkbcommon and zlib subdirectories of the thirdparty subdirectory. It is also legal to delete the QtConcurrent, QtGui, QtNetwork and QtXml subdirectories from the includes subdirectory.</p>
<p>The resulting source tree has less than 800 files and requires only ~11 MB (2.6 MB zip compressed), and perfectly works as a substitute of the full source tree in <a href="https://github.com/rochus-keller/LeanQt/blob/main/Readme.md#how-to-build-the-oberon-command-line-compiler-version-with-leanqt">this guide</a>; see the attached LeanQt_core_only.zip file.</p></div></div>
  </body>
</html>
