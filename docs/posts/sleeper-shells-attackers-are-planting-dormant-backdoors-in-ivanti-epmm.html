<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://defusedcyber.com/ivanti-epmm-sleeper-shells-403jsp">Original</a>
    <h1>Sleeper Shells: Attackers Are Planting Dormant Backdoors in Ivanti EPMM</h1>
    
    <div id="readability-page-1" class="page"><div><p data-svelte-h="svelte-fw48zm">Exploitation of Ivanti Endpoint Manager Mobile (EPMM) has been relentless since vulnerability disclosure. Thatâ€™s not necessarily news. Major institutions - governments included - have already been compromised through this vector, and weâ€™re tracking another exploitation wave as it develops.</p> <p data-svelte-h="svelte-1vxx46c">On <strong>February 4th, 2026</strong>, a coordinated campaign started across our telemetry with a differing pattern to previous mass exploitation. Rather than the smash-and-grab post-exploitation youâ€™d expect - dropping traditional webshells, running recon and enumeration commands - this operator did something more deliberate, uploading a payload, confirming it landed, and leaving.</p> <p data-svelte-h="svelte-h0dy3t">No commands were executed, the implant was simply left in place.</p> <blockquote data-svelte-h="svelte-7552f7"><p><strong>Key Takeaway:</strong> This campaign deployed a dormant in-memory Java class loader to <code>/mifs/403.jsp</code> - a somewhat lesser common webshell path. The implant can only be activated with a specific trigger parameter, and no follow-on exploitation has yet been observed. This is suggstive of initial access broker (IAB) tradecraft: gain a foothold, then sell or hand off access later.</p></blockquote> <h2 id="the-vulnerabilities" data-svelte-h="svelte-1hd50k6"><a title="Permalink" aria-hidden="true" href="#the-vulnerabilities"><span>#</span></a>The Vulnerabilities</h2> <p data-svelte-h="svelte-1gw0noy">Ivanti disclosed two critical vulnerabilities in EPMM - CVE-2026-1281 and CVE-2026-1340 - both covering authentication bypass and remote code execution, affecting different packages (aftstore and appstore respectively). The practical outcome is the same: unauthenticated access to application-level endpoints. Ivanti published patching guidance via their <a href="https://hub.ivanti.com/s/article/Security-Advisory-Ivanti-Endpoint-Manager-Mobile-EPMM-CVE-2026-1281-CVE-2026-1340" rel="nofollow">security advisory</a>, and exploitation in the wild followed shortly after.</p> <p data-svelte-h="svelte-1w40552">Most of the early activity was predictable - opportunistic scanning, mass exploitation, and commodity webshell drops.</p> <h2 id="the-403jsp-campaign" data-svelte-h="svelte-zuw54a"><a title="Permalink" aria-hidden="true" href="#the-403jsp-campaign"><span>#</span></a>The 403.jsp Campaign</h2> <p data-svelte-h="svelte-xp9oum">Every exploit from this campaign dropped a webshell to the path:</p> <pre><code>/mifs/403.jsp</code></pre> <p data-svelte-h="svelte-1u2c3rs">The path itself isnâ€™t new - 403.jsp has been observed in prior compromises targeting Ivanti and MobileIron infrastructure, typically alongside other JSP-based webshells. What made this campaign worth writing about isnâ€™t where the payload was placed, but what it did once it got there.</p> <p data-svelte-h="svelte-gmmdj0">Rather than deploying a conventional webshell with interactive command execution, the operator delivered a Base64-encoded Java class file via HTTP parameters. Each payload decoded to valid Java bytecode (identifiable by the CAFEBABE header) functioning as a dormant in-memory class loader - not an immediately usable backdoor. The distinction matters, and weâ€™ll get into why below.</p> <h2 id="inside-baseinfo---the-in-memory-loader" data-svelte-h="svelte-2upd8l"><a title="Permalink" aria-hidden="true" href="#inside-baseinfo---the-in-memory-loader"><span>#</span></a>Inside <code>base.Info</code> - The In-Memory Loader</h2> <p data-svelte-h="svelte-1ppd1k3">The payload is a compiled Java class (<code>base.Info</code>, source file <code>Info.java</code>). Itâ€™s not a webshell in the traditional sense - it doesnâ€™t provide command execution, file access, or any interactive capability on its own. Itâ€™s a stage loader: its only purpose is to receive, load, and execute a second Java class delivered via HTTP at a later time.</p> <h3 id="how-it-works" data-svelte-h="svelte-2a6v8a"><a title="Permalink" aria-hidden="true" href="#how-it-works"><span>#</span></a>How It Works</h3> <p data-svelte-h="svelte-w4u2qz">The class uses <code>equals(Object)</code> as its entry point, which is unusual but intentional - standard servlet handler methods like <code>doGet</code> or <code>doPost</code> are more likely to be flagged by security tooling. The <code>parseObj</code> method extracts <code>HttpServletRequest</code> and <code>HttpServletResponse</code> from the argument, with fallback logic to handle <code>PageContext</code> objects and various servlet wrapper/facade patterns. This makes the loader portable across different container environments.</p> <p data-svelte-h="svelte-lkvv7u">Once invoked, the loader checks for an HTTP parameter named <code>k0f53cf964d387</code>. If present, it strips a two-character prefix from the value and Base64-decodes the remainder into raw bytes. These bytes are then loaded as a Java class in memory via a reflective call to <code>ClassLoader#defineClass</code> - nothing is written to disk. The resulting class is instantiated with a string argument containing basic host information, and its <code>toString()</code> output is returned in the HTTP response.</p> <p data-svelte-h="svelte-10utsxz">The response body is wrapped in fixed delimiters (<code>3cd3d</code> / <code>e60537</code>) and served as <code>text/html</code>, making it straightforward for automated tooling to parse.</p> <p data-svelte-h="svelte-1gwzvrl">For Base64 handling, the loader supports both <code>java.util.Base64</code> (Java 8+) and <code>sun.misc.BASE64Decoder</code>, ensuring compatibility across older and newer JVM versions.</p> <h3 id="host-fingerprinting" data-svelte-h="svelte-10ctodl"><a title="Permalink" aria-hidden="true" href="#host-fingerprinting"><span>#</span></a>Host Fingerprinting</h3> <p data-svelte-h="svelte-1yqx6kz">Before invoking the second-stage class, the loader gathers a small set of environment details: the application working directory (<code>user.dir</code>), filesystem root paths (drive letters on Windows, <code>/</code> on Unix), the OS name, and the running username. This information is passed to the second-stage class as a constructor argument - likely to help the operator orient themselves on the target at a later date.</p> <h3 id="what-we-didnt-see" data-svelte-h="svelte-3aaofi"><a title="Permalink" aria-hidden="true" href="#what-we-didnt-see"><span>#</span></a>What We Didnâ€™t See</h3> <p data-svelte-h="svelte-j3u5o1">This is the part that matters from a defensive standpoint. Across all observed telemetry, the loader was deployed and confirmed functional, but <strong>no follow-on requests were observed supplying a second-stage class to the trigger parameter</strong>. The access was established and then left dormant.</p> <p data-svelte-h="svelte-1atrcst">This is consistent with initial access broker (IAB) activity. The tooling is generic and container-agnostic - itâ€™s built to work reliably across environments, not to perform any specific post-exploitation task. The operator deployed it at scale, verified it landed, and moved on. The likely purpose is to package confirmed, working access for handoff or sale to a separate party, who would activate it from different infrastructure at a later time.</p> <p data-svelte-h="svelte-1hriirt">That separation - one actor establishes access, another exploits it - is what makes this pattern difficult to detect in practice. Thereâ€™s a gap between the initial compromise and eventual use where the telemetry trail simply goes quiet.</p> <h2 id="what-to-look-for" data-svelte-h="svelte-5e0vf2"><a title="Permalink" aria-hidden="true" href="#what-to-look-for"><span>#</span></a>What To Look For</h2> <p data-svelte-h="svelte-byft2g">If youâ€™re running Ivanti EPMM, the presence of any of this activity should be treated as <strong>evidence of compromise or attempted compromise</strong> - even without follow-on exploitation. <em>Especially</em> without follow-on exploitation. The absence of further activity doesnâ€™t mean the access isnâ€™t valuable; it may simply mean it hasnâ€™t been activated yet.</p> <p data-svelte-h="svelte-zf8b8"><strong>Immediate actions:</strong> Patch Ivanti EPMM per vendor guidance immediately. Restart affected application servers to flush in-memory implants - this is critical, as the payload never touches disk. Then review access logs with the indicators below.</p> <h3 id="log-indicators" data-svelte-h="svelte-ccxcm5"><a title="Permalink" aria-hidden="true" href="#log-indicators"><span>#</span></a>Log Indicators</h3> <ul data-svelte-h="svelte-1ke8nr4"><li>Any requests to <code>/mifs/403.jsp</code></li> <li>Large Base64 parameters beginning with <code>yv66vg</code> (the Base64 encoding of the <code>CAFEBABE</code> Java magic bytes)</li> <li>The parameter name <code>k0f53cf964d387</code> in request strings</li> <li>Response bodies containing the markers <code>3cd3d</code> or <code>e60537</code></li> <li>Any response containing <code>ERROR://</code> (the loaderâ€™s error format)</li></ul> <h2 id="indicators-of-compromise" data-svelte-h="svelte-uzyojw"><a title="Permalink" aria-hidden="true" href="#indicators-of-compromise"><span>#</span></a>Indicators of Compromise</h2> <h3 id="artifact" data-svelte-h="svelte-hrxt8n"><a title="Permalink" aria-hidden="true" href="#artifact"><span>#</span></a>Artifact</h3> <table data-svelte-h="svelte-k9opuk"><thead><tr><th>Field</th> <th>Value</th></tr></thead> <tbody><tr><td>Class Name</td> <td><code>base.Info</code></td></tr> <tr><td>Source File</td> <td><code>Info.java</code></td></tr> <tr><td>SHA-256</td> <td><code>097b051c9c9138ada0d2a9fb4dfe463d358299d4bd0e81a1db2f69f32578747a</code></td></tr></tbody></table> <h3 id="network-iocs---source-ips" data-svelte-h="svelte-1u64ogz"><a title="Permalink" aria-hidden="true" href="#network-iocs---source-ips"><span>#</span></a>Network IOCs - Source IPs</h3> <table data-svelte-h="svelte-2rvwfp"><thead><tr><th>IP Address</th> <th>Organization</th> <th>ASN</th> <th>Country</th></tr></thead> <tbody><tr><td>104.219.171.96</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>108.64.229.100</td> <td>AT&amp;T Enterprises, LLC</td> <td>AS7018</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>115.167.65.16</td> <td>NTT America, Inc.</td> <td>AS2914</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>138.36.92.162</td> <td>HOSTINGFOREX S.A.</td> <td>AS265645</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>146.103.53.35</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>148.135.183.63</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>151.247.221.59</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>166.0.83.171</td> <td>UK Dedicated Servers Limited</td> <td>AS42831</td> <td>ðŸ‡¬ðŸ‡§</td></tr> <tr><td>172.59.92.152</td> <td>T-Mobile USA, Inc.</td> <td>AS21928</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>185.240.120.91</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ºðŸ‡¸</td></tr> <tr><td>185.239.140.40</td> <td>Datacamp Limited</td> <td>AS212238</td> <td>ðŸ‡ªðŸ‡¸</td></tr> <tr><td>194.35.226.128</td> <td>LeaseWeb Netherlands B.V.</td> <td>AS60781</td> <td>ðŸ‡³ðŸ‡±</td></tr> <tr><td>193.41.68.58</td> <td>LeaseWeb Netherlands B.V.</td> <td>AS60781</td> <td>ðŸ‡³ðŸ‡±</td></tr> <tr><td>77.78.79.243</td> <td>SPCom s.r.o.</td> <td>AS204383</td> <td>ðŸ‡¨ðŸ‡¿</td></tr> <tr><td>62.84.168.208</td> <td>Hydra Communications Ltd</td> <td>AS25369</td> <td>ðŸ‡¬ðŸ‡§</td></tr> <tr><td>45.66.95.235</td> <td>Hydra Communications Ltd</td> <td>AS25369</td> <td>ðŸ‡¬ðŸ‡§</td></tr> <tr><td>46.34.44.66</td> <td>Liberty Global Europe Holding B.V.</td> <td>AS6830</td> <td>ðŸ‡³ðŸ‡±</td></tr></tbody></table> <p data-svelte-h="svelte-14p59lj"><em>More IOCs available in Defused telemetry.</em></p> <h3 id="third-party-detection" data-svelte-h="svelte-1i0octq"><a title="Permalink" aria-hidden="true" href="#third-party-detection"><span>#</span></a>Third-Party Detection</h3> <p data-svelte-h="svelte-1nm6b90">The <code>base.Info</code> class was submitted to VirusTotal, where it received a hit from Nextron Systemsâ€™ THOR APT Scanner under a generic JSP webshell characteristics rule. Traditional AV engines largely miss the artifact - unsurprising for a payload that never touches disk - but heuristic engines correctly identify the behavioural signatures consistent with in-memory class loaders.</p> <p data-svelte-h="svelte-mrlvjr">See the <a href="https://www.virustotal.com/gui/file/097b051c9c9138ada0d2a9fb4dfe463d358299d4bd0e81a1db2f69f32578747a/community" rel="nofollow">VirusTotal entry here.</a></p> <h2 id="the-quiet-ones-are-worse" data-svelte-h="svelte-huptjn"><a title="Permalink" aria-hidden="true" href="#the-quiet-ones-are-worse"><span>#</span></a>The Quiet Ones Are Worse</h2> <p data-svelte-h="svelte-16jsvwc">Thereâ€™s a tendency in incident response to prioritise the loud compromises - the ransomware detonations, the mass data exfiltration, the lateral movement storms that light up every detection rule in the stack. This campaign is a useful reminder that the most dangerous intrusions are often the ones that donâ€™t do anything. Yet.</p> <p data-svelte-h="svelte-qxb2e2">The use of undocumented JSP paths, in-memory Java loaders, and dormant execution triggers represents a meaningful step forward in post-exploitation tradecraft targeting enterprise mobility infrastructure. When the operatorâ€™s goal is to create <em>inventory</em> rather than cause immediate damage, all the usual urgency signals go quiet - and thatâ€™s exactly the point.</p> <p data-svelte-h="svelte-1wuna5">If youâ€™re running Ivanti EPMM, donâ€™t wait for the second act. Patch, restart, and hunt. The loader is patient. You donâ€™t have to be.</p> <p data-svelte-h="svelte-wd9xr">Parts of the technical analysis above have been AI-assisted.</p></div></div>
  </body>
</html>
