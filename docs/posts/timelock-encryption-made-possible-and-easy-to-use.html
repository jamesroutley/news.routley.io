<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/drand/tlock">Original</a>
    <h1>Timelock Encryption made possible and easy to use</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><h2 dir="auto"><a id="user-content-tlock-timelock-encryptiondecryption-made-practical" aria-hidden="true" href="#tlock-timelock-encryptiondecryption-made-practical"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>tlock: Timelock Encryption/Decryption Made Practical</h2>
<p dir="auto">tlock gives you time based encryption and decryption capabilities by relying on a <a href="https://drand.love/" rel="nofollow">drand</a> threshold network.</p>
<p dir="auto">Our timelock encryption system relies on an unchained drand network. Currently, the only publicly available one is the League of Entropy Testnet.
However, it should soon also be available on the League&#39;s Mainnet.</p>
<p dir="auto">Working endpoints to access it are, for now:</p>
<ul dir="auto">
<li><a href="https://pl-us.testnet.drand.sh/" rel="nofollow">https://pl-us.testnet.drand.sh/</a></li>
<li><a href="https://testnet0-api.drand.cloudflare.com/" rel="nofollow">https://testnet0-api.drand.cloudflare.com/</a></li>
</ul>
<p dir="auto">Notice this is relying on the League of Entropy <strong>Testnet</strong>, which should not be considered secure.
A compatible League of Entropy Mainnet network is going to be launched in mid September, which can be considered secure.
In the meantime, we recommend only using the Testnet network for development and testing purposes.</p>
<p dir="auto">You can also spin up a new drand network and run your own, but notice that the security guarantees boil down to the trust you can have in your network.</p>
<hr/>
<h3 dir="auto"><a id="user-content-see-how-it-works" aria-hidden="true" href="#see-how-it-works"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>See How It Works</h3>
<p dir="auto">
	<a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/181501/177999855-cc1cfef7-ee1c-4193-bea7-4ee2e689f2d1.svg"><img src="https://user-images.githubusercontent.com/181501/177999855-cc1cfef7-ee1c-4193-bea7-4ee2e689f2d1.svg"/></a>
</p>
<hr/>
<h3 dir="auto"><a id="user-content-table-of-contents" aria-hidden="true" href="#table-of-contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Table Of Contents</h3>
<ul dir="auto">
<li><a href="#install-the-cli">Install the CLI</a></li>
<li><a href="#or-build-it">Build it</a></li>
<li><a href="#cli-usage">CLI usage</a>
<ul dir="auto">
<li><a href="#cli-encryption">Encryption</a></li>
<li><a href="#cli-decryption">Decryption</a></li>
</ul>
</li>
<li><a href="#library-usage">Library usage</a></li>
<li><a href="#applying-another-layer-of-encryption">Applying another layer of encryption</a></li>
<li><a href="#security-considerations">Security considerations</a></li>
</ul>
<hr/>
<h3 dir="auto"><a id="user-content-install-or-build-the-cli" aria-hidden="true" href="#install-or-build-the-cli"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install or Build the CLI</h3>
<p dir="auto">This tool is pure Go, it works without CGO (<code>CGO_ENABLED=0</code>)</p>
<div data-snippet-clipboard-copy-content="go install github.com/drand/tlock/cmd/tle@latest"><pre>go install github.com/drand/tlock/cmd/tle@latest</pre></div>
<div data-snippet-clipboard-copy-content="git clone https://github.com/drand/tlock
go build cmd/tle/tle.go"><pre>git clone https://github.com/drand/tlock
go build cmd/tle/tle.go</pre></div>
<hr/>
<h3 dir="auto"><a id="user-content-cli-usage" aria-hidden="true" href="#cli-usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CLI Usage</h3>
<div data-snippet-clipboard-copy-content="Usage:
	tle [--encrypt] (-r round)... [--armor] [-o OUTPUT] [INPUT]
	tle --decrypt [-o OUTPUT] [INPUT]

Options:
	-e, --encrypt  Encrypt the input to the output. Default if omitted.
	-d, --decrypt  Decrypt the input to the output.
	-n, --network  The drand API endpoint to use.
	-c, --chain    The chain to use. Can use either beacon ID name or beacon hash. Use beacon hash in order to ensure public key integrity.
	-r, --round    The specific round to use to encrypt the message. Cannot be used with --duration.
	-D, --duration How long to wait before the message can be decrypted. Defaults to 120d (120 days).
	-o, --output   Write the result to the file at path OUTPUT.
	-a, --armor    Encrypt or Decrypt to a PEM encoded format.

If the OUTPUT exists, it will be overwritten.

NETWORK defaults to the Drand test network http://pl-us.testnet.drand.sh/.

CHAIN defaults to the &#34;unchained&#34; hash in the default test network:
7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf

DURATION has a default value of 120d. When it is specified, it expects a number
followed by one of these units: &#34;ns&#34;, &#34;us&#34; (or &#34;µs&#34;), &#34;ms&#34;, &#34;s&#34;, &#34;m&#34;, &#34;h&#34;, &#34;d&#34;, &#34;M&#34;, &#34;y&#34;).

Example:
    $ tle -D 10d -o encrypted_file data_to_encrypt

After the specified duration:
    $ tle -d -o dencrypted_file.txt encrypted_file"><pre><code>Usage:
	tle [--encrypt] (-r round)... [--armor] [-o OUTPUT] [INPUT]
	tle --decrypt [-o OUTPUT] [INPUT]

Options:
	-e, --encrypt  Encrypt the input to the output. Default if omitted.
	-d, --decrypt  Decrypt the input to the output.
	-n, --network  The drand API endpoint to use.
	-c, --chain    The chain to use. Can use either beacon ID name or beacon hash. Use beacon hash in order to ensure public key integrity.
	-r, --round    The specific round to use to encrypt the message. Cannot be used with --duration.
	-D, --duration How long to wait before the message can be decrypted. Defaults to 120d (120 days).
	-o, --output   Write the result to the file at path OUTPUT.
	-a, --armor    Encrypt or Decrypt to a PEM encoded format.

If the OUTPUT exists, it will be overwritten.

NETWORK defaults to the Drand test network http://pl-us.testnet.drand.sh/.

CHAIN defaults to the &#34;unchained&#34; hash in the default test network:
7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf

DURATION has a default value of 120d. When it is specified, it expects a number
followed by one of these units: &#34;ns&#34;, &#34;us&#34; (or &#34;µs&#34;), &#34;ms&#34;, &#34;s&#34;, &#34;m&#34;, &#34;h&#34;, &#34;d&#34;, &#34;M&#34;, &#34;y&#34;).

Example:
    $ tle -D 10d -o encrypted_file data_to_encrypt

After the specified duration:
    $ tle -d -o dencrypted_file.txt encrypted_file
</code></pre></div>
<h4 dir="auto"><a id="user-content-time-lock-encryption" aria-hidden="true" href="#time-lock-encryption"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Time Lock Encryption</h4>
<p dir="auto">Files can be encrypted using a duration (<code>--duration/-D</code>) in which the <code>encrypted_data</code> can be decrypted.</p>
<div data-snippet-clipboard-copy-content="$ tle -n=&#34;http://pl-us.testnet.drand.sh/&#34; -c=&#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34; -D=5s -o=encrypted_data data.txt"><pre>$ tle -n=<span><span>&#34;</span>http://pl-us.testnet.drand.sh/<span>&#34;</span></span> -c=<span><span>&#34;</span>7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf<span>&#34;</span></span> -D=5s -o=encrypted_data data.txt</pre></div>
<p dir="auto">If a round (<code>--round/-R</code>) number is known, it can be used instead of the duration. The data can be decrypted only when that round becomes available in the network.</p>
<div data-snippet-clipboard-copy-content="$ tle -n=&#34;http://pl-us.testnet.drand.sh/&#34; -c=&#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34; -r=123456 -o=encrypted_data data.txt"><pre>$ tle -n=<span><span>&#34;</span>http://pl-us.testnet.drand.sh/<span>&#34;</span></span> -c=<span><span>&#34;</span>7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf<span>&#34;</span></span> -r=123456 -o=encrypted_data data.txt</pre></div>
<p dir="auto">It is also possible to encrypt the data to a PEM encoded format using the armor (<code>--armor/-a</code>) flag.</p>
<div data-snippet-clipboard-copy-content="$ tle -a -n=&#34;http://pl-us.testnet.drand.sh/&#34; -c=&#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34; -r=123456 -o=encrypted_data.PEM data.txt"><pre>$ tle -a -n=<span><span>&#34;</span>http://pl-us.testnet.drand.sh/<span>&#34;</span></span> -c=<span><span>&#34;</span>7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf<span>&#34;</span></span> -r=123456 -o=encrypted_data.PEM data.txt</pre></div>
<h4 dir="auto"><a id="user-content-time-lock-decryption" aria-hidden="true" href="#time-lock-decryption"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Time Lock Decryption</h4>
<p dir="auto">For decryption, it&#39;s only necessary to specify the network.</p>
<div data-snippet-clipboard-copy-content="$ tle -d -n=&#34;http://pl-us.testnet.drand.sh/&#34; -o=decrypted_data encrypted_data"><pre>$ tle -d -n=<span><span>&#34;</span>http://pl-us.testnet.drand.sh/<span>&#34;</span></span> -o=decrypted_data encrypted_data</pre></div>
<p dir="auto">If decoding a PEM source.</p>
<div data-snippet-clipboard-copy-content="$ tle -a -d -n=&#34;http://pl-us.testnet.drand.sh/&#34; -o=decrypted_data encrypted_data"><pre>$ tle -a -d -n=<span><span>&#34;</span>http://pl-us.testnet.drand.sh/<span>&#34;</span></span> -o=decrypted_data encrypted_data</pre></div>
<hr/>
<h3 dir="auto"><a id="user-content-library-usage" aria-hidden="true" href="#library-usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Library Usage</h3>
<p dir="auto">These example show how to use the API to time lock encrypt and decrypt data.</p>
<h4 dir="auto"><a id="user-content-time-lock-encryption-1" aria-hidden="true" href="#time-lock-encryption-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Time Lock Encryption</h4>
<div data-snippet-clipboard-copy-content="// Open an io.Reader to the data to be encrypted.
in, err := os.Open(&#34;data.txt&#34;)
if err != nil {
	log.Fatalf(&#34;open: %s&#34;, err)
	return
}
defer in.Close()

// Construct a network that can talk to a drand network.
// host:      &#34;http://pl-us.testnet.drand.sh/&#34;
// chainHash: &#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34;
network := http.NewNetwork(host, chainHash)

// Specify how long we need to wait before the file can be decrypted.
duration := 10 * time.Second

// Use the network to identify the round number that represents the duration.
roundNumber, err := network.RoundNumber(time.Now().Add(duration))
if err != nil {
	log.Fatalf(&#34;round by duration: %s&#34;, err)
	return
}

// Write the encrypted file data to this buffer.
var cipherData bytes.Buffer

// Encrypt the data for the given round.
if err := tlock.New(network).Encrypt(&amp;cipherData, in, roundNumber); err != nil {
	log.Fatalf(&#34;encrypt: %v&#34;, err)
	return
}"><pre><span>// Open an io.Reader to the data to be encrypted.</span>
<span>in</span>, <span>err</span> <span>:=</span> <span>os</span>.<span>Open</span>(<span>&#34;data.txt&#34;</span>)
<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
	<span>log</span>.<span>Fatalf</span>(<span>&#34;open: %s&#34;</span>, <span>err</span>)
	<span>return</span>
}
<span>defer</span> <span>in</span>.<span>Close</span>()

<span>// Construct a network that can talk to a drand network.</span>
<span>// host:      &#34;http://pl-us.testnet.drand.sh/&#34;</span>
<span>// chainHash: &#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34;</span>
<span>network</span> <span>:=</span> <span>http</span>.<span>NewNetwork</span>(<span>host</span>, <span>chainHash</span>)

<span>// Specify how long we need to wait before the file can be decrypted.</span>
<span>duration</span> <span>:=</span> <span>10</span> <span>*</span> <span>time</span>.<span>Second</span>

<span>// Use the network to identify the round number that represents the duration.</span>
<span>roundNumber</span>, <span>err</span> <span>:=</span> <span>network</span>.<span>RoundNumber</span>(<span>time</span>.<span>Now</span>().<span>Add</span>(<span>duration</span>))
<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
	<span>log</span>.<span>Fatalf</span>(<span>&#34;round by duration: %s&#34;</span>, <span>err</span>)
	<span>return</span>
}

<span>// Write the encrypted file data to this buffer.</span>
<span>var</span> <span>cipherData</span> bytes.<span>Buffer</span>

<span>// Encrypt the data for the given round.</span>
<span>if</span> <span>err</span> <span>:=</span> <span>tlock</span>.<span>New</span>(<span>network</span>).<span>Encrypt</span>(<span>&amp;</span><span>cipherData</span>, <span>in</span>, <span>roundNumber</span>); <span>err</span> <span>!=</span> <span>nil</span> {
	<span>log</span>.<span>Fatalf</span>(<span>&#34;encrypt: %v&#34;</span>, <span>err</span>)
	<span>return</span>
}</pre></div>
<h4 dir="auto"><a id="user-content-time-lock-decryption-1" aria-hidden="true" href="#time-lock-decryption-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Time Lock Decryption</h4>
<div data-snippet-clipboard-copy-content="// Open an io.Reader to the data to be decrypted.
in, err := os.Open(&#34;data.tle&#34;)
if err != nil {
	log.Fatalf(&#34;open: %v&#34;, err)
	return
}
defer in.Close()

// Construct a network that can talk to a drand network.
// host:      &#34;http://pl-us.testnet.drand.sh/&#34;
// chainHash: &#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34;
network := http.NewNetwork(host, chainHash)

// Write the decrypted file data to this buffer.
var plainData bytes.Buffer

// Decrypt the data. If you try to decrypt the data *before* the specified
// duration, it will fail with the message: &#34;too early to decrypt&#34;.
if err := tlock.New(network).Decrypt(&amp;plainData, in); err != nil {
	log.Fatalf(&#34;decrypt: %v&#34;, err)
	return
}"><pre><span>// Open an io.Reader to the data to be decrypted.</span>
<span>in</span>, <span>err</span> <span>:=</span> <span>os</span>.<span>Open</span>(<span>&#34;data.tle&#34;</span>)
<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
	<span>log</span>.<span>Fatalf</span>(<span>&#34;open: %v&#34;</span>, <span>err</span>)
	<span>return</span>
}
<span>defer</span> <span>in</span>.<span>Close</span>()

<span>// Construct a network that can talk to a drand network.</span>
<span>// host:      &#34;http://pl-us.testnet.drand.sh/&#34;</span>
<span>// chainHash: &#34;7672797f548f3f4748ac4bf3352fc6c6b6468c9ad40ad456a397545c6e2df5bf&#34;</span>
<span>network</span> <span>:=</span> <span>http</span>.<span>NewNetwork</span>(<span>host</span>, <span>chainHash</span>)

<span>// Write the decrypted file data to this buffer.</span>
<span>var</span> <span>plainData</span> bytes.<span>Buffer</span>

<span>// Decrypt the data. If you try to decrypt the data *before* the specified</span>
<span>// duration, it will fail with the message: &#34;too early to decrypt&#34;.</span>
<span>if</span> <span>err</span> <span>:=</span> <span>tlock</span>.<span>New</span>(<span>network</span>).<span>Decrypt</span>(<span>&amp;</span><span>plainData</span>, <span>in</span>); <span>err</span> <span>!=</span> <span>nil</span> {
	<span>log</span>.<span>Fatalf</span>(<span>&#34;decrypt: %v&#34;</span>, <span>err</span>)
	<span>return</span>
}</pre></div>
<hr/>
<h3 dir="auto"><a id="user-content-applying-another-layer-of-encryption" aria-hidden="true" href="#applying-another-layer-of-encryption"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Applying another layer of encryption</h3>
<p dir="auto">The recommended way of doing &#34;hybrid&#34; encryption where you both encrypt your data using timelock encryption, but also with another encryption scheme, such as a public-key or a symmetric-key scheme is to simple re-encrypt your encrypted data using tlock.</p>
<p dir="auto">For example, you can use the <a href="https://github.com/FiloSottile/age">age</a> cli to encrypt your data with a passphrase as follows.</p>
<h4 dir="auto"><a id="user-content-encrypting-data-with-passphrase" aria-hidden="true" href="#encrypting-data-with-passphrase"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Encrypting Data With Passphrase</h4>
<div data-snippet-clipboard-copy-content="$ cat data.txt | age -p | tle -D 30s -o encrypted_data"><pre>$ cat data.txt <span>|</span> age -p <span>|</span> tle -D 30s -o encrypted_data</pre></div>
<h4 dir="auto"><a id="user-content-decrypting-data-with-passphrase" aria-hidden="true" href="#decrypting-data-with-passphrase"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Decrypting Data With Passphrase</h4>
<div data-snippet-clipboard-copy-content="$ cat encrypted_data | tle -d | age -d -o data.txt"><pre>$ cat encrypted_data <span>|</span> tle -d <span>|</span> age -d -o data.txt</pre></div>
<p dir="auto">Note that you could do the same with PGP or any other encryption tool.</p>
<hr/>
<h3 dir="auto"><a id="user-content-security-considerations" aria-hidden="true" href="#security-considerations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Security considerations</h3>
<p dir="auto">Currently, this is relying on the League of Entropy <strong>Testnet</strong>, which should not be considered secure.
A compatible League of Entropy Mainnet network is going to be launched in mid September, which can be considered secure.</p>
<p dir="auto">The security of our timelock encryption mechanism relies on four main things:</p>
<ul dir="auto">
<li>The security of the underlying <a href="https://crypto.stanford.edu/~dabo/pubs/papers/bfibe.pdf" rel="nofollow">Identity Encryption Scheme</a> (proposed in 2001) and <a href="https://github.com/drand/kyber/blob/a780ab21355ebe7f60b441a586d5e73a40c564eb/encrypt/ibe/ibe.go#L39-L47">its implementation</a> that we&#39;re using.</li>
<li>The security of the <a href="https://link.springer.com/content/pdf/10.1007/s00145-004-0314-9.pdf" rel="nofollow">threshold BLS scheme</a> (proposed in 2003), and <a href="https://github.com/drand/kyber/blob/master/sign/tbls/tbls.go">its impementation</a> by the network you&#39;re relying on.</li>
<li>The security of <a href="https://age-encryption.org/" rel="nofollow">age</a>&#39;s underlying primitives, and that of the <a href="https://age-encryption.org/" rel="nofollow">age implementation</a> we&#39;re using to encrypt the data, since we rely on the <a href="https://en.wikipedia.org/wiki/Hybrid_cryptosystem" rel="nofollow">hybrid encryption</a> principle, where we only timelock encrypt (&#34;wrap&#34;) a random symmetric key that is used by age to actually symmetrically encrypt the data using <a href="https://datatracker.ietf.org/doc/html/rfc8439" rel="nofollow">Chacha20Poly1305</a>).</li>
<li>The security of the threshold network providing you with its BLS signatures <strong>at a given frequency</strong>, for instance the default for <code>tle</code> is to rely on drand and its existing League of Entropy network.</li>
</ul>
<p dir="auto">In practice this means that if you trust there are never more than the threshold <code>t</code> malicious nodes on the network you&#39;re relying on, you are guaranteed that you timelocked data cannot be decrypted earlier than what you intended.</p>
<p dir="auto">Please note that neither BLS nor the IBE scheme we are relying on are &#34;quantum resistant&#34;, therefore shall a Quantum Computer be built that&#39;s able to threaten their security, our current design wouldn&#39;t resist. There are also no quantum resistant scheme that we&#39;re aware of that could be used to replace our current design since post-quantum signatures schemes do not &#34;thresholdize&#34; too well in a post-quantum IBE-compatible way.</p>
<p dir="auto">However, such a quantum computer seems unlikely to be built within the next 5-10 years and therefore we currently consider that you can expect a &#34;<strong>long term security</strong>&#34; horizon of at least 5 years by relying on our design.</p>
<hr/>
<h3 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h3>
<p dir="auto">This project is licensed using the <a href="https://protocol.ai/blog/announcing-the-permissive-license-stack/" rel="nofollow">Permissive License Stack</a> which means that all contributions are available under the most permissive commonly-used licenses, and dependent projects can pick the license that best suits them.</p>
<p dir="auto">Therefore, the project is dual-licensed under Apache 2.0 and MIT terms:</p>
<ul dir="auto">
<li>Apache License, Version 2.0, (<a href="https://github.com/drand/drand/blob/master/LICENSE-APACHE">LICENSE-APACHE</a> or <a href="http://www.apache.org/licenses/LICENSE-2.0" rel="nofollow">http://www.apache.org/licenses/LICENSE-2.0</a>)</li>
<li>MIT license (<a href="https://github.com/drand/drand/blob/master/LICENSE-MIT">LICENSE-MIT</a> or <a href="http://opensource.org/licenses/MIT" rel="nofollow">http://opensource.org/licenses/MIT</a>)
89</li>
</ul>
</article>
          </div></div>
  </body>
</html>
