<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ratfactor.com/cards/fake-trees">Original</a>
    <h1>Fake Trees: Using Indents for Simpler UIs</h1>
    
    <div id="readability-page-1" class="page"><article>
        <header>
            
                
            
            
            
            
            
            
                <p>Created: <span>2023-12-29</span></p>
            
            
                <p>Updated: <span>2023-12-30</span></p>
                
            
            
        </header>

        
        <p>This is a technique I’ve used in actual for-pay software, but
most recently in my text adventure game editor, <a href="https://ratfactor.com/hiss/">Hiss</a>.</p>
<div>
<h2 id="_the_problem_you_want_a_tree_like_list_in_your_ui">The problem: you want a tree-like list in your UI</h2>
<div>
<p>Let’s say you have this fantastic dynamic list of Foo and Bar data and you
would like to display it in a tree view of some sort in your application:</p>
<div>
<div>
<pre>My Foos
    Foo 1
        Foo 1.a
        Foo 1.b
    Foo 2
    Foo 3
My Bars
    Bar I
        Baz baz baz
    Bar II
    Bar III
    Bar IV
...</pre>
</div>
</div>
<p>This obviously you need to implement some sort of parent-child relationship
between these items, right?</p>
<p>That sounds like a lot of work and potentially awkward-to-work-with data
structure, especially if stored in a database. But surely there is no way
around it. It’s &#34;obviously&#34; the only way to go.</p>
<p>Okay, so let’s do that. You could express this with a parent ID.
Something like this, if you’re using a database:</p>
<div>
<div>
<pre>  id | sort | name    | parent
 ----+------+---------+-------
  13 | 1    | Foo     | null
  78 | 1    | Foo 1   | 13
  98 | 1    | Foo 1.a | 78
  99 | 2    | Foo 1.b | 78
  ...</pre>
</div>
</div>
<p>Now how to do we work with this?</p>
<p>Well, for example, one way to get tree-structured data from a relational
database with a SQL query is to write a recursive CTE (Common Table
Expressions), which are just as fun as they sound.</p>
<p>If you’re a programmer, you’re probably already thinking about how you would
display this data…​</p>
</div>
</div>
<div>
<h2 id="_wait_but_does_your_data_really_need_to_be_a_tree">Wait, but does your data <em>really</em> need to be a tree?</h2>
<div>
<p>Do your items actually have to have a parent-child relationship, or do they
just need to <em>look</em> like they do?</p>
<p>I find that these lists are often just formatted this way for human
organization. There’s no actual need for a formal relationship between them.</p>
<p>If that’s the case, a vastly simpler method for storing this tree is:</p>
<div>
<div>
<pre>  id | sort | indent | name
 ----+------+--------+-------
  13 | 1    | 0      | Foo
  78 | 2    | 1      | Foo 1
  98 | 3    | 2      | Foo 1.a
  99 | 4    | 2      | Foo 1.b
  ...</pre>
</div>
</div>
<p>Why is this simpler? Because it literally describes what you see on the screen.
Which means it’s easy as pie to render. Note how the sort order is now absolute
for the entire list, not for sub-item order. The indent is quite literally how
much space to put before the item.</p>
<p>And it’s not just display the list that becomes easier - making an interface to
<em>edit</em> this tree can also be much simpler now. You can simply let the user
move items up and down and indent/unindent them to their heart’s content (or
put in some simple rules to enforce correct indenting - that’s up to you).
It becomes more like editing a list in a word processor than interfacing with
a data structure straight out of a computer science text book.</p>
</div>
</div>
<div>
<h2 id="_another_example_using_namespacing">Another example using &#34;namespacing&#34;</h2>
<div>

<p>I’ve got items with these names from a silly example game:</p>
<div>
<div>
<pre>Start
banana
banana.eat
banana.peel
banana.sniff
banana.throw away
monkey
...</pre>
</div>
</div>
<p>And these render in the interface like so:</p>
<div>
<p><img src="https://ratfactor.com/hiss/hiss18.png" alt="a things list contains sub-items under the banana thing: eat" width="peel" height="sniff"/>
</p>
</div>
<p>It appears I implemented some sort of namespacing feature to HissScript.</p>
<p>But I didn’t!</p>
<p>I’m just sorting the items alphabetically and if I see a dot (&#34;.&#34;) in a name, I
chop off the first part and indent the item.</p>
<p>As with the Foo and Bar list in the previous example, it looks like the game
editor &#34;understands&#34; the relationship, but that’s just an illusion.</p>
<p>Just to give a sense of how simple this is, here’s the entirety of the list
drawing code (JavaScript):</p>
<div>
<div>
<pre>var names = Object.keys(objs).sort();

return names.map(function(n){
    if(m = /^.+(\..+)$/.exec(n)){
        return [&#34;a.indent&#34;, {onclick:link(n)}, m[1]];
    }
    return [&#34;a&#34;, {onclick:link(n)}, n];
});</pre>
</div>
</div>
<p>And that’s raw editor code that sets up click handlers and everything. The
pseudocode logic is just:</p>
<div>
<div>
<pre>names = sort(things.keys)
each names as name:
    if contains(&#39;.&#39;, name):
        print_indent chop_before(&#39;.&#39;, name)
    else
        print name</pre>
</div>
</div>
<p>(I later added a check to make sure a &#34;parent&#34; item with the given prefix
exists before doing the indent/chop. But that was just another couple lines.
Also, it would be no problem to add arbitrarily deep nesting levels to this
namespacing feature but I’m waiting for an actual need.)</p>
<p>The &#34;namespacing&#34; appearance is <em>very</em> important for a human trying to organize
a game. But it means <em>nothing</em> to the game editor and player. Names with dots
in them are just names. The namespacing keeps them unique, but that’s it.</p>
<p>I learned the hard way long ago: more often than not, people don’t
actually want (or need) trees, they just need the <em>appearance</em> of them.</p>
</div>
</div>
<div>
<h2 id="_bonus_tree_as_list">Bonus tree-as-list</h2>
<div>
<p><strong>Update:</strong> Dave Long writes:</p>
<div>
<blockquote>
<p>&#34;Low-tech real trees: store path + info in a flat list (like the output of find).&#34;</p>
</blockquote>
</div>
<p>That’s definitely true and is essentially the insight behind my &#34;banana.eat&#34;
example above. Here’s some fake <code>find</code> output:</p>
<div>
<div>
<pre>./foo/zonk
./foo/bonk
./bar/boop/bop
./bar/boop/bleep</pre>
</div>
</div>
<div>
<blockquote>
<p>&#34;Want a depth-first traversal? lexically sort by the path.&#34;</p>
</blockquote>
</div>
<p>For sure:</p>
<div>
<div>
<pre>./bar/boop/bleep
./bar/boop/bop
./foo/bonk
./foo/zonk</pre>
</div>
</div>
<div>
<blockquote>
<p>&#34;Want a breadth-first traversal? sort by the (properly padded) reversal of the path&#34;</p>
</blockquote>
</div>
<p>To make this one work, you first reverse your paths by the path separator. Then
you need to ensure your paths all have the same &#34;depth&#34; by adding blank items.</p>
<p>Then sort:</p>
<div>
<div>
<pre>      / bonk / foo / .
      / zonk / foo / .
bleep / boop / bar / .
bop   / boop / bar / .</pre>
</div>
</div>
<p>The list above is to demonstrate the conceptual result, but presumably you’re
doing this with arrays after having chopped up your lines by separator.</p>
<p>Flat lists are great to work with in general. Computers like them and they seem
to suit my simple mind as well.  If possible, I put things in plain old lists.
This reminds me of my other recent card:
<a href="https://ratfactor.com/cards/if-else-stack">Interpreting if/else logic with a simple flat list of booleans</a>.</p>
</div>
</div>
<div>
<h2 id="_physical_analogy">Physical analogy</h2>
<div>
<p>Just to hammer on the point, let’s say you’re working on your personal
scrapbook. You’re starting to put boxes of photos, notes, postcards, ticket stubs,
etc. into some sort of order. You’re laying everything out on the floor and
you’re making some really nice groupings of items and you’ve even made little
folded paper signs to label the groups.</p>
<p>Even though it is <em>glaringly obvious</em> to you, the human, how these groups work,
is there actually any physical mechanism built into your floor to enforce this
relationship? Of course not. <strong>The floor has no idea what’s going on.</strong></p>
<p><em>(Or if it does, you have accidentally moved into a home built
over an ancient burial ground and are in immediate danger. Pack a bag and
leave now. Sleep in a hotel tonight and you can think about how to get your
belongings and find a new home when you’ve got a clear head tomorrow morning.
The scrapbook can wait for a better time when you’re less likely to be eaten
by skeletons.)</em></p>
</div>
</div>
<div>
<h2 id="_caution_one_size_does_not_fit_all">Caution: One size does not fit all</h2>
<div>
<p>I’m sure there are infinite variations on this and I’m sure I’m not the first
person to think either of the above two example techniques. But I have never
seen anyone mention it before. So anything like this will probably count as a
&#34;hack&#34; in most programming circles.</p>
<p>You will almost definitely need to heavily adapt it to your specific scenario.</p>
<p>And for the love of all that is good, if you <strong>actually need a tree</strong>, use a
tree. Do the whole parent ID thing (or separate parent/child join table or
whatever makes sense to your data model).</p>
<p>In the physical analogy above, if you’re cataloging a massive research project
and you <em>need</em> the organizing power of physical filing cabinets and
neatly-labeled folders, the floor method is not going to cut it!
<em>(Just make sure you’re not using haunted filing cabinets.)</em></p>
<p><strong>Do not</strong> hack something with indents or counting symbols in strings or some
nonsense like that if you will ever need to <em>actually know</em> the relationship
between your items. Yes, you can do it, but it will be a path of suffering
for the lifetime of the project and all of its maintenance forever after.
Don’t say I didn’t warn you.</p>
</div>
</div>

        
    </article></div>
  </body>
</html>
