<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/flavioribeiro/donut">Original</a>
    <h1>Go Donut: Convert Live Streaming to WebRTC</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/244265/200068510-7c24d5c7-6ba0-44ee-8e60-0f157f990b90.png"><img src="https://user-images.githubusercontent.com/244265/200068510-7c24d5c7-6ba0-44ee-8e60-0f157f990b90.png" width="350"/></a></p>
<p dir="auto"><strong>donut</strong> is a zero setup required <a href="https://en.wikipedia.org/wiki/Secure_Reliable_Transport" rel="nofollow">SRT</a> (<em>MPEG-TS</em>) and <a href="https://en.wikipedia.org/wiki/Real-Time_Messaging_Protocol" rel="nofollow">RTMP</a> to <a href="https://webrtc.org/" rel="nofollow">WebRTC</a> bridge powered by <a href="http://pion.ly/" rel="nofollow">Pion</a>.</p>

<section data-identity="a96ab681-2e5e-4860-9a8c-85a5600d5901" data-host="https://viewscreen.githubusercontent.com" data-src="https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com" data-type="mermaid" aria-label="mermaid rendered output container">
  <div data-json="{&#34;data&#34;:&#34;sequenceDiagram\n    actor User\n\n    box Cornsilk\n        participant browser\n    end\n\n    User-&amp;gt;&amp;gt;+browser: input protocol, host, port, id, and opts\n    User-&amp;gt;&amp;gt;+browser: click on [Connect]\n    \n    Note over donut,browser: WebRTC connection setup\n    \n    browser-&amp;gt;&amp;gt;+browser: create WebRTC browserOffer\n    browser-&amp;gt;&amp;gt;+donut: POST /doSignaling {browserOffer}\n\n    donut-&amp;gt;&amp;gt;+browser: reply WebRTC {serverOffer}\n\n    Note over donut,browser: WebRTC connection setup\n\n    loop Async streaming\n        donut--)streaming server: fetchMedia\n        donut--)donut: ffmpeg::libav demux/transcode\n        donut--)browser: sendWebRTCMedia\n        browser--)browser: render audio/video frames\n        User--)browser: watch media\n    end\n&#34;}" data-plain="sequenceDiagram
    actor User

    box Cornsilk
        participant browser
    end

    User-&gt;&gt;+browser: input protocol, host, port, id, and opts
    User-&gt;&gt;+browser: click on [Connect]
    
    Note over donut,browser: WebRTC connection setup
    
    browser-&gt;&gt;+browser: create WebRTC browserOffer
    browser-&gt;&gt;+donut: POST /doSignaling {browserOffer}

    donut-&gt;&gt;+browser: reply WebRTC {serverOffer}

    Note over donut,browser: WebRTC connection setup

    loop Async streaming
        donut--)streaming server: fetchMedia
        donut--)donut: ffmpeg::libav demux/transcode
        donut--)browser: sendWebRTCMedia
        browser--)browser: render audio/video frames
        User--)browser: watch media
    end
" dir="auto">
    <div dir="auto">
      <pre lang="mermaid" aria-label="Raw mermaid code">sequenceDiagram
    actor User

    box Cornsilk
        participant browser
    end

    User-&gt;&gt;+browser: input protocol, host, port, id, and opts
    User-&gt;&gt;+browser: click on [Connect]
    
    Note over donut,browser: WebRTC connection setup
    
    browser-&gt;&gt;+browser: create WebRTC browserOffer
    browser-&gt;&gt;+donut: POST /doSignaling {browserOffer}

    donut-&gt;&gt;+browser: reply WebRTC {serverOffer}

    Note over donut,browser: WebRTC connection setup

    loop Async streaming
        donut--)streaming server: fetchMedia
        donut--)donut: ffmpeg::libav demux/transcode
        donut--)browser: sendWebRTCMedia
        browser--)browser: render audio/video frames
        User--)browser: watch media
    end
</pre>
    </div>
  </div>
  <span role="presentation">
    <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true" data-view-component="true">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" fill="none"></circle>
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"></path>
</svg>  <span>Loading</span>

  </span>
</section>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flavioribeiro/donut/blob/main/.github/docker-compose-donut-setup.webp"><img src="https://github.com/flavioribeiro/donut/raw/main/.github/docker-compose-donut-setup.webp" alt="donut docker-compose setup" title="donut docker-compose setup"/></a></p>
<p dir="auto">ref: <a href="https://github.com/flavioribeiro/donut/blob/main/HOW_IT_WORKS.md">how donut works</a></p>

<p dir="auto">Make sure you have the <code>ffmpeg 5.x.x</code>. You must configure the CGO library path pointing it to <strong>ffmpeg 5</strong>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="export CGO_LDFLAGS=&#34;-L/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/lib/&#34;
export CGO_CFLAGS=&#34;-I/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/include/&#34;
export PKG_CONFIG_PATH=&#34;/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/lib/pkgconfig&#34;"><pre><span>export</span> CGO_LDFLAGS=<span><span>&#34;</span>-L/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/lib/<span>&#34;</span></span>
<span>export</span> CGO_CFLAGS=<span><span>&#34;</span>-I/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/include/<span>&#34;</span></span>
<span>export</span> PKG_CONFIG_PATH=<span><span>&#34;</span>/opt/homebrew/Cellar/ffmpeg@5/5.1.4_6/lib/pkgconfig<span>&#34;</span></span></pre></div>
<p dir="auto">Now you can install and run it:</p>
<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/flavioribeiro/donut@latest
donut"><pre>go install github.com/flavioribeiro/donut@latest
donut</pre></div>
<p dir="auto">Here are specific instructions <a href="https://github.com/flavioribeiro/donut/blob/main/MAC_DEVELOPMENT.md">to run on MacOS</a>.</p>

<p dir="auto">Alternatively, you can use <code>docker-compose</code> to simulate an <a href="https://github.com/flavioribeiro/donut/blob/main/DOCKER_DEVELOPMENT.md">SRT live transmission and run the donut effortless</a>.</p>


<p dir="auto">Open <a href="http://localhost:8080/demo" rel="nofollow">http://localhost:8080/demo</a>. You will see two text fields. Fill them with the your streaming info and hit connect.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flavioribeiro/donut/blob/main/.github/docker-compose-donut-setup.webp"><img src="https://github.com/flavioribeiro/donut/raw/main/.github/docker-compose-donut-setup.webp" alt="donut docker-compose setup" title="donut docker-compose setup"/></a></p>

<p dir="auto">Please check the <a href="https://github.com/flavioribeiro/donut/blob/main/FAQ.md">FAQ</a> if you&#39;re facing any trouble.</p>
</article></div></div>
  </body>
</html>
