<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.blog/2023-01-17-git-security-vulnerabilities-announced-2/">Original</a>
    <h1>Git Security Vulnerabilities Announced</h1>
    
    <div id="readability-page-1" class="page"><div>
  <div>
    


<main role="main" id="post-69534">
  
<p>Today, the Git project <a href="https://lore.kernel.org/git/xmqq7cxl9h0i.fsf@gitster.g/T/#u">released</a> new versions to address a pair of security vulnerabilities, <a href="https://github.com/git/git/security/advisories/GHSA-475x-2q3q-hvwq">CVE-2022-41903</a>, and <a href="https://github.com/git/git/security/advisories/GHSA-c738-c5qq-xg89">CVE-2022-23521</a>, that affect versions 2.39 and older.</p>
<p>Git for Windows was also patched to address an additional, Windows-specific issue known as <a href="https://github.com/git-for-windows/git/security/advisories/GHSA-v4px-mx59-w99c">CVE-2022-41953</a>.</p>
<p>The first two vulnerabilities affect Git’s commit formatting mechanism and <code>.gitattributes</code> parser, respectively. The former can be used to perform arbitrary heap writes, while the latter can be used for arbitrary reads, too. Both may result in arbitrary code execution, so users should upgrade immediately. Both were also found as part of an audit of the Git codebase conducted by <a href="https://x41-dsec.de/">X41</a>. This audit was sponsored by the <a href="https://ostif.org/">Open Source Technology Improvement Fund</a> (OSTIF). Fixes were authored by engineers from the <a href="https://about.gitlab.com/handbook/security/threat-management/security-research/">GitLab Security Research Team</a>, as well as GitHub Engineers, and members of the git-security mailing list.</p>
<p>A complete copy of the report (along with a variety of issues that weren’t deemed to have security implications) is available <a href="https://github.com/git/git/files/10430260/X41-OSTIF-Gitlab-Git-Security-Audit-20230117-public.pdf">here</a>.</p>
<p>The Windows-specific issue involves a <code>$PATH</code> lookup including the current working directory, which can be leveraged to run arbitrary code when cloning repositories with Git GUI.</p>
<h2 id="cve-2022-41903">CVE-2022-41903<a href="#cve-2022-41903" aria-label="CVE-2022-41903"></a></h2>
<p>The first set of updates concern Git’s commit-formatting mechanism, used to display arbitrary information about commits, as in <code>git log --format</code>. When processing one of the <a href="https://git-scm.com/docs/pretty-formats#Documentation/pretty-formats.txt-emltltNgttruncltruncmtruncem">padding operators</a> (for example, <code>%&lt;(</code>, <code>%&gt;(</code>, etc.) an integer overflow can occur when a large offset is given).</p>
<p>This vulnerability can be triggered directly via <code>git log --format</code>. It may also be triggered indirectly via Git’s <code><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes#_export_subst">export-subst</a></code> mechanism, which applies the formatting modifiers to selected files when using <code><a href="https://git-scm.com/docs/git-archive">git archive</a></code>.</p>
<p>This integer overflow can result in arbitrary heap reads and writes, which may result in remote code execution.</p>
<p>[<a href="https://github.com/git/git/compare/abd4d67ab0f84fff703fa14d9eebfd287b42daeb...304a50adff6480ede46b68f7545baab542cbfb46">source</a>]</p>
<h2 id="cve-2022-23521">CVE-2022-23521<a href="#cve-2022-23521" aria-label="CVE-2022-23521"></a></h2>
<p><code><a href="https://git-scm.com/docs/gitattributes">gitattributes</a></code> are used to define unique attributes corresponding to paths in your repository. These attributes are defined by <code>.gitattributes</code> file(s) within your repository.</p>
<p>The parser used to read these files has multiple integer overflows, which can occur when parsing either a large number of patterns, a large number of attributes, or attributes with overly-long names.</p>
<p>These overflows may be triggered via a malicious .gitattributes file. However, Git automatically splits lines at 2KB when reading <code>.gitattributes</code> from a file, but not when parsing it from the index. Successfully exploiting this vulnerability depends on the location of the <code>.gitattributes</code> file in question.</p>
<p>Like the above, this integer overflow can result in arbitrary heap reads and writes, which may result in remote code execution.</p>
<p>[<a href="https://github.com/git/git/compare/3305300f4c27859e82633c4df94a6b31415a5fb2...3c50032ff5289cc45659f21949c8d09e52164579">source</a>]</p>
<h2 id="cve-2022-41953">CVE-2022-41953<a href="#cve-2022-41953" aria-label="CVE-2022-41953"></a></h2>
<p>After cloning a repository, Git GUI automatically applies some post-processing to the resulting checkout, including running a spell-checker, if one is available.</p>
<p>A Windows-specific vulnerability causes Git GUI to look for the spell-check in the worktree that was just checked out, which may result in running untrusted code.</p>
<p>[<a href="https://github.com/git-for-windows/git/compare/8e17eddb924fa9e7bacff258ab94671e86aef02b...5de016e4ad628eb2a76f6529489915fca47ac78c">source</a>]</p>
<h2 id="upgrade-to-the-latest-git-version">Upgrade to the latest Git version<a href="#upgrade-to-the-latest-git-version" aria-label="Upgrade to the latest Git version"></a></h2>
<p>The most effective way to protect against these vulnerabilities is to upgrade to Git 2.39.1. If you can’t update immediately, reduce your risk by taking the following steps:</p>
<ul>
<li>Avoid invoking the <code>--format</code> mechanism directly with the known operators, and avoid running <code>git archive</code> in untrusted repositories.</li>
<li>If you expose <code>git archive</code> via <code>git daemon</code>, consider disabling it if working with untrusted repositories by running <code>git config --global daemon.uploadArch false</code>.</li>
<li>Avoid using Git GUI on Windows when cloning untrusted repositories. </li>
</ul>
<p>In order to protect users against these attacks, GitHub has taken proactive steps. Specifically, we:</p>
<ul>
<li>Scanned all repositories on GitHub.com to confirm that no evidence exists to conclude that GitHub was used as a vector to exploit any of these vulnerabilities.</li>
<li>Implemented mitigation steps to prevent GitHub.com from being used as an attack vector in <a href="https://github.com/git/git/security/advisories/GHSA-475x-2q3q-hvwq">CVE-2022-41903</a>, and <a href="https://github.com/git/git/security/advisories/GHSA-c738-c5qq-xg89">CVE-2022-23521</a>.</li>
<li>Scheduled a GitHub Desktop release for later today, January 17, that prevents the exploitation of this vulnerability.</li>
<li>Scheduled updates to GitHub Codespaces and GitHub Actions to upgrade their versions of Git.</li>
<li>Scheduled updates to GitHub Enterprise Server<sup id="fnref-69534-1"><a href="#fn-69534-1" title="Read footnote.">1</a></sup> with patched versions of Git.</li>
</ul>
<p>Credit for <a href="https://github.com/git/git/security/advisories/GHSA-475x-2q3q-hvwq">CVE-2022-41903</a>, and <a href="https://github.com/git/git/security/advisories/GHSA-c738-c5qq-xg89">CVE-2022-23521</a> goes to Markus Vervier, and Eric Sesterhenn of <a href="https://x41-dsec.de/">X41 D-Sec</a>, whose work was sponsored by <a href="https://ostif.org/">OSTIF</a>, as well as Joern Schneeweisz of GitLab. Fixes were written by Patrick Steinhardt of GitLab, with additional help from members of the Git security mailing list.</p>
<p>Credit for finding <a href="https://github.com/git-for-windows/git/security/advisories/GHSA-v4px-mx59-w99c">CVE-2022-41953</a> goes to 俞晨东.</p>
<hr/>
<p><a href="https://git-scm.com/">Download Git 2.39.1</a></p>

<h2 id="notes">Notes<a href="#notes" aria-label="Notes"></a></h2>


      
  </main>


  </div>
</div></div>
  </body>
</html>
