<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bejarano.io/terraform-stateless-critique/">Original</a>
    <h1>A more mature take on stateless Terraform</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
<p>A year and a half ago, I wrote <a href="https://www.bejarano.io/terraform-stateless/">this piece</a> on why “<mark>Terraform should have remained stateless</mark>”.</p>
<p>It was a critique of <a href="https://developer.hashicorp.com/terraform/language/state/purpose">Terraform’s admitted reasons</a> as to <strong>why it requires state</strong>, why said <strong>state makes using Terraform painful</strong>, and my proposal for a <code>none</code> state backend that would enable Terraform to <strong>operate just as fine without state</strong>.</p>
<p>As time passed, I have tried to <strong>back my words with code</strong>, and got a deeper understanding of Terraform’s need for state and how <strong>we could make it stateless</strong> without significant changes to its design.</p>
<p>What you are about to read is my <mark>self-critique</mark> of that piece, along with a <mark>revised proposal</mark> for a stateless Terraform.</p>
<h2 id="what-i-got-wrong-terraform-needs-state">What I got wrong: Terraform needs state</h2>
<p><strong>I was wrong</strong>: Terraform needs <em>some form</em> of state.</p>
<p>These are the reasons Terraform’s <a href="https://developer.hashicorp.com/terraform/language/state/purpose">documentation</a> quotes:</p>
<h4 id="mapping-to-the-real-world">Mapping to the real world</h4>
<p>You <mark>do not <em>really</em> need state</mark> to do this.</p>
<p>Most infrastructure resources have one or more <strong>attributes that can perform as “primary key”</strong> of such resources.</p>
<p>Said attributes need only meet these two requirements:</p>
<ul>
<li><strong>must be user-defined <em>before</em> resource creation</strong>, so we can write them down in code; and</li>
<li><strong>must <em>uniquely</em> identify the resource <em>at least within the scope of the provider</em></strong> that manages said resource.</li>
</ul>
</div></div>
  </body>
</html>
