<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tobylam.xyz/2023/11/27/inverse-functions-legendre-part-1">Original</a>
    <h1>Geometrically understanding calculus of inverse functions (2023)</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">

    <!-- Makes it possible to have an excerpt that has HTML code in it (instead of only plaintext in a string) -->
    
      <p>Given a function such as \(\tan x\), could you write \(\frac{d}{dx} \arctan x\) and \(\int \arctan x \; dx\), just from \(\tan x\), \(\frac{d}{dx} \tan x\) and \(\int \tan x \; dx\)? With some caveats, the inverse function theorem answers the former while the Legendre transformation answers the later. We’ll approach this with as much geometric intuition as possible, avoiding the dry application of formulas.</p>

<h2 id="derivatives-of-inverse-functions-and-the-inverse-function-theorem">Derivatives of inverse functions and the inverse function theorem</h2>

<p>Instead of approaching the inverse function theorem through formulas, we’ll explore it geometrically—it’s much more intuitive and enjoyable!</p>

<p>But first, to refresh our memory, let’s revisit the formal statement of the inverse function theorem, which relates the derivative of \(f(x)\) and its inverse \(f^{-1}(x)\).</p>

<blockquote>
  <p>Given a continuously differentiable function \(f: \mathbb{R} \to \mathbb{R}\) with \(f&#39;(a) \neq 0\) at some point, the inverse function theorem states that there is some interval \(I\) with \(a \in I\) such that there exists a continuously differentiable inverse \(f^{-1}\) defined on \(f(I)\) such that for all \(x \in I\)</p>
</blockquote><p>

\[\frac{df^{-1}}{dx}(x) = \frac{1}{f&#39;(f^{-1}(x))}.\]

</p><p>A simple example of the theorem in action is finding the derivative of \(\ln x\), which evaluates to \(1/e^{\ln x} = 1/x\). The standard high school approach to deduce the above in high school is to differentiate both sides of \(f^{-1}(f(x)) = x\).</p>

<p>This formal approach is quite dry and things get a lot more interesting when we think geometrically.</p>

<p>Geometrically, given some function \(f(x) = y\) the inverse is just taking the plot of the function and reflecting it about the diagonal line \(y=x\). As such all tangent lines are also reflected along the diagonal line and hence the slope is inversed. Below we have the graph of \(e^x\) (the blue line) and the graph of \(\ln x\) (the red line). And you can see how the tangent line of \(e^x\) at \((2,e^2)\) is reflected along \(y=x\) to give the tangent line of \(\ln x\) at \((e^2, 2)\).</p>

<p><img src="https://tobylam.xyz/generated/assets/images/2023-11-28-e%5Ex-ivt-600-8400210a9.webp" srcset="/generated/assets/images/2023-11-28-e%5Ex-ivt-480-8400210a9.webp 480w, /generated/assets/images/2023-11-28-e%5Ex-ivt-600-8400210a9.webp 600w, /generated/assets/images/2023-11-28-e%5Ex-ivt-720-8400210a9.webp 720w, /generated/assets/images/2023-11-28-e%5Ex-ivt-900-8400210a9.webp 900w, /generated/assets/images/2023-11-28-e%5Ex-ivt-1080-8400210a9.webp 1080w, /generated/assets/images/2023-11-28-e%5Ex-ivt-1250-8400210a9.webp 1250w" sizes="(max-width: 600px) 100vw, (max-width: 1000px) 600px, (max-width: 1400px) 600px, (min-width: 1401px) 600px" width="1250" height="628"/></p>

<p>Another way of looking at it would be to subjugate \(S=\{(x, f(x)) \, \vert \, x \in I\}\), the plot of \(f(x)\), with a graph transformation \(\phi:(x,y) \to (\hat{x}, \hat{y}) = (y,x)\) and express \(\phi(S)\) as a plot \((\hat{x}, \hat{y}(\hat{x}))\). This way \(\hat{y}\) would be in effect the inverse of \(y\). We then wish to understand how \(\phi\) acts on \(\frac{dy}{dx}\) to give \(\frac{d\hat{y}}{d\hat{x}}\).</p>

<p>You can express this with the following graph</p>

<p><img alt="https://q.uiver.app/#q=WzAsNixbMywwLCIoeSh4KSx4KSJdLFswLDIsIih4LCB5Jyh4KSkiXSxbMywyLCIoXFxoYXR7eH0sXFxmcmFje2RcXGhhdHt5fX17ZFxcaGF0e3h9fSkgIl0sWzAsMCwiKHgseSh4KSkiXSxbNCwwLCIoXFxoYXR7eH0sXFxoYXR7eX0oXFxoYXR7eH0pKSAiXSxbNCwxLCJcXGhhdHt4fSh4KT0geSh4KSBcXFxcIFxcaGF0e3l9KFxcaGF0e3h9KHgpKT15XnstMX0oXFxoYXR7eH0pIl0sWzAsMiwiXFxmcmFje2R9e2RcXGhhdHt4fX0iXSxbMSwyXSxbMywwLCJcXHBoaSgoeCx5KSk9KHkseCkiXSxbMywxLCJcXGZyYWN7ZH17ZHh9Il0sWzAsNCwiPSIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs0LDUsIiIsMSx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=" src="https://tobylam.xyz/generated/assets/images/legend1-600-fb2c4463e.png" srcset="/generated/assets/images/legend1-480-fb2c4463e.webp 480w, /generated/assets/images/legend1-600-fb2c4463e.webp 600w, /generated/assets/images/legend1-720-fb2c4463e.webp 720w, /generated/assets/images/legend1-900-fb2c4463e.webp 900w, /generated/assets/images/legend1-1080-fb2c4463e.webp 1080w, /generated/assets/images/legend1-1260-fb2c4463e.webp 1260w, /generated/assets/images/legend1-1304-fb2c4463e.webp 1304w" sizes="(max-width: 600px) 100vw, (max-width: 1000px) 600px, (max-width: 1400px) 600px, (min-width: 1401px) 600px" width="1304" height="782"/></p>

<p>and the equalities</p><p>

\[\begin{align*}
    \hat x(x) &amp;= y(x), \\
    \hat y(\hat x(x)) &amp;= x \\
    &amp;= y^{-1}(\hat x(x)).
\end{align*}\]

</p><p>We could then directly calculate</p><p>

\[\begin{align*}
    \frac{d\hat{y}}{d\hat{x}}(\hat x(x)) &amp;= \frac{d\hat{y}}{dx}(x) / \frac{d\hat{x}}{dx}(x) &amp; \text{(Chain rule)} \\
    &amp;= 1 / \frac{dy}{dx}(x).
\end{align*}\]

</p><p>This recovers the inverse function theorem.</p>

<p>This method generalises to other maps \(\phi: \mathbb{R}^2 \to \mathbb{R}^2\) (e.g. \(\phi:(r, \theta) \to (r \cos \theta, r \sin \theta)\)) . These ideas are explored much more deeply in <a href="https://www.cambridge.org/core/books/symmetry-methods-for-differential-equations/805DEEB7D5D0D2040A3A8444B1C8A33E">Hydon’s book on Symmetry Methods for Differential Equations</a>.</p>

<p>By calculating \(\frac{d}{dx} \tan x = \sec^2 x\), we now know that \(\frac{d}{dx} \arctan x = \frac{1}{\text{sec}^2(\arctan x)} = \frac{1}{1+x^2}\). So what about \(\int \arctan x \, dx\)?</p>

<h2 id="integrals-of-inverse-functions-and-the-legendre-transformation">Integrals of inverse functions and the Legendre transformation</h2>

<p>Geometrically, we could show that with \(f\) strictly monotone, we have</p><p>

\[\int_{f(a)}^{f(b)} f^{-1}(y) \, dy + \int^{b}_a f(x) \, dx  = bf(b)-af(a)\]

</p><p>This is <a href="https://en.wikipedia.org/wiki/Integral_of_inverse_functions">a result by Laisant in 1905</a>. Here’s a proof-without-words.</p>

<p><img src="https://tobylam.xyz/generated/assets/images/legend3-800-1a031bab5.png" srcset="/generated/assets/images/legend3-400-1a031bab5.png 400w, /generated/assets/images/legend3-600-1a031bab5.png 600w, /generated/assets/images/legend3-800-1a031bab5.png 800w, /generated/assets/images/legend3-1000-1a031bab5.png 1000w"/></p>

<!-- <small> By <a href="//commons.wikimedia.org/w/index.php?title=User:Jonathan.Steinbuch&amp;action=edit&amp;redlink=1" title="Jonathan Steinbuch - Own work"> Jonathan Steinbuch - Own work, </a>
 <a href="https://creativecommons.org/licenses/by-sa/3.0" title="Creative Commons Attribution-Share Alike 3.0">CC BY-SA 3.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=16592836">Link</a> </small> -->

<p>You can use this to recover the explicit formula of the integral of \(f^{-1}\), which is left as an exercise! Instead we will use the graph reflection approach used earlier for the inverse function theroem.</p>

<p>Suppose we’re interested in finding \(\int \arctan x \, dx\). Notationally, it is the easiest to let \(y = \int \tan x \, dx\) up to some constant such that \(\frac{dy}{dx} = \tan x\) is the function we want to invert. Let \(S\) be the plot of \(\frac{dy}{dx}\), i.e. \(\{(x, \frac{dy}{dx}) \vert \, x \in I\}\) for some appropiate interval \(I\). Applying the map \(\phi: (x,y) \to (\hat{x}, \hat{y}) = (y,x)\), we assume the existence of some \(\hat{y}\) such that its derivative is the plot of \(\phi(S)\). Now \(\hat{y} = \int \arctan \hat{x} \, d\hat{x}\) which is what we seek.</p>

<p>Consider</p>

<p><img alt="https://q.uiver.app/#q=WzAsNSxbMywwLCIoXFxoYXR7eH0sXFxoYXR7eX0oXFxoYXQgeCkiXSxbMCwyLCIoeCwgXFxmcmFje2R5fXtkeH0oeCkpIl0sWzMsMiwiKFxcaGF0IHgsIFxcZnJhY3tkXFxoYXQgeX17ZFxcaGF0IHh9KFxcaGF0IHgpKSAiXSxbMCwwLCIoeCx5KHgpKSJdLFs1LDNdLFswLDIsIlxcZnJhY3tkfXtkXFxoYXR7eH19Il0sWzEsMiwiXFxwaGkoKHgseSkpPSh5LHgpIl0sWzMsMSwiXFxmcmFje2R9e2R4fSJdXQ==" src="https://tobylam.xyz/generated/assets/images/legend2-600-9a72c68ab.png" srcset="/generated/assets/images/legend2-480-9a72c68ab.webp 480w, /generated/assets/images/legend2-600-9a72c68ab.webp 600w, /generated/assets/images/legend2-720-9a72c68ab.webp 720w, /generated/assets/images/legend2-900-9a72c68ab.webp 900w, /generated/assets/images/legend2-1080-9a72c68ab.webp 1080w, /generated/assets/images/legend2-1232-9a72c68ab.webp 1232w" sizes="(max-width: 600px) 100vw, (max-width: 1000px) 600px, (max-width: 1400px) 600px, (min-width: 1401px) 600px" width="1232" height="712"/></p>

<p>with the equalities</p><p>

\[\begin{align*}
    \hat x(x) &amp;= \frac{dy}{dx}(x), \\
    \frac{d\hat y}{d\hat x}(\hat x(x)) &amp;= x. \\
\end{align*}\]

</p><p>Now consider</p><p>

\[\begin{align*}
    &amp;\;\hat{y}(\hat{x}) \\
    &amp;= \int\frac{d\hat y}{d\hat x}(\hat{x}) d\hat{x}  \\
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - \int \hat{x}\frac{d^2\hat y}{d\hat x^2}(\hat{x}) d\hat{x}  &amp; (\text{by parts}) \\
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - \int \hat{x}(x)\frac{d^2\hat y}{d\hat x^2}(\hat{x}(x))  \frac{d\hat x}{dx}(x) dx &amp;\\
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - \int \hat{x}(x)\bigg[\frac{d}{dx}\bigg(\frac{d\hat y}{d\hat x}(\hat{x}(x))\bigg)(x)\bigg] dx &amp; (\text{chain rule})\\ 
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - \int \hat{x}(x) dx &amp; \bigg(\frac{d\hat y}{d\hat x}(\hat{x}(x)) = x\bigg) \\ 
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - \int \frac{dy}{dx}(x) dx &amp; (\text{by def of } \hat{x})\\ 
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - y(x) + C \\
    &amp;= \hat{x} \frac{d\hat y}{d\hat x}(\hat{x}) - y\bigg(\frac{d\hat{y}}{d\hat x}(\hat{x})\bigg) + C.  &amp; (\text{by def of } \hat{x})
\end{align*}\]

</p><p>Let’s try to compute a simple example, the integral of \(\ln x\). Consider</p>

<p><img src="https://tobylam.xyz/generated/assets/images/legend4-600-36dc952bd.png" srcset="/generated/assets/images/legend4-480-36dc952bd.webp 480w, /generated/assets/images/legend4-600-36dc952bd.webp 600w, /generated/assets/images/legend4-720-36dc952bd.webp 720w, /generated/assets/images/legend4-900-36dc952bd.webp 900w, /generated/assets/images/legend4-1080-36dc952bd.webp 1080w, /generated/assets/images/legend4-1260-36dc952bd.webp 1260w, /generated/assets/images/legend4-1440-36dc952bd.webp 1440w, /generated/assets/images/legend4-1736-36dc952bd.webp 1736w" sizes="(max-width: 600px) 100vw, (max-width: 1000px) 600px, (max-width: 1400px) 600px, (min-width: 1401px) 600px" width="1736" height="718"/></p>

<p>Repeating what we’ve done above, we have</p><p>

\[\begin{align*}
    \hat{y} &amp;= \int \ln \hat{x} \, d\hat{x} \\
    &amp;= \hat{x} \times \ln(\hat{x})  - \int \hat{x} \times \frac{d}{d\hat x}(\ln \hat{x}) d\hat{x}\\
    &amp;= \hat{x} \times \ln(\hat{x}) - \int e^x \times \frac{d}{d\hat x}(\ln \hat x) \times \frac{d}{dx} (\hat x) dx \\
    &amp;= \hat{x} \times \ln(\hat{x}) - \int e^x \times \frac{d}{dx} \big(\ln(e^x)\big) dx \\
    &amp;= \hat{x} \times \ln(\hat{x}) - \int e^x dx \\
    &amp;= \hat{x} \times \ln(\hat{x}) - e^x + C \\
    &amp;= \hat{x} \times \ln(\hat{x}) - e^{\ln (\hat{x})} + C \\
    &amp;= \hat{x} \times \ln(\hat{x}) - \hat{x} + C. 
\end{align*}\]

</p><p>Finally, just by using the formula \(\hat{y} = \hat{x} \times\frac{d\hat y}{d\hat x}(\hat{x}) - y(\hat{y}&#39;(\hat{x})) + C\), if we let \(y = - \ln \vert \cos(x) \vert\), then we have \(y&#39; = \tan(x)\) and \(\hat{y}&#39; = \arctan(x)\) so</p><p>

\[\begin{align*}
    \int \arctan \hat{x} &amp;= \hat{x} \arctan \hat{x} - \ln \vert \cos(\arctan(\hat{x}))\vert + C\\
    &amp;=  \hat{x} \arctan \hat{x} - \frac{1}{2} \ln \big( \frac{1}{1+\hat{x}^2}\big) + C
\end{align*}\]

</p><p>as expected.</p>

<p>The map \(y(x) \to \hat{y}(\hat{x}) := \hat{x}\frac{d\hat y}{d\hat x}(\hat{x}) - y(\frac{d\hat y}{d\hat x}(\hat{x}))\) is called the Legendre transformation, which has wide applications in areas of physics. But mathematically, one could think of it as an analogue to the inverse function theorem: It tells you how the inverse map acts on integrals.</p>

<h2 id="summary">Summary</h2>

<p><img alt="https://q.uiver.app/#q=WzAsNixbMCwxLCJmKHgpIl0sWzAsMiwiZicoeCkiXSxbMCwwLCJGKHgpIl0sWzMsMSwiZyh5KTo9Zl57LTF9KHkpIl0sWzMsMCwiRyh5KSJdLFszLDIsImcnKHkpIl0sWzAsMSwiXFxmcmFje2R9e2R4fSJdLFsyLDAsIlxcZnJhY3tkfXtkeH0iXSxbMCwzXSxbNCwzLCJcXGZyYWN7ZH17ZHl9Il0sWzMsNSwiXFxmcmFje2R9e2R5fSJdLFsxLDUsIlxcdGV4dHtJbnZlcnNlIEZ1bmMuIFRobS59Il0sWzIsNCwiXFx0ZXh0e0xlZ2VuZHJlIFRyYW5zZm9ybX0iXV0=" src="https://tobylam.xyz/generated/assets/images/2023-11-29-summary-600-47e06eab1.png" srcset="/generated/assets/images/2023-11-29-summary-480-47e06eab1.webp 480w, /generated/assets/images/2023-11-29-summary-600-47e06eab1.webp 600w, /generated/assets/images/2023-11-29-summary-720-47e06eab1.webp 720w, /generated/assets/images/2023-11-29-summary-900-47e06eab1.webp 900w, /generated/assets/images/2023-11-29-summary-1080-47e06eab1.webp 1080w, /generated/assets/images/2023-11-29-summary-1260-47e06eab1.webp 1260w, /generated/assets/images/2023-11-29-summary-1440-47e06eab1.webp 1440w, /generated/assets/images/2023-11-29-summary-1800-47e06eab1.webp 1800w, /generated/assets/images/2023-11-29-summary-1992-47e06eab1.webp 1992w" sizes="(max-width: 600px) 100vw, (max-width: 1000px) 600px, (max-width: 1400px) 600px, (min-width: 1401px) 600px" width="1992" height="824"/></p>

<p>with the following relations</p><p>

\[\begin{align*}
    \text{IFT:} \quad &amp; g&#39;(y) = \frac{1}{f&#39;(g(y))} \\
    \text{Legendre:} \quad &amp; G(y) = y\times g(y) - F(g(y)) + C
\end{align*}\]

</p><p>For more ways to understand the ideas covered in this post you can look at the <a href="https://tobylam.xyz/assets/documents/2023-11-27-inverse-functions-legendre.pdf">article</a> I’ve written for the Oxford Invariants journal, as well as the <a href="https://en.wikipedia.org/wiki/Integral_of_inverse_functions">wiki page</a> on the integral of inverse functions.</p>

<!-- 
$$\begin{align*}
    &\int g(y) dy \\
    &= y \times g(y) - \int y dg(y) \\
    &= y \times g(y) - \int y g'(y) dy \\
    &= y \times g(y) - \int f(x) g'(f(x)) f'(x) dx & (\text{Let }y = f(x))\\
    &= y \times g(y) - \int f(x) (g \circ f)'(x) dx \\
    &= y \times g(y) - \int f(x) dx & (g \circ f = \text{id}) \\
    &= y \times g(y) - F(x) + C \\
    &= y \times g(y) - F(g(y)) + C
\end{align*}$$
-->

    
    

    <!-- Only change in this layout is here. Next posts and previous posts. Refer to _plugins/WithinCategoryPostNavigation.rb-->
    <!-- I have no idea why the next and previous posts are swapped. Oh well. The link to all this is here https://ajclarkson.co.uk/blog/jekyll-category-post-navigation/ -->

    <!-- <a href="/2023/12/11/visualization-fundamental-theorem-calculus" class="previous-link">Next post</a> 
    
     <a href="/2023/11/04/graph-sketching-techniques" class="next-link">Previous post</a> 

    <p>All posts in <a href="/archive/categories#Maths"> "maths" </a></p> -->

  </div>
</article>
      </div>
    </div></div>
  </body>
</html>
