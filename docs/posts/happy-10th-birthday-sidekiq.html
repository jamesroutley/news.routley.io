<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.mikeperham.com/2022/01/17/happy-10th-birthday-sidekiq/">Original</a>
    <h1>Happy 10th Birthday, Sidekiq</h1>
    
    <div id="readability-page-1" class="page"><div>
    <article>
      
<p>
  <small>
  
  
  2022-01-17
  </small>
  
</p>
<p>It’s hard for me to believe these words but I pushed Sidekiq’s <a href="https://github.com/mperham/sidekiq/commit/26d9a92a6b355f131720b983888e8858e40aaa6e">first commit</a> on Jan 16th, 2012. Ten years ago. <a href="https://www.mikeperham.com/2012/02/07/sidekiq-simple-efficient-messaging-for-rails/">The public announcement</a>. <a href="https://www.mikeperham.com/2012/03/02/the-state-of-sidekiq-one-month-later/">One month later</a>. <a href="https://www.mikeperham.com/2012/05/01/one-quarter-of-sidekiq/">One quarter later</a>.</p>
<p>Some context for those new to this blog: Sidekiq is the most popular background job system for the Ruby programming language.
Every application has tasks which are important: send an email, charge a credit card, reserve inventory for an order, synchronize some data to a 3rd party service, etc.
By making these background jobs, you automatically get error handling and retry, easy scaling across multiple machines, a monitoring UI and lots more.</p>
<div>
  
  <p>Nate Berkopec&#39;s incredible <a href="https://nateberk.gumroad.com/l/sidekiqinpractice"><b>Sidekiq in Practice</b></a> workshop is 10 times cheaper in honor of Sidekiq&#39;s 10th Anniversary. You can buy it for $5 with the discount code <tt>SIDEKIQ10</tt>.
  </p><p>The discount is good for <b>this week only</b> and ends on 2022-01-24.</p>
</div>
<h2 id="prehistory">Prehistory</h2>
<p>Sidekiq did not spring fully formed from the ether.
The first background job system in Ruby which I’m aware of was <strong><a href="https://www.infoq.com/articles/BackgrounDRb/">BackgrounDRb</a></strong> in 2006 from the late, great <a href="https://youtu.be/xG1S9ZPCy2Q">Ezra Zygmuntowicz</a>.
Ruby on Rails was just taking off in popularity but there was little to no infrastructure to process tasks outside of the HTTP request/response cycle.
The name is a play on DRB, the Distributed Ruby module which ships in Ruby’s standard library, and allows RPC-style calls across machines.
Note the use of the term <strong>Worker</strong> in <a href="http://blog.gnufied.org">the docs</a>; modern Ruby uses the term <strong>Job</strong> now.</p>
<p>BackgrounDRb’s main issue is that it is not persistent: if the process is shutdown, all executing jobs are lost.
Tobi Lutke, CEO of Shopify, <a href="https://github.com/tobi/delayed_job/commit/75b49dc1c281ffa934a4eb2c7e840291e8b4a5ff">published <strong>Delayed::Job</strong> in Feb 2008</a>.
DJ persisted job data to the database, allowing for safe, frequent deployments which restarted any DJ processes.
DJ’s main issue is that it targeted MySQL, which was not designed for the access patterns inherent in a queue; it added massive load to the database which limited its scalability pretty severely.</p>
<p>Chris Wanstrath, Founder of GitHub, <a href="https://github.com/resque/resque/commit/b1e00511b8ee9d9b2bcec41d7ccf306757049e66">published <strong>Resque</strong> in Aug 2009</a>.
Resque moved away from the database and stored job data inside a popular new datastore named <strong>Redis</strong>.
(Side note: Ezra Zygmuntowicz was the main driver of Redis adoption within the Ruby community and wrote the first Redis client.)
Redis was marketed as a “data structure server” and had native, high performance support for queueing operations, making it far more scalable than DJ.
Resque’s main issue is that jobs are not thread-safe and so job execution is single-threaded only, making it RAM hungry.</p>
<p>Shopify is currently worth $140+ billion.
GitHub was bought by Microsoft for $7.5 billion.
Tobi and Chris are both now billionaires.</p>
<h2 id="history">History</h2>
<p>This was the state of background jobs circa 2010.
I had implemented a background job system in every Ruby company I had worked at because each OSS solution had severe limitations.
I built <a href="https://github.com/mperham/qanat">Qanat in 2010</a>, an <a href="https://www.mikeperham.com/2010/01/27/scalable-ruby-processing-with-eventmachine/">event-based job runner</a> which used green threads to process multiple jobs concurrently but it suffered from the same malady as Node apps: blocking the event loop.
I built <a href="https://github.com/mperham/girl_friday/wiki">girl_friday in 2011</a> which prototyped using the Actor pattern for <a href="https://www.mikeperham.com/2011/05/19/threads-fibers-events-and-actors/">thread-safe job execution</a> but still had a few design issues I was not happy about.
The stage was set for Sidekiq.</p>
<p>Redis really impressed me as a pragmatic datastore.
It was the first non-trivial C project I’d seen that did not run <code>configure</code>;
you just downloaded the code and ran <code>make</code>.
It did not pretend to support every *nix since 1983.
64-bit native.
The code was clean and readable.
I believed I could rely on it as a datastore and that has proven to be true.
I never seriously considered supporting multiple datastores; that’s a quagmire with little value.
Omakase.</p>
<p>Sidekiq was the first major Ruby job system to run multi-threaded only.
I knew someone had to entice the community to address thread-safety and my main worry was that the community would reject Sidekiq due to thread-safety fears.
I guess the promise of a huge leap forward in performance won the day;
within a year or so most thread safety problems in popular gems had been discovered and fixed.
I still get occasional emails from customers running Sidekiq with concurrency: 1 because they don’t trust their own app code to be thread-safe.
Alas.</p>
<p>After a few months I did something unusual: I declared that Sidekiq was unsustainable and that to solve that problem I wanted to run some <a href="https://www.mikeperham.com/2012/08/26/the-sidekiq-experiment-part-i/">“financial experiments”</a> to ensure long-term support and maintenance.
In October 2012, <a href="https://www.mikeperham.com/2012/10/01/say-hello-to-sidekiq-pro/">I started selling Sidekiq Pro</a>.
Even today I regularly see talk about the unsustainability of open source software, burnout and “retiring from OSS”.
What’s old is new again.</p>
<p>My solution to sustainability was to make Sidekiq profitable.
A project the size of Sidekiq requires many years of maintenance while supporting many thousands of users.
That work can be a brutal cross to bear for free but it’s a perfectly sensible job.
I settled on the open core business model: Sidekiq is open source but Sidekiq Pro and Sidekiq Enterprise are closed source, commercial add-ons.
I still work in the open where possible;
issues, pull requests, wiki documentation are all on GitHub in the open.</p>
<h2 id="some-numbers">Some Numbers</h2>
<p>What has happened in the past 10 years?</p>
<ul>
<li>11,500 stars</li>
<li>4100 commits (from me <strong>and</strong> the community!)</li>
<li>5100 issues</li>
<li>115 million downloads</li>
<li>170 OSS gem versions</li>
</ul>
<p>But none of that matters if a maintainer’s health or well-being is suffering. Here’s some business numbers for <a href="https://contribsys.com">Contributed Systems</a>:</p>
<ul>
<li>1 employee (me!)</li>
<li>1850 customers</li>
<li>3.0m HTTP requests to the commercial gem server per day</li>
<li>$13.5 million in total gross sales</li>
</ul>
<p>Ten years later and I’m still here: sustainability ✅ and I did it my way.</p>
<p>But I do wonder: could I have sold out, taken VC, and grown Sidekiq into a billion dollar unicorn?
Maybe… but that wasn’t my objective.
Since the beginning I’ve focused on building Sidekiq with steady, methodical improvement every day.</p>
<p>Four years ago, I started a new project, <a href="https://github.com/contribsys/faktory/wiki">Faktory</a>, to bring Sidekiq’s functionality to any programming language, not just Ruby.
Like Sidekiq, it has a commercial version which ensures long-term maintenance.
Unlike Sidekiq, it is designed to work with any programming language: Go, JavaScript, Python, et al.
The bulk of my workday consists of supporting my Sidekiq and Faktory users.</p>
<p>It’s been incredibly gratifying to see many other software projects following Sidekiq’s lead.
Some copy the pricing, the wiki documentation style, the commercial license or even the <a href="https://sidekiq.org">sidekiq.org</a> home page!
Once a person blazes a trail, many people can follow the well-worn path.</p>
<h2 id="the-future">The Future</h2>
<p>Short term: Ruby 3.1 and Rails 7.0 will require some minor but breaking changes, coming in Sidekiq
7.0. Maintenance never ends.</p>
<p>Long term: it’s really hard for me to type this but I likely won’t see 2030 as project owner and maintainer.
While I have a few wonderful collaborators, being Sidekiq’s <a href="https://en.wikipedia.org/wiki/Benevolent_dictator_for_life">BDFL</a> means I am a single point of failure.
I’m approaching 50 years old and want to enjoy my success at some point.
What should I do?
One idea is to turn Sidekiq over to <a href="https://rubycentral.org">Ruby Central</a>.
Nothing would making me prouder than seeing Sidekiq sustaining our Ruby community infrastructure.</p>
<p>What a legacy that would be!</p>
<p>Thoughts? Tweet <a href="https://twitter.com/getajobmike">@getajobmike</a>.</p>
<div>
  
  <p>Nate Berkopec&#39;s incredible <a href="https://nateberk.gumroad.com/l/sidekiqinpractice"><b>Sidekiq in Practice</b></a> workshop is 10 times cheaper in honor of Sidekiq&#39;s 10th Anniversary. You can buy it for $5 with the discount code <tt>SIDEKIQ10</tt>.
  </p><p>The discount is good for <b>this week only</b> and ends on 2022-01-24.</p>
</div>

    </article>
  </div></div>
  </body>
</html>
