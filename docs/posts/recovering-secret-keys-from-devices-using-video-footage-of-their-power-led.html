<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.nassiben.com/video-based-crypta">Original</a>
    <h1>Recovering secret keys from devices using video footage of their power LED</h1>
    
    <div id="readability-page-1" class="page"><div id="comp-lgxz3pzd" data-testid="richTextElement"><p><span><span>           Ben Nassi,  Etay Iluz,  Ofek Vayner,  Or Cohen,  </span></span><span><span>Dudi Nassi,  Boris Zadov,  Yuval Elovici   </span><span>  </span></span></p>

<p><span><span>     Cornell Tech         Ben-Gurion University of the Negev</span></span></p></div><div id="comp-lgxz3pzf4" data-testid="richTextElement"><p><span><span><span><span><span><span><span>​</span></span></span></span></span></span></span></p>

<p><span>TLDR</span></p>

<p><span>We were able to recover secret ke</span><span>ys from non-compromised devices using video footage of their power LED obtained by commercial video cam</span><span>eras.</span></p>

<p><span><span>​</span></span></p>

<p><span><span><span>Abstr</span></span><span><span>act</span></span></span></p>

<p><span><span>In this paper, we present video-based cryptanalysis, a new method used to recover secret keys from a device by analyzing video footage of a device’s power LED. We show that cryptographic computations performed by the CPU change the power consumption of the device which affects the brightness of the device’s power LED. Based on this observation, we show how attackers can exploit commercial video cameras (e.g., an iPhone 13’s camera or Internet-connected security camera) to recover secret keys from devices. This is done by obtaining video footage of a device’s power LED (in which the frame is filled with the power LED) and exploiting the video camera’s rolling shutter to increase the sampling rate by three orders of magnitude from the FPS rate (60 measurements per second) to the rolling shutter speed (60K measurements per second in the iPhone 13 Pro Max). The frames of the video footage of the device’s power LED are analyzed in the RGB space, and the associated RGB values are used to recover the secret key by inducing the power consumption of the device from the RGB values. We demonstrate the application of video-based cryptanalysis by performing two side-channel cryptanalytic timing attacks and recover: (1) a 256- bit ECDSA key from a smart card by analyzing video footage of the power LED of a smart card reader via a hijacked Internet-connected security camera located 16 meters away from the smart card reader, and (2) a 378-bit SIKE key from a Samsung Galaxy S8 by analyzing video footage of the power LED of Logitech Z120 USB speakers that were connected to the same USB hub (that was used to charge the Galaxy S8) via an iPhone 13 Pro Max. Finally, we discuss countermeasures, limitations, and the future of video-based cryptanalysis in light of the expected improvements in video cameras’ specifications.</span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>​</span></span></p></div><div id="comp-lgxz3pzg1" data-testid="richTextElement"><p><span><span><span><span><span><span>​</span></span></span></span></span></span></p>

<p><span><span><span>Recovering ECDSA Key from Smartcard using Video Footage </span></span><span><span>of the Sma</span></span><span><span>rtca</span></span><span><span>rd Reader&#39;s Power LED </span></span><span><span>obtained </span><span>using an Internet-connected video camera</span></span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span><span><span><span><span><span>Using an Interne</span><span>t</span><span>-connected video camera</span></span></span></span></span></span></span></p>

<p><span><span>​</span></span></p>

</div><div id="comp-lirmipvo" data-testid="richTextElement"><p><span><span><span><span>A few seconds of the video we used</span></span></span></span></p>

<p><span><span><span><span>to recover the key</span></span></span></span></p></div><div id="comp-lgxz3pzp6" data-testid="richTextElement"><p><span><span><span><span><span><span>​</span></span></span></span></span></span></p>

<p><span><span><span>Recovering SIKE</span></span><span><span> Key</span></span><span><span> from Samsung Galaxy S8 using Video Footage of the Logitech Z120 USB Speakers&#39; Power LED obtained using iPhon</span></span><span><span>e 13 Pro Ma</span></span><span><span>x</span></span></span></p>

<p><span><span><span>​</span></span></span></p></div><div id="comp-lgxz3q001" data-testid="richTextElement"><p><span><span><span><span><span>​</span></span></span></span></span></p>

<p><span><span><span>FAQ</span></span></span></p>

<p><span>​</span></p>

<p>Q: Why power LEDs can be exploited for the purpose of cryptanalysis?</p>

<p>A: The intensity/color of the power LEDs can be used to detect the beginning and end of cryptographic operations. This can be done because the intensity/brightness of a device&#39;s power LED (in many electrical circuits) correlates with its power consumption (which is affected by the CPU operations).</p>

<p>This is caused by the fact that the power LED is connected directly to the power line of the electrical circuit which lacks effective means (e.g., filters, voltage stabilizers) of decoupling the correlation with the power consumption. </p>

<p><span>​</span></p>

<p><span><span>Q: What is the difference</span></span><span><span> between video-based cryptanalysis and prior methods to conduct cryptanalysis?</span></span></p>

<p><span><span>A: We show that the combination of vulnerable cryptographic algorithms (i.e., that are vulnerable to cryptanalytic side-channel attacks) and vulnerable power LEDs (i.e., that their color/brightness leak information) can be exploited by attackers to recover secret keys in a weaker threat model with respect to SOTA methods used to conduct cryptanalysis.</span></span></p>

<p><span>​</span></p>

<p><span><span>Q: Why do you consider the threat model weaker/easier with respect to SOTA methods used to conduct cryptanalysis?</span></span></p>

<p><span><span>A: Video-based cryptanalysis allows attackers to recover secret keys using commonly used sensors (video cameras) instead of a dedicated professional sensor (e.g., scope, EMR) without compromising the target device with malware.</span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>Q: Is the origin of the vulnerability in the power LED? </span></span></p>

<p><span><span>A: No. The origin of the vulnerabilities is in the cryptographic libraries. </span></span></p>

<p><span><span>However, power LEDs provide the infrastructure needed to exploit the vulnerability visually.</span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>Q: What is the best way to prevent the two demonstrated attacks</span><span>?</span></span></p>

<p><span><span>A: Use the most updated cryptographic libraries available. </span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>Q: Why did you choose to demonstrate the HertzBleed and Minerva attacks</span><span>?</span></span></p>

<p><span><span>A: These two attacks were recen</span></span><span><span>tly discovered (HetzBleed - 22, Minerva - 20).</span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>Q: Assuming I use the most updated cryptographic libraries, am I still at risk?</span></span></p>

<p><span><span>A: We cannot say for sure because maybe some 0-day vulnerabilities exist in the code of the most updated cryptographic libraries. Remember that somewhere in the past, the known vulnerable cryptographic libraries were considered the most updated libraries. </span></span></p>

<p><span><span><span>​</span></span></span></p>

<p><span><span>Q: Which devices are vulnerable to video-based</span><span> cryptanalysis?</span></span></p>

<p><span><span>A: At least six s</span></span><span><span>martcard readers manufactured by five manufacturers sold on Amazon are vulnerable to a direct attack. </span></span><span><span>Samsung Galaxy S8 is vulnerable to an indirect attack.</span></span></p>

<p><span>​</span></p>

<p><span><span>Q: Are there additional devices vulnerable to video-based cryptanalysis?</span></span></p>

<p><span><span>A: Most likely.   </span></span><span><span>  </span></span></p>

<p><span><span>​</span></span></p>

<p><span><span>Q: Why do attackers need to obtain video footage filled with the LED of the target device? </span></span></p>

<p><span><span>A: Cryptanalysis requires a high sampling</span></span><span><span> rate.</span></span><span><span> A sampling rate of 60k can provide the needed sampling rate to attack functional IoT devices (smartphones, smartcards, TV streamers, etc.).</span></span></p>

<p><span><span>​</span></span></p>

<p><span><span>Q: Assuming a device with no power LED, do you still consider it at risk?</span></span></p>

<p><span><span>A: The fact that the device does not contain an integrated power LED prevents attackers to recover secret keys directly from its power LED. However, attackers might be able to recover the secret key from the device using video footage obtained from a power LED of a connected </span></span>peripheral (an indirect attack).</p>

<p><span><span>​</span></span></p>

<p><span>Q: How did you come up with the i</span><span>dea to conduct cryptanalysis using power LEDs?</span></p>

<p><span>A: We played a lot with light in the context of confidentiality in recent years (see <span><span><a href="https://www.nassiben.com/lamphone" target="_self">Lamphone</a>, </span></span><span>and </span><a href="https://www.nassiben.com/little-seal-bug" target="_blank"><span><span>The Little Seal Bug</span></span></a>). We tested the bandwidth of power LEDs in <span><a href="https://www.nassiben.com/glowworm-attack" target="_blank"><span>prior research</span> </a></span>where we were able to recover audible speech from the light emitted from the power LEDs of various devices.</span></p></div></div>
  </body>
</html>
