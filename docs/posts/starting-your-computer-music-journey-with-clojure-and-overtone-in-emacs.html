<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://savo.rocks/posts/starting-your-computer-music-journey-with-clojure-and-overtone-in-emacs/">Original</a>
    <h1>Starting Your Computer Music Journey with Clojure and Overtone in Emacs</h1>
    
    <div id="readability-page-1" class="page"><div><p>In this post I want to write about probably the most powerful text editor there is: <a href="https://opensource.com/resources/what-emacs" target="_blank">Emacs</a> and how to set it up so you can begin programming and live coding with Overtone in no time. Many users would disagree and argue that <a href="https://en.wikipedia.org/wiki/Vi" target="_blank">vi</a>/<a href="https://en.wikipedia.org/wiki/Vim_(text_editor)" target="_blank">Vim</a> is the king of editors, and I’m not going to get into that bickering, which has lasted for several decades, as can be seen on <a href="https://en.wikipedia.org/wiki/Editor_war" target="_blank">this wiki page</a>. Even Google joined in on this joke, as can be seen in the following screenshot: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/emacs-vs-vi.png" alt="Google Emacs/vi search"/> </p><h2 id="why-should-you-consider-emacs">Why should you consider Emacs?</h2><p>It is one of the oldest editors still in use. It is very stable, powerful, extensible, and has great learning resources. On top of that, there is a mature development environment built for Clojure called <a href="https://github.com/clojure-emacs/cider#readme" target="_blank">CIDER</a> that most Clojurians use. In fact, for every programming language there is a <a href="https://tldp.org/HOWTO/Emacs-Beginner-HOWTO-3.html" target="_blank">mode</a> which enhances your experience while working in Emacs. Modes also exist for other software programmers typically use, such as <a href="https://github.com/magit/magit#readme" target="_blank">Magit</a> for git or <a href="https://wikemacs.org/wiki/Ansi-term" target="_blank">Ansi-term</a> if you want to run a terminal process inside Emacs. </p><h2 id="install-emacs">Install Emacs</h2><h3 id="linux">Linux</h3><p>There are many ways to install Emacs on Linux, but the easiest is probably through your distribution package manager. Since I’m using Arch Linux with default package manager Pacman, I can just type in my terminal <code>sudo pacman -S emacs</code> and voilà, it is on my system and ready to run. If you are on Ubuntu, the command for you would be <code>sudo apt install emacs</code>. Best way to find out is to search the web for installation instructions on your particular distribution. But most of them probably have very similar and easy process as Arch or Ubuntu.</p><h3 id="mac-osx">Mac OSX</h3><p>I seldom use Apple computers and their OSX, but I came across <a href="https://wikemacs.org/wiki/Installing_Emacs_on_OS_X" target="_blank">this page</a> which shows us several ways how to install Emacs. I know that <a href="https://brew.sh/" target="_blank">Homebrew</a> is pretty popular, so you can use it for installation. I noticed that you should first uninstall outdated version of Emacs that comes with the system and then you can install current version. Execute the following lines in your terminal:</p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
</pre></td><td><pre><span>sudo rm</span> /usr/bin/emacs
<span>sudo rm</span> <span>-rf</span> /usr/share/emacs
brew tap railwaycat/emacsmacport
brew <span>install </span>emacs-mac
</pre></td></tr></tbody></table></code></p></div><p>and that should do it. If you want to do it another way visit the first link I gave in the Mac OSX section.</p><h3 id="windows">Windows</h3><p>This operating system doesn’t have an integrated package manager, so it’s best to go to <a href="https://ftp.gnu.org/gnu/emacs/windows/" target="_blank">GNU Emacs for Windows repository</a>, open the latest directory (at the time of writing of this article that is <a href="https://ftp.gnu.org/gnu/emacs/windows/emacs-28/" target="_blank">emacs-28</a> and download the <em>emacs-xx.x-installer.exe</em> (xx.x representing the version number here). Run the downloaded executable and install the program. The same process can be repeated for updates in the future. </p><h2 id="configure-emacs">Configure Emacs</h2><p>Plain Emacs installation looks like this: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/emacs-vanilla.png" alt="Plain Emacs Installation"/> </p><h3 id="prelude">Prelude</h3><p>Since Emacs has been actively developed for several decades, many people configured it to suit their particular needs. But most of us are lazy and want to change as little as we need to have the best experience possible. Fortunately, there is a project called <a href="https://github.com/bbatsov/prelude#readme" target="_blank">Prelude</a> that enhances Emacs experience and makes it so that you get fully functioning development environment for many programming languages. It also contains <a href="https://github.com/clojure-emacs/cider#readme" target="_blank">CIDER</a> which means we don’t have to install it separately. You can go to <a href="https://github.com/bbatsov/prelude#readme" target="_blank">Prelude’s GitHub Page</a> to find out more about the changes it brings to the default Emacs installation. </p><h3 id="tweaking-prelude">Tweaking Prelude</h3><p>If you open up Emacs now you’ll see bunch of changes happening really fast. This is because Emacs applies new settings which we got with Prelude. After that fairly short process you’ll get the message similar to “Prelude is ready to do thy bidding, Master <em>username</em>!”. Now, we need to do some minor tweaking to enable various prelude modules which will enhance our Experience. </p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td><pre><span>;;; Uncomment the modules you&#39;d like to use and restart Prelude afterwards</span>

<span>;;; General productivity tools</span>

<span>(</span><span>require</span> <span>&#39;prelude-ido</span><span>)</span> <span>;; Supercharges Emacs completion for C-x C-f and more</span>
<span>;; (require &#39;prelude-ivy) ;; A mighty modern alternative to ido</span>
<span>;; (require &#39;prelude-selectrum) ;; A powerful, yet simple, alternative to ivy</span>
<span>(</span><span>require</span> <span>&#39;prelude-helm</span><span>)</span> <span>;; Interface for narrowing and search</span>
<span>;; (require &#39;prelude-helm-everywhere) ;; Enable Helm everywhere</span>
<span>(</span><span>require</span> <span>&#39;prelude-company</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-key-chord</span><span>)</span> <span>;; Binds useful features to key combinations</span>

<span>;;; Vim emulation</span>
<span>;;</span>
<span>;; Enable this module if you&#39;re fond of vim&#39;s keybindings.</span>
<span>;; (require &#39;prelude-evil)</span>

<span>;;; Org-mode (a legendary productivity tool that deserves its own category)</span>
<span>;;</span>
<span>;; Org-mode helps you keep TODO lists, notes and more.</span>
<span>(</span><span>require</span> <span>&#39;prelude-org</span><span>)</span>

<span>;;; Programming languages support</span>
<span>;;</span>
<span>;; Modules for a few very common programming languages</span>
<span>;; are enabled by default.</span>

<span>(</span><span>require</span> <span>&#39;prelude-c</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-clojure</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-coffee</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-common-lisp</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-css</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-dart</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-emacs-lisp</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-erlang</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-elixir</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-fsharp</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-go</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-haskell</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-js</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-latex</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-lisp</span><span>)</span> <span>;; Common setup for Lisp-like languages</span>
<span>(</span><span>require</span> <span>&#39;prelude-lsp</span><span>)</span> <span>;; Base setup for the Language Server Protocol</span>
<span>(</span><span>require</span> <span>&#39;prelude-lua</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-ocaml</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-perl</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-python</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-racket</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-ruby</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-rust</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-scala</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-scheme</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-shell</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-scss</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-ts</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-web</span><span>)</span> <span>;; Emacs mode for web templates</span>
<span>(</span><span>require</span> <span>&#39;prelude-xml</span><span>)</span>
<span>(</span><span>require</span> <span>&#39;prelude-yaml</span><span>)</span>

<span>;;; Misc</span>
<span>(</span><span>require</span> <span>&#39;prelude-erc</span><span>)</span> <span>;; A popular Emacs IRC client (useful if you&#39;re still into Freenode)</span>

<span>(</span><span>provide</span> <span>&#39;prelude-modules</span><span>)</span>
<span>;;; prelude-modules.el ends here</span>
</pre></td></tr></tbody></table></code></p></div><p>If you compare it to your starting file you’ll see that, apart that I enabled all programming modules, I didn’t change much from the defaults. The biggest one is that I use <a href="https://www.emacswiki.org/emacs/InteractivelyDoThings" target="_blank">ido</a> completion tool instead of <a href="https://github.com/abo-abo/swiper" target="_blank">ivy</a> or <a href="" target="_blank">selectrum</a>. Although ivy and selectrum appear to be more powerful than ido, I just like the simplicity of it as it does what it has to do and doesn’t get in the way, so I just never switched when it stopped being the default. </p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
5
6
</pre></td><td><pre><span>(</span><span>disable-theme</span> <span>&#39;zenburn</span><span>)</span>
<span>(</span><span>setq</span> <span>custom-safe-themes</span> <span>t</span><span>)</span>
<span>(</span><span>setq</span> <span>prelude-theme</span> <span>&#39;cyberpunk</span><span>)</span>
<span>(</span><span>setq</span> <span>prelude-minimalistic-ui</span> <span>t</span><span>)</span>
<span>(</span><span>menu-bar-mode</span> <span>-1</span><span>)</span>
<span>(</span><span>scroll-bar-mode</span> <span>-1</span><span>)</span>
</pre></td></tr></tbody></table></code></p></div><p>The first three lines make sure that Emacs does not use the default <a href="https://github.com/bbatsov/zenburn-emacs" target="_blank">Zenburn</a> theme and loads the <a href="https://github.com/n3mo/cyberpunk-theme.el" target="_blank">Cyberpunk</a> theme which I find more vibrant and easier to work with. It just comes down to personal preference. I suggest you try it, as it is one of the best themes around. Note that you need to install the cyberpunk theme first in Emacs. You do that by going to Emacs, then pressing M-x (this means to press <em>Alt</em> button and <em>x</em> button at the same time, but i’ll explain that later), type <code>package-install</code>, press <em>Enter</em>, then type <code>cyberpunk-theme</code> and press <em>Enter</em>. You have now installed cyberpunk theme and it will be loaded if you use first 3 lines from the code above. Next line, <code>(setq prelude-minimalistic-ui t)</code> disables line number on the left side of Emacs window. I have that disabled because in the bottom part of Emacs there is information on which line and character are you exactly, so I found I have no use for it. The <code>menu-bar-mode</code> and <code>scroll-bar-mode</code> are both set to <em>-1</em> value, because I don’t want to have neither menu-bar (context menus) or scroll bar, since everything can be done with Emacs keybindings. I have consciously made the decision to make myself learn to use Emacs properly, because I saw the potential of powerful keyboard-oriented editor. And you know what? I haven’t regretted it once! </p><h2 id="emacs-basics">Emacs Basics</h2><p>This article is concentrated on setting up Emacs to be used with Clojure and Overtone for live coding. Properly describing various keybindings and concepts would require much longer article. In fact, many books were written on the subject, including O’reilly’s <a href="https://www.oreilly.com/library/view/learning-gnu-emacs/0596006489/ch01.html" target="_blank">Learning GNU Emacs</a> which is what I first read when I was getting to know the editor. Now, go to the link supplied and skip to the section named <em>Emacs Commands</em>. There you will find excellent explanation of many useful Emacs keybindings. Or you can read that chapter from the beginning if you want to understand more about Emacs.</p><h2 id="use-emacs-for-clojure-programming-and-overtone-live-coding">Use Emacs for Clojure Programming and Overtone Live Coding</h2><p>Now, we have everything set up and we can start using Emacs to do some great stuff. Open Emacs and press <code>C-x C-f</code> (hold Ctrl all the time, press x, release x, press f, release f, release Ctrl). Now, navigate to <code>my-overtone-project/src/my-overtone-project/</code> and open the file <em>core.clj</em>. If you don’t have Clojure project with Overtone as dependency, learn how to create it from <a href="https://omarish.com/posts/overtone-basic-setup/" target="_blank">Overtone: Basic Setup</a> article that I wrote previously. </p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
5
</pre></td><td><pre><span>my-overtone-project.core&gt;</span><span> </span><span>(</span><span>+</span><span> </span><span>3</span><span> </span><span>8</span><span>)</span><span>
</span><span>11</span><span>
</span><span>my-overtone-project.core&gt;</span><span> </span><span>(</span><span>map</span><span> </span><span>inc</span><span> </span><span>[</span><span>3</span><span> </span><span>4</span><span> </span><span>5</span><span> </span><span>6</span><span> </span><span>7</span><span> </span><span>8</span><span>])</span><span>
</span><span>(</span><span>4</span><span> </span><span>5</span><span> </span><span>6</span><span> </span><span>7</span><span> </span><span>8</span><span> </span><span>9</span><span>)</span><span>
</span><span>my-overtone-project.core&gt;</span><span>
</span></pre></td></tr></tbody></table></code></p></div><p>Now that we are sure our REPL is working let’s go to the buffer where our <em>core.clj</em> file is opened. Press <code>C-x o</code> again and the buffer we’re working in will switch. Populate the <em>core.clj</em> as follows:</p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td><pre><span>(</span><span>ns</span><span> </span><span>my-overtone-project.core</span><span>)</span><span>

</span><span>(</span><span>use</span><span> </span><span>&#39;overtone.live</span><span>)</span><span>
</span><span>(</span><span>use</span><span> </span><span>&#39;overtone.inst.synth</span><span>)</span><span>

</span><span>(</span><span>defn</span><span> </span><span>play</span><span> </span><span>[</span><span>x</span><span>]</span><span>
  </span><span>&#34;Can play either single tone: (play 60), (play :C4) or Whole chords&#34;</span><span>
  </span><span>(</span><span>if</span><span> </span><span>(</span><span>seqable?</span><span> </span><span>x</span><span>)</span><span>
    </span><span>(</span><span>doseq</span><span> </span><span>[</span><span>note</span><span> </span><span>x</span><span>]</span><span> </span><span>(</span><span>overpad</span><span> </span><span>note</span><span>))</span><span>
    </span><span>(</span><span>if</span><span> </span><span>(</span><span>keyword?</span><span> </span><span>x</span><span>)</span><span>
      </span><span>(</span><span>overpad</span><span> </span><span>(</span><span>note</span><span> </span><span>x</span><span>))</span><span>
      </span><span>(</span><span>overpad</span><span> </span><span>x</span><span>))))</span><span>

</span><span>(</span><span>play</span><span> </span><span>:C4</span><span>)</span><span>
</span><span>(</span><span>play</span><span> </span><span>(</span><span>chord</span><span> </span><span>:C4</span><span> </span><span>:minor</span><span>))</span><span>

</span><span>(</span><span>defn</span><span> </span><span>melody</span><span> </span><span>[</span><span>notes</span><span> </span><span>sleep</span><span>]</span><span>
  </span><span>(</span><span>if</span><span> </span><span>(</span><span>empty?</span><span> </span><span>notes</span><span>)</span><span> </span><span>nil</span><span>
      </span><span>(</span><span>doseq</span><span> </span><span>[]</span><span>
        </span><span>(</span><span>play</span><span> </span><span>(</span><span>first</span><span> </span><span>notes</span><span>))</span><span>
        </span><span>(</span><span>Thread/sleep</span><span> </span><span>sleep</span><span>)</span><span>
        </span><span>(</span><span>melody</span><span> </span><span>(</span><span>rest</span><span> </span><span>notes</span><span>)</span><span> </span><span>sleep</span><span>))))</span><span>

</span><span>(</span><span>defn</span><span> </span><span>vechord</span><span> </span><span>[</span><span>x</span><span> </span><span>y</span><span>]</span><span>
  </span><span>(</span><span>conj</span><span> </span><span>(</span><span>vec</span><span> </span><span>(</span><span>chord</span><span> </span><span>x</span><span> </span><span>y</span><span>))</span><span> </span><span>0</span><span>))</span><span>

</span><span>(</span><span>doseq</span><span> </span><span>[]</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:a3</span><span> </span><span>:minor</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:f3</span><span> </span><span>:major</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:c4</span><span> </span><span>:major</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:g3</span><span> </span><span>:major</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:a3</span><span> </span><span>:minor</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>(</span><span>vechord</span><span> </span><span>:f3</span><span> </span><span>:major</span><span>)</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>[</span><span>48</span><span> </span><span>52</span><span> </span><span>55</span><span> </span><span>0</span><span>]</span><span> </span><span>250</span><span>)</span><span>
 </span><span>(</span><span>melody</span><span> </span><span>[</span><span>43</span><span> </span><span>50</span><span> </span><span>55</span><span> </span><span>0</span><span>]</span><span> </span><span>250</span><span>))</span><span>
</span></pre></td></tr></tbody></table></code></p></div><p>You can copy it from this page and populate your file using Emacs keybindings. First, use <code>C-x h</code> to select everything in the <em>core.clj</em> buffer, then hit <em>Backspace</em> button to erase everything. Now, copy the last code block from this article and use <code>C-y</code> to populate the buffer with the code. It really feels effortless to use keybindings once you get used to them. Now, let’s walk through the code. </p><h2 id="summary">Summary</h2><p>Well, here we are, at the end of our article. Although a bit lengthy, it shows in a detailed way:</p><ul><li>How to install and setup Emacs, arguably the most powerful text editor/development environment in the world</li><li>How to tweak the environment so you can truly concentrate on programming in a keyboard-focused way</li><li>How to use Clojure and Overtone to create music with it</li></ul><p>Now that we have our environment ready we can focus on exploring what kind of interesting sounds we can create with Overtone and how we can improve it. But more on that topic in the future articles. Until then, try to modify the code from this article and see (or better, listen) to what kind of results you will get. Until next time, happy coding!</p></div></div>
  </body>
</html>
