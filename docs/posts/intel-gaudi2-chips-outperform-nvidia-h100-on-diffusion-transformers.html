<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://stability.ai/news/putting-the-ai-supercomputer-to-work">Original</a>
    <h1>Intel Gaudi2 chips outperform Nvidia H100 on diffusion transformers</h1>
    
    <div id="readability-page-1" class="page"><div data-block-type="2" data-border-radii="{&#34;topLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;topRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0}}" id="block-yui_3_17_2_1_1709158639151_29172"><div>

<div>
  <p>In our <a href="https://stability.ai/news/using-the-new-ai-supercomputer"><span>last installment</span></a>, we spoke about how we plan to utilize our state-of-the-art AI Supercomputer.</p><p>In this installment, we delve deeper into performance benchmarks and benefits of various compute solutions.</p><p>Our commitment to developing cutting-edge open models in multiple modalities necessitates a compute solution capable of handling diverse tasks with efficiency. To this end, we conducted a performance analysis, training two of our models, including the highly anticipated <a href="https://stability.ai/news/stable-diffusion-3"><span>Stable Diffusion 3</span></a>.</p><p>In our analysis, we compared the training speed of Intel Gaudi 2 accelerators versus Nvidia&#39;s A100 and H100, two of the most common choices for startups and developers training LLMs.</p><p><strong>Model 1:</strong></p><p><a href="https://stability.ai/news/stable-diffusion-3"><span><strong>Stable Diffusion 3</strong></span></a> is our most capable text-to-image model, soon to be in <a href="https://stability.ai/stablediffusion3"><span>early preview</span></a>. </p><p>Upon public release of Stable Diffusion 3, it will be available in sizes ranging from 800M to 8B parameters. Our analysis utilized the 2B parameter version and showed pleasantly surprising results. </p><p>We measured the training throughput for the 2B <a href="https://stability.ai/news/stable-diffusion-3-research-paper"><span>Multimodal Diffusion Transformer</span></a> (MMDiT) architecture model with d=24, BFloat16mixed precision, optimized attention (xFormers for A100 and the FusedSDPA for Intel Gaudi). We call this model version MMDiT-ps2-d24.</p><p>First, let’s examine our training benchmark results across 2 nodes, a total of 16 accelerators (Gaudi/GPU). Here’s an excerpt of the raw data:</p>
</div>




















  
  



</div></div><div data-block-type="2" data-border-radii="{&#34;topLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;topRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0}}" id="block-yui_3_17_2_1_1709158639151_25063"><div>

<div>
  <p>In this configuration, the Gaudi 2 cluster processed over 3x more images per second, compared to A100-80GB GPUs. This is particularly impressive considering that the A100s have a very optimized software stack. </p><p>On inference tests with the Stable Diffusion 3 8B parameter model the Gaudi 2 chips offer inference speed similar to Nvidia A100 chips using base PyTorch. However, with TensorRT optimization, the A100 chips produce images 40% faster than Gaudi 2. We anticipate that with further optimization, Gaudi 2 will soon outperform A100s on this model. In earlier tests on our SDXL model with base PyTorch, Gaudi 2 generates a 1024x1024 image in 30 steps in 3.2 seconds, versus 3.6 seconds for PyTorch on A100s and 2.7 seconds for a generation with TensorRT on an A100. </p><p>The higher memory and fast interconnect of Gaudi 2, plus other design considerations, make it competitive to run the Diffusion Transformer architecture that underpins this next generation of media models.</p><p><a href="https://stability.ai/news/stable-beluga-large-instruction-fine-tuned-models"><span><strong>Stable Beluga 2.5 70B</strong></span></a><strong> </strong>is our fine-tuned version of LLaMA 2 70B, building on the <a href="https://stability.ai/news/stable-beluga-large-instruction-fine-tuned-models"><span>Stable Beluga 2</span></a> model which was the first open model to best ChatGPT 3.5 in select benchmarks. We ran this training benchmark on 256 Gaudi 2 accelerators. Running our PyTorch code out of the box, with no extra optimizations, we measured an impressive total average throughput of 116,777 tokens/second. More specifically, this involves using a FP16 datatype, a global batch size of 1024, gradient accumulation steps of 2, and micro batch size of 2.</p><p>On inference tests with our 70B language model on Gaudi 2, it generates 673 tokens/second per accelerator, using an input token size of 128 and output token size of 2048. In comparison to <a href="https://nvidia.github.io/TensorRT-LLM/performance.html"><span>TensorRT-LLM</span></a>, Gaudi 2 appears to be 28% faster than the 525 tokens/second for the A100. We also anticipate further speed improvements with FP8.</p><p>Companies like ours face an increasing demand for more powerful and efficient computing solutions. Our findings underscore the need for alternatives like the Gaudi 2, which not only offers superior performance to other 7nm chips, but also addresses critical market needs such as affordability, reduced lead times, and superior price-to-performance ratios. Ultimately, the opportunity for choice in computing options broadens participation and innovation, thereby making advanced AI technologies more accessible to all.</p><p>Stay tuned for more insights in our next installment of &#34;Behind the Compute.&#34; </p><p>To stay updated on our progress follow us on <a href="https://twitter.com/stabilityai"><span>Twitter</span></a>, <a href="https://www.instagram.com/stability.ai/"><span>Instagram</span></a>, <a href="https://www.linkedin.com/company/stability-ai"><span>LinkedIn</span></a>, and join our <a href="https://discord.gg/stablediffusion"><span>Discord Community</span></a>.</p>
</div>




















  
  



</div></div></div>
  </body>
</html>
