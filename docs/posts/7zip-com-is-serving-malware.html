<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.malwarebytes.com/blog/threat-intel/2026/02/fake-7-zip-downloads-are-turning-home-pcs-into-proxy-nodes">Original</a>
    <h1>7zip.com Is Serving Malware</h1>
    
    <div id="readability-page-1" class="page"><article id="post-373953">
	<div>


		<div>
			
<p>A convincing lookalike of the popular 7-Zip archiver site has been serving a trojanized installer that silently converts victims’ machines into residential proxy nodes—and it has been hiding in plain sight for some time.</p>



<h2 id="h-i-m-so-sick-to-my-stomach">“I’m so sick to my stomach”</h2>



<p>A PC builder recently turned to Reddit’s r/pcmasterrace community in a panic after realizing they had downloaded 7‑Zip from the wrong website. Following a YouTube tutorial for a new build, they were instructed to download 7‑Zip from 7zip[.]com, unaware that the legitimate project is hosted exclusively at 7-zip.org.</p>



<p>In their Reddit post, the user described installing the file first on a laptop and later transferring it via USB to a newly built desktop. They encountered repeated 32‑bit versus 64‑bit errors and ultimately abandoned the installer in favor of Windows’ built‑in extraction tools. Nearly two weeks later, Microsoft Defender alerted on the system with a generic detection: Trojan:Win32/Malgent!MSR.</p>



<p>The experience illustrates how a seemingly minor domain mix-up can result in long-lived, unauthorized use of a system when attackers successfully masquerade as trusted software distributors.</p>



<h2 id="h-a-trojanized-installer-masquerading-as-legitimate-software">A trojanized installer masquerading as legitimate software</h2>



<p>This is not a simple case of a malicious download hosted on a random site. The operators behind 7zip[.]com distributed a trojanized installer via a lookalike domain, delivering a functional copy of functional 7‑Zip File Manager alongside a concealed malware payload.</p>



<p>The installer is Authenticode‑signed using a now‑revoked certificate issued to Jozeal Network Technology Co., Limited, lending it superficial legitimacy. During installation, a modified build of <code>7zfm.exe</code> is deployed and functions as expected, reducing user suspicion. In parallel, three additional components are silently dropped:</p>



<ul>
<li><strong>Uphero.exe</strong>—a service manager and update loader</li>



<li><strong>hero.exe</strong>—the primary proxy payload (Go‑compiled)</li>



<li><strong>hero.dll</strong>—a supporting library</li>
</ul>



<p>All components are written to <code>C:\Windows\SysWOW64\hero\</code>, a privileged directory that is unlikely to be manually inspected.</p>



<p>An independent update channel was also observed at <code>update.7zip[.]com/version/win-service/1.0.0.2/Uphero.exe.zip</code>, indicating that the malware payload can be updated independently of the installer itself.</p>



<h2 id="h-abuse-of-trusted-distribution-channels">Abuse of trusted distribution channels</h2>



<p>One of the more concerning aspects of this campaign is its reliance on third‑party trust. The Reddit case highlights YouTube tutorials as an inadvertent malware distribution vector, where creators incorrectly reference 7zip.com instead of the legitimate domain.</p>



<p>This shows how attackers can exploit small errors in otherwise benign content ecosystems to funnel victims toward malicious infrastructure at scale.</p>



<h2 id="h-execution-flow-from-installer-to-persistent-proxy-service">Execution flow: from installer to persistent proxy service</h2>



<p>Behavioral analysis shows a rapid and methodical infection chain:</p>



<p><strong>1. File deployment</strong>—The payload is installed into SysWOW64, requiring elevated privileges and signaling intent for deep system integration.</p>



<p><strong>2. Persistence via Windows services</strong>—Both <code>Uphero.exe</code> and <code>hero.exe</code> are registered as auto‑start Windows services running under System privileges, ensuring execution on every boot.</p>



<p><strong>3. Firewall rule manipulation</strong>—The malware invokes <code>netsh</code> to remove existing rules and create new inbound and outbound allow rules for its binaries. This is intended to reduce interference with network traffic and support seamless payload updates.</p>



<p><strong>4. Host profiling</strong>—Using WMI and native Windows APIs, the malware enumerates system characteristics including hardware identifiers, memory size, CPU count, disk attributes, and network configuration. The malware communicates with iplogger[.]org via a dedicated reporting endpoint, suggesting it collects and reports device or network metadata as part of its proxy infrastructure.</p>



<h2 id="h-functional-goal-residential-proxy-monetization">Functional goal: residential proxy monetization</h2>



<p>While initial indicators suggested backdoor‑style capabilities, further analysis revealed that the malware’s primary function is proxyware. The infected host is enrolled as a residential proxy node, allowing third parties to route traffic through the victim’s IP address.</p>



<p>The <code>hero.exe</code> component retrieves configuration data from rotating “smshero”‑themed command‑and‑control domains, then establishes outbound proxy connections on non‑standard ports such as 1000 and 1002. Traffic analysis shows a lightweight XOR‑encoded protocol (key <code>0x70</code>) used to obscure control messages.</p>



<p>This infrastructure is consistent with known residential proxy services, where access to real consumer IP addresses is sold for fraud, scraping, ad abuse, or anonymity laundering.</p>







<p>The 7‑Zip impersonation appears to be part of a broader operation. Related binaries have been identified under names such as <code>upHola.exe</code>, upTiktok, upWhatsapp, and upWire, all sharing identical tactics, techniques, and procedures:</p>



<ul>
<li>Deployment to SysWOW64</li>



<li>Windows service persistence</li>



<li>Firewall rule manipulation via <code>netsh</code></li>



<li>Encrypted HTTPS C2 traffic</li>
</ul>



<p>Embedded strings referencing VPN and proxy brands suggest a unified backend supporting multiple distribution fronts.</p>



<h2 id="h-rotating-infrastructure-and-encrypted-transport">Rotating infrastructure and encrypted transport</h2>



<p>Memory analysis uncovered a large pool of hardcoded command-and-control domains using <code>hero</code> and <code>smshero</code> naming conventions. Active resolution during sandbox execution showed traffic routed through Cloudflare infrastructure with TLS‑encrypted HTTPS sessions. </p>



<p>The malware also uses DNS-over-HTTPS via Google’s resolver, reducing visibility for traditional DNS monitoring and complicating network-based detection.</p>



<h2 id="h-evasion-and-anti-analysis-features">Evasion and anti‑analysis features</h2>



<p>The malware incorporates multiple layers of sandbox and analysis evasion:</p>



<ul>
<li>Virtual machine detection targeting VMware, VirtualBox, QEMU, and Parallels</li>



<li>Anti‑debugging checks and suspicious debugger DLL loading</li>



<li>Runtime API resolution and PEB inspection</li>



<li>Process enumeration, registry probing, and environment inspection</li>
</ul>



<p>Cryptographic support is extensive, including AES, RC4, Camellia, Chaskey, XOR encoding, and Base64, suggesting encrypted configuration handling and traffic protection.</p>



<h2 id="h-defensive-guidance">Defensive guidance</h2>



<p>Any system that has executed installers from 7zip.com should be considered compromised. While this malware establishes SYSTEM‑level persistence and modifies firewall rules, reputable security software can effectively detect and remove the malicious components. Malwarebytes is capable of fully eradicating known variants of this threat and reversing its persistence mechanisms. In high‑risk or heavily used systems, some users may still choose a full OS reinstall for absolute assurance, but it is not strictly required in all cases.</p>



<p>Users and defenders should:</p>



<ul>
<li>Verify software sources and bookmark official project domains</li>



<li>Treat unexpected code‑signing identities with skepticism</li>



<li>Monitor for unauthorized Windows services and firewall rule changes</li>



<li>Block known C2 domains and proxy endpoints at the network perimeter</li>
</ul>



<h2 id="h-researcher-attribution-and-community-analysis">Researcher attribution and community analysis</h2>



<p>This investigation would not have been possible without the work of independent security researchers who went deeper than surface-level indicators and identified the true purpose of this malware family.</p>



<ul>
<li><strong>Luke Acha</strong> provided the first comprehensive analysis showing that the Uphero/hero malware functions as residential proxyware rather than a traditional backdoor. His work documented the proxy protocol, traffic patterns, and monetization model, and connected this campaign to a broader operation he dubbed upStage Proxy. <a href="https://blog.lukeacha.com/2026/01/beware-of-fake-7zip-installer-upstage.html" target="_blank" rel="noreferrer noopener nofollow">Luke’s full write-up is available on his blog</a>.</li>



<li><strong>s1dhy</strong> expanded on this analysis by reversing and decoding the custom XOR-based communication protocol, validating the proxy behavior through packet captures, and correlating multiple proxy endpoints across victim geolocations. Technical notes and findings were <a href="https://x.com/s1dhy" target="_blank" rel="noreferrer noopener nofollow">shared publicly on X (Twitter)</a>.</li>



<li><strong>Andrew Danis</strong> contributed <a href="https://x.com/andrewdanis" target="_blank" rel="noreferrer noopener nofollow">additional infrastructure analysis and clustering</a>, helping tie the fake 7-Zip installer to related proxyware campaigns abusing other software brands.</li>
</ul>



<p>Additional technical validation and dynamic analysis were published by researchers at <a href="https://qiita.com/RaichuLab/items/f592cad98b76a0bba150" target="_blank" rel="noreferrer noopener nofollow">RaichuLab</a> on Qiita and <a href="https://wizsafe.iij.ad.jp/2026/01/2075/" target="_blank" rel="noreferrer noopener nofollow">WizSafe Security</a> on IIJ.</p>



<p>Their collective work highlights the importance of open, community-driven research in uncovering long-running abuse campaigns that rely on trust and misdirection rather than exploits.</p>



<h2 id="h-closing-thoughts">Closing thoughts</h2>



<p>This campaign demonstrates how effective brand impersonation combined with technically competent malware can operate undetected for extended periods. By abusing user trust rather than exploiting software vulnerabilities, attackers bypass many traditional security assumptions—turning everyday utility downloads into long‑lived monetization infrastructure.</p>



<p>Malwarebytes detects and blocks known variants of this proxyware family and its associated infrastructure.</p>



<h2 id="h-indicators-of-compromise-iocs">Indicators of Compromise (IOCs)</h2>



<h3 id="h-file-paths">File paths</h3>



<ul>
<li><code>C:\Windows\SysWOW64\hero\Uphero.exe</code></li>



<li><code>C:\Windows\SysWOW64\hero\hero.exe</code></li>



<li><code>C:\Windows\SysWOW64\hero\hero.dll</code></li>
</ul>



<h3 id="h-file-hashes-sha-256">File hashes (SHA-256)</h3>



<ul>
<li><code>e7291095de78484039fdc82106d191bf41b7469811c4e31b4228227911d25027</code> (Uphero.exe)</li>



<li><code>b7a7013b951c3cea178ece3363e3dd06626b9b98ee27ebfd7c161d0bbcfbd894</code> (hero.exe)</li>



<li><code>3544ffefb2a38bf4faf6181aa4374f4c186d3c2a7b9b059244b65dce8d5688d9</code> (hero.dll)</li>
</ul>



<h3 id="h-network-indicators">Network indicators</h3>



<p><strong>Domains:</strong></p>



<ul>
<li><code>soc.hero-sms[.]co</code></li>



<li><code>neo.herosms[.]co</code></li>



<li><code>flux.smshero[.]co</code></li>



<li><code>nova.smshero[.]ai</code></li>



<li><code>apex.herosms[.]ai</code></li>



<li><code>spark.herosms[.]io</code></li>



<li><code>zest.hero-sms[.]ai</code></li>



<li><code>prime.herosms[.]vip</code></li>



<li><code>vivid.smshero[.]vip</code></li>



<li><code>mint.smshero[.]com</code></li>



<li><code>pulse.herosms[.]cc</code></li>



<li><code>glide.smshero[.]cc</code></li>



<li><code>svc.ha-teams.office[.]com</code></li>



<li><code>iplogger[.]org</code></li>
</ul>



<p><strong>Observed IPs (Cloudflare-fronted):</strong></p>



<ul>
<li><code>104.21.57.71</code></li>



<li><code>172.67.160.241</code></li>
</ul>



<h3 id="h-host-based-indicators">Host-based indicators</h3>



<ul>
<li>Windows services with image paths pointing to <code>C:\Windows\SysWOW64\hero\</code></li>



<li>Firewall rules named Uphero or hero (inbound and outbound)</li>



<li>Mutex: <code>Global\3a886eb8-fe40-4d0a-b78b-9e0bcb683fb7</code></li>
</ul>



<hr/>



<p><strong>We don’t just report on threats—we remove them</strong></p>



<p>Cybersecurity risks should never spread beyond a headline. Keep threats off your devices by <a href="https://www.malwarebytes.com/for-home">downloading Malwarebytes today</a>.</p>
		</div><!-- .entry-content -->
	</div>
</article><div>
    <p>
        <h3>About the author</h3>
    </p>
    <div>
        <div>
            <p><a href="https://www.malwarebytes.com/blog/authors/sdasic">
                                            <img alt="Stefan Dasic" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/T9182B16E-UA1LSQA5C-4ec152fb11fd-512.png" srcset="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/T9182B16E-UA1LSQA5C-4ec152fb11fd-512.png" height="150" width="150" loading="lazy"/>
                                    </a>
            </p>
            
        </div>
                         <p>Passionate about antivirus solutions, Stefan has been involved in malware testing and AV product QA from an early age. As part of the Malwarebytes team, Stefan is dedicated to protecting customers and ensuring their security.</p>
                    </div>
</div></div>
  </body>
</html>
