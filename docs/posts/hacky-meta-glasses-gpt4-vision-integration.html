<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/dcrebbin/meta-vision-api">Original</a>
    <h1>Show HN: Hacky Meta Glasses GPT4 Vision Integration</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<h3 tabindex="-1" dir="auto"><a id="user-content-meta-glasses-gpt4-vision-api-implementation" aria-hidden="true" tabindex="-1" href="#meta-glasses-gpt4-vision-api-implementation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Meta Glasses GPT4 Vision API Implementation</h3>
<p dir="auto">This is a hacky way to integrate GPT4 Vision into the Meta Rayban Smart Glasses using voice commands.</p>
<p dir="auto"><a href="https://www.youtube.com/watch?v=PiEDrcLCmew" rel="nofollow">Example Demonstration</a></p>
<p dir="auto">Requirements:</p>
<p dir="auto">a) <a href="https://about.fb.com/news/2023/09/new-ray-ban-meta-smart-glasses/" rel="nofollow">Meta Rayban Smart Glasses</a></p>
<p dir="auto">b) <a href="https://platform.openai.com/" rel="nofollow">OpenAi Api Key</a></p>
<p dir="auto">c) Alternative Facebook/Messenger account</p>
<p dir="auto">d) <a href="https://bun.sh/" rel="nofollow">bun</a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-setup" aria-hidden="true" tabindex="-1" href="#setup"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Setup</h3>
<h4 tabindex="-1" dir="auto"><a id="user-content-get-the-server-up-and-running" aria-hidden="true" tabindex="-1" href="#get-the-server-up-and-running"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Get the server up and running:</h4>
<ol dir="auto">
<li>
<p dir="auto">Add a .env file with your OpenAi API key (example via <code>env.example</code>)</p>
</li>
<li>
<p dir="auto">Run <code>bun install</code></p>
</li>
<li>
<p dir="auto">Run <code>bun run dev</code></p>
</li>
<li>
<p dir="auto">Server should be up and running on PORT 3103</p>
</li>
</ol>
<h4 tabindex="-1" dir="auto"><a id="user-content-add-the-messenger-chat-observer" aria-hidden="true" tabindex="-1" href="#add-the-messenger-chat-observer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Add the Messenger Chat Observer:</h4>
<p dir="auto"><strong>WARNING</strong>: bookmarklets are a slightly obscure and very hacky way to execute arbitrary javascript in your browser, before running <strong>MAKE SURE</strong> to check the code you&#39;re executing.
The bookmarklet code is documented below in the section titled: <strong>Bookmarklet Code Breakdown</strong></p>
<ol dir="auto">
<li>
<p dir="auto">Login to <a href="https://www.messenger.com" rel="nofollow">messenger.com</a> with an alternative messenger/facebook account (make sure you are friends with your main account that&#39;s logged into your meta view app)</p>
</li>
<li>
<p dir="auto">Copy and paste the code from <code>bookmarklet.js</code> and create a new bookmark in your browser with the URL as the code (alternatively import it as a bookmark)</p>
</li>
<li>
<p dir="auto">Click the newly created bookmark</p>
</li>
<li>
<p dir="auto">Upon success a dialog should appear with <strong>Added Messenger Chat Observer</strong></p>
</li>
</ol>
<h4 tabindex="-1" dir="auto"><a id="user-content-test-the-integration" aria-hidden="true" tabindex="-1" href="#test-the-integration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Test the integration:</h4>
<ol dir="auto">
<li>
<p dir="auto">Make sure within the Meta View app that the messenger connection is connected to the appropriate main account</p>
</li>
<li>
<p dir="auto">Say <code>You: Hey Meta, send a photo to *name of alternative account*</code></p>
</li>
<li>
<p dir="auto"><code>Meta: Send a photo to *name of alternative account*</code></p>
</li>
<li>
<p dir="auto"><code>You: Yes</code></p>
</li>
<li>
<p dir="auto">Upon receiving the new photo and sending it to GPT4 Vision the server should display the following logs:</p>
</li>
</ol>
<div data-snippet-clipboard-copy-content="GPT4 Vision Request
Sending request to GPT4 Vision
Request Successful
Saving data
Reading stored data
Creating new data file.
Writing new data"><pre><code>GPT4 Vision Request
Sending request to GPT4 Vision
Request Successful
Saving data
Reading stored data
Creating new data file.
Writing new data
</code></pre></div>
<ol start="6" dir="auto">
<li>Open up <code>./public/data.json</code> to check the successful added data</li>
</ol>
<p dir="auto">ENJOY!</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-bookmarklet-code-breakdown" aria-hidden="true" tabindex="-1" href="#bookmarklet-code-breakdown"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Bookmarklet Code Breakdown:</h4>
<div dir="auto" data-snippet-clipboard-copy-content="javascript: (function (s) {
  //This a bookmarklet that you can either import as a bookmark
  //OR you can copy all the code and paste into the URL when making a new bookmark
  //OR post in dev console

  // This is designed to observe for any new photo messages that are sent in messenger and then to forward the image url to this projects REST api

  const messages = document.getElementsByClassName(&#34;x78zum5 xdt5ytf x1iyjqo2 xs83m0k x1xzczws x6ikm8r x1rife3k x1n2onr6 xh8yej3&#34;)[1].childNodes[2];

  // This is to find the messages container within messenger.com for the selected chat

  // However, these obfuscated classes are subject to change and so this is likely to break in the near future

  messages.removeEventListener(&#34;DOMNodeInserted&#34;, null);

  // The utilization of DOMNodeInserted is very bad practice and will be deprecated in all browsers in the future

  // Mutation observer should replace DOMNodeInserted
  messages.addEventListener(&#34;DOMNodeInserted&#34;, async (event) =&gt; {
    const imgSrc = event?.target?.getElementsByTagName(&#34;img&#34;)[1]?.src;
    if (imgSrc) {
      const res = await fetch(&#34;http://localhost:3103/api/gpt-4-vision&#34;, {
        method: &#34;POST&#34;,

        //Facebook&#39;s image urls contains lots of properties that need to be perfectly preserved in order to view the image
        body: JSON.stringify({ imageUrl: imgSrc }),
        mode: &#34;no-cors&#34;,
        headers: {
          &#34;Content-Type&#34;: &#34;application/json&#34;,
        },
      });
      const data = res.json();
      console.log(data);
    }
  });
  alert(&#34;Added Messenger Chat Observer&#34;);
})();"><pre>javascript: <span>(</span><span>function</span> <span>(</span><span>s</span><span>)</span> <span>{</span>
  <span>//This a bookmarklet that you can either import as a bookmark</span>
  <span>//OR you can copy all the code and paste into the URL when making a new bookmark</span>
  <span>//OR post in dev console</span>

  <span>// This is designed to observe for any new photo messages that are sent in messenger and then to forward the image url to this projects REST api</span>

  <span>const</span> <span>messages</span> <span>=</span> <span>document</span><span>.</span><span>getElementsByClassName</span><span>(</span><span>&#34;x78zum5 xdt5ytf x1iyjqo2 xs83m0k x1xzczws x6ikm8r x1rife3k x1n2onr6 xh8yej3&#34;</span><span>)</span><span>[</span><span>1</span><span>]</span><span>.</span><span>childNodes</span><span>[</span><span>2</span><span>]</span><span>;</span>

  <span>// This is to find the messages container within messenger.com for the selected chat</span>

  <span>// However, these obfuscated classes are subject to change and so this is likely to break in the near future</span>

  <span>messages</span><span>.</span><span>removeEventListener</span><span>(</span><span>&#34;DOMNodeInserted&#34;</span><span>,</span> <span>null</span><span>)</span><span>;</span>

  <span>// The utilization of DOMNodeInserted is very bad practice and will be deprecated in all browsers in the future</span>

  <span>// Mutation observer should replace DOMNodeInserted</span>
  <span>messages</span><span>.</span><span>addEventListener</span><span>(</span><span>&#34;DOMNodeInserted&#34;</span><span>,</span> <span>async</span> <span>(</span><span>event</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>imgSrc</span> <span>=</span> <span>event</span><span>?.</span><span>target</span><span>?.</span><span>getElementsByTagName</span><span>(</span><span>&#34;img&#34;</span><span>)</span><span>[</span><span>1</span><span>]</span><span>?.</span><span>src</span><span>;</span>
    <span>if</span> <span>(</span><span>imgSrc</span><span>)</span> <span>{</span>
      <span>const</span> <span>res</span> <span>=</span> <span>await</span> <span>fetch</span><span>(</span><span>&#34;http://localhost:3103/api/gpt-4-vision&#34;</span><span>,</span> <span>{</span>
        <span>method</span>: <span>&#34;POST&#34;</span><span>,</span>

        <span>//Facebook&#39;s image urls contains lots of properties that need to be perfectly preserved in order to view the image</span>
        <span>body</span>: <span>JSON</span><span>.</span><span>stringify</span><span>(</span><span>{</span> <span>imageUrl</span>: <span>imgSrc</span> <span>}</span><span>)</span><span>,</span>
        <span>mode</span>: <span>&#34;no-cors&#34;</span><span>,</span>
        <span>headers</span>: <span>{</span>
          <span>&#34;Content-Type&#34;</span>: <span>&#34;application/json&#34;</span><span>,</span>
        <span>}</span><span>,</span>
      <span>}</span><span>)</span><span>;</span>
      <span>const</span> <span>data</span> <span>=</span> <span>res</span><span>.</span><span>json</span><span>(</span><span>)</span><span>;</span>
      <span>console</span><span>.</span><span>log</span><span>(</span><span>data</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>
  <span>alert</span><span>(</span><span>&#34;Added Messenger Chat Observer&#34;</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>(</span><span>)</span><span>;</span></pre></div>
<p dir="auto">by <a href="https://github.com/dcrebbin">Devon Crebbin</a></p>
<p dir="auto">Please reach out if there are any issues or feature requests :)</p>
<p dir="auto">Hopefully the Meta Reality Labs team will provide an SDK in the future so these types of integrations can be ✨productionised✨</p>
</article>
          </div></div>
  </body>
</html>
