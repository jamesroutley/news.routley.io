<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Mic92/strace-macos">Original</a>
    <h1>Strace-macOS: A clone of the strace command for macOS</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A system call tracer for macOS using the LLDB debugger API.</p>
<p dir="auto"><strong>Status</strong>: Beta - Core functionality works, but some features are still in development.</p>

<ul dir="auto">
<li><strong>Works with SIP enabled</strong> - Unlike <code>dtruss</code>, doesn&#39;t require disabling System Integrity Protection</li>
<li><strong>Pure Python implementation</strong> - No kernel extensions or compiled components</li>
<li><strong>Multiple output formats</strong> - JSON Lines and strace-compatible text output</li>
<li><strong>Syscall filtering</strong> - Filter by syscall name or category (<code>-e trace=file</code>, <code>-e trace=network</code>)</li>
<li><strong>Symbolic decoding</strong> - Automatically decodes flags, error codes, and struct fields</li>
<li><strong>Color output</strong> - Syntax highlighting when output is a TTY</li>
<li><strong>Summary statistics</strong> - Time/call/error counts with <code>-c</code></li>
</ul>


<div dir="auto" data-snippet-clipboard-copy-content="# Run directly
nix run github:Mic92/strace-macos -- ls

# Install to profile
nix profile install github:Mic92/strace-macos"><pre><span><span>#</span> Run directly</span>
nix run github:Mic92/strace-macos -- ls

<span><span>#</span> Install to profile</span>
nix profile install github:Mic92/strace-macos</pre></div>

<p dir="auto">strace-macos requires macOS system Python (has LLDB bindings):</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Install directly from GitHub
/usr/bin/python3 -m pip install --user git+https://github.com/Mic92/strace-macos

# Then run (if ~/Library/Python/3.x/bin is in PATH)
strace /usr/local/bin/git status  # or any homebrew-installed binary

# Or run directly from repository without installing
git clone https://github.com/Mic92/strace-macos
cd strace-macos
/usr/bin/python3 -m strace_macos /usr/local/bin/git status"><pre><span><span>#</span> Install directly from GitHub</span>
/usr/bin/python3 -m pip install --user git+https://github.com/Mic92/strace-macos

<span><span>#</span> Then run (if ~/Library/Python/3.x/bin is in PATH)</span>
strace /usr/local/bin/git status  <span><span>#</span> or any homebrew-installed binary</span>

<span><span>#</span> Or run directly from repository without installing</span>
git clone https://github.com/Mic92/strace-macos
<span>cd</span> strace-macos
/usr/bin/python3 -m strace_macos /usr/local/bin/git status</pre></div>


<div dir="auto" data-snippet-clipboard-copy-content="# Basic usage (use non-system binaries like homebrew or nix-installed)
strace /usr/local/bin/git status

# Output to file
strace -o trace.txt /usr/local/bin/git status

# JSON output
strace --json /usr/local/bin/git status &gt; trace.jsonl

# Filter syscalls by name
strace -e trace=open,close /usr/local/bin/git status

# Filter by category*
strace -e trace=file /usr/local/bin/git status    # All file operations
strace -e trace=network /usr/local/bin/curl https://example.com   # Network syscalls only
strace -e trace=process /usr/local/bin/git status # Process lifecycle syscalls"><pre><span><span>#</span> Basic usage (use non-system binaries like homebrew or nix-installed)</span>
strace /usr/local/bin/git status

<span><span>#</span> Output to file</span>
strace -o trace.txt /usr/local/bin/git status

<span><span>#</span> JSON output</span>
strace --json /usr/local/bin/git status <span>&gt;</span> trace.jsonl

<span><span>#</span> Filter syscalls by name</span>
strace -e trace=open,close /usr/local/bin/git status

<span><span>#</span> Filter by category*</span>
strace -e trace=file /usr/local/bin/git status    <span><span>#</span> All file operations</span>
strace -e trace=network /usr/local/bin/curl https://example.com   <span><span>#</span> Network syscalls only</span>
strace -e trace=process /usr/local/bin/git status <span><span>#</span> Process lifecycle syscalls</span></pre></div>
<p dir="auto">* See <a href="#syscall-filtering">Syscall Filtering</a> for all supported categories.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Attach to running process</h3><a id="user-content-attach-to-running-process" aria-label="Permalink: Attach to running process" href="#attach-to-running-process"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>


<div dir="auto" data-snippet-clipboard-copy-content="strace -c /usr/local/bin/git status
# % time     seconds  usecs/call     calls    errors syscall
# ------ ----------- ----------- --------- --------- ----------------
#  45.23    0.001234          12       103           read
#  32.10    0.000876           8       110           write
#  ..."><pre>strace -c /usr/local/bin/git status
<span><span>#</span> % time     seconds  usecs/call     calls    errors syscall</span>
<span><span>#</span> ------ ----------- ----------- --------- --------- ----------------</span>
<span><span>#</span>  45.23    0.001234          12       103           read</span>
<span><span>#</span>  32.10    0.000876           8       110           write</span>
<span><span>#</span>  ...</span></pre></div>

<p dir="auto">strace-macos supports filtering syscalls by name or category using the <code>-e trace=</code> option.</p>

<p dir="auto">Specify one or more syscall names separated by commas:</p>
<div dir="auto" data-snippet-clipboard-copy-content="strace -e trace=open,close,read,write /usr/local/bin/git status"><pre>strace -e trace=open,close,read,write /usr/local/bin/git status</pre></div>

<p dir="auto">Use predefined categories to trace groups of related syscalls:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
<th>Example Syscalls</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file</code></td>
<td>File operations</td>
<td>open, close, read, write, stat, unlink</td>
</tr>
<tr>
<td><code>network</code></td>
<td>Network operations</td>
<td>socket, connect, send, recv, bind</td>
</tr>
<tr>
<td><code>process</code></td>
<td>Process lifecycle</td>
<td>fork, exec, wait, exit, kill</td>
</tr>
<tr>
<td><code>memory</code></td>
<td>Memory management</td>
<td>mmap, munmap, brk, mprotect</td>
</tr>
<tr>
<td><code>signal</code></td>
<td>Signal handling</td>
<td>signal, sigaction, sigprocmask, kill</td>
</tr>
<tr>
<td><code>ipc</code></td>
<td>Inter-process communication</td>
<td>pipe, shm_open, msgget, semop</td>
</tr>
<tr>
<td><code>thread</code></td>
<td>Thread operations</td>
<td>pthread_create, bsdthread_register</td>
</tr>
<tr>
<td><code>time</code></td>
<td>Time and timers</td>
<td>gettimeofday, setitimer, utimes</td>
</tr>
<tr>
<td><code>sysinfo</code></td>
<td>System information</td>
<td>sysctl, getpid, getuid, uname</td>
</tr>
<tr>
<td><code>security</code></td>
<td>Security/MAC operations</td>
<td>__mac_*, csops, csrctl</td>
</tr>
<tr>
<td><code>debug</code></td>
<td>Debugging and tracing</td>
<td>ptrace, kdebug_trace, panic_with_data</td>
</tr>
<tr>
<td><code>misc</code></td>
<td>Miscellaneous syscalls</td>
<td>ioctl, fcntl, kqueue, connectx</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Trace only file operations
strace -e trace=file /usr/local/bin/git status

# Trace only network syscalls
strace -e trace=network /usr/local/bin/curl https://example.com

# Trace process management syscalls
strace -e trace=process /usr/local/bin/git status"><pre><span><span>#</span> Trace only file operations</span>
strace -e trace=file /usr/local/bin/git status

<span><span>#</span> Trace only network syscalls</span>
strace -e trace=network /usr/local/bin/curl https://example.com

<span><span>#</span> Trace process management syscalls</span>
strace -e trace=process /usr/local/bin/git status</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Comparison with Linux strace</h3><a id="user-content-comparison-with-linux-strace" aria-label="Permalink: Comparison with Linux strace" href="#comparison-with-linux-strace"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Feature</th>
<th>Linux strace</th>
<th>strace-macos</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filter by syscall name</td>
<td>✅ <code>-e trace=open,close</code></td>
<td>✅ <code>-e trace=open,close</code></td>
</tr>
<tr>
<td>Filter by category</td>
<td>✅ <code>-e trace=file</code></td>
<td>✅ <code>-e trace=file</code></td>
</tr>
<tr>
<td>Negation (<code>!</code>)</td>
<td>✅ <code>-e trace=!open</code></td>
<td>❌ Not yet</td>
</tr>
<tr>
<td>Regex filtering</td>
<td>✅ <code>-e trace=/^open/</code></td>
<td>❌ Not yet</td>
</tr>
<tr>
<td>Path filtering</td>
<td>✅ <code>-P /etc/passwd</code></td>
<td>❌ Not yet</td>
</tr>
<tr>
<td>FD filtering</td>
<td>✅ <code>-e trace-fd=3</code></td>
<td>❌ Not yet</td>
</tr>
<tr>
<td><code>%desc</code> category</td>
<td>✅ FD-related syscalls</td>
<td>❌ Not yet</td>
</tr>
<tr>
<td>Percent prefix</td>
<td>✅ <code>%file</code> or <code>file</code></td>
<td><g-emoji alias="warning">⚠️</g-emoji> Only <code>file</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<ul dir="auto">
<li>macOS 12+ (Monterey or later)</li>
<li>Apple Silicon (ARM64) - <strong>primary platform</strong></li>
<li>Intel (x86_64) - <strong>work in progress</strong></li>
<li>Xcode Command Line Tools (for LLDB)</li>
<li>System Python (<code>/usr/bin/python3</code>)</li>
</ul>
<p dir="auto"><strong>Important</strong>: Must use macOS system Python - LLDB bindings don&#39;t work with Homebrew/pyenv/Nix Python.</p>

<p dir="auto">Contributions are welcome! See <a href="https://github.com/Mic92/strace-macos/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> for:</p>
<ul dir="auto">
<li>Development environment setup</li>
<li>Code style guidelines</li>
<li>Testing instructions</li>
<li>How to add new syscalls</li>
<li>Pull request process</li>
</ul>
<p dir="auto"><strong>Current Status</strong>: 3/13 tests passing (spawn functionality working)</p>

<div data-snippet-clipboard-copy-content="strace-macos (Python CLI)
    ↓
LLDB Python API
    ↓
debugserver (macOS debugging APIs)
    ↓
Target Process"><pre><code>strace-macos (Python CLI)
    ↓
LLDB Python API
    ↓
debugserver (macOS debugging APIs)
    ↓
Target Process
</code></pre></div>
<p dir="auto">The tracer uses LLDB&#39;s Python bindings to:</p>
<ol dir="auto">
<li>Set breakpoints at syscall entry/exit points</li>
<li>Read CPU registers to extract syscall arguments</li>
<li>Decode arguments symbolically (flags, errno, structs)</li>
<li>Format output in strace-compatible or JSON format</li>
</ol>

<p dir="auto"><strong>Working</strong>:</p>
<ul dir="auto">
<li>Spawn and trace new processes ✅</li>
<li>Attach to running processes ✅</li>
<li>Basic syscall capture (entry/exit) ✅</li>
<li>Argument decoding (integers, strings, pointers, buffers, iovecs) ✅</li>
<li>Symbolic flag decoding (O_RDONLY, etc.) ✅</li>
<li>Error code decoding (ENOENT, etc.) ✅</li>
<li>Struct decoding (stat, sockaddr, msghdr, etc.) ✅</li>
<li>Syscall filtering by name and category ✅</li>
<li>Summary statistics (<code>-c</code>) ✅</li>
<li>JSON and text output formats ✅</li>
<li>Color output with syntax highlighting ✅</li>
</ul>
<p dir="auto"><strong>Planned</strong>:</p>
<ul dir="auto">
<li>Multi-threaded process support</li>
<li>Follow forks (<code>-f</code>)</li>
<li>Negation filtering (<code>-e trace=!open</code>)</li>
<li>Regex filtering (<code>-e trace=/^open/</code>)</li>
<li>Path-based filtering (<code>-P /path</code>)</li>
<li>FD-based filtering (<code>-e trace-fd=3</code>)</li>
<li>String truncation control (<code>-s</code>)</li>
<li>Relative/absolute timestamps (<code>-t</code>, <code>-tt</code>, <code>-ttt</code>)</li>
</ul>

<p dir="auto">macOS ships with <code>dtruss</code>, a DTrace-based syscall tracer. However:</p>
<ul dir="auto">
<li>Requires disabling System Integrity Protection (SIP)</li>
<li>Doesn&#39;t work on modern macOS versions without workarounds</li>
<li>Limited filtering capabilities</li>
<li>No symbolic decoding of arguments</li>
</ul>
<p dir="auto">strace-macos works with SIP enabled and provides richer output.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Comparison with Linux strace</h2><a id="user-content-comparison-with-linux-strace-1" aria-label="Permalink: Comparison with Linux strace" href="#comparison-with-linux-strace-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">strace-macos aims for compatibility with Linux strace where possible:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Feature</th>
<th>Linux strace</th>
<th>strace-macos</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic tracing</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Attach to PID</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Syscall filtering*</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Summary stats</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Follow forks</td>
<td>✅</td>
<td>⏳</td>
</tr>
<tr>
<td>Symbolic decoding</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>JSON output</td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td>Color output</td>
<td>❌</td>
<td>✅</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">* See <a href="#syscall-filtering">Syscall Filtering</a> for detailed feature comparison.</p>

<p dir="auto">MIT License - see LICENSE file for details.</p>

<p dir="auto">Jörg Thalheim <a href="mailto:joerg@thalheim.io">joerg@thalheim.io</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Need commercial support or customization?</h2><a id="user-content-need-commercial-support-or-customization" aria-label="Permalink: Need commercial support or customization?" href="#need-commercial-support-or-customization"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">For commercial support, please contact <a href="https://github.com/Mic92/">Mic92</a> at
<a href="mailto:joerg@thalheim.io">joerg@thalheim.io</a> or reach out to <a href="https://numtide.com/contact/" rel="nofollow">Numtide</a>.</p>

<ul dir="auto">
<li><a href="https://github.com/Mic92/strace-macos/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> - Development and contribution guide</li>
<li><a href="https://github.com/Mic92/strace-macos/blob/main/tests/README.md">tests/README.md</a> - Test suite documentation</li>
</ul>
</article></div></div>
  </body>
</html>
