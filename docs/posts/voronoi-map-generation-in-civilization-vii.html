<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://civilization.2k.com/civ-vii/from-the-devs/map-generation/">Original</a>
    <h1>Voronoi map generation in Civilization VII</h1>
    
    <div id="readability-page-1" class="page"><div><p><span>Est. Read Time</span><span>6 minutes, 30 seconds</span></p></div><div><!----><div><p>Hello <i>Civ</i> fans! Ken Pruiksma, Senior Graphics Engineer at Firaxis Games, here to share some behind-the-scenes updates on map generation.</p><p>When <i>Civilization VII </i>first shipped, the map generation technique we used focused on ensuring balanced play while following some new gameplay rules around things like Deep Ocean and Distant Lands. This technique, which has its roots in previous <i>Civ</i> games, created fair maps, but also made them predictable. This caused the exploration phase of the game to be potentially less rewarding (which is a problem when the first X in 4X is Explore!) We heard from you that maps felt too repetitive, and we agreed. </p><p>Something else we heard loud and clear from the community is that the straight-edged coastlines that could occur between the two major halves was hindering the play experience. Part of the fantasy of Civ is that you&#39;re playing an alternative history of Earth, and when the maps don&#39;t feel plausibly Earth-like, it detracts from the experience (outside some exceptions like perfectly balanced multiplayer where you&#39;re opting into a mirrored game).</p><p>So, we&#39;ve made some big updates with 1.2.5. We wanted map generation that felt more natural and less repetitive, while still keeping balance in mind where it matters. Out of that work came two brand new map types to choose from: <b>Continents and Islands </b>(two large continents, with islands) and <b>Pangea and Islands </b>(one large continent, with islands). Both are built on an entirely new technique: <b>Voronoi map generation.</b></p>
              <picture>
                <source media="(min-width: 768px)" srcset="//assets.2k.com/1a6ngf98576c/4guRcpyxBNNSPiZ5b6jdV/1827cad1015b57dde3e87446a6071e44/01_FromTheDevs_ImprovedMapGeneration_Comparison.png" width="100%"/>
                <img loading="lazy" src="https://assets.2k.com/1a6ngf98576c/4guRcpyxBNNSPiZ5b6jdV/1827cad1015b57dde3e87446a6071e44/01_FromTheDevs_ImprovedMapGeneration_Comparison.png" width="100%"/>
              </picture><h2>VORONOI MAPS</h2><p>I&#39;m a graphics engineer, which means I spend most of my time making beautiful pixels, but I&#39;ve always had a soft spot for procedural generation and the algorithms that drive it. When the chance came up to help the gameplay team with map generation, I couldn&#39;t resist.</p><p>I had an idea about using Voronoi diagrams to dynamically grow landmasses using some rules. After throwing a quick test together, the idea showed promise.</p><p>Without getting too technical, the Voronoi technique completely changes how we approach map generation. Previously, fractal noise had been used to create maps, and it works really well when it can be applied uniformly to the whole map. That said, it can be hard to steer towards specific gameplay needs. Voronoi diagrams, on the other hand, give us structure we can build rules on top of, so maps can stay organic while still meeting the gameplay requirements of <i>Civ VII</i>.</p><p>Let&#39;s walk through how this works.</p><ol><li>Randomly spray a bunch of points onto the map. The more points we spray, the higher the resolution. We&#39;ll start low res.</li><li>Draw lines around each point dividing them into &#34;cells.&#34; You end up with something that looks a bit like cracked glass.</li><li>Select some starting cells. These are the seeds of tectonic plates in the game map, similar to the tectonic plates that form our Earth.</li><li>Each plate grows, one cell at a time, following some configurable rules, until the whole map is filled. Each plate gets a rotation and movement direction. This is your map&#39;s crust, and will be used to help influence the growth of continents later.</li><li>Now spray many more dots for a higher resolution version! Draw those lines again to get another shattered-glass look sitting on top of your tectonic plates.</li><li>Choose some new starting points for the primary landmasses, and grow them once again following a custom set of configurable rules. These rules can do things like influence landmasses to grow along plate boundaries (especially if they&#39;re colliding), avoid the poles, and prefer certain latitudes, just to name a few. This is also where we can apply gameplay-based restrictions, like ensuring Homelands and Distant Lands are separated by a Deep Ocean.</li><li>Based on the map&#39;s settings, we then grow islands, erode the coastline, add mountains and volcanoes, and perform other finishing touches. Many of these steps involve the same set of generic rules used earlier to determine where features are placed.</li><li>Once finished, we overlay the hex grid and then hand the map off to the gameplay layer to determine tile types, Yields, Resources, starting location, and more.</li></ol>
              <picture>
                <source media="(min-width: 768px)" srcset="//assets.2k.com/1a6ngf98576c/646kN78brdWAyoT4Ck6IwD/6f7d428088409d3d0ae001583c7f0117/02_FromTheDevs_ImprovedMapGeneration_Process.gif" width="100%"/>
                <img loading="lazy" src="https://assets.2k.com/1a6ngf98576c/646kN78brdWAyoT4Ck6IwD/6f7d428088409d3d0ae001583c7f0117/02_FromTheDevs_ImprovedMapGeneration_Process.gif" width="100%"/>
              </picture><p>The result is that the maps are far more varied and look much more natural. Things that were impossible before can now appear regularly. For example, Homelands and Distant Lands might be North and South of each other. Continents may share a large border, be connected by a small isthmus, or be separated by a sea. There may be a chain of islands between Homelands and Distant Lands – or maybe there won&#39;t! The islands could all be clustered in a corner or scattered around, and they&#39;re even allowed to merge, possibly causing a continent-sized super-island!</p><p>One thing to keep in mind is that we intentionally tuned the settings to generate &#34;normal&#34; maps (i.e. natural-feeling maps with standard gameplay) about 95% of the time. This means there is a small chance for super weird layouts. Part of the fun of <i>Civ</i> is sometimes landing on a bizarre start or weird map thanks to the RNG gods. If you land on an odd map, please share those!</p><p>Most importantly, this all means that while you&#39;re exploring your starting location and surrounding area, you can&#39;t make any assumptions about the shape of the world. When playing on these new maps, I&#39;ve felt the mystery and excitement again as I explore in the early game and have no idea what&#39;s going to appear in the next hex!</p>
              <picture>
                <source media="(min-width: 768px)" srcset="//assets.2k.com/1a6ngf98576c/5a6lBf3k7s6JkWM4DUTjtP/938f20ae045798ac976cd85a39090d37/4.9MB-03_FromTheDevs_ImprovedMapGeneration_Gen.gif" width="100%"/>
                <img loading="lazy" src="https://assets.2k.com/1a6ngf98576c/5a6lBf3k7s6JkWM4DUTjtP/938f20ae045798ac976cd85a39090d37/4.9MB-03_FromTheDevs_ImprovedMapGeneration_Gen.gif" width="100%"/>
              </picture>
              <picture>
                <source media="(min-width: 768px)" srcset="//assets.2k.com/1a6ngf98576c/2Z2PouWFqZiVmgDIZ3kvdJ/a70afe20da409b2924e2ecde9dd7aa1d/4.8MB_04_FromTheDevs_ImprovedMapGeneration_Gen.gif" width="100%"/>
                <img loading="lazy" src="https://assets.2k.com/1a6ngf98576c/2Z2PouWFqZiVmgDIZ3kvdJ/a70afe20da409b2924e2ecde9dd7aa1d/4.8MB_04_FromTheDevs_ImprovedMapGeneration_Gen.gif" width="100%"/>
              </picture><h2>JUST THE BEGINNING</h2><p>With the release of 1.2.5, you&#39;ll find new maps named &#34;Continents and Islands&#34; and &#34;Pangea and Islands&#34; that use this new approach, with the former being the new default in singleplayer games. If you&#39;d like to play with the old maps, they are still there under their original names. These older maps may be preferred in a multiplayer setting where the lower variance helps keep the balance among players. </p><p>This is just the beginning for our revamped work on maps! This technique was built with customization, expansion, and modding in mind from the beginning. As a result, you can expect more map options, future improvements to existing map types, and more exposed settings over time as we continue to develop this system. And yes, modders, Voronoi maps are available to you, too! You&#39;ll find the scripts and configuration settings used to generate them within the game files along with the specific settings we used for our official maps. We&#39;d love to see how you use this new approach to make new map types.</p><p>
Finally, we&#39;d love to see the maps you&#39;re all getting, so please keep posting them on social media or in the <a href="https://discord.com/invite/civilizationofficial" target="_blank" rel="noopener"><u>official </u><i><u>Civ</u></i><u> Discord</u></a>. We&#39;re excited about these changes and we hope you are too. Stay tuned for more map updates. Until then, have fun exploring! </p></div><!----></div></div>
  </body>
</html>
