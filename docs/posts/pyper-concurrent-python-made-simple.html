<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/pyper-dev/pyper">Original</a>
    <h1>Show HN: Pyper ‚Äì Concurrent Python Made Simple</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/pyper-dev/pyper/refs/heads/main/docs/src/assets/img/pyper.png"><img src="https://raw.githubusercontent.com/pyper-dev/pyper/refs/heads/main/docs/src/assets/img/pyper.png" alt="Pyper"/></a>
</p>
<p dir="auto">
    <em>Concurrent Python made simple</em>
</p>
<p dir="auto">
<a href="https://github.com/pyper-dev/pyper/actions/workflows/test.yml">
    <img src="https://github.com/pyper-dev/pyper/actions/workflows/test.yml/badge.svg" alt="Test"/>
</a>
<a href="https://coveralls.io/github/pyper-dev/pyper" rel="nofollow">
    <img src="https://camo.githubusercontent.com/7c0abda7e870aada4b86d61e835ac47343e1cd17c4fb1a3f271d516f1624fa75/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f70797065722d6465762f70797065722f62616467652e737667" alt="Coverage" data-canonical-src="https://coveralls.io/repos/github/pyper-dev/pyper/badge.svg"/>
</a>
<a href="https://pypi.org/project/python-pyper" rel="nofollow">
    <img src="https://camo.githubusercontent.com/bc504e749e0b1766c213e3677bdeced8663e31501e672f3cbbd2ecd58e39f41d/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f707974686f6e2d70797065723f636f6c6f723d253233333444303538266c6162656c3d707970692532307061636b616765" alt="Package version" data-canonical-src="https://img.shields.io/pypi/v/python-pyper?color=%2334D058&amp;label=pypi%20package"/>
</a>
<a href="https://pypi.org/project/python-pyper" rel="nofollow">
    <img src="https://camo.githubusercontent.com/1b06abc2edce72f4fca12539e4f46aad3886f666d62390ec549068049c4948a4/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f707974686f6e2d70797065722e7376673f636f6c6f723d253233333444303538" alt="Supported Python versions" data-canonical-src="https://img.shields.io/pypi/pyversions/python-pyper.svg?color=%2334D058"/>
</a>
</p>
<hr/>
<p dir="auto">Pyper is a flexible framework for concurrent and parallel data-processing, based on functional programming patterns. Used for üîÄ <strong>ETL Systems</strong>, ‚öôÔ∏è <strong>Data Microservices</strong>, and üåê <strong>Data Collection</strong></p>
<p dir="auto">See the <a href="https://pyper-dev.github.io/pyper/" rel="nofollow">Documentation</a></p>
<p dir="auto"><strong>Key features:</strong></p>
<ul dir="auto">
<li>üí°<strong>Intuitive API</strong>: Easy to learn, easy to think about. Implements clean abstractions to seamlessly unify threaded, multiprocessed, and asynchronous work.</li>
<li>üöÄ <strong>Functional Paradigm</strong>: Python functions are the building blocks of data pipelines. Let&#39;s you write clean, reusable code naturally.</li>
<li>üõ°Ô∏è <strong>Safety</strong>: Hides the heavy lifting of underlying task execution and resource clean-up. No more worrying about race conditions, memory leaks, or thread-level error handling.</li>
<li>‚ö° <strong>Efficiency</strong>: Designed from the ground up for lazy execution, using queues, workers, and generators.</li>
<li>‚ú® <strong>Pure Python</strong>: Lightweight, with zero sub-dependencies.</li>
</ul>

<p dir="auto">Install the latest version using <code>pip</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ pip install python-pyper"><pre>$ <span>pip install python-pyper</span></pre></div>
<p dir="auto">Note that <code>python-pyper</code> is the <a href="https://pypi.org/project/python-pyper" rel="nofollow">pypi</a> registered package.</p>

<p dir="auto">In Pyper, the <code>task</code> decorator is used to transform functions into composable pipelines.</p>
<p dir="auto">Let&#39;s simulate a pipeline that performs a series of transformations on some data.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import asyncio
import time

from pyper import task


def get_data(limit: int):
    for i in range(limit):
        yield i


async def step1(data: int):
    await asyncio.sleep(1)
    print(&#34;Finished async wait&#34;, data)
    return data


def step2(data: int):
    time.sleep(1)
    print(&#34;Finished sync wait&#34;, data)
    return data


def step3(data: int):
    for i in range(10_000_000):
        _ = i*i
    print(&#34;Finished heavy computation&#34;, data)
    return data


async def main():
    # Define a pipeline of tasks using `pyper.task`
    pipeline = task(get_data, branch=True) \
        | task(step1, workers=20) \
        | task(step2, workers=20) \
        | task(step3, workers=20, multiprocess=True)

    # Call the pipeline
    total = 0
    async for output in pipeline(limit=20):
        total += output
    print(&#34;Total:&#34;, total)


if __name__ == &#34;__main__&#34;:
    asyncio.run(main())"><pre><span>import</span> <span>asyncio</span>
<span>import</span> <span>time</span>

<span>from</span> <span>pyper</span> <span>import</span> <span>task</span>


<span>def</span> <span>get_data</span>(<span>limit</span>: <span>int</span>):
    <span>for</span> <span>i</span> <span>in</span> <span>range</span>(<span>limit</span>):
        <span>yield</span> <span>i</span>


<span>async</span> <span>def</span> <span>step1</span>(<span>data</span>: <span>int</span>):
    <span>await</span> <span>asyncio</span>.<span>sleep</span>(<span>1</span>)
    <span>print</span>(<span>&#34;Finished async wait&#34;</span>, <span>data</span>)
    <span>return</span> <span>data</span>


<span>def</span> <span>step2</span>(<span>data</span>: <span>int</span>):
    <span>time</span>.<span>sleep</span>(<span>1</span>)
    <span>print</span>(<span>&#34;Finished sync wait&#34;</span>, <span>data</span>)
    <span>return</span> <span>data</span>


<span>def</span> <span>step3</span>(<span>data</span>: <span>int</span>):
    <span>for</span> <span>i</span> <span>in</span> <span>range</span>(<span>10_000_000</span>):
        <span>_</span> <span>=</span> <span>i</span><span>*</span><span>i</span>
    <span>print</span>(<span>&#34;Finished heavy computation&#34;</span>, <span>data</span>)
    <span>return</span> <span>data</span>


<span>async</span> <span>def</span> <span>main</span>():
    <span># Define a pipeline of tasks using `pyper.task`</span>
    <span>pipeline</span> <span>=</span> <span>task</span>(<span>get_data</span>, <span>branch</span><span>=</span><span>True</span>) \
        <span>|</span> <span>task</span>(<span>step1</span>, <span>workers</span><span>=</span><span>20</span>) \
        <span>|</span> <span>task</span>(<span>step2</span>, <span>workers</span><span>=</span><span>20</span>) \
        <span>|</span> <span>task</span>(<span>step3</span>, <span>workers</span><span>=</span><span>20</span>, <span>multiprocess</span><span>=</span><span>True</span>)

    <span># Call the pipeline</span>
    <span>total</span> <span>=</span> <span>0</span>
    <span>async</span> <span>for</span> <span>output</span> <span>in</span> <span>pipeline</span>(<span>limit</span><span>=</span><span>20</span>):
        <span>total</span> <span>+=</span> <span>output</span>
    <span>print</span>(<span>&#34;Total:&#34;</span>, <span>total</span>)


<span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span>:
    <span>asyncio</span>.<span>run</span>(<span>main</span>())</pre></div>
<p dir="auto">Pyper provides an elegant abstraction of the execution of each task, allowing you to focus on building out the <strong>logical</strong> functions of your program. In the <code>main</code> function:</p>
<ul dir="auto">
<li><code>pipeline</code> defines a function; this takes the parameters of its first task (<code>get_data</code>) and yields each output from its last task (<code>step3</code>)</li>
<li>Tasks are piped together using the <code>|</code> operator (motivated by Unix&#39;s pipe operator) as a syntactic representation of passing inputs/outputs between tasks.</li>
</ul>
<p dir="auto">In the pipeline, we are executing three different types of work:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>task(step1, workers=20)</code> spins up 20 <code>asyncio.Task</code>s to handle asynchronous IO-bound work</p>
</li>
<li>
<p dir="auto"><code>task(step2, workers=20)</code> spins up 20 <code>threads</code> to handle synchronous IO-bound work</p>
</li>
<li>
<p dir="auto"><code>task(step3, workers=20, multiprocess=True)</code> spins up 20 <code>processes</code> to handle synchronous CPU-bound work</p>
</li>
</ul>
<p dir="auto"><code>task</code> acts as one intuitive API for unifying the execution of each different type of function.</p>
<p dir="auto">Each task has workers that submit outputs to the next task within the pipeline via queue-based data structures; this is the mechanism underpinning how concurrency and parallelism are achieved. See the <a href="https://pyper-dev.github.io/pyper/docs/UserGuide/BasicConcepts" rel="nofollow">docs</a> for a breakdown of what a pipeline looks like under the hood.</p>
<hr/>

<details>
<summary>See a non-async example</summary>
</details>

<p dir="auto">To explore more of Pyper&#39;s features, see some further <a href="https://pyper-dev.github.io/pyper/docs/Examples" rel="nofollow">examples</a></p>

<p dir="auto">Pyper is implemented in pure Python, with no sub-dependencies. It is built on top of the well-established built-in Python modules:</p>
<ul dir="auto">
<li><a href="https://docs.python.org/3/library/threading.html" rel="nofollow">threading</a> for thread-based concurrency</li>
<li><a href="https://docs.python.org/3/library/multiprocessing.html" rel="nofollow">multiprocessing</a> for parallelism</li>
<li><a href="https://docs.python.org/3/library/asyncio.html" rel="nofollow">asyncio</a> for async-based concurrency</li>
<li><a href="https://docs.python.org/3/library/concurrent.futures.html" rel="nofollow">concurrent.futures</a> for unifying threads, processes, and async code</li>
</ul>

<p dir="auto">This project is licensed under the terms of the MIT license.</p>
</article></div></div>
  </body>
</html>
