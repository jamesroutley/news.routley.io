<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/sstraust/shannonmax">Original</a>
    <h1>ShannonMax: A Library to Optimize Emacs Keybindings with Information Theory</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">ShannonMax uses information theory to <strong>analyze your emacs usage</strong> and <strong>suggest better keybindings</strong>.</p>
<p dir="auto">In particular, it helps you find commands where changing the keybinding can <ins>significantly reduce the amount you type</ins>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/sstraust/shannonmax/blob/master/ExampleResults.png"><img src="https://github.com/sstraust/shannonmax/raw/master/ExampleResults.png" alt="Example Results"/></a></p>
<p dir="auto">WARNING: When using a keylogger, be careful not to log any sensitive information!</p>
<p dir="auto">Cite This:</p>
<p dir="auto">Original Talk: <a href="https://www.youtube.com/watch?v=MytPttbIUOY" rel="nofollow">https://www.youtube.com/watch?v=MytPttbIUOY</a></p>

<ol dir="auto">
<li>
<p dir="auto">Download the files <code>shannon-max.el</code>, and <code>target/emacskeys-0.1.0-SNAPSHOT-standalone.jar</code>. Put them in the same directory, somewhere in your emacs path. So the structure should look like:</p>
<div data-snippet-clipboard-copy-content="~/.emacs.d/custom/shannon-max.el
~/.emacs.d/custom/target/emacskeys-0.1.0-SNAPSHOT-standalone.jar"><pre><code>~/.emacs.d/custom/shannon-max.el
~/.emacs.d/custom/target/emacskeys-0.1.0-SNAPSHOT-standalone.jar
</code></pre></div>
<p dir="auto">And you should have something in your <code>.emacs</code> that looks like this:</p>
<div data-snippet-clipboard-copy-content="(add-to-list &#39;load-path &#34;~/.emacs.d/custom&#34;)
(require &#39;shannon-max)
(setq shannon-max-jar-file
  (expand-file-name &#34;~/.emacs.d/custom/target/emacskeys-0.1.0-SNAPSHOT-standalone.jar&#34;))
"><pre><code>(add-to-list &#39;load-path &#34;~/.emacs.d/custom&#34;)
(require &#39;shannon-max)
(setq shannon-max-jar-file
  (expand-file-name &#34;~/.emacs.d/custom/target/emacskeys-0.1.0-SNAPSHOT-standalone.jar&#34;))

</code></pre></div>
<p dir="auto">You&#39;ll also need to have java/the jvm available on your machine and chmod +x the jar file to make it executable.</p>
</li>
<li>
<p dir="auto">Start collecting data.</p>
<p dir="auto">Add
<code>(shannon-max-start-logger)</code> to your .emacs configuration file.</p>
<p dir="auto">After a few minutes, check the contents of <code>~/emacs-logged-keys</code> to verify the logger is working correctly.</p>
</li>
<li>
<p dir="auto">Once you have enough data, call <code>M-x shannon-max-analyze</code> to see the results!</p>
</li>
</ol>

<p dir="auto">At any time, you can call <code>M-x shannon-max-analyze</code> to see the results.</p>
<p dir="auto">In the results buffer:</p>

<p dir="auto">Shannonmax compares the <em>actual</em> length of your keybinding (e.g. &#34;x e&#34; has length 2), to the <em>theoretical</em> length of your keybinding (how long it <em>should</em> be, given how much you actually use it). We use information theory on the logged data to determine a keybinding&#39;s theoretical length.</p>
<p dir="auto">Commands you use more often should have shorter keybindings, so in general, the strategy is to rebind &#34;Keybindings that are too long&#34; to something that&#39;s shorter and more convenient. If you run out of keys on your keyboard, you can free up space by unbinding infrequently used &#34;Keybindings that are too short&#34;.</p>
<p dir="auto">You can learn more about it by watching the video here: <a href="https://www.youtube.com/watch?v=MytPttbIUOY" rel="nofollow">https://www.youtube.com/watch?v=MytPttbIUOY</a></p>

<p dir="auto"><code>shannon-max-custom-keypress-cost</code></p>
<p dir="auto">By default, shannon-max assumes every keypress costs <code>1</code>. Sequences with control characters are given an additional cost of 1 per control character.</p>
<p dir="auto">So for example:</p>
<ul dir="auto">
<li>&#34;a&#34;     Has a cost of 1</li>
<li>&#34;a b&#34;   Has a cost of 2</li>
<li>&#34;C-a&#34;   Has a cost of 2</li>
<li>&#34;C-M-a&#34; Has a cost of 3</li>
<li>&#34;C-x C-s&#34; Has a cost of 4</li>
</ul>
<p dir="auto">If you have a different view of the world, you can write your own cost function.</p>
<p dir="auto">If you create your own cost function, you&#39;ll also need to modify alphabet-size to the corresponding value.</p>
<p dir="auto"><code>shannon-max-alphabet-size </code></p>
<p dir="auto">This represents &#34;How much can I type with a single keypress?&#34;. It&#39;s used to compute the theoretical length of a given key command.</p>
<p dir="auto">For example, if you only have two keys on your keyboard, then in theory your keybindings must be very long, if you are to represent every possible command with just 2 keys. But if you have 100 keys on your keyboard, your keybindings can be very short.</p>
<p dir="auto">By default, we assume you have 52 keys on your keyboard, and every keypress costs 1.</p>
<p dir="auto">If you change your cost function, you need to calculate the correct alphabet size for your new cost-weighted &#34;keyboard&#34;. The right way to do this is by solving the characteristic function as described here: <a href="https://people.math.harvard.edu/~ctm/home/text/others/shannon/entropy/entropy.pdf" rel="nofollow">https://people.math.harvard.edu/~ctm/home/text/others/shannon/entropy/entropy.pdf</a> (page 3). I want to make this calculation more automatic, and it&#39;s planned for future work.</p>
<p dir="auto">If you&#39;re too lazy to calculate it out you can fiddle with the value until it seems right, and you should still get somewhat useful/actionable results.</p>
<p dir="auto"><code>shannon-max-filtered-commands</code></p>
<p dir="auto">A list of emacs commands to ignore from the output. By default we also filter all commands matching &#34;lambda&#34;, &#34;(&#34;, or &#34;[&#34;. This is particularly useful for removing things like the self insert command.</p>
<p dir="auto"><code>shannon-max-filter-commands-fn</code></p>
<p dir="auto">Basically does the same thing as shannon-max-filtered-commands, but as a function.</p>


<p dir="auto">Certain packages mess with the keylogger&#39;s ability to correctly log commands. In particular, shannonmax uses real-last-command and this-command-keys-vector inside of post-command-hook in order to determine what keys/commands to log. Certain packages (like ido-mode) interfere with our ability to correctly set these values. We use post(rather than pre)-command-hook so that logged keys are correctly set in god-mode.</p>
<p dir="auto">If you have feedback on how to get around this, I&#39;d love your thoughts and advice!</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">Better Support For Major Modes</h4><a id="user-content-better-support-for-major-modes" aria-label="Permalink: Better Support For Major Modes" href="#better-support-for-major-modes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Certain keybindings are only active in major/minor modes. Ideally we&#39;d compute separate keymaps for every major minor mode, but it&#39;s tricky/takes a lot of thought and care to handle this correctly in a way that&#39;s relevant and useful.</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">Support for Multi-Command Codings/Arithmetic Codings</h4><a id="user-content-support-for-multi-command-codingsarithmetic-codings" aria-label="Permalink: Support for Multi-Command Codings/Arithmetic Codings" href="#support-for-multi-command-codingsarithmetic-codings"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To get really optimal output, we&#39;d like to understand how <em>pairs</em> or sequences of commonly used emacs commands can be folded into a single keybinding</p>

<ul dir="auto">
<li>Easier Installation on MELPA</li>
<li>Better Custom UI menus for rebinding keys (rather than keymap-global-set)</li>
<li>Better support for capitalized letters</li>
</ul>
<p dir="auto">Any other thoughts? Feel free to open an issue on this Repo :D</p>
</article></div></div>
  </body>
</html>
