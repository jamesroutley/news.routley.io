<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/facebookresearch/audio2photoreal">Original</a>
    <h1>Audio2Photoreal</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">This repositiory contains a pytorch implementation of <a href="https://people.eecs.berkeley.edu/~evonne_ng/projects/audio2photoreal/" rel="nofollow">&#34;From Audio to Photoreal Embodiment: Synthesizing Humans in Conversations&#34;</a></p>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description audio2photoreal.mp4">audio2photoreal.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/17986358/293801739-5cba4079-275e-48b6-aecc-f84f3108c810.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDQ0MDY2ODQsIm5iZiI6MTcwNDQwNjM4NCwicGF0aCI6Ii8xNzk4NjM1OC8yOTM4MDE3MzktNWNiYTQwNzktMjc1ZS00OGI2LWFlY2MtZjg0ZjMxMDhjODEwLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTA0VDIyMTMwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY4MTcyYWYxZGEyYmZkYWY5NTRhMGMxN2ZiODA2MTJmNjJkZjhkNDQxYTllYTg0Y2M0YWYyMzRkYzZkNGUxNGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.e3QPMVNtRfRlPPnxHT8k_p-8D8MweuP3g3_G72O8FYE" data-canonical-src="https://private-user-images.githubusercontent.com/17986358/293801739-5cba4079-275e-48b6-aecc-f84f3108c810.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDQ0MDY2ODQsIm5iZiI6MTcwNDQwNjM4NCwicGF0aCI6Ii8xNzk4NjM1OC8yOTM4MDE3MzktNWNiYTQwNzktMjc1ZS00OGI2LWFlY2MtZjg0ZjMxMDhjODEwLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTA0VDIyMTMwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY4MTcyYWYxZGEyYmZkYWY5NTRhMGMxN2ZiODA2MTJmNjJkZjhkNDQxYTllYTg0Y2M0YWYyMzRkYzZkNGUxNGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.e3QPMVNtRfRlPPnxHT8k_p-8D8MweuP3g3_G72O8FYE" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto">This codebase provides:</p>
<ul dir="auto">
<li>train code</li>
<li>test code</li>
<li>pretrained motion models</li>
<li>access to dataset</li>
</ul>
<p dir="auto">If you use the dataset or code, please cite our <a href="https://arxiv.org/abs/2401.01885" rel="nofollow">Paper</a></p>
<div data-snippet-clipboard-copy-content="@article{ng2024audio2photoreal,
  title={From Audio to Photoreal Embodiment: Synthesizing Humans in Conversations},
  author={Ng, Evonne and Romero, Javier and Bagautdinov, Timur and Bai, Shaojie and Darrell, Trevor and Kanazawa, Angjoo and Richard, Alexander},
  journal={arXiv preprint arXiv:2401.01885},
  year={2024}
}"><pre><code>@article{ng2024audio2photoreal,
  title={From Audio to Photoreal Embodiment: Synthesizing Humans in Conversations},
  author={Ng, Evonne and Romero, Javier and Bagautdinov, Timur and Bai, Shaojie and Darrell, Trevor and Kanazawa, Angjoo and Richard, Alexander},
  journal={arXiv preprint arXiv:2401.01885},
  year={2024}
}
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-repository-contents" aria-hidden="true" tabindex="-1" href="#repository-contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Repository Contents</h3>
<ul dir="auto">
<li><a href="#quickstart"><strong>Quickstart:</strong></a> easy gradio demo that lets you record audio and render a video</li>
<li><a href="#installation"><strong>Installation:</strong></a> environment setup and installation (for more details on the rendering pipeline, please refer to <a href="https://github.com/facebookresearch/ca_body">Codec Avatar Body</a>)</li>
<li><a href="#download-data-and-models"><strong>Download data and models:</strong></a> download annotations and pre-trained models
<ul dir="auto">
<li><a href="#dataset">Dataset desc.</a>: description of dataset annotations</li>
<li><a href="#visualize-ground-truth">Visualize Dataset</a>: script for visualizing ground truth annotations</li>
<li><a href="#pretrained-models">model desc.</a>: description of pretrained models</li>
</ul>
</li>
<li><a href="#running-the-pretrained-models"><strong>Running the pretrained models:</strong></a> how to generate results files and visualize the results using the rendering pipeline.
<ul dir="auto">
<li><a href="#face-generation">Face generation</a>: commands to generate the results file for the faces</li>
<li><a href="#body-generation">Body generation</a>: commands to generate the results file for the bodies</li>
<li><a href="#visualization">Visualization</a>: how to call into the rendering api. For full details, please refer to <a href="https://github.com/facebookresearch/ca_body">this repo</a>.</li>
</ul>
</li>
<li><a href="#training-from-scratch"><strong>Training from scratch (3 models):</strong></a> scripts to get the training pipeline running from scratch for face, guide poses, and body models.
<ul dir="auto">
<li><a href="#1-face-diffusion-model">Face diffusion model</a></li>
<li><a href="#2-body-diffusion-model">Body diffusion</a></li>
<li><a href="#3-body-vq-vae">Body vq vae</a></li>
<li><a href="#4-body-guide-transformer">Body guide transformer</a></li>
</ul>
</li>
</ul>
<p dir="auto">We annotate code that you can directly copy and paste into your terminal using the ðŸ‘‡ icon.</p>

<p dir="auto">With this demo, you can record an audio clip and select the number of samples you want to generate.</p>
<p dir="auto">Make sure you have CUDA 11.7 and gcc/++ 9.0 for pytorch3d compatibility</p>
<p dir="auto">ðŸ‘‡ Install necessary components. This will do the environment configuration and install the corresponding rendering assets, prerequisite models, and pretrained models:</p>
<div data-snippet-clipboard-copy-content="conda create --name a2p_env python=3.9
conda activate a2p_env
sh demo/install.sh"><pre><code>conda create --name a2p_env python=3.9
conda activate a2p_env
sh demo/install.sh
</code></pre></div>
<p dir="auto">ðŸ‘‡ Run the demo. You can record your audio and then render corresponding results!</p>

<p dir="auto">ðŸŽ¤ First, record your audio</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebookresearch/audio2photoreal/blob/main/assets/demo1.gif"><img src="https://github.com/facebookresearch/audio2photoreal/raw/main/assets/demo1.gif" alt="" data-animated-image=""/></a></p>
<p dir="auto">âŒ› Hold tight because the rendering can take a while!</p>
<p dir="auto">You can change the number of samples (1-10) you want to generate, and download your favorite video by clicking on the download button on the top right of each video.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebookresearch/audio2photoreal/blob/main/assets/demo2.gif"><img src="https://github.com/facebookresearch/audio2photoreal/raw/main/assets/demo2.gif" alt="" data-animated-image=""/></a></p>

<p dir="auto">The code has been tested with CUDA 11.7 and python 3.9, gcc/++ 9.0</p>
<p dir="auto">ðŸ‘‡ If you haven&#39;t done so already via the demo setup, configure the environnments and download prerequisite models:</p>
<div data-snippet-clipboard-copy-content="conda create --name a2p_env python=3.9
conda activate a2p_env
pip install -r scripts/requirements.txt
sh scripts/download_prereq.sh"><pre><code>conda create --name a2p_env python=3.9
conda activate a2p_env
pip install -r scripts/requirements.txt
sh scripts/download_prereq.sh
</code></pre></div>
<p dir="auto">ðŸ‘‡ To get the rendering working, please also make sure you install <a href="https://github.com/facebookresearch/pytorch3d/blob/main/INSTALL.md">pytorch3d</a>.</p>
<div data-snippet-clipboard-copy-content="pip install &#34;git+https://github.com/facebookresearch/pytorch3d.git&#34;"><pre><code>pip install &#34;git+https://github.com/facebookresearch/pytorch3d.git&#34;
</code></pre></div>
<p dir="auto">Please see <a href="https://github.com/facebookresearch/ca_body">CA Bodies repo</a> for more details on the renderer.</p>

<p dir="auto">To download any of the datasets, you can find them at <code>https://github.com/facebookresearch/audio2photoreal/releases/download/v1.0/&lt;person_id&gt;.zip</code>, where you can replace <code>&lt;person_id&gt;</code> with any of <code>PXB184</code>, <code>RLW104</code>, <code>TXB805</code>, or <code>GQS883</code>.</p>
<div data-snippet-clipboard-copy-content="wget https://github.com/facebookresearch/audio2photoreal/releases/download/v1.0/&lt;person_id&gt;.zip
unzip &lt;person_id&gt;.zip -d dataset/
rm &lt;person_id&gt;.zip"><pre><code>wget https://github.com/facebookresearch/audio2photoreal/releases/download/v1.0/&lt;person_id&gt;.zip
unzip &lt;person_id&gt;.zip -d dataset/
rm &lt;person_id&gt;.zip
</code></pre></div>
<p dir="auto">ðŸ‘‡ To download <em>all</em> of the datasets, you can simply run the following which will download and unpack all the models.</p>
<div data-snippet-clipboard-copy-content="sh scripts/download_alldatasets.sh"><pre><code>sh scripts/download_alldatasets.sh
</code></pre></div>
<p dir="auto">Similarly, to download any of the models, you can find them at <code>http://audio2photoreal_models.berkeleyvision.org/&lt;person_id&gt;_models.tar</code>.</p>
<div data-snippet-clipboard-copy-content="# download the motion generation
wget http://audio2photoreal_models.berkeleyvision.org/&lt;person_id&gt;_models.tar
tar xvf &lt;person_id&gt;_models.tar
rm &lt;person_id&gt;_models.tar

# download the body decoder/rendering assets and place them in the right place
mkdir -p checkpoints/ca_body/data/
wget https://github.com/facebookresearch/ca_body/releases/download/v0.0.1-alpha/&lt;person_id&gt;.tar.gz
tar xvf &lt;person_id&gt;.tar.gz --directory checkpoints/ca_body/data/
rm &lt;person_id&gt;.tar.gz"><pre><code># download the motion generation
wget http://audio2photoreal_models.berkeleyvision.org/&lt;person_id&gt;_models.tar
tar xvf &lt;person_id&gt;_models.tar
rm &lt;person_id&gt;_models.tar

# download the body decoder/rendering assets and place them in the right place
mkdir -p checkpoints/ca_body/data/
wget https://github.com/facebookresearch/ca_body/releases/download/v0.0.1-alpha/&lt;person_id&gt;.tar.gz
tar xvf &lt;person_id&gt;.tar.gz --directory checkpoints/ca_body/data/
rm &lt;person_id&gt;.tar.gz
</code></pre></div>
<p dir="auto">ðŸ‘‡ You can also download all of the models with this script:</p>
<div data-snippet-clipboard-copy-content="sh scripts/download_allmodels.sh"><pre><code>sh scripts/download_allmodels.sh
</code></pre></div>
<p dir="auto">The above model script will download <em>both</em> the models for motion generation and the body decoder/rendering models. Please view the script for more details.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-dataset" aria-hidden="true" tabindex="-1" href="#dataset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dataset</h3>
<p dir="auto">Once the dataset is downloaded and unzipped (via <code>scripts/download_datasets.sh</code>), it should unfold into the following directory structure:</p>
<div data-snippet-clipboard-copy-content="|-- dataset/
    |-- PXB184/
        |-- data_stats.pth 
        |-- scene01_audio.wav
        |-- scene01_body_pose.npy
        |-- scene01_face_expression.npy
        |-- scene01_missing_face_frames.npy
        |-- ...
        |-- scene30_audio.wav
        |-- scene30_body_pose.npy
        |-- scene30_face_expression.npy
        |-- scene30_missing_face_frames.npy
    |-- RLW104/
    |-- TXB805/
    |-- GQS883/"><pre><code>|-- dataset/
    |-- PXB184/
        |-- data_stats.pth 
        |-- scene01_audio.wav
        |-- scene01_body_pose.npy
        |-- scene01_face_expression.npy
        |-- scene01_missing_face_frames.npy
        |-- ...
        |-- scene30_audio.wav
        |-- scene30_body_pose.npy
        |-- scene30_face_expression.npy
        |-- scene30_missing_face_frames.npy
    |-- RLW104/
    |-- TXB805/
    |-- GQS883/
</code></pre></div>
<p dir="auto">Each of the four participants (<code>PXB184</code>, <code>RLW104</code>, <code>TXB805</code>, <code>GQS883</code>) should have independent &#34;scenes&#34; (1 to 26 or so).
For each scene, there are 3 types of data annotations that we save.</p>
<div data-snippet-clipboard-copy-content="*audio.wav: wavefile contining the raw audio (two channels, 1600*T samples) at 48kHz; channel 0 is the audio associated with the current person, channel 1 is the audio associated with their conversational partner.

*body_pose.npy: (T x 104) array of joint angles in a kinematic skeleton. Not all of the joints are represented with 3DoF. Each 104-d vector can be used to reconstruct a full-body skeleton.

*face_expression.npy: (T x 256) array of facial codes, where each 256-d vector reconstructs a face mesh.

*missing_face_frames.npy: List of indices (t) where the facial code is missing or corrupted. 

data_stats.pth: carries the mean and std for each modality of each person."><pre><code>*audio.wav: wavefile contining the raw audio (two channels, 1600*T samples) at 48kHz; channel 0 is the audio associated with the current person, channel 1 is the audio associated with their conversational partner.

*body_pose.npy: (T x 104) array of joint angles in a kinematic skeleton. Not all of the joints are represented with 3DoF. Each 104-d vector can be used to reconstruct a full-body skeleton.

*face_expression.npy: (T x 256) array of facial codes, where each 256-d vector reconstructs a face mesh.

*missing_face_frames.npy: List of indices (t) where the facial code is missing or corrupted. 

data_stats.pth: carries the mean and std for each modality of each person.
</code></pre></div>
<p dir="auto">For the train/val/test split the indices are defined in <code>data_loaders/data.py</code> as:</p>
<div data-snippet-clipboard-copy-content="train_idx = list(range(0, len(data_dict[&#34;data&#34;]) - 6))
val_idx = list(range(len(data_dict[&#34;data&#34;]) - 6, len(data_dict[&#34;data&#34;]) - 4))
test_idx = list(range(len(data_dict[&#34;data&#34;]) - 4, len(data_dict[&#34;data&#34;])))"><pre><code>train_idx = list(range(0, len(data_dict[&#34;data&#34;]) - 6))
val_idx = list(range(len(data_dict[&#34;data&#34;]) - 6, len(data_dict[&#34;data&#34;]) - 4))
test_idx = list(range(len(data_dict[&#34;data&#34;]) - 4, len(data_dict[&#34;data&#34;])))
</code></pre></div>
<p dir="auto">for any of the four dataset participants we train on.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-visualize-ground-truth" aria-hidden="true" tabindex="-1" href="#visualize-ground-truth"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Visualize ground truth</h3>
<p dir="auto">If you&#39;ve properly installed the rendering requirements, you can then visualize the full dataset with the following command:</p>
<div data-snippet-clipboard-copy-content="python -m visualize.render_anno 
    --save_dir &lt;path/to/save/dir&gt; 
    --data_root &lt;path/to/data/root&gt; 
    --max_seq_length &lt;num&gt;"><pre><code>python -m visualize.render_anno 
    --save_dir &lt;path/to/save/dir&gt; 
    --data_root &lt;path/to/data/root&gt; 
    --max_seq_length &lt;num&gt;
</code></pre></div>
<p dir="auto">The videos will be chunked lengths according to specificed <code>--max_seq_length</code> arg, which you can specify (the default is 600).</p>
<p dir="auto">ðŸ‘‡ For example, to visualize ground truth annotations for <code>PXB184</code>, you can run the following.</p>
<div data-snippet-clipboard-copy-content="python -m visualize.render_anno --save_dir vis_anno_test --data_root dataset/PXB184 --max_seq_length 600"><pre><code>python -m visualize.render_anno --save_dir vis_anno_test --data_root dataset/PXB184 --max_seq_length 600
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-pretrained-models" aria-hidden="true" tabindex="-1" href="#pretrained-models"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Pretrained models</h3>
<p dir="auto">We train person-specific models, so each person should have an associated directory. For instance, for <code>PXB184</code>, their complete models should unzip into the following structure.</p>
<div data-snippet-clipboard-copy-content="|-- checkpoints/
    |-- diffusion/
        |-- c1_face/
            |-- args.json
            |-- model:09d.pt
        |-- c1_pose/
            |-- args.json
            |-- model:09d.pt
    |-- guide/
        |-- c1_pose/
            |-- args.json
            |-- checkpoints/
                |-- iter-:07d.pt
    |-- vq/
        |-- c1_pose/
            |-- args.json
            |-- net_iter:06d.pth"><pre><code>|-- checkpoints/
    |-- diffusion/
        |-- c1_face/
            |-- args.json
            |-- model:09d.pt
        |-- c1_pose/
            |-- args.json
            |-- model:09d.pt
    |-- guide/
        |-- c1_pose/
            |-- args.json
            |-- checkpoints/
                |-- iter-:07d.pt
    |-- vq/
        |-- c1_pose/
            |-- args.json
            |-- net_iter:06d.pth
</code></pre></div>
<p dir="auto">There are 4 models for each person and each model has an associated <code>args.json</code>.</p>
<ol dir="auto">
<li>a face diffusion model that outputs 256 facial codes conditioned on audio</li>
<li>a pose diffusion model that outputs 104 joint rotations conditioned on audio and guide poses</li>
<li>a guide vq pose model that outputs vq tokens conditioned on audio at 1 fps</li>
<li>a vq encoder-decoder model that vector quantizes the continuous 104-d pose space.</li>
</ol>

<p dir="auto">To run the actual models, you will need to run the pretrained models and generate the associated results files before visualizing.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-face-generation" aria-hidden="true" tabindex="-1" href="#face-generation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Face generation</h3>
<p dir="auto">To generate the results file for the face,</p>
<div data-snippet-clipboard-copy-content="python -m sample.generate 
    --model_path &lt;path/to/model&gt; 
    --num_samples &lt;xsamples&gt; 
    --num_repetitions &lt;xreps&gt; 
    --timestep_respacing ddim500 
    --guidance_param 10.0"><pre><code>python -m sample.generate 
    --model_path &lt;path/to/model&gt; 
    --num_samples &lt;xsamples&gt; 
    --num_repetitions &lt;xreps&gt; 
    --timestep_respacing ddim500 
    --guidance_param 10.0
</code></pre></div>
<p dir="auto">The <code>&lt;path/to/model&gt;</code> should be the path to the diffusion model that is associated with generating the face.
E.g. for participant <code>PXB184</code>, the path might be <code>./checkpoints/diffusion/c1_face/model000155000.pt</code>
The other parameters are:</p>
<div data-snippet-clipboard-copy-content="--num_samples: number of samples to generate. To sample the full dataset, use 56 (except for TXB805, whcih is 58).
--num_repetitions: number of times to repeat the sampling, such that total number of sequences generated is (num_samples * num_repetitions). 
--timestep_respacing: how many diffusion steps to take. Format will always be ddim&lt;number&gt;.
--guidance_param: how influential the conditioning is on the results. I usually use range 2.0-10.0, and tend towards higher for the face."><pre><code>--num_samples: number of samples to generate. To sample the full dataset, use 56 (except for TXB805, whcih is 58).
--num_repetitions: number of times to repeat the sampling, such that total number of sequences generated is (num_samples * num_repetitions). 
--timestep_respacing: how many diffusion steps to take. Format will always be ddim&lt;number&gt;.
--guidance_param: how influential the conditioning is on the results. I usually use range 2.0-10.0, and tend towards higher for the face.
</code></pre></div>
<p dir="auto">ðŸ‘‡ A full example of running the face model for <code>PXB184</code> with the provided pretrained models would then be:</p>
<div data-snippet-clipboard-copy-content="python -m sample.generate --model_path checkpoints/diffusion/c1_face/model000155000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0"><pre><code>python -m sample.generate --model_path checkpoints/diffusion/c1_face/model000155000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0
</code></pre></div>
<p dir="auto">This generates 10 samaples from the dataset 1 time. The output results file will be saved to:
<code>./checkpoints/diffusion/c1_face/samples_c1_face_000155000_seed10_/results.npy</code></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-body-generation" aria-hidden="true" tabindex="-1" href="#body-generation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Body generation</h3>
<p dir="auto">To generate the corresponding body, it will be very similar to generating the face, except now we have to feed in the model for generating the guide poses as well.</p>
<div data-snippet-clipboard-copy-content="python -m sample.generate 
    --model_path &lt;path/to/model&gt; 
    --resume_trans &lt;path/to/guide/model&gt; 
    --num_samples &lt;xsamples&gt; 
    --num_repetitions &lt;xreps&gt; 
    --timestep_respacing ddim500 
    --guidance_param 10.0"><pre><code>python -m sample.generate 
    --model_path &lt;path/to/model&gt; 
    --resume_trans &lt;path/to/guide/model&gt; 
    --num_samples &lt;xsamples&gt; 
    --num_repetitions &lt;xreps&gt; 
    --timestep_respacing ddim500 
    --guidance_param 10.0
</code></pre></div>
<p dir="auto">ðŸ‘‡ Here, <code>&lt;path/to/guide/model&gt;</code> should point to the guide transformer. The full command would be:</p>
<div data-snippet-clipboard-copy-content="python -m sample.generate --model_path checkpoints/diffusion/c1_pose/model000340000.pt --resume_trans checkpoints/guide/c1_pose/checkpoints/iter-0100000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0"><pre><code>python -m sample.generate --model_path checkpoints/diffusion/c1_pose/model000340000.pt --resume_trans checkpoints/guide/c1_pose/checkpoints/iter-0100000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0
</code></pre></div>
<p dir="auto">Similarly, the output will be saved to:
<code>./checkpoints/diffusion/c1_pose/samples_c1_pose_000340000_seed10_guide_iter-0100000.pt/results.npy</code></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-visualization" aria-hidden="true" tabindex="-1" href="#visualization"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Visualization</h3>
<p dir="auto">On the body generation side of things, you can also optionally pass in the <code>--plot</code> flag in order to render out the photorealistic avatar. You will also need to pass in the corresponding generated face codes with the <code>--face_codes</code> flag.
Optionally, if you already have the poses precomputed, you an also pass in the generated body with the <code>--pose_codes</code> flag.
This will save videos in the same directory as where the body&#39;s <code>results.npy</code> is stored.</p>
<p dir="auto">ðŸ‘‡ An example of the full command with <em>the three new flags added is</em>:</p>
<div data-snippet-clipboard-copy-content="python -m sample.generate --model_path checkpoints/diffusion/c1_pose/model000340000.pt --resume_trans checkpoints/guide/c1_pose/checkpoints/iter-0100000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0 --face_codes ./checkpoints/diffusion/c1_face/samples_c1_face_000155000_seed10_/results.npy --pose_codes ./checkpoints/diffusion/c1_pose/samples_c1_pose_000340000_seed10_guide_iter-0100000.pt/results.npy --plot"><pre><code>python -m sample.generate --model_path checkpoints/diffusion/c1_pose/model000340000.pt --resume_trans checkpoints/guide/c1_pose/checkpoints/iter-0100000.pt --num_samples 10 --num_repetitions 5 --timestep_respacing ddim500 --guidance_param 10.0 --face_codes ./checkpoints/diffusion/c1_face/samples_c1_face_000155000_seed10_/results.npy --pose_codes ./checkpoints/diffusion/c1_pose/samples_c1_pose_000340000_seed10_guide_iter-0100000.pt/results.npy --plot
</code></pre></div>
<p dir="auto">The remaining flags can be the same as before. For the actual rendering api, please see <a href="https://github.com/facebookresearch/ca_body">Codec Avatar Body</a> for installation etc.
<em>Important: in order to visualize the full photorealistic avatar, you will need to run the face codes first, then pass them into the body generation code.</em> It will not work if you try to call generate with <code>--plot</code> for the face codes.</p>

<p dir="auto">There are four possible models you will need to train: 1) the face diffusion model, 2) the body diffusion model, 3) the body vq vae, 4) the body guide transformer.
The only dependency is that 3) is needed for 4). All other models can be trained in parallel.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-1-face-diffusion-model" aria-hidden="true" tabindex="-1" href="#1-face-diffusion-model"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>1) Face diffusion model</h3>
<p dir="auto">To train the face model, you will need to run the following script:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_diffusion 
    --save_dir &lt;path/to/save/dir&gt;
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --dataset social  
    --data_format face 
    --layers 8 
    --heads 8 
    --timestep_respacing &#39;&#39;
    --max_seq_length 600"><pre><code>python -m train.train_diffusion 
    --save_dir &lt;path/to/save/dir&gt;
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --dataset social  
    --data_format face 
    --layers 8 
    --heads 8 
    --timestep_respacing &#39;&#39;
    --max_seq_length 600
</code></pre></div>
<p dir="auto">Importantly, a few of the flags are as follows:</p>
<div data-snippet-clipboard-copy-content="--save_dir: path to directory where all outputs are stored
--data_root: path to the directory of where to load the data from
--dataset: name of dataset to load; right now we only support the &#39;social&#39; dataset
--data_format: set to &#39;face&#39; for the face, as opposed to pose
--timestep_respacing: set to &#39;&#39; which does the default spacing of 1k diffusion steps
--max_seq_length: the maximum number of frames for a given sequence to train on"><pre><code>--save_dir: path to directory where all outputs are stored
--data_root: path to the directory of where to load the data from
--dataset: name of dataset to load; right now we only support the &#39;social&#39; dataset
--data_format: set to &#39;face&#39; for the face, as opposed to pose
--timestep_respacing: set to &#39;&#39; which does the default spacing of 1k diffusion steps
--max_seq_length: the maximum number of frames for a given sequence to train on
</code></pre></div>
<p dir="auto">ðŸ‘‡ A full example for training on person <code>PXB184</code> is:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_diffusion --save_dir checkpoints/diffusion/c1_face_test --data_root ./dataset/PXB184/ --batch_size 4 --dataset social --data_format face --layers 8 --heads 8 --timestep_respacing &#39;&#39; --max_seq_length 600"><pre><code>python -m train.train_diffusion --save_dir checkpoints/diffusion/c1_face_test --data_root ./dataset/PXB184/ --batch_size 4 --dataset social --data_format face --layers 8 --heads 8 --timestep_respacing &#39;&#39; --max_seq_length 600
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-2-body-diffusion-model" aria-hidden="true" tabindex="-1" href="#2-body-diffusion-model"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>2) Body diffusion model</h3>
<p dir="auto">Training the body model is similar to the face model, but with the following additional parameters</p>
<div data-snippet-clipboard-copy-content="python -m train.train_diffusion 
    --save_dir &lt;path/to/save/dir&gt; 
    --data_root &lt;path/to/data/root&gt;
    --lambda_vel &lt;num&gt;
    --batch_size &lt;bs&gt; 
    --dataset social 
    --add_frame_cond 1 
    --data_format pose 
    --layers 6 
    --heads 8 
    --timestep_respacing &#39;&#39; 
    --max_seq_length 600"><pre><code>python -m train.train_diffusion 
    --save_dir &lt;path/to/save/dir&gt; 
    --data_root &lt;path/to/data/root&gt;
    --lambda_vel &lt;num&gt;
    --batch_size &lt;bs&gt; 
    --dataset social 
    --add_frame_cond 1 
    --data_format pose 
    --layers 6 
    --heads 8 
    --timestep_respacing &#39;&#39; 
    --max_seq_length 600
</code></pre></div>
<p dir="auto">The flags that differ from the face training are as follows:</p>
<div data-snippet-clipboard-copy-content="--lambda_vel: additional auxilary loss for training with velocity
--add_frame_cond: set to &#39;1&#39; for 1 fps. if not specified, it will default to 30 fps.
--data_format: set to &#39;pose&#39; for the body, as opposed to face"><pre><code>--lambda_vel: additional auxilary loss for training with velocity
--add_frame_cond: set to &#39;1&#39; for 1 fps. if not specified, it will default to 30 fps.
--data_format: set to &#39;pose&#39; for the body, as opposed to face
</code></pre></div>
<p dir="auto">ðŸ‘‡ A full example for training on person <code>PXB184</code> is:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_diffusion --save_dir checkpoints/diffusion/c1_pose_test --data_root ./dataset/PXB184/ --lambda_vel 2.0 --batch_size 4 --dataset social --add_frame_cond 1 --data_format pose --layers 6 --heads 8 --timestep_respacing &#39;&#39; --max_seq_length 600"><pre><code>python -m train.train_diffusion --save_dir checkpoints/diffusion/c1_pose_test --data_root ./dataset/PXB184/ --lambda_vel 2.0 --batch_size 4 --dataset social --add_frame_cond 1 --data_format pose --layers 6 --heads 8 --timestep_respacing &#39;&#39; --max_seq_length 600
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-3-body-vq-vae" aria-hidden="true" tabindex="-1" href="#3-body-vq-vae"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>3) Body VQ VAE</h3>
<p dir="auto">To train a vq encoder-decoder, you will need to run the following script:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_vq 
    --out_dir &lt;path/to/out/dir&gt; 
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --lr 1e-3 
    --code_dim 1024 
    --output_emb_width 64 
    --depth 4 
    --dataname social 
    --loss_vel 0.0 
    --add_frame_cond 1 
    --data_format pose 
    --max_seq_length 600"><pre><code>python -m train.train_vq 
    --out_dir &lt;path/to/out/dir&gt; 
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --lr 1e-3 
    --code_dim 1024 
    --output_emb_width 64 
    --depth 4 
    --dataname social 
    --loss_vel 0.0 
    --add_frame_cond 1 
    --data_format pose 
    --max_seq_length 600
</code></pre></div>
<p dir="auto">ðŸ‘‡ For person <code>PXB184</code>, it would be:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_vq --out_dir checkpoints/vq/c1_vq_test --data_root ./dataset/PXB184/ --lr 1e-3 --code_dim 1024 --output_emb_width 64 --depth 4 --dataname social --loss_vel 0.0 --data_format pose --batch_size 4 --add_frame_cond 1 --max_seq_length 600"><pre><code>python -m train.train_vq --out_dir checkpoints/vq/c1_vq_test --data_root ./dataset/PXB184/ --lr 1e-3 --code_dim 1024 --output_emb_width 64 --depth 4 --dataname social --loss_vel 0.0 --data_format pose --batch_size 4 --add_frame_cond 1 --max_seq_length 600
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-4-body-guide-transformer" aria-hidden="true" tabindex="-1" href="#4-body-guide-transformer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>4) Body guide transformer</h3>
<p dir="auto">Once you have the vq trained from 3) you can then pass it in to train the body guide pose transformer:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_guide 
    --out_dir &lt;path/to/out/dir&gt;
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --resume_pth &lt;path/to/vq/model&gt;
    --add_frame_cond 1 
    --layers 6 
    --lr 2e-4 
    --gn 
    --dim 64 "><pre><code>python -m train.train_guide 
    --out_dir &lt;path/to/out/dir&gt;
    --data_root &lt;path/to/data/root&gt;
    --batch_size &lt;bs&gt;
    --resume_pth &lt;path/to/vq/model&gt;
    --add_frame_cond 1 
    --layers 6 
    --lr 2e-4 
    --gn 
    --dim 64 
</code></pre></div>
<p dir="auto">ðŸ‘‡ For person <code>PXB184</code>, it would be:</p>
<div data-snippet-clipboard-copy-content="python -m train.train_guide --out_dir checkpoints/guide/c1_trans_test --data_root ./dataset/PXB184/ --batch_size 4 --resume_pth checkpoints/vq/c1_vq_test/net_iter300000.pth --add_frame_cond 1 --layers 6 --lr 2e-4 --gn --dim 64"><pre><code>python -m train.train_guide --out_dir checkpoints/guide/c1_trans_test --data_root ./dataset/PXB184/ --batch_size 4 --resume_pth checkpoints/vq/c1_vq_test/net_iter300000.pth --add_frame_cond 1 --layers 6 --lr 2e-4 --gn --dim 64
</code></pre></div>
<p dir="auto">After training these 4 models, you can now follow the <a href="#running-the-pretrained-models">&#34;Running the pretrained models&#34;</a> section to generate samples and visualize results.</p>
<p dir="auto">You can also visualize the corresponding ground truth sequences by passing in the <code>--render_gt</code> flag.</p>

<p dir="auto">The code and dataset are released under <a href="https://github.com/facebookresearch/audio2photoreal/blob/main/LICENSE">CC-NC 4.0 International license</a>.</p>
</article>
          </div></div>
  </body>
</html>
