<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/PollRobots/scheme">Original</a>
    <h1>Show HN: A an R7RS Scheme Implementation in WebAssembly</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pollrobots/scheme/actions/workflows/node.js.yml/badge.svg"><img src="https://github.com/pollrobots/scheme/actions/workflows/node.js.yml/badge.svg" alt="Node.js CI"/></a></p>

<p dir="auto">An R7RS Scheme implemented in WebAssembly</p>
<p dir="auto">A partial implementation of <a href="https://small.r7rs.org/" rel="nofollow">r7rs scheme</a>, written
entirely in WebAssembly using the WebAssembly Text format. The only external
imports are for IO (<code>read</code>, <code>write</code>, and <code>readFile</code>), unicode (I have an
import that reads information about 256 code-point blocks to enable case
operations etc.), and process control (<code>exit</code>).</p>
<p dir="auto">You can try it out at <a href="https://pollrobots.com/scheme/scheme.wasm.html" rel="nofollow">pollrobots.com/scheme/scheme.wasm.html</a> — apologies for the huge download. I need to fix
bundling.</p>
<h2 dir="auto"><a id="user-content-how-complete-is-it" aria-hidden="true" href="#how-complete-is-it"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How Complete Is It?</h2>
<p dir="auto">The aim is to write a spec complete version of <code>r7rs</code>, although I may skip
some of the optional features.</p>
<h3 dir="auto"><a id="user-content-what-is-done-so-far" aria-hidden="true" href="#what-is-done-so-far"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What is done so far</h3>
<ul>
<li> Numerics
<ul>
<li> Integers (arbitrary precision)</li>
<li> Real numbers (double precision)</li>
<li> Rationals</li>
<li> Complex Numbers</li>
</ul>
</li>
<li> Booleans</li>
<li> Strings</li>
<li> Characters</li>
<li> Pairs and Lists</li>
<li> Vectors</li>
<li> Bytevectors</li>
<li> Values</li>
<li> Tail call optimization — internally <code>eval</code> uses a continuation passing
style, so TCO comes for free.</li>
<li> <code>call/cc</code> and exceptions</li>
<li> Macros
<ul>
<li> <code>define-syntax</code>, <code>syntax-rules</code>, <code>syntax-error</code></li>
<li> Hygienic over <code>let</code>, <code>let*</code>, <code>letrec</code>, <code>letrec*</code>, and <code>lambda</code></li>
<li> <code>define-let</code>, <code>define-letrec</code></li>
</ul>
</li>
<li> Modules</li>
<li> Ports</li>
<li> <code>dynamic-wind</code></li>
<li> Everything else</li>
</ul>
<h2 dir="auto"><a id="user-content-credits" aria-hidden="true" href="#credits"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Credits</h2>
<p dir="auto">Where practical everything has been implemented from scratch, but there
are places where it either wasn&#39;t practical, or where I tried and failed
to implement them myself, so credit is due to:</p>
<ul dir="auto">
<li><strong>xxHash</strong>:
It&#39;s probably overkill, but the hashing algorithm used for hashtables,
which are in turn used for environments and interning symbols, is xxHash
translated from the C++ implementation at
<a href="https://github.com/Cyan4973/xxHash">github.com/Cyan4973/xxHash</a></li>
<li><strong>string-&gt;real</strong>:
Strings are converted to real numbers using <em>Algorithm M</em> from
&#34;How to Read Floating Point Numbers Accurately&#34;,
<a href="https://www.khoury.northeastern.edu/people/william-d-clinger/" rel="nofollow">William D Clinger</a> 1990. Which is conveniently expressed in scheme in the original
<a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.45.4152&amp;rep=rep1&amp;type=pdf" rel="nofollow">paper</a></li>
<li><strong>real-&gt;string</strong>:
Real numbers are converted to strings using <em>Grisu 2</em> by
<a href="https://florian.loitsch.com/home" rel="nofollow">Florian Loitsch</a>.
This was translated from C++ found at <a href="https://github.com/romange/Grisu">github.com/romange/Grisu</a></li>
</ul>
<p dir="auto">Additionally inspiration came from a couple of places</p>
<ul dir="auto">
<li><strong>Lispy</strong>: <a href="https://norvig.com" rel="nofollow">Peter Norvig&#39;s</a> article
<a href="https://norvig.com/lispy.html" rel="nofollow">(How to Write a (Lisp) Interpreter (in Python))</a>
was a critical source of inspiration.</li>
<li><strong>EPLAiP</strong>: Nearly a decade ago a <span title="Hi Ashley!">friend</span> gave
me a copy of
<a href="https://billhails.net/EPLAiP.pdf" rel="nofollow">Exploring Programming Language Architecture in Perl</a>
by <a href="https://billhails.net" rel="nofollow">Bill Hails</a>. Definitely worth reading regardless of
your language of choice (I haven&#39;t written PERL this millenium).</li>
</ul>
</article>
        </div></div>
  </body>
</html>
