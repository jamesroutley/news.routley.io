<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.kravchyk.com/adding-type-safety-to-object-ids-typescript/">Original</a>
    <h1>Adding type safety to object IDs in TypeScript</h1>
    
    <div id="readability-page-1" class="page"><div id="page"><div id="content"><div id="primary"><main id="main"><article id="post-82" itemtype="https://schema.org/CreativeWork" itemscope=""><div>
<div itemprop="text">
<div><figure><img fetchpriority="high" decoding="async" width="1728" height="676" src="https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example.png" alt="A code snippet demonstrating type safety of IDs in TypeScript" srcset="https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example.png 1728w, https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example-300x117.png 300w, https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example-1024x401.png 1024w, https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example-768x300.png 768w, https://www.kravchyk.com/wp-content/uploads/2024/01/typescript_id_types_example-1536x601.png 1536w" sizes="(max-width: 1728px) 100vw, 1728px"/></figure></div>

<p>I was creating a type for an options object of a function, one of the options properties would accept an ID of the item (string based UUID) or a special value, i.e. <code>&#39;currentNode&#39;</code>.</p>
<p>Initially I would come up with something like this:</p>
<pre aria-describedby="shcb-language-1" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><span><code><span><span><span>interface</span> InsertOptions {
</span></span><span><span>  
</span></span><span><span>  target: <span>string</span> | <span>&#39;currentNode&#39;</span>
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span><span><span>function</span> <span>insert</span>(<span>options: InsertOptions</span>): <span>void</span> </span>{
</span></span><span><span>  
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span>insert({ target: <span>&#39;activeNode&#39;</span> }); 
</span></span></code></span><small id="shcb-language-1"><span>Code language:</span> <span>TypeScript</span> <span>(</span><span>typescript</span><span>)</span></small></pre>
<p><a href="https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgJIgM7TAeQA5jAD2myA3gFDLID0Nam2yoYRyYAFisJALbIAjAJ7MAJsiJR2XZIkIA3bnyrs4UAOYQwALmQYwUUOuQAfZAHIEAVyhQI4AHJFREcxQC+FCjCsgEhEmZGKDAACiICYkxddCwQ-ADMAEpdeSJgcUpqOg8vUDiwslUNLV1zOWBFJxdzZHckgG5aegAFOAwMI1lkBAAbCDVekV8WexdxCMTkeTheqxQAd2Be3uQQIjBkOwwrXs3QWRBkaChJIA" data-type="link" data-id="https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgJIgM7TAeQA5jAD2myA3gFDLID0Nam2yoYRyYAFisJALbIAjAJ7MAJsiJR2XZIkIA3bnyrs4UAOYQwALmQYwUUOuQAfZAHIEAVyhQI4AHJFREcxQC+FCjCsgEhEmZGKDAACiICYkxddCwQ-ADMAEpdeSJgcUpqOg8vUDiwslUNLV1zOWBFJxdzZHckgG5aegAFOAwMI1lkBAAbCDVekV8WexdxCMTkeTheqxQAd2Be3uQQIjBkOwwrXs3QWRBkaChJIA" target="_blank" rel="noreferrer noopener">Try It</a></p>
<p>There are 2 problems with this approach:</p>
<ul>
<li>No autotype hints for currentNode</li>
<li>No type checking for the special option since <code>curentNode</code> is a also just a <code>string</code>.</li>
</ul>
<p><code>type NodeId = string</code> would hardly help since it’s just an alias for string and is the same from type checking perspective.</p>
<p>One way to solve this would be to wrap the special option in an object:</p>
<pre aria-describedby="shcb-language-2" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><span><code><span>interface</span> InsertOptions {
  target: <span>string</span> | { target: <span>&#39;activeNode&#39;</span>}
}

<span><span>function</span> <span>insert</span>(<span>options: InsertOptions</span>): <span>void</span> </span>{
  
}

insert({ target: <span>&#39;KQER3XVBdD3u&#39;</span> }); 
insert({ target: { target: <span>&#39;activeNode&#39;</span> } }); 
insert({ target: { target: <span>&#39;currentNode&#39;</span> } }); </code></span><small id="shcb-language-2"><span>Code language:</span> <span>TypeScript</span> <span>(</span><span>typescript</span><span>)</span></small></pre>
<p><a href="https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgJIgM7TAeQA5jAD2myA3gFDLJhxQDmEYAXMhmFKPcgD7k11GLZAHJEhAG4QAckQAmEEQF8KKijACuIBIRLJQWKGAAURAsUyt0h3OZIYAlKwlFgc8lWQB6L6ooUDbGMyAQYmVhEAaQBFAFEAJQBmAA0ANQAhOQARRI0RZCUHAG5vL2RUuAAbNwDMIJDaMOEGwXDRcWApWQV8pQLi0vKqmsCjYNChVhamiIQNKCgIcG7FAv6Sn2RYhaIoIA" data-type="link" data-id="https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgJIgM7TAeQA5jAD2myA3gFDLJhxQDmEYAXMhmFKPcgD7k11GLZAHJEhAG4QAckQAmEEQF8KKijACuIBIRLJQWKGAAURAsUyt0h3OZIYAlKwlFgc8lWQB6L6ooUDbGMyAQYmVhEAaQBFAFEAJQBmAA0ANQAhOQARRI0RZCUHAG5vL2RUuAAbNwDMIJDaMOEGwXDRcWApWQV8pQLi0vKqmsCjYNChVhamiIQNKCgIcG7FAv6Sn2RYhaIoIA" target="_blank" rel="noreferrer noopener">Try It</a></p>
<p>This is going to work, both type checking and autoexpand suggestion will work, but it does not look nice at all…</p>
<p>Fortunately TypeScript has <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html" target="_blank" rel="noreferrer noopener">template literal types</a> since version 4.1. It’s possible to use them to create a type that only an ID would have, like:</p>
<pre aria-describedby="shcb-language-3" data-shcb-language-name="JavaScript" data-shcb-language-slug="javascript"><span><code>type NodeId = <span>`node_<span>${string}</span>`</span>
</code></span><small id="shcb-language-3"><span>Code language:</span> <span>JavaScript</span> <span>(</span><span>javascript</span><span>)</span></small></pre>
<p>So now we can do:</p>
<pre aria-describedby="shcb-language-4" data-shcb-language-name="TypeScript" data-shcb-language-slug="typescript"><span><code><span>interface</span> InsertOptions {
  target: NodeId | <span>&#39;activeNode&#39;</span>
}

<span><span>function</span> <span>insert</span>(<span>options: InsertOptions</span>): <span>void</span> </span>{
  
}

insert({ target: <span>&#39;activeNode&#39;</span> }); 
insert({ target: <span>&#39;node_KQER3XVBdD3u&#39;</span> }); 
insert({ target: <span>&#39;currentNode&#39;</span> }); </code></span><small id="shcb-language-4"><span>Code language:</span> <span>TypeScript</span> <span>(</span><span>typescript</span><span>)</span></small></pre>
<p><a href="https://www.typescriptlang.org/play?#code/C4TwDgpgBAcg9gEwgSQVAvFABgO0RAfQBIBvAZ2ACcBLHAcwF8sAoZ24CSgMwEMBjaMhxlOwAPJhg1OMKglmUKMB6U6EYAC5Y+VFAA+UAOT8pANwjwkh5g1ZcArjj5SZUWiMrAAFHEnThWkIe4n4yZACUWqZw1GjyigD0CTas7qJeJEoqappGJtTmlhCGUAzhANxQSVAAajwANrFswumZyqrqWoZ4SAQA0gCKAKIASgDMABo1AEIIACJj9iVlldV1jQjNwRlZHbmGfPaUlBA4wEXLFVUJUEPHcJRAA" data-type="link" data-id="https://www.typescriptlang.org/play?#code/C4TwDgpgBAcg9gEwgSQVAvFABgO0RAfQBIBvAZ2ACcBLHAcwF8sAoZ24CSgMwEMBjaMhxlOwAPJhg1OMKglmUKMB6U6EYAC5Y+VFAA+UAOT8pANwjwkh5g1ZcArjj5SZUWiMrAAFHEnThWkIe4n4yZACUWqZw1GjyigD0CTas7qJeJEoqappGJtTmlhCGUAzhANxQSVAAajwANrFswumZyqrqWoZ4SAQA0gCKAKIASgDMABo1AEIIACJj9iVlldV1jQjNwRlZHbmGfPaUlBA4wEXLFVUJUEPHcJRAA" target="_blank" rel="noreferrer noopener">Try It</a></p>
<p>Now the target type is not string anymore and TS can see the difference between the ID and the special options, meaning that the special options are type checked and will show in autotype suggestions.</p>
<p>This does not only solve the 2 problems mentioned, but also introduces type safety of IDs in TypeScript. Each type of item can have a different type of ID assigned, I.e.</p>
<pre aria-describedby="shcb-language-5" data-shcb-language-name="JavaScript" data-shcb-language-slug="javascript"><span><code>type UserId = <span>`user_<span>${string}</span>`</span>;
type GroupId = <span>`group_<span>${string}</span>`</span>;

<span><span>function</span> <span>updateUser</span>(<span>id: UserId</span>): <span>void</span> </span>{
  
}


declare <span>const</span> id: GroupId;

updateUser(id); </code></span><small id="shcb-language-5"><span>Code language:</span> <span>JavaScript</span> <span>(</span><span>javascript</span><span>)</span></small></pre>
<p><a data-type="link" data-id="https://www.typescriptlang.org/play?#code/C4TwDgpgBAqgzhATgSQCZQLxQAYFcGID6AJAN5zCICWAdgOYC+2A3AFCiRQDiiA9rmDSYcdPgJLlKtRi1asAZrhoBjYFV40oA1AENgEeEgAUVVAC5YBNAEoLAN16mopVlCgB6d6wZzPUZAC2OnS00HC8ARAA7gAWSNC0UMBxUMq8qNAg-FAxOnbQOppOdjrUOgBGADbQyXpQVHBQOtxigqisGcqVpdBpNBT15i38bWys2noGBCao1swe7lAAooh8iBYAgoh0uJE0wFC88kng0ADk2KIjEhTU9Exn9Y00vAc6cHBUdDQV1Um8UDApR0kX0iEOxw45zwBBuUnu2DOQA" href="https://www.typescriptlang.org/play?#code/C4TwDgpgBAqgzhATgSQCZQLxQAYFcGID6AJAN5zCICWAdgOYC+2A3AFCiRQDiiA9rmDSYcdPgJLlKtRi1asAZrhoBjYFV40oA1AENgEeEgAUVVAC5YBNAEoLAN16mopVlCgB6d6wZzPUZAC2OnS00HC8ARAA7gAWSNC0UMBxUMq8qNAg-FAxOnbQOppOdjrUOgBGADbQyXpQVHBQOtxigqisGcqVpdBpNBT15i38bWys2noGBCao1swe7lAAooh8iBYAgoh0uJE0wFC88kng0ADk2KIjEhTU9Exn9Y00vAc6cHBUdDQV1Um8UDApR0kX0iEOxw45zwBBuUnu2DOQA" target="_blank" rel="noreferrer noopener">Try It</a></p>
<p>I have been using it for a year now and implementing type safe IDs  has already prevented me a few times already from mixing entity types.</p>
<p>The benefit of this is not just at compile time, but also at runtime. You can use this to detect the type of object by checking its ID prefix and it’s also very convenient that whenever the object pops up in the logs, you immediately know what it is just by looking at the ID.</p>
</div>
  </div></article></main></div></div></div></div>
  </body>
</html>
