<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://www.cypherspace.org/adam/hacks/lotus-nsa-key.html">Original</a>
    <h1>NSA Backdoor Key from Lotus-Notes (2002)</h1>
    
    <div id="readability-page-1" class="page">

<em>This page has also been translated into Russian <a href="http://www.designcontest.com/show/nsa-key-be">here</a></em>



<p>Before the US crypto export regulations were finally disolved the
export version of Lotus Notes used to include a key escrow / backdoor
feature called differential cryptography.  The idea was that they got
permission to export 64 bit crypto if 24 of those bits were encrypted
for the NSA&#39;s public key.  The NSA would then only have the small
matter of brute-forcing the remaining 40 bits to get the plaintext,
and everyone else would get a not-that-great 64 bit key space (which
probably already back then NSA would have had the compute power to
brute force also, only at higher cost).</p>

<p>Anyway as clearly inside the application somewhere would be an NSA
public key that the NSA had the private key for, I tried reverse
engineering it to get the public key.</p>

<p>In doing this I discovered that the NSA public key had an
organizational name of &#34;MiniTruth&#34;, and a common name of
&#34;Big Brother&#34;.  Specifically what I saw in my debugger late
one night, which was spooky for a short moment was:</p>

<block>
<b><tt>O=MiniTruth CN=Big Brother</tt></b>
</block>

<p>Literary note: for those who have not read Orwell&#39;s prescient
&#34;1984&#34; the Ministry of Truth was the agency who&#39;s job was
propaganda and suppression of truths that did not suit the malignant
fictional future government in the book, and &#34;Big Brother&#34;
was the evil shadowy leader of this government.  The whole book is <a href="http://www.george-orwell.org/1984">online here</a>.</p>

<h2>The NSA&#39;s Public Key</h2>

<p>I put this together some years after the reverse-engineering stint,
so there could be errors, but this is from my notes, the raw public
key modulus from the debugger:</p>

<block><b><tt><pre>  8D9D6213D3EF03A7 A5CEAE99B8E9FF06
  12E58ECAAB2939FE 72B41833B8B947A0
  DF8111B561CE67FB 50844623CF88338C
  E7BC80C5ECC31276 6075E13E12E956F6
  59954F68B04F0FEA B6B82EFEC4E07BD8
  4BC41FE3123AF70C 31688BCD5895BB00
</pre></tt></b></block>

<p>I figured it was in little endian format by trial and error; other
formats were easy to factor.  So the big endian hex representation is:

<block><b><tt></tt></b></block></p><b><tt><xmp>
  e = 3
  n = \
  00BB9558CD8B68310CF73A12E31FC44BD87BE0C4FE2EB8B6EA0F4FB0684F9559\
  F656E9123EE175607612C3ECC580BCE78C3388CF23468450FB67CE61B51181DF\
  A047B9B83318B472FE3929ABCA8EE51206FFE9B899AECEA5A703EFD313629D8D
</xmp></tt></b>

<p>where the modulus is 760 bits, and the public key formatted as a
PGP key is (of course I made this user id up -- you can edit it to
whatever you choose it&#39;s of course not self-signed):</p>

<block><b><tt><xmp>
Type Bits/KeyID    Date       User ID
pub   760/13629D8D 1998/10/25 Director, NSA <dirnsa@nsa.gov>

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6.3i

mQBsAzYyeuIAAAEC+LuVWM2LaDEM9zoS4x/ES9h74MT+Lri26g9PsGhPlVn2VukS
PuF1YHYSw+zFgLznjDOIzyNGhFD7Z85htRGB36BHubgzGLRy/jkpq8qO5RIG/+m4
ma7OpacD79MTYp2NAAIDtB5EaXJlY3RvciwgTlNBIDxkaXJuc2FAbnNhLmdvdj4=
=aoSi
-----END PGP PUBLIC KEY BLOCK-----
</xmp></tt></b></block>

<p>and here&#39;s what pgpacket has to say about the contents of that
key:</p>

<block><tt><b><xmp>
---------------------------
Packet Type:Public Key Packet
Length:108
Version Byte:3
Key Created:25 Oct 1998  01:12:02
Valid forever
Algorithm:1 (RSA)
N:0xBB9558CD8B68310CF73A12E31FC44BD87BE0C4FE2EB8B6EA0F4FB0684F9559F6\
56E9123EE175607612C3ECC580BCE78C3388CF23468450FB67CE61B51181DFA0\
47B9B83318B472FE3929ABCA8EE51206FFE9B899AECEA5A703EFD313629D8D
E:0x03
Key ID: 0xA703EFD313629D8D

---------------------------
Packet Type:User ID Packet
Length:30
User ID:"Director, NSA <dirnsa@nsa.gov>"
</xmp></b></tt></block>

<hr/>
<em>
Comments, html bugs to  
(<a href="http://www.cypherspace.org/adam/">Adam Back</a>) at
<a href="mailto:adam@cypherspace.org">&lt;adam@cypherspace.org&gt;</a>
</em>



</div>
  </body>
</html>
