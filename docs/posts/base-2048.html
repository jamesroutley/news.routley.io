<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/qntm/base2048">Original</a>
    <h1>Base 2048</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">Base2048 is a binary encoding optimised for transmitting data through Twitter. This JavaScript module, <code>base2048</code>, is the first implementation of this encoding. Using Base2048, up to 385 octets can fit in a single Tweet. Compare with <a href="https://github.com/qntm/base65536">Base65536</a>, which manages only 280 octets.</p>
<table>
  <thead>
    <tr>
      <th colspan="2" rowspan="2">Encoding</th>
      <th colspan="3">Efficiency</th>
      <th rowspan="2">Bytes per Tweet *</th>
    </tr>
    <tr>
      <th>UTF‑8</th>
      <th>UTF‑16</th>
      <th>UTF‑32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="5">ASCII‑constrained</td>
      <td>Unary / <a href="https://github.com/ferno/base1">Base1</a></td>
      <td>0%</td>
      <td>0%</td>
      <td>0%</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Binary</td>
      <td>13%</td>
      <td>6%</td>
      <td>3%</td>
      <td>35</td>
    </tr>
    <tr>
      <td>Hexadecimal</td>
      <td>50%</td>
      <td>25%</td>
      <td>13%</td>
      <td>140</td>
    </tr>
    <tr>
      <td>Base64</td>
      <td><strong>75%</strong></td>
      <td>38%</td>
      <td>19%</td>
      <td>210</td>
    </tr>
    <tr>
      <td>Base85 †</td>
      <td>80%</td>
      <td>40%</td>
      <td>20%</td>
      <td>224</td>
    </tr>
    <tr>
      <td rowspan="4">BMP‑constrained</td>
      <td><a href="https://github.com/ferno/hexagram-encode">HexagramEncode</a></td>
      <td>25%</td>
      <td>38%</td>
      <td>19%</td>
      <td>105</td>
    </tr>
    <tr>
      <td><a href="https://github.com/ferno/braille-encode">BrailleEncode</a></td>
      <td>33%</td>
      <td>50%</td>
      <td>25%</td>
      <td>140</td>
    </tr>
    <tr>
      <td><a href="https://github.com/qntm/base2048">Base2048</a></td>
      <td>56%</td>
      <td>69%</td>
      <td>34%</td>
      <td><strong>385</strong></td>
    </tr>
    <tr>
      <td><a href="https://github.com/ferno/base32768">Base32768</a></td>
      <td>63%</td>
      <td><strong>94%</strong></td>
      <td>47%</td>
      <td>263</td>
    </tr>
    <tr>
      <td rowspan="3">Full Unicode</td>
      <td><a href="https://github.com/keith-turner/ecoji">Ecoji</a></td>
      <td>31%</td>
      <td>31%</td>
      <td>31%</td>
      <td>175</td>
    </tr>
    <tr>
      <td><a href="https://github.com/ferno/base65536">Base65536</a></td>
      <td>56%</td>
      <td>64%</td>
      <td><strong>50%</strong></td>
      <td>280</td>
    </tr>
    <tr>
      <td><a href="https://github.com/ferno/base131072">Base131072</a> ‡</td>
      <td>53%+</td>
      <td>53%+</td>
      <td>53%</td>
      <td>297</td>
    </tr>
  </tbody>
</table>
<p dir="auto">* A Tweet can be up to 280 Unicode characters, give or take Twitter&#39;s complex &#34;weighting&#34; calculation.</p>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>

<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<div data-snippet-clipboard-copy-content="import { encode, decode } from &#39;base2048&#39;

const uint8Array = new Uint8Array([1, 2, 4, 8, 16, 32, 64, 128])
const str = encode(uint8Array)
console.log(str) // &#39;GƸOʜeҩ&#39;

const uint8Array2 = decode(str)
console.log(uint8Array2)
// [1, 2, 4, 8, 16, 32, 64, 128]"><pre><span>import</span> <span>{</span> <span>encode</span><span>,</span> <span>decode</span> <span>}</span> <span>from</span> <span>&#39;base2048&#39;</span>

<span>const</span> <span>uint8Array</span> <span>=</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>4</span><span>,</span> <span>8</span><span>,</span> <span>16</span><span>,</span> <span>32</span><span>,</span> <span>64</span><span>,</span> <span>128</span><span>]</span><span>)</span>
<span>const</span> <span>str</span> <span>=</span> <span>encode</span><span>(</span><span>uint8Array</span><span>)</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>str</span><span>)</span> <span>// &#39;GƸOʜeҩ&#39;</span>

<span>const</span> <span>uint8Array2</span> <span>=</span> <span>decode</span><span>(</span><span>str</span><span>)</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>uint8Array2</span><span>)</span>
<span>// [1, 2, 4, 8, 16, 32, 64, 128]</span></pre></div>
<h2 dir="auto"><a id="user-content-api" aria-hidden="true" href="#api"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h2>
<p dir="auto"><code>base2048</code> accepts and returns <code>Uint8Array</code>s. Note that every Node.js <code>Buffer</code> is a <code>Uint8Array</code>. A <code>Uint8Array</code> can be converted to a Node.js <code>Buffer</code> like so:</p>
<div data-snippet-clipboard-copy-content="const buffer = Buffer.from(uint8Array.buffer, uint8Array.byteOffset, uint8Array.byteLength)"><pre><span>const</span> <span>buffer</span> <span>=</span> <span>Buffer</span><span>.</span><span>from</span><span>(</span><span>uint8Array</span><span>.</span><span>buffer</span><span>,</span> <span>uint8Array</span><span>.</span><span>byteOffset</span><span>,</span> <span>uint8Array</span><span>.</span><span>byteLength</span><span>)</span></pre></div>
<h3 dir="auto"><a id="user-content-encodeuint8array" aria-hidden="true" href="#encodeuint8array"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>encode(uint8Array)</h3>
<p dir="auto">Encodes a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" rel="nofollow"><code>Uint8Array</code></a> and returns a Base2048 <code>String</code> suitable for passing through Twitter. Give or take some padding characters, the output string has 1 character per 11 bits of input.</p>
<h3 dir="auto"><a id="user-content-decodestring" aria-hidden="true" href="#decodestring"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>decode(string)</h3>
<p dir="auto">Decodes a Base2048 <code>String</code> and returns a <code>Uint8Array</code> containing the original binary data.</p>
<h2 dir="auto"><a id="user-content-rationale" aria-hidden="true" href="#rationale"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Rationale</h2>
<p dir="auto">Originally, Twitter allowed Tweets to be at most 140 characters. Discounting URLs, which have their own complex rules, Tweet length was computed as the number of Unicode code points in the Tweet — <em>not</em> the number of octets in any particular encoding of that Unicode string. In 2015, observing that most existing text-based encodings made negligible use of most of the Unicode code point space (e.g. Base64 encodes only 6 bits per character = 105 octets per Tweet), I developed <a href="https://github.com/qntm/base65536">Base65536</a>, which encodes 16 bits per character = 280 octets per Tweet.</p>
<p dir="auto">On 26 September 2017, Twitter <a href="https://blog.twitter.com/official/en_us/topics/product/2017/Giving-you-more-characters-to-express-yourself.html" rel="nofollow">announced that</a></p>
<blockquote>
<p dir="auto">we&#39;re going to try out a longer limit, 280 characters, in languages impacted by cramming (which is all except Japanese, Chinese, and Korean).</p>
</blockquote>
<p dir="auto">This statement is fairly light on usable details and/or factual accuracy. However, following some experimentation and examination of the new web client code, we now understand that maximum Tweet length is indeed 280 Unicode code points, <em>except that code points U+1100 HANGUL CHOSEONG KIYEOK upwards now count double</em>.</p>
<p dir="auto">Effectively, Twitter divides Unicode into 4,352 &#34;light&#34; code points (U+0000 to U+10FF inclusive) and 1,109,760 &#34;heavy&#34; code points (U+1100 to U+10FFFF inclusive).</p>
<p dir="auto">Base65536 <em>solely</em> uses heavy characters, which means that a new &#34;long&#34; Tweet can still only contain at most 140 characters of Base65536, encoding 280 octets. This seemed like an imperfect state of affairs to me, and so here we are.</p>
<p dir="auto">Base2048 solely uses light characters, which means a new &#34;long&#34; Tweet can contain at most 280 characters of Base2048. Base2048 is an 11-bit encoding, so those 280 characters encode 3080 bits i.e. 385 octets of data, significantly better than Base65536.</p>
<h3 dir="auto"><a id="user-content-note" aria-hidden="true" href="#note"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Note</h3>
<p dir="auto">At the time of writing, the sophisticated weighted-code point check is only carried out client-side. Server-side, the check is still a simple code point length check, now capped at 280 code points. So, by circumventing the client-side check, it&#39;s possible to send <a href="https://twitter.com/dx_test1/status/912835316679151621" rel="nofollow">280 characters of Base65536 i.e. 560 bytes of data in a single Tweet</a>.</p>
<p dir="auto">Base2048 was developed under the assumption that most people will not go to the trouble of circumventing the client-side check and/or that eventually the check will be implemented server-side as well.</p>
<h2 dir="auto"><a id="user-content-code-point-safety" aria-hidden="true" href="#code-point-safety"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Code point safety</h2>
<p dir="auto">Base2048 uses only <a href="https://qntm.org/safe" rel="nofollow">&#34;safe&#34; Unicode code points</a> (no unassigned code points, no control characters, no whitespace, no combining diacritics, ...). This guarantees that the data sent will remain intact when sent through any &#34;Unicode-clean&#34; text interface.</p>
<p dir="auto">In the available space of 4,352 light code points, there are 2,343 safe code points. For Base2048, since I felt it improved the character repertoire, I further ruled out the four &#34;Symbol&#34; General Categories, leaving 2,212 safe code points, and the &#34;Letter, Modifier&#34; General Category, leaving 2,176 safe code points. From these I chose 2<sup>11</sup> = 2048 code points for the primary repertoire and 2<sup>3</sup> = 8 additional code points to use as padding characters.</p>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">MIT</p>
</article>
          </div></div>
  </body>
</html>
