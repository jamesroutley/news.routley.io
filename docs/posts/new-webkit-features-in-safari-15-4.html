<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://webkit.org/blog/12445/new-webkit-features-in-safari-15-4/">Original</a>
    <h1>New WebKit Features in Safari 15.4</h1>
    
    <div id="readability-page-1" class="page"><div>
                <menu><menuitem><h6><label for="table-of-contents-toggle">Contents</label></h6><ul><li><a href="#html">HTML</a></li><li><a href="#css">CSS</a></li><li><a href="#web-apis">Web APIs</a></li><li><a href="#javascript">JavaScript</a></li><li><a href="#web-apps">Web Apps</a></li><li><a href="#media">Media</a></li><li><a href="#privacy">Privacy</a></li><li><a href="#security">Security</a></li><li><a href="#wkwebview">WKWebView</a></li><li><a href="#safari-web-extensions">Safari Web Extensions</a></li><li><a href="#web-inspector">Web Inspector</a></li><li><a href="#feedback">Feedback</a></li><li><a href="#and-more">And More</a></li></ul></menuitem></menu>                
                <p>With over 70 additions to WebKit, Safari 15.4 is packed with new web technologies, updates, and fixes. We’ve assembled a huge release as part of our commitment to web developers, and the people who use the web. This is the first big WebKit release of 2022, and we’re just getting started.</p>
<p>Safari 15.4 is available today for macOS Monterey 12.3, iPadOS and iOS 15.4.</p>
<h2><a name="html"></a>HTML</h2>
<p>Let’s start with HTML. WebKit added support for <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading">lazy-loading</a> images with the <a href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#lazy-loading-attributes"><code>loading</code></a> attribute on the <code>&lt;img&gt;</code> element, providing web developers with an easy way to instruct the browser to defer loading certain images until the user scrolls near them.</p>
<p>After years of standardization debates over accessibility considerations and with a solution finally at hand, WebKit added support for the <a href="https://html.spec.whatwg.org/multipage/interactive-elements.html#the-dialog-element"><code>&lt;dialog&gt;</code></a> element and <a href="https://fullscreen.spec.whatwg.org/#::backdrop-pseudo-element"><code>::backdrop</code></a> pseudo-element. The <code>&lt;dialog&gt;</code> element provides a robust and powerful way to create overlays and modals.</p>
<pre><code><span>&lt;<span>dialog</span> <span>id</span>=<span>&#34;confirmation-dialog&#34;</span>&gt;</span>
    <span>&lt;<span>h1</span>&gt;</span>Do you want to delete everything?<span>&lt;/<span>h1</span>&gt;</span>
    <span>&lt;<span>p</span>&gt;</span>You will lose all your data.<span>&lt;/<span>p</span>&gt;</span>
    <span>&lt;<span>button</span> <span>id</span>=<span>&#34;cancel-delete&#34;</span>&gt;</span>Cancel<span>&lt;/<span>button</span>&gt;</span>
    <span>&lt;<span>button</span> <span>id</span>=<span>&#34;confirm-delete&#34;</span>&gt;</span>Delete!<span>&lt;/<span>button</span>&gt;</span>
<span>&lt;/<span>dialog</span>&gt;</span>
</code></pre>
<p>The <code>::backdrop</code> pseudo-element makes it possible to style the background underneath the modal.</p>
<figure>
<dialog>
<p>This is a pretty dialog</p>
<p>The backdrop animates!</p>

</dialog>
<figcaption>Pretty dialog example styled and animated</figcaption></figure>
<p>You can learn all about using <code>&lt;dialog&gt;</code> and <code>::backdrop</code> in <a href="https://webkit.org/blog/12209/introducing-the-dialog-element/"><em>Introducing the Dialog Element</em></a>.</p>
<p>WebKit also added support for the global <a href="https://html.spec.whatwg.org/multipage/interaction.html#dom-fe-autofocus"><code>autofocus</code></a> attribute allowing developers to indicate which element should be the one in focus when the page loads or when a <code>&lt;dialog&gt;</code> is displayed.</p>
<h2><a name="css"></a>CSS</h2>
<h3><a name="features-for-css-architecture"></a>Features for CSS Architecture</h3>
<p>Several additions to CSS in 2022 offer revolutionary new ways for web developers to architect their code, making it easier to reuse code, create design systems, and integrate with complex applications.</p>
<p>Landing <a href="https://caniuse.com/css-has">in Safari first</a>, WebKit added support for the <a href="https://www.w3.org/TR/selectors-4/#relational"><code>:has()</code></a> pseudo-class. This selector fulfills a long-expressed desire for a “parent selector” — a way to apply CSS rules conditionally based on the contents of an element — and goes even further with the possibilities it enables. It was long thought such a selector was not possible, but our team figured out a way to highly-optimize performance and deliver a flexible solution that does not slow the page.</p>
<p>WebKit added support for <a href="https://css-tricks.com/css-cascade-layers/">Cascade Layers</a> — a powerful way to organize styles into layers where specificity is calculated independently inside each layer.</p>
<figure><img src="https://webkit.org/wp-content/uploads/cascade-layers-1024x576.png" alt="a diagram of cascade layers, showing how Author layers cascade" width="1024" height="576" srcset="https://webkit.org/wp-content/uploads/cascade-layers-1024x576.png 1024w, https://webkit.org/wp-content/uploads/cascade-layers-300x169.png 300w, https://webkit.org/wp-content/uploads/cascade-layers-768x432.png 768w, https://webkit.org/wp-content/uploads/cascade-layers-1536x864.png 1536w, https://webkit.org/wp-content/uploads/cascade-layers-2048x1152.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>
<p>A web developer could create a “framework” layer and a “custom” layer — assigning all the CSS from a 3rd-party framework to the “framework” layer, and writing their own code in the “custom” layer. They could designate that everything in the custom layer should beat everything in the framework layer, no matter the specificity of the selectors used in each layer. Cascade Layers is <a href="https://caniuse.com/css-cascade-layers">arriving in all major browsers</a> at about the same time and is included in <a href="https://webkit.org/blog/12288/working-together-on-interop-2022/">Interop 2022</a>, ensuring this is a tool web developers can begin to seriously consider for the future.</p>
<p>WebKit also added support for <a href="https://www.w3.org/TR/css-contain-2">CSS Containment</a> — all four types: size, layout, style, and paint — with the <code>contain</code> property.</p>
<h3><a name="solving-pain-points"></a>Solving Pain Points</h3>
<p>Several more additions to CSS in WebKit introduce solutions to long-standing pain points.</p>
<p>Web developers often ask for a tool that would work similar to existing viewport units, but work better on mobile devices where the dimensions of the browser’s viewport change as a user scrolls the page. The <a href="https://www.w3.org/TR/css-values-4/#viewport-relative-lengths">new Viewport Units</a> are that solution. <code>100svh</code>  refers to 100% of the height of the smallest possible viewport. <code>100lvh</code> refers to 100% of the height of the largest possible viewport. And <code>100dvh</code> refers to 100% of the dynamic viewport height — meaning the value will change as the user scrolls.</p>
<figure><img loading="lazy" src="https://webkit.org/wp-content/uploads/viewport_units-1024x576.png" alt="100svh measures the smallest viewport, top to bottom. 100lvh measures the largest viewport. 100dvh measures the dynamic viewport, changing as the user scrolls." width="1024" height="576" srcset="https://webkit.org/wp-content/uploads/viewport_units-1024x576.png 1024w, https://webkit.org/wp-content/uploads/viewport_units-300x169.png 300w, https://webkit.org/wp-content/uploads/viewport_units-768x432.png 768w, https://webkit.org/wp-content/uploads/viewport_units-1536x864.png 1536w, https://webkit.org/wp-content/uploads/viewport_units-2048x1151.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>
<p>There are other new viewport units as well — <code>svw</code>, <code>lvw</code>, and <code>dvw</code> serve the same purpose for width. To cover the small, large, and dynamic versions of vmin and vmax, the <code>svmin</code>, <code>svmax</code>, <code>lvmin</code>, <code>lvmax</code>, <code>dvmin</code>, and <code>dvmax</code> units were implemented. To support logical dimensions, the new <code>vi</code> and <code>vb</code> are similar to existing Viewport Units, in the viewport inline and viewport block dimensions. And <code>svi</code>, <code>svb</code>, <code>lvi</code>, <code>lvb</code>, <code>dvi</code>, and <code>dvb</code> provide logical dimension units for the small, large, and dynamic versions of the inline and block dimensions. WebKit is happy to lead the pack, <a href="https://caniuse.com/viewport-unit-variants">shipping these new units first</a> and encouraging other browsers to do so through <a href="https://webkit.org/blog/12288/working-together-on-interop-2022/">Interop 2022</a>.</p>
<p>WebKit added support for the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:focus-visible"><code>:focus-visible</code></a> pseudo-class to style the focus indicator only when the browser renders it. Learn more by reading <a href="https://webkit.org/blog/12179/the-focus-indicated-pseudo-class-focus-visible/"><em>The Focus-Indicated Pseudo-class :focus-visible</em></a>.</p>
<p>To make native form controls more customizable, the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/accent-color"><code>accent-color</code></a> property provides a way for web developers to alter the color of particular parts of the form control UI. Accent color is supported for <code>&lt;input type=&#34;checkbox&#34;&gt;</code>, <code>&lt;input type=&#34;radio&#34;&gt;</code>, <code>&lt;progress&gt;</code>, <code>&lt;select&gt;</code>, and text-input types with a <code>&lt;datalist&gt;</code> on macOS, iPadOS, and iOS. Additionally, on iPadOS and iOS, accent color is supported for <code>&lt;input type=&#34;range&#34;&gt;</code>, <code>&lt;button&gt;</code>, and <code>&lt;input type=&#34;button&#34;&gt;</code>.</p>
<p>WebKit fixed an accessibility bug with <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/display#box"><code>display:contents</code></a>, which incorrectly hid content from the accessibility tree. This fix makes it possible to freely use this display value to <a href="https://www.w3.org/TR/css-display-3/#box-generation">remove a box from the DOM tree</a>, while still including its children. This can be useful when you want to adjust which box is the child of a Flexbox or Grid container, for instance.</p>
<p>WebKit fixed a bug with the interpolation between colors with alpha transparency — improving gradient support.</p>
<figure><img loading="lazy" src="https://webkit.org/wp-content/uploads/gradient-example-1024x333.png" alt="How a gradient looks before &amp; after this fix. Without the fix, the color is muddy." width="1024" height="333" srcset="https://webkit.org/wp-content/uploads/gradient-example-1024x333.png 1024w, https://webkit.org/wp-content/uploads/gradient-example-300x98.png 300w, https://webkit.org/wp-content/uploads/gradient-example-768x250.png 768w, https://webkit.org/wp-content/uploads/gradient-example-1536x499.png 1536w, https://webkit.org/wp-content/uploads/gradient-example-2048x666.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>
<p>WebKit added support for <a href="https://www.w3.org/TR/css-values-4/#trig-funcs"><code>calc()</code> math functions</a> including <code>sin</code>, <code>cos</code>, <code>tan</code>, <code>e</code>, <code>pi</code>, <code>exp</code>, <code>log</code>, <code>atan</code>, <code>acos</code>, <code>asin</code>, and <code>atan2</code>.</p>
<h3><a name="typography"></a>Typography</h3>
<p>Several new WebKit features in Safari 15.4 enrich what’s possible in typography on the web.</p>
<p>WebKit added support for the <a href="https://www.w3.org/TR/css-fonts-4/#font-palette-prop"><code>font-palette</code></a> CSS property and <a href="https://www.w3.org/TR/css-fonts-4/#font-palette-values"><code>@font-palette-values</code></a> rule. The <code>font-palette</code> property provides a way for web developers to select one of several different pre-defined color palettes contained inside a color font — for example, to declare that a font’s dark color palette be used for the site’s dark mode design. The <code>@font-palette-values</code> rule provides a way for web developers to define their own custom color palette for recoloring color fonts.</p>
<figure><img loading="lazy" src="https://webkit.org/wp-content/uploads/color-font-palette-1024x503.png" alt="four versions of a drop cap, in orange, purple, yellow, and black." width="1024" height="503" srcset="https://webkit.org/wp-content/uploads/color-font-palette-1024x503.png 1024w, https://webkit.org/wp-content/uploads/color-font-palette-300x147.png 300w, https://webkit.org/wp-content/uploads/color-font-palette-768x377.png 768w, https://webkit.org/wp-content/uploads/color-font-palette-1536x754.png 1536w, https://webkit.org/wp-content/uploads/color-font-palette-2048x1005.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>The color font used for the enlarged caps is <a href="https://djr.com/notes/bradley-initials-font-of-the-month">Bradley Initials DJR Web</a>, shown here with its default palette, a customized palette created by the web developer, an alternative palette that’s included with the font, and with color removed by the user’s preference.</figcaption></figure>
<p>WebKit added support for <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-decoration-skip-ink"><code>text-decoration-skip-ink</code></a> to control how underlines and overlines are rendered when they pass over glyph ascenders and descenders. WebKit previously supported this typography feature through <code>text-decoration-skip</code>, but since no other browsers yet support this short-hand, WebKit’s support of the long-hand will make it easier to turn off ink skipping for underlines and overlines.</p>
<p>WebKit added support the <a href="https://drafts.csswg.org/css-values-4/#ic"><code>ic</code> unit</a>, useful when typesetting CJK scripts. Much like how the <code>ch</code> unit is equivalent to the width (or height, whichever is the inline direction) of the <code>0</code> glyph in a font, the <code>ic</code> unit is equivalent to inline direction length (width or height) of the “水” glyph in the element’s current font.</p>
<h3><a name="retiring-webkit-prefixes"></a>Retiring WebKit prefixes</h3>
<p>In an ongoing effort to reduce dependency on prefixes, WebKit newly supports several CSS properties and values that were only previous available in an earlier form. The prefixed versions will still work, now aliased to the unprefixed versions. Safari 15.4 added support for:</p>
<ul>
<li><code>appearance</code>, including <code>appearance: auto</code></li>
<li><code>mask</code>, along with the long-hand forms <code>mask-image</code>, <code>mask-size</code>, <code>mask-repeat-x</code>, <code>mask-repeat-y</code>, <code>mask-origin</code></li>
<li><code>backface-visibility</code> </li>
<li><code>text-combine-upright</code> </li>
<li><code>print-color-adjust</code> </li>
<li><code>match-parent</code> CSS value for the <code>text-align</code> property</li>
</ul>
<p>WebKit also removed the non-standard CSS properties <code>-webkit-border-fit</code>, <code>-webkit-margin-collapse</code>, <code>-webkit-margin-top-collapse</code>, <code>-webkit-margin-bottom-collapse</code>, <code>-webkit-margin-before-collapse</code>, <code>-webkit-margin-after-collapse</code>, and <code>-webkit-background-composite</code>.</p>
<h2><a name="web-apis"></a>Web APIs</h2>
<p>This release includes many upgrades to Web APIs in WebKit to help web developers deliver better user experiences.</p>
<p>New support for <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#broadcasting-to-other-browsing-contexts">BroadcastChannel</a> allows tabs, windows, iframes, and Workers from an origin to send messages to each other. This enables experiences like syncing login state for a site across multiple tabs.</p>
<p>Another new mechanism supported in WebKit is the <a href="https://w3c.github.io/web-locks/">Web Locks API</a> to manage access to a resource as an asynchronous locking control from an origin in tabs, windows, iframes, and Workers.</p>
<p>Developers can also control scroll behavior for an element with either the CSS <a href="https://www.w3.org/TR/css-overflow-3/#smooth-scrolling"><code>scroll-behavior</code></a>  property or the <code>behavior</code> option in <code>window.scroll()</code>, <code>window.scrollTo()</code>, and <code>window.scrollBy()</code> methods in JavaScript. This new support gives developers the ability to choose between instantly jumping to a position in the viewport or smoothly animating the scroll operation.</p>
<p>The ResizeObserver API has updated support for the <a href="https://drafts.csswg.org/resize-observer/#resizeobserversize"><code>ResizeObserverSize</code></a> interface used by <code>ResizeObserverEntry</code> to help developers observe changes to an element’s box-sizing properties.</p>
<p>The addition of <a href="https://html.spec.whatwg.org/multipage/structured-data.html#dom-structuredclone"><code>structuredClone(value)</code></a> provides a utility that uses the structured clone algorithm to synchronously perform a deep copy to clone and transfer objects from the input value.</p>
<p>WebKit support of the File System Access API with Origin Private File System first shipped in Safari 15.2. This release introduces the <code>getFile()</code> method in <code>FileSystemFileHandle</code> making it more convenient to read a file from the file system. Plus, WebKit updated WriteableStream to work with the File System Access API. For more information, read <a href="https://webkit.org/blog/12257/the-file-system-access-api-with-origin-private-file-system/"><em>File System Access API with Origin Private File System</em></a>.</p>
<h2><a name="javascript"></a>JavaScript</h2>
<p>New features and updates to JavaScript bring added convenience for developers. Handy new Array features make it nicer to search starting from the end of an array using the <a href="https://github.com/tc39/proposal-array-find-from-last"><code>findLast()</code> and <code>findLastIndex()</code> methods</a>. These methods help developers avoid the typical approach requiring mutating the array with <code>reverse()</code> first.</p>
<p>There’s also support for the <a href="https://github.com/tc39/proposal-relative-indexing-method"><code>at()</code></a> method to access an entry at a specified integer index, which notably includes support for using negative integers to start at the end of the array.</p>
<pre><code><span>let</span> <span>list</span> <span>=</span> [<span>&#39;banana&#39;</span>,<span>&#39;cherry&#39;</span>,<span>&#39;orange&#39;</span>,<span>&#39;apple&#39;</span>,<span>&#39;kiwi&#39;</span>];

<span>console</span>.<span>log</span>(<span>list</span>[<span>list</span>.<span>length</span><span>-</span><span>2</span>]);

<span>console</span>.<span>log</span>(<span>list</span>.<span>at</span>(<span>-</span><span>2</span>));
</code></pre>
<p>The new language utility <a href="https://github.com/tc39/proposal-accessible-object-hasownproperty"><code>Object.hasOwn()</code></a> simplifies detecting when the object has a property itself, one that is not inherited or doesn’t exist.</p>
<h3><a name="internationalization"></a>Internationalization</h3>
<p>As the standards process defines more Internationalization features, WebKit continues to add regular updates to its <code>Intl</code> implementation. This release includes identifying the supported values of local time zones, collations, calendars, numbering systems, and currency with the <a href="https://tc39.es/proposal-intl-enumeration/">Intl Enumeration API</a>.</p>
<p><a href="https://tc39.es/proposal-intl-locale-info/#sec-Intl.Locale.prototype.hourCycles"><code>Intl.Locale</code>, updated to V2</a>, exposes new information that includes calendar-week data such as the first day of the week, text information like writing direction, and other region-dependent defaults such as calendars, 12- or 24-hour cycles, and numbering systems.</p>
<p>WebKit also updated <a href="https://github.com/tc39/proposal-intl-displaynames-v2"><code>Intl.DisplayNames</code> to V2</a>, adding support for the <code>calendar</code> and <code>dateTimeField</code> names, and the <code>languageDisplay</code> option.</p>
<p>The <code>selectRange()</code> method added to <code>Intl.PluralRules</code> provides locale-correct pluralization for ranges (e.g. 0-1 items). The <a href="https://tc39.es/proposal-intl-numberformat-v3/"><code>Intl.NumberFormat</code> V3</a> update adds the <code>formatRange()</code> and <code>formatRangetoParts()</code> methods for formatting a number range using locale-aware conventions along with new <code>useGrouping</code>, <code>roundingPriority</code>, <code>roundingIncrement</code>, <code>trailingZeroDisplay</code>, and <code>signDisplay</code> options.</p>
<p>Finally, <code>Intl.DateTimeFormat</code> includes support for four new <a href="https://github.com/tc39/proposal-intl-extend-timezonename"><code>timeZoneName</code></a> options: <code>shortOffset</code>, <code>longOffset</code>, <code>shortGeneric</code>, and <code>longGeneric</code>.</p>
<h2><a name="web-apps"></a>Web Apps</h2>
<p>Web App Manifest and ServiceWorker received updates that improve the user experience for both websites in Safari and web apps saved to the home screen on iOS and iPadOS.</p>
<p><a href="https://w3c.github.io/manifest">Web App Manifest</a> improvements include ensuring the browser always fetches the manifest file during page load instead of when the user chooses to “Add to Home Screen” from the Share menu. This approach improves reliability, and also allows a manifest file to define the characteristics of a webpage in Safari.</p>
<p>In addition, declaring icons in a web app manifest file is now supported. Safari and iOS use manifest-declared icons when there is no <code>apple-touch-icon</code> defined in the HTML head, and when the manifest file code for declaring the icons either omits the <code>&#34;purpose&#34;</code> key or includes <code>&#34;purpose&#34;: &#34;any&#34;</code>. Defining icons by using <code>apple-touch-icon</code> takes precedence over manifest-declared icons in order to provide consistent behavior for web apps that use this technique to define specific icons for iOS, distinct from other mobile platforms.</p>
<p>Developers can now enable <a href="https://w3c.github.io/ServiceWorker/#service-worker-registration-navigationpreload">Navigation Preload in ServiceWorker</a> to improve load performance and avoid ServiceWorker startup delays that block network requests. There’s also new support for allowing users to download files generated by a ServiceWorker. WebKit also improved the reliability of using Fetch using <code>FormData</code> with a file going through ServiceWorker.</p>
<h2><a name="media"></a>Media</h2>
<p>The WebRTC negotiation API is now fully aligned with the WebRTC 1.0 specification to support <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Perfect_negotiation">WebRTC perfect negotiation</a>. It is an approach that solves potential synchronization issues that can happen during negotiation between two remote peers.</p>
<p>WebKit added support for in-band chapter tracks for audio and video. In-band text tracks provide captions or chapter marker information inside the container for the media itself, instead of being declared in HTML or injected with JavaScript. In-band caption tracks like <a href="https://en.wikipedia.org/wiki/EIA-608">CEA-608</a> were already supported. Now, <a href="https://developer.mozilla.org/en-US/docs/Web/API/TextTrack/kind">in-band chapter tracks</a> are also supported, where the “cue” represents the start time and title of a chapter.</p>
<p>WebKit added support for <a href="https://web.dev/requestvideoframecallback-rvfc/"><code>requestVideoFrameCallback()</code></a> on <code>&lt;video&gt;</code>, which allows the caller to be notified when there’s a new video frame available for display, and also provides metadata about that frame.</p>
<h2><a name="privacy"></a>Privacy</h2>
<p>Continuing our dedication to privacy, and to further our proposed web standard for measuring advertising in a privacy-preserving way, Safari 15.4 provides three updates to <a href="https://webkit.org/blog/11940/pcm-click-fraud-prevention-and-attribution-sent-to-advertiser/">Private Click Measurement</a>:</p>
<ul>
<li>Added conversion fraud prevention via unlinkable tokens for triggering events on merchant websites.</li>
<li>Added support for same-site conversion pixels on merchant websites, to remove dependency on cross-site pixels.</li>
<li>Allowed measurement of links in nested, cross-site iframes on publisher websites.</li>
</ul>
<h2><a name="security"></a>Security</h2>
<p>WebKit in Safari 15.4 improves support for <a href="https://www.w3.org/TR/CSP3/">Content Security Policy Level 3</a>, providing enhanced security control over the loading of content, and helping web developers to mitigate risks of cross-site scripting and other vulnerabilities. Blocked resource violation reporting for inline script, inline style and eval execution is updated to match web standards. New support for  <code>&#39;strict-dynamic&#39;</code>,  <code>&#39;unsafe-hashes&#39;</code>, and  <code>&#39;report-sample&#39;</code> source expressions give developers more flexibility. Developers can also safely include external JavaScript in their pages using new support for hash source expressions.</p>
<p>The release also removes support for the XSS Auditor, which has been superseded by modern cross-origin defenses like CSP and COEP.</p>
<h2><a name="wkwebview"></a>WKWebView</h2>
<p>Developers that use WKWebView, including third-party browsers on iOS and iPadOS, can make use of new WKPreferences for additional user experience control. Apps on iOS, iPadOS, and macOS can now control allowing or preventing web content from using the <a href="https://fullscreen.spec.whatwg.org/#ref-for-dom-element-requestfullscreen">Fullscreen API</a>. Another new preference allows enabling or disabling site-specific quirks, a set of site-specific behaviors designed to improve web compatibility.</p>
<p>On iPadOS, web content that uses Media Source Extensions now works in WKWebView.</p>
<h2><a name="safari-web-extensions"></a>Safari Web Extensions</h2>
<p>In our ongoing commitment to a <a href="https://www.w3.org/community/webextensions/2021/06/04/forming-the-wecg/">cross-browser interoperable model for extensions</a>, Safari 15.4 includes additional support for Web Extensions, including support for <code>manifest_version</code> 3 and related API changes. New capabilities include:</p>
<ul>
<li><code>service_worker</code> background scripts as an alternative to non-persistent background pages.</li>
<li>Script and style injection via the <code>browser.scripting</code> APIs.</li>
<li>Dynamic and session rules via the <code>browser.declarativeNetRequest</code> APIs.</li>
<li>Webpage-to-extension messaging using <code>externally_connectable:matches.</code></li>
</ul>
<p>And several issues were resolved, including:</p>
<ul>
<li>Limits are now enforced on the size and number of items in extension sync storage.</li>
<li>More directives are now allowed to be included in the <code>content_security_policy</code> of an extension’s manifest, such as the <code>sandbox</code> directive.</li>
<li>Special matching characters (<code>*</code>, <code>|</code>, <code>||</code>, and <code>^</code>) in <code>urlFilter</code> of <code>declarativeNetRequest</code> rules are now handled, instead of being treated as regex patterns.</li>
<li><code>Promise</code> returns from <code>runtime.onMessage</code> listeners are now allowed for the message reply.</li>
</ul>
<h2><a name="web-inspector"></a>Web Inspector</h2>
<p>Updates to Web Inspector provide helpful new tools for working with CSS in the Styles panel, including intuitive support for Cascade Layers and the new <code>@layer</code> rulesets, making it easy to identify in which layer a rule is defined.</p>
<p>There are also new CSS Alignment controls when using <code>align-content</code>, <code>align-items</code>, <code>align-self</code>, <code>justify-content</code>, <code>justify-items</code>, or <code>justify-self</code> for Flexbox and Grid to visually identify and select an ideal value.</p>
<figure><video controls="" loop="" muted="" autoplay="" width="100%"><source src="https://webkit.org/wp-content/uploads/alignment-editor-dark.mp4" type="video/mp4" media="(prefers-color-scheme:dark)"/><source src="https://webkit.org/wp-content/uploads/alignment-editor.mp4" type="video/mp4"/></video></figure>
<p>While adding new properties or values in the Styles panel, Web Inspector offers convenient auto-completion options. This release upgrades auto-completion to use fuzzy matching, making finding the right option even easier.</p>
<p>When working with CSS custom properties, or CSS variables as they’re more widely known, a common practice is to add them to a selector rule for <code>:root</code> or <code>html</code>. Unfortunately, this leads to a long list of inherited CSS variables for every element on the page. Web Inspector helps you handle this in a few ways. First, it hides unused inherited CSS variables automatically. Then, a button is available to reveal them all when you need to see them. You can also use the filter tools to search for the right CSS variable. Or, you can see all applicable CSS variables grouped by value type in the Computed panel, allowing you to collapse the groups that aren’t relevant to your task.</p>
<figure><video controls="" loop="" muted="" autoplay="" width="305" height="420" poster="https://webkit.org/wp-content/uploads/video-variables-grouped-light.jpeg"><source src="https://webkit.org/wp-content/uploads/video-variables-grouped-dark.mp4" type="video/mp4" media="(prefers-color-scheme:dark)"/><source src="https://webkit.org/wp-content/uploads/video-variables-grouped-light.mp4" type="video/mp4"/></video><figcaption>The list of applicable CSS variables can be grouped by value type into collapsible subsections: colors, dimensions and other types.</figcaption></figure>
<p>Learn more by reading <a href="https://webkit.org/blog/12303/css-variables-web-inspector/"><em>Taming CSS Variables with Web Inspector</em></a>.</p>
<h2><a name="feedback"></a>Feedback</h2>
<p>We love hearing from you. Send a tweet to <a href="https://twitter.com/webkit">@webkit</a>, <a href="https://twitter.com/jensimmons">@jensimmons</a> or <a href="https://twitter.com/jonathandavis">@jonathandavis</a> to share your thoughts on this release. What technology from Safari 15.4 are you most excited about? What features or fixes do you want to see next? If you run into any issues, we welcome your <a href="https://feedbackassistant.apple.com/">feedback</a> on the Safari UI or your <a href="https://bugs.webkit.org/">WebKit bug report</a> about web technology. Filing issues really does make a difference.</p>
<p>Download the latest <a href="https://developer.apple.com/safari/download/">Safari Technology Preview</a> to stay at the forefront of the web platform and  to use the latest Web Inspector features. You can also use the <a href="https://webkit.org/status">WebKit Feature Status</a> page to watch for new information about the web features that interest you the most.</p>
<h2><a name="and-more"></a>And More</h2>
<p>To see the full list of what’s in WebKit for Safari 15.4, including additional bug fixes, read the <a href="https://developer.apple.com/documentation/safari-release-notes/safari-15_4-release-notes">Safari 15.4 release notes</a>.</p>
<p>These features were first released in Safari Technology Preview: <a href="https://webkit.org/blog/11958/release-notes-for-safari-technology-preview-130/">130</a>, <a href="https://webkit.org/blog/11962/release-notes-for-safari-technology-preview-131/">131</a>, <a href="https://webkit.org/blog/11971/release-notes-for-safari-technology-preview-132/">132</a>, <a href="https://webkit.org/blog/11975/release-notes-for-safari-technology-preview-133/">133</a>, <a href="https://webkit.org/blog/12033/release-notes-for-safari-technology-preview-134/">134</a>, <a href="https://webkit.org/blog/12040/release-notes-for-safari-technology-preview-135/">135</a>, <a href="https://webkit.org/blog/12137/release-notes-for-safari-technology-preview-136/">136</a>, <a href="https://webkit.org/blog/12156/release-notes-for-safari-technology-preview-137/">137</a>, <a href="https://webkit.org/blog/12176/release-notes-for-safari-technology-preview-138/">138</a>, and <a href="https://webkit.org/blog/12193/release-notes-for-safari-technology-preview-139/">139</a>.</p>

                            </div></div>
  </body>
</html>
