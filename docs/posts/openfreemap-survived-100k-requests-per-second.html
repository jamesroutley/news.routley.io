<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.hyperknot.com/p/openfreemap-survived-100000-requests">Original</a>
    <h1>OpenFreeMap survived 100k requests per second</h1>
    
    <div id="readability-page-1" class="page"><div><div dir="auto"><p><span>I was about to post about how nice the last 10 months of </span><a href="https://openfreemap.org/" rel="">OpenFreeMap</a><span> have been. The architecture has really proven itself to be great, Cloudflare has agreed to sponsor the bandwidth, Hetzner servers are super stable as always, serving tiles from Btrfs proved to be a great choice, nginx is amazing, and life is good.</span></p><p>Then, out of the blue, I&#39;m getting reports that some tiles are not loading, which normally means tile generation bugs, but not this time. I look into the nginx logs and see this:</p><pre><code>2025/08/08 23:08:16 [crit] 1084275#1084275: *161914910 open() &#34;/mnt/ofm/planet-20250730_001001_pt/tiles/8/138/83.pbf&#34; failed (24: Too many open files) ...</code></pre><p><span>This is weird. I&#39;ve never seen anything like this. I check nload, and it shows huge traffic. I log into Cloudflare and I see </span><strong>THIS</strong><span> for the last 24 hours.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!gPqG!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!gPqG!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 424w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 848w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 1272w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!gPqG!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png" width="290" height="310.0936329588015" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/b5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1142,&#34;width&#34;:1068,&#34;resizeWidth&#34;:290,&#34;bytes&#34;:131535,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;topImage&#34;:true,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!gPqG!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 424w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 848w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 1272w, https://substackcdn.com/image/fetch/$s_!gPqG!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5b43d9f-e03e-4f4d-bb4a-f0f9005b5627_1068x1142.png 1456w" sizes="100vw" fetchpriority="high"/></picture><div><div></div></div></div></a></figure></div><p><span>What? </span><strong>3 billion requests in 24 hours?</strong><span> What on Earth is that? Also, 215 TB of traffic from tiny, 70 kB files?</span></p><p>This much traffic would cost over $6 million per month on MapTiler and double that on Mapbox.</p><p>It&#39;s especially spiking in the last 5 minutes, where I&#39;m seeing 30 million requests.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!WPBx!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!WPBx!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 424w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 848w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 1272w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!WPBx!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png" width="1456" height="1157" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1157,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:610511,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!WPBx!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 424w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 848w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 1272w, https://substackcdn.com/image/fetch/$s_!WPBx!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F33fd332a-1568-4e0c-bee3-2dcbb814739a_3756x2984.png 1456w" sizes="100vw"/></picture><div><div></div></div></div></a></figure></div><p>How much is that?</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!5lZz!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!5lZz!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 424w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 848w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 1272w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!5lZz!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png" width="526" height="61.41483516483517" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/f28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:170,&#34;width&#34;:1456,&#34;resizeWidth&#34;:526,&#34;bytes&#34;:146004,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!5lZz!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 424w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 848w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 1272w, https://substackcdn.com/image/fetch/$s_!5lZz!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff28e69c0-a00e-4979-91af-eb769fff638a_2056x240.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p><span>Wow, that&#39;s </span><strong>100,000 requests per second</strong><span>!</span></p><p>My first thoughts are:</p><ul><li><p>Wow.</p></li><li><p>Wow, I&#39;m surprised that the only bug I&#39;ve heard about is some missing tiles. I mean, the service still seems to work? Somehow those empty tiles got cached by Cloudflare, but other than that, it still kind of works?</p></li></ul><p>Looking at the Cloudflare dashboard, I can see that 96% of the requests were 200 OK; only 3.6% were broken (206 Partial Content).</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!cwFU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!cwFU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 424w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 848w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 1272w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!cwFU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png" width="1456" height="182" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:182,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:178766,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!cwFU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 424w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 848w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 1272w, https://substackcdn.com/image/fetch/$s_!cwFU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9ecc692b-f6c4-4bf1-b729-05d4ee347938_3630x454.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>So it seems that OpenFreeMap is mostly managing to serve 100,000 requests per second?</p><h2><strong>But what is causing it?</strong><div><div></div></div></h2><p><a href="https://wplace.live/" rel="">Wplace.live</a><span> happened. Out of the blue, a new collaborative drawing website appeared, built from scratch using OpenFreeMap.</span></p><p>I don&#39;t know what it is, but the internet seems to be crazy about it. One thing is for sure: the traffic it generates is out of this world.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!7mXy!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!7mXy!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 424w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 848w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 1272w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!7mXy!,w_2400,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png" width="1200" height="775.5494505494505" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/f834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:false,&#34;imageSize&#34;:&#34;large&#34;,&#34;height&#34;:941,&#34;width&#34;:1456,&#34;resizeWidth&#34;:1200,&#34;bytes&#34;:8817364,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:&#34;center&#34;,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!7mXy!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 424w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 848w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 1272w, https://substackcdn.com/image/fetch/$s_!7mXy!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff834af0d-4b67-4b42-b0fb-5a1c49a12535_4000x2584.png 1456w" sizes="100vw" loading="lazy"/></picture><div><div></div></div></div></a><figcaption><a href="https://wplace.live/" rel="">Wplace.live</a></figcaption></figure></div><p>I believe what is happening is that those images are being drawn by some script-kiddies. If I understand correctly, the website limited everyone to 1 pixel per 30 seconds, so I guess everyone was just scripting Puppeteer/Chromium to start a new browser, click a pixel, and close the browser, possibly with IP address rotation, but maybe that wasn&#39;t even needed.</p><p><span>Nice idea, interesting project, next time please contact me before. </span><a href="https://neal.fun/" rel="">Neal.fun</a><span> did the same before launching </span><a href="https://neal.fun/internet-roadtrip/" rel="">Internet Roadtrip</a><span> - they asked me if the traffic would be OK and even decided to sponsor the OpenFreeMap project with an amount that more than covers their bandwidth usage.</span></p><p>Sorry Wplace.live, I had to create my first-ever Cloudflare rule. As a single user, you broke the service for everyone.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!cJrQ!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!cJrQ!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 424w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 848w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 1272w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!cJrQ!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png" width="385" height="151.83098591549296" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/a54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:504,&#34;width&#34;:1278,&#34;resizeWidth&#34;:385,&#34;bytes&#34;:77421,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!cJrQ!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 424w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 848w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 1272w, https://substackcdn.com/image/fetch/$s_!cJrQ!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa54d2af9-d072-4ff5-9743-a1da2313c3a5_1278x504.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>I wonder if there is an automatic way to do this on Cloudflare, to limit traffic by referer or custom headers. It&#39;d be great if this could be automatic, as I want to avoid this ever happening in the future. I hope I can script this via the API.</p><p>Finally, I want to say a huge thanks to Cloudflare for helping with the bandwidth. I haven&#39;t written about it yet, but when I contacted them back in November, they managed to get my bandwidth sponsorship status approved in 48 hours over a Saturday. Moreover, they connected me with some of their best engineers to discuss how OpenFreeMap could use their architecture even better. I&#39;ve never seen a company of their size move as agilely as they did.</p><p>As the sole person running OpenFreeMap, I&#39;m incredibly proud of these two numbers. First, that my architecture hit a 99.4% CDN cache rate, which is fantastic for a service with weekly data updates. And second, that my own servers successfully handled the remaining 1,000 requests per second. </p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!ATGA!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!ATGA!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 424w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 848w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 1272w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/$s_!ATGA!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png" width="226" height="121.136" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:268,&#34;width&#34;:500,&#34;resizeWidth&#34;:226,&#34;bytes&#34;:35267,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:&#34;https://blog.hyperknot.com/i/170530219?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png&#34;,&#34;isProcessing&#34;:false,&#34;align&#34;:null,&#34;offset&#34;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!ATGA!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 424w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 848w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 1272w, https://substackcdn.com/image/fetch/$s_!ATGA!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F35b950cd-6da7-4bcc-bfd3-5c2835e071e2_500x268.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><h2><strong>Update</strong><div><div></div></div></h2><p>I managed to contact the dev behind Wplace.live. He said they grew to 2 million users in a few days, out of the blue, so I totally understand them not being prepared for this kind of traffic. BTW, I&#39;m amazed that their main architecture is holding up.</p><p>I offered to help them set up a self-hosted OpenFreeMap instance, which is the perfect fit for such use cases. They get the service for free, the public instance doesn&#39;t get the load, and everyone is happy.</p><p>Also, &#34;only&#34; having 2 million users confirms my belief that it&#39;s all just script-kiddies creating the load. 3 billion requests / 2 million users is an average of 1,500 req/user. A normal user might make 10-20 requests when loading a map, so these are extremely high, scripted use cases.</p><p>My recommendation to them is to remove the rules that force people to hack around with new browser sessions; it will just keep hammering their servers.</p><h3><strong>Learnings</strong><div><div></div></div></h3><p>There are two learnings I&#39;ll write about in a next post.</p><ol><li><p>I need to implement bandwidth limiting by referer. I&#39;m looking into how to do this on Cloudflare. Nothing changes in the service; everything will still stay free and without registration, but every referer will be limited to a very high number, like 100 million requests per 24 hours or something similar. For native apps, I&#39;ll probably ask them to add a custom header identifying their app.</p></li><li><p>I&#39;ll need to improve my server config to fix those empty tiles. Even though I&#39;m not expecting a load like this in the future, I think I found the culprit in the config that was causing the missing tiles.</p></li></ol><p><span>If you find OpenFreeMap valuable, please consider </span><a href="https://github.com/sponsors/hyperknot" rel="">sponsoring on GitHub</a><span>. To be fully transparent, the project currently runs on $500/month in donations. This is just enough to cover all infrastructure costs, which is fantastic. However, it means that new development happens in my limited free time. More support means more time I can spend coding, ensuring OpenFreeMap is ready for whatever comes next.</span></p><p><span>You can sponsor the project on GitHub at </span><a href="https://github.com/sponsors/hyperknot" rel="">https://github.com/sponsors/hyperknot</a></p><div><div><p>If you enjoyed this post, feel free to subscribe to this blog, or follow me on <a href="https://x.com/hyperknot">X</a> or <a href="https://bsky.app/profile/hyperknot.com">Bluesky</a>.</p><div data-component-name="SubscribeWidget"><div><div><form action="/api/v1/free?nojs=true" method="post" novalidate=""><div><div></div></div></form></div></div></div></div></div></div></div></div>
  </body>
</html>
