<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://vmssoftware.com/resources/blog/2025-03-31-how-big-is-vms/">Original</a>
    <h1>How Big Is VMS?</h1>
    
    <div id="readability-page-1" class="page"><div>
                                                        <p><img src="https://vmssoftware.com/images/blog/2025-03-31-How-Big-Is-VMS.jpg" alt="How Big Is VMS?" title="How Big Is VMS?"/></p><p>This question was asked during my Boot Camp presentation last fall in Boston, and over the past 35 years dozens of times people have asked, how big is VMS? That translates into &#34;how many lines of code are in VMS&#34;? I thought it was time to at least make a stab at pursuing some insight into the answer. I wrote some command procedures to count the number of source lines in .B32, .B64, .C, .MAR, .M64, and .S files. Not counted are blank lines and lines beginning with the standard comment characters and miscellaneous directives for the particular language.</p>

<p>First, I needed a baseline definition of  &#39;VMS&#39;.</p>

<ul>
<li>Does it include layered products, networking, compilers, RTLs, debuggers, open source, etc.?</li>
<li>Is it the code on a particular running system?</li>
<li>Does it include command procedures?</li>
</ul>

<p>I said &#39;no&#39; to all of the above and as a starting point chose 15 facilities which are representative of identifiable components of the system: ACPI , AUDSRV, CLUSTER, DCL, DRIVER, F11X, JOBCTL, LAN, PCSI, RMS, SCSI, SDA, SHADOWING, SYS, XFC.</p>

<p>I chose the following releases for comparison:</p>

<ul>
<li>V6.2:       May / 1995 - port to Alpha</li>
<li>V7.2:       Feb / 1999 - kernel threads, 64-bit APIs, Galaxy, and more</li>
<li>V8.2:       Feb /  2005 - port to Itanium</li>
<li>V9.2-3:     Dec / 2024 - port to x86</li>
</ul>

<p>The LINES.COM procedure, which invokes a set of nested procedures, fetches all of the source files with the extensions mentioned above, in the SCSI facility that are in the release stream V8.2, gets the line counts, and produces the text file below. This was done for each of the 15 facilities in each of the four release streams.</p>

<pre><code>MTMERU-V8.4-2L2$ @lines scsi &#34;V8.2&#34; V82 

MTMERU-V8.4-2L2$ type [.scsi]total-line-counts-v82.txt

WORK10:[GRANT.LOC.SCSI.BLISS]TOTALS.TXT;1

Total source files = 2
Total source lines = 7770

WORK10:[GRANT.LOC.SCSI.C]TOTALS.TXT;1

Total source files = 64
Total source lines = 119609

WORK10:[GRANT.LOC.SCSI.M64]TOTALS.TXT;1

Total source files = 1
Total source lines = 885

WORK10:[GRANT.LOC.SCSI.MAR]TOTALS.TXT;1

Total source files = 34
Total source lines = 38414

WORK10:[GRANT.LOC.SCSI.S]TOTALS.TXT;1

Total source files = 0
Total source lines = 0


        Grand Totals

Total source files = 101
Total source lines = 166678
MTMERU-V8.4-2L2$
</code></pre>

<p>Here are all the totals for V8.2. There is a similar chart for each of the other three releases.</p>

<figure>
  <img src="https://vmssoftware.com/images/blog/2025-03-31-Figure2.jpg"/>
</figure>

<p>Here is the lines of code summary for the four releases. You can find a graphical representation of the table below at this <a href="https://22678977.fs1.hubspotusercontent-na1.net/hubfs/22678977/VMS%20-%20Blogs/March%20Blog%20Graph.png">link</a>.</p>

<figure>
  <img src="https://vmssoftware.com/images/blog/2025-03-31-Figure3-2.jpg"/>
</figure>

<h2 id="notes-and-observations%3A">Notes and Observations:</h2>

<p>Not all code in a facility is in every release, but it is or has been in one or more releases.</p>

<p>There are 409 facilities in the VMS source pool - some big, some small. They contribute to the VMS operating system build for one or more platforms.</p>

<p>These 15 facilities chosen comprise close to two million lines of code and their total has nearly tripled in size during the last three releases.</p>

<p>There were many changes and additions to VMS between V8.2 and V9.2-3 prior to the x86 porting work.
Given a relatively small delta, each release has increased by about 400,000 lines of code.
The emergence of C code is another aspect of VMS that is part of the story. In the beginning, VMS was written in BLISS and MACRO-32 (VAX assembler). During the latter stages of the port to Alpha, we declared that all new code would be written in C. There are exceptions, of course, but for the most part we followed this guideline. Not shown in the data above, but part of this investigation, is the following which reflects the 15 facilities. (The 31 C modules in V6.2 were all written during the port to Alpha.)</p>

<figure>
  <img src="https://vmssoftware.com/images/blog/2025-03-31-Figure4.jpg"/>
</figure>

<p>It might be interesting to look into why some facilities have changed so much over time. Some seem obvious but others do not. If you have suggestions for a future post, please speak up.</p>
                                                    <hr/>
                    <div>
                        <div>
                                                            <div>
                                    <p><img src="https://vmssoftware.com/images/authors/clairgrant-avatar.png" alt="Clair Grant" title="Clair Grant"/>
                                    </p>
                                    
                                </div>
                                                    </div>
                        
                    </div>
                            </div></div>
  </body>
</html>
