<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/BMCsCanNeedRebooting">Original</a>
    <h1>Server BMCs can need to be rebooted every so often</h1>
    
    <div id="readability-page-1" class="page"><div><h2>Your server BMCs can need to be rebooted every so often</h2>

	<p><small>January 14, 2023</small></p>
</div><div><p>Over on the Fediverse <a href="https://mastodon.social/@cks/109683498578654891">I said</a>:</p>

<blockquote><p>A sysadmin tip: if your <a href="https://en.wikipedia.org/wiki/Intelligent_Platform_Management_Interface">BMC/IPMI</a>
is doing weird things, restart (reboot) it. Server BMCs are little
computers running ancient versions of Linux with software that&#39;s
probably terribly written and they stay running forever, which means
all sorts of opportunities for slow bugs. Reboot away!</p>

<p>This is brought to you by the BMC with a KVM-over-IP that wouldn&#39;t
accept &#39;2&#39; entered on the (virtual) keyboard in any way or form. Until
I rebooted the BMC. </p>
</blockquote>

<p>(This probably isn&#39;t the only weird BMC glitch we&#39;ve experienced,
but it&#39;s the first one where I tried rebooting the BMC and that
fixed it.)</p>

<p>A number of people shared additional stories in the replies, and I
especially &#39;liked&#39; <a href="https://chaos.social/@frederic/109683675954689732">@frederic@chaos.social</a>&#39;s:</p>

<blockquote><p>Same for IPMI hardware sensors: Thought the motherboard was damaged
because half the sensors were reported as &#34;n/a&#34;.  Rebooting magically
fixed this. <abbr title="see no evil emoji">ðŸ™ˆ</abbr></p>
</blockquote>

<p>This happens for more or less the reasons I mentioned above. BMCs
naturally accumulate very large uptimes because they don&#39;t normally
reboot when your server reboots; if you don&#39;t do anything special,
your BMC will normally stay up for as long as the server has power.
In many places this can amount to years of uptime, and it&#39;s a rare
set of software that can stand up to that even if you don&#39;t use
them much. Server vendors typically don&#39;t want you to think about
this, and I don&#39;t believe &#39;BMC uptime&#39; is generally exposed anywhere.</p>

<p>(Routinely querying the BMC&#39;s sensor readings via IPMI may actually
make this worse, since then the BMC&#39;s software is active to answer
those queries. I should probably make <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/PrometheusGrafanaSetup-2019">our metrics system</a> notice when a server decreases the
number of IPMI metrics it exposes without a reboot.)</p>

<p>Modern BMCs can generally reboot themselves without rebooting their
host (the actual server), although you may want to test this to be
sure since <a href="https://honk.bewilderbeest.net/u/zev/h/63l6vyZV3WKDHZbz35">apparently some vendors can do that differently</a>.</p>

<p>PS: How I encountered this is that I was reinstalling a server using
KVM-over-IP, and I hit the portion of the base Ubuntu 22.04 install
when I had to enter the subnet and various associated IP addresses.
Our network has a &#39;2&#39; in it, so all of that failed. Helpfully, the
KVM-over-IP software had a virtual keyboard so I could see it wasn&#39;t
just some browser weirdness intercepting a &#39;2&#39; from my real keyboard;
even the virtual keyboard&#39;s &#39;2&#39; key wouldn&#39;t get through to the
Ubuntu 22.04 installer running on the server being reinstalled. Since
rebooting the BMC didn&#39;t reboot the host, I could verify that rebooting
the BMC alone fixed the problem; when the BMC rebooted, my KVM-over-IP
session could now enter all digits.</p>

<p>(I&#39;m glad that it occurred to me to reboot the BMC, instead of just
grumble and go down to the machine room to do the install with the
physical console.)</p>
</div></div>
  </body>
</html>
