<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://astral.sh/blog/ruff-v0.1.0">Original</a>
    <h1>Ruff v0.1.0</h1>
    
    <div id="readability-page-1" class="page"><article><p>As a reminder: <strong>Ruff is an extremely fast Python linter, written in Rust.</strong> Ruff can be used to replace Flake8 (plus dozens of plugins), isort, pydocstyle, pyupgrade, and more, all while executing tens or hundreds of times faster than any individual tool.</p>
<p>Ruff is used in production by tens of thousands of
<a href="https://github.com/astral-sh/ruff#whos-using-ruff">open source projects</a> and major enterprises.
In the last year, we&#39;ve been working to expand Ruff&#39;s feature set and improve stability for those
that depend on Ruff in their daily workflows.</p>
<p>Today, we&#39;re excited to announce that <a href="https://github.com/astral-sh/ruff">Ruff v0.1.0</a> is out! This
release is focused on stabilization, and includes a new <a href="#introducing-preview-mode">preview mode</a>,
the introduction of <a href="#respecting-fix-safety">fix safety levels</a>, and a formal <a href="#ruffs-versioning-policy">versioning policy</a>.</p>
<p>Read on for discussion of the major changes, take a look at the <a href="https://github.com/astral-sh/ruff/blob/main/CHANGELOG.md#010">100+ changes</a> in this release, or install Ruff now from
<a href="https://pypi.org/project/ruff/">PyPI</a> or your package manager of choice:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="shell" data-theme="default"><span><span>pip </span><span>install</span><span> </span><span>--upgrade</span><span> </span><span>ruff</span></span></code></pre></div></div>
<h2><span id="a-growing-feature-set"></span>A growing feature set<!-- --> <a href="#a-growing-feature-set">#</a></h2>
<p>Earlier this year, Charlie looked back on
<a href="https://notes.crmarsh.com/ruff-the-first-200-releases">the first 200 releases of Ruff</a>, at which
point 376 lint rules were supported. <strong>Ruff now supports over 700 rules</strong>, with new rules being
added in every release. In case you missed it, we&#39;ve released some exciting features this year:</p>
<ul>
<li><a href="https://astral.sh/blog/ruff-v0.0.285#stabilized-support-for-jupyter-notebooks">Jupyter notebook support</a></li>
<li><a href="https://astral.sh/blog/ruff-v0.0.292#support-for-pep-701">Python 3.12 f-string syntax support</a></li>
<li><a href="https://astral.sh/blog/ruff-v0.0.283#ruff-supports-pep-695">Python 3.12 type alias and generics syntax support</a></li>
<li><a href="https://astral.sh/blog/ruff-v0.0.281#ruffs-lexer-is-2-3x-faster">2-3x performance improvements to our lexer</a></li>
<li>Improvements to the <a href="https://play.ruff.rs/">Ruff playground</a></li>
</ul>
<p>We also <a href="https://github.com/astral-sh/ruff/discussions/7310">released an alpha version</a> of our
Black-compatible code formatter. Expect more news on that front soon!</p>
<h2><span id="introducing-preview-mode"></span>Introducing preview mode<!-- --> <a href="#introducing-preview-mode">#</a></h2>
<p>In <a href="https://github.com/astral-sh/ruff/releases/tag/v0.0.289">v0.0.289</a>, we added a new preview mode
to enable the use of unstable features when running Ruff.</p>
<p>Since new rules often benefit from a trial period, we want to be able to release them in a staged
manner. Previously, we used a &#34;nursery&#34; rule category to do this, a concept taken from Clippy,
Rust&#39;s linter.</p>
<p>However, the nursery required opt-in for each rule using their exact code, e.g., if you&#39;d selected
<code>F</code> and we released an unstable rule <code>F999</code>, you&#39;d need to update your selection to <code>[F, F999]</code>.
Requiring opt-in for each rule reduced exposure of new rules and could be tedious for users to
update. Furthermore, as Ruff grows, we want a global concept for use of unstable features — the
nursery concept doesn&#39;t scale beyond rule selection.</p>
<p>Preview mode will be used to enable new rules, unstable fixes, and experimental code analysis.
Releasing these features — but gating them to users who opt-in — will allow us to collect community
feedback and gain confidence that changes are a net-benefit.</p>
<p>Preview mode can be enabled per-invocation with the <code>--preview</code> flag or by updating your
configuration file:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="toml" data-theme="default"><span><span>[</span><span>tool</span><span>.</span><span>ruff</span><span>]</span></span>
<span><span>preview</span><span> </span><span>=</span><span> </span><span>true</span></span></code></pre></div></div>
<p>Check out the <a href="https://docs.astral.sh/ruff/preview/">docs</a> for preview mode and give it a try!</p>
<h2><span id="respecting-fix-safety"></span>Respecting fix safety<!-- --> <a href="#respecting-fix-safety">#</a></h2>
<p>Ruff&#39;s ability to automatically fix violations is one of its most powerful features. However, given
Python&#39;s dynamic nature, it&#39;s not always possible to guarantee that a fix is &#34;safe&#34;. Since May,
we&#39;ve been labeling a subset of Ruff&#39;s fixes as unsafe. When applying safe fixes, the meaning and
intent of your code will be retained; when applying unsafe fixes, the meaning could change.</p>
<p>For example,
<a href="https://docs.astral.sh/ruff/rules/unnecessary-iterable-allocation-for-first-element"><code>unnecessary-iterable-allocation-for-first-element</code></a>
is a rule which checks for potentially unperformant use of <code>list(...)[0]</code>. The fix replaces this
pattern with <code>next(iter(...))</code> which can result in a drastic speedup:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="shell" data-theme="default"><span><span>$ </span><span>python</span><span> </span><span>-m</span><span> </span><span>timeit</span><span> </span><span>&#34;</span><span>head = list(range(99999999))[0]</span><span>&#34;</span></span>
<span><span>1 </span><span>loop,</span><span> </span><span>best</span><span> </span><span>of</span><span> </span><span>5</span><span>:</span><span> </span><span>1.69</span><span> </span><span>sec</span><span> </span><span>per</span><span> </span><span>loop</span></span>
<span></span>
<span><span>$ </span><span>python</span><span> </span><span>-m</span><span> </span><span>timeit</span><span> </span><span>&#34;</span><span>head = next(iter(range(99999999)))</span><span>&#34;</span></span>
<span><span>5000000 </span><span>loops,</span><span> </span><span>best</span><span> </span><span>of</span><span> </span><span>5</span><span>:</span><span> </span><span>70.8</span><span> </span><span>nsec</span><span> </span><span>per</span><span> </span><span>loop</span></span></code></pre></div></div>
<p>However, when the collection is empty, this fix changes the raised exception from an <code>IndexError</code> to
<code>StopIteration</code>:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="shell" data-theme="default"><span><span>$ </span><span>python</span><span> </span><span>-c</span><span> </span><span>&#39;</span><span>list(range(0))[0]</span><span>&#39;</span></span>
<span><span>Traceback (most </span><span>recent</span><span> </span><span>call</span><span> </span><span>last</span><span>):</span></span>
<span><span>File </span><span>&#34;</span><span>&lt;string&gt;</span><span>&#34;</span><span>,</span><span> </span><span>line</span><span> </span><span>1</span><span>,</span><span> </span><span>in</span><span> </span><span>&lt;</span><span>modul</span><span>e</span><span>&gt;</span></span>
<span><span>IndexError: </span><span>list</span><span> </span><span>index</span><span> </span><span>out</span><span> </span><span>of</span><span> </span><span>range</span></span>
<span></span>
<span><span>$ </span><span>python</span><span> </span><span>-c</span><span> </span><span>&#39;</span><span>next(iter(range(0)))[0]</span><span>&#39;</span></span>
<span><span>Traceback (most </span><span>recent</span><span> </span><span>call</span><span> </span><span>last</span><span>):</span></span>
<span><span>File </span><span>&#34;</span><span>&lt;string&gt;</span><span>&#34;</span><span>,</span><span> </span><span>line</span><span> </span><span>1</span><span>,</span><span> </span><span>in</span><span> </span><span>&lt;</span><span>modul</span><span>e</span><span>&gt;</span></span>
<span><span>StopIteration</span></span></code></pre></div></div>
<p>Since this could break error handling, this fix is categorized as unsafe.</p>
<p>Previously, the safety of a fix was only an internal note, but in v0.1.0, Ruff will only use safe
fixes by default to increase confidence when applying fixes and highlight fixes that need additional
review.</p>
<p>Unsafe fixes can be enabled by passing the <code>--unsafe-fixes</code> flag to <code>ruff check</code>:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="shell" data-theme="default"><span><span># Show unsafe fixes</span></span>
<span><span>ruff </span><span>check</span><span> </span><span>.</span><span> </span><span>--unsafe-fixes</span></span>
<span></span>
<span><span># Apply unsafe fixes</span></span>
<span><span>ruff </span><span>check</span><span> </span><span>.</span><span> </span><span>--fix</span><span> </span><span>--unsafe-fixes</span></span></code></pre></div></div>
<p>or by setting
<a href="https://docs.astral.sh/ruff/settings#unsafe-fixes"><code>unsafe-fixes</code></a> in your configuration file:</p>
<div data-rehype-pretty-code-fragment=""><div><pre><code data-language="toml" data-theme="default"><span><span>[</span><span>tool</span><span>.</span><span>ruff</span><span>]</span></span>
<span><span>unsafe-fixes</span><span> </span><span>=</span><span> </span><span>true</span></span></code></pre></div></div>
<p>When working with Ruff in an IDE (via our LSP), we will no longer apply unsafe fixes with the &#34;Fix
all&#34; action. Instead, unsafe fixes can be applied individually with the &#34;Quick fix&#34; action allowing
review of each fix. If you opt-in to unsafe fixes, they&#39;ll be applied during &#34;Fix all&#34;. See the
<a href="https://github.com/astral-sh/ruff-lsp#fix-safety">LSP docs</a> for more details.</p>
<p>The safety of fixes can be adjusted per rule using the
<a href="https://docs.astral.sh/ruff/settings#extend-safe-fixes"><code>extend-safe-fixes</code></a> and
<a href="https://docs.astral.sh/ruff/settings#extend-unsafe-fixes"><code>extend-unsafe-fixes</code></a> settings, allowing
you to customize safety levels for your use-case.</p>
<p>See the <a href="https://docs.astral.sh/ruff/configuration/#fix-safety">docs</a> for more details on fix
safety.</p>
<h2><span id="ruffs-versioning-policy"></span>Ruff&#39;s versioning policy<!-- --> <a href="#ruffs-versioning-policy">#</a></h2>
<p>Thus far, Ruff releases have only involved incrementing the patch version number. This versioning
scheme suffers from a few core problems:</p>
<ul>
<li>There is no documented policy and little room for a meaningful policy</li>
<li>Rules are added in most releases, resulting in significant new violations for users on upgrade</li>
<li>Users cannot get bug fix upgrades with confidence that they will not need to do other work</li>
<li>Ruff is not perceived as stable</li>
</ul>
<p>With the promotion to v0.1.0, Ruff can adopt a meaningful rules around versioning to ensure that
users know what to expect from each release. With the addition of a minor version number, we hope
to:</p>
<ul>
<li>Reduce the frequency of large changes</li>
<li>Give rules a period for stabilization before enabling</li>
<li>Differentiate between breaking and non-breaking releases</li>
<li>Move towards stronger stability guarantees</li>
</ul>
<p>With the release of 0.1.0, Ruff includes a full versioning policy. Briefly:</p>
<ul>
<li>The <strong>minor</strong> version will be used for stabilization of <strong>preview</strong> features, changes to
<strong>stable</strong> behavior, and breaking changes.</li>
<li>The <strong>patch</strong> version will be used for bug fixes and <em>any</em> changes to rules or fixes in
<strong>preview.</strong></li>
</ul>
<p>Check out the <a href="https://docs.astral.sh/ruff/versioning/">docs</a> for a full description of the policy.</p>
<h2><span id="a-new-home-for-ruffs-documentation"></span>A new home for Ruff&#39;s documentation<!-- --> <a href="#a-new-home-for-ruffs-documentation">#</a></h2>
<p>Our documentation has moved from <a href="https://beta.ruff.rs/docs">beta.ruff.rs/docs</a> to
<a href="https://docs.astral.sh/">docs.astral.sh</a>. We&#39;re excited to remove the beta label and move the
documentation under the umbrella of our
<a href="https://astral.sh/blog/announcing-astral-the-company-behind-ruff">growing company</a>. All existing
links redirect to the new domain, and should continue to work as-before.</p>
<h2><span id="thank-you"></span>Thank you!<!-- --> <a href="#thank-you">#</a></h2>
<p>Thousands of community members visit our repository every day, and we continue to be energized by
the incredible positivity around Ruff. It&#39;s a privilege and joy to build this project in
collaboration with our 282 contributors, plus all of those that have engaged with the project along
the way, be it on Discord or by filing an Issue. A big thank-you to everyone that&#39;s participated in
this wonderful community.</p>
<hr/>
<p>View the full changelog on <a href="https://github.com/astral-sh/ruff/releases/tag/v0.1.0">GitHub</a>.</p>
<p>We&#39;re hiring! Read more about <a href="https://astral.sh/about">Astral</a> — the company behind Ruff.</p></article></div>
  </body>
</html>
