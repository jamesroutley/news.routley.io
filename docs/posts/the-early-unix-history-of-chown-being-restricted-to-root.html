<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/ChownRestrictionEarlyHistory">Original</a>
    <h1>The early Unix history of chown() being restricted to root</h1>
    
    <div id="readability-page-1" class="page"><div><h2>The early Unix history of chown() being restricted to root</h2>

	<p><small>October 12, 2025</small></p>
</div><div><p>A few years ago I wrote about <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/ChownDivideAndQuotas">the divide in chown() about who got
to give away files</a>, where BSD and V7 were
on one side, restricting it to root, while System III and System V
were on the other, allowing the owner to give them away too. At the
time I quoted <a href="https://minnie.tuhs.org/cgi-bin/utree.pl?file=V7/usr/man/man2/chown.2">the V7 chown(2)</a>
explanation of this:</p>

<blockquote><p>[...] Only the super-user may execute this call, because if users
were able to give files away, they could defeat the (nonexistent)
file-space accounting procedures.</p>
</blockquote>

<p>Recently, <a href="https://adhd.irenes.space/@ireneista/statuses/01K7D39DD8Z4S02G9JZDZ8F0JV">for reasons</a>,
chown(2) and its history was on my mind and so I wondered if the early
Research Unixes had always had this, or if a restriction was added at
some point.</p>

<p>The answer is that the restriction was added in V6, where <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=V6/usr/man/man2/chown.2">the V6
chown(2) manual page</a> has
the same wording as V7. In Research Unix V5 and earlier, people can
chown(2) away their own files; this is documented in <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=V4/man/man2/chown.2">the V4
chown(2) manual page</a>
and is what <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=V5/usr/sys/ken/sys4.c">the V5 kernel code for chown() does</a>.
This behavior runs all the way back to <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=V1/man/man2/chown.2">the V1 chown() manual
page</a>,
with an extra restriction that you can&#39;t chown() setuid files.</p>

<p>(Since I looked it up, the restriction on chown()&#39;ing setuid files
was lifted in V4. In V4 and later, a setuid file has its setuid bit
removed on chown; in V3 you still can&#39;t give away such a file,
according to <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=V3/man/man2/chown.2">the V3 chown(2) manual page</a>.)</p>

<p>At this point you might wonder where the <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/SystemIIIBlindSpot">System III</a>
and System V unrestricted chown came from. The surprising to me
answer seems to be that System III partly descends from <a href="https://en.wikipedia.org/wiki/PWB/UNIX">PWB/UNIX</a>, and PWB/UNIX 1.0, although
it was theoretically based on V6, has pre-V6 chown(2) behavior
(<a href="https://www.tuhs.org/cgi-bin/utree.pl?file=PWB1/sys/sys/os/sys4.c">kernel source</a>,
<a href="https://www.tuhs.org/cgi-bin/utree.pl?file=PWB1/usr/man/man2/chown.2">manual page</a>). I
suspect that there&#39;s a story both to why V6 made chown() more
restricted and also why PWB/UNIX specifically didn&#39;t take that
change from V6, but I don&#39;t know if it&#39;s been documented anywhere
(a casual Internet search didn&#39;t turn up anything).</p>

<p>(The <a href="https://www.tuhs.org/cgi-bin/utree.pl?file=SysIII/usr/src/man/man2/chown.2">System III chown(2) manual page</a>
says more or less the same thing as the PWB/UNIX manual page, just
more formally, and the kernel code is very similar.)</p>
</div></div>
  </body>
</html>
