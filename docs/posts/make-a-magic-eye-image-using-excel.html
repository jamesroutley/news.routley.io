<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/">Original</a>
    <h1>Make a &#34;Magic Eye&#34; image using Excel</h1>
    
    <div id="readability-page-1" class="page"><article id="post-5785">
	

	<div>

		<!-- .entry-header -->

		<div>
			
<p>I’ve been on a weird kick lately making images using Excel. [Here’s <a href="https://divisbyzero.com/2024/11/13/making-the-mandelbrot-set-with-excel/">one post</a>. I hope to post more soon.] If you add a background color to each cell in a spreadsheet and resize the cell widths to make each one square, then you can zoom out so that each cell acts like a pixel in an image. </p>



<p>In this post, I show how you can create your own “Magic Eye” image using Excel. (I also give you an <a href="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyetemplate.xlsx">Excel spreadsheet</a> to get you started.) Technically these images are called <a href="https://en.wikipedia.org/wiki/Autostereogram">autostereograms</a>. These are two-dimensional images that appear three-dimensional when viewed correctly with your two eyes. Here are some tips for viewing these images.</p>



<ol>
<li>Relax your eyes.</li>



<li>Let your eyes diverge. Look through the image as if it’s a window, and you are focusing on something beyond it.</li>



<li>If there are similar patterns in the pixels, allow them to come together as one in your vision.</li>
</ol>



<p>Here’s one example I made. You shoud see a flat background with one large copy of the letter π floating a little above the background (closer to you).  I have several other examples at the end of this post. (These all work better on a larger screen—not on a phone screen.)</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png"><img data-attachment-id="5788" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/pi/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png" data-orig-size="2376,2380" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="pi" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=1000" width="1022" height="1023" src="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=1022" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=1022 1022w, https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=2044 2044w, https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/pi.png?w=768 768w" sizes="(max-width: 1022px) 100vw, 1022px"/></a></figure>



<p>I’ll now share how I made these images and give you enough details to make your own. If you want to make your own, <a href="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyetemplate.xlsx">download this Excel file</a>, which has my sample code in it.</p>



<p>The Excel file has three tabs at the bottom: the “Final” tab has the final image, the “Raw” tab contains the depth map for the image you’d like to create, and the “Parameters” tab allows you to adjust three parameters. </p>



<p><strong>Raw tab.</strong> This tab contains the 300×300 “depth map” for the desired 3D image. In my π example above, there are only two depths—the background (corresponding to 0 in the cell) and the π in the foreground (1). If you want to design a more complex shape with more depth, you can have different values in the cells (they do not have to be integers). For instance, two of the images below show undulating surfaces with varrying depths. </p>



<p>I used ChatGPT to help create the depth map for π. First, I created the image shown below with a black π on a white background. I then uploaded it to ChatGPT and typed the following prompt.</p>



<pre><code>I am uploading a square black and white image. I would like a csv file with 300 rows and 300 columns that shows this image. In particular, I would like you to imagine shrinking this down to a 300x300 image, and then converting the white pixels to be 0 and the black pixels to be 1. </code></pre>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png"><img data-attachment-id="5799" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/magiceyepi/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png" data-orig-size="1255,1255" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="magiceyepi" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=1000" width="1255" height="1255" src="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png 1255w, https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=150&amp;h=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=300&amp;h=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=768&amp;h=768 768w, https://divisbyzero.com/wp-content/uploads/2024/11/magiceyepi.png?w=1024&amp;h=1024 1024w" sizes="(max-width: 1255px) 100vw, 1255px"/></a></figure>



<p>For the two images showing surfaces, I begain with a top row and a left column that gave a sequence of points along the x- and y-axes, respectively. Then, I created a formula in each cell that evaluated a function at the corresponding x and y values. Here’s the code in cell B2 for one example.</p>



<pre><code>=SIN(SQRT(B$1^2+$A2^2))/SQRT(B$1^2+$A2^2)+1</code></pre>



<p><strong>Parameters tab.</strong> This tab allows you to enter three values that will change the look of the final image: <code>numcolors,</code> <code>backshift,</code> and <code>multfactor.</code> </p>



<p><strong>Final tab. </strong>The “Final” tab contains the final image. To view this page, you want to zoom far enough out that the entire image is visible. You don’t have to edit this page at all. It is generated using the information you provide in the other two tabs. </p>



<p>This page is a 300×300 grid, and each cell contains a number 1 through <code>numcolors.</code>  Excel’s “conditional formatting” colors the page automatically based on the number. (You can change the colors by changing the conditional formatting for these cells.) </p>



<p>Each cell has code like the following. (This code is in cell A1.)</p>



<pre><code>=LET(
depth,Raw!A1,
numcolors,Parameters!$B$1,
backshift,Parameters!$B$2,
multfactor,Parameters!$B$3,
pixelshift,TRUNC(backshift-depth*multfactor),
IF(
COLUMN()&gt;backshift,
OFFSET(A1,0,-pixelshift),
RANDBETWEEN(1,numcolors)
)
)</code></pre>



<p>Here’s what it does. The general idea is that we want our two eyes to see two different horizontally-separated pixels of the same color as one pixel. The closer together the pair of pixels, the nearer to you the combined pixels will seem when looking at the image with both eyes.</p>



<p>For the first <code>backshift</code> number of columns, the code randomly assigns a number (which we think of as a color): 1 through <code>numcolors.</code> For the rest of the columns, the color of a pixel is the same as the color of some pixel to its left. For points on the flat background (corresponding to a depth of 0), each pixel is the same color as the pixel <code>backshift</code> spaces to the left. My π example has <code>backshift</code>= 40. The pixels we want to appear closer to us should be closer together; in this code, such a pixel is the same color as the one <code>backshift-depth*multfactor</code> cells away. In our π example, we have <code>multfactor</code>= 4, so a depth of 1 yields a shift of <img src="https://s0.wp.com/latex.php?latex=40-1%5Ccdot+4%3D36.&amp;bg=ffffff&amp;fg=6a6c6e&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=40-1%5Ccdot+4%3D36.&amp;bg=ffffff&amp;fg=6a6c6e&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=40-1%5Ccdot+4%3D36.&amp;bg=ffffff&amp;fg=6a6c6e&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="40-1\cdot 4=36."/></p>



<p>That’s it! Have fun playing. Here are some examples. </p>



<p>This one shows a familiar mathematical variable.</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/x.png"><img data-attachment-id="5789" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/x/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/x.png" data-orig-size="2368,2370" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="x" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=1000" width="1024" height="1024" src="https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=1024" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=1024 1024w, https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=2046 2046w, https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/x.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>This one shows a familiar mathematical symbol.</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png"><img data-attachment-id="5790" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/infinity/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png" data-orig-size="2368,2370" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="infinity" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=1000" loading="lazy" width="1024" height="1024" src="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=1024" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=1024 1024w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=2046 2046w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>This one shows a surface: the graph of a multivariable function.</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png"><img data-attachment-id="5812" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/function1-2/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png" data-orig-size="2386,2372" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="function1" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=1000" loading="lazy" width="1024" height="1017" src="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=1024" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=1024 1024w, https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=2046 2046w, https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/function1-1.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>This one shows a surface: the graph of a multivariable function. </p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png"><img data-attachment-id="5792" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/function2/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png" data-orig-size="2386,2372" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="function2" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=1000" loading="lazy" width="1024" height="1017" src="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=1024" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=1024 1024w, https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=2046 2046w, https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/function2.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>This one shows one of our earlier symbols again. I changed the pattern for the first few columns. That gave this repeating look.</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png"><img data-attachment-id="5795" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/pi2/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png" data-orig-size="1200,1200" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="pi2" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=300" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=1000" loading="lazy" width="1024" height="1024" src="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=1024" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=1024 1024w, https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=300 300w, https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png?w=768 768w, https://divisbyzero.com/wp-content/uploads/2024/11/pi2.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>This one shows one of our earlier symbols again. I changed the pattern for the first few columns. That gave this repeating look.</p>



<figure><a href="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png"><img data-attachment-id="5794" data-permalink="https://divisbyzero.com/2024/11/30/make-a-magic-eye-image-using-excel/infinity2/" data-orig-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png" data-orig-size="1200,1212" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="infinity2" data-image-description="" data-image-caption="" data-medium-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=297" data-large-file="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=1000" loading="lazy" width="1014" height="1024" src="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=1014" alt="" srcset="https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=1014 1014w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=150 150w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=297 297w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png?w=768 768w, https://divisbyzero.com/wp-content/uploads/2024/11/infinity2.png 1200w" sizes="(max-width: 1014px) 100vw, 1014px"/></a></figure>
					</div><!-- .entry-content -->

		
			</div><!-- .entry-inner -->
</article></div>
  </body>
</html>
