<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://telefoncek.si/2025/02/2025-02-10-hidden-microphone-on-nanokvm/">Original</a>
    <h1>How I discovered a hidden microphone on a Chinese NanoKVM</h1>
    
    <div id="readability-page-1" class="page"><article itemscope="" itemtype="http://schema.org/BlogPosting">
	<div itemprop="articleBody">
		<p>NanoKVM is a <strong>hardware KVM switch</strong> developed by the Chinese company Sipeed. Released last year, it enables remote control of a computer or server using a virtual keyboard, mouse, and monitor. Thanks to its compact size and low price, it quickly gained attention online, especially when the company promised to release its code as open-source. However, as we’ll see, the device has some serious security issues. But first, let’s start with the basics.</p>

<h2 id="how-does-the-device-work">How Does the Device Work?</h2>

<p>As mentioned, NanoKVM is a KVM switch designed for remotely controlling and managing computers or servers. It features an HDMI port, three USB-C ports, an Ethernet port for network connectivity, and a special serial interface. The package also includes a small accessory for managing the power of an external computer.</p>

<p>Using it is quite simple. First, you connect the device to the internet via an Ethernet cable. Once online, you can access it through a standard web browser (though <em>JavaScript JIT</em> must be enabled). The device supports Tailscale VPN, but with some effort (read: hacking), it can also be configured to work with your own VPN, such as WireGuard or OpenVPN server. Once set up, you can control it from anywhere in the world via your browser.</p>

<div>
<p><a href="https://bugwhisperer.dev/static/2025/02/NanoKVM.jpg">
<img src="https://bugwhisperer.dev/static/2025/02/NanoKVM.jpg" alt="NanoKVM"/></a></p><p>
NanoKVM
</p>
</div>

<p>The device could be connected to the target computer using an HDMI cable, capturing the video output that would normally be displayed on a monitor. This allows you to view the computer’s screen directly in your browser, essentially acting as a virtual monitor.</p>

<p>Through the USB connection, NanoKVM can also emulate a keyboard, mouse, CD-ROM, USB drive, and even a USB network adapter. This means you can remotely control the computer as if you were physically sitting in front of it - but all through a web interface.</p>

<p>While it functions similarly to remote management tools like RDP or VNC, it has one key difference: there’s no need to install any software on the target computer. Simply plug in the device, and you’re ready to manage it remotely. NanoKVM even allows you to enter the BIOS, and with the additional accessory for power management, you can remotely turn the computer on, off, or reset it.</p>

<p>This makes it incredibly useful - you can power on a machine, access the BIOS, change settings, mount a virtual bootable CD, and install an operating system from scratch, just as if you were physically there. Even if the computer is on the other side of the world.</p>

<p>NanoKVM is also quite affordable. The fully-featured version, which includes all ports, a built-in mini screen, and a case, costs just over €60, while the stripped-down version is around €30. By comparison, a similar RaspberryPi-based device, PiKVM, costs around €400. However, PiKVM is significantly more powerful and reliable and, with a KVM splitter, can manage multiple devices simultaneously.</p>

<p>As mentioned earlier, the announcement of the device caused quite a stir online - not just because of its low price, but also due to its compact size and minimal power consumption. In fact, it can be powered directly from the target computer via a USB cable, which it also uses to simulate a keyboard, mouse, and other USB devices. So you have only one USB cable - in one direction it powers NanoKVM, on the other it helps it to simulate keyboard mouse and other devices on a computer you want to manage.</p>

<p>The device is built on the open-source RISC-V processor architecture, and the manufacturer eventually did release the device’s software under an open-source license at the end of last year. (To be fair, one part of the code remains closed, but the community has already found a suitable open-source replacement, and the manufacturer has promised to open this portion soon.)</p>

<p><strong>However, the real issue is security.</strong></p>

<p>Understandably, the company was eager to release the device as soon as possible. In fact, an early version had a minor hardware design flaw - due to an incorrect circuit cable, the device sometimes failed to detect incoming HDMI signals. As a result, the company recalled and replaced all affected units free of charge. Software development also progressed rapidly, but in such cases, the primary focus is typically on getting basic functionality working, with security taking a backseat.</p>

<p>So, it’s not surprising that the developers made some serious missteps - rushed development often leads to stupid mistakes. But some of the security flaws I discovered in my quick (and by no means exhaustive) review are genuinely concerning.</p>

<p>One of the <a href="https://www.hackster.io/news/security-researcher-warns-on-sipeed-s-nanokvm-finds-vulnerabilities-and-a-cat-in-the-firmware-e1157a9ff0f4">first security analysis revealed numerous vulnerabilities</a> - and some rather bizarre discoveries. For instance, a security researcher even found an image of a cat embedded in the firmware. While the Sipeed developers acknowledged these issues and relatively quickly fixed at least some of them, many remain unresolved.</p>

<div>
<p><a href="https://bugwhisperer.dev/static/2025/02/device.jpg">
<img src="https://bugwhisperer.dev/static/2025/02/device.jpg" alt="NanoKVM"/></a></p><p>
NanoKVM
</p>
</div>

<p>After purchasing the device myself, I ran a quick security audit and found several alarming flaws. The device initially came with a default password, and <code>SSH</code> access was enabled using this preset password. I reported this to the manufacturer, and to their credit, they fixed it relatively quickly. However, many other issues persist.</p>

<p>The user interface is riddled with security flaws - there’s no CSRF protection, no way to invalidate sessions, and more. Worse yet, the encryption key used for password protection (when logging in via a browser) is <strong>hardcoded and identical</strong> across all devices. This is a major security oversight, as it allows an attacker to easily decrypt passwords. More problematic, this needed to be explained to the developers. Multiple times.</p>

<p>Another concern is the device’s reliance on Chinese DNS servers. And configuring your own (custom) DNS settings is quite complicated. Additionally, the device communicates with Sipeed’s servers in China - downloading not only updates but also the closed-source component mentioned earlier. For this closed source component it needs to verify an identification key, which is stored on the device in plain text. Alarmingly, the device does not verify the integrity of software updates, includes a strange version of the WireGuard VPN application (which does not work on some networks), and runs a heavily stripped-down version of Linux that lacks <code>systemd</code> and <code>apt</code>. And these are just a few of the issues.</p>

<p>Were these problems simply oversights? Possibly. But what additionally raised red flags was the presence of <code>tcpdump</code> and <code>aircrack</code> - tools commonly used for network packet analysis and wireless security testing. While these are useful for debugging and development, they are also <strong>hacking tools</strong> that can be dangerously exploited. I can understand why developers might use them during testing, but they have absolutely no place on a production version of the device.</p>

<p>A Hidden Microphone</p>

<p>And then I discovered something even more alarming - <strong>a tiny built-in microphone that isn’t clearly mentioned in the official documentation</strong>. It’s a miniature SMD component, measuring just 2 x 1 mm, yet capable of recording surprisingly high-quality audio.</p>

<p>What’s even more concerning is that all the necessary recording tools are already installed on the device! By simply connecting via <code>SSH</code> (remember, the device initially used default passwords!), I was able to start recording audio using the amixer and arecord tools. Once recorded, the audio file could be easily copied to another computer. With a little extra effort, it would even be possible to stream the audio over a network, allowing an attacker to eavesdrop in real time.</p>

<div>
<p><a href="https://bugwhisperer.dev/static/2025/02/hidden_microphone.jpg">
<img src="https://bugwhisperer.dev/static/2025/02/hidden_microphone.jpg" alt="Hidden Microphone in NanoKVM"/></a></p><p>
Hidden Microphone in NanoKVM
</p>
</div>

<p>Physically removing the microphone is possible, but it’s not exactly straightforward. As seen in the image, disassembling the device is tricky, and due to the microphone’s tiny size, you’d need a microscope or magnifying glass to properly desolder it.</p>

<p><strong>To summarize</strong>: the device is riddled with security flaws, originally shipped with default passwords, communicates with servers in China, comes preinstalled with hacking tools, and even includes a built-in microphone - fully equipped for recording audio - without clear mention of it in the documentation. Could it get any worse?</p>

<p>I am pretty sure these issues stem from extreme negligence and rushed development rather than malicious intent. However, that doesn’t make them any less concerning.</p>

<p>That said, these findings don’t mean the device is entirely unusable.</p>

<p>Since the device is open-source, it’s entirely possible to install custom software on it. In fact, <a href="https://github.com/scpcom/sophgo-sg200x-debian">one user has already begun porting his own Linux distribution</a> - starting with Debian and later switching to Ubuntu. With a bit of luck, this work could soon lead to official Ubuntu Linux support for the device.</p>

<p>This custom Linux version already runs the manufacturer’s modified KVM code, and within a few months, we’ll likely have a fully independent and significantly more secure software alternative. The only minor inconvenience is that installing it requires physically opening the device, removing the built-in SD card, and flashing the new software onto it. However, in reality, this process isn’t too complicated.</p>

<p>And while you’re at it, you might also want to remove the microphone… or, if you prefer, connect a speaker. In my test, I used an 8-ohm, 0.5W speaker, which produced surprisingly good sound - essentially turning the NanoKVM into a tiny music player. Actually, the idea is not so bad, because <a href="https://docs.pikvm.org/audio/">PiKVM also included 2-way audio support for their devices end of last year</a>.</p>

<div>
<p><a href="https://bugwhisperer.dev/static/2025/02/speaker.jpg">
<img src="https://bugwhisperer.dev/static/2025/02/speaker.jpg" alt="Basic board with speaker"/></a></p><p>
Basic board with speaker
</p>
</div>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>All this of course raises an interesting question: How many similar devices with hidden functionalities might be lurking in your home, just waiting to be discovered? And not just those of Chinese origin. Are you absolutely sure none of them have built-in miniature microphones or cameras?</p>

<p>You can start with your iPhone - <a href="https://arstechnica.com/tech-policy/2025/01/apple-agrees-to-pay-95m-delete-private-conversations-siri-recorded/">last year Apple has agreed to pay $95 million to settle a lawsuit alleging that its voice assistant Siri recorded private conversations</a>. They shared the data with third parties and used them for targeted ads. “Unintentionally”, of course! Yes, that Apple, that cares about your privacy so much.</p>

<p>And Google is doing the same. They are facing a similar lawsuit over their voice assistant, but the litigation likely won’t be settled until this fall. So no, small Chinese startup companies are not the only problem. And if you are worried about Chinese companies obligations towards Chinese government, let’s not forget that U.S. companies also have obligations to cooperate with U.S. government. While Apple is publicly claiming they do not cooperate with FBI and other U. S. agencies (because thy care about your privacy so much), some media revealed that Apple was holding a series secretive Global Police Summit at its Cupertino headquarters <a href="https://www.forbes.com/sites/thomasbrewster/2024/10/09/apple-sells-privacy-to-consumers-but-its-quietly-helping-police-use-iphones-for-surveillance/">where they taught police how to use their products for surveillance and policing work</a>. And as one of the police officers pointed out - he has “<em>never been part of an engagement that was so collaborative</em>.”. Yep.</p>

<h3 id="ps-how-to-record-audio-on-nanokvm">P.S. How to Record Audio on NanoKVM</h3>

<p>If you want to test the built-in microphone yourself, simply connect to the device via <code>SSH</code> and run the following two commands:</p>

<ul>
  <li><code>amixer -Dhw:0 cset name=&#39;ADC Capture Volume 20&#39;</code> (<em>this sets microphone sensitivity to high</em>)</li>
  <li><code>arecord -Dhw:0,0 -d 3 -r 48000 -f S16_LE -t wav test.wav &amp; &gt; /dev/null &amp;</code> (<em>this will capture the sound to a file named <code>test.wav</code></em>)</li>
</ul>

<p>Now, speak or sing (perhaps the Chinese national anthem?) near the device, then press <code>Ctrl + C</code>, copy the <code>test.wav</code> file to your computer, and listen to the recording.</p>

	</div>
</article></div>
  </body>
</html>
