<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://ballingt.com/observable-hugo-shortcode/">Original</a>
    <h1>Observable Hugo Shortcode</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Here’s a shortcode for embedding Observable notebooks in Hugo.</p>
<pre tabindex="0"><code>{{&lt; obs
    specifier=&#34;@ballingt/embedding-example&#34;
    cells=&#34;vegaPetalsWidget,viewof minSepalLength,viewof minSepalWidth&#34;
&gt;}}
</code></pre><p>When the shortcode is installed in layouts/shortcodes/obs.html in your Hugo site, the input above produces the output below.</p>



<p>Here’s the code to stick in the file layouts/shortcodes/obs.html.</p>
<div><pre tabindex="0"><code data-lang="html">&lt;<span>iframe</span>
  <span>width</span><span>=</span><span>&#34;100%&#34;</span>
  <span>frameborder</span><span>=</span><span>&#34;0&#34;</span>
  <span>src</span><span>=</span><span>&#34;https://observablehq.com/embed/{{
</span><span>    .Get &#34;</span><span>specifier</span><span>&#34;</span>
  <span>}}{{</span> <span>with</span> <span>.</span><span>Get</span> <span>&#34;</span><span>cells</span><span>&#34;</span>
    <span>}}?</span><span>cells</span><span>=</span><span>{{</span> <span>.</span> <span>}}{{</span>
  <span>end</span> <span>}}&#34;</span>&gt;&lt;/<span>iframe</span>&gt;
&lt;<span>script</span>&gt;
(<span>function</span>() {
  <span>const</span> <span>scripts</span> <span>=</span> document.<span>querySelectorAll</span>(<span>&#39;script&#39;</span>);
  <span>const</span> <span>iframe</span> <span>=</span> <span>scripts</span>[<span>scripts</span>.<span>length</span> <span>-</span> <span>1</span>].<span>previousElementSibling</span>;
  window.<span>addEventListener</span>(<span>&#34;message&#34;</span>, (<span>e</span>) =&gt; {
    <span>if</span> (<span>e</span>.<span>origin</span> <span>===</span> <span>&#39;https://observablehq.com&#39;</span> <span>&amp;&amp;</span>
        <span>e</span>.<span>source</span> <span>===</span> <span>iframe</span>.<span>contentWindow</span>) {
      <span>const</span> <span>msg</span> <span>=</span> <span>JSON</span>.<span>parse</span>(<span>e</span>.<span>data</span>)
      <span>if</span> (<span>msg</span>.<span>context</span> <span>===</span> <span>&#39;iframe.resize&#39;</span>) {
        <span>iframe</span>.<span>height</span> <span>=</span> <span>msg</span>.<span>height</span>;
      }
    }
  });
})();
&lt;/<span>script</span>&gt;
</code></pre></div>
</div></div>
  </body>
</html>
