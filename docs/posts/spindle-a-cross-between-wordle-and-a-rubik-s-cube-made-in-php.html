<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://playspindle.com/">Original</a>
    <h1>Show HN: Spindle, a cross between Wordle and a Rubik&#39;s Cube made in PHP</h1>
    
    <div id="readability-page-1" class="page"><div>
                <div>
        
        <div wire:snapshot="{&#34;data&#34;:{&#34;grid&#34;:null,&#34;targetWord&#34;:&#34;DEFAULT&#34;,&#34;currentDate&#34;:&#34;&#34;,&#34;turnCount&#34;:0,&#34;userTimestamp&#34;:0,&#34;victory&#34;:false,&#34;leaderboard&#34;:null,&#34;gameId&#34;:&#34;XwfLTRiKihkKa8YJxJyUBreM85cU4mA4lsCD9vMk&#34;},&#34;memo&#34;:{&#34;id&#34;:&#34;1Fqfe7qZTHRNzsbyWP5A&#34;,&#34;name&#34;:&#34;spindle&#34;,&#34;path&#34;:&#34;\/&#34;,&#34;method&#34;:&#34;GET&#34;,&#34;children&#34;:[],&#34;scripts&#34;:[],&#34;assets&#34;:[],&#34;errors&#34;:[],&#34;locale&#34;:&#34;en&#34;},&#34;checksum&#34;:&#34;00fb29f01ceef288842f385446e6eff58be452e32db828e8c28f825fa690d026&#34;}" wire:effects="[]" wire:id="1Fqfe7qZTHRNzsbyWP5A" x-data="{ 
    start: null, 
    end: null,
    invalidWordStart: null,
    invalidWordEnd: null,
    validWordStart: null,
    validWordEnd: null,
    loading: false,
    spinning: false,
    showHelp: false,

    invalidWord(row, col) {
        if (!this.invalidWordStart || !this.invalidWordEnd) {
            return false;
        }
        if (this.invalidWordStart[0] === this.invalidWordEnd[0]) {
            // horizontal word
            return row === this.invalidWordStart[0] &amp;&amp; 
              col &gt;= this.invalidWordStart[1] &amp;&amp; 
              col &lt;= this.invalidWordEnd[1];
        }
        return col === this.invalidWordStart[1] &amp;&amp; 
          row &gt;= this.invalidWordStart[0] &amp;&amp; 
          row &lt;= this.invalidWordEnd[0];
    },

    validWordAnimation(row, col) {
        if (!this.validWordStart || !this.validWordEnd) {
            return &#39;&#39;;
        }
        if (this.validWordStart[0] === this.validWordEnd[0]) {
            // horizontal word
            if (row !== this.validWordStart[0] ||
              col &lt; this.validWordStart[1] || 
              col &gt; this.validWordEnd[1]) {
                return &#39;&#39;;
            }
            // check how far left or right of &#39;center&#39; we are, and return
            // the appropriate animation
            const center = this.validWordStart[1] + (this.validWordEnd[1] - this.validWordStart[1])/2;
            const offset = col - center;
            return `z-20 animate-rotate-x-${offset.toString().replace(/\.5.*/, &#39;-5&#39;)}`;
        }
        // vertical word
        if (col !== this.validWordStart[1] ||
          row &lt; this.validWordStart[0] || 
          row &gt; this.validWordEnd[0]) {
            return &#39;&#39;;
        }
        // check how far above or below of &#39;center&#39; we are, and return
        // the appropriate animation
        const center = this.validWordStart[0] + (this.validWordEnd[0] - this.validWordStart[0])/2;
        const offset = row - center;
        return `z-20 animate-rotate-y-${offset.toString().replace(/\.5.*/, &#39;-5&#39;)}`;
    },

    validWordAnimationText(row, col) {
        const outer = this.validWordAnimation(row, col);
        return outer ? `animate-rotate-text-counter` : &#39;&#39;;
    },

    startOrEnd(row, col) {
        return (
            this.start?.[0] === row &amp;&amp; this.start?.[1] === col ||
            this.end?.[0] === row &amp;&amp; this.end?.[1] === col
        );
    },

    letterBackground(row, col) {
        const inTarget = $wire.targetWord.includes($wire.grid[row][col]);
        if (this.startOrEnd(row, col)) {
            return `bg-green-500 dark:bg-green-600 ${this.loading ? &#39;animate-pulse&#39; : &#39;&#39;}`;
        }
        if (this.invalidWord(row, col)) {
            return `animate-pulse-bg-once from-red-500 ${inTarget ? &#39;to-sky-50 dark:to-slate-600&#39; : &#39;dark:to-slate-800 to-sky-200&#39;}`;
        }
        if (inTarget) {
            return &#39;bg-sky-300 dark:bg-slate-600&#39;;
        }

        return &#39;bg-sky-100 dark:bg-slate-800&#39;;
    },

    async clickOnLetter(row, col) {
        if (this.spinning || this.loading || $wire.victory) {
            return;
        }

        console.log(&#39;clickOnLetter&#39;, row, col);

        if (!this.start || this.end) {
            this.start = [row, col];
            this.end = null;
        } else {
            if (row === this.start[0] &amp;&amp; col === this.start[1]) {
                this.clearStartEnd();
            } else if (row !== this.start[0] &amp;&amp; col != this.start[1]) {
                this.start = [row, col];
                this.end = null;
            } else {
                this.end = [ row, col ];

                // ready to submit!
                console.log(&#39;Submitting move&#39;);
                this.loading = true;
                this.lastResult = await $wire.submit(this.start, this.end);
                this.loading = false;
                console.log(&#39;result&#39;, this.lastResult);

                if (this.lastResult.valid) {
                    // it was a valid move, do an animation
                    // it was invalid - flash the letters red
                    this.validWordStart = (this.start[0] &lt; this.end[0] || this.start[1] &lt; this.end[1]) ? this.start : this.end;
                    this.validWordEnd = this.validWordStart === this.start ? this.end : this.start;
                    this.spinning = true;
                    if ($wire.victory) {
                        this.makeConfetti();
                    }
                    setTimeout(() =&gt; {
                        this.validWordStart = null;
                        this.validWordEnd = null;
                        this.spinning = false;
                        this.clearStartEnd();
                    }, 1000);
                } else {
                    // it was invalid - flash the letters red
                    this.invalidWordStart = (this.start[0] &lt; this.end[0] || this.start[1] &lt; this.end[1]) ? this.start : this.end;
                    this.invalidWordEnd = this.invalidWordStart === this.start ? this.end : this.start;
                    setTimeout(() =&gt; {
                        this.invalidWordStart = null;
                        this.invalidWordEnd = null;
                    }, 500);
                    this.clearStartEnd();
                }
            }
        }
    },

    clearStartEnd() {
        if (this.spinning || this.loading || $wire.victory) {
            return;
        }
        console.log(&#39;clearStartEnd&#39;);
        this.start = null;
        this.end = null;
    },

    makeConfetti() {
        confetti({
            disableForReducedMotion: true,
            gravity: 1.5,
            scalar: 1.25,
            decay: 0.9,
            particleCount: 100,
        });
    },

    dismissHelp() {
        this.showHelp = false;
    },
    requestHelp() {
        this.showHelp = true;
    },
  }" @click.away="clearStartEnd" x-init="$wire.initialise(new Date().getTimezoneOffset())"> 
    <div x-transition="" x-cloak="" x-show="showHelp" @click.outside="dismissHelp">
        
        <p>
            The aim is to rearrange the grid so that the <strong>target word</strong>
            is spelled out (either horizontally or vertically).
        </p>
        <p>
            The grid is rearranged by spinning words â€” again, either horizontally
            or vertically.
        </p>
        <p>
            For example, you could spin
            <span>C</span><span>A</span><span>T</span>
            to obtain  
            <span>T</span><span>A</span><span>C</span>.
        </p>
        <p>
            You can also spin in reverse, so you could spin 
            <span>T</span><span>A</span><span>H</span><span>C</span>
            to make 
            <span>C</span><span>H</span><span>A</span><span>T</span>.
        </p>
        <p>
            Try to assemble the target word using the fewest spins possible.
        </p>
        
    </div>
    <!--[if BLOCK]><![endif]--> <!--[if ENDBLOCK]><![endif]-->
</div>


    </div>
            </div></div>
  </body>
</html>
