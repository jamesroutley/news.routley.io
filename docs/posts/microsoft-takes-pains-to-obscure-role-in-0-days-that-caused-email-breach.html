<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/security/2023/07/microsoft-takes-pains-to-obscure-role-in-0-days-that-caused-email-breach/">Original</a>
    <h1>Microsoft takes pains to obscure role in 0-days that caused email breach</h1>
    
    <div id="readability-page-1" class="page"><div>
            <h4>
      CYA    —
</h4>
            
            <h2 itemprop="description">Critics also decry Microsoft&#39;s &#34;pay-to-play&#34; monitoring that detected intrusions.</h2>
            <section>

  



  
</section>        </div><section>
            <div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2023/07/microsoft-exchange-azure-hiding-800x450.jpg" alt="Microsoft takes pains to obscure role in 0-days that caused email breach"/>
      <figcaption><p>Getty Images | Aurich Lawson</p></figcaption>  </figure>

  




<!-- cache hit 1:single/related:fbec121f1dc90d41de375d0c8b12a0f2 --><!-- empty -->
<p>On Friday, Microsoft attempted to explain the cause of a breach that gave hackers working for the Chinese government access to the email accounts of 25 organizations—reportedly including the US Departments of State and Commerce and other sensitive organizations.</p>
<p>In a <a href="https://www.microsoft.com/en-us/security/blog/2023/07/14/analysis-of-storm-0558-techniques-for-unauthorized-email-access/">post on Friday</a>, the company indicated that the compromise resulted from three exploited vulnerabilities in either its Exchange Online email service or <a href="https://azure.microsoft.com/en-us/products/active-directory/">Azure Active Directory</a>, an identity service that manages single sign-on and multifactor authentication for large organizations. Microsoft’s Threat Intelligence team said that Storm-0558, a China-based hacking outfit that conducts espionage on behalf of that country’s government, exploited them starting on May 15. Microsoft drove out the attackers on June 16 after a customer tipped off company researchers of the intrusion.</p>
<h2>Above all else: Avoid the Z-word</h2>
<p>In standard parlance among security professionals, this means that Storm-0558 exploited zero-days in the Microsoft cloud services. A “zero-day” is a vulnerability that is known to or exploited by outsiders before the vendor has a patch for it. “Exploit” means using code or other means to trigger a vulnerability in a way that causes harm to the vendor or others.</p>
<p>While both conditions are clearly met in the Storm-0558 intrusion, Friday’s post and <a href="https://msrc.microsoft.com/blog/2023/07/microsoft-mitigates-china-based-threat-actor-storm-0558-targeting-of-customer-email/">two</a> <a href="https://blogs.microsoft.com/on-the-issues/2023/07/11/mitigation-china-based-threat-actor/">others</a> Microsoft published Tuesday, bend over backward to avoid the words “vulnerability” or “zero-day.” Instead, the company uses considerably more amorphous terms such as “issue,” “error,” and “flaw” when attempting to explain how nation-state hackers tracked the email accounts of some of the company&#39;s biggest customers.</p>                                            
                                                        
<p>“In-depth analysis of the Exchange Online activity discovered that in fact the actor was forging Azure AD tokens using an acquired Microsoft account (MSA) consumer signing key,” Microsoft researchers wrote Friday. “This was made possible by a validation error in Microsoft code.”</p>
<p>Later in the post, the researchers said that Storm-0558 acquired an inactive signing key used for consumer cloud accounts and somehow managed to use it to forge tokens for Azure AD, a supposedly fortified cloud service that, in effect, stores the keys that thousands of organizations use to manage logins for accounts on both their internal networks and cloud-based ones.</p>
<p>“The method by which the actor acquired the key is a matter of ongoing investigation,” the post stated. “Though the key was intended only for MSA accounts, a validation issue allowed this key to be trusted for signing Azure AD tokens.”</p>
<p>Two paragraphs later, Microsoft said that Storm-0558 used the forged token to gain access to Exchange email accounts through a programming interface for Outlook Web Access (OWA). The researchers wrote:</p>
<blockquote><p>Once authenticated through a legitimate client flow leveraging the forged token, the threat actor accessed the OWA API to retrieve a token for Exchange Online from the GetAccessTokenForResource API used by OWA. The actor was able to obtain new access tokens by presenting one previously issued from this API due to a design flaw. This flaw in the GetAccessTokenForResourceAPI has since been fixed to only accept tokens issued from Azure AD or MSA respectively. The actor used these tokens to retrieve mail messages from the OWA API.</p></blockquote>
<p>A plain-English summary of the event would seem to be: Microsoft has patched three vulnerabilities in its cloud service that were discovered after Storm-0558 exploited them to gain access to customer accounts. It would also be helpful if Microsoft provided a tracking designation under the CVE (Common Vulnerabilities and Exposures) system the way other cloud companies do. So why doesn’t Microsoft do the same?</p>                                            
                                                        
<p>“I don&#39;t think Microsoft ever acknowledges vulnerabilities in their cloud services (also there&#39;s no CVEs for cloud), and you don&#39;t say breach at Microsoft,” independent researcher Kevin Beaumont <a href="https://cyberplace.social/@GossiTheDog/110713723694545488">said on Mastodon</a>. “They did say ‘exploit’ in the original MSRC blog in relation to Microsoft&#39;s cloud services, and you exploit a vulnerability. So I think it&#39;s fair to say that, yes, they had vuln(s).”</p>

<p>Microsoft issued the following comment: &#34;We don’t have any evidence that the actor exploited a 0day.&#34; Microsoft didn&#39;t elaborate. In one of the two posts published on Tuesday, Microsoft said: &#34;The actor exploited a token validation issue to impersonate Azure AD users and gain access to enterprise mail.&#34; Ars has asked for a clarification of exactly what was exploited by the threat actor.</p>
<h2>Pay-to-play security</h2>
<p>Besides being opaque about the root cause of the breach and its own role in it, Microsoft is under fire for withholding details that some of the victims could have used to detect the intrusion, something critics have called “pay-to-play security.” <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-193a">According to</a> the US Cybersecurity and Information Security Agency, one federal agency that was breached by Storm-0558, it discovered the intrusion through audit logs that track logins and other important events affecting customers’ Microsoft cloud events.</p>
<p>Microsoft, however, requires customers to <a href="https://learn.microsoft.com/en-US/microsoft-365/admin/manage/assign-licenses-to-users?view=o365-worldwide">pay an additional fee</a> to access these records. The cost for an “E5” enterprise license allowing such access is $57 per month per user, compared to an E3 license cost of $36 per month per customer.</p>
<p>“The fact that Microsoft only allows those who pay the extra money for E5 licensing to see the relevant log files is, well, something…” Will Dorman, senior principal analyst at Analygence, said in an interview. “If you&#39;re not an E5-paying customer, you lose the ability to see that you were compromised.”</p>
<p>While Microsoft’s disclosures have been less than forthcoming in the role its vulnerabilities played in breaching the accounts of organizations, Friday’s disclosure provides helpful indicators that people can use to determine if they’ve been targeted or compromised by Storm-0558.</p>

                                                </div>

            
            
        </section></div>
  </body>
</html>
