<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.alexellis.io/docker-is-deleting-open-source-images/">Original</a>
    <h1>Docker is deleting Open Source organisations - what you need to know</h1>
    
    <div id="readability-page-1" class="page"><div role="main">
   <article>

        <header>
            
            <section>
                <time datetime="2023-03-15">15 March 2023</time>  on <a href="https://blog.alexellis.io/tag/docker/">docker</a>, <a href="https://blog.alexellis.io/tag/open-source/">open source</a>, <a href="https://blog.alexellis.io/tag/community/">community</a>, <a href="https://blog.alexellis.io/tag/github/">github</a>
            </section>
        </header>

        <section>
            <div><p>Coming up with a title that explains the full story here was difficult, so I&#39;m going to try to explain quickly.</p>
<p>Yesterday, <a href="https://docker.com">Docker</a> sent an email to all Docker Hub users explaining that anyone who has created an &#34;organisation&#34; will have their account deleted including all images, if they do not upgrade to a paid team plan. The email contained a link to a tersely written PDF (since, silently edited) which was missing many important details which caused significant anxiety and additional work for open source maintainers.</p>
<blockquote>
<p>As far as we know, this only affects organisation accounts that are often used by open source communities. There was no change to personal accounts. Free personal accounts have a <a href="https://www.docker.com/blog/scaling-dockers-business-to-serve-millions-more-developers-storage">a 6 month retention period</a>.</p>
</blockquote>
<p>Why is this a problem?</p>
<ol>
<li>Paid team plans cost 420USD per year (paid monthly)</li>
<li>Many open source projects including ones I maintain have published images to the Docker Hub for years</li>
<li>Docker&#39;s Open Source program is hostile and out of touch</li>
</ol>
<p>Why should you listen to me?</p>
<p>I was one of the biggest advocates around for Docker, <a href="https://blog.alexellis.io/dockercon-2017-captains-log/">speaking at their events</a>, contributing to their projects and being a loyal member of their voluntary influencer program &#34;<a href="https://www.docker.com/blog/inside-look-docker-captains-program/">Docker Captains</a>&#34;. I have written dozens if not hundreds of articles and code samples on Docker as a technology.</p>
<p>I&#39;m not one of those people who think that all software and services should be free. I pay for a personal account, not because I publish images there anymore, but because I need to pull images like the base image for Go, or Node.js as part of my daily open source work.</p>
<p>When one of our OpenFaaS customers grumbled about paying for Docker Desktop, and wanted to spend several weeks trying to get Podman or Rancher Desktop working, I had to bite my tongue. If you&#39;re using a Mac or a Windows machine, it&#39;s worth paying for in my opinion. But that is a different matter.</p>
<p>Having known <a href="https://twitter.com/justincormack">Docker&#39;s new CTO</a> personally for a very long time, I was surprised how out of touch the communication was.</p>
<p>I&#39;m not the only one, you can read the reactions <a href="https://twitter.com/alexellisuk/status/1635679295891812359?s=20">on Twitter</a> (including many quote tweets) and on <a href="https://news.ycombinator.com/item?id=35154025">Hacker News</a>.</p>
<p>Let&#39;s go over each point, then explore options for moving forward with alternatives and resolutions.</p>
<h2 id="theissues">The issues</h2>
<ol>
<li>
<p>The cost of an organisation that hosts public images has risen from 0 USD / year to 420 USD / year. Many open source projects receive little to no funding. I would understand if Docker wanted to clamp down on private repos, because what open source repository needs them? I would understand if they applied this to new organisations.</p>
</li>
<li>
<p>Many open source projects have published images to the Docker Hub in this way for years, <a href="https://github.com/openfaas/faas">openfaas</a> as far back as 2016. Anyone could cybersquat the image and publish malicious content. The OpenFaaS project now publishes its free Community Edition images to GitHub&#39;s Container Registry, but we still see thousands of pulls of old images from the Docker Hub. Docker is holding us hostage here, if we don&#39;t pay up, systems will break for many free users.</p>
</li>
<li>
<p>Docker has a hostile and out of touch definition of what is allowable for their Open Source program. It rules out anything other than spare-time projects, or projects that have been wholly donated to an open-source foundation.</p>
</li>
</ol>
<blockquote>
<p>&#34;Not have a pathway to commercialization. Your organization must not seek to make a profit through services or by charging for higher tiers. Accepting donations to sustain your efforts is permissible.&#34;</p>
</blockquote>
<p>This language has been softened since the initial email, I assume in an attempt to reduce the backlash.</p>
<p><a href="https://blog.alexellis.io/the-5-pressures-of-leadership/">Open Source has a funding problem</a>, and Docker was born in Open Source. We the community were their king makers, and now that they&#39;re <a href="https://sacra.com/c/docker/">turning over significant revenue</a>, they are only too ready to forget their roots.</p>
<h2 id="theworkarounds">The workarounds</h2>
<p>Docker&#39;s <a href="https://twitter.com/justincormack/status/1635706522419200004?s=20">CTO commented informally on Twitter</a> that they will shut down accounts that do not pay up, and not allow anyone else to take over the name. I&#39;d like to see that published in writing, as a written commitment.</p>
<p>In an ideal world, these accounts would continue to be attached to the user account, so that if for some reason we wanted to pay for them, we&#39;d have access to restore them.</p>
<p>Squatting and the effects of malware and poison images is my primary concern here. For many projects I maintain, we already switched to publishing open source packages to GitHub&#39;s Container Registry. Why? Because Docker enforced <a href="https://docs.actuated.dev/examples/registry-mirror/">unrealistic rate limits</a> that means any and every user who downloads content from their Docker Hub requires a paid subscription - whether personal or corporate. I pay for one so that I can download images like Prometheus, NATS, Go, Python and Node.</p>
<h3 id="maybeyouqualifyfortheopensourceprogram">Maybe you qualify for the &#34;open source&#34; program?</h3>
<p>If the project you maintain is owned by a foundation like the CNCF or Apache Foundation, you may simply be able to apply to Docker&#39;s program. However if you are independent, and have any source of funding or any way to financial sustainability, I&#39;ll paraphrase Docker&#39;s leadership: &#34;sucks to be you.&#34;</p>
<p>Let&#39;s take an example? The <a href="https://daniel.haxx.se/">curl project maintained by Daniel Stenberg</a> - something that is installed on every Mac and Linux computer and certainly used by Docker. Daniel has a consulting company and does custom development. Such a core piece of Internet infrastructure seems to be disqualified.</p>
<blockquote data-conversation="none"><p lang="en" dir="ltr">There is an open-source exemption, but it&#39;s very strict (absolutely no &#34;pathway to commercialization&#34; - no services, no sponsors, no paid addons, and no pathway to ever do so later) and they&#39;re apparently taking &gt;1 year to process applications anyway.</p>— Tim Perry (@pimterry) <a href="https://twitter.com/pimterry/status/1635757752587829249?ref_src=twsrc%5Etfw">March 14, 2023</a></blockquote> 
<h3 id="cybersquatbeforeabadactorcan">Cybersquat before a bad actor can</h3>
<p>If you are able to completely delete your organisation, then you could re-create it as a free personal account. That should be enough to reserve the name to prevent hostile take-over. <a href="https://qz.com/646467/how-one-programmer-broke-the-internet-by-deleting-a-tiny-piece-of-code">Has Docker forgotten Remember leftpad?</a></p>
<p>This is unlikely that large projects can simply delete their organisation and all its images.</p>
<p>If that&#39;s the case, and you can tolerate some downtime, you could try the following:</p>
<ul>
<li>Create a new personal user account</li>
<li>Mirror all images and tags required to the new user account</li>
<li>Delete the organisation</li>
<li>Rename the personal user account to the name of the organisation</li>
</ul>
<h3 id="startpublishingimagestogithub">Start publishing images to GitHub</h3>
<p><a href="https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry">GitHub&#39;s Container Registry</a> offers free storage for public images. It doesn&#39;t require service accounts or long-lived tokens to be stored as secrets in CI, because it can mint a short-lived token to access ghcr.io already.</p>
<p>Want to see a full example of this?</p>
<p>We covered it on the actuated blog: <a href="https://actuated.dev/blog/multi-arch-docker-github-actions">The efficient way to publish multi-arch containers from GitHub Actions</a></p>
<p>If you already have an image on GitHub and want to start publishing new tags there using GitHub&#39;s built-in GITHUB_TOKEN, you&#39;ll need to go to the Package and edit its write permissions. Add the repository with &#34;Write&#34; access.</p>
<p>Make sure you do not miss the &#34;permissions&#34; section of the workflow file.</p>
<p><img src="https://blog.alexellis.io/content/images/2023/03/write_access--1-.png" alt="Setting up write access"/></p>
<blockquote>
<p>How to set up write access for an existing repository with GITHUB_TOKEN</p>
</blockquote>
<h3 id="migrateyourexistingimages">Migrate your existing images</h3>
<p>The crane tool by Google&#39;s open source office is able to mirror images in a much more efficient way than running docker pull, tag and push. The pull, tag and push approach also doesn&#39;t work with multi-arch images.</p>
<p>Here&#39;s an example command to list tags for an image:</p>
<pre><code>crane ls ghcr.io/openfaas/gateway | tail -n 5

0.26.1
c26ec5221e453071216f5e15c3409168446fd563
0.26.2
a128df471f406690b1021a32317340b29689c315
0.26.3
</code></pre>
<p>The <code>crane cp</code> command doesn&#39;t require a local docker daemon and copies directly from one registry to another:</p>
<pre><code>crane cp docker.io/openfaas/gateway:0.26.3 ghcr.io/openfaas/gateway:0.26.3
</code></pre>
<p>On Twitter, a full-time employee on the CNCF&#39;s <a href="https://goharbor.io/">Harbor</a> project also explained that it has a &#34;mirroring&#34; capability.</p>
<h2 id="wrappingup">Wrapping up</h2>
<p>Many open source projects moved away from the Docker Hub already when they started rate-limiting pulls of public open-source images like Go, Prometheus and NATS. I myself still pay Docker for an account, the only reason I have it is to be able to pull those images.</p>
<p>I am not against Docker making money, I already pay them money and have encouraged customers to do the same. My issue is with the poor messaging, the deliberate anxiety that they&#39;ve created for many of their most loyal and supportive community users and their hypocritical view of Open Source sustainability.</p>
<p>If you&#39;re using GitHub Actions, then it&#39;s easy to publish images to GHCR.io - you can use the example for the <a href="https://actuated.dev/blog/multi-arch-docker-github-actions">inlets-operator</a> I shared.</p>
<p>But what about GitHub&#39;s own reliability?</p>
<p>I was talking to a customer for <a href="https://actuated.dev">actuated</a> only yesterday. They were happy with our product and service, but in their first week of a PoC saw downtime due to GitHub&#39;s increasing number of outages and incidents.</p>
<p>We can only hope that whatever has caused issues almost every day since the start of the year is going to be addressed by leadership.</p>
<p>Is GitHub perfect?</p>
<p>I would have never predicted the way that Docker changed since its rebirth - from the darling of the open source community, on every developer&#39;s laptop, to where we are today. So with the recent developments on GitHub like Actions and GHCR only getting better, with them being acquired by Microsoft - it&#39;s tempting to believe that they&#39;re infallible and wouldn&#39;t make a decision that could hurt maintainers. All businesses need to work on a profit and loss basis. A prime example of how GitHub also hurt open source developers was when it cancelled all Sponsorships to maintainers that were paid over PayPal. This was done at very short notice, and it <a href="https://github.com/sponsors/alexellis">hit my own open source work very hard</a> - made even worse by the global downturn.</p>
<p>What if GitHub &#34;does a Docker on us&#34;?</p>
<p>What if GitHub starts charging for open source Actions minutes? Or for storage of Open Source and public repositories? That is a risk that we need to be prepared for and more of a question of &#34;when&#34; than &#34;if&#34;. It was only a few years ago that Travis CI was where Open Source projects built their software and collaborated. I don&#39;t think I&#39;ve heard them mentioned since then.</p>
<p>Let&#39;s not underestimate the lengths that Open Source maintainers will go to - so that they can continue to serve their communities. They already work day and night without pay or funding, so whilst it&#39;s not convenient for anyone, we will find a way forward. Just like we did when Travis CI turned us away, and now Docker is shunning its Open Source roots.</p>
<p>See what people are saying on Twitter:</p>
<blockquote><p lang="en" dir="ltr">Is Docker saying that the OSS openfaas organisation on Docker Hub will get deleted if we don&#39;t sign up for a paid plan?</p>— Alex Ellis (@alexellisuk) <a href="https://twitter.com/alexellisuk/status/1635679295891812359?ref_src=twsrc%5Etfw">March 14, 2023</a></blockquote> </div>
        </section>

        

    </article>
</div></div>
  </body>
</html>
