<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ArthurBrussee/brush">Original</a>
    <h1>Brush â€“ A new compatible Gaussian splatting engine</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description teaser_compressed.mp4">teaser_compressed.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/7014262/379799498-b7f55b9c-8632-49f9-b34b-d5de52a7a8b0.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTc5OTQ5OC1iN2Y1NWI5Yy04NjMyLTQ5ZjktYjM0Yi1kNWRlNTJhN2E4YjAubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZjU4NzYwZDIxNTM5ZTNiMTU3ODFkZTU3ZWNiOGZmODNjNjJiZDMzMTE1YjNkNTM1OTA1N2ZmMzMxM2VkODUyYSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.zfrAW3TZoSw_0666b3bILKQy5zMtF8WDeHHwqtRX-vw" data-canonical-src="https://private-user-images.githubusercontent.com/7014262/379799498-b7f55b9c-8632-49f9-b34b-d5de52a7a8b0.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTc5OTQ5OC1iN2Y1NWI5Yy04NjMyLTQ5ZjktYjM0Yi1kNWRlNTJhN2E4YjAubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZjU4NzYwZDIxNTM5ZTNiMTU3ODFkZTU3ZWNiOGZmODNjNjJiZDMzMTE1YjNkNTM1OTA1N2ZmMzMxM2VkODUyYSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.zfrAW3TZoSw_0666b3bILKQy5zMtF8WDeHHwqtRX-vw" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto">Brush is a 3D reconstruction engine, using <a href="https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/" rel="nofollow">Gaussian splatting</a>. It aims to be highly portable, flexible and fast. 3D reconstruction shouldn&#39;t require special hardware. Brush can render and train on a wide range of systems: <strong>macOS/windows/linux</strong>, <strong>AMD/Nvidia</strong> cards, <strong>Android</strong>, and in a <strong>browser</strong>. To achieve this, brush is built using WebGPU compatible tech, that can run practically anywhere! It uses the <a href="https://github.com/tracel-ai/burn">Burn</a> framework, which has a portable <a href="https://github.com/gfx-rs/wgpu"><code>wgpu</code></a> backend. This project is currently still a proof of concept, and doesn&#39;t yet implement any of the extensions to gaussian splatting that have been developed, nor is the performance optimal yet.</p>
<p dir="auto"><a href="https://arthurbrussee.github.io/brush-demo" rel="nofollow"><strong>Try the (experimental) web demo</strong> <img src="https://camo.githubusercontent.com/d789da5bd9ba5cf1ca29eae6c7e20de946dcedcf344a3676c43add82fab516e5/68747470733a2f2f63646e2d69636f6e732d706e672e666c617469636f6e2e636f6d2f3235362f3838382f3838383834362e706e67" alt="chrome logo" width="24" data-canonical-src="https://cdn-icons-png.flaticon.com/256/888/888846.png"/>
</a></p>
<p dir="auto"><em>NOTE: This only works on desktop Chrome 129+ currently (Oct 2024). Firefox and Safari are hopefully supported <a href="https://caniuse.com/webgpu" rel="nofollow">soon</a>, but currently even firefox nightly and safari technical preview do not work</em></p>

<p dir="auto">The demo can load pretrained ply splats, and can load datasets to train on. Currently only two formats are supported. A .zip file containing:</p>
<ul dir="auto">
<li>A transform_train.json and images, like the synthetic nerf scene dataset.</li>
<li>An <code>images</code> &amp; <code>sparse</code> folder with <a href="https://github.com/colmap/colmap"><code>COLMAP</code></a> data</li>
</ul>
<p dir="auto">While training you can interact with the splats and see their training dynamics live, and compare the current rendering to training / eval views as the training progresses.</p>

<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description combined_compressed.mp4">combined_compressed.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/7014262/379765142-4c70f892-cfd2-419f-8098-b0e20dba23c7.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTc2NTE0Mi00YzcwZjg5Mi1jZmQyLTQxOWYtODA5OC1iMGUyMGRiYTIzYzcubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9Zjc0ZGQyNDA5MGFlOWNlZGQzOWMyYWQ0ZDlkNmFiODg3YmIzNzI3ODgyODgwYzk5YTY4ODFkOWUzZGJjZGY4MiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.iXQWEPqUn918dwMt7x2bnfYLrSzh7IRp5BBtioKu_7c" data-canonical-src="https://private-user-images.githubusercontent.com/7014262/379765142-4c70f892-cfd2-419f-8098-b0e20dba23c7.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTc2NTE0Mi00YzcwZjg5Mi1jZmQyLTQxOWYtODA5OC1iMGUyMGRiYTIzYzcubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9Zjc0ZGQyNDA5MGFlOWNlZGQzOWMyYWQ0ZDlkNmFiODg3YmIzNzI3ODgyODgwYzk5YTY4ODFkOWUzZGJjZGY4MiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.iXQWEPqUn918dwMt7x2bnfYLrSzh7IRp5BBtioKu_7c" controls="controls" muted="muted">

  </video>
</details>


<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description rerun_dash_compressed.mp4">rerun_dash_compressed.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/7014262/379449916-f679fec0-935d-4dd2-87e1-c301db9cdc2c.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTQ0OTkxNi1mNjc5ZmVjMC05MzVkLTRkZDItODdlMS1jMzAxZGI5Y2RjMmMubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NWE2YzU2OTNmOGM0Y2RkNmMyZjk0NjE3YTc4YjZiMTM1NTVjYmMwNTc1ZWUxNTVkNDEwZDg2ZjFhNzQ5YmU5NCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.chNQ5BEWo4tSIiraLLdXUyi2cKw-GoxyDdaTzYCE69o" data-canonical-src="https://private-user-images.githubusercontent.com/7014262/379449916-f679fec0-935d-4dd2-87e1-c301db9cdc2c.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTQ0OTkxNi1mNjc5ZmVjMC05MzVkLTRkZDItODdlMS1jMzAxZGI5Y2RjMmMubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NWE2YzU2OTNmOGM0Y2RkNmMyZjk0NjE3YTc4YjZiMTM1NTVjYmMwNTc1ZWUxNTVkNDEwZDg2ZjFhNzQ5YmU5NCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.chNQ5BEWo4tSIiraLLdXUyi2cKw-GoxyDdaTzYCE69o" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto">While training, additional data can be visualized with the excellent <a href="https://rerun.io/" rel="nofollow">rerun</a>. To install rerun on your machine, please follow their <a href="https://rerun.io/docs/getting-started/installing-viewer" rel="nofollow">instructions</a>. Open the ./brush_blueprint.rbl in the viewer for best results.</p>

<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description brush_android_compressed.mp4">brush_android_compressed.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/7014262/379451093-d6751cb3-ff58-45a4-8321-77d3b0a7b051.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTQ1MTA5My1kNjc1MWNiMy1mZjU4LTQ1YTQtODMyMS03N2QzYjBhN2IwNTEubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmQzY2M2ODQ4NmI3ZWVlNzhiOTdhYTMxODE4MTRiMzA3MzNkYWNhNTc4NjAzYzkxNjQ4MDAxMDcyZmM1MjM4ZiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.e42FKedYR_KL1RWv9hQdjkejHpBHOt1_sd4fl264p40" data-canonical-src="https://private-user-images.githubusercontent.com/7014262/379451093-d6751cb3-ff58-45a4-8321-77d3b0a7b051.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjk4NjYwNjIsIm5iZiI6MTcyOTg2NTc2MiwicGF0aCI6Ii83MDE0MjYyLzM3OTQ1MTA5My1kNjc1MWNiMy1mZjU4LTQ1YTQtODMyMS03N2QzYjBhN2IwNTEubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MTAyNSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDEwMjVUMTQxNjAyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmQzY2M2ODQ4NmI3ZWVlNzhiOTdhYTMxODE4MTRiMzA3MzNkYWNhNTc4NjAzYzkxNjQ4MDAxMDcyZmM1MjM4ZiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.e42FKedYR_KL1RWv9hQdjkejHpBHOt1_sd4fl264p40" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto">Live training on a pixel 7</p>

<p dir="auto">Machine learning for real time rendering has a lot of potential, but at the same time, most popular ML tools don&#39;t align well with r. Rendering requires low latency, usually involve dynamic shapes, and it&#39;s not pleasant to attempt to ship apps with large PyTorch/Jax/CUDA deps calling out to python in a rendering loop. The usual fix is to write a seperate training and inference application. Brush on the other hand, written in rust using <code>wgpu</code> and <code>burn</code>, can produce simple dependency free binaries, and can run on nearly all devices.</p>

<p dir="auto">Install rust 1.81+ and run <code>cargo run</code> or <code>cargo run --release</code>. You can run tests with <code>cargo test --all</code>. Brush uses the wonderful <a href="https://github.com/ArthurBrussee/brush/blob/main/rerun.io">rerun</a> for additional visualizations while training.
It currently requires rerun 0.19 however, which isn&#39;t released yet.</p>

<p dir="auto">Simply <code>cargo run</code> or <code>cargo run --release</code> from the workspace root.</p>
<p dir="auto">Note: Linux has not yet been tested but <em>should</em> work. Windows works well, but does currently only works on Vulkan.</p>

<p dir="auto">This project uses <a href="https://github.com/trunk-rs/trunk"><code>trunk</code></a> to build for the web. Install trunk, and then run <code>trunk serve</code> or <code>trunk serve --release</code> to run a development server.</p>
<p dir="auto">WebGPU is still a new standard, and as such, only the latest versions of Chrome work currently. Firefox nightly should work but unfortunately crashes currently.</p>
<p dir="auto">The public web demo is registered for the <a href="https://chromestatus.com/feature/5126409856221184" rel="nofollow">subgroups origin trial</a>. To run the web demo for yourself, please enable the &#34;Unsafe WebGPU support&#34; flag in Chrome.</p>

<p dir="auto">To build on Android, see the more detailed README instructions at crates/brush-android.</p>

<p dir="auto">Brush <em>should</em> work on iOs but there is currently no project setup to do so.</p>

<p dir="auto">Brush is split into various crates. A quick overview of the different responsibilities are:</p>
<ul dir="auto">
<li><code>brush-render</code> is the main crate that pulls together the kernels into rendering functions.</li>
<li><code>brush-train</code> has code to actually train Gaussians, and handle larger scale optimizations like splitting/cloning gaussians etc.</li>
<li><code>brush-viewer</code> handles the UI and integrating the training loop.</li>
<li><code>brush-android</code> is the binary target for running on android, while <code>brush-desktop</code> is for running both on web, and mac/Windows/Linux.</li>
<li><code>brush-wgsl</code> handles some kernel inspection for generating CPU-side structs and interacing with <a href="https://github.com/bevyengine/naga_oil">naga-oil</a> to handle shader imports.</li>
<li><code>brush-dataset</code> handles importing different datasets like COLMAP or synthetic nerf data.</li>
<li><code>brush-prefix-sum</code> and <code>brush-sort</code> are only compute kernels and should be largely independent of Brush (other than <code>brush-wgsl</code>).</li>
<li><code>rrfd</code> is a small extension of <a href="https://github.com/PolyMeilex/rfd"><code>rfd</code></a></li>
</ul>

<p dir="auto">The kernels are written in a &#34;sparse&#34; style, that is, only work for visible gaussians is done, though the final calculated gradients are dense. Brush uses a GPU radix sort based on <a href="https://www.amd.com/en/products/graphics/technologies/fidelityfx.html" rel="nofollow">FidelityFX</a> (see <code>crates/brush-sort</code>). The sorting is done in two parts - first splats are sorted only by depth, then sorted by their tile ID, which saves some sorting time compared to sorting both depth and tile ids at the same time.</p>
<p dir="auto">Compatibility with WebGPU does bring some challenges, even with (the excellent) <a href="https://github.com/gfx-rs/wgpu">wgpu</a>.</p>
<ul dir="auto">
<li>WebGPU lacks native atomic floating point additions, and a software CAS loop has to be used.</li>
<li>GPU readbacks have to be async on WebGPU. A rendering pass can&#39;t do this unless the whole rendering becomes async, which has its own perils, and isn&#39;t great for an UI. The reference tile renderer requires reading back the number of &#34;intersections&#34; (each visible tile of a gaussian is one intersection), but this is not feasible. This is worked around by assuming a worst case. To reduce the number of tiles the rasterizer culls away unused tiles by intersecting the gaussian ellipses with the screenspace tiles.</li>
</ul>
<p dir="auto">The WGSL kernels use <a href="https://github.com/bevyengine/naga_oil">naga_oil</a> to manage imports. brush-wgsl additionally does some reflection to generate rust code to send uniform data to a kernel. In the future, it might be possible to port the kernels to Burns new <a href="https://github.com/tracel-ai/cubecl"><code>CubeCL</code></a> language, which is much more ergonomic and would allow generating CUDA / rocM kernels. It might also be possible to integrate with George Kopanos&#39; <a href="https://github.com/google/slang-gaussian-rasterization">Slang kernels</a>.</p>

<p dir="auto">Rendering performance is expected to be very competitive with gSplat, while training performance is still a bit slower. You can run some benchmarks using <code>cargo bench</code>. The performance of the splatting forward and backwards kernel are faster than the <em>legacy</em> gSplat kernels as they use some new techniques for better performance, but they haven&#39;t been compared yet to the more recent gSplat kernels. End-to-end training performance is also still slower, due to other overheads.</p>
<p dir="auto">For additional profiling, you can use <a href="https://github.com/wolfpld/tracy">tracy</a> and run with <code>cargo run --release --feature=tracy</code>.</p>

<p dir="auto">Quality is similair, but for now still somewhat lagging behind the original GS implementation. This is likely due to some suboptimal splitting/cloning heuristics.</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Scene</th>
<th>Brush</th>
<th>GS paper</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bicycle@7K</td>
<td>23.2</td>
<td>23.604</td>
</tr>
<tr>
<td>Garden@7k</td>
<td>25.8</td>
<td>26.245</td>
</tr>
<tr>
<td>Stump@7k</td>
<td>24.9</td>
<td>25.709</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto"><a href="https://github.com/nerfstudio-project/gsplat"><strong>gSplat</strong></a>, for their reference version of the kernels</p>
<p dir="auto"><strong>Peter Hedman &amp; George Kopanas</strong>, for the many discussions &amp; pointers.</p>
<p dir="auto"><strong>The Burn team</strong>, for help &amp; improvements to Burn along the way</p>
<p dir="auto"><strong>Raph Levien</strong>, for the <a href="https://github.com/googlefonts/compute-shader-101/pull/31" data-hovercard-type="pull_request" data-hovercard-url="/googlefonts/compute-shader-101/pull/31/hovercard">original version</a> of the GPU radix sort.</p>

<p dir="auto">This is <em>not</em> an official Google product. This repository is a forked public version of <a href="https://github.com/google-research/google-research/tree/master/brush_splat">the google-research repository</a></p>
</article></div></div>
  </body>
</html>
