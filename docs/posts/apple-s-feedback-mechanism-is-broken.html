<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.caseyliss.com/2022/6/20/feedback-is-broken-stop-trying-to-make-radar-happen">Original</a>
    <h1>Apple&#39;s Feedback Mechanism Is Broken</h1>
    
    <div id="readability-page-1" class="page"><div>
                <!-- header -->
                <div>


<p>In November, I purchased a brand-new MacBook Pro, complete with Apple‚Äôs fancy
new M1 Max processor. This is, without reservation, the best computer
I‚Äôve ever owned. It is faster than my beloved iMac Pro, but considerably more
portable.</p>
<p>At the time, I was working on what would eventually become <a href="https://www.caseyliss.com/maskeraid">MaskerAid</a>. Very
quickly upon getting to work on my new computer, I realized that things weren‚Äôt
working properly on this new machine. After some research, it appeared that
some aspects of the <a href="https://developer.apple.com/documentation/vision">Vision Framework</a> were not available on Apple Silicon
based Macs.</p>
<p>Apple‚Äôs mechanism for providing them feedback is the aptly-named <code>Feedback Assistant</code>
(n√©e Radar). It is a full-blown app on macOS/iOS/iPadOS. In fact, if you happen
to be on an Apple device, try <a href="applefeedback:">this link</a>. Radar was a black hole, where
issues went to <s>die</s> get marked as duplicates. <code>Feedback Assistant</code>, despite
trying to pull the ‚Äú<a href="https://en.wikipedia.org/wiki/Xfinity#Branding">Xfinity trick</a>‚Äù, seems to be the same as it ever was.</p>
<p>Regardless, I filed a <s>Radar</s> Feedback ‚Äî Apple people, if you happen to
read this, it‚Äôs <a href="rdar://FB9738098">FB9738098</a>. When I filed it, back in 3 November 2021, I
even included a <strong>super</strong>-simple sample project to demonstrate the issue.</p>
<hr/>
<p>Apple‚Äôs feedback system is fundamentally broken ‚Äî at least, for everyone
who does <em>not</em> work at Apple.</p>
<p>In the roughly 225 days since I filed that feedback, I received precisely
zero‚Ä¶ well‚Ä¶ feedback. Apple is a big company, and surely gets an
unimaginable amount of feedback filed every single day. However, I have <em>zero</em>
indication that a human has looked at my bug. To me, it went into the black hole,
never to return again.</p>
<p>Thankfully, by virtue of <a href="https://atp.fm/">my day job</a>, I‚Äôve had the occasion to make the
acquaintance of quite a few Apple engineers. I reached out to someone who, let‚Äôs
just say, should have insight into how to fix my problem. They were very helpful,
and very apologetic, but their response was, in my words, ‚Äútough shit‚Äù.</p>
<p><strong>Sigh.</strong></p>
<hr/>
<p>Fast forward to early this month, and it‚Äôs <a href="https://developer.apple.com/wwdc22">WWDC</a>. One of the best
not-so-secret secrets about WWDC is that the labs are where it‚Äôs at. You can,
from the comfort of your own home, spend ~30 minutes with an Apple engineer
that is likely to be intimately familiar with the APIs you‚Äôre working with.
So, I signed up for a lab to beg for someone to fix my bug.</p>
<p>I didn‚Äôt expect much to come of this lab, and I started by telling the engineer
I spoke with that I expected it to take just a couple minutes. As I told them,
I was just there to beg for them to fix my bug.</p>
<p>The engineer‚Äôs response?</p>
<p>‚ÄúWell, I do think this is only going to be a couple minutes, but it‚Äôs better
than you think: I have an easy workaround for you!‚Äù</p>
<p>üéâ</p>
<hr/>
<p>In short, when you make a request of the Vision Framework on an Apple Silicon
Mac, it fails every time.</p>
<details>
<summary>Sample code</summary>
<pre><code>/// Asynchronously detects the faces within an image.
/// - Parameter image: Image to detect faces within
/// - Returns: Array of rects that contains faces.
///
/// - Note: The rects that are returned are percentages
///         relative to the source image. For example:
///         `(0.6651394367218018,`
///          `0.527057409286499,`
///          `0.0977390706539154,`
///          `0.1303187608718872)`
static func detectFaces(in image: UIImage) async throws -&gt; [CGRect] {
    typealias RectanglesContinuation = CheckedContinuation&lt;[CGRect], Error&gt;
    
    return try await withCheckedThrowingContinuation { (continuation: CheckedContinuation) in
        guard let cgImage = image.cgImage else {
            print(&#34;WARNING: Couldn&#39;t get CGImage&#34;)
            continuation.resume(throwing: FaceDetectionErrors.couldNotGetCgImageError)
            return
        }
                    
        var retVal: [CGRect] = []
        let request = VNDetectFaceRectanglesRequest { request, error in
            if let error = error {
                print(&#34;WARNING: Got an error: \(error)&#34;)
//                    continuation.resume(throwing: error)
                return
            }
            
            if let results = request.results as? [VNFaceObservation] {
                retVal.append(contentsOf: results.map(\.boundingBox))
            } else {
                print(&#34;WARNING: Results unavailable.&#34;)
            }
            
            continuation.resume(returning: retVal)
        }
        
        let handler = VNImageRequestHandler(cgImage: cgImage,
                                            orientation: CGImagePropertyOrientation(image.imageOrientation),
                                            options: [:])
        

        do {
            try handler.perform([request])
        } catch {
            print(&#34;ERROR: Request failed: \(error)&#34;)
            continuation.resume(throwing: error)
        }
    }
}
</code></pre>
</details>
<p>The error you receive is as follows:</p>
<pre><code>Request failed: Error Domain=com.apple.vis Code=9 &#34;Could not create inference context&#34; UserInfo={NSLocalizedDescription=Could not create inference context}
</code></pre>
<hr/>
<p>Back in my lab, I asked the engineer what they were talking about. As it turns
out, I simply needed to add one line, against my instance of
<a href="https://developer.apple.com/documentation/vision/vndetectfacerectanglesrequest"><code>VNDetectFaceRectanglesRequest</code></a>:</p>
<p><code>request.usesCPUOnly = true</code></p>
<p>That‚Äôs it.</p>
<p>Apparently it will force the Vision Framework to use the CPU and not GPU for
its computations. Pretty crummy for a real device, but no problem when you‚Äôre
just trying things in the Simulator.</p>
<p>Having my problem worked around, in the span of five minutes, with a single-line
code change is both <em>delightful</em> and <strong>incredibly frustrating</strong>.</p>
<hr/>
<p>I got to thinking about this lab again this morning, and I‚Äôm pretty upset by it.
Ultimately, I got what I wanted, but why couldn‚Äôt I have had that OVER TWO HUNDRED
DAYS AGO‚ÄΩ It‚Äôs infuriating.</p>
<p>Furthermore, as a parting shot, the engineer asked me if I ever bothered trying
to talk to someone by using one of my <a href="https://developer.apple.com/support/technical/">Tech Support Incidents</a>. The
engineer meant it in good faith ‚Äî they were trying to say that I didn‚Äôt
have to wait from November ‚Üí June to get an answer. But in a way, I almost find
this more frustrating still.</p>
<p>Why is this the accepted way to get the attention of an engineer? For something
as simple as a one-line code change, why are my only two options:</p>
<ul>
<li>Wait for June and hope I get an audience with the right engineer at a lab</li>
<li>Use one of my two Technical Support Incidents and hope it‚Äôs fruitful‚Ä¶ and
that I don‚Äôt need that one for something else later in the year</li>
</ul>
<p>Were my problem put on the desk of the right engineer, who was
incentivized to provide useful and actionable feedback, it could have
been worked around in just a few minutes. I just needed a reply to my feedback
with the one-liner.</p>
<p>Unfortunately, Feedback Assistant and Radar are tools for Apple, and they
serve Apple‚Äôs needs and only Apple‚Äôs. They are a complete waste of time for outside
developers. I maintain that they are a black hole into which I pour time, effort,
sample code, and [often useless] <code>sysdiagnose</code>s. I get nothing in return.</p>
<p>Apple swears up and down that Feedbacks are useful. I‚Äôve been told many times,
by many teams, that they also use Feedbacks as a de facto voting mechanism to
try to get a pulse on what external developers want. I‚Äôll leave it as an exercise
for the reader to think about how utterly broken that is.</p>
<p>Instead, let me make it clear what developers want:</p>
<ul>
<li><a href="https://www.caseyliss.com/2020/11/10/on-apples-pisspoor-documentation">Documentation that, um, exists; and when it exists, it shouldn‚Äôt suck</a>.</li>
<li>A way to have <strong>two-way</strong> feedback with engineering</li>
</ul>
<p>Let‚Äôs start there, if you please.</p>
                </div><!-- main -->
            </div></div>
  </body>
</html>
