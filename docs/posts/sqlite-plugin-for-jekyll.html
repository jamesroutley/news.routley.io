<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/captn3m0/jekyll-sqlite">Original</a>
    <h1>Show HN: SQLite Plugin for Jekyll</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A Jekyll generator plugin to lets you use SQLite database instead of data files as a data source. It lets you easily create APIs and websites from a SQLite database, by linking together a database file, your template, and the relevant queries.</p>
<p dir="auto">It supports site-level queries, per-page queries, and prepared queries that can
use existing data (possibly generated via more queries) as parameters.</p>
<p dir="auto"><a href="https://github.com/captn3m0/jekyll-sqlite/actions/workflows/main.yml"><img src="https://github.com/captn3m0/jekyll-sqlite/actions/workflows/main.yml/badge.svg" alt="Continuous Integration"/></a> <a href="https://badge.fury.io/rb/jekyll-sqlite" rel="nofollow"><img src="https://camo.githubusercontent.com/921c7b9919a976af572c90945d0edcf01ef1c23f754be241974ccb6853fbbeee/68747470733a2f2f62616467652e667572792e696f2f72622f6a656b796c6c2d73716c6974652e737667" alt="Gem Version" data-canonical-src="https://badge.fury.io/rb/jekyll-sqlite.svg"/></a></p>

<p dir="auto">Add this line to your site&#39;s <code>Gemfile</code>:</p>

<p dir="auto">And then add this line to your site&#39;s <code>_config.yml</code>:</p>


<p dir="auto">üèÅ A fully-functional demo website that uses this plugin is available at
<a href="https://northwind.captnemo.in" rel="nofollow">northwind.captnemo.in</a>. The source code for
the demo is available at <a href="https://github.com/captn3m0/northwind">captn3m0/northwind</a>.</p>
<p dir="auto">Update your <code>_config.yml</code> to define your data sources with your SQLite database.</p>
<div dir="auto" data-snippet-clipboard-copy-content="...
sqlite:
  - data: customers
    file: *db
    query: SELECT * from Customers"><pre>...
<span>sqlite</span>:
  - <span>data</span>: <span>customers</span>
    <span>file</span>: <span>*db</span>
    <span>query</span>: <span>SELECT * from Customers</span></pre></div>
<p dir="auto">Then, you can use the <code>site.data</code> attributes accordingly:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{{ site.data.customers | jsonify }}"><pre>{{ <span>site</span>.<span>data</span>.<span>customers</span> | <span>jsonify</span> }}</pre></div>

<p dir="auto">This plugin supports prepared queries with parameter binding. This lets you
use existing data from a previous query, or some other source (such as
<code>site.data.*</code> or <code>page.*</code>) as a parameter in your query.</p>
<p dir="auto">Say you have a YAML file defining your items (<code>data/books.yaml</code>):</p>
<div dir="auto" data-snippet-clipboard-copy-content="- id: 31323952-2708-42dc-a995-6006a23cbf00
  name: Time Travel with a Rubber Band
- id: 5c8e67a0-d490-4743-b5b8-8e67bd1f95a2
  name: The Art of Cache Invalidation"><pre>- <span>id</span>: <span>31323952-2708-42dc-a995-6006a23cbf00</span>
  <span>name</span>: <span>Time Travel with a Rubber Band</span>
- <span>id</span>: <span>5c8e67a0-d490-4743-b5b8-8e67bd1f95a2</span>
  <span>name</span>: <span>The Art of Cache Invalidation</span></pre></div>
<p dir="auto">and the prices for the items in your SQLite database, the following configuration will enrich the <code>items</code> array with the price:</p>
<div dir="auto" data-snippet-clipboard-copy-content="sql:
- data: items.books
  query: SELECT price, author FROM pricing WHERE id =:id
  db: books.db"><pre><span>sql</span>:
- <span>data</span>: <span>items.books</span>
  <span>query</span>: <span>SELECT price, author FROM pricing WHERE id =:id</span>
  <span>db</span>: <span>books.db</span></pre></div>
<p dir="auto">This would allow the following Liquid loop to be written:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{% for item in site.data.items %}
{{item.meta.price}}, {{item.meta.author}}
{% endfor %}"><pre>{% <span>for</span> <span>item</span> <span>in</span> <span>site</span>.<span>data</span>.<span>items</span> %}
{{<span>item</span>.<span>meta</span>.<span>price</span>}}, {{<span>item</span>.<span>meta</span>.<span>author</span>}}
{% <span>endfor</span> %}</pre></div>

<p dir="auto">The exact same syntax can be used on a per-page basis to generate data within
each page. This is helpful for keeping page-specific queries within the page
itself. Here&#39;s an example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="---
FeaturedSupplierID: 2
sqlite:
  - data: suppliers
    file: &#34;_db/northwind.db&#34;
    query: &#34;SELECT CompanyName, SupplierID FROM suppliers ORDER BY SupplierID&#34;
  - data: suppliers.products
    # This is a prepared query, where SupplierID is coming from the previous query.
    file: &#34;_db/northwind.db&#34;
    query: &#34;SELECT ProductName, CategoryID,UnitPrice FROM products WHERE SupplierID = :SupplierID&#34;
  # :FeaturedSupplierID is picked up automatically from the page frontmatter.
  - data: FeaturedSupplier
    file: &#34;_db/northwind.db&#34;
    query: &#34;SELECT * SupplierID = :FeaturedSupplierID&#34;
---
{{page.suppliers|jsonify}}"><pre>---
<span>FeaturedSupplierID</span>: <span>2</span>
<span>sqlite</span>:
  - <span>data</span>: <span>suppliers</span>
    <span>file</span>: <span><span>&#34;</span>_db/northwind.db<span>&#34;</span></span>
    <span>query</span>: <span><span>&#34;</span>SELECT CompanyName, SupplierID FROM suppliers ORDER BY SupplierID<span>&#34;</span></span>
  - <span>data</span>: <span>suppliers.products</span>
    <span><span>#</span> This is a prepared query, where SupplierID is coming from the previous query.</span>
    <span>file</span>: <span><span>&#34;</span>_db/northwind.db<span>&#34;</span></span>
    <span>query</span>: <span><span>&#34;</span>SELECT ProductName, CategoryID,UnitPrice FROM products WHERE SupplierID = :SupplierID<span>&#34;</span></span>
  <span><span>#</span> :FeaturedSupplierID is picked up automatically from the page frontmatter.</span>
  - <span>data</span>: <span>FeaturedSupplier</span>
    <span>file</span>: <span><span>&#34;</span>_db/northwind.db<span>&#34;</span></span>
    <span>query</span>: <span><span>&#34;</span>SELECT * SupplierID = :FeaturedSupplierID<span>&#34;</span></span>
---
<span>{{page.suppliers|jsonify}}</span></pre></div>
<p dir="auto">This will generate a <code>page.suppliers</code> array with all the suppliers, and a <code>page.FeaturedSupplier</code> object with the details of the featured supplier.</p>
<p dir="auto">Each supplier will have a <code>products</code> array with all the products for that supplier.</p>

<p dir="auto">It works well with the <code>datapage_gen</code> plugin:</p>
<p dir="auto">See the <a href="https://github.com/avillafiorita/jekyll-datapage_gen">datapage_gen</a> docs for more details.</p>
<p dir="auto">Here&#39;s a sample configuration:</p>
<div dir="auto" data-snippet-clipboard-copy-content="sqlite:
  restaurants:
    file: _db/reviews.db
    sql: SELECT id, name, last_review_date &gt; 1672531200 as active, address FROM restaurants;
page_gen:
  - data: restaurants
    template: restaurant
    name: id
    title: name
    filter: active"><pre><span>sqlite</span>:
  <span>restaurants</span>:
    <span>file</span>: <span>_db/reviews.db</span>
    <span>sql</span>: <span>SELECT id, name, last_review_date &gt; 1672531200 as active, address FROM restaurants;</span>
<span>page_gen</span>:
  - <span>data</span>: <span>restaurants</span>
    <span>template</span>: <span>restaurant</span>
    <span>name</span>: <span>id</span>
    <span>title</span>: <span>name</span>
    <span>filter</span>: <span>active</span></pre></div>
<p dir="auto">This will automatically generate a file for each restaurant
restaurants/#{id}.html file with the layout <code>_layouts/restaurant.html</code> and page.id, page.name, page.active set and page.title set to restaurant name</p>
<p dir="auto">Note that the <code>datapage_gen</code> plugin will run <em>after</em> the <code>jekyll-sqlite</code> plugin,
if you generate any pages with per-page queries, these queries will not execute.</p>

<p dir="auto">After checking out the repo, run <code>bin/setup</code> to install dependencies. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>
<p dir="auto">To install this gem onto your local machine, run <code>bundle exec rake install</code>. To release a new version, update the version number in <code>version.rb</code>, and then run <code>bundle exec rake release</code>, which will create a git tag for the version, push git commits and the created tag, and push the <code>.gem</code> file to <a href="https://rubygems.org" rel="nofollow">rubygems.org</a>.</p>

<p dir="auto">Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/captn3m0/jekyll-sqlite">https://github.com/captn3m0/jekyll-sqlite</a>. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="https://github.com/captn3m0/jekyll-sqlite/blob/main/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
<p dir="auto">Note that only maintained versions of <a href="https://endoflife.date/jekyll" rel="nofollow">Jekyll</a> and
<a href="https://endoflife.date/ruby" rel="nofollow">Ruby</a> are supported.</p>

<p dir="auto">Everyone interacting in the Jekyll::Sqlite project&#39;s codebases, issue trackers, chat rooms and mailing lists is expected to follow the <a href="https://github.com/captn3m0/jekyll-sqlite/blob/main/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
</article></div></div>
  </body>
</html>
