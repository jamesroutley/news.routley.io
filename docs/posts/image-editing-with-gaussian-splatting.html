<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.unite.ai/image-editing-with-gaussian-splatting/">Original</a>
    <h1>Image Editing with Gaussian Splatting</h1>
    
    <div id="readability-page-1" class="page"><div id="mvp-content-main"><p>A new  collaboration between researchers in Poland and the UK proposes the prospect of using <a href="https://arxiv.org/pdf/2308.04079" target="_blank" rel="noopener">Gaussian Splatting</a> to edit images, by temporarily interpreting a selected part of the image into 3D space, allowing the user to modify and manipulate the 3D representation of the image, and then applying the transformation.</p><div id="attachment_206991"><p><img decoding="async" aria-describedby="caption-attachment-206991" src="https://www.unite.ai/wp-content/uploads/2024/10/cat-example.jpg" alt="To change the orientation of the cat&#39;s head, the relevant section is moved into 3D space via Gaussian Splatting, and then manipulated by the user. The modification is then applied. The process is analogous to various modal techniques in Adobe software, that lock off the interface until a current complex process is completed. Source: https://github.com/waczjoan/MiraGe/" width="657" height="296" srcset="https://www.unite.ai/wp-content/uploads/2024/10/cat-example.jpg 1200w, https://www.unite.ai/wp-content/uploads/2024/10/cat-example-300x135.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/cat-example-250x113.jpg 250w, https://www.unite.ai/wp-content/uploads/2024/10/cat-example-768x346.jpg 768w" sizes="(max-width: 657px) 100vw, 657px"/></p><p id="caption-attachment-206991"><span><em>To change the orientation of the cat&#39;s head, the relevant section is moved into 3D space via Gaussian Splatting, and then manipulated by the user. The modification is then applied. The process is analogous to various modal techniques in Adobe software, that lock off the interface until a current complex process is completed.</em> Source: https://github.com/waczjoan/MiraGe/</span></p></div><p>Since the Gaussian Splat element is temporarily represented by a mesh of triangles, and momentarily enters a ‘CGI state&#39;, a physics engine integrated into the process can interpret natural movement, either to change the static state of an object, or to produce an animation.</p><div id="attachment_206993"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-206993" src="https://www.unite.ai/wp-content/uploads/2024/10/blanket.gif" alt="A physics engine incorporated into the new MiraGe system can perform natural interpretations of physical movement, either for animations or static alterations to an image. " width="666" height="666"/></p><p id="caption-attachment-206993"><span><em>A physics engine incorporated into the new MiraGe system can perform natural interpretations of physical movement, either for animations or static alterations to an image.</em></span></p></div><p>There is no generative AI involved in the process, meaning that no <a href="https://www.unite.ai/understanding-diffusion-models-a-deep-dive-into-generative-ai/">Latent Diffusion Models</a> (LDMs) are involved, unlike Adobe&#39;s <a href="https://www.unite.ai/adobe-express-enhances-user-experience-with-firefly-generative-ai/">Firefly system</a>, which is trained on Adobe Stock (formerly Fotolia).</p><p>The system – called <em><i>MiraGe</i></em> – interprets selections into 3D space and infers geometry by creating a <em><i>mirror image</i></em> of the selection, and approximating 3D coordinates that can be embodied in a Splat, which then interprets the image into a mesh.</p><p><span><strong><em><b><i>Click to play. </i></b></em></strong><em><i>Further examples of elements that have been either altered manually by a user of the MiraGe system, or subject to physics-based deformation.</i></em></span></p><p>The authors compared the MiraGe system to former approaches, and found that it achieves state-of-the-art performance in the target task.</p><p>Users of the zBrush modeling system will be familiar with this process, since zBrush allows the user to essentially <a href="https://www.youtube.com/watch?v=FD4w8e8mqTg&amp;t=317s" target="_blank" rel="noopener">‘flatten&#39; a 3D model</a> and add 2D detail, while preserving the underlying mesh, and interpreting the new detail into it – a ‘freeze&#39; that is the opposite of the MiraGe method, which operates more like Firefly or other Photoshop-style modal manipulations, such as warping or crude 3D interpretations.</p><div id="attachment_206996"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-206996" src="https://www.unite.ai/wp-content/uploads/2024/10/splatting-mod-MiraGe.jpg" alt="Parametrized Gaussian Splats allow MiraGe to create high-quality reconstructions of selected areas of a 2D image, and apply soft-body physics to the temporarily-3D selection." width="794" height="364" srcset="https://www.unite.ai/wp-content/uploads/2024/10/splatting-mod-MiraGe.jpg 1200w, https://www.unite.ai/wp-content/uploads/2024/10/splatting-mod-MiraGe-300x138.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/splatting-mod-MiraGe-250x115.jpg 250w, https://www.unite.ai/wp-content/uploads/2024/10/splatting-mod-MiraGe-768x352.jpg 768w" sizes="(max-width: 794px) 100vw, 794px"/></p><p id="caption-attachment-206996"><span><em>Parametrized Gaussian Splats allow MiraGe to create high-quality reconstructions of selected areas of a 2D image, and apply soft-body physics to the temporarily-3D selection.</em></span></p></div><p>The paper states:</p><p><em><i>‘[We] introduce a model that encodes 2D images by simulating human interpretation. Specifically, our model perceives a 2D image as a human would view a photograph or a sheet of paper, treating it as a flat object within a 3D space. </i></em></p><p><em><i>‘This approach allows for intuitive and flexible image editing, capturing the nuances of human perception while enabling complex transformations.&#39;</i></em></p><p>The <a href="https://arxiv.org/pdf/2410.01521">new paper</a> is titled <em><i>MiraGe: Editable 2D Images using Gaussian Splatting</i></em>, and comes from four authors across Jagiellonian University at Kraków, and the University of Cambridge. The full code for the system has been <a href="https://github.com/waczjoan/MiraGe/">released at GitHub</a>.</p><p>Let&#39;s take a look at how the researchers tackled the challenge.</p><h2><strong>Method</strong></h2><p>The MiraGe approach utilizes <a href="https://arxiv.org/pdf/2402.01459" target="_blank" rel="noopener">Gaussian Mesh Splatting</a> (GaMeS) parametrization, a technique developed by a group that includes two of the authors of the new paper. GaMeS allows Gaussian Splats to be interpreted as traditional CGI meshes, and to become subject to the standard range of warping and modification techniques that the CGI community has developed over the last several decades.</p><p>MiraGe interprets ‘flat&#39; Gaussians, in a 2D space, and uses GaMeS to ‘pull&#39; content into GSplat-enabled 3D space, temporarily.</p><div id="attachment_206997"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-206997" src="https://www.unite.ai/wp-content/uploads/2024/10/games-parametrization-MiraGe.jpg" alt="Each flat Gaussian is represented as three points in a cloud of triangles, called &#39;triangle soup&#39;, opening up the inferred image to manipulation. Source: https://arxiv.org/pdf/2410.01521" width="889" height="358" srcset="https://www.unite.ai/wp-content/uploads/2024/10/games-parametrization-MiraGe.jpg 1200w, https://www.unite.ai/wp-content/uploads/2024/10/games-parametrization-MiraGe-300x121.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/games-parametrization-MiraGe-250x101.jpg 250w, https://www.unite.ai/wp-content/uploads/2024/10/games-parametrization-MiraGe-768x309.jpg 768w" sizes="(max-width: 889px) 100vw, 889px"/></p><p id="caption-attachment-206997"><span><em>Each flat Gaussian is represented as three points in a cloud of triangles, called ‘triangle soup&#39;, opening up the inferred image to manipulation.</em> Source: https://arxiv.org/pdf/2410.01521</span></p></div><p>We can see in the lower-left corner of the image above that MiraGe creates a ‘mirror&#39; image of the section of an image to be interpreted.</p><p>The authors state:</p><p><em><i>‘[We] employ a novel approach utilizing two opposing cameras positioned along the Y axis, symmetrically aligned around the origin and directed towards one another. The first camera is tasked with reconstructing the original image, while the second models the mirror reflection. </i></em></p><p><em><i>‘The photograph is thus conceptualized as a translucent tracing paper sheet, embedded within the 3D spatial context. The reflection can be effectively represented by horizontally flipping the [image]. This mirror-camera setup enhances the fidelity of the generated reflections, providing a robust solution for accurately capturing visual elements.&#39;</i></em></p><p>The paper notes that once this extraction has been achieved, perspective adjustments that would typically be challenging become accessible via direct editing in 3D. In the example below, we see a selection of an image of a woman that encompasses only her arm. In this instance, the user has tilted the hand downward in a plausible manner, which would be a challenging task by just pushing pixels around.</p><div id="attachment_207000"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-207000" src="https://www.unite.ai/wp-content/uploads/2024/10/hand-MiraGe2.jpg" alt="An example of the MiraGe editing technique" width="538" height="328" srcset="https://www.unite.ai/wp-content/uploads/2024/10/hand-MiraGe2.jpg 1000w, https://www.unite.ai/wp-content/uploads/2024/10/hand-MiraGe2-300x183.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/hand-MiraGe2-246x150.jpg 246w, https://www.unite.ai/wp-content/uploads/2024/10/hand-MiraGe2-768x468.jpg 768w" sizes="(max-width: 538px) 100vw, 538px"/></p><p id="caption-attachment-207000"><span><em>An example of the MiraGe editing technique.</em></span></p></div><p>Attempting this using the Firefly generative tools in Photoshop would usually mean that the hand becomes replaced by a synthesized, diffusion-imagined hand, breaking the authenticity of the edit. Even the more capable systems, such as the <a href="https://github.com/lllyasviel/ControlNet" target="_blank" rel="noopener">ControlNet</a> ancillary system for Stable Diffusion and other Latent Diffusion Models, <a href="https://huggingface.co/XLabs-AI/flux-controlnet-collections" target="_blank" rel="noopener">such as Flux</a>, struggle to achieve this kind of edit in an image-to-image pipeline.</p><p>This particular pursuit has been dominated by methods using Implicit Neural Representations (INRs), such as <a href="https://proceedings.neurips.cc/paper_files/paper/2020/file/53c04118df112c13a8c34b38343b9c10-Paper.pdf">SIREN</a> and <a href="https://arxiv.org/pdf/2301.05187">WIRE</a>. The difference between an implicit and explicit representation method is that the coordinates of the model are not directly addressable in INRs, which use a <a href="https://byjus.com/maths/continuous-function/" target="_blank" rel="noopener">continuous function</a>.</p><p>By contrast, Gaussian Splatting offers explicit and addressable X/Y/Z <a href="https://mathinsight.org/cartesian_coordinates" target="_blank" rel="noopener">Cartesian coordinates</a>, even though it uses Gaussian ellipses rather than <a href="https://archive.is/Tnl4i" target="_blank" rel="noopener">voxels</a> or other methods of depicting content in a 3D space.</p><p>The idea of using GSplat in a 2D space has been most prominently presented, the authors note, in the 2024 Chinese academic collaboration <a href="https://arxiv.org/pdf/2403.08551" target="_blank" rel="noopener">GaussianImage</a>, which offered a 2D version of Gaussian Splatting, enabling inference frame rates of 1000fps. However, this model has no implementation related to image editing.</p><p>After GaMeS parametrization extracts the selected area into a Gaussian/mesh representation, the image is reconstructed using the Material Points Method (MPM) technique first outlined in a <a href="https://yuanming.taichi.graphics/publication/2018-mlsmpm/mls-mpm-cpic.pdf" target="_blank" rel="noopener">2018 CSAIL paper</a>.</p><p>In MiraGe, during the process of alteration, the Gaussian Splat exists as a guiding proxy for an equivalent mesh version, much as <a href="https://arxiv.org/pdf/1909.01815.pdf" target="_blank" rel="noopener">3DMM CGI models</a> are <a href="https://www.unite.ai/rignerf-a-new-deepfakes-method-that-uses-neural-radiance-fields/" target="_blank" rel="noopener">frequently used</a> as orchestration methods for implicit neural rendering techniques such as Neural Radiance Fields (NeRF).</p><p>In the process, two-dimensional objects are modeled in 3D space, and the parts of the image that are not being influenced are not visible to the end user, so that the contextual effect of the manipulations are not apparent until the process is concluded.</p><p>MiraGe can be integrated into the popular open source 3D program <a href="https://www.blender.org/" target="_blank" rel="noopener">Blender</a>, which is now <a href="https://github.com/benrugg/AI-Render" target="_blank" rel="noopener">frequently used</a> in AI-inclusive workflows, primarily for image-to-image purposes.</p><div id="attachment_207001"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-207001" src="https://www.unite.ai/wp-content/uploads/2024/10/blender-MiraGe.jpg" alt="A workflow for MiraGe in Blender, involving the movement of the arm of a figure depicted in a 2D image." width="1200" height="416" srcset="https://www.unite.ai/wp-content/uploads/2024/10/blender-MiraGe.jpg 1200w, https://www.unite.ai/wp-content/uploads/2024/10/blender-MiraGe-300x104.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/blender-MiraGe-250x87.jpg 250w, https://www.unite.ai/wp-content/uploads/2024/10/blender-MiraGe-768x266.jpg 768w" sizes="(max-width: 1200px) 100vw, 1200px"/></p><p id="caption-attachment-207001"><span>A workflow for MiraGe in Blender, involving the movement of the arm of a figure depicted in a 2D image.</span></p></div><p>The authors offer two versions of a deformation approach based on Gaussian Splatting – <em><i>Amorphous</i></em> and <em><i>Graphite</i></em>.</p><p>The Amorphous approach directly utilizes the GaMeS method, and allows the extracted 2D selection to move freely in 3D space, whereas the Graphite approach constrains the Gaussians to 2D space during initialization and training.</p><p>The researchers found that though the Amorphous approach might handle complex shapes better than Graphite, ‘tears&#39; or rift artefacts were more evident, where the edge of the deformation aligns with the unaffected portion of the image*.</p><p>Therefore, they developed the aforementioned ‘mirror image&#39; system:</p><p><em><i>‘[We] employ a novel approach utilizing two opposing cameras positioned along the Y axis, symmetrically aligned around the origin and directed towards one another. </i></em></p><p><em><i>‘The first camera is tasked with reconstructing the original image, while the second models the mirror reflection. The photograph is thus conceptualized as a translucent tracing paper sheet, embedded within the 3D spatial context. The reflection can be effectively represented by horizontally flipping the [image]. </i></em></p><p><em><i>‘This mirror-camera setup enhances the fidelity of the generated reflections, providing a robust solution for accurately capturing visual elements.&#39;</i></em></p><p>The paper notes that MiraGe can use external physics engines such as those <a href="https://docs.blender.org/manual/en/latest/physics/index.html" target="_blank" rel="noopener">available in Blender</a>, or in <a href="https://github.com/taichi-dev/taichi_elements" target="_blank" rel="noopener">Taichi_Elements</a>.</p><h2><strong>Data and Tests</strong></h2><p>For image quality assessments in tests carried out for MiraGe, the <a href="https://www.unite.ai/what-is-noise-in-image-processing-a-primer/">Signal-to-Noise Ratio</a> (SNR) and <a href="https://www.cns.nyu.edu/pub/eero/wang03b.pdf">MS-SIM</a> metrics were used.</p><p>Datasets used were the <a href="https://r0k.us/graphics/kodak/" target="_blank" rel="noopener">Kodak Lossless True Color Image Suite</a>, and the <a href="https://data.vision.ee.ethz.ch/cvl/DIV2K/" target="_blank" rel="noopener">DIV2K </a><a href="https://developers.google.com/machine-learning/crash-course/training-and-test-sets/splitting-data" target="_blank" rel="noopener">validation</a> set. The resolutions of these datasets suited a comparison with the closest prior work, Gaussian Image. The other rival frameworks trialed were SIREN, WIRE, NVIDIA&#39;s <a href="https://arxiv.org/pdf/2201.05989" target="_blank" rel="noopener">Instant Neural Graphics Primitives</a> (I-NGP), and <a href="https://arxiv.org/pdf/2309.15426" target="_blank" rel="noopener">NeuRBF</a>.</p><p>The experiments took place on a NVIDIA GEFORCE RTX 4070 laptop and on a NVIDIA RTX 2080.</p><div id="attachment_207002"><p><img loading="lazy" decoding="async" aria-describedby="caption-attachment-207002" src="https://www.unite.ai/wp-content/uploads/2024/10/tab-1.jpg" alt="MiraGe offers state-of-the-art results against the chosen prior frameworks, according to the results featured in the new paper." width="759" height="274" srcset="https://www.unite.ai/wp-content/uploads/2024/10/tab-1.jpg 1200w, https://www.unite.ai/wp-content/uploads/2024/10/tab-1-300x108.jpg 300w, https://www.unite.ai/wp-content/uploads/2024/10/tab-1-250x90.jpg 250w, https://www.unite.ai/wp-content/uploads/2024/10/tab-1-768x277.jpg 768w" sizes="(max-width: 759px) 100vw, 759px"/></p><p id="caption-attachment-207002"><span><em>MiraGe offers state-of-the-art results against the chosen prior frameworks, according to the results featured in the new paper.</em></span></p></div><p>Of these results, the authors state:</p><p><em><i>‘We see that our proposition outperforms the previous solutions on both datasets. The quality measured by both metrics shows significant improvement compared to all the previous approaches.&#39;</i></em></p><h2><strong>Conclusion</strong></h2><p>MiraGe&#39;s adaptation of 2D Gaussian Splatting is clearly a nascent and tentative foray into what may prove to be a very interesting alternative to the vagaries and whims of using diffusion models to effect modifications to an image (i.e., via Firefly and other API-based diffusion methods, and via open source architectures such as Stable Diffusion and Flux).</p><p>Though there are many diffusion models that can effect minor changes in images, LDMs are limited by their semantic and often ‘over-imaginative&#39; approach to a text-based user request for a modification.</p><p>Therefore the ability to temporarily pull part of an image into 3D space, manipulate it and replace it back into the image, while using only the source image as a reference, seems a task that Gaussian Splatting may be well suited for in the future.</p><p>* <em><i>There is some confusion in the paper, in that it cites ‘Amorphous-Mirage&#39; as the most effective and capable method, in spite of its tendency to produce unwanted Gaussians (artifacts), while arguing that ‘Graphite-Mirage&#39; is more flexible. It appears that Amorphous-Mirage obtains the best detail, and Graphite-Mirage the best flexibility. Since both methods are presented in the paper, with their diverse strengths and weaknesses, the authors&#39; preference, if any, does not appear to be clear at this time.</i></em></p><p><em><i>First published Thursday, October 3, 2024</i></em></p>   <p><a href="https://subscribe.unite.ai/"> <img loading="lazy" decoding="async" src="https://www.unite.ai/wp-content/uploads/2022/10/join-the-future-newsletter.png" alt="" width="1099" height="628" srcset="https://www.unite.ai/wp-content/uploads/2022/10/join-the-future-newsletter.png 1099w, https://www.unite.ai/wp-content/uploads/2022/10/join-the-future-newsletter-300x171.png 300w, https://www.unite.ai/wp-content/uploads/2022/10/join-the-future-newsletter-250x143.png 250w, https://www.unite.ai/wp-content/uploads/2022/10/join-the-future-newsletter-768x439.png 768w" sizes="(max-width: 1099px) 100vw, 1099px"/> </a>  <a href="https://subscribe.unite.ai/"> <img loading="lazy" decoding="async" src="https://www.unite.ai/wp-content/uploads/2024/01/Unite-AI-Mobile-Newsletter-1.png" alt="" width="1099" height="628"/> </a></p></div></div>
  </body>
</html>
