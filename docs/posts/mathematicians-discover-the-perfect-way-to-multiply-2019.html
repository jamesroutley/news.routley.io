<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.quantamagazine.org/mathematicians-discover-the-perfect-way-to-multiply-20190411/">Original</a>
    <h1>Mathematicians discover the perfect way to multiply (2019)</h1>
    
    <div id="readability-page-1" class="page"><div data-reactid="243"><div data-reactid="244"><p><img alt="Art for &#34;Mathematicians Discover the Perfect Way to Multiply&#34;" src="https://d2r55xnwy6nx47.cloudfront.net/uploads/2019/04/Multiplication_1920x1080_Lede.gif" data-reactid="246"/></p></div><figcaption data-reactid="248"><section data-reactid="249"></section></figcaption></div><div data-reactid="253"><div data-reactid="254"><div data-reactid="255"><div data-reactid="256"><section data-reactid="303"><div data-reactid="304"><div data-reactid="305"><div data-reactid="306"><p>Four thousand years ago, the Babylonians invented multiplication. Last month, mathematicians perfected it.</p>
<p>On March 18, two researchers described <a href="https://hal.archives-ouvertes.fr/hal-02070778/document">the fastest method ever discovered for multiplying two very large numbers</a>. The paper marks the culmination of a long-running search to find the most efficient procedure for performing one of the most basic operations in math.</p>
<p>“Everybody thinks basically that the method you learn in school is the best one, but in fact it’s an active area of research,” said <a href="http://www.texmacs.org/joris/main/joris.html">Joris van der Hoeven</a>, a mathematician at the French National Center for Scientific Research and one of the co-authors.</p>
<p>The complexity of many computational problems, from calculating new digits of pi to finding large prime numbers, boils down to the speed of multiplication. Van der Hoeven describes their result as setting a kind of mathematical speed limit for how fast many other kinds of problems can be solved.</p>
<p>“In physics you have important constants like the speed of light which allow you to describe all kinds of phenomena,” van der Hoeven said. “If you want to know how fast computers can solve certain mathematical problems, then integer multiplication pops up as some kind of basic building brick with respect to which you can express those kinds of speeds.”</p>
<p>Most everyone learns to multiply the same way. We stack two numbers, multiply every digit in the bottom number by every digit in the top number, and do addition at the end. If you’re multiplying two two-digit numbers, you end up performing four smaller multiplications to produce a final product.</p>
<p>The grade school or “carrying” method requires about <em>n</em><sup>2</sup> steps, where <em>n</em> is the number of digits of each of the numbers you’re multiplying. So three-digit numbers require nine multiplications, while 100-digit numbers require 10,000 multiplications.</p>
<p>The carrying method works well for numbers with just a few digits, but it bogs down when we’re multiplying numbers with millions or billions of digits (which is what computers do to accurately calculate pi or as part of the <a href="https://www.mersenne.org/">worldwide search for large primes</a>). To multiply two numbers with 1 billion digits requires 1 billion squared, or 10<sup>18</sup>, multiplications, which would take a modern computer roughly 30 years.</p>
<p>For millennia it was widely assumed that there was no faster way to multiply. Then in 1960, the 23-year-old Russian mathematician Anatoly Karatsuba took a seminar led by Andrey Kolmogorov, one of the great mathematicians of the 20th century. Kolmogorov asserted that there was no general procedure for doing multiplication that required fewer than <em>n</em><sup>2</sup> steps. Karatsuba thought there was — and after a week of searching, he found it.</p>
<p>Karatsuba’s method involves breaking up the digits of a number and recombining them in a novel way that allows you to substitute a small number of additions and subtractions for a large number of multiplications. The method saves time because addition takes only 2<em>n</em> steps, as opposed to <em>n</em><sup>2</sup> steps.</p>

<p>“With addition, you do it a year earlier in school because it’s much easier, you can do it in linear time, almost as fast as reading the numbers from right to left,” said <a href="http://www.cse.psu.edu/~fhs/">Martin Fürer</a>, a mathematician at Pennsylvania State University who in 2007 created what was at the time the fastest multiplication algorithm.</p>
<p>When dealing with large numbers, you can repeat the Karatsuba procedure, splitting the original number into almost as many parts as it has digits. And with each splitting, you replace multiplications that require many steps to compute with additions and subtractions that require far fewer.</p>
<p>“You can turn some of the multiplications into additions, and the idea is additions will be faster for computers,” said <a href="https://web.maths.unsw.edu.au/~davidharvey/">David Harvey</a>, a mathematician at the University of New South Wales and a co-author on the new paper.</p>
<p>Karatsuba’s method made it possible to multiply numbers using only <em>n</em><sup>1.58</sup> single-digit multiplications. Then in 1971 <a href="https://pages.iai.uni-bonn.de/schoenhage_arnold/">Arnold Schönhage</a> and Volker Strassen published a method capable of multiplying large numbers in <em>n</em> × log <em>n</em> × log(log <em>n</em>) multiplicative steps, where log <em>n</em> is the logarithm of <em>n</em>. For two 1-billion-digit numbers, Karatsuba’s method would require about 165 trillion additional steps.</p>

<p>Schönhage and Strassen’s method, which is how computers multiply huge numbers, had two other important long-term consequences. First, it introduced the use of a technique from the field of signal processing called a fast Fourier transform. The technique has been the basis for every fast multiplication algorithm since.</p>
<p>Second, in that same paper Schönhage and Strassen conjectured that there should be an even faster algorithm than the one they found — a method that needs only <em>n </em>× log<em> n</em> single-digit operations — and that such an algorithm would be the fastest possible. Their conjecture was based on a hunch that an operation as fundamental as multiplication must have a limit more elegant than <em>n</em> × log <em>n</em> × log(log <em>n</em>).</p>
<p>“It was kind of a general consensus that multiplication is such an important basic operation that, just from an aesthetic point of view, such an important operation requires a nice complexity bound,” Fürer said. “From general experience the mathematics of basic things at the end always turns out to be elegant.”</p>
<p>Schönhage and Strassen’s ungainly <em>n</em> × log <em>n</em> × log(log <em>n</em>) method held on for 36 years. In 2007 Fürer beat it and the floodgates opened. Over the past decade, mathematicians have found successively faster multiplication algorithms, each of which has inched closer to <em>n</em> × log <em>n</em>, without quite reaching it. Then last month, Harvey and van der Hoeven got there.</p>
<p>Their method is a refinement of the major work that came before them. It splits up digits, uses an improved version of the fast Fourier transform, and takes advantage of other advances made over the past forty years. “We use [the fast Fourier transform] in a much more violent way, use it several times instead of a single time, and replace even more multiplications with additions and subtractions,” van der Hoeven said.</p>
<p>Harvey and van der Hoeven’s algorithm proves that multiplication can be done in <em>n</em> × log <em>n</em> steps. However, it doesn’t prove that there’s no faster way to do it. Establishing that this is the best possible approach is much more difficult. At the end of February, a team of computer scientists at Aarhus University <a href="https://arxiv.org/abs/1902.10935">posted a paper arguing</a> that if another unproven conjecture is also true, this is indeed the fastest way multiplication can be done.</p>
<p>And while the new algorithm is important theoretically, in practice it won’t change much, since it’s only marginally better than the algorithms already being used. “The best we can hope for is we’re three times faster,” van der Hoeven said. “It won’t be spectacular.”</p>

<p>In addition, the design of computer hardware has changed. Two decades ago, computers performed addition much faster than multiplication. The speed gap between multiplication and addition has narrowed considerably over the past 20 years to the point where multiplication can be even faster than addition in some chip architectures. With some hardware, “you could actually do addition faster by telling the computer to do a multiplication problem, which is just insane,” Harvey said.</p>
<p>Hardware changes with the times, but best-in-class algorithms are eternal. Regardless of what computers look like in the future, Harvey and van der Hoeven’s algorithm will still be the most efficient way to multiply.</p>
<p><i>This article was reprinted on <a href="https://www.wired.com/story/mathematicians-discover-the-perfect-way-to-multiply/">Wired.com</a> and in Spanish at <a href="https://www.investigacionyciencia.es/noticias/la-forma-perfecta-de-multiplicar-17404">Investigacionyciencia.es</a></i>.</p>
</div></div></div></section></div></div></div></div></div>
  </body>
</html>
