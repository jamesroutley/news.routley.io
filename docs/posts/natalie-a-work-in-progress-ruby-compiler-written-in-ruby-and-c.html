<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/natalie-lang/natalie">Original</a>
    <h1>Natalie â€“ a work-in-progress Ruby compiler, written in Ruby and C&#43;&#43;</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://github.com/natalie-lang/natalie/actions?query=workflow%3ABuild+branch%3Amaster"><img src="https://github.com/natalie-lang/natalie/actions/workflows/build.yml/badge.svg" alt="github build status"/></a>
<a href="https://github.com/natalie-lang/natalie/blob/master/LICENSE"><img src="https://camo.githubusercontent.com/2bb630e2707a04100cd270fd944d22816241c37b68a5a1629257920c65e17891/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c7565" alt="MIT License" data-canonical-src="https://img.shields.io/badge/license-MIT-blue"/></a>
<a href="https://justforfunnoreally.dev" rel="nofollow"><img src="https://camo.githubusercontent.com/3ce3eefc53df2dda9015536215fe419668c176c8fc9fe1de9b7b6f49656f75c0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6a757374666f7266756e6e6f7265616c6c792d6465762d396666" alt="justforfunnoreally.dev badge" data-canonical-src="https://img.shields.io/badge/justforfunnoreally-dev-9ff"/></a></p>
<p dir="auto">Natalie is a very early-stage work-in-progress Ruby implementation.</p>
<p dir="auto">It provides an ahead-of-time compiler using C++ and gcc/clang as the backend.
Also, the language has a REPL that performs incremental compilation.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/natalie-lang/natalie/blob/master/examples/demo.gif"><img src="https://github.com/natalie-lang/natalie/raw/master/examples/demo.gif" alt="demo screencast" data-animated-image=""/></a></p>
<p dir="auto">There is much work left to do before this is useful. Please let me know if you
want to help!</p>
<h2 tabindex="-1" id="user-content-helping-out" dir="auto"><a href="#helping-out">Helping Out<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Contributions are welcome! You can learn more about how I work on Natalie via
the <a href="https://www.youtube.com/playlist?list=PLWUx_XkUoGTq-nkbhnk6PN4m109ISo5BX" rel="nofollow">hacking session videos on YouTube</a>.</p>
<p dir="auto">The easiest way to get started right now would be to find a method on an object
that is not yet implemented and make it yourself! Also take a look at
<a href="https://github.com/natalie-lang/natalie/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22">good first issues</a>.
(See the &#39;Building&#39; and &#39;Running Tests&#39; sections below for some helpful steps.)</p>
<p dir="auto">We have a very quiet <a href="https://discord.gg/hnHp2tdQyn" rel="nofollow">Discord server</a> -- come and hang out!</p>
<h2 tabindex="-1" id="user-content-building" dir="auto"><a href="#building">Building<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Natalie is tested on macOS, OpenBSD, and Ubuntu Linux. Windows is not yet supported.</p>
<p dir="auto">Natalie requires a system Ruby (MRI) to host the compiler, for now.</p>
<p dir="auto">Prerequisites:</p>
<ul dir="auto">
<li>git</li>
<li>autoconf</li>
<li>automake</li>
<li>libtool</li>
<li>GNU make</li>
<li>gcc or clang</li>
<li>Ruby 3.0 or higher with dev headers
<ul dir="auto">
<li>Using <a href="https://github.com/rbenv/rbenv">rbenv</a> to install Ruby is preferred.</li>
<li>Installing <a href="https://github.com/tpope/rbenv-aliases">rbenv-aliases</a> along with rbenv helps with matching Ruby versions like <code>3.0</code> to the latest patch release.</li>
<li>If not using rbenv or another version manager, you&#39;ll need the <code>ruby</code> and <code>ruby-dev</code> package from your system.</li>
</ul>
</li>
<li>ccache (optional, but recommended)</li>
<li>compiledb (optional, but recommended)</li>
</ul>
<p dir="auto">Install the above prerequisites on your platform, then run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/natalie-lang/natalie
cd natalie
rake"><pre>git clone https://github.com/natalie-lang/natalie
<span>cd</span> natalie
rake</pre></div>
<h3 tabindex="-1" id="user-content-troubleshooting-build-errors" dir="auto"><a href="#troubleshooting-build-errors">Troubleshooting Build Errors<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<ul dir="auto">
<li><strong>Don&#39;t use <code>sudo</code>!</strong> If you already made that mistake, then you should <code>sudo rm -rf build</code>
and try again.</li>
<li>If you get an error about file permissions, e.g. unable to write a file to somewhere like
<code>/usr/lib/ruby</code>, or another path that would require root, then you have a couple options:
<ul dir="auto">
<li>Use a tool like <a href="https://github.com/rbenv/rbenv">rbenv</a> to install a Ruby verison in your
home directory. Gems will also be installed there. Run <code>rbenv version</code> to see which version
is currently selected. Run <code>rbenv shell</code> followed by a version to select that version.</li>
<li>Specify where to install gems with something like:
<div data-snippet-clipboard-copy-content="mkdir -p ~/gems
export GEM_HOME=~/gems"><pre><code>mkdir -p ~/gems
export GEM_HOME=~/gems
</code></pre></div>
You&#39;ll just have to remember to do that every time you open a new terminal tab.</li>
</ul>
</li>
<li>If you get an error about missing <code>bundler</code>, then your operating system probably didn&#39;t
install it alongside Ruby. You can run <code>gem install bundler</code> to get it.</li>
</ul>
<p dir="auto"><strong>NOTE:</strong> Currently, the default build is the &#34;debug&#34; build, since Nataile is in active development.
But you can build in release mode with <code>rake build_release</code>.</p>
<h2 tabindex="-1" id="user-content-usage" dir="auto"><a href="#usage">Usage<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><strong>REPL:</strong></p>

<p dir="auto"><strong>Run a Ruby script:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="bin/natalie examples/hello.rb"><pre>bin/natalie examples/hello.rb</pre></div>
<p dir="auto"><strong>Compile a file to an executable:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="bin/natalie -c hello examples/hello.rb
./hello"><pre>bin/natalie -c hello examples/hello.rb
./hello</pre></div>
<h2 tabindex="-1" id="user-content-using-with-docker" dir="auto"><a href="#using-with-docker">Using With Docker<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<div data-snippet-clipboard-copy-content="docker build -t natalie .                                            # build image
docker run -it --rm natalie                                          # repl
docker run -it --rm natalie -e &#34;p 2 * 3&#34;                             # immediate
docker run -it --rm -v$(pwd)/myfile.rb:/myfile.rb natalie /myfile.rb # execute a local rb file
docker run -it --rm --entrypoint bash natalie                        # bash prompt"><pre><code>docker build -t natalie .                                            # build image
docker run -it --rm natalie                                          # repl
docker run -it --rm natalie -e &#34;p 2 * 3&#34;                             # immediate
docker run -it --rm -v$(pwd)/myfile.rb:/myfile.rb natalie /myfile.rb # execute a local rb file
docker run -it --rm --entrypoint bash natalie                        # bash prompt
</code></pre></div>
<h2 tabindex="-1" id="user-content-running-tests" dir="auto"><a href="#running-tests">Running Tests<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">To run a test (or spec), you can run it like a normal Ruby script:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bin/natalie spec/core/string/strip_spec.rb"><pre>bin/natalie spec/core/string/strip_spec.rb</pre></div>
<p dir="auto">This will run the tests and tell you if there are any failures.</p>
<p dir="auto">If you want to run all the tests that we expect to pass, you can run:</p>

<p dir="auto">Lastly, if you need to run a handful of tests locally, you can use the
<code>test/runner.rb</code> helper script:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bin/natalie test/runner.rb test/natalie/if_test.rb test/natalie/loop_test.rb"><pre>bin/natalie test/runner.rb test/natalie/if_test.rb test/natalie/loop_test.rb</pre></div>
<h3 tabindex="-1" id="user-content-whats-the-difference-between-the-spec-and-test-directories" dir="auto"><a href="#whats-the-difference-between-the-spec-and-test-directories">What&#39;s the difference between the &#39;spec/&#39; and &#39;test/&#39; directories?<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The files in <code>spec/</code> come from the excellent <a href="https://github.com/ruby/spec">ruby/spec</a>
project, which is a community-curated repo of test files that any Ruby
implementation can use to compare its conformance to what MRI (Matz&#39;s Ruby
Interpreter) does. We copy specs over as we implement the part of the language
that they cover.</p>
<p dir="auto">Everything in <code>test/</code> is stuff we wrote while working on Natalie. These are
tests that helped us bootstrap certain parts of the language and/or weren&#39;t
covered as much as we would like by the official Ruby specs. We use this
to supplement the specs in <code>spec/</code>.</p>
<h2 tabindex="-1" id="user-content-copyright--license" dir="auto"><a href="#copyright--license">Copyright &amp; License<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Natalie is copyright 2021, Tim Morgan and contributors. Natalie is licensed
under the MIT License; see the <code>LICENSE</code> file in this directory for the full text.</p>
<p dir="auto">Some parts of this program are copied from other sources, and the copyright
belongs to the respective owner. Such copyright notices are either at the top of
the respective file, in the same directory with a name like <code>LICENSE</code>, or both.</p>
<table>
<thead>
<tr>
<th>file(s)</th>
<th>copyright</th>
<th>license</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>big_int.*</code></td>
<td>Syed Faheel Ahmad</td>
<td>MIT</td>
</tr>
<tr>
<td><code>dtoa.c</code></td>
<td>David M. Gay, Lucent Technologies</td>
<td>custom permissive</td>
</tr>
<tr>
<td><code>fiber_object.*</code></td>
<td>Evan Jones</td>
<td>MIT</td>
</tr>
<tr>
<td><code>spec/*</code></td>
<td>Engine Yard, Inc.</td>
<td>MIT</td>
</tr>
<tr>
<td><code>version.rb</code></td>
<td>Engine Yard, Inc.</td>
<td>MIT</td>
</tr>
<tr>
<td><code>zlib</code></td>
<td>Jean-loup Gailly and Mark Adler</td>
<td>zlib license</td>
</tr>
</tbody>
</table>
<p dir="auto">See each file above for full copyright and license text.</p>
</article>
          </div></div>
  </body>
</html>
