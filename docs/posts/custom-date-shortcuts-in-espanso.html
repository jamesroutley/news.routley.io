<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://missfunmi.com/custom-date-shortcuts-in-espanso/">Original</a>
    <h1>Custom Date Shortcuts in Espanso</h1>
    
    <div id="readability-page-1" class="page"><div id="skip"><section><p>Custom Date Shortcuts in Espanso</p><p>A handy text replacement shortcut that turns :jan31: into &#39;Sat Jan 31, 2026&#39; using regex and bash.</p><p><time datetime="2026-01-24">Published January 24, 2026</time></p></section><section><p>For some reason, I find myself having to type out dates a lot â€” in race reports, meeting notes, emails, blogposts, TODO lists. I usually like to include the weekday so I donâ€™t have to look it up later, but that means I first have to look it up in my calendar to type out a date like <code>Sun Jun 14, 2026</code>. Annoying ğŸ˜’. This seemed to me like a problem text replacement could solve, but how?</p><p>The solution sort of found me while I was looking for something else. I needed to use âŒ˜ in a piece of text, and for what felt like the millionth time, I found myself Googling â€œApple command symbolâ€ just to copy and paste the character from the search results. While commiserating with my fellow internet users about this somewhat annoying process, I stumbled across a mention of <a href="https://espanso.org/" target="_blank" rel="noopener">espanso</a>, an open source text-expander app for desktop computers. With espanso installed, typing something like <code>:cmd</code> could get replaced with âŒ˜, <code>:lol</code> becomes ğŸ˜‚, and so on anywhere that accepts text on your computer (you can <a href="https://espanso.org/docs/configuration/app-specific-configurations/" target="_blank" rel="noopener">exclude any apps</a> from espanso use). What an amazing idea!</p><p>Looking through the <a href="https://espanso.org/docs/get-started/" target="_blank" rel="noopener">docs</a>, I realized I could combine espansoâ€™s support for <a href="https://espanso.org/docs/matches/regex-triggers/" target="_blank" rel="noopener">regex triggers</a> and <a href="https://espanso.org/docs/matches/extensions/#shell-extension" target="_blank" rel="noopener">shell extensions</a> to turn a shortcut like <code>:jan31:</code> into <code>Sat Jan 31, 2026</code> or <code>:mar8_2027:</code> into <code>Mon Mar 8, 2027</code>. Could this be the thing I had been searching for all my life?!</p><p>Hereâ€™s how I implemented this text replacement in espanso using a bash script on macOS:</p><p>â€“</p><h2 id="the-shortcut" tabindex="-1">The Shortcut</h2><div><p><span>yaml</span></p><pre tabindex="0"><code>

<span>matches</span><span>:</span>
  <span>-</span> <span>regex</span><span>:</span> <span>&#34;:(?P&lt;month&gt;[a-z]{3})(?P&lt;day&gt;[0-9]{1,2})_?(?P&lt;year&gt;[0-9]{0,4}):&#34;</span>
    <span>replace</span><span>:</span> <span>&#34;{{out}}&#34;</span>
    <span>vars</span><span>:</span>
      <span>-</span> <span>name</span><span>:</span> out
        <span>type</span><span>:</span> shell
        <span>params</span><span>:</span>
          <span>cmd</span><span>:</span> <span>&gt;</span><span>
            month=&#34;{{month}}&#34;; day=&#34;{{day}}&#34;; year=&#34;{{year}}&#34;;
            [ -z &#34;$year&#34; ] &amp;&amp; year=$(date +%Y);
            mm=$(echo $month | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39; | sed &#39;s/jan/1/;s/feb/2/;s/mar/3/;s/apr/4/;s/may/5/;s/jun/6/;s/jul/7/;s/aug/8/;s/sep/9/;s/oct/10/;s/nov/11/;s/dec/12/&#39;);
            date -jf &#34;%m %d %Y&#34; &#34;$mm $day $year&#34; &#34;+%a %b %-d, %Y&#34;</span></code></pre></div><p>There are 3 key parts to this that Iâ€™ll cover below:</p><ol><li>The regex, which identifies and extracts parts of the date trigger,</li><li>A bash script, which converts those parts into a readable weekday date</li><li>How espansoâ€™s <code>vars</code> system connects the regex captures to the replacement output</li></ol><hr/><h2 id="1.-the-regex" tabindex="-1">1. The Regex</h2><div><p><span>regex</span></p><pre tabindex="0"><code>:<span>(</span><span>?</span>P&lt;month&gt;<span><span>[</span><span>a<span>-</span>z</span><span>]</span></span><span>{3}</span><span>)</span><span>(</span><span>?</span>P&lt;day&gt;<span><span>[</span><span>0<span>-</span>9</span><span>]</span></span><span>{1,2}</span><span>)</span>_<span>?</span><span>(</span><span>?</span>P&lt;year&gt;<span><span>[</span><span>0<span>-</span>9</span><span>]</span></span><span>{0,4}</span><span>)</span>:</code></pre></div><p>This regex matches patterns like <code>:jan31:</code> or <code>:mar8_2027:</code>. It extracts three pieces of information into variables: <code>month</code>, <code>day</code>, and <code>year</code> (even if <code>year</code> is blank).</p><p><strong>How it works:</strong></p><ul><li><code>:</code> â†’ matches a literal colon at the start.</li><li><code>(?P&lt;month&gt;[a-z]{3})</code> â†’ a named capture group called <code>month</code> that matches exactly 3 lowercase letters (<code>jan</code>, <code>feb</code>, etc.).</li><li><code>(?P&lt;day&gt;[0-9]{1,2})</code> â†’ a named capture group called <code>day</code> that matches 1 or 2 digits (the day of the month).</li><li><code>_?</code>** â†’ an optional underscore (appears if the year is included). I added an underscore to delineate the day from the year (e.g. in my <code>mar8_2027</code> example, it extracts <code>8</code> distinctly from <code>2027</code>).</li><li><code>(?P&lt;year&gt;[0-9]{0,4})</code> â†’ a named capture group called <code>year</code> that matches 0 to 4 digits. Zero digits are allowed so that <code>:jan31:</code> without a year still works â€” in that case, the <code>year</code> variable is still extracted as an empty string.</li><li><code>:</code> â†’ matches a literal colon at the end. Without this trailing colon, espanso would trigger too early â€” typing <code>:jan3</code> would activate before you finished typing <code>:jan31:</code> (if the latter is what you meant to type).</li></ul><hr/><h2 id="2.-the-bash-script" tabindex="-1">2. The Bash Script</h2><div><p><span>bash</span></p><pre tabindex="0"><code><span>month</span><span>=</span><span>&#34;{{month}}&#34;</span><span>;</span> <span>day</span><span>=</span><span>&#34;{{day}}&#34;</span><span>;</span> <span>year</span><span>=</span><span>&#34;{{year}}&#34;</span><span>;</span>
<span>[</span> <span>-z</span> <span>&#34;<span>$year</span>&#34;</span> <span>]</span> <span>&amp;&amp;</span> <span>year</span><span>=</span><span><span>$(</span><span>date</span> +%Y<span>)</span></span><span>;</span>
<span>mm</span><span>=</span><span><span>$(</span><span>echo</span> $month <span>|</span> <span>sed</span> <span>&#39;s/jan/1/;s/feb/2/;s/mar/3/;s/apr/4/;s/may/5/;s/jun/6/;s/jul/7/;s/aug/8/;s/sep/9/;s/oct/10/;s/nov/11/;s/dec/12/&#39;</span><span>)</span></span><span>;</span>
<span>date</span> <span>-jf</span> <span>&#34;%m %d %Y&#34;</span> <span>&#34;<span>$mm</span> <span>$day</span> <span>$year</span>&#34;</span> <span>&#34;+%a %b %-d, %Y&#34;</span></code></pre></div><p>This (simpler than it looks) bash script turns the regex captures into a properly formatted date string including the weekday and fills in the current year if missing.</p><p>How it works:</p><ol><li>Assign the captured regex variables to shell variables:</li></ol><div><p><span>bash</span></p><pre tabindex="0"><code><span>month</span><span>=</span><span>&#34;{{month}}&#34;</span><span>;</span> <span>day</span><span>=</span><span>&#34;{{day}}&#34;</span><span>;</span> <span>year</span><span>=</span><span>&#34;{{year}}&#34;</span><span>;</span></code></pre></div><ol start="2"><li>Default the year to system year if empty (using <a href="https://ss64.com/mac/date.html" target="_blank" rel="noopener">macOSâ€™s <code>date</code> function</a>):</li></ol><div><p><span>bash</span></p><pre tabindex="0"><code><span>[</span> <span>-z</span> <span>&#34;<span>$year</span>&#34;</span> <span>]</span> <span>&amp;&amp;</span> <span>year</span><span>=</span><span><span>$(</span><span>date</span> +%Y<span>)</span></span><span>;</span></code></pre></div><ol start="3"><li>Map the abbreviated months to their numeric equivalents using <a href="https://www.gnu.org/software/sed/manual/sed.html#The-_0022s_0022-Command" target="_blank" rel="noopener"><code>sed</code>â€™s substitution command</a>, so <code>jan</code> â†’ <code>1</code>, <code>feb</code> â†’ <code>2</code>, â€¦, <code>dec</code> â†’ <code>12</code>. Thereâ€™s probably a more elegant way to do this, but this works and I can read it six months from now. You can add as many substitutions as you like â€” <code>s</code> is pretty fast! Also, notice I donâ€™t bother doing input validation since Iâ€™m the one writing the shortcut on my computer anyway ğŸ˜„</li></ol><div><p><span>bash</span></p><pre tabindex="0"><code><span>mm</span><span>=</span><span><span>$(</span><span>echo</span> $month <span>|</span> <span>sed</span> <span>&#39;s/jan/1/;s/feb/2/;s/mar/3/;â€¦/&#39;</span><span>)</span></span><span>;</span> </code></pre></div><ol start="4"><li>Finally, format the date to the desired output using the <code>date</code> function:</li></ol><div><p><span>bash</span></p><pre tabindex="0"><code><span>date</span> <span>-jf</span> <span>&#34;%m %d %Y&#34;</span> <span>&#34;<span>$mm</span> <span>$day</span> <span>$year</span>&#34;</span> <span>&#34;+%a %b %-d, %Y&#34;</span></code></pre></div><ul><li><code>-j</code> â†’ tells the computer weâ€™re not trying to set the system date â€” weâ€™re just looking to parse and format via the additional flag <code>f</code></li><li><code>-f &#34;%m %d %Y&#34;</code> â†’ tells <code>date</code> how to interpret the input string â€” i.e. as <code>&#34;month day year&#34;</code> (e.g., <code>&#34;1 31 2026&#34;</code>)</li><li><code>&#34;+%a %b %-d, %Y&#34;</code> â†’ indicates how the date should be formatted on output; i.e. the above example input date becomes <code>Sat Jan 31, 2026</code> on output</li></ul><hr/><h2 id="3.-the-vars-attributes" tabindex="-1">3. The <code>vars</code> Attributes</h2><div><p><span>yaml</span></p><pre tabindex="0"><code><span>vars</span><span>:</span>
  <span>-</span> <span>name</span><span>:</span> out
    <span>type</span><span>:</span> shell
    <span>params</span><span>:</span>
      
      <span>cmd</span><span>:</span> <span>&gt;</span><span>
	      &lt;bash script&gt;</span></code></pre></div><p>espansoâ€™s <code>vars</code> lets you dynamically compute replacement text using shell logic (or other types, like clipboard, input, etc.). In this case, the shell script reads the regex captures and outputs a formatted date string.</p><p><strong>How it works:</strong></p><ul><li><code>name: out</code> â†’ the variable that espanso will replace in <code>replace: &#34;{{out}}&#34;</code>.</li><li><code>type: shell</code> â†’ tells espanso to execute a shell command to compute the value of this variable.</li><li><code>params: cmd</code> â†’ the actual shell command to run. This command can reference the named regex captures using <code>{{month}}</code>, <code>{{day}}</code>, and <code>{{year}}</code>. The output of the command is then returned back as the replacement for the matched text.</li></ul><hr/><p>And thatâ€™s it! Note on Windows, youâ€™d need to adapt the <code>date</code> parsing logic in step 2 from bash to the equivalent PowerShell function, but the regex and espanso structure stay the same. The core pattern of regex â†’ shell script â†’ formatted output works across platforms.</p><p>It took quite a few iterations, as well as some <a href="https://www.reddit.com/r/ProgrammerHumor/comments/tdtdfn/id_like_you_to_meet_regex/" target="_blank" rel="noopener">AI help with the regex</a>, but Iâ€™m pretty happy with the result. Itâ€™s not quite as snappy as the simple text replacement match pairs, which is a shame because I really wanted to feel smug about shaving the additional 0.3 seconds off my date-typing workflow. I suppose the regex matching and script execution adds an unavoidable tiny overhead in espansoâ€™s translation. Guess Iâ€™ll live with that (for now).</p><p>Now when Iâ€™m recapping meetings or writing race reports, instead of typing out â€œSat Jan 31, 2026,â€ I can just type <code>:jan31:</code> and not even have to open my calendar. Win! If only I can find a way to do this on iPhoneâ€¦ ğŸ¤”</p><ul><li><a href="https://missfunmi.com/26-posts-for-2026/">26 posts for 2026</a></li></ul></section></div></div>
  </body>
</html>
