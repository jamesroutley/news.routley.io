<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://serebit.com/posts/wayland-is-pretty-good/">Original</a>
    <h1>Wayland is pretty good</h1>
    
    <div id="readability-page-1" class="page"><div id="main-page"><header><a href="https://serebit.com/"><img src="https://serebit.com/images/ginger.webp" alt="Picture of me in Limerick, Ireland"/></a><p>Campbell Jones</p></header><section><p>Published on 2023-06-28</p><article><p>I started working on <a href="https://gitlab.com/serebit/flyaway/">Flyaway</a> with the intention of becoming familiar with Wayland, its protocols and extensions, and the wlroots library. Instead, I ended up genuinely liking all three.</p><p><img src="https://serebit.com/posts/wayland-is-pretty-good/budgie-in-flyaway_hu1dcdc12211606c344342f56ec08f689e_37063_848x848_fit_box_2.png" width="848" alt="This is Budgie &#34;running&#34; &#34;in&#34; Flyaway. Blame Joey Riches for this one." title="This is Budgie &#34;running&#34; &#34;in&#34; Flyaway. Blame Joey Riches for this one."/></p><p>Wayland is an interesting beast. X11, for all its faults, does a lot for the desktop environment. If you’re stretched for time, you could - in theory - just slap a panel onto the default X11 window manager and call it a day. The modern landscape of desktop environments built on top of X11 exists because developers have gotten really good at eschewing X11’s built-in crusty junk for their own new and shiny junk, so that things work as you’d expect them to. For the most part, this kinda works - with enough hacks, you can get things like variable refresh rate, fractional scaling, et cetera.</p><p>The problem here is that X11 definitely was not built for those things. Variable refresh rate works, but only if you’re using a single monitor, and mixed refresh rate monitors in a single X session don’t work at all outside of the hardware cursor. Fractional scaling is a hack. Compositing in general is optional and is sort of just stapled onto the existing architecture. X11 does do what it needs to do, which is display windows, but it’s kinda garbo when you need it to do anything more advanced.</p><p>Wayland is what happens when issues with the dominant windowing protocol have been festering for decades. It throws away everything and establishes a core set of standards that must be adhered to, along with a (very large) set of extensions that can be optionally implemented. The website <a href="https://wayland.app/">https://wayland.app/</a> shows all the protocols worth knowing, and a lot more on top of that. It’s kinda like Vulkan, in a sense: the core has the basics, and everything else is extensions that can be queried for by clients.</p><p><a href="https://gitlab.freedesktop.org/wlroots/wlroots/">Wlroots</a> is a library that writes all the code that I didn’t want to have to write, because it has too much math. It’s a generally unopinionated framework for building your own Wayland compositor that, while not perfect, does most of the heavy lifting for you. In writing Flyaway, most of the work so far has been figuring out how to put together the pieces that wlroots has given me; piping and such. Sadly, the documentation kinda sucks, but examples are plenty (e.g. <a href="https://github.com/swaywm/sway/">sway</a> and <a href="https://git.sr.ht/~kennylevinsen/clay/">clay</a>) and the developers have been very accessible and helpful when I’ve had questions.</p><p>Right now, I’m focused on implementing the <a href="https://wayland.app/protocols/xdg-shell">XDG shell</a> protocol that has all the desktop windowing functionality you expect, like maximizing/minimizing/tiling, and the wlroots-spearheaded <a href="https://wayland.app/protocols/wlr-layer-shell-unstable-v1">wlr-layer-shell</a> protocol for KDE/Budgie style panels and docks. The former is a must-have, and the latter is what I have determined is the best way for Budgie’s panel system to be ported to Wayland. The below is a small demonstration of what I’ve accomplished so far with wlr-layer-shell, using the <a href="https://github.com/wmww/gtk-layer-shell">gtk-layer-shell</a> example binary.</p><p>Primarily, what I’ve learned is that Wayland is actually really well-designed. The writing is on the wall for X, and Wayland really is the future. I look forward to the day when I will be able to start up a Budgie desktop shell and have Wayland be running underneath. Oh, and it’ll have proper VRR support, or I’m not signing off on it.</p></article></section></div></div>
  </body>
</html>
