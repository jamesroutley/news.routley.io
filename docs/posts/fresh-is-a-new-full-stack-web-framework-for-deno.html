<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://deno.com/blog/fresh-is-stable">Original</a>
    <h1>Fresh is a new full stack web framework for Deno</h1>
    
    <div id="readability-page-1" class="page"><div><p><a href="https://fresh.deno.dev/" rel="noopener noreferrer">Fresh</a> is a new full stack web framework for Deno. By default, web pages
built with Fresh send zero JavaScript to the client. The framework has no build
step which allows for an order of magnitude improvement in deployment times.
Today we are releasing the first stable version of Fresh.</p>
<p>Client side rendering has become increasingly popular in recent years. React
(and React-like) pages allow programs to build very complex UIs with relative
ease. The popularity shows in the current web framework space: it is dominated
by React based frameworks.</p>
<p>But client-side rendering is expensive; the framework often will ship hundreds
of kilobytes of client-side JavaScript to users on each request. These JS
bundles often do little more than rendering static content that could just as
well have been served as plain HTML.</p>
<p>Some newer frameworks also have support for server side rendering. This helps
reduce page load times by pre-rendering on the server. But most current
implementations still ship the entire rendering infrastructure for the full
application to every client so the page can be fully re-rendered on the client.</p>
<p>This is a bad development - client-side JavaScript is really expensive: it slows
down the user experience, drastically increases power consumption on mobile
devices, and is often not very robust.</p>
<p>Fresh uses a different model: one where you ship <strong>0 KB</strong> of JS to clients by
default. One where the majority of rendering is done on a server, and the client
is only responsible for re-rendering small islands of interactivity. A model
where the developer explicitly opts in to client side rendering for specific
components. This model was described back in 2020 by Jason Miller in his
<a href="https://jasonformat.com/islands-architecture" rel="noopener noreferrer"><em>Islands Architecture</em> blog post</a>.</p>
<p>At its core, Fresh is a routing framework and templating engine that renders
pages as they are requested, on a server. In addition to this just-in-time (JIT)
rendering on the server, Fresh also provides an interface for seamlessly
rendering some components on the client for maximum interactivity. The framework
uses Preact and JSX (or TSX) for rendering and templating on both the server and
the client. Client rendering is completely opt in on a per component level, and
as such many applications will ship no JavaScript to the client at all.</p>
<p>Fresh does not have a build step. The code you write is directly the code that
is run on the server and client-side, and any necessary transpilation of
TypeScript or JSX to plain JavaScript is done just-in-time, when it is needed.
This allows for very fast iteration loops with <strong>instant deployments</strong>.</p>
<h2 id="quick-start"><a aria-hidden="true" tabindex="-1" href="#quick-start"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h2><p>To really explain what makes Fresh special, let&#39;s scaffold a new project and
look at some code:</p>
<pre><code>deno run -A -r https://fresh.deno.dev my-app</code></pre><p>This script generates the minimal boilerplate required for a Fresh project in
the folder you specified as the last argument to the initialization script
(<code>my-app</code> in this case). You can learn more about what all the files mean in the
<a href="https://fresh.deno.dev/docs/getting-started/create-a-project" rel="noopener noreferrer"><em>Getting Started</em> guide</a>.</p>
<pre><code>my-app/
├── README.md
├── deno.json
├── dev.ts
├── fresh.gen.ts
├── import_map.json
├── islands
│   └── Counter.tsx
├── main.ts
├── routes
│   ├── [name].tsx
│   ├── api
│   │   └── joke.ts
│   └── index.tsx
└── static
    ├── favicon.ico
    └── logo.svg</code></pre><p>For now, direct your attention to the <code>routes/</code> folder. It contains the handlers
and templates for each route of the application. The name of each file defines
which paths the route matches. The <code>api/joke.ts</code> file serves requests to
<code>/api/joke</code> for example. The folder structure might remind you of Next.js or
PHP, as these systems also use <a href="https://fresh.deno.dev/docs/concepts/routing" rel="noopener noreferrer">file system routing</a>.</p>
<p>Let&#39;s take a look at the <code>routes/index.tsx</code> file:</p>
<div><pre>

<span>import</span> <span>{</span> h <span>}</span> <span>from</span> <span>&#34;preact&#34;</span><span>;</span>
<span>import</span> Counter <span>from</span> <span>&#34;../islands/Counter.tsx&#34;</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>Home</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span><span><span>&lt;</span>div</span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span>img</span>
        <span>src</span><span><span>=</span><span>&#34;</span>/logo.svg<span>&#34;</span></span>
        <span>height</span><span><span>=</span><span>&#34;</span>100px<span>&#34;</span></span>
        <span>alt</span><span><span>=</span><span>&#34;</span>the fresh logo: a sliced lemon dripping with juice<span>&#34;</span></span>
      <span>/&gt;</span></span><span>
      </span><span><span><span>&lt;</span>p</span><span>&gt;</span></span><span>
        Welcome to `fresh`. Try update this message in the ./routes/index.tsx
        file, and refresh.
      </span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span><span>Counter</span></span> <span>start</span><span><span>=</span><span>{</span><span>3</span><span>}</span></span> <span>/&gt;</span></span><span>
    </span><span><span><span>&lt;/</span>div</span><span>&gt;</span></span>
  <span>)</span><span>;</span>
<span>}</span></pre></div><p>The default export of the route is the JSX template that is rendered server side
for each request. The template component itself is never rendered on the client.</p>
<p>This poses the question: what if you do want to re-render some parts of the
application on the client, for example in response to some user interaction?
This is what Fresh&#39;s <a href="https://fresh.deno.dev/docs/concepts/islands" rel="noopener noreferrer"><em>Islands</em></a> are for. They are individual
components of an application that are re-hydrated on the client to allow
interaction.</p>
<p>Below is an example of an island that provides a client side counter with
increment and decrement buttons. It uses the Preact <code>useState</code> hook to keep
track of the counter value.</p>
<div><pre>



<span>import</span> <span>{</span> h <span>}</span> <span>from</span> <span>&#34;preact&#34;</span><span>;</span>
<span>import</span> <span>{</span> useState <span>}</span> <span>from</span> <span>&#34;preact/hooks&#34;</span><span>;</span>

<span>interface</span> <span>CounterProps</span> <span>{</span>
  start<span>:</span> <span>number</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>Counter</span><span>(</span>props<span>:</span> CounterProps<span>)</span> <span>{</span>
  <span>const</span> <span>[</span>count<span>,</span> setCount<span>]</span> <span>=</span> <span>useState</span><span>(</span>props<span>.</span>start<span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span><span><span>&lt;</span>div</span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span>p</span><span>&gt;</span></span><span>{</span>count<span>}</span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span>button</span> <span>onClick</span><span><span>=</span><span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCount</span><span>(</span>count <span>-</span> <span>1</span><span>)</span><span>}</span></span><span>&gt;</span></span><span>-1</span><span><span><span>&lt;/</span>button</span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span>button</span> <span>onClick</span><span><span>=</span><span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setCount</span><span>(</span>count <span>+</span> <span>1</span><span>)</span><span>}</span></span><span>&gt;</span></span><span>+1</span><span><span><span>&lt;/</span>button</span><span>&gt;</span></span><span>
    </span><span><span><span>&lt;/</span>div</span><span>&gt;</span></span>
  <span>)</span><span>;</span>
<span>}</span></pre></div><p>Islands have to be placed in the <code>islands/</code> folder. Fresh takes care of
automatically re-hydrating the island on the client if it encounters its use in
a route&#39;s template.</p>
<p>Fresh is not just a frontend framework, but rather a fully integrated system for
writing websites. You can arbitrarily handle requests of any type, return custom
responses, make database requests, and more. This route returns a plain text
HTTP response instead of an HTML page for example:</p>
<div><pre>


<span>const</span> <span>JOKES</span> <span>=</span> <span>[</span><span>]</span><span>;</span>

<span>export</span> <span>const</span> handler <span>=</span> <span>(</span>_req<span>:</span> Request<span>)</span><span>:</span> Response <span>=&gt;</span> <span>{</span>
  <span>const</span> randomIndex <span>=</span> Math<span>.</span><span>floor</span><span>(</span>Math<span>.</span><span>random</span><span>(</span><span>)</span> <span>*</span> <span>JOKES</span><span>.</span>length<span>)</span><span>;</span>
  <span>const</span> body <span>=</span> <span>JOKES</span><span>[</span>randomIndex<span>]</span><span>;</span>
  <span>return</span> <span>new</span> <span>Response</span><span>(</span>body<span>)</span><span>;</span>
<span>}</span><span>;</span></pre></div><p>This can also be used to do asynchronous data fetching for a route. Here is a
route that loads blog posts from a file on disk:</p>
<div><pre>


<span>import</span> <span>{</span> HandlerContext<span>,</span> PageProps <span>}</span> <span>from</span> <span>&#34;$fresh/server.ts&#34;</span><span>;</span>

<span>export</span> <span>const</span> handler <span>=</span> <span>async</span> <span>(</span>_req<span>:</span> Request<span>,</span> ctx<span>:</span> HandlerContext<span>)</span><span>:</span> Response <span>=&gt;</span> <span>{</span>
  <span>const</span> body <span>=</span> <span>await</span> Deno<span>.</span><span>readTextFile</span><span>(</span><span><span>`</span><span>./posts/</span><span><span>${</span>ctx<span>.</span>params<span>.</span>id<span>}</span></span><span>.md</span><span>`</span></span><span>)</span><span>;</span>
  <span>return</span> ctx<span>.</span><span>render</span><span>(</span><span>{</span> body <span>}</span><span>)</span><span>;</span>
<span>}</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>BlogPostPage</span><span>(</span>props<span>:</span> PageProps<span>)</span> <span>{</span>
  <span>const</span> <span>{</span> body <span>}</span> <span>=</span> props<span>.</span>data<span>;</span>
  
<span>}</span></pre></div><p>Because Fresh is so reliant on dynamic server side rendering, it is imperative
that this is fast. This makes Fresh very well suited for running on the edge in
runtimes like <a href="https://deno.com/deploy" rel="noopener noreferrer">Deno Deploy</a>, Netlify Edge Functions, or Supabase Edge
Functions. This results in rendering happening physically close to a user, which
minimizes network latency.</p>
<p>Deploying a Fresh app to Deno Deploy takes only a couple of seconds: push the
code to a GitHub repository, then link this repository to a project in the Deno
Deploy dashboard. Your project is then served from 33 regions across the globe,
with 100k requests a day included in the free tier.</p>
<h2 id="production-ready"><a aria-hidden="true" tabindex="-1" href="#production-ready"><svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Production Ready</h2><p>Fresh 1.0 is a stable release and can be relied upon for production use. Much of
Deno&#39;s public web services use Fresh (for example the site you are reading this
blog post on now!). This does not mean we are done with Fresh. We have many more
ideas to improve user and developer experience.</p>
<p><em>Try <a href="https://deno.com/deploy" rel="noopener noreferrer">Deno Deploy</a> - you will be surprised at the speed and simplicity.</em></p>
<hr/>
<p>Finally, thank you to <a href="https://github.com/sylc" rel="noopener noreferrer">Sylvain Cau</a>,
<a href="https://github.com/hashrock" rel="noopener noreferrer">@hashrock</a>, and
<a href="https://github.com/iFaxity" rel="noopener noreferrer">Christian Norrman</a> for your help on the Fresh
project. Additional thanks to the
<a href="https://github.com/sponsors/preactjs" rel="noopener noreferrer">Preact team</a> for building Preact, and
<a href="https://github.com/developit" rel="noopener noreferrer">Jason Miller</a> for his <em>Islands Architecture</em> blog
post.</p>
</div></div>
  </body>
</html>
