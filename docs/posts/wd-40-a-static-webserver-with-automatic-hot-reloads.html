<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/baalimago/wd-40">Original</a>
    <h1>Show HN: Wd-40, a static webserver with automatic hot-reloads</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://goreportcard.com/report/github.com/baalimago/wd-41" rel="nofollow"><img src="https://camo.githubusercontent.com/07664b5b6c6475d97c9eab96cb9b696272848c998a02d54d1fc02ac5714c16ff/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f6261616c696d61676f2f77642d3431" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/baalimago/wd-41"/></a>
<a href="https://wakatime.com/badge/user/018cc8d2-3fd9-47ef-81dc-e4ad645d5f34/project/3bc921ec-dc23-4222-bf00-578f2eda0cbd" rel="nofollow"><img src="https://camo.githubusercontent.com/b4cb49803be37acc0b5028e368a74663014979a79d42258ea846e8572a6486ae/68747470733a2f2f77616b6174696d652e636f6d2f62616467652f757365722f30313863633864322d336664392d343765662d383164632d6534616436343564356633342f70726f6a6563742f33626339323165632d646332332d343232322d626630302d3537386632656461306362642e737667" alt="wakatime" data-canonical-src="https://wakatime.com/badge/user/018cc8d2-3fd9-47ef-81dc-e4ad645d5f34/project/3bc921ec-dc23-4222-bf00-578f2eda0cbd.svg"/></a></p>
<p dir="auto">Test coverage: 73.640% ğŸ˜ŒğŸ‘</p>
<p dir="auto">This is a simple static webserver which live reloads your web-browser on changes to the hosted files.</p>

<p dir="auto"><code>wd-41 s|serve &lt;relative directory&gt;</code> or <code>wd-41 s|serve</code> for hosting the current work directory</p>

<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/baalimago/wd-41@latest"><pre>go install github.com/baalimago/wd-41@latest</pre></div>
<p dir="auto">You may also use the setup script:</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -fsSL https://raw.githubusercontent.com/baalimago/wd-41/main/setup.sh | sh"><pre>curl -fsSL https://raw.githubusercontent.com/baalimago/wd-41/main/setup.sh <span>|</span> sh</pre></div>

<ol dir="auto">
<li>First the content of the website is copied to a temporary directory, this is the <em>mirrored content</em></li>
<li>Every mirrored file is inspectd for type, if it&#39;s text/html, a <code>delta-streamer.js</code> script is injected</li>
<li>The web server is started, hosting the <em>mirrored</em> content</li>
<li>The <code>delta-streamer.js</code> in turn sets up a websocket connection to the wd-41 webserver</li>
<li>The original file system is monitored, on any file changes:
<ol dir="auto">
<li>the new file is copied to the mirror (including injections)</li>
<li>the file name is propagated to the browser via the websocket</li>
</ol>
</li>
<li>The <code>delta-streamer.js</code> script then checks if the current window origin is the updated file. If so, it reloads the page.</li>
</ol>
<div data-snippet-clipboard-copy-content="       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 
       â”‚ Web Developer â”‚                                                 
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                 
               â”‚                                                         
       [writes &lt;content&gt;]                                                
               â”‚                                                         
               â–¼                                                         
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          
 â”‚ website-directory/&lt;content&gt; â”‚        â”‚ file system notify  â”‚          
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          
               â”‚                                  â”‚                      
               â”‚                      [update mirrored content]          
               â–¼                                  â”‚                      
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                      
     â”‚ ws-script injector â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              
               â”‚                                                         
               â”‚                                                         
               â–¼                                                         
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            
   â”‚ tmp-abcd1234/&lt;content&gt; â”‚                                            
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            
               â”‚                                                         
       [serves &lt;content&gt;]                                                
               â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                               â”‚         Browser        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                        â”‚
â”‚          Web Server          â”‚               â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [localhost:&lt;port&gt;/&lt;content&gt;] â”‚â—„â”€â”€â”€[reloadâ”€â”€â”€â”€â”¼â”€â–ºâ”‚ ws â”‚  â”‚ &lt;content&gt; â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     page]     â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                               â”‚                        â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"><pre><code>       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 
       â”‚ Web Developer â”‚                                                 
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                 
               â”‚                                                         
       [writes &lt;content&gt;]                                                
               â”‚                                                         
               â–¼                                                         
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          
 â”‚ website-directory/&lt;content&gt; â”‚        â”‚ file system notify  â”‚          
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          
               â”‚                                  â”‚                      
               â”‚                      [update mirrored content]          
               â–¼                                  â”‚                      
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                      
     â”‚ ws-script injector â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              
               â”‚                                                         
               â”‚                                                         
               â–¼                                                         
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            
   â”‚ tmp-abcd1234/&lt;content&gt; â”‚                                            
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            
               â”‚                                                         
       [serves &lt;content&gt;]                                                
               â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                               â”‚         Browser        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                        â”‚
â”‚          Web Server          â”‚               â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [localhost:&lt;port&gt;/&lt;content&gt;] â”‚â—„â”€â”€â”€[reloadâ”€â”€â”€â”€â”¼â”€â–ºâ”‚ ws â”‚  â”‚ &lt;content&gt; â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     page]     â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                               â”‚                        â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>
</article></div></div>
  </body>
</html>
