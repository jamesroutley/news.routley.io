<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.legitsecurity.com/blog/camoleak-critical-github-copilot-vulnerability-leaks-private-source-code">Original</a>
    <h1>CamoLeak: Critical GitHub Copilot Vulnerability Leaks Private Source Code</h1>
    
    <div id="readability-page-1" class="page"><section>
	
</section><div>
  <div>
    <div>
      

      <div>
        <article>
          <div>
            <p><b>SHARE:</b>
                
                
                
            </p>
            <p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p data-pm-slice="1 1 []"><i>Get details on our discovery of a <span>critical vulnerability in GitHub Copilot Chat.</span><span></span></i></p>
<!--more-->
<h2><strong>TL;DR:</strong></h2>
<p><span>In June 2025, I found a critical vulnerability in GitHub Copilot Chat (CVSS 9.6) that allowed silent exfiltration of secrets and source code from private repos, and gave me full control over Copilot’s responses, including suggesting malicious code or links.</span><span></span></p>
<p><span>The attack combined </span><strong><span>a novel CSP bypass using GitHub’s own infrastructure</span></strong><span> with </span><strong><span>remote prompt injection. </span></strong><span></span><span>I reported it via HackerOne, and GitHub fixed it by disabling image rendering in Copilot Chat completely.</span></p>
<h2><strong><span>Background</span></strong></h2>
<p><span>GitHub Copilot Chat is an AI assistant built into GitHub that helps developers by answering questions, explaining code, and suggesting implementations directly in their workflow. </span></p>
<p><span>Copilot Chat is context-aware: it can use information from the repository (such as code, commits, or pull requests) to provide tailored answers. </span></p>
<p><span>As always, <strong>more context = more attack surface.</strong></span></p>

<p><span><strong><img src="https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=2106&amp;height=1074&amp;name=rick.png" width="2106" height="1074" loading="lazy" alt="rick" srcset="https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=1053&amp;height=537&amp;name=rick.png 1053w, https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=2106&amp;height=1074&amp;name=rick.png 2106w, https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=3159&amp;height=1611&amp;name=rick.png 3159w, https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=4212&amp;height=2148&amp;name=rick.png 4212w, https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=5265&amp;height=2685&amp;name=rick.png 5265w, https://www.legitsecurity.com/hs-fs/hubfs/rick.png?width=6318&amp;height=3222&amp;name=rick.png 6318w" sizes="(max-width: 2106px) 100vw, 2106px"/></strong></span></p>

<h2 id="finding-the-prompt-injection">Finding the prompt injection</h2>
<p>As mentioned earlier, GitHub Copilot is context-aware - so I set out to make it notice me. To do this, I embedded a prompt directed at Copilot inside a pull request description.</p>
<p><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=720&amp;height=64&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png" width="720" height="64" loading="lazy" alt="Screenshot 2025-09-30 at 3.21.24 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=360&amp;height=32&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 360w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=720&amp;height=64&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 720w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=1080&amp;height=96&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 1080w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=1440&amp;height=128&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 1440w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=1800&amp;height=160&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 1800w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.21.24%20PM.png?width=2160&amp;height=192&amp;name=Screenshot%202025-09-30%20at%203.21.24%20PM.png 2160w" sizes="(max-width: 720px) 100vw, 720px"/></p>

<p><img src="https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=1752&amp;height=908&amp;name=hooray.png" width="1752" height="908" loading="lazy" alt="hooray" srcset="https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=876&amp;height=454&amp;name=hooray.png 876w, https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=1752&amp;height=908&amp;name=hooray.png 1752w, https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=2628&amp;height=1362&amp;name=hooray.png 2628w, https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=3504&amp;height=1816&amp;name=hooray.png 3504w, https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=4380&amp;height=2270&amp;name=hooray.png 4380w, https://www.legitsecurity.com/hs-fs/hubfs/hooray.png?width=5256&amp;height=2724&amp;name=hooray.png 5256w" sizes="(max-width: 1752px) 100vw, 1752px"/></p>

<p><span>But what’s the point if everyone can see it? Luckily, GitHub came to the rescue with a proper solution: </span><strong><span>invisible comments are an official feature!</span></strong><span> </span><span>🎉</span><span><br/></span></p>
<p><span>You can find more details in their documentation: </span><a href="https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax#hiding-content-with-comments">Hiding content with comments</a><span>. By simply putting the content you want to hide inside:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=721&amp;height=43&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png" width="721" height="43" loading="lazy" alt="Screenshot 2025-09-30 at 3.25.10 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=361&amp;height=22&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 361w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=721&amp;height=43&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 721w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=1082&amp;height=65&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 1082w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=1442&amp;height=86&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 1442w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=1803&amp;height=108&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 1803w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.25.10%20PM.png?width=2163&amp;height=129&amp;name=Screenshot%202025-09-30%20at%203.25.10%20PM.png 2163w" sizes="(max-width: 721px) 100vw, 721px"/></span></p>
<p><span>I tried the same prompt but this time as a hidden comment inside the PR description,</span><span><strong> </strong></span><strong><span>and it worked!</span></strong></p>

<p><strong><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=1758&amp;height=882&amp;name=hidden_comment.png" width="1758" height="882" loading="lazy" alt="hidden_comment" srcset="https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=879&amp;height=441&amp;name=hidden_comment.png 879w, https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=1758&amp;height=882&amp;name=hidden_comment.png 1758w, https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=2637&amp;height=1323&amp;name=hidden_comment.png 2637w, https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=3516&amp;height=1764&amp;name=hidden_comment.png 3516w, https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=4395&amp;height=2205&amp;name=hidden_comment.png 4395w, https://www.legitsecurity.com/hs-fs/hubfs/hidden_comment.png?width=5274&amp;height=2646&amp;name=hidden_comment.png 5274w" sizes="(max-width: 1758px) 100vw, 1758px"/></span></strong></p>

<p><span>Interestingly, posting a hidden comment triggers the usual PR notification to the repo owner, but the content of the hidden comment isn’t revealed anywhere.</span></p>

<p><span data-contrast="auto"><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=718&amp;height=386&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png" width="718" height="386" loading="lazy" alt="Screenshot 2025-09-30 at 3.30.38 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=359&amp;height=193&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 359w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=718&amp;height=386&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 718w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=1077&amp;height=579&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 1077w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=1436&amp;height=772&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 1436w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=1795&amp;height=965&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 1795w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.30.38%20PM.png?width=2154&amp;height=1158&amp;name=Screenshot%202025-09-30%20at%203.30.38%20PM.png 2154w" sizes="(max-width: 718px) 100vw, 718px"/><br/></span></p>
<p><span>I attempted logging in with a different user and visited the pull request page. <strong>The prompt was injected into my context as well! </strong><br/></span></p>
<p><span>I then replaced the original “HOORAY” prompt with far more complex instructions, including code suggestions and Markdown rendering, <strong>and to my surprise, they worked flawlessly!</strong><br/></span></p>
<p><span>For instance, notice how effortlessly Copilot suggests this malicious <strong>Copilotevil</strong> package.</span></p>
<p><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=738&amp;height=197&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png" width="738" height="197" loading="lazy" alt="Screenshot 2025-09-23 at 11.24.04 AM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=369&amp;height=99&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 369w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=738&amp;height=197&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 738w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=1107&amp;height=296&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 1107w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=1476&amp;height=394&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 1476w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=1845&amp;height=493&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 1845w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.24.04%20AM.png?width=2214&amp;height=591&amp;name=Screenshot%202025-09-23%20at%2011.24.04%20AM.png 2214w" sizes="(max-width: 738px) 100vw, 738px"/></p>

<p><img src="https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=2704&amp;height=1756&amp;name=test4.gif" width="2704" height="1756" loading="lazy" alt="test4" srcset="https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=1352&amp;height=878&amp;name=test4.gif 1352w, https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=2704&amp;height=1756&amp;name=test4.gif 2704w, https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=4056&amp;height=2634&amp;name=test4.gif 4056w, https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=5408&amp;height=3512&amp;name=test4.gif 5408w, https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=6760&amp;height=4390&amp;name=test4.gif 6760w, https://www.legitsecurity.com/hs-fs/hubfs/test4.gif?width=8112&amp;height=5268&amp;name=test4.gif 8112w" sizes="(max-width: 2704px) 100vw, 2704px"/></p>
<p><em><span>* Notice that the user who asked Copilot Chat to explain the PR is different from the user who posted the invisible prompt, demonstrating that the prompt can affect any user who visits the page.</span></em></p>
<p><strong><span>Copilot operates with the same permissions as the user making the request</span></strong><span>, but it obviously needs access to the user’s private repositories to respond accurately. We can exploit this by including instructions in our injected prompt to access a victim user’s private repository, encode its contents in base16, and append it to a URL. Then, when the user clicks the URL, the data is exfiltrated back to us.</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=768&amp;height=197&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png" width="768" height="197" loading="lazy" alt="Screenshot 2025-09-23 at 11.28.07 AM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=384&amp;height=99&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 384w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=768&amp;height=197&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 768w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=1152&amp;height=296&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 1152w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=1536&amp;height=394&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 1536w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=1920&amp;height=493&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 1920w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2011.28.07%20AM.png?width=2304&amp;height=591&amp;name=Screenshot%202025-09-23%20at%2011.28.07%20AM.png 2304w" sizes="(max-width: 768px) 100vw, 768px"/></span></p>
<p><em><span>* Notice that the repository https://github.com/LegitSecurity/issues-service is a private repo inside a private GitHub organization!</span></em></p>

<p><em><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=2694&amp;height=1682&amp;name=link.png" width="2694" height="1682" loading="lazy" alt="link" srcset="https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=1347&amp;height=841&amp;name=link.png 1347w, https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=2694&amp;height=1682&amp;name=link.png 2694w, https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=4041&amp;height=2523&amp;name=link.png 4041w, https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=5388&amp;height=3364&amp;name=link.png 5388w, https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=6735&amp;height=4205&amp;name=link.png 6735w, https://www.legitsecurity.com/hs-fs/hubfs/link.png?width=8082&amp;height=5046&amp;name=link.png 8082w" sizes="(max-width: 2694px) 100vw, 2694px"/></span></em></p>

<h2><strong><span>Recap: What We Can Do</span></strong></h2>
<ul>
<li>Influence the responses generated by another user’s Copilot</li>
<li>Inject custom Markdown, including URLs, code, and images</li>
<li>Exploit the fact that Copilot runs with the same permissions as the victim user</li>
</ul>
<h2><strong><span>Bypassing Content Security Policy (CSP)</span></strong></h2>
<p><span>This is where things get tricky. If you’ve followed along so far, you’re probably thinking — just inject an HTML </span><span>&lt;img&gt;</span><span> tag into the victim’s chat, encode their private data as a parameter, and once the browser tries to render it, the data will be leaked.</span></p>
<p><span></span><span>Not so fast. GitHub enforces a very restrictive Content Security Policy (CSP), which blocks fetching images and other content types from domains that aren’t explicitly owned by GitHub. So, our “simple” </span><span>&lt;img&gt;</span><span> trick won’t work out of the box.</span></p>
<p><span>You’re probably asking yourself - <strong>wait, how does my fancy README manage to show images from third-party sites?</strong></span></p>
<p><span>When you commit a README or any Markdown file containing external images, GitHub automatically processes the file, during this process:</span></p>
<ol>
<li>GitHub parses the Markdown and identifies any image URLs pointing to domains outside of GitHub.</li>
<li><strong>URL rewriting via Camo: Each external URL is rewritten to a Camo proxy URL. This URL includes a HMAC-based cryptographic signature and points to </strong><span><a href="https://camo.githubusercontent.com/"><strong>https://camo.githubusercontent.com/</strong></a></span><strong>….</strong></li>
<li>Signed request verification: When a browser requests the image, the Camo proxy verifies the signature to ensure it was generated by GitHub. Only valid, signed URLs are allowed.</li>
<li>Content fetching: If the signature is valid, Camo fetches the external image from its original location and serves it through GitHub’s servers.</li>
</ol>
<p>This process ensures that:</p>
<ul>
<li>Attackers cannot craft arbitrary URLs to exfiltrate dynamic data.</li>
<li>All external images go through a controlled proxy, maintaining security and integrity.</li>
<li>The end user sees the image seamlessly in the README, but the underlying URL never exposes the original domain directly.</li>
</ul>
<p><span>More information about Camo can be found </span><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-anonymized-urls"><span>here</span></a><span>.</span></p>
<p><span>Let’s look at an example: Committing a README file to GitHub that contains this URL:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=721&amp;height=42&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png" width="721" height="42" loading="lazy" alt="Screenshot 2025-09-30 at 3.54.19 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=361&amp;height=21&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 361w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=721&amp;height=42&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 721w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=1082&amp;height=63&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 1082w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=1442&amp;height=84&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 1442w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=1803&amp;height=105&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 1803w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%203.54.19%20PM.png?width=2163&amp;height=126&amp;name=Screenshot%202025-09-30%20at%203.54.19%20PM.png 2163w" sizes="(max-width: 721px) 100vw, 721px"/></span></p>
<p><span>Will be automatically changed inside the README into:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=996&amp;height=108&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png" width="996" height="108" loading="lazy" alt="Screenshot 2025-09-30 at 4.09.07 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=498&amp;height=54&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 498w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=996&amp;height=108&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 996w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=1494&amp;height=162&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 1494w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=1992&amp;height=216&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 1992w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=2490&amp;height=270&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 2490w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.09.07%20PM.png?width=2988&amp;height=324&amp;name=Screenshot%202025-09-30%20at%204.09.07%20PM.png 2988w" sizes="(max-width: 996px) 100vw, 996px"/></span></p>
<p><span>Rather than doing it manually through the website, you can use GitHub’s REST API to submit raw Markdown and receive it back with all external image URLs automatically converted to Camo proxy URLs.</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=2692&amp;height=672&amp;name=generating_camo.png" width="2692" height="672" loading="lazy" alt="generating_camo" srcset="https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=1346&amp;height=336&amp;name=generating_camo.png 1346w, https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=2692&amp;height=672&amp;name=generating_camo.png 2692w, https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=4038&amp;height=1008&amp;name=generating_camo.png 4038w, https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=5384&amp;height=1344&amp;name=generating_camo.png 5384w, https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=6730&amp;height=1680&amp;name=generating_camo.png 6730w, https://www.legitsecurity.com/hs-fs/hubfs/generating_camo.png?width=8076&amp;height=2016&amp;name=generating_camo.png 8076w" sizes="(max-width: 2692px) 100vw, 2692px"/></span><span></span></p>
<p><span>Alright, so we can’t generate Camo URLs on the fly — without code execution, every </span><span>&lt;img&gt;</span><span> tag we inject into the victim’s chat must include a valid Camo URL signature that was pre-generated. Otherwise, GitHub’s reverse proxy won’t fetch the content.</span></p>
<h2><strong><span>The discovery</span></strong></h2>
<p><span>I spent a long time thinking about this problem before this crazy idea struck me.</span></p>
<p><span></span><span>I quickly got to work. First, I set up a web server that responds to every request with a 1x1 transparent pixel. This way, when GitHub’s Camo reverse proxy fetches the images from my server, they remain invisible in the victim’s chat.</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=719&amp;height=395&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png" width="719" height="395" loading="lazy" alt="Screenshot 2025-09-30 at 4.15.42 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=360&amp;height=198&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 360w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=719&amp;height=395&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 719w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=1079&amp;height=593&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 1079w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=1438&amp;height=790&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 1438w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=1798&amp;height=988&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 1798w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.15.42%20PM.png?width=2157&amp;height=1185&amp;name=Screenshot%202025-09-30%20at%204.15.42%20PM.png 2157w" sizes="(max-width: 719px) 100vw, 719px"/></span></p>
<p><span>Next, by using GitHub’s API, I created a valid Camo URL dictionary of all the letters and symbols that may be used to leak source code / issues content:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=723&amp;height=85&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png" width="723" height="85" loading="lazy" alt="Screenshot 2025-09-30 at 4.17.46 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=362&amp;height=43&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 362w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=723&amp;height=85&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 723w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=1085&amp;height=128&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 1085w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=1446&amp;height=170&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 1446w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=1808&amp;height=213&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 1808w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.17.46%20PM.png?width=2169&amp;height=255&amp;name=Screenshot%202025-09-30%20at%204.17.46%20PM.png 2169w" sizes="(max-width: 723px) 100vw, 723px"/></span></p>
<p><span>Turns into:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=996&amp;height=202&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png" width="996" height="202" loading="lazy" alt="Screenshot 2025-09-30 at 4.19.12 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=498&amp;height=101&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 498w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=996&amp;height=202&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 996w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=1494&amp;height=303&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 1494w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=1992&amp;height=404&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 1992w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=2490&amp;height=505&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 2490w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-30%20at%204.19.12%20PM.png?width=2988&amp;height=606&amp;name=Screenshot%202025-09-30%20at%204.19.12%20PM.png 2988w" sizes="(max-width: 996px) 100vw, 996px"/></span></p>
<p><span>And finally, I created the prompt:</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=725&amp;height=252&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png" width="725" height="252" loading="lazy" alt="Screenshot 2025-09-23 at 12.13.17 PM" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=363&amp;height=126&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 363w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=725&amp;height=252&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 725w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=1088&amp;height=378&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 1088w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=1450&amp;height=504&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 1450w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=1813&amp;height=630&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 1813w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-23%20at%2012.13.17%20PM.png?width=2175&amp;height=756&amp;name=Screenshot%202025-09-23%20at%2012.13.17%20PM.png 2175w" sizes="(max-width: 725px) 100vw, 725px"/></span></p>
<p><em><span>* I added &#34;random&#34; parameter at the end of each Camo URL and requested Copilot to generate each time a new random number and append it to the URL, this way caching is not a problem.</span></em></p>
<p><span>Our target: </span><strong><span>the description of a zero-day vulnerability inside an issue of a private project.</span></strong></p>

<p><strong><img src="https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=1518&amp;height=726&amp;name=zero_day.png" width="1518" height="726" loading="lazy" alt="zero_day" srcset="https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=759&amp;height=363&amp;name=zero_day.png 759w, https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=1518&amp;height=726&amp;name=zero_day.png 1518w, https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=2277&amp;height=1089&amp;name=zero_day.png 2277w, https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=3036&amp;height=1452&amp;name=zero_day.png 3036w, https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=3795&amp;height=1815&amp;name=zero_day.png 3795w, https://www.legitsecurity.com/hs-fs/hubfs/zero_day.png?width=4554&amp;height=2178&amp;name=zero_day.png 4554w" sizes="(max-width: 1518px) 100vw, 1518px"/></strong></p>

<p><span>The result: </span><strong><span>Stealing zero days from private repositories.</span></strong></p>


<p><span>PoC showcasing the full attack (Only if you have 4 minutes):</span></p>


<p><span>I also managed to get Copilot to search the victim’s entire codebase for the keyword </span>&#34;AWS_KEY&#34; <span>and exfiltrate the result.</span></p>


<h2><strong><span>GitHub’s Response</span></strong></h2>
<p><span>GitHub reports that the vulnerability was fixed as of August 14.</span></p>
<p><span><img src="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=1476&amp;height=426&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png" width="1476" height="426" loading="lazy" alt="Screenshot 2025-09-01 at 18.21.47" srcset="https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=738&amp;height=213&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 738w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=1476&amp;height=426&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 1476w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=2214&amp;height=639&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 2214w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=2952&amp;height=852&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 2952w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=3690&amp;height=1065&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 3690w, https://www.legitsecurity.com/hs-fs/hubfs/Screenshot%202025-09-01%20at%2018.21.47.png?width=4428&amp;height=1278&amp;name=Screenshot%202025-09-01%20at%2018.21.47.png 4428w" sizes="(max-width: 1476px) 100vw, 1476px"/></span></p>
<h2><strong>To learn more</strong></h2>
<p>Get details on a previous <a href="https://www.legitsecurity.com/blog/remote-prompt-injection-in-gitlab-duo">vulnerability</a> we unearthed in GitLab Duo.</p>
<p>Get our thoughts on <a href="https://info.legitsecurity.com/appsec-in-the-age-of-ai-report">AppSec in the age of AI</a>.</p>
</span>
          </p></div>
          
          
          
        </article>
				
<!-- 				<div class="blog-mobile-info-container d-flex" style="flex-wrap:wrap;">
									<div class="blog-post-author-wrapper d-flex desktop-hidden">
					<img loading="lazy" class="blog-post-author-image" src="https://20956152.fs1.hubspotusercontent-na1.net/hubfs/20956152/Screenshot%202025-01-01%20at%2015.49.21.png" alt="Omer Mayraz">
					<a class="blog-post-author-link semibold-weight" href="https://www.legitsecurity.com/blog/author/omer-mayraz" rel="author">
						<span class="blog-post-author-name">Written by</span>
						Omer Mayraz
					</a>
				</div>

				<div class="blog-sidebar-share-wrapper desktop-hidden">
					<h4 class="blog-share-heading display-xs bold-weight">Share this guide</h4>

					<div class="blog-share-links-wrapper d-flex">
						  <a style="margin: 8px;" class="blog-share-link" data-icon="twitter" href="https://twitter.com/intent/tweet?text=https://www.legitsecurity.com/blog/camoleak-critical-github-copilot-vulnerability-leaks-private-source-code"></a>
							<a style="margin: 8px;" class="blog-share-link" data-icon="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.legitsecurity.com/blog/camoleak-critical-github-copilot-vulnerability-leaks-private-source-code" target="_blank" rel="noopener"></a>
					</div>
				</div>
          <div style="color: var(--purply-black);font-weight:600;padding: 20px 10px 0px 15px;">
              <span style="color: var(--gray-500);font-size: var(--text-md);font-weight: 400;line-height: 1.5;">Published on </span><br>October 08, 2025
           </div>
				</div> -->

				
      </div>
    </div>
  </div>
</div></div>
  </body>
</html>
