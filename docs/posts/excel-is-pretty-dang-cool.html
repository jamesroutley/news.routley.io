<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://buttondown.email/hillelwayne/archive/excel-is-pretty-dang-cool/">Original</a>
    <h1>Excel is pretty dang cool</h1>
    
    <div id="readability-page-1" class="page"><div>
                
                    
                        <p>Surprise newsletter! I said there was none this week due to vacation, but that ended Monday and I’m forever cursed by a witch, so</p>
<p>People might remember this quote from <a href="https://buttondown.email/hillelwayne/archive/six-programming-languages-id-like-to-see/" target="_blank">last month’s newsletter</a>:</p>
<blockquote>
<p>Interactive computation is a common enough activity for me that I’d put a <em>lot</em> of time into learning something like this. …Maybe I should just get real good with Excel.</p>
</blockquote>
<p>Did I? <em>Did I!</em> Here’s some of the fun stuff I discovered:</p>
<h2>Excel has actual programming affordances now</h2>
<p>Let’s start with the most useful feature nobody seems to know about. Instead of sprinkling <code>A15</code> and <code>B1:D94</code> in your code, you can just… give the cells and ranges names. Or skip storing information in a cell and just directly assign the name a value. Almost like a real programming language!</p>
<p><img alt="Three names defined, one a fixed value, one a fixed array, and one a reference to a cell" src="https://buttondown.s3.amazonaws.com/images/ee2e7d8e-5ee9-41d6-b585-9829de1fd69e.png"/> </p>
<p>Now that’s not normally something you write home about, except it fixes one of the biggest problems that makes spreadsheets illegible. Instead of writing the formula <code>=A1*B1</code>, you can do <code>=Width*Height</code> like you should have been able to 30 years ago.</p>
<p>Oh, and you can write custom formula now.</p>
<p>Yes, really. In 2020 Microsoft added LET and LAMBDA to Excel. If you assign the name <code>MAXEXP</code> to <code>LAMBDA(arr,y, MAX(arr)^y)</code>, then you can use <code>MAXEXP</code> like any builtin formula. LET can bind new names in the middle of a formula, which can also refer to previous bindings. A really simple example is that <code>LET(x, 1, y, x+1, z, y+x)</code> evaluates to 3. Kinda like how every other programming language with LET works. Sure, the syntax is kinda wonky (unless you’re a sexp fan), but it still. It’s useful.</p>
<p>(It helps if you add newlines to formulae, which you can do with alt+enter.)</p>
<h2>Flash fill!</h2>
<p>Start with</p>
<p><img alt="Four rows, three columns, last column of first two rows is a complicated text transformation, last two rows are missing the last column. Cursor is on the third column." src="https://buttondown.s3.amazonaws.com/images/d1944dd6-e175-4b98-b945-242223329e72.png"/>  </p>
<p>Then press ctrl+e and:</p>
<p><img alt="Now the last two rows have the final column filled out according to the same pattern" src="https://buttondown.s3.amazonaws.com/images/c2408a8e-6620-488b-a742-d8b772ad0f2a.png"/> </p>
<p>How cool is that?!</p>
<h2>There’s good data provenance</h2>
<p>I was pretty excited when I saw the “import from web” button:</p>
<p><img alt="The import from web button" src="https://buttondown.s3.amazonaws.com/images/db3ffa80-6b3f-4c0c-a403-e91660e9c7f7.png"/> </p>
<p>It does <em>almost</em> what you’d expect: put in a url and it’ll let you convert any of the HTML tables in Excel tables.</p>
<p>The <em>almost</em> bit is that it doesn’t just load the table. Instead, it outputs the table as the result of a “data query” against the url. If you mangle the table beyond recognition, you can refresh the query and immediately restore the original table, along with any updates from the source.</p>
<p>You can do this to pretty much any data source, including XML, json, and <em>tables in PDFs</em>. As an experiment I dropped an old tax return PDF into the importer and it was able to pull out the right data.</p>
<p>Before you finish importing data, though, you get a chance to modify it in the “Power Query”. You can filter out rows, fill in blank cells, split a column on a delimiter, basic data cleanup stuff like that. Your changes are modeled as a sequence of transformation steps on the data. This means that, if you refresh the query, all of your original transformations are reapplied. </p>
<p><img alt="Me cleaning up a csv of bad data, with reproducible steps" src="https://buttondown.s3.amazonaws.com/images/6aa1331e-ca40-4166-a2a6-9dd4b986af8d.png"/> </p>
<p>Did I mention you can rename and place comments on your steps? Because you can place comments on your steps. If that’s not cool enough, you can also fork a query, so that two separate queries share starting steps! So you can, for example, source a bunch of data, clean it up, and then decompose it into separate 2021 and 2022 tables. Then if you realize you need to do more cleaning, you can apply it to the forked prefix and both output tables will automatically update.</p>
<h2>Excel is basically an APL</h2>
<p>This might be the weirdest one for me. Excel has this thing called <em>spillover arrays</em>: a formula in a single cell outputs an array of values, which spill over into other cells. For example, if have this table:</p>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>And then place in C1 <code>=A1:A3 + B1:B3</code>, you’ll get <code>C1=3</code>, <code>C2=7</code>, <code>C3=11</code>. Now, if you place in D1 <code>=C1^2</code>, you’ll just get <code>D1=9</code>. But if you instead place <code>C1#^2</code>, it instead applies to C1’s <em>spillover array</em>, meaning you now have <code>D1=9, D2=49, D3=121</code>. </p>
<p>Oh also if you instead do <code>C1 = A1:A3 + TRANPOSE(B1:B3)</code> you get this:</p>
<table>
<thead>
<tr>
<th>C</th>
<th>D</th>
<th>E</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td>5</td>
<td>7</td>
<td>9</td>
</tr>
<tr>
<td>7</td>
<td>9</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>This opens up some fun APL-like experiences. Recently I had a data table like this:</p>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>12</td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>x</td>
</tr>
</tbody>
</table>
<p>In this case, <code>B</code> marked whether the value in <code>A</code> was supposed to be halfed or not. I wanted to calculate the sum of all values, after halving had been applied. The “proper” way to do it would be like this: </p>
<div><pre><span></span><code>=SUM(A:A*IF(ISBLANK(B:B), 1, 0.5))
</code></pre></div>

<p>But you can also do it in an APL-like way, like this:</p>
<div><pre><span></span><code>SUM(A:A*(1-0.5*(B:B=&#34;x&#34;)))
</code></pre></div>

<p>In the insider build there’s a few formulae that will make Excel even more APL-like. In the meantime, here’s game of life in Excel:</p>
<div><pre><span></span><code>LET(x, SUM(OFFSET(cell#,-1,-1,3,3)), (x=3)+cell#*(x=4))
</code></pre></div>

<p><img alt="Three steps of game of life" src="https://buttondown.s3.amazonaws.com/images/f9c1edff-367c-47a1-8afe-269e7c90cb4c.png"/> </p>
<h3>Miscellaneous Nuttery</h3>
<ul>
<li>Excel comes with a constraint solver. You have to enable it in the addons.</li>
<li>You can directly move or copy sheets between Excel files.</li>
<li>With the linked data types, you can put a yoga pose into a cell and Excel will tell you how hard it is</li>
<li>There’s a button to generate 3D globe maps of your data. Apparently you can make guided tours, but I haven’t tried that yet (or ever).</li>
<li>There’s a button that converts a selection into an image which I didn’t even notice until I’d written this entire newsletter.</li>
</ul>
<hr/>
<p>Overall I’m glad I put the time into learning Excel, because it’s a neat tool that I can see being really useful to me. I’m also surprised at how much it outclasses Google Sheets. All of the online comparisons say they’re about equal, but Sheets doesn’t even have proper tables, much less lambdas or a “get yoga pose” button. Then again it <em>is</em> free, that’s gotta count for something.</p>
<p>Also I don’t think most users, or even most “power users”, use many of these features. The same is true for devs, most of whom don’t really use the features of their editors. It’s good to explore these things!</p>
<p>Anyway I’d recommend checking it out if you or your company threw a 365 subscription at ya</p>
<h2>Update for the Internets</h2>
<p>This was sent as part of an email newsletter; you can subscribe <a href="https://buttondown.email/hillelwayne/" target="_blank">here</a>. Common topics are <a href="https://buttondown.email/hillelwayne/archive/there-was-no-formal-methods-winter/" target="_blank">software history</a>, <a href="https://buttondown.email/hillelwayne/archive/formal-specification-languages/" target="_blank">formal methods</a>, the <a href="https://buttondown.email/hillelwayne/archive/reject-simplicity-embrace-complexity/" target="_blank">theory of software engineering</a>, and <a href="https://buttondown.email/hillelwayne/archive/whats-the-most-expensive-software-per-byte/" target="_blank">silly research dives</a>. Updates are usually 1x a week. I also have a <a href="https://www.hillelwayne.com/" target="_blank">website</a> where I put my polished writing (the newsletter is more for off-the-cuff stuff).</p>
                    
                
            </div></div>
  </body>
</html>
