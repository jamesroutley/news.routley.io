<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mistral.ai/news/mixtral-of-experts/">Original</a>
    <h1>Mistral: Mixtral of Experts</h1>
    
    <div id="readability-page-1" class="page"><div><p>Mistral AI continues its mission to deliver the best open models to the developer community. Moving forward in AI requires taking new technological turns beyond reusing well-known architectures and training paradigms. Most importantly, it requires making the community benefit from original models to foster new inventions and usages.</p><p>Today, the team is proud to release Mixtral 8x7B, a high-quality sparse mixture of experts model (SMoE) with open weights. Licensed under Apache 2.0. Mixtral outperforms Llama 2 70B on most benchmarks with 6x faster inference. It is the strongest open-weight model with a permissive license and the best model overall regarding cost/performance trade-offs. In particular, it matches or outperforms GPT3.5 on most standard benchmarks.</p><p>Mixtral has the following capabilities.</p><ul><li>It gracefully handles a context of 32k tokens.</li><li>It handles English, French, Italian, German and Spanish.</li><li>It shows strong performance in code generation.</li><li>It can be finetuned into an instruction-following model that achieves a score of 8.3 on MT-Bench.</li></ul><h4 id="pushing-the-frontier-of-open-models-with-sparse-architectures">Pushing the frontier of open models with sparse architectures</h4><p>Mixtral is a sparse mixture-of-experts network. It is a decoder-only model where the feedforward block picks from a set of 8 distinct groups of parameters. At every layer, for every token, a router network chooses two of these groups (the “experts”) to process the token and combine their output additively.</p><p>This technique increases the number of parameters of a model while controlling cost and latency, as the model only uses a fraction of the total set of parameters per token.
Concretely, Mixtral has 46.7B total parameters but only uses 12.9B parameters per token. It, therefore, processes input and generates output at the same speed and for the same cost as a 12.9B model.</p><p>Mixtral is pre-trained on data extracted from the open Web – we train experts and routers simultaneously.</p><h4 id="performance">Performance</h4><p>We compare Mixtral to the Llama 2 family and the GPT3.5 base model. Mixtral matches or outperforms Llama 2 70B, as well as GPT3.5, on most benchmarks.</p><p><img src="https://mistral.ai/images/news/mixtral-of-experts/overview.png" alt="Performance overview" width="66%"/></p><p>On the following figure, we measure the quality versus inference budget tradeoff. Mistral 7B and Mixtral 8x7B belong to a family of highly efficient models compared to Llama 2 models.</p><p><img src="https://mistral.ai/images/news/mixtral-of-experts/scaling.png" alt="Scaling of performances" width="100%"/></p><p>The following table give detailed results on the figure above.</p><p><img src="https://mistral.ai/images/news/mixtral-of-experts/open_models.png" alt="Detailed benchmarks" width="100%"/></p><p><strong>Hallucination and biases.</strong> To identify possible flaws to be corrected by fine-tuning / preference modelling,
we measure the <em>base</em> model performance on TruthfulQA/BBQ/BOLD.</p><p><img src="https://mistral.ai/images/news/mixtral-of-experts/bbq_bold.png" alt="BBQ BOLD benchmarks" width="40%"/></p><p>Compared to Llama 2, Mixtral is more truthful (73.9% vs 50.2% on the TruthfulQA benchmark) and presents less bias on the BBQ benchmark.
Overall, Mixtral displays more positive sentiments than Llama 2 on BOLD, with similar variances within each dimension.</p><p><strong>Language.</strong> Mixtral 8x7B masters French, German, Spanish, Italian, and English.</p><p><img src="https://mistral.ai/images/news/mixtral-of-experts/multilingual.png" alt="Multilingual benchmarks" width="100%"/></p><h4 id="instructed-models">Instructed models</h4><p>We release Mixtral 8x7B Instruct alongside Mixtral 8x7B. This model has been optimised through supervised fine-tuning and direct preference optimisation (DPO) for careful instruction following. On MT-Bench, it reaches a score of 8.30, making it the best open-source model, with a performance comparable to GPT3.5.</p><p>Note: Mixtral can be gracefully prompted to ban some outputs from constructing applications that require a strong level of moderation, as exemplified <a href="https://docs.mistral.ai/platform/guardrailing">here</a>. A proper preference tuning can also serve this purpose. Bear in mind that without such a prompt, the model will just follow whatever instructions are given.</p><h4 id="deploy-mixtral-with-an-open-source-deployment-stack">Deploy Mixtral with an open-source deployment stack</h4><p>To enable the community to run Mixtral with a fully open-source stack, we have submitted changes to the vLLM project, which integrates Megablocks CUDA kernels for efficient inference.</p><p>Skypilot allows the deployment of vLLM endpoints on any instance in the cloud.</p><h4 id="use-mixtral-on-our-platform">Use Mixtral on our platform.</h4><p>We’re currently using Mixtral 8x7B behind our endpoint <em>mistral-small</em>, which is <a href="https://mistral.ai/news/la-plateforme/">available in beta</a>. <a href="https://console.mistral.ai">Register</a> to get early access to all generative and embedding endpoints.</p><h4 id="acknowledgement">Acknowledgement</h4><p>We thank CoreWeave and Scaleway teams for technical support as we trained our models.</p></div></div>
  </body>
</html>
