<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.videah.net/attacking-my-landlords-boiler/">Original</a>
    <h1>Attacking My Landlord&#39;s Boiler</h1>
    
    <div id="readability-page-1" class="page"><div><article><div><p><label>Posted on <time datetime="2025-04-22T00:00:00+00:00">April 22, 2025</time> ‚Ä¢ 10 minute read</label></p></div><figure><div><picture><img alt="Very bright red photo of a Macbook plugged into a HackRF radio, with my thermostat sitting next to it" height="500px" src="https://blog.videah.net/processed_images/banner.929433b287ec442f.png"/></picture></div></figure><div><div><p>Please do your due diligence and check local laws before attempting anything I do in this post. Transmitting radio signals can become legally problematic <em>very quickly</em>, and the band I specifically transmit on here (<code>868Mhz</code>) is <strong>illegal</strong> in the United States without a license. I&#39;d rather you didn&#39;t have men in suits knocking on your door on my account. You&#39;ve been warned!</p></div></div><p>A little while ago I moved into an apartment to live on my own for the first time. This has given me a decent amount of newfound freedom to sculpt my living environment to my liking, but not enough where I could start knocking down walls. I have a landlord (and a deposit!) to think about, after all. üôÇ</p><p>While it isn&#39;t near the level of knocking down walls, I was finding heating my apartment rather frustrating. The boiler&#39;s thermostat installed by my landlord is a single radio-controlled unit that uses a built-in temperature sensor to modulate the heating on and off to meet a target temperature. This presents a few first-world problems:</p><ul><li>The temperature sensor can only sample a single room in the apartment, which heats unevenly.</li><li>That room is dependent on the physical proximity of the thermostat&#39;s controls, which can be annoying to use if I might be in bed and the controls are in the living room or vice versa.</li><li>If I forget to turn the heating off before I leave the apartment, I&#39;m wasting a lot of costly energy.</li></ul><p>I automate things around my apartment with <a href="https://www.home-assistant.io">Home Assistant</a>, and I wanted to be able to do the same here. There are a lot of off-the-shelf solutions for this, obviously, but to get back to the knocking-down-walls comparison, they would require my landlord&#39;s cooperation and likely a visit from an electrician. I don&#39;t want that!</p><p>Instead, here&#39;s how I figured out how to control my apartment&#39;s heating in a way that leaves no trace using the existing thermostat already fitted by my landlord, and maybe learn a bit about radios along the way.</p><h2 id="where-do-we-start">Where Do We Start?</h2><p>I knew that the thermostat communicated with the boiler through some kind of radio protocol. We could try to reverse-engineer the protocol from scratch, but as I&#39;ll get into later, that turns out to be <em>very involved</em> and way beyond my minimal radio skills.</p><p>I eventually decided it was a lot easier to attempt something called a <a href="https://en.wikipedia.org/wiki/Replay_attack#Remote_keyless-entry_system_for_vehicles">Replay Attack</a>. This involves cloning the signals sent between the boiler and the thermostat, and then pretending <em>we</em> are the thermostat by re-broadcasting the signals. This way we don&#39;t need to understand the protocol, just replay it.</p><div><div><p>This approach requires some degree of luck and crossing your fingers. Replay attacks can be pretty easily thwarted by using an incrementing counter in the communications to nullify previous signals, ignoring signals with a counter value you&#39;ve already seen. I was lucky the thermostat does not do this‚Äîyour mileage may vary!</p></div></div><h2 id="initial-reconnaissance">Initial Reconnaissance</h2><p>The first thing I did was check to see if there was any information online about my specific thermostat. I came across <a href="https://www.wolseley.co.uk/product/center-rf-wireless-programmable-boiler-thermostat">a listing for the exact model I had</a>, along with a datasheet in the attachments section. The section on <em>RF Communication</em> is exactly what I was looking for:</p><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/boiler_datasheet_rf.png"/></picture></figure><p>From this, we know the thermostat communicates around the <code>868Mhz</code> range. The <code>Protocol: Encrypted</code> part was initially a bit concerning, but it turned out to not be a problem.</p><p>The first issue I&#39;m running into here is that there are shockingly few resources on cloning a <code>868Mhz</code> signal online. Most beefy resources were about using LoRa/Meshtastic. I would come across a lot of Reddit posts of people trying to do the same thing as me for things like ceiling fans and garage doors, but nobody seemed to have any answers... üò≠</p><div><div><p>I <em>suspect</em> this is because unlicensed <code>868Mhz</code> transmission is illegal in the US and nobody cares about Europe, but who really knows. My life would be <em>so much</em> easier if it were <code>433Mhz</code> instead, as there is a plethora of consumer-facing tools for communicating on that band.</p></div></div><h2 id="seeing-signals">Seeing Signals</h2><p>So without much to go on, I thought the first thing to do would be to actually <em>see</em> the radio packets and inspect them. I&#39;d read about <a href="https://en.wikipedia.org/wiki/Software-defined_radio">Software-Defined Radios</a> in the past and guessed it&#39;d be my best bet. Most SDRs are <em>really</em> expensive, so I went with the budget <a href="https://www.aliexpress.com/item/1005005952566458.html?spm=a2g0o.order_list.order_list_main.165.295b1802ErX1lM">RTL-SDR V4</a> off of AliExpress. (This actually ended up being somewhat unnecessary for reasons we&#39;ll eventually get to!)</p><div><div><p>You might have heard of the infamous <a href="https://flipperzero.one">Flipper Zero</a> and its ability to clone and replay signals. Maybe you&#39;re like me and consider using it in this situation, but be warned that the Flipper is <strong>NOT</strong> an SDR. The Flipper is very stingy about what frequencies it can operate on. I found this out the hard way when I borrowed one and assumed all was hopeless when it wouldn&#39;t work.</p></div></div><p>After it arrived, I hooked it up to my laptop with the <a href="https://www.sdrpp.org">SDR++</a> software just to see if it worked and get an initial glimpse of my thermostat yapping. After pressing the thermostat&#39;s buttons a few times, I managed to see the waterfall light up!</p><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/sdr_plus_plus.png"/></picture><figcaption>The &#34;waterfall&#34; at 868Mhz showing long horizontal blips.</figcaption></figure><div><div><p>Ignore the solid vertical line on the waterfall‚Äîthis is just a common byproduct of using a really cheap SDR, and for me it appears nearby to any frequency I&#39;m inspecting.</p></div></div><p>This step isn&#39;t super important, but we can then try to use the <a href="https://github.com/merbanan/rtl_433">rtl_433</a> tool (it works on other frequencies despite the name) to see if the thermostat is speaking a known protocol. More obscure devices might not work here!</p><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/rtl_443_results.png"/></picture></figure><p>It seems like this thermostat speaks the same protocol as another Honeywell one. The demand attribute sets whether the boiler is on (1) or off (0), and then the boiler responds with an acknowledgement (presumably so the thermostat can determine if it&#39;s out of range).</p><h2 id="trying-to-yell-back">Trying To Yell Back</h2><p>Now that we&#39;ve actually seen the back-and-forth communication, we want to be able to send some packets ourselves and puppeteer the boiler as if we were the thermostat.</p><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/challenger.png"/></picture><figcaption>Using a 868Mhz Challenger Dev Board, first failed attempt...</figcaption></figure><p>This was the step I got stuck on for <em>months</em>. I was trying the &#34;smart&#34; route of attempting to reverse-engineer and reconstruct the packets <em>by hand</em> using <a href="https://github.com/jopohl/urh">URH</a> and then broadcasting them with very cheap <code>868Mhz</code> microcontroller boards. I can safely say this was all wayyy outside of my skill set. None of the boards were really designed to talk to anything other than <em>the exact same board</em>, and going any further than that required poking at radio registers in ways I wasn&#39;t comfortable doing.</p><h2 id="the-hackrf">The HackRF</h2><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/hackrf-board.png"/></picture><figcaption>The official HackRF One board, going on to spawn many AliExpress clones.</figcaption></figure><p>I decided to then go for the <strong>sledgehammer</strong> approach: use a full-blown SDR to just replay the exact same signal without a care for what the signal actually contains. But the cheap RTL-SDR I got earlier only supports receiving, not broadcasting. SDRs that can broadcast are usually <em>hundreds of dollars</em>.</p><p>I say <em>usuallyyy</em> because one of the most common broadcast-capable SDRs, the <code>HackRF One</code> (usually upwards of $400), had numerous clones available on AliExpress for a fraction of the price‚Äîjust $40.</p><div><div><p>And then I say <em>haddd</em> because, writing this months later, AliExpress has removed pretty much every listing you could find just searching &#34;HackRF&#34;. From my understanding, they were getting nabbed at customs in a lot of countries that were getting pissy about importing a scawy hacking tool, so they just decided to nuke all the listings rather than deal with it. Newer clones can be bought from <a href="https://opensourcesdrlab.com/products/r10c-hrf-sdr-software-defined-1mhz-to-6ghz-mainboard-development-board-kit?VariantsId=10158">here</a>, but they aren&#39;t nearly as cheap as they used to be... üò≠</p></div></div><p>There are some obvious ethical (and probably a few technical) problems with cheap clones of what is meant to be open-source hardware, but I figured it&#39;d be fine for my small use case. Please <a href="https://greatscottgadgets.com/hackrf/one">support the original hardware project</a> if it&#39;s within your means to!</p><div><div><p>As I kinda alluded to earlier, this makes the need for the RTL-SDR sort of redundant? But I guess it&#39;s always good to have another SDR just to confirm that we&#39;re not polluting other frequencies.</p></div></div><h2 id="actually-yelling-back">Actually Yelling Back</h2><p>With the HackRF in hand, we can use the <a href="https://manpages.debian.org/unstable/hackrf/hackrf_transfer.1.en.html">hackrf_transfer tool</a> to record signals and, most importantly, <em>replay</em> signals. I perform these commands and then press the appropriate controls on the thermostat to write the signals to individual files:</p><pre data-lang="shell"><code data-lang="shell"><span># We set the frequency to 868.3Mhz and the sample rate to 2000000.
</span><span>hackrf_transfer -r turn_off.raw -f 868300000 -s 2000000
</span><span>hackrf_transfer -r turn_on.raw -f 868300000 -s 2000000
</span></code></pre><p>And then we can try and turn the boiler off and on from CLI like this:</p><pre data-lang="shell"><code data-lang="shell"><span># We use -a to turn on the amplifier and -x to increase the gain a tad.
</span><span>hackrf_transfer -t turn_off.raw -f 868300000 -s 2000000 -a 1 -x 23
</span><span>hackrf_transfer -t turn_on.raw -f 868300000 -s 2000000 -a 1 -x 23
</span></code></pre><p>After doing this, I could hear the physical relay inside of my boiler turning on and off!</p><h2 id="automating-the-whole-thing">Automating The Whole Thing</h2><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/hackrf_horizontal.png"/></picture><figcaption>My HackRF clone in a 3D printed case, plugged into the server.</figcaption></figure><p>I have the HackRF plugged into a powered USB hub connected to my Home Assistant server. I wrote a very basic web server that simply shells out to the transmit commands above in a Docker container.</p><p>Then with an <a href="https://github.com/Limych/ha-average">Average Sensor Plugin</a> and the config YAML below:</p><pre data-lang="yaml"><code data-lang="yaml"><span>command_line</span><span>:
</span><span>  - </span><span>switch</span><span>:
</span><span>    </span><span>name</span><span>: </span><span>Boiler
</span><span>    </span><span>command_on</span><span>: &#34;</span><span>curl http://docker-vm:1111/api/on</span><span>&#34;
</span><span>    </span><span>command_off</span><span>: &#34;</span><span>curl http://docker-vm:1111/api/off</span><span>&#34;
</span><span>
</span><span>sensor</span><span>:
</span><span>  - </span><span>platform</span><span>: </span><span>average
</span><span>    </span><span>name</span><span>: &#34;</span><span>Average Temperature</span><span>&#34;
</span><span>    </span><span>entities</span><span>:
</span><span>      - </span><span>sensor.bedroom_thermostat_temperature
</span><span>      - </span><span>sensor.kitchen_thermostat_temperature
</span><span>
</span><span>climate</span><span>:
</span><span>  - </span><span>platform</span><span>: </span><span>generic_thermostat
</span><span>  </span><span>name</span><span>: </span><span>Boiler Thermostat
</span><span>  </span><span>heater</span><span>: </span><span>switch.boiler
</span><span>  </span><span>target_sensor</span><span>: </span><span>sensor.average_temperature
</span></code></pre><p>We have a working controllable thermostat! ü§Ø</p><p>At this point I was just happy to have the thing <em>working</em> after so many months, so I&#39;ll be the first to admit this setup with Home Assistant is a bit slapdash and could use some cleanup. It&#39;d be better to write a proper plugin and control the radio directly instead of shelling out to the CLI. Relying on <code>curl</code> to heat my apartment is maybe a bit cursed?</p><h2 id="was-it-worth-it">Was It Worth It?</h2><figure><picture><img decoding="async" loading="lazy" src="https://parkerhiggins.net/2025/04/realtime-bluesky-events-jetstream-for-helping-friendly-bot/images/boiler_grafana.png"/></picture><figcaption>Grafana graph showing the temperatures following the target one.</figcaption></figure><p>I&#39;ve been using this setup to control the heating of my apartment since the beginning of December and haven&#39;t had any issues since! It&#39;s super convenient to dial in the temperature from my phone, and the automations I have make me feel like this project was really worth the work.</p><p>I have some basic automations like having the temperature go down when I&#39;m sleeping and then up in the morning in time for me waking up, but I also have it so the heating turns off when I go into town and turns back on when I&#39;m just a few train stops away so my place is nice and toasty for me getting home!</p><p>The only thing I&#39;m not happy with is needing to use a very powerful and versatile radio like the HackRF for something as simple as a boiler on/off switch. But I&#39;d rather use something overkill and have it work than spend ages trying to force smaller radios to do my bidding.</p><p>The important thing is I&#39;m not as cold as I used to be! üê∫</p><hr/><div><h3>There was a comment section here. It&#39;s gone now.</h3><p>As of March 16th, 2025 the United Kingdom&#39;s <a href="https://en.wikipedia.org/wiki/Online_Safety_Act_2023">Online Safety Act</a> has gone into full effect. The law presents a lot of challenges for hobbyist websites like this one to present any user-to-user content (like y&#39;know, <i>blog comments</i>) and comes with some pretty serious repercussions for non-compliance.</p><p>The odds of Ofcom (the regulator whose job is to enforce this) kicking my door down over this blog are low if we are being honest with ourselves. But the odds are at least somewhere above zero and the punishment is a life ruining <strong>¬£18 million fine(!!)</strong> so it&#39;s just not worth the risk.</p><p>A kind lawyer has written up the <a href="https://onlinesafetyact.co.uk/ra_blog_with_comments/">implications of this law for self-run blogs like this one</a> and the only way to guarantee that I am not in-scope would be to manually review all comments made before being available to the public. Not to be a big baby about it all but I don&#39;t really want to do this! I liked my current setup!</p><p>So I guess as a little act of protest and to hedge against any risk I&#39;ve removed the comment section entirely. Sorry about that!</p><p>If you want more information on this and how much this sucks for the hobbyist internet <a href="https://lobste.rs/s/ukosa1/uk_users_lobsters_needs_your_help_with#c_xevn8a">please read this writeup</a>.</p></div></article></div></div>
  </body>
</html>
