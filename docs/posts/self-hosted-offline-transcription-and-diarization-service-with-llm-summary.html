<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/transcriptionstream/transcriptionstream">Original</a>
    <h1>Self-hosted offline transcription and diarization service with LLM summary</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Created by <a href="https://transcription.stream" rel="nofollow">https://transcription.stream</a> with special thanks to <a href="https://github.com/MahmoudAshraf97">MahmoudAshraf97</a> and his work on <a href="https://github.com/MahmoudAshraf97/whisper-diarization/">whisper-diarization</a>, and to <a href="https://github.com/jmorganca/ollama">jmorganca</a> for <a href="https://ollama.com/" rel="nofollow">Ollama</a> and its amazing simplicity in use.</p>

<p dir="auto">Transcription Stream is a turnkey self-hosted diarization service that works completely offline. Out of the box it includes:</p>
<ul dir="auto">
<li>drag and drop diarization and transcription via SSH</li>
<li>a web interface for upload, review, and download of files</li>
<li>summarization with Ollama and Mistral</li>
<li>Meilisearch for full text search</li>
</ul>
<p dir="auto">A web interface and SSH drop zones make this simple to use and implement into your workflows. Ollama allows for a powerful toolset, limited only by your prompt skills, to perform complex operations on your transcriptions. Meiliesearch adds ridiculously fast full text search.</p>
<p dir="auto">Use the web interface to upload, listen to, review, and download output files, or drop files via SSH into <code>transcribe</code> or <code>diarize</code>. Files are processed with output placed into a named and dated folder. Have a quick look at the <a href="https://www.youtube.com/watch?v=3RufeOjnlcE" rel="nofollow">install</a> and <a href="https://www.youtube.com/watch?v=pbZ8o7_MjG4" rel="nofollow">ts-web walkthrough</a> videos for a better idea.</p>
<div dir="auto">
<div dir="auto"><h3 tabindex="-1" dir="auto">ssh upload and transcribed</h3><a id="user-content-ssh-upload-and-transcribed" aria-label="Permalink: ssh upload and transcribed" href="#ssh-upload-and-transcribed"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2aa2dd082b5932abf0046d2f20c0cf23d58ecedf80d415e8b83cac8d8a633ddd/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f74732d73736875706c6f61642e706e67"><img src="https://camo.githubusercontent.com/2aa2dd082b5932abf0046d2f20c0cf23d58ecedf80d415e8b83cac8d8a633ddd/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f74732d73736875706c6f61642e706e67" width="33%" alt="upload file to be diarized to the diarize folder" data-canonical-src="https://transcription.stream/ts-sshupload.png"/></a>  <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2ac0fba1c77d1ff3bb436100adff81fcd3fa1b00779e06ffb1695db980a752b8/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f74732d7373687472616e736372696265642e706e67"><img src="https://camo.githubusercontent.com/2ac0fba1c77d1ff3bb436100adff81fcd3fa1b00779e06ffb1695db980a752b8/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f74732d7373687472616e736372696265642e706e67" width="33%" alt="transcribed files in their folders" data-canonical-src="https://transcription.stream/ts-sshtranscribed.png"/></a></p>
<p><a href="https://www.youtube.com/watch?v=pbZ8o7_MjG4" rel="nofollow">
<img src="https://camo.githubusercontent.com/f24f746542895b1f7eb6c4ad7d1e27f46f489df9e5afdea1ab2aa25a0181631b/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f74732d7765622e706e67" width="66%" alt="Example Image" data-canonical-src="https://transcription.stream/ts-web.png"/>
</a></p><div dir="auto"><h3 tabindex="-1" dir="auto">ts-gpu diarization example </h3><a id="user-content-ts-gpu-diarization-example-" aria-label="Permalink: ts-gpu diarization example " href="#ts-gpu-diarization-example-"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p><a href="https://www.youtube.com/watch?v=UAgbcZjR4mM" rel="nofollow">
    <img src="https://camo.githubusercontent.com/8a9021c32cb6f7b753fcde9ac00db477a1379be2f7c9544c4c7e5b7b540ded94/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f766964656f7468756d622e706e67" alt="watch video on youtube" data-canonical-src="https://transcription.stream/videothumb.png"/>
  </a>
</p></div>
<div dir="auto">

<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/8bd00c7e859e9fb5028354f408a06280540a62070f7db7ee9ade9413f3f24912/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f73756d6d6172792e706e67"><img src="https://camo.githubusercontent.com/8bd00c7e859e9fb5028354f408a06280540a62070f7db7ee9ade9413f3f24912/68747470733a2f2f7472616e736372697074696f6e2e73747265616d2f73756d6d6172792e706e67" alt="local ollama mistral summary" data-canonical-src="https://transcription.stream/summary.png"/></a>
</p></div>
<div data-snippet-clipboard-copy-content="prompt_text = f&#34;&#34;&#34;
Summarize the transcription below. Be sure to include pertinent information about the speakers, including name and anything else shared.
Provide the summary output in the following style

Speakers: names or identifiers of speaking parties
Topics: topics included in the transcription
Ideas: any ideas that may have been mentioned
Dates: dates mentioned and what they correspond to
Locations: any locations mentioned
Action Items: any action items

Summary: overall summary of the transcription

The transcription is as follows

{transcription_text}

&#34;&#34;&#34;"><pre><code>prompt_text = f&#34;&#34;&#34;
Summarize the transcription below. Be sure to include pertinent information about the speakers, including name and anything else shared.
Provide the summary output in the following style

Speakers: names or identifiers of speaking parties
Topics: topics included in the transcription
Ideas: any ideas that may have been mentioned
Dates: dates mentioned and what they correspond to
Locations: any locations mentioned
Action Items: any action items

Summary: overall summary of the transcription

The transcription is as follows

{transcription_text}

&#34;&#34;&#34;
</code></pre></div>
<p dir="auto"><strong>Prerequisite: NVIDIA GPU</strong></p>
<blockquote>
<p dir="auto"><strong>Warning:</strong> The resulting ts-gpu image is ~26GB and might take a hot second to create</p>
</blockquote>

<div dir="auto"><h3 tabindex="-1" dir="auto">Pulls all docker images and starts services</h3><a id="user-content-pulls-all-docker-images-and-starts-services" aria-label="Permalink: Pulls all docker images and starts services" href="#pulls-all-docker-images-and-starts-services"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<div dir="auto"><h2 tabindex="-1" dir="auto">Build and Run Instructions</h2><a id="user-content-build-and-run-instructions" aria-label="Permalink: Build and Run Instructions" href="#build-and-run-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If you&#39;d like to build the images locally</p>
</blockquote>
<div dir="auto"><h3 tabindex="-1" dir="auto">Automated Install and Run</h3><a id="user-content-automated-install-and-run" aria-label="Permalink: Automated Install and Run" href="#automated-install-and-run"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="chmod +x install.sh;
./install.sh;"><pre>chmod +x install.sh<span>;</span>
./install.sh<span>;</span></pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="chmod +x run.sh;
./run.sh"><pre>chmod +x run.sh<span>;</span>
./run.sh</pre></div>


<ul dir="auto">
<li><strong>SSH:</strong> 22222</li>
<li><strong>HTTP:</strong> 5006</li>
<li><strong>Ollama:</strong> 11434</li>
<li><strong>Meilisearch:</strong> 7700</li>
</ul>

<ul dir="auto">
<li><strong>Port:</strong> 22222</li>
<li><strong>User:</strong> <code>transcriptionstream</code></li>
<li><strong>Password:</strong> <code>nomoresaastax</code></li>
<li><strong>Usage:</strong> Place audio files in <code>transcribe</code> or <code>diarize</code>. Completed files are stored in <code>transcribed</code>.</li>
</ul>

<ul dir="auto">
<li><strong>URL:</strong> <a href="http://dockerip:5006" rel="nofollow">http://dockerip:5006</a></li>
<li><strong>Features:</strong>
<ul dir="auto">
<li>Audio file upload/download</li>
<li>Task completion alerts with interactive links</li>
<li>HTML5 web player with speed control and transcription highlighting</li>
<li>Time-synced transcription scrubbing/highlighting/scrolling</li>
</ul>
</li>
</ul>

<ul dir="auto">
<li><strong>URL:</strong> <a href="http://dockerip:11434" rel="nofollow">http://dockerip:11434</a></li>
<li>change the prompt used, in <code>/ts-gpu/ts-summarize.py</code></li>
</ul>

<ul dir="auto">
<li><strong>URL:</strong> <a href="http://dockerip:7700" rel="nofollow">http://dockerip:7700</a></li>
</ul>
<blockquote>
<p dir="auto"><strong>Warning:</strong> This is example code for example purposes and should not be used in production environments without additional security measures.</p>
</blockquote>
<div dir="auto"><h3 tabindex="-1" dir="auto">Customization and Troubleshooting</h3><a id="user-content-customization-and-troubleshooting" aria-label="Permalink: Customization and Troubleshooting" href="#customization-and-troubleshooting"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Update variables in the .env file</li>
<li>Change the password for <code>transcriptionstream</code> in the <code>ts-gpu</code> Dockerfile.</li>
<li>Update the Ollama api endpoint IP in .env if you want to use a different endpoint</li>
<li>Update the secret in .env for ts-web</li>
<li>Use .env to choose which models are included in the initial build.</li>
<li>Change the prompt text in ts-gpu/ts-summarize.py to fit your needs. Update ts-web/templates/transcription.html if you want to call it something other than summary.</li>
<li>12GB of vram may not be enough to run both whisper-diarization and ollama mistral. Whisper-diarization is fairly light on gpu memory out of the box, but Ollama&#39;s runner holds enough gpu memory open causing the diarization/transcription to run our of CUDA memory on occasion. Since I can&#39;t run both on the same host reliably, I&#39;ve set the batch size for both whisper-diarization and whisperx to 16, from their default 8, and let a m series mac run the Ollama endpoint.</li>
</ul>

<ul dir="auto">
<li>Need to fix an issue with ts-web that throws an error to console when loading a transcription when a summary.txt file does not also exist. Lots of other annoyances with ts-web, but it&#39;s functional.</li>
<li>Need to add a search/control interface to ts-web for Meilisearch</li>
</ul>
</article></div></div>
  </body>
</html>
