<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://riskmusings.substack.com/p/join-my-new-risk-musings-subscriber">Original</a>
    <h1>Join my new Risk Musings subscriber chat</h1>
    
    <div id="readability-page-1" class="page"><article>

<p>I recently found that MAME supports running the SGI Indy while looking for ways to test some modifications I was making to the mips code in 9front. After a fair bit of elbow grease cinap and I (but mostly cinap) were able to get the old 9front indy kernel booting and running within mame. I thought I might as well document how we set things up here. As a word of warning this will require some decent 9front infrastructure setup already and some familiarity with things like ndb, additionally this system is barely usable from a modern standard so its usefulness is limited.</p>
<h2>Baseline MAME Indy</h2>
<p>The mainline MAME only gives the Indy 16MB of ram, which is a little tight. Thanks to some clever folks on the irixnet forums I found a patch for bumping this limit to the theoretical maximum (256MB), you can grab a prepatched repo <a href="https://github.com/majiru/mame">here</a> or if you are using a system with nix flakes available you can use <code>nix run github:majiru/9front-in-a-box#mame</code>.</p>
<p>Next you&#39;ll need to grab the required firmware files, of which I used <a href="https://sgi.neocities.org/">this</a> guide to get going, some links may be dead but some google searching of the required file names should get you some archive.org files.</p>
<p>Next you&#39;ll need to configure networking, MAME is a bit unique here and expects a tap named <code>tap-mess-$UID-0</code>, additionally after running once you&#39;ll need to modify the <code>$MAMEROOT/cfg/indy_4610.cfg</code> to make the <code>edlc</code> device line like so:</p>
<p><code>&lt;device tag=&#34;:edlc&#34; interface=&#34;0&#34; mac=&#34;08:00:69:12:34:56&#34; /&gt;</code></p>
<p>Then you&#39;ll also likely need to modify the network from the in-emulation menu in MAME, which can be found by booting up the emulator, hitting ScrlLk followed by Tab, then clicking network settings and arrowing over to TAP/TUN network. This should only need to be done once as it will change the <code>interface=</code> line for the <code>edlc</code> device, unfortunately this specific index seems to be OS specific (was 0 for me on linux, was 2 for cinap on Windows) so its a bit difficult to modify without the in-emulation menu. At this point you <em>should</em> have a working Indy with networking, I suggest perhaps booting in to IRIX (as documented in the neocities guide) and double checking if you get stuck further on.</p>
<p>(editor&#39;s note: a real tap-mess indeed)</p>
<h2>9front bits</h2>
<p>Now for the fun bits, lets setup our 9front grid for bootp&#39;ing this device. Let&#39;s first build the userspace and kernel:</p>
<p><code>cd /sys/src/</code></p>
<p><code>objtype=mips mk install</code></p>
<p><code>cd /sys/src/9/sgi</code></p>
<p><code>mk install</code></p>
<p>Next we need to configure the network booting, first add a <code>/lib/ndb/local</code> line to the tune of:</p>
<p><code>ip=192.168.168.214 ether=080069123456 sys=indy dom=indy.genso fs=myfs auth=myauth bootf=/mips/9indy</code></p>
<p>Then assuming you have your <code>ip/tftpd</code> running and MAME setup correctly you can boot up the Indy, click the button for maintenance mode, enter the PROM shell, then type <code>BOOTP();</code> which should grab your kernel and boot right up.</p>
<h2>Profit?</h2>
<p><img height="576" src="https://files.catbox.moe/wgp8an.png"/></p>

</article></div>
  </body>
</html>
