<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2025/05/06/random-points-on-a-sphere/">Original</a>
    <h1>A simple way to generate random points on a sphere</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p>I recently ran across a simple way to generate random points uniformly distributed on a sphere: Generate random points in a cube until you get one inside the sphere, then push it to the surface of the sphere by normalizing it [1].</p>
<p><img fetchpriority="high" decoding="async" src="https://www.johndcook.com/pts_on_sphere.png" width="287" height="311"/></p>
<p>In more detail, to generate random points on the unit sphere, generate triples</p>
<p>(<em>u</em><sub>1</sub>, <em>u</em><sub>2</sub>, <em>u</em><sub>3</sub>)</p>
<p>of independent random values uniformly generated on [−1, 1] and compute the sum of there squares</p>
<p><em>S</em>² = <em>u</em><sub>1</sub>² + <em>u</em><sub>2</sub>² + <em>u</em><sub>3</sub>²</p>
<p>If <em>S</em>² &gt; 1 then reject the sample and try again. Otherwise return</p>
<p>(<em>u</em><sub>1</sub>/<em>S</em>, <em>u</em><sub>2</sub>/<em>S</em>, <em>u</em><sub>3</sub>/<em>S</em>).</p>
<p>There are a couple things I like about this approach. First, it’s intuitively plausible that it works. Second, it has minimal dependencies. You could code it up quickly in a new environment, say in an embedded system, though you do need a square root function.</p>
<h2>Comparison with other methods</h2>
<p>It’s not the most common approach. The most common approach to generate points on a sphere in <em>n</em> dimensions is to generate <em>n</em> independent values from a standard normal distribution, then normalize. The advantage of this approach is that it generalizes efficiently to any number of dimensions.</p>
<p>It’s not obvious that the common approach works, unless you’ve studied a far amount of probability, and it raises the question of how to generate samples from normal random variable. The usual method, the Box-Muller algorithm, requires a logarithm and a sine in addition to a square root.</p>
<p>The method starting with points in a cube is more efficient (when <em>n</em> = 3, though not for large <em>n</em>) than the standard approach. About half the samples that you generate from the cube will be thrown out, so on average you’ll need to generate six values from [−1, 1] to generate one point on the sphere. It’s not the <em>most</em> efficient approach—Marsaglia gives a faster algorithm in the paper cited aove—but it’s good enough.</p>
<h2>Accept-reject methods</h2>
<p>One disadvantage to accept-reject methods in general is that although they often have good average efficiency, their worst-case efficiency is theoretically infinitely bad: it’s conceivable that you’ll reject every sample, never getting one inside the sphere. This is not a problem in practice. However, it may be a problem in practice that the runtime is variable.</p>
<p>When computing in parallel, a task may have to wait on the last thread to finish. The runtime for the task is the runtime of the slowest thread. In that case you may want to use an algorithm that is less efficient on average but that has constant runtime.</p>
<p>It also matters in cryptography whether processes have a constant runtime. An attacker may be able to infer something about the path taken through code by observing how long it took for the code to execute.</p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/2023/08/12/fibonacci-lattice/">Evenly distributing points on a sphere</a></li>
<li><a href="https://www.johndcook.com/blog/2021/04/29/reinventing-rng/">Evolution of random number generators</a></li>
<li><a href="https://www.johndcook.com/blog/rng-testing/">Testing random number generators</a></li>
</ul>
<p>[1] George Marsaglia. Choosing a point from the surface of a sphere. The Annals of Mathematical Statistics. 1972, Vol. 43, No. 2, 645–646.</p>
			</div></div>
  </body>
</html>
