<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cgad.ski/blog/where-is-noethers-principle-in-machine-learning.html">Original</a>
    <h1>Where Is Noether&#39;s Principle in Machine Learning?</h1>
    
    <div id="readability-page-1" class="page">
    
    
    <p><em>This post accompanies a <a href="https://cgad.ski/math/mlss_poster.pdf">poster</a> to be presented at the <a href="http://mlss.cc/">MLSS 2024</a>.</em></p>
<p>Physics likes optimization! Subject to its boundary conditions, the time evolution of a physical system is a critical point for a quantity called an <strong>action.</strong> This point of view sets the stage for <strong>Noether&#39;s principle</strong>, a remarkable correspondence between continuous invariances of the action and conservation laws of the system.</p>
<p>In machine learning, we often deal with discrete &#34;processes&#34; whose control parameters are chosen to minimize some quantity. For example, we can see a deep residual network as a process where the role of &#34;time&#34; is played by depth. We may ask:</p>
<ol>
<li>Does Noether&#39;s theorem apply to these processes?</li>
<li>Can we find meaningful conserved quantities?</li>
</ol>
<p>Our answers: &#34;yes,&#34; and &#34;not sure!&#34;</p>
<h2>Noether&#39;s Principle in Physics</h2>
<p>In 1630, Fermat observed that the trajectory a beam of light takes through a lens is a path of least time. Formally, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v(q)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>v</span><span>(</span><span>q</span><span>)</span></span></span></span> gives the velocity of light at a point <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">q,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span><span>,</span></span></span></span> a trajectory <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(t)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span><span>(</span><span>t</span><span>)</span></span></span></span> taken by a beam of light between two points <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(t_0)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span><span>(</span><span><span>t</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(t_1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span><span>(</span><span><span>t</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> will be a stationary point for
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mi>q</mi><mo stretchy="false">]</mo><mo>=</mo><msubsup><mo>∫</mo><msub><mi>t</mi><mn>0</mn></msub><msub><mi>t</mi><mn>1</mn></msub></msubsup><mfrac><mn>1</mn><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">∥</mo><mover accent="true"><mi>q</mi><mo>˙</mo></mover><mo stretchy="false">∥</mo><mtext> </mtext><mi>d</mi><mi>t</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">S[q] = \int_{t_0}^{t_1} \frac{1}{v(q)} \lVert \dot q \rVert \, dt,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span>[</span><span>q</span><span>]</span><span></span><span>=</span><span></span></span><span><span></span><span><span>∫</span><span><span><span><span><span><span></span><span><span><span><span>t</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span><span></span><span><span><span><span>t</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>v</span><span>(</span><span>q</span><span>)</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>∥</span><span><span><span><span><span><span></span><span>q</span></span><span><span></span><span><span>˙</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span>∥</span><span></span><span>d</span><span>t</span><span>,</span></span></span></span></span>
in the sense that
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mi>S</mi><mo stretchy="false">[</mo><mi>q</mi><mo>+</mo><mi>ϵ</mi><mi>h</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{d}{d \epsilon} S[q + \epsilon h] = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>d</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>S</span><span>[</span><span>q</span><span></span><span>+</span><span></span></span><span><span></span><span>ϵ</span><span>h</span><span>]</span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span>
for any &#34;perturbation&#34; <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>h</span></span></span></span> verifying <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0.</mn></mrow><annotation encoding="application/x-tex">h(t_0) = h(t_1) = 0.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>h</span><span>(</span><span><span>t</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>h</span><span>(</span><span><span>t</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>0.</span></span></span></span> Furthermore, this condition turns out to characterize the paths that light can take.</p>
<p>In fact, all fundamental physical theories can be written in the form
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>δ</mi><mi>S</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta S = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>δ</span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span>
for a suitable &#34;action&#34; <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">S,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span>,</span></span></span></span> where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>δ</span></span></span></span> denotes a (variational) derivative with respect to the process trajectory. Such an equation is called a <strong>stationary action principle</strong>.</p>
<p>Given a physical system, a function <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>q</mi><mo separator="true">,</mo><mover accent="true"><mi>q</mi><mo>˙</mo></mover><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(q, \dot q, t, \dots)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>F</span><span>(</span><span>q</span><span>,</span><span></span><span><span><span><span><span><span></span><span>q</span></span><span><span></span><span><span>˙</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span>,</span><span></span><span>t</span><span>,</span><span></span><span>…</span><span></span><span>)</span></span></span></span> of the system state is called a conserved quantity when its value is constant over any given physical trajectory. For dynamics expressed by a stationary action principle, <strong>Noether&#39;s principle</strong> gives a remarkable correspondence between <strong>conserved quantities</strong> and certain <strong>invariances</strong> of the action <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">S.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span>.</span></span></span></span></p>
<p>For the purposes of this article, we will not give more details on Noether&#39;s principle. The interested reader is invited to seek out Chapter 4 of Arnold&#39;s <em>Mathematical Methods of Classical Mechanics</em> for a concise description from the point of view of Lagrangian mechanics. (For a much more complete reference, including the more subtle &#34;off-shell&#34; version applicable to local gauge transformations, see Chapter 5 of Olver&#39;s <em>Application of Lie Groups to Differential Equations</em>.) However, as a guide for the imagination, we illustrate two examples.</p>
<p>In physics, the famous two-body problem is described by the action
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><mo>∫</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><msubsup><mover accent="true"><mi>q</mi><mo>˙</mo></mover><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub><msubsup><mover accent="true"><mi>q</mi><mo>˙</mo></mover><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo>−</mo><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub><mi>G</mi></mrow><mrow><mo stretchy="false">∥</mo><msub><mi>q</mi><mn>1</mn></msub><mo>−</mo><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">∥</mo></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>t</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">S =  \int \frac{1}{2} (m_1 \dot q_1^2 + m_2 \dot q_2^2) - \frac{m_1 m_2 G}{\lVert q_1 - q_2 \rVert} \, dt,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span>∫</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>2</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>(</span><span><span>m</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span><span><span><span></span><span>q</span></span><span><span></span><span><span>˙</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span>1</span></span></span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span><span><span><span></span><span>q</span></span><span><span></span><span><span>˙</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span>2</span></span></span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∥</span><span><span>q</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span><span>q</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>∥</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>m</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>G</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>d</span><span>t</span><span>,</span></span></span></span></span>
where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>q</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">q_2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>q</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> are the positions of our two bodies and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> are their masses. The integrand does not change if the trajectories <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q_1(t)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>q</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>t</span><span>)</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q_2(t)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>q</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>t</span><span>)</span></span></span></span> are translated or rotated, so these transformations are <em>invariants</em> for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">S.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span>.</span></span></span></span> Applying Noether&#39;s theorem gives us three conserved quantities—one for each degree of freedom in our group of transformations—which turn out to be horizontal, vertical, and angular momentum.</p>

<p>In the illustration above, we consider two bodies with equal mass. Conservation of linear momentum means that the sum of the arrows is constant, while conservation of angular momentum means that the sum of highlighted areas is constant.</p>
<p>For a less familiar example of a conservation law, consider a ray of light passing through a rotationally symmetric lens. Rotating a trajectory about the center of the lens does not affect the time needed to traverse it. What conserved quantity does this symmetry produce?</p>

<p>At each instant, let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>p</span></span></span></span> be a vector pointing in the direction of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>q</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot q</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span>q</span></span><span><span></span><span><span>˙</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span> with norm equal to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>v</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">1/v(q).</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1/</span><span>v</span><span>(</span><span>q</span><span>)</span><span>.</span></span></span></span> (We&#39;ve drawn this vector in the widget above.) This vector can be seen as the gradient of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span></span></span></span> with respect to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">q;</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span><span>;</span></span></span></span> it gives the marginal price we would pay to move <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>q</span></span></span></span> in a certain direction at a particular instant. Noether&#39;s principle tells us that
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>∧</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p \wedge (q - c)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>p</span><span></span><span>∧</span><span></span></span><span><span></span><span>(</span><span>q</span><span></span><span>−</span><span></span></span><span><span></span><span>c</span><span>)</span></span></span></span></span>
is conserved, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>c</span></span></span></span> is the center of the lens. In our illustration, this conserved quantity is represented by the area of the triangle.</p>
<h2>Noether&#39;s Principle in ML: A Toy Example</h2>
<p>In machine learning, we routinely deal with processes whose control parameters are chosen to minimize some quantity. For example, say we are trying to solve a supervised learning problem by choosing parameters <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>θ</mi><mi>N</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\theta_1, \dots, \theta_N)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span><span>θ</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> so that a composition
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo>=</mo><msub><mi>φ</mi><mi>N</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>N</mi></msub><mo stretchy="false">)</mo><mo>∘</mo><mo>⋯</mo><mo>∘</mo><msub><mi>φ</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>∘</mo><msub><mi>φ</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F = \varphi_N(\theta_N) \circ \dots \circ \varphi_2(\theta_2) \circ \varphi_1(\theta_1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>F</span><span></span><span>=</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>∘</span><span></span></span><span><span></span><span>⋯</span><span></span><span>∘</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>∘</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span>
minimizes some expected loss <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><mi>L</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[L(F(x), y)]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>[</span><span>L</span><span>(</span><span>F</span><span>(</span><span>x</span><span>)</span><span>,</span><span></span><span>y</span><span>)]</span></span></span></span> with respect to some random variables <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">y.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span>.</span></span></span></span></p>
<p>Let&#39;s view the sequence of random variables
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>x</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>x</mi><mi>N</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mi>N</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>N</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
x_0 &amp;= x \\
x_1 &amp;= \varphi_1(\theta_1)(x_0) \\
&amp; \vdots \\
x_N &amp;= \varphi_N(\theta_N)(x_{N - 1})
\end{align*}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>x</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span>x</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>x</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>x</span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span>(</span><span><span>x</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span><span><span></span><span><span></span><span><span>⋮</span><span></span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span>(</span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>N</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span>
as the states of a discrete-time &#34;process.&#34; After optimization, the trajectory <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>N</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_0, \dots, x_N)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>x</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> is approximately a <strong>critical point for a loss function</strong>. As we saw above, physical trajectories are also characterized as critical points of certain functions. Can we think about our trajectory of intermediate values <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> from a physical point of view?</p>
<p>Of course, several things are different. Most obviously, &#34;time&#34; is now discrete rather than continuous. Furthermore, our trajectory of intermediate values is constrained in a different way. In physics, we specified boundary conditions and allowed the intermediate states of the process to vary, but in machine learning we specify an initial condition and constrain the trajectory <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>N</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_0, \dots, x_N)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>x</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> to be driven by some parameters <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\theta_i.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>θ</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>.</span></span></span></span> Fortunately, Noether&#39;s principle continues to apply!</p>
<p>To see how, let&#39;s consider a toy example that&#39;s easy to visualize. First, we&#39;ll define a family of &#34;deformations&#34; of the plane, as depicted below. (Click the screen or drag the sldier to change the parameters of the deformation.)</p>

<p>Next, we&#39;ll set up some simple optimization problems. In each case, we&#39;ll try to find a sequence of small deformations that work together to send some &#34;clusters&#34; to their corresponding &#34;destinations.&#34; This is easy to do by initializing randomly and optimizing our parameters with gradient descent. In the following widget, a composition of 50 maps is able to swap the positions of three clusters.</p>

<p>Now, observe that our family <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">F</mi></mrow><annotation encoding="application/x-tex">\Fc</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>F</span></span></span></span></span> of deformations is <strong>invariant</strong> under conjugation by translations and rotations. This means that, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Q</span></span></span></span> is a translation or rotation, we have an equality
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>Q</mi><mo>∘</mo><mi>f</mi><mo>∘</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>∣</mo><mi>f</mi><mo>∈</mo><mi mathvariant="script">F</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\Fc = \{ Q \circ f \circ Q^{-1} \mid f \in \Fc \}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>F</span></span><span></span><span>=</span><span></span></span><span><span></span><span>{</span><span>Q</span><span></span><span>∘</span><span></span></span><span><span></span><span>f</span><span></span><span>∘</span><span></span></span><span><span></span><span><span>Q</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>∣</span><span></span></span><span><span></span><span>f</span><span></span><span>∈</span><span></span></span><span><span></span><span><span>F</span></span><span>}</span></span></span></span></span>
of sets. In other words, our family <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">F</mi></mrow><annotation encoding="application/x-tex">\Fc</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>F</span></span></span></span></span> &#34;looks the same&#34; from a translated or rotated coordinate system. Moreover, conjugating a map <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>f</span></span></span></span> by a transformation <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Q</span></span></span></span> near the identity can be realized by making a small change to the parameters that define <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>f</span><span>.</span></span></span></span> As it turns out, this is the right notion of invariance to apply Noether&#39;s principle. What conserved quantity do we get?</p>
<p>For each data point, let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>g</mi><mi>i</mi></msub><msubsup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">(g_i)_{i = 1}^N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>g</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> be the backpropagated gradients of the loss function with respect to the intermediate positions <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><msubsup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">(x_i)_{i = 1}^N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span><span>x</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> that this data point takes through our &#34;process.&#34; Applying a certain discrete Noether&#39;s principle, detailed at the end of this post, will turn invariance of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">F</mi></mrow><annotation encoding="application/x-tex">\Fc</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>F</span></span></span></span></span> under translations into conservation of the <em>expected value</em> <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[g_i]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>[</span><span><span>g</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>]</span></span></span></span> from one layer to the next. (You can display the individual vectors <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> in the widget above.) Invariance under rotation gives a conserved quantity reminiscent of angular momentum, namely <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msub><mi>g</mi><mi>i</mi></msub><mo>∧</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">E[g_i \wedge x_i].</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>[</span><span><span>g</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>∧</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>]</span><span>.</span></span></span></span></p>
<p>In this particular example, it turns out that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[g_i]</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>[</span><span><span>g</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>]</span></span></span></span> is also approximately conserved (and nearly zero) over each individual <em>cluster</em>. In the next widget, we add some
examples where the per-cluster gradient is not conserved. (Each cluster now has its average gradient drawn with a single arrow. For simplicity, we are not visualizing &#34;angular gradient.&#34;)</p>

<p>In the physical world, interactions are often accompanied by transfers of conserved quantities. Think, for example, of particles in a gas exchanging momentum and energy. Conversely, if two systems are not interacting with one another, then conservation laws will hold for each system in isolation. In mechanics, this is known as Newton&#39;s first law.</p>
<p>In our first toy example, the subgoals of bringing each cluster to its respective destination could be achieved without compromise between clusters, meaning that each cluster acted like an independent subsystem. This lack of interaction explains the conservation of gradient within each cluster. (In other words, we can apply Newton&#39;s first law.) In our next examples, &#34;transfers&#34; of average gradient indicate &#34;interactions&#34; between clusters, meaning that the trajectory of our process is no longer a stationary point for each subgoal considered in isolation. On the other hand, we can sometimes identify <em>subset</em> of clusters over which gradient is approximately conserved.</p>
<p>In general, if the layers of a deep model have meaningful &#34;Noether equivariances,&#34; then we can build conserved quantities and perhaps study a physically-inspired notion of &#34;interaction.&#34; However, I don&#39;t know if this idea works in practice! Can you think of interesting equivariances that we might find on real-world machine learning models? (Keep in mind that they might only be valid near the actual parameters of the model.)</p>
<h2>Proof of a Discrete Noether&#39;s Principle</h2>
<p>In the above, we&#39;ve been intentionally vague about the details of Noether&#39;s principle and how it applied to our toy example. We end this post with a general proof of our &#34;discrete&#34; Noether&#39;s principle.</p>
<p>We&#39;ll focus on a single step of an &#34;optimized process.&#34; Let <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi><mspace></mspace><mspace width="0.1111em"></mspace><mo lspace="0em" rspace="0.17em"></mo><mtext> ⁣</mtext><mo lspace="0em" rspace="0em">:</mo><mspace width="0.3333em"></mspace><mi mathvariant="normal">Θ</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">\varphi \colon \Theta \times X \to Y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>φ</span><span></span><span></span><span></span><span></span><span></span><span><span>:</span></span><span></span><span>Θ</span><span></span><span>×</span><span></span></span><span><span></span><span>X</span><span></span><span>→</span><span></span></span><span><span></span><span>Y</span></span></span></span> describe some family of functions parameterized over <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\Theta,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Θ</span><span>,</span></span></span></span> and define the action
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">⟩</mo><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>g</mi><mi>y</mi></msub><mo separator="true">,</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">S = \langle g_x, x \rangle - \langle g_y, \varphi_\theta(x) - y \rangle</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span>⟨</span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>x</span><span>⟩</span><span></span><span>−</span><span></span></span><span><span></span><span>⟨</span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span></span><span>−</span><span></span></span><span><span></span><span>y</span><span>⟩</span></span></span></span></span>
where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span></span></span></span> are understood to be random variables, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">g_x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">g_y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> are their associated loss gradients, and inner products are taken in expectation. In the typical context of supervised learning, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>φ</span></span></span></span> will parameterize a layer of a deep model, and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle g_x, x \rangle</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>⟨</span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>x</span><span>⟩</span></span></span></span> (for example) stands for a sum
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\frac{1}{n} \sum_{i = 1}^n \langle g_x(i), x(i) \rangle</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>n</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span>n</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span>⟨</span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>i</span><span>)</span><span>,</span><span></span><span>x</span><span>(</span><span>i</span><span>)⟩</span></span></span></span></span>
where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span> indexes over a dataset and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>g</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x(i), g_x(i))</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>x</span><span>(</span><span>i</span><span>)</span><span>,</span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>i</span><span>))</span></span></span></span> are activation and gradient vectors for the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>th data point.</p>
<p>The &#34;forward pass&#34; <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = \varphi_\theta(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span></span></span></span> and &#34;backward pass&#34; <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>x</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∂</mi><mi>φ</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>x</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msub><mi>g</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">g_x = (\partial \varphi / \partial x)^T g_y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>(</span><span>∂</span><span>φ</span><span>/</span><span>∂</span><span>x</span><span><span>)</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span></span></span></span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> are encoded by the stationarity of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span></span></span></span> with respect to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">g_y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span>,</span></span></span></span> since
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>g</mi><mi>y</mi></msub></mrow></mfrac><mo>=</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><mo separator="true">,</mo><mspace width="1em"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><msub><mi>g</mi><mi>x</mi></msub><mo>−</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>φ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mi>T</mi></msup><msub><mi>g</mi><mi>y</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial g_y} = \varphi_\theta(x) - y, \quad \frac{\partial S}{\partial x} = g_x - \left( \frac{\partial \varphi}{\partial x}\right)^T g_y.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span></span><span>−</span><span></span></span><span><span></span><span>y</span><span>,</span><span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>x</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>x</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>φ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span><span></span><span><span>T</span></span></span></span></span></span></span></span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>.</span></span></span></span></span>
Similarly, first-order optimality of the parameter <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span></span></span></span> can be expressed as
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>0.</mn></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial \theta} = 0.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>θ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0.</span></span></span></span></span>
In practice, this will hold only approximately, so our conservation law will also be approximate. We ignore this detail for simplicity.</p>
<p>Now, suppose that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y, \theta)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>x</span><span>,</span><span></span><span>y</span><span>,</span><span></span><span>θ</span><span>)</span></span></span></span> are made to depend on a real-valued parameter <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>ϵ</span></span></span></span> and that
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo stretchy="false">⟨</mo><msub><mi>g</mi><mi>y</mi></msub><mo separator="true">,</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><mo stretchy="false">⟩</mo><mo>=</mo><mn>0.</mn></mrow></mstyle></mtd><mtd></mtd><mtd></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\frac{\partial}{\partial \epsilon} \langle g_y, \varphi_\theta(x) - y \rangle = 0.\tag{1}
\end{align*}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span></span><span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⟨</span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span></span><span>−</span><span></span><span>y</span><span>⟩</span><span></span><span>=</span><span></span><span>0.</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span><span><span><span><span><span></span><span><span><span>(</span><span><span>1</span></span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span>
For example, when we have a Lie group <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span></span></span></span> acting on <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">X,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>X</span><span>,</span></span></span></span> <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi></mrow><annotation encoding="application/x-tex">\Theta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Θ</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Y</span></span></span></span> such that
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>φ</mi><mrow><mi>g</mi><mo>⋅</mo><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><mi>g</mi><mo>⋅</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo>⋅</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\varphi_{g \cdot \theta}(g \cdot x) = g \cdot \varphi_\theta(x),</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span><span>g</span><span>⋅</span><span>θ</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>g</span><span></span><span>⋅</span><span></span></span><span><span></span><span>x</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>g</span><span></span><span>⋅</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span>,</span></span></span></span></span>
then any one-parameter subgroup of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span></span></span></span> gives rise to such a variation of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">(x, y, \theta).</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>x</span><span>,</span><span></span><span>y</span><span>,</span><span></span><span>θ</span><span>)</span><span>.</span></span></span></span> This is the case for our toy example, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span></span></span></span> is the group <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">SE</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{SE}(2)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>SE</span></span><span>(</span><span>2</span><span>)</span></span></span></span> of translations and rotations of the plane. I&#39;m calling this kind of symmetry a <strong>Noether equivariance</strong>.</p>
<p>Let&#39;s compute <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∂</mi><mi>S</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>ϵ</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\partial S / \partial \epsilon.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>∂</span><span>S</span><span>/</span><span>∂</span><span>ϵ</span><span>.</span></span></span></span> Applying <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">(1),</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>1</span><span>)</span><span>,</span></span></span></span> we find
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial \epsilon} = \left\langle  g_x, \frac{\partial x}{\partial \epsilon}  \right\rangle.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>.</span></span></span></span></span>
On the other hand, if <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span></span></span></span> is stationary with respect to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\theta,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span><span>,</span></span></span></span> then <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∂</mi><mi>S</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\partial S / \partial \epsilon</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>∂</span><span>S</span><span>/</span><span>∂</span><span>ϵ</span></span></span></span> can be explained entirely by the variation of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">y,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span>,</span></span></span></span> which is
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>y</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial \epsilon} = \frac{\partial S}{\partial y} \frac{\partial y}{\partial \epsilon} = \left\langle  g_y, \frac{\partial y}{\partial \epsilon} \right\rangle.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>y</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>S</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>.</span></span></span></span></span>
Overall, we conclude that
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>y</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\left\langle  g_x, \frac{\partial x}{\partial \epsilon} \right\rangle = \left\langle  g_y, \frac{\partial y}{\partial \epsilon} \right\rangle.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>.</span></span></span></span></span>
This is quite analogous to the conservation law
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mrow><mo fence="true">⟨</mo><mi>p</mi><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{d}{dt} \left\langle  p, \frac{\partial q}{\partial \epsilon}  \right\rangle = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>d</span><span>t</span></span></span><span><span></span><span></span></span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span>⟨</span></span><span>p</span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>q</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span>
that Noether&#39;s principle implies for a Hamiltonian system invariant under a family of canonical transformations.</p>
<p>One simple kind of Noether equivariance is a relationship like
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>φ</mi><mrow><mi>g</mi><mo>⋅</mo><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo>⋅</mo><msub><mi>φ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\varphi_{g \cdot \theta}(x) = g \cdot\varphi_\theta(x),</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span><span>g</span><span>⋅</span><span>θ</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>g</span><span></span><span>⋅</span><span></span></span><span><span></span><span><span>φ</span><span><span><span><span><span><span></span><span><span>θ</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span><span>,</span></span></span></span></span>
meaning that our family of maps is expressive enough to be closed under the action of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span></span></span></span> on its outputs. In this case, since the action on <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> is trivial, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∂</mi><mi>x</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\partial x / \partial \epsilon = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>∂</span><span>x</span><span>/</span><span>∂</span><span>ϵ</span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span> and the &#34;conservation law&#34; associated with any one-parameter subgroup of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span></span></span></span> simply reads
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>y</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">0 = \left\langle g_y, \frac{\partial y}{\partial \epsilon}  \right\rangle.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>.</span></span></span></span></span>
Indeed, this inner product is exactly the derivative of the loss with respect to the transformation of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span></span></span></span> by a given one-parameter subgroup of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">G.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>G</span><span>.</span></span></span></span> If variations to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span></span></span></span> can produce these transformations and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span></span></span></span> is chosen optimally, the inner product must be <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn></mrow><annotation encoding="application/x-tex">0.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.</span></span></span></span> (Informally, this explains why the average gradients in our toy example are approximately <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn></mrow><annotation encoding="application/x-tex">0.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.</span></span></span></span>)</p>
<p>The same idea applies to a group acting only on <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\theta,</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span><span>,</span></span></span></span> in which case we get
<span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">⟨</mo><msub><mi>g</mi><mi>x</mi></msub><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow><mo>=</mo><mn>0.</mn></mrow><annotation encoding="application/x-tex">\left\langle g_x, \frac{\partial x}{\partial \epsilon}  \right\rangle = 0.</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>⟨</span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span>ϵ</span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>⟩</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0.</span></span></span></span></span>
For example, if <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x \in \R^n</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span></span><span>∈</span><span></span></span><span><span></span><span><span><span>R</span></span><span><span><span><span><span><span></span><span><span>n</span></span></span></span></span></span></span></span></span></span></span> is the input to a linear layer, we get a &#34;Noether equivariance&#34; in the form of an action of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">GL</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\GL(n)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>GL</span></span><span>(</span><span>n</span><span>)</span></span></span></span> on <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and the layer parameters. Letting <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∂</mi><mi>x</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\partial x / \partial \epsilon</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>∂</span><span>x</span><span>/</span><span>∂</span><span>ϵ</span></span></span></span> range over all linear functions of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> in the equation above—which we get from the action of one-parameter subgroups of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">GL</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\GL(n)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>GL</span></span><span>(</span><span>n</span><span>)</span></span></span></span>—shows that the tensor product <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>x</mi></msub><mo>⊗</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">g_x \otimes x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>g</span><span><span><span><span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>⊗</span><span></span></span><span><span></span><span>x</span></span></span></span> will vanish in expectation if the loss is stationary with respect to the parameters of the linear layer. The general principle we proved above can be understood as the &#34;two-sided&#34; extension of these kinds of observations.</p>

    


</div>
  </body>
</html>
