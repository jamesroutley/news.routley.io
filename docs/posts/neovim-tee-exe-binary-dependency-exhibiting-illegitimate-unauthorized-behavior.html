<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/neovim/neovim/issues/32431">Original</a>
    <h1>Neovim tee.exe binary dependency exhibiting illegitimate / unauthorized behavior</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="">
      <div data-gid="I_kwDOAPphoM6p93sT" data-url="/neovim/neovim/issues/32431/partials/body?issue=32431" data-channel="eyJjIjoiaXNzdWU6Mjg1MTU2ODQwMyIsInQiOjE3Mzk1MjEyODB9--28da4d2b0acab05f5c5e3d5acaf3e8363f276001b5f7276f7fdeea72155cc89a">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/realchrisolin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/realchrisolin"><img src="https://avatars.githubusercontent.com/u/1288116?s=80&amp;u=9cd46204079272f65d10f774fa457bf7de0a6cb0&amp;v=4" width="40" height="40" alt="@realchrisolin"/></a>

</p>

  <div id="issue-2851568403">

    <div data-body-version="56bec884d2a139f1974c75af922c5f7d5d6f8e3d93e7b94434cf88c0674e6209">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">While installing/testing neovim in a Windows 11 sandbox environment for security testing purposes before deploying in a commercial environment, the bundled tee.exe binary was classified as Trojan.Malware.300983.susgen. After doing my due diligence to rule out a false positive, I&#39;m finding that this binary is exhibiting what I would consider suspicious behavior. Specifically, it is performing DNS lookups to fp2E7A.wpc.2BE4.phicdn.net and fp2e7a.wpc.phicdn.net, and making network connections to the following IPs with one of which being flagged as malicious (confirmed by VirusTotal, <a href="https://www.virustotal.com/gui/file/950eea4e17fa3a7e89fa2c55374037b5797b3f1a54fea1304634884ab42ec14d/relations" rel="nofollow">https://www.virustotal.com/gui/file/950eea4e17fa3a7e89fa2c55374037b5797b3f1a54fea1304634884ab42ec14d/relations</a>):</p>
<p dir="auto">UDP a83f:8110:0:0:700:700:2800:4000:53</p>
<p dir="auto">The tee utility and its expected behavior is fairly well-documented and known. I cannot find any justifiable explanation for this behavior.</p>
<p dir="auto">The commit history shows that this binary was committed to the neovim/deps repo ~2 years ago via <a data-hovercard-type="commit" data-hovercard-url="https://github.com/neovim/deps/commit/21c5e8bdda33521a6ed497b315e03265a2785cbc/hovercard" href="https://github.com/neovim/deps/commit/21c5e8bdda33521a6ed497b315e03265a2785cbc">neovim/deps@<tt>21c5e8b</tt></a> and that&#39;s where it&#39;s being sourced from when building neovim. Given this behavior, I&#39;m inclined to suggest a root cause analysis should be performed and insist that this binary along with the others in the deps repo should be built from source.</p>
      </div>
</task-lists>


        <div>


            <div>
              <div data-view-component="true">
  <!-- '"` --><!-- </textarea></xmp> --><form data-turbo="false" action="/neovim/neovim/reactions" accept-charset="UTF-8" method="post">
    
      
    <div>
          <tool-tip id="tooltip-527cdb3f-58b3-4b00-9b66-4995f56475f6" for="reactions--reaction_button_component-3e069e" popover="manual" data-direction="n" data-type="description" data-view-component="true">tedeh, savchenko, AlexMasterov, kartikynwa, cogwheel, graphitemaster, rlkissinger, janurs2, ppebb, iguanacucumber, and 2 more reacted with confused emoji</tool-tip>
          <tool-tip id="tooltip-819cbcc7-cc3d-4136-81d7-08bcdd741e42" for="reactions--reaction_button_component-309aaa" popover="manual" data-direction="n" data-type="description" data-view-component="true">mormegil-cz, Frizlab, HPRIOR, Oleksii-Kutsenko, iguanacucumber, ron-wolf, and satgo1546 reacted with eyes emoji</tool-tip>
      
    </div>
</form></div>
            </div>
        </div>
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


      <div>
    


      <div data-gid="REFE_lADOAPphoM6p93sTzwAAAAPLkZti">
  
          


  

    


  


  


  
<div>
  <div id="ref-commit-3c5450e">
    
  <p><a data-hovercard-type="user" data-hovercard-url="/users/dundargoc/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dundargoc">dundargoc</a> 

      added a commit
        to dundargoc/neovim
      that referenced
      this issue

    </p><a href="#ref-commit-3c5450e">
      <relative-time datetime="2025-02-13T22:07:56Z">Feb 13, 2025</relative-time>
    </a>
    <div>
      
<div data-channel="eyJjIjoicmVwbzozNzg2MTQ4OTk6Y29tbWl0OjNjNTQ1MGU4M2JiZDg5OTA3NGRhZDNkYTRiNTQxZTgyY2Y1OWFhZDQiLCJ0IjoxNzM5NTIxMjgwfQ==--4a34b8ad93240ba6a30cf5a4ceba058067021d466e1d9a049abc9aa3378e454d" data-url="/dundargoc/neovim/commit/3c5450e83bbd899074dad3da4b541e82cf59aad4/show_partial?partial=commit%2Fcondensed_details">
  <div>
    <div>
      
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/dundargoc/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dundargoc">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/33953936?s=40&amp;u=fda8177141e651d0565717f11506d5967083e75b&amp;v=4" width="20" height="20" alt="@dundargoc"/>
</a>  </p>
</div>


      

      

      

      <!-- ml-1 is added to accommodate "clock" icon -->
      
    </div>
  </div>
    <div>
      <pre>The legitimacy of the binaries can&#39;t be guaranteed and poses a security
risk. A replacement version of these may be introduced in the future in
a more secure manner.

<span aria-label="This commit closes issue #32431.">Closes</span> <a data-error-text="Failed to load title" data-id="2851568403" data-permission-text="Title is private" data-url="https://github.com/neovim/neovim/issues/32431" data-hovercard-type="issue" data-hovercard-url="/neovim/neovim/issues/32431/hovercard" href="https://github.com/neovim/neovim/issues/32431">neovim#32431</a>.</pre>
    </div>
</div>

    </div>
  </div>
</div>

  
<div>
  <div id="ref-commit-0d161ce">
    
  <p><a data-hovercard-type="user" data-hovercard-url="/users/dundargoc/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dundargoc">dundargoc</a> 

      added a commit
        to dundargoc/neovim
      that referenced
      this issue

    </p><a href="#ref-commit-0d161ce">
      <relative-time datetime="2025-02-13T22:50:36Z">Feb 13, 2025</relative-time>
    </a>
    <div>
      
<div data-channel="eyJjIjoicmVwbzozNzg2MTQ4OTk6Y29tbWl0OjBkMTYxY2VmNWE1YTA4NmE2ZTY3NGQ5YzQ0MWNmN2E4YjI5YzQzMTMiLCJ0IjoxNzM5NTIxMjgwfQ==--d2cf79d17c3dc76074c20d7892277563c17b011e916e191288b6cdecb1c4e2b6" data-url="/dundargoc/neovim/commit/0d161cef5a5a086a6e674d9c441cf7a8b29c4313/show_partial?partial=commit%2Fcondensed_details">
  <div>
    <div>
      
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/dundargoc/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dundargoc">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/33953936?s=40&amp;u=fda8177141e651d0565717f11506d5967083e75b&amp;v=4" width="20" height="20" alt="@dundargoc"/>
</a>  </p>
</div>


      

      

      

      <!-- ml-1 is added to accommodate "clock" icon -->
      
    </div>
  </div>
    <div>
      <pre>The legitimacy of the binaries can&#39;t be guaranteed and poses a security
risk. A replacement version of these may be introduced in the future in
a more secure manner.

<span aria-label="This commit closes issue #32431.">Closes</span> <a data-error-text="Failed to load title" data-id="2851568403" data-permission-text="Title is private" data-url="https://github.com/neovim/neovim/issues/32431" data-hovercard-type="issue" data-hovercard-url="/neovim/neovim/issues/32431/hovercard" href="https://github.com/neovim/neovim/issues/32431">neovim#32431</a>.</pre>
    </div>
</div>

    </div>
  </div>
</div>

    




</div>

      <div data-gid="IC_kwDOAPphoM6ec6Lq">
  
      
<div data-gid="IC_kwDOAPphoM6ec6Lq" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6ec6Lq/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/quyleanh/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/quyleanh"><img src="https://avatars.githubusercontent.com/u/9365035?s=80&amp;u=a21581510d681b19e01e2bb867024ebf8f2862a8&amp;v=4" width="40" height="40" alt="@quyleanh"/></a>

</p>


  <div id="issuecomment-2658378474">

    <div data-body-version="2cb678d2df4db44a5e20e6d55a01f0e4d853acba43fde0af20f02ff5ad9421cd">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">Where did these binary files come from and what is its actual behavior?</p>
      </div>
</task-lists>


        
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edCfE">
  
      
<div data-gid="IC_kwDOAPphoM6edCfE" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edCfE/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/zeertzjq/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/zeertzjq"><img src="https://avatars.githubusercontent.com/u/35768171?s=80&amp;u=bc88e4a76542cab3249a02cd50ac8dbb258ddf5a&amp;v=4" width="40" height="40" alt="@zeertzjq"/></a>

</p>


  

</div>


</div>


      

      <div data-gid="IC_kwDOAPphoM6edNdu">
  
      
<div data-gid="IC_kwDOAPphoM6edNdu" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edNdu/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/hakusaro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/hakusaro"><img src="https://avatars.githubusercontent.com/u/532647?s=80&amp;u=b5821831ee4f977bfd34f1573025a553a6800eb5&amp;v=4" width="40" height="40" alt="@hakusaro"/></a>

</p>


  

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edQ_7">
  
      
<div data-gid="IC_kwDOAPphoM6edQ_7" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edQ_7/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/Ret2lib/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Ret2lib"><img src="https://avatars.githubusercontent.com/u/20664366?s=80&amp;u=fce030ba7fb7513e0cebb01b22b9a33adffae12b&amp;v=4" width="40" height="40" alt="@Ret2lib"/></a>

</p>


  <div id="issuecomment-2658471931">

    <div data-body-version="6f129e633b17eee8bc6b4b5187d90b9d20086cd98b052e749b089287bd2bcb87">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">The domains were not always malicious, and might still not be be? They were at one point CNAMEs for ocsp.digicert.com (If digitcert is used, this is to check if its on the revocation list).</p>
<p dir="auto">Theres other github issues about these.</p>
<p dir="auto"><a data-error-text="Failed to load title" data-id="1666706752" data-permission-text="Title is private" data-url="https://github.com/hoshsadiq/adblock-nocoin-list/issues/452" data-hovercard-type="issue" data-hovercard-url="/hoshsadiq/adblock-nocoin-list/issues/452/hovercard" href="https://github.com/hoshsadiq/adblock-nocoin-list/issues/452">hoshsadiq/adblock-nocoin-list#452</a></p>
<p dir="auto">The ips listed are from cloud providers so might have hosted malicious stuff at some point.</p>
<p dir="auto">Hopefully the devs can clear this up, but doesn&#39;t really mean you&#39;re pwned.</p>
      </div>
</task-lists>


        
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edSjT">
  
      
<div data-gid="IC_kwDOAPphoM6edSjT" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edSjT/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/hakusaro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/hakusaro"><img src="https://avatars.githubusercontent.com/u/532647?s=80&amp;u=b5821831ee4f977bfd34f1573025a553a6800eb5&amp;v=4" width="40" height="40" alt="@hakusaro"/></a>

</p>


  <div id="issuecomment-2658478291">

    <div data-body-version="d8de2088b837b2549d90bfdae9093d4e501dda47526defa6fbd31e1a888a3211">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">I didn&#39;t personally see DNS lookups to <code>phicdn.net</code> in my Windows 10 <em>VM</em> -- but I don&#39;t have physical hardware to test with and I only have 10 in a fairly-easy-to-detect VM.</p>
      </div>
</task-lists>


        
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edbii">
  
      
<div data-gid="IC_kwDOAPphoM6edbii" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edbii/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/jrozner/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jrozner"><img src="https://avatars.githubusercontent.com/u/26415?s=80&amp;u=dcaff1d761fc8ee0a0eda52eff587872c9007df6&amp;v=4" width="40" height="40" alt="@jrozner"/></a>

</p>


  <div id="issuecomment-2658515106">

    <div data-body-version="33ea384b912f2cff258e7171f60091c43c4504292fa39aab6222bc60d9a4113f">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">I&#39;m also not seeing anything abnormal in a vm or on bare metal. <a data-hovercard-type="user" data-hovercard-url="/users/realchrisolin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/realchrisolin">@realchrisolin</a> can you share steps for reproduction? The virus total and sandbox results shared here don&#39;t seem particularly concerning. The detection was on a single AV that I&#39;ve never heard of before. Doesn&#39;t mean there isn&#39;t something there but I don&#39;t see anything definitive from virus total or the sandbox analysis links shared here.</p>
      </div>
</task-lists>


        
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edeKA">
  
      
<div data-gid="IC_kwDOAPphoM6edeKA" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edeKA/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/yaleman/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/yaleman"><img src="https://avatars.githubusercontent.com/u/168188?s=80&amp;v=4" width="40" height="40" alt="@yaleman"/></a>

</p>


  

</div>


</div>


      <div data-gid="IC_kwDOAPphoM6edmTv">
  
      
<div data-gid="IC_kwDOAPphoM6edmTv" data-url="/neovim/neovim/comments/IC_kwDOAPphoM6edmTv/partials/timeline_issue_comment">

  <p><a data-hovercard-type="user" data-hovercard-url="/users/hakusaro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/hakusaro"><img src="https://avatars.githubusercontent.com/u/532647?s=80&amp;u=b5821831ee4f977bfd34f1573025a553a6800eb5&amp;v=4" width="40" height="40" alt="@hakusaro"/></a>

</p>


  <div id="issuecomment-2658559215">

    <div data-body-version="0ab2dff5649333f573b62383b79a845d1d5bacd22ad5af11aac0545560f3585c">
      


      <div>

        <task-lists disabled="" sortable="">
<div>
          <p dir="auto">The <code>tee.exe</code> binary in question (<code>950eea4e17fa3a7e89fa2c55374037b5797b3f1a54fea1304634884ab42ec14d</code>) originated in <a data-hovercard-type="commit" data-hovercard-url="https://github.com/neovim/deps/commit/db6981d3d86c9eb78656883b72a7e493b06d31fb/hovercard" href="https://github.com/neovim/deps/commit/db6981d3d86c9eb78656883b72a7e493b06d31fb">neovim/deps@<tt>db6981d</tt></a>, from that commit, it links off to <a href="https://github.com/vim/vim-win32-installer/releases/tag/v9.0.0626">https://github.com/vim/vim-win32-installer/releases/tag/v9.0.0626</a>, which is linked above as a download. I didn&#39;t realize the connection to gvim from this point, spawned from issue <a data-error-text="Failed to load title" data-id="824031225" data-permission-text="Title is private" data-url="https://github.com/neovim/neovim/issues/14078" data-hovercard-type="issue" data-hovercard-url="/neovim/neovim/issues/14078/hovercard" href="https://github.com/neovim/neovim/issues/14078">#14078</a>.</p>
<p dir="auto">I think the above indicators are a red herring. It looks like if anything, these binaries <em>have</em> good sources (gVim) that are documented and can be traced around to find the origin fairly easily. The introduction commit that added them to the codebase simply extracted a zip that contained vendor deps, which were bumped <em>as a result of security-adjacent concerns</em>.</p>
      </div>
</task-lists>


        
      </div>

      <!-- '"` --><!-- </textarea></xmp> -->    </div>
</div>

</div>


</div>






  <!-- Rendered timeline since 2025-02-14 00:17:08 -->
  
</div>


  </div></div>
  </body>
</html>
