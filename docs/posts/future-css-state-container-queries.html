<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ishadeed.com/article/css-state-queries/">Original</a>
    <h1>Future CSS: State Container Queries</h1>
    
    <div id="readability-page-1" class="page"><div>
		
		<p>Wait, what? Yes, you heard that right. The Chromium team is experimenting with a new type of query, which is called <strong>State Query</strong>. Last year, <a href="https://ishadeed.com/article/say-hello-to-css-container-queries/">size container queries</a> got supported in all major browsers. They let us query a container based on its width.</p>

<div><div><pre><code><span>.card-wrapper</span> <span>{</span>
  <span>container-type</span><span>:</span> <span>inline-size</span><span>;</span>
  <span>container-name</span><span>:</span> <span>card</span><span>;</span>
<span>}</span>

<span>@container</span> <span>card</span> <span>(</span><span>min-width</span><span>:</span> <span>400px</span><span>)</span> <span>{</span>
  <span>.card</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
    <span>align-items</span><span>:</span> <span>center</span><span>;</span>
  <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>Adding on that, we now have <a href="https://ishadeed.com/article/css-container-style-queries/">Style queries</a>, which let us query a container and check if a CSS variable persists.</p>

<div><div><pre><code><span>.special-wrapper</span> <span>{</span>
  <span>--theme</span><span>:</span> <span>dark</span><span>;</span>
  <span>container-name</span><span>:</span> <span>stats</span><span>;</span>
<span>}</span>

<span>@container</span> <span>stats</span> <span>style</span><span>(</span><span>--theme</span><span>:</span> <span>dark</span><span>)</span> <span>{</span>
  <span>.stat</span> <span>{</span>
    <span>/* Add the dark styles. */</span>
  <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>This is still in Chrome Canary only for now.</p>

<p>Back to state queries. While watching <a href="https://www.youtube.com/watch?v=TVkwiUFbtyQ">Una’s talk</a> on CSS Day I spotted something that got me excited to check what this is all about.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/state-queries/css-container-queries.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>In my <a href="https://ishadeed.com/article/css-wishlist-2023/">2023 CSS wishlist</a>, one of the things was getting a way to check if an element is stuck, meaning that <code>position: sticky</code> is active. I got so much excitement when I knew that the Chrome team is experimenting with it!</p>

<p>Sneaking over the <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1445189&amp;q=state%20queries&amp;can=2">Chromium bug</a>, it works like this:</p>

<ul>
  <li>Define the container type as <code>sticky</code></li>
  <li>Use the <code>state</code> query</li>
  <li>Check if <code>stuck: direction</code> is active</li>
</ul>

<p>That means, when the header is sticky, we need to update the <code>padding</code>. Or maybe hide or show something. It’s up to you!</p>

<p>Let’s explore how it works.</p>

<h2 id="state-queries-examples">State queries examples</h2>

<h3 id="stuck-state-query">Stuck state query</h3>

<p>A use case for the stuck state is when we have a header that will change its design based on whether it’s stuck or not. By stuck, I mean that the <code>position: sticky</code> took action.</p>

<p>Consider the following example:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/state-queries/css-state-queries-header.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>When the header is <code>sticky</code>, I want to simplify its design. The reason is that it’s not always a good practice to keep elements taking a part from the screen real-estate.</p>

<p>I used to detect that with Javascript, but now we might get that in CSS soon.</p>

<div><div><pre><code><span>.page</span> <span>{</span>
  <span>container-name</span><span>:</span> <span>sticky-header</span><span>;</span>
  <span>container-type</span><span>:</span> <span>sticky</span><span>;</span>
<span>}</span>

<span>.site-header</span> <span>{</span>
  <span>position</span><span>:</span> <span>sticky</span><span>;</span>
  <span>top</span><span>:</span> <span>0</span><span>;</span>
<span>}</span>

<span>@container</span> <span>state</span><span>(</span><span>stuck</span><span>:</span> <span>top</span><span>)</span> <span>{</span>
  <span>.site-header__bottom</span> <span>{</span>
    <span>display</span><span>:</span> <span>none</span><span>;</span>
  <span>}</span>

  <span>.site-header__actions</span> <span>{</span>
    <span>display</span><span>:</span> <span>none</span><span>;</span>
  <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>I feel that the current syntax will change, as I’m not sure about using <code>sticky</code> for <code>container-type</code> and <code>stuck</code> for the query.</p>

<h3 id="wrap-state-query">Wrap state query</h3>

<p>State queries aren’t only about sticky positioning. Earlier this year, I published a blog post asking <a href="https://ishadeed.com/article/flex-wrap-detect/">Do we need CSS flex-wrap detection?</a></p>

<p>Consider the following figure:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/state-queries/flex-wrap-detect-site-header-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>We have a site header that is built with flexbox. When the items wrap, I want to hide the navigation and replace it with a toggle menu button.</p>

<div><div><pre><code><span>.site-header</span> <span>{</span>
  <span>container-type</span><span>:</span> <span>wrap</span><span>;</span>
  <span>container-name</span><span>:</span> <span>header</span><span>;</span>
  <span>display</span><span>:</span> <span>flex</span><span>;</span>
  <span>flex-wrap</span><span>:</span> <span>wrap</span><span>;</span>
  <span>align-items</span><span>:</span> <span>center</span><span>;</span>
<span>}</span>

<span>@container</span> <span>header</span> <span>state</span><span>(</span><span>wrap</span><span>:</span> <span>true</span><span>)</span> <span>{</span>
  <span>.site-header__nav</span> <span>{</span>
    <span>display</span><span>:</span> <span>none</span><span>;</span>
  <span>}</span>

  <span>.nav-toggle</span> <span>{</span>
    <span>display</span><span>:</span> <span>block</span><span>;</span>
  <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>Being able to detect when a flex container is wrapped will be very helpful. Note: this is still an idea and hasn’t been implemented in any browser yet.</p>

<h3 id="empty-state">Empty state</h3>

<p>Currently, we can use the <code>:empty</code> pseudo-class to check if an element is empty.</p>

<div><div><pre><code><span>.figcaption</span><span>:empty</span> <span>{</span>
  <span>display</span><span>:</span> <span>none</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>That works fine, but if there is a space character within the <code>&lt;figcaption&gt;</code> element, it will fail. Can we do better with state queries?</p>

<p>Consider the following HTML. Notice that I <strong>intentionally added an empty space.</strong></p>

<div><div><pre><code><span>&lt;section</span> <span>class=</span><span>&#34;section&#34;</span><span>&gt;&lt;/section&gt;</span>
</code></pre></div></div>

<p>I don’t know how exactly this should work since we can’t apply CSS to the container itself, but here is a pseudo code.</p>

<div><div><pre><code><span>section</span> <span>{</span>
  <span>container-type</span><span>:</span> <span>empty</span><span>;</span>
<span>}</span>

<span>@container</span> <span>state</span><span>(</span><span>empty</span><span>:</span> <span>true</span><span>)</span> <span>{</span>
  <span>display</span><span>:</span> <span>none</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Empty here means when the container <strong>doesn’t have any child elements</strong>.</p>

<h3 id="detecting-the-document-direction">Detecting the document direction</h3>

<p>I’m not sure if this can be considered a state, but a lot of times I need to know if the container direction is <code>ltr</code> or <code>rtl</code>. For example, I might want to flip an icon.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/state-queries/css-state-queries-direction.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>With a state query for the document direction, this might help a lot.</p>

<div><div><pre><code><span>/* Instead of.. */</span>
<span>html</span><span>[</span><span>dir</span><span>=</span><span>&#34;rtl&#34;</span><span>]</span> <span>.button-icon</span> <span>{</span>
  <span>transform</span><span>:</span> <span>scaleX</span><span>(</span><span>-1</span><span>);</span>
<span>}</span>

<span>/* We do this */</span>
<span>@container</span> <span>state</span><span>(</span><span>dir</span><span>:</span> <span>rtl</span><span>)</span> <span>{</span>
  <span>.button-icon</span> <span>{</span>
    <span>transform</span><span>:</span> <span>scaleX</span><span>(</span><span>-1</span><span>);</span>
  <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>That’s it for this quick post. What do you think? Do you have any ideas on other state queries? I would love to hear from you on Twitter @shadeed9.</p>

<p>Thank you for reading.</p>

	</div></div>
  </body>
</html>
