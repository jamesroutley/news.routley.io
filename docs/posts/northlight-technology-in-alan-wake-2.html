<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.remedygames.com/article/how-northlight-makes-alan-wake-2-shine">Original</a>
    <h1>Northlight technology in Alan Wake 2</h1>
    
    <div id="readability-page-1" class="page"><div><p>The Northlight team is super-excited to have Alan Wake 2 out there. We&#39;ve created and polished off a lot of new tech so that Alan Wake 2 looks great and plays great. Here are the key highlights of the new features and tools that we&#39;d like to give a moment in the spotlight. We&#39;re keeping the description to a fairly high level here; our engineers will be back with more in-depth topics in due course.</p><h3>Core engine: New data-oriented game object model</h3><p>Northlight switched to a completely new data-oriented game object framework during the development of Alan Wake 2. The new entity component system (ECS) based model enables memory-efficient storage and makes parallel execution efficient and safe. This means that the engine can support a varying number of target hardware cores efficiently, enabling bigger, more dynamic and fuller worlds. ECS also played a supporting role for our tools development, simplifying the building of the new Scattering tool for mass-authoring vegetation - ECS allowed us to simply have a lot more entities without the need to invent any custom solution for scattering objects in the world.</p><p>The ECS framework also made it to our gameplay programmers&#39; &#34;favorite tech&#34; list as it helped implement the Case Board - Saga&#39;s visual storyboard for gathering evidence. ECS meant that iteration was quick because adding new or modifying existing systems or game objects was easy, and performance gains were clear when saving and loading the Case Board.</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544bf00d880ecdd52ccc46e_image-2023-11-3_11-17-22.png" loading="lazy" alt="Picture of Case Board"/></p></figure><h3>Voxel-Based Character Controller</h3><p>Alan Wake 2 called forth reimagining character control in Northlight. We built a new Voxel-Based Character Control that enables smooth navigation in cramped, complex and dynamic environments; it makes character movement more natural and fluid. Our marketing folks would say the characters are more responsive and lifelike than ever before; our internal dev notes described it as &#34;the characters won&#39;t bump or get stuck into objects in tight spaces&#34;.</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-video"><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://player.vimeo.com/video/880838821" title="VCC_path_demo"></iframe></p></figure><p><figcaption>Character path visualization showing predicted path (white) as the character tries to reach the movement target (yellow).</figcaption></p><h3>Reworked<em> </em>NPC locomotion</h3><p>Our animation tech made some major changes into how Non-Player Characters (NPC) move. The revamped NPC locomotion means that in Alan Wake 2 all NPCs utilize animation-driven movement combined with new distance-based Motion Matching. This new tech improves movement quality and gives us more control over how and when animations are used.</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-video"><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://player.vimeo.com/video/882017461" title="Alan Wake 2 NPC Locomotion"></iframe></p></figure><h3>Realistic wind</h3><p>More realistic wind was on the must-have tech list for Alan Wake 2 - and that&#39;s we have, wind that realistically affects physics, particles, and cloth.</p><p>For example, game designers can now easily define indoor and outdoor areas that have different wind speeds, with smooth, stateless transitions between the two types of areas. The indoor vs. outdoor area definitions are used, for example, to ensure that there&#39;s no wind inside the car that Saga and Casey are driving. This is done through defining a moving &#34;wind box&#34; that specifies that the inside of the car is a wind-free indoor area.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544bea014d3dfaf2f5c6858_moving_windbox.png" loading="lazy" alt="Northlight Wind Debugger showing wind box that defines indoor vs. outdoor area. Block edge shows the transition."/></p><figcaption>Northlight Wind Debugger showing wind box that defines indoor vs. outdoor area. Block edge shows the transition.</figcaption></figure><p>The wind system tech is built on Signed Distance Fields (SDF) methods where wind boxes are used as primitives that define a smooth, global wind strength field. The wind boxes act like basic building blocks that define how strong the wind is in different areas, creating realistic and smoothly varying wind patterns between indoor and outdoor areas.</p><h3>Scattering tool</h3><p>We developed a new Scattering tool to allow for mass-authoring vegetation and propping environments on a grand scale. In Alan Wake 2 it was used to create denser, richer and more life-like environments with the longer-than-before draw distances (i.e. what defines how far the player can see objects and details in the game world).</p><h3>Luau</h3><p>We switched our scripting language from a proprietary language into Luau, embeddable scripting language derived from Lua by our friends at Roblox. It exposes a comprehensive set of engine functionality and supports live-editing. Luau is used for level scripting and also for various gameplay systems such as the weapon upgrade system. Luau allowed the game team to prototype and implement various game features and VFX effects without needing help from engine programmers.</p><p>We&#39;ve also cooked up our own VS Code language server extension, so that it all integrates seamlessly into Remedy’s development pipelines. And adopting Luau helped us boot out some 80 000 lines of code we no longer need to maintain.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544c372589da1e2a2285809_luau_weather_system.png" loading="lazy" alt="VFX team used Luau to implement a weather system - The different weather conditions can be quickly tested through a debug panel,"/></p><figcaption>VFX team used Luau to implement a weather system - The different weather conditions can be quickly tested through a debug panel.</figcaption></figure><h2></h2><h3>New GPU-driven rendering pipeline</h3><p>Alan Wake 2 showcases Northlight&#39;s brand-new GPU-driven rendering pipeline. It allows us to push more geometry into the world without sacrificing performance. With GPU-driven rendering using mesh shaders, we can now do occlusion culling down to a single-pixel precision and use everything in a scene as an occluder. This ability to only draw what is visible means that the world of AW2 has more geometric detail than we’ve ever shipped before.</p><p>Diving a bit deeper into how it works: we also cull meshlets, in addition to the mesh. Meshlets are smaller, more optimized, groups of triangles extracted from the mesh. In the images below you can see what meshlets look like around Cauldron Lake&#39;s convenience store location.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544d4dc52652337e5f1e521_meshlet_visualization1.jpg" loading="lazy" alt=""/></p><figcaption>What the player sees...</figcaption></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544d5a842800d0cc9817d14_meshlet_visualization2.jpg" loading="lazy" alt=""/></p><figcaption>...vs. what&#39;s fed into the renderer (silly amount of geometric detail!). Colors represent clusters.</figcaption></figure><h3>Character-style rigs on foliage - Large scale procedural GPU animation</h3><p>The expansive primordial forest environments of Alan Wake 2 are brought to life through our new shader-based vegetation system. It&#39;s based on a new skinning system that runs entirely on GPU and supports &#34;art-driven&#34; bone shader animations. In Alan Wake 2 it enabled us to use full character-style rigs on all the foliage visible in the environments.</p><p>We&#39;re calling the new system art-driven here because the bone shaders expose an API with which artists can write their own shader code that hooks into the underlying system. So technically artists could use it to animate anything they&#39;d like: foliage, objects bobbing up and down on water, power cables wobbling in the wind, etc. </p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-video"><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://player.vimeo.com/video/880842428" title="GPU_animation"></iframe></p></figure><p><figcaption>GPU bone visualization - The skeleton rigs animating all vegetation. Each line is one bone, with almost 300,000 bones in Cauldron Lake being processed every frame.</figcaption></p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544da11f604c7d5e835ae8e_GPU_animation_pic2NoDraw.JPG" loading="lazy" alt=""/></p><figcaption>GPU bone visualization OFF</figcaption></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544da29c20118c775ce9996_GPU_animation_pic2WDraw.JPG" loading="lazy" alt=""/></p><figcaption>GPU bone visualization ON</figcaption></figure><h3>HDR support</h3><p>Alan Wake 2 fully supports HDR. We&#39;ve made sure that the game looks great out-of-the-box with default settings, regardless of whether your display supports SDR or HDR. </p><p>On the tech side, adding HDR support could almost be said to have been a simple &#39;let&#39;s change the output format&#39; operation; the more significant effort was done on the creative side. Alan Wake 2 is authored in HDR, meaning that the color grading was done by actual human colorists to ensure that the unique art styles and aesthetics, the storytelling and mood of Alan Wake 2 is amplified in both HDR and SDR.</p><h3>Transparency and atmospheric effects</h3><p>The pervasive fog scenes in Alan Wake 2 are built upon improvements into how we render transparency. We&#39;re using MBOIT (Moment-Based Order-Independent Transparency) to make see-through surfaces blend together smoothly, even when they have different levels of detail.</p><p>During Alan Wake 2&#39;s development, Northlight did a complete overhaul of transparent rendering. We now draw transparency in three resolutions with MBOIT, which makes it possible to blend fog, transparent geometry and effects seamlessly. In addition to better blending of fog and other transparent elements, we’ve improved pipelines to allow more fine-grained control over fog placement in the world. Combining all this to per-pixel transparent lighting and fog-affected reflections makes opaque and transparent elements fit together better than in our previous projects.</p><p>Our fog also approximates multiple light scattering, giving it a thick and realistic look that improves atmosphere.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544db9b6fe3aaa039dcc7b8_transparency_boat.jpg" loading="lazy" alt=""/></p><figcaption>Note how the water refracts correctly and supports non-uniform blur for realistic looking water.</figcaption></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544dba3c20118c775cfbc07_atmospheric_sunset.jpg" loading="lazy" alt=""/></p></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544dba991ac1ce7f3e43dda_multiple_light_scattering.jpg" loading="lazy" alt=""/></p></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/6544dbb6c31507ffce973345_coffee_world_MBOIT.jpg" loading="lazy" alt=""/></p><figcaption>Transparent Rendering - A perfect blend of different transparent effects: fog, particles and water all use MBOIT. </figcaption></figure><h3>VFX</h3><p>Effects are an essential part of Alan Wake 2’s visuals and expand on what we achieved in Control. The node-based VFX tools in Northlight have evolved significantly in terms of supported features and runtime performance. Visual effects artists are now able to author complex and dynamic effects like rain, wetness, water simulation, and character wounds. VFX tools also benefit from GPU-driven rendering and can push a lot of geometry through the GPU. This is required, for example, when rendering rain blocker objects to a dynamic mask that prevents rain from appearing indoors or under cover.</p><figure><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/654b588acdfefc332c7826bd_vfx_off.jpg" loading="lazy" alt=""/></p><figcaption>Screenshot of Dark Place with visual effects OFF.</figcaption></figure><figure><p><img src="https://assets-global.website-files.com/64630b03551142e3347ae3da/654b58e00c008e3bfe394ede_vfx_on.jpg" loading="lazy" alt=""/></p><figcaption>Screenshot of Dark Place with visual effects ON. &#39;Fade Out&#39; enemies and weather effects are key parts of the visual identity</figcaption></figure><p>‍</p><h3>Ray tracing</h3><p>We have added support for fully ray-traced direct lighting and combined this with improved denoising and indirect lighting algorithms with Nvidia. Ray tracing in Alan Wake 2 is more accurate and robust than what has been seen in Control. Ray tracing also makes the animated foliage look amazing, now that all the geometry animation (foliage) is authored and simulated using skinning.</p><p>With Alan Wake 2, PC players can experience (GPU and CPU setup permitting) the latest Nvidia DLSS innovations - DLSS Frame Generation, DLSS Ray Reconstruction, Path Traced Indirect Lighting - all the things that enable us to say &#39;never before&#39; once more.</p><p>‍</p></div></div>
  </body>
</html>
