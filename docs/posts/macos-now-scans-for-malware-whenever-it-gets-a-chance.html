<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://eclecticlight.co/2022/08/30/macos-now-scans-for-malware-whenever-it-gets-a-chance/">Original</a>
    <h1>macOS now scans for malware whenever it gets a chance</h1>
    
    <div id="readability-page-1" class="page"><div id="primary">
		<main id="main" role="main">

			
<article id="post-67442">
	
	<header>

		
		
	</header><!-- .entry-header -->

	
		<div data-first_letter="I">
		<p>In the last six months macOS malware protection has changed more than it did over the previous seven years. It has now gone fully pre-emptive, as active as many commercial anti-malware products, provided that your Mac is running Catalina or later. This article updates those I’ve previously written about Apple’s new tool in the war against malware, XProtect Remediator.</p>
<p>Until XProtect Remediator arrived in macOS 12.3 last March, system tools for tackling malware were essentially limited to XProtect and MRT. XProtect was mainly used to check apps and other code which had a quarantine flag set, against a list of signatures of known malware, and can only detect. While Apple has broadened its scope to check more frequently, and continues to update those signatures every couple of weeks, they have their limits. MRT ran scans to both detect and remove (‘remediate’) known malware, most noticeably shortly after startup, but infrequently.</p>
<p>XProtect Remediator consists of executable code modules which both scan for and remediate detected malware. At present, these include the following:</p>
<ul>
<li>Adload, an endemic Trojan known for downloading unwanted adware and PUPs, <a href="https://blog.malwarebytes.com/detections/trojan-adload/" target="_blank" rel="noopener">summarised here</a>;</li>
<li>DubRobber, a troubling and versatile <a href="https://blog.malwarebytes.com/detections/osx-dubrobber/" target="_blank" rel="noopener">Trojan dropper</a> also known as XCSSET;</li>
<li>Eicar, a harmless <a href="https://en.wikipedia.org/wiki/EICAR_test_file" target="_blank" rel="noopener">standard test</a> for anti-malware products;</li>
<li>Genieo, a browser hijacker acting as adware, <a href="https://blog.malwarebytes.com/detections/osx-genieo/" target="_blank" rel="noopener">summarised here</a>;</li>
<li>GreenAcre, an Apple internal name;</li>
<li>MRTv3, referring to Apple’s original malware remediator;</li>
<li>Pirrit, malicious adware explained <a href="https://objective-see.org/blog/blog_0x0E.html" target="_blank" rel="noopener">in detail here</a>;</li>
<li>SheepSwap, an Apple internal name;</li>
<li>SnowBeagle, an Apple internal name;</li>
<li>SnowDrift, identified by Stuart Ashenbrenner of Jamf as CloudMensis, spyware first <a href="https://www.welivesecurity.com/2022/07/19/i-see-what-you-did-there-look-cloudmensis-macos-spyware/" target="_blank" rel="noopener">identified by ESET</a>;</li>
<li>ToyDrop, an Apple internal name;</li>
<li>Trovi, a cross-platform <a href="https://macsecurity.net/view/57-how-to-remove-trovi-adware-from-mac" target="_blank" rel="noopener">browser hijacker</a>.</li>
<li>WaterNet, an Apple internal name.</li>
</ul>
<p>These are orchestrated by XProtectPluginService, an XPC service which is scheduled and dispatched using the DAS-CTS system that does the same for most periodic background tasks. What’s unusual with XProtect Remediator is that the task dispatched goes on to choose and run different scanning modules. Thus the only practical way to discover which run and when is from the log. Fortunately, that’s straightforward using the log search predicate</p>
<p>The DubRobber (XCSSET) scanner is by far the most frequently run, performing scans lasting 15-35 seconds every hour or two during periods of low user activity. Other scans observed include the modules for:</p>
<ul>
<li>Adload for a period of 8 seconds, once or so each day;</li>
<li>Eicar for less than 0.01 second, twice;</li>
<li>Geneio for 0.5 second, once;</li>
<li>GreenAcre for 1.2 seconds, once;</li>
<li>MRTv3 for 17 seconds, once;</li>
<li>Pirrit for 0.5 seconds, once;</li>
<li>SheepSwap for 5 seconds, once;</li>
<li>SnowBeagle for 10 seconds, once;</li>
<li>SnowDrift (CloudMensis) for 9 seconds, once;</li>
<li>ToyDrop for 0.02 second, once;</li>
<li>Trovi in a group of three brief scans of less than 0.1 second each;</li>
<li>WaterNet in one sustained bout, without any reported conclusion.</li>
</ul>
<p>They make the complete set.</p>
<p>These frequent DubRobber scans present a structured series of log entries, starting with a check for a verifiable XPC connection protocol. After that, a Yara rule is loaded and telemetry enabled, as it remains throughout the rest of the scan. There’s a series of static code signature checks, then a series of path checks. File and further Yara checks follow that, and at the end is an event before the scan report, which takes the form</p>
<p>These scans should now be taking place on all Macs running macOS Catalina and later, with the current XProtect Remediator installed. They’re most likely to take place when your Mac is awake but doing little other than background tasks, such as routine backups, and receiving incoming email as it arrives.</p>
<p>For those running these recent versions of macOS this represents a big step forward. It also dispels any doubt as to whether this new malware protection has gone live yet: it’s both alive and scanning actively already.</p>
<p><strong>Update</strong></p>
<p>I have amended the list of scans observed to reflect my further experience.</p>
<p><em>Updated 2020 GMT 30 August 2022.</em></p>
	</div><!-- .entry-content -->

	
	<!-- .entry-footer -->

</article><!-- #post-## -->
		</main><!-- #main -->
	</div></div>
  </body>
</html>
