<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://insider.microsoft365.com/en-us/blog/new-regular-expression-regex-functions-in-excel">Original</a>
    <h1>Regular expression functions in Excel</h1>
    
    <div id="readability-page-1" class="page"><div _ngcontent-sc9=""><div _ngcontent-sc9="" id="content"><p>Hey, Microsoft 365 Insiders! My name is Jake Armstrong, and I’m a Product Manager on the Excel team. I’m excited to announce the availability of three new functions that use Regular Expressions to help parse text more easily: REGEXTEST, REGEXEXTRACT, and REGEXREPLACE.</p>
<p><strong>NOTE:</strong> These are preview functions. Their signature and results may change substantially before being broadly released, based on your feedback. So, we do not recommend using these functions in important workbooks until they are generally available.</p>
<h3>New Regular expression (Regex) functions in Excel</h3>
<p>Regular expressions, or ‘regex’, are sequences of characters that define search patterns, commonly used for string searching and text parsing. They are incredibly versatile and are often used to check if a string contains a certain pattern, extract substrings that match the pattern, or replace substrings that match the pattern.</p>
<p>The new regex functions we are introducing are:</p>
<ul>
	<li><strong>REGEXTEST</strong>: Checks if any part of supplied text matches a regex pattern.</li>
	<li><strong>REGEXEXTRACT</strong>: Extracts one or more parts of supplied text that match a regex pattern.</li>
	<li><strong>REGEXREPLACE</strong>: Searches for a regex pattern within supplied text and replaces it with different text.</li>
</ul>
<p>Let’s dive in and take a look at each function in more detail.</p>
<h3>REGEXTEST</h3>
<p>REGEXTEST checks whether the <em>pattern</em> matches any part of the provided <em>text</em>, always returning TRUE or FALSE.</p>
<p><img loading="lazy" src="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_1.png" alt="Worksheet showing a REGEXTEST function" width="490" height="168" srcset="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_1.png 420w, https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_1-300x103.png 300w" sizes="(max-width: 490px) 100vw, 490px"/></p>
<p><em>Checking whether the strings in column C contain numerical digits, using the regex pattern “[0-9]”</em></p>
<p>The full signature is: REGEXTEST(text, pattern, [case_sensitivity])</p>
<p><a href="https://support.microsoft.com/topic/7d38200b-5e5c-4196-b4e6-9bff73afbd31">Learn more</a></p>
<h3>REGEXEXTRACT</h3>
<p>REGEXEXTRACT returns substrings of <em>text</em> that match the <em>pattern</em> provided. Depending on the <em>return mode</em>, it can return the first match, all matches, or each capture group from the first match.</p>
<p><img loading="lazy" src="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_2.png" alt="Worksheet showing a REGEXTRACT function" width="491" height="224" srcset="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_2.png 515w, https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_2-300x137.png 300w" sizes="(max-width: 491px) 100vw, 491px"/></p>
<p><em>Extracting names from text using the pattern “[A-z]+ [A-z]+”, which matches two groups of alphabet characters separated by a space</em></p>
<p>The full signature is: REGEXEXTRACT(text, pattern, [return_mode], [case_sensitivity])</p>
<p><a href="https://support.microsoft.com/topic/4b96c140-9205-4b6e-9fbe-6aa9e783ff57">Learn more</a></p>
<h3>REGEXREPLACE</h3>
<p>REGEXREPLACE looks for substrings of <em>text</em> that match the <em>pattern </em>provided, and then replaces them with a <em>replacement </em>string.</p>
<p><em><img loading="lazy" src="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_3.png" alt="Worksheet showing a REGEXREPLACE function" width="489" height="125" srcset="https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_3.png 532w, https://office-insider-media.azurefd.net/media/2024/04/Reg-Function_3-300x77.png 300w" sizes="(max-width: 489px) 100vw, 489px"/></em></p>
<p><em>Replacing the first three digits of each phone number with ***, using the pattern “[0-9]{3}-”, which matches against three numerical digits followed by “-”</em></p>
<p>The full signature is: REGEXREPLACE(text, pattern, replacement, [occurrence], [case_sensitivity])</p>
<p><a href="https://support.microsoft.com/topic/9c030bb2-5e47-4efc-bad5-4582d7100897">Learn more</a></p>
<h3>Regex coming soon to XLOOKUP and XMATCH</h3>
<p>We will also be introducing a way to use regex within XLOOKUP and XMATCH, via a new option for their ‘match mode’ arguments. The regex pattern will be supplied as the ‘lookup value’.</p>
<p>This will be available for you to try in Beta soon, at which point we’ll update this blog post with more details.</p>
<h3>Tips and tricks</h3>
<ul>
	<li>When writing regex patterns, you can use symbols called ‘tokens’ that match with a variety of characters. Here are some useful tokens to get you started:

<ul>
	<li>“[0-9]”: any numerical digit</li>
	<li>“[a-z]”: a character in the range of a to z</li>
	<li>“.”: any character</li>
	<li>“a”: the “a” character</li>
	<li>“a*”: zero or more “a”</li>
	<li><span><span lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span>“a+”: one or more “a”</span></span></span><span data-ccp-props="{}"> </span></li>
</ul>
</li>
</ul>
<ul>
	<li>Try asking <a href="https://copilot.microsoft.com/">Bing Copilot</a> for regex patterns!</li>
</ul>
<h3>Availability   </h3>
<p>These functions are currently available to Beta Channel users running:</p>
<ul>
	<li>Windows: Version 2406 (Build 17715.20000) or later</li>
	<li>Mac: Version <span data-contrast="auto">16.86 (Build 24051422) or later</span><span data-ccp-props="{&#34;201341983&#34;:0,&#34;335559739&#34;:160,&#34;335559740&#34;:278}">   </span></li>
</ul>
<h4>Don’t have it yet? It’s probably us, not you. </h4>
<p>Features are released over some time to ensure things are working smoothly. We highlight features that you may not have because they’re slowly releasing to larger numbers of Insiders. Sometimes we remove elements to further improve them based on your feedback. Though this is rare, we also reserve the option to pull a feature entirely out of the product, even if you, as an Insider, have had the opportunity to try it. </p>
<h3>Feedback  </h3>
<p>We want to hear from you! Please click <strong>Help &gt; Feedback</strong> to submit your thoughts about these new functions. </p></div></div></div>
  </body>
</html>
