<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ggerganov/kbd-audio">Original</a>
    <h1>Acoustic Keyboard Eavesdropping</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://github.com/ggerganov/kbd-audio/actions"><img src="https://github.com/ggerganov/kbd-audio/workflows/CI/badge.svg" alt="Actions Status"/></a></p>
<p dir="auto">This is a collection of command-line and GUI tools for capturing and analyzing audio data.</p>
<h3 dir="auto"><a id="user-content-keytap" aria-hidden="true" href="#keytap"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Keytap</h3>
<p dir="auto">The most interesting tool is called <strong>keytap</strong> - it can guess pressed keyboard keys only by analyzing the audio captured from the computer&#39;s microphone.</p>
<p dir="auto">Check this blog post for more details:</p>
<p dir="auto"><a href="https://ggerganov.github.io/jekyll/update/2018/11/30/keytap-description-and-thoughts.html" rel="nofollow">Keytap: description and some random thoughts</a></p>
<p dir="auto"><a href="https://www.youtube.com/watch?v=2OjzI9m7W10" rel="nofollow">Video: short demo of Keytap in action</a></p>
<p dir="auto"><a href="https://ggerganov.github.io/keytap" rel="nofollow">Try it online:</a></p>
<p dir="auto"><a href="https://ggerganov.github.io/keytap" rel="nofollow"><img src="https://camo.githubusercontent.com/09496b376b4e1aed862406b0fdb2b829211b170f0285113a0282c68ffb344269/68747470733a2f2f692e696d6775722e636f6d2f465861363050722e676966" data-canonical-src="https://i.imgur.com/FXa60Pr.gif"/></a></p>
<h3 dir="auto"><a id="user-content-keytap2" aria-hidden="true" href="#keytap2"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Keytap2</h3>
<p dir="auto">The <strong>keytap2</strong> tool is another interesting tool for recovering text from audio. It does not require training data - instead it uses statistical information about the frequencies of the letters and n-grams in the English language.</p>
<p dir="auto">A more detailed description of the tool is available here: <a href="https://github.com/ggerganov/kbd-audio/discussions/31" data-hovercard-type="discussion" data-hovercard-url="/ggerganov/kbd-audio/discussions/31/hovercard">Keytap2 discussion</a></p>
<p dir="auto"><a href="https://www.youtube.com/watch?v=jNtw17S6SR0" rel="nofollow">Video: short demo of Keytap2 in action</a></p>
<p dir="auto"><a href="https://ggerganov.github.io/keytap-challenge/" rel="nofollow">CTF: can you guess the text being typed?</a></p>
<p dir="auto"><a href="https://keytap2.ggerganov.com" rel="nofollow">Try it online:</a></p>
<p dir="auto"><a href="https://keytap2.ggerganov.com" rel="nofollow"><img src="https://camo.githubusercontent.com/f06393226fb6af54ef544fce8f8bd51f396b3b321763ec459db4e2b3c12144fc/68747470733a2f2f692e696d6775722e636f6d2f6e506c4c45444e2e6a7067" data-canonical-src="https://i.imgur.com/nPlLEDN.jpg"/></a></p>
<h3 dir="auto"><a id="user-content-keytap3" aria-hidden="true" href="#keytap3"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Keytap3</h3>
<p dir="auto">This version introduces significant algorithm improvements and better n-gram statistics compared to keytap2. The attack is now fully
automated and does not require any manual intervation during the text recovery process.</p>
<p dir="auto"><a href="https://youtu.be/5aphvxpSt3o" rel="nofollow">Video: short demo of using Keytap3</a></p>
<p dir="auto"><a href="https://youtu.be/kCOrxrR-4ak" rel="nofollow">Video: another example of using Keytap3</a></p>
<p dir="auto"><a href="https://keytap3-gui.ggerganov.com" rel="nofollow">GUI for Keytap3</a></p>
<p dir="auto"><a href="https://keytap3.ggerganov.com" rel="nofollow">Check if your keyboard is vulnerable to Keytap:</a></p>
<p dir="auto"><a href="https://keytap3.ggerganov.com" rel="nofollow"><img src="https://user-images.githubusercontent.com/1991296/166096331-ab26f7f8-08e0-48d6-abd7-57017ebf1866.JPEG"/></a></p>
<h3 dir="auto"><a id="user-content-what-people-say-about-keytap" aria-hidden="true" href="#what-people-say-about-keytap"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What people say about Keytap</h3>
<p dir="auto"><em>&#34;This works incredibly well.</em> -- ffpip</p>
<p dir="auto"><em>&#34;I just tried it and it works incredibly well. It kind of makes me want to stop using a mechanical keyboard.&#34;</em> -- Karawebnetwork</p>
<p dir="auto"><em>&#34;This attack and Van Eck phreaking are why Edward Snowden, while typing passwords and other sensitive information, would pull a blanket over himself and his laptop.&#34;</em> -- aarchi</p>
<p dir="auto"><em>&#34;This is what mechanical keyboard users deserve&#34;</em> -- super guy</p>
<p dir="auto"><em>&#34;fuck..&#34;</em> -- Lluis Franco</p>
<h2 dir="auto"><a id="user-content-build-instructions" aria-hidden="true" href="#build-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Build instructions</h2>
<p dir="auto">Dependencies:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>SDL2</strong> - used to capture audio and to open GUI windows <a href="https://www.libsdl.org" rel="nofollow">libsdl</a></p>
<div data-snippet-clipboard-copy-content="[Ubuntu]
$ sudo apt install libsdl2-dev

[Mac OS with brew]
$ brew install sdl2

[MSYS2]
$ pacman -S git cmake make mingw-w64-x86_64-dlfcn mingw-w64-x86_64-gcc mingw-w64-x86_64-SDL2"><pre><code>[Ubuntu]
$ sudo apt install libsdl2-dev

[Mac OS with brew]
$ brew install sdl2

[MSYS2]
$ pacman -S git cmake make mingw-w64-x86_64-dlfcn mingw-w64-x86_64-gcc mingw-w64-x86_64-SDL2
</code></pre></div>
</li>
<li>
<p dir="auto"><strong>FFTW3</strong> <em>(optional)</em> - some of the helper tools perform Fourier transformations <a href="http://www.fftw.org" rel="nofollow">fftw</a></p>
</li>
</ul>
<p dir="auto"><strong>Linux, FreeBSD, Mac OS, Windows (MSYS2 + MinGW)</strong></p>
<div data-snippet-clipboard-copy-content="git clone https://github.com/ggerganov/kbd-audio
cd kbd-audio
git submodule update --init
mkdir build &amp;&amp; cd build
cmake ..
make"><pre><code>git clone https://github.com/ggerganov/kbd-audio
cd kbd-audio
git submodule update --init
mkdir build &amp;&amp; cd build
cmake ..
make
</code></pre></div>
<h2 dir="auto"><a id="user-content-tools" aria-hidden="true" href="#tools"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tools</h2>
<p dir="auto">Short summary of the available tools. If the status of the tool is not <strong>stable</strong>, expect problems and non-optimal results.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>record</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>record-full</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>play</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>play-full</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>view-gui</strong></td>
<td>gui</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>view-full-gui</strong></td>
<td>gui</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>key-detector</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>keytap</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>keytap-gui</strong></td>
<td>gui</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>keytap2-gui</strong></td>
<td>gui</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>keytap3</strong></td>
<td>text</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td><strong>keytap3-gui</strong></td>
<td>gui</td>
<td><strong>stable</strong></td>
</tr>
<tr>
<td>-</td>
<td><em>extra</em></td>
<td>-</td>
</tr>
<tr>
<td><strong>guess-qp</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>guess-qp2</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>keytap3-multi</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>scale</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>subreak</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>key-average-gui</strong></td>
<td>gui</td>
<td>experiment</td>
</tr>
<tr>
<td><strong>keytap2</strong></td>
<td>text</td>
<td>experiment</td>
</tr>
</tbody>
</table>
<h2 dir="auto"><a id="user-content-tool-details" aria-hidden="true" href="#tool-details"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tool details</h2>
<ul dir="auto">
<li>
<p dir="auto"><strong>record-full</strong></p>
<p dir="auto">Record audio to a raw binary file on disk</p>
<div data-snippet-clipboard-copy-content="./record-full output.kbd [-cN]"><pre><code>./record-full output.kbd [-cN]
</code></pre></div>
<hr/>
</li>
<li>
<p dir="auto"><strong>play-full</strong></p>
<p dir="auto">Playback a recording captured via the <strong>record-full</strong> tool</p>
<div data-snippet-clipboard-copy-content="./play-full input.kbd [-pN]"><pre><code>./play-full input.kbd [-pN]
</code></pre></div>
<hr/>
</li>
<li>
<p dir="auto"><strong>record</strong></p>
<p dir="auto">Record audio only while typing. Useful for collecting training data for <strong>keytap</strong></p>
<div data-snippet-clipboard-copy-content="./record output.kbd [-cN] [-CN]"><pre><code>./record output.kbd [-cN] [-CN]
</code></pre></div>
<hr/>
</li>
<li>
<p dir="auto"><strong>play</strong></p>
<p dir="auto">Playback a recording created via the <strong>record</strong> tool</p>

<hr/>
</li>
<li>
<p dir="auto"><strong>keytap</strong></p>
<p dir="auto">Detect pressed keys via microphone audio capture in real-time. Uses training data captured via the <strong>record</strong> tool.</p>
<div data-snippet-clipboard-copy-content="./keytap input0.kbd [input1.kbd] [input2.kbd] ... [-cN] [-CN] [-pF] [-tF]"><pre><code>./keytap input0.kbd [input1.kbd] [input2.kbd] ... [-cN] [-CN] [-pF] [-tF]
</code></pre></div>
<hr/>
</li>
<li>
<p dir="auto"><strong>keytap-gui</strong></p>
<p dir="auto">Detect pressed keys via microphone audio capture in real-time. Uses training data captured via the <strong>record</strong> tool. GUI version.</p>
<div data-snippet-clipboard-copy-content="./keytap-gui input0.kbd [input1.kbd] [input2.kbd] ... [-cN] [-CN]"><pre><code>./keytap-gui input0.kbd [input1.kbd] [input2.kbd] ... [-cN] [-CN]
</code></pre></div>
<p dir="auto">Online demo: <a href="https://keytap.ggerganov.com" rel="nofollow">https://keytap.ggerganov.com</a></p>
<hr/>
</li>
<li>
<p dir="auto"><strong>keytap2-gui</strong> record.kbd n-gram-dir [-pN] [-cN] [-CN]</p>
<p dir="auto">Detect pressed keys via microphone audio capture. Uses statistical information (n-gram frequencies) about the language. <strong>No training data is required</strong>. The <em>&#39;record.kbd&#39;</em> input file has to be generated via the <strong>record-full</strong> tool and contains the audio data that will be analyzed. The <em>&#39;n-gram-dir&#39;</em> folder file has to contain n-gram probability files for the corresponding language.</p>
<div data-snippet-clipboard-copy-content="./keytap2-gui record.kbd ../data"><pre><code>./keytap2-gui record.kbd ../data
</code></pre></div>
<p dir="auto">Online demo: <a href="https://keytap2.ggerganov.com" rel="nofollow">https://keytap2.ggerganov.com</a></p>
<hr/>
</li>
<li>
<p dir="auto"><strong>keytap3</strong></p>
<p dir="auto">Fully automated recovery of unknown text from audio recordings.</p>
<div data-snippet-clipboard-copy-content="./keytap3 input.kbd ../data [-cN] [-CN] [-pF] [-tF] [-FN] [-fN]"><pre><code>./keytap3 input.kbd ../data [-cN] [-CN] [-pF] [-tF] [-FN] [-fN]
</code></pre></div>
<p dir="auto">Online demo: <a href="https://keytap3.ggerganov.com" rel="nofollow">https://keytap3.ggerganov.com</a></p>
<hr/>
</li>
<li>
<p dir="auto"><strong>keytap3-gui</strong></p>
<p dir="auto">GUI version of the <strong>keytap3</strong> tool.</p>
<div data-snippet-clipboard-copy-content="./keytap3-gui input.kbd ../data [-cN] [-CN] [-pF] [-tF] [-FN] [-fN]"><pre><code>./keytap3-gui input.kbd ../data [-cN] [-CN] [-pF] [-tF] [-FN] [-fN]
</code></pre></div>
<p dir="auto">Online demo: <a href="https://keytap3-gui.ggerganov.com" rel="nofollow">https://keytap3-gui.ggerganov.com</a></p>
<hr/>
</li>
<li>
<p dir="auto"><strong>view-full-gui</strong></p>
<p dir="auto">Visualize waveforms recorded with the <strong>record-full</strong> tool. Can also playback the audio data.</p>
<div data-snippet-clipboard-copy-content="./view-full-gui input.kbd [-pN]"><pre><code>./view-full-gui input.kbd [-pN]
</code></pre></div>
<p dir="auto"><a href="https://i.imgur.com/scjTaXw.png" rel="nofollow"><img src="https://camo.githubusercontent.com/4abeb4bf37692fd651f632bb8402272f2bf0353d99d4488818145e4df5459f7f/68747470733a2f2f692e696d6775722e636f6d2f73636a546158772e706e67" alt="view-full-gui" data-canonical-src="https://i.imgur.com/scjTaXw.png"/></a></p>
<hr/>
</li>
<li>
<p dir="auto"><strong>view-gui</strong></p>
<p dir="auto">Visualize training data recorded with the <strong>record</strong> tool. Can also playback the audio data.</p>
<div data-snippet-clipboard-copy-content="./view-gui input.kbd [-pN]"><pre><code>./view-gui input.kbd [-pN]
</code></pre></div>
<p dir="auto"><a href="https://i.imgur.com/2binGaZ.png" rel="nofollow"><img src="https://camo.githubusercontent.com/2319f6e0815981fa3c72b97505fe256a67fb01716cbcfe21a2f29c16bc82b01c/68747470733a2f2f692e696d6775722e636f6d2f3262696e47615a2e706e67" alt="view-full-gui" data-canonical-src="https://i.imgur.com/2binGaZ.png"/></a></p>
<hr/>
</li>
</ul>
<h2 dir="auto"><a id="user-content-feedback" aria-hidden="true" href="#feedback"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feedback</h2>
<p dir="auto">Any feedback about the performance of the tools is highly appreciated. Please drop a comment <a href="https://github.com/ggerganov/kbd-audio/issues/3" data-hovercard-type="issue" data-hovercard-url="/ggerganov/kbd-audio/issues/3/hovercard">here</a>.</p>
</article>
          </div></div>
  </body>
</html>
