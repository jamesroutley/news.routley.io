<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ian.sh/etugra">Original</a>
    <h1>Security concerns with the e-Tugra certificate authority</h1>
    
    <div id="readability-page-1" class="page"><div><div><article id="block-etugra"><p><span><span>Certificate authorities (CAs) are a critical backbone of internet security; when they are compromised, users lose the ability to securely connect to websites without fear of interception. Websites cannot insulate themselves against a fully-compromised CA, even if they normally use other CAs.</span></span></p><p><span><span>In many regards, certificate authorities are audited comprehensively against industry-specific audit standards. Certificate authorities also </span><span><a href="https://en.wikipedia.org/wiki/DigiNotar" target="_blank" rel="noopener noreferrer">routinely</a></span><span> </span><span><a href="https://arstechnica.com/information-technology/2022/11/state-sponsored-hackers-in-china-compromise-certificate-authority/" target="_blank" rel="noopener noreferrer">get</a></span><span> </span><span><a href="https://arstechnica.com/information-technology/2011/09/comodo-hacker-i-hacked-diginotar-too-other-cas-breached/" target="_blank" rel="noopener noreferrer">hacked</a></span><span>. Despite this, </span><span><strong>not a single certificate authority runs a bug bounty program</strong></span><span>, and of the major CAs, only GlobalSign and Let’s Encrypt even offer a </span><span><code>security.txt</code></span><span> to help disclose issues. Only an annual penetration is generally required of CAs.</span></span></p><p><span><span>As a result, I suspected that there was a lot of low-hanging fruit in certificate authorities, which malicious actors may have already discovered. I decided to look into several certificate authorities, in particular looking into the applications they are exposing to the internet.</span></span></p><p><span><span>I ended up taking a deep look into e-Tugra, a Turkey-based certificate authority trusted by Apple, Google, Mozilla, and other clients. I found a number of alarming issues that worry me as to the security practices inside their company, and want to share the details in hope of preventing these issues in the future. While every company suffers from security issues, these appear to be concerning issues in critical infrastructure, and I am disclosing them quickly in order to raise awareness of the potential risks.</span></span></p><h2 id="block-a589e83938194b228b1efa720f135320"><span id="a589e83938194b228b1efa720f135320"></span><span><span>Administrative tools with default passwords</span></span></h2><p><span><span>e-Tugra appears to use a common framework for many of their internal tools. They have a similar appearance, but also similar conspicuous text on their homepages.</span></span></p><p><span><span></span><img alt="image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><p><span><span>Although it’s written in Turkish, the homepage helpfully offers the default credentials for this application are either </span><span><code>admin / admin123%</code></span><span> or </span><span><code>user / user123%</code></span><span>. This is quite alarming to see on a certificate authority’s production website! Nevertheless, these credentials did not work at first, until I stumbled upon another application:</span></span></p><p><span><span></span><img alt="image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><p><span><span>This appeared to be a server storing logs from their other applications, and </span><span><strong>the default password worked</strong></span><span>! This allowed logging in and viewing over 14 million log entries, as well as adding other users to the application as an administrator. Notably, there was no other user configured, so the default passwords would have had to be willingly used by e-Tugra staff in order to access this system.</span></span></p><p><span><span>Additionally, there were many log lines referencing </span><span><a href="https://ian.sh/etugra">EJBCA</a></span><span>, which is the software used by many certificate authorities as part of their issuance infrastructure. As a result, </span><span><strong>this system was likely connected to other systems with the ability to issue certificates</strong></span><span>. Luckily, the log lines did not appear to have sensitive or secret values in them, albeit many are in Turkish which I do not speak.</span></span></p><h2 id="block-52c5e109419f47a796c27ec69f139c69"><span id="52c5e109419f47a796c27ec69f139c69"></span><span><span>Administrative tools with sign-up enabled(!)</span></span></h2><p><span><span>I tried the default passwords on another similar e-Tugra application written with the same framework. Luckily, they had been changed and did not work. However, there was an additional button on the login form — </span><span><strong>to sign up for a new account</strong></span><span>! I registered an account with the email </span><span><code>admin2@admin2.com</code></span><span> and was immediately logged into into a massive administrative panel.</span></span></p><p><span><span>This administrative tool contains every email message, text message, and uploaded document sent to and from e-Tugra’s systems. It contains numerous amounts of PII including uploaded Turkish IDs, email addresses, phone numbers, and physical addresses.</span></span></p><div id="block-6fb970f563be4199862818ef546c7608"><div id="block-c81f0588353c401b874e2efdd86f13f5"><div id="block-75ddf3f8e43c477ea59a812fe06b4378"><p><span><span></span><img alt="568k sent emails from e-Tugra systems" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><figcaption><span><span>568k sent emails from e-Tugra systems</span></span></figcaption></div></div><div id="block-cbcbfe9f181444b387cbf8d0e913af67"><div id="block-067d6640e8974088a3382995966ac67e"><p><span><span></span><img alt="Documents uploaded to e-Tugra" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><figcaption><span><span>Documents uploaded to e-Tugra</span></span></figcaption></div></div></div><p><span><span>This is, undoubtedly, a very serious issue. It is likely also a massive data breach of personal information. However, for certificate authorities, they also have a unique role of validating control of certain things like domain names. One way certificate authorities do this is by sending a unique code to specific email addresses, like </span><span><code>admin@yourdomain.com</code></span><span>, and having you send them that code as proof of control of the email address.</span></span></p><p><span><span><em>(Side note: Email validation is the only allowed domain validation method that relies on “secret” values. DNS and HTTP validation methods use public values that are then hosted on the domain, but email validation is the only one to have secrets which must be kept from the user.)</em></span></span></p><p><span><span>This issue in e-Tugra’s system allowed me to view the contents of any email sent to any e-Tugra user. Here, they are sending me a confirmation code to my own email address, but I could view these for any user:</span></span></p><p><span><span></span><img alt="image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><p><span><span>In this same administrative panel, we can see that it has an email template for proving control of a domain name. We can also edit the template, which is extremely concerning in itself. It appears this template may be presently unused by e-Tugra at the moment, however any domain validation previously completed through this system likely should be considered invalid.</span></span></p><p><span><span></span><img alt="image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="responsive"/></span></p><h2 id="block-3e729a791d324f96969e68c80aaeeea8"><span id="3e729a791d324f96969e68c80aaeeea8"></span><span><span>Customer-facing panel issues</span></span></h2><p><span><span>e-Tugra also offers a customer panel for customers to purchase certificates. Using the above issues, we could capture password reset emails and take over any account on this site. Without going into specific details due to them potentially not being resolved, there were numerous additional issues in this customer panel:</span></span></p><ul><li id="block-8d1f7a766fe84a4a87fe7640060eb276"><span><span>Several trivial and critical issues which could lead to user account takeover</span></span></li></ul><p><span><span>Hopefully I can add more details to these issues in the future, but I must stress how trivial they are. I was unable to test the customer panel in detail because it did not accept foreign credit cards, despite my best attempts. However, customer panels for certificate authorities often allow re-issuing existing certificates without further validation. These would be a critical issue for any user of e-Tugra.</span></span></p><h2 id="block-c1aa88dd8cb04cc69a3c9de07e4fc8fa"><span id="c1aa88dd8cb04cc69a3c9de07e4fc8fa"></span><span><span>Response</span></span></h2><p><span><span>Under the </span><span><a href="https://cabforum.org/wp-content/uploads/CA-Browser-Forum-Network-Security-Guidelines-v1.7.pdf" target="_blank" rel="noopener noreferrer">CA/B Forum Network Security Guidelines</a></span><span>, e-Tugra is required to remediate critical security vulnerabilities within 96 hours. I disclosed all of these issues in detail to e-Tugra, but have decided to publish this post without waiting for approval from e-Tugra due to the potential ecosystem risks.</span></span></p><ul><li id="block-22d44d40bc8d448b8351bf2646f39e5d"><span><span><strong>Nov 13, 2022 4:10</strong></span><span>: Initial contact to e-Tugra about administrative systems</span></span></li><li id="block-4d2de2e90b7447c28293905d430b9329"><span><span><strong><strong><strong><strong>Unknown</strong></strong></strong></strong></span><span>: Administrative systems no longer reachable on the internet</span></span></li><li id="block-a13e4de0b387443ba5634a3ccaa55dac"><span><span><strong>Nov 13, 2022 18:50</strong></span><span>: Second set of issues reported to e-Tugra, follow-up on initial issues that appeared fixed</span></span></li><li id="block-d0b08380f1534ffa8a65c7d4927d007b"><span><span><strong>Nov 14, 2022 8:35</strong></span><span>: Initial reply from e-Tugra saying they are working on resolution</span></span></li><li id="block-e5abd382c4ff40b8921012f0670fe615"><span><span><strong>Nov 14, 2022 17:18</strong></span><span>: Asked how to report security issues in the future</span></span></li><li id="block-8fb2f51b0cee4282987661e670a207ff"><span><span><strong>Nov 16, 2022 22:52: </strong></span><span>Notified e-Tugra of impending disclosure</span></span></li><li id="block-f36984c8d2124a4b9846f8bd4cc9c6a3"><span><span><strong>Nov 17, 2022</strong></span><span>: Disclosed this post</span></span></li></ul></article></div></div></div>
  </body>
</html>
