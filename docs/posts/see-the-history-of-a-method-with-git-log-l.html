<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://calebhearth.com/git-method-history">Original</a>
    <h1>See the History of a Method with Git log -L</h1>
    
    <div id="readability-page-1" class="page"><article>

<p>Git can “trace the evolution” of a specific method when passed <code>-L</code> using the <code>:&lt;funcname&gt;</code> variant. Let’s take a look at the history of this blog’s posts’ <code>published</code> scope, which is used in most places that articles are listed out. You can see that git is able to identify the boundaries of the method even as the length changes and it prints out the full method with diff from each commit in the log, which is filtered to changes to that method.</p>
<div><div><pre><code>$ git log -L :self.published:app/models/post.rb -n3
<span>commit d1fbdf3b9a5bd37dd49d61c61ee0f51c75fdb806
Author: Caleb Hearth &lt;caleb@calebhearth.com&gt;
Date:   Thu Feb 2 16:36:34 2023 -0700
</span><span>
</span>    Decree, LFW, new homepage, RSS-only posts
<span>
</span><span>diff --git a/app/models/post.rb b/app/models/post.rb
</span><span>--- a/app/models/post.rb
</span><span>+++ b/app/models/post.rb
</span><span>@@ -15,6 +15,6 @@</span>
   def self.published
     all
<span>-      .reject { _1.frontmatter[:draft] }
</span><span>+      .reject { _1.frontmatter[:draft] || _1.tags.include?(&#34;rss-only&#34;) }
</span>       .select { _1.date &lt;= Date.today }
   end
<span>

</span><span>commit 37a830b625db4e60e0ffbfec881d693369706169
Author: Caleb Hearth &lt;caleb@calebhearth.com&gt;
Date:   Fri Nov 12 11:39:48 2021 -0600
</span><span>
</span>    Publish posts published today
<span>
</span><span>diff --git a/app/models/post.rb b/app/models/post.rb
</span><span>--- a/app/models/post.rb
</span><span>+++ b/app/models/post.rb
</span><span>@@ -15,6 +15,6 @@</span>
   def self.published
     all
       .reject { _1.frontmatter[:draft] }
<span>-      .select { _1.date &lt; Date.today }
</span><span>+      .select { _1.date &lt;= Date.today }
</span>   end
<span>

</span><span>commit b1ed34a897af9ff2f882e140132a6e6045257b10
Author: Caleb Hearth &lt;caleb@calebhearth.com&gt;
Date:   Mon Nov 1 10:33:13 2021 -0500
</span><span>
</span>    Don&#39;t filter out all posts
<span>
</span><span>diff --git a/app/models/post.rb b/app/models/post.rb
</span><span>--- a/app/models/post.rb
</span><span>+++ b/app/models/post.rb
</span><span>@@ -12,6 +15,6 @@</span>
   def self.published
     all
<span>-      .reject { |post| post.frontmatter[:draft] }
-      .reject { |post| post.frontmatter[:date] &lt; Date.today }
</span><span>+      .reject { _1.frontmatter[:draft] }
+      .select { _1.date &lt; Date.today }
</span>   end
</code></pre></div></div>
<p>If you got excited and tried this on your own, you may have been disappointed to see a message like</p>
<div><div><pre><code><span>fatal: -L parameter &#39;self.published&#39; starting at line 1: no match
</span></code></pre></div></div>
<p>While Git knows how to do this for some languages (mostly the C family), it needs a bit of help for a lot of others including Ruby and Swift. Fortunately it’s as simple as adding one these lines (you only need the one relevant to your project’s language) to your project’s .gitattributes</p>
<div><div><pre><code>*.rb diff=ruby
*.swift diff=swift
</code></pre></div></div>
<p>If you’d like this to be global so you don’t get that error in each new project, you can set up a global .gitattributes file for yourself like this:</p>
<div><div><pre><code><span>$ </span>git config <span>--global</span> core.attributesfile ~/.gitattributes
</code></pre></div></div>
<p>Then add the above lines to ~/.gitattributes.</p>
</article></div>
  </body>
</html>
