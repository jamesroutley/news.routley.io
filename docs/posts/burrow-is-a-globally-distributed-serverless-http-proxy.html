<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/myzie/burrow">Original</a>
    <h1>Show HN: Burrow is a globally distributed, serverless HTTP proxy</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Burrow is a serverless and globally-distributed HTTP proxy for Go built on
AWS Lambda.</p>
<p dir="auto">It is designed to be completely compatible with the standard Go <code>*http.Client</code>
which means it can be transparently added to many existing applications. Burrow
provides an implementation of the <code>http.RoundTripper</code> interface that proxies
requests through one or more AWS Lambda functions exposed with
<a href="https://docs.aws.amazon.com/lambda/latest/dg/urls-configuration.html" rel="nofollow">Function URLs</a>.</p>
<p dir="auto">A round-robin transport is also provided which makes it trivial to automatically
rotate through multiple Lambda functions in different regions.</p>

<p dir="auto">Burrow gives you a network of rotating IPs in different regions, which can be
useful in a variety of situations, including:</p>
<ul dir="auto">
<li>Development: test how your app behaves when accessed from different regions.</li>
<li>Load testing: simulate distributed global traffic for your services.</li>
<li>Privacy: anonymous IP addresses when making web requests.</li>
<li>Geo-restriction bypass: access region-limited content or services.</li>
<li>API rate limiting: reduce the effects of IP address usage quotas when calling APIs.</li>
<li>Web scraping: efficiently collect data in a distributed manner.</li>
<li>Multi-region testing: Verify application behavior across different global regions.</li>
</ul>
<p dir="auto">Performance for individual requests through Burrow can be slow, especially when
routing through distant regions. However, Burrow is designed for highly concurrent
use in Go, where overall throughput matters more than individual request latency.</p>

<ul dir="auto">
<li>Easy-to-use proxy via <code>http.RoundTripper</code> implementation</li>
<li>Optional round-robin transport for rotating through multiple lambda proxies</li>
<li>Terraform for one command deployment to 17 AWS regions</li>
</ul>

<p dir="auto">Add burrow package to your Go project:</p>
<div dir="auto" data-snippet-clipboard-copy-content="go get github.com/myzie/burrow"><pre>go get github.com/myzie/burrow</pre></div>
<p dir="auto">Enable on an <code>http.Client</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="proxy := &#34;https://randomprefix.lambda-url.eu-west-2.on.aws/&#34;
client := &amp;http.Client{Transport: burrow.NewTransport(proxy, &#34;POST&#34;)}
// Now use the *http.Client as you would normally"><pre><span>proxy</span> <span>:=</span> <span>&#34;https://randomprefix.lambda-url.eu-west-2.on.aws/&#34;</span>
<span>client</span> <span>:=</span> <span>&amp;</span>http.<span>Client</span>{<span>Transport</span>: <span>burrow</span>.<span>NewTransport</span>(<span>proxy</span>, <span>&#34;POST&#34;</span>)}
<span>// Now use the *http.Client as you would normally</span></pre></div>
<p dir="auto">Create a round-robin transport:</p>
<div dir="auto" data-snippet-clipboard-copy-content="proxies := []string{
    &#34;https://randomprefix1.lambda-url.us-east-1.on.aws/&#34;,
    &#34;https://randomprefix2.lambda-url.us-east-2.on.aws/&#34;,
    &#34;https://randomprefix3.lambda-url.us-west-1.on.aws/&#34;,
}
var transports []http.RoundTripper
for _, u := range proxies {
    transports = append(transports, burrow.NewTransport(u, &#34;POST&#34;))
}
client := &amp;http.Client{
    Transport: burrow.NewRoundRobinTransport(transports),
}
// Client will now rotate through the provided proxies for each request"><pre><span>proxies</span> <span>:=</span> []<span>string</span>{
    <span>&#34;https://randomprefix1.lambda-url.us-east-1.on.aws/&#34;</span>,
    <span>&#34;https://randomprefix2.lambda-url.us-east-2.on.aws/&#34;</span>,
    <span>&#34;https://randomprefix3.lambda-url.us-west-1.on.aws/&#34;</span>,
}
<span>var</span> <span>transports</span> []http.<span>RoundTripper</span>
<span>for</span> <span>_</span>, <span>u</span> <span>:=</span> <span>range</span> <span>proxies</span> {
    <span>transports</span> <span>=</span> <span>append</span>(<span>transports</span>, <span>burrow</span>.<span>NewTransport</span>(<span>u</span>, <span>&#34;POST&#34;</span>))
}
<span>client</span> <span>:=</span> <span>&amp;</span>http.<span>Client</span>{
    <span>Transport</span>: <span>burrow</span>.<span>NewRoundRobinTransport</span>(<span>transports</span>),
}
<span>// Client will now rotate through the provided proxies for each request</span></pre></div>
<p dir="auto">Or use the <code>burrow.NewRoundRobinClient</code> helper:</p>
<div dir="auto" data-snippet-clipboard-copy-content="client := burrow.NewRoundRobinClient([]string{
    &#34;https://randomprefix1.lambda-url.us-east-1.on.aws/&#34;,
    &#34;https://randomprefix2.lambda-url.us-east-2.on.aws/&#34;,
    &#34;https://randomprefix3.lambda-url.us-west-1.on.aws/&#34;,
})"><pre><span>client</span> <span>:=</span> <span>burrow</span>.<span>NewRoundRobinClient</span>([]<span>string</span>{
    <span>&#34;https://randomprefix1.lambda-url.us-east-1.on.aws/&#34;</span>,
    <span>&#34;https://randomprefix2.lambda-url.us-east-2.on.aws/&#34;</span>,
    <span>&#34;https://randomprefix3.lambda-url.us-west-1.on.aws/&#34;</span>,
})</pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Multi-Region Deployment in AWS</h2><a id="user-content-multi-region-deployment-in-aws" aria-label="Permalink: Multi-Region Deployment in AWS" href="#multi-region-deployment-in-aws"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Burrow includes Terraform configurations to deploy Burrow across the 17
default-enabled AWS regions in your account with a single command:</p>
<div dir="auto" data-snippet-clipboard-copy-content="make deploy BUCKET_NAME=my-terraform-state-bucket"><pre>make deploy BUCKET_NAME=my-terraform-state-bucket</pre></div>
<p dir="auto">When the command completes, a <code>function_urls.json</code> file is written which contains
the URL for each Lambda function in each region. You can then read this file in
your Go program and pass the values to <code>burrow.NewRoundRobinClient</code>.</p>
<p dir="auto">See the Makefile for more information. You&#39;ll need the following installed:</p>
<ul dir="auto">
<li>terraform</li>
<li>make</li>
<li>go</li>
<li>jq</li>
<li>aws cli</li>
</ul>
<p dir="auto">The default-enabled AWS regions:</p>
<div data-snippet-clipboard-copy-content="ap-northeast-1 - Tokyo
ap-northeast-2 - Seoul
ap-northeast-3 - Osaka
ap-south-1 - Mumbai
ap-southeast-1 - Singapore
ap-southeast-2 - Sydney
ca-central-1 - Canada Central
eu-central-1 - Frankfurt
eu-north-1 - Stockholm
eu-west-1 - Ireland
eu-west-2 - London
eu-west-3 - Paris
sa-east-1 - Sao Paulo
us-east-1 - N. Virginia
us-east-2 - Ohio
us-west-1 - N. California
us-west-2 - Oregon"><pre><code>ap-northeast-1 - Tokyo
ap-northeast-2 - Seoul
ap-northeast-3 - Osaka
ap-south-1 - Mumbai
ap-southeast-1 - Singapore
ap-southeast-2 - Sydney
ca-central-1 - Canada Central
eu-central-1 - Frankfurt
eu-north-1 - Stockholm
eu-west-1 - Ireland
eu-west-2 - London
eu-west-3 - Paris
sa-east-1 - Sao Paulo
us-east-1 - N. Virginia
us-east-2 - Ohio
us-west-1 - N. California
us-west-2 - Oregon
</code></pre></div>

<ul dir="auto">
<li>Optional API key authentication in the Lambda proxy</li>
<li>Tests</li>
<li>Other suggestions?</li>
</ul>

<ul dir="auto">
<li><a href="https://github.com/myzie/burrow/blob/main/cmd/example_client/main.go">cmd/example_client/main.go</a></li>
<li><a href="https://github.com/myzie/burrow/blob/main/cmd/example_multi_region/main.go">cmd/example_multi_region/main.go</a></li>
</ul>
<p dir="auto">The multi-region example makes requests to <code>https://api.ipify.org?format=json</code>
to demonstrate how the proxy IP address changes across regions.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ go run ./cmd/example_multi_region
{&#34;ip&#34;:&#34;13.36.171.187&#34;}
{&#34;ip&#34;:&#34;13.208.187.84&#34;}
{&#34;ip&#34;:&#34;18.142.184.58&#34;}
{&#34;ip&#34;:&#34;3.106.212.219&#34;}
{&#34;ip&#34;:&#34;13.60.11.169&#34;}
{&#34;ip&#34;:&#34;43.200.183.53&#34;}
{&#34;ip&#34;:&#34;3.127.170.76&#34;}
{&#34;ip&#34;:&#34;3.238.225.252&#34;}
{&#34;ip&#34;:&#34;54.185.130.119&#34;}
{&#34;ip&#34;:&#34;54.168.55.243&#34;}
{&#34;ip&#34;:&#34;13.201.18.225&#34;}
{&#34;ip&#34;:&#34;15.222.11.134&#34;}
{&#34;ip&#34;:&#34;54.247.221.168&#34;}
{&#34;ip&#34;:&#34;13.40.174.185&#34;}
{&#34;ip&#34;:&#34;15.228.175.92&#34;}
{&#34;ip&#34;:&#34;3.137.163.176&#34;}
{&#34;ip&#34;:&#34;54.177.165.5&#34;}
{&#34;ip&#34;:&#34;13.36.171.187&#34;} # Back to the first region"><pre>$ go run ./cmd/example_multi_region
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.36.171.187<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.208.187.84<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>18.142.184.58<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>3.106.212.219<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.60.11.169<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>43.200.183.53<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>3.127.170.76<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>3.238.225.252<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>54.185.130.119<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>54.168.55.243<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.201.18.225<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>15.222.11.134<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>54.247.221.168<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.40.174.185<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>15.228.175.92<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>3.137.163.176<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>54.177.165.5<span>&#34;</span></span>}
{<span><span>&#34;</span>ip<span>&#34;</span></span>:<span><span>&#34;</span>13.36.171.187<span>&#34;</span></span>} <span><span>#</span> Back to the first region</span></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Custom Development and Consulting</h2><a id="user-content-custom-development-and-consulting" aria-label="Permalink: Custom Development and Consulting" href="#custom-development-and-consulting"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The author of Burrow <a href="https://github.com/myzie">@myzie</a> is available for
contract work and consulting. Feel free to reach out on Github or Linkedin for
help with anything related to Go, AWS, Terraform, cloud security, or SaaS
development. See my <a href="https://github.com/myzie">profile</a> for my Linkedin.</p>

<p dir="auto">Contributions are welcome! Please feel free to submit a pull request.</p>

<p dir="auto">Apache License 2.0</p>
</article></div></div>
  </body>
</html>
