<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2025/09/11/random-inside-triangle/">Original</a>
    <h1>Randomly selecting points inside a triangle</h1>
    
    <div id="readability-page-1" class="page"><article id="post-246489">
	<!-- .entry-header -->

	<div>
		<p>If you have a triangle with vertices <em>A</em>, <em>B</em>, and <em>C</em>, how would you generate random points inside the triangle <em>ABC</em>?</p>
<h2>Barycentric coordinates</h2>
<p>One idea would be to use barycentric coordinates.</p>
<ol>
<li>Generate random numbers α, β, and γ from the interval [0, 1].</li>
<li>Normalize the points to have sum 1 by dividing each by their sum.</li>
<li>Return α<em>A</em> + β<em>B</em> + γ<em>C</em>.</li>
</ol>
<p>This generates points inside the triangle, but not uniformly.</p>
<p><img fetchpriority="high" decoding="async" src="https://www.johndcook.com/triangle_bary.png" width="480" height="360"/></p>
<h2>Accept-reject</h2>
<p>Another idea is to use an accept-reject method. Draw a rectangle around the triangle, generate points in the square, and throw them away if they land outside the triangle.</p>
<p>An advantage to this method is that it obviously works because it doesn’t rely on anything subtle. Three cheers for brute force!</p>
<p>The method is fairly efficient; on average only half the points will be rejected.</p>
<p>A disadvantage to all accept-reject methods is that they have variable runtime, though this only matters in some applications.</p>
<h2>Accept-flip</h2>
<p>There is a clever variation on the accept-reject method. Create a parallelogram by attaching a flipped copy of the triangle. Now randomly sample from the parallelogram. Every sample point will either land inside the original triangle or in its flipped twin. If it landed in the original triangle, keep it. If it landed in the twin, flip it back over and use that point.</p>
<p>This is like an accept-reject method, except there’s no waste. Every point is kept, possibly after flipping.</p>
<p>You can find code for implementing this method on <a href="https://stackoverflow.com/questions/68493050/sample-uniformly-random-points-within-a-triangle">Stack Overflow</a>.</p>
<p><img decoding="async" src="https://www.johndcook.com/triangle_uniform.png" width="480" height="360"/></p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/2025/05/06/random-points-on-a-sphere/">Random points on a sphere</a></li>
<li><a href="https://www.johndcook.com/blog/2023/09/29/platonic-solids-and-integration/">Regular solinds and Monte Carlo integration</a></li>
<li><a href="https://www.johndcook.com/blog/2023/08/12/fibonacci-lattice/">Fibonacci lattice on a sphere</a></li>
</ul>
			</div><!-- .entry-content -->

	<!-- .entry-meta -->
</article></div>
  </body>
</html>
