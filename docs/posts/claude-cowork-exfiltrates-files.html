<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.promptarmor.com/resources/claude-cowork-exfiltrates-files">Original</a>
    <h1>Claude Cowork exfiltrates files</h1>
    
    <div id="readability-page-1" class="page"><div><!--$--><div><div data-framer-name="Content" data-framer-component-type="RichTextContainer"><p><img alt="Claude Cowork exfiltrates user files by uploading them to an attacker&#39;s Anthropic account." width="1328" height="935" src="https://framerusercontent.com/images/kbWpSh9EoyvzEzJzIk214QuARqc.png" srcset="https://framerusercontent.com/images/kbWpSh9EoyvzEzJzIk214QuARqc.png?scale-down-to=512&amp;width=2656&amp;height=1870 512w,https://framerusercontent.com/images/kbWpSh9EoyvzEzJzIk214QuARqc.png?scale-down-to=1024&amp;width=2656&amp;height=1870 1024w,https://framerusercontent.com/images/kbWpSh9EoyvzEzJzIk214QuARqc.png?scale-down-to=2048&amp;width=2656&amp;height=1870 2048w,https://framerusercontent.com/images/kbWpSh9EoyvzEzJzIk214QuARqc.png?width=2656&amp;height=1870 2656w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><h3 id="context"><a href="#context">Context </a></h3><p>Two days ago, Anthropic released the Claude Cowork research preview (a general-purpose AI agent to help anyone with their day-to-day work). In this article, we demonstrate how attackers can exfiltrate user files from Cowork by exploiting an unremediated vulnerability in Claude’s coding environment, which now extends to Cowork. The vulnerability was first identified in Claude.ai chat before Cowork existed by Johann Rehberger, who <!--$--><a href="https://embracethered.com/blog/posts/2025/claude-abusing-network-access-and-anthropic-api-for-data-exfiltration/" target="_blank" rel="noopener">disclosed</a><!--/$--> the vulnerability — it was <em>acknowledged but not remediated </em>by Anthropic. <!--$--><!--/$--></p><blockquote><p>“I do not think it is fair to tell regular non-programmer users to watch out for &#39;suspicious actions that may indicate prompt injection’!”</p></blockquote><p>As Anthropic has acknowledged this risk and put it on users to “avoid granting access to local files with sensitive information” (while simultaneously <!--$--><a href="http://youtube.com/watch?v=WBNZpAWhw5E&amp;t=32s" target="_blank" rel="noopener">encouraging</a><!--/$--> the use of Cowork to organize your Desktop), we have chosen to publicly disclose this demonstration of a threat users should be aware of. By raising awareness, we hope to enable users to better identify the types of ‘suspicious actions’ mentioned in Anthropic’s warning.</p><h3 id="the-attack-chain"><a href="#the-attack-chain">The Attack Chain</a></h3><p>This attack leverages the allowlisting of the Anthropic API  to achieve data egress from Claude&#39;s VM environment (which restricts most network access).</p><ol><li data-preset-tag="p"><p><strong>The victim connects Cowork to a local folder containing confidential real estate files</strong></p><img alt="A real estate folder is attached to Claude Cowork, containing  confidential appraisals and loan estimates." width="623" height="531" src="https://framerusercontent.com/images/taocGIGRimnEINXFaBdqZ6ChOU.png" srcset="https://framerusercontent.com/images/taocGIGRimnEINXFaBdqZ6ChOU.png?scale-down-to=512&amp;width=1246&amp;height=1063 512w,https://framerusercontent.com/images/taocGIGRimnEINXFaBdqZ6ChOU.png?scale-down-to=1024&amp;width=1246&amp;height=1063 1024w,https://framerusercontent.com/images/taocGIGRimnEINXFaBdqZ6ChOU.png?width=1246&amp;height=1063 1246w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p><strong>The victim uploads a file to Claude that contains a hidden prompt injection<br/></strong>For general use cases, this is quite common; a user finds a file online that they upload to Claude code. This attack is not dependent on the injection source - other injection sources include, but are not limited to: web data from Claude for Chrome, connected MCP servers, etc. In this case, the attack has the file being a Claude ‘Skill’ (although, as mentioned, it could also just be a regular document), as it is a generalizable file convention that users are likely to encounter, especially when using Claude.<em></em></p><img alt="The &#39;skill&#39; document uploaded by the user contains a concealed prompt injection." width="2088" height="1787" src="https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png" srcset="https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png?scale-down-to=512&amp;width=4176&amp;height=3574 512w,https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png?scale-down-to=1024&amp;width=4176&amp;height=3574 1024w,https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png?scale-down-to=2048&amp;width=4176&amp;height=3574 2048w,https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png?scale-down-to=4096&amp;width=4176&amp;height=3574 4096w,https://framerusercontent.com/images/MQrUto9iWrpJ9wZvYbs73KmGeU.png?width=4176&amp;height=3574 4176w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p><strong>The victim asks Cowork to analyze their files using the Real Estate ‘skill’ they uploaded</strong></p><img alt="Claude reads the uploaded &#39;skill&#39; document, using another skill that allows Claude to read docx." width="2400" height="1510" src="https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png" srcset="https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png?scale-down-to=512&amp;width=4801&amp;height=3020 512w,https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png?scale-down-to=1024&amp;width=4801&amp;height=3020 1024w,https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png?scale-down-to=2048&amp;width=4801&amp;height=3020 2048w,https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png?scale-down-to=4096&amp;width=4801&amp;height=3020 4096w,https://framerusercontent.com/images/U6cEhIAqQDizxjXYYPJyTg9uhM.png?width=4801&amp;height=3020 4801w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p><strong>The injection manipulates Cowork to upload files to the attacker’s Anthropic account</strong></p><img alt="Claude is manipulated by the prompt injection to make a cURL request, uploading the Loan Estimate to the attacker&#39;s Anthropic account." width="2342" height="1472" src="https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png" srcset="https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png?scale-down-to=512&amp;width=4684&amp;height=2944 512w,https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png?scale-down-to=1024&amp;width=4684&amp;height=2944 1024w,https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png?scale-down-to=2048&amp;width=4684&amp;height=2944 2048w,https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png?scale-down-to=4096&amp;width=4684&amp;height=2944 4096w,https://framerusercontent.com/images/YD8e2OtFEcm9oWgKwEn7vuyM.png?width=4684&amp;height=2944 4684w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>If we expand the &#39;Running command&#39; block, we can see the malicious request in detail:</p><img alt="API call uploading the user&#39;s file to the attacker&#39;s Anthropic account (by using the attacker&#39;s API key from the injection)." width="4036" height="1851" src="https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png" srcset="https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png?scale-down-to=512&amp;width=8072&amp;height=3702 512w,https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png?scale-down-to=1024&amp;width=8072&amp;height=3702 1024w,https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png?scale-down-to=2048&amp;width=8072&amp;height=3702 2048w,https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png?scale-down-to=4096&amp;width=8072&amp;height=3702 4096w,https://framerusercontent.com/images/gupBFbCsaxB2zGy8IiaPvnr1YAc.png?width=8072&amp;height=3702 8072w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>Code executed by Claude is run in a VM - restricting outbound network requests to almost all domains - but the Anthropic API flies under the radar as trusted, allowing this attack to complete successfully. </p></li><li data-preset-tag="p"><p><strong>The attacker’s account contains the victim&#39;s file, allowing them to chat with it</strong></p><img alt="Victim&#39;s file has been uploaded to the attackers account. Attacker can use the file ID to chat with it." width="2336" height="1409" src="https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png" srcset="https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png?scale-down-to=512&amp;width=4673&amp;height=2818 512w,https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png?scale-down-to=1024&amp;width=4673&amp;height=2818 1024w,https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png?scale-down-to=2048&amp;width=4673&amp;height=2818 2048w,https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png?scale-down-to=4096&amp;width=4673&amp;height=2818 4096w,https://framerusercontent.com/images/A2BIsw0c4kZl6qpT0BnDIz81DzY.png?width=4673&amp;height=2818 4673w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><img alt="The attacker can now query Claude and ask about the victim&#39;s document." width="1680" height="1261" src="https://framerusercontent.com/images/5mq9ZVMEir1kLhrLoNTMcFpb0c.png" srcset="https://framerusercontent.com/images/5mq9ZVMEir1kLhrLoNTMcFpb0c.png?scale-down-to=512&amp;width=3360&amp;height=2523 512w,https://framerusercontent.com/images/5mq9ZVMEir1kLhrLoNTMcFpb0c.png?scale-down-to=1024&amp;width=3360&amp;height=2523 1024w,https://framerusercontent.com/images/5mq9ZVMEir1kLhrLoNTMcFpb0c.png?scale-down-to=2048&amp;width=3360&amp;height=2523 2048w,https://framerusercontent.com/images/5mq9ZVMEir1kLhrLoNTMcFpb0c.png?width=3360&amp;height=2523 3360w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>The exfiltrated file contains financial figures and PII, including partial SSNs.</p></li></ol><h3 id="a-note-on-model-specific-resilience"><a href="#a-note-on-model-specific-resilience">A Note on Model-specific Resilience</a></h3><p>The above exploit was demonstrated against Claude Haiku. Although Claude Opus 4.5 is known to be more resilient against injections, Opus 4.5 in Cowork was successfully manipulated via indirect prompt injection to leverage the same file upload vulnerability to exfiltrate data in a test that considered a &#39;user&#39; uploading a malicious integration guide while developing a new AI tool:</p><p><img alt="Opus 4.5 exfiltrates customer records to attacker&#39;s Anthropic account." width="3425" height="2123" src="https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png" srcset="https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png?scale-down-to=512&amp;width=6850&amp;height=4246 512w,https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png?scale-down-to=1024&amp;width=6850&amp;height=4246 1024w,https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png?scale-down-to=2048&amp;width=6850&amp;height=4246 2048w,https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png?scale-down-to=4096&amp;width=6850&amp;height=4246 4096w,https://framerusercontent.com/images/BPiMMEfgljtKc7k7LtYFg9NWZeI.png?width=6850&amp;height=4246 6850w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>As the focus of this article was more for everyday users (and not developers), we opted to demonstrate the above attack chain instead of this one.</p><h3 id="dos-via-malformed-files"><a href="#dos-via-malformed-files">DOS via Malformed Files</a></h3><p>An interesting finding: Claude&#39;s API struggles when a file does not match the type it claims to be. When operating on a malformed PDF (ends .pdf, but it is really a text file with a few sentences in it), after trying to read it once, Claude starts throwing an API error in every subsequent chat in the conversation.</p><p><img alt="Attempting to read a file with the wrong extension provokes repeated API errors." width="2108" height="1322" src="https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png" srcset="https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png?scale-down-to=512&amp;width=4217&amp;height=2644 512w,https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png?scale-down-to=1024&amp;width=4217&amp;height=2644 1024w,https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png?scale-down-to=2048&amp;width=4217&amp;height=2644 2048w,https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png?scale-down-to=4096&amp;width=4217&amp;height=2644 4096w,https://framerusercontent.com/images/5Wt3USKsw3SnUb4PXtqqVkmBU.png?width=4217&amp;height=2644 4217w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>We posit that it is likely possible to exploit this failure via indirect prompt injection to cause a limited denial of service attack (e.g., an injection can elicit Claude to create a malformed file, and then read it). Uploading the malformed file via the files API resulted in notifications with an error message, both in the Claude client and the Anthropic Console.</p><h3 id="agentic-blast-radius"><a href="#agentic-blast-radius">Agentic Blast Radius</a></h3><p>One of the key capabilities that Cowork was created for is the ability to interact with one&#39;s entire day-to-day work environment. This includes the browser and MCP servers, granting capabilities like sending texts, controlling one&#39;s Mac with AppleScripts, etc. </p></div></div><!--/$--></div></div>
  </body>
</html>
