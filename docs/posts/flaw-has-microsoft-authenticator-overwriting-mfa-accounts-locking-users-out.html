<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.csoonline.com/article/3480918/design-flaw-has-microsoft-authenticator-overwriting-mfa-accounts-locking-users-out.html">Original</a>
    <h1>Flaw has Microsoft Authenticator overwriting MFA accounts, locking users out</h1>
    
    <div id="readability-page-1" class="page"><article id="post-3480918">
	<section>
		<div>
			<div>
				<div>
					<div>
						<div>
							<div>
								<div>
									<div>
	<h2>
		Microsoft stands out from the authenticator crowd by annihilating accounts when new accounts are introduced via QR code. Despite user complaints for years, no fix has been issued, leaving IT experts wondering, ‘Why would you pick Microsoft?’	</h2>
	
</div>
		
<div>
	<p><img width="1024" height="683" src="https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?quality=50&amp;strip=all&amp;w=1024" alt="Young man depressed, sad dissatisfied and unhappy outside office building, holding phone, reading bad news from smartphone, businessman in shirt after work." data-hero="" loading="eager" decoding="async" fetchpriority="high" srcset="https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?quality=50&amp;strip=all 8192w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=300%2C200&amp;quality=50&amp;strip=all 300w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=768%2C512&amp;quality=50&amp;strip=all 768w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=1024%2C683&amp;quality=50&amp;strip=all 1024w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=1536%2C1025&amp;quality=50&amp;strip=all 1536w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=2048%2C1366&amp;quality=50&amp;strip=all 2048w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=1240%2C826&amp;quality=50&amp;strip=all 1240w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=150%2C100&amp;quality=50&amp;strip=all 150w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=1045%2C697&amp;quality=50&amp;strip=all 1045w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=252%2C168&amp;quality=50&amp;strip=all 252w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=126%2C84&amp;quality=50&amp;strip=all 126w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=720%2C480&amp;quality=50&amp;strip=all 720w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=540%2C360&amp;quality=50&amp;strip=all 540w, https://www.csoonline.com/wp-content/uploads/2024/08/3480918-0-94260100-1722867179-shutterstock_2427472129.jpg?resize=375%2C250&amp;quality=50&amp;strip=all 375w" sizes="(max-width: 1024px) 100vw, 1024px"/>	</p>
			<p>Credit: voronaman / Shutterstock</p></div><!-- .post-thumbnail -->

								</div>
							</div>
						</div>					
						<div id="remove_no_follow">
		<div>
					  <div>
						<div>
<section></section>



<hr/>







<p>With use of <a href="https://www.csoonline.com/article/563753/two-factor-authentication-2fa-explained.html">multi-factor authentication</a> rising, end-users can find themselves fiddling with codes and authentication apps frequently throughout their days. For those who rely on Microsoft Authenticator, the experience can go beyond momentary frustration to full-blown panic as they become locked out of their accounts.</p>



<p>That’s because, due to an issue involving which fields it uses, Microsoft Authenticator often overwrites accounts when a user adds a new account via QR scan — the most common method of doing so. </p>
</div> <!-- Closing article-column__content0 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg0 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column0 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>But because of the way the resulting lockout happens, the user is not likely to realize the issue resides with Microsoft Authenticator. Instead, the company issuing the authentication is considered the culprit, resulting in wasted corporate helpdesk hours trying to fix an issue not of that company’s making. </p>


<div>
    
</div>



<p>The core of the problem? Microsoft Authenticator will overwrite an account with the same username. Given the prominent use of email addresses for usernames, most users’ apps share the same username. Google Authenticator and just about every other authenticator app add the name of the issuer — such as a bank or a car company — to avoid this issue. Microsoft only uses the username.</p>



<p>Making this situation worse is that when a Microsoft overwrite happens, it’s not easy to determine which account is being overwritten. This can cause authentication issues with both the newly created account and the account that is overwritten. Moreover, users can potentially not realize a previously created account was annihilated until they attempt to use it again, whether that’s weeks or months later.</p>
</div> <!-- Closing article-column__content1 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg1 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column1 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>There are multiple workarounds. The easiest is for companies to use any other authentication app. Not using the QR code scan feature — and manually entering the code — will also sidestep the issue, which doesn’t appear to arise when the authenticated accounts belong to Microsoft.</p>



<p>CSO Online found complaints of this problem dating back to 2020, but it appears to have been in place since Microsoft Authenticator was released in June 2016. (For historical context, Google was the first Authenticator app, having been launched in 2010.) </p>



<p>One such complaint in 2020 noted the workaround to manually enter the information, but it was dismissed as not viable for an enterprise audience.</p>
</div> <!-- Closing article-column__content2 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg2 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column2 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>“I believe the fix, sorry, I mean <em>workaround</em> for this is to use the Secret Key from the Identity Provider and manually type this into the Authenticator app during setup,” <a href="https://learn.microsoft.com/en-us/answers/questions/721812/authenticator-will-overwrite-accounts-with-same-us">the user wrote</a>. “Unfortunately, this is not very helpful in an enterprise environment, especially when the average end user rarely knows anything about the inner workings of authentication, and seeing a random string of characters is intimidating.”</p>



<h2 id="a-big-problem-with-usability-and-cybersecurity">‘A big problem with usability and cybersecurity’</h2>



<p>This problem got attention recently when Australian IT consultant Brett Randall posted about it on LinkedIn. </p>



<p>In his post, Randall described participating in a recent vendor training session: “As we logged into their system, we were presented with a QR code to scan for MFA. A number of attendees opened Microsoft Authenticator, scanned the QR code, and proceeded to overwrite another application’s TOTP (Time-based One-Time Password) key,” Randall wrote.</p>
</div> <!-- Closing article-column__content3 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg3 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column3 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>“Here’s how it should work and how every other authenticator app out there — Google, Okta, etc. — work. When you scan a QR code for MFA, it generates a string with a series of values. Other apps take two of these values — the label and the issuer — and join them together to form the unique ID for that key. Microsoft, on the other hand, ignores the standard and just takes one value — the label. And that’s typically your email address. Which means, Microsoft Authenticator will overwrite the last TOTP key that used the same email address. This can be disastrous.”</p>



<p>He added: “Watching a room full of people lose access to other systems as they gradually scanned a QR code and Microsoft Authenticator overwrote their keys to other systems was painful. But trying to get Microsoft to recognize the issue and do something about it? That’s been nigh on impossible.”</p>



<figure><blockquote><p>“If you haven’t picked an authentication app, why would you pick Microsoft?”</p><cite>— Tim Erlin, VP of product at Wallarm</cite></blockquote></figure>



<p>CSO Online contacted various other security and IT specialists and asked them if they could re-create the problem. They all could.</p>
</div> <!-- Closing article-column__content4 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg4 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column4 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>“The help-desk burden is not trivial. This is one where I think it’s a design flaw,” said Gary Longsine, fractional CTO at IllumineX. “As far as recommending the app, this would prevent me from using Microsoft Authenticator. I wouldn’t recommend it to anyone for that reason.”</p>



<p>Tim Erlin, VP of product at Wallarm, said, “Users will be locked out and will need to get back in. Once you add one entry that is using the email address, the second entry will conflict. And once you have overwritten, you won’t know which one was overwritten.”</p>



<p>He added, “It’s possible that this problem occurs more often than anyone realizes because [users] don’t realize what the cause is. If you haven’t picked an authentication app, why would you pick Microsoft?”</p>
</div> <!-- Closing article-column__content5 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg5 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column5 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>Erlin speculated that this problem initially happened because of an historic disconnect between security engineers and end-users. “This is a small example of a big problem with usability and cybersecurity. This is what happens when apps are developed by engineers who don’t have a strong knowledge of customers,” he said, adding that Microsoft hasn’t bothered to fix it because Microsoft Authenticator is a free product and therefore doesn’t generate revenue.</p>



<p>David Meltzer, chief product officer at Netography, re-created the problem and found it disconcerting. “I tried this to experience it myself. It is clearly a bug. It is a fairly straightforward thing [for Microsoft] to fix. Every other authenticator can handle it.”</p>



<p>Asked for comment, Google spokesperson Kimberly Samra wrote that “it’s correct that we don’t overwrite codes. That was an explicit decision.”</p>
</div> <!-- Closing article-column__content6 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg6 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column6 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<h2 id="microsoft-says-users-issuers-to-blame">Microsoft says users, issuers to blame</h2>



<p>Microsoft confirmed the issue but said it was a feature not a bug, and that it was the fault of users or companies that use the app for authentication.</p>



<p>Microsoft issued two written statements to CSO Online but declined an interview. Its first statement read: “We can confirm that our authenticator app is functioning as intended. When users scan a QR code, they will receive a message prompt that asks for confirmation before proceeding with any action that might overwrite their account settings. This ensures that users are fully aware of the changes they are making.”</p>



<p>One problem with that first statement is that it does not correctly reflect what the message says. The message says: “This action will overwrite existing security information for your account. To prevent being locked out of your account, continue only if you initiated this action from a trusted source.”</p>
</div> <!-- Closing article-column__content7 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg7 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column7 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>The first sentence of the warning window is correct, in that the action will indeed overwrite the account. But the second sentence incorrectly tells the user to proceed as long as two conditions are met: that the user initiated the action; and that it is a trusted source. In almost all relevant situations, both would apply. The user did indeed initiate the action (as opposed to a cyberthief trying to break in) and the site (such as a bank or hotel) is trusted.</p>



<p>Therefore, a user following those instructions would proceed and overwrite the accounts. It’s also worth noting that the message offers no means of not overwriting the account, other than abandoning the entire authentication effort. Users following the instructions would experience the problematic overwrite. </p>



<p>A few days after its initial response, Microsoft unprompted sent a different statement. The second one was much longer, blaming issuers:</p>
</div> <!-- Closing article-column__content8 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg8 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column8 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<blockquote>
<p>“When you scan a QR code, the Authenticator app uses a label given by the vendor to set up your Time-based One-Time Password (TOTP) account. However, some sites or vendors don’t include the issuer — the site name or Identity provider name — in the label. This may result in a situation where a user may already have an account with the same label and the app attempts to overwrite the existing TOTP account with the new one they are scanning. In situations where a user has an existing account with the same label, users are always presented with a message prompt to confirm overwriting an existing TOTP account in their app and can make a conscious choice to proceed or not. We are always working on enhancing our products and will take this into consideration and apply it to future improvements.”</p>
</blockquote>



<p>That last sentence is the only indication we have seen from Microsoft that it might fix the issue.</p>



<p>As for the actions of “some sites or vendors,” Randall said there are a limited number of ways to resolve this situation.</p>



<p>“It seems there are two options here to avoid end users accidentally overwriting other apps’ keys. We audit every application’s otpauth and go through the hassle of trying to convince every company doing it ‘wrong’ to fix it. Or Microsoft fixes this once and then we never have to worry about it again,” Randall said.</p>
</div> <!-- Closing article-column__content9 -->
							</div> <!-- Closing col-12 col-10@md col-6@lg col-start-3@lg9 -->
								</div> <!-- Closing grid grid--cols-10@md grid--cols-8@lg article-column9 -->
								<div>
										<div>
											 <div>							
												<div>
									<div>										
										<div>									
											
										</div>										
									</div>
								</div>
											</div>
										</div>
									</div>
					<div> <!-- Open -->
						<div> <!-- Open -->
							<div>


<p>“By the way, I’ve tested this behavior in 14 other authenticator apps so far. None of them exhibit the same collision behavior that Microsoft Authenticator does,” he added. “I gave up at 14 because at that point, it’s obvious Microsoft are the ones who are doing things poorly here.”</p>



<p>Randall listed the apps he tested: Google Authenticator by Google; Okta Verify by Okta; Duo Mobile by Duo Security; LastPass Authenticator by LastPass; 2FA Authenticator (2FAS) by Two Factor Authentication Service; Twilio Authy by Authy; Salesforce Authenticator by Salesforce; OneAuth by Zoho; ForgeRock Authenticator by ForgeRock; Authenticator 7 by SMM Service; Authenticator App by 2Stable; Auth0 Guardian by Auth0; OTP Auth by Roland Moers; and Authenticator 2FA Sentinel by Tommaso Carpi.</p>
</div></div></div></div>					</div>
				</div>
			</div>

			<!--right side bar-->
			<div id="rightrail-wrapper">
				<div>
					<div>
        
					<div>
					  <div>
						<div>
						  <div>						
											
						  </div>
						</div>
					  </div>
					</div>
						  </div>		<div>
			<h2>Related content</h2>
			<ul>
									<li id="nativocardrightrail-1"></li>		<li>
			<a href="https://www.csoonline.com/article/564860/hot-cybersecurity-trends.html" rel="noreferrer" aria-label="Go to content">
				<p><span>feature</span>
									</p>
				<h4>6 hot cybersecurity trends — and 2 going cold</h4>
				 <p><span>Artificial intelligence is altering not only the threat landscape but also how security teams can defend their organizations. But AI isn’t the only trend cybersecurity pros should be on top of.</span></p>				<p><span>
				By Neal Weinberg				</span>
				</p>
				<p><span>Aug 06, 2024</span>
											<span>
							<span>11 mins</span>						</span>
									</p>
				<p><span><span>Passwords</span></span>
													<span><span>Ransomware</span></span>
													<span><span>Phishing</span></span>
															</p>
			</a>
		</li>
										<li>
			<a href="https://www.csoonline.com/article/2515415/fbi-disrupts-1000-russian-bots-spreading-disinformation-on-x.html" rel="noreferrer" aria-label="Go to content">
				<p><span>news</span>
									</p>
				<h4>FBI disrupts 1,000 Russian bots spreading disinformation on X</h4>
				 <p><span>The bot farm was built by a Russian state-sponsored media to spread misinformation in and about a number of countries.</span></p>				<p><span>
				By Shweta Sharma				</span>
				</p>
				<p><span>Jul 10, 2024</span>
											<span>
							<span>4 mins</span>						</span>
									</p>
				<p><span><span>Authentication</span></span>
													<span><span>Technology Industry</span></span>
															</p>
			</a>
		</li>
										<li>
			<a href="https://www.csoonline.com/article/2137564/after-snowflake-hugging-face-reports-security-breach.html" rel="noreferrer" aria-label="Go to content">
				<p><span>news</span>
									</p>
				<h4>After Snowflake, Hugging Face reports security breach</h4>
				 <p><span>Hugging Face has advised its community members to refresh access tokens or switch to safer ones to protect against the attack.</span></p>				<p><span>
				By Shweta Sharma				</span>
				</p>
				<p><span>Jun 03, 2024</span>
											<span>
							<span>4 mins</span>						</span>
									</p>
				<p><span><span>Authentication</span></span>
													<span><span>Hacking</span></span>
															</p>
			</a>
		</li>
															</ul>
					<ul>
								<li>
						<a href="https://www.csoonline.com/podcasts/">PODCASTS</a>
					</li>
										<li>
						<a href="https://www.csoonline.com/videos/">VIDEOS</a>
					</li>
										<li>
						<a href="https://us.resources.csoonline.com">RESOURCES</a>
					</li>
										<li>
						<a href="https://www.csoonline.com/events/">EVENTS</a>
					</li>
							</ul>
					</div>
		<div>
        
					<div>
					  <div>
						<div>
						  <div>						
											
						  </div>
						</div>
					  </div>
					</div>
						  </div>	<div>
					<p>SUBSCRIBE TO OUR NEWSLETTER			</p>
							<h3>
				From our editors straight to your inbox			</h3>
						<p>
			Get started by entering your email address below.		</p>
				<div>
			<form method="post" id="rr-single-nl-form">
								<div>
					<div>
						<p><span>Please enter a valid email address</span>
						</p>
					</div>
				</div>
				
			</form>
		</div>
	</div>
 			 
				</div>
			</div>
			<!--right side bar ends here-->

		</div>
	</section>
</article></div>
  </body>
</html>
