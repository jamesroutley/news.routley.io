<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://aldenhallak.com/blog/posts/draw-a-fish-postmortem.html">Original</a>
    <h1>Drawafish.com Postmortem: Whoops</h1>
    
    <div id="readability-page-1" class="page"><div>
        

        <div>
            <div>
                <p><img src="https://aldenhallak.com/blog/images/drawafish-hero.jpg" alt="DrawAFish.com website screenshot - 100 hand drawn fish swimming in a tank."/></p><p>DrawAFish.com</p>
            </div>

            <h2>TL;DR:</h2>
            <ul>
                <li><strong>Incident Duration:</strong> ~6 hours (2AMâ€“8AM EST)</li>
                <li><strong>Impact:</strong>
                    <ul>
                        <li>Username vandalism (slurs)</li>
                        <li>Offensive fish approved / safe fish removed</li>
                    </ul>
                </li>
                <li><strong>Root Causes:</strong>
                    <ol>
                        <li>Legacy 6-digit admin password exposed in past data breach</li>
                        <li>Username update API lacked authentication</li>
                        <li>JWT not tied to specific user</li>
                    </ol>
                </li>
                <li><strong>Mitigation:</strong> Manual reversal of mod actions, fixed authorization logic, backups reviewed</li>
                <li><strong>Takeaway:</strong> hwoopsy daisy ðŸ™‚</li>
            </ul>

            <div>
                <p><img src="https://aldenhallak.com/blog/images/hackernews-pointing.jpg" alt="Post &#39;Show HN: Draw A Fish and watch it swim with the others&#39; on the #1 spot of hacker news, highlighted, circled, lots of red arrows pointing to it."/></p><p>Did you see? Did you see it? What it says? What it says on top of the website?
                </p>
            </div>

            <p>If you were on HackerNews on <a href="https://news.ycombinator.com/front?day=2025-08-01" target="_blank">Aug 1 2025</a>, you may have seen <a href="https://drawafish.com">DrawAFish.com</a>.
                Because it was in the number 1 spot. You also may have seen it if you follow me on <a href="https://instagram.com/verybigandstrong" target="_blank">instagram</a>. You also probably saw
                that I was in the #1 spot on Hackernews there too. Because I posted about it a lot. And also if you
                talked to me in person you probably heard about it. And then you probably heard a lot of quotes from
                <i>The Social Network</i> (2010) where I replaced various words with &#34;Fish.&#34;</p>

            <blockquote>
                &#34;A million fish isn&#39;t cool. You know what&#39;s cool? <a href="https://www.youtube.com/watch?v=4e0n7vTLz1U" target="_blank">A billion fish</a>.&#34;
            </blockquote>

            <p>If you read the post on Hackernews, you saw that the website was an exercise in
                vibe-coding. I used Copilot to implement features, and I used it to implement features <i>fast</i>.</p>

            <p> In my career,<sup><a href="#footnote-0" id="ref-0">[0]</a></sup> I have learned the art of &#34;Blameless
                Postmortems.&#34; The problem with a Blameless
                Postmortem is that it doesn&#39;t really work when you&#39;re the sole contributor. So this is a blameful
                postmortem. And I blame me. (Not the LLM, sorry).</p>

            <p>If you saw the website only on August 1, you probably do not understand why I need to write a postmortem
                at
                all. Everything went swimmingly (ha, ha). But if you had the displeasure of viewing my website between
                the hours of 2AM (20 minutes after I went to sleep) and 8AM (when I woke up)<sup><a href="#footnote-1" id="ref-1">[1]</a></sup> EST on Aug 3, then you would have seen chaos. Every single username was
                transformed to a heinous slur, many unsavory fish had made it into the fishtank, and many beautiful fish
                were gone. How did this happen?</p>

            <h2>The Vulnerabilities</h2>

            <div>
                <p><img src="https://aldenhallak.com/blog/images/hacked.jpg" alt="Screenshot showing a hacked user profile with username changed to &#39;Stinky Fart Man&#39;"/></p><p>This is not what they changed my username to. I&#39;ll let you use your
                    imagination.</p>
            </div>

            <ol>
                <li>
                    <p><strong>Legacy admin password exposed in data breach:</strong> When creating the website, I used
                        my childhood username and my childhood 6-digit password for testing. I think the first time it
                        leaked was on Neopets.com.<sup><a href="#footnote-2" id="ref-2">[2]</a></sup> I then set up
                        Google Auth. From then on, I only logged in with Google Auth. But the password remained. I
                        simply forgot. This allowed some of the most intelligent and brilliant minds on the internet to
                        find my password on the Neopets data leak paste, log in as an admin, and approve and disapprove
                        some really disgusting and horrible fish.</p>

                    <p>On the plus side, the brilliant minds (while attempting to ban every single user) managed to
                        accidentally ban themselves. So that vulnerability was only an active issue for an hour or so.
                    </p>
                </li>

                <li>
                    <p><strong>Username update API lacked authentication:</strong> I vibe coded the profile backend,
                        which allows users to modify their username. I added this feature last minute, figured I&#39;d
                        review it later, and then didn&#39;t. The username modification did not perform any auth logic
                        whatsoever. whoopsy</p>
                </li>

                <li>
                    <p><strong>JWT not tied to specific user:</strong> There was another security vulnerability - I
                        used the JWT to authorize login, but never confirmed that the JWT token belonged to the userId /
                        email associated with it in the admin actions. So you could log in with my username and password,
                        grab the JWT, and then send that along with your request. While this was a mistake, it ended up
                        saving me. Fortunately, hackernews user @<a href="https://news.ycombinator.com/user?id=iceweaselfan44" target="_blank">iceweaselfan44</a> used this vulnerability to authorize as an admin and
                        delete the really bad fish. He was awake, on the other side of the world, removing fish and
                        helping out.<sup><a href="#footnote-3" id="ref-3">[3]</a></sup></p>
                </li>
            </ol>

            <h2>The Recovery</h2>

            <div>
                <p><img src="https://aldenhallak.com/blog/images/moderation-logs.jpg" alt="A moderation log that shows a moderation action done at 3AM and undone in the morning."/></p><p>Moderation logs. There are so many of these.</p>
            </div>

            <p>I woke up at around 7:45 am, saw a couple pings and messages, and immediately rushed to my desktop.<sup><a href="#footnote-4" id="ref-4">[4]</a></sup> Fortunately, I had set up firebase backups.
                Unfortunately, I had set them up wrong. I spent a good hour or so diagnosing the errors and then quickly
                pushed changes to require authentication.</p>

            <p>I had a mod log set up, so undoing the changes was as simple as writing an annoying script that just
                undid all the mod actions. Did I learn my lesson about vibe coding? Maybe. I vibe coded the script,
                looked over the code, and did a dry run first.</p>

            <p>I banned the other mod account ran by IceWeasel<sup><a href="#footnote-5" id="ref-5">[5]</a></sup> and
                patched the JWT bug - at which point he reached out to me and explained how he created it. We then
                hopped on a call and he took a look at the codebase, where he expertly suggested a refactor that would
                be more idiomatic with current security practices. And then when I blindly pushed it and it broke
                everything, he expertly committed some more changes that fixed it.</p>

            <h2>Reflection</h2>

            <p>At this point, you&#39;re probably thinking: geeze man. Wow. youve gotta be stupid.</p>

            <p>And I&#39;d like to get on my hands and knees and beg for your suspension of belief when I say: yes I am but
                not when it comes to my job. It is really fun to just have high velocity, and it is really fun to not do
                code reviews and to just push stuff. Sometimes it feels like all I do at work is review code and write
                docs - and the code I write at work is lately deeply within legacy systems and makes my brain hurt
                sometimes. I have good reviews! Just ask my coworkers! The ones that hate me hate me because I leave TOO
                many comments and am TOO thorough (or they are jealous of my handsome good looks and devilish charm).
            </p>

            <p>So when I decided to learn how to build on GCP and vibe code a small app that I figured a handful of
                people would see, I took it easy on the code reviews. I let Copilot do all the work, I wrote no tests,
                and instead of writing TODOs and Documentation I simply said &#34;I&#39;ll remember to change my password / add
                auth / understand this code later.&#34; And then I didn&#39;t do that. Whoops!</p>

            <p>It would be very nice for my ego to blame the LLM here. But LLMs are a tool. They let you generate a lot
                of code really fast, and sometimes that is good. Sometimes it is not. And it is up to you to review it,
                and decide what code gets committed.</p>

            <!-- Lessons learned image suggestion: Meme or infographic about vibe coding vs proper development -->
            <div>
                <p><img src="https://aldenhallak.com/blog/images/llms-dont-commit.jpg" alt="Very crudely draw MS-Paint sticker for &#39;LLMs don&#39;t commit code, people do&#39;. It&#39;s drawn over a sticker that says &#39;Guns don&#39;t kill people, people do.&#39;"/></p><p>I am selling these stickers for 100 dollars each. Please reach out to purchase
                    them.</p>
            </div>

            <hr/>

            <p><small> Nearly 5 years at the same company. <a href="#ref-0">â†©</a></small>
            </p>

            <p><small> I usually try to sleep more than this. I want to sleep more than
                    this. But my fancy &#34;smart&#34; ikea roller blinds that keep it dark at night and bright when I wake up
                    fell down because I taped them to the wall very poorly. <a href="#ref-1">â†©</a></small></p>

            <p><small> I remember being a kid and forgetting my password and thinking &#34;wow
                    it&#39;s nice how they just email you your password, instead of resetting it. More websites should do
                    that.&#34; <a href="#ref-2">â†©</a></small></p>

            <p><small> The JWT token issue was the only vuln that really required knowing
                    how anything worked. I don&#39;t think it&#39;s a coincidence that there was a correlation between being a
                    studious / diligent person and actively being a helpful force. <a href="#ref-3">â†©</a></small></p>

            <p><small> Which is next to my bed. I live in New York.<sup><a href="#footnote-4a" id="ref-4a">[4a]</a></sup></small></p>

            <p><small> Only because it had no identifying information at all - just didn&#39;t
                    know who this person was. He reached out later and we chatted over discord and now we&#39;re cool. <a href="#ref-5">â†©</a></small></p>
        </div>
    </div></div>
  </body>
</html>
