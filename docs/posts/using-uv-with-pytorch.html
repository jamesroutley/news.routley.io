<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://docs.astral.sh/uv/guides/integration/pytorch/">Original</a>
    <h1>Using uv with PyTorch</h1>
    
    <div id="readability-page-1" class="page"><div data-md-component="container">
      
      
        
          
        
      
      <main data-md-component="main">
        <div>
          
            
              
              
            
            
              
              
            
          
          
            <div data-md-component="content">
              
              <article>
                
                  

  
  



<p>The <a href="https://pytorch.org/">PyTorch</a> ecosystem is a popular choice for deep learning research and
development. You can use uv to manage PyTorch projects and PyTorch dependencies across different
Python versions and environments, even controlling for the choice of accelerator (e.g., CPU-only vs.
CUDA).</p>
<h2 id="installing-pytorch"><a href="#installing-pytorch">Installing PyTorch</a></h2>
<p>From a packaging perspective, PyTorch has a few uncommon characteristics:</p>
<ul>
<li>Many PyTorch wheels are hosted on a dedicated index, rather than the Python Package Index (PyPI).
  As such, installing PyTorch typically often configuring a project to use the PyTorch index.</li>
<li>PyTorch includes distinct builds for each accelerator (e.g., CPU-only, CUDA). Since there&#39;s no
  standardized mechanism for specifying these accelerators when publishing or installing, PyTorch
  encodes them in the local version specifier. As such, PyTorch versions will often look like
  <code>2.5.1+cpu</code>, <code>2.5.1+cu121</code>, etc.</li>
<li>Builds for different accelerators are published to different indexes. For example, the <code>+cpu</code>
  builds are published on <a href="https://download.pytorch.org/whl/cpu">https://download.pytorch.org/whl/cpu</a>, while the <code>+cu121</code> builds are
  published on <a href="https://download.pytorch.org/whl/cu121">https://download.pytorch.org/whl/cu121</a>.</li>
</ul>
<p>As such, the necessary packaging configuration will vary depending on both the platforms you need to
support and the accelerators you want to enable.</p>
<p>To start, consider the following (default) configuration, which would be generated by running
<code>uv init --python 3.12</code> followed by <code>uv add torch torchvision</code>.</p>
<p>In this case, PyTorch would be installed from PyPI, which hosts CPU-only wheels for Windows and
macOS, and GPU-accelerated wheels on Linux (targeting CUDA 12.4):</p>
<div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span>[project]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;project&#34;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span>version</span><span> </span><span>=</span><span> </span><span>&#34;0.1.0&#34;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span>requires-python</span><span> </span><span>=</span><span> </span><span>&#34;&gt;=3.12&#34;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span>dependencies</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span>  </span><span>&#34;torch&gt;=2.5.1&#34;</span><span>,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span>  </span><span>&#34;torchvision&gt;=0.20.1&#34;</span><span>,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span>]</span>
</code></pre></div>
<div>
<p>Supported Python versions</p>
<p>At time of writing, PyTorch does not yet publish wheels for Python 3.13; as such projects with
<code>requires-python = &#34;&gt;=3.13&#34;</code> may fail to resolve. See the
<a href="https://github.com/pytorch/pytorch/blob/main/RELEASE.md#release-compatibility-matrix">compatibility matrix</a>.</p>
</div>
<p>This is a valid configuration for projects that want to use CPU builds on Windows and macOS, and
CUDA-enabled builds on Linux. However, if you need to support different platforms or accelerators,
you&#39;ll need to configure the project accordingly.</p>
<h2 id="using-a-pytorch-index"><a href="#using-a-pytorch-index">Using a PyTorch index</a></h2>
<p>In some cases, you may want to use a specific PyTorch variant across all platforms. For example, you
may want to use the CPU-only builds on Linux too.</p>
<p>In such cases, the first step is to add the relevant PyTorch index to your <code>pyproject.toml</code>:</p>
<div data-tabs="1:5"><p><label for="__tabbed_1_1">CPU-only</label><label for="__tabbed_1_2">CUDA 11.8</label><label for="__tabbed_1_3">CUDA 12.1</label><label for="__tabbed_1_4">CUDA 12.4</label><label for="__tabbed_1_5">ROCm6</label></p>
<div>
<div>
<div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cpu&#34;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
</div>
<div>
<div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu118&#34;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cu118&#34;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
</div>
<div>
<div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu121&#34;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cu121&#34;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
</div>
<div>
<div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cu124&#34;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
</div>
<div>
<div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-rocm&#34;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/rocm6.2&#34;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
</div>
</div>
</div>
<p>We recommend the use of <code>explicit = true</code> to ensure that the index is <em>only</em> used for <code>torch</code>,
<code>torchvision</code>, and other PyTorch-related packages, as opposed to generic dependencies like <code>jinja2</code>,
which should continue to be sourced from the default index (PyPI).</p>
<p>Next, update the <code>pyproject.toml</code> to point <code>torch</code> and <code>torchvision</code> to the desired index:</p>
<div data-tabs="2:5"><p><label for="__tabbed_2_1">CPU-only</label><label for="__tabbed_2_2">CUDA 11.8</label><label for="__tabbed_2_3">CUDA 12.1</label><label for="__tabbed_2_4">CUDA 12.4</label><label for="__tabbed_2_5">ROCm6</label></p>
<div>
<div>
<p>PyTorch doesn&#39;t publish CPU-only builds for macOS, since macOS builds are always considered CPU-only.
As such, we gate on <code>platform_system</code> to instruct uv to ignore the PyTorch index when resolving for macOS.</p>
<div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span>]</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span>]</span>
</code></pre></div>
</div>
<div>
<p>PyTorch doesn&#39;t publish CUDA builds for macOS. As such, we gate on <code>platform_system</code> to instruct uv to ignore
the PyTorch index when resolving for macOS.</p>
<div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu118&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span>]</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu118&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span>]</span>
</code></pre></div>
</div>
<div>
<p>PyTorch doesn&#39;t publish CUDA builds for macOS. As such, we gate on <code>platform_system</code> to instruct uv to ignore
the PyTorch index when resolving for macOS.</p>
<div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu121&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span>]</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu121&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span>]</span>
</code></pre></div>
</div>
<div>
<p>PyTorch doesn&#39;t publish CUDA builds for macOS. As such, we gate on <code>platform_system</code> to instruct uv to ignore
the PyTorch index when resolving for macOS.</p>
<div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span>]</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span>},</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span>]</span>
</code></pre></div>
</div>
<div>
<p>PyTorch doesn&#39;t publish ROCm6 builds for macOS or Windows. As such, we gate on <code>platform_system</code> to instruct uv to
ignore the PyTorch index when resolving for those platforms.</p>
<div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-rocm&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Linux&#39;&#34;</span><span>},</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span>]</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-rocm&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Linux&#39;&#34;</span><span>},</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span>]</span>
</code></pre></div>
</div>
</div>
</div>
<p>As a complete example, the following project would use PyTorch&#39;s CPU-only builds on all platforms:</p>
<div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span>[project]</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;project&#34;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span>version</span><span> </span><span>=</span><span> </span><span>&#34;0.1.0&#34;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span>requires-python</span><span> </span><span>=</span><span> </span><span>&#34;&gt;=3.12.0&#34;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span>dependencies</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span>  </span><span>&#34;torch&gt;=2.5.1&#34;</span><span>,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span>  </span><span>&#34;torchvision&gt;=0.20.1&#34;</span><span>,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span>]</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span>    </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span>]</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span>    </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span>]</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cpu&#34;</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
<h2 id="configuring-accelerators-with-environment-markers"><a href="#configuring-accelerators-with-environment-markers">Configuring accelerators with environment markers</a></h2>
<p>In some cases, you may want to use CPU-only builds in one environment (e.g., macOS and Windows), and
CUDA-enabled builds in another (e.g., Linux).</p>
<p>With <code>tool.uv.sources</code>, you can use environment markers to specify the desired index for each
platform. For example, the following configuration would use PyTorch&#39;s CPU-only builds on Windows
(and macOS, by way of falling back to PyPI), and CUDA-enabled builds on Linux:</p>
<div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span>[project]</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;project&#34;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span>version</span><span> </span><span>=</span><span> </span><span>&#34;0.1.0&#34;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span>requires-python</span><span> </span><span>=</span><span> </span><span>&#34;&gt;=3.12.0&#34;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span>dependencies</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span>  </span><span>&#34;torch&gt;=2.5.1&#34;</span><span>,</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span>  </span><span>&#34;torchvision&gt;=0.20.1&#34;</span><span>,</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span>]</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Windows&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Linux&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span>]</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Windows&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system == &#39;Linux&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span>]</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cpu&#34;</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cu124&#34;</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
<h2 id="configuring-accelerators-with-optional-dependencies"><a href="#configuring-accelerators-with-optional-dependencies">Configuring accelerators with optional dependencies</a></h2>
<p>In some cases, you may want to use CPU-only builds in some cases, but CUDA-enabled builds in others,
with the choice toggled by a user-provided extra (e.g., <code>uv sync --extra cpu</code> vs.
<code>uv sync --extra cu124</code>).</p>
<p>With <code>tool.uv.sources</code>, you can use extra markers to specify the desired index for each enabled
extra. For example, the following configuration would use PyTorch&#39;s CPU-only for
<code>uv sync --extra cpu</code> and CUDA-enabled builds for <code>uv sync --extra cu124</code>:</p>
<div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span>[project]</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;project&#34;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span>version</span><span> </span><span>=</span><span> </span><span>&#34;0.1.0&#34;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span>requires-python</span><span> </span><span>=</span><span> </span><span>&#34;&gt;=3.12.0&#34;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span>dependencies</span><span> </span><span>=</span><span> </span><span>[]</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span>[project.optional-dependencies]</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span>cpu</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span>  </span><span>&#34;torch&gt;=2.5.1&#34;</span><span>,</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span>  </span><span>&#34;torchvision&gt;=0.20.1&#34;</span><span>,</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span>]</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span>cu124</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span>  </span><span>&#34;torch&gt;=2.5.1&#34;</span><span>,</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span>  </span><span>&#34;torchvision&gt;=0.20.1&#34;</span><span>,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span>]</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span>[tool.uv]</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span>conflicts</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span>  </span><span>[</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span>    </span><span>{</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cpu&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span>    </span><span>{</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cu124&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span>  </span><span>],</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span>]</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span>[tool.uv.sources]</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span>torch</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cu124&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span>]</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span>torchvision</span><span> </span><span>=</span><span> </span><span>[</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span><span>,</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cpu&#34;</span><span>,</span><span> </span><span>marker</span><span> </span><span>=</span><span> </span><span>&#34;platform_system != &#39;Darwin&#39;&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span>  </span><span>{</span><span> </span><span>index</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span><span>,</span><span> </span><span>extra</span><span> </span><span>=</span><span> </span><span>&#34;cu124&#34;</span><span> </span><span>},</span>
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span>]</span>
<a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cpu&#34;</span>
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cpu&#34;</span>
<a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
<a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>
<a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span>[[tool.uv.index]]</span>
<a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span>name</span><span> </span><span>=</span><span> </span><span>&#34;pytorch-cu124&#34;</span>
<a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span>url</span><span> </span><span>=</span><span> </span><span>&#34;https://download.pytorch.org/whl/cu124&#34;</span>
<a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span>explicit</span><span> </span><span>=</span><span> </span><span>true</span>
</code></pre></div>
<div>
<p>Note</p>
<p>Since GPU-accelerated builds aren&#39;t available on macOS, the above configuration will continue to use
the CPU-only builds on macOS via the <code>&#34;platform_system != &#39;Darwin&#39;&#34;</code> marker, regardless of the extra
provided.</p>
</div>
<h2 id="the-uv-pip-interface"><a href="#the-uv-pip-interface">The <code>uv pip</code> interface</a></h2>
<p>While the above examples are focused on uv&#39;s project interface (<code>uv lock</code>, <code>uv sync</code>, <code>uv run</code>,
etc.), PyTorch can also be installed via the <code>uv pip</code> interface.</p>
<p>PyTorch itself offers a <a href="https://pytorch.org/get-started/locally/">dedicated interface</a> to determine
the appropriate pip command to run for a given target configuration. For example, you can install
stable, CPU-only PyTorch on Linux with:</p>
<div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>$<span> </span>pip3<span> </span>install<span> </span>torch<span> </span>torchvision<span> </span>torchaudio<span> </span>--index-url<span> </span>https://download.pytorch.org/whl/cpu
</code></pre></div>
<p>To use the same workflow with uv, replace <code>pip3</code> with <code>uv pip</code>:</p>
<div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>$<span> </span>uv<span> </span>pip<span> </span>install<span> </span>torch<span> </span>torchvision<span> </span>torchaudio<span> </span>--index-url<span> </span>https://download.pytorch.org/whl/cpu
</code></pre></div>



  




                
              </article>
            </div>
          
          
  


        </div>
        
          
        
      </main>
      
        
      
    </div></div>
  </body>
</html>
