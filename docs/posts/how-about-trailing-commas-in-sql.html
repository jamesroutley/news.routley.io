<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://peter.eisentraut.org/blog/2025/02/11/how-about-trailing-commas-in-sql">Original</a>
    <h1>How about trailing commas in SQL?</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>Anecdotally, this might be the most requested feature in SQL: Allow
some trailing commas.</p>

<p>The classic example is</p>

<div><div><pre><code>SELECT a,
       b,
       c,  -- here
FROM ...
</code></pre></div></div>

<p>Another one is</p>

<div><div><pre><code>CREATE TABLE tab1 (
    a int,
    b int,
    c int,  -- here
)
</code></pre></div></div>

<p>There might be a few other popular ones.  (Please send feedback.)</p>

<p>How could we support that?  And by “we”, I primarily mean, either in
PostgreSQL, which I work on, or in the SQL standard, which I work on.
And ultimately in other SQL implementations, which may or may not
follow either of these two sources.</p>

<p>Implementing the above two cases in PostgreSQL is easy.  Done?!?</p>

<p>But there are loads more places in SQL with comma-separated lists, for
example, array constructors, row constructors, function calls, as well
as in various commands, such as function definitions, type
definitions, <code>COPY</code>, <code>CREATE PUBLICATION</code>, many others.  What to do
about this?  Is there a line to draw somewhere?</p>

<p>I can see a few possible approaches:</p>

<ol>
  <li>
    <p>We just support a few of the most requested cases.  Over time, we
can add a few more if people request it.</p>
  </li>
  <li>
    <p>We support most cases, except the ones that are too complicated to
implement or cause grammar conflicts.</p>
  </li>
  <li>
    <p>We rigorously support trailing commas everywhere commas are used
and maintain this for future additions.</p>
  </li>
</ol>

<p>These are all problematic, in my opinion.  If we do option 1, then how
do we determine what is popular?  And if we change it over time, then
there will be a mix of versions that support different things, and it
will be very confusing.  Option 2 is weird, how do you determine the
cutoff?  Option 3 would do the job, but it would obviously be a lot of
work.  And there might be some cases where it’s impossible, and it
would have to degrade into option 2.</p>

<p>In any case, it would also be nice to get this into the SQL standard.
Then we can aim for some consistency across implementations in the
long run.</p>

<p>There, we have the same questions, but we need to be even more
rigorous.</p>

<ol>
  <li>
    <p>If we just add support for a few that we feel like are most
requested and add more over time, then we need to manage different
conformance rules and a bunch of feature codes.  I think this would
be confusing for implementers and users.  I still remember that C
supported trailing commas in structure values in C89 but in enum
declarations only in C99.  That was confusing!  And now consider
having that but many more times!</p>
  </li>
  <li>
    <p>There is likely no option 2, because adding <code>&lt;optional trailing
comma&gt;</code> (or whatever it might be called) all over the standard text
is easy.  There are no cases that are “too complicated”.</p>
  </li>
  <li>
    <p>We could add it everywhere.  That’d be straightforward.  But then
we don’t take implementation concerns into account.  Are there
cases where it’s too complicated too parse?  Would it require
additional reserved words?  How do we verify that this is actually
implementable?  I think this would result in fragmentation in the
actual implementations, which is exactly not the point.</p>
  </li>
</ol>

<p>I researched about a dozen programming languages.  Most of them
nowadays have some trailing-comma support somewhere.  But that’s where
the similarities end.  Usually, you can see trailing commas support in
something like enum definitions or array initialization.  But how
about function calls?  Or function definitions?  You can easily find
three different answers!  Also, programming languages generally have
much fewer syntactic constructs than SQL, which is generally a good
thing, but then it’s hard to make a good comparison or find good
guidance.</p>

<p>On the SQL side, DuckDB has <a href="https://duckdb.org/docs/sql/dialect/friendly_sql.html#trailing-commas">advertised
support</a>
for trailing commas, but I have not found rigorous answers to the
above questions.  Trying it out, they cover some of the popular cases,
but you can easily find places where it doesn’t work for no obvious
reason.  Now if other implementations do it their own way as well,
we’ll just get chaos.</p>

<p>What do you think?  What’s the way forward here?</p>

  </div>
  
  
</article>

      </div>
    </div></div>
  </body>
</html>
