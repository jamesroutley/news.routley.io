<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ai.facebook.com/blog/ai-powered-audio-compression-technique/">Original</a>
    <h1>Using AI to compress audio files for quick and easy sharing</h1>
    
    <div id="readability-page-1" class="page"><div><div><div id="u_0_2r_4L"><div id="u_0_2s_af"><div tabindex="0" id="u_0_2t_Di"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_2u_pB"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_2w_rY"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div></div><p> Compression is an important part of the internet today, because it enables people to easily share high-quality photos, listen to audio messages, stream their favorite shows, and so much more. Even when using today’s state-of-the-art techniques, enjoying these <a href="https://ai.facebook.com/blog/ai-driven-acoustic-synthesis-for-augmented-and-virtual-reality-experiences/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span> rich multimedia experiences </span></a> requires a speedy internet connection and plenty of storage space. For current and future experiences — like the metaverse — to deliver high-quality, uninterrupted experiences for everyone, <a href="https://ai.facebook.com/blog/training-with-quantization-noise-for-extreme-model-compression/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>compression techniques </span></a> will need to overcome these limitations. </p><p>Today, we are detailing progress that our <a href="https://ai.facebook.com/research/#research-areas" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span> Fundamental AI Research </span></a> (FAIR) team has made in the area of AI-powered hypercompression of audio. Imagine listening to a friend’s audio message in an area with low connectivity and not having it stall or glitch. Our research shows how we can use AI to help us achieve this. We built a three-part system and trained it end to end to compress audio data to the size we target. This data can then be decoded using a neural network. We achieve an approximate 10x compression rate compared with MP3 at 64 kbps, without a loss of quality. While such techniques have been explored before for speech, we are the first to make it work for 48 kHz sampled stereo audio (i.e., CD quality), which is the standard for music distribution. We are sharing additional details in a research paper, along with code and samples as part of our commitment to open science.</p><p>The new approach can compress and decompress audio in real time to state-of-the-art size reductions. More work needs to be done, but eventually it could lead to improvements such as supporting faster, better-quality calls under poor network conditions and delivering rich metaverse experiences without requiring major bandwidth improvements. </p><p>While our techniques do not yet cover video, this is the start of an ongoing initiative with the goal of advances that could improve experiences such as videoconferencing, streaming movies, and playing games with friends in VR. </p><h2> Our AI-powered compression technique </h2><p><a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCodec&amp;h=AT23J_pc0CAcqqw4_VVR3EWNW4h4IcJ3oTVWC9lh8TI8tTC5AO3K57qTVPdG9b-BXIOnV7AK2xlIp_U_xdHbYBDcxLNwSToO0LgjcVrDxxGNyGunwj0roiQeNhj8Ql7wOvfhlX3Pv4PwTTBJ" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>Codecs </span></a>, which act as encoders and decoders for streams of data, help power most of the audio compression people currently use online. Some examples of commonly used codecs include MP3, Opus, and EVS. Classic codecs like these decompose the signal between different frequencies and encode as efficiently as possible. Most classic codecs leverage human hearing knowledge (psychoacoustics) but have a finite or given set of handcrafted ways to efficiently code and decode the file. We are probably close to the limit of what handcrafting can give us, which is why it’s important to explore new techniques.</p><p>In order to push the boundaries of what’s possible, we need AI to help. We created Encodec, a neural network that is trained end to end to reconstruct the input signal. It consists of three parts:</p><ul><li><p> The encoder, which takes the uncompressed data and transforms it into a higher dimensional and lower frame rate representation. </p></li><li><p> The quantizer, which compresses this representation to the size we target. We train the quantizer to give us the size (or set of sizes) that we want while retaining the most important information to rebuild the original signal. This compressed representation is what we store on disk or send through the network. This is the equivalent of the .mp3 file on your computer. </p></li><li><p> The decoder is the final step. It turns the compressed signal back into a waveform that is as similar as possible to the original. The key to lossy compression is to identify changes that will not be perceivable by humans, as perfect reconstruction is impossible at low bit rates. To do so, we use discriminators to improve the perceptual quality of the generated samples.This creates a cat-and-mouse game where the discriminator’s job is to differentiate between real samples and reconstructed samples. The compression model attempts to generate samples to fool the discriminators by pushing the reconstructed samples to be more perceptually similar to the original samples. </p></li></ul><p>We achieve state-of-the art results in low bit rate speech audio compression (1.5 kbps to 12 kbps) as evaluated by human annotators who compared several compression methods, including Google&#39;s latest codec Lyra-v2, with the uncompressed one and ranked them accordingly. Across all bandwidth and quality levels, our model encodes and decodes audio in real time on a single CPU core. We see many areas where we can continue to build and improve on this research in the future. We believe we can attain even smaller file sizes, as we haven’t yet reached the limits of quantization techniques. On the applied research side, there is more work that can be done on the trade-off between computing power and the size of compressed audio. Dedicated chips, such as those that are already on phones and laptops, could be improved in the future to help compress and decompress files, while consuming less power. </p><h2>Building on this research </h2><p> We invest in and share fundamental AI research like this so the broader community can learn from and build on these advancements. This research could lead to richer, faster online experiences for people around the world, regardless of the speed of their internet connection. </p><p>There is additional research that will need to be done to help us get there. We want to continue exploring how we can compress audio to even smaller file sizes without significantly degrading the quality. We also plan to explore spatial audio compression, which will require a technique that can compress several audio channels while keeping accurate spatial information. These learnings could be useful for future metaverse experiences. We are also exploring techniques for using AI to compress audio and video, and we hope to share more about that work in the future.</p><p> Read our <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Farxiv.org%2Fabs%2F2210.13438&amp;h=AT0NLmIPoXgiuv_YRha6lzZM3kecbT-Hw9mSU1aHhC7cnyjLbo2l9RfjJauDEjQf0wy2Kk3vo0F3Q6qYwHeMPbpFtbMkCxJeEXfvIUrf2dN4B7LuEGyDA7qz-rAk_IjeZdthxtvWQiVOimCP" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span> paper </span></a> to learn more about AI-powered hypercompression for audio, and then <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fgithub.com%2Ffacebookresearch%2Fencodec&amp;h=AT0SFEDfvxvnsf7ZO06ZFfFCSI8wHSUhgcK3euobXyAJmJRYx1EMAQsSJrtboa1IWupmAGTrHPExnEct_L1Q7T0RLISXRR-C5J7wqP91jgn3tnM98u8av1YNIJKis6mHcKCSY_969zlRToAs" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>download the code</span></a>.</p></div></div>
  </body>
</html>
