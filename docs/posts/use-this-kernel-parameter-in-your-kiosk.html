<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cedwards.xyz/use-this-kernel-parameter-in-your-kiosk/">Original</a>
    <h1>Use this kernel parameter in your kiosk</h1>
    
    <div id="readability-page-1" class="page"><div>
            

            <div>
                <div>
                    <p>Use This Kernel Parameter in Your Kiosk</p>
                    <p>November 18, 2022</p>
                </div>
                <p><a href="https://www.reddit.com/r/pbsod">r/PBSOD</a> is a fun subreddit all about posting pictures of broken kiosks and information/entertainment systems in public. It stands for Public Blue Screen of Death which is a Windowsism but Linux systems are posted there too.</p>
<p>If you spend enough time scrolling, you might notice two things:</p>
<ol>
<li>There’s a scary number of these kiosks running networked Windows</li>
<li>Nearly all of the Linux kiosks are in a panicked state</li>
</ol>
<p>A kernel panic is an unrecoverable error. It could be a damaged filesystem, bad hardware, a malfunctioning driver, a bitflip, or just a kernel bug. When this happens, a backtrace is printed and the system hangs forever. It won’t respond to ACPI shutdown events and there’s no processes running to report that it’s in a bad state.</p>
<p>These panicked kiosks we see are in limbo until they’re power cycled. Some might get power cycled daily, but I’d wager somebody usually needs to come along and do it.</p>
<p>This is kind of tragic because it can be prevented by adding one parameter to the boot command line.</p>
<p>Or it can be set ephemerally with <code>sysctl</code>:</p>
<div><pre tabindex="0"><code data-lang="fallback">$ sysctl -w kernel.panic=60
</code></pre></div><p>Use this and the kernel will automatically reboot 60 seconds after a panic. It gives you enough time to snap a pic if you want to look into the issue, but gets the system back up and running shortly if you’re not around to fix it. Of course, if the hardware is indeed damaged or the filesystem is broken, this will just throw it into a boot loop, but you’re no worse off. If you’re building a kiosk, it’s hopefully obvious to avoid having any read-write mounted filesystems at all costs.</p>
<p>In fact, this is worth using on any production system you manage. It doesn’t matter where your system is – whether it’s in the cloud, on-premise, or inside a fridge – one day it will panic and this might just save you from being woken up at 1am.</p>

            </div>
            

        </div></div>
  </body>
</html>
