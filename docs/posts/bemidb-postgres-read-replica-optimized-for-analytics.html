<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/BemiHQ/BemiDB">Original</a>
    <h1>Show HN: BemiDB ‚Äì Postgres read replica optimized for analytics</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">BemiDB is a Postgres read replica optimized for analytics.
It consists of a single binary that seamlessly connects to a Postgres database, replicates the data in a compressed columnar format, and allows you to run complex queries using its Postgres-compatible analytical query engine.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/BemiHQ/BemiDB/blob/main/img/BemiDB.gif"><img src="https://github.com/BemiHQ/BemiDB/raw/main/img/BemiDB.gif" alt="BemiDB" data-animated-image=""/></a></p>

<ul dir="auto">
<li><a href="#highlights">Highlights</a></li>
<li><a href="#use-cases">Use cases</a></li>
<li><a href="#quickstart">Quickstart</a></li>
<li><a href="#configuration">Configuration</a>
<ul dir="auto">
<li><a href="#local-disk-storage">Local disk storage</a></li>
<li><a href="#s3-block-storage">S3 block storage</a></li>
</ul>
</li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#future-roadmap">Future roadmap</a></li>
<li><a href="#benchmark">Benchmark</a></li>
<li><a href="#development">Development</a></li>
<li><a href="#alternatives">Alternatives</a></li>
<li><a href="#license">License</a></li>
</ul>

<ul dir="auto">
<li><strong>Performance</strong>: runs analytical queries up to 2000x faster than Postgres.</li>
<li><strong>Single Binary</strong>: consists of a single binary that can be run on any machine.</li>
<li><strong>Postgres Replication</strong>: automatically syncs data from Postgres databases.</li>
<li><strong>Compressed Data</strong>: uses an open columnar format for tables with 4x compression.</li>
<li><strong>Scalable Storage</strong>: storage is separated from compute and can natively work on S3.</li>
<li><strong>Query Engine</strong>: embeds a query engine optimized for analytical workloads.</li>
<li><strong>Postgres-Compatible</strong>: integrates with any services and tools in the Postgres ecosystem.</li>
<li><strong>Open-Source</strong>: released under an OSI-approved license.</li>
</ul>

<ul dir="auto">
<li><strong>Run complex analytical queries like it&#39;s your Postgres database</strong>. Without worrying about performance impact and indexing.</li>
<li><strong>Simplify your data stack down to a single binary</strong>. No complex setup, no data movement, no CDC, no ETL, no DW.</li>
<li><strong>Integrate with Postgres-compatible tools and services</strong>. Query and visualize data with BI tools, notebooks, and ORMs.</li>
<li><strong>Have all data automatically synced into your data lakehouse</strong>. Using Iceberg tables with Parquet data on object storage.</li>
</ul>

<p dir="auto">Install BemiDB:</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -sSL https://raw.githubusercontent.com/BemiHQ/BemiDB/refs/heads/main/scripts/install.sh | bash"><pre>curl -sSL https://raw.githubusercontent.com/BemiHQ/BemiDB/refs/heads/main/scripts/install.sh <span>|</span> bash</pre></div>
<p dir="auto">Sync data from a Postgres database:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bemidb sync --pg-database-url postgres://postgres:postgres@localhost:5432/dbname"><pre>bemidb sync --pg-database-url postgres://postgres:postgres@localhost:5432/dbname</pre></div>
<p dir="auto">Run BemiDB database:</p>

<p dir="auto">Run Postgres queries on top of the BemiDB database:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# List all tables
psql postgres://localhost:54321/bemidb -c &#34;SELECT * FROM information_schema.tables&#34;

# Query a table
psql postgres://localhost:54321/bemidb -c &#34;SELECT COUNT(*) FROM [table_name]&#34;"><pre><span><span>#</span> List all tables</span>
psql postgres://localhost:54321/bemidb -c <span><span>&#34;</span>SELECT * FROM information_schema.tables<span>&#34;</span></span>

<span><span>#</span> Query a table</span>
psql postgres://localhost:54321/bemidb -c <span><span>&#34;</span>SELECT COUNT(*) FROM [table_name]<span>&#34;</span></span></pre></div>


<p dir="auto">By default, BemiDB stores data on the local disk.
Here is an example of running BemiDB with default settings and storing data in a local <code>iceberg</code> directory:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bemidb start \
  --port 54321 \
  --database bemidb \
  --storage-type LOCAL \
  --iceberg-path ./iceberg \ # $PWD/iceberg/*
  --init-sql ./init.sql \
  --log-level INFO"><pre>bemidb start \
  --port 54321 \
  --database bemidb \
  --storage-type LOCAL \
  --iceberg-path ./iceberg <span>\ </span><span><span>#</span> $PWD/iceberg/*</span>
  --init-sql ./init.sql \
  --log-level INFO</pre></div>

<p dir="auto">BemiDB natively supports S3 storage. You can specify the S3 settings using the following flags:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bemidb start \
  --port 54321 \
  --database bemidb \
  --storage-type AWS_S3 \
  --iceberg-path iceberg \ # s3://[AWS_S3_BUCKET]/iceberg/*
  --aws-region us-east-1 \
  --aws-s3-bucket [AWS_S3_BUCKET] \
  --aws-access-key-id [AWS_ACCESS_KEY_ID] \
  --aws-secret-access-key [AWS_SECRET_ACCESS_KEY]"><pre>bemidb start \
  --port 54321 \
  --database bemidb \
  --storage-type AWS_S3 \
  --iceberg-path iceberg <span>\ </span><span><span>#</span> s3://[AWS_S3_BUCKET]/iceberg/*</span>
  --aws-region us-east-1 \
  --aws-s3-bucket [AWS_S3_BUCKET] \
  --aws-access-key-id [AWS_ACCESS_KEY_ID] \
  --aws-secret-access-key [AWS_SECRET_ACCESS_KEY]</pre></div>
<p dir="auto">Here is the minimal IAM policy required for BemiDB to work with S3:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
    &#34;Version&#34;: &#34;2012-10-17&#34;,
    &#34;Statement&#34;: [
        {
            &#34;Sid&#34;: &#34;VisualEditor0&#34;,
            &#34;Effect&#34;: &#34;Allow&#34;,
            &#34;Action&#34;: [
                &#34;s3:PutObject&#34;,
                &#34;s3:GetObject&#34;,
                &#34;s3:ListBucket&#34;,
                &#34;s3:DeleteObject&#34;
            ],
            &#34;Resource&#34;: [
                &#34;arn:aws:s3:::[AWS_S3_BUCKET]&#34;,
                &#34;arn:aws:s3:::[AWS_S3_BUCKET]/*&#34;
            ]
        }
    ]
}"><pre>{
    <span>&#34;Version&#34;</span>: <span><span>&#34;</span>2012-10-17<span>&#34;</span></span>,
    <span>&#34;Statement&#34;</span>: [
        {
            <span>&#34;Sid&#34;</span>: <span><span>&#34;</span>VisualEditor0<span>&#34;</span></span>,
            <span>&#34;Effect&#34;</span>: <span><span>&#34;</span>Allow<span>&#34;</span></span>,
            <span>&#34;Action&#34;</span>: [
                <span><span>&#34;</span>s3:PutObject<span>&#34;</span></span>,
                <span><span>&#34;</span>s3:GetObject<span>&#34;</span></span>,
                <span><span>&#34;</span>s3:ListBucket<span>&#34;</span></span>,
                <span><span>&#34;</span>s3:DeleteObject<span>&#34;</span></span>
            ],
            <span>&#34;Resource&#34;</span>: [
                <span><span>&#34;</span>arn:aws:s3:::[AWS_S3_BUCKET]<span>&#34;</span></span>,
                <span><span>&#34;</span>arn:aws:s3:::[AWS_S3_BUCKET]/*<span>&#34;</span></span>
            ]
        }
    ]
}</pre></div>

<p dir="auto">BemiDB consists of the following main components:</p>
<ul dir="auto">
<li><strong>Database Server</strong>: implements the <a href="https://www.postgresql.org/docs/current/protocol.html" rel="nofollow">Postgres protocol</a> to enable Postgres compatibility.</li>
<li><strong>Query Engine</strong>: embeds the <a href="https://duckdb.org/" rel="nofollow">DuckDB</a> query engine to run analytical queries.</li>
<li><strong>Storage Layer</strong>: uses the <a href="https://iceberg.apache.org/" rel="nofollow">Iceberg</a> table format to store data in columnar compressed Parquet files.</li>
<li><strong>Postgres Connector</strong>: connects to a Postgres databases to sync tables&#39; schema and data.</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/BemiHQ/BemiDB/blob/main/img/architecture.png"><img src="https://github.com/BemiHQ/BemiDB/raw/main/img/architecture.png" alt="Architecture" width="720px"/></a></p>

<ul>
<li> Native support for complex data structures like JSON and arrays.</li>
<li> Incremental data synchronization into Iceberg tables.</li>
<li> Direct Postgres-compatible write operations.</li>
<li> Real-time replication from Postgres using CDC.</li>
<li> TLS and authentication support for Postgres connections.</li>
<li> Iceberg table compaction and partitioning.</li>
<li> Cache layer for frequently accessed data.</li>
<li> Add support for materialized views.</li>
</ul>

<p dir="auto">BemiDB is optimized for analytical workloads and can run complex queries up to 2000x faster than Postgres.</p>
<p dir="auto">On the TPC-H benchmark with 22 sequential queries, BemiDB outperforms Postgres by a significant margin:</p>
<ul dir="auto">
<li>Scale factor: 0.1
<ul dir="auto">
<li>BemiDB unindexed: 2.3s üëç</li>
<li>Postgres unindexed: 1h23m13s üëé (2,170x slower)</li>
<li>Postgres indexed: 1.5s üëç (99.97% bottleneck reduction)</li>
</ul>
</li>
<li>Scale factor: 1.0
<ul dir="auto">
<li>BemiDB unindexed: 25.6s üëç</li>
<li>Postgres unindexed: ‚àû üëé (infinitely slower)</li>
<li>Postgres indexed: 1h34m40s üëé (220x slower)</li>
</ul>
</li>
</ul>
<p dir="auto">See the <a href="https://github.com/BemiHQ/BemiDB/blob/main/benchmark">benchmark</a> directory for more details.</p>

<p dir="auto">We develop BemiDB using <a href="https://www.jetify.com/devbox" rel="nofollow">Devbox</a> to ensure a consistent development environment without relying on Docker.</p>
<p dir="auto">To start developing BemiDB and run tests, follow these steps:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cp .env.sample .env
make install
make test"><pre>cp .env.sample .env
make install
make <span>test</span></pre></div>
<p dir="auto">To run BemiDB locally, use the following command:</p>

<p dir="auto">To sync data from a Postgres database, use the following command:</p>


<ul dir="auto">
<li>PostgreSQL
<ul dir="auto">
<li>The most loved general-purpose transactional (OLTP) database. Can run analytical queries at small scale.</li>
<li>Slow for analytical (OLAP) queries on medium and large datasets. Requires manual tuning and indexing.</li>
</ul>
</li>
<li>PostgreSQL + foreign data wrapper extensions (parquet_fdw, parquet_s3_fdw, etc.)
<ul dir="auto">
<li>Allow querying external data sources like columnar Parquet files directly from PostgreSQL.</li>
<li>Not optimized query engine. Requires manual data syncing and schema mapping. Extensions may not be supported by PostgreSQL hosting providers.</li>
</ul>
</li>
<li>PostgreSQL + OLAP query engine extensions (pg_duckdb, pg_analytics, etc.)
<ul dir="auto">
<li>Integrate an analytical query engine directly into PostgreSQL.</li>
<li>Cumbersome to set up and use (creating foreign tables, secrets management, calling custom functions). PostgreSQL data is not integrated and optimized. Extensions may not be supported by PostgreSQL hosting providers.</li>
</ul>
</li>
<li>DuckDB
<ul dir="auto">
<li>Designed for OLAP use cases. Easy to run with a single binary.</li>
<li>Limited support in the data ecosystem (notebooks, BI tools, etc.). Requires manual data syncing and schema mapping for best performance.</li>
</ul>
</li>
<li>Real-time and high-volume databases (ClickHouse, Druid, etc.)
<ul dir="auto">
<li>High-performance OLAP databases optimized for real-time analytics.</li>
<li>Require expertise to set up and manage distributed systems. Limitations on data mutability. Steeper learning curve. Require manual data syncing and schema mapping.</li>
</ul>
</li>
<li>Big data query engines (Spark, Trino, etc.)
<ul dir="auto">
<li>Distributed SQL query engines for big data analytics.</li>
<li>Complex to set up and manage a distributed query engine (ZooKeeper, JVM, etc.). Don&#39;t have a storage layer themselves. Require manual data syncing and schema mapping.</li>
</ul>
</li>
<li>Proprietary solutions (Snowflake, AWS Redshift, GCP BigQuery, Databricks, etc.)
<ul dir="auto">
<li>Fully managed cloud data warehouses and lakehouses optimized for OLAP.</li>
<li>Can be expensive compared to other alternatives. Vendor lock-in, proprietary solutions. Require separate systems for data syncing and schema mapping.</li>
</ul>
</li>
</ul>

<p dir="auto">Distributed under the terms of the <a href="https://github.com/BemiHQ/BemiDB/blob/main/LICENSE">AGPL-3.0 License</a>. If you need to modify and distribute the code, please release it to contribute back to the open-source community.</p>
</article></div></div>
  </body>
</html>
