<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lfi.dev/">Original</a>
    <h1>Show HN: Lfi â€“ a lazy functional sync, async, and concurrent iteration library</h1>
    
    <div id="readability-page-1" class="page"><div id="__docusaurus"><nav aria-label="Main"></nav><div id="__docusaurus_skipToContent_fallback"><div><header><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 793 793"><defs><clipPath id="clippath"><circle cx="396.75" cy="396.75" r="396.25"></circle></clipPath></defs><circle cx="396.75" cy="396.75" r="396.25"></circle><path d="M50.19 407.93c-8.65-8.65-16.86-18.26-21.28-29.26-5.26 7.5-4.37 18.79-.22 28.61s11.15 18.55 18.04 27.05c2.66 3.28 5.88 7.09 9.97 8.19 3.84 1.03 7.8-.98 10.28-3.22 2.08-1.88 3.48-4.56 3.22-7.72-.3-3.68-2.69-6.8-5.42-9.5-4.81-4.77-9.8-9.36-14.59-14.15m-14.21 19.16c-8.35-7.62-16.42-16.08-21.35-25.78-3.8 6.62-1.9 16.57 2.68 25.23s11.5 16.34 18.32 23.84c2.63 2.89 5.8 6.25 9.45 7.21 3.43.91 6.65-.87 8.57-2.85 1.61-1.66 2.56-4.03 2.02-6.81-.63-3.24-3.01-6-5.64-8.37-4.64-4.2-9.42-8.25-14.04-12.47Zm-3.77 25.94c-8.18-6.74-16.16-14.29-21.29-23.21-3.14 6.5-.81 15.83 3.94 23.78 4.75 7.94 11.62 14.83 18.37 21.54 2.6 2.59 5.74 5.59 9.18 6.29 3.23.66 6.12-1.22 7.78-3.21 1.4-1.67 2.14-3.97 1.48-6.58-.77-3.04-3.14-5.51-5.72-7.62-4.55-3.71-9.21-7.27-13.74-11.01Z"></path><path d="M344.53 433.55c-16.19 4.42-32.39 8.85-48.58 13.27-14.11 3.85-28.28 7.72-42.78 9.67-42.7 5.75-86.47-.25-124.59-20.34-14.62-7.71-24.79-15.45-40.73-19.8s-31.94-5.78-44.17 5.34c-27.18 24.73-10.7 64.04 11.17 85.75 34.88 34.61 82.48 51 130.35 56.39 39.42 4.44 79.33 1.76 118.63-3.63"></path><g style="clip-path:url(#clippath)"><path d="M680 679c-13.94-60.87-32.54-136.15-46.48-197.02-6.48-28.29-13-57.36-8.95-86.1 3.19-22.64 12.79-43.81 22.27-64.61 9.63-21.12 21.36-41.4 28.88-63.35 9.08-26.48 13.67-56.79 2.48-84.4-10.64-26.28-39.86-40.31-36.96-65.65-5.55 4.1-10.57 3.04-18.07 3.4-.2-3.86-3.06-9.05-3.26-12.91-4.79 1.55-12.1 2.98-17.03 5.98-4.37-3-5.69-6.98-6.61-11.71-12.36 12.69-50.82-1.37-90.95 1.05-60.79 3.67-94.44 39.67-116.33 85.35-21.9 45.69-26.19 97.53-30.13 148.03-2.24 28.71-18.77 55.9-28.18 83.11-8.98 25.98-17.97 51.99-24.85 78.6-19.18 74.26-19.51 152.47-6.63 228.08 5.79 34.01 16.01 47.49 24.25 59.35 10.22 1.91 28.03 9.09 38.55 9.77 139 9 237.43-29.86 318-117Z" style="fill:#916e4c"></path></g><path d="M227.77 635.58c-10.12.21-18.91-.59-27.98-4.58 1.42 8.06 8.62 14.5 16.85 17.92 8.22 3.42 13.31 4.67 22.33 5.5 3.48.32 7.6.61 10.61-1.34 2.83-1.84 3.91-5.64 4.02-8.64.08-2.51-.7-5.08-2.72-6.88-2.35-2.09-5.59-2.49-8.76-2.41-5.61.14-8.73.3-14.34.42Z"></path><path d="M227.44 656.42c-10.07 1.03-19.64 1.21-29.03-1.57 2.1 7.04 9.84 12.16 18.33 14.51s11.52 3.1 20.59 3.09c3.5 0 7.63-.09 10.46-2.08 2.66-1.87 3.42-5.34 3.26-8.01-.13-2.23-1.13-4.46-3.3-5.88-2.53-1.66-5.78-1.74-8.94-1.41-5.58.6-5.79.77-11.37 1.35m5.35 19.55c-9.41 1.32-17.45 1.79-26.4-.49 2.31 6.53 9.82 11.06 17.91 12.97s11.44 2.13 19.96 1.8c3.28-.13 7.16-.35 9.73-2.32 2.41-1.85 2.96-5.13 2.69-7.63-.23-2.09-1.28-4.14-3.38-5.4-2.45-1.47-5.52-1.43-8.47-1-5.21.76-6.82 1.35-12.04 2.08Z"></path><path d="M572.51 457.94c-11.63-11.21-29.69-13.73-45.39-9.86s-29.45 13.21-42.07 23.3a333.6 333.6 0 0 0-39.3 36.98c-11.3 12.51-21.66 25.86-33.35 38.01-33.73 35.02-78.56 59.23-126.38 68.22-10.48 1.97-21.2 3.26-31.09 7.23-11.88 4.77-22.02 13.8-23.79 26.99-.95 7.06.28 14.26 2.42 21.05 2.18 6.94 9.27 15.03 15.31 19.09 17.87 12.01 36.86 11.55 55.4 11.78 48.19.61 93.98-17.41 135.64-40.16 41.97-22.92 83.37-48.9 119.11-80.78 18.95-16.9 28.61-43.13 30.43-68.44 1.28-17.79-4.1-41.02-16.95-53.41Z"></path><path d="M631.82 207.59c10.51 20.58 7.37 41.31-1.26 58.08-15.75 30.59-31.97 58.74-60.11 78.54-28.14 19.79-63.29 30.69-97.39 26.1-18.4-2.47-36.44-9.54-50.4-21.79-23.07-20.25-32.65-52.95-30-83.53 1.73-19.95 7.99-39.33 16.8-57.24 6.25-12.7 12.89-25.47 22.01-36.38 4.49-5.38 9.78-9.4 14.97-13.96 7.04-6.17 14.14-11.33 23.45-13.01 8.84-1.59 18.65-1.24 26.22 4.15 4.85 3.46 8.55 8.38 12.71 12.58 4.53 4.58 9.39 8.83 14.52 12.73 9.53 7.23 18.7 7.8 30.24 9 10.38 1.08 20.72 1.04 31.13.49 10.55-.56 35.34 1.25 47.11 24.26Z"></path><path d="M559.36 232.1c-15.26-5.27-27.19.11-35.07 6.76s-11.39 20.4-8.21 30.21c2.18 6.72 7.61 11.8 13.04 16.33 9.64 8.04 19.97 15.35 28.54 24.53 8.27 8.87 14.9 19.9 15.95 31.94 13.32-9.99 23.91-21.91 33.07-35.09-2.5-13.3-7-21.77-13.12-33.86-8.15-16.08-17.16-34.92-34.2-40.81Zm-148.44 35.87c4.53-1.78 9.24-3.09 13.99-4.11 13.24-2.85 26.58-5.09 39.5-9.16 25.27-7.96 29.25-33.18 18.49-44.69-9.13-9.77-24.76-9.61-36.79-7.45-9.53 1.71-15.95 5.8-22.2 9.08-10.35 5.44-21.74 16-23.44 17.6-3.99 11.56-6.74 23.54-7.8 35.74-.38 4.34-.5 8.72-.38 13.1 1.6-1.13 4.58-3.23 5.85-4.11 3.55-2.48 8.77-4.43 12.79-6.01Z"></path><path d="M472.03 263.96c-4.31-.34-8.93.15-12.41 2.72-4.49 3.32-6.11 9.67-4.66 15.06s5.53 9.81 10.34 12.65c5.08 3 10.81 4.63 16.61 5.56 2.95.47 5.92.93 8.91 1.01 8.16.22 12.38-4.72 13.35-7.58 1.26-3.67 1.27-7.83.03-11.51-2-5.94-7.11-9.66-12.61-12.15-6.08-2.76-12.88-5.24-19.56-5.76" style="fill:#56524e"></path><path d="M495.72 348.38c-12.11 0-18.38-3.8-24.21-8.05a3.324 3.324 0 0 1-.73-4.64c1.08-1.48 3.16-.48 4.64.6 4.48 3.27 10.08 6 23 5.38 11.15-.54 18.97-5.77 21.15-10.09.83-1.64 2.82-2.3 4.46-1.47 1.64.82.97 2.82.14 4.46-3.12 6.2-11.44 13.06-25.43 13.73-1.04.05-2.05.07-3.01.07Zm44.78-102.75c-2.32 1.38-3.94 3.68-5.23 6.05a39 39 0 0 0-3.07 7.32c-.89 2.92-1.32 6.39.59 8.78 2.14 2.67 6.45 2.64 9.34.81s4.65-4.98 6.13-8.06c1.11-2.32 2.13-4.73 2.41-7.28.26-2.39-.26-4.76-1.55-6.79-.93-1.46-3.02-1.96-4.64-1.94-1.39.01-2.78.42-3.97 1.12Zm-67.52-22.97c.36 2.68-.44 5.38-1.5 7.86a38.6 38.6 0 0 1-3.83 6.95c-1.74 2.51-4.19 5.01-7.24 4.99-3.42-.02-6.08-3.42-6.43-6.82s1.01-6.74 2.52-9.81c1.13-2.31 2.38-4.61 4.21-6.41 1.71-1.69 3.89-2.75 6.29-3 1.72-.18 3.41 1.15 4.41 2.43.85 1.1 1.4 2.43 1.58 3.81Z"></path><path d="M314.43 198.48a5.4 5.4 0 0 1-3.61 2.77c-5.51 1.22-19.76 2.53-41.04-8.58-18.29-9.55-26.31-22.58-29.03-28.07-.77-1.55-.76-3.36.04-4.89l42.64-81.95 73.78 38.5-42.78 82.21Z"></path><path d="M346.28 120.07c-8.2 0-20.09-3.75-32.62-10.29-15.56-8.12-27.09-18.13-29.38-25.5-.58-1.88-.52-3.5.18-4.83.48-.9 2.2-1.42 4.71-1.42 7.65 0 21.42 4.6 35.07 11.73 18.52 9.67 29.74 19.87 31.25 24.95.22.75.22 1.33-.01 1.74-1.68 2.99-5.93 3.62-9.19 3.62Z" style="fill:#b76009"></path><path d="M289.17 79.6c7.42 0 20.9 4.53 34.34 11.55 23.9 12.48 30.8 22.82 30.57 24.57-1.33 2.29-4.97 2.78-7.8 2.78-7.96 0-19.58-3.69-31.9-10.11-14.97-7.81-26.46-17.69-28.61-24.57-.46-1.48-.44-2.67.04-3.59 0 0 .65-.62 3.35-.62m.01-3.15c-3.14 0-5.29.73-6.1 2.26-4.21 7.95 9.49 21.82 29.86 32.45 12.71 6.63 24.89 10.47 33.35 10.47 5.1 0 8.86-1.4 10.56-4.42 2.94-5.21-11.5-18.22-31.88-28.86-14.47-7.55-28.1-11.91-35.8-11.91Zm-45.42 77.2s-35.48-9.62-15.67-47.59c19.82-37.97 48.79-14.65 48.79-14.65-2.51 4.72-4.99 10.14-7.64 14.79-1.5-.31-2.35-1.91-2.61-3.36s-.16-2.97-.82-4.32c-1.62-3.32-6.49-3.82-9.7-3.57-6.81.54-10.92 5.4-14.61 10.29-4.07 5.4-7.53 11.62-8.61 18.39-.66 4.14-.22 8.55 1.68 12.46 1.61 3.3 5.01 6.95 9.08 6.52 2.2-.23 4.69-1.44 6.87-.17l-6.76 11.2Z"></path><path d="M382.37 69.01c-.72.05-1.46 0-2.17.16s-.54.28-1.2.6c-1.18.56-2.36-1.16-2.35-2.47 0-1.31.75-5.26 5.5-8.56 1.13-.78 2.79-.13 4.04.44 1.83.84 2.69 2.81 2.69 4.74 0 1.71-1.89 3.29-3.24 4.06-1 .57-2.12.94-3.27 1.02ZM286 84c12 0 21 7 31.64 6.09 3.59-.31 6.49-3.48 10.04-4.04 4.05-.64 8.29 1.11 12.25-.03 3.16-.91 5.34-3.94 8.01-6.01 6.14-4.78 10.23.27 14.68-2.73 1.07-.72 3.74-1.87 4.83-2.53s3.44-.96 4.44-.1c.71.61 1.04 1.64 1.2 2.62.56 3.39-.42 7.02-2.54 9.46-1.93 2.22-4.66 3.41-6.58 5.63-1.88 2.17-1.25 3.82-2.68 6.39-2.09 3.77-4.36 4.87-6.16 8.83-2.31 5.08.87 7.44-2.13 9.44-7.16 4.77-23.26.04-31-4-23-12-34.89-22.82-36-29Zm97.95-.75c-.42-.36-.78-.77-1.25-1.06s-.44-.14-.96-.31c-.93-.32-.65-1.87.04-2.57s3.19-2.42 7.48-1.68c1.02.18 1.57 1.41 1.93 2.37.53 1.42-.05 2.93-1.07 3.96-.9.91-2.75.76-3.89.46-.84-.22-1.63-.62-2.29-1.18Z" style="fill:#563d24"></path><path d="M364.98 479.59c1.11 9.59-23.69 57.66-37.83 75.2-10.39 12.89-53.11-6.8-51.65-26.81 1.6-21.87 20.49-63.93 45.03-69.27 19.42-4.22 43.18 9.96 44.44 20.88Z"></path><path d="M364.98 479.59c1.11 9.59-23.69 57.66-37.83 75.2-3.42 4.24-10.34 4.96-18.03 3.29 0 0 10.17-1.89 24.44-24.98 16.76-27.13 31.42-53.51 31.42-53.51m-45.06 4.59c.11 1.91 3.78 4.31 6.62 3.22 2.11-.81 1.3-2.04 2.88-4.22 2.53-3.5 3.8-2.41 4.27-4.48s-4.66-5.04-7.28-3.94c-1.81.75-6.77 4.28-6.48 9.43Z"></path><path d="M364.98 479.59c-.7-6.06-8.34-13.12-18.32-17.49-4.49 3.18-21.7 16.26-31.47 36.17l-1.18-.58c9.47-19.3 25.82-32.26 31.23-36.19-7.68-3.1-16.57-4.56-24.7-2.8-24.55 5.33-43.44 47.4-45.03 69.27-1.46 20.01 41.25 39.7 51.65 26.81 14.14-17.53 38.94-65.61 37.83-75.2Z"></path><path d="M315.19 498.28c9.77-19.91 26.98-32.99 31.47-36.17-.47-.2-.94-.4-1.42-.59-5.41 3.93-21.76 16.89-31.23 36.19l1.18.58Z"></path><path d="m32.97 363.99 78.63-31.55c.26-.1.21-.54-.06-.6l-5.6-1.28c-.89-.2-1.81-.14-2.64.2l-72.59 28.83c-2.61 1.04-4.36 4.4-3.38 7.47l13.08 36.71c.03.08.09.15.16.18l.47.21c-.22 0-.34.28-.2.49l36.51 54.31c.81 1.2 1.95 2.07 3.22 2.45l6.1 1.81c.25.07.43-.25.26-.49l-39.52-55.86s-.03-.06-.04-.09l-14.54-42.41c-.06-.16.01-.34.15-.39Z" style="fill:gray"></path><path d="m32.5 369.06 12.24 33.7c.19.51.43.99.73 1.43l38.77 56.47c2.09 3.04 5.58 4.28 8.65 3.08l73.26-28.87c3.15-1.24 4.17-5.71 2.01-8.82l-38.2-55.17a6.2 6.2 0 0 1-.7-1.33l-13.13-34.01c-1.1-2.85-3.93-4.33-6.42-3.34l-74.46 29.49c-2.6 1.03-3.84 4.36-2.75 7.37"></path><path d="m43.42 372.79 6.15 16.96c.74 2.03 2.73 3.09 4.48 2.4l60.75-23.47c1.79-.71 2.64-3 1.9-5.08l-6.23-17.33c-.73-2.04-2.74-3.11-4.5-2.4L45.3 367.71c-1.78.72-2.63 3.01-1.88 5.08" style="fill:#b3bca6"></path><path d="m54.87 402.82 14.04-5.61 6.81 9.88-14.12 5.49zm18.59-7.56 14.04-5.6 6.81 9.87-14.12 5.49zm18.47-7.58 14.04-5.6 6.81 9.87-14.12 5.49zm18.47-7.58 14.04-5.6 6.81 9.87-14.13 5.49zm-45.9 36.68 14.04-5.6 6.81 9.87-14.12 5.49zm18.59-7.55 14.04-5.61 6.81 9.88-14.13 5.49zm18.47-7.58 14.04-5.61 6.81 9.88-14.13 5.49zm18.46-7.58 14.04-5.61 6.81 9.88-14.12 5.49zm-45.7 36.98 14.04-5.61 6.81 9.88-14.13 5.49zm18.59-7.56 14.04-5.6 6.81 9.87-14.13 5.49zm18.46-7.58 14.04-5.6 6.81 9.87-14.12 5.49zm-27.43 29.11 32.6-12.7 6.81 9.88-32.68 12.57zM121 429.88l14.04-5.61 6.81 9.88-14.12 5.49z"></path><path d="m129.84 408.79 14.04-5.6 16.44 23.38-14.13 5.49z"></path></svg></header><main><section><div><h3>ðŸ”€ Concurrent iteration</h3><p><code>lfi</code>â€™s<!-- --> <a href="https://mclare.blog/docs/concepts/concurrent-iterable">concurrent iterables</a> <!-- -->offer superior performance over<!-- --> <a href="https://github.com/sindresorhus/p-map" target="_blank" rel="noopener noreferrer"><code>p-map</code></a>,<!-- --> <a href="https://github.com/sindresorhus/p-filter" target="_blank" rel="noopener noreferrer"><code>p-filter</code></a>, and others, because each item flows through the operations independently of other items.</p><div><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span> asConcur</span><span>,</span><span> filterConcur</span><span>,</span><span> mapConcur</span><span>,</span><span> pipe</span><span>,</span><span> reduceConcur</span><span>,</span><span> toArray </span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;lfi&#39;</span><span></span><br/></span><span><span></span><span>import</span><span> </span><span>pFilter</span><span> </span><span>from</span><span> </span><span>&#39;p-filter&#39;</span><span></span><br/></span><span><span></span><span>import</span><span> </span><span>pMap</span><span> </span><span>from</span><span> </span><span>&#39;p-map&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span>const</span><span> mapDelays </span><span>=</span><span> </span><span>[</span><span>5</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>]</span><span></span><br/></span><span><span></span><span>const</span><span> filterDelays </span><span>=</span><span> </span><span>[</span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>5</span><span>]</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>delay</span><span> </span><span>=</span><span> </span><span>ms</span><span> </span><span>=&gt;</span><span></span><br/></span><span><span>  </span><span>new</span><span> </span><span>Promise</span><span>(</span><span>resolve</span><span> </span><span>=&gt;</span><span> </span><span>setTimeout</span><span>(</span><span>resolve</span><span>,</span><span> ms</span><span>)</span><span>)</span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>mapFn</span><span> </span><span>=</span><span> </span><span>i</span><span> </span><span>=&gt;</span><span></span><br/></span><span><span>  </span><span>delay</span><span>(</span><span>mapDelays</span><span>[</span><span>i</span><span>]</span><span> </span><span>*</span><span> </span><span>1000</span><span>)</span><span>.</span><span>then</span><span>(</span><span>(</span><span>)</span><span> </span><span>=&gt;</span><span> i</span><span>)</span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>filterFn</span><span> </span><span>=</span><span> </span><span>i</span><span> </span><span>=&gt;</span><span></span><br/></span><span><span>  </span><span>delay</span><span>(</span><span>filterDelays</span><span>[</span><span>i</span><span>]</span><span> </span><span>*</span><span> </span><span>1000</span><span>)</span><span>.</span><span>then</span><span>(</span><span>(</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>true</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>time</span><span>(</span><span>`</span><span>with lfi</span><span>`</span><span>)</span><span></span><br/></span><span><span></span><span>const</span><span> withLfi </span><span>=</span><span> </span><span>await</span><span> </span><span>pipe</span><span>(</span><span></span><br/></span><span><span>  </span><span>asConcur</span><span>(</span><span>[</span><span>0</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span><span>]</span><span>)</span><span>,</span><span></span><br/></span><span><span>  </span><span>mapConcur</span><span>(</span><span>mapFn</span><span>)</span><span>,</span><span></span><br/></span><span><span>  </span><span>filterConcur</span><span>(</span><span>filterFn</span><span>)</span><span>,</span><span></span><br/></span><span><span>  </span><span>reduceConcur</span><span>(</span><span>toArray</span><span>(</span><span>)</span><span>)</span><span>,</span><span></span><br/></span><span><span></span><span>)</span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>timeEnd</span><span>(</span><span>`</span><span>with lfi</span><span>`</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>time</span><span>(</span><span>`</span><span>without lfi</span><span>`</span><span>)</span><span></span><br/></span><span><span></span><span>const</span><span> withoutLfi </span><span>=</span><span> </span><span>await</span><span> </span><span>pFilter</span><span>(</span><span></span><br/></span><span><span>  </span><span>await</span><span> </span><span>pMap</span><span>(</span><span>[</span><span>0</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span><span>]</span><span>,</span><span> mapFn</span><span>)</span><span>,</span><span></span><br/></span><span><span>  filterFn</span><span>,</span><span></span><br/></span><span><span></span><span>)</span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>timeEnd</span><span>(</span><span>`</span><span>without lfi</span><span>`</span><span>)</span><br/></span></code></pre></div></div><a href="https://mclare.blog/playground#aW1wb3J0IHsgYXNDb25jdXIsIGZpbHRlckNvbmN1ciwgbWFwQ29uY3VyLCBwaXBlLCByZWR1Y2VDb25jdXIsIHRvQXJyYXkgfSBmcm9tICdsZmknCmltcG9ydCBwRmlsdGVyIGZyb20gJ3AtZmlsdGVyJwppbXBvcnQgcE1hcCBmcm9tICdwLW1hcCcKCi8vIEh5cG90aGV0aWNhbCBkZWxheXMgZm9yIGVhY2ggaXRlbQpjb25zdCBtYXBEZWxheXMgPSBbNSwgMSwgMV0KY29uc3QgZmlsdGVyRGVsYXlzID0gWzEsIDEsIDVdCgpjb25zdCBkZWxheSA9IG1zID0+CiAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSkKY29uc3QgbWFwRm4gPSBpID0+CiAgZGVsYXkobWFwRGVsYXlzW2ldICogMTAwMCkudGhlbigoKSA9PiBpKQpjb25zdCBmaWx0ZXJGbiA9IGkgPT4KICBkZWxheShmaWx0ZXJEZWxheXNbaV0gKiAxMDAwKS50aGVuKCgpID0+IHRydWUpCgovLyBUYWtlcyA2IHNlY29uZHMhIEVhY2ggaXRlbSBmbG93cyB0aHJvdWdoIHRoZQovLyBvcGVyYXRpb25zIGluZGVwZW5kZW50bHkgb2Ygb3RoZXIgaXRlbXMKY29uc29sZS50aW1lKGB3aXRoIGxmaWApCmNvbnN0IHdpdGhMZmkgPSBhd2FpdCBwaXBlKAogIGFzQ29uY3VyKFswLCAxLCAyXSksCiAgbWFwQ29uY3VyKG1hcEZuKSwKICBmaWx0ZXJDb25jdXIoZmlsdGVyRm4pLAogIHJlZHVjZUNvbmN1cih0b0FycmF5KCkpLAopCmNvbnNvbGUudGltZUVuZChgd2l0aCBsZmlgKQoKLy8gVGFrZXMgMTAgc2Vjb25kcyEgVGhlIGZpcnN0IGl0ZW0gaXMgYSBib3R0bGVuZWNrCi8vIGJlY2F1c2UgYHAtbWFwYCB3YWl0cyBmb3IgYWxsIGNhbGxiYWNrcwpjb25zb2xlLnRpbWUoYHdpdGhvdXQgbGZpYCkKY29uc3Qgd2l0aG91dExmaSA9IGF3YWl0IHBGaWx0ZXIoCiAgYXdhaXQgcE1hcChbMCwgMSwgMl0sIG1hcEZuKSwKICBmaWx0ZXJGbiwKKQpjb25zb2xlLnRpbWVFbmQoYHdpdGhvdXQgbGZpYCk=" target="_blank">Playground <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M6.22 8.72a.75.75 0 0 0 1.06 1.06l5.22-5.22v1.69a.75.75 0 0 0 1.5 0v-3.5a.75.75 0 0 0-.75-.75h-3.5a.75.75 0 0 0 0 1.5h1.69L6.22 8.72Z"></path><path d="M3.5 6.75c0-.69.56-1.25 1.25-1.25H7A.75.75 0 0 0 7 4H4.75A2.75 2.75 0 0 0 2 6.75v4.5A2.75 2.75 0 0 0 4.75 14h4.5A2.75 2.75 0 0 0 12 11.25V9a.75.75 0 0 0-1.5 0v2.25c0 .69-.56 1.25-1.25 1.25h-4.5c-.69 0-1.25-.56-1.25-1.25v-4.5Z"></path></svg></a></div></div><div><h3>ðŸ¦¥ Lazy and memory efficient</h3><p><code>lfi</code> delays applying operations until their results are needed.</p><div><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span> filter</span><span>,</span><span> flatMap</span><span>,</span><span> map</span><span>,</span><span> pipe</span><span>,</span><span> reduce</span><span>,</span><span> toSet </span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;lfi&#39;</span><span></span><br/></span><span><span></span><span>import</span><span> </span><span>zoo</span><span> </span><span>from</span><span> </span><span>&#39;lfi:zoo&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>getSlothNamesWithLfi</span><span> </span><span>=</span><span> </span><span>(</span><span>)</span><span> </span><span>=&gt;</span><span></span><br/></span><span><span>  </span><span>pipe</span><span>(</span><span></span><br/></span><span><span>    zoo</span><span>.</span><span>exhibits</span><span>,</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>flatMap</span><span>(</span><span>exhibit</span><span> </span><span>=&gt;</span><span> exhibit</span><span>.</span><span>animals</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>filter</span><span>(</span><span>animal</span><span> </span><span>=&gt;</span><span> animal</span><span>.</span><span>species</span><span> </span><span>===</span><span> </span><span>`</span><span>sloth</span><span>`</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>map</span><span>(</span><span>sloth</span><span> </span><span>=&gt;</span><span> sloth</span><span>.</span><span>name</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>reduce</span><span>(</span><span>toSet</span><span>(</span><span>)</span><span>)</span><span>,</span><span></span><br/></span><span><span>  </span><span>)</span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>log</span><span>(</span><span>getSlothNamesWithLfi</span><span>(</span><span>)</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>getSlothNamesWithoutLfi</span><span> </span><span>=</span><span> </span><span>(</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span><br/></span><span><span>  </span><span>const</span><span> slothNames </span><span>=</span><span> zoo</span><span>.</span><span>exhibits</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>.</span><span>flatMap</span><span>(</span><span>exhibit</span><span> </span><span>=&gt;</span><span> exhibit</span><span>.</span><span>animals</span><span>)</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>.</span><span>filter</span><span>(</span><span>animal</span><span> </span><span>=&gt;</span><span> animal</span><span>.</span><span>species</span><span> </span><span>===</span><span> </span><span>`</span><span>sloth</span><span>`</span><span>)</span><span></span><br/></span><span><span>    </span><span></span><br/></span><span><span>    </span><span>.</span><span>map</span><span>(</span><span>sloth</span><span> </span><span>=&gt;</span><span> sloth</span><span>.</span><span>name</span><span>)</span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>return</span><span> </span><span>new</span><span> </span><span>Set</span><span>(</span><span>slothNames</span><span>)</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>log</span><span>(</span><span>getSlothNamesWithoutLfi</span><span>(</span><span>)</span><span>)</span><br/></span></code></pre></div></div><a href="https://mclare.blog/playground#aW1wb3J0IHsgZmlsdGVyLCBmbGF0TWFwLCBtYXAsIHBpcGUsIHJlZHVjZSwgdG9TZXQgfSBmcm9tICdsZmknCmltcG9ydCB6b28gZnJvbSAnbGZpOnpvbycKCmNvbnN0IGdldFNsb3RoTmFtZXNXaXRoTGZpID0gKCkgPT4KICBwaXBlKAogICAgem9vLmV4aGliaXRzLAogICAgLy8gTm8gYXJyYXlzIGNyZWF0ZWQgYW55d2hlcmUgaGVyZQogICAgZmxhdE1hcChleGhpYml0ID0+IGV4aGliaXQuYW5pbWFscyksCiAgICBmaWx0ZXIoYW5pbWFsID0+IGFuaW1hbC5zcGVjaWVzID09PSBgc2xvdGhgKSwKICAgIG1hcChzbG90aCA9PiBzbG90aC5uYW1lKSwKICAgIC8vIEFuZCB0aGVuIGEgc2V0IGlzIGNyZWF0ZWQgaGVyZQogICAgcmVkdWNlKHRvU2V0KCkpLAogICkKY29uc29sZS5sb2coZ2V0U2xvdGhOYW1lc1dpdGhMZmkoKSkKCmNvbnN0IGdldFNsb3RoTmFtZXNXaXRob3V0TGZpID0gKCkgPT4gewogIGNvbnN0IHNsb3RoTmFtZXMgPSB6b28uZXhoaWJpdHMKICAgIC8vIEFuIGFycmF5IGlzIGNyZWF0ZWQgaGVyZS4uLgogICAgLmZsYXRNYXAoZXhoaWJpdCA9PiBleGhpYml0LmFuaW1hbHMpCiAgICAvLyBBbmQgaGVyZS4uLgogICAgLmZpbHRlcihhbmltYWwgPT4gYW5pbWFsLnNwZWNpZXMgPT09IGBzbG90aGApCiAgICAvLyBBbmQgaGVyZS4uLgogICAgLm1hcChzbG90aCA9PiBzbG90aC5uYW1lKQogIC8vIEFuZCB0aGVuIGEgc2V0IGlzIGNyZWF0ZWQgaGVyZQogIHJldHVybiBuZXcgU2V0KHNsb3RoTmFtZXMpCn0KY29uc29sZS5sb2coZ2V0U2xvdGhOYW1lc1dpdGhvdXRMZmkoKSk=" target="_blank">Playground <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M6.22 8.72a.75.75 0 0 0 1.06 1.06l5.22-5.22v1.69a.75.75 0 0 0 1.5 0v-3.5a.75.75 0 0 0-.75-.75h-3.5a.75.75 0 0 0 0 1.5h1.69L6.22 8.72Z"></path><path d="M3.5 6.75c0-.69.56-1.25 1.25-1.25H7A.75.75 0 0 0 7 4H4.75A2.75 2.75 0 0 0 2 6.75v4.5A2.75 2.75 0 0 0 4.75 14h4.5A2.75 2.75 0 0 0 12 11.25V9a.75.75 0 0 0-1.5 0v2.25c0 .69-.56 1.25-1.25 1.25h-4.5c-.69 0-1.25-.56-1.25-1.25v-4.5Z"></path></svg></a></div></div><div><h3>ðŸŒ³ Small and tree shakeable</h3><p><code>lfi</code> is just<!-- --> <a href="https://bundlejs.com/?text=export%20*%20from%20%27lfi%27&amp;bundle" target="_blank" rel="noopener noreferrer">5.71 kB gzipped</a>, or even smaller when<!-- --> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Tree_shaking" target="_blank" rel="noopener noreferrer">tree shaking</a>.</p><p><code>lfi</code>â€™s functions are automatically<!-- --> <a href="https://mclare.blog/docs/concepts/currying">curried</a> <!-- -->and their parameters are perfectly arranged for use in the<!-- --> <code>pipe</code> function, which provides a syntax similar to<!-- --> <a href="https://en.wikipedia.org/wiki/Method_chaining" target="_blank" rel="noopener noreferrer">method chaining</a> <!-- -->without giving up tree shaking.</p><p>The result? The functions imported in the code below bundle to just<!-- --> <a href="https://bundlejs.com/?text=export%20{%20filter,%20flatMap,%20map,%20pipe,%20reduce,%20toGrouped,%20toMap,%20toSet%20}%20from%20%27lfi%27&amp;bundle" target="_blank" rel="noopener noreferrer">790 B gzipped</a>!</p><div><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span> filter</span><span>,</span><span> flatMap</span><span>,</span><span> map</span><span>,</span><span> pipe</span><span>,</span><span> reduce</span><span>,</span><span> toGrouped</span><span>,</span><span> toMap</span><span>,</span><span> toSet </span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;lfi&#39;</span><span></span><br/></span><span><span></span><span>import</span><span> </span><span>zoo</span><span> </span><span>from</span><span> </span><span>&#39;lfi:zoo&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>const</span><span> </span><span>getSlothNamesByAge</span><span> </span><span>=</span><span> </span><span>(</span><span>)</span><span> </span><span>=&gt;</span><span></span><br/></span><span><span>  </span><span>pipe</span><span>(</span><span></span><br/></span><span><span>    zoo</span><span>.</span><span>exhibits</span><span>,</span><span></span><br/></span><span><span>    </span><span>flatMap</span><span>(</span><span>exhibit</span><span> </span><span>=&gt;</span><span> exhibit</span><span>.</span><span>animals</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>filter</span><span>(</span><span>animal</span><span> </span><span>=&gt;</span><span> animal</span><span>.</span><span>species</span><span> </span><span>===</span><span> </span><span>`</span><span>sloth</span><span>`</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>map</span><span>(</span><span>sloth</span><span> </span><span>=&gt;</span><span> </span><span>[</span><span>sloth</span><span>.</span><span>age</span><span>,</span><span> sloth</span><span>.</span><span>name</span><span>]</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>reduce</span><span>(</span><span>toGrouped</span><span>(</span><span>toSet</span><span>(</span><span>)</span><span>,</span><span> </span><span>toMap</span><span>(</span><span>)</span><span>)</span><span>)</span><span>,</span><span></span><br/></span><span><span>  </span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>console</span><span>.</span><span>log</span><span>(</span><span>getSlothNamesByAge</span><span>(</span><span>)</span><span>)</span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><br/></span></code></pre></div></div><a href="https://mclare.blog/playground#aW1wb3J0IHsgZmlsdGVyLCBmbGF0TWFwLCBtYXAsIHBpcGUsIHJlZHVjZSwgdG9Hcm91cGVkLCB0b01hcCwgdG9TZXQgfSBmcm9tICdsZmknCmltcG9ydCB6b28gZnJvbSAnbGZpOnpvbycKCmNvbnN0IGdldFNsb3RoTmFtZXNCeUFnZSA9ICgpID0+CiAgcGlwZSgKICAgIHpvby5leGhpYml0cywKICAgIGZsYXRNYXAoZXhoaWJpdCA9PiBleGhpYml0LmFuaW1hbHMpLAogICAgZmlsdGVyKGFuaW1hbCA9PiBhbmltYWwuc3BlY2llcyA9PT0gYHNsb3RoYCksCiAgICBtYXAoc2xvdGggPT4gW3Nsb3RoLmFnZSwgc2xvdGgubmFtZV0pLAogICAgcmVkdWNlKHRvR3JvdXBlZCh0b1NldCgpLCB0b01hcCgpKSksCiAgKQoKY29uc29sZS5sb2coZ2V0U2xvdGhOYW1lc0J5QWdlKCkpCi8vPT4gTWFwKDMpIHsKLy89PiAgIDcgPT4gU2V0KDIpIHsKLy89PiAgICAgJ3N0cmF3YmVycnknLAovLz0+ICAgICAnYml0c3knCi8vPT4gICB9LAovLz0+ICAgMTkgPT4gU2V0KDEpIHsKLy89PiAgICAgJ21heCcKLy89PiAgIH0sCi8vPT4gICAyNCA9PiBTZXQoMSkgewovLz0+ICAgICAndG9tbXknCi8vPT4gICB9Ci8vPT4gfQ==" target="_blank">Playground <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M6.22 8.72a.75.75 0 0 0 1.06 1.06l5.22-5.22v1.69a.75.75 0 0 0 1.5 0v-3.5a.75.75 0 0 0-.75-.75h-3.5a.75.75 0 0 0 0 1.5h1.69L6.22 8.72Z"></path><path d="M3.5 6.75c0-.69.56-1.25 1.25-1.25H7A.75.75 0 0 0 7 4H4.75A2.75 2.75 0 0 0 2 6.75v4.5A2.75 2.75 0 0 0 4.75 14h4.5A2.75 2.75 0 0 0 12 11.25V9a.75.75 0 0 0-1.5 0v2.25c0 .69-.56 1.25-1.25 1.25h-4.5c-.69 0-1.25-.56-1.25-1.25v-4.5Z"></path></svg></a></div></div></section></main></div></div></div></div>
  </body>
</html>
