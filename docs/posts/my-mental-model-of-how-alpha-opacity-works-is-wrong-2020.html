<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://coolbutuseless.github.io/2020/02/14/my-mental-model-of-how-alpha-works-is-wrong/">Original</a>
    <h1>My mental model of how alpha opacity works is wrong (2020)</h1>
    
    <div id="readability-page-1" class="page"><div>
      



<div id="my-mental-model-of-alpha-when-plotting">
<h2>My mental model of alpha when plotting</h2>
<p>When plotting overlapping elements with a defined alpha (opacity), I had always
thought about it as an additive process with results clamped to not exceed 1.</p>
<p>Thus, without every bothering to check, my mental model was: three overlapping
black rectangles,
each with an opacity of 0.4, would result in a black rectangle since their combined
opacity is 1.2, and this is clamped the maximum possible value of 1.</p>
<p>My mental model is wrong.</p>
</div>
<div id="what-actually-happens-with-overlapping-alpha">
<h2>What actually happens with overlapping alpha</h2>
<p>In each sub-plot, I’ve plotted the overlap of a number of rectangles, each with <code>opacity</code> of 0.4.</p>
<p>The combined opacity increases with each overlap but doesn’t quite reach an opacity of 1.</p>
<pre><code>#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Simple function to create a plot with N overlapping rectangles with 
# each having an alpha of 0.4
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
stack_alpha &lt;- function(N) {
  plot_df &lt;- tibble(
    x       = seq(0.45, 0.55, length.out = N),
    y       = seq(0.45, 0.55, length.out = N), 
    opacity = 0.4
  )
  
  ggplot(plot_df) + 
    geom_tile(aes(x, y, alpha = I(opacity)), fill = &#39;black&#39;, 
              width=0.5, height = 0.5, colour = NA) + 
    theme_void() + 
    coord_equal()
}

plots &lt;- lapply(1:4, stack_alpha)

patchwork::wrap_plots(plots, ncol = 4)</code></pre>
<p><img src="https://coolbutuseless.github.io/post/2020-02-13-stacking-alpha_files/figure-html/unnamed-chunk-1-1.png" width="100%"/></p>
</div>
<div id="correcting-my-thinking">
<h2>Correcting my thinking</h2>
<p>Rather than talking about <code>opacity</code>, I should think in terms of <code>transmissivity</code>
(i.e. <code>1-opacity</code>) - and transmissivity is a <em>multiplicative</em> property.</p>
<p>So, for a sequence of N layers with a transmissivity <code>t</code>, the transmissivity of the
result is <code>t^N</code>, and thus the <code>opacity</code> is <code>(1 - t^N)</code></p>
<p>The following plots show the original 4 plots from above, and below them plots of my
estimation of the combined alpha using multiplicative transmissivity</p>
<table>
<thead>
<tr>
<th>N</th>
<th>opacity</th>
<th>transmissivity</th>
<th>cumulative transmissivity</th>
<th>cumulative alpha</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.4</td>
<td>0.6</td>
<td>0.6</td>
<td>1 - 0.6 = 0.4</td>
</tr>
<tr>
<td>2</td>
<td>0.4</td>
<td>0.6</td>
<td>0.6 * 0.6 = 0.36</td>
<td>1 - 0.36 = 0.64</td>
</tr>
<tr>
<td>3</td>
<td>0.4</td>
<td>0.6</td>
<td>0.6 * 0.6 * 0.6 = 0.216</td>
<td>1 - 0.216 = 0.784</td>
</tr>
<tr>
<td>4</td>
<td>0.4</td>
<td>0.6</td>
<td>0.6 ^ 4 = 0.1296</td>
<td>1 - 0.1296 = 0.8704</td>
</tr>
</tbody>
</table>
<pre><code>#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Manually calculate the total transmissivity for 1-4 overlapping rectangles.
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
manually_stack_alpha &lt;- function(N) {
  plot_df &lt;- tibble(
    N = N,
    x = 0.5,
    y = 0.5, 
    tranmissivity = (1 - 0.4)^N,
    opacity       = 1 - tranmissivity
  )
  
  ggplot(plot_df) + 
    geom_tile(aes(x, y, alpha = I(opacity)), fill = &#39;black&#39;, 
              width=0.5, height = 0.5, colour = NA) + 
    theme_void() + 
    coord_equal() + 
    facet_wrap(~N + opacity, labeller = label_both)
}


manual_plots &lt;- lapply(1:4, manually_stack_alpha)

patchwork::wrap_plots(c(plots, manual_plots), ncol = 4)</code></pre>
<p><img src="https://coolbutuseless.github.io/post/2020-02-13-stacking-alpha_files/figure-html/unnamed-chunk-2-1.png" width="100%"/></p>
</div>
<div id="summary">
<h2>Summary</h2>
<ul>
<li>Opacity isn’t additive.</li>
<li>Transmissivity = 1 - Opacity.</li>
<li>Transmissivity is multiplicative</li>
</ul>
</div>

    </div></div>
  </body>
</html>
