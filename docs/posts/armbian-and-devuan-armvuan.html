<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/declassed-art/armvuan">Original</a>
    <h1>Armbian and Devuan = Armvuan</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">This distro is based on two prominent projects: <a href="https://www.armbian.com" rel="nofollow">Armbian</a> and <a href="https://www.devuan.org" rel="nofollow">Devuan</a>.
It is built in the simplest way, using Devuan debootstrapped system with kernel, dtb,
u-boot, and board support packages from Armbian, thus avoiding compilation parties as much as possible.</p>
<p dir="auto">Armvuan builder uses Armbian&#39;s toolkit but it&#39;s not a part of it as it may seem.
Actually I don&#39;t know how this pet project should evolve.
Both Armbian and Devuan have their own toolchains for ARM boards and both have fatal flaws:
the former is locked to systemd-based distros, the latter has poor support for ARM boards.</p>
<p dir="auto">Pre-built images for boards I have:</p>
<ul dir="auto">
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Nanopi-r2s_daedalus_current_6.1.50.img.xz">Armbian_23.11.0-trunk_Nanopi-r2s_daedalus_current_6.1.50.img.xz</a></li>
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Nanopim4v2_daedalus_current_6.1.50.img.xz">Armbian_23.11.0-trunk_Nanopim4v2_daedalus_current_6.1.50.img.xz</a> Caveat: problems with USB</li>
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Nanopineo3_daedalus_current_6.1.50.img.xz">Armbian_23.11.0-trunk_Nanopineo3_daedalus_current_6.1.50.img.xz</a></li>
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Orangepipc_daedalus_current_6.1.53.img.xz">Armbian_23.11.0-trunk_Orangepipc_daedalus_current_6.1.53.img.xz</a></li>
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Orangepi-r1_daedalus_current_6.1.53.img.xz">Armbian_23.11.0-trunk_Orangepi-r1_daedalus_current_6.1.53.img.xz</a></li>
<li><a href="https://github.com/declassed-art/armvuan/releases/download/daedalus/Armbian_23.11.0-trunk_Orangepizero_daedalus_current_6.1.53.img.xz">Armbian_23.11.0-trunk_Orangepizero_daedalus_current_6.1.53.img.xz</a></li>
</ul>
<p dir="auto">Work in progress:</p>
<ul dir="auto">
<li>OrangePI 3</li>
</ul>
<p dir="auto">Possibly in future (these boards are <a href="https://arm-files.devuan.org/" rel="nofollow">already supported by Devuan</a>):</p>
<ul dir="auto">
<li>RaspberryPI</li>
</ul>
<p dir="auto">Targetted primarily to headless boards, this distro is very minimalistic
and does not run any configuration script at first boot.
After flashing your microSD card you need to make tweaks to <code>/etc/network/interfaces</code>
and write your SSH public key to <code>/root/.ssh/authorized_keys</code>.</p>
<h2 tabindex="-1" id="user-content-tweaks" dir="auto"><a href="#tweaks">Tweaks<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Armvuan is shipped with the following services enabled:</p>
<ul dir="auto">
<li>armbian-hardware-optimization</li>
<li>armbian-ramlog</li>
</ul>
<p dir="auto">All the rest is up to you. You can convert necessary services
from board support package located in <code>/lib/systemd/system/</code>.
Their names start from<code>armbian-</code>.</p>
<h2 tabindex="-1" id="user-content-troubleshooting-hints" dir="auto"><a href="#troubleshooting-hints">Troubleshooting hints<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">If you cannot connect to a headless board, try the following:</p>
<ol dir="auto">
<li>Reduce commit to a reasonable value, i.e. 6 in <code>/etc/fstab</code></li>
<li>Disable ramlog by unlinking <code>/etc/rcS.d/S??armbian-ramlog</code></li>
<li>Insert microSD card in and power on your board</li>
<li>Wait a couple of minutes</li>
<li>Power off, pull microSD card out and examine <code>/var/log</code></li>
</ol>
<h2 tabindex="-1" id="user-content-how-to-use-the-toolkit" dir="auto"><a href="#how-to-use-the-toolkit">How to use the toolkit<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<ul dir="auto">
<li>clone this repository with --recurse-submodules option</li>
<li>revise <code>cli-armvuan.sh</code></li>
<li>run <code>prepare.sh</code> script to patch Armbian toolchain</li>
<li>look into <code>armbian/config/boards</code> for board names</li>
<li>make an image for your board:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="sudo ./armbian/compile.sh armvuan-build BOARD=orangepi-r1 BRANCH=current RELEASE=daedalus"><pre>sudo ./armbian/compile.sh armvuan-build BOARD=orangepi-r1 BRANCH=current RELEASE=daedalus</pre></div>
<p dir="auto">Your image is here: <code>armbian/output/images</code></p>
<h2 tabindex="-1" id="user-content-problems" dir="auto"><a href="#problems">Problems<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">They broke u-boot at some point in past. My OrangePI 3 survived only because
I set up boot process to continue from USB HDD so upgrade failed to find the right boot device.</p>
<p dir="auto">in dmesg output on my OrangePI 3:</p>
<div data-snippet-clipboard-copy-content="mdio_bus stmmac-0: MDIO device at address 1 is missing.
dwmac-sun8i 5020000.ethernet end0: __stmmac_open: Cannot attach to PHY (error: -19)"><pre><code>mdio_bus stmmac-0: MDIO device at address 1 is missing.
dwmac-sun8i 5020000.ethernet end0: __stmmac_open: Cannot attach to PHY (error: -19)
</code></pre></div>
<p dir="auto">I suspect u-boot is guilty of USB problems on NanoPI M4v2.</p>
<p dir="auto">Remember, dist-upgrade is dangerous in Armbian.</p>
</article>
          </div></div>
  </body>
</html>
