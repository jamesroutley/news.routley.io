<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/cbiffle/lilos">Original</a>
    <h1>Lilos: A wee async RTOS for Cortex-M</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">(Hi! We now have a <a href="https://github.com/cbiffle/lilos/blob/main/doc/intro.adoc">intro guide!</a>)</p>
<p dir="auto">This is a wee operating system written to support the <code>async</code> style of
programming in Rust on microcontrollers. It fits in about 2 kiB of Flash and
uses about 20 bytes of RAM (before your tasks are added). In that space, you get
a full <code>async</code> runtime with multiple tasks, support for complex concurrency via
<code>join</code> and <code>select</code>, and a lot of convenient but simple APIs. (If you want to
see what a <code>lilos</code> program looks like, look in the <code>examples</code> directory, or read
the intro guide.)</p>
<p dir="auto"><code>lilos</code> has been deployed in real embedded systems since 2019, running
continuously. I&#39;ve built about a dozen systems around it of varying complexity,
on half a dozen varieties of microcontroller. It works pretty okay! Perhaps you
will find it useful too.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-repo-layout" aria-hidden="true" href="#repo-layout"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Repo layout</h2>
<p dir="auto">This repo contains crates in subdirectories, but it is <em>not</em> a Cargo workspace.
This means you will need to <code>cd</code> into subdirectories to build things. Here is a
map:</p>
<ul dir="auto">
<li><code>os</code> contains the operating system crate. The <a href="https://github.com/cbiffle/lilos/blob/main/os/README.mkdn">README in that
crate</a> gives more
background.</li>
<li><code>testsuite</code> contains a test suite for the operating system, which can run on a
Cortex-M3 or better. See <a href="https://github.com/cbiffle/lilos/blob/main/testsuite/README.mkdn">its
README</a> for
instructions.</li>
<li><code>examples</code> contains example programs for various microcontrollers.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-building" aria-hidden="true" href="#building"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Building</h2>
<p dir="auto">These instructions are mostly for building the examples or working on the
operating system itself. If you&#39;re trying to use <code>lilos</code> in a program, the usual
way is to just <code>cargo add lilos</code> to your application.</p>
<p dir="auto">To build in the repo, you will need a Rust toolchain installed through <code>rustup</code>,
because we use a <code>rustup</code>-style <code>rust-toolchain.toml</code> file to pin the toolchain
version to ensure that you get the right results. <code>rustup</code> will automatically
ensure you&#39;ve got the appropriate toolchain version available, including support
for the right target architecture for whatever program you&#39;re building.</p>
<ol dir="auto">
<li>Enter the directory you&#39;re interested in, for example, <code>cd os</code>.</li>
<li>Build: <code>cargo build</code> (or, for smaller binaries, <code>cargo build --release</code>).</li>
<li>To try an example on a microcontroller eval board, see the README in the
individual example. (In most cases <code>cargo run</code> in the directory will
suffice.)</li>
</ol>
<p dir="auto">To build everything in the repo, run <code>./build-all.sh</code>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-contact-and-license" aria-hidden="true" href="#contact-and-license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contact and License</h2>
<p dir="auto">If you have questions, or you use it for something, I&#39;d love to find out! Send
me an email.</p>
<p dir="auto">All the code in this repo is MPL-2 licensed.</p>
</article>
          </div></div>
  </body>
</html>
