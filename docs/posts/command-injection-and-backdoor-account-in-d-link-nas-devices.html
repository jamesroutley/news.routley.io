<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/netsecfish/dlink">Original</a>
    <h1>Command injection and backdoor account in D-Link NAS devices</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">

<p dir="auto">The described vulnerability affects multiple D-Link NAS devices, including models DNS-340L, DNS-320L, DNS-327L, and DNS-325, among others. The vulnerability lies within the <strong><code>nas_sharing.cgi</code></strong> uri, which is vulnerable due to two main issues: a backdoor facilitated by hardcoded credentials, and a command injection vulnerability via the <strong><code>system</code></strong> parameter. This exploitation could lead to arbitrary command execution on the affected D-Link NAS devices, granting attackers potential access to sensitive information, system configuration alteration, or denial of service, by specifying a command,affecting over 92,000 devices on the Internet.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/netsecfish/dlink/blob/main/fofa-result.png"><img src="https://github.com/netsecfish/dlink/raw/main/fofa-result.png" alt="Untitled"/></a></p>

<p dir="auto">CWE-77 (Command Injection) and CWE-798 (Use of Hard-coded Credentials).</p>

<ul dir="auto">
<li>DNS-320L Version 1.11, Version 1.03.0904.2013, Version 1.01.0702.2013</li>
<li>DNS-325 Version 1.01</li>
<li>DNS-327L Version 1.09, Version 1.00.0409.2013</li>
<li>DNS-340L Version 1.08</li>
</ul>

<p dir="auto">The vulnerability exists in the <code>nas_sharing.cgi</code> CGI script, which leads to:</p>
<ol dir="auto">
<li><strong>Backdoor through Username and Password Exposure</strong>: The request includes parameters for a username (<strong><code>user=messagebus</code></strong>) and an empty password field (<strong><code>passwd=</code></strong>). This indicates a backdoor allowing unauthorized access without proper authentication.</li>
<li><strong>Command Injection through the System Parameter</strong>: The <strong><code>system</code></strong> parameter within the request carries a base64 encoded value that, when decoded, appears to be a command.</li>
</ol>

<p dir="auto">Craft Malicious HTTP Request: Prepare an HTTP GET request targeting the <code>/cgi-bin/nas_sharing.cgi</code> endpoint.</p>
<div data-snippet-clipboard-copy-content="GET /cgi-bin/nas_sharing.cgi?user=messagebus&amp;passwd=&amp;cmd=15&amp;system=&lt;BASE64_ENCODED_COMMAND_TO_BE_EXECUTED&gt;"><pre><code>GET /cgi-bin/nas_sharing.cgi?user=messagebus&amp;passwd=&amp;cmd=15&amp;system=&lt;BASE64_ENCODED_COMMAND_TO_BE_EXECUTED&gt;
</code></pre></div>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/netsecfish/dlink/blob/main/dns-320.jpg"><img src="https://github.com/netsecfish/dlink/raw/main/dns-320.jpg" alt="Untitled"/></a></p>

<p dir="auto">Successful exploitation of this vulnerability could allow an attacker to execute arbitrary commands on the system, potentially leading to unauthorized access to sensitive information, modification of system configurations, or denial of service conditions.</p>

<ul dir="auto">
<li>Apply available patches and updates from the device manufacturer.</li>
</ul>
</article></div></div>
  </body>
</html>
