<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.bitmex.com/flashbots/">Original</a>
    <h1>Flashbots</h1>
    
    <div id="readability-page-1" class="page"><div>


<p><strong>Abstract: </strong>We examine a mining and transaction selection system on Ethereum called “Flashbots”. Flashbots is a potential mitigation against the so-called MEV problem. Over 90% of Ethereum miners subscribe to the Flashbots centralised and trusted service and we discuss the implications of this and the degree to which this contributes to Ethereum centralisation. We conclude by asserting that Flashbots may have saved Ethereum, as although it is a trusted and centralised system, the alternative could have been far worse. We go on to look at ETH 2.0 and explain why Flashbots or a similar system needs to be constructed again from scratch. A further complication for “the merge”.</p>
<figure><img loading="lazy" src="https://blog.bitmex.com/wp-content/uploads/2022/05/fb-1024x986.png" alt="" width="512" height="493" srcset="https://blog.bitmex.com/wp-content/uploads/2022/05/fb-1024x986.png 1024w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb-300x289.png 300w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb-768x739.png 768w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb-696x670.png 696w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb-1068x1028.png 1068w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb-436x420.png 436w, https://blog.bitmex.com/wp-content/uploads/2022/05/fb.png 1203w" sizes="(max-width: 512px) 100vw, 512px"/></figure>
<p><strong>Overview</strong></p>
<p>If complex activity is occurring on a blockchain, which can contain systems such as betting, decentralised exchanges or liquidation processes, additional rewards can be earned by parties exploiting these opportunities. For instance, if a user submits a market buy order to a decentralised exchange, to buy a token, there could be arbitrage opportunities. The first entity to match against this order could earn substantial rewards. This concept is similar to front running in traditional finance. In blockchain systems it is the producer of the next block who may get to decide on who can capitalise on this opportunity and therefore this privilege could yield the block producer extra financial rewards. In Ethereum lingo, the value of these rewards is called MEV (Firstly “Miner Extractible Value” and then “Maximal Extractible Value”). The entities which finds these opportunities and create the transactions which exploit them, are called searchers. In Ethereum, arbitrage is by far the most common sub-category of MEV, it probably accounts for over 98% of MEV related revenue. It is the most popular Defi trading protocol, Uniswap, which generates a majority of these MEV opportunities.</p>
<p>As Defi has become popular on Ethereum, the value of MEV has been growing and this has led to a somewhat degraded user experience and “unfair markets”. The consensus view in Ethereum appears to be that there is nothing that can be done about this aspect of the problem. This is said to be an inevitable consequence of decentralised systems and users need to accept it or modify their behaviour if they don’t like it.</p>
<p>In order to extract the MEV, block producers/searchers may be required to engage in several burdensome processes:</p>
<ol><li>They need to analyse and understand most of the Defi activity occurring</li><li>They may also need significant capital to exploit such opportunities</li></ol>
<p>Therefore, block producers and searchers require complex systems similar to those of a sophisticated trading house, like Alameda Research or Jump for example. This can therefore result in significant centralisation pressures for block producers, with smaller less sophisticated block producers being unable to compete.</p>
<p>However, even in the above scenario, the situation may not be totally devastating for Ethereum, just more centralisation pressure and some clever entities making some nice profits. In early 2021, several factors made the situation on Ethereum much worse. When searchers saw MEV strategies of other searchers in the transaction memory pool, they immediately copied them with a higher gas fee. There were scorched earth type fee races, as searchers competed with each other to win the MEV opportunity. The problem here is that fees for all other Ethereum users then rapidly increased as a result.</p>
<p>To prevent this, searchers started doing private deals with mining pools, whereby instead of broadcasting the MEV translation to the open memory pool, they would privately submit it to a mining pool, such that a fee race was avoided. These private arrangements with mining pools ensured the searchers and miners shared the benefits of MEV, without impacting wider users. The problem here is mining centralisation. It is not hard to see why such a system could result in one dominant block producer. This would then undermine all the core properties of Ethereum, as one dominant miner could censor transactions.</p>
<p><strong>Flashbots</strong></p>
<p>In November 2020, Flashbots emerged as a potential solution to this MEV problem. Flashbots is basically an organisation which connects searchers and mining pools together. Except, rather than using private contracts and arrangements, it’s an open participation system, where any searcher and any mining pool can join. This open system is believed to be far more beneficial to the network, than a few private entities dominating, because it still allows for competition.</p>
<p><strong>Flashbot Architecture</strong></p>
<p>Flashbots works as follows. Searchers analyse the blockchain and memory pool for MEV opportunities. When they find such an opportunity they create a transaction or bundle of transactions which exploits it. They then submit these transactions to the centralised Flashbots server. These transactions also include a payment for the miners. The idea here is that a searcher will no longer bother broadcasting their MEV transactions to the memory pool anymore and will only use the Flashbots system.</p>
<u><p>Flashbot Architecture Illustration</p></u>
<figure><img loading="lazy" src="https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-1024x589.png" alt="" width="512" height="295" srcset="https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-1024x589.png 1024w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-300x172.png 300w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-768x442.png 768w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-696x400.png 696w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-1068x614.png 1068w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd-730x420.png 730w, https://blog.bitmex.com/wp-content/uploads/2022/05/fbd.png 1501w" sizes="(max-width: 512px) 100vw, 512px"/></figure>
<p>The Flashbots server then sends these bundles of transactions on to the miners, such that they never hit the public memory pool. For any conflicting transactions, the miners then select whichever transactions have the highest payment to them and then they construct their block candidates. This is essentially an auction. Except bidders do not know the price other bidders have submitted and therefore, assuming the MEV transaction market is competitive, searchers should ensure they pay a substantial amount of the reward to the miners, to ensure they have a decent chance of winning the auction and getting in the block. Based on data from <a href="https://explore.flashbots.net/">explore.flashbots.net</a>, it appears as if around 63% of MEV rewards go to searchers, with the remainder, 37%, going to miners. This may indicate that mining is more competitive than searching.</p>
<p>The miners participating in the Flashbots system are also free to include any non-Flashbot transactions in their blocks, which they can potentially obtain by also connecting to the public transaction memory pool. Miners subscribing to Flashbot transactions are required to run a special modified version of Geth, called MEV-Geth. In our view it is critical that the mining nodes also connect to the “normal” memory pool and consider adding these transactions. This is a major counterpoint to any that would claim that since Flashbots is centralised and widely adopted by the miners, Ethereum therefore has a single point of failure.</p>
<p>MEV transaction bundles are either included or they are not. The way the mining client works is to analyse the entire block with the MEV bundle and to compare this to a version of the block without any MEV transactions, the miner then works on whatever block provides the highest rewards. The mining client is not able to unbundle Flashbot transactions, as this could result in a failure to capture MEV. However, the client can choose how many MEV bundles to include.</p>
<p>The block produced by MEV miners has the MEV related transactions at the top of the block, followed by the “normal” non-MEV transactions. It should be noted that this is all automated and happens very fast, with Ethereum’s block target around 13 seconds, it is critical to be well connected and quickly send the MEV transaction bundles.</p>
<p><strong>Flashbots adoption</strong></p>
<p>In Ethereum, as of May 2022, it is believed that over 90% of miners are connected to the Flashbots server. One can determine this by observing that over 90% of blocks contain Flashbot transaction bundles. Adoption from 0% to around 90% occurred almost entirely within 2021. Flashbots should therefore be considered very significant from an economic perspective when analysing Ethereum.</p>
<p>Another metric one can use to evaluate the economic significance of Flashbots is comparing the value of extracted MEV to Ethereum fees. According to <a href="https://charts.coinmetrics.io/network-data/">Coinmetrics</a> data, in the last 12 months total Ethereum miner fees have been around US$10,740m. In contrast, according to <a href="https://explore.flashbots.net/">explore.flashbots.net</a>, in the same period, the value of MEV extracted was US$393m. This is a proportion of only 3.7%, and therefore one can argue Flashbots is not particularly economically significant. However, 3.7% of revenue could have a large impact on miner margins and the 90% miner adoption indicates it is a major part of the Ethereum network. In the future, it is likely to remain a significant part of transaction propagation and therefore we consider Flashbots as important.</p>
<p><strong>The Centralised Flashbots Relay Entity</strong></p>
<p>Flashbots is a single centralised entity. It is funded by Fred Ehrsam’s crypto VC firm Paradigm, although it appears that this funding could be altruistic. Searchers send there MEV transactions to the server with the address <a href="https://relay.flashbots.net/">https://relay.flashbots.net/</a> and the server is currently located in Ohio in the United States of America.</p>
<p>The Flashbots entity must also be trusted to sensitively and securely handle the information in the MEV transaction bundles. If Flashbots acted nefariously, it could outbid and front run other searchers themselves. Flashbots is therefore a trusted and centralised system, not ideal as a long term solution to the MEV problem.</p>
<p>In order to prevent spam, searchers are required to be authenticated prior to the submission of MEV transactions and can build up reputation.</p>
<p><strong>ETH2/PoS</strong></p>
<p>The Flashbots system is integrated into the current Proof of Work (PoW) mining system on Ethereum. When the Merge happens and PoW mining is switched off, Flashbots adoption will reset to zero again. In order to mitigate against the MEV problem a new Flashbots infrastructure will need to be built up and staking agents will need to adopt this new system. This was not in the ETH 2.0 roadmap and may be an additional complication related to the upgrade to <a href="https://blog.bitmex.com/ethereum-2-0/">ETH 2.0</a>.</p>
<p>In the longer term, using ideas from Flashbots, there is the idea of further decoupling staking from block production and transaction selection. Ethereum founder Vitalik Butterin <a href="https://ethresear.ch/t/proposer-block-builder-separation-friendly-fee-market-designs/9725">wrote</a> about this in June 2021. Instead of stakers producing blocks, third party searchers/builders could construct blocks. The builders then broadcast only the block headers, which include the payment to the block producer and a commitment to all the transactions. The block proposer then signs and publishes the block header with the highest reward, following this, only then does the builder publish the full block. Although this makes selecting the tip more complicated, as the rules will need to be changed to consider whether the full block is present or not, attempting to decouple block builders from proposers at the protocol level could make something like the centralised Flashbot system somewhat unnecessary.</p>
<p><strong>What has Flashbots achieved?</strong></p>
<p>Now that we understand Flashbots were designed to mitigate the risks of miner centralisation and that the Flashbots system is itself a centralised server, one can legitimately ask the question: Isn’t this all pointless then? We have the centralisation now, so Flashbots achieved nothing.</p>
<p>The first response to that, from a pragmatic standpoint, Flashbots did reduce network fees, even if the system is centralised and therefore Flashbots has been helpful. However, if Flashbots did not exist, it is likely that the alternative model would be a series of private arrangements between miners and searchers, therefore network fees could have been lowered anyway. The key thing is that Flashbots is a relatively open system, where small miners and smaller searchers could join and try to compete. Flashbots is therefore superior to one large searcher and one large miner doing a private deal. This single entity could have become dominant and controlled Ethereum. Therefore you could argue that Flashbots almost saved Ethereum. In essence, what Flashbots has achieved is sacrificing decentralisation in the MEV extraction, to allow for open participation, rather than a closed system. This feels like a worthwhile tradeoff.</p>
<p><strong>Is Ethereum Centralised?</strong></p>
<p>Flashbots is centralised and it is a component of the block production process in Ethereum, with c95% of miners subscribing to the service. However, it is not, strictly speaking, a necessary component of the block production process. The centralised Flashbots relay entity does not directly own any hashpower. Nor can Flashbots censor non-MEV related transactions. Miners can still include transactions that did not go through the Flashbots relay. Flashbots is clearly a centralising force, but the alternative feels far worse.</p>
<p>Fear not, proponents of Flashbots argue. The Flashbots system is a DAO and will eventually become decentralised itself. This is a similar analogy to Lido here. <a href="https://blog.bitmex.com/outsourced-stake/">Lido</a> is a staking pool that accounts for around 29% of all Ethereum staked in ETH 2.0. To avert claims of centralisation, Lido itself says it is or will become a decentralised DAO, just like Flashbots. To “Bitcoin maximallists”, this logic may sound ridiculous. It is merely obfuscating the centralisation into more layers and complexity, such that the centralisation is harder to see, they could argue. However, we do see some limited merit in adding more layers. The benefits of this could be that the centralisation is harder to spot, which can improve the resilience network against some adversaries over some periods. At the same time centralisation can be more easily shuffled around between the layers, confusing any adversary.</p>
 </div></div>
  </body>
</html>
