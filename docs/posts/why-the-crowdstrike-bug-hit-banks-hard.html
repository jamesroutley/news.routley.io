<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bitsaboutmoney.com/archive/crowdstrike-bug-hit-banks-hard/">Original</a>
    <h1>Why the CrowdStrike bug hit banks hard</h1>
    
    <div id="readability-page-1" class="page"><div>
        <p><em><strong>Programming note</strong>: I recently launched a weekly podcast, </em><a href="https://www.complexsystemspodcast.com" rel="noreferrer"><em>Complex Systems</em></a><em> with Patrick McKenzie. About 50% of the conversations cover Bits about Money&#39;s beat. The remainder will be on other interesting intersections of technology, incentives, culture, and organizational design. The first three episodes covered </em><a href="https://www.complexsystemspodcast.com/episodes/teaching-trading-ricki-heicklen/" rel="noreferrer"><em>teaching trading</em></a><em>, Byrne Hobart on the </em><a href="https://www.complexsystemspodcast.com/episodes/writing-history-byrne-hobart/" rel="noreferrer"><em>epistemology of financial firms</em></a><em>, and </em><a href="https://www.complexsystemspodcast.com/episodes/reporting-tech-kelsey-piper/" rel="noreferrer"><em>the tech industry vs. tech reporting divide</em></a><em>. Subscribe to it anywhere you listen to podcasts. If you enjoy it, writing a review (in your podcast app or to me via email) helps quite a bit.</em></p><p>On July 19th, a firm most people have sensibly never heard of knocked out a large portion of the routine operations at many institutions worldwide. This hit the banking sector particularly hard. It has been <a href="https://www.wsj.com/tech/microsoft-reports-major-service-outage-affecting-users-worldwide-328a2f40">publicly reported</a> that several of the largest U.S. banks were affected by the outage. I understand one of them to have idled tellers and bankers nationwide for the duration. (You’ll forgive me for not naming them, as it would cost me some points.) The issue affected institutions across the size spectrum, including large regionals and community banks.</p><p>You might sensibly ask why that happened and, for that matter, how it was possible it would happen.</p><p>You might be curious about how to quickly reconstitute the financial system from less legible sources of credit when it is down. (Which: probably less important as a takeaway, but it is quite colorful.)</p><h2 id="brief-necessary-technical-context">Brief necessary technical context</h2><p>Something like 20% of the readership of this column has an engineering degree. To you folks, I apologize in advance for the following handwaviness. (You <em>may</em> be better served by the <a href="https://www.crowdstrike.com/falcon-content-update-remediation-and-guidance-hub/" rel="noreferrer">Preliminary Post Incident Review</a>.)</p><p>Many operating systems have a distinction between the “kernel” supplied by the operating system manufacturer and all other software running on the computer system. For historical reasons, that area where almost everything executes is called “userspace.”</p><p>In modern software design, programs running in userspace (i.e. almost all programs) are <em>relatively</em> limited in what they can do. Programs running in kernelspace, on the other hand, get direct access to the hardware under the operating system. Certain bugs in kernel programming are very, very bad news for everything running on the computer.</p><p><a href="https://www.crowdstrike.com/platform/endpoint-security/">CrowdStrike Falcon</a> is endpoint monitoring software. In brief, “endpoint monitoring” is a service sold to enterprises which have tens or hundreds of thousands of devices (“endpoints”). Those devices are<em> illegible to the organization that owns them</em> due to sheer scale; no single person nor group of people understand what is happening on them. This means there are <em>highly variable</em> levels of how-totally-effed those devices might be at exactly this moment in time. The pitch for endpoint monitoring is that it gives your teams the ability to make those systems legible again while also benefitting from economies of scale, with you getting a continuously updated feed of threats to scan for from your provider.</p><p>One way an endpoint might be effed is if it was physically stolen from your working-from-home employee earlier this week. Another way is if it has recently joined a botnet orchestrated from a geopolitical adversary of the United States after one of your junior programmers decided to install warez because the six figure annual salary was too little to fund their video game habit. (No, I am not reading <em>your</em> incident reports, I clarify for every security team in the industry.)</p><p>In theory, you perform ongoing monitoring of <em>all</em> of your computers. Then, your crack security team responds to alerts generated by your endpoint monitoring solution. This will sometimes merit further investigation and sometimes call for immediate remedial work. The conversations range from “Did you really just install cracked Starcraft 2 on your work PC? … Please don’t do that.” to “The novel virus reported this morning compromised 32 computers in the wealth management office. Containment was achieved by 2:05 PM ET, by which point we had null routed every packet coming out of that subnet then physically disconnected power to the router just to be sure. We have engaged incident response to see what if any data was exfiltrated in the 47 minutes between detection and null routing. At this point we have no indications of compromise outside that subnet but we cannot rule out a threat actor using the virus as a beachhead or advanced persistent threats being deployed.”</p><p>(Yes, that does sound like a Tom Clancy novel. No, that is not a parody.)</p><h2 id="falcon-punched">Falcon punched</h2><p>Falcon <a href="https://www.crowdstrike.com/blog/falcon-update-for-windows-hosts-technical-details/">shipped a configuration bug</a>. In brief, this means that rather than writing new software (which, in modern development practice, hopefully goes through fairly extensive testing and release procedures), CrowdStrike sent a bit of data to systems with Falcon installed. That data was intended to simply update the set of conditions that Falcon scanned for. However, due to an error at CrowdStrike, it <em>actually</em> caused existing already-reviewed Falcon software to fail catastrophically.</p><p>Since that failure happened in kernelspace at a particularly vulnerable time, this resulted in Windows systems experiencing total failure beginning at boot. The user-visible symptom is sometimes called the <a href="https://support.microsoft.com/en-us/windows/resolving-blue-screen-errors-in-windows-60b01860-58f2-be66-7516-5c45a66ae3c6" rel="noreferrer">Blue Screen of Death</a>.</p><p>Configuration bugs are a disturbingly large portion of engineering decisions which cause outages. (Citation: let’s go with “general knowledge as an informed industry observer.” As always, while I’ve previously worked at Stripe, neither Stripe nor its security team necessarily endorses things I say in my personal spaces.)</p><p>However, because <em>this</em> configuration bug hit very widely distributed software running in kernelspace almost universally across machines used by the workforce of lynchpin institutions throughout society (most relevantly to this column, banks, but also <a href="https://www.delta.com/us/en/advisories/other-alerts/global-it-outage" rel="noreferrer">airlines</a>, etc etc), it had a blast radius much, much larger than typical configuration bugs.</p><p>Have I mentioned that IT security really likes military metaphors? “Blast radius” means “given a fault or failure in system X, how far afield from X will we see negative user impact.” I struggle to recall a bug with a broader direct blast radius than the Falcon misconfiguration.</p><p>Once the misconfiguration was rolled out, fixing it was complicated by the tiny issue that a lot of the people needed to fix it couldn’t access their work systems because their machine Blue Screen of Death’ed.</p><p>Why? Well, we put the vulnerable software on essentially all machines in a particular institution. You want to protect <em>all</em> the devices. That is the point of endpoint monitoring. It is literally someone’s job to figure out where the devices that aren’t endpoint monitored exist and then to bring them into compliance.</p><p>Why do we care about optimizing for endpoint monitoring coverage? Partly it is for genuinely good security reasons. But a major part of it is that small-c compliance is necessary for large-C Compliance. Your regulator will effectively demand that you do it.</p><h2 id="why-did-falcon-run-in-kernelspace-rather-than-userspace">Why did Falcon run in kernelspace rather than userspace?</h2><p>Falcon runs in kernelspace versus userspace in part because the most straightforward way to poke its nose in other programs’ business is to simply ignore the security guarantees that operating systems give to programs running in userspace. Poking your nose in another program’s memory is generally considered somewhere between rude and forbidden-by-very-substantial-engineering-work. However, endpoint monitoring software considers that other software running on the device <em>may be there at the direction of the adversary</em>. It therefore considers that software’s comfort level with its intrusion to be a distant secondary consideration.</p><p>Another reason Falcon ran in kernelspace was, as Microsoft told <a href="https://www.wsj.com/tech/cybersecurity/microsoft-tech-outage-role-crowdstrike-50917b90">the WSJ</a>, Microsoft was forbidden by an understanding with the European Commission from firmly demoting other security software developers down to userspace. This was because Microsoft both a) wrote security software and b) necessarily always had the option of writing it in kernelspace, because Microsoft controls Windows. The European Commission has <a href="https://www.euronews.com/next/2024/07/23/european-commission-denies-responsibility-for-massive-microsoft-it-outage#:~:text=A%20European%20Commission%20spokesperson%20has,Commission%20either%20before%20or%20after" rel="noreferrer">pushed back</a> against this characterization and pointed out that This Sentence Uses Cookies To Enable Essential Essay Functionality.</p><h2 id="regulations-which-strongly-suggest-particular-software-purchases">Regulations which strongly suggest particular software purchases</h2><p>It would be an overstatement to say that the United States federal government commanded U.S. financial institutions to install CrowdStrike Falcon and thereby embed a landmine into the kernels of all their employees’ computers. Anyone saying that has no idea how banking regulation works.</p><p>Life is much more subtle than that.</p><p>The United States has many, many different banking regulators. Those regulators have some desires for their banks which rhyme heavily, and so they have banded into a club to share resources. This lets them spend their limited brainsweat budgets on things banking regulators have more individualized opinions on than simple, common banking regulatory infrastructure.</p><p>One such club is the <a href="https://www.ffiec.gov/">Federal Financial Institutions Examination Council</a>. They wrote the tgreatest crossover event of all time if your interests are a) mandatory supervisory evaluations of financial institutions and b) IT risk management: the <a href="https://www.ffiec.gov/press/pdf/ffiec_it_handbook_information_security_booklet.pdf">FFIEC Information Technology Examination Handbook&#39;s Information Security Booklet</a>.</p><p>The modal consumer of this document is probably not a Linux kernel programmer with a highly developed mental model of kernelspace versus userspace. That would be an <em>unreasonable</em> expectation for a banking supervisor. They work for a <em>banking regulator</em>, not a software company, doing <em>important supervisory work</em>, not merely implementation. Later this week they might be working on capital adequacy ratios, but for right now, they’re asking your IT team about endpoint monitoring.</p><p>The FFEITC ITEH ISB (the acronym just rolls off the tongue) is not super prescriptive about exactly what controls you, a financial institution, have to have. This is common in many regulatory environments. HIPAA, to use a contrasting example, is unusual in that it describes a control environment that you can reduce to a checklist with Required or Optional next to each of them. (HIPAA spells that second category “Addressable”, for reasons outside the scope of this essay, but which I’ll mention because I don’t want to offend other former HIPAA Compliance Officers.)</p><p>To facilitate your institution’s conversation with the examiner who drew the short straw, you will conduct a risk analysis. Well, more likely, you’ll pay a consulting firm to conduct a risk analysis. In the production function that is scaled consultancies, this means that a junior employee will open U.S. Financial Institution IT Security Risk Analysis v3-edited-final-final.docx and add important client-specific context like a) their name and b) their logo.</p><p>That document will heavily reference the ITEH, because it exists to quickly shut down the line of questioning from the examiner. If you desire a career in this field, you will phrase that as “guiding the conversation towards areas of maximum mutual interest in the cause of &#39;advanc[ing] the nation’s monetary, financial, and payment systems to build a stronger economy for all Americans.&#39;” (The internal quotation is lifted from a <a href="https://archive.is/P7Zsz#selection-1405.0-1405.69" rel="noreferrer">job description</a> at the Federal Reserve.)</p><p>Your consultants are going to, when they conduct the mandatory risk analysis, give you a shopping list. Endpoint monitoring is one item on that shopping list. Why? Ask your consultant and they’ll bill you for the answer, but you can get my opinion for free and it is worth twice what you paid for it: II.C.12 Malware Mitigation.</p><p>Does the FFEITC have a hugely prescriptive view of what you should be doing for malware monitoring? Well, no:</p><blockquote>Management should implement defense-in-depth to protect, detect, and respond to malware. The institution can use many tools to block malware before it enters the environment and to detect it and respond if it is not blocked. Methods or systems that management should consider include the following: [12 bullet points which vary in specificity from whitelisting allowed programs to port monitoring to user education].</blockquote><p>But your consultants will tell you that you want a very responsive answer to II.C.12 in this report and that, since you probably do not have Google’s ability to fill floors of people doing industry-leading security research, you should just buy something which says Yeah We Do That.</p><p>CrowdStrike’s sales reps will happily tell you <a href="https://crowdstrike.com/solutions/financial-services/">Yeah We Do That</a>. This web page exists as a result of a deterministic process co-owned by the Marketing and Sales departments at a B2B software company to create industry-specific “sales enablement” collateral. As a matter of fact, if you want to give CrowdStrike your email address and job title, they will even send you a document which is not titled <a href="https://www.crowdstrike.com/resources/reports/crowdstrike-falcon-and-ffiec-compliance/">Exact Wording To Put In Your Risk Assessment Including Which Five Objectives And Seventeen Controls Purchasing This Product Will Solve For</a>.</p><p>CrowdStrike is not, strictly speaking, the only vendor that you could have installed on every computer you owned to make your regulators happy with you. But, due to vagaries of how enterprise software sales teams work, they sewed up an awful lot of government-adjacent industries. This was in part because they aggressively pursued writing the <a href="https://www.crowdstrike.com/why-crowdstrike/crowdstrike-compliance-certification/" rel="noreferrer">sort of documents</a> you need if the people who read your project plans have national security briefs.</p><p>I’m not mocking the Federal Financial Institutions Examining Council for cosplaying as having a national security brief. (Goodness knows that that happens a lot in cybersecurity... and government generally. New York <em>City</em> likes to pretend it has an <a href="https://www.nyc.gov/site/nypd/bureaus/investigative/intelligence.page" rel="noreferrer">intelligence service</a>, which is absolutely not a patronage program designed to have taxpayers fund indefinite foreign vacations with minimal actual job duties.)</p><p>But money <em>is</em> core societal infrastructure, like the power grid and transportation systems are. It would be <em>really bad</em> if hackers working for a foreign government could just <em>turn off money</em>. That would be more damaging than a conventional missile being fired at random into New York City, and we might be more constrained in responding.</p><p>And so, we ended up in a situation where we invited an <a href="https://www.crowdstrike.com/cybersecurity-101/advanced-persistent-threat-apt/">advanced persistent threat</a> into kernelspace.</p><p>It is perhaps important to point out that security professionals understand  security tools to themselves introduce security vulnerabilities. Partly, the worry is that a monoculture could have a particular weakness that could be exploited in a particular way. Partly, it is that security tools (and security personnel!) frequently have more privileges than is typical, and therefore they can be directly compromised by the adversary. This observation is fractal in systems engineering: at every level of abstraction, if your control plane gets compromised, you lose. (Control plane has a <a href="https://www.cloudflare.com/learning/network-layer/what-is-the-control-plane/">specific meaning</a> in networking but for this purpose just round it to “operating system (metaphorical) that controls your operating systems (literal).”)</p><p>CrowdStrike <a href="https://x.com/George_Kurtz/status/1814235001745027317" rel="noreferrer">maintains</a> that they do not understand it to be the case that a bad actor intentionally tried to bring down global financial infrastructure and airlines by using them as a weapon. No, CrowdStrike did that themselves, on accident, of their own volition. But this demonstrates the problem pretty clearly: if a junior employee tripping over a power cord at your company brings down computers worldwide, the bad guys have a variety of options for achieving directionally similar aims by attacking directionally similar power cords.</p><h2 id="when-money-stops-money-ing">When money stops money-ing</h2><p>I found out about the CrowdStrike vulnerability in the usual fashion: Twitter. But then my friendly local bank branch cited it (as quote the Microsoft systems issue endquote) when I was attempting to withdraw cash from the teller window.</p><p>My family purchased a duplex recently and is doing renovation prior to moving in. For complex social reasons, a thorough recitation of which would make me persona non grata across the political spectrum, engaging a sufficient number of contractors in Chicago will result in one being asked to make frequent, sizable payments in cash.</p><p>This created a minor emergency for me, because it was an other-than-minor emergency for some contractors I was working with.</p><p>Many contractors are small businesses. Many small businesses are very thinly capitalized. Many employees of small businesses are extremely dependent on receiving compensation exactly on payday and not after it. And so, while <em>many</em> people in Chicago were basically unaffected on that Friday because <em>their</em> money kept working (on mobile apps, via Venmo/Cash App, via credit cards, etc), cash-dependent people got an enormous wrench thrown into their plans.</p><p>I personally tried withdrawing cash at three financial institutions in different weight classes, as was told it was absolutely impossible (in size) at all of them, owing to the Falcon issue.</p><p>At one, I was told that I couldn’t use the tellers but could use the ATM. Unfortunately, like many customers, I was attempting to take out more cash from the ATM than I ever had before. Fortunately, their system that flags potentially fraudulent behavior will let a customer unflag themselves by responding to an instant communication from the bank. Unfortunately, the subdomain that communication directs them to runs on a server apparently protected by CrowdStrike Falcon.</p><p>It was not impossible at <em>all</em> financial institutions. I am aware of a few around Chicago which ran out of physical cash on hand at some branches, because all demand for cash on a Friday was serviced by them versus by “all of the financial institutions.” (As always happens during widespread disturbances in infrastructure, there quickly arises a shadow economy of information trading which redirects relatively sophisticated people to the places that are capable of servicing them. This happens through offline social networks since time immemorial and online social networks since we invented those. The first is probably more impactful but the second is more <em>legible</em>, so banking regulators pretend this class of issues sprang fully formed from the tech industry just in time to bring down banks last year.)</p><p>I have some knowledge of the history of comprehensive failures of financial infrastructure, and so I considered doing the traditional thing when convertibility of deposits is suspended by industry-wide issues: <a href="https://theculturetrip.com/europe/ireland/articles/how-pubs-in-ireland-literally-saved-the-countrys-economy">head to the bar</a>.</p><p>A hopefully unnecessary disclaimer: the following is historical fact despite rhyming with stereotype.</p><p>Back in 1970, there was a widespread and sustained (six months!) strike in the Irish banking sector. Workers were unable to cash paychecks because tellers refused to work. So, as an accommodation for customers, operators of pubs would cash the checks from the till, trusting that <em>eventually</em> checks drawn on the accounts of local employers would be good funds again. </p><p>Some publicans even cashed personal checks, backed by the swift and terrible justice of the credit reporting bureau We Control Whether You Can Ever Enjoy A Pint With Your Friends Again. This kept physical notes circulating in the economy.</p><p>As I told my contractors, to their confusion, I was unable to simply go down to the local bar to get them cash with the banks down. I don’t have sufficient credit with the operator of the local bar, as I don’t drink.</p><p>I told them, to their <em>even greater</em> confusion, that I had considered going down to the parish and buying all their cash on hand with a personal check. Churches, much like bars, have much of their weekly income come through electronic payments but still do a substantial amount of cash management through the workweek heading into the weekend. I’m much more a known quantity at church than I am at the friendly neighborhood watering hole. (Also, when attempting to workaround financial infrastructure bugs to get workers their wages, consider relying on counterparties with common knowledge of <a href="https://bible.usccb.org/bible/james/5">James 5:4</a>.)</p><p>I eventually resolved the issue in a more boring fashion: I texted someone I reasonably assumed to have cash and asked them to bring it over.</p><p>Financial infrastructure normally functions to abstract away personal ties and replace favor-swapping with legibly-priced broadly-offered services.</p><p>Thankfully, while this outage was surprisingly deep and broad, banks were <em>mostly</em> back to normal on the following Monday.</p>

        

        <div>
          <h2>Want more essays in your inbox?</h2>
          <p>I write about the intersection of tech and finance, approximately biweekly. It&#39;s free.</p>
                  </div>

      </div></div>
  </body>
</html>
