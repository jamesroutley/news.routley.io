<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/wizenheimer/tinkerbird">Original</a>
    <h1>Show HN: TinkerBird â€“ A Chrome-native vector database</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">TinkerBird is a Chrome-native vector database designed for efficient storage and
retrieval of high-dimensional vectors (embeddings). Its query engine, written in
TypeScript, leverages HNSW (Hierarchical Navigable Small World) indexes for fast
vector retrieval. The storage layer utilizes IndexedDB, which could be extended
with an lru-cache.</p>
<p dir="auto">One significant challenge facing large language models (LLMs) is their tendency
to generate syntactically correct but factually inaccurate responses, a
phenomenon known as hallucination. To address this issue, vector databases
provide LLMs with relevant context to structure it&#39;s response. This not only
improves the accuracy of LLM responses but also minimizes computational costs
incurred by irrelevant tokens. Additionally, vector databases ensure that LLMs
are anchored to the required context.</p>
<p dir="auto">TinkerBird disrupts traditional RAG workflows, which rely heavily on server-side
interactions. By co-locating data and embeddings, it eliminates the roundtrip
delays associated with client-server model. With Tinkerbird, sensitive data
remains local, thus benefiting from vector search, without the associated
compliance and security risks.</p>
<p dir="auto">TinkerBird uses IndexedDB as it&#39;s storage layer, which in turn builds upon Blobs
and LevelDB storage systems. By using Indexeddb, it benefits from IndexedDB&#39;s
adoption, stability and familiarity as a native choice for offline first
workflows.</p>

<p dir="auto">Documentation covers the key methods and usage scenarios for the <code>HNSW</code> and
<code>VectorStore</code> classes.</p>

<p dir="auto">Encapsulates an in-memory implementation of HNSW index</p>
<div dir="auto" data-snippet-clipboard-copy-content="// Initialize HNSW index
const hnsw = new HNSW();

// Build HNSW index incrementally
await hnsw.buildIndex(data);

// Save the serialized index to a file
const serializedIndex = hnsw.serialize();

// Query Index with queryVector and kValue
const results = hnsw.query(queryVector, kValue);"><pre><span>// Initialize HNSW index</span>
<span>const</span> <span>hnsw</span> <span>=</span> <span>new</span> <span>HNSW</span><span>(</span><span>)</span><span>;</span>

<span>// Build HNSW index incrementally</span>
<span>await</span> <span>hnsw</span><span>.</span><span>buildIndex</span><span>(</span><span>data</span><span>)</span><span>;</span>

<span>// Save the serialized index to a file</span>
<span>const</span> <span>serializedIndex</span> <span>=</span> <span>hnsw</span><span>.</span><span>serialize</span><span>(</span><span>)</span><span>;</span>

<span>// Query Index with queryVector and kValue</span>
<span>const</span> <span>results</span> <span>=</span> <span>hnsw</span><span>.</span><span>query</span><span>(</span><span>queryVector</span><span>,</span> <span>kValue</span><span>)</span><span>;</span></pre></div>

<ul dir="auto">
<li><code>metric: SimilarityMetric</code>: The similarity metric used in the HNSW graph.</li>
<li><code>similarityFunction: vectorReducer</code>: The similarity function for reducing
vectors.</li>
<li><code>d: number | null</code>: The vector dimension. It can be <code>null</code> if not specified.</li>
<li><code>M: number</code>: The maximum neighbor count.</li>
<li><code>efConstruction: number</code>: The effervescence coefficient used during
construction.</li>
<li><code>entryPointId: number</code>: The ID of the entry node in the graph.</li>
<li><code>nodes: Map&lt;number, Node&gt;</code>: A mapping of node IDs to nodes.</li>
<li><code>probs: number[]</code>: Probabilities for each level in the graph.</li>
<li><code>levelMax: number</code>: The maximum level of the graph.</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="// Example usage of the HNSW class
const hnsw = new HNSW();"><pre><span>// Example usage of the HNSW class</span>
<span>const</span> <span>hnsw</span> <span>=</span> <span>new</span> <span>HNSW</span><span>(</span><span>)</span><span>;</span></pre></div>

<p dir="auto">An enumeration of similarity metrics used in the context of the HNSW class.</p>

<ul dir="auto">
<li><code>cosine</code>: Represents the cosine similarity metric.</li>
<li><code>euclidean</code>: Represents the Euclidean similarity metric.</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="// Example usage of the SimilarityMetric enum
const selectedMetric: SimilarityMetric = SimilarityMetric.cosine;"><pre><span>// Example usage of the SimilarityMetric enum</span>
<span>const</span> <span>selectedMetric</span>: <span>SimilarityMetric</span> <span>=</span> <span>SimilarityMetric</span><span>.</span><span>cosine</span><span>;</span></pre></div>

<p dir="auto">This documentation provides an overview of the <code>VectorStore</code> class, its methods,
and usage examples. Feel free to adjust the parameters and methods as per your
needs.</p>
<p dir="auto">The <code>VectorStore</code> class extends the HNSW class and provides functionality for
managing a vector index, including building, loading, saving, deleting the
index, and querying vectors. It supports caching to improve query performance.</p>


<div dir="auto" data-snippet-clipboard-copy-content="static async create(options: VectorStoreOptions): Promise&lt;VectorStore&gt;"><pre><span>static</span> <span>async</span> <span>create</span><span>(</span><span>options</span>: <span>VectorStoreOptions</span><span>)</span>: <span>Promise</span><span>&lt;</span><span>VectorStore</span><span>&gt;</span></pre></div>
<ul dir="auto">
<li>Creates a new instance of the <code>VectorStore</code> class.</li>
<li><code>options</code>: Object containing options for vector store initialization.
<ul dir="auto">
<li><code>collectionName</code>: A unique name for the vector collection.</li>
<li><code>M</code>: Maximum neighbor count (default is 16).</li>
<li><code>efConstruction</code>: Effervescence coefficient during construction (default
is 200).</li>
</ul>
</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="static async recreate(collectionName: string): Promise&lt;VectorStore&gt;"><pre><span>static</span> <span>async</span> <span>recreate</span><span>(</span><span>collectionName</span>: string<span>)</span>: <span>Promise</span><span>&lt;</span><span>VectorStore</span><span>&gt;</span></pre></div>
<ul dir="auto">
<li>Attempts to recreate index from collection or else create a new instance of
the <code>VectorStore</code> class if collection doesn&#39;t exist. This has been reported
to result in unintended results, prefer create() instead.</li>
<li><code>options</code>: Object containing options for vector store initialization.
<ul dir="auto">
<li><code>collectionName</code>: A unique name for the vector collection.</li>
</ul>
</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="async loadIndex(): Promise&lt;void&gt;"><pre><span>async</span> <span>loadIndex</span><span>(</span><span>)</span>: <span>Promise</span><span>&lt;</span><span><span>void</span></span><span>&gt;</span></pre></div>
<ul dir="auto">
<li>Loads the vector index and meta data from the IndexedDB database. Used
internally to recreate index</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="async saveIndex(): Promise&lt;void&gt;"><pre><span>async</span> <span>saveIndex</span><span>(</span><span>)</span>: <span>Promise</span><span>&lt;</span><span><span>void</span></span><span>&gt;</span></pre></div>
<ul dir="auto">
<li>Persists the current state of the vector index and meta data onto the
IndexedDB database.</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="async deleteIndex(): Promise&lt;void&gt;"><pre><span>async</span> <span>deleteIndex</span><span>(</span><span>)</span>: <span>Promise</span><span>&lt;</span><span><span>void</span></span><span>&gt;</span></pre></div>
<ul dir="auto">
<li>Deletes the persisted index and metadata from the IndexedDB and populates it
with an empty index and metadata</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="query(target: number[], k: number = 3): vectorResult"><pre><span>query</span><span>(</span><span>target</span>: <span>number</span><span>[</span><span></span><span>]</span><span>,</span> <span>k</span>: <span>number</span> <span>=</span> <span>3</span><span>)</span>: <span>vectorResult</span></pre></div>
<ul dir="auto">
<li>Performs a vector search on the index.</li>
<li><code>target</code>: The vector for which the search is performed.</li>
<li><code>k</code>: The number of neighbors to retrieve (default is 3).</li>
<li>Returns: The result of the vector query.</li>
</ul>

<ul dir="auto">
<li><code>VectorStoreUnintialized</code>: Error indicating that the vector store is
uninitialized.</li>
<li><code>VectorStoreIndexMissing</code>: Error indicating that the vector store index is
missing.</li>
<li><code>VectorStoreIndexPurgeFailed</code>: Error indicating that the vector store index
deletion failed.</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="// Create VectorStore instance
const vectorStore = await VectorStore.create({
    collectionName: &#34;my-collection&#34;,
    M: 16,
    efConstruction: 200
});

// Load, Save, and Delete Index
await vectorStore.loadIndex();
await vectorStore.saveIndex();
await vectorStore.deleteIndex();

// Perform Vector Query
const queryVector = [
    /* ... */
];
const kValue = 5;
const results = vectorStore.query(queryVector, kValue);"><pre><span>// Create VectorStore instance</span>
<span>const</span> <span>vectorStore</span> <span>=</span> <span>await</span> <span>VectorStore</span><span>.</span><span>create</span><span>(</span><span>{</span>
    <span>collectionName</span>: <span>&#34;my-collection&#34;</span><span>,</span>
    <span>M</span>: <span>16</span><span>,</span>
    <span>efConstruction</span>: <span>200</span>
<span>}</span><span>)</span><span>;</span>

<span>// Load, Save, and Delete Index</span>
<span>await</span> <span>vectorStore</span><span>.</span><span>loadIndex</span><span>(</span><span>)</span><span>;</span>
<span>await</span> <span>vectorStore</span><span>.</span><span>saveIndex</span><span>(</span><span>)</span><span>;</span>
<span>await</span> <span>vectorStore</span><span>.</span><span>deleteIndex</span><span>(</span><span>)</span><span>;</span>

<span>// Perform Vector Query</span>
<span>const</span> <span>queryVector</span> <span>=</span> <span>[</span>
    <span>/* ... */</span>
<span>]</span><span>;</span>
<span>const</span> <span>kValue</span> <span>=</span> <span>5</span><span>;</span>
<span>const</span> <span>results</span> <span>=</span> <span>vectorStore</span><span>.</span><span>query</span><span>(</span><span>queryVector</span><span>,</span> <span>kValue</span><span>)</span><span>;</span></pre></div>

<p dir="auto">The <code>VectorStoreOptions</code> type defines the configuration options for initializing
a VectorStore instance.</p>


<ul dir="auto">
<li><code>collectionName: string</code>: A unique name for the vector collection.</li>
<li><code>M?: number</code>: Maximum neighbor count (default is 16).</li>
<li><code>efConstruction?: number</code>: Effervescence coefficient during construction
(default is 200).</li>
<li><code>cacheOptions?: CacheOptions | null</code>: Options for caching (optional).</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="const vectorStoreOptions: VectorStoreOptions = {
    collectionName: &#34;my-collection&#34;,
    M: 16,
    efConstruction: 200,
    cacheOptions: {
        max: 1000,
        maxAge: 60000 // 1 minute
    }
};"><pre><span>const</span> <span>vectorStoreOptions</span>: <span>VectorStoreOptions</span> <span>=</span> <span>{</span>
    <span>collectionName</span>: <span>&#34;my-collection&#34;</span><span>,</span>
    <span>M</span>: <span>16</span><span>,</span>
    <span>efConstruction</span>: <span>200</span><span>,</span>
    <span>cacheOptions</span>: <span>{</span>
        <span>max</span>: <span>1000</span><span>,</span>
        <span>maxAge</span>: <span>60000</span> <span>// 1 minute</span>
    <span>}</span>
<span>}</span><span>;</span></pre></div>

<p dir="auto">Feel free to contribute to TinkerBird by sending us your suggestions, bug
reports, or cat videos. Contributions are what make the open source community
such an amazing place to be learn, inspire, and create. Any contributions you
make are <strong>greatly appreciated</strong>.</p>

<p dir="auto">Distributed under the MIT License. See <a href="https://github.com/wizenheimer/tinkerbird/blob/master/LICENSE">LICENSE</a> for more information.
TinkerBird is provided &#34;as is&#34; and comes with absolutely no guarantees. We take
no responsibility for irrelevant searches, confused users, or existential crises
induced by unpredictable results. If it breaks, well, that&#39;s your problem now
ðŸ’€.</p>

<p dir="auto">TinkerBird was brought to you by an indie developer who should probably be
working on something more productive. But hey I am.</p>

<ul dir="auto">
<li><a href="https://github.com/erikbern/ann-benchmarks">ANN-Benchmarks</a></li>
<li><a href="https://15721.courses.cs.cmu.edu/spring2018/papers/08-oltpindexes1/pugh-skiplists-cacm1990.pdf" rel="nofollow">Skip Lists: A Probabilistic Alternative to Balanced Trees</a></li>
<li><a href="https://arxiv.org/abs/1603.09320" rel="nofollow">Efficient and Robust Approximate Nearest Neighbor Search Using Hierarchical Navigable Small Worlds</a></li>
<li><a href="https://www.iiis.org/CDs2011/CD2011IDI/ICTA_2011/PapersPdf/CT175ON.pdf" rel="nofollow">Scalable Distributed Algorithm for Approximate Nearest Neighbor Search Problem in High-Dimensional General Metric Spaces</a></li>
<li><a href="https://deepai.org/publication/a-comparative-study-on-hierarchical-navigable-small-world-graphs" rel="nofollow">A Comparative Study on Hierarchical Navigable Small World Graphs</a></li>
<li><a href="https://proceedings.mlr.press/v119/prokhorenkova20a/prokhorenkova20a.pdf" rel="nofollow">HNSW: Hierarchical Navigable Small World graphs</a></li>
<li><a href="https://github.com/deepfates/hnsw/">HNSW Graphs</a></li>
<li><a href="https://github.com/facebookresearch/faiss/blob/main/faiss/impl/HNSW.cpp">Hierarchical Navigable Small World graphs in FAISS</a></li>
<li><a href="https://escholarship.org/content/qt1rp889r9/qt1rp889r9_noSplash_7071690a1d8a4ee71eb95432887d3a8e.pdf" rel="nofollow">A Comparative Study on Hierarchical Navigable Small World Graphs</a></li>
<li><a href="https://towardsdatascience.com/similarity-search-part-4-hierarchical-navigable-small-world-hnsw-2aad4fe87d37" rel="nofollow">Hierarchical Navigable Small World (HNSW) for ApproximateNearest Neighbor Search</a></li>
<li><a href="https://srivatssan.medium.com/hierarchical-navigable-small-worlds-d44d39d91f4b" rel="nofollow">Hierarchical Navigable Small Worlds</a></li>
</ul>
</article></div></div>
  </body>
</html>
