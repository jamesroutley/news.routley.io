<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lcamtuf.coredump.cx/p0f3/">Original</a>
    <h1>p0f: TCP Packet Fingerprinting</h1>
    
    <div id="readability-page-1" class="page">


<p>
<span>
Copyright (C) 2000-2014 by Michal Zalewski &lt;<a href="mailto:lcamtuf@coredump.cx">lcamtuf@coredump.cx</a>&gt;
</span>
</p>

<p>
My latest book, <a href="https://lcamtuf.coredump.cx/prep/" target="_blank"><b>Practical Doomsday</b></a>, is now out. Please check it out - I think it&#39;s my
best work so far.
</p>

<h2>What&#39;s this?</h2>

<p>
P0f is a tool that utilizes an array of sophisticated, purely passive traffic
fingerprinting mechanisms to identify the players behind any incidental TCP/IP
communications (often as little as a single normal SYN) without interfering in
any way. Version 3 is a complete rewrite of the original codebase, incorporating a significant
number of improvements to network-level fingerprinting, and introducing the ability to reason
about application-level payloads (e.g., HTTP).
</p>

<p>
Some of p0f&#39;s capabilities include:
</p>

<ul>

<li> <p>Highly scalable and extremely fast identification of the operating system
     and software on both endpoints of a vanilla TCP connection - especially in
     settings where <a href="https://www.nmap.org/">NMap</a> probes are blocked, too slow, unreliable, or would
     simply set off alarms.</p>

</li><li> <p>Measurement of system uptime and network hookup, distance (including
     topology behind NAT or packet filters), user language preferences, and so on.</p>

</li><li> <p>Automated detection of connection sharing / NAT, load balancing, and
     application-level proxying setups.</p>

</li><li> <p>Detection of clients and servers that forge declarative statements
     such as <i>X-Mailer</i> or <i>User-Agent</i>.</p>

</li></ul>

<p>
The tool can be operated in the foreground or as a daemon, and offers a simple
real-time API for third-party components that wish to obtain additional
information about the actors they are talking to.
</p>

<p>
Common uses for p0f include reconnaissance during penetration tests; routine
network monitoring; detection of unauthorized network interconnects in corporate
environments; providing signals for abuse-prevention tools; and miscellanous
forensics.
</p>

<p>
You can read more about its design and operation in 
<a href="https://lcamtuf.coredump.cx/p0f3/README">this document</a>. In one form or another,
<a href="https://lcamtuf.coredump.cx/p0f3/releases/old/2.x/">earlier versions</a> of p0f are used in a wide variety of projects, including
<a href="http://www.pfsense.org/index.php?option=com_content&amp;task=view&amp;id=40&amp;Itemid=43">pfsense</a>,
<a href="http://ettercap.sourceforge.net">Ettercap</a>,
<a href="http://prads.projects.linpro.no/">PRADS</a>,
<a href="http://www.ijs.si/software/amavisd/">amavisd</a>, 
<a href="http://www.snertsoft.com/sendmail/milter-p0f/">milter</a>, 
<a href="http://postgrey.schweikert.ch/">postgrey</a>, 
<a href="http://www.cipherdyne.org/fwknop/">fwknop</a>,
<a href="http://chatteronthewire.org/mortalx.htm">Satori</a>,
the OpenBSD firewall, and an assortment of commercial tools.
</p>

<p>
<i>Fun fact: The idea for p0f dates back to 
<a href="http://seclists.org/bugtraq/2000/Jun/141">June 10, 2000</a>. Today,
almost all applications that do passive OS fingerprinting either simply reuse p0f
for TCP-level checks (Ettercap, Disco, PRADS, Satori), or use inferior approaches that,
for example, pay no attention to the intricate relationship between host&#39;s 
window size and MTU (SinFP).</i>
</p><h2>What&#39;s the output?</h2>

<p>
A snippet of typical p0f output may look like this:
</p>

<xmp>
.-[ 1.2.3.4/1524 -> 4.3.2.1/80 (syn) ]-
|
| client   = 1.2.3.4
| os       = Windows XP
| dist     = 8
| params   = none
| raw_sig  = 4:120+8:0:1452:65535,0:mss,nop,nop,sok:df,id+:0
|
`----

.-[ 1.2.3.4/1524 -> 4.3.2.1/80 (mtu) ]-
|
| client   = 1.2.3.4
| link     = DSL
| raw_mtu  = 1492
|
`----

.-[ 1.2.3.4/1524 -> 4.3.2.1/80 (uptime) ]-
|
| client   = 1.2.3.4
| uptime   = 0 days 11 hrs 16 min (modulo 198 days)
| raw_freq = 250.00 Hz
|
|
`----

.-[ 1.2.3.4/1524 -> 4.3.2.1/80 (http request) ]-
|
| client   = 1.2.3.4/1524
| app      = Firefox 5.x or newer
| lang     = English
| params   = none
| raw_sig  = 1:Host,User-Agent,Accept=[text/html,application/xhtml+xml...
|
`----
</xmp>


<h2>Can I have it?</h2>

<p>
Yup: <a href="https://lcamtuf.coredump.cx/p0f3/releases/p0f-3.09b.tgz">click here</a> to download the current release (3.09b), or <a href="https://lcamtuf.coredump.cx/p0f3/releases/">here</a> to browse
older releases, including 2.0.x and 1.8.x.
</p>


<p>
Please keep in mind that p0f v3 is a complete rewrite of the original tool, including a brand new database of signatures. We are starting
from scratch, so especially for the first few releases, please be sure to submit new signatures and report bugs with special zeal! I am particularly
interested in:
</p>

<ul>

<li> <p>TCP SYN (&#34;who is connecting to me?&#34;) signatures for a variety of systems - especially from some of the older, more exotic, or more specialized platforms,
such as Windows 9x, NetBSD, IRIX, Playstation, Cisco IOS, etc. To do this, you simply need to attempt establishing a connection to a box running p0f.
The connection does not need to succeed.</p>

</li><li> <p>TCP SYN+ACK signatures (&#34;who am I connecting to?&#34;). The current database is minimal, so all contributions are welcome. To collect these signatures, you
need to compile the supplied <i>p0f-sendsyn</i> tool, and then use it to initiate a connection to an open port on a remote host; see
<a href="https://lcamtuf.coredump.cx/p0f3/README">README</a> for more.</p>

</li><li> <p>HTTP request signatures - especially for older or more exotic browsers (e.g. MSIE5, mobile devices, gaming consoles), crawlers, command-line tools, and
libraries. To collect a signature, you can run p0f on the client system itself, or on the web server it talks to.</p>

</li><li> <p>HTTP response signatures. P0f ships with a minimal database here (only Apache 2.x has any real coverage). Signatures are best collected for three
separate cases: several minutes of casual browsing with a modern browser; a request with <i>curl</i>; and another one with <i>wget</i>.</p>

</li></ul>

<h2>Can I see it in action?</h2>

<p>
I had a demo set up here, but now that my server is behind a load balancer, it&#39;s no longer working - sorry.
</p>

<h2>Contact</h2>

<p>
Please submit questions, comments, patches, signatures, and chocolate to
&lt;<a href="mailto:lcamtuf@coredump.cx">lcamtuf@coredump.cx</a>&gt;. You can also
<a href="https://twitter.com/lcamtuf">follow me on Twitter</a>.
For other features, check out <a href="https://lcamtuf.coredump.cx/">my homepage</a>.
</p>
</div>
  </body>
</html>
