<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://eieio.games/essays/my-computer-tells-me-to-go-to-bed/">Original</a>
    <h1>My Computer Tells Me to Go to Bed</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
    <p>Every night at 12:15 AM my computer tells me to go to bed.</p>

<p>No, really. A voice says “time to sleep.” Then this window pops up:</p>

<p><img src="http://eieio.games/assets/images/go-to-bed/popup.png"/>
</p>
<p>yeah, it&#39;s a little verbose</p>

<p>If I hit “ok” the window pops up again a minute later. Sometimes I move the popup out of view and ignore it for a few minutes. Sometimes I snooze it and keep coding (or writing - it’s 12:28 AM right now). But most of the time I go to bed.</p>

<!-- excerpt-end -->


<p>I am a night owl. I like to stay up late.</p>

<p>Sometimes that’s fine! I’ve accepted that when I’m deep in the weeds <a href="http://eieio.games/nonsense/game-11-flappy-bird-finder">optimizing finder display speeds</a> I do much of my best work at night, and I don’t want to prevent that.</p>

<p>But this easily carries over to nights where I’m <em>not</em> doing anything worthwhile. And on those nights staying up late on my computer means looking at the same few reddit, hacker news, twitter, and twitch tabs. I don’t get much out of this; I’m happier when I just go to bed.</p>

<p>This has always been a problem for me. But it’s a bigger problem because I <a href="http://eieio.games/whats-my-deal">work for myself</a> right now. There’s no pressure on me to wake up for a job; if I stay up too late I can just sleep in.</p>

<p>I’ve found that a 3:30 AM bedtime means that I can either have a fun social life or a productive work life but not both. I want both. And this is an effective way to nudge myself towards behavior that makes me long-term happy.</p>

<p>These popups help me because they:</p>
<ul>
  <li>Are easy to snooze when I need to. Snoozing them is just editing a file; I never hesitate to edit the file when I’m doing something interesting.</li>
  <li>Are hard to snooze when I shouldn’t. I mean, they’re not <em>literally</em> hard to snooze, but I know that I’m going against the spirit of the popup if I snooze them to hit “more” on Hacker News.</li>
  <li>Are easy to ignore for a minute if need be - I can move it to the side of the screen to finish reading something.</li>
  <li>Are hard to ignore forever - it’s an always on top window! It’s annoying! It gets in the way!</li>
</ul>


<p>I have a script called <code>go-to-bed.sh</code> in my <code>~/bin</code>. I run it out of cron:</p>

<div><div><pre><code>% crontab <span>-l</span>
<span>*</span> <span>*</span> <span>*</span> <span>*</span> <span>*</span> /Users/nroyalty/bin/go-to-bed.sh <span>-from-cron</span>
</code></pre></div></div>
<p>I specify `-from-cron` to make the script a little easier to test. </p>

<p>The script starts by grepping <code>ps</code> to see if there’s already an undismissed ‘Time to Sleep’ notification displayed and exits if there is - this prevents it from piling up notifications. It then does some math to check whether the current time is between the bounds in my <code>~/.go-to-sleep</code> file and, if it is, uses <code>afplay</code>, <code>say</code>, and some AppleScript to play a sound, make a voice say “Time to Sleep”, and display a popup window.</p>

<p>You can grab the script from <a href="https://gist.github.com/nolenroyalty/5c27c7bea201806bf35a99d79debc280">this gist</a>. Here it is in full:</p>
<div><div><pre><code><span>#!/usr/bin/env bash -x</span>

<span># config file looks like</span>
<span>#START_TIME:0.16</span>
<span>#END_TIME:6.0</span>
<span>#HUSHED_UNTIL:2023-11-23T1:40:00</span>

<span>if</span> <span>[</span> <span>&#34;</span><span>$1</span><span>&#34;</span> <span>=</span> <span>&#34;-from-cron&#34;</span> <span>]</span>
<span>then
    if </span>ps aux | <span>grep </span>osascript | <span>grep</span> <span>-q</span> <span>&#39;Time to Sleep&#39;</span>
    <span>then
        </span><span>echo </span>There is probably a pending window, exiting
        <span>exit </span>0
    <span>fi
fi

</span><span>alert_title</span><span>=</span><span>&#34;Time to Sleep&#34;</span>
<span>alert_message</span><span>=</span><span>$(</span>
<span>cat</span> <span>&lt;&lt;</span><span>&#39;</span><span>EOF</span><span>&#39;
Most of the time when you are using your computer at this hour you aren&#39;t doing anything worthwhile.
If you&#39;re programming or doing something else cool, edit ~/.go-to-bed to hush this message until tomorrow.
Otherwise you should consider sleeping or doing something more fun! Read a book or a new yorker article. Play a game. Play your piano.
</span><span>EOF
</span><span>)</span>
<span>start_time</span><span>=</span><span>$(</span><span>cat</span> ~/.go-to-bed | <span>grep </span>START_TIME | <span>cut</span> <span>-d</span>: <span>-f2</span><span>)</span>
<span>end_time</span><span>=</span><span>$(</span><span>cat</span> ~/.go-to-bed | <span>grep </span>END_TIME | <span>cut</span> <span>-d</span>: <span>-f2</span><span>)</span>
<span>time</span><span>=</span><span>$(</span><span>date</span> +%H.%M<span>)</span>

convert_to_minutes<span>()</span> <span>{</span>
    <span>hours</span><span>=</span><span>$(</span><span>echo</span> <span>$1</span> | <span>cut</span> <span>-d</span><span>.</span> <span>-f1</span><span>)</span>
    <span>minutes</span><span>=</span><span>$(</span><span>echo</span> <span>$1</span> | <span>cut</span> <span>-d</span><span>.</span> <span>-f2</span><span>)</span>
    <span>echo</span> <span>$((</span><span>10</span><span>#$hours * 60 + 10#$minutes))</span>
<span>}</span>

<span># Convert HH:MM to minutes</span>
<span>start_minutes</span><span>=</span><span>$(</span>convert_to_minutes <span>$start_time</span><span>)</span>
<span>end_minutes</span><span>=</span><span>$(</span>convert_to_minutes <span>$end_time</span><span>)</span>
<span>current_minutes</span><span>=</span><span>$(</span>convert_to_minutes <span>$time</span><span>)</span>

<span>if</span> <span>((</span> <span>$current_minutes</span> <span>&gt;=</span> <span>$start_minutes</span> <span>&amp;&amp;</span> <span>$current_minutes</span> &lt; <span>$end_minutes</span> <span>))</span>
<span>then
    </span><span>echo </span><span>in </span>window, maybe notifying
    <span>hush_time</span><span>=</span><span>$(</span><span>cat</span> ~/.go-to-bed | <span>grep </span>HUSHED_UNTIL | <span>cut</span> <span>-d</span>: <span>-f2-</span><span>)</span>
    <span>zone</span><span>=</span><span>$(</span><span>date</span> +%z<span>)</span>
    <span>sec_hush</span><span>=</span><span>$(</span><span>date</span> <span>-j</span> <span>-f</span> <span>&#39;%Y-%m-%dT%H:%M:%S%z&#39;</span> <span>&#34;</span><span>${</span><span>hush_time</span><span>}${</span><span>zone</span><span>}</span><span>&#34;</span> +<span>&#34;%s&#34;</span><span>)</span>
    <span>sec_now</span><span>=</span><span>$(</span><span>date</span> +%s<span>)</span>

    <span>if</span> <span>((</span> <span>$sec_hush</span> <span>&gt;</span> <span>$sec_now</span> <span>))</span>
    <span>then
        </span><span>echo </span>hushed, doing nothing
    <span>else
        </span><span>echo </span>notifiying
        afplay /System/Library/Sounds/Blow.aiff
        say <span>-v</span> Daniel <span>time </span>to <span>sleep
        </span>osascript <span>-e</span> <span>&#34;display alert </span><span>\&#34;</span><span>${</span><span>alert_title</span><span>}</span><span>\&#34;</span><span> message </span><span>\&#34;</span><span>${</span><span>alert_message</span><span>}</span><span>\&#34;</span><span>&#34;</span>
    <span>fi
fi</span>
</code></pre></div></div>

<p>I hope you get use out of this script; I’ve been using it for a few months and it’s been tremendously helpful for me.</p>

<p>It’s also prompted me to push my “get off the computer if you’re just messing around” threshold earlier. I originally had the script prompt me at 2 AM. I’ve repeatedly moved that back; right now it’s at 12:15 AM. And writing this post made me realize that those 15 minutes aren’t doing me any favors - so I’ve moved it to midnight.</p>

<p>Happy sleeping.</p>

  </div></div>
  </body>
</html>
