<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.ret2.io/2023/08/09/jtag-hacking-the-original-xbox-2023/">Original</a>
    <h1>JTAG &#39;Hacking&#39; the Original Xbox in 2023</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
    <p>Released in November 2001, the <a href="https://en.wikipedia.org/wiki/Xbox_(console)">original Xbox</a> was Microsoft’s first venture into the game console industry. With its hardware closely resembling a cheap but versatile PC of the early 2000s, the device came under the immediate scrutiny of technical hobbyists looking to run ‘homebrew’ code and alternative operating systems on it.</p>

<p>Over the course of its lifetime, the Xbox was <a href="https://en.wikipedia.org/wiki/Xbox_modding">unilaterally hacked</a> through a broad range of both hardware and software attacks. But at 20 years old, this Intel-based <a href="https://en.wikipedia.org/wiki/Pentium_III">Pentium III</a> system holds up as an amazing platform to learn or explore a plethora of security and computer systems engineering topics that are still relevant to this day.</p>

<p>As a fun departure from our usual content, this post exploits some nostalgia to tackle <a href="https://www.bunniestudios.com/bunnie/proj/anatak/xboxmod.html#:~:text=good%20luck%20JTAG%20hackers...">a challenge</a> put forth by some of the earliest musings of the original Xbox researchers: “hacking” the original Xbox via Intel’s x86 CPU JTAG.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_connected.jpg" data-lightbox="xbox_JTAG_debugger_connected.jpg" data-title="Hardware debugging the original Xbox CPU (Pentium III) using a custom JTAG CPU interposer">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_connected.jpg" alt=""/>
    
    </a></p><p>Hardware debugging the original Xbox CPU (Pentium III) using a custom JTAG CPU interposer</p>
    
</div>

<!--more-->

<h2 id="about-the-original-xbox">About the Original Xbox</h2>

<p>Unlike some of the other early 2000s game consoles, the original Xbox was a remarkably straight-forward <a href="https://www.copetti.org/writings/consoles/xbox/">hardware platform</a> built around an Intel CPU + NVIDIA GPU with a unified memory architecture. Microsoft designed a system that would be easy to transition existing PC game developers onto, tapping into their dominance of the PC market.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_motherboard.jpg" data-lightbox="xbox_JTAG_motherboard.jpg" data-title="Original Xbox 1.0 motherboard: An ATX board with a 32-bit 733 MHz Intel Pentium III CPU and a custom NVIDIA GPU">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_motherboard.jpg" alt=""/>
    
    </a></p><p>Original Xbox 1.0 motherboard: An ATX board with a 32-bit 733 MHz Intel Pentium III CPU and a custom NVIDIA GPU</p>
    
</div>

<p>But the security of the Xbox leaned heavily on a “secret” 512 byte bootrom that was carefully hidden within the system’s custom NVIDIA <a href="https://www.cnet.com/culture/nvidia-reveals-details-of-xbox-mystery-chip/">MCPX</a> Southbridge to establish a chain of trust. Within three months of launch, this secret bootrom was infamously dumped by Andrew “<a href="https://en.wikipedia.org/wiki/Andrew_Huang_(hacker)">bunnie</a>” Huang blowing the console wide open to further research.</p>

<p>Bunnie dumped the secret ROM using an FPGA to sniff the ROM on the <a href="https://en.wikipedia.org/wiki/HyperTransport">HyperTransport</a> bus as it left the MCPX on its way to the Northbridge / GPU, before traveling over the <a href="https://en.wikipedia.org/wiki/Front-side_bus">Front-side bus</a> to the CPU. This attack (among others) is described in great detail in bunnie’s 2003 book: <em><a href="https://nostarch.com/xboxfree">“Hacking The Xbox”</a> (now free.)</em></p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_mcpx.jpg" data-lightbox="xbox_JTAG_mcpx.jpg" data-title="The MCPX is the Media Communication Processor (southbridge) which also plays host to the secret ROM">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_mcpx.jpg" alt=""/>
    
    </a></p><p>The MCPX is the &#34;Media Communication Processor&#34; (southbridge) which also plays host to the secret ROM</p>
    
</div>

<p>Looking back at the race to dump secret ROM, there was some amount of <a href="https://www.bunniestudios.com/bunnie/proj/anatak/xboxmod.html">discussion</a> which weighed trying to use Intel’s CPU JTAG functionality to probe the system and read out this elusive bootloader:</p>

<blockquote>
  <p>“The JTAG boundary scan approach was rejected on the grounds that the TRST# pin, used to hold the JTAG chain in reset, was tied active in a manner that was difficult to modify without removing the processor.”</p>

  <p>– Excerpt from <a href="https://dspace.mit.edu/handle/1721.1/6694">Keeping Secrets in Hardware: The Microsoft Xbox (TM) Case Study</a>, by Andrew Huang, 2002</p>

</blockquote>

<p>Microsoft had intentionally tied the <a href="https://en.wikipedia.org/wiki/JTAG#:~:text=The%20TRST%20pin,chip%20being%20debugged.">TRST#</a> pin to ground underneath the Xbox CPU in an effort to disable the Intel JTAG interface and dissuade anyone from poking around.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_retail.jpg" data-lightbox="xbox_JTAG_CPU_retail.jpg" data-title="Original Xbox CPU: 32-bit 733 MHz Intel Pentium III with 128 KB L2 cache as a mobile BGA2 chip package">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_retail.jpg" alt=""/>
    
    </a></p><p>Original Xbox CPU: 32-bit 733 MHz Intel Pentium III with 128 KB L2 cache as a mobile BGA2 chip package</p>
    
</div>

<p>More importantly, blackbox reversing Intel’s private JTAG instructions in order to query memory, registers, or perform other debugger-like actions was considered non-trivial:</p>

<blockquote>

  <p>“Removal and socketing of the processor was considered to be prohibitively expensive and time consuming; the cost of a BGA socket for the Pentium III is estimated to be in the hundreds to thousands of dollars. In addition, the JTAG boundary scan codes for the Pentium III are largely proprietary and would have to be reverse engineered as well…”</p>

  <p>– Excerpt from <a href="https://dspace.mit.edu/handle/1721.1/6694">Keeping Secrets in Hardware: The Microsoft Xbox (TM) Case Study</a>, by Andrew Huang, 2002</p>
</blockquote>

<p>But as the Xbox homebrew ecosystem flourished over the next several years, a <a href="https://www.youtube.com/watch?v=6fOjGLCctEY">slew of other methods</a> were discovered to cheaply break, dump, or escape the chain of trust Microsoft had tried to establish with the secret ROM. There was little incentive pursuing these more challenging hardware attacks, so they were left behind and largely forgotten.</p>

<h2 id="intel-x86-jtag">Intel x86 JTAG</h2>

<p>While there is little else to be gained from new methods to dump or bypass secret ROM today, the ability to hardware debug the Xbox CPU would still provide unrivaled introspection to further study and preserve the rich history of the platform. Some of the benefits of JTAG debugging the CPU includes:</p>

<ul>
  <li>Debug the system from the very first instruction executed (a.k.a the <a href="https://en.wikipedia.org/wiki/Reset_vector">reset vector</a>)</li>
  <li>Non-intrusive debugging without modifying the OS or any software running on the hardware</li>
  <li>Debugging retail BIOS images and other runtimes without native kernel debugging capabilities</li>
  <li>If it runs on the CPU, you can debug it – the Xbox Kernel, Linux, a custom RTOS, Windows (etc.)</li>
  <li>JTAG surpasses <a href="https://github.com/xemu-project/xemu">emulators</a> in fidelity for studying hardware-specific behavior and un-emulated peripherals</li>
</ul>

<p>Yet, twenty years later there is zero open-source hardware or software solutions privy to Intel’s private JTAG instructions… which seem odd given how ubiquitous x86 is. The alternative, locating a semi-complete <em>“highly proprietary”</em> hardware debugger (and its software components) from days past, is almost equally as challenging:</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_CodeTAP_debugger.jpg" data-lightbox="xbox_JTAG_CodeTAP_debugger.jpg" data-title="An Applied Microsystems CodeTAP debugger for Intel Pentium II / III, purchased AS IS">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_CodeTAP_debugger.jpg" alt=""/>
    
    </a></p><p>An Applied Microsystems CodeTAP debugger for Intel Pentium II / III, purchased &#34;AS IS&#34;</p>
    
</div>

<p>From my research, the best Pentium III debuggers (maybe even the only ones) of the early 2000s were made by <a href="https://web.archive.org/web/20020926010023/http://www.arium.com/">American Arium</a> and <a href="https://web.archive.org/web/20020124114635/http://www.amc.com/">Applied Microsystems</a>. These ranged from as low as <a href="https://www.eetimes.com/applied-microsystems-supports-intel-pentium-ii-and-celeron-processors-with-newcodetap-jtag-emulators/">$9k</a> to over $40k USD for some of the Arium units. Allegedly, Intel bound these firms by 10-15 year NDAs when developing these solutions.</p>

<p>The main customer of these debuggers would have primarily been OEMs performing hardware validation or BIOS/firmware development while stabilizing new motherboards. With a pretty narrow market, there’s no more than a few thousand hardware debuggers of this period produced by either company.</p>

<p>In 2023 these vintage hardware debuggers seldom pop up, and aren’t <a href="https://www.ebay.com/itm/323775509467">bought</a> for much more than $25-75 USD.</p>

<h2 id="rolling-your-own-cpu-jtag">Rolling Your Own CPU JTAG</h2>

<p>One of the more challenging aspects of tackling JTAG on Xbox is the fact that TRST# was tied to ground under the CPU. While yes, in theory drilling out the connection to release TRST# may allow us to drive the JTAG state machine, I had no clue how the CodeTAP / hardware debugger might respond to TRST# not operating as expected.</p>

<p>I began reviewing old Intel <a href="https://www.intel.com/content/dam/support/us/en/documents/processors/mobile/celeron/sb/28365403.pdf">processor</a> datasheets, hardware <a href="https://download.intel.com/design/PentiumII/manuals/24400101.pdf">developer manuals</a>, motherboard <a href="https://web.archive.org/web/20030711134843/http://intel.com/design/intarch/manuals/27333303.pdf">reference designs</a>, and platform recommendations of the era to start piecing together a better understanding of how these hardware debuggers are meant to physically interface with the CPU.</p>



<p>As predominantly a software researcher by trade, manipulating the physical integration of an Intel CPU is not something I wanted to cut corners on. In order to remove all hardware ambiguity, I decided it would be best to design a CPU interposer PCB to cleanly breakout the JTAG signals, adapting from Intel’s specifications to rebuild an ITP port.</p>

<p>A dedicated CPU interposer would allow me to isolate the JTAG signals (and other CPU control signals) while skipping reverse engineering anything else the Xbox motherboard may have been doing to them. This would also enable me to neatly collect the relevant signals into a physical port the debugger normally expected to tap.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_kicad_layers.png" data-lightbox="xbox_JTAG_kicad_layers.png" data-title="Designing the 4-layer CPU JTAG breakout interposer in &lt;a href=https://www.kicad.org/&gt;KiCad&lt;/a&gt; 7.0">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_kicad_layers.png" alt=""/>
    
    </a></p><p>Designing the 4-layer CPU JTAG breakout interposer in <a href="https://www.kicad.org/">KiCad</a> 7.0</p>
    
</div>

<p>The large majority of CPU signals simply plunge through the 4-layer CPU interposer PCB 1-for-1. This interposer was originally designed simply as a 2 layer PCB, but was bumped up to 4 layers after some peer-review and negligible cost differential of hobbyist PCB production today.</p>

<p>The JTAG / CPU control signals of interest are pulled out using an internal routing layer (green), with the second internal layer (hidden above) simply serving as a ground plane. The breakout is a 30 pin SMT <a href="https://www.te.com/usa-en/products/brands/ampmodu/ampmodusystem50.html?tab=pgp-story">System 50</a> connector per Intel specs – the header alone cost $15 USD.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_kicad_render.png" data-lightbox="xbox_JTAG_kicad_render.png" data-title="A render of the JTAG breakout interposer PCB from KiCad, prior to physical order">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_kicad_render.png" alt=""/>
    
    </a></p><p>A render of the JTAG breakout interposer PCB from KiCad, prior to physical order</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_interposers.jpg" data-lightbox="xbox_JTAG_CPU_interposers.jpg" data-title="Five JTAG breakout interposers, fresh from JLCPCB">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_interposers.jpg" alt=""/>
    
    </a></p><p>Five JTAG breakout interposers, fresh from JLCPCB</p>
    
</div>

<p>The minimum order of five 4-layer ENIG PCBs from JLCPCB cost $20 USD, and $20 for DHL shipping. While waiting on the JTAG interposer PCBs to arrive, I reballed a loose Xbox CPU or two I had leftover from a <a href="https://www.reddit.com/r/originalxbox/comments/117h672/i_completed_a_xbox_cpu_upgrade_what_games_do_you/">separate project</a>.</p>

<p>Eight days after ordering, I had the JTAG breakout CPU interposers in-hand and a board ready for the install attempt.</p>

<h2 id="installing-the-jtag-breakout-cpu-interposer">Installing the JTAG breakout CPU Interposer</h2>

<p>Even with semi-professional equipment, installing the JTAG breakout interposer is a tedious process that will be unforgiving of errors. The following image series depicts the rough sequence of steps for removing the original CPU and installing the JTAG interposer.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_removal.jpg" data-lightbox="xbox_JTAG_BGA_removal.jpg" data-title="The original Xbox CPU with flux around it to aid in reflow, under a BGA rework station, prior to chip removal">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_removal.jpg" alt=""/>
    
    </a></p><p>The original Xbox CPU with flux around it to aid in reflow, under a BGA rework station, prior to chip removal</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_pads.jpg" data-lightbox="xbox_JTAG_CPU_pads.jpg" data-title="The BGA footprint of the original Xbox CPU after removal from the motherboard and pad cleanup">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_pads.jpg" alt=""/>
    
    </a></p><p>The BGA footprint of the original Xbox CPU after removal from the motherboard and pad cleanup</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_interposer_reball.jpg" data-lightbox="xbox_JTAG_CPU_interposer_reball.jpg" data-title="Bottom of JTAG breakout interposer, sitting in a 3D printed jig to aid with reballing alignment (0.76mm balls, leaded)">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_CPU_interposer_reball.jpg" alt=""/>
    
    </a></p><p>Bottom of JTAG breakout interposer, sitting in a 3D printed jig to aid with reballing alignment (0.76mm balls, leaded)</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_alignment.jpg" data-lightbox="xbox_JTAG_interposer_alignment.jpg" data-title="A test fit of the JTAG interposer and its expected alignment prior to final install">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_alignment.jpg" alt=""/>
    
    </a></p><p>A test fit of the JTAG interposer and its expected alignment prior to final install</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_reflow.jpg" data-lightbox="xbox_JTAG_BGA_reflow.jpg" data-title="CPU and interposer on a cheap BGA rework station, both about to be soldered during a single reflow profile">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_reflow.jpg" alt=""/>
    
    </a></p><p>CPU and interposer on a cheap BGA rework station, both about to be soldered during a single reflow profile</p>
    
</div>

<p>The most critical part of the install was nailing the alignment and reflow of not just one, but BOTH ball-grid-arrays for welding over a single rework profile. While I had some kapton to help better ensure alignment of the bottom array (interposer to motherboard), the top ball array (CPU to interposer) was done by eye.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_sandwich.png" data-lightbox="xbox_JTAG_BGA_sandwich.png" data-title="BGA camera of CPU + interposer stackup, after the BGA profile has completed the reflow profile">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_BGA_sandwich.png" alt=""/>
    
    </a></p><p>BGA camera of CPU + interposer stackup, after the BGA profile has completed the reflow profile</p>
    
</div>

<p>Some “supports” (no-op SMD resistors) were put underneath the header portion of the interposer prior to reflow. While these supports are not visible and do not serve any electrical purpose, they provide some mechanical strength to help prevent stress or cracking of BGA balls when plugging or un-plugging the JTAG ribbon.</p>

<p>As a prototype, I wasn’t even sure this JTAG interposer (or the install) would be without error so I wasn’t too concerned about ideal construction or longevity for this attempt at a proof-of-concept.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_attached.jpg" data-lightbox="xbox_JTAG_interposer_attached.jpg" data-title="The successfully installed JTAG interposer - the system was able to boot normally at this point">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_attached.jpg" alt=""/>
    
    </a></p><p>The successfully installed JTAG interposer - the system was able to boot normally at this point</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_final.jpg" data-lightbox="xbox_JTAG_interposer_final.jpg" data-title="The fully populated JTAG interposer ready for testing with the CodeTAP hardware debugger">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_interposer_final.jpg" alt=""/>
    
    </a></p><p>The fully populated JTAG interposer ready for testing with the CodeTAP hardware debugger</p>
    
</div>

<p>The interposer is populated by hand after completing the reflow process. I did not trust the 30-pin header to not melt under the heat required to solder the CPU and JTAG interposer. Given the complexity of this install and using an un-vetted design to interpose 150 sensitive CPU signals, things went remarkably smooth.</p>

<p>With the CPU interposer installed, thankfully the Xbox boots as one would normally expect. But would JTAG work?</p>

<h2 id="dumping-secret-rom">Dumping Secret ROM</h2>

<p>Testing the JTAG setup for the first time was difficult because I had zero clue what a “normal” attach sequence would look like for both the hardware and software and no documentation. I had acquired the CodeTAP “AS-IS” and struggled to find a Pentium II / III motherboard with an ITP port (usually rare engineering boards) to test it against.</p>

<p>Plugging the hardware debugger into my JTAG interposer and connecting the software (CAD-UL XDB) to it, the Xbox would “FRAG” (flashing-red-and-green, a general system fault state) when trying to boot.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_connected.jpg" data-lightbox="xbox_JTAG_debugger_connected.jpg" data-title="Plugging the CodeTAP JTAG debugger into the interposer when prepping the board post-install">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_connected.jpg" alt=""/>
    
    </a></p><p>Plugging the CodeTAP JTAG debugger into the interposer when prepping the board post-install</p>
    
</div>

<p>The debugger software kept failing to attach stating <em>“Target RESET asserted”</em> while the CodeTAP hardware wasn’t even indicating it could sense power from the target (TGTPWR). I had a slight suspicion of what the issue could be, but triple checked my schematics, pinout, and probed across the motherboard to verify that the CPU was indeed being RESET.</p>

<p>The source of the problem is that System Management Controller (a <a href="https://en.wikipedia.org/wiki/PIC_microcontrollers">PIC16</a> MCU) on the original Xbox expects the CPU to pass a set of system integrity tests within about 200ms of boot or it will reset the entire device chain. I had configured the debugger to resume on system attach, but apparently this was not working, or not the way I expected it to.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_smc_probing.jpg" data-lightbox="xbox_JTAG_smc_probing.jpg" data-title="Probing signals off the SMC with a logic analyzer while also injecting messages on I2C">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_smc_probing.jpg" alt=""/>
    
    </a></p><p>Probing signals off the SMC with a logic analyzer while also injecting messages on I2C</p>
    
</div>

<p>I put together a small sketch for an <a href="https://en.wikipedia.org/wiki/Arduino_Uno">Arduino Uno</a> and placed it on the <a href="https://en.wikipedia.org/wiki/I%C2%B2C">I2C</a> bus that normally runs between the SMC and MCPX. This way, I could fulfill the SMC’s system integrity challenges in lieu of normal CPU execution.</p>

<p>All at once, everything had suddenly clicked into place and the JTAG debugger attached – I had glimpsed the CPU reset vector of the Xbox’s original 1.0 secret ROM, in all its glory:</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_reset.png" data-lightbox="xbox_JTAG_debugger_reset.png" data-title="CAD-UL XDB (JTAG debugging software) initial attach, at the Xbox&#39;s CPU reset vector">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_reset.png" alt=""/>
    
    </a></p><p>CAD-UL XDB (JTAG debugging software) initial attach, at the Xbox&#39;s CPU reset vector</p>
    
</div>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_dump_censored.png" data-lightbox="xbox_JTAG_debugger_dump_censored.png" data-title="Navigating to the top 512 bytes of memory, dumping the infamous MCPX secret ROM 1.0 via JTAG">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_dump_censored.png" alt=""/>
    
    </a></p><p>Navigating to the top 512 bytes of memory, dumping the infamous MCPX secret ROM 1.0 via JTAG</p>
    
</div>

<p>After fighting to get acquainted with the debugger and a few system resets, I was able to navigate the XDB memory view to the top 512 bytes of system memory (around the reset vector) - dumping the complete, original 1.0 secret bootrom, from a retail Xbox motherboard, using JTAG.</p>

<p><strong>Finally</strong>, one of the oldest theoretical attacks against the system - put to rest.</p>

<h2 id="continued-discovery">Continued Discovery</h2>

<p>Blending nostalgic curiosities with a fun opportunity for establishing a deeper appreciation of computer hardware was the real purpose of this research. Further, the ability to hardware debug the Xbox CPU opens up several new tangential projects that I find personally interesting towards further research of the platform and general OS internals.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_final_setup.jpg" data-lightbox="xbox_JTAG_final_setup.jpg" data-title="The pure chaos of JTAG hacking the Original Xbox, 20 years in the making">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_final_setup.jpg" alt=""/>
    
    </a></p><p>The pure chaos of JTAG hacking the Original Xbox, 20 years in the making</p>
    
</div>

<p>While insufficient, Microsoft made active effort to layer security mechanisms in the Xbox. Having released TRST# via the interposer, satisfied SMC security challenges with an arduino, and dumped secret ROM using JTAG… they hid one last trick to bind an abnormal CPU startup with a forced reset from MCPX a few seconds after boot.</p>

<p>Identifying the origin of this final reset, its history within the system, and ultimate disablement could be its own separate blogpost, highlighting that perhaps there are a few mysteries within the Xbox still worth contextualizing.</p>

<div>
    
    <p><a href="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_running.png" data-lightbox="xbox_JTAG_debugger_running.png" data-title="A screenshot of breaking with the JTAG debugger while the system is fully up and running">
    
      <img src="https://blog.ret2.io/assets/img/xbox_JTAG_debugger_running.png" alt=""/>
    
    </a></p><p>A screenshot of breaking with the JTAG debugger while the system is fully up and running</p>
    
</div>

<p>With Intel JTAG on Xbox now fully functioning, there is less uncertainty in refining this work by eliminating the arduino and likely even the CPU interposer. Over the longer term, this Pentium III JTAG setup provides a good basis for studying the private Intel JTAG instructions as a derivative of this work with broader application.</p>

<p>If you are interested or familiar with bespoke Intel JTAG technologies, please consider contributing (what you can) to the fledgling open knowledgebase being established <a href="https://github.com/Necrosys/x86-JTAG-Information">here</a> on GitHub. This is one of the only modern resources aimed at preserving or documenting x86 JTAG, which proved important in the work described by this post.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This blogpost revisited an old idea that the original Microsoft Xbox could have been hacked through Intel’s x86 CPU JTAG interface. A custom CPU interposer PCB was created to breakout the JTAG signals to a CodeTAP hardware debugger. The secret Xbox bootrom was successfully dumped via Intel JTAG, with real debug capabilities from the very first instruction of execution - closing the chapter on a 20 year old theory.</p>

<p>Hardware CPU debugging can offer unique system introspection over more traditional software and OS-based kernel debugging technologies. These types of hardware solutions used to be highly proprietary and very little public information exists for them, making this a challenging but equally rewarding research experience.</p>

  </div></div>
  </body>
</html>
