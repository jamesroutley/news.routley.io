<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/rhalkyard/SEthernet">Original</a>
    <h1>SEthernet: Modern, low-cost 10/100 Ethernet for the Macintosh SE and SE/30</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">Modern, low-cost 10/100 Ethernet for the Macintosh SE and SE/30.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-introduction" aria-hidden="true" tabindex="-1" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Introduction</h2>
<p dir="auto">It&#39;s an unfortunate reality of retrocomputing that, as time goes on, original
hardware only ever becomes more scarce, and usually more expensive.</p>
<p dir="auto">While PDS ethernet cards are certainly not <em>scarce</em> yet, the collector appeal of
Compact Macs means that cards are in high demand, with consequent high prices.
As of this writing (October 2023), the going eBay rate for them seems to be of
the order of $US 150-200, which is a bit steep for those of us who remember
finding them in electronics-recycler dollar bins.</p>
<p dir="auto">While other projects have aimed to clone these original cards, such an approach
comes with a downside - the ethernet controller chips used in them have been out
of production for many years, and the controllers and (even more so) their
supporting components, are difficult to find.</p>
<p dir="auto">While cloned cards trade off parts sourcing difficutly (and cost) for the
significant advantage of being able to use existing drivers, this project takes
the opposite approach: design an all-new card using a modern, readily-available
ethernet controller, and write a new driver for it. How hard can it be?
<sup><a href="#user-content-fn-howhard-15b6f302dc8765c0bebb5c01adb3a8a0" id="user-content-fnref-howhard-15b6f302dc8765c0bebb5c01adb3a8a0" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-hardware-overview" aria-hidden="true" tabindex="-1" href="#hardware-overview"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Hardware Overview</h2>
<p dir="auto">Both the SEthernet and SEthernet/30 use the Microchip
<a href="https://ww1.microchip.com/downloads/aemDocuments/documents/OTH/ProductDocuments/DataSheets/39935c.pdf" rel="nofollow">ENC624J600</a>
all-in-one embedded ethernet controller. It&#39;s cheap, readily available, has a
straightforward software interface without any glaring misfeatures (I&#39;m looking
at you, RTL8019AS), and amongst its multitude of configurable host-bus modes, it
has one that matches the 68k processor bus nicely.</p>
<p dir="auto">Since the Macintosh SE lacks any real infrastructure for expansion beyond
&#34;here&#39;s a connector with the CPU bus on it,&#34; the SEthernet board is a very dumb
device. It simply maps the ENC624J600 into a vacant chunk of memory at <code>0x80 0000</code>-<code>0x80 ffff</code> and connects it to an interrupt line. Hardware detection,
interrupt vector interception, and device configuration are all left to the
driver to implement.</p>
<p dir="auto">The Macintosh SE/30 is a more civilised machine, and the SEthernet/30 provides a
<a href="https://github.com/rhalkyard/SEthernet/blob/main/rom/se30">declaration ROM</a> and multiple addressing options (configurable by
jumper) to take full advantage of the Slot Manager and coexist with multiple PDS
cards. Potentially, the driver could even be built into the declaration ROM,
allowing for a truly plug-and-play solution. To facilitate driver updates, the
declaration ROM is a flash chip, with logic to allow for in-system programming.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-current-project-status" aria-hidden="true" tabindex="-1" href="#current-project-status"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Current project status</h2>
<p dir="auto">Very early days yet! Pardon my dust as I get this repo organised, more thorough
writeups are hopefully forthcoming.</p>
<p dir="auto">Rev0 boards have been ordered for the SE and SE/30, and the driver and glue
logic are theoretically complete but untested and almost certainly broken in
many fun and exciting ways.</p>
<p dir="auto">The plan is, once the boards arrive, to bring up the SE board first, given that
its glue logic is simpler. Once that&#39;s functional, I&#39;ll move on to the SE/30.</p>
<p dir="auto">A subsequent revision will likely eliminate the awful through-hole PLCC sockets
for directly-soldered surface-mount chips. This should make for much better
routing and potentially free up board real estate for a PDS pass through slot in
the SE/30 card.</p>
<p dir="auto">While I would like to produce a small production run of these once the design
has stabilised, that is likely a ways off at this point.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-project-files" aria-hidden="true" tabindex="-1" href="#project-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Project files</h2>
<p dir="auto">Schematics: <a href="https://github.com/rhalkyard/SEthernet/blob/main/boards/se/se.pdf">SEthernet</a> -
<a href="https://github.com/rhalkyard/SEthernet/blob/main/boards/se30/se30.pdf">SEthernet/30</a> - <a href="https://github.com/rhalkyard/SEthernet/blob/main/boards/breakout/breakout.pdf">Breakout Board</a></p>
<p dir="auto">Glue Logic: <a href="https://github.com/rhalkyard/SEthernet/blob/main/pld/se">SEthernet</a> - <a href="https://github.com/rhalkyard/SEthernet/blob/main/pld/se30">SEthernet/30</a></p>
<p dir="auto"><a href="https://github.com/rhalkyard/SEthernet/blob/main/rom/se30">SEthernet30 Declaration ROM</a></p>
<p dir="auto"><a href="https://github.com/rhalkyard/SEthernet/blob/main/software/driver">Driver</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-required-tools" aria-hidden="true" tabindex="-1" href="#required-tools"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Required tools</h2>
<p dir="auto">Schematics, board layout and BOM: <a href="https://www.kicad.org/" rel="nofollow">KiCad 7</a></p>
<p dir="auto">Programmable Logic: <a href="https://www.microchip.com/en-us/products/fpgas-and-plds/spld-cplds/pld-design-resources" rel="nofollow">WinCUPL</a>
(see <a href="https://github.com/rhalkyard/SEthernet/blob/main/pld/README.md"><code>pld/README.md</code></a> for notes on WinCUPL)</p>
<p dir="auto">Declaration ROM, driver and software:
<a href="https://github.com/autc04/Retro68">Retro68</a>, <a href="https://cmake.org/" rel="nofollow">CMake</a> and
<a href="https://www.python.org" rel="nofollow">Python 3</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-errata" aria-hidden="true" tabindex="-1" href="#errata"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Errata</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-revision-0" aria-hidden="true" tabindex="-1" href="#revision-0"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Revision 0</h3>
<h4 tabindex="-1" dir="auto"><a id="user-content-enc624j600-is-erroneously-configured-into-spi-mode" aria-hidden="true" tabindex="-1" href="#enc624j600-is-erroneously-configured-into-spi-mode"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>ENC624J600 is erroneously configured into SPI mode</h4>
<p dir="auto">The combined <code>SPISEL</code>/<code>/INT</code> pin on the ENC624J600 is pulled up instead of down.
This causes the ENC624J600 to be configured into SPI mode rather than parallel
mode, which is not much use to us.</p>
<h5 tabindex="-1" dir="auto"><a id="user-content-symptoms" aria-hidden="true" tabindex="-1" href="#symptoms"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Symptoms</h5>
<p dir="auto">Card does not function.</p>
<h5 tabindex="-1" dir="auto"><a id="user-content-workaround" aria-hidden="true" tabindex="-1" href="#workaround"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Workaround</h5>
<p dir="auto">Break the track between the <code>SPISEL</code> pullup resistor (R5 on SEthernet, R2 on
SEthernet/30) and 3.3V. Connect the resistor to ground instead.</p>
<h5 tabindex="-1" dir="auto"><a id="user-content-resolution" aria-hidden="true" tabindex="-1" href="#resolution"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Resolution</h5>
<p dir="auto">This issue has been resolved in the latest schematics for Revision 1.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-read-accesses-to-the-sethernet30-board-do-not-meet-timing-specifications" aria-hidden="true" tabindex="-1" href="#read-accesses-to-the-sethernet30-board-do-not-meet-timing-specifications"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Read accesses to the SEthernet/30 board do not meet timing specifications.</h4>
<h5 tabindex="-1" dir="auto"><a id="user-content-symptoms-1" aria-hidden="true" tabindex="-1" href="#symptoms-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Symptoms</h5>
<p dir="auto">Card operation is erratic.</p>
<h5 tabindex="-1" dir="auto"><a id="user-content-workaround-1" aria-hidden="true" tabindex="-1" href="#workaround-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Workaround</h5>
<p dir="auto">Insert wait states on read accesses</p>
<ul dir="auto">
<li>
<p dir="auto">Carefully cut the traces connecting U4 pin 4 to ground on both sides of the
board (a small countersink bit works well for this).</p>
</li>
<li>
<p dir="auto">Program a GAL16V8/ATF16V8 with the equations in
<a href="https://github.com/rhalkyard/SEthernet/blob/main/pld/se30/se30-bodge.pld"><code>pld/se30/se30-bodge.pld</code></a> and &#39;dead bug&#39; it to a
convenient place on the circuit board, connected as follows:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Pin #</th>
<th>Destination</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>U1, pin 33 (<code>CLKOUT</code>) or J1, pin c38 (<code>C16M</code>/<code>CPUCLK</code>) (see note below)</td>
</tr>
<tr>
<td>2</td>
<td>U3, pin 12 (<code>!ROM_CS</code>)</td>
</tr>
<tr>
<td>3</td>
<td>U3, pin 13 (<code>EN_CS</code>)</td>
</tr>
<tr>
<td>10, 11</td>
<td>Ground</td>
</tr>
<tr>
<td>12</td>
<td>U4, pin 4 (<code>WAIT</code>)</td>
</tr>
<tr>
<td>20</td>
<td>+5V</td>
</tr>
</tbody>
</table>
<p dir="auto">Connect a 0.1uF capacitor across pins 10 and 20.</p>
<p dir="auto">It is preferable to use the ENC624J600&#39;s software-configurable <code>CLKOUT</code> pin as a
clock source, but the clock signal available on pin c38 of the PDS connector
(16MHz <code>C16M</code> on the SE/30 and IIsi, 20MHz <code>CPUCLK</code> on the IIfx) can be used as
a more easily-soldered alternative.</p>
<p dir="auto">The default <code>CLKOUT</code> frequency of 4MHz (<code>COCON</code>=<code>1011</code>) gives ample timing margin, 25MHz (<code>COCON</code>=<code>0010</code>) gives
an optimal wait-state delay of 80 nanoseconds.</p>
<h5 tabindex="-1" dir="auto"><a id="user-content-resolution-1" aria-hidden="true" tabindex="-1" href="#resolution-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Resolution</h5>
<p dir="auto">Revision 1 glue logic will be implemented on single CPLD with configurable
wait-state generation built in.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-useful-reference-material" aria-hidden="true" tabindex="-1" href="#useful-reference-material"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Useful reference material</h2>
<ul dir="auto">
<li>
<p dir="auto"><a href="https://ww1.microchip.com/downloads/aemDocuments/documents/OTH/ProductDocuments/DataSheets/39935c.pdf" rel="nofollow">ENC624J600 datasheet</a></p>
</li>
<li>
<p dir="auto"><a href="https://www.vintageapple.org/inside_o/pdf/Designing_Cards_and_Drivers_for_the_Macintosh_Family_3rd_Edition_1992.pdf" rel="nofollow">Designing Cards and Drivers for the Macintosh Family (3rd
Edition)</a></p>
</li>
<li>
<p dir="auto"><a href="https://www.vintageapple.org/inside_r/pdf/Networking_1994.pdf" rel="nofollow">Inside Macintosh (1994): Networking</a></p>
</li>
<li>
<p dir="auto"><a href="https://www.vintageapple.org/inside_r/pdf/Devices_1994.pdf" rel="nofollow">Inside Macintosh (1994): Devices</a></p>
</li>
<li>
<p dir="auto"><a href="https://www.mactcp.net/ethernet.html" rel="nofollow">Glenn Anderson&#39;s ethernet driver page</a> -
contains C source for a DP8390-based card.</p>
</li>
<li>
<p dir="auto"><a href="https://vintageapple.org/macdrivers/network.shtml" rel="nofollow">Mac Driver Museum: Network
Drivers</a> - good material
for reverse-engineering. In particular, the Dayna ethernet drivers contain
debug symbols, which are quite handy for our purposes.</p>
</li>
<li>
<p dir="auto"><a href="http://www.synack.net/~bbraun/declrom.html" rel="nofollow">Rob Braun&#39;s declaration ROM page</a>
has useful information about declaration ROMs and how they work.</p>
</li>
</ul>
<section data-footnotes="">
<ol dir="auto">
<li id="user-content-fn-howhard-15b6f302dc8765c0bebb5c01adb3a8a0">
<p dir="auto">[Arrested Development narrator voice]: It was, in fact, quite hard <a href="#user-content-fnref-howhard-15b6f302dc8765c0bebb5c01adb3a8a0" data-footnote-backref="" aria-label="Back to reference 1">↩</a></p>
</li>
</ol>
</section>
</article>
          </div></div>
  </body>
</html>
