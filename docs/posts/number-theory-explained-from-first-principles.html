<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://explained-from-first-principles.com/number-theory/">Original</a>
    <h1>Number theory explained from first principles</h1>
    
    <div id="readability-page-1" class="page"><div>
        <article>

<svg id="svg-definitions" width="0" height="0" viewBox="0 0 0 0" xmlns="http://www.w3.org/2000/svg">
    <defs>

        <marker id="arrow" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-blue" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-purple" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-pink" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-red" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-orange" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-yellow" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-green" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-brown" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-gray" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-text" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>
        <marker id="arrow-background" orient="auto-start-reverse" markerWidth="4" markerHeight="4" refX="4" refY="2">
            <path d="M0,0 L1,2 L0,4 L4,2 Z"></path>
        </marker>

        <marker id="circle" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-blue" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-purple" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-pink" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-red" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-orange" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-yellow" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-green" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-brown" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-gray" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-text" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>
        <marker id="circle-background" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
            <circle cx="1.5" cy="1.5" r="1"></circle>
        </marker>

    </defs>
</svg>

<header>
    
    <p>explained from first principles</p>

    <p>
        This <a href="https://github.com/KasparEtter/ef1p/blob/main/pages/number-theory/number-theory.md">article</a>
        and its <a href="https://github.com/KasparEtter/ef1p/blob/main/pages/number-theory/number-theory.tsx">code</a> were
        first published on 17 September 2022.
        
        If you like the article,
        please share it with your friends on <a href="https://twitter.com/ExplainedFrom1P">social media</a>
        or support me with a <a href="https://riskmusings.substack.com/#donate">donation</a>.
        
        You can also
        join the <a href="https://www.reddit.com/r/ef1p/comments/xgsco5/number_theory_explained_from_first_principles/">discussion on Reddit</a>,
        <a id="pdf-download" href="https://riskmusings.substack.com/pages/number-theory/generated/2022-09-17%20Number%20theory%20explained%20from%20first%20principles.pdf" download="">download the article</a> as a PDF,
        see what people are <a href="https://twitter.com/search?q=https%3A%2F%2Fexplained-from-first-principles.com%2Fnumber-theory%2F%20-from%3AKasparEtter">saying about it on Twitter</a>,
        or <a href="https://translate.google.com/translate?u=https://explained-from-first-principles.com/number-theory/">use Google Translate</a> to read this article in your native language.
    </p>

    <p>
        If you are visiting this website for the first time,
        then please first read the <a href="https://riskmusings.substack.com/">front page</a>,
        where I explain the intention of this blog
        and how to best make use of it.
        As far as your privacy is concerned,
        all data entered on this page is stored locally in your browser
        unless noted otherwise.
        While I researched the content on this page thoroughly,
        you take or omit actions based on it at your own risk.
        In no event shall I as the author be liable
        for any damages arising from information or advice
        on this website or on referenced websites.
    </p>
</header>

<details open="">
  <summary id="preface">
Preface
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Number_theory">Number theory</a>
is the study of <a href="https://en.wikipedia.org/wiki/Integer">integers</a> and the relations between them.
<a href="https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss">Carl Friedrich Gauss</a> (1777 − 1855)
allegedly said that mathematics is the queen of the sciences and that number theory is the queen of mathematics.
What he meant by this is that mathematics,
unlike the <a href="https://en.wikipedia.org/wiki/Science#Branches_of_science">empirical sciences</a>,
studies regularities which are independent from the universe that we live in.
Not having to deal with the messiness of the real world
makes mathematics <a href="https://xkcd.com/435/">the purest of all sciences</a>.
Similarly, he must have considered number theory to be the most elegant
and <a href="https://en.wikipedia.org/wiki/Pure_mathematics">the purest branch of mathematics</a>,
given its <a href="https://en.wikipedia.org/wiki/Mathematical_beauty">beauty</a>
and that it was studied for centuries for its own sake.
Or as <a href="https://en.wikipedia.org/wiki/Leonard_Eugene_Dickson">Leonard Eugene Dickson</a>
(1874 − 1954) put it: “Thank God that number theory is unsullied by any application”.
This changed with the advent of <a href="https://en.wikipedia.org/wiki/Cryptography#Modern_cryptography">modern cryptography</a>
and <a href="https://en.wikipedia.org/wiki/Coding_theory">coding theory</a> in the second half of the 20th century.
Unlike the mathematicians who discovered most of what I cover in this article,
we’re studying number theory only for its applications in these two fields,
which will be the topics of the next two articles.</p>

</details>

<details open="">
  <summary id="outline">
Outline
</summary>

  <p>The goal of this article is to understand
how we can construct <a href="#linear-one-way-functions">linear one-way functions</a>
using <a href="#finite-groups">finite groups</a> which have a <a href="#discrete-logarithm-problem">certain property</a>.
There are two families of finite groups which are widely used in modern cryptography:
<a href="#multiplicative-groups">multiplicative groups</a> and <a href="#elliptic-curves">elliptic curves</a>.
The former are based on <a href="#modular-arithmetic">modular arithmetic</a>,
the latter on <a href="#finite-fields">finite fields</a>.
<a href="#prime-numbers">Prime numbers</a> play a crucial role in both.
We’ll study these topics in a somewhat peculiar order
and also take two detours which will pay off on our journey:</p>

  <figure>
    <svg id="figure-outline" data-name="outline" width="661.826" height="380" viewBox="-1.25 -1.25 661.826 380" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="562.605" y1="78.688" x2="562.605" y2="40.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="329.663" y1="78.688" x2="329.663" y2="40.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="562.605" y1="157.688" x2="562.605" y2="119.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="329.663" y1="157.688" x2="329.663" y2="119.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="96.721" y1="157.688" x2="96.721" y2="119.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="562.605" y1="258.688" x2="562.605" y2="220.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="426.696" y1="278.75" x2="464.634" y2="278.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="329.663" y1="258.688" x2="329.663" y2="220.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="193.754" y1="278.75" x2="231.692" y2="278.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="96.721" y1="258.688" x2="96.721" y2="220.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <line x1="562.605" y1="337.688" x2="562.605" y2="299.75" marker-end="url(#arrow)" stroke-dasharray="31"></line>
    <rect x="232.942" y="0" width="426.384" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="446.134" y="25.65"><tspan>1. Linear one-way functions</tspan></tspan>
    </text>
    <rect x="0" y="79" width="659.326" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="329.663" y="104.65"><tspan>2. Finite groups</tspan></tspan>
    </text>
    <rect x="0" y="158" width="193.442" height="61.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="96.721" y="183.65"><tspan>4. Additive groups</tspan></tspan><tspan x="96.721" y="205.65">(Additive notation)</tspan>
    </text>
    <rect x="232.942" y="158" width="193.442" height="61.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="329.663" y="183.65"><tspan>5. Multiplicative groups</tspan></tspan><tspan x="329.663" y="205.65">(Multiplicative notation)</tspan>
    </text>
    <rect x="465.884" y="158" width="193.442" height="61.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="562.605" y="183.65"><tspan>9. Elliptic curves</tspan></tspan><tspan x="562.605" y="205.65">(Additive notation)</tspan>
    </text>
    <rect x="0" y="259" width="193.442" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="96.721" y="284.65"><tspan>3. Modular arithmetic</tspan></tspan>
    </text>
    <rect x="232.942" y="259" width="193.442" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="329.663" y="284.65"><tspan>6. Prime numbers</tspan></tspan>
    </text>
    <rect x="465.884" y="259" width="193.442" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="562.605" y="284.65"><tspan>8. Finite fields</tspan></tspan>
    </text>
    <rect x="465.884" y="338" width="193.442" height="39.5" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="562.605" y="363.65"><tspan>7. Commutative rings</tspan></tspan>
    </text>

</svg>

    <figcaption>
How the various chapters of this article build on one another.
</figcaption>
  </figure>

  <p>Since it’s easy to get lost in theorems and proofs, I start this article with
introducing and motivating the concept of <a href="#linear-one-way-functions">linear one-way functions</a>
so that we never lose sight of our goal.
Afterwards, I cover <a href="#finite-groups">finite groups</a> in the abstract
in order to establish the terminology that we will use for the rest of the article.
Establishing such a mental framework first also helps us to process our observations later on.
Additionally, proving properties in the abstract saves us a lot of work when looking at multiple examples.
If you read about these topics for the first time,
feel free to jump ahead and play with <a href="#additive-groups">concrete examples</a> before understanding the theory behind them.
If you really want to grasp the math behind modern cryptography,
you likely have to read this article more than once anyway.
The reason for covering <a href="#modular-arithmetic">modular arithmetic</a> and <a href="#multiplicative-groups">multiplicative groups</a>
before <a href="#prime-numbers">prime numbers</a> is to get as far as possible before the math gets more challenging
and to understand why prime numbers are so special.
After learning about <a href="#elliptic-curves">elliptic curves</a>,
I cover the <a href="#dl-algorithms">best known algorithms</a> for breaking our linear one-way functions in a bonus chapter,
before concluding the article with formal proofs of basic <a href="#group-properties">group properties</a> as an appendix.</p>

</details>

<details open="">
  <summary id="contributions">
Contributions
</summary>

  <p>There exist already plenty of textbooks and blog posts on number theory
(see below for <a href="#further-reading">some recommendations</a>),
so I wasn’t sure whether it’s worth adding my own.
Since future articles will require a thorough understanding of number theory
and my ambition is to <a href="https://riskmusings.substack.com/#ambition">explain things from first principles</a>, I proceeded anyway.
Looking at the result, here’s what sets this article apart:</p>
  <ul>
    <li><strong>Focus</strong>: Number theory is a big field with many advanced concepts.
This article focuses on the aspects which are relevant for modern cryptography and coding theory.
As you’ll see, almost all theorems mentioned in this article are being used later on.</li>
    <li><strong>Notation</strong>: As we’ll see, <a href="#notation">two notations</a> are used in <a href="#finite-groups">group theory</a>,
and I haven’t found any other source which consistently provides both.
Not having to translate between the two yourself
reduces your <a href="https://en.wikipedia.org/wiki/Cognitive_load">cognitive load</a>.</li>
    <li><strong>Intuition</strong>: I went to great lengths to complement formal proofs with more intuitive explanations.
While formal rigor is important, nothing beats an intuitive understanding of a theorem.</li>
    <li><strong>Completeness</strong>: Apart from the chapter on <a href="#elliptic-curves">elliptic curves</a>,
I took no shortcuts when explaining why things are the way they are.
Therefore, this article contains the complete proofs of almost all covered theorems,
including <a href="#carmichaels-totient-function">Carmichael’s totient function</a>,
the <a href="#monier-rabin-bound-on-the-number-of-liars">Monier-Rabin bound</a>,
<a href="#square-roots-modulo-composite-numbers">square roots modulo composite numbers</a>,
and the <a href="#birthday-paradox">expected running time of Pollard’s rho algorithm</a>,
which I haven’t found online outside of <abbr title="Portable Document Format">PDFs</abbr>.</li>
    <li><strong>Interactivity</strong>: Depending on how you count them,
this article contains up to 40 <a href="https://riskmusings.substack.com/#interactive-tools">interactive tools</a>,
which I also published on a <a href="https://riskmusings.substack.com/number-theory/tools/">separate page</a>.
Many tools, such as the <a href="#multiplicative-group-repetition-table">repetition tables</a>,
visualize important group properties.
Many other tools show how important algorithms work,
such as the <a href="#extended-euclidean-algorithm">extended Euclidean algorithm</a>,
the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>,
and the <a href="#tonelli-shanks-algorithm">Tonelli-Shanks algorithm</a>.
I also implemented the <a href="#dl-algorithms">main algorithms</a>
to solve the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>,
such as <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a>,
the <a href="#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a>,
and the <a href="#index-calculus-algorithm">index-calculus algorithm</a>.
Besides being fun to play with, these tools allow you to check your own hypotheses,
which makes mathematics an empirical science after all. 🙂</li>
  </ul>

</details>

<details>
  <summary id="math-aversion">
Math aversion
</summary>

  <p>It should be no surprise that an article about math contains a lot of math.
If you’re afraid of math, then see this article as a free
<a href="https://en.wikipedia.org/wiki/Exposure_therapy">exposure-therapy</a> session.
On a more serious note: Number theory is quite different from the math you endured during high school.
Number theory is mostly about understanding why some properties follow from others.
You won’t have to calculate anything yourself; this is what computers are for.
At times, the notation can seem daunting,
but this is actually a problem of language and communication, not math.
The situation isn’t made easier by the fact that <a href="#notation">different notations</a>
are used to talk about the same things.
While I tried to keep everything as unconfusing as possible, this is an aspect that I couldn’t change.</p>

</details>

<details>
  <summary id="why-proofs">
Why proofs?
</summary>

  <p>There is a big difference between understanding how something works and understanding why something works.
In mathematics, answers to why questions are called <a href="https://en.wikipedia.org/wiki/Mathematical_proof">proofs</a>.
Proofs explain why a statement is true by showing how the statement can be deduced
from already proven statements (called <a href="https://en.wikipedia.org/wiki/Theorem">theorems</a>)
and statements which are simply assumed to be true (called <a href="https://en.wikipedia.org/wiki/Axiom">axioms</a>).
If you want to understand only how modern cryptography works,
you can skip this whole article and read just the next one.
If you want to understand also why modern cryptography works,
there is no way around proofs, even if you find them overly formal and tedious.
But of course, you can always ignore answers to questions you would not have asked.</p>

</details>

<details>
  <summary id="further-reading">
Further reading
</summary>

  <p>The two most important sources when writing this article were
<a href="https://shoup.net/ntb/">A Computational Introduction to Number Theory and Algebra</a>
by <a href="https://shoup.net/">Victor Shoup</a>
and the <a href="https://cacr.uwaterloo.ca/hac/">Handbook of Applied Cryptography</a>
by <a href="https://uwaterloo.ca/scholar/ajmeneze">Alfred Menezes</a>,
<a href="https://carleton.ca/scs/people/paul-van-oorschot/">Paul van Oorschot</a>,
and <a href="https://uwaterloo.ca/combinatorics-and-optimization/about/people/scott-vanstone">Scott Vanstone</a> (1947 − 2014).
Consult the former for mathematical proofs and the latter for algorithmic aspects.
Other useful sources are <a href="https://en.wikipedia.org/wiki/Wiki">wikis</a> for proofs,
such as <a href="https://proofwiki.org/wiki/Main_Page">ProofWiki</a>
and <a href="https://groupprops.subwiki.org/wiki/Main_Page">Groupprops</a>,
and <a href="https://en.wikipedia.org/wiki/Q%26A_software">question-and-answer websites</a>,
such as <a href="https://math.stackexchange.com/">Stack Exchange</a> and <a href="https://quora.com">Quora</a>.</p>

</details>

<h2 id="linear-one-way-functions">Linear one-way functions</h2>

<h3 id="definition">Definition</h3>

<p>The term “linear one-way function” consists of three words:</p>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Function_(mathematics)"><strong>Function</strong></a>:
A function maps inputs from one <a href="https://en.wikipedia.org/wiki/Set_(mathematics)">set</a>
to outputs in the same or some other set.
In mathematics, functions are always <a href="https://en.wikipedia.org/wiki/Deterministic_algorithm">deterministic</a>,
which means that the output is determined entirely by the input.
I write \(f(a) = A\), with \(f\) being the name of the function,
lowercase \(a\) denoting the input, and uppercase \(A\) referring to the output of the function.</li>
  <li><a href="https://en.wikipedia.org/wiki/One-way_function"><strong>One-way</strong></a>:
Computing the output \(A\) from the input \(a\) is efficient,
whereas finding an input \(a\) which maps to a given output \(A\) is
<a href="#computational-complexity-theory">computationally infeasible</a>.
I depict efficient calculations with a green arrow and infeasible ones with a red arrow.</li>
  <li><a href="https://en.wikipedia.org/wiki/Linear_function"><strong>Linear</strong></a>:
We restrict the input of our function to <a href="https://en.wikipedia.org/wiki/Integer">integers</a> (the whole numbers)
and require that there exists some <a href="https://en.wikipedia.org/wiki/Operation_(mathematics)">operation</a> \(\circ\)
so that \(f(a + b) = f(a) \circ f(b)\).
(The <a href="https://unicode-table.com/en/2218/">ring operator</a> <code>∘</code> is often used to denote
the <a href="https://en.wikipedia.org/wiki/Function_composition">composition of functions</a>,
but I use it simply as a placeholder for an <a href="#notation">actual operator</a>.)
In other words, if \(a + b = c\), then \(f(a) \circ f(b) = f(c)\), which can be illustrated as follows:</li>
</ul>

<figure>
  <svg id="figure-linear-one-way-function" data-name="linear-one-way-function" width="182.5" height="110.5" viewBox="-1.25 -1.25 182.5 110.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="168" y1="71.688" x2="168" y2="37.25" marker-end="url(#arrow-red)" stroke-dasharray="27"></line>
    <line x1="156" y1="36.313" x2="156" y2="70.75" marker-end="url(#arrow-green)" stroke-dasharray="27"></line>
    <line x1="96" y1="71.688" x2="96" y2="37.25" marker-end="url(#arrow-red)" stroke-dasharray="27"></line>
    <line x1="84" y1="36.313" x2="84" y2="70.75" marker-end="url(#arrow-green)" stroke-dasharray="27"></line>
    <line x1="24" y1="71.688" x2="24" y2="37.25" marker-end="url(#arrow-red)" stroke-dasharray="27"></line>
    <line x1="12" y1="36.313" x2="12" y2="70.75" marker-end="url(#arrow-green)" stroke-dasharray="27"></line>
    <rect x="0" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="23.9"><tspan>a</tspan></tspan>
    </text>
    <rect x="72" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="23.9"><tspan>b</tspan></tspan>
    </text>
    <rect x="144" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="162" y="23.9"><tspan>c</tspan></tspan>
    </text>
    <rect x="0" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="95.9"><tspan>A</tspan></tspan>
    </text>
    <rect x="72" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="95.9"><tspan>B</tspan></tspan>
    </text>
    <rect x="144" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="162" y="95.9"><tspan>C</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="23.9"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="23.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="96.9"><tspan>∘</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="95.9"><tspan>=</tspan></tspan>
    </text>

</svg>

  <figcaption>
The properties of a linear one-way function.
</figcaption>
</figure>

<p>Since</p>

\[f(1 + 1) = f(1) \circ f(1)\]

<p>and thus</p>

\[f(n) = f(\underbrace{1 + … + 1 \mathstrut}_{n \text{ times}})
= \underbrace{f(1) \circ … \circ f(1)}_{n \text{ times}}\text{,}\]

<p>the inputs can be called <a href="https://en.wikipedia.org/wiki/Scalar_(mathematics)">scalars</a>
because they scale the output of the function by a linear factor.</p>

<details>
  <summary id="comparison-with-cryptographic-hash-functions">
Comparison with cryptographic hash functions
</summary>

  <p>As we saw in a <a href="https://riskmusings.substack.com/email/#cryptographic-hash-functions">previous article</a>,
<a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash functions</a>
work on inputs of arbitrary size and have to fulfill additional requirements,
namely second-preimage resistance and collision resistance.
We don’t care about these properties here
because we will limit our linear one-way functions to a finite set of inputs
and construct them in such a way that unequal inputs are mapped to unequal outputs.
Depending on whether you limit the set of inputs or not,
second preimages either don’t exist or are trivial to find.
On the other hand, cryptographic hash functions are typically not linear
(as long as we ignore <a href="https://en.wikipedia.org/wiki/Security_of_cryptographic_hash_functions#Provably_secure_hash_functions">provably secure hash functions</a>,
which are of limited practical use).</p>

</details>

<details>
  <summary id="computational-complexity-theory">
Computational complexity theory
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Computational_complexity_theory">Computational complexity theory</a>
classifies problems according to how many steps are needed to solve them.
Determining the precise number of steps required to solve an instance of a problem is of little interest, though.
What computer scientists care about is how the required effort depends on the size of the input:
If you double the input, does the number of steps that it takes to find a solution grow
<a href="https://en.wikipedia.org/wiki/Time_complexity#Polynomial_time">polynomially</a>, such as quadrupling,
or <a href="https://en.wikipedia.org/wiki/Time_complexity#Exponential_time">exponentially</a>?
Problems whose computational complexity grows exponentially with the input size become
<a href="https://en.wikipedia.org/wiki/Computational_complexity_theory#Intractability">intractable</a>
if you make the input large enough.
One-way functions can exist only if there are problems
which cannot be solved in <a href="https://en.wikipedia.org/wiki/Time_complexity#Polynomial_time">polynomial time</a>,
but solutions to which can be verified in polynomial time.
It is widely believed that such problems exist, but we still lack a proof for this.
This <a href="https://en.wikipedia.org/wiki/Conjecture">conjecture</a>,
which is known as <a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P ≠ NP</a>, is the most important
<a href="https://en.wikipedia.org/wiki/List_of_unsolved_problems_in_computer_science">open question in computer science</a>.
Examples of problems for which no polynomial-time algorithms are known
but whose solution can be verified in polynomial time are <a href="#prime-factorization">integer factorization</a>
and the <a href="#discrete-logarithm-problem">discrete-logarithm problem (<abbr title="Discrete-Logarithm Problem">DLP</abbr>)</a>.</p>

</details>

<h3 id="motivation">Motivation</h3>

<p>Linear one-way functions are useful in cryptography
because they allow a party to conceal information by feeding it into a linear one-way function,
while another party can still perform computations with the output of the linear one-way function.
For example, a party who knows the output \(f(a)\) and the input \(b\) can calculate \(f(a \cdot b)\)
without having to learn \(a\) by repeating \(f(a)\) \(b\) times:</p>

\[f(a \cdot b) = f(\underbrace{a + … + a \mathstrut}_{b \text{ times}})
= \underbrace{f(a) \circ … \circ f(a)}_{b \text{ times}}\text{.}\]

<h3 id="notation">Notation</h3>

<p>Linear one-way functions are an abstract concept, which I made up for this introduction to
<a href="https://en.wikipedia.org/wiki/Public-key_cryptography">asymmetric cryptography</a>.
Instead of using the generic operator \(\circ\),
the operation in the output set of actual linear one-way functions is usually written
as <a href="https://en.wikipedia.org/wiki/Addition">addition</a>
or <a href="https://en.wikipedia.org/wiki/Multiplication">multiplication</a>,
even when it has <a href="#point-addition">nothing to do</a> with addition or multiplication of integers.
As a consequence, every equation can be written in a generic, an additive,
and a multiplicative <a href="https://en.wikipedia.org/wiki/Abelian_group#Notation">notation</a>.
I do this with boxes like the following,
where I choose the default notation (or “all”) depending on the context,
and you can select another notation by clicking on the corresponding tab:</p>

<p>

$$
f(a + b) = f(a) \circ f(b)
$$

$$
f(a + b) = f(a) + f(b)
$$

$$
f(a + b) = f(a) \cdot f(b)
$$

</p>

<p>You can change the notation throughout this article by double-clicking on the corresponding tab.</p>

<h3 id="repetitions">Repetitions</h3>

<p>As we will see, linear one-way functions are typically constructed
by <a href="#element-repetitions">repeating an element</a> from the output set,
the so-called <a href="#group-generators">generator</a> \(G\), the specified number of times.
Repeated addition is written as multiplication,
where the <a href="https://en.wikipedia.org/wiki/Multiplication_sign">multiplication sign</a> is usually
<a href="https://en.wikipedia.org/wiki/Juxtaposition#Mathematics">omitted</a>,
and repeated multiplication is written as <a href="https://en.wikipedia.org/wiki/Exponentiation">exponentiation</a>:</p>

<p>

$$
f(a) = \underbrace{G \circ … \circ G}_{a \text{ times}}
$$

$$
f(a) = aG
$$

$$
f(a) = G^a
$$

</p>

<p>The generic notation is a valuable reminder that the additive and the multiplicative notation stand for the same thing.
However, repetitions are a bit cumbersome to write,
which is why only the additive and the multiplicative notation are used in practice.</p>

<h3 id="linearity">Linearity</h3>

<p>It is easy to see why repeating an element from the output set is a linear operation
(given that the operation is <a href="#group-axioms">associative</a>):</p>

<p>

$$
f(a + b)
= \underbrace{G \circ … \circ G}_{a + b \text{ times}}
= \underbrace{G \circ … \circ G}_{a \text{ times}} \circ \underbrace{G \circ … \circ G}_{b \text{ times}}
= f(a) \circ f(b)
$$

$$
f(a + b) = (a + b)G = aG + bG = f(a) + f(b)
$$

$$
f(a + b) = G^{a + b} = G^a \cdot G^b = f(a) \cdot f(b)
$$

</p>

<h3 id="zero-as-input">Zero as input</h3>

<p>If <a href="https://en.wikipedia.org/wiki/0">zero</a> is a valid input to a linear function,
there has to be an element in the output set which does not affect any other element:</p>

<p>

$$
f(a) = f(a + 0) = f(a) \circ f(0)
$$

$$
f(a) = f(a + 0) = f(a) + f(0)
$$

$$
f(a) = f(a + 0) = f(a) \cdot f(0)
$$

</p>

<p>This element is called the <a href="https://en.wikipedia.org/wiki/Identity_element">identity element</a> or the neutral element.
Given its special role, we assign a specific letter to it:</p>

<p>

$$
f(0) = \underbrace{G \circ … \circ G}_{0 \text{ times}} = E
$$

$$
f(0) = 0G = O
$$

$$
f(0) = G^0 = I
$$

</p>

<p>Note that I use the letters \(O\) and \(I\) instead of \(0\) and \(1\)
because elements in the output set do not have to be integers.
In the case of <a href="#elliptic-curves">elliptic curves</a>,
for example, \(O\) is the <a href="#point-at-infinity">point at infinity</a>.
The resemblance with the corresponding integer is no coincidence, though.</p>

<h3 id="negative-inputs">Negative inputs</h3>

<p>If we allow the input of a linear function to be <a href="https://en.wikipedia.org/wiki/Negative_number">negative</a>,
there has to be an <a href="https://en.wikipedia.org/wiki/Inverse_element">inverse element</a> for each element in the output set:</p>

<p>

$$
f(0) = f(a + (-a)) = f(a) \circ f(-a) = E
$$

$$
f(0) = f(a + (-a)) = f(a) + f(-a) = O
$$

$$
f(0) = f(a + (-a)) = f(a) \cdot f(-a) = I
$$

</p>

<p>In the following chapter, we will formalize these concepts and prove interesting properties about them.</p>

<details open="">
  <summary id="abstract-algebra">
Abstract algebra
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Algebra">Algebra</a> is the study of how to manipulate equations with symbols,
and <a href="https://en.wikipedia.org/wiki/Abstract_algebra">abstract algebra</a> is the study of
<a href="https://en.wikipedia.org/wiki/Algebraic_structure">algebraic structures</a>,
which consist of a set and certain operations on the elements of the set.
The goal of abstract algebra is to understand the properties of such structures
at the highest level of <a href="https://en.wikipedia.org/wiki/Abstraction">abstraction</a>
so that these properties are applicable to any structure
which satisfies the same requirements.
Each algebraic structure has its own set of requirements,
which are called <a href="https://en.wikipedia.org/wiki/Axiom">axioms</a>.
Axioms are the <a href="https://en.wikipedia.org/wiki/Premise">premises</a>
from which <a href="https://en.wikipedia.org/wiki/Logical_consequence">conclusions</a> are derived.
The next chapter is about <a href="#finite-groups">finite groups</a>,
but we’ll encounter other algebraic structures later on,
namely <a href="#commutative-rings">commutative rings</a> and <a href="#finite-fields">finite fields</a>.</p>

</details>

<h2 id="finite-groups">Finite groups</h2>

<h3 id="group-axioms">Group axioms</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Group_(mathematics)">group</a>
consists of a <a href="https://en.wikipedia.org/wiki/Set_(mathematics)">set</a>
and a <a href="https://en.wikipedia.org/wiki/Binary_operation">binary operation</a>,
which combines any two elements of the set according to the
<a href="https://en.wikipedia.org/wiki/Group_(mathematics)#Definition">following rules</a>:</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Closure_(mathematics)"><strong>Closure</strong></a>:
When applying the operation to any two elements of the set, the resulting element is also part of the set.</li>
  <li><a href="https://en.wikipedia.org/wiki/Associative_property"><strong>Associativity</strong></a>:
Operations can be evaluated in any order without changing the result (i.e. parentheses don’t matter).</li>
  <li><a href="https://en.wikipedia.org/wiki/Identity_element"><strong>Identity</strong></a>:
There exists a unique identity element which, when combined with any element, results in the other element.</li>
  <li><a href="https://en.wikipedia.org/wiki/Inverse_element"><strong>Invertibility</strong></a>:
Each element has a unique inverse. If you combine an element with its inverse, you get the identity element.</li>
</ul>

<p>The operation can be written in <a href="#notation">different ways</a>,
which leads to different notations for the identity element and the inverses:</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="All">

  <ul>
    <li><strong>Associativity</strong>: For any elements \(A\), \(B\), and \(C\), \((A \circ B) \circ C = A \circ (B \circ C)\).</li>
    <li><strong>Identity element \(E\)</strong>: For any element \(A\), \(A \circ E = E \circ A = A\).</li>
    <li><strong>\(\overline{A}\) for the inverse of \(A\)</strong>: For any element \(A\), \(A \circ \overline{A} = \overline{A} \circ A = E\).</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Associativity</strong>: For any elements \(A\), \(B\), and \(C\), \((A + B) + C = A + (B + C)\).</li>
    <li><strong>Identity element \(O\)</strong>: For any element \(A\), \(A + O = O + A = A\).</li>
    <li><strong>\(-A\) for the inverse of \(A\)</strong>: For any element \(A\), \(A + (-A) = (-A) + A = O\).</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Associativity</strong>: For any elements \(A\), \(B\), and \(C\), \((A \cdot B) \cdot C = A \cdot (B \cdot C)\).</li>
    <li><strong>Identity element \(I\)</strong>: For any element \(A\), \(A \cdot I = I \cdot A = A\).</li>
    <li><strong>\(A^{-1}\) for the inverse of \(A\)</strong>: For any element \(A\), \(A \cdot A^{-1} = A^{-1} \cdot A = I\).</li>
  </ul>

</div>

<p>Usually, the group axioms are presented in a <a href="#reduced-group-axioms">reduced version</a>,
from which properties like the <a href="#uniqueness-of-right-identity">uniqueness of the identity</a> are derived.
Since this is not important for our purposes,
I moved <a href="#derived-group-properties">such derivations</a> to the <a href="#group-properties">end of this article</a>.</p>

<h3 id="unique-solution">Unique solution</h3>

<p>The defining property of a group is that the following equation has a unique solution
for any elements \(A\) and \(B\) of the group:</p>

<p>

$$
X \circ A = B \textsf{ has a unique solution, namely } X = B \circ \overline{A} \\[2pt]
\textsf{because }(B \circ \overline{A}) \circ A = B \circ (\overline{A} \circ A) = B \circ E = B \textsf{.} \\[8pt]
\textsf{Any two solutions } X_1 \textsf{ and } X_2 \textsf{ are the same because} \\[3pt]
\begin{aligned}
X_1 \circ A &amp;= X_2 \circ A \\
(X_1 \circ A) \circ \overline{A} &amp;= (X_2 \circ A) \circ \overline{A} \\
X_1 \circ (A \circ \overline{A}) &amp;= X_2 \circ (A \circ \overline{A}) \\
X_1 \circ E &amp;= X_2 \circ E \\
X_1 &amp;= X_2 \textsf{.}
\end{aligned}
$$

$$
X + A = B \textsf{ has a unique solution, namely } X = B + (-A) \\[2pt]
\textsf{because }(B + (-A)) + A = B + ((-A) + A) = B + O = B \textsf{.} \\[8pt]
\textsf{Any two solutions } X_1 \textsf{ and } X_2 \textsf{ are the same because} \\[3pt]
\begin{aligned}
X_1 + A &amp;= X_2 + A \\
(X_1 + A) + (-A) &amp;= (X_2 + A) + (-A) \\
X_1 + (A + (-A)) &amp;= X_2 + (A + (-A)) \\
X_1 + O &amp;= X_2 + O \\
X_1 &amp;= X_2 \textsf{.}
\end{aligned}
$$

$$
X \cdot A = B \textsf{ has a unique solution, namely } X = B \cdot A^{-1} \\[2pt]
\textsf{because }(B \cdot A^{-1}) \cdot A = B \cdot (A^{-1} \cdot A) = B \cdot I = B \textsf{.} \\[8pt]
\textsf{Any two solutions } X_1 \textsf{ and } X_2 \textsf{ are the same because} \\[3pt]
\begin{aligned}
X_1 \cdot A &amp;= X_2 \cdot A \\
(X_1 \cdot A) \cdot A^{-1} &amp;= (X_2 \cdot A) \cdot A^{-1} \\
X_1 \cdot (A \cdot A^{-1}) &amp;= X_2 \cdot (A \cdot A^{-1}) \\
X_1 \cdot I &amp;= X_2 \cdot I \\
X_1 &amp;= X_2 \textsf{.}
\end{aligned}
$$

</p>

<p id="unique-result">The same is true if \(X\) is on the right side of \(A\).
Since the solution is unique, different combinations map to different results:</p>

<p>

$$
\textsf{If } X_1 ≠ X_2 \textsf{, then } X_1 \circ A ≠ X_2 \circ A \textsf{.}
$$

$$
\textsf{If } X_1 ≠ X_2 \textsf{, then } X_1 + A ≠ X_2 + A \textsf{.}
$$

$$
\textsf{If } X_1 ≠ X_2 \textsf{, then } X_1 \cdot A ≠ X_2 \cdot A \textsf{.}
$$

</p>

<h3 id="commutative-groups">Commutative groups</h3>

<p>An operation is <a href="https://en.wikipedia.org/wiki/Commutative_property">commutative</a>
if swapping the inputs does not change the output,
i.e. the following holds for any elements \(A\) and \(B\):</p>

<p>

$$
A \circ B = B \circ A
$$

$$
A + B = B + A
$$

$$
A \cdot B = B \cdot A
$$

</p>

<p>Commutativity is not required in the <a href="#group-axioms">above definition</a>.
It follows from the <a href="#reduced-group-axioms">reduced group axioms</a>
that the right identity is also an identity <a href="#right-identity-is-left-identity">when applied from the left</a>
and that any right inverse is also an inverse <a href="#right-inverses-are-left-inverses">when applied from the left</a>,
even if the operation itself is not commutative.
A group whose operation is commutative is called a commutative group
or an <a href="https://en.wikipedia.org/wiki/Abelian_group">abelian group</a>,
named after <a href="https://en.wikipedia.org/wiki/Niels_Henrik_Abel">Niels Henrik Abel</a> (1802 − 1829).
(Even though “abelian” is derived from a <a href="https://en.wikipedia.org/wiki/Proper_name">proper name</a>,
the first letter is <a href="https://en.wikipedia.org/wiki/Abelian_group#A_note_on_typography">usually not capitalized</a>.)</p>

<h3 id="element-repetitions">Element repetitions</h3>

<p>Instead of combining two different elements, a single element can be combined repeatedly with itself.
We write this as follows:</p>

<p>

$$
nA = \underbrace{A + … + A}_{n \text{ times}}
$$

$$
A^n = \underbrace{A \cdot … \cdot A}_{n \text{ times}}
$$

</p>

<p>As <a href="#notation">noted earlier</a>, the generic operation \(\circ\) lacks a concise notation for repetitions,
which is why I don’t include it in this section.</p>

<p id="added-repetitions">Since the group operation is associative (which means that we can move parentheses around),
it follows immediately that:</p>

<p>

$$
(m + n)A = \underbrace{A + … + A}_{m + n \text{ times}}
= (\underbrace{A + … + A}_{m \text{ times}}) + (\underbrace{A + … + A}_{n \text{ times}})
= mA + nA
$$

$$
A^{m + n} = \underbrace{A \cdot … \cdot A}_{m + n \text{ times}}
= (\underbrace{A \cdot … \cdot A}_{m \text{ times}}) \cdot (\underbrace{A \cdot … \cdot A}_{n \text{ times}})
= A^m \cdot A^n
$$

</p>

<p id="cancelled-repetitions">And since repetitions of inverses cancel as many repetitions of the element itself,
we can make it work for differences as well:</p>

<p>

$$
(m - n)A = \underbrace{A + … + A}_{m - n \text{ times}}
= (\underbrace{A + … + A}_{m \text{ times}}) + (\underbrace{(-A) + … + (-A)}_{n \text{ times}})
= mA + n(-A)
$$

$$
A^{m - n} = \underbrace{A \cdot … \cdot A}_{m - n \text{ times}}
= (\underbrace{A \cdot … \cdot A}_{m \text{ times}}) \cdot (\underbrace{A^{-1} \cdot … \cdot A^{-1}}_{n \text{ times}})
= A^m \cdot (A^{-1})^n
$$

</p>

<p id="zero-and-negative-repetitions">If we don’t require the difference to be positive,
we get the following definitions for zero and a negative number of repetitions:</p>

<p>

$$
\begin{aligned}
0A &amp;= O \\
(-n)A &amp;= n(-A)
\end{aligned}
$$

$$
\begin{aligned}
A^0 &amp;= I \\
A^{-n} &amp;= (A^{-1})^n
\end{aligned}
$$

</p>

<h3 id="group-order">Group order</h3>

<p>A group is <a href="https://en.wikipedia.org/wiki/Finite_group">finite</a>
if its set contains only a finite number of elements.
The number of elements is then called the <a href="https://en.wikipedia.org/wiki/Order_(group_theory)">order of the group</a>.
If \(\mathbb{G}\) is the set of the group, its order is usually written as \(|\mathbb{G}|\),
which is the same notation as used to denote the <a href="https://en.wikipedia.org/wiki/Cardinality">cardinality of a set</a>.</p>

<details>
  <summary id="notation-for-sets-and-elements">
Notation for sets and elements
</summary>

  <p>A <a href="https://en.wikipedia.org/wiki/Set_(mathematics)">set</a> is a collection
of <a href="https://en.wikipedia.org/wiki/Element_(mathematics)">distinct elements</a>.
When a variable is used to denote a set,
it is often written in <a href="https://en.wikipedia.org/wiki/Blackboard_bold">blackboard bold</a>,
such as \(\mathbb{Z}\) for the set of <a href="https://en.wikipedia.org/wiki/Integer">integers</a>,
<!-- --> \(\mathbb{R}\) for the set of <a href="https://en.wikipedia.org/wiki/Real_number">real numbers</a>,
and \(\mathbb{C}\) for the set of <a href="https://en.wikipedia.org/wiki/Complex_number">complex numbers</a>.
The <a href="https://en.wikipedia.org/wiki/Element_(mathematics)#Notation_and_terminology">symbol \(\in\)</a>
is used to denote that \(A\) “is” an element of the set \(\mathbb{G}\), written as \(A \in \mathbb{G}\).
I put “is” in quotation marks because the same notation is used when \(A\) is not an element of the set
but rather a <a href="https://en.wikipedia.org/wiki/Variable_(mathematics)">variable</a> which represents an element of the set.
Sets are <a href="https://en.wikipedia.org/wiki/Set-builder_notation">usually defined</a> by enumerating all its elements
within <a href="https://en.wikipedia.org/wiki/Bracket#Curly_bracket">curly brackets</a>, such as \(\{1, 2, 3\}\),
or by specifying a criteria for its elements after a <a href="https://en.wikipedia.org/wiki/Vertical_bar">vertical bar</a>,
such as \(\{x \in \mathbb{Z} \mid x &gt; 2\}\) for the set of integers greater than two.</p>

</details>

<h3 id="element-order">Element order</h3>

<p>If you keep <a href="#element-repetitions">repeating</a> an element of a finite group,
you will reach an earlier result again at some point because you run out of fresh elements.
Let \(A\) be the element that we repeat and \(B\) be the first element that we reach twice,
which we can depict as follows:</p>

<p>

$$
E \circ \overbrace{\underbrace{A \circ A \circ … \circ A\ \vphantom{\large |}}_{m \text{ times}\ =\ B} \circ \underbrace{A \circ … \circ A \vphantom{\large |}}_{n - m \text{ times}\ =\ E}}^{n \text{ times}\ =\ B}
$$

$$
O + \overbrace{\underbrace{A + A + … + A\ \vphantom{\large |}}_{m \text{ times}\ =\ B} + \underbrace{A + … + A \vphantom{\large |}}_{n - m \text{ times}\ =\ O}}^{n \text{ times}\ =\ B}
$$

$$
I \cdot \overbrace{\underbrace{A \cdot A \cdot … \cdot A\ \vphantom{\large |}}_{m \text{ times}\ =\ B} \cdot \underbrace{A \cdot … \cdot A \vphantom{\large |}}_{n - m \text{ times}\ =\ I}}^{n \text{ times}\ =\ B}
$$

</p>

<p>If you reach \(B\) for the first time after repeating \(A\) \(m\) times and again after repeating \(A\) \(n\) times,
then \(A\) repeated \(n - m\) times has to equal the <a href="#group-axioms">identity element</a>
because the identity element is the <a href="#unique-solution">unique solution</a> to \(B \circ X = B\).
If we start with <a href="#zero-and-negative-repetitions">zero repetitions</a> and thus the identity element instead of \(A\),
the identity element has to be the first element which we encounter again
because as soon as \(m &gt; 0\), \(n - m\) is smaller than \(n\),
which means that you reach the identity element before you reach \(B\) for the second time.
The smallest \(n &gt; 0\) which results in the identity element when repeating \(A\) \(n\) times
is called the <a href="https://en.wikipedia.org/wiki/Order_(group_theory)">order of the element</a> \(A\),
written as \(|A|\):</p>

<p>

$$
\underbrace{A \circ … \circ A}_{|A| \text{ times}} = E
$$

$$
(|A|)A = O
$$

$$
A^{|A|} = I
$$

</p>

<p id="repeated-group-elements">In a finite group, every element has a finite order.
Once you’ve reached the identity element, the elements repeat in the same order:</p>

<p>

$$
\overbrace{\underset{A}{\underset{\downarrow}{A}} \circ \underset{B}{\underset{\downarrow}{A}} \circ \underset{C}{\underset{\downarrow}{A}} \circ … \circ \underset{E}{\underset{\downarrow}{A}} \vphantom{\large |}}^{|A| \text{ times}} \circ \underset{A}{\underset{\downarrow}{A}} \circ \underset{B}{\underset{\downarrow}{A}} \circ \underset{C}{\underset{\downarrow}{A}} \circ …
$$

$$
\overbrace{\underset{A}{\underset{\downarrow}{A}} + \underset{B}{\underset{\downarrow}{A}} + \underset{C}{\underset{\downarrow}{A}} + … + \underset{O}{\underset{\downarrow}{A}} \vphantom{\large |}}^{|A| \text{ times}} + \underset{A}{\underset{\downarrow}{A}} + \underset{B}{\underset{\downarrow}{A}} + \underset{C}{\underset{\downarrow}{A}} + …
$$

$$
\overbrace{\underset{A}{\underset{\downarrow}{A}} \cdot \underset{B}{\underset{\downarrow}{A}} \cdot \underset{C}{\underset{\downarrow}{A}} \cdot … \cdot \underset{I}{\underset{\downarrow}{A}} \vphantom{\large |}}^{|A| \text{ times}} \cdot \underset{A}{\underset{\downarrow}{A}} \cdot \underset{B}{\underset{\downarrow}{A}} \cdot \underset{C}{\underset{\downarrow}{A}} \cdot …
$$

</p>

<p id="inverse-through-repetitions">If \(A\)
repeated \(|A|\) times results in the identity element,
then \(A\) repeated \(|A| - 1\) times has to result in the inverse element of \(A\):</p>

<p>

$$
A \circ \underbrace{A \circ … \circ A}_{|A| - 1 \text{ times}} = A \circ \overline{A} =
\underbrace{A \circ … \circ A}_{|A| - 1 \text{ times}} \circ A = \overline{A} \circ A = E
$$

$$
A + \underbrace{A + … + A}_{|A| - 1 \text{ times}} = A + (-A) =
\underbrace{A + … + A}_{|A| - 1 \text{ times}} + A = (-A) + A = O
$$

$$
A \cdot \underbrace{A \cdot … \cdot A}_{|A| - 1 \text{ times}} = A \cdot A^{-1} =
\underbrace{A \cdot … \cdot A}_{|A| - 1 \text{ times}} \cdot A = A^{-1} \cdot A = I
$$

</p>

<p>This is the most intuitive way to understand why a right inverse is also always a left inverse and vice versa.</p>

<details>
  <summary id="why-do-we-need-invertibility-as-an-axiom">
Why do we need invertibility as an axiom?
</summary>

  <p>Since you get the inverse of any element \(A\) in any finite group simply by repeating \(A\),
you may wonder why we require each element to have an inverse in the group as one of <a href="#group-axioms">our axioms</a>.
The reason for this is that without invertibility, \(X \circ A = B\) can have several solutions,
which means that you can get stuck in a loop which doesn’t involve the identity element.
(To see this happening, set the <a href="#modulo-operation">modulus</a> to a <a href="#prime-factorization">composite number</a>
in the <a href="#multiplicative-group-repetition-table">repetition table of multiplicative groups</a> below.)
Instead of requiring that each element has an inverse,
we can require that \(X \circ A = B\) and \(A \circ Y = B\) have a <a href="#unique-solution">unique solution</a>
for any elements \(A\) and \(B\) of the group.
This is an <a href="#alternative-group-axioms">alternative definition of a group</a>
and makes even the <a href="#group-axioms">identity axiom</a> redundant,
as we’ll see <a href="#latin-square-associativity-group">later</a>.</p>

</details>

<h3 id="group-generators">Group generators</h3>

<p>If an element reaches every element of the group before coming to the identity element
when it is <a href="#element-repetitions">repeated</a>,
the element is said to <a href="https://en.wikipedia.org/wiki/Generating_set_of_a_group">generate the group</a>.
Such an element is called a generator and usually denoted as \(G\).
A group can have several generators or <a href="#carmichaels-totient-function">no generator</a>.
By definition, the <a href="#element-order">order of each generator</a>
equals the <a href="#group-order">order of the group</a>: \(\lvert G \rvert = \lvert \mathbb{G} \rvert\).
The set generated by an element \(A\) is usually written
with <a href="https://en.wikipedia.org/wiki/Bracket#Angle_brackets">angle brackets</a> as \(⟨A⟩\).
Also by definition, the set generated by a generator is the whole group: \(\mathbb{G} = ⟨G⟩\).</p>

<h3 id="cyclic-groups">Cyclic groups</h3>

<p>A group with a <a href="#group-generators">generator</a> is called <a href="https://en.wikipedia.org/wiki/Cyclic_group">cyclic</a>
because all its elements can be reached in a single cycle when <a href="#element-repetitions">repeating</a> the generator \(G\):</p>

<figure>
  <svg id="figure-cyclic-group" data-name="cyclic-group" width="225.25" height="225.25" viewBox="-112.625 -112.625 225.25 225.25" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="80"></circle>
    <line x1="0" y1="-75" x2="0" y2="-85"></line>
    <line x1="44.084" y1="-60.676" x2="49.962" y2="-68.766"></line>
    <line x1="71.329" y1="-23.176" x2="80.84" y2="-26.266"></line>
    <line x1="71.329" y1="23.176" x2="80.84" y2="26.266"></line>
    <line x1="44.084" y1="60.676" x2="49.962" y2="68.766"></line>
    <line x1="0" y1="75" x2="0" y2="85"></line>
    <line x1="-44.084" y1="60.676" x2="-49.962" y2="68.766"></line>
    <line x1="-71.329" y1="23.176" x2="-80.84" y2="26.266"></line>
    <line x1="-71.329" y1="-23.176" x2="-80.84" y2="-26.266"></line>
    <line x1="-44.084" y1="-60.676" x2="-49.962" y2="-68.766"></line>
    <text text-anchor="middle">
        <tspan x="0" y="-96.85"><tspan>G<tspan dy="-6">0</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="60.395" y="-77.226"><tspan>G<tspan dy="-6">1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="97.721" y="-25.851"><tspan>G<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="97.721" y="37.651"><tspan>G<tspan dy="-6">3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="60.395" y="89.026"><tspan>G<tspan dy="-6">4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="108.65"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-60.395" y="89.026"><tspan>G<tspan dy="-6">−4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-97.721" y="37.651"><tspan>G<tspan dy="-6">−3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-97.721" y="-25.851"><tspan>G<tspan dy="-6">−2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-60.395" y="-77.226"><tspan>G<tspan dy="-6">−1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <path d="M 0,-53.333 A 53.333 53.333 0 0 1 0,53.333 L -0.009973,53.334063" marker-end="url(#arrow-blue)" stroke-dasharray="161"></path>
    <text text-anchor="middle">
        <tspan x="0" y="8.9"><tspan>𝔾</tspan></tspan>
    </text>

</svg>

  <figcaption>

Repeating the generator <strong>G</strong> using the <a href="#notation">multiplicative notation</a>.

</figcaption>
</figure>

<p>Since every element can be written as a repetition of \(G\),
the group operation and element inversion can be performed as follows:</p>

<div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <p>Let \(A = aG\) and \(B = bG\) be arbitrary elements,
then \(A + B = aG + bG \href{#added-repetitions}{=} (a + b)G\)
and \(-A = -(aG) \href{#cancelled-repetitions}{=} a(-G) \href{#zero-and-negative-repetitions}{=} (-a)G\).</p>

  <p>Let \(A = G^a\) and \(B = G^b\) be arbitrary elements,
then \(A \cdot B = G^a \cdot G^b \href{#added-repetitions}{=} G^{a + b}\)
and \(A^{-1} = (G^a)^{-1} \href{#cancelled-repetitions}{=} (G^{-1})^a \href{#zero-and-negative-repetitions}{=} G^{-a}\).</p>

</div>

<p>Therefore, cyclic groups are <a href="#commutative-groups">commutative</a>
because the addition of the integers in the repetition of the generator is commutative:</p>

<div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <p>Let \(A = aG\) and \(B = bG\) be arbitrary elements,
then \(A + B = aG + bG = (a + b)G = (b + a)G = bG + aG = B + A\).</p>

  <p>Let \(A = G^a\) and \(B = G^b\) be arbitrary elements,
then \(A \cdot B = G^a \cdot G^b = G^{a + b} = G^{b + a} = G^b \cdot G^a = B \cdot A\).</p>

</div>

<details>
  <summary id="even-number-of-generators">
Even number of generators
</summary>

  <p>Repeating the inverse of \(G\) generates the group in the opposite direction
because the inverse undoes <a href="#cancelled-repetitions">one repetition at a time</a>:</p>

  <p>

$$
iG = (\lvert G \rvert - (\lvert G \rvert - i))G = \underbrace{(\lvert G \rvert)G}_{=\ O} + (\lvert G \rvert - i)(-G) = (\lvert G \rvert - i)(-G)
$$

$$
G^i = G^{\lvert G \rvert - (\lvert G \rvert - i)} = \underbrace{G^{\lvert G \rvert}}_{=\ I} \cdot (G^{-1})^{\lvert G \rvert - i} = (G^{-1})^{\lvert G \rvert - i}
$$

</p>

  <p>As a consequence, every cyclic group with more than two elements has an even number of generators
because the inverse of every generator is also a generator.
(Since each inverse is <a href="#uniqueness-of-inverses">unique</a>
and the inverse of each inverse is the <a href="#double-inverse-theorem">original element again</a>,
two different generators cannot have the same inverse
— and a generator can equal its inverse only for groups of order 2.)</p>

</details>

<h3 id="fast-repetitions">Fast repetitions</h3>

<p>The goal of this article is to construct <a href="#linear-one-way-functions">linear one-way functions</a>.
As we’ve seen in the introduction, <a href="#element-repetitions">repeating an element</a> is a <a href="#linearity">linear operation</a>.
As we’ll see <a href="#discrete-logarithm-problem">later</a>, figuring out how many times an element has been repeated
is <a href="#computational-complexity-theory">(presumably) computationally infeasible</a> in some groups.
In this section, we want to understand why repeating an element a certain number of times is so much easier
than determining the number of repetitions when given the result.
Let’s start with how we can compute element repetitions efficiently.</p>

<p>Instead of performing one repetition at a time,
we can compute \(A\) repeated \(n\) times for any integer \(n\) using the following insight:</p>

<p>

$$
nA = \begin{cases}
(-n)(-A) &amp;\text{if } n &lt; 0 \text{,} \\
O &amp;\text{if } n = 0 \text{,} \\
(n - 1)A + A &amp;\text{if } n \text{ is odd,} \\
2(\frac{n}{2}A) &amp;\text{if } n \text{ is even.}
\end{cases}
$$

$$
A^n = \begin{cases}
(A^{-1})^{-n} &amp;\text{if } n &lt; 0 \text{,} \\
I &amp;\text{if } n = 0 \text{,} \\
A^{n-1} \cdot A &amp;\text{if } n \text{ is odd,} \\
(A^{\frac{n}{2}})^2 &amp;\text{if } n \text{ is even.}
\end{cases}
$$

</p>

<p>Solving a problem by reducing it to smaller instances of the same problem is known
as <a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)">recursion</a>.
The above <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> terminates
because a negative \(n\) is transformed into a positive \(n\)
and then \(n\) gets smaller in every iteration until it reaches zero.
Since an odd number becomes even when you subtract one, \(n\) is halved at least in every other iteration.
Therefore, the <a href="https://en.wikipedia.org/wiki/Analysis_of_algorithms#Run-time_analysis">running time</a>
of the algorithm is <a href="https://en.wikipedia.org/wiki/Time_complexity#Logarithmic_time">logarithmic</a>
with regard to the input \(n\).
Since halving a <a href="https://riskmusings.substack.com/internet/#number-encoding">binary number</a> is the same as dropping its
<a href="https://en.wikipedia.org/wiki/Bit_numbering#Bit_significance_and_indexing">least-significant bit</a>,
one can also say that the running time is linear in the <a href="https://en.wikipedia.org/wiki/Bit-length">bit length</a> of \(n\).
In other words, if you double the length of a number (rather than its size),
you just double the number of steps required.</p>

<p>When using the <a href="#notation">multiplicative notation</a>, this algorithm is known as
<a href="https://en.wikipedia.org/wiki/Exponentiation_by_squaring">exponentiation by squaring</a> or square-and-multiply.
When using the <a href="#notation">additive notation</a>, this becomes multiplication by doubling or double-and-add.
The algorithm exploits the fact that the group operation is <a href="#group-axioms">associative</a>:
Instead of evaluating the expression from left to right,
the operations are grouped in such a way that as many intermediate results as possible can be reused.
Reusing intermediate results instead of recomputing them is called
<a href="https://en.wikipedia.org/wiki/Common_subexpression_elimination">common subexpression elimination</a>
in <a href="https://en.wikipedia.org/wiki/Compiler">compiler design</a>.
It’s also the core idea of <a href="https://en.wikipedia.org/wiki/Dynamic_programming">dynamic programming</a>.
Let’s look at <a href="https://en.wikipedia.org/wiki/Exponentiation_by_squaring#Basic_method">an example</a>:</p>

<p>

$$
\begin{aligned}
13A &amp;= A + A + A + A + A + A + A + A + A + A + A + A + A \\
&amp;= \bigg(\Big(\big((A + A) + A\big) + \big((A + A) + A\big)\Big)
+ \Big(\big((A + A) + A\big) + \big((A + A) + A\big)\Big)\bigg) + A \\
&amp;= 2\Big(2\big(2(O + \underset{1}{\underset{\uparrow}{A}}) + \underset{1}{\underset{\uparrow}{A}}\big)
+ \underset{0}{\underset{\uparrow}{O}}\Big) + \underset{1}{\underset{\uparrow}{A}}
\end{aligned}

$$

$$
\begin{aligned}
A^{13} &amp;= A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \\
&amp;= \bigg(\Big(\big((A \cdot A) \cdot A\big) \cdot \big((A \cdot A) \cdot A\big)\Big)
\cdot \Big(\big((A \cdot A) \cdot A\big) \cdot \big((A \cdot A) \cdot A\big)\Big)\bigg) \cdot A \\
&amp;= \Big(\big((I \cdot \underset{1}{\underset{\uparrow}{A}})^2 \cdot \underset{1}{\underset{\uparrow}{A}}\big)^2
\cdot \underset{0}{\underset{\uparrow}{I}}\Big)^2 \cdot \underset{1}{\underset{\uparrow}{A}}
\end{aligned}
$$

</p>

<p>Instead of 12 group operations, we performed only 5 (ignoring the combinations with the identity element).
13 written as a binary number is 1101 (8 + 4 + 1), which corresponds to the pattern of
when you have to combine the intermediary result with the element before doubling/squaring it again.
(If you look at the recursive formula, the least-significant bit determines whether the current number is odd or even
and thus whether you combine the recursive invocation with the element or not before dropping this bit.)</p>

<p>Crucially, this technique works only if you know how many repetitions you have to perform.
If you try to determine the number of repetitions from the result,
you cannot work backwards and halve the number every other step,
which is why this algorithm can be used only in one direction.
I cover the best known algorithms for determining the number of repetitions in a <a href="#dl-algorithms">separate chapter</a>.</p>

<details>
  <summary id="non-recursive-algorithm">
Non-recursive algorithm
</summary>

  <p>The above <a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)">recursive algorithm</a>
can easily be turned into a non-recursive algorithm:</p>

  <p>

$$
\text{function }repeat(A, n)\ \{ \\
\quad \text{if }(n &lt; 0)\ \{ \\
\quad \quad A := -A \\
\quad \quad n := -n \\
\quad \} \\
\quad \text{let }B := O \\
\quad \text{while }(n &gt; 0)\ \{ \\
\quad \quad \text{if }(n\ \href{#modulo-operation}{\%}\ 2 = 1)\ \{ \\
\quad \quad \quad B := B + A \\
\quad \quad \quad n := n - 1 \\
\quad \quad \} \\
\quad \quad A := A + A \\
\quad \quad n := n / 2 \\
\quad \} \\
\quad \text{return } B \\
\} \\
$$

$$
\text{function }repeat(A, n)\ \{ \\
\quad \text{if }(n &lt; 0)\ \{ \\
\quad \quad A := A^{-1} \\
\quad \quad n := -n \\
\quad \} \\
\quad \text{let }B := I \\
\quad \text{while }(n &gt; 0)\ \{ \\
\quad \quad \text{if }(n\ \href{#modulo-operation}{\%}\ 2 = 1)\ \{ \\
\quad \quad \quad B := B \cdot A \\
\quad \quad \quad n := n - 1 \\
\quad \quad \} \\
\quad \quad A := A \cdot A \\
\quad \quad n := n / 2 \\
\quad \} \\
\quad \text{return } B \\
\} \\
$$

</p>

  <p>This function returns the correct result because \(B \cdot A^n\) (respectively \(B + nA\)) equals the desired result
before and after every <a href="https://en.wikipedia.org/wiki/Control_flow#Loops">loop iteration</a>
and we repeat the loop until \(n = 0\).
Unlike the <a href="https://en.wikipedia.org/wiki/Exponentiation_by_squaring#With_constant_auxiliary_memory">variant on Wikipedia</a>,
the above algorithm wastes one group operation in the last iteration when \(n = 1\).
On the other hand, we don’t have to handle the case where \(n = 0\) separately.
Since computers represent numbers in <a href="https://en.wikipedia.org/wiki/Binary_number">binary</a>,
you can check whether \(n\) is odd with a <a href="https://en.wikipedia.org/wiki/Bitwise_operation#AND">bitwise and</a>
(typically written as <code>n &amp; 1 === 1</code>) and divide \(n\) by \(2\) without having to subtract the
<a href="https://en.wikipedia.org/wiki/Bit_numbering#Bit_significance_and_indexing">least-significant bit</a> first by
<a href="https://en.wikipedia.org/wiki/Arithmetic_shift">shifting the bits</a> one to the right (typically written as <code>n &gt;&gt; 1</code>).
Since I haven’t yet introduced any actual groups,
I will provide an <a href="https://riskmusings.substack.com/#interactive-tools">interactive tool</a> for fast repetitions <a href="#repetition-revisited">later on</a>.</p>

</details>

<h3 id="subgroups">Subgroups</h3>

<p>A group \(\mathbb{H}\) is a <a href="https://en.wikipedia.org/wiki/Subgroup">subgroup</a> of another group \(\mathbb{G}\)
if every element of \(\mathbb{H}\) is also an element of \(\mathbb{G}\) and they have the same operation.
Since a group must have an <a href="#group-axioms">identity element</a> and the identity element is defined by the operation,
the subgroup \(\mathbb{H}\) has to include the same identity element
as the <a href="https://en.wiktionary.org/wiki/supergroup">supergroup</a> \(\mathbb{G}\).
Given that the identity element results in itself when it is combined with itself,
every group has a <a href="https://en.wikipedia.org/wiki/Trivial_group">trivial subgroup</a>,
which contains only the identity element.
Since <a href="#group-axioms">associativity</a> is a property of the operation and not of the elements,
a subgroup satisfies this axiom simply by using the same operation as its supergroup.
<a href="https://en.wikipedia.org/wiki/Subgroup#Subgroup_tests">What has to be verified</a>, though,
is that the elements of the subgroup are <a href="#group-axioms">closed</a> under the group operation.
If this is the case and the subgroup is non-empty and finite,
the identity element and all inverses are guaranteed to be included
as you reach them by <a href="#inverse-through-repetitions">repeating the corresponding element</a>.
Any element \(A\) of \(\mathbb{G}\) <a href="#group-generators">generates</a> a <a href="#cyclic-groups">cyclic</a> subgroup,
which is denoted as \(\href{#group-generators}{⟨A⟩}\).
Generated subsets are always closed because combining repetitions of \(A\)
results in <a href="#cyclic-groups">another repetition of \(A\)</a>.
If \(A\) does not generate all elements of \(\mathbb{G}\), then \(⟨A⟩\) is a proper subgroup of \(\mathbb{G}\).</p>

<details>
  <summary id="notation-for-the-subgroup-relation">
Notation for the subgroup relation
</summary>

  <p>As you may have noticed, I began to denote a group by its set in this section.
The <a href="#subgroups">subgroup</a> <a href="https://en.wikipedia.org/wiki/Relation_(mathematics)">relation</a> is usually written
as \(\mathbb{H} ≤ \mathbb{G}\) (or as \(\mathbb{H} &lt; \mathbb{G}\) if \(\mathbb{H} ≠ \mathbb{G}\))
instead of \(\mathbb{H} \subseteq \mathbb{G}\)
because not every <a href="https://en.wikipedia.org/wiki/Subset">subset</a> of elements forms a subgroup.</p>

</details>

<details>
  <summary id="intersection-of-subgroups-is-a-subgroup">
Intersection of subgroups is a subgroup
</summary>

  <p>Given two <a href="#subgroups">subgroups</a> \(\mathbb{H_1}\) and \(\mathbb{H_2}\) of a <a href="#group-axioms">group</a> \(\mathbb{G}\),
their <a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)">intersection</a> \(\mathbb{H} = \mathbb{H_1} \cap \mathbb{H_2}\)
is also a subgroup of \(\mathbb{G}\) because:</p>
  <ul>
    <li>\(\mathbb{H}\) is not empty because the <a href="#group-axioms">identity element</a> \(E\) of \(\mathbb{G}\)
is included in both \(\mathbb{H_1}\) and \(\mathbb{H_2}\). Therefore, \(E \in \mathbb{H}\).</li>
    <li>\(\mathbb{H}\) is <a href="#group-axioms">closed</a> because for any elements \(A\) and \(B\) in \(\mathbb{H}\),
<!-- --> \(A\) and \(B\) belong to both \(\mathbb{H_1}\) and \(\mathbb{H_2}\).<!-- --></li>
  </ul>

  <p>On the other hand,
the <a href="https://en.wikipedia.org/wiki/Union_(set_theory)">union</a> of two subgroups is generally
<a href="https://en.wikipedia.org/wiki/Subgroup#Basic_properties_of_subgroups">not a subgroup</a>.</p>

</details>

<h3 id="subgroup-cosets">Subgroup cosets</h3>

<p>If you combine each element of a <a href="#subgroups">subgroup</a> \(\mathbb{H}\)
with a fixed element \(A\) of the supergroup \(\mathbb{G}\),
you get a <a href="https://en.wikipedia.org/wiki/Coset">coset</a> of \(\mathbb{H}\), which is written as:</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

  <ul>
    <li><strong>Right coset</strong>: \(\mathbb{H} \circ A = \{H \circ A \mid H \in \mathbb{H}\}\),</li>
    <li><strong>Left coset</strong>: \(A \circ \mathbb{H} = \{A \circ H \mid H \in \mathbb{H}\}\).</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Right coset</strong>: \(\mathbb{H} + A = \{H + A \mid H \in \mathbb{H}\}\),</li>
    <li><strong>Left coset</strong>: \(A + \mathbb{H} = \{A + H \mid H \in \mathbb{H}\}\).</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Right coset</strong>: \(\mathbb{H} \cdot A = \{H \cdot A \mid H \in \mathbb{H}\}\),</li>
    <li><strong>Left coset</strong>: \(A \cdot \mathbb{H} = \{A \cdot H \mid H \in \mathbb{H}\}\).</li>
  </ul>

</div>

<p>If the group operation is <a href="#commutative-groups">commutative</a>,
the right coset and the left coset of a subgroup \(\mathbb{H}\) and an element \(A \in \mathbb{G}\) are the same.
If the element \(A\) belongs to the subgroup \(\mathbb{H}\),
the right coset and the left coset equal the subgroup itself due to <a href="#group-axioms">closure</a>:</p>

<p>

$$
\mathbb{H} \circ A = \mathbb{H} = A \circ \mathbb{H}
$$

$$
\mathbb{H} + A = \mathbb{H} = A + \mathbb{H}
$$

$$
\mathbb{H} \cdot A = \mathbb{H} = A \cdot \mathbb{H}
$$

</p>

<p id="cosets-are-equal-or-disjoint">Any two right cosets and any two left cosets are either equal or <a href="https://en.wikipedia.org/wiki/Disjoint_sets">disjoint</a>.
Given arbitrary elements \(A, B \in \mathbb{G}\), there are two cases:</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

  <ol>
    <li>If \(B \in \mathbb{H} \circ A\), then \(\mathbb{H} \circ A = \mathbb{H} \circ B\)</li>
    <li>If \(B \notin \mathbb{H} \circ A\), then \(\mathbb{H} \circ A \cap \mathbb{H} \circ B = \varnothing\)
(the <a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)">intersection</a> of the two cosets
results in the <a href="https://en.wikipedia.org/wiki/Empty_set">empty set</a>)</li>
  </ol>

  <!-- -->

  <ol>
    <li>If \(B \in \mathbb{H} + A\), then \(\mathbb{H} + A = \mathbb{H} + B\)</li>
    <li>If \(B \notin \mathbb{H} + A\), then \(\mathbb{H} + A \cap \mathbb{H} + B = \varnothing\)
(the <a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)">intersection</a> of the two cosets
results in the <a href="https://en.wikipedia.org/wiki/Empty_set">empty set</a>)</li>
  </ol>

  <!-- -->

  <ol>
    <li>If \(B \in \mathbb{H} \cdot A\), then \(\mathbb{H} \cdot A = \mathbb{H} \cdot B\)</li>
    <li>If \(B \notin \mathbb{H} \cdot A\), then \(\mathbb{H} \cdot A \cap \mathbb{H} \cdot B = \varnothing\)
(the <a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)">intersection</a> of the two cosets
results in the <a href="https://en.wikipedia.org/wiki/Empty_set">empty set</a>)</li>
  </ol>

</div>

<p>As different \(H \in \mathbb{H}\) are mapped to <a href="#unique-result">different elements</a> in every coset,
all cosets contain the same number of elements, namely <a href="#group-order">\(|\mathbb{H}|\)</a>.</p>

<h3 id="lagranges-theorem">Lagrange’s theorem</h3>

<p><a href="https://en.wikipedia.org/wiki/Lagrange%27s_theorem_(group_theory)">Lagrange’s theorem</a>
states that for any finite group \(\mathbb{G}\),
the <a href="#group-order">order</a> of every <a href="#subgroups">subgroup</a> \(\mathbb{H}\) of \(\mathbb{G}\)
divides the order of \(\mathbb{G}\).
In other words, if \(\mathbb{H}\) is a subgroup of \(\mathbb{G}\), \(|\mathbb{G}|\) is a
<a href="https://en.wikipedia.org/wiki/Multiple_(mathematics)">multiple</a> of \(|\mathbb{H}|\).
Since each element \(A \in \mathbb{G}\) belongs to a <a href="#subgroup-cosets">coset</a> of \(\mathbb{H}\)
(\(A \in \mathbb{H} \circ A\))
and all cosets of \(\mathbb{H}\) are either equal or disjoint and contain the same number of elements,
the cosets of \(\mathbb{H}\) split the group \(\mathbb{G}\)
into <a href="https://en.wikipedia.org/wiki/Subset">subsets</a> of equal size:</p>

<figure>
  <svg id="figure-subgroup-cosets" data-name="subgroup-cosets" width="126" height="188.5" viewBox="-3.75 -26.75 126 188.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <rect x="0" y="0" width="118.5" height="39.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="59.25" y="25.65"><tspan>ℍ</tspan></tspan>
    </text>
    <rect x="0" y="39.5" width="118.5" height="39.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="59.25" y="65.15"><tspan>ℍ ∘ A</tspan></tspan>
    </text>
    <rect x="0" y="79" width="118.5" height="39.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="59.25" y="104.65"><tspan>ℍ ∘ B</tspan></tspan>
    </text>
    <rect x="0" y="118.5" width="118.5" height="39.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="59.25" y="144.15"><tspan>⋮</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="59.25" y="-13.85">𝔾</tspan>
    </text>
    <rect x="-2.5" y="-2.5" width="123.5" height="163" rx="0" ry="0"></rect>

</svg>

  <figcaption>

The cosets of \(\mathbb{H}\) form a <a href="https://en.wikipedia.org/wiki/Partition_of_a_set">partition</a>
of the supergroup \(\mathbb{G}\)</figcaption>
</figure>

<p>Since \(\mathbb{H}\) is a coset of \(\mathbb{H}\),
it follows that \(|\mathbb{H}|\) divides \(|\mathbb{G}|\).
This theorem is named after <a href="https://en.wikipedia.org/wiki/Joseph-Louis_Lagrange">Joseph-Louis Lagrange</a> (1736 − 1813).</p>

<p id="lagrange-consequences">Lagrange’s theorem has several important consequences:</p>
<ol>
  <li>The <a href="#element-order">order</a> of every element \(A\) in \(\mathbb{G}\) divides the order of \(\mathbb{G}\)
because \(A\) <a href="#group-generators">generates</a> the <a href="#subgroups">subgroup</a> \(\href{#group-generators}{⟨A⟩}\),
where \(|⟨A⟩| = |A|\).</li>
  <li>Any element \(A\) in \(\mathbb{G}\)
repeated \(|\mathbb{G}|\) times equals the <a href="#group-axioms">identity element</a>
because with \(|\mathbb{G}| = |A| \cdot n\) for some integer \(n\):
    <p>

$$
(|\mathbb{G}|)A = (|A| \cdot n)A = n((|A|)A) = nO = O
$$

$$
A^{|\mathbb{G}|} = A^{|A| \cdot n} = (A^{|A|})^n = I^n = I
$$

</p>
  </li>
  <li>Every group of <a href="#prime-factorization">prime</a> order is <a href="#cyclic-groups">cyclic</a>,
and every element except the identity element is a <a href="#group-generators">generator</a>.
(Given a group \(\mathbb{G}\) where \(|\mathbb{G}|\) is prime,
the order of every \(A \in \mathbb{G}\) has to be \(1\) or \(|\mathbb{G}|\).
If its order is \(1\), \(A\) is the identity element.
If its order is \(|\mathbb{G}|\), \(A\) is a generator.)</li>
</ol>

<details>
  <summary id="index-and-cofactor">
Index and cofactor
</summary>

  <p>Given a group \(\mathbb{G}\) and a subgroup \(\mathbb{H}\),
the ratio \(\frac{|\mathbb{G}|}{|\mathbb{H}|}\) is called the
<a href="https://en.wikipedia.org/wiki/Index_of_a_subgroup">index of the subgroup</a>
or the <a href="https://en.wikipedia.org/wiki/Cofactor">cofactor</a> in the case of <a href="#elliptic-curves">elliptic curves</a>.</p>

</details>

<details>
  <summary id="proof-without-cosets-for-commutative-groups">
Proof without cosets for commutative groups
</summary>

  <p>If we restrict our attention to <a href="#commutative-groups">commutative groups</a>,
there’s a much simpler proof for why you get the <a href="#group-axioms">identity element</a>
when you <a href="#element-repetitions">repeat an element</a> of such a group as many times as there are elements in the group.
(I found this proof on page 34 of <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>.)
Since you get <a href="#unique-result">different results</a>
when you combine an element \(A\) with two different elements \(B_1\) and \(B_2\),
<!-- --> \(f(X) = A \circ X\) is an <a href="https://en.wikipedia.org/wiki/Bijection">invertible function</a>.
This means that \(f(X)\) is a <a href="#permutations">permutation</a>,
and thus \(f(\mathbb{G}) = \{f(B) \mid B \in \mathbb{G}\} = \mathbb{G}\).
Using <a href="#sum-and-product-of-similar-terms">Greek letters</a> to iterate over all the elements of a commutative group,
we can observe the following:</p>

  <p>

$$
\sum_{B \in \mathbb{G}} B
= \sum_{B \in \mathbb{G}} f(B)
= \sum_{B \in \mathbb{G}} A + B
= (|\mathbb{G}|)A + \Big( \sum_{B \in \mathbb{G}} B \Big) \\[8pt]
\textsf{After canceling } \sum_{B \in \mathbb{G}} B \textsf{ on both sides, we have that } O = (|\mathbb{G}|)A \textsf{.}
$$

$$
\prod_{B \in \mathbb{G}} B
= \prod_{B \in \mathbb{G}} f(B)
= \prod_{B \in \mathbb{G}} A \cdot B
= A^{|\mathbb{G}|} \cdot \Big( \prod_{B \in \mathbb{G}} B \Big) \\[8pt]
\textsf{After canceling } \prod_{B \in \mathbb{G}} B \textsf{ on both sides, we have that } I = A^{|\mathbb{G}|} \textsf{.}
$$

</p>

  <p>You can replace \(B\) with \(f(B)\) and aggregate all \(A\)
outside the <a href="https://en.wikipedia.org/wiki/Control_flow#Loops">loop</a>
only if the operation of the group is <a href="#commutative-groups">commutative</a>.
The <a href="#element-order">order of every element</a> has to divide the <a href="#group-order">order of the group</a>
because it cannot be larger and you wouldn’t get the identity element
if \(|\mathbb{G}|\) was not a multiple of \(|A|\).
To make similar statements about non-commutative groups and <a href="#non-cyclic-subgroups-of-non-cyclic-groups">non-cyclic subgroups</a>,
you still need <a href="#lagranges-theorem">Lagrange’s theorem</a> with its <a href="#subgroup-cosets">cosets</a>.
This is probably why this proof is not more popular;
but it is enough for our purposes.</p>

</details>

<h2 id="modular-arithmetic">Modular arithmetic</h2>

<p>Before we can look at some examples of <a href="#finite-groups">finite groups</a>,
we have to learn about <a href="https://en.wikipedia.org/wiki/Modular_arithmetic">modular arithmetic</a> first.</p>

<h3 id="euclidean-division">Euclidean division</h3>

<p><a href="https://en.wikipedia.org/wiki/Integer">Integers</a>
aren’t <a href="https://en.wikipedia.org/wiki/Closure_(mathematics)">closed</a>
under <a href="https://en.wikipedia.org/wiki/Division_(mathematics)">division</a>,
but you can divide any two integers with a <a href="https://en.wikipedia.org/wiki/Remainder">remainder</a>,
which is known as <a href="https://en.wikipedia.org/wiki/Euclidean_division">Euclidean division</a>.
Given a positive integer \(d &gt; 0\), every integer \(n\) can be written as \(n = q \cdot d + r\),
where \(q\) and \(r\) are integers and \(0 ≤ r &lt; d\).
In this equation,
<!-- --> \(n\) is called the <a href="https://en.wiktionary.org/wiki/dividend">dividend</a> (the quantity to be divided),
<!-- --> \(d\) is called the <a href="https://en.wiktionary.org/wiki/divisor">divisor</a> (the quantity which divides),
<!-- --> \(q\) is called the <a href="https://en.wiktionary.org/wiki/quotient">quotient</a>
(how many times the divisor is included in the dividend),
and \(r\) is called the <a href="https://en.wiktionary.org/wiki/remainder">remainder</a> (the quantity which is left over).</p>

<p>Since the divisor \(d\) splits the <a href="https://en.wikipedia.org/wiki/Number_line">number line</a> into equal sections,
the quotient \(q\) and the remainder \(r\) are unique:</p>

<figure>
  <svg id="figure-modulo-line-positive" data-name="modulo-line-positive" width="367.225" height="61.5" viewBox="-5.975 -29.75 367.225 61.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="0" y1="0" x2="360" y2="0" marker-end="url(#arrow)" stroke-dasharray="353"></line>
    <line x1="0" y1="-5" x2="240" y2="-5" marker-end="url(#arrow-blue)" stroke-dasharray="233"></line>
    <text text-anchor="middle">
        <tspan x="120" y="-17"><tspan>q · d</tspan></tspan>
    </text>
    <line x1="240" y1="-5" x2="300" y2="-5" marker-end="url(#arrow-green)" stroke-dasharray="53"></line>
    <text text-anchor="middle">
        <tspan x="270" y="-17">r</tspan>
    </text>
    <line x1="0" y1="-5" x2="0" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="0" y="28.5"><tspan>0</tspan></tspan>
    </text>
    <line x1="80" y1="-5" x2="80" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="80" y="28.5"><tspan>d</tspan></tspan>
    </text>
    <line x1="160" y1="-5" x2="160" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="160" y="28.5"><tspan>2d</tspan></tspan>
    </text>
    <line x1="240" y1="-5" x2="240" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="240" y="28.5"><tspan>q · d</tspan></tspan>
    </text>
    <line x1="320" y1="-5" x2="320" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="320" y="28.5"><tspan>(q + 1)d</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="200" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="200" y="-17"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="284.4" y="-17"><tspan>=</tspan></tspan>
    </text>
    <line x1="300" y1="-5" x2="300" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="300" y="-17"><tspan>n</tspan></tspan>
    </text>

</svg>

  <figcaption>
The divisor \(d\) divides the number line for positive integers.
</figcaption>
</figure>

<p>Personally, I’m satisfied with this geometric argument.
You find a more formal proof for the existence and the uniqueness of \(q\) and \(r\)
on <a href="https://en.wikipedia.org/wiki/Euclidean_division#Proof">Wikipedia</a>.
Since we are interested in positive divisors only, I didn’t bother to define Euclidean division for a negative \(d\).
What we do care about, though, is that the remainder \(r\) is
<a href="https://en.wikipedia.org/wiki/Sign_(mathematics)#non-negative_and_non-positive">non-negative</a>
(i.e. greater than or equal to zero) even if the integer \(n\) is negative:</p>

<figure>
  <svg id="figure-modulo-line-negative" data-name="modulo-line-negative" width="367.225" height="71.5" viewBox="-361.25 -34.75 367.225 71.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="0" y1="0" x2="-360" y2="0" marker-end="url(#arrow)" stroke-dasharray="353"></line>
    <line x1="0" y1="-5" x2="-320" y2="-5" marker-end="url(#arrow-blue)" stroke-dasharray="313"></line>
    <line x1="-320" y1="-10" x2="-260" y2="-10" marker-end="url(#arrow-green)" stroke-dasharray="53"></line>
    <line x1="0" y1="-10" x2="0" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="0" y="33.5"><tspan>0</tspan></tspan>
    </text>
    <line x1="-80" y1="-10" x2="-80" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="-80" y="33.5"><tspan>–d</tspan></tspan>
    </text>
    <line x1="-160" y1="-10" x2="-160" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="-160" y="33.5"><tspan>–2d</tspan></tspan>
    </text>
    <line x1="-240" y1="-10" x2="-240" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="-240" y="33.5"><tspan>(q + 1)d</tspan></tspan>
    </text>
    <line x1="-320" y1="-10" x2="-320" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="-320" y="33.5"><tspan>q · d</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-193.6" y="33.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-320" y="-22"><tspan>q · d</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-296.8" y="-22"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-284.8" y="-22"><tspan>r</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-272.8" y="-22"><tspan>=</tspan></tspan>
    </text>
    <line x1="-260" y1="-10" x2="-260" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="-260" y="-22"><tspan>n</tspan></tspan>
    </text>

</svg>

  <figcaption>
The divisor \(d\) also divides the number line for negative integers.
</figcaption>
</figure>

<details>
  <summary id="divisor">
Divisor
</summary>

  <p>An integer \(d\) which divides another integer \(n\) without a remainder
is a co-called <a href="https://en.wikipedia.org/wiki/Divisor">divisor</a> of \(n\).
This is usually written as \(d \mid n\),
which means that there is an integer \(c\) so that \(c \cdot d = n\).
In this context, the term “divisor” is used differently than in the <a href="#euclidean-division">Euclidean division</a> above.</p>

</details>

<h3 id="modulo-operation">Modulo operation</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Modulo_operation">modulo operation</a>
returns the remainder of <a href="#euclidean-division">Euclidean division</a>.
The divisor of the division is also called
the <a href="https://en.wiktionary.org/wiki/modulus#Latin">modulus</a> (a small measure or interval) of the operation.
The modulo operation is <a href="https://en.wikipedia.org/wiki/Modulo_operation#Notation">typically written as</a>
<!-- --> \(n \text{ mod } m\) or \(n\ \%\ m\), where \(n\) is the dividend and \(m\) is the modulus.
For example, \(8\ \%\ 3 = 2\).
Many calculators, including <a href="https://en.wikipedia.org/wiki/Google_Search">Google Search</a>
and <a href="https://en.wikipedia.org/wiki/Spotlight_(software)">Apple Spotlight</a>,
support the modulo operation in both notations
but struggle if you make the numbers large enough
(because some use <a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic">floating-point arithmetic</a>).
Since we want to perform calculations with very large integers in cryptography,
it’s time for the first <a href="https://riskmusings.substack.com/#interactive-tools">interactive tool</a> of this article:</p>



<details>
  <summary id="modulo-in-programming-languages">
Modulo in programming languages
</summary>

  <p>In many <a href="https://en.wikipedia.org/wiki/Programming_language">programming languages</a>,
including <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a>,
<a href="https://en.wikipedia.org/wiki/C%2B%2B">C++</a>,
<a href="https://en.wikipedia.org/wiki/Go_(programming_language)">Go</a>,
<a href="https://en.wikipedia.org/wiki/Java_(programming_language)">Java</a>,
and <a href="https://en.wikipedia.org/wiki/JavaScript">JavaScript</a>,
the <code>%</code> operator does not compute the remainder as <a href="#euclidean-division">presented here</a>.
Instead, these languages round the quotient towards zero and allow the remainder to be negative, which is listed
as truncated division on <a href="https://en.wikipedia.org/wiki/Modulo_operation#In_programming_languages">Wikipedia</a>.
For example, <code>-7 % 2 == -1</code>,
which means that you <a href="https://en.wikipedia.org/wiki/Modulo_operation#Common_pitfalls">cannot test</a>
whether a potentially negative integer is odd by using <code>n % 2 == 1</code>.
For the quotient, this behavior is probably desirable,
which is why signed division is implemented like this
in the <code>IDIV</code> instruction of the <a href="https://en.wikipedia.org/wiki/X86">x86</a>
<a href="https://en.wikipedia.org/wiki/Instruction_set_architecture">instruction set</a>.
The situation becomes even more complicated if you allow the divisor/modulus to be negative.</p>

</details>

<h3 id="equivalence-relation">Equivalence relation</h3>

<p>When we calculate all numbers modulo a fixed modulus, the numbers wrap around when they reach the modulus.
The best-known example for this is the <a href="https://en.wikipedia.org/wiki/Clock#Analog">analog clock</a>:</p>

<figure>
  <svg id="figure-modulo-clock" data-name="modulo-clock" width="217.45" height="221.5" viewBox="-108.725 -109.75 217.45 221.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="80"></circle>
    <line x1="0" y1="-75" x2="0" y2="-85"></line>
    <line x1="37.5" y1="-64.952" x2="42.5" y2="-73.612"></line>
    <line x1="64.952" y1="-37.5" x2="73.612" y2="-42.5"></line>
    <line x1="75" y1="0" x2="85" y2="0"></line>
    <line x1="64.952" y1="37.5" x2="73.612" y2="42.5"></line>
    <line x1="37.5" y1="64.952" x2="42.5" y2="73.612"></line>
    <line x1="0" y1="75" x2="0" y2="85"></line>
    <line x1="-37.5" y1="64.952" x2="-42.5" y2="73.612"></line>
    <line x1="-64.952" y1="37.5" x2="-73.612" y2="42.5"></line>
    <line x1="-75" y1="0" x2="-85" y2="0"></line>
    <line x1="-64.952" y1="-37.5" x2="-73.612" y2="-42.5"></line>
    <line x1="-37.5" y1="-64.952" x2="-42.5" y2="-73.612"></line>
    <text text-anchor="middle">
        <tspan x="0" y="-96.85"><tspan>0</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="51.375" y="-83.084"><tspan>1</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="88.984" y="-45.475"><tspan>2</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="102.75" y="5.9"><tspan>3</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="88.984" y="57.275"><tspan>4</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="51.375" y="94.884"><tspan>5</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="108.65"><tspan>6</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-51.375" y="94.884"><tspan>7</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-88.984" y="57.275"><tspan>8</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-102.75" y="5.9"><tspan>9</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-88.984" y="-45.475"><tspan>10</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-51.375" y="-83.084"><tspan>11</tspan></tspan>
    </text>
    <path d="M -53.333,0 A 53.333 53.333 0 0 1 53.333,0 L 53.334063,0.009973" marker-end="url(#arrow-green)" stroke-dasharray="161"></path>
    <text text-anchor="middle">
        <tspan x="0" y="-22"><tspan>+ 6</tspan></tspan><tspan x="0" y="0"><tspan>mod 12</tspan></tspan>
    </text>

</svg>

  <figcaption>
6 hours past 9 <abbr title="ante meridiem (before midday)">a.m.</abbr> is (9 + 6) <a href="#modulo-operation">%</a> 12 = 3 <abbr title="post meridiem (after midday)">p.m.</abbr>
</figcaption>
</figure>

<p>When two numbers have the same <a href="#euclidean-division">remainder</a>,
we say that they are equivalent up to a multiple of the modulus,
which means that their difference is a multiple of the modulus.
Given the numbers \(a\) and \(b\), this is usually written in one of the following two ways:</p>

<p>\[\begin{aligned}
a &amp;\equiv b \pmod m \\
\textsf{or} \quad a &amp;\equiv_m b
\end{aligned}\]
</p>

<p>I prefer the latter to the former because it makes it clearer
that the aspect which is affected by the modulus is the comparison of the two numbers.
The second notation is also more flexible as it allows us to use the modular comparison
and the <a href="https://en.wikipedia.org/wiki/Equality_(mathematics)">ordinary equality</a>
in a <a href="#index-calculus-algorithm">single line</a>.
Since the third dash increases the load on our eyes
(similar to <a href="https://en.wikipedia.org/wiki/Visual_pollution">visual pollution</a>)
without any benefits, I will simply write:</p>

\[a =_m b\]

<p>The reason for not dropping the modulus in the <a href="https://en.wikipedia.org/wiki/Subscript_and_superscript">subscript</a>
of the <a href="https://en.wikipedia.org/wiki/Equals_sign">equals sign</a> as well is
that the modulus is a useful reminder of whether we perform a computation with simple numbers
in the <a href="#multiplicative-groups">modular group</a> or the <a href="#repetition-ring">repetition ring</a>.
If a computation is performed with something else,
such as <a href="#point-addition">points</a> or <a href="https://en.wikipedia.org/wiki/Polynomial">polynomials</a>,
we will leave the meaning of the equals sign to the context in which it is used.</p>

<p>We have now five different ways to express the same <a href="https://en.wikipedia.org/wiki/Relation_(mathematics)">relation</a>
between two integers \(a\) and \(b\):</p>

\[a\ \%\ m = b\ \%\ m
\enspace \iff \enspace a =_m b
\enspace \iff \enspace (a - b)\ \%\ m = 0
\enspace \iff \enspace m \href{#divisor}{\mid} (a - b)
\enspace \iff \enspace a = b + c \cdot m \textsf{ for some integer } c\]

<p id="equivalence-properties">Equality of remainders is an <a href="https://en.wikipedia.org/wiki/Equivalence_relation">equivalence relation</a>,
which is defined by the following three properties given any numbers \(a\), \(b\), and \(c\):</p>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Reflexive_relation"><strong>Reflexivity</strong></a>:
\(a =_m a\).</li>
  <li><a href="https://en.wikipedia.org/wiki/Symmetric_relation"><strong>Symmetry</strong></a>:
If \(a =_m b\), then \(b =_m a\).</li>
  <li><a href="https://en.wikipedia.org/wiki/Transitive_relation"><strong>Transitivity</strong></a>:
If \(a =_m b\) and \(b =_m c\), then \(a =_m c\).</li>
</ul>

<p>These properties are satisfied when considering only the remainder of numbers
because the remainder is unique for every number.</p>

<h3 id="congruence-relation">Congruence relation</h3>

<p>The above <a href="#equivalence-relation">equivalence relation</a> is compatible with
<a href="https://en.wikipedia.org/wiki/Addition">addition</a> and <a href="https://en.wikipedia.org/wiki/Multiplication">multiplication</a>
in the sense that equivalent inputs yield equivalent outputs:
For any integers \(a_1\), \(a_2\), \(b_1\), and \(b_2\) so that \(a_1 =_m a_2\) and \(b_1 =_m b_2\)
(i.e. \(a_1 = a_2 + c_a \cdot m\) and \(b_1 = b_2 + c_b \cdot m\) for some integers \(c_a\) and \(c_b\)),
we have that</p>
<ul>
  <li>\(a_1 + b_1 =_m a_2 + b_2\)
because \(a_1 + b_1 = (a_2 + c_a \cdot m) + (b_2 + c_b \cdot m) = (a_2 + b_2) + (c_a + c_b) \cdot m\), and</li>
  <li>\(a_1 \cdot b_1 =_m a_2 \cdot b_2\)
because \(a_1 \cdot b_1 = (a_2 + c_a \cdot m) \cdot (b_2 + c_b \cdot m)
= (a_2 \cdot b_2) + (a_2 \cdot c_b + c_a \cdot b_2 + c_a \cdot c_b \cdot m) \cdot m\).</li>
</ul>

<p>An equivalence relation which is compatible with the operations of interest
is a <a href="https://en.wikipedia.org/wiki/Congruence_relation">congruence relation</a>.
Calculating modulo \(m\) therefore means that we can eliminate multiples of \(m\) without affecting the equivalence relation.
Since only the remainders are relevant, we can – and will – represent all numbers by their unique remainder.
Instead of reinterpreting what it means to be equal,
we could just as well <a href="https://en.wikipedia.org/wiki/Operator_overloading">overload the operators</a>
so that \(a +_m b = (a + b)\ \%\ m\) and \(a \cdot_m b = (a \cdot b)\ \%\ m\).
This is an <a href="#quotient-rings">adequate way to think about modular arithmetic</a>
and also how I <a href="https://github.com/KasparEtter/ef1p/tree/main/code/math">implemented the following tools</a>.
Regarding notation, it’s better to keep the modulus next to the equals sign, though,
because it makes longer expressions easier to read.
Moreover, some operations,
such as <a href="https://en.wikipedia.org/wiki/Modular_exponentiation">modular exponentiation</a>,
are written without an operator to which the modulus could be attached.</p>

<h2 id="additive-groups">Additive groups</h2>

<p>After having gone through quite a bit of theory,
the time has finally come to see some <a href="#finite-groups">finite groups</a> in action.
The integers modulo some integer \(m\) form a <a href="#commutative-groups">commutative group</a>
under <a href="https://en.wikipedia.org/wiki/Addition">addition</a>.
As explained in the <a href="#modular-arithmetic">previous chapter</a>,
you can either define the set of the group to contain all the integers
and redefine what it <a href="#equivalence-relation">means to be equal</a>,
or restrict the set of elements to \(\{0, 1, …, m - 1\}\)
and <a href="#congruence-relation">redefine addition</a> as \(A +_m B = (A + B)\ \href{#modulo-operation}{\%}\ m\).
The latter is usually preferred because it makes the representation of elements unique.
The number of elements is given by the modulus \(m\).
It’s easy to see why addition modulo \(m\) satisfies the four <a href="#group-axioms">group axioms</a>:</p>
<ul>
  <li><strong>Closure</strong>:
Every integer has a <a href="#euclidean-division">remainder</a> between \(0\) and \(m - 1\) (both inclusive).
It’s not possible to leave the set of elements.</li>
  <li><strong>Associativity</strong>:
Since reducing intermediate results to their remainder <a href="#congruence-relation">doesn’t change the result</a>,
addition <a href="https://en.wikipedia.org/wiki/Addition#Associativity">remains associative</a>.</li>
  <li><strong>Identity</strong>:
The number \(0\) is the only <a href="https://en.wikipedia.org/wiki/Addition#Identity_element">identity element</a>.
For any number \(A\), we have that \(A + 0 = 0 + A = A\).</li>
  <li><strong>Invertibility</strong>:
The inverse of any number \(A\) is \(m - A\) because \(A + (m - A) =_m 0\).</li>
</ul>

<p>The combinations of elements can be displayed in an <a href="#additive-group-operation-table">operation table</a>
and the <a href="#element-repetitions">repetitions of each element</a> in a <a href="#additive-group-repetition-table">repetition table</a>.</p>

<h3 id="additive-group-operation-table">Operation table</h3>

<p>An operation table is a <a href="https://en.wikipedia.org/wiki/Mathematical_table">mathematical table</a>
which lists the results of combining any two elements
with a <a href="https://en.wikipedia.org/wiki/Binary_operation">binary operation</a>.
If the table is exhaustive, it defines the operation by <a href="https://en.wikipedia.org/wiki/Enumeration">enumeration</a>.
You likely had to learn the <a href="https://en.wikipedia.org/wiki/Multiplication_table">multiplication table</a>
up to a factor of 10 by heart in <a href="https://en.wikipedia.org/wiki/Primary_school">primary school</a>,
and you might also be familiar with <a href="https://en.wikipedia.org/wiki/Truth_table">truth tables</a>,
which are used to define <a href="https://en.wikipedia.org/wiki/Truth_function">truth functions</a>.
In the case of <a href="#finite-groups">groups</a>,
an operation table is also called a group table, a composition table,
or a <a href="https://en.wikipedia.org/wiki/Cayley_table">Cayley table</a>,
named after <a href="https://en.wikipedia.org/wiki/Arthur_Cayley">Arthur Cayley</a> (1821 − 1895).
Just to be clear, an operation table has nothing to do
with an <a href="https://en.wikipedia.org/wiki/Operating_table">operating table</a>.</p>

<p>The following tool allows you to generate the operation table
for all <a href="#additive-groups">additive groups</a> up to a modulus of 100:</p>



<p>All the elements which are <a href="#multiset-of-prime-factors">coprime</a> with the modulus
are highlighted with a green background in the first row and the first column.
We’ll discuss the properties of operation tables when we look at <a href="#multiplicative-groups">multiplicative groups</a>,
where the tables are a bit more interesting.</p>

<h3 id="additive-group-repetition-table">Repetition table</h3>

<p>Most of the <a href="#finite-groups">introduction to group theory</a>
was about <a href="#element-repetitions">combining the same element with itself repeatedly</a>.
We learned that the <a href="#group-axioms">identity element</a> is reached before another element occurs twice
and that this <a href="#element-order">element order</a> divides the <a href="#group-order">group order</a>.
You can observe both properties for moduli up to 100 in the tool below,
where each element is repeated in a separate row until it reaches the identity element.
Such tables aren’t commonly used to visualize <a href="#lagranges-theorem">Lagrange’s theorem</a>
and other properties, such as <a href="#number-of-generators-in-cyclic-groups">the number of generators</a>.
I call them repetition tables, but feel free to refer to them as <a href="https://riskmusings.substack.com/#about">Etter tables</a>. 😉</p>



<p>The first row indicates how many times the element in the first column was repeated.
(Remember that repeated addition is <a href="#element-repetitions">written as multiplication</a>.)
The tool highlights all the repetitions which divide the number of elements in the group with a blue background.
These are the columns in which the identity element can be reached in the repetitions below.
You can increase and decrease the modulus by pressing
the up and down <a href="https://en.wikipedia.org/wiki/Arrow_keys">arrow keys</a> of your keyboard
when the <a href="https://en.wikipedia.org/wiki/Cursor_(user_interface)">cursor</a>
is in the <a href="https://en.wikipedia.org/wiki/Text_box">input field</a>.</p>

<p>In the case of additive groups,
the following properties are easy to understand even if you don’t know anything about <a href="#finite-groups">group theory</a>:</p>
<ul>
  <li><strong>Group order</strong>: A multiple of the modulus is obviously <a href="#congruence-relation">congruent</a> to zero,
i.e. \(mA =_m 0\) for any number \(A\).
This was also <a href="#lagrange-consequences">one of the consequences</a> of <a href="#lagranges-theorem">Lagrange’s theorem</a>.
You can observe it in the repetition table above by <a href="#tool-table-additive-group-repetition&amp;repeat=true">enabling “Repeat”</a>.</li>
  <li><strong>Prime modulus</strong>: If the modulus \(m\) is <a href="#prime-factorization">prime</a>,
you won’t get a multiple of \(m\) until you repeat any element except zero \(m\) times.
Since you cannot hit some element twice <a href="#element-order">before reaching the identity element</a>,
all elements except zero <a href="#group-generators">generate the whole group</a>.</li>
  <li><strong>Cyclic groups</strong>: Additive groups modulo some number are always <a href="#cyclic-groups">cyclic</a>
because the number 1 always generates the whole group.</li>
  <li><strong>Gray element</strong>: If the modulus \(m\) is even, the element \(\frac{m}{2}\) has an order of two.
An order of two means that \(\frac{m}{2}\) is <a href="#even-number-of-generators">its own inverse</a>.
All other elements except zero have an order greater than two
because for all elements \(A &lt; \frac{m}{2}\), we have that \(2A &lt; m\),
and for all elements \(A &gt; \frac{m}{2}\), we have that \(m &lt; 2A &lt; 2m\).
Thus, whenever an element has an even order
(which can be the case <a href="#lagranges-theorem">only if \(m\) is even</a>),
you reach \(\frac{m}{2}\) halfway to the identity element.
To make it easier to see this, the tool marks \(\frac{m}{2}\) with a gray background.</li>
</ul>

<p>You can ignore the additional options of the tool for now;
we’ll make use of them <a href="#sum-of-eulers-totient-function-over-divisors">later on</a>.</p>

<h3 id="additive-group-subgroup-cosets">Subgroup cosets</h3>

<p>As we learned <a href="#lagranges-theorem">above</a>,
the order of every subgroup divides the order of the group
because the <a href="#subgroup-cosets">cosets of a subgroup</a> are either equal or disjoint
and all elements of the group belong to a coset of a particular subgroup.
The following tool demonstrates this for additive groups modulo some number.
The first row contains the elements of the subgroup which is <a href="#group-generators">generated</a> by the given element.
It corresponds to the row of the given element in the group’s <a href="#additive-group-repetition-table">repetition table</a>
with the difference that the identity element comes first instead of last.
The second row contains the elements of the first row incremented by one,
the third row contains the elements of the first row incremented by two, and so on.
The reason why I put the identity element into the first column is
to make it easy to recognize which coset is represented by a particular row.</p>



<p>For example, <a href="#tool-cosets-additive-group&amp;modulus=9&amp;element=3&amp;unique=false">setting the modulus to 9 and the element to 3</a>,
the first row is \(\href{#group-generators}{⟨3⟩} = \{0, 3, 6\}\),
the second row is \(⟨3⟩ + 1 = \{0 + 1 = 1, 3 + 1 = 4, 6 + 1 = 7\}\), and so on.
If the element in the first column appears in another row,
then the elements in these two rows are identical, they just appear in a different order.
If the element in the first column does not appear in another row,
then the two rows have no elements in common.
You can filter all the rows whose elements already appeared in the table
by <a href="#tool-cosets-additive-group&amp;unique=true">enabling “Unique”</a>.
In order to make it easier to spot that each element appears exactly once when “Unique” is enabled,
the elements of the group are highlighted with a blue background one after the other.
You can disable this animation by <a href="#tool-cosets-additive-group&amp;delay=0">setting the delay to 0</a>.</p>

<details>
  <summary id="visualization-of-cosets">
Visualization of cosets
</summary>

  <p>For additive groups modulo some number,
even the fact that a group is partitioned by <a href="#subgroup-cosets">subgroup cosets</a> is somewhat intuitive:</p>

  <figure>
    <svg id="figure-additive-group-modulo-9" data-name="additive-group-modulo-9" width="217" height="217" viewBox="-108.5 -108.5 217 217" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="80"></circle>
    <text text-anchor="middle">
        <tspan x="0" y="5.9"><tspan>+3</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="-95.6"><tspan>0</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="65.243" y="-71.854"><tspan>1</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="99.958" y="-11.725"><tspan>2</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="87.902" y="56.65"><tspan>3</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="34.715" y="101.279"><tspan>4</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-34.715" y="101.279"><tspan>5</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-87.902" y="56.65"><tspan>6</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-99.958" y="-11.725"><tspan>7</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-65.243" y="-71.854"><tspan>8</tspan></tspan>
    </text>
    <line x1="78.785" y1="-13.892" x2="-24.489" y2="72.765" marker-start="url(#circle-yellow)" marker-end="url(#arrow-yellow)" stroke-dasharray="128"></line>
    <line x1="-27.362" y1="75.175" x2="-50.772" y2="-57.591" marker-start="url(#circle-yellow)" marker-end="url(#arrow-yellow)" stroke-dasharray="128"></line>
    <line x1="-51.423" y1="-61.284" x2="75.261" y2="-15.174" marker-start="url(#circle-yellow)" marker-end="url(#arrow-yellow)" stroke-dasharray="128"></line>
    <line x1="51.423" y1="-61.284" x2="28.013" y2="71.482" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="128"></line>
    <line x1="27.362" y1="75.175" x2="-75.912" y2="-11.481" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="128"></line>
    <line x1="-78.785" y1="-13.892" x2="47.899" y2="-60.001" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="128"></line>
    <line x1="0" y1="-80" x2="67.407" y2="36.752" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="128"></line>
    <line x1="69.282" y1="40" x2="-65.532" y2="40" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="128"></line>
    <line x1="-69.282" y1="40" x2="-1.875" y2="-76.752" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="128"></line>

</svg>

    <figcaption>

The subgroup generated by the element 3 in red</figcaption>
  </figure>

  <p>Admittedly, this is the simplest possible case.
What happens if you don’t hit \(0\) in the first pass and have to do more loops?
If you repeat an element from the left side of the circle,
then you just reach the elements in the opposite order
(e.g. \((6 + 6)\ \%\ 9 = 3\) and \((3 + 6)\ \%\ 9 = 0\)).
For a more sophisticated example, let’s look at the
<a href="#tool-cosets-additive-group&amp;modulus=14&amp;element=6&amp;unique=true">additive group modulo 14 with the element 6</a>:</p>

  <figure>
    <svg id="figure-additive-group-modulo-14" data-name="additive-group-modulo-14" width="218.155" height="219" viewBox="-109.655 -108.5 218.155 219" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="80"></circle>
    <text text-anchor="middle">
        <tspan x="0" y="5.9"><tspan>+6</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="-95.6"><tspan>0</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="44.039" y="-85.548"><tspan>1</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="79.356" y="-57.384"><tspan>2</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="98.955" y="-16.686"><tspan>3</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="98.955" y="28.486"><tspan>4</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="79.356" y="69.184"><tspan>5</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="44.039" y="97.348"><tspan>6</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="107.4"><tspan>7</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-44.039" y="97.348"><tspan>8</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-79.356" y="69.184"><tspan>9</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-98.955" y="28.486"><tspan>10</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-98.955" y="-16.686"><tspan>11</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-79.356" y="-57.384"><tspan>12</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-44.039" y="-85.548"><tspan>13</tspan></tspan>
    </text>
    <line x1="34.711" y1="-72.078" x2="0.834" y2="76.344" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="0" y1="80" x2="-33.876" y2="-68.422" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="-34.711" y1="-72.078" x2="60.208" y2="46.947" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="62.547" y1="49.879" x2="-74.616" y2="-16.175" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="-77.994" y1="-17.802" x2="74.244" y2="-17.802" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="77.994" y1="-17.802" x2="-59.168" y2="48.252" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="-62.547" y1="49.879" x2="32.373" y2="-69.146" marker-start="url(#circle-orange)" marker-end="url(#arrow-orange)" stroke-dasharray="145"></line>
    <line x1="0" y1="-80" x2="33.876" y2="68.422" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="34.711" y1="72.078" x2="-60.208" y2="-46.947" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="-62.547" y1="-49.879" x2="74.616" y2="16.175" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="77.994" y1="17.802" x2="-74.244" y2="17.802" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="-77.994" y1="17.802" x2="59.168" y2="-48.252" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="62.547" y1="-49.879" x2="-32.373" y2="69.146" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>
    <line x1="-34.711" y1="72.078" x2="-0.834" y2="-76.344" marker-start="url(#circle-red)" marker-end="url(#arrow-red)" stroke-dasharray="145"></line>

</svg>

    <figcaption>

The subgroup generated by the element 6 in red</figcaption>
  </figure>

  <p>As you can see in the above graphic,
the distance between adjacent elements of the subgroup is always the same.
This has to be the case because repeating an element generates a <a href="#cyclic-groups">cyclic</a> <a href="#subgroups">subgroup</a>,
which is <a href="#group-axioms">closed</a>.
As a consequence, the difference between the two closest elements is itself an element.
(If we denote the closest elements as \(A\) and \(B\),
then \(B + (-A)\) is also an element of the subgroup due to closure.)
This difference can then be added and subtracted from all other elements.
If this leads to an even smaller gap, you repeat this procedure until the subgroup is closed.
If the original element does not generate the whole group,
you get a disjoint coset when you rotate the generated subgroup by one.
As we’ll see <a href="#bezouts-identity">later</a>, the difference between adjacent elements of the generated subgroup
equals the <a href="#greatest-common-divisor">greatest common divisor</a> of the generating element and the modulus,
and the first time you hit zero again corresponds to the <a href="#least-common-multiple">least common multiple</a> of these two numbers.</p>

</details>

<h3 id="additive-group-notations">Group notations</h3>

<p>The additive group of integers modulo some number \(m\) is usually denoted
as \((\mathbb{Z}/m\mathbb{Z})^+\) or \(\mathbb{Z}_m^+\).
(By convention, \(\mathbb{Z}\) stands for the <a href="https://en.wikipedia.org/wiki/Integer">set of all integers</a>.
The letter comes from the German word for numbers, which is <a href="https://en.wiktionary.org/wiki/Zahlen">Zahlen</a>.)
The former notation refers to the additive group of the <a href="#quotient-rings">quotient ring</a> \(\mathbb{Z}/m\mathbb{Z}\).
Since the second notation is also used for a
<a href="https://en.wikipedia.org/wiki/P-adic_number#p-adic_integers">different mathematical concept</a>,
mathematicians typically prefer the former, whereas cryptographers tend to settle for the latter.</p>

<h2 id="multiplicative-groups">Multiplicative groups</h2>

<p>The integers modulo some integer \(m\) can also be combined
using <a href="https://en.wikipedia.org/wiki/Multiplication">multiplication</a>,
which results in the so-called
<a href="https://en.wikipedia.org/wiki/Multiplicative_group_of_integers_modulo_n">multiplicative group of integers modulo \(m\)</a>.
Since <a href="#equivalence-relation">equivalence up to a multiple of \(m\)</a>
is <a href="#congruence-relation">preserved also under multiplication</a>,
it’s easy to see why modular multiplication is still <a href="#group-axioms">associative</a>.
It’s also rather obvious that the number \(1\) is the identity element
because for any number \(A\), \(A \cdot 1 = 1 \cdot A = A\).
Since there is no number \(B\) for which \(0 \cdot B =_m 1\), \(0\) has to be excluded from the set of elements.
What remains to be seen is which other numbers below the modulus have an inverse
and why the group is closed if the numbers without an inverse are excluded.
The short answer is that integers have a <a href="#modular-multiplicative-inverse">multiplicative inverse</a>
<a href="#if-and-only-if">if and only if</a> the only <a href="#greatest-common-divisor">factor in common</a> with the modulus is \(1\).
We will see in the <a href="#multiplicative-inverse-revisited">next chapter</a> why this is the case.
For now, just be aware that the following tools do not always display groups.
If the modulus is not prime, you have to enable the “<a href="#multiset-of-prime-factors">coprime</a> filter” to get a group.
This is the reason why <a href="#prime-factorization">prime numbers</a> play such an important role in number theory and cryptography.</p>

<details>
  <summary id="if-and-only-if">
If and only if
</summary>

  <p>Given two statements \(P\) and \(Q\),
“\(P\) <a href="https://en.wikipedia.org/wiki/If_and_only_if">if and only if</a> \(Q\)”
means that either both statements are true or neither of them is.
In other words, \(P\) is
<a href="https://en.wikipedia.org/wiki/Necessity_and_sufficiency#Simultaneous_necessity_and_sufficiency">necessary and sufficient</a>
for \(Q\) (and the other way around),
which means that each statement <a href="#material-implication">implies the other</a>.
In formulas,
this so-called <a href="https://en.wikipedia.org/wiki/If_and_only_if">material equivalence</a> is usually written as \(\iff\),
which is a <a href="https://en.wikipedia.org/wiki/Truth_function#Table_of_binary_truth_functions">binary truth function</a>
with the following <a href="https://en.wikipedia.org/wiki/Truth_table">truth table</a>
(using <a href="https://en.wikipedia.org/wiki/Tee_(symbol)">\(\top\)</a> for true
and <a href="https://en.wikipedia.org/wiki/Up_tack">\(\bot\)</a> for false):</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>\(P\)</th>
          <th>\(Q\)</th>
          <th>\(P \iff Q\)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
      </tbody>
    </table>

    <figcaption>
The definition of \(\iff\).
</figcaption>
  </figure>

</details>

<h3 id="multiplicative-group-operation-table">Operation table</h3>

<p>The following tool allows you to generate the <a href="#additive-group-operation-table">operation table</a>
for all <a href="#multiplicative-groups">multiplicative groups</a> up to a modulus of 100:</p>



<p>Operation tables of groups, which are also known as <a href="https://en.wikipedia.org/wiki/Cayley_table">Cayley tables</a>,
have <a href="#symmetries">some</a> <a href="#permutations">interesting</a> <a href="#identity-row-and-column">properties</a>.
I limited the modulus to 100 not because these properties no longer hold for larger moduli
but because the operation table becomes unwieldy way before that.</p>

<h4 id="symmetries">Symmetries</h4>

<p>The table is symmetric along the diagonal axis from the upper left corner to the lower right corner
<a href="#if-and-only-if">if and only if</a> the operation is <a href="#commutative-groups">commutative</a>
and the elements are listed in the same order in both dimensions.
All the groups that we are interested in are commutative.
If the operation is not commutative,
<a href="https://en.wikipedia.org/wiki/Cayley_table#Structure_and_layout">the convention is</a>
that the first element determines the row and the second element determines the column of the table.
If you play with the <a href="#tool-table-multiplicative-group-operation">above tool</a>,
you notice that the table is also symmetric along the diagonal axis from the lower left corner to the upper right corner.
The reason for this is that the product of two negative numbers is the same
as the product of the corresponding positive numbers:
<!-- --> \(A \cdot B = B \cdot A = (-B) \cdot (-A) =_m (m - B) \cdot (m - A)\).
This second symmetry is specific to <a href="#multiplicative-groups">multiplicative groups</a>,
which you can verify by going back to the <a href="#additive-group-operation-table">additive groups</a>.</p>

<h4 id="permutations">Permutations</h4>

<p>The <a href="#group-axioms">group axioms</a> imply that \(A \circ X = B\) and \(Y \circ A = B\)
have <a href="#unique-solution">unique solutions</a> for any elements \(A\) and \(B\) of the group.
This means that each row and column of a group’s operation table may contain each element only once.
Otherwise, the solution is not unique:</p>

<figure>

  <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>⋯</th>
      <th>X<sub>1</sub></th>
      <th>⋯</th>
      <th>X<sub>2</sub></th>
      <th>⋯</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>⋮</th>
      <td></td>
      <td>⋮</td>
      <td></td>
      <td>⋮</td>
      <td></td>
    </tr>
    <tr>
      <th>A</th>
      <td>⋯</td>
      <td>B</td>
      <td>⋯</td>
      <td>B</td>
      <td>⋯</td>
    </tr>
    <tr>
      <th>⋮</th>
      <td></td>
      <td>⋮</td>
      <td></td>
      <td>⋮</td>
      <td></td>
    </tr>
  </tbody>
</table>

  <figcaption>
A row (or column) may not contain the same element twice.
</figcaption>
</figure>

<p>Due to <a href="#group-axioms">closure</a>, each combination of two elements results in another element.
Therefore, none of the cells may be empty and each row and column has to contain each element
<a href="https://en.wikipedia.org/wiki/Pigeonhole_principle#Alternative_formulations">exactly once</a>.
In other words, the rows and columns are <a href="https://en.wikipedia.org/wiki/Permutation">permutations</a> of the group’s elements
and the operation table forms a so-called <a href="https://en.wikipedia.org/wiki/Latin_square">Latin square</a>,
where each symbol occurs exactly once in each row and column.</p>

<h4 id="identity-row-and-column">Identity row and column</h4>

<p>Since groups have an identity element,
one of the rows has to match the column headers
and one of the columns has to match the row headers.
Put differently, the <a href="https://en.wikipedia.org/wiki/Permutation_group#Neutral_element_and_inverses">identity permutation</a>,
which maps every element of the group to itself,
has to be included in the <a href="#permutations">permutations</a> of the rows and the columns.
If the elements are listed in the same order along the vertical and the horizontal axis of the table,
the identity row intersects the identity column on the diagonal from the upper left corner to the lower right corner
because the identity element equals itself when it is combined with itself.
(This property is called <a href="#idempotence">idempotence</a>.)</p>

<details>
  <summary id="latin-square-associativity-group">
Latin square + associativity = group
</summary>

  <p>Being a <a href="https://en.wikipedia.org/wiki/Latin_square">Latin square</a> is not a
<a href="https://en.wikipedia.org/wiki/Necessity_and_sufficiency#Sufficiency">sufficient condition</a> to form a group,
which can be demonstrated with the following example:</p>

  <figure>

    <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>B</td>
      <td>A</td>
      <td>C</td>
    </tr>
    <tr>
      <th>B</th>
      <td>A</td>
      <td>C</td>
      <td>B</td>
    </tr>
    <tr>
      <th>C</th>
      <td>C</td>
      <td>B</td>
      <td>A</td>
    </tr>
  </tbody>
</table>

    <figcaption>
This operation does not form a group.
</figcaption>
  </figure>

  <p>This table lacks an identity row and column,
but more importantly, the operation is not <a href="#group-axioms">associative</a>.
For example, \((A \circ B) \circ C = A \circ C = C\),
whereas \(A \circ (B \circ C) = A \circ B = B\).
Since associativity makes a statement about three elements and not just two,
it is <a href="https://en.wikipedia.org/wiki/Cayley_table#Associativity">difficult to spot</a>
whether an operation is associative based on its table.
If an operation defined by a Latin square is associative, it does form a group, though.
In order to understand why this is the case, we need to understand
why an associative operation with <a href="#unique-solution">unique solutions</a>
implies that the identity element is the same for all elements.</p>

  <p>Since every column of the operation table is a <a href="#permutations">permutation</a> of the group’s elements,
every element has to appear in its own column.
This means that for every element \(D\), there exists an element \(E\) so that \(E \circ D = D\).
By applying this element <a href="#preservation-of-equality">on both sides</a> from the left,
we get \(E \circ (E \circ D) = E \circ D\).
Due to associativity, \((E \circ E) \circ D = E \circ D\).
Since \(X \circ D = D\) has a unique solution, \(E \circ E = E\).
In other words, every identity for a single element is <a href="#idempotence">idempotent</a>.
What remains to be seen is that an idempotent element is an identity for all elements.</p>

  <p>For any element \(F\), \(E \circ X = F\) has a unique solution.
Since \(E \circ E = E\), \((E \circ E) \circ X = F\) and thus \(E \circ (E \circ X) = F\).
Using the fact that \(E \circ X = F\), it follows that \(F\) is the unique solution for \(E \circ X = F\).
This is why an identity for one element is an identity for all elements.
The identity element is unique because \(X \circ F = F\) would have two solutions otherwise.
The same argument can be used to show that the right identity is also unique.
The left identity \(E_L\) and the right identity \(E_R\) are the same
because they are identities for each other: \(E_L = E_L \circ E_R = E_R\).
Since you can get from any element to any other element in a Latin square,
you can get to the unique identity from any element,
which means that each element has an inverse.</p>

  <p>We have shown that any associative operation which generates a Latin square forms a group.
I cover an alternative proof for these alternative group axioms <a href="#alternative-group-axioms">in the last chapter</a>.</p>

</details>

<details>
  <summary id="fixing-the-group-of-order-3">
Fixing the group of order 3
</summary>

  <p>Before we continue, let’s fix the <a href="#latin-square-associativity-group">above operation table</a>
by starting with the necessary identity row and column:</p>

  <figure>

    <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>A</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>B</th>
      <td>B</td>
      <td>?</td>
      <td>?</td>
    </tr>
    <tr>
      <th>C</th>
      <td>C</td>
      <td>?</td>
      <td>?</td>
    </tr>
  </tbody>
</table>

    <figcaption>
A skeleton for a group of order 3.
</figcaption>
  </figure>

  <p>We may try to complete the operation table by setting \(B \circ B\) to \(A\),
but this would lead to a conflict in the third row and column:</p>

  <figure>

    <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>A</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>B</th>
      <td>B</td>
      <td>A</td>
      <td>!</td>
    </tr>
    <tr>
      <th>C</th>
      <td>C</td>
      <td>!</td>
      <td>?</td>
    </tr>
  </tbody>
</table>

    <figcaption>
This cannot be completed to a Latin square.
</figcaption>
  </figure>

  <p>Given that \(C\) has to occur in the middle row and column and cannot occur a second time in the last row and column,
it has to be that \(B \circ B = C\).
Another reason for this is that \(B \circ B = A\) makes the <a href="#element-order">order</a> of \(B\) 2
since \(A\) is the identity element; but this violates <a href="#lagranges-theorem">Lagrange’s theorem</a>,
which implies that the order of any element divides the <a href="#group-order">order of the group</a>.
Therefore:</p>

  <figure>

    <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>A</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>B</th>
      <td>B</td>
      <td>C</td>
      <td>A</td>
    </tr>
    <tr>
      <th>C</th>
      <td>C</td>
      <td>A</td>
      <td>B</td>
    </tr>
  </tbody>
</table>

    <figcaption>
The only group of order 3.
</figcaption>
  </figure>

  <p>Since there was no other way to complete the operation table, this is the only group of order 3.
In fact, all groups of prime order are unique up to a relabeling of the elements because
<a href="#lagranges-theorem">as we saw earlier</a>, groups of prime order are <a href="#cyclic-groups">cyclic</a>,
and <a href="#isomorphism-of-cyclic-groups">as we will see later</a>,
all cyclic groups of the same order <a href="#group-isomorphisms">behave identically</a>.
This particular group corresponds to the
<a href="#tool-table-additive-group-operation&amp;modulus=3&amp;coprime=false">additive group modulo 3</a>.</p>

  <p>If you enjoy solving <a href="https://en.wikipedia.org/wiki/Sudoku">Sudokus</a>,
you might also enjoy solving the operation table for groups of higher order.
For example, there are
<a href="https://en.wikipedia.org/wiki/List_of_small_groups#List_of_small_abelian_groups">two solutions for groups of order 4</a>.
Can you find them?
And can you <a href="https://proofwiki.org/wiki/Groups_of_Order_4">prove that these are the only two groups of order 4</a>? 🤓</p>

</details>

<h3 id="multiplicative-group-repetition-table">Repetition table</h3>

<p>The following tool repeats the elements of the multiplicative group modulo the given modulus
similar to the <a href="#additive-group-repetition-table">additive groups above</a>:</p>



<p>As noted <a href="#multiplicative-groups">earlier</a>,
you have to <a href="#tool-table-multiplicative-group-repetition&amp;coprime=true">enable “Coprime”</a>
to exclude the numbers which don’t have an inverse and therefore don’t belong to the group
if the modulus isn’t <a href="#prime-factorization">prime</a>.
Multiplicative groups are different from <a href="#additive-groups">additive groups</a> in several regards:</p>
<ul>
  <li><strong>Non-cyclic groups</strong>: Not all multiplicative groups are <a href="#cyclic-groups">cyclic</a>.
For example, the multiplicative groups modulo
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=8&amp;coprime=true&amp;repeat=false">8</a>,
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=12&amp;coprime=true&amp;repeat=false">12</a>,
and <a href="#tool-table-multiplicative-group-repetition&amp;modulus=15&amp;coprime=true&amp;repeat=false">15</a>
have no <a href="#group-generators">generator</a>.
As we’ll discuss <a href="#carmichaels-totient-function">later</a>,
all multiplicative groups modulo a prime number are cyclic, though.</li>
  <li><strong>Square root of one</strong>: If a multiplicative group is cyclic and the modulus \(m\) is greater than two,
then \(m - 1\) is the only element with an <a href="#element-order">order</a> of two.
(\(m - 1\) is <a href="#congruence-relation">congruent</a> to \(-1\), and \((-1)^2 = 1\).)
The element \(m - 1\) is marked with a gray background.
Whenever the order of an element in a cyclic group is even,
you encounter \(m - 1\) at half its order.
No other element can have an order of two as the group wouldn’t be cyclic otherwise.
As mentioned in the previous point, not all multiplicative groups are cyclic.
When calculating <a href="#tool-table-multiplicative-group-repetition&amp;modulus=24&amp;coprime=true&amp;repeat=false">modulo 24</a>,
for example, all elements except the identity element have an order of two and are thus their own inverse.</li>
  <li><strong>Subgroups of prime order</strong>: You cannot construct a group with a prime order greater than two with the above tool
because the <a href="#eulers-totient-function">number of coprime elements</a> below any modulus is always even.
When a prime order is desirable for cryptographic applications, you have to resort to <a href="#subgroups">subgroups</a>.
For example, many elements generate a subgroup of order 11
when you <a href="#tool-table-multiplicative-group-repetition&amp;modulus=23&amp;coprime=true&amp;repeat=false">set the modulus to 23</a>.</li>
  <li><strong>Symmetry of even columns</strong>: Since \((-A)^e = A^e\) whenever the exponent \(e\) is even,
even columns are <a href="https://en.wikipedia.org/wiki/Palindrome">palindromes</a> (i.e. \(\downarrow\ =\ \uparrow\)).</li>
</ul>

<details>
  <summary id="all-subgroups-of-cyclic-groups-are-cyclic">
All subgroups of cyclic groups are cyclic
</summary>

  <p>Given a <a href="#group-generators">generator</a> \(G\) which generates
the <a href="#cyclic-groups">cyclic group</a> \(\mathbb{G} = \href{#group-generators}{⟨G⟩}\)
of <a href="#group-order">order</a> \(n = \lvert \mathbb{G} \rvert = \lvert G \rvert\),
there exists a single <a href="#subgroups">subgroup</a> of order \(d\) for every <a href="#divisor">divisor</a> \(d\) of \(n\).
We <a href="https://crypto.stanford.edu/pbc/notes/numbertheory/cyclic.html#_subgroups_of_cyclic_groups">prove this statement</a>
by showing that such a subgroup exists and that it is unique:</p>

  <div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

    <ul>
      <li><strong>Existence</strong>: Let \(c = n / d\), then \(⟨cG⟩ = \{cG, 2(cG), …, d(cG) = O\}\) is a cyclic subgroup of order \(d\).</li>
      <li><strong>Uniqueness</strong>: Given a subgroup \(\mathbb{H} = \{A_1, …, A_d\}\) of order \(d\),
we show that there is an integer \(b\) for each \(A \in \mathbb{H}\) so that \(A = b(cG)\),
which implies that \(\mathbb{H} = ⟨cG⟩\).
Since \(G\) generates all elements of \(\mathbb{G}\), there exists an integer \(a\) so that \(A = aG\).
Since a subgroup is a group, the order of \(A\) must divide \(d\) according to <a href="#lagranges-theorem">Lagrange’s theorem</a>.
Therefore, \(dA = d(aG) = O\).
Since the order of \(G\) is \(n\), \(a \cdot d\) must be a multiple of \(n\),
which means that there exists an integer \(b\) so that \(a \cdot d = b \cdot n = b \cdot (c \cdot d)\).
It follows that \(a = b \cdot c\) and \(A = aG = b(cG)\).</li>
    </ul>

    <!-- -->

    <ul>
      <li><strong>Existence</strong>: Let \(c = n / d\), then \(⟨G^c⟩ = \{G^c, (G^c)^2, …, (G^c)^d = I\}\) is a cyclic subgroup of order \(d\).</li>
      <li><strong>Uniqueness</strong>: Given a subgroup \(\mathbb{H} = \{A_1, …, A_d\}\) of order \(d\),
we show that there is an integer \(b\) for each \(A \in \mathbb{H}\) so that \(A = (G^c)^b\),
which implies that \(\mathbb{H} = ⟨G^c⟩\).
Since \(G\) generates all elements of \(\mathbb{G}\), there exists an integer \(a\) so that \(A = G^a\).
Since a subgroup is a group, the order of \(A\) must divide \(d\) according to <a href="#lagranges-theorem">Lagrange’s theorem</a>.
Therefore, \(A^d = (G^a)^d = I\).
Since the order of \(G\) is \(n\), \(a \cdot d\) must be a multiple of \(n\),
which means that there exists an integer \(b\) so that \(a \cdot d = b \cdot n = b \cdot (c \cdot d)\).
It follows that \(a = b \cdot c\) and \(A = G^a = (G^c)^b\).</li>
    </ul>

  </div>

  <p><a href="#tool-table-multiplicative-group-repetition&amp;modulus=13&amp;repeat=false&amp;order=false&amp;totient=false">For example</a>,
<!-- --> \(2\) generates the multiplicative group modulo \(13\) of order \(12\).
A subgroup of order \(6\) is generated by \(2^{12/6} =_{13} 4\).
Another subgroup of order \(6\) may contain \(9 =_{13} 2^8\).
In this case, \(b = \frac{a \cdot d}{n} = \frac{8 \cdot 6}{12} = 4\).
It follows that \(4^4 =_{13} 9\), which is true.</p>

  <p>To get a better feeling for where an element with a certain order may or may not appear,
you can <a href="#tool-table-multiplicative-group-repetition&amp;order=true">enable the “Order” option</a>.</p>

</details>

<h3 id="multiplicative-group-subgroup-cosets">Subgroup cosets</h3>

<p>The following tool shows the <a href="#subgroup-cosets">cosets</a> of the <a href="#subgroups">subgroup</a> generated by the given element
(see the <a href="#additive-group-subgroup-cosets">additive groups</a> for explanations):</p>



<details>
  <summary id="non-cyclic-subgroups-of-non-cyclic-groups">
Non-cyclic subgroups of non-cyclic groups
</summary>

  <p>Subgroups don’t have to be generated by a single element.
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=15&amp;coprime=true&amp;repeat=false&amp;order=false&amp;totient=false">For example</a>,
<!-- --> \(\{1, 4, 11, 14\}\) form a multiplicative group modulo \(15\):</p>

\[\begin{aligned}
4 \cdot 4 &amp;=_{15} 1 \\
4 \cdot 11 &amp;=_{15} 14 \\
4 \cdot 14 &amp;=_{15} 11 \\
11 \cdot 11 &amp;=_{15} 1 \\
11 \cdot 14 &amp;=_{15} 4 \\
14 \cdot 14 &amp;=_{15} 1
\end{aligned}\]

  <p>Since each element is its own inverse, none of the elements generates the whole subgroup.
Its <a href="#subgroup-cosets">cosets</a> still partition the <a href="#cyclic-groups">non-cyclic</a>
multiplicative group of coprime elements modulo 15:</p>

  <figure>

    <table>
  <thead>
    <tr>
      <th>1</th>
      <th>4</th>
      <th>11</th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>7</td>
      <td>13</td>
    </tr>
  </tbody>
</table>

    <figcaption>
The unique cosets of {1, 4, 11, 14} modulo 15.
</figcaption>
  </figure>

  <p>The <a href="#tool-table-multiplicative-group-repetition">above tool</a> just doesn’t support this case
because we’re usually interested only in <a href="#element-repetitions">repetitions of a single element</a>.</p>

</details>

<h3 id="multiplicative-group-notations">Group notations</h3>

<p>The multiplicative group of integers modulo some number \(m\) is usually
<a href="https://en.wikipedia.org/wiki/Multiplicative_group_of_integers_modulo_n#Notation">denoted as</a>
<!-- --> \((\mathbb{Z}/m\mathbb{Z})^\times\) or \(\mathbb{Z}_m^\times\).
As mentioned <a href="#additive-group-notations">previously</a>,
the former notation is derived from the <a href="#quotient-rings">quotient ring</a> \(\mathbb{Z}/m\mathbb{Z}\).
Both notations imply that the integers below the modulus are restricted
<a href="#multiplicative-group-of-units">to those which have an inverse</a>.
Cryptographers often use the latter notation with an <a href="https://en.wikipedia.org/wiki/Asterisk">asterisk</a>
as the multiplication sign, i.e. \(\mathbb{Z}_m^*\).</p>

<h3 id="fermats-little-theorem">Fermat’s little theorem</h3>

<p><a href="https://en.wikipedia.org/wiki/Fermat%27s_little_theorem">Fermat’s little theorem</a> states that
for any integers \(a\) and \(p\),
if \(p\) is <a href="#prime-factorization">prime</a> and \(a\) is not a multiple of \(p\), then \(a^{p - 1} =_p 1\).
This theorem is an instantiation of the <a href="#lagrange-consequences">second consequence</a>
of <a href="#lagranges-theorem">Lagrange’s theorem</a>,
which states that if you repeat an element of a group as many times as there are elements in the group,
you get the <a href="#group-axioms">identity element</a> of the group.
The theorem is named after <a href="https://en.wikipedia.org/wiki/Pierre_de_Fermat">Pierre de Fermat</a> (1607 − 1665).
There is no Fermat’s big theorem,
but <a href="https://en.wikipedia.org/wiki/Fermat%27s_theorem">several theorems</a> are named after him.
We will generalize Fermat’s little theorem to non-prime integers in the <a href="#eulers-theorem">next chapter</a>.</p>

<h3 id="modular-multiplicative-inverse">Modular multiplicative inverse</h3>

<p>As discussed <a href="#inverse-through-repetitions">earlier</a>,
you can compute the inverse of an element by repeating it one time less than its <a href="#element-order">order</a>.
Using <a href="#fermats-little-theorem">Fermat’s little theorem</a>,
we can compute the <a href="https://en.wikipedia.org/wiki/Modular_multiplicative_inverse">multiplicative inverse</a>
modulo a <a href="#prime-factorization">prime number</a> \(p\) for any element \(A\) as \(A^{-1} =_p A^{p-2}\)
because \(A \cdot A^{p-2} =_p A^{p-1} =_p 1\).
As we’ll see in the <a href="#extended-euclidean-algorithm">next chapter</a>,
there’s a faster way to compute the multiplicative inverse of an element.
In cryptography, speed is not the only consideration, though;
you also want to avoid <a href="https://en.wikipedia.org/wiki/Side-channel_attack">side-channel attacks</a>.
If you want to compute the multiplicative inverse of an element
in <a href="https://en.wikipedia.org/wiki/Timing_attack#Avoidance">constant time</a>,
you might still prefer to compute \(A^{-1}\) as \(A^{p-2}\).</p>

<h3 id="discrete-logarithm-problem" data-toc-text="Discrete-logarithm problem">Discrete-logarithm problem (<abbr title="Discrete-Logarithm Problem">DLP</abbr>)</h3>

<p>A lot of modern cryptography is built on the <a href="https://en.wikipedia.org/wiki/Computational_hardness_assumption">assumption</a>
that computing the <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithm</a> in multiplicative groups
is infeasible on classical computers if you choose the modulus \(m\) <a href="#pohlig-hellman-algorithm">carefully</a>.
In other words, while computing \(K =_m G^k\) given a <a href="#group-generators">generator</a> \(G\) and an exponent \(k\) is easy
(we <a href="#fast-repetitions">have seen</a> that the <a href="https://en.wikipedia.org/wiki/Time_complexity">running time</a>
is proportional to the number of bits in \(k\)),
computing \(k = \log_G(K)\) as the <a href="https://en.wikipedia.org/wiki/Logarithm">logarithm</a>
of \(K\) to the <a href="https://en.wikipedia.org/wiki/Base_(exponentiation)">base</a> \(G\) is presumably hard.
If this assumption is indeed true, <a href="https://en.wikipedia.org/wiki/Modular_exponentiation">modular exponentiation</a>
is a <a href="#linear-one-way-functions">linear one-way function</a>.
As mentioned <a href="#computational-complexity-theory">earlier</a>, it is widely believed that this is the case,
but we still lack a proof for the <a href="https://en.wikipedia.org/wiki/Computational_hardness_assumption">hardness</a>
of the discrete-logarithm <a href="https://en.wikipedia.org/wiki/Computational_problem">problem</a>.
We’ll study the best known <a href="https://en.wikipedia.org/wiki/Algorithm">algorithms</a>
for solving the discrete-logarithm problem in the <a href="#dl-algorithms">second to last chapter</a>.</p>

<details>
  <summary id="quantum-computers">
Quantum computers
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Quantum_computing">Quantum computers</a> perform calculations
using the physical properties of <a href="https://en.wikipedia.org/wiki/Quantum_mechanics">quantum mechanics</a>,
such as <a href="https://en.wikipedia.org/wiki/Quantum_superposition">superposition</a>.
The discrete-logarithm problem can be solved efficiently on a sufficiently powerful quantum computer
with <a href="https://en.wikipedia.org/wiki/Shor%27s_algorithm">Shor’s algorithm</a>,
named after <a href="https://en.wikipedia.org/wiki/Peter_Shor">Peter Shor</a> (born in 1959).
The quantum computers which have been built until now are by far not powerful enough to break modern cryptography,
but since this might change in the future, cryptography which cannot be broken by quantum computers
– so-called <a href="https://en.wikipedia.org/wiki/Post-quantum_cryptography">post-quantum cryptography</a> –
is an active area of research with increasing interest.</p>

</details>

<h2 id="prime-numbers">Prime numbers</h2>

<p>We’ve talked quite a bit about <a href="https://en.wikipedia.org/wiki/Prime_number">prime numbers</a> already.
The goal of this chapter is to give you a better understanding about primality
and related concepts such as <a href="#prime-factorization">factorization</a>.
From here to the end of this article, the topics get more and more advanced.
None of the remaining topics are required to get a basic understanding of modern cryptosystems.
This chapter fills some gaps from previous chapters,
such as why only <a href="#multiset-of-prime-factors">coprime integers</a>
have a <a href="#multiplicative-inverse-revisited">multiplicative inverse</a>,
generalizes some results,
such as <a href="#fermats-little-theorem">Fermat’s little theorem</a> to <a href="#eulers-theorem">Euler’s theorem</a>,
and discusses some algorithmic aspects,
such as how to <a href="#extended-euclidean-algorithm">compute the multiplicative inverse</a>
and how to <a href="#probabilistic-primality-tests">test whether an integer is prime</a>.
The chapters afterwards build towards <a href="#elliptic-curves">elliptic curves</a>,
which are another popular way to construct a <a href="#linear-one-way-functions">linear one-way function</a>.</p>

<details>
  <summary id="formatting-preferences">
Formatting preferences
</summary>

  <p>All tools in this chapter can handle arbitrarily large integers, which are easier to read
when their digits are <a href="https://en.wikipedia.org/wiki/Decimal_separator#Digit_grouping">grouped with a delimiter</a>.
I prefer the <a href="https://en.wikipedia.org/wiki/Apostrophe">apostrophe</a> as a thousand separator,
but <a href="https://github.com/KasparEtter/ef1p/issues/3">other people have different preferences</a>.
From time to time, you may also want to copy numbers
or <a href="https://en.wikipedia.org/wiki/Expression_(mathematics)">expressions</a>
to other calculators or to <a href="https://en.wikipedia.org/wiki/Source_code">source code</a>,
in which case it is best if the number or expression isn’t formatted at all.
(Many <a href="https://en.wikipedia.org/wiki/Programming_language">programming languages</a>
actually allow <a href="https://en.wikipedia.org/wiki/Underscore">underscores</a>
in <a href="https://en.wikipedia.org/wiki/Integer_literal">integer literals</a>.)
For these reasons, I decided to make the outputs of my tools fully configurable,
including the signs of various operations:</p>

  

</details>

<h3 id="prime-factorization">Prime factorization</h3>

<p>Every positive integer is a <a href="https://en.wikipedia.org/wiki/Multiple_(mathematics)">multiple</a> of 1 and itself.
Many positive integers are also a multiple of other positive integers,
which means that they can be divided by an integer between 1 and themselves without a <a href="#euclidean-division">remainder</a>.
Such integers can therefore be written as a <a href="https://en.wikipedia.org/wiki/Product_(mathematics)">product</a>
of two <a href="https://en.wikipedia.org/wiki/Divisor">factors</a>, which are both smaller than their product.
Positive integers which can be split into a product of two smaller positive integers
are called <a href="https://en.wikipedia.org/wiki/Composite_number">composite</a>.
All other positive integers <a href="#the-integer-1">except 1</a> are called <a href="https://en.wikipedia.org/wiki/Prime_number">prime</a>.
The process of splitting a composite number into a product of smaller integers
is called <a href="https://en.wikipedia.org/wiki/Integer_factorization">integer factorization</a>.
As long as one of the factors is still composite, you can continue the factorization until all factors are prime.
Since the factors are smaller than the integer which is factorized but cannot get smaller than 2,
the factorization into primes terminates after a finite number of steps for every integer.
To find the factors of an integer, you can simply try all possible factors until
the <a href="https://en.wikipedia.org/wiki/Square_root">square root</a> of the given integer.
This <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> is called
<a href="https://en.wikipedia.org/wiki/Trial_division">trial division</a> and
<a href="https://en.wikipedia.org/wiki/Constructive_proof">proves constructively</a>
that every positive integer can be written as a product of primes.
We’ll prove <a href="#unique-factorization-theorem">later</a>
that the factorization into primes is unique (up to the order of the primes).
Unfortunately, the number of integers between 2 and the square root of the given integer
scales exponentially in the number of bits, and hence trial division isn’t very useful in practice.
There are <a href="https://en.wikipedia.org/wiki/Integer_factorization#Factoring_algorithms">faster factoring algorithms</a>
(we’ll study <a href="#pollards-rho-factorization-algorithm">one of them</a> in the second to last chapter),
but similar to the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>,
no algorithm is known for factoring (large) integers efficiently on <a href="#quantum-computers">classical computers</a>.
The following tool factorizes integers into primes using trial division with the configured delay between attempts.</p>



<details>
  <summary id="the-integer-1">
The integer 1
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Prime_number#Primality_of_one">By convention</a>,
1 is not included in the set of prime numbers in order to make statements involving prime numbers simpler.</p>

</details>

<details>
  <summary id="euclids-theorem">
Euclid’s theorem
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Euclid%27s_theorem">Euclid’s theorem</a> states that there are infinitely many prime numbers.
It is named after <a href="https://en.wikipedia.org/wiki/Euclid">Euclid</a>,
who proved it around 300 <a href="https://en.wikipedia.org/wiki/Common_Era"><abbr title="Before the Common Era">BCE</abbr></a>.
If there were only a finite number of primes,
then the product of all primes plus 1 cannot be divided without remainder by any of the prime numbers.
The new number is therefore either prime or has prime factors which were not accounted for.
Since this is a <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradiction</a>,
there has to be an infinite number of primes.</p>

</details>

<details>
  <summary id="smooth-numbers">
Smooth numbers
</summary>

  <p>An integer is called <a href="https://en.wikipedia.org/wiki/Smooth_number">\(n\)-smooth</a>
if none of its prime factors are greater than \(n\).
As you can see when playing with the <a href="#tool-integer-factorization-trial-division">above tool</a>,
factoring large numbers is <a href="#computational-complexity-theory">easy</a> if most of their factors are sufficiently small.
Since this is often <a href="#pohlig-hellman-algorithm">undesirable</a> in cryptographic applications,
you have to choose the delicate parameters <a href="#sophie-germain-and-safe-primes">carefully</a>.</p>

</details>

<h3 id="multiset-of-prime-factors">Multiset of prime factors</h3>

<p>Since each number can be written as a <a href="#prime-factorization">product of prime factors</a>,
we can represent each number by the <a href="https://en.wikipedia.org/wiki/Multiset">multiset</a> of its prime factors.
Unlike a <a href="https://en.wikipedia.org/wiki/Set_(mathematics)">set</a>, a multiset can contain an element multiple times.
The number of times that an element is included in a multiset is called the multiplicity of the element in the multiset.
We can extend the following <a href="https://en.wikipedia.org/wiki/Binary_operation">operations</a>
and <a href="https://en.wikipedia.org/wiki/Binary_relation">relations</a> from <a href="https://en.wikipedia.org/wiki/Set_theory">set theory</a>
<a href="https://en.wikipedia.org/wiki/Multiset#Basic_properties_and_operations">to multisets</a>:</p>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Union_(set_theory)"><strong>Union</strong></a>:
The union \(\mathbb{C}\) of the multisets \(\mathbb{A}\) and \(\mathbb{B}\)
contains each element contained in \(\mathbb{A}\) or \(\mathbb{B}\) with the higher of the two multiplicities.
Using the notation from sets, we write this as \(\mathbb{C} = \mathbb{A} \cup \mathbb{B}\).
For example, \(\{2, 2, 3\} \cup \{2, 5\} = \{2, 2, 3, 5\}\).</li>
  <li><a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)"><strong>Intersection</strong></a>:
The intersection \(\mathbb{C}\) of the multisets \(\mathbb{A}\) and \(\mathbb{B}\)
contains each element contained in both \(\mathbb{A}\) and \(\mathbb{B}\) with the lower of the two multiplicities.
Using the notation from sets, we write this as \(\mathbb{C} = \mathbb{A} \cap \mathbb{B}\).
For example, \(\{2, 2, 3\} \cap \{2, 5\} = \{2\}\).</li>
  <li><a href="https://en.wikipedia.org/wiki/Inclusion_(set_theory)"><strong>Inclusion</strong></a>:
The multiset \(\mathbb{B}\) includes the multiset \(\mathbb{A}\)
if every element contained in \(\mathbb{A}\) is also contained in \(\mathbb{B}\) with the same or a higher multiplicity.
We write this as \(\mathbb{A} \subseteq \mathbb{B}\) or, if at least one element has a higher multiplicity
in \(\mathbb{B}\) than in \(\mathbb{A}\), as \(\mathbb{A} \subset \mathbb{B}\).
For example, \(\{2, 2\} \subset \{2, 2, 3\}\).</li>
</ul>

<p>Unlike <a href="https://en.wikipedia.org/wiki/Tuple">tuples</a> and <a href="https://en.wikipedia.org/wiki/List_(abstract_data_type)">lists</a>,
the order of the elements in multisets matters neither for comparison nor the above operations.
We say that an integer \(a\) is <a href="https://en.wikipedia.org/wiki/Coprime_integers">coprime</a> with an integer \(b\)
(or, equivalently, that \(a\) is relatively prime to \(b\)) if \(a\) and \(b\) have no prime factor in common.
Using the name of an integer in <a href="https://en.wikipedia.org/wiki/Blackboard_bold">blackboard bold</a>
to denote the multiset of its prime factors, we can write this as \(\mathbb{A} \cap \mathbb{B} = \varnothing\),
where \(\varnothing\) denotes the <a href="https://en.wikipedia.org/wiki/Empty_set">empty multiset</a>.
Coprimality can be visualized with a <a href="https://en.wikipedia.org/wiki/Venn_diagram">Venn diagram</a>,
named after <a href="https://en.wikipedia.org/wiki/John_Venn">John Venn</a> (1834 − 1923), like this:</p>

<figure>
  <svg id="figure-set-disjoint" data-name="set-disjoint" width="266.5" height="122.5" viewBox="-61.25 -61.25 266.5 122.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="60"></circle>
    <text text-anchor="middle">
        <tspan x="0" y="5.9">𝔸</tspan>
    </text>
    <circle cx="144" cy="0" r="60"></circle>
    <text text-anchor="middle">
        <tspan x="144" y="5.9">𝔹</tspan>
    </text>

</svg>

  <figcaption>

The prime factors of two coprime integers are <a href="https://en.wikipedia.org/wiki/Disjoint_sets">disjoint</a>.

</figcaption>
</figure>

<h3 id="greatest-common-divisor" data-toc-text="Greatest common divisor">Greatest common divisor (<abbr title="Greatest Common Divisor">GCD</abbr>)</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Greatest_common_divisor">greatest common divisor</a> of two integers
is the largest positive integer which divides both integers <a href="#euclidean-division">without a remainder</a>.
Since the <a href="#prime-factorization">factorization into primes</a> is unique,
as we will prove <a href="#unique-factorization-theorem">soon</a>,
the prime factors of any <a href="#divisor">divisor</a> of an integer \(a\)
are <a href="#multiset-of-prime-factors">included in the prime factors</a> of \(a\).
(If this wasn’t the case, the factorization of \(a\) wouldn’t be unique.)
The greatest common divisor of any two integers thus corresponds to the intersection of their prime factors
because any larger integer no longer divides both integers:</p>

<figure>
  <svg id="figure-set-intersection" data-name="set-intersection" width="182.5" height="122.5" viewBox="-91.25 -61.25 182.5 122.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 0 -51.962 A 60 60 0 1 1 0 51.962 A 60 60 0 1 1 0 -51.962 Z"></path>
    <path d="M 0 -51.962 A 60 60 0 0 1 0 51.962 A 60 60 0 0 1 0 -51.962 Z"></path>
    <text text-anchor="middle">
        <tspan x="-60" y="5.9">𝔸</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="5.9"><tspan>gcd</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="60" y="5.9">𝔹</tspan>
    </text>

</svg>

  <figcaption>
<abbr title="Greatest Common Divisor">GCD</abbr> = intersection of prime factors
</figcaption>
</figure>

<p>We write the greatest common divisor of the integers \(a\) and \(b\) as \(\operatorname{gcd}(a, b)\).
Any integer which divides both \(a\) and \(b\) also divides \(\operatorname{gcd}(a, b)\).
The only and thus the greatest common divisor of two <a href="#multiset-of-prime-factors">coprime integers</a> is 1.
As we will see <a href="#euclidean-algorithm">in a moment</a>,
the greatest common divisor of two integers can be computed efficiently
without having to determine the prime factors of both integers first.</p>

<h3 id="least-common-multiple" data-toc-text="Least common multiple">Least common multiple (<abbr title="Least Common Multiple">LCM</abbr>)</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Least_common_multiple">least common multiple</a> of two positive integers
is the smallest positive integer which is a multiple of both integers.
The product of all the numbers in the <a href="#multiset-of-prime-factors">union of the prime factors</a> of both integers
is the smallest number which is a multiple of both integers:</p>

<figure>
  <svg id="figure-set-union" data-name="set-union" width="182.5" height="122.5" viewBox="-91.25 -61.25 182.5 122.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 0 -51.962 A 60 60 0 0 1 0 51.962 A 60 60 0 0 1 0 -51.962 Z"></path>
    <path d="M 0 -51.962 A 60 60 0 1 1 0 51.962 A 60 60 0 1 1 0 -51.962 Z"></path>
    <text text-anchor="middle">
        <tspan x="-60" y="5.9">𝔸</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="5.9"><tspan>lcm</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="60" y="5.9">𝔹</tspan>
    </text>

</svg>

  <figcaption>
<abbr title="Least Common Multiple">LCM</abbr> = union of prime factors
</figcaption>
</figure>

<p>We write the least common multiple of the integers \(a\) and \(b\) as \(\operatorname{lcm}(a, b)\).
Since the product of \(a\) and \(b\) contains the prime factors in the intersection twice,
you get the least common multiple when you divide the product
by the <a href="#greatest-common-divisor">greatest common divisor</a> of \(a\) and \(b\):</p>

\[\operatorname{lcm}(a, b) = \frac{a \cdot b}{\operatorname{gcd}(a, b)}\]

<p>If \(a\) and \(b\) are coprime, then \(\operatorname{gcd}(a, b) = 1\) and \(\operatorname{lcm}(a, b) = a \cdot b\).
(Unlike <a href="https://en.wikipedia.org/wiki/Least_common_multiple#Using_the_greatest_common_divisor">Wikipedia</a>,
we don’t care about negative inputs here.)</p>

<h3 id="euclidean-algorithm">Euclidean algorithm</h3>

<p>The <a href="#greatest-common-divisor">greatest common divisor</a> can also be interpreted geometrically:
Given a rectangle, what is the largest square which tiles the rectangle in both dimensions without remainders?
If you want to tile a rectangular bathroom which is 51 units wide and 21 units deep, for example,
which square tiles should you order so that you don’t have to break any tiles and have as little work as possible?
In order to find the answer, we can make the problem smaller and smaller.
Any square which divides some length in one dimension also divides the same length in the other dimension.
This means that we can subtract the smaller side from the larger side without affecting the solution.
Given that our room is 21 units deep, we know that there has to be a boundary between tiles 21 units in from the left.
This reduces the problem to a rectangle which is 30 units wide and 21 units deep.
We can repeat this procedure of splitting off squares from our rectangle until we’re left with a square.
The side of this square corresponds to the greatest common divisor of the two numbers that we started with.
In our example, a square whose sides are 3 units is the largest square which tiles the room:</p>

<figure>
  <svg id="figure-euclidean-algorithm" data-name="euclidean-algorithm" width="557.149" height="251.75" viewBox="-44.649 -2.5 557.149 251.75" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <rect x="-1.25" y="-1.25" width="512.5" height="212.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="255" y="246"><tspan>51</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-24.5" y="110.9"><tspan>21</tspan></tspan>
    </text>
    <rect x="1.25" y="1.25" width="207.5" height="207.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="105" y="110.9"><tspan>21</tspan></tspan>
    </text>
    <rect x="211.25" y="1.25" width="207.5" height="207.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="315" y="110.9"><tspan>21</tspan></tspan>
    </text>
    <rect x="421.25" y="1.25" width="87.5" height="87.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="465" y="50.9"><tspan>9</tspan></tspan>
    </text>
    <rect x="421.25" y="91.25" width="87.5" height="87.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="465" y="140.9"><tspan>9</tspan></tspan>
    </text>
    <rect x="421.25" y="181.25" width="27.5" height="27.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="435" y="200.9"><tspan>3</tspan></tspan>
    </text>
    <rect x="451.25" y="181.25" width="27.5" height="27.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="465" y="200.9"><tspan>3</tspan></tspan>
    </text>
    <rect x="481.25" y="181.25" width="27.5" height="27.5" rx="0" ry="0"></rect>
    <text text-anchor="middle">
        <tspan x="495" y="200.9"><tspan>3</tspan></tspan>
    </text>

</svg>

  <figcaption>
From the pink room, we split off the red squares and the orange squares to get the yellow squares.
</figcaption>
</figure>

<p>This procedure for determining the greatest common divisor of two numbers is called
the <a href="https://en.wikipedia.org/wiki/Euclidean_algorithm">Euclidean algorithm</a>.
It is named after the Greek mathematician <a href="https://en.wikipedia.org/wiki/Euclid">Euclid</a>,
who described it around 300 <a href="https://en.wikipedia.org/wiki/Common_Era"><abbr title="Before the Common Era">BCE</abbr></a>.
A <a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)">recursive implementation</a> of the algorithm looks as follows:</p>

\[\operatorname{gcd}(a, b) = \begin{cases}
a &amp;\text{if } a = b\text{,} \\
\operatorname{gcd}(a - b, b) &amp;\text{if } a &gt; b \text{,} \\
\operatorname{gcd}(a, b - a) &amp;\text{if } a &lt; b \text{.}
\end{cases}\]

<p>The algorithm is guaranteed to terminate because one of the two parameters gets smaller in every iteration
and the parameters never get smaller than 1 since 1 divides all integers.
Instead of subtracting the smaller number from the larger number one by one,
we can use the <a href="#modulo-operation">modulo operation</a> to subtract the smaller number from the larger number
as many times as it takes to make the larger number smaller than the smaller number in one go.
The Euclidean algorithm is typically implemented as follows:</p>

<div><div><pre><code><span>function</span> <span>gcd</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>)</span> <span>{</span>
    <span>while</span> <span>(</span><span>b</span> <span>!=</span> <span>0</span><span>)</span> <span>{</span>
        <span>let</span> <span>t</span> <span>=</span> <span>b</span><span>;</span>
        <span>b</span> <span>=</span> <span>a</span> <span>%</span> <span>b</span><span>;</span>
        <span>a</span> <span>=</span> <span>t</span><span>;</span>
    <span>}</span>
    <span>return</span> <span>a</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Since this is valid <a href="https://en.wikipedia.org/wiki/JavaScript">JavaScript</a>,
you can copy the code to the <a href="https://en.wikipedia.org/wiki/Web_development_tools">developer tools</a> of your browser
and verify that <code>gcd(51, 21)</code> is indeed <code>3</code>.
<code>t</code> is just a <a href="https://en.wikipedia.org/wiki/Temporary_variable">temporary variable</a> to swap the values of <code>a</code> and <code>b</code>.
If <code>b</code> is greater than <code>a</code> initially, the first round results only in
the <a href="https://en.wikipedia.org/wiki/Swap_(computer_programming)">swapping</a> of <code>a</code> and <code>b</code>.
Unlike <a href="#prime-factorization">integer factorization</a>,
the Euclidean algorithm is <a href="https://en.wikipedia.org/wiki/Euclidean_algorithm#Algorithmic_efficiency">efficient</a>
and can thus be computed even for very large integers.</p>

<h3 id="extended-euclidean-algorithm">Extended Euclidean algorithm</h3>

<p>When calculating the <a href="#greatest-common-divisor">greatest common divisor</a>
of any positive integers \(a\) and \(b\) with the <a href="#euclidean-algorithm">Euclidean algorithm</a>,
we can keep track of how we combined these two numbers to get the current intermediate value.
Instead of subtracting numbers from one another, we subtract equations from one another
so that we end up with <a href="https://en.wikipedia.org/wiki/Coefficient">coefficients</a> for \(a\) and \(b\)
which result in the greatest common divisor:</p>

\[\begin{aligned}
a &amp;= 1 \cdot a + 0 \cdot b \\
b &amp;= 0 \cdot a + 1 \cdot b \\
&amp;\enspace \vdots \\
\operatorname{gcd}(a, b) &amp;= c \cdot a + d \cdot b
\end{aligned}\]

<p>This procedure is known as the <a href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm">extended Euclidean algorithm</a>,
and the equation we end up with is known as <a href="#bezouts-identity">Bézout’s identity</a>.
The following tool visualizes the extended Euclidean algorithm with a table.
The first two rows after the column titles contain the initialization of the algorithm
as in the equations above this paragraph, where the larger number is taken first.
The “remainder” column contains the values of the <a href="#euclidean-algorithm">Euclidean algorithm</a>;
the two columns after that contain the coefficients of the larger and the smaller input.
The “quotient” column indicates how many times the current row is subtracted from the row above.
The cell with the green background contains the last value before we reach 0,
which is the greatest common divisor of the two inputs to the tool.</p>



<details>
  <summary id="bezouts-identity">
Bézout’s identity
</summary>

  <p><a href="https://en.wikipedia.org/wiki/B%C3%A9zout%27s_identity">Bézout’s identity</a>,
named after <a href="https://en.wikipedia.org/wiki/%C3%89tienne_B%C3%A9zout">Étienne Bézout</a> (1730 − 1783),
makes the following two statements:</p>
  <ul>
    <li><strong>Existence</strong>: For any two positive integers \(a\) and \(b\), there exist some integers \(c\) and \(d\)
so that \(\operatorname{\href{#greatest-common-divisor}{gcd}}(a, b) = c \cdot a + d \cdot b\).
The <a href="#extended-euclidean-algorithm">extended Euclidean algorithm</a>
<a href="https://en.wikipedia.org/wiki/Constructive_proof">proves constructively</a> that such coefficients exist.
These coefficients are not unique, though.
Since the coefficients in the last row of the <a href="#tool-integer-extended-euclidean-algorithm">tool above</a>
add up to \(0\) when multiplied by the corresponding input,
you can add multiples of the last row to the second last row without affecting the left side of the equation.
<a href="#tool-integer-extended-euclidean-algorithm&amp;a=51&amp;b=21">For example</a>,
as \(3 = (-2) \cdot 51 + 5 \cdot 21\) and \(0 = 7 \cdot 51 + (-17) \cdot 21\),
we also have that \(3 = (-2 + 7) \cdot 51 + (5 - 17) \cdot 21 = 5 \cdot 51 + (-12) \cdot 21\).</li>
    <li><strong>Multiples</strong>: Every <a href="https://en.wikipedia.org/wiki/Linear_combination">linear combination</a>
of \(a\) and \(b\) is a multiple of \(\operatorname{gcd}(a, b)\),
and every multiple of \(\operatorname{gcd}(a, b)\) can be expressed as a linear combination of \(a\) and \(b\).
Denoting \(\operatorname{gcd}(a, b)\) as \(g\),
we can write this as \(\{e \cdot a + f \cdot b \mid e, f \in \mathbb{Z}\} = \{h \cdot g \mid h \in \mathbb{Z}\}\).
The second half of this statement is an immediate consequence of the previous point:
Since \(g = c \cdot a + d \cdot b\) for some integers \(c\) and \(d\),
any multiple \(h \cdot g = (h \cdot c) \cdot a + (h \cdot d) \cdot b\)
due to <a href="https://en.wikipedia.org/wiki/Distributive_property">distributivity</a>,
which is a linear combination of \(a\) and \(b\).
We prove the first half of the statement with the following two <a href="https://en.wikipedia.org/wiki/Lemma_(mathematics)">lemmas</a>:
      <ul>
        <li>Let \(\mathbb{I} = \{e \cdot a + f \cdot b \mid e, f \in \mathbb{Z}\}\)
and \(i\) be the smallest positive element in \(\mathbb{I}\).
Claim: All elements in \(\mathbb{I}\) are a multiple of \(i\).
Proof: Using <a href="#euclidean-division">Euclidean division</a>,
every element \(j\) in \(\mathbb{I}\) can be written as \(j = q \cdot i + r\)
for some integers \(q\) and \(r\) with \(0 ≤ r &lt; i\).
Since \(i\) and \(j\) are in \(\mathbb{I}\), so is \(r = j - q \cdot i\).
Since \(0 ≤ r &lt; i\) and \(i\) is by assumption the smallest positive element in \(\mathbb{I}\),
<span>\(r\) must</span> be \(0\).
Therefore, every \(j \in \mathbb{I}\) is indeed a multiple of \(i\).
(As we will see <a href="#ideals">later</a>, \(\mathbb{I}\) is
a so-called <a href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)">ideal</a>.)</li>
        <li>Claim: The smallest positive element \(i \in \mathbb{I}\) is the greatest common divisor of \(a\) and \(b\).
Proof: Since all linear combinations of \(a\) and \(b\) are multiples of \(i\) according to the first lemma,
both \(a\) and \(b\) are multiples of \(i\), which means that \(i\) is a common divisor of both \(a\) and \(b\).
Any integer which divides both \(a\) and \(b\) also divides every integer
of the form \(e \cdot a + f \cdot b\) due to distributivity.
Since \(i\) is of this form, all common divisors divide \(i\).
Therefore, \(i\) is the greatest common divisor of \(a\) and \(b\).</li>
      </ul>
    </li>
  </ul>

  <p>The second part of Bézout’s identity matches our <a href="#visualization-of-cosets">earlier observation</a>
that all modular multiples of a number are spaced equally.</p>

</details>

<details>
  <summary id="euclids-lemma">
Euclid’s lemma
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Euclid%27s_lemma">Euclid’s lemma</a> states that
if a prime \(p\) divides the product \(a \cdot b\) of some integers \(a\) and \(b\),
then \(p\) divides \(a\) or \(b\) (<a href="https://en.wikipedia.org/wiki/Logical_disjunction">or both</a>).
If \(p\) divides \(a\), the statement is true.
So all we need to show is that if \(p\) does not divide \(a\), then \(p\) divides \(b\).
Since \(p\) is prime and \(a\) is not a multiple of \(p\), \(p\) and \(a\) are <a href="#multiset-of-prime-factors">coprime</a>.
Using <a href="#bezouts-identity">Bézout’s identity</a>,
we know that there are some integers \(c\) and \(d\) so that \(c \cdot p + d \cdot a = 1\).
When we multiply this equation by \(b\), we get \(c \cdot p \cdot b + d \cdot a \cdot b = b\).
Since the statement is an <a href="https://en.wikipedia.org/wiki/Material_conditional">implication</a>, we can assume
the so-called <a href="https://en.wikipedia.org/wiki/Antecedent_(logic)">antecedent</a> (that \(p\) divides \(a \cdot b\))
when proving the so-called <a href="https://en.wikipedia.org/wiki/Consequent">consequent</a> (that \(p\) divides \(b\)).
Therefore, \(b\) is a multiple of \(p\) because both \(c \cdot p \cdot b\)
and \(d \cdot a \cdot b\) are multiples of \(p\).
(If you add multiples of a number, you get another multiple
due to <a href="https://en.wikipedia.org/wiki/Distributive_property">distributivity</a>:
<!-- --> \(e \cdot p + f \cdot p = (e + f) \cdot p\) for any \(e\) and \(f\).)</p>

</details>

<details>
  <summary id="unique-factorization-theorem">
Unique factorization theorem
</summary>

  <p>The unique factorization theorem, which is also known as the
<a href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_arithmetic">fundamental theorem of arithmetic</a>,
states that every integer greater than 1 can be written uniquely
– up to the order of the factors – as a product of prime numbers.
It makes two claims:</p>
  <ul>
    <li><strong>Existence</strong>: All integers greater than 1 can be factorized into primes
because each of them is <a href="#prime-factorization">either composite or prime</a>.</li>
    <li><strong>Uniqueness</strong>: Suppose that there are integers greater than 1
which have distinct <a href="#prime-factorization">prime factorizations</a>.
Let \(n\) be the smallest such integer
so that \(n = p_1 \cdot p_2 \cdot … \cdot p_k = q_1 \cdot q_2 \cdot … \cdot q_l\),
where each \(p_i\) and each \(q_j\) is prime.
Since \(p_1\) divides \(n = q_1 \cdot q_2 \cdot … \cdot q_l\),
it has to divide one of the \(q_j\)s according to (a recursive application of) <a href="#euclids-lemma">Euclid’s lemma</a>.
Since we don’t care about the order of the \(q_j\)s, let’s assume that \(p_1\) divides \(q_1\).
Since both \(p_1\) and \(q_1\) are prime and greater than 1, it follows that \(p_1 = q_1\).
When we cancel these factors on both sides of the equation,
we get \(m = p_2 \cdot … \cdot p_k = q_2 \cdot … \cdot q_l\).
Given that the two factorizations of \(n\) were distinct,
these two factorizations of \(m\) have to be distinct as well.
Since \(m &lt; n\), \(n\) cannot be the smallest integer with distinct prime factorizations,
which is a <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradiction</a>.
Thus, each positive integer can be represented by a unique <a href="#multiset-of-prime-factors">multiset of prime factors</a>.</li>
  </ul>

</details>

<h3 id="multiplicative-inverse-revisited">Multiplicative inverse revisited</h3>

<p>Coming back to <a href="#multiplicative-groups">multiplicative groups modulo some integer \(m\)</a> for a moment:
Why is it that only those integers have a <a href="#modular-multiplicative-inverse">multiplicative inverse</a>
which are <a href="#prime-factorization">coprime</a> with the group’s modulus?
Coprimality is <a href="https://en.wikipedia.org/wiki/Necessity_and_sufficiency">necessary and sufficient</a>
for an integer to have an inverse since:</p>
<ul>
  <li><strong>Sufficient</strong>: If an integer \(a\) is coprime with the modulus \(m\),
<a href="#bezouts-identity">Bézout’s identity</a> tells us that there are two integers \(b\) and \(n\)
so that \(b \cdot a + n \cdot m = 1\).
This equation means that \(b \cdot a\) equals \(1\) up to a multiple of \(m\), that is \(b \cdot a =_m 1\).
<!-- --> \(b\) is therefore the multiplicative inverse of \(a\) modulo \(m\).
The <a href="#extended-euclidean-algorithm">extended Euclidean algorithm</a> can be used to determine \(b\).
This approach is usually much faster than <a href="#modular-multiplicative-inverse">using exponentiation</a>.
The <a href="#tool-integer-extended-euclidean-algorithm">above tool</a> marks the coefficient of the smaller number
with a blue background whenever the <a href="#greatest-common-divisor">greatest common divisor</a> is \(1\).
If you use the extended Euclidean algorithm only to determine the multiplicative inverse of \(a\),
you don’t need to keep track of the coefficient of \(m\)
(i.e. you don’t have to implement the second to last column).</li>
  <li><strong>Necessary</strong>: The second part of <a href="#bezouts-identity">Bézout’s identity</a> tells us
that the closest you can get to a multiple of \(m\) is \(\operatorname{gcd}(a, m)\).
If an integer \(a\) is not coprime with the modulus \(m\), \(\operatorname{gcd}(a, m) &gt; 1\).
Consequently, there is no integer \(b\) so that \(b \cdot a =_m 1\).
For example, if both \(a\) and \(m\) are even,
which means that their greatest common divisor is a multiple of \(2\),
you cannot reach an odd number, including \(1\), by adding \(a\) repeatedly to itself.</li>
</ul>

<p>There is another important question to be answered:
Why are multiplicative groups closed if you limit the elements to the integers which are coprime with the modulus?
The best way to think about this is with <a href="#multiset-of-prime-factors">multisets of the prime factors</a>.
When you multiply two integers, you combine the multisets of their prime factors
by adding the multiplicities of each element.
For example, \(6 \cdot 15 = \{2, 3\} + \{3, 5\} = \{2, 3, 3, 5\} = 90\).
If neither \(a\) nor \(b\) has prime factors in common with some integer \(m\), then neither has \(a \cdot b\).
Calculating the product <a href="#modulo-operation">modulo \(m\)</a> doesn’t change this fact
because the <a href="#congruence-relation">congruence property</a> of modular multiplication
means that you can reduce integers to their remainder, not that you have to.
After all, the <a href="#euclidean-algorithm">Euclidean algorithm</a> showed us that
subtracting the smaller number \(m\) repeatedly from the larger number \(a \cdot b\)
does not change the <a href="#greatest-common-divisor">greatest common divisor</a> of the two numbers.</p>

<p>Since the <a href="#group-order">order of a group</a> plays a crucial role in cryptography, our next goal is to find a formula
which counts the <a href="#eulers-totient-function">number of coprime integers</a> smaller than \(m\).
On our way there, we’ll study another famous result from number theory:
the <a href="#chinese-remainder-theorem">Chinese remainder theorem</a>.</p>

<details>
  <summary id="least-common-multiple-and-0">
Least common multiple and 0
</summary>

  <p>There is another way to see why elements which share a prime factor with the modulus are undesirable.
If the integer \(a\) is not coprime with the modulus \(m\),
then <a href="#greatest-common-divisor">\(\operatorname{gcd}(a, m) &gt; 1\)</a>
and <a href="#least-common-multiple">\(\operatorname{lcm}(a, m) &lt; a \cdot m\)</a>.
This means that there is some integer \(b &lt; m\) for which \(b \cdot a = \operatorname{lcm}(a, m)\).
Since \(\operatorname{lcm}(a, m)\) is also a multiple of \(m\), \(b \cdot a =_m 0\).
As I explained when I <a href="#multiplicative-groups">introduced multiplicative groups</a>,
<!-- --> \(0\) has to be excluded from the set of elements.
Since a group has to be <a href="#group-axioms">closed</a>, we have to exclude \(a\) or \(b\).
This problem can be observed in the <a href="#multiplicative-group-operation-table">operation table of multiplicative groups</a>.
If we <a href="#tool-table-multiplicative-group-operation&amp;modulus=12&amp;coprime=false&amp;zero=true&amp;product=false">set the modulus to 12</a>,
for example, we see that all the elements which are not coprime with the modulus
(the tool marks them with a blue background) reach \(0\) at some point.
After that, the elements repeat because \((b + 1) \cdot a =_m b \cdot a + 1 \cdot a =_m 0 + a =_m a\).
The first factor for which we reach \(0\) is \(b = \frac{\operatorname{lcm}(a, m)}{a} = \frac{m}{\operatorname{gcd}(a, m)}\).
This means that there are \(\operatorname{gcd}(a, m)\) repetitions in the rows and columns of non-coprime elements.
It also implies that the equation \(a \cdot x =_m c\) has \(d = \operatorname{gcd}(a, m)\) solutions in \(\mathbb{Z}_m\)
if \(c\) is a multiple of \(d\) and <a href="#bezouts-identity">no solution otherwise</a>.</p>

</details>

<details>
  <summary id="uniqueness-of-the-multiplicative-inverse">
Uniqueness of the multiplicative inverse
</summary>

  <p>As required by the <a href="#group-axioms">group axioms</a>,
the multiplicative inverse of a <a href="#multiset-of-prime-factors">coprime</a> element is unique.
Suppose that the coprime element \(a\) has two multiplicative inverses: \(b_1 \cdot a =_m 1\) and \(b_2 \cdot a =_m 1\).
It follows that \(b_1 \cdot a =_m b_2 \cdot a\) and hence that \(b_1 \cdot a - b_2 \cdot a =_m 0\).
This means that \(b_1 \cdot a - b_2 \cdot a = (b_1 - b_2) \cdot a\) is a multiple of \(m\).
Since \(\operatorname{\href{#greatest-common-divisor}{gcd}}(a, m) = 1\), \(m\) has to divide \(b_1 - b_2\)
according to a generalized version of <a href="#euclids-lemma">Euclid’s lemma</a>.
(Its proof required only that \(p\) and \(a\) are coprime, which means that \(p\) has to be
only <a href="#multiset-of-prime-factors">relatively prime</a> to one of the factors, not “absolutely” prime.)
Therefore, \(b_1\) has to equal \(b_2\) up to a multiple of \(m\).</p>

</details>

<h3 id="chinese-remainder-theorem" data-toc-text="Chinese remainder theorem">Chinese remainder theorem (<abbr title="Chinese Remainder Theorem">CRT</abbr>)</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Chinese_remainder_theorem">Chinese remainder theorem</a> states that
if the remainders of an integer are known relative to several moduli
which are <a href="#multiset-of-prime-factors">coprime with one another</a>,
the integer is unique up to multiples of the product of the moduli.
More formally, the system of <a href="#congruence-relation">congruences</a></p>

\[\begin{aligned}
x &amp;=_{m_1} r_1 \\
x &amp;=_{m_2} r_2 \\
&amp;\enspace \vdots \\
x &amp;=_{m_l} r_l
\end{aligned}\]

<p>has a unique solution \(x\) with \(0 ≤ x &lt; M\)
if \(\operatorname{\href{#greatest-common-divisor}{gcd}}(m_i, m_j) = 1\) for all \(i ≠ j\),
where \(M = \prod_{i=1}^l m_i\).
The problem was first stated in <a href="https://en.wikipedia.org/wiki/Sunzi_Suanjing">a Chinese text</a>
around the 4th century <a href="https://en.wikipedia.org/wiki/Common_Era"><abbr title="Common Era">CE</abbr></a>.
The solution can be determined as follows:
Let \(M_i = M / m_i\), which is the product of all moduli except \(m_i\).
Given that \(m_i\) has no prime factor in common with any of the other moduli, \(M_i\) and \(m_i\) are coprime.
Using the <a href="#extended-euclidean-algorithm">extended Euclidean algorithm</a>,
we find an \(N_i\) so that \(N_i \cdot M_i =_{m_i} 1\).
As \(M_i\) is a multiple of all other moduli, \(N_i \cdot M_i =_{m_j} 0\) for all \(j ≠ i\).
Therefore, \(x =_M \sum_{i=1}^{l} r_i \cdot N_i \cdot M_i\) satisfies all the congruences.
The solution is unique because for any two solutions,
<!-- --> \(x_1 - x_2 =_{m_i} 0\) for all \(i\) and thus also \(x_1 - x_2 =_M 0\)
because any multiple of coprime factors is also a multiple of their product.</p>

<p>The following tool implements this procedure for \(l = 2\).
If you want to solve a larger system of congruences,
you can repeatedly replace any two equations with their solution
until only a single congruence is left, which is the solution to the whole system.
The case of \(l = 2\) is special because \(M_1 = m_2\) and \(M_2 = m_1\),
which means that a single <a href="#bezouts-identity">Bézout’s identity</a> is enough to find the solution:</p>



<details>
  <summary id="sum-and-product-of-similar-terms">
Sum and product of similar terms
</summary>

  <p>I used the following two shortcuts in the description of the Chinese remainder theorem,
which you might not be familiar with:</p>
  <ul>
    <li><a href="https://en.wikipedia.org/wiki/Summation#Capital-sigma_notation"><strong>Capital-sigma notation</strong></a>:
<!-- --> \(\sum_{i=1}^{l} r_i \cdot N_i \cdot M_i = r_1 \cdot N_1 \cdot M_1 + … + r_l \cdot N_l \cdot M_l\), and</li>
    <li><a href="https://en.wikipedia.org/wiki/Multiplication#Capital_pi_notation"><strong>Capital-pi notation</strong></a>:
<!-- --> \(\prod_{i=1}^l m_i = m_1 \cdot … \cdot m_l\),
where \(i\) is the <a href="https://en.wikipedia.org/wiki/Index_notation">index</a> which is incremented.</li>
  </ul>

</details>

<details>
  <summary id="signals-of-different-frequencies">
Signals of different frequencies
</summary>

  <p>The <a href="#chinese-remainder-theorem">Chinese remainder theorem</a> is more intuitive than it may seem.
Given two pulses with coprime <a href="https://en.wikipedia.org/wiki/Pulse_repetition_frequency">repetition frequencies</a>,
it’s clear that the <a href="https://en.wikipedia.org/wiki/Phase_(waves)#Phase_shift">phase</a>
of one pulse shifts relative to the phase of the other pulse
until they re-align at the <a href="#least-common-multiple">least common multiple</a>:</p>

  <figure>
    <svg id="figure-chinese-remainder-theorem" data-name="chinese-remainder-theorem" width="557.5" height="71.5" viewBox="-16.25 -34.75 557.5 71.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="15" y1="-5" x2="15" y2="5"></line>
    <line x1="30" y1="-5" x2="30" y2="5"></line>
    <line x1="45" y1="-5" x2="45" y2="5"></line>
    <line x1="60" y1="-5" x2="60" y2="5"></line>
    <line x1="75" y1="-5" x2="75" y2="5"></line>
    <line x1="90" y1="-5" x2="90" y2="5"></line>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <line x1="120" y1="-5" x2="120" y2="5"></line>
    <line x1="135" y1="-5" x2="135" y2="5"></line>
    <line x1="150" y1="-5" x2="150" y2="5"></line>
    <line x1="165" y1="-5" x2="165" y2="5"></line>
    <line x1="180" y1="-5" x2="180" y2="5"></line>
    <line x1="195" y1="-5" x2="195" y2="5"></line>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <line x1="225" y1="-5" x2="225" y2="5"></line>
    <line x1="240" y1="-5" x2="240" y2="5"></line>
    <line x1="255" y1="-5" x2="255" y2="5"></line>
    <line x1="270" y1="-5" x2="270" y2="5"></line>
    <line x1="285" y1="-5" x2="285" y2="5"></line>
    <line x1="300" y1="-5" x2="300" y2="5"></line>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <line x1="330" y1="-5" x2="330" y2="5"></line>
    <line x1="345" y1="-5" x2="345" y2="5"></line>
    <line x1="360" y1="-5" x2="360" y2="5"></line>
    <line x1="375" y1="-5" x2="375" y2="5"></line>
    <line x1="390" y1="-5" x2="390" y2="5"></line>
    <line x1="405" y1="-5" x2="405" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="435" y1="-5" x2="435" y2="5"></line>
    <line x1="450" y1="-5" x2="450" y2="5"></line>
    <line x1="465" y1="-5" x2="465" y2="5"></line>
    <line x1="480" y1="-5" x2="480" y2="5"></line>
    <line x1="495" y1="-5" x2="495" y2="5"></line>
    <line x1="510" y1="-5" x2="510" y2="5"></line>
    <line x1="0" y1="-10" x2="0" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="0" y="-22"><tspan>0</tspan></tspan>
    </text>
    <line x1="75" y1="-10" x2="75" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="75" y="-22"><tspan>5</tspan></tspan>
    </text>
    <line x1="150" y1="-10" x2="150" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="150" y="-22"><tspan>10</tspan></tspan>
    </text>
    <line x1="225" y1="-10" x2="225" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="225" y="-22"><tspan>15</tspan></tspan>
    </text>
    <line x1="300" y1="-10" x2="300" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="300" y="-22"><tspan>20</tspan></tspan>
    </text>
    <line x1="375" y1="-10" x2="375" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="375" y="-22"><tspan>25</tspan></tspan>
    </text>
    <line x1="450" y1="-10" x2="450" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="450" y="-22"><tspan>30</tspan></tspan>
    </text>
    <line x1="525" y1="-10" x2="525" y2="-1.25"></line>
    <text text-anchor="middle">
        <tspan x="525" y="-22"><tspan>35</tspan></tspan>
    </text>
    <line x1="0" y1="1.25" x2="0" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="0" y="33.5"><tspan>0</tspan></tspan>
    </text>
    <line x1="105" y1="1.25" x2="105" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="105" y="33.5"><tspan>7</tspan></tspan>
    </text>
    <line x1="210" y1="1.25" x2="210" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="210" y="33.5"><tspan>14</tspan></tspan>
    </text>
    <line x1="315" y1="1.25" x2="315" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="315" y="33.5"><tspan>21</tspan></tspan>
    </text>
    <line x1="420" y1="1.25" x2="420" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="420" y="33.5"><tspan>28</tspan></tspan>
    </text>
    <line x1="525" y1="1.25" x2="525" y2="10"></line>
    <text text-anchor="middle">
        <tspan x="525" y="33.5"><tspan>35</tspan></tspan>
    </text>
    <line x1="-15" y1="0" x2="540" y2="0" marker-end="url(#arrow)" stroke-dasharray="548"></line>

</svg>

    <figcaption>

Visualizing shifting repetitions on a <a href="https://en.wikipedia.org/wiki/Number_line">number line</a>
with m<sub>1</sub> = 5 and m<sub>2</sub> = 7.

</figcaption>
  </figure>

  <p>The offset between the two pulses has to be different throughout this cycle.
If the same offset occurred twice, the difference between the two occurrences would be a multiple of both frequencies
smaller than the least common multiple, which is a <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradiction</a>.
(This argument is similar to the one we used to establish that you <a href="#element-order">reach the identity element</a>
before any of the group’s elements can appear again when <a href="#element-repetitions">repeating an element</a>.)
This is also why all (and only) the coprime elements <a href="#additive-group-repetition-table">generate the additive group</a>.
In the above example, there are 5 offsets to cover and 5 green ticks before the cycle repeats.
Since no two offsets may be the same, all 5 offsets are covered due to the
<a href="https://en.wikipedia.org/wiki/Pigeonhole_principle#Alternative_formulations">pigeonhole principle</a>.
(On the other side of the number line, there are 7 offsets to cover with 7 blue ticks.)
The difference between the two remainders in the <a href="#tool-integer-chinese-remainder-theorem">tool above</a>
determines into which repetition the solution falls.
For example, if the first remainder is one smaller than the second remainder,
the solution is 15 + r<sub>1</sub>.</p>

</details>

<h3 id="group-isomorphisms">Group isomorphisms</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Group_isomorphism">group isomorphism</a>
is an <a href="https://en.wikipedia.org/wiki/Bijection">invertible function</a>
which maps the elements of one group to distinct elements of another group
so that the result of combining any two elements in one group
matches the result when combining the paired elements in the other group.
More formally, given two groups \(\mathbb{G}_1\) and \(\mathbb{G}_2\)
with corresponding operations \(\circ_1\) and \(\circ_2\),
an invertible function \(f{:}\ \mathbb{G}_1 \to \mathbb{G}_2\)
defines a group isomorphism <a href="#if-and-only-if">if and only if</a>
<!-- --> \(f(A \circ_1 B) = f(A) \circ_2 f(B)\) for all \(A, B \in \mathbb{G}_1\).
A group isomorphism can be visualized as follows:</p>

<figure>
  <svg id="figure-group-isomorphism" data-name="group-isomorphism" width="223.196" height="110.5" viewBox="-41.946 -1.25 223.196 110.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="162" y1="37.25" x2="162" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="90" y1="37.25" x2="90" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="18" y1="37.25" x2="18" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <rect x="0" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="23.9"><tspan>A<tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="72" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="23.9"><tspan>B<tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="144" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="162" y="23.9"><tspan>C<tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="0" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="95.9"><tspan>A<tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="72" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="95.9"><tspan>B<tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="144" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="162" y="95.9"><tspan>C<tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="24.9"><tspan>∘</tspan><tspan><tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="23.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="96.9"><tspan>∘</tspan><tspan><tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="95.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="23.9">𝔾<tspan dy="3">1</tspan><tspan dy="-3">​</tspan>:</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="95.9">𝔾<tspan dy="3">2</tspan><tspan dy="-3">​</tspan>:</tspan>
    </text>

</svg>

  <figcaption>
An isomorphism between two groups.
</figcaption>
</figure>

<p>You may have realized that this looks similar to our definition of a <a href="#definition">linear one-way function</a>.
The main differences are that the inputs to an isomorphism are the elements of a group, which don’t have to be integers,
and that the operation doesn’t have to resemble addition.
Moreover, an isomorphism may be easy to invert, thus neither “linear” nor “one-way” are appropriate adjectives.</p>

<p>If an isomorphism exists between the groups \(\mathbb{G}_1\) and \(\mathbb{G}_2\),
the groups are said to be isomorphic, which is usually written as \(\mathbb{G}_1 \cong \mathbb{G}_2\).
For a function to be invertible, it has to map a single element of \(\mathbb{G}_1\) to every element of \(\mathbb{G}_2\).
As a consequence, isomorphic groups have the same <a href="#group-order">order</a> (\(|\mathbb{G}_1| = |\mathbb{G}_2|\)),
and the <a href="https://en.wikipedia.org/wiki/Inverse_function">inverse of an isomorphism</a> is also an isomorphism.
Furthermore, an isomorphism maps the identity element of \(\mathbb{G}_1\) to the identity element of \(\mathbb{G}_2\)
because \(f(A) = f(A \circ_1 E) = f(A) \circ_2 f(E)\) for all \(A \in \mathbb{G}_1\).
It also maps the inverse \(\overline{A}\) of each element \(A \in \mathbb{G}_1\)
to the inverse of \(f(A)\) because \(f(A) \circ_2 f(\overline{A}) = f(A \circ_1 \overline{A}) = f(E)\).
Since you reach the identity element in one group only when you reach it in the other group,
the <a href="#element-order">order</a> of mapped elements is the same: \(|A| = |f(A)|\).
Last but not least, either both groups are <a href="#commutative-groups">commutative</a> or neither of them is.
In conclusion, isomorphic groups represent the same structure, they just use different labels for the elements.</p>

<details>
  <summary id="isomorphism-of-cyclic-groups">
Isomorphism of cyclic groups
</summary>

  <p>All <a href="#cyclic-groups">cyclic groups</a> of the same order are <a href="#group-isomorphisms">isomorphic</a>.
As we saw <a href="#additive-group-repetition-table">earlier</a>, <a href="#additive-groups">additive groups</a> are always cyclic.
This means that all cyclic groups of order \(m\) are isomorphic to <a href="#additive-group-notations">\(\mathbb{Z}_m^+\)</a>
and thus <a href="#commutative-groups">commutative</a>.
Given a <a href="#group-generators">generator</a> \(G\), \(\href{#group-generators}{⟨G⟩} \cong \mathbb{Z}_m^+\)
<a href="#if-and-only-if">if and only if</a> \(\lvert G \rvert = m\).</p>

  <div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

    <div>
      <p>The function \(f(x) = xG\) is a group isomorphism because:</p>

      <figure>
        <svg id="figure-group-isomorphism-additive" data-name="group-isomorphism-additive" width="261.588" height="110.5" viewBox="-44.338 -1.25 261.588 110.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="180" y1="37.25" x2="180" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="90" y1="37.25" x2="90" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="18" y1="37.25" x2="18" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <rect x="0" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="23.9"><tspan>a</tspan></tspan>
    </text>
    <rect x="72" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="23.9"><tspan>b</tspan></tspan>
    </text>
    <rect x="144" y="0" width="72" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="180" y="23.9"><tspan>a + b</tspan></tspan>
    </text>
    <rect x="0" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="95.9"><tspan>aG</tspan></tspan>
    </text>
    <rect x="72" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="95.9"><tspan>bG</tspan></tspan>
    </text>
    <rect x="144" y="72" width="72" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="180" y="95.9"><tspan>(a + b)G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="24.9"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="23.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="96.9"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="95.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="23.9">ℤ<tspan dy="-6">+</tspan><tspan dy="6">​</tspan><tspan dx="-6.96">​</tspan><tspan dy="3">m</tspan><tspan dy="-3">​</tspan>:</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="95.9">⟨G⟩:</tspan>
    </text>

</svg>

        <figcaption>
An isomorphism with \(\mathbb{Z}_m^+\) using additive notation.
</figcaption>
      </figure>

    </div>

    <div>
      <p>The function \(f(x) = G^x\) is a group isomorphism because:</p>

      <figure>
        <svg id="figure-group-isomorphism-multiplicative" data-name="group-isomorphism-multiplicative" width="261.588" height="110.5" viewBox="-44.338 -1.25 261.588 110.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="180" y1="37.25" x2="180" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="90" y1="37.25" x2="90" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <line x1="18" y1="37.25" x2="18" y2="70.75" marker-start="url(#arrow-blue)" marker-end="url(#arrow-blue)" stroke-dasharray="20" stroke-dashoffset="33"></line>
    <rect x="0" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="23.9"><tspan>a</tspan></tspan>
    </text>
    <rect x="72" y="0" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="23.9"><tspan>b</tspan></tspan>
    </text>
    <rect x="144" y="0" width="72" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="180" y="23.9"><tspan>a + b</tspan></tspan>
    </text>
    <rect x="0" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="18" y="95.9"><tspan>G<tspan dy="-6">a</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <rect x="72" y="72" width="36" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="90" y="95.9"><tspan>G<tspan dy="-6">b</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <rect x="144" y="72" width="72" height="36" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="180" y="95.9"><tspan>G<tspan dy="-6">a + b</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="24.9"><tspan>+</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="23.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="54" y="96.9"><tspan>·</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="126" y="95.9"><tspan>=</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="23.9">ℤ<tspan dy="-6">+</tspan><tspan dy="6">​</tspan><tspan dx="-6.96">​</tspan><tspan dy="3">m</tspan><tspan dy="-3">​</tspan>:</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-25.2" y="95.9">⟨G⟩:</tspan>
    </text>

</svg>

        <figcaption>
An isomorphism with \(\mathbb{Z}_m^+\) using multiplicative notation.
</figcaption>
      </figure>

    </div>

  </div>

  <p>In <a href="#discrete-logarithm-problem">some</a> <a href="#elliptic-curve-discrete-logarithm-problem">groups</a>,
the inverse isomorphism is <a href="#computational-complexity-theory">difficult to compute</a>,
giving us the <a href="#linear-one-way-functions">linear one-way functions</a> we were looking for.</p>

</details>

<h3 id="direct-product">Direct product</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Cartesian_product">Cartesian product</a>
of the \(l\) sets \(\mathbb{G}_1\) to \(\mathbb{G}_l\)
is the set of \(l\)-<a href="https://en.wikipedia.org/wiki/Tuple">tuples</a>
where the \(i\)-th component is an element of \(\mathbb{G}_i\).
More formally:</p>

\[\mathbb{G}_1 \times … \times \mathbb{G}_l
= \{(A_1, …, A_l) \mid A_1 \in \mathbb{G}_1, …, A_l \in \mathbb{G}_l \}\]

<p>The product is named after <a href="https://en.wikipedia.org/wiki/Ren%C3%A9_Descartes">René Descartes</a> (1596 − 1650).
The product of \(l\) groups forms a group with the following operation:</p>

\[(A_1, …, A_l) \circ (B_1, …, B_l) = (A_1 \circ_1 B_1, …, A_l \circ_l B_l)\]

<p>This so-called <a href="https://en.wikipedia.org/wiki/Direct_product_of_groups">direct product of groups</a>
with such a component-wise operation fulfills all <a href="#group-axioms">group axioms</a>:
It is closed and associative because the operation in each of the groups is closed and associative,
the tuple consisting of each group’s identity element is the identity element of the direct product,
and each element of the direct product has a unique inverse consisting of the component-wise inverses.
Being a Cartesian product, the <a href="#group-order">order of the direct product</a> equals the product of each group’s order:</p>

\[|\mathbb{G}_1 \times … \times \mathbb{G}_l| = |\mathbb{G}_1| \cdot … \cdot |\mathbb{G}_l|\]

<p>The <a href="#element-order">order of each element</a> is the <a href="#least-common-multiple">least common multiple</a>
of the order of each component in its group:</p>

\[|(A_1, …, A_l)| = \operatorname{\href{#least-common-multiple}{lcm}}(|A_1|, …, |A_l|)\]

<p>Hence, the direct product is <a href="#cyclic-groups">cyclic</a> <a href="#if-and-only-if">if and only if</a>
the individual groups are all cyclic and their orders are coprime with one another.</p>

<details>
  <summary id="internal-direct-product-of-commutative-subgroups">
Internal direct product of commutative subgroups
</summary>

  <p>Given two <a href="#subgroups">subgroups</a> \(\mathbb{H_1}\) and \(\mathbb{H_2}\)
of a <a href="#commutative-groups">commutative group</a> \(\mathbb{G}\)
which have no element in common other than the <a href="#group-axioms">identity element</a> \(E\)
(i.e. \(\mathbb{H_1} \cap \mathbb{H_2} = \{E\}\)),
the so-called <a href="https://proofwiki.org/wiki/Definition:Internal_Group_Direct_Product">internal direct product</a>
<!-- --> \(\mathbb{H_1} \circ \mathbb{H_2} = \{A_1 \circ A_2 \mid A_1 \in \mathbb{H_1}, A_2 \in \mathbb{H_2}\}\)
is <a href="#group-isomorphisms">isomorphic</a> to the <a href="#direct-product">direct product</a> \(\mathbb{H_1} \times \mathbb{H_2}\)
(i.e. \(\mathbb{H_1} \times \mathbb{H_2} \cong \mathbb{H_1} \circ \mathbb{H_2}\)).
The isomorphism is given by the function \(f\big((A_1, A_2)\big) = A_1 \circ A_2\),
which maps elements of \(\mathbb{H_1} \times \mathbb{H_2}\) to elements of \(\mathbb{H_1} \circ \mathbb{H_2}\).
In order to show that this is indeed an isomorphism,
we need to show that \(f\) is compatible with the group operations
(i.e. \(f(A \circ_1 B) = f(A) \circ_2 f(B)\)) and invertible:</p>
  <ul>
    <li><strong>Compatibility</strong>: \(f\big((A_1, A_2) \circ (B_1, B_2)\big)
= f\big((A_1 \circ B_1, A_2 \circ B_2)\big)
= (A_1 \circ B_1) \circ (A_2 \circ B_2)
= (A_1 \circ A_2) \circ (B_1 \circ B_2)
= f\big((A_1, A_2)\big) \circ f\big((B_1, B_2)\big)\)
due to <a href="#group-axioms">associativity</a> and <a href="#commutative-groups">commutativity</a>.</li>
    <li><strong>Invertibility</strong> (a so-called <a href="https://en.wikipedia.org/wiki/Bijection">bijection</a>):
The function \(f\) is invertible if the following two criteria are fulfilled:
      <ul>
        <li><strong>Distinct elements are mapped to distinct elements</strong> (<a href="https://en.wikipedia.org/wiki/Injective_function">injectivity</a>):
This is the case if we obtain equal outputs <a href="https://en.wikipedia.org/wiki/Contraposition">only for equal inputs</a>.
In other words, we need to show that \(f\big((A_1, A_2)\big) = f\big((B_1, B_2)\big)\)
implies \((A_1, A_2) = (B_1, B_2)\).
As \(A_1 \circ A_2 = B_1 \circ B_2\), we have that \(\overline{B_1} \circ A_1 = B_2 \circ \overline{A_2}\).
Clearly, \(\overline{B_1} \circ A_1 \in \mathbb{H_1}\) and \(B_2 \circ \overline{A_2} \in \mathbb{H_2}\)
due to <a href="#group-axioms">closure</a>.
Since the identity element is the only element which is in both \(\mathbb{H_1}\) and \(\mathbb{H_2}\),
<!-- --> \(\overline{B_1} \circ A_1 = E\) and \(B_2 \circ \overline{A_2} = E\).
Thus, \(A_1 = B_1\) and \(A_2 = B_2\).</li>
        <li><strong>Every element of the target group is reached</strong> (<a href="https://en.wikipedia.org/wiki/Surjective_function">surjectivity</a>):
Since every element in \(\mathbb{H_1} \circ \mathbb{H_2}\) is of the form \(A_1 \circ A_2\) by definition,
there’s an input for every element in \(\mathbb{H_1} \circ \mathbb{H_2}\),
namely \((A_1, A_2)\) because \(f\big((A_1, A_2)\big) = A_1 \circ A_2\).</li>
      </ul>
    </li>
  </ul>

</details>

<details>
  <summary id="order-when-combining-two-elements-of-coprime-orders">
Order when combining two elements of coprime orders
</summary>

  <p>Given a finite <a href="#commutative-groups">commutative group</a> \(\mathbb{G}\)
with two elements \(A_1\) and \(A_2\) so that \(\operatorname{\href{#greatest-common-divisor}{gcd}}(|A_1|, |A_2|) = 1\),
the <a href="#element-order">order</a> of \(A_1 \circ A_2\) is \(|A_1| \cdot |A_2|\).
Since \(A_1\) <a href="#group-generators">generates</a> the <a href="#subgroups">subgroup</a> \(\href{#group-generators}{⟨A_1⟩}\)
and \(A_2\) generates the subgroup \(⟨A_2⟩\),
<a href="#intersection-of-subgroups-is-a-subgroup">their intersection is a subgroup</a> of both \(⟨A_1⟩\) and \(⟨A_2⟩\).
By <a href="#lagranges-theorem">Lagrange’s theorem</a>, \(|⟨A_1⟩ \cap ⟨A_2⟩|\) divides both \(|⟨A_1⟩|\) and \(|⟨A_2⟩|\).
Since \(\operatorname{gcd}(|⟨A_1⟩|, |⟨A_2⟩|) = 1\), \(|⟨A_1⟩ \cap ⟨A_2⟩|\) has to equal \(1\).
Since the <a href="#group-axioms">identity element</a> \(E\) is part of every subgroup, \(⟨A_1⟩ \cap ⟨A_2⟩ = \{E\}\).
According to the <a href="#internal-direct-product-of-commutative-subgroups">previous box</a>,
<!-- --> \(⟨A_1⟩ \circ ⟨A_2⟩\) is thus <a href="#group-isomorphisms">isomorphic</a> to \(⟨A_1⟩ \times ⟨A_2⟩\).
Therefore, \(|A_1 \circ A_2| = |(A_1, A_2)|
= \operatorname{\href{#least-common-multiple}{lcm}}(|A_1|, |A_2|) = |A_1| \cdot |A_2|\).</p>

</details>

<h3 id="composite-groups">Composite groups</h3>

<p>Given the \(l\) coprime moduli \(m_1, …, m_l\)
and <a href="#sum-and-product-of-similar-terms">their product</a> \(M = \prod_{i=1}^l m_i\),
the <a href="#additive-groups">additive group</a> \(\mathbb{Z}_M^+\) is <a href="#group-isomorphisms">isomorphic</a>
to the <a href="#direct-product">direct product</a> of \(\mathbb{Z}_{m_1}^+, …, \mathbb{Z}_{m_l}^+\),
written as follows:</p>

\[\mathbb{Z}_M^+ \cong \mathbb{Z}_{m_1}^+ \times … \times \mathbb{Z}_{m_l}^+\]

<p>Let us verify this step by step.
Since the <a href="#group-order">order of additive groups</a> is given by the modulus,
both groups contain the same number of elements:
<!-- --> \(|\mathbb{Z}_M^+| = |\mathbb{Z}_{m_1}^+| \cdot … \cdot |\mathbb{Z}_{m_l}^+| = M\).
According to the <a href="#chinese-remainder-theorem">Chinese remainder theorem</a>,
there’s a unique element in \(\mathbb{Z}_M^+\)
for every element of \(\mathbb{Z}_{m_1}^+ \times … \times \mathbb{Z}_{m_l}^+\).
As a consequence, the function \(f(x) = (x\ \href{#modulo-operation}{\%}\ m_1, …, x\ \%\ m_l)\)
is <a href="https://en.wikipedia.org/wiki/Bijection">invertible</a>.
<!-- --> \(f(x)\) is an <a href="#group-isomorphisms">isomorphism</a> because <a href="#equivalence-relation">modular equivalence</a>
is a <a href="#congruence-relation">congruence relation</a> for any modulus:
\(f(A + B) = ((A + B)\ \%\ m_1, …, (A + B)\ \%\ m_l)
= (A\ \%\ m_1, …, A\ \%\ m_l) + (B\ \%\ m_1, …, B\ \%\ m_l) = f(A) + f(B)\)
for any \(A, B \in \mathbb{Z}_M^+\).</p>

<p>The same function is also an isomorphism for <a href="#multiplicative-groups">multiplicative groups</a>
because \((A \cdot B)\ \%\ m_i =_{m_i} (A\ \%\ m_i) \cdot (B\ \%\ m_i)\):</p>

\[\mathbb{Z}_M^\times \cong \mathbb{Z}_{m_1}^\times \times … \times \mathbb{Z}_{m_l}^\times\]

<p>Both groups contain the same number of elements because an integer is <a href="#multiset-of-prime-factors">coprime</a> with \(M\)
<a href="#if-and-only-if">if and only if</a> it is coprime with all moduli \(m_1, …, m_l\).
This gives us an easy way to determine the number of elements in multiplicative groups modulo a composite integer,
as we shall see in the <a href="#eulers-totient-function">next section</a>.</p>

<p>You can display the decomposition of each element <a href="#modulo-operation">modulo</a>
the <a href="#prime-factorization">prime factors</a> of the modulus in the operation tables
of <a href="#additive-group-operation-table">additive groups</a>
and <a href="#multiplicative-group-operation-table">multiplicative groups</a>
by <a href="#tool-table-multiplicative-group-operation&amp;product=true">enabling the “Product” option</a>.
For example, <a href="#tool-table-multiplicative-group-operation&amp;modulus=35&amp;coprime=false&amp;product=true">\(\mathbb{Z}_{35}^\times \cong \mathbb{Z}_{5}^\times \times \mathbb{Z}_{7}^\times\)</a>.
Instead of multiplying two elements in \(\mathbb{Z}_{35}^\times\),
you can multiply their components in \(\mathbb{Z}_{5}^\times\) and \(\mathbb{Z}_{7}^\times\).
For example, \([11 \leftrightarrow (1, 4)] \cdot [8 \leftrightarrow (3, 1)] = [18 \leftrightarrow (3, 4)]\).
Decomposing a composite group into a <a href="#direct-product">direct product</a> of its factors is another way to see
why only coprime elements <a href="#multiplicative-inverse-revisited">have an inverse</a>
because multiples of the prime factors are mapped to \(0\) in the corresponding group
and \(0\) has no multiplicative inverse.</p>

<h3 id="eulers-totient-function" data-toc-text="Euler&#39;s totient function">Euler’s totient function φ</h3>

<p>As explained <a href="#multiplicative-inverse-revisited">earlier</a>,
<a href="#multiplicative-groups">multiplicative groups</a> contain all the integers between \(0\) and \(m\)
which are <a href="#multiset-of-prime-factors">coprime</a> with the modulus \(m\).
So how many coprime integers below \(m\) are there?
We answer this question by starting with the simplest case and generalizing from there:</p>
<ul>
  <li>\(m = p\) for some prime \(p\): All integers strictly between \(0\) and \(p\) (i.e. \(0 &lt; x &lt; p\)) are coprime with \(p\).
Using the <a href="https://en.wikipedia.org/wiki/Phi">Greek letter phi</a> to denote the function
which returns the number of coprime integers smaller than its input, \(\varphi(p) = p - 1\).</li>
  <li>\(m = p^e\) for some prime \(p\) and a positive integer \(e\):
All integers between \(0\) and \(p^e\) except the multiples of \(p\) are coprime with \(p^e\).
Since \(0 &lt; c \cdot p &lt; p^e\) for \(0 &lt; c &lt; p^{e-1}\),
there are \(p^{e-1} - 1\) multiples of \(p\) which have to be excluded.
Therefore, \(\varphi(p^e) = (p^e - 1) - (p^{e-1} - 1) = p^e - p^{e-1} = p^{e-1} \cdot (p - 1)\).</li>
  <li>\(m = p_1^{e_1} \cdot … \cdot p_l^{e_l}\) for \(l\) distinct primes with positive exponents:
Since <a href="https://en.wikipedia.org/wiki/Prime_power">powers of different primes</a> are coprime with one another,
<!-- --> \(\mathbb{Z}_m^\times \cong \mathbb{Z}_{p_1^{e_1}}^\times \times … \times \mathbb{Z}_{p_l^{e_l}}^\times\)
according to the <a href="#composite-groups">previous section</a>.
<a href="#direct-product">Therefore</a>,
<!-- --> \(\varphi(p_1^{e_1} \cdot … \cdot p_l^{e_l}) = \varphi(p_1^{e_1}) \cdot … \cdot \varphi(p_l^{e_l})\).</li>
</ul>

<p>Given the <a href="#prime-factorization">prime factorization</a> of \(m = p_1^{e_1} \cdot … \cdot p_l^{e_l}\),
the number of coprime integers below \(m\) is given by the following formula:</p>

\[\varphi(m)
= \prod_{i=1}^l \varphi(p_i^{e_i})
= \prod_{i=1}^l p_i^{e_i} - p_i^{e_i-1}
= \prod_{i=1}^l p_i^{e_i-1} \cdot (p_i - 1)\]

<p>This is known as <a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler’s totient function</a>,
named after <a href="https://en.wikipedia.org/wiki/Leonhard_Euler">Leonhard Euler</a> (1707 − 1783).
(<a href="https://en.wiktionary.org/wiki/totient">Totient</a> comes from the Latin “tot”, which means “that many”.)
Since the computation of Euler’s totient function requires the prime factorization of the given input,
I’ve included it in the <a href="#tool-integer-factorization-trial-division">tool above</a>;
you just need to <a href="#tool-integer-factorization-trial-division&amp;totient=true">activate the “Totients” toggle</a>.</p>

<details open="">
  <summary id="eulers-theorem">
Euler’s theorem
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Euler%27s_theorem">Euler’s theorem</a>
is a generalization of <a href="#fermats-little-theorem">Fermat’s little theorem</a>:
For any coprime integers \(a\) and \(m\), we have that \(a^{\varphi(m)} =_m 1\).</p>

</details>

<details>
  <summary id="number-of-generators-in-cyclic-groups">
Number of generators in cyclic groups
</summary>

  <p>We <a href="#isomorphism-of-cyclic-groups">saw</a> that all <a href="#cyclic-groups">cyclic groups</a>
are <a href="#group-isomorphisms">isomorphic</a> to the <a href="#additive-groups">additive group</a> of the same order.
Any element \(A\) that is coprime with the modulus \(m\) generates the additive group
because \(mA\) is the first time you get a multiple of \(m\).
(If there was a smaller number \(n\) such that \(nA =_m 0\),
then the <a href="#least-common-multiple">least common multiple</a> of \(A\) and \(m\) would be smaller than \(mA\),
which means that their <a href="#greatest-common-divisor">greatest common divisor</a> would be larger than \(1\).)
As a consequence, the number of generators of any cyclic group \(\mathbb{G}\) is given by \(\varphi(|\mathbb{G}|)\).</p>

</details>

<details>
  <summary id="sum-of-eulers-totient-function-over-divisors">
Sum of Euler’s totient function over divisors
</summary>

  <p>As shown <a href="#all-subgroups-of-cyclic-groups-are-cyclic">earlier</a>,
all <a href="#subgroups">subgroups</a> of <a href="#cyclic-groups">cyclic groups</a> are cyclic,
and a unique subgroup exists for every <a href="#divisor">divisor</a> \(d\) of the <a href="#group-order">group’s order</a> \(n\).
Since subgroups are groups,
the cyclic subgroup of order \(d\) has <a href="#number-of-generators-in-cyclic-groups">\(\varphi(d)\) generators</a>.
This means that in a cyclic group of order \(n\),
there are exactly \(\varphi(d)\) elements of order \(d\) for every divisor \(d\) of \(n\).
According to <a href="#lagranges-theorem">Lagrange’s theorem</a>,
each of the \(n\) elements has an order which divides \(n\).
This implies that the sum of the <a href="#eulers-totient-function">Euler’s totient function</a>
of every divisor \(d\) of \(n\) equals \(n\):</p>

\[\sum_{d\ \mid\ n} \varphi(d) = n \textsf{, where } \varphi(1) = 1 \textsf{.}\]

  <p>If you <a href="#tool-table-additive-group-repetition&amp;totient=true">enable the “Totient” option</a>
in the <a href="#additive-group-repetition-table">repetition</a> <a href="#multiplicative-group-repetition-table">tables</a> above,
you see the output of the Euler’s totient function for every divisor of the group’s order in a separate row.
The sum of all the values in this row plus \(1\) for the <a href="#group-axioms">identity element</a>,
whose count is covered by the label \(\varphi(i)\), equals the number of elements in the group.
Please note that the value in the totient row matches the number of elements with the given order only if the group is cyclic.</p>

</details>

<h3 id="carmichaels-totient-function" data-toc-text="Carmichael&#39;s totient function">Carmichael’s totient function λ</h3>

<p>As mentioned <a href="#multiplicative-group-repetition-table">earlier</a>,
not all <a href="#multiplicative-groups">multiplicative groups</a> are <a href="#cyclic-groups">cyclic</a>.
We use the <a href="https://en.wikipedia.org/wiki/Lambda">Greek letter lambda</a>
to denote the function which returns the largest order among the elements of the group:
<!-- --> \(\lambda(m) = \max_{A \in \mathbb{Z}_m^\times} |A|\).
This is known as <a href="https://en.wikipedia.org/wiki/Carmichael_function">Carmichael’s (totient) function</a>,
named after <a href="https://en.wikipedia.org/wiki/Robert_Daniel_Carmichael">Robert Daniel Carmichael</a> (1879 − 1967).
We shall see shortly that for <a href="https://en.wikipedia.org/wiki/Prime_power">prime powers</a>,
its value can be computed as follows:</p>

\[\lambda(p^e) = \begin{cases}
\frac{1}{2}\varphi(p^e) = 2^{e-2} &amp;\text{if } p = 2 \text{ and } e &gt; 2 \text{,} \\
\varphi(p^e) = p^{e-1}(p - 1) &amp;\text{otherwise.}
\end{cases}\]

<p>For other integers, \(\mathbb{Z}_m^\times\) is a <a href="#composite-groups">composite group</a>,
and the <a href="#element-order">element order</a> in a <a href="#direct-product">direct product</a>
is the <a href="#least-common-multiple">least common multiple</a> of all groups:</p>

\[\lambda(p_1^{e_1} \cdot … \cdot p_l^{e_l})
= \operatorname{lcm}(\lambda(p_1^{e_1}), …, \lambda(p_l^{e_l}))\]

<p>Given my definition of Carmichael’s totient function as \(\lambda(m) = \max_{A \in \mathbb{Z}_m^\times} |A|\),
which is <a href="#exponent-of-a-multiplicative-group">different from but equivalent to</a> what you encounter elsewhere,
and the definition of <a href="#eulers-totient-function">Euler’s totient function</a> as \(\varphi(m) = |\mathbb{Z}_m^\times|\),
the multiplicative group \(\mathbb{Z}_m^\times\) is cyclic <a href="#if-and-only-if">if and only if</a> \(\lambda(m) = \varphi(m)\).
Given the above formulas, multiplicative groups are cyclic
if and only if the modulus \(m = 2\), \(4\), \(p^e\), or \(2p^e\)
for an odd prime \(p\) and a positive integer \(e\).
For higher powers of \(2\), \(\lambda(2^e) = \frac{1}{2}\varphi(2^e)\).
And since the result of Euler’s totient function is even for any prime power other than \(2^1\),
<!-- --> \(\operatorname{gcd}(\varphi(p_1^{e_1}), \varphi(p_2^{e_2})) ≥ 2\)
and thus \(\operatorname{lcm}(\varphi(p_1^{e_1}), \varphi(p_2^{e_2})) &lt; \varphi(p_1^{e_1}) \cdot \varphi(p_2^{e_2})\).
This means that odd prime powers may be combined only with \(2\)
because a combination with any other prime power makes the group non-cyclic.
You can verify this for moduli up to 100 with the <a href="#multiplicative-group-repetition-table">repetition table tool</a>.
(This is why it displays the <a href="#prime-factorization">prime factorization</a> of the modulus at the top.)
You can compute Carmichael’s totient function of an integer
by <a href="#tool-integer-factorization-trial-division&amp;totient=true">enabling the “Totients” option</a>
of the <a href="#tool-integer-factorization-trial-division">factorization tool</a>.</p>

<p>The math required to understand the formula for \(\lambda(p^e)\) is a bit advanced,
which is why I cover it in several <a href="https://riskmusings.substack.com/#information-boxes">information boxes</a> below.
In fact, it was rather difficult to find a satisfying explanation online.
I adapted the following proof from <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>
starting on the pages 160 and 203.
You find an alternative approach <a href="https://pi.math.cornell.edu/~mathclub/Media/mult-grp-cyclic-az.pdf">here</a>.</p>

<details>
  <summary id="order-of-prime-power">
Order of prime power
</summary>

  <div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

    <p>For any element \(A\) of a group \(\mathbb{G}\),
if \(p^eA = O\) and \(p^{e-1}A ≠ O\) for some prime \(p\) and a positive integer \(e\),
then \(|A| = p^e\).
The reason for this is that whatever the <a href="#element-order">order</a> of \(A\) is,
it has to divide \(p^e\) given that \(p^eA = O\).
Only powers of \(p\) divide \(p^e\),
but the order of \(A\) cannot have a smaller exponent than \(e\) because \(p^{e-1}A ≠ O\).</p>

    <p>For any element \(A\) of a group \(\mathbb{G}\),
if \(A^{p^e} = I\) and \(A^{p^{e-1}} ≠ I\) for some prime \(p\) and a positive integer \(e\),
then \(|A| = p^e\).
The reason for this is that whatever the <a href="#element-order">order</a> of \(A\) is,
it has to divide \(p^e\) given that \(A^{p^e} = I\).
Only powers of \(p\) divide \(p^e\),
but the order of \(A\) cannot have a smaller exponent than \(e\) because \(A^{p^{e-1}} ≠ I\).</p>

  </div>

</details>

<details>
  <summary id="exponent-of-a-multiplicative-group">
Exponent of a multiplicative group
</summary>

  <p>The so-called exponent of the <a href="#finite-groups">multiplicative group</a> \(\mathbb{Z}_m^\times\)
is the smallest positive integer \(n\) so that \(A^n =_m 1\) for all elements \(A\) of the group.
Clearly, \(n\) divides the <a href="#group-order">order of the group</a>
and is a multiple of the <a href="#element-order">order of each element</a>, including the largest one.
In this box, we show that an element of order \(n\) exists,
which implies that \(\lambda(m) = n\) and \(A^{\lambda(m)} =_m 1\)
for any number \(A\) which is <a href="#multiset-of-prime-factors">coprime</a> with the modulus \(m\).
This is in fact how <a href="#carmichaels-totient-function">Carmichael’s totient function</a> is usually defined.
Since \(\lambda(m) ≤ \varphi(m)\) for any positive integer \(m\),
Carmichael’s totient function gives a tighter exponent than <a href="#eulers-totient-function">Euler’s totient function</a>
in <a href="#eulers-theorem">Euler’s theorem</a>.</p>

  <p>Let \(\prod_{i=1}^l p_i^{e_i}\) be the <a href="#prime-factorization">prime factorization</a> of the exponent \(n\).
For each \(i\) between (and including) \(1\) and \(l\),
there exists an element \(A_i \in \mathbb{Z}_m^\times\) so that \(A_i^{n/p_i} ≠_m 1\).
If no such \(A_i\) could be found for some \(i\), \(n/p_i\) would be an exponent smaller than \(n\)
which results in \(1\) for all elements of the group,
which would <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradict</a> the minimality of \(n\).
Given such an element \(A_i\) for each \(i\), the element \(A_i^{n/p_i^{e_i}}\) has order \(p_i^{e_i}\)
because \((A_i^{n/p_i^{e_i}})^{p_i^{e_i}} =_m A_i^n =_m 1\)
and \((A_i^{n/p_i^{e_i}})^{p_i^{e_i - 1}} =_m A_i^{n/p_i} ≠_m 1\)
(see the <a href="#order-of-prime-power">previous box</a>).
As all the prime powers of an integer factorization are coprime with one another,
the order of \(\prod_{i=1}^l A_i^{n/p_i^{e_i}}\) is \(n\)
according to an <a href="#order-when-combining-two-elements-of-coprime-orders">earlier theorem</a>.</p>

</details>

<details>
  <summary id="why-multiplicative-groups-modulo-a-prime-are-cyclic">
Why multiplicative groups modulo a prime are cyclic
</summary>

  <p>Let’s start with the simplest case: \(\mathbb{Z}_p^\times\) is <a href="#cyclic-groups">cyclic</a>
if \(p\) is <a href="#prime-factorization">prime</a>.
In order to prove this, we need math which we haven’t covered yet:</p>
  <ol>
    <li>\(\mathbb{Z}_p\) is a finite field over which <a href="https://en.wikipedia.org/wiki/Polynomial">polynomials</a> can be defined.
We’ll discuss finite fields <a href="#finite-fields">later in this article</a>.</li>
    <li>A <a href="https://en.wikipedia.org/wiki/Polynomial#constant_polynomial">non-constant</a>
<a href="https://en.wikipedia.org/wiki/Polynomial#univariate">single-variable</a>
polynomial of <a href="https://en.wikipedia.org/wiki/Degree_of_a_polynomial">degree</a> \(d\)
evaluates to \(0\) for at most \(d\) distinct inputs.
In other words, \(f(x) = \sum_{i=0}^d c_i x^i\)
with some <a href="https://en.wikipedia.org/wiki/Coefficient">coefficients</a>
<!-- --> \(c_0,\allowbreak …,\allowbreak c_d \in \mathbb{Z}_p\) where \(d &gt; 0\) and at least \(c_d ≠ 0\)
has at most \(d\) <a href="https://en.wikipedia.org/wiki/Zero_of_a_function">roots</a>.
Confusingly enough, this statement is also known
as <a href="https://en.wikipedia.org/wiki/Lagrange%27s_theorem_(number_theory)">Lagrange’s theorem</a>.
When formulated over the field of <a href="https://en.wikipedia.org/wiki/Complex_number">complex numbers</a>,
it is also known as the <a href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_algebra">fundamental theorem of algebra</a>.
We’ll prove it in the article about coding theory.</li>
  </ol>

  <p>We learned in the <a href="#exponent-of-a-multiplicative-group">previous box</a>
that \(A^{\lambda(p)} =_p 1\) for all elements \(A\) of \(\mathbb{Z}_p^\times\).
This means that the polynomial \(f(X) =_p X^{\lambda(p)} - 1\) evaluates to \(0\)
for all \(\varphi(p) = p - 1\) elements of \(\mathbb{Z}_p^\times\).
Since a polynomial of degree \(\lambda(p)\) over a field can have at most \(\lambda(p)\) roots,
<!-- --> \(\lambda(p)\) cannot be smaller than \(\varphi(p)\).
Therefore, \(\lambda(p) = \varphi(p)\).
Please note that this argument works only for fields (i.e. if the modulus is prime).
In \(\mathbb{Z}_{24}\), for example, \(X^2 - 1 =_{24} 0\) has
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=24&amp;coprime=true&amp;repeat=false&amp;order=false&amp;totient=false">8 solutions</a>.</p>

  <p>Even though we know that \(\mathbb{Z}_p^\times\) is cyclic for any prime \(p\)
and that it has <a href="#number-of-generators-in-cyclic-groups">\(\varphi(p - 1)\) generators</a>,
no formula is known for finding a <a href="#group-generators">generator</a> without searching.
We’ll discuss how to find a generator for a <a href="#multiplicative-groups">multiplicative group</a>
in the <a href="#search-for-a-group-generator">last section</a> of this chapter.</p>

  <p>Since \(\mathbb{Z}_{p^e}\) is not a field for any integer \(e &gt; 1\), we
<a href="#binomial-coefficients-and-binomial-the-theorem">need</a>
<a href="#binomial-coefficients-of-a-prime-are-multiples-of-the-prime">four</a>
<a href="#congruence-after-exponentiation-modulo-a-prime-power">additional</a>
<a href="#congruence-of-1-plus-prime-power-after-exponentiation">facts</a>
to prove that \(\mathbb{Z}_{p^e}^\times\) is cyclic for any odd prime \(p\).</p>

</details>

<details>
  <summary id="binomial-coefficients-and-binomial-the-theorem">
Binomial coefficients and the binomial theorem
</summary>

  <p>Since multiplication <a href="https://en.wikipedia.org/wiki/Distributive_property">distributes</a> over addition,
<!-- --> \((a + b)(c + d) = a(c + d) + b(c + d) = ac + ad + bc + bd\).
This means that you add up all possible combinations
of a term from the first expression with a term from the second expression.
If the two expressions are the same, you get some combinations several times:
<!-- --> \((a + b)^2 = (a + b)(a + b) = aa + ab + ba + bb = a^2 + 2ab + b^2\).
The same is true for powers greater than \(2\).
For \((a + b)^n\), every combination consists of \(n\) instead of \(2\) terms.
How many times do we get the combination \(a^ib^{n-i}\) for some integer \(i\) between \(0\) and \(n\)
when we expand \((a + b)^n\)?
The first \(a\) can be chosen from any of the \(n\) expressions,
the second \(a\) from any of the remaining \(n - 1\) expressions,
and so on until you have \(n - i + 1\) options left for the \(i\)<sup>th</sup> \(a\).
Since we don’t care about the order in which we picked the \(a\)s in a specific combination of \(a\)s and \(b\)s,
we have to divide the integer that we obtained so far by the number of ways in which \(i\) \(a\)s can be ordered.
The first \(a\) can be any of the \(i\) \(a\)s, the second \(a\) any of the remaining \(i - 1\) \(a\)s, and so on.
<!-- --> \(i \cdot (i - 1) \cdot … \cdot 2 \cdot 1\)
is the so-called <a href="https://en.wikipedia.org/wiki/Factorial">factorial</a> of \(i\),
which is usually written with an <a href="https://en.wikipedia.org/wiki/Exclamation_mark">exclamation mark</a> as \(i!\).
The number of ways in which you can pick \(i\) \(a\)s out of \(n\) expressions is:</p>

\[\binom{n}{i} = \frac{n (n-1) (n-2) … (n-i+1)}{i (i-1) (i-2) … 1} = \frac{n!}{i!\,(n-i)!}
\quad \text{for } 0 ≤ i ≤ n\]

  <p>This is known as the <a href="https://en.wikipedia.org/wiki/Binomial_coefficient">binomial coefficient</a>,
which is often written as the two numbers above each other in
<a href="https://en.wikipedia.org/wiki/Bracket#Parentheses">parentheses</a>.
Since no choice is left for the \(n - i\) \(b\)s, we don’t need to account for them.
Instead of choosing the \(i\) \(a\)s, we could choose the \(n - i\) \(b\)s, though,
which would give us the same result as \(\binom{n}{i} = \binom{n}{n - i}\).
Putting everything together, we get the <a href="https://en.wikipedia.org/wiki/Binomial_theorem">binomial theorem</a>:</p>

\[(a + b)^n = \sum_{i=0}^n \binom{n}{i} a^ib^{n-i}\]

</details>

<details>
  <summary id="binomial-coefficients-of-a-prime-are-multiples-of-the-prime">
Binomial coefficients of a prime are multiples of the prime
</summary>

  <p><a href="https://proofwiki.org/wiki/Binomial_Coefficient_of_Prime">\(\binom{p}{i} =_p 0\)</a>
for any <a href="#prime-factorization">prime</a> \(p\) and any integer \(i\) strictly between \(0\) and \(p\) (i.e. \(0 &lt; i &lt; p\)).
Since \(\binom{p}{i}\) must be an integer <a href="#binomial-coefficients-and-binomial-the-theorem">given what it counts</a>,
<!-- --> \(i!\) divides \(p (p-1) (p-2) … (p-i+1)\).
Since \(p\) is prime and all the factors in \(i!\) are smaller than \(p\),
<!-- --> \(\operatorname{\href{#greatest-common-divisor}{gcd}}(p, i!) = 1\).
By <a href="#euclids-lemma">Euclid’s lemma</a>, \(i!\) then has to divide \((p-1) (p-2) … (p-i+1)\).
Therefore, \(\binom{p}{i} = \frac{(p-1) (p-2) … (p-i+1)}{i!} \cdot p\).</p>

</details>

<details>
  <summary id="congruence-after-exponentiation-modulo-a-prime-power">
Congruence after exponentiation modulo a prime power
</summary>

  <p>Given a prime \(p\) and a positive integer \(e\),
<!-- --> \(a =_{p^e} b\) implies \(a^p =_{p^{e+1}} b^p\) for any integers \(a\) and \(b\).</p>

  <p>Proof: \(a =_{p^e} b\) means that \(a = b + cp^e\) for some integer \(c\).
Thus, \(a^p = (b + cp^e)^p = b^p + pb^{p-1}cp^e + dp^{2e}\) for some integer \(d\).
(See the <a href="#binomial-coefficients-and-binomial-the-theorem">binomial theorem</a> if you struggle with this expansion.)
As a consequence, \(a^p\) equals \(b^p\) up to some multiple of \(p^{e+1}\).</p>

</details>

<details>
  <summary id="congruence-of-1-plus-prime-power-after-exponentiation">
Congruence of 1 plus prime power after exponentiation
</summary>

  <p>Given a prime \(p\) and a positive integer \(e\) with \(p^e &gt; 2\),
<!-- --> \(a =_{p^{e+1}} 1 + p^e\) implies \(a^p =_{p^{e+2}} 1 + p^{e+1}\) for any integers \(a\) and \(b\).</p>

  <p>Proof: According to the <a href="#congruence-after-exponentiation-modulo-a-prime-power">previous box</a>,
<!-- --> \(a =_{p^{e+1}} 1 + p^e\) implies \(a^p =_{p^{e+2}} (1 + p^e)^p\).
Using the <a href="#binomial-coefficients-and-binomial-the-theorem">binomial theorem</a>, we get:</p>

\[(1 + p^e)^p
= \sum_{i=0}^p \binom{p}{i} (p^e)^i
= 1 + p \cdot p^e + \Big( \sum_{i=2}^{p-1} \binom{p}{i} p^{ei} \Big) + p^{ep}\]

  <p>Since \(\binom{p}{i}\) is <a href="#binomial-coefficients-of-a-prime-are-multiples-of-the-prime">divisible by \(p\)</a>
for \(0 &lt; i &lt; p\), \(\binom{p}{i} p^{ei}\) is divisible by \(p^{1+2e}\) for \(2 ≤ i &lt; p\).
Since \(1 + 2e ≥ e + 2\) for all \(e ≥ 1\), we can ignore the terms of the second sum
when computing <a href="#modulo-operation">modulo</a> \(p^{e+2}\).
By the requirement that \(p^e &gt; 2\), either \(p ≥ 3\) or \(e ≥ 2\).
In both cases, \(ep ≥ e + 2\).
Therefore, we can ignore \(p^{ep}\) as well,
which leaves us with \((1 + p^e)^p =_{p^{e+2}} 1 + p^{e+1}\).</p>

</details>

<details>
  <summary id="why-multiplicative-groups-modulo-a-power-of-an-odd-prime-are-cyclic">
Why multiplicative groups modulo a power of an odd prime are cyclic
</summary>

  <p>In this box, we want to show that \(\mathbb{Z}_{p^e}^\times\) is <a href="#cyclic-groups">cyclic</a>
for any odd prime \(p\) and any integer \(e &gt; 1\).
We learned <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">earlier</a> that \(\mathbb{Z}_p^\times\) is cyclic.
Let \(G\) be a <a href="#group-generators">generator</a> of \(\mathbb{Z}_p^\times\)
and \(n\) be the <a href="#element-order">order</a> of \(G\) in \(\mathbb{Z}_{p^e}^\times\).
Since \(G^n =_{p^e} 1\), \(G^n =_p 1\).
(If \(G^n - 1\) is a multiple of \(p^e\), it is also a multiple of \(p\) because \(p^e\) is a multiple of \(p\).)
Therefore, \(n\) has to be a multiple of \(p - 1\), which is the <a href="#group-order">order</a> of \(\mathbb{Z}_p^\times\).
Since \(n\) is the smallest positive integer so that \(G^n =_{p^e} 1\),
<!-- --> \(G^{n/(p-1)}\) has an order of \(p - 1\) in \(\mathbb{Z}_{p^e}^\times\).
If we find an element \(H\) with an order of \(p^{e-1}\) in \(\mathbb{Z}_{p^e}^\times\),
then \(H \cdot G^{n/(p-1)}\) has an order of \(p^{e-1} (p - 1) = \varphi(p^e)\)
according to an <a href="#order-when-combining-two-elements-of-coprime-orders">earlier theorem</a>.</p>

  <p>We now show that \(H = 1 + p\) has an order of \(p^{e-1}\) in \(\mathbb{Z}_{p^e}^\times\).
According to the <a href="#congruence-of-1-plus-prime-power-after-exponentiation">previous box</a>,
<!-- --> \(H =_{p^2} 1 + p\) implies \(H^p =_{p^3} 1 + p^2\).
If \(e &gt; 2\), \(p^e\) is a multiple of \(p^3\), and thus \(H^p ≠_{p^e} 1\).
When we raise \(H^p\) to the power of \(p\) again, we get \(H^{p^2} =_{p^4} 1 + p^3\).
This continues until \(H^{p^{e-1}} =_{p^{e+1}} 1 + p^e =_{p^e} 1\).
Since this is the first time that we reach the identity element,
the order of \(H\) is \(p^{e-1}\).</p>

</details>

<details>
  <summary id="why-multiplicative-groups-modulo-a-power-of-2-greater-than-4-are-not-cyclic">
Why multiplicative groups modulo a power of 2 greater than 4 are not cyclic
</summary>

  <p>You can use the <a href="#multiplicative-group-repetition-table">repetition table</a> to verify
that <a href="#tool-table-multiplicative-group-repetition&amp;modulus=2&amp;coprime=true&amp;repeat=false">\(\mathbb{Z}_2^\times\)</a>
and <a href="#tool-table-multiplicative-group-repetition&amp;modulus=4&amp;coprime=true&amp;repeat=false">\(\mathbb{Z}_4^\times\)</a>
are <a href="#cyclic-groups">cyclic</a> and
that <a href="#tool-table-multiplicative-group-repetition&amp;modulus=8&amp;coprime=true&amp;repeat=false">\(\mathbb{Z}_8^\times\)</a>
has no <a href="#group-generators">generator</a>.
In this box, we first show that every element in \(\mathbb{Z}_{2^e}^\times\) for an integer \(e &gt; 2\)
has an <a href="#element-order">order</a>
of <a href="https://en.wikipedia.org/wiki/Carmichael_function#Extension_for_powers_of_two">at most \(2^{e - 2}\)</a>.
This is an upper bound for \(\lambda(2^e)\).
By showing that the element \(5\) has this order, we establish the same value as a lower bound,
which implies that \(\lambda(2^e) = 2^{e - 2}\) for \(e &gt; 2\).</p>

  <p>We first observe that all even integers have the factor \(2\) in common with powers of \(2\)
and that all odd integers are <a href="#multiset-of-prime-factors">coprime</a> with powers of \(2\).
Therefore, any element \(A \in \mathbb{Z}_{2^e}^\times\) can be written as \(A = 1 + 2b\) for some integer \(b\).
Using our <a href="#binomial-coefficients-and-binomial-the-theorem">algebraic skills</a>,
<!-- --> \(A^2 = (1 + 2b)^2 = 1 + 4b + 4b^2 = 1 + 4b(1 + b)\).
Since either \(b\) or \(1 + b\) is even, \(c = \frac{b(1 + b)}{2}\) is an integer.
Therefore, \(A^2 = 1 + 8c\).
For \(e = 3\), we have seen that \(A^{2^{e-2}} = 1 + 2^ec\),
which means that \(A^{2^{e-2}} =_{2^e} 1\).
By <a href="https://en.wikipedia.org/wiki/Mathematical_induction">induction</a>,
we show that this is also true for any \(e &gt; 3\):
<!-- --> \((A^{2^{e-2}})^2 = A^{2^{e-1}} = (1 + 2^ec)^2 = 1 + 2 \cdot 2^ec + 2^{2e}c^2 = 1 + 2^{e+1}(c + 2^{e-1}c^2)\),
which means that \(A^{2^{e-1}} =_{2^{e+1}} 1\).</p>

  <p>With the same argument as in the <a href="#why-multiplicative-groups-modulo-a-power-of-an-odd-prime-are-cyclic">previous box</a>,
we prove that the element \(5\) has an order of \(2^{e - 2}\) in \(\mathbb{Z}_{2^e}^\times\).
This time, though, we start with \(5 =_{2^3} 1 + 2^2\),
which means that we have \(H =_{p^3} 1 + p^2\) for \(p = 2\) before raising \(H\) to the power of \(p\) for the first time.
As a consequence, we lag one exponentiation behind when compared to the previous box,
which is why the order of \(5\) is \(2^{e-2}\) instead of \(2^{e-1}\).
Ignoring this and working it out again,
we get \(5^{2^i} =_{2^{3+i}} 1 + 2^{2+i}\) when squaring \(5\) \(i\) times
according to <a href="#congruence-of-1-plus-prime-power-after-exponentiation">this box</a>.
When \(i = e - 2\), we have \(5^{2^{e-2}} =_{2^{e+1}} 1 + 2^e =_{2^e} 1\).
When \(i = e - 3\), \(5^{2^{e-3}} =_{2^e} 1 + 2^{e-1} ≠_{2^e} 1\).
<a href="#order-of-prime-power">Therefore</a>, \(|5| = 2^{e-2}\).</p>

</details>

<h3 id="probabilistic-primality-tests">Probabilistic primality tests</h3>

<p>Let’s continue with something different: How do we know whether an integer is <a href="#prime-factorization">prime</a>?
For small integers, we can use <a href="#prime-factorization">trial division</a>:
Given an integer \(n\), you can simply try to divide \(n\) by all possible factors up to \(\sqrt{n}\).
If you find a factor, \(n\) is composite.
Otherwise, \(n\) is prime.
For large integers, trial division becomes infeasible
because it <a href="#computational-complexity-theory">scales</a> with the square root of \(n\).
Even though <a href="https://en.wikipedia.org/wiki/AKS_primality_test">a deterministic algorithm is known</a>
to determine in <a href="https://en.wikipedia.org/wiki/Time_complexity#Polynomial_time">polynomial time</a>
whether an integer is prime,
<a href="https://en.wikipedia.org/wiki/Primality_test#Probabilistic_tests">probabilistic primality tests</a>
are used in practice because they are much faster and much simpler.
Given an integer \(n\), probabilistic primality tests check whether a condition is true
for integers between \(1\) and \(n\).
If \(n\) is prime, the condition is true for all such integers.
If \(n\) is composite, the condition is still true for some integers between \(1\) and \(n\).
Such integers are called liars, and we denote the set of liars for the integer \(n\) as \(\mathbb{L}_n\).
Clearly, \(\mathbb{L}_n\) is a <a href="https://en.wikipedia.org/wiki/Subset">subset</a>
of the set of all positive integers below \(n\), which we write as \(\mathbb{Z}_n^{\cancel{0}}\).
We denote the <a href="https://en.wikipedia.org/wiki/Complement_(set_theory)#Relative_complement">relative complement</a>
of \(\mathbb{L}_n\) in \(\mathbb{Z}_n^{\cancel{0}}\) as \(\mathbb{W}_n = \mathbb{Z}_n^{\cancel{0}} \setminus \mathbb{L}_n\).
Its elements are so-called <a href="https://en.wikipedia.org/wiki/Witness_(mathematics)">witnesses</a> for the compositeness of \(n\).
If we choose a random \(A \in \mathbb{Z}_n^{\cancel{0}}\),
the probability that \(A\) is a liar is \(|\mathbb{L}_n| / |\mathbb{Z}_n^{\cancel{0}}|\).
When we repeat this \(t\) times, the probability that we select \(t\) liars
and therefore think that \(n\) is prime even though it isn’t is \((|\mathbb{L}_n| / |\mathbb{Z}_n^{\cancel{0}}|)^t\).
If \(|\mathbb{L}_n|\) is larger than the number of integers that can be tested,
a probabilistic primality test determines only the compositeness of \(n\) with certainty
(by finding a single witness \(W \in \mathbb{W}_n\)) but not its primality.
If \(|\mathbb{L}_n| / |\mathbb{Z}_n^{\cancel{0}}| &lt; 1\),
we can increase our confidence that \(n\) is prime to any degree below \(1\)
by repeating the test more often.
An integer which passes a probabilistic primality test
is called a <a href="https://en.wikipedia.org/wiki/Probable_prime">probable prime</a>,
which is in contrast to a <a href="https://en.wikipedia.org/wiki/Provable_prime">provable prime</a>,
whose primality has been established with certainty.
We’ll study two probabilistic primality tests:
The <a href="#fermat-primality-test">Fermat primality test</a>
and the superior and thus preferable <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>.</p>

<h3 id="fermat-primality-test">Fermat primality test</h3>

<p><a href="#fermats-little-theorem">Fermat’s little theorem</a> states that given a <a href="#prime-factorization">prime</a> \(n\),
<!-- --> \(A^{n-1} =_n 1\) for all \(A \in \mathbb{Z}_n^\times\).
This can be used as the condition for a <a href="#probabilistic-primality-tests">probabilistic primality test</a>,
which is known as the <a href="https://en.wikipedia.org/wiki/Fermat_primality_test">Fermat primality test</a>.
The problem with this test is that there are infinitely many composite integers for which the theorem holds as well.
These integers are called <a href="#carmichael-numbers">Carmichael numbers</a>.
While Carmichael numbers are <a href="#density-of-carmichael-numbers-and-prime-numbers">rare</a>,
they are common enough that you cannot ignore them,
especially in the adversarial context of cryptography.
If the given integer \(n\) is not a Carmichael number,
then at least half of all the elements in \(\mathbb{Z}_n^\times\) are <a href="#probabilistic-primality-tests">witnesses</a>,
which means that \(|\mathbb{L}_n^F| ≤ \frac{1}{2} |\mathbb{Z}_n^\times| &lt; \frac{n}{2}\).
(The \(F\) in \(\mathbb{L}_n^F\) indicates that we are talking about the <a href="#probabilistic-primality-tests">liars</a>
of the Fermat primality test.)
There are two ways to see why this is the case:</p>
<ul>
  <li><strong>Pairing</strong>: There is at least one witness \(W \in \mathbb{W}_n^F\) as \(n\) would be a Carmichael number otherwise.
Since \(\mathbb{Z}_n^\times\) is a <a href="#group-axioms">group</a>, \(W\) maps each liar \(L \in \mathbb{L}_n^F\)
to a <a href="#unique-result">distinct</a> witness: \((L \cdot W)^{n-1} =_n L^{n-1} \cdot W^{n-1} =_n W^{n-1} ≠_n 1\)
(\(L^{n-1} =_n 1\) by definition).
Thus \(|\mathbb{L}_n^F| ≤ |\mathbb{W}_n^F|\).</li>
  <li><strong>Subgroup</strong>: \(\mathbb{L}_n^F\) is a <a href="#subgroups">subgroup</a> of \(\mathbb{Z}_n^\times\)
because \(\mathbb{L}_n^F\) is not empty as \(1 \in \mathbb{L}_n^F\)
and \(\mathbb{L}_n^F\) is <a href="#group-axioms">closed</a>
as \((L_1 \cdot L_2)^{n-1} =_n L_1^{n-1} \cdot L_2^{n-1} =_n 1\) for all \(L_1, L_2 \in \mathbb{L}_n^F\).
By <a href="#lagranges-theorem">Lagrange’s theorem</a>, \(|\mathbb{L}_n^F| = \frac{1}{c} |\mathbb{Z}_n^\times|\)
for a \(c \in \mathbb{Z}_{&gt;0}\).
As \(n\) isn’t a Carmichael number, \(|\mathbb{L}_n^F| &lt; |\mathbb{Z}_n^\times|\) and \(c &gt; 1\).</li>
</ul>

<p>The following tool implements the Fermat primality test.
You can enter a comma-separated list of bases that you want to test the integer \(n\) with
and specify the number of rounds which shall be performed with randomly chosen bases.
See the boxes below for inputs on which the test fails with a high probability.
This is why you should not use the Fermat primality test alone in practice.</p>



<details>
  

  <ul>
    <li><strong>Input n</strong>: The input \(n\) has to be odd because the inputs are shared
with the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>,
which cannot handle even inputs.
(For even inputs, the base 2 is always a witness as we will see in the <a href="#carmichael-numbers">next box</a>.)</li>
    <li><strong>Seed</strong>: The bases as indicated by the “Rounds” slider
are derived <a href="https://en.wikipedia.org/wiki/Pseudorandomness">pseudo-randomly</a>
from the given <a href="https://en.wikipedia.org/wiki/Random_seed">seed</a>.
This allows you to <a href="https://riskmusings.substack.com/#interactive-tools">revisit earlier bases</a>
and <a href="https://riskmusings.substack.com/#sharing-of-values">share interesting outputs</a>.
Another benefit is that you get a new set of bases by changing the seed,
such as by clicking on the “Increment” button.
If you implement a <a href="#probabilistic-primality-tests">probabilistic primality test</a> yourself, there’s no reason
to use a <a href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator">pseudo-random number generator (<abbr title="Pseudo-Random Number Generator">PRNG</abbr>)</a> like I did.
In particular, using a known seed is <a href="https://eprint.iacr.org/2018/749.pdf">dangerous in an adversarial setting</a>.
(This <a href="https://en.wikipedia.org/wiki/Design_choice">design choice</a> also made it easy
to use the same set of bases in the <a href="#tool-integer-miller-rabin-primality-test">Miller-Rabin primality test tool</a> below.)</li>
    <li><strong>Abort</strong>: If you want to find liars for a particular input,
you don’t want the tool to stop after encountering a witness.
This is why the tool allows you to <a href="#tool-integer-miller-rabin-primality-test&amp;abort=false">disable the “Abort”</a>,
which you wouldn’t do if you care only about whether the input is <a href="#probabilistic-primality-tests">probably prime</a>.</li>
  </ul>

</details>

<details>
  <summary id="carmichael-numbers">
Carmichael numbers
</summary>

  <p>A <a href="#prime-factorization">composite integer</a> \(n\) is a <a href="https://en.wikipedia.org/wiki/Carmichael_number">Carmichael number</a>
<a href="#if-and-only-if">if and only if</a> <a href="#carmichaels-totient-function">Carmichael’s totient function \(\lambda(n)\)</a>
divides \(n - 1\).
If this is the case, then \(A^{n-1} =_n A^{\lambda(n) \cdot c} =_n 1^c =_n 1\)
for all \(A\) which are <a href="#multiset-of-prime-factors">coprime</a> with \(n\) and some integer \(c\).
These numbers are also named after
<a href="https://en.wikipedia.org/wiki/Robert_Daniel_Carmichael">Robert Daniel Carmichael</a> (1879 − 1967).
The <a href="#fermat-primality-test">Fermat primality test</a> fails for Carmichael numbers
only if all the chosen bases are coprime with the integer which is being tested.
If a base \(A\) is not coprime with the integer \(n\),
then \(A\) has <a href="#multiplicative-inverse-revisited">no multiplicative inverse</a>
and the closest you can get to a multiple of \(n\) is \(\operatorname{\href{#greatest-common-divisor}{gcd}}(A, n)\).
In other words, if \(\operatorname{gcd}(A, n) &gt; 1\), then \(A^{n-1} ≠_n 1\).
Thus, \(\mathbb{L}_n^F = \mathbb{Z}_n^\times\).
If you use the first dozen prime numbers as bases,
which the <a href="#tool-integer-fermat-primality-test">tool above</a> does by default,
the Fermat primality test fails only for 2 out of the first 33 Carmichael numbers
as given by <a href="https://oeis.org/A002997">this list</a> from the
<a href="https://en.wikipedia.org/wiki/On-Line_Encyclopedia_of_Integer_Sequences">On-Line Encyclopedia of Integer Sequences (<abbr title="On-Line Encyclopedia of Integer Sequences">OEIS</abbr>)</a>:
<a href="#tool-integer-fermat-primality-test&amp;input=252%27601&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37&amp;rounds=0">252’601</a> = <a href="#tool-integer-factorization-trial-division&amp;input=252%27601">41 · 61 · 101</a> and
<a href="#tool-integer-fermat-primality-test&amp;input=410%27041&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37&amp;rounds=0">410’041</a> = <a href="#tool-integer-factorization-trial-division&amp;input=410%27041">41 · 73 · 137</a>.
All the other numbers on the list have a factor smaller than 41.
As we will see in the <a href="#chernicks-carmichael-numbers">next box</a>,
there’s a simple formula to obtain Carmichael numbers which don’t have a small factor.</p>

</details>

<details>
  <summary id="chernicks-carmichael-numbers">
Chernick’s Carmichael numbers
</summary>

  <p>If you find an integer \(k\) so that \(6k + 1\), \(12k + 1\), and \(18k + 1\) are prime,
then \(n = (6k + 1)(12k + 1)(18k + 1)\) is a <a href="#carmichael-numbers">Carmichael number</a>
since \(\href{#carmichaels-totient-function}{\lambda}(n)
= \operatorname{\href{#least-common-multiple}{lcm}}(6k, 12k, 18k) = 36k\)
divides \(n - 1 = 1296k^3 + 396k^2 + 36k\).
(\(1296 / 36 = 36\) and \(396 / 36 = 11\).)
The small subset of Carmichael numbers which are of this form are called
<a href="https://en.wikipedia.org/wiki/Carmichael_number#Discovery">Chernick’s Carmichael numbers</a>,
named after Jack Chernick (1911 − 1971), who lacks an entry on Wikipedia.
As we learned in the <a href="#carmichael-numbers">previous box</a>,
the <a href="#fermat-primality-test">Fermat primality test</a> detects the compositeness of a Carmichael number
only if one of the chosen bases is a multiple of one of its prime factors.
The Fermat primality test is thus only slightly better
than <a href="#prime-factorization">trial division</a> in the case of Carmichael numbers.
The likelihood that a random base is a <a href="#probabilistic-primality-tests">liar</a>,
and we thus fail to detect the compositeness of the Carmichael number \(n\) in a particular round,
is \(\frac{|\mathbb{L}_n^F|}{|\mathbb{Z}_n^{\cancel{0}}|}
= \frac{\href{#eulers-totient-function}{\varphi}(n)}{n-1}\).</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>k</th>
          <th>Carmichael number</th>
          <th>Prime factorization</th>
          <th>Failure rate per round</th>
          <th>Failure rate after 100 rounds</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=1%27729&amp;bases=&amp;rounds=100">1’729</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=1%27729">7 · 13 · 19</a></td>
          <td>0.7500</td>
          <td>0.0000</td>
        </tr>
        <tr>
          <td>6</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=294%27409&amp;bases=&amp;rounds=100">294’409</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=294%27409">37 · 73 · 109</a></td>
          <td>0.9508</td>
          <td>0.0065</td>
        </tr>
        <tr>
          <td>35</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=56%27052%27361&amp;bases=&amp;rounds=100">56’052’361</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=56%27052%27361">211 · 421 · 631</a></td>
          <td>0.9913</td>
          <td>0.4183</td>
        </tr>
        <tr>
          <td>45</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=118%27901%27521&amp;bases=&amp;rounds=100">118’901’521</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=118%27901%27521">271 · 541 · 811</a></td>
          <td>0.9932</td>
          <td>0.5076</td>
        </tr>
        <tr>
          <td>51</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=172%27947%27529&amp;bases=&amp;rounds=100">172’947’529</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=172%27947%27529">307 · 613 · 919</a></td>
          <td>0.9940</td>
          <td>0.5497</td>
        </tr>
        <tr>
          <td>55</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=216%27821%27881&amp;bases=&amp;rounds=100">216’821’881</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=216%27821%27881">331 · 661 · 991</a></td>
          <td>0.9945</td>
          <td>0.5741</td>
        </tr>
        <tr>
          <td>56</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=228%27842%27209&amp;bases=&amp;rounds=100">228’842’209</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=228%27842%27209">337 · 673 · 1’009</a></td>
          <td>0.9946</td>
          <td>0.5798</td>
        </tr>
        <tr>
          <td>100</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=1%27299%27963%27601&amp;bases=&amp;rounds=100">1’299’963’601</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=1%27299%27963%27601">601 · 1’201 · 1’801</a></td>
          <td>0.9970</td>
          <td>0.7369</td>
        </tr>
        <tr>
          <td>…</td>
          <td>…</td>
          <td>…</td>
          <td>…</td>
          <td>…</td>
        </tr>
        <tr>
          <td>511</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=173%27032%27371%27289&amp;bases=&amp;rounds=100">173’032’371’289</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=173%27032%27371%27289">3’067 · 6’133 · 9’199</a></td>
          <td>0.9994</td>
          <td>0.9420</td>
        </tr>
        <tr>
          <td>710</td>
          <td><a href="#tool-integer-fermat-primality-test&amp;input=464%27052%27305%27161&amp;bases=&amp;rounds=100">464’052’305’161</a></td>
          <td><a href="#tool-integer-factorization-trial-division&amp;input=464%27052%27305%27161">4’261 · 8’521 · 12’781</a></td>
          <td>0.9996</td>
          <td>0.9579</td>
        </tr>
      </tbody>
    </table>

    <figcaption>

The first Chernick’s Carmichael numbers according to <a href="https://oeis.org/A033502">this list</a> from the
<a href="https://en.wikipedia.org/wiki/On-Line_Encyclopedia_of_Integer_Sequences">On-Line Encyclopedia of Integer Sequences (<abbr title="On-Line Encyclopedia of Integer Sequences">OEIS</abbr>)</a>.

</figcaption>
  </figure>

</details>

<details>
  <summary id="carmichael-numbers-are-a-product-of-at-least-three-distinct-primes">
Carmichael numbers are a product of at least three distinct primes
</summary>

  <p>It is no coincidence that <a href="#chernicks-carmichael-numbers">Chernick’s formula for Carmichael numbers</a>
is a product of three prime numbers.
In this box we’ll show that every <a href="#carmichael-numbers">Carmichael number</a>
is a product of at least three distinct primes.
Let \(n = p_1^{e_1} \cdot … \cdot p_l^{e_l}\)
be the <a href="#prime-factorization">prime factorization</a> of an arbitrary Carmichael number.
This factorization has the following four properties
(see page 308 in <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>):</p>
  <ol>
    <li>\(n\) is odd, i.e. \(p_i ≠ 2\) for all \(i \in \{1, …, l\}\):
If \(n\) was even, \(n - 1\) would be odd
and the coprime element \(-1 =_n n - 1\) would be a <a href="#probabilistic-primality-tests">witness</a>
because \(-1^d =_n -1 ≠_n 1\) for any odd integer \(d\).
Since \(n\) is a Carmichael number, this cannot be the case.</li>
    <li>\(e_i = 1\) for every \(i \in \{1, …, l\}\):
The <a href="#composite-groups">composite group</a> \(\mathbb{Z}_n^\times\) is <a href="#group-isomorphisms">isomorphic</a>
to the <a href="#direct-product">direct product</a> of \(\mathbb{Z}_{p_1^{e_1}}^\times, …, \mathbb{Z}_{p_l^{e_l}}^\times\).
Since \(n\) is a Carmichael number, \(A^{n-1} =_n 1\) for every \(A \in \mathbb{Z}_n^\times\).
Since the isomorphism maps \(1 \in \mathbb{Z}_n^\times\)
to \((1, …, 1) \in \mathbb{Z}_{p_1^{e_1}}^\times \times … \times \mathbb{Z}_{p_l^{e_l}}^\times\),
it has to be the case that \(A^{n-1} =_{p_i^{e_i}} 1\) for every \(A \in \mathbb{Z}_{p_i^{e_i}}^\times\).
Since \(p_i\) is odd according to the previous point,
<a href="#why-multiplicative-groups-modulo-a-power-of-an-odd-prime-are-cyclic">\(\mathbb{Z}_{p_i^{e_i}}^\times\) is cyclic</a>
and thus \(n - 1\) has to be a multiple of \(|\mathbb{Z}_{p_i^{e_i}}^\times|
= \href{#eulers-totient-function}{\varphi}(p_i^{e_i}) = p_i^{e_i-1} (p_i - 1)\).
With \(e_i &gt; 1\), \(p_i^{e_i-1} (p_i - 1)\) would be a multiple of \(p_i\)
and thus \(n - 1\) would also be a multiple of \(p_i\).
However, given that \(p_i\) is a factor of \(n\), \(e_i\) has to be \(1\)
because \(n\) and \(n - 1\) cannot both be multiples of \(p_i\).</li>
    <li>\(p_i - 1\) divides \(n - 1\) for all \(i \in \{1, …, l\}\):
I explained in the previous point why \(n - 1\) has to be a multiple of \(p_i^{e_i-1} (p_i - 1)\).
Now that we know that \(e_i = 1\), it follows that \(n - 1\) is a multiple of \(p_i - 1\).</li>
    <li>\(l ≥ 3\): By definition, \(n\) has to be composite and thus \(l &gt; 1\).
Suppose \(l = 2\), which means that \(n\) is the product of two primes.
According to the previous point, \(p_1 - 1\) divides \(n - 1\).
Given that \(n - 1 = p_1 p_2 - 1 = (p_1 - 1) p_2 + (p_2 - 1)\),
<!-- --> \(p_1 - 1\) has to divide \(p_2 - 1\).
(\(a \cdot b + c\) can be a multiple of \(a\) only if \(c\) is a multiple of \(a\).)
By a symmetric argument, \(p_2 - 1\) has to divide \(p_1 - 1\).
However, two integers can be multiples of each other only if they are the same.
Since our notation for the prime factorization requires the factors to be distinct,
<!-- --> \(p_1\) cannot equal \(p_2\).
Hence, \(n\) is the product of at least three distinct primes.</li>
  </ol>

  <p>The second and the third point are <a href="https://en.wikipedia.org/wiki/Necessity_and_sufficiency#Sufficiency">sufficient</a>
for \(n\) to be a Carmichael number because they ensure
that \(\href{#carmichaels-totient-function}{\lambda}(n)\) divides \(n - 1\)
as required by <a href="#carmichael-numbers">our definition</a>.
This is known as <a href="https://en.wikipedia.org/wiki/Carmichael_number#Korselt&#39;s_criterion">Korselt’s criterion</a>,
named after <a href="https://en.wikipedia.org/wiki/Alwin_Korselt">Alwin Reinhold Korselt</a> (1864 − 1947).</p>

</details>

<details>
  <summary id="density-of-carmichael-numbers-and-prime-numbers">
Density of Carmichael numbers and prime numbers
</summary>

  <p>For a sufficiently large integer \(x\),
there are <a href="https://en.wikipedia.org/wiki/Carmichael_number#Distribution">at least \(x^{1/3}\)</a>
<a href="#carmichael-numbers">Carmichael numbers</a> smaller than \(x\).
On the other hand, the number of primes smaller than \(x\) is
<a href="https://en.wikipedia.org/wiki/Prime-counting_function">approximately \(\frac{x}{\log_\mathrm{e}(x)}\)</a>,
where \(\log_\mathrm{e}(x)\) is the <a href="https://en.wikipedia.org/wiki/Natural_logarithm">natural logarithm</a> of \(x\).
To give you an idea for how much rarer Carmichael numbers are than prime numbers:
There are 2’220’819’602’560’918’840 ≈ 2 · 10<sup>18</sup> prime numbers
and only 8’220’777 ≈ 8 · 10<sup>6</sup> Carmichael numbers below 10<sup>20</sup>.</p>

</details>

<h3 id="miller-rabin-primality-test">Miller-Rabin primality test</h3>

<p>We can improve upon the <a href="#fermat-primality-test">Fermat primality test</a> by making the condition in our test stricter:
When testing whether an integer \(n\) is <a href="#probabilistic-primality-tests">probably prime</a>,
we can require that whenever you reach \(1\) <a href="#modulo-operation">modulo</a> \(n\)
by <a href="https://en.wikipedia.org/wiki/Square_(algebra)">squaring</a> some number,
the number must be either \(1\) or \(-1\).
Given our extensive toolkit, we have three ways to see why \(1\) and \(-1\)
are the only possible <a href="https://en.wikipedia.org/wiki/Square_root">square roots</a> of \(1\) in \(\mathbb{Z}_n^\times\)
if \(n\) is <a href="#prime-factorization">prime</a>:</p>
<ul>
  <li><strong>Euclid’s lemma</strong>:
We want to find the possible solutions for \(x\) in \(x^2 =_n 1\).
By taking the \(1\) to the left side, we get \(x^2 - 1 =_n 0\),
which we can refactor into \((x - 1)(x + 1) =_n 0\).
Since the product of \(x - 1\) and \(x + 1\) is a multiple of the prime \(n\),
<!-- --> \(x - 1\) or \(x + 1\) has to be a multiple of \(n\) according to <a href="#euclids-lemma">Euclid’s lemma</a>.
If \(x - 1\) is a multiple of \(n\), then \(x =_n 1\).
If not, then \(x\) has to equal \(-1\).</li>
  <li><strong>Cyclic group</strong>:
Since \(n\) is prime, <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">\(\mathbb{Z}_n^\times\) is cyclic</a>.
As I argued <a href="#multiplicative-group-repetition-table">earlier</a>,
there can be only a single element half-way through the cycle.</li>
  <li><strong>Polynomial</strong>:
Even though this is not officially part of our toolkit yet,
I mentioned <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">earlier</a>
that \(\mathbb{Z}_n\) is a <a href="#finite-fields">finite field</a> if \(n\) is prime
and that a <a href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a> over a field
can have no more <a href="https://en.wikipedia.org/wiki/Zero_of_a_function">roots</a>
than its <a href="https://en.wikipedia.org/wiki/Degree_of_a_polynomial">degree</a>.
Therefore, the polynomial \(f(x) = x^2 - 1\) can evaluate to \(0\) for at most two distinct \(x\),
which are \(1\) and \(-1\).</li>
</ul>

<p>After checking that \(n\) is odd, we know that \(n - 1\) is even.
(If you want to be able to handle the case where \(n = 2\), you have to handle it explicitly
with a separate <a href="https://en.wikipedia.org/wiki/Conditional_(computer_programming)">conditional</a>.)
Since \(A^{n-1} =_n 1\) for all \(A \in \mathbb{Z}_n^\times\) by <a href="#fermats-little-theorem">Fermat’s little theorem</a>,
<!-- --> \(A^{\frac{n-1}{2}}\) has to equal either \(1\) or \(-1\) up to a multiple of \(n\) if \(n\) is prime.
If this is not the case, we know for sure that \(n\) is composite.
If \(A^{\frac{n-1}{2}} =_n 1\) and \(\frac{n-1}{2}\) is still even,
we can continue the process with \(A^{\frac{n-1}{4}}\) and so on.
Instead of calculating such large exponentiations repeatedly,
we write \(n - 1\) as \(2^cd\) with an integer \(c ≥ 1\) and an odd integer \(d\).
For some base \(A\), we calculate \(A^d \text{ \href{#modulo-operation}{mod} } n\).
If the result is \(1\), we can continue with the next base because the result will remain \(1\)
when we square it repeatedly until we arrive at \((A^d)^{2^c} =_n A^{n-1} =_n 1\).
If the result is \(-1\), we can also continue with the next base because we get \(1\) after squaring the result once.
For any other result, we square the result and check what we have then.
If the new result is \(1\), we know that \(n\) is composite
because the previous result was neither \(1\) nor \(-1\).
If the new result is \(-1\), we can continue with the next base
because we’re certain that \(A^{n-1}\) will be \(1\).
If necessary, we square the first result (i.e. \(A^d\)) \(c - 1\) times.
If we still haven’t got \(-1\) at this point, we know that \(n\) is composite
because even if we would get \(1\) at \(A^{n-1}\) when squaring \(A^{\frac{n-1}{2}}\) one more time,
we would arrive from a number other than \(-1\) or \(1\).</p>

<p>This <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> is known as the
<a href="https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin primality test</a>,
named after <a href="https://en.wikipedia.org/wiki/Gary_Miller_(computer_scientist)">Gary Lee Miller</a>
(I couldn’t figure out when this gentleman was born)
and <a href="https://en.wikipedia.org/wiki/Michael_O._Rabin">Michael Oser Rabin</a> (born in 1931).
As for any <a href="#probabilistic-primality-tests">probabilistic primality test</a>, liars still exist.
(If there were no liars, the test wouldn’t be probabilistic and we wouldn’t have to check more than a single base.)
Unlike the <a href="#fermat-primality-test">Fermat primality test</a>, however,
<!-- --> \(|\mathbb{L}_n^{MR}| / |\mathbb{Z}_n^{\cancel{0}}| ≤ 4\) for any odd composite \(n\)
as we will <a href="#power-function-and-its-preimage">prove</a> <a href="#monier-rabin-bound-on-the-number-of-liars">below</a>.
Any Miller-Rabin liar is also a Fermat liar (i.e. \(\mathbb{L}_n^{MR} \subseteq \mathbb{L}_n^{F}\)),
so for any bases for which the Miller-Rabin primality test fails,
the Fermat primality test fails as well.
Since the Miller-Rabin primality test doesn’t struggle with <a href="#carmichael-numbers">Carmichael numbers</a>,
it is strictly preferable to the Fermat primality test, which isn’t even noticeably faster.</p>

<p>The following tool implements the Miller-Rabin primality test.
Its input is synchronized with the <a href="#tool-integer-fermat-primality-test">Fermat primality test above</a>
so that you can compare the outputs of the two tests.
(This is best done on <a href="https://riskmusings.substack.com/number-theory/tools/#fermat-primality-test">this separate page</a>,
which includes only the tools of this article.)
As \(1\) and \(n - 1\) are always liars,
this tool samples the random bases between these two values.
For this reason, the smallest integer that you can test is \(5\).
You can use the <a href="https://en.wikipedia.org/wiki/Arrow_keys">up and down arrows</a> on your keyboard to step through the odd inputs
when the <a href="https://en.wikipedia.org/wiki/Cursor_(user_interface)">cursor</a> is in the input field of the integer \(n\).
The tool displays \(-1\) only for your convenience.
If you calculate <a href="#modulo-operation">modulo \(n\)</a>, you get \(n - 1\), of course.</p>



<details>
  <summary id="small-prime-numbers-as-bases">
Small prime numbers as bases
</summary>

  <p>It turns out that the first \(l\) prime numbers form excellent bases
for the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>:</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>l</th>
          <th>Bases</th>
          <th>Smallest composite integer for which the test fails</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2">2</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=2%27047&amp;bases=2&amp;rounds=0">2’047</a> &gt; 2<sup>10</sup></td>
        </tr>
        <tr>
          <td>2</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3">2, 3</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=1%27373%27653&amp;bases=2%2C+3&amp;rounds=0">1’373’653</a> &gt; 2<sup>20</sup></td>
        </tr>
        <tr>
          <td>3</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5">2, 3, 5</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=25%27326%27001&amp;bases=2%2C+3%2C+5&amp;rounds=0">25’326’001</a> &gt; 2<sup>24</sup></td>
        </tr>
        <tr>
          <td>4</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7">2, 3, 5, 7</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27215%27031%27751&amp;bases=2%2C+3%2C+5%2C+7&amp;rounds=0">3’215’031’751</a> &gt; 2<sup>31</sup></td>
        </tr>
        <tr>
          <td>5</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11">2, 3, 5, 7, 11</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=2%27152%27302%27898%27747&amp;bases=2%2C+3%2C+5%2C+7%2C+11&amp;rounds=0">2’152’302’898’747</a> &gt; 2<sup>40</sup></td>
        </tr>
        <tr>
          <td>6</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13">2, 3, 5, 7, 11, 13</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27474%27749%27660%27383&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13&amp;rounds=0">3’474’749’660’383</a> &gt; 2<sup>41</sup></td>
        </tr>
        <tr>
          <td>7</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17">2, 3, 5, 7, 11, 13, 17</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=341%27550%27071%27728%27321&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17&amp;rounds=0">341’550’071’728’321</a> &gt; 2<sup>48</sup></td>
        </tr>
        <tr>
          <td>8</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19">2, 3, 5, 7, 11, 13, 17, 19</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=341%27550%27071%27728%27321&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19&amp;rounds=0">341’550’071’728’321</a> &gt; 2<sup>48</sup></td>
        </tr>
        <tr>
          <td>9</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23">2, 3, 5, 7, 11, 13, 17, 19, 23</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27825%27123%27056%27546%27413%27051&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23&amp;rounds=0">3’825’123’056’546’413’051</a> &gt; 2<sup>61</sup></td>
        </tr>
        <tr>
          <td>10</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29">2, 3, 5, 7, 11, 13, 17, 19, 23, 29</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27825%27123%27056%27546%27413%27051&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29&amp;rounds=0">3’825’123’056’546’413’051</a> &gt; 2<sup>61</sup></td>
        </tr>
        <tr>
          <td>11</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31">2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27825%27123%27056%27546%27413%27051&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31&amp;rounds=0">3’825’123’056’546’413’051</a> &gt; 2<sup>61</sup></td>
        </tr>
        <tr>
          <td>12</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37">2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=318%27665%27857%27834%27031%27151%27167%27461&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37&amp;rounds=0">318’665’857’834’031’151’167’461</a> &gt; 2<sup>78</sup></td>
        </tr>
        <tr>
          <td>13</td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37%2C+41">2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41</a></td>
          <td><a href="#tool-integer-miller-rabin-primality-test&amp;input=3%27317%27044%27064%27679%27887%27385%27961%27981&amp;bases=2%2C+3%2C+5%2C+7%2C+11%2C+13%2C+17%2C+19%2C+23%2C+29%2C+31%2C+37%2C+41&amp;rounds=0">3’317’044’064’679’887’385’961’981</a> &gt; 2<sup>81</sup></td>
        </tr>
      </tbody>
    </table>

    <figcaption>

The smallest integers for which the first \(l\) prime numbers are not enough to detect their compositeness</figcaption>
  </figure>

</details>

<details>
  <summary id="power-function-and-its-preimage">
Power function and its preimage
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Function_(mathematics)">function</a> \(f_y(X) =_n X^y\)
computes the \(y\)<sup>th</sup> <a href="https://en.wikipedia.org/wiki/Exponentiation#Power_functions">power</a>
of any element \(X\) of the <a href="#multiplicative-groups">multiplicative group</a> \(\mathbb{Z}_n^\times\).
For any <a href="https://en.wikipedia.org/wiki/Subset">subset</a> \(\mathbb{S} \subseteq \mathbb{Z}_n^\times\),
we denote the so-called <a href="https://en.wikipedia.org/wiki/Image_(mathematics)#Inverse_image">preimage</a>
of \(\mathbb{S}\) under \(f_y\) as \(f_y^{-1}(\mathbb{S}) = \{X \in \mathbb{Z}_n^\times \mid f_y(X) \in \mathbb{S}\}\).
(As we will revisit <a href="#kernel">later</a>, \(f_y^{-1}(\{1\})\) is the so-called
<a href="https://en.wikipedia.org/wiki/Kernel_(algebra)">kernel</a> of \(f_y\).)
We need the following property in order to prove
the <a href="#monier-rabin-bound-on-the-number-of-liars">Monier-Rabin bound on the number of liars</a>:
If \(\mathbb{Z}_n^\times\) is <a href="#cyclic-groups">cyclic</a>, \(|f_y^{-1}(\{1\})|
= \operatorname{\href{#greatest-common-divisor}{gcd}}(y, \href{#eulers-totient-function}{\varphi}(n))\).
Proof: Let \(G\) be a <a href="#group-generators">generator</a> of the cyclic group,
then for any \(X \in \mathbb{Z}_n^\times\), there’s an integer \(x\) so that \(X =_n G^x\).
We want to determine the number of \(X \in \mathbb{Z}_n^\times\) for which \(X^y =_n (G^x)^y =_n 1\).
Now \(G^z\) can equal \(1\) only if \(z\) is a multiple of \(\lvert G \rvert = \varphi(n)\).
How many \(x \in \mathbb{Z}_{\varphi(n)}\) are there so that \(x \cdot y =_{\varphi(n)} 0\)?
As we saw <a href="#least-common-multiple-and-0">earlier</a>, the answer is \(\operatorname{gcd}(y, \varphi(n))\).</p>

</details>

<details>
  <summary id="monier-rabin-bound-on-the-number-of-liars">
Monier-Rabin bound on the number of liars
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Louis_Monier">Louis Monier</a> (born in 1956) and
<a href="https://en.wikipedia.org/wiki/Michael_O._Rabin">Michael Oser Rabin</a> (born in 1931) proved independently in 1980
that \(|\mathbb{L}_n^{MR}| / |\mathbb{Z}_n^{\cancel{0}}| ≤ 4\) for any odd composite integer \(n\).
As a consequence, the probability that an odd composite integer \(n\) is mislabeled
as a <a href="#probabilistic-primality-tests">probable prime</a> after \(t\) rounds
of the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a> with random bases is at most \((\frac{1}{4})^t\).
I adapted the following proof from page 309 of <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>.
You find similar approaches <a href="https://kconrad.math.uconn.edu/blurbs/ugradnumthy/millerrabin.pdf">here</a>
and <a href="https://www.cis.upenn.edu/~jean/RSA-primality-testing.pdf">here</a>
in case you cannot follow my explanations below.</p>

  <p>After checking that \(n\) is odd and aborting the Miller-Rabin primality test otherwise, there are two cases to consider:</p>
  <ol>
    <li>\(n = p^e\) for some odd prime \(p\) and an integer \(e &gt; 1\):
Since every Miller-Rabin liar is also a Fermat liar
(i.e. \(\mathbb{L}_n^{MR} \subseteq \mathbb{L}_n^{F}\)),
any upper bound on the latter also applies to the former
(i.e. if \(|\mathbb{L}_n^{F}| ≤ \frac{n-1}{4}\), then \(|\mathbb{L}_n^{MR}| ≤ \frac{n-1}{4}\)).
An element \(L \in \mathbb{Z}_n^\times\) is a Fermat liar <a href="#if-and-only-if">if and only if</a> \(L^{n-1} =_n 1\).
Since <a href="#why-multiplicative-groups-modulo-a-power-of-an-odd-prime-are-cyclic">multiplicative groups modulo a power of an odd prime are cyclic</a>,
there are \(|f_{n-1}^{-1}(\{1\})| \allowbreak
= \operatorname{\href{#greatest-common-divisor}{gcd}}(n - 1, \href{#eulers-totient-function}{\varphi}(n))\)
Fermat liars in \(\mathbb{Z}_n^\times\) according to the <a href="#power-function-and-its-preimage">previous box</a>.
Using the definitions of <a href="#eulers-totient-function">Euler’s totient function \(\varphi\)</a> and \(n\),
we get \(\operatorname{gcd}(p^e - 1, p^{e-1}(p - 1))\).
Clearly, \(p - 1\) divides \(p^{e-1}(p - 1)\).
Since \((p - 1) \sum_{i=0}^{e-1} p^i \allowbreak
= \big(\sum_{i=1}^e p^i\big) - \big(\sum_{i=0}^{e-1} p^i\big) \allowbreak = p^e - 1\),
<!-- --> \(p - 1\) divides also \(p^e - 1\).
(It’s obvious when putting it as \((m+1)^e =_m 1\) for \(m = p - 1\).)
Since \(\sum_{i=0}^{e-1} p^i\) is not a multiple of \(p\) (as it is one more than a multiple of \(p\)),
<!-- --> \(p - 1\) is the <a href="#greatest-common-divisor">greatest common divisor</a> of \(p^e - 1\) and \(p^{e-1}(p - 1)\).
Finally, \(p - 1 = (p^e - 1) / \big(\sum_{i=0}^{e-1} p^i\big) = \frac{n - 1}{p^{e-1} + … + 1} ≤ \frac{n-1}{4}\)
because \(p^{e-1} + 1 ≥ 4\) for any \(p ≥ 3\) and \(e ≥ 2\).
Thus, \(|\mathbb{L}_n^{F}| ≤ |\mathbb{Z}_n^{\cancel{0}}| / 4\).</li>
    <li>\(n = p_1^{e_1} \cdot … \cdot p_l^{e_l}\) for \(l &gt; 1\) distinct odd primes \(p_i\) and positive integers \(e_i\):
This case is more complicated because \(\mathbb{L}_n^{MR}\) is generally not closed under multiplication.
(<a href="#tool-integer-miller-rabin-primality-test&amp;input=65&amp;bases=8%2C+18%2C+14&amp;rounds=0">For example</a>,
<!-- --> \(8\) and \(18\) are liars for \(n = 65\),
but \(8 \cdot 18 =_{65} 14\) is a witness for the compositeness of \(n\).)
The <a href="#composite-groups">composite group</a> \(\mathbb{Z}_n^\times\) is <a href="#group-isomorphisms">isomorphic</a>
to the <a href="#direct-product">direct product</a> of \(\mathbb{Z}_{p_1^{e_1}}^\times, …, \mathbb{Z}_{p_l^{e_l}}^\times\).
Let \(n - 1 = 2^cd\) for an integer \(c ≥ 1\) and an odd integer \(d\).
Similarly, \(\varphi(p_i^{e_i}) = 2^{c_i}d_i\), where \(1 ≤ i ≤ l\) and \(d_i\) is odd.
We define \(a\) as the smallest integer in the set \(\{c, c_1, …, c_l\}\).
Since \(\varphi(p_i^{e_i})\) is even for any odd prime \(p_i\), \(a ≥ 1\).
Next, we’ll prove a series of statements:
      <ul>
        <li>\(L^{2^ad} =_n 1\) for all \(L \in \mathbb{L}_n^{MR}\).
If \(a = c\), this is the case because every Miller-Rabin liar is also a Fermat liar (i.e. \(L^{n-1} =_n 1\)).
If \(a &lt; c\), \(a = c_j\) for some index \(j\).
If \(L^{2^bd} ≠_n 1\) for some \(L \in \mathbb{L}_n^{MR}\), we must have \(L^{2^bd} =_n -1\)
for some \(b\) greater than or equal to \(a\) and smaller than \(c\)
because \(L\) wouldn’t be a Miller-Rabin liar otherwise.
If \(L^{2^bd} + 1\) is a multiple of \(n\), it is also a multiple of \(p_j^{e_j}\).
Therefore, \(L^{2^bd} =_n -1\) implies that \(L^{2^bd} =_{p_j^{e_j}} -1\).
Since \((L^d)^{2^b} =_{p_j^{e_j}} -1\) and \((L^d)^{2^{b+1}} =_{p_j^{e_j}} 1\),
the <a href="#element-order">order of \(L^d\)</a> is \(2^{b+1}\) in \(\mathbb{Z}_{p_j^{e_j}}^\times\)
according to an <a href="#order-of-prime-power">earlier theorem</a>.
However, the <a href="#group-order">order of \(\mathbb{Z}_{p_j^{e_j}}^\times\)</a> is \(2^{c_j}d_j\),
which means that \(|L^d|\) does not divide \(|\mathbb{Z}_{p_j^{e_j}}^\times|\) because \(b + 1 &gt; c_j\).
Since this is a <a href="#lagrange-consequences">contradiction</a>,
there is no liar \(L \in \mathbb{L}_n^{MR}\) for which \(L^{2^ad} ≠_n 1\).</li>
        <li>\(|\mathbb{L}_n^{MR}| ≤ 2 \cdot |f_{2^{a-1}d}^{-1}(\{1\})|\).
It follows from the previous point and the definition of a Millar-Rabin liar
that \(L^{2^{a-1}d} =_n ±1\) for all \(L \in \mathbb{L}_n^{MR}\).
Therefore, \(\mathbb{L}_n^{MR} \subseteq f_{2^{a-1}d}^{-1}(\{1\}) \cup f_{2^{a-1}d}^{-1}(\{-1\})\).
Let \(\{U_1, U_2, U_3, …, U_v\}\) denote all the elements of \(f_{2^{a-1}d}^{-1}(\{-1\})\).
Then \(f_{2^{a-1}d}^{-1}(\{1\})\) cannot be smaller than \(f_{2^{a-1}d}^{-1}(\{-1\})\) because it contains
at least the \(v\) elements \(\{U_1 \cdot U_1, U_1 \cdot U_2, U_1 \cdot U_3, …, U_1 \cdot U_v\}\).
These elements are distinct because all preimages belong to \(\mathbb{Z}_n^\times\)
and you get <a href="#unique-result">different results</a> when you combine the same element with different elements in a group.</li>
        <li>\(|f_y^{-1}(\{1\})| = \prod_{i=1}^{l} \operatorname{gcd}(y, 2^{c_i}d_i)\) for any positive integer \(y\).
Since \(\mathbb{Z}_n^\times \cong \mathbb{Z}_{p_1^{e_1}}^\times \times … \times \mathbb{Z}_{p_l^{e_l}}^\times\),
the number of elements in \(\mathbb{Z}_n^\times\) which map to \(1\) when being raised to the \(y\)<sup>th</sup> power
is given by the product of the number of elements which do the same in each of the groups
<!-- --> \(\mathbb{Z}_{p_1^{e_1}}^\times\) to \(\mathbb{Z}_{p_l^{e_l}}^\times\).
Since each \(\mathbb{Z}_{p_i^{e_i}}^\times\) is a <a href="#cyclic-groups">cyclic group</a>,
the formula from the <a href="#power-function-and-its-preimage">previous box</a> can be used.</li>
        <li>
          <!-- -->
          <p>\(|f_{2^ad}^{-1}(\{1\})| = 2^l \cdot |f_{2^{a-1}d}^{-1}(\{1\})|\).
According to the previous point, \(|f_{2^ad}^{-1}(\{1\})| = \prod_{i=1}^{l} \operatorname{gcd}(2^ad, 2^{c_i}d_i)\).
Since \(a ≥ 1\) and \(c_i ≥ a\) for \(i = 1, …, l\), \(|f_{2^ad}^{-1}(\{1\})|
= 2^l \cdot \prod_{i=1}^{l} \operatorname{gcd}(2^{a-1}d, 2^{c_i}d_i) = 2^l \cdot |f_{2^{a-1}d}^{-1}(\{1\})|\).
(This is the reason why \(a\) has to be smaller than or equal to each \(c_i\);
you wouldn’t be able to extract the factor \(2\) in each of the groups otherwise.)</p>
        </li>
        <li>
          <!-- -->
          <p>\(|f_{2^ad}^{-1}(\{1\})| ≤ |f_{2^cd}^{-1}(\{1\})|\)
because for any \(X \in \mathbb{Z}_n^\times\) for which \(X^{2^ad} =_n 1\),
<!-- --> \(X^{2^cd} =_n 1\) since \(c ≥ a\).</p>
        </li>
      </ul>

      <p>If follows from these statements that \(|\mathbb{L}_n^{MR}| ≤ 2^{-l + 1} \cdot |f_{n-1}^{-1}(\{1\})|\).
There are two cases to consider:</p>
      <ul>
        <li>
          <!-- -->
          <p>\(l ≥ 3\): This implies that \(|\mathbb{L}_n^{MR}| ≤ |f_{n-1}^{-1}(\{1\})| / 4\).
Since \(|f_{n-1}^{-1}(\{1\})| ≤ |\mathbb{Z}_n^\times|\), \(|\mathbb{L}_n^{MR}| ≤ |\mathbb{Z}_n^{\cancel{0}}| / 4\).</p>
        </li>
        <li>
          <!-- -->
          <p>\(l = 2\):
According to an <a href="#carmichael-numbers-are-a-product-of-at-least-three-distinct-primes">earlier theorem</a>,
<!-- --> \(n\) cannot be a <a href="#carmichael-numbers">Carmichael number</a>.</p>
        </li>
      </ul>
    </li>
  </ol>

</details>

<h3 id="sophie-germain-and-safe-primes">Sophie Germain and safe primes</h3>

<p>A prime number \(p\) is a <a href="https://en.wikipedia.org/wiki/Safe_and_Sophie_Germain_primes">Sophie Germain prime</a>,
named after <a href="https://en.wikipedia.org/wiki/Sophie_Germain">Marie-Sophie Germain</a> (1776 − 1831),
if \(q = 2p + 1\) is also prime.
A prime number \(q\) for which \(p = (q - 1) / 2\) is also prime
is called a <a href="https://en.wikipedia.org/wiki/Safe_and_Sophie_Germain_primes">safe prime</a>.
Safe primes are important in cryptography
because the difficulty of solving the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
is bounded by the largest prime factor of the <a href="#group-order">group’s order</a>
as we will see <a href="#pohlig-hellman-algorithm">later</a>.</p>

<figure>

  

  <figcaption>

The first ten Sophie Germain primes with their corresponding safe primes.

</figcaption>
</figure>

<h3 id="search-for-a-probable-prime">Search for a probable prime</h3>

<p>How do we find large prime numbers that we can use for cryptographic applications?
Since prime numbers are <a href="#expected-number-of-attempts">sufficiently dense</a>,
we can repeatedly check with the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>
whether a randomly generated integer of the desired length is a <a href="#probabilistic-primality-tests">probable prime</a>
until we find one.
The following tool implements this random search for a probable prime.
If you need a <a href="#sophie-germain-and-safe-primes">safe prime</a>,
the tool generates a random number \(p\) until both \(p\) and \(q = 2p + 1\) are probably prime.
In order to let you see what the tool is doing,
the tool waits for a fraction of a second after each attempt.
You should <a href="#tool-integer-prime-number-generation&amp;delay=0">disable this delay</a>
when generating large prime numbers.</p>



<details>
  <summary id="primality-test-optimizations">
Primality test optimizations
</summary>

  <p>Since this algorithm tests many integers for their primality,
the performance of the prime number generation is determined by the performance of the employed primality test.
Here are some ways to reject composite inputs as quickly as possible:</p>
  <ul>
    <li><strong>Trial division by small primes</strong>:
Since every second number is a multiple of 2,
every third number number is a multiple of 3, and so on,
you can rule out a substantial fraction of inputs
using <a href="#prime-factorization">trial division</a> by small prime numbers.
(To check that an input is odd, you have to verify only
that the <a href="https://en.wikipedia.org/wiki/Bit_numbering">least-significant bit</a> is 1.)</li>
    <li><strong>Coprimality with product of small primes</strong>:
You can check that an input is not a multiple of many small primes “at once”
by checking that the input is <a href="#multiset-of-prime-factors">coprime</a> with their product
using the <a href="#euclidean-algorithm">Euclidean algorithm</a>.
The product of the first \(l\) prime numbers is known
as the <a href="https://en.wikipedia.org/wiki/Primorial">primorial number</a> \(p_l\# = \prod_{i=1}^{l} p_i\),
where \(p_i\) is the \(i\)<sup>th</sup> prime number.
For example, the product of the first 40 prime numbers is <span id="product-of-40-primes"></span>
(see the last row of <a href="https://en.wikipedia.org/wiki/Primorial#Table_of_primorials">this table</a>).</li>
    <li><strong>Incremental instead of random search</strong>:
Instead of choosing the next input randomly, you can increment the previous input by a known value.
This has the advantage that you no longer need to perform the trial divisions
if you store the remainders from the previous attempt.
See the note 4.51 in the <a href="https://cacr.uwaterloo.ca/hac/about/chap4.pdf">Handbook of Applied Cryptography</a>
for a more detailed discussion of this approach.
(The tool above increments even inputs by 1 to make them odd before performing any primality checks.)</li>
  </ul>

</details>

<details>
  <summary id="expected-number-of-attempts">
Expected number of attempts
</summary>

  <p>As I mentioned <a href="#density-of-carmichael-numbers-and-prime-numbers">earlier</a>,
there are <a href="https://en.wikipedia.org/wiki/Prime-counting_function">approximately \(\frac{x}{\log_\mathrm{e}(x)}\)</a>
prime numbers smaller than \(x\).
Since half of all the integers are odd,
the probability that a random odd integer smaller than \(x\) is prime
is around \(\frac{x}{\log_\mathrm{e}(x)} / \frac{x}{2} = \frac{2}{\log_\mathrm{e}(x)}\).
Denoting the number of bits we are interested in as \(l\),
we get \(\frac{2}{\log_\mathrm{e}(2^l)}\).
Since \(s = \log_\mathrm{e}(2^l)\) means that \(e^s = 2^l\),
we can raise both sides by \(1 / l\) to get \(e^{s/l} = 2\).
Thus, \(\log_\mathrm{e}(2) = s / l\) and \(s = l \cdot \log_\mathrm{e}(2) = \log_\mathrm{e}(2^l)\),
which is one of the <a href="https://en.wikipedia.org/wiki/Logarithm#Logarithmic_identities">logarithmic identities</a>.
The number of <a href="https://en.wikipedia.org/wiki/Bernoulli_trial">independent trials</a> needed to get a success
is given by the <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>.
If the probability of success in each attempt is \(P\), it takes on average \(\frac{1}{P}\) attempts.
As a consequence, the expected number of attempts needed to find a prime number with \(l\) bits
is \(l \cdot \frac{\log_\mathrm{e}(2)}{2} = 0.34657 \cdot l ≈ \frac{1}{3} l\).
The probability of finding a <a href="#sophie-germain-and-safe-primes">safe prime</a> is \(P^2\),
which means that it takes \((l \cdot \frac{\log_\mathrm{e}(2)}{2})^2 = 0.12 \cdot l^2\) attempts on average.
The following table lists the expected number of attempts for the lengths supported
by the <a href="#tool-integer-prime-number-generation">tool above</a>.</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>Number of bits</th>
          <th>Expected number of attempts</th>
          <th>Squared for safe prime</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>8</td>
          <td>3</td>
          <td>8</td>
        </tr>
        <tr>
          <td>16</td>
          <td>6</td>
          <td>31</td>
        </tr>
        <tr>
          <td>32</td>
          <td>11</td>
          <td>123</td>
        </tr>
        <tr>
          <td>64</td>
          <td>22</td>
          <td>492</td>
        </tr>
        <tr>
          <td>128</td>
          <td>44</td>
          <td>1’968</td>
        </tr>
        <tr>
          <td>256</td>
          <td>89</td>
          <td>7’872</td>
        </tr>
        <tr>
          <td>512</td>
          <td>177</td>
          <td>31’487</td>
        </tr>
        <tr>
          <td>1’024</td>
          <td>355</td>
          <td>125’948</td>
        </tr>
        <tr>
          <td>2’048</td>
          <td>710</td>
          <td>503’791</td>
        </tr>
      </tbody>
    </table>

    <figcaption>

The expected number of attempts to find a (safe) prime of the given length rounded to the next integer.

</figcaption>
  </figure>

  <p>While I implemented some of the optimizations mentioned in the <a href="#primality-test-optimizations">previous box</a>,
the tool is not fast enough to find a safe prime with 2’048 bits in a reasonable amount of time.
I still wanted to support this length so that you get a sense for how large the prime number
has to be in order to get a <a href="#bits-of-security">reasonable amount of security</a>.
(Finding a normal prime of this length is
<a href="#tool-integer-prime-number-generation&amp;bits=11&amp;safe=false&amp;generator=false&amp;delay=0">no problem</a>.)
You can abort the search for a (safe) prime by changing one of the tool’s options.</p>

</details>

<details>
  <summary id="required-number-of-miller-rabin-rounds">
Required number of Miller-Rabin rounds
</summary>

  <p>Since the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>
is a <a href="#probabilistic-primality-tests">probabilistic primality test</a>,
what is the probability that the random search for a prime number returns a composite number?
How many rounds do we have to perform in the Miller-Rabin primality test
to push this probability below a certain value, such as \((\frac{1}{2})^{80}\)?
You may think that this error probability is given by the
<a href="#monier-rabin-bound-on-the-number-of-liars">Monier-Rabin bound on the number of liars</a>,
namely \((\frac{1}{4})^t\), where \(t\) denotes the number of rounds.
However, this bound limits the probability
that the Miller-Rabin primality test declares an input to be prime given that the input is composite.
Using mathematical notation, this is \(P(D_t \mid C) ≤ (\frac{1}{4})^t\),
where \(D_t\) denotes the <a href="https://en.wikipedia.org/wiki/Event_(probability_theory)">event</a>
that the input is declared prime after \(t\) rounds of the Miller-Rabin primality test
and \(C\) represents the event that the input is composite.
(\(P(D_t \mid C)\) is a <a href="https://en.wikipedia.org/wiki/Conditional_probability">conditional probability</a>,
which is defined as \(P(D_t \mid C) = \frac{P(D_t\ \cap\ C)}{P(C)}\).)
What we are interested in here, though, is the probability that an input is composite
given that the Miller-Rabin primality test declared it to be prime after \(t\) rounds: \(P(C \mid D_t)\).
Using <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem">Bayes’ theorem</a>, we have</p>

\[P(C \mid D_t) = P(C) \cdot \frac{P(D_t \mid C)}{P(D_t)} ≤ \frac{P(D_t \mid C)}{P(D_t)} ≤ \frac{1}{r} (\frac{1}{4})^t
\textsf{,}\]

  <p>where \(r\) is the ratio of the inputs which are prime.
Since the Miller-Rabin primality test declares all inputs which are prime to be prime, \(P(D_t) ≥ r\).
If \(r\) is small, the probability \(P(C \mid D_t)\) can be considerably larger than \((\frac{1}{4})^t\).
(For example, the probability of error is \(1\) if the set of candidates contains only composite numbers.)
However, the fraction of Miller-Rabin liars is far smaller than \(\frac{1}{4}\) for most numbers.
According to the note 4.49 in the <a href="https://cacr.uwaterloo.ca/hac/about/chap4.pdf">Handbook of Applied Cryptography</a>,
<a href="http://www.math.dartmouth.edu/~carlp/PDF/paper88.pdf">it has been shown</a>
that just 6 rounds of the Miller-Rabin primality test are needed to push the probability
that the random search for a 512-bit prime returns a composite number below \((\frac{1}{2})^{80}\).
For 1’024 bits, 3 rounds are enough, and for 2’048 bits, it suffices to perform 2 rounds.
Since you perform on average <a href="#performance-impact-of-the-number-of-rounds">only a bit more than one round</a>
of the Miller-Rabin primality test for unsuccessful candidates even in the worst case,
choosing a bigger \(t\) won’t affect the performance of the random search by much.
The situation is different when searching for safe primes,
but a better optimization is to increase your confidence that both \(p\) and \(q = 2p + 1\) are prime in parallel
instead of gaining high certainty that \(p\) is prime before even considering \(q\).
(I didn’t implement this optimization in the <a href="#tool-integer-prime-number-generation">above tool</a>
because it wouldn’t match the visualization, including the counter of how many times \(p\) was prime.)</p>

  <p>Please note that this discussion applies only to the case where the candidates are sampled randomly.
If you test an input which is provided by an untrusted party,
you can rely only on the worst-case error bound of \((\frac{1}{4})^t\).
Not considering the adversarial setting has been an issue
<a href="https://eprint.iacr.org/2018/749.pdf">in many cryptography libraries</a>.
If you verify that an integer provided by someone else is prime,
you should use 64 rounds to push the risk of being exploited <a href="#bits-of-security">below \(2^{-128}\)</a>.
Alternatively, you can use the <a href="https://en.wikipedia.org/wiki/Baillie%E2%80%93PSW_primality_test">Baillie-PSW primality test</a>,
which is named after Robert Baillie,
<a href="https://en.wikipedia.org/wiki/Carl_Pomerance">Carl Bernard Pomerance</a> (born in 1944),
<a href="https://en.wikipedia.org/wiki/John_Selfridge">John Lewis Selfridge</a> (1927 − 2010), and
<a href="https://en.wikipedia.org/wiki/Samuel_S._Wagstaff_Jr.">Samuel Standfield Wagstaff Jr.</a> (born in 1945).
This primality test consists of a single round of the Miller-Rabin primality test with the base 2 followed by the
<a href="https://en.wikipedia.org/wiki/Lucas_pseudoprime#Implementing_a_Lucas_probable_prime_test">Lucas probable prime test</a>,
which is named after <a href="https://en.wikipedia.org/wiki/%C3%89douard_Lucas">François Édouard Anatole Lucas</a> (1842 − 1891).</p>

</details>

<details>
  <summary id="performance-impact-of-the-number-of-rounds">
Performance impact of the number of rounds
</summary>

  <p>Since at most \(\frac{1}{4}\) of all bases of a composite number are <a href="#probabilistic-primality-tests">liars</a>,
the probability that you have to perform a second round of the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>
after performing a first round with a random base is at most \(\frac{1}{4}\) for any composite number.
The probability that you need a third round is at most \(\frac{1}{16}\), and so on.
In the worst case (the fraction of liars is usually much smaller than \(\frac{1}{4}\)),
the expected number of rounds needed to detect that a composite number is composite
is <a href="https://stackoverflow.com/a/6330138/12917821">\(1 + \frac{1}{4} + \frac{1}{16} + … = \frac{4}{3}\)</a>.
(\(s = \sum_{i=0}^{\infin} r^i = 1 + r + r^2 + …\)
is a <a href="https://en.wikipedia.org/wiki/Geometric_series">geometric series</a>,
which converges to \(\frac{1}{1-r}\) if \(|r| &lt; 1\)
because \(s - rs = s(1 - r) = 1\) as all but the first term cancel out.)
We get the same result when we interpret this
as the <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>,
whose <a href="https://en.wikipedia.org/wiki/Expected_value">expected value</a> is \(\frac{1}{P}\),
with a success probability of \(P = \frac{3}{4}\).
Ignoring the <a href="#primality-test-optimizations">optimizations mentioned above</a>,
we have to multiply the <a href="#expected-number-of-attempts">expected number of attempts to find a probable prime</a>
by \(\frac{4}{3}\) to get an estimate for the total number of Miller-Rabin primality test rounds
before the last attempt, which returns the probable prime after an additional \(t\) rounds.
This estimate is not really affected by the parameter \(t\).
For example, when we search for a 2’048-bit prime, we expect to perform in the order
of \(710 \cdot \frac{4}{3} = 947\) rounds of the Miller-Rabin primality test before the last attempt.
Whether you perform an additional 2 or 64 rounds for the last attempt is only a matter of a few percentages.
The above optimizations make the impact of the last attempt on the overall performance significantly bigger,
but we’re still talking about percentages and not multiples when we change the parameter \(t\).</p>

</details>

<h3 id="search-for-a-group-generator">Search for a group generator</h3>

<p>Given a <a href="#cyclic-groups">cyclic group</a> \(\mathbb{G}\)
and the <a href="#prime-factorization">prime factorization</a> of its order \(n = p_1^{e_1}p_2^{e_2} … p_l^{e_l}\),
<!-- --> \(G \in \mathbb{G}\) generates the whole group <a href="#if-and-only-if">if and only if</a></p>

<p>

$$
\frac{n}{p_i}G ≠ O
$$

$$
G^\frac{n}{p_i} ≠ I
$$

</p>

<p>for \(i\) from \(1\) to \(l\).
(According to <a href="#lagrange-consequences">Lagrange’s theorem</a>,
the <a href="#element-order">order of \(G\)</a> has to divide the <a href="#group-order">group order</a> \(n\),
and the above condition ensures that the order of \(G\) is not <a href="#multiset-of-prime-factors">one factor smaller</a> than \(n\).)
A simple way to find a <a href="#group-generators">generator</a>
is to repeatedly choose a random element from \(\mathbb{G}\) until this is the case.
Since a cyclic group of order \(n\) has <a href="#number-of-generators-in-cyclic-groups">\(\varphi(n)\) generators</a>,
the probability that a randomly chosen element generates the group is \(\frac{\varphi(n)}{n}\).
The number of <a href="https://en.wikipedia.org/wiki/Bernoulli_trial">trials</a> needed to find a generator
follows the <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>.
This means that we find a generator after \(\frac{n}{\varphi(n)}\) trials
<a href="https://en.wikipedia.org/wiki/Expected_value">on average</a>.
Since \(\varphi(n) &gt; \frac{n}{6 \log_\mathrm{e}(\log_\mathrm{e}(n))}\) for all \(n ≥ 5\)
(see the fact 2.102 in the <a href="https://cacr.uwaterloo.ca/hac/about/chap2.pdf">Handbook of Applied Cryptography</a>),
<!-- --> \(\frac{n}{\varphi(n)} &lt; 6 \log_\mathrm{e}(\log_\mathrm{e}(n))\).
We will study a smarter version of this algorithm in a <a href="#a-faster-algorithm-for-finding-a-generator">box below</a>.</p>

<p>This algorithm can be used only if the prime factorization of the group’s order is known.
As mentioned <a href="#prime-factorization">earlier</a>,
integer factorization is a <a href="#computational-complexity-theory">hard problem</a>.
We can avoid this problem for <a href="#multiplicative-groups">multiplicative groups</a> modulo a prime number \(q\)
by choosing the factors of \(q - 1\) first and then deriving \(q\) from them,
as we did <a href="#search-for-a-probable-prime">when searching</a> for a <a href="#sophie-germain-and-safe-primes">safe prime</a>.
In the case of a safe prime \(q = 2p + 1 &gt; 5\), \(|\href{#multiplicative-group-notations}{\mathbb{Z}_q^\times}| = 2p\)
and \(\varphi(|\mathbb{Z}_q^\times|) = \varphi(2p) = \varphi(2) \cdot \varphi(p) = p - 1\).
(If <a href="#tool-table-multiplicative-group-repetition&amp;modulus=5&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">\(q = 5\)</a>
and thus \(p = 2\), \(\varphi(4) = \varphi(2^2) = 2^1(2 - 1) = 2 ≠ 2 - 1 = 1\).)
If we ignore the elements \(1\) and \(q - 1\),
as the order of \(1\) is \(1\) and the order of \(q - 1\) modulo \(q\) is \(2\),
then half of all the \(2p - 2 = 2(p - 1)\) remaining elements in the group are generators.
This means that when we choose an element between \(1\) and \(q - 1\) at random (excluding both ends),
we have a 50% chance that this element generates the whole group.
As a consequence, we need only two attempts on average
to find a generator of the group \(\mathbb{Z}_q^\times\), where \(q\) is a safe prime.
Since \(q - 1\) is <a href="#multiplicative-group-repetition-table">the only element of order \(2\)</a> in a cyclic group,
<!-- --> \(G &lt; q - 1\) is a generator if \(G^p ≠_q 1\).
You can <a href="#tool-integer-prime-number-generation&amp;safe=true&amp;generator=true">enable the generation of a generator</a>
according to this logic in the <a href="#tool-integer-prime-number-generation">tool of the previous section</a>.
You can also convince yourself that half of all the elements between \(1\) and \(q - 1\) are generators
for all the safe primes greater than 5 and smaller than 100 (namely
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=7&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">7</a>,
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=11&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">11</a>,
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=23&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">23</a>,
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=47&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">47</a>,
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=59&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">59</a>, and
<a href="#tool-table-multiplicative-group-repetition&amp;modulus=83&amp;coprime=false&amp;repeat=false&amp;order=false&amp;totient=true">83</a>)
using the <a href="#multiplicative-group-repetition-table">repetition table of multiplicative groups</a>.</p>

<p>For the sake of simplicity, I use only the <a href="#notation">multiplicative notation</a>
in the text parts of the following <a href="https://riskmusings.substack.com/#information-boxes">information boxes</a>.</p>

<details>
  <summary id="generator-of-a-subgroup">
Generator of a subgroup
</summary>

  <p>Given a <a href="#group-generators">generator</a> \(G\) of a group \(\mathbb{G}\) of <a href="#group-order">order</a> \(n\),
the element \(H = G^\frac{n}{d}\) generates the <a href="#all-subgroups-of-cyclic-groups-are-cyclic">unique subgroup</a>
<!-- --> \(\mathbb{H}\) of order \(d\), where \(d\) is a <a href="#divisor">divisor</a> of \(n\).
(The order of \(H\) has to be \(d\) because the order of \(G\) wouldn’t be \(n\) otherwise.)
If the order of the desired subgroup \(\mathbb{H}\) is prime,
you don’t need to find a generator of the <a href="#subgroups">supergroup</a> \(\mathbb{G}\) first.
To find a generator of the subgroup with the prime order \(p\),
you can repeatedly choose a random element \(R \in \mathbb{G}\) until \(R^\frac{n}{p} ≠ I\).
Once you have found an element \(R\) for which this is the case,
the element \(R^\frac{n}{p}\) generates the subgroup of order \(p\).
Proof: Clearly, \((R^\frac{n}{p})^p = I\) because \(A^n = I\) for all \(A \in \mathbb{G}\)
due to <a href="#lagrange-consequences">Lagrange’s theorem</a>.
Since \((R^\frac{n}{p})^p = I\) and \((R^\frac{n}{p})^1 ≠ I\),
it follows from an <a href="#order-of-prime-power">earlier theorem with \(e = 1\)</a>
that the order of \(R^\frac{n}{p}\) is \(p\).</p>

</details>

<details>
  <summary id="determining-the-order-of-an-element">
Determining the order of an element
</summary>

  <p>Given a <a href="#finite-groups">finite group</a> \(\mathbb{G}\) and the <a href="#prime-factorization">prime factorization</a>
of its <a href="#group-order">order</a> \(n = p_1^{e_1}p_2^{e_2} … p_l^{e_l}\),
we want to determine the <a href="#element-order">order</a> \(d\) of an element \(A\).
Due to <a href="#lagrange-consequences">Lagrange’s theorem</a>, \(d\) divides \(n\).
Therefore, the <a href="#multiset-of-prime-factors">multiset of the prime factors</a> of \(n\)
includes the multiset of the prime factors of \(d\),
which means that \(d = p_1^{s_1}p_2^{s_2} … p_l^{s_l}\), where \(s_i ≤ e_i\) for \(i\) from \(1\) to \(l\).
Since \(d\) is the order of \(A\), \(A^d = I\) and \(A^{c \cdot d} = (A^d)^c = I^c = I\) for any integer \(c\).
This allows us to determine \(d\) by lowering each of the \(e_i\) to the lowest value \(s_i&#39;\)
for which \(A\) repeated \(d&#39; = \prod_{i=1}^l p_i^{s_i&#39;}\) times still equals the <a href="#group-axioms">identity element</a>.
The important insight is that we can tweak each of the exponents independently from the others.
As long as \(s_i&#39; ≥ s_i\) for each of the exponents, \(d&#39;\) is still a multiple of \(d\).
As soon as one \(s_i&#39; &lt; s_i\), \(d&#39;\) is no longer a multiple of \(d\), and thus \(A^{d&#39;} ≠ I\).
This gives us the following <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> for determining the order of \(A\):</p>

  <p>

$$
\text{let } d := n \\
\text{for } (i \text{ from } 1 \text{ to } l)\ \{ \\
\quad d := d / p_i^{e_i} \\
\quad \text{let } B := d A \\
\quad \text{while } (B ≠ O)\ \{ \\
\quad \quad B := p_i B \\
\quad \quad d := d \cdot p_i \\
\quad \} \\
\} \\
\text{return } d
$$

$$
\text{let } d := n \\
\text{for } (i \text{ from } 1 \text{ to } l)\ \{ \\
\quad d := d / p_i^{e_i} \\
\quad \text{let } B := A^d \\
\quad \text{while } (B ≠ I)\ \{ \\
\quad \quad B := B^{p_i} \\
\quad \quad d := d \cdot p_i \\
\quad \} \\
\} \\
\text{return } d
$$

</p>

  <p>The algorithm does not require the group to be <a href="#cyclic-groups">cyclic</a>,
but it requires that the prime factorization of the group’s order is known.
The following tool implements the above algorithm for arbitrarily large numbers
as long as it can <a href="#limitations-of-the-above-tool">determine and then factorize</a> the order of the group
with <a href="#pollards-rho-factorization-algorithm">Pollard’s rho factorization algorithm</a>.
You can ignore the tab titled <a href="#elliptic-curves">elliptic curve</a> for now.</p>

  

</details>

<details>
  <summary id="a-faster-algorithm-for-finding-a-generator">
A faster algorithm for finding a generator
</summary>

  <p>Given a <a href="#cyclic-groups">cyclic</a>, <a href="#commutative-groups">commutative group</a> \(\mathbb{G}\) and the
<a href="#prime-factorization">prime factorization</a> of its <a href="#group-order">order</a> \(n = p_1^{e_1}p_2^{e_2} … p_l^{e_l}\),
we get a generator \(G\) by doing</p>

  <p>

$$
\text{for } (i \text{ from } 1 \text{ to } l)\ \{ \\
\quad \text{choose } A \in \mathbb{G} \text{ at random until } \frac{n}{p_i}A ≠ O \\
\quad \text{let } G_i := \frac{n}{p_i^{e_i}}A \\
\} \\
\text{return } G := \sum_{i=1}^l G_i
$$

$$
\text{for } (i \text{ from } 1 \text{ to } l)\ \{ \\
\quad \text{choose } A \in \mathbb{G} \text{ at random until } A^\frac{n}{p_i} ≠ I \\
\quad \text{let } G_i := A^\frac{n}{p_i^{e_i}} \\
\} \\
\text{return } G := \prod_{i=1}^l G_i
$$

</p>

  <p>Before we can understand why this algorithm works, we must note that the above construction implies that</p>

  <p>

$$
p_i^{e_i} G_i = p_i^{e_i} (\frac{n}{p_i^{e_i}} A) = n A = O \quad \text{and} \quad
p_i^{e_i-1} G_i = p_i^{e_i-1} (\frac{n}{p_i^{e_i}} A) = \frac{n}{p_i} A ≠ O
$$

$$
G_i^{p_i^{e_i}} = (A^\frac{n}{p_i^{e_i}})^{p_i^{e_i}} = A^n = I \quad \text{and} \quad
G_i^{p_i^{e_i-1}} = (A^\frac{n}{p_i^{e_i}})^{p_i^{e_i-1}} = A^\frac{n}{p_i} ≠ I
$$

</p>

  <p>It follows from an <a href="#order-of-prime-power">earlier theorem</a> that the <a href="#element-order">order</a> of \(G_i\) is \(p_i^{e_i}\).
According to <a href="#order-when-combining-two-elements-of-coprime-orders">another theorem</a>, the order of \(G\) is \(n\)
because \(\operatorname{\href{#greatest-common-divisor}{gcd}}(|G_i|, |G_j|) = 1\) for all \(i ≠ j\).
This means that if the algorithm terminates, \(G\) is indeed a generator of the group \(\mathbb{G}\).</p>

  <p>This algorithm is quite fast because we need on average at most two attempts to find a suitable \(A\) for each \(p_i\).
This is because:</p>
  <ol>
    <li>The <a href="https://en.wikipedia.org/wiki/Image_(mathematics)">image</a> \(\mathbb{H} = f_{n/p_i}(\mathbb{G})\)
of the <a href="#power-function-and-its-preimage">power function</a> \(f_{n/p_i}\)
is a <a href="#subgroups">subgroup</a> of \(\mathbb{G}\):
Since every element in \(\mathbb{H}\) is of the form \(A^{n/p_i}\) for some \(A \in \mathbb{G}\)
and the group operation is <a href="#commutative-groups">commutative</a>,
<!-- --> \(A_1^{n/p_i} \cdot A_2^{n/p_i} = (A_1 \cdot A_2)^{n/p_i} \in \mathbb{H}\)
because \(A_1 \cdot A_2 \in \mathbb{G}\).
Thus, \(\mathbb{H}\) is <a href="#group-axioms">closed</a>.
Since every element in \(\mathbb{G}\) is mapped to some element in \(\mathbb{H}\), \(\mathbb{H}\) is not empty.
<a href="#subgroups">Therefore</a>, \(\mathbb{H}\) is indeed a subgroup of \(\mathbb{G}\).</li>
    <li>The <a href="#group-order">order</a> of \(\mathbb{H}\) is \(p_i\):
Given a <a href="#group-generators">generator</a> \(G\) of the group \(\mathbb{G}\),
<!-- --> \(G^{n/p_i} \in \mathbb{H}\) has order \(p_i\) because \((G^{n/p_i})^{p_i} = G^n = I\).
Since the group generated by \(G^{n/p_i}\) is included in \(\mathbb{H}\) due to <a href="#group-axioms">closure</a>,
<!-- --> \(\mathbb{H}\) contains at least \(p_i\) elements.
Since \(\mathbb{G}\) is <a href="#cyclic-groups">cyclic</a>,
the subgroup \(\mathbb{H}\) <a href="#all-subgroups-of-cyclic-groups-are-cyclic">is cyclic as well</a>.
So let \(H\) be a generator of \(\mathbb{H}\) and \(J \in f_{n/p_i}^{-1}(\{H\})\)
be any of its <a href="https://en.wikipedia.org/wiki/Image_(mathematics)#Inverse_image">preimages</a>.
Since the order of \(J\) can be at most \(n\) due to <a href="#lagrange-consequences">Lagrange’s theorem</a>,
the order of \(H = J^{n/p_i}\) can be at most \(p_i\).
Therefore, \(\mathbb{H}\) contains exactly \(p_i\) elements.</li>
    <li>The preimage \(\mathbb{K} = f_{n/p_i}^{-1}(\{I\})\) of the <a href="#group-axioms">identity element \(I\)</a>
is a subgroup of \(\mathbb{G}\): \(I \in \mathbb{K}\) because \(I^{n/p_i} = I\).
For any \(A_1, A_2 \in \mathbb{K}\) (i.e. \(A_1^{n/p_i} = I\) and \(A_2^{n/p_i} = I\)),
<!-- --> \(A_1 \cdot A_2 \in \mathbb{K}\)
because \((A_1 \cdot A_2)^{n/p_i} = A_1^{n/p_i} \cdot A_2^{n/p_i} = I\) due to <a href="#commutative-groups">commutativity</a>.
Since \(\mathbb{K}\) is non-empty and <a href="#group-axioms">closed</a>, \(\mathbb{K}\) is a subgroup of \(\mathbb{G}\).
(As we will revisit <a href="#kernel">later</a>, \(\mathbb{K}\) is the so-called
<a href="https://en.wikipedia.org/wiki/Kernel_(algebra)">kernel</a> of \(f_{n/p_i}\).)</li>
    <li>
      <!-- -->
      <p>\(f_{n/p_i}\) maps two inputs \(A\) and \(B\) to the same output <a href="#if-and-only-if">if and only if</a>
they belong to the same <a href="#subgroup-cosets">coset</a> of \(\mathbb{K}\):<!-- --></p>
    </li>
    <li>
      <!-- -->
      <p>\(A^{n/p_i}\) is <a href="https://en.wikipedia.org/wiki/Discrete_uniform_distribution">distributed uniformly</a>
over \(\mathbb{H}\) as \(A\) is chosen at random from \(\mathbb{G}\)
and all cosets contain <a href="#subgroup-cosets">the same number of elements</a>.</p>
    </li>
    <li>
      <!-- -->
      <p>\(P(A^{n/p_i} = I) = \frac{1}{p_i} ≤ \frac{1}{2}\) because of the previous point and \(|\mathbb{H}| = p_i\).
Therefore, the probability of success when choosing \(A\) is \(P(A^{n/p_i} ≠ I) = 1 - \frac{1}{p_i} ≥ \frac{1}{2}\).
Since the number of attempts needed to find a suitable \(A\) for each \(p_i\)
follows the <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>,
the expected number of attempts is \(\frac{1}{1 - 1 / p_i} ≤ 2\).</p>
    </li>
  </ol>

  <p>You find a more elaborate analysis of the <a href="https://en.wikipedia.org/wiki/Time_complexity">running time</a>
of this algorithm on page 328 of <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>.
The following tool implements the above algorithm for cyclic groups.
As we saw <a href="#carmichaels-totient-function">earlier</a>,
a <a href="#multiplicative-groups">multiplicative group</a> is cyclic <a href="#if-and-only-if">if and only if</a>
<!-- --> \(\href{#carmichaels-totient-function}{\lambda}(m) = \href{#eulers-totient-function}{\varphi}(m)\),
which is the case if and only if the modulus \(m = 2\), \(4\), \(p^e\), or \(2p^e\)
for an odd prime \(p\) and a positive integer \(e\).
In the case of <a href="#elliptic-curves">elliptic curves</a>,
the situation is <a href="https://math.stackexchange.com/a/2324138/947937">more complicated</a>,
and the tool simply aborts after 128 failed attempts to find a suitable \(A\).</p>

  

</details>

<h2 id="commutative-rings">Commutative rings</h2>

<p>In this article, this and the <a href="#finite-fields">next chapter</a> build towards <a href="#elliptic-curves">elliptic curves</a>,
which constitute the second popular way to construct <a href="#linear-one-way-functions">linear one-way functions</a>.
However, the concepts presented in the following two chapters are also important in their own right.
We will encounter <a href="#repetition-ring">repetition rings</a> when we will discuss cryptosystems
and <a href="#finite-fields">finite fields</a> when we will study coding theory.</p>

<h3 id="ring-axioms">Ring axioms</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Ring_(mathematics)">ring</a> is an <a href="#abstract-algebra">algebraic structure</a>
which consists of a <a href="#notation-for-sets-and-elements">set</a> \(\mathbb{R}\)
and two <a href="https://en.wikipedia.org/wiki/Binary_operation">binary operations</a>,
called <a href="https://en.wikipedia.org/wiki/Addition">addition (+)</a>
and <a href="https://en.wikipedia.org/wiki/Multiplication">multiplication (·)</a>,
which satisfy the <a href="https://en.wikipedia.org/wiki/Ring_(mathematics)#Definition">following axioms</a>
(written in a compact notation using <a href="#universal-and-existential-quantifiers">universal and existential quantifiers</a>):</p>
<ul>
  <li>Addition forms a <a href="#commutative-groups">commutative group</a>:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Closure_(mathematics)"><strong>Closure</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{R}\ a + b \in \mathbb{R}\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Associative_property"><strong>Associativity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{R}\ (a + b) + c = a + (b + c)\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Identity_element"><strong>Identity</strong></a>:
<!-- --> \(\exists\ 0 \in \mathbb{R}\ \forall\ a \in \mathbb{R}\ a + 0 = a\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Inverse_element"><strong>Invertibility</strong></a>:
<!-- --> \(\forall\ a \in \mathbb{R}\ \exists\ {-}a \in \mathbb{R}\ a + (-a) = 0\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Commutative_property"><strong>Commutativity</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{R}\ a + b  = b + a\)</li>
    </ul>
  </li>
  <li>Multiplication forms a so-called <a href="https://en.wikipedia.org/wiki/Monoid">monoid</a>
(a <a href="#group-like-algebraic-structures">group without invertibility</a>):
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Closure_(mathematics)"><strong>Closure</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{R}\ a \cdot b \in \mathbb{R}\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Associative_property"><strong>Associativity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{R}\ (a \cdot b) \cdot c = a \cdot (b \cdot c)\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Identity_element"><strong>Identity</strong></a>:
<!-- --> \(\exists\ 1 \in \mathbb{R}\ \forall\ a \in \mathbb{R}\ a \cdot 1 = a = 1 \cdot a\)</li>
    </ul>
  </li>
  <li>Multiplication distributes over addition:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Distributive_property"><strong>Distributivity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{R}\ a \cdot (b + c) = a \cdot b + a \cdot c\)</li>
    </ul>
  </li>
</ul>

<p>As the title of this chapter suggests,
we’re interested only in <a href="https://en.wikipedia.org/wiki/Commutative_ring">commutative rings</a>,
whose multiplication operation is commutative:</p>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Commutative_property"><strong>Commutativity</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{R}\ a \cdot b  = b \cdot a\)</li>
</ul>

<details open="">
  

  <ul>
    <li><strong>Lowercase</strong>: I use lowercase letters to denote the elements of a ring
instead of uppercase letters as I did in the case of <a href="#finite-groups">groups</a>.
This makes it easier to tell groups and rings apart:
As we will see <a href="#repetition-ring">in a moment</a>,
the inputs of our <a href="#linear-one-way-functions">linear one-way functions</a> form a ring,
whereas the outputs belong to a group.
The inputs of the linear one-way functions <a href="https://en.wikipedia.org/wiki/Scalar_(mathematics)">scale</a> the outputs,
and it’s common to write <a href="https://en.wikipedia.org/wiki/Coefficient">coefficients</a> in lowercase.</li>
    <li><strong>Identities</strong>: Since the only rings we are interested in for now consist of integers,
it’s convenient to use the integers 0 and 1 to denote the additive and the multiplicative identity.</li>
    <li><strong>Precedence</strong>: By convention, multiplication and division are evaluated before addition and subtraction,
i.e. \(a \cdot b + a \cdot c\) is to be interpreted as \((a \cdot b) + (a \cdot c)\).
(<a href="https://en.wikipedia.org/wiki/Exponentiation">Exponentiation</a>
and <a href="https://en.wikipedia.org/wiki/Root_extraction">root extraction</a>
have an even higher <a href="https://en.wikipedia.org/wiki/Order_of_operations">precedence</a>.)</li>
    <li>
      <!-- -->
      <p>\(\mathbb{R}\): This symbol is usually used to denote
the <a href="https://en.wikipedia.org/wiki/Real_number">set of real numbers</a>.
Since we talk only about integers throughout this article,
I decided to use this symbol despite this conflict in meaning.</p>
    </li>
  </ul>

</details>

<details>
  <summary id="universal-and-existential-quantifiers">
Universal and existential quantifiers
</summary>

  <p>When making a statement about the elements of a set, it is important to indicate
whether the statment is true for all elements of the set or just for some elements of the set.
In <a href="https://en.wikipedia.org/wiki/First-order_logic">predicate logic</a>,
one uses the <a href="https://en.wikipedia.org/wiki/Universal_quantification">universal quantifier \(\forall\)</a>
(“for all”) for the former
and the <a href="https://en.wikipedia.org/wiki/Existential_quantification">existential quantifier \(\exists\)</a>
(“it exists”) for the latter.
The most important <a href="https://en.wikipedia.org/wiki/Rule_of_inference">rule of inference</a>
is <a href="https://en.wikipedia.org/wiki/Universal_instantiation">universal instantiation</a>:
If a statement is true for all elements of a set, it is true for any particular element of the set.
The order of quantifiers matters:
The identity axiom says that there is at least one element which is an identity for all elements of the set,
whereas the invertibility axiom says that for all elements of the set at least one element exists
which is an inverse for that particular element.</p>

</details>

<details>
  <summary id="multiplicative-identity-crisis">
Multiplicative identity crisis
</summary>

  <p>Ignoring the fact that the definition of the additive group is <a href="#less-ambiguous-notation">ambiguous</a>,
it follows from these <a href="#reduced-group-axioms">reduced group axioms</a>
that <a href="#uniqueness-of-right-identity">the right identity is unique</a>
and that <a href="#right-identity-is-left-identity">the right identity is also a left identity</a>
(see the <a href="#group-properties">last chapter</a>).
As far as I can tell, we have to require that the right identity is also a left identity in the case of a monoid
in order to ensure that the identity of the monoid is unique.
(If there were two distinct identities \(E_1\) and \(E_2\), then \(E_1 = E_1 \circ E_2 = E_2\),
which is a <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradiction</a>.)
Alternatively, we could require that both a left identity and a right identity exist in a monoid.
(If there were two distinct left identities \(E_1\) and \(E_2\) and a right identity \(E\),
then \(E_1 = E_1 \circ E = E\) and \(E_2 = E_2 \circ E = E\), which contradicts that \(E_1 ≠ E_2\).)</p>

</details>

<h3 id="integers-modulo-m">Integers modulo m</h3>

<p>As we saw earlier, the integers <a href="#modulo-operation">modulo</a> an integer \(m\) form an <a href="#additive-groups">additive group</a>.
Such a group is also closed under multiplication.
Multiplication is still associative when the result is reduced to its <a href="#euclidean-division">remainder</a>,
and the integer \(1\) is the <a href="https://en.wikipedia.org/wiki/Identity_element#Definitions">multiplicative identity</a>.
Since multiplication means repeated addition
and addition is <a href="https://en.wikipedia.org/wiki/Associative_property">associative</a>
and <a href="https://en.wikipedia.org/wiki/Commutative_property">commutative</a>,
multiplication distributes over addition:</p>

\[a \cdot (b + c)
=_m \underbrace{(b + c) + … + (b + c)}_{a \text{ times}}
=_m \underbrace{b + … + b}_{a \text{ times}} + \underbrace{c + … + c}_{a \text{ times}}
=_m a \cdot b + a \cdot c\]

<p>Therefore, the integers modulo \(m\), which we write as \(\mathbb{Z}/m\mathbb{Z}\) or \(\mathbb{Z}_m\)
(see <a href="#additive-group-notations">above</a> and <a href="#quotient-rings">below</a>), form a (commutative) ring.
You can use the following tool to perform modular addition and multiplication with arbitrarily large numbers,
which is handy in cryptography:</p>



<details>
  <summary id="subrings">
Subrings
</summary>

  <p>A ring \(\mathbb{S}\) is a <a href="https://en.wikipedia.org/wiki/Subring">subring</a> of another ring \(\mathbb{R}\)
if every element of \(\mathbb{S}\) is also contained in \(\mathbb{R}\)
and the <a href="#ring-axioms">above axioms</a> hold for the same operations.
Since the modulus \(m\) is part of the operations (it defines what it means to be <a href="#equivalence-relation">equivalent</a>),
the integers modulo \(m\) have no subrings other than the whole ring
because the multiplicative identity \(1\) generates the whole additive group.</p>

</details>

<details>
  <summary id="zero-ring">
Zero ring
</summary>

  <p>The <a href="#ring-axioms">above axioms</a> don’t require that \(0 ≠ 1\).
If the additive identity equals the multiplicative identity,
all elements in the ring are equal to these identities:</p>

\[\begin{aligned}
\forall\ a \in \mathbb{R} \quad a &amp;= a \cdot 1 &amp;&amp; \textsf{since } 1 \textsf{ is the multiplicative identity} \\
&amp;= a \cdot 0 &amp;&amp; \textsf{since}\ 1 = 0 \\
&amp;= 0 &amp;&amp; \textsf{see the \href{#multiplication-by-zero}{next section}}
\end{aligned}\]

  <p>A ring which contains only a single element is a so-called <a href="https://en.wikipedia.org/wiki/Zero_ring">zero ring</a>.
Since all zero rings are <a href="#group-isomorphisms">isomorphic</a> to one another,
we speak of <em>the</em> zero ring, denoted as \(\{0\}\).
The zero ring is not a <a href="#subrings">subring</a> of any non-zero ring
because the additive identity is different from the multiplicative identity in non-zero rings,
and a subring must have the same identities as its superring in order to satisfy the axioms for the same operations.
We’re not interested in such technicalities,
and we will exclude the case where \(0 = 1\) explicitly when <a href="#field-axioms">defining fields</a>,
as it is commonly done.</p>

</details>

<h3 id="derived-ring-properties">Derived properties</h3>

<p>Since addition forms a group and multiplication forms a monoid,
the additive identity and the <a href="#multiplicative-identity-crisis">multiplicative identity</a> of a ring are unique.
It also follows that <a href="#uniqueness-of-inverses">the additive inverse is unique</a>.
Other consequences of the ring axioms are:</p>

<h4 id="multiplication-by-zero">Multiplication by zero</h4>

\[\boxed{\, \forall\ a \in \mathbb{R}\ a \cdot 0 = 0 \, \vphantom{\large |}}\]

\[a \cdot 0 = a \cdot (0 + 0) = a \cdot 0 + a \cdot 0 \\[2pt]
\textsf{Add } {-}(a \cdot 0) \textsf{ on both sides to get } 0 = a \cdot 0 \textsf{.}\]

<h4 id="multiplication-by-minus-one">Multiplication by minus one</h4>

\[\boxed{\, \forall\ a \in \mathbb{R}\ a \cdot (-1) = {-}a \, \vphantom{\large |}}\]

\[\begin{aligned}
a \cdot 0 &amp;= 0 &amp;&amp; \textsf{as just proven} \\
a \cdot (1 + (-1)) &amp;= 0 &amp;&amp; \textsf{since } 0 = 1 + (-1) \\
a \cdot 1 + a \cdot (-1) &amp;= 0 &amp;&amp; \textsf{due to distributivity} \\
a + a \cdot (-1) &amp;= 0 &amp;&amp; \textsf{since } a \cdot 1 = a \\
a \cdot (-1) &amp;= -a &amp;&amp; \textsf{add } {-}a \textsf{ on both sides}
\end{aligned}\]

<h3 id="units-and-zero-divisors">Units and zero divisors</h3>

<p>An element of a ring may or may not have a multiplicative inverse.
An element which has a multiplicative inverse is a so-called <a href="https://en.wikipedia.org/wiki/Unit_(ring_theory)">unit</a>.
An element \(a\) is called a <a href="https://en.wikipedia.org/wiki/Zero_divisor">zero divisor</a>
if there exists a non-zero element \(x\) so that \(a \cdot x = 0\).
(Since we care only about <a href="#ring-axioms">commutative rings</a>,
we don’t distinguish between left and right zero divisors.)
Every element of a finite ring is either a unit or a zero divisor, which can be seen as follows.
Consider the function \(f_a(x) = a \cdot x\), which multiplies the input by some element \(a\).
Since the multiplication of ring elements is <a href="#ring-axioms">closed</a>,
this function maps each element of \(\mathbb{R}\) to another element of \(\mathbb{R}\),
which is usually written as \(f_a{:}\ \mathbb{R} \to \mathbb{R}\).
(In mathematical terms, \(\mathbb{R}\) is both the <a href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a>
and the <a href="https://en.wikipedia.org/wiki/Codomain">codomain</a> of the function.)
Depending on \(a\), \(f_a\) is either so-called <a href="https://en.wikipedia.org/wiki/Injective_function">injective</a> or not:</p>
<ul>
  <li><strong>Injective</strong>: \(f_a\) maps distinct inputs to distinct outputs,
which means that \(x_1 ≠ x_2\) implies that \(f_a(x_1) ≠ f_a(x_2)\).
By <a href="https://en.wikipedia.org/wiki/Contraposition">contraposition</a>,
this also means that \(f_a(x_1) = f_a(x_2)\) implies that \(x_1 = x_2\).
Since the codomain of the function (the set of potential outputs) is just as large as its domain (the set of inputs),
there has to be an element \(x\) for each \(y \in \mathbb{R}\) so that \(f_a(x) = y\).
(A function whose <a href="https://en.wikipedia.org/wiki/Image_(mathematics)">image</a> covers its codomain
is said to be <a href="https://en.wikipedia.org/wiki/Surjective_function">surjective</a>.
A function which is both injective and surjective is said to be <a href="https://en.wikipedia.org/wiki/Bijection">bijective</a>.)
As a consequence, \(f_a\) is a <a href="https://en.wikipedia.org/wiki/Permutation">permutation</a>.
(We’ve already encountered permutations <a href="#permutations">in the context of groups</a>.)
It follows that there is an element \(a^{-1}\) for which \(f_a(a^{-1}) = a \cdot a^{-1} = 1\)
and that there is no element \(z\) other than zero for which \(f_a(z) = a \cdot z = 0\).
(As we saw <a href="#multiplication-by-zero">above</a>, \(f_a(0) = a \cdot 0 = 0\).)
This means that if \(f_a\) is injective for some element \(a\),
then \(a\) is a unit and not a zero divisor.</li>
  <li><strong>Non-injective</strong>: If \(f_a\) is not injective,
there are distinct elements \(x_1\) and \(x_2\) for which \(f_a(x_1) = f_a(x_2)\).
Since \(a \cdot x_1 = a \cdot x_2\) and \(x_1 ≠ x_2\), \(a\) is a zero divisor
because \(a \cdot x_1 - a \cdot x_2 = a \cdot (x_1 - x_2) = 0\) due to <a href="#ring-axioms">distributivity</a>.
(As we saw <a href="#least-common-multiple-and-0">earlier</a>, \(f_a(x_1) = f_a(x_2)\) also implies
that \(f_a(x_1 + b) = f_a(x_2 + b)\) for any element \(b\)
because \(a \cdot (x_1 + b) = a \cdot x_1 + a \cdot b = a \cdot x_2 + a \cdot b = a \cdot (x_2 + b)\),
which means that the outputs repeat after a <a href="https://en.wikipedia.org/wiki/Hash_collision">collision</a>.)
Since at least two inputs map to the same output, there has to be at least one element \(y \in \mathbb{R}\)
for which there exists no element \(x\) so that \(f_a(x) = a \cdot x = y\).
If \(a\) had a multiplicative inverse \(a^{-1}\), the element \(a^{-1} \cdot y\)
(which exists due to <a href="#ring-axioms">closure</a>) would constitute such an input
as \(f_a(a^{-1} \cdot y) = a \cdot (a^{-1} \cdot y) = (a \cdot a^{-1}) \cdot y = y\)
due to <a href="#ring-axioms">associativity</a>.
Therefore, zero divisors can’t have a multiplicative inverse
because the existence of a multiplicative inverse makes the mapping injective,
whereas a zero divisor makes the mapping non-injective since \(f_a(x) = 0\) for zero and some other element.</li>
</ul>

<p>The existence of zero divisors is “undesirable” because it destroys the
<a href="https://en.wikipedia.org/wiki/Cancellation_property">cancellation property</a>:
<!-- --> \(a \cdot b = a \cdot c\) implies that \(b = c\) only if \(a\) is not a zero divisor.
If \(a\) is a zero divisor,
then \(b\) equals \(c\) only up to a multiple of the smallest element \(z\) for which \(a \cdot z = 0\).
You can observe these facts in the <a href="#multiplicative-group-operation-table">operation table of multiplicative groups</a>
when you choose a non-prime modulus,
such as <a href="#tool-table-multiplicative-group-operation&amp;modulus=15&amp;coprime=false&amp;zero=true&amp;product=false">15</a>.</p>

<details>
  <summary id="integral-domains">
Integral domains
</summary>

  <p>The statement that each element is either <a href="#units-and-zero-divisors">a unit or a zero divisor</a>
doesn’t hold for rings with an infinite number of elements.
For example, the <a href="https://en.wikipedia.org/wiki/Integer">integers \(\mathbb{Z}\)</a>
form a ring under ordinary addition and multiplication.
The only elements which have a multiplicative inverse in \(\mathbb{Z}\) are \(+1\) and \(-1\),
yet no integer other than \(0\) divides \(0\).
A <a href="#zero-ring">non-zero</a> commutative ring where the product of any two non-zero elements is non-zero
(i.e. \(0\) is the only zero divisor), is called an <a href="https://en.wikipedia.org/wiki/Integral_domain">integral domain</a>.
Since every element of a finite ring is either a unit or a zero divisor,
every finite integral domain is a <a href="#finite-fields">field</a>.
Since we’re interested only in finite <a href="#abstract-algebra">algebraic structures</a>,
we don’t care about integral domains.
I still want to note that the cancellation property holds also for infinite rings:
If \(a\) is not a zero divisor, then \(a \cdot b = a \cdot c\) implies that \(b = c\)
because \(a \cdot b = a \cdot c\) implies that \(a \cdot b - a \cdot c = a \cdot (b - c) = 0\)
and \(b - c\) has to equal \(0\) given that \(a\) is not a zero divisor,
which is the case only if \(b = c\).</p>

</details>

<details>
  <summary id="uniqueness-of-the-multiplicative-inverse-in-rings">
Uniqueness of the multiplicative inverse in rings
</summary>

  <p>If an element of a ring has a multiplicative inverse, the multiplicative inverse is unique.
For finite rings, this fact follows directly from the <a href="#units-and-zero-divisors">argument above</a>.
(If \(a\) is a unit, \(f_a\) is a permutation, and thus there is only a single element for which \(f_a(x) = 1\).)
It’s not difficult to show that this fact holds for infinite rings as well:
After proving that <a href="#right-inverses-are-left-inverses">a right inverse is also a left inverse</a>
(or simply requiring that the ring is <a href="#ring-axioms">commutative</a>),
any two inverses \(a_1^{-1}\) and \(a_2^{-1}\) of \(a\) are the same because \(a_1^{-1}
= a_1^{-1} \cdot 1
= a_1^{-1} \cdot (a \cdot a_2^{-1})
= (a_1^{-1} \cdot a) \cdot a_2^{-1}
= 1 \cdot a_2^{-1}
= a_2^{-1}\).</p>

</details>

<details>
  <summary id="multiplicative-group-of-units">
Multiplicative group of units
</summary>

  <p>Given a ring \(\mathbb{R}\), the set of all <a href="#units-and-zero-divisors">units</a> in \(\mathbb{R}\)
is usually denoted as \(\mathbb{R}^\times\) (or as \(\mathbb{R}^*\)).
<!-- --> \(\mathbb{R}^\times\) forms a <a href="#group-axioms">group</a> under the ring’s multiplication:</p>
  <ul>
    <li><strong>Identity</strong>: The multiplicative identity \(1\) is a unit and thus included in \(\mathbb{R}^\times\)
because it has a multiplicative inverse, namely itself.</li>
    <li><strong>Invertibility</strong>: By definition, every unit has a multiplicative inverse.
Since <a href="#right-inverses-are-left-inverses">a right inverse is also a left inverse</a> and vice versa,
every inverse is itself invertible.
(If \(b\) is the inverse of \(a\), then \(a\) is the inverse of \(b\).)</li>
    <li><strong>Closure</strong>: The product of two units is another unit.
For any \(a, b \in \mathbb{R}^\times\), \((a \cdot b)^{-1} = b^{-1} \cdot a^{-1}\)
because \((a \cdot b) \cdot (b^{-1} \cdot a^{-1})
= (a \cdot (b \cdot b^{-1})) \cdot a^{-1} = a \cdot a^{-1} = 1\).
(\(a^{-1}\) and \(b^{-1}\) exist because \(a\) and \(b\) are units.)</li>
    <li><strong>Associativity</strong>: Since multiplication is the same operation as in the ring, it is still associative.</li>
  </ul>

  <p>The notation for the group of units shouldn’t surprise you.
I’ve been using it since I introduced <a href="#multiplicative-groups">multiplicative groups</a>:
<a href="#integers-modulo-m">\(\mathbb{Z}_m\)</a> \(\to\) <a href="#multiplicative-group-notations">\(\mathbb{Z}_m^\times\)</a>.</p>

</details>

<h3 id="repetition-ring">Repetition ring</h3>

<p>There are two reasons why we study rings.
For one thing, fields,
which we’ll discuss in the <a href="#finite-fields">next chapter</a> in order to construct <a href="#elliptic-curves">elliptic curves</a>,
are simply rings in which all non-zero elements are <a href="#units-and-zero-divisors">units</a>.
For another thing, we learned that you reach the <a href="#group-axioms">identity element</a>
when you <a href="#element-repetitions">repeat an element</a> \(A\) of a <a href="#finite-groups">finite group</a> often enough.
From there on, you will get <a href="#repeated-group-elements">the same elements in the same order</a>.
This means that we can reduce the number of repetitions <a href="#modulo-operation">modulo</a>
the <a href="#element-order">element’s order</a> \(|A|\) without affecting the result:</p>

<p>

$$
nA = (n\ \href{#modulo-operation}{\%}\ |A|)A \textsf{ \href{#lagrange-consequences}{since} } (|A|)A = O
$$

$$
A^n = A^{n\ \href{#modulo-operation}{\%}\ |A|} \textsf{ \href{#lagrange-consequences}{since} } A^{|A|} = I
$$

</p>

<p>When constructing a <a href="#linear-one-way-functions">linear one-way function</a> to be used in cryptosystems,
we typically repeat a <a href="#group-generators">generator</a> \(G\).
Since the function is linear,
we can add and multiply two inputs \(a\) and \(b\) in the output <a href="https://en.wikipedia.org/wiki/Vector_space">space</a>
<a href="#motivation">while knowing only</a> the input \(b\) and the output \(A = f(a)\):</p>

<div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <ul>
    <li><strong>Addition</strong>: \(f(a + b) = (a + b)G = aG + bG = A + bG\)</li>
    <li><strong>Multiplication</strong>: \(f(a \cdot b) = (a \cdot b)G = b(aG) = bA\)</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Addition</strong>: \(f(a + b) = G^{a + b} = G^a \cdot G^b = A \cdot G^b\)</li>
    <li><strong>Multiplication</strong>: \(f(a \cdot b) = G^{a \cdot b} = (G^a)^b = A^b\)</li>
  </ul>

</div>

<p>Since we compute the addition and the multiplication of inputs modulo the generator’s order \(\lvert G \rvert\),
the inputs of our linear one-way function <a href="#integers-modulo-m">form a finite ring</a>.
I call it the repetition ring of the element which is repeated,
even though I haven’t found anyone else who uses this term.
If the linear one-way function is constructed with a <a href="#multiplicative-groups">multiplicative group modulo \(m\)</a>,
it’s very easy to confuse the group operation, which is multiplication modulo \(m\),
with multiplication in the repetition ring, which is computed
modulo \(|\href{#multiplicative-group-notations}{\mathbb{Z}_m^\times}| = \href{#eulers-totient-function}{\varphi(m)}\).
In order to minimize confusion, I use uppercase letters for the elements of the group
and lowercase letters for the elements of the ring.
As mentioned <a href="#equivalence-relation">earlier</a>,
this is also why I keep the modulus next to the equals sign.
For example, such a linear one-way function transforms the <a href="#equivalence-relation">equivalence relation</a>
<!-- --> \(a \cdot b + c =_{\varphi(m)} d\) into \((G^a)^b \cdot G^c =_m G^d\),
i.e. the latter relation holds <a href="#if-and-only-if">if and only if</a> the former does.
Since the repetition ring is a ring,
an element \(a\) <a href="#units-and-zero-divisors">may or may not have a multiplicative inverse</a>.
For example, \((G^a)^x =_m G\) has a solution \(x\)
if and only if \(a\) has a multiplicative inverse modulo \(\varphi(m)\),
in which case \(x =_{\varphi(m)} a^{-1}\).</p>

<h3 id="advanced-concepts">Advanced concepts</h3>

<p>While Wikipedia lists the following topics
<a href="https://en.wikipedia.org/wiki/Ring_(mathematics)#Basic_concepts">as basic concepts</a>,
they are fairly advanced for our standards.
I put all of them in <a href="https://riskmusings.substack.com/#optional-reading">optional information boxes</a>
because we don’t need any of them.
They just provide an outlook into the bigger mathematical context,
and having an elementary understanding of them makes it easier to read the sources
that I’ve referenced throughout this article (including Wikipedia).
They also explain the notation <a href="#additive-group-notations">\(\mathbb{Z}/m\mathbb{Z}\)</a>.
I advise you to skip these boxes if you’re not interested in any of this.</p>

<details>
  <summary id="homomorphisms">
Homomorphisms
</summary>

  <p>A <a href="https://en.wikipedia.org/wiki/Homomorphism">homomorphism</a> is a function
which maps the elements of one <a href="#abstract-algebra">algebraic structure</a>
to the elements of a similar algebraic structure while preserving the relations between the elements in each structure
under the operations of the corresponding structure.
Unlike an <a href="https://en.wikipedia.org/wiki/Isomorphism">isomorphism</a>,
which has to be invertible (see the <a href="#group-isomorphisms">group isomorphisms</a> above),
a homomorphism can map several elements of its <a href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a>
to a single element of its <a href="https://en.wikipedia.org/wiki/Codomain">codomain</a>
and doesn’t have to reach all the elements of its codomain.
In other words, a homomorphism has to be neither <a href="https://en.wikipedia.org/wiki/Injective_function">injective</a>)
nor <a href="https://en.wikipedia.org/wiki/Surjective_function">surjective</a>,
while an isomorphism has to be both in order to be <a href="https://en.wikipedia.org/wiki/Bijection">bijective</a>.
(Every isomorphism is a homomorphism,
but a homomorphism is an isomorphism <a href="#if-and-only-if">if and only if</a> it is bijective.)</p>

  <p>Given two rings \(\mathbb{R}_1\) and \(\mathbb{R}_2\),
a <a href="https://en.wikipedia.org/wiki/Ring_homomorphism">ring homomorphism</a>
is a function \(f{:}\ \mathbb{R}_1 \to \mathbb{R}_2\) which satisfies the following properties:</p>
  <ol>
    <li><strong>Preservation of addition</strong>: For all \(a, b \in \mathbb{R}_1\), \(f(a +_1 b) = f(a) +_2 f(b)\).</li>
    <li><strong>Preservation of multiplication</strong>: For all \(a, b \in \mathbb{R}_1\), \(f(a \cdot_1 b) = f(a) \cdot_2 f(b)\).</li>
    <li><strong>Preservation of the multiplicative identity</strong>: \(f(1_1) = 1_2\).</li>
  </ol>

  <p>The index indicates to which ring an operation or an identity element belongs.
The third property prevents that all elements are mapped to \(0_2\).
It follows from these properties that the additive identity
and additive and multiplicative inverses are <a href="#group-isomorphisms">preserved</a>.</p>

</details>

<details>
  <summary id="kernel">
Kernel
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Kernel_(algebra)">kernel</a>
of a <a href="#homomorphisms">homomorphism</a> \(f{:}\ \mathbb{R}_1 \to \mathbb{R}_2\)
is the <a href="https://en.wikipedia.org/wiki/Image_(mathematics)#Inverse_image">preimage</a>
of the additive identity element (or just the identity element in the case of groups):
<!-- --> \(\mathbb{K}_f = \{x \in \mathbb{R}_1 \mid f(x) = 0_2 \} = f^{-1}(\{ 0_2 \})\)
(see <a href="#notation-for-sets-and-elements">these</a> <a href="#power-function-and-its-preimage">boxes</a>
if you don’t understand these notations).
(The kernel is usually written as \(\ker(f)\) or \(\ker f\) instead of \(\mathbb{K}_f\),
but I decided to make use of my <a href="https://en.wikipedia.org/wiki/Artistic_license">artistic license</a> again.)</p>

  <p>The kernel \(\mathbb{K}_f\) of a homomorphism \(f{:}\ \mathbb{R}_1 \to \mathbb{R}_2\) has some interesting properties:</p>
  <ol>
    <li>The kernel is a <a href="#group-axioms">group</a> under addition:
      <ul>
        <li><strong>Closure</strong>: For all \(a, b \in \mathbb{K}_f\), \(a +_1 b \in \mathbb{K}_f\)
because \(f(a +_1 b) = f(a) +_2 f(b) = 0_2 +_2 0_2 = 0_2\).</li>
        <li><strong>Associativity</strong>: Inherited from the associativity of addition in \(\mathbb{R}_1\).</li>
        <li><strong>Identity</strong>: \(0_1 \in \mathbb{K}_f \iff f(0_1) = 0_2\)
because you can cancel \(f(0_1)\) from \(f(0_1) = f(0_1 +_1 0_1) = f(0_1) +_2 f(0_1)\).</li>
        <li><strong>Invertibility</strong>: For all \(a \in \mathbb{K}_f\), \(-a \in \mathbb{K}_f\)
because \(0_2 = f(0_1) = f(a +_1 (-a)) = f(a) +_2 f(-a) = f(-a)\).</li>
      </ul>
    </li>
    <li>A homomorphism maps two inputs \(a\) and \(b\) to the same output <a href="#if-and-only-if">if and only if</a>
they belong to the same <a href="#subgroup-cosets">coset</a> of its kernel:
<!-- --> \(f(a) = f(b) \iff f(a) -_2 f(b) = 0_2 \iff f(a -_1 b) = 0_2
\iff a -_1 b \in \mathbb{K}_f \iff a \in \mathbb{K}_f +_1 b\).
Obviously, \(b \in \mathbb{K}_f +_1 b\) because \(0_1 \in \mathbb{K}_f\).
(You may have noticed that we’ve already used this fact <a href="#a-faster-algorithm-for-finding-a-generator">earlier</a>.)</li>
    <li>\(f\) is <a href="https://en.wikipedia.org/wiki/Injective_function">injective</a> if and only if \(\mathbb{K}_f = \{0_1\}\).
One direction of this equivalence is trivial to prove:
If \(f\) is injective, no two inputs are mapped to the same output, including \(0_2\).
If \(f\) is not injective, there are at least two distinct elements \(a, b \in \mathbb{R}_1\) so that \(f(a) = f(b)\).
Therefore, \(a -_1 b \in \mathbb{K}_f\) as shown in the previous point.
Since \(a ≠ b\), \(a -_1 b ≠ 0_1\),
which proves the <a href="https://en.wikipedia.org/wiki/Contraposition">contraposition</a> of the other direction.</li>
  </ol>

</details>

<details>
  <summary id="ideals">
Ideals
</summary>

  <p>An <a href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)">ideal</a> \(\mathbb{I}\)
is a subset of the elements of a <a href="#ring-axioms">ring</a> \(\mathbb{R}\)
so that they form a <a href="#group-axioms">group</a> under addition
and that they absorb all the elements of \(\mathbb{R}\) under multiplication,
which means that for every \(r \in \mathbb{R}\) and every \(i \in \mathbb{I}\), \(r \cdot i \in \mathbb{I}\).
(If the ring is not <a href="#ring-axioms">commutative</a>, one has to distinguish between
<a href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)#Definitions_and_motivation">left ideals and right ideals</a>,
whose intersection consists of the two-sided ideals.)
Ideals are usually not <a href="#subrings">subrings</a>, as they typically lack the multiplicative identity.
For example, given the ring of <a href="https://en.wikipedia.org/wiki/Integer">integers \(\mathbb{Z}\)</a>,
the set of all the multiples of an integer \(n\),
which is commonly written as \(n \mathbb{Z} = \{n \cdot z \mid z \in \mathbb{Z}\}\), is an ideal.
This set is closed under addition (the sum of two multiples of \(n\) is another multiple of \(n\)),
addition remains associative (the order in which you add multiples of \(n\) doesn’t matter),
it has an identity element (\(0\) is a multiple of \(n\) because <a href="#multiplication-by-zero">\(n \cdot 0 = 0\)</a>),
and every element has an additive inverse (\((n \cdot z) + (n \cdot (-z)) = n \cdot (z - z) = 0\)).
Additionally, if you multiply any multiple of \(n\) by any integer, you get another multiple of \(n\).</p>

  <p>The <a href="#kernel">kernel</a> \(\mathbb{K}_f\) of a <a href="#homomorphisms">homomorphism</a> \(f\) is an ideal
because the kernel forms a group under addition (see the first property in the <a href="#kernel">previous box</a>)
and the kernel absorbs all the elements under multiplication
since for all \(r \in \mathbb{R}_1\) and all \(k \in \mathbb{K}_f\),
<!-- --> \(r \cdot_1 k \in \mathbb{K}_f\) as \(f(r \cdot_1 k) = f(r) \cdot_2 f(k) = f(r) \cdot_2 0_2 = 0_2\).</p>

</details>

<details>
  <summary id="principal-ideals">
Principal ideals
</summary>

  <p>A <a href="https://en.wikipedia.org/wiki/Principal_ideal">principal ideal</a>
is an <a href="#ideals">ideal</a> in a <a href="#ring-axioms">ring</a> \(\mathbb{R}\)
which is generated by multiplying a single element \(a\) of \(\mathbb{R}\) by every element of \(\mathbb{R}\).
Such a principal ideal is often written as \(a \mathbb{R} = \{a \cdot r \mid r \in \mathbb{R}\}\).
If the ring is not <a href="#ring-axioms">commutative</a>, \(a \mathbb{R}\) can be different from \(\mathbb{R} a\).
If they are the same, the ideal generated by \(a\) is also written as \(⟨a⟩\) or simply as \((a)\).
As we saw earlier when we discussed <a href="#bezouts-identity">Bézout’s identity</a>,
every <a href="https://en.wikipedia.org/wiki/Linear_combination">linear combination</a> of any two integers \(a\) and \(b\)
is a multiple of \(\operatorname{\href{#greatest-common-divisor}{gcd}}(a, b)\).
This means that any ideal in the ring of integers \(\mathbb{Z}\) can be generated by a single element,
which makes \(\mathbb{Z}\) a so-called <a href="https://en.wikipedia.org/wiki/Principal_ideal_domain">principal ideal domain</a>.</p>

</details>

<details>
  <summary id="quotient-rings">
Quotient rings
</summary>

  <p>Given a <a href="#ring-axioms">ring</a> \(\mathbb{R}\)
and a (<a href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)#Definitions_and_motivation">two-sided</a>)
<a href="#ideals">ideal</a> \(\mathbb{I}\) in \(\mathbb{R}\),
we can define an <a href="#equivalence-relation">equivalence relation</a> \(=_{\mathbb{I}}\)
so that for any \(a, b \in \mathbb{R}\),
<!-- --> \(a =_{\mathbb{I}} b\) <a href="#if-and-only-if">if and only if</a> \(a - b \in \mathbb{I}\).
For \(=_{\mathbb{I}}\) to be an equivalence relation,
it must satisfy the <a href="#equivalence-properties">following properties</a>
for any elements \(a\), \(b\), and \(c \in \mathbb{R}\):</p>
  <ul>
    <li><a href="https://en.wikipedia.org/wiki/Reflexive_relation"><strong>Reflexivity</strong></a>:
\(a =_{\mathbb{I}} a\).
Since every ideal includes \(0\), \(a - a = 0 \in \mathbb{I}\).</li>
    <li><a href="https://en.wikipedia.org/wiki/Symmetric_relation"><strong>Symmetry</strong></a>:
If \(a =_{\mathbb{I}} b\), then \(b =_{\mathbb{I}} a\).
Since the elements of an ideal form an additive group,
an ideal contains the additive inverse of each of its elements.
Therefore, if \(a - b \in \mathbb{I}\), then \(b - a \href{#inversion-of-combination}{=} -(a - b) \in \mathbb{I}\).</li>
    <li><a href="https://en.wikipedia.org/wiki/Transitive_relation"><strong>Transitivity</strong></a>:
If \(a =_{\mathbb{I}} b\) and \(b =_{\mathbb{I}} c\), then \(a =_{\mathbb{I}} c\).
Since \(a - b \in \mathbb{I}\) and \(b - c \in \mathbb{I}\),
<!-- --> \((a - b) + (b - c) = a - c \in \mathbb{I}\) because every ideal is closed under addition
(i.e. if \(i \in \mathbb{I}\) and \(j \in \mathbb{I}\), then \(i + j \in \mathbb{I}\),
which also means that \(i =_{\mathbb{I}} j\)).</li>
  </ul>

  <p>A set of equivalent elements is called an <a href="https://en.wikipedia.org/wiki/Equivalence_class">equivalence class</a>.
Transitivity implies that any two equivalence classes overlap each other completely or not at all but not partially.
Since the elements of both the ring and the ideal form a group under addition,
the ideal is an additive subgroup of the ring.
Since \(a - b \in \mathbb{I} \iff a \in \mathbb{I} + b\)
and \(b \in \mathbb{I} + b\) because \(0 \in \mathbb{I}\),
two elements are identical if and only if they belong to the same additive <a href="#subgroup-cosets">cosets</a> of the ideal.
As shown <a href="#cosets-are-equal-or-disjoint">earlier</a>,
cosets are either equal or <a href="https://en.wikipedia.org/wiki/Disjoint_sets">disjoint</a>.</p>

  <p>Interestingly, \(=_{\mathbb{I}}\) is also a <a href="#congruence-relation">congruence relation</a>,
which means that equivalent inputs result in equivalent outputs under addition and multiplication:
Given \(a_1, a_2, b_1, b_2 \in \mathbb{R}\) where \(a_1 =_{\mathbb{I}} a_2\) and \(b_1 =_{\mathbb{I}} b_2\), then</p>
  <ul>
    <li>\(a_1 + b_1 =_{\mathbb{I}} a_2 + b_2\) because \(a_1 - a_2 =_{\mathbb{I}} b_2 - b_1\)
as we required that \(a_1 - a_2 \in \mathbb{I}\) and \(b_2 - b_1 \in \mathbb{I}\), and</li>
    <li>\(a_1 \cdot b_1 =_{\mathbb{I}} a_2 \cdot b_2\) because \(a_1 = a_2 + i_a\) for some \(i_a \in \mathbb{I}\)
and \(b_1 = b_2 + i_b\) for some \(i_b \in \mathbb{I}\),
and thus \(a_1 \cdot b_1 = (a_2 + i_a) \cdot (b_2 + i_b)
= a_2 \cdot b_2 + a_2 \cdot i_b + i_a \cdot b_2 + i_a \cdot i_b\).
Now \(a_2 \cdot b_2 + a_2 \cdot i_b + i_a \cdot b_2 + i_a \cdot i_b =_{\mathbb{I}} a_2 \cdot b_2\)
because \(a_2 \cdot b_2 + a_2 \cdot i_b + i_a \cdot b_2 + i_a \cdot i_b - a_2 \cdot b_2
= a_2 \cdot i_b + i_a \cdot b_2 + i_a \cdot i_b \in \mathbb{I}\)
since \(\mathbb{I}\) absorbs multiplication and is closed under addition.</li>
  </ul>

  <p>Therefore, addition and multiplication are well-defined for the cosets of \(\mathbb{I}\):
No matter which elements from two cosets you add or multiply, all results belong to the same coset.
As a consequence, the function \(f(x) = \mathbb{I} + x = \{i + x \mid i \in \mathbb{I}\}\)
is a <a href="#homomorphisms">ring homomorphism</a>, where \(\mathbb{I}\) is the additive identity
because \(\mathbb{I} + \mathbb{I} = \mathbb{I}\) (closure under addition)
and \(a \cdot \mathbb{I} = \mathbb{I}\) for any \(a \in \mathbb{R}\) (absorption of multiplication),
and \(\mathbb{I}\) is also the <a href="#kernel">kernel</a> of \(f\) because for all \(i \in \mathbb{I}\)
and only those \(i\)s, \(f(i) = \mathbb{I} + i = \mathbb{I}\):</p>
  <ol>
    <li><strong>Preservation of addition</strong>: For all \(a, b \in \mathbb{R}\), \(f(a + b) = \mathbb{I} + (a + b)
= \mathbb{I} + \mathbb{I} + (a + b) = (\mathbb{I} + a) + (\mathbb{I} + b) = f(a) + f(b)\).</li>
    <li><strong>Preservation of multiplication</strong>: For all \(a, b \in \mathbb{R}\), \(f(a \cdot b) = \mathbb{I} + (a \cdot b)
= \mathbb{I} \cdot \mathbb{I} + \mathbb{I} \cdot b + a \cdot \mathbb{I} + a \cdot b
= (\mathbb{I} + a) \cdot (\mathbb{I} + b) = f(a) \cdot f(b)\),
where \(\mathbb{A} \cdot \mathbb{B} = \{a \cdot b \mid a \in \mathbb{A},  b \in \mathbb{B} \}\)
instead of the <a href="https://en.wikipedia.org/wiki/Cartesian_product">Cartesian product</a> of sets.</li>
    <li><strong>Preservation of the multiplicative identity</strong>: \(f(1) = \mathbb{I} + 1\),
which is the multiplicative identity because \((\mathbb{I} + a) \cdot (\mathbb{I} + 1)
= \mathbb{I} \cdot \mathbb{I} + \mathbb{I} \cdot 1 + a \cdot \mathbb{I} + a \cdot 1 = \mathbb{I} + a\)
for any \(a \in \mathbb{R}\).</li>
  </ol>

  <p>Since the ideal \(\mathbb{I}\) “divides” (partitions) the ring \(\mathbb{R}\),
the ring of cosets is called the <a href="https://en.wikipedia.org/wiki/Quotient_ring">quotient ring</a>
of \(\mathbb{R}\) modulo \(\mathbb{I}\), written as \(\mathbb{R} / \mathbb{I}\).
So not only does a ring homomorphism define a kernel, which is an ideal,
an ideal also defines a homomorphism, whose kernel is the ideal itself.
A ring homomorphism \(f\) maps all the elements of a coset of \(\mathbb{K}_f\) to a single element because
for all \(a \in \mathbb{K}_f + b\), \(f(a) = f(k + b) = f(k) + f(b) = 0 + f(b) = f(b)\) for some \(k \in \mathbb{K}_f\).
We thus have an invertible mapping between the cosets of \(\mathbb{K}_f\)
and the <a href="https://en.wikipedia.org/wiki/Image_(mathematics)">image</a> of \(f\),
which means that the quotient ring of \(\mathbb{R}\) modulo \(\mathbb{K}_f\)
is <a href="#homomorphisms">isomorphic</a> to the image \(f(\mathbb{R})\) of \(f\):</p>

\[\mathbb{R} / \mathbb{K}_f \href{#group-isomorphisms}{\cong} f(\mathbb{R})\]

  <p><a href="https://en.wikipedia.org/wiki/Isomorphism_theorems#Theorem_A_(rings)">This theorem</a>
has some interesting <a href="https://en.wikipedia.org/wiki/Edge_case">edge cases</a>.
If the ideal (and thus the kernel) is the ring itself, all elements are mapped to zero,
and the quotient ring is isomorphic to the <a href="#zero-ring">zero ring</a>: \(\mathbb{R} / \mathbb{R} \cong \{0\}\).
(This is the case if the multiplicative identity belongs to the ideal.)
On the other hand, if the ideal contains only zero,
the quotient ring is isomorphic to the ring itself: \(\mathbb{R} / \{0\} \cong \mathbb{R}\).</p>

  <p>In the scope of this article, we’re interested only in integers <a href="#modulo-operation">modulo</a> an integer \(m\),
where we have \(\mathbb{Z} / m \mathbb{Z} \cong \mathbb{Z}_m\).
As noted <a href="#ideals">above</a>, \(m \mathbb{Z}\) is the ideal which consists of all multiples of \(m\).
In the case of \(m = 3\), we can visualize what we learned as follows:</p>

  <figure>
    <svg id="figure-quotient-ring" data-name="quotient-ring" width="253.167" height="387.25" viewBox="-1.25 -28 253.167 387.25" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <rect x="0" y="0" width="154.667" height="116" rx="8" ry="8"></rect>
    <text text-anchor="start">
        <tspan x="12" y="63.9"><tspan>3ℤ = 𝕂<tspan dy="3">f</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <rect x="218.667" y="42" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="234.667" y="63.9"><tspan>0</tspan></tspan>
    </text>
    <rect x="80.667" y="42" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="96.667" y="63.9"><tspan>…</tspan></tspan>
    </text>
    <line x1="131.479" y1="21" x2="217.417" y2="58" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="5" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="26.9"><tspan>−3</tspan></tspan>
    </text>
    <line x1="149.979" y1="58" x2="217.417" y2="58" marker-end="url(#arrow-pink)" stroke-dasharray="60"></line>
    <rect x="117.667" y="42" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="133.667" y="63.9"><tspan>0</tspan></tspan>
    </text>
    <line x1="131.479" y1="95" x2="217.417" y2="58" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="79" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="100.9"><tspan>3</tspan></tspan>
    </text>
    <rect x="0" y="121" width="154.667" height="116" rx="8" ry="8"></rect>
    <text text-anchor="start">
        <tspan x="12" y="184.9"><tspan>3ℤ + 1</tspan></tspan>
    </text>
    <rect x="218.667" y="163" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="234.667" y="184.9"><tspan>1</tspan></tspan>
    </text>
    <rect x="80.667" y="163" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="96.667" y="184.9"><tspan>…</tspan></tspan>
    </text>
    <line x1="131.479" y1="142" x2="217.417" y2="179" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="126" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="147.9"><tspan>−2</tspan></tspan>
    </text>
    <line x1="149.979" y1="179" x2="217.417" y2="179" marker-end="url(#arrow-pink)" stroke-dasharray="60"></line>
    <rect x="117.667" y="163" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="133.667" y="184.9"><tspan>1</tspan></tspan>
    </text>
    <line x1="131.479" y1="216" x2="217.417" y2="179" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="200" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="221.9"><tspan>4</tspan></tspan>
    </text>
    <rect x="0" y="242" width="154.667" height="116" rx="8" ry="8"></rect>
    <text text-anchor="start">
        <tspan x="12" y="305.9"><tspan>3ℤ + 2</tspan></tspan>
    </text>
    <rect x="218.667" y="284" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="234.667" y="305.9"><tspan>2</tspan></tspan>
    </text>
    <rect x="80.667" y="284" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="96.667" y="305.9"><tspan>…</tspan></tspan>
    </text>
    <line x1="131.479" y1="263" x2="217.417" y2="300" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="247" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="268.9"><tspan>−1</tspan></tspan>
    </text>
    <line x1="149.979" y1="300" x2="217.417" y2="300" marker-end="url(#arrow-pink)" stroke-dasharray="60"></line>
    <rect x="117.667" y="284" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="133.667" y="305.9"><tspan>2</tspan></tspan>
    </text>
    <line x1="131.479" y1="337" x2="217.417" y2="300" marker-end="url(#arrow-pink)" stroke-dasharray="87"></line>
    <rect x="99.167" y="321" width="32" height="32" rx="8" ry="8"></rect>
    <text text-anchor="middle">
        <tspan x="115.167" y="342.9"><tspan>5</tspan></tspan>
    </text>
    <text text-anchor="start">
        <tspan x="12" y="-15.1"><tspan>ℤ / 3ℤ</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="115.167" y="-15.1"><tspan>ℤ</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="173.667" y="-15.1"><tspan>f(x) = x % 3</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="234.667" y="-15.1"><tspan>ℤ<tspan dy="3">3</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>

The homomorphism \(f(x) = x\ \href{#modulo-operation}{\%}\ 3\) maps the elements of the infinite ring \(\mathbb{Z}\) (in blue)
to the elements of the finite ring \(\mathbb{Z}_3\) (in green).
All and only the multiples of \(3\) are mapped to \(0\),
which means that \(\mathbb{K}_f = 3 \mathbb{Z}\), which is an infinite ideal.
The cosets of this ideal are the elements of the quotient ring \(\mathbb{Z} / 3 \mathbb{Z}\) (in purple).
Since the elements of each coset are mapped to a distinct element of \(\mathbb{Z}_3\),
we have \(\mathbb{Z} / 3 \mathbb{Z} \cong \mathbb{Z}_3\).

</figcaption>
  </figure>

</details>

<details>
  <summary id="quotient-groups">
Quotient groups
</summary>

  <p>The <a href="#ring-axioms">ring</a>-related concepts from the previous boxes
have <a href="#group-axioms">group</a>-related equivalents:</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th><a href="https://en.wikipedia.org/wiki/Ring_(algebra)">Ring</a></th>
          <th><a href="https://en.wikipedia.org/wiki/Group_(mathematics)">Group</a></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Ring_homomorphism">Ring homomorphism</a></td>
          <td><a href="https://en.wikipedia.org/wiki/Group_homomorphism">Group homomorphism</a></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Kernel_(algebra)#Ring_homomorphisms">Kernel</a> as preimage of \(0\)</td>
          <td><a href="https://en.wikipedia.org/wiki/Kernel_(algebra)#Group_homomorphisms">Kernel</a> as preimage of \(E\)</td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)">Two-sided ideal</a></td>
          <td><a href="https://en.wikipedia.org/wiki/Normal_subgroup">Normal subgroup</a></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Quotient_ring">Quotient ring</a></td>
          <td><a href="https://en.wikipedia.org/wiki/Quotient_group">Quotient group</a></td>
        </tr>
      </tbody>
    </table>

    <figcaption>

An overview of ring- and group-related concepts.

</figcaption>
  </figure>

  <p>Just like an additive subgroup of a ring has to satisfy an additional requirement to be an <a href="#ideals">ideal</a>,
a <a href="#subgroups">subgroup</a> \(\mathbb{H}\) of a group \(\mathbb{G}\) is a normal subgroup
<a href="#if-and-only-if">if and only if</a> the <a href="#subgroup-cosets">left coset</a> \(G \circ \mathbb{H}\)
equals the <a href="#subgroup-cosets">right coset</a> \(\mathbb{H} \circ G\) for all \(G \in \mathbb{G}\).
In <a href="#commutative-groups">commutative groups</a>, every subgroup is normal.
There’s a great explanation on why we need this condition for non-commutative groups
<a href="https://math.stackexchange.com/a/14315/947937">on Stack Exchange</a>.
See also <a href="https://www.quora.com/What-are-some-examples-of-subgroups-of-non-abelian-groups-that-are-normal-and-others-that-are-not-normal/answer/Alon-Amit">this answer on Quora</a>,
which introduces <a href="https://en.wikipedia.org/wiki/Conjugacy_class">conjugacy classes</a>.
Both answers use the <a href="https://en.wikipedia.org/wiki/Symmetric_group">symmetric group</a> \(\mathrm{S}_3\) as an example.</p>

</details>

<h2 id="finite-fields">Finite fields</h2>

<h3 id="field-axioms">Field axioms</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Field_(mathematics)">field</a> is a <a href="#ring-axioms">commutative ring</a>
where all non-zero elements are <a href="#units-and-zero-divisors">units</a> (i.e. have a multiplicative inverse)
and \(0 ≠ 1\).
While the elements of a ring form a <a href="#commutative-groups">commutative group</a> only under addition,
the non-zero elements of a field form a commutative group also under multiplication.
Even though most of it is repetition,
we can state the <a href="https://en.wikipedia.org/wiki/Field_(mathematics)#Classic_definition">field axioms</a>
for a <a href="#notation-for-sets-and-elements">set</a> \(\mathbb{F}\)
and two <a href="https://en.wikipedia.org/wiki/Binary_operation">binary operations</a>,
called <a href="https://en.wikipedia.org/wiki/Addition">addition (+)</a>
and <a href="https://en.wikipedia.org/wiki/Multiplication">multiplication (·)</a>, as follows
(written in a compact notation using <a href="#universal-and-existential-quantifiers">universal and existential quantifiers</a>):</p>
<ul>
  <li>The elements of the field form a commutative <a href="#group-axioms">group</a> under addition:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Closure_(mathematics)"><strong>Closure</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{F}\ a + b \in \mathbb{F}\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Associative_property"><strong>Associativity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{F}\ (a + b) + c = a + (b + c)\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Identity_element"><strong>Identity</strong></a>:
<!-- --> \(\exists\ 0 \in \mathbb{F}\ \forall\ a \in \mathbb{F}\ a + 0 = a\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Inverse_element"><strong>Invertibility</strong></a>:
<!-- --> \(\forall\ a \in \mathbb{F}\ \exists\ {-}a \in \mathbb{F}\ a + (-a) = 0\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Commutative_property"><strong>Commutativity</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{F}\ a + b  = b + a\)</li>
    </ul>
  </li>
  <li>The non-zero elements of the field form a commutative <a href="#group-axioms">group</a> under multiplication:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Closure_(mathematics)"><strong>Closure</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{F}\ a \cdot b \in \mathbb{F}\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Associative_property"><strong>Associativity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{F}\ (a \cdot b) \cdot c = a \cdot (b \cdot c)\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Identity_element"><strong>Identity</strong></a>:
<!-- --> \(\exists\ 1 \in \mathbb{F}\ \forall\ a \in \mathbb{F}\ a \cdot 1 = a\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Inverse_element"><strong>Invertibility</strong></a>:
<!-- --> \(\forall\ a \in \href{https://en.wikipedia.org/wiki/Complement_(set_theory)}{\mathbb{F} \setminus \{0\}} \ \exists\ a^{-1} \in \mathbb{F}\ a \cdot a^{-1} = 1\)</li>
      <li><a href="https://en.wikipedia.org/wiki/Commutative_property"><strong>Commutativity</strong></a>:
<!-- --> \(\forall\ a, b \in \mathbb{F}\ a \cdot b  = b \cdot a\)</li>
    </ul>
  </li>
  <li>Multiplication distributes over addition:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Distributive_property"><strong>Distributivity</strong></a>:
<!-- --> \(\forall\ a, b, c \in \mathbb{F}\ a \cdot (b + c) = a \cdot b + a \cdot c\)</li>
    </ul>
  </li>
  <li>The additive identity is different from the multiplicative identity:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Zero_ring#Properties"><strong>Non-triviality</strong></a>:
<!-- --> \(0 ≠ 1\)</li>
    </ul>
  </li>
</ul>

<details>
  <summary id="infinite-fields">
Infinite fields
</summary>

  <p>Examples for infinite fields are the <a href="https://en.wikipedia.org/wiki/Rational_number">rational numbers \(\mathbb{Q}\)</a>,
the <a href="https://en.wikipedia.org/wiki/Real_number">real numbers \(\mathbb{R}\)</a>,
and the <a href="https://en.wikipedia.org/wiki/Complex_number">complex numbers \(\mathbb{C}\)</a>.</p>

</details>

<details>
  <summary id="multiplicative-group-of-a-field">
Multiplicative group of a field
</summary>

  <p>Given that I quantified the various multiplication axioms over different sets,
it’s admittedly not obvious why the non-zero elements of a field form a group under multiplication.
Clearly, if associativity, identity, and commutativity hold for all the elements of a field,
then they also hold for a subset of them.
Since every field is a ring, multiplication by \(0\) always <a href="#multiplication-by-zero">results in \(0\)</a>.
Therefore, the inverse of a non-zero element is another non-zero element because you wouldn’t get \(1\) otherwise.
As we saw <a href="#units-and-zero-divisors">above</a> and will prove again <a href="#no-non-trivial-zero-divisors">below</a>,
invertibility implies that there are no non-trivial zero divisors.
Consequently, the product of two non-zero elements is another non-zero element,
which means that the non-zero elements are closed under multiplication.</p>

</details>

<details>
  <summary id="commutativity-of-addition">
Commutativity of addition
</summary>

  <p>Strictly speaking, commutativity of addition is not required as an axiom
because <a href="https://people.reed.edu/~mayer/math112.html/html1/node17.html#commfield">it follows from the other axioms</a>.</p>

</details>

<h3 id="integers-modulo-p">Integers modulo p</h3>

<p>The <a href="#ring-axioms">ring</a> <a href="#integers-modulo-m">\(\mathbb{Z}_m\)</a> is a field
<a href="#if-and-only-if">if and only if</a> the modulus \(m\) is <a href="#prime-factorization">prime</a>.
As we saw <a href="#multiplicative-inverse-revisited">earlier</a>,
an integer has a <a href="#modular-multiplicative-inverse">multiplicative inverse modulo \(m\)</a>
if and only if it is <a href="#prime-factorization">coprime</a> with \(m\).
If \(m\) is prime, then all the positive integers smaller than \(m\) are relatively prime to \(m\).
If \(m\) is composite, its factors are <a href="#units-and-zero-divisors">zero divisors</a>,
which prevents \(\mathbb{Z}_m\) from being a field.
Excluding non-coprime integers from the field as we did in the case of <a href="#multiplicative-groups">multiplicative groups</a>
no longer works because repeatedly adding \(1\) to itself <a href="#group-generators">generates</a>
all the integers from \(0\) to \(m - 1\).
Put differently, filtering non-coprime integers breaks the closure of addition.
I added such a filtering option to the <a href="#additive-group-operation-table">operation table of additive groups</a>
just so that you can convince yourself that this is indeed the case.
In the case of integers modulo a prime number \(p\), both the <a href="#additive-groups">additive group</a>
and the <a href="#multiplicative-groups">multiplicative group</a> are <a href="#cyclic-groups">cyclic</a>.
As explained <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">earlier</a>,
the multiplicative group of a finite field is always cyclic.
In the article about coding theory,
we will extend these so-called <a href="https://en.wikipedia.org/wiki/Finite_field#Properties">prime fields</a> and see
that the additive group of a proper <a href="https://en.wikipedia.org/wiki/Field_extension">extension field</a> is not cyclic.</p>

<h3 id="field-notation">Field notation</h3>

<p>We are interested only in <a href="https://en.wikipedia.org/wiki/Finite_field">finite fields</a>,
i.e. fields which contain a finite number of elements.
Finite fields are also called Galois fields (<abbr title="Galois Field">GF</abbr>),
named after <a href="https://en.wikipedia.org/wiki/%C3%89variste_Galois">Évariste Galois</a> (1811 − 1832),
who died at the age of 20 in a <a href="https://en.wikipedia.org/wiki/Duel">duel</a>.
The number of elements in a finite field is called its <a href="#group-order">order</a>.
Without explaining why, the order of a finite field is always a <a href="https://en.wikipedia.org/wiki/Prime_power">prime power</a>,
and all the finite fields of the same order are <a href="#homomorphisms">isomorphic</a> to one another.
Given \(q = p^e\), where \(p\) is a prime number and \(e\) is a positive integer,
the unique field of order \(q\) is denoted as \(\mathbb{F}_q\) or \(GF(q)\).
For integers modulo a prime number, I will also use \(\mathbb{Z}_p\),
where \(p\) indicates that the modulus is <a href="#prime-factorization">prime</a>.</p>

<h3 id="derived-field-properties">Derived properties</h3>

<p>Many properties, such as that the additive identity and the multiplicative identity are unique
or that the additive inverse and the multiplicative inverse of an element are unique,
follow from the fact that addition and multiplication (in the latter case without \(0\))
form <a href="#derived-group-properties">groups</a>.
Since every <a href="#field-axioms">field</a> is a <a href="#ring-axioms">ring</a>,
the <a href="#derived-ring-properties">properties we proved for rings</a> still apply.
Other consequences of the field axioms are:</p>

<h4 id="multiplicative-inverse-of-minus-one">Multiplicative inverse of minus one</h4>

\[\boxed{\, (-1)^{-1} = -1 \, \vphantom{\large |}}\]

\[\begin{aligned}
-(-1) &amp;= (-1) \cdot (-1) &amp;&amp; \textsf{as proven \href{#multiplication-by-minus-one}{above}, where } a = -1 \\
1 &amp;= (-1) \cdot (-1) &amp;&amp; \textsf{using the \href{#double-inverse-theorem}{double inverse theorem}} \\
1 \cdot (-1)^{-1} &amp;= (-1) \cdot (-1) \cdot (-1)^{-1} &amp;&amp; \textsf{multiplying both sides by } (-1)^{-1} \\
(-1)^{-1} &amp;= -1 &amp;&amp; \textsf{simplifying both sides as usual}
\end{aligned}\]

<h4 id="multiplicative-inverse-of-additive-inverse">Multiplicative inverse of additive inverse</h4>

\[\boxed{\, \forall\ a \in \mathbb{F}\ (-a)^{-1} = -(a^{-1}) \, \vphantom{\large |}}\]

\[\begin{aligned}
(-a)^{-1} &amp;= ((-1) \cdot a)^{-1} &amp;&amp; \textsf{using \href{#multiplication-by-minus-one}{multiplication by minus one}} \\
&amp;= (-1)^{-1} \cdot a^{-1} &amp;&amp; \textsf{using \href{#inversion-of-combination}{inversion of combination}} \\
&amp;= (-1) \cdot a^{-1} &amp;&amp; \textsf{using \href{#multiplicative-inverse-of-minus-one}{multiplicative inverse of minus one}} \\
&amp;= -(a^{-1}) &amp;&amp; \textsf{using \href{#multiplication-by-minus-one}{multiplication by minus one}}
\end{aligned}\]

<p>Stated in words, the multiplicative inverse of the additive inverse is the same
as the additive inverse of the multiplicative inverse for every element of every field.
What we knew from the rational numbers with ordinary division
(\(\tfrac{1}{-a} = -\tfrac{1}{a}\)) thus holds in any field.</p>

<h4 id="no-non-trivial-zero-divisors">No non-trivial zero divisors</h4>

\[\boxed{\, \forall\ a, b \in \mathbb{F} \enspace a \cdot b = 0 \implies a = 0 \lor b = 0 \, \vphantom{\large |}}\]

<p>If \(a = 0\), the above <a href="#material-implication">implication</a> is true.
If \(a \neq 0\), then \(a\) has a multiplicative inverse, and thus</p>

\[\begin{aligned}
a \cdot b &amp;= 0 &amp;&amp; \textsf{starting with the premise of the above statement} \\
a^{-1} \cdot a \cdot b &amp;= a^{-1} \cdot 0 &amp;&amp; \textsf{multiplying both sides by } a^{-1} \\
b &amp;= 0 &amp;&amp; \textsf{simplifying both sides as usual,}
\end{aligned}\]

<p>which makes \(a = 0 \lor b = 0\) true in the other case as well.
This is also known as the <a href="https://en.wikipedia.org/wiki/Zero-product_property">zero-product property</a>.</p>

<details>
  <summary id="material-implication">
Material implication \(\implies\)
</summary>

  <p>The implication operator \(\implies\) is a
<a href="https://en.wikipedia.org/wiki/Truth_function#Table_of_binary_truth_functions">binary truth function</a>
with the following <a href="https://en.wikipedia.org/wiki/Truth_table">truth table</a>
(using <a href="https://en.wikipedia.org/wiki/Tee_(symbol)">\(\top\)</a> for true
and <a href="https://en.wikipedia.org/wiki/Up_tack">\(\bot\)</a> for false):</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>\(P\)</th>
          <th>\(Q\)</th>
          <th>\(P \implies Q\)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
      </tbody>
    </table>

    <figcaption>
The definition of \(\implies\).
</figcaption>
  </figure>

  <p>The technical term for this operation is <a href="https://en.wikipedia.org/wiki/Material_conditional">material implication</a>
in order to distinguish it from how we use the term “implication” in everyday language.
In logic, implication does not require <a href="https://en.wikipedia.org/wiki/Causality">causation</a>.
For example, \(7 \text{ is odd} \implies 3 \text{ is prime}\) is a true statement.</p>

</details>

<details>
  <summary id="logical-disjunction">
Logical disjunction \(\lor\)
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Logical_disjunction">logical disjunction \(\lor\)</a> (“or”) is true
<a href="#if-and-only-if">if and only if</a> one of the operands are true (\(\htmlClass{color-green}{\top}\))
instead of false (\(\htmlClass{color-red}{\bot}\)):</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>\(P\)</th>
          <th>\(Q\)</th>
          <th>\(P \lor Q\)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
      </tbody>
    </table>

    <figcaption>
The definition of \(\lor\).
</figcaption>
  </figure>

</details>

<h4 id="solutions-of-squares">Solutions of squares</h4>

\[\boxed{\, \forall\ a, b \in \mathbb{F}\ a^2 = b^2 \iff a = b \lor a = -b \, \vphantom{\large |}}\]

\[\begin{aligned}
a^2 = b^2 &amp;\iff a^2 - b^2 = 0 &amp;&amp; \textsf{subtracting } b^2 \textsf{ from both sides} \\
&amp;\iff (a - b) \cdot (a + b) = 0 &amp;&amp; \textsf{using distributivity and commutativity} \\
&amp;\iff a - b = 0 \lor a + b = 0 &amp;&amp; \textsf{using \href{#no-non-trivial-zero-divisors}{no non-trivial zero divisors}} \\
&amp;\iff a = b \lor a = -b &amp;&amp; \textsf{taking } b \textsf{ to the other side}
\end{aligned}\]

<!-- -->
<p>\(\iff\) stands for <a href="#if-and-only-if">material equivalence (“if and only if”)</a>.
The above theorem states that any two elements which result in the same element when being squared
differ at most in their <a href="https://en.wikipedia.org/wiki/Sign_(mathematics)">sign</a>
(i.e. one is the additive inverse of the other if they are not equal).
Therefore, the equation \(x^2 = c\) has at most two solutions for a given element \(c\).
(If \(c = 0\), there is only one solution, namely \(0\),
and as we will see in the <a href="#quadratic-residues">next section</a>,
there is no solution for half of the non-zero elements.)
A different way to see this is that in a field,
the polynomial \(f(x) = x^2 - c\) of degree two can have at most two solutions,
as mentioned but not yet proved <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">earlier</a>.</p>

<details>
  <summary id="yet-another-proof">
Yet another proof
</summary>

  <p>In the <a href="#integers-modulo-p">field of integers modulo a prime \(p\)</a>,
the only square roots of \(1\) are \(1\) and \(-1\) due to <a href="#euclids-lemma">Euclid’s lemma</a>
as we saw <a href="#miller-rabin-primality-test">earlier</a>.
Thus:</p>

\[a^2 =_p b^2 \iff a^2 / b^2 =_p 1 \iff (a/b)^2 =_p 1 \iff a/b =_p ±1 \iff a =_p ±b\]

</details>

<h3 id="quadratic-residues">Quadratic residues</h3>

<p>An integer \(a\) is called a <a href="https://en.wikipedia.org/wiki/Quadratic_residue">quadratic residue</a>
<a href="#modulo-operation">modulo</a> \(m\) if there exists an integer \(x\) so that \(a =_m x^2\).
If no such integer exists, \(a\) is called a <a href="#non-quadratic-residue">quadratic non-residue</a>.
Just like \(1\) is technically prime but <a href="#the-integer-1">excluded from the set of prime numbers</a>
to make theorems involving prime numbers easier,
<!-- --> \(0\) is technically a quadratic residue but excluded from the set of quadratic residues
to make theorems about quadratic residues and non-residues easier.
Given this definition and an odd prime number \(p\),
there are as many quadratic residues modulo \(p\) as quadratic non-residues modulo \(p\).
As we saw in the <a href="#solutions-of-squares">previous paragraph</a>,
the square of an integer equals the square of its additive inverse in any <a href="#field-axioms">field</a>,
including the field <a href="#field-notation">\(\mathbb{Z}_p\)</a>.
Therefore, there are at most \(\frac{p - 1}{2}\) quadratic residues modulo \(p\):</p>

\[\begin{aligned}
1^2 &amp;=_p (p - 1)^2 \\
2^2 &amp;=_p (p - 2)^2 \\
&amp;\enspace \vdots \\
(\frac{p - 1}{2})^2 &amp;=_p (\frac{p + 1}{2})^2
\end{aligned}\]

<p>Since any two elements of the field which result in the same element when being squared
differ <a href="#solutions-of-squares">at most in their sign</a>,
these \(\frac{p - 1}{2}\) squares are all different.
Not accounting for \(0\), all the other \(\frac{p - 1}{2}\) elements in \(\mathbb{Z}_p\) are quadratic non-residues.</p>

<details>
  <summary id="non-quadratic-residue">
Non-quadratic residue
</summary>

  <p>It would make much more sense to use the term “non-quadratic residue” instead of “quadratic non-residue”
for the integers which are not a residue of a <a href="https://en.wikipedia.org/wiki/Square_number">square number</a>.
<a href="https://en.wikipedia.org/wiki/Gauss">Gauss</a> is to blame for this.
He’s the one who introduced the terms “quadratic residue” and “quadratic non-residue”
(respectively their <a href="https://en.wikipedia.org/wiki/Latin">Latin</a> sources “residua quadratica” and
<a href="https://la.wikisource.org/wiki/Disquisitiones_arithmeticae/Sectio_quarta">“non-residua quadratica”</a>)
in his book <a href="https://en.wikipedia.org/wiki/Disquisitiones_Arithmeticae">Disquisitiones Arithmeticae</a> in 1801.
These terms have been used since then,
often even without “quadratic” if it’s clear from the context what “residue” and “non-residue” refer to.
Furthermore, “nonresidue” is frequently written without a <a href="https://en.wikipedia.org/wiki/Hyphen">hyphen</a>.</p>

</details>

<details>
  <summary id="proof-using-group-theory">
Proof using group theory
</summary>

  <p>Given the <a href="#field-axioms">field</a> <a href="#field-notation">\(\mathbb{Z}_p\)</a> of integers modulo an odd prime \(p\),
we denote its <a href="#multiplicative-groups">multiplicative group</a>,
which consists of all its elements except \(0\), as <a href="#multiplicative-group-notations">\(\mathbb{Z}_p^\times\)</a>.
The squaring function \(f(x) =_p x^2\) is a <a href="#homomorphisms">group homomorphism</a>
because \(f(a \cdot b) =_p (a \cdot b)^2 =_p a^2 \cdot b^2 =_p f(a) \cdot f(b)\).
As a consequence, the <a href="https://en.wikipedia.org/wiki/Image_(mathematics)">image of this function</a>
– the set of quadratic residues — is a <a href="#subgroups">subgroup</a> of \(\mathbb{Z}_p^\times\).
The <a href="#kernel">kernel</a> \(\mathbb{K}_f\) of this homomorphism is \(\{1, -1\}\).
<!-- --> \(f\) maps two inputs \(a\) and \(b\) to the same output <a href="#if-and-only-if">if and only if</a>
they belong to the same <a href="#subgroup-cosets">coset</a> \(\mathbb{K}_f\):
<!-- --> \(a^2 =_p b^2 \iff a^2 / b^2 =_p 1 \iff (a / b)^2 =_p 1
\iff a / b \in \mathbb{K}_f \iff a \in \mathbb{K}_f \cdot b\).
Since \(|\mathbb{K}_f| = 2\) and all cosets are of the same size,
always two elements are mapped to the same output,
which means that half of all elements are quadratic residues.
This is no surprise since we already proved <a href="#solutions-of-squares">earlier</a>
that every element of the <a href="https://en.wikipedia.org/wiki/Image_(mathematics)">function’s image</a>
has exactly two <a href="https://en.wikipedia.org/wiki/Image_(mathematics)#Inverse_image">preimages</a>.</p>

</details>

<details>
  <summary id="products-of-residues-and-non-residues">
Products of residues and non-residues
</summary>

  <p>The following table summarizes what you get
when you multiply quadratic residues and non-residues modulo an odd prime \(p\):</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>Factor 1</th>
          <th>·</th>
          <th>Factor 2</th>
          <th>=</th>
          <th>Product</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Residue</td>
          <td> </td>
          <td>Residue</td>
          <td> </td>
          <td>Residue</td>
        </tr>
        <tr>
          <td>Residue</td>
          <td> </td>
          <td>Non-residue</td>
          <td> </td>
          <td>Non-residue</td>
        </tr>
        <tr>
          <td>Non-residue</td>
          <td> </td>
          <td>Residue</td>
          <td> </td>
          <td>Non-residue</td>
        </tr>
        <tr>
          <td>Non-residue</td>
          <td> </td>
          <td>Non-residue</td>
          <td> </td>
          <td>Residue</td>
        </tr>
      </tbody>
    </table>

    <figcaption>

The possible products of residues and non-residues.

</figcaption>
  </figure>

  <p>Given that multiplication of integers is <a href="#commutative-groups">commutative</a>,
there are <a href="https://www.quora.com/Prove-the-product-of-two-quadratic-non-residues-is-a-quadratic-residue-mod-p-p-prime/answer/Yang-Yan-1">three cases to analyze</a>:</p>
  <ol>
    <li><strong>Residue · residue</strong>:
The set of quadratic residues is closed under multiplication because for any residues \(a^2\) and \(b^2\),
their product \(a^2 \cdot b^2 =_p (a \cdot b)^2\) is another quadratic residue.
(We already saw in the <a href="#proof-using-group-theory">previous box</a> that
the quadratic residues form a <a href="#subgroups">subgroup</a> of <a href="#multiplicative-group-notations">\(\mathbb{Z}_p^\times\)</a>.
Since \(1^2 =_p 1\), \(1\) is a residue.
And the inverse of a residue is another residue: \((a^2)^{-1} =_p (a^{-1})^2\).)</li>
    <li><strong>Residue · non-residue</strong>:
Since \(\mathbb{Z}_p^\times\) is a <a href="#multiplicative-groups">multiplicative group</a>,
the function \(f(x) =_p a \cdot x\) is a <a href="#permutations">permutation</a> for any \(a \in \mathbb{Z}_p^\times\)
(i.e. distinct inputs are mapped to <a href="#unique-result">distinct outputs</a>).
Since we know that exactly half of all elements in \(\mathbb{Z}_p^\times\) are residues
and that the product of two residues is another residue,
the function \(f(x) =_p b \cdot x\) has to map all non-residues to non-residues for any residue \(b\).
If just a single non-residue was mapped to a residue, more than half of all outputs would be residues.</li>
    <li><strong>Non-residue · non-residue</strong>:
Since the product of a residue and a non-residue is a non-residue,
the function \(f(x) =_p c \cdot x\) has to map all non-residues to residues for any non-residue \(c\).
If just a single non-residue was mapped to a non-residue, more than half of all outputs would be non-residues.</li>
  </ol>

  <p>The second point can also be proven as follows:
Let \(b\) be a residue and \(c\) be a non-residue.
If \(b \cdot c\) was a residue, \(b^{-1} \cdot b \cdot c =_p c\) would be a residue according to the first point,
which is a <a href="https://en.wikipedia.org/wiki/Proof_by_contradiction">contradiction</a>.
Therefore, \(b \cdot c\) has to be a non-residue.</p>

  <p>The second and the third case <a href="https://www.quora.com/Prove-the-product-of-two-quadratic-non-residues-is-a-quadratic-residue-mod-p-p-prime/answer/Jack-Huizenga">can also be derived</a>
using our <a href="#advanced-concepts">advanced group concepts</a>:
Let \(\mathbb{S}_p\) denote the subgroup of quadratic residues modulo the odd prime \(p\),
then the quadratic non-residues are a <a href="#subgroup-cosets">coset</a> of \(\mathbb{S}_p\).
Let’s call this coset of non-residues \(\mathbb{T}_p\),
then \(\mathbb{S}_p \cdot s = \mathbb{S}_p\) for any \(s \in \mathbb{S}_p\),
and \(\mathbb{S}_p \cdot t = \mathbb{T}_p\) for any \(t \in \mathbb{T}_p\).
Now \(\mathbb{S}_p\) can also be interpreted as a <a href="#kernel">kernel</a>,
where the resulting <a href="#quotient-groups">quotient group</a> \(\mathbb{Z}_p^\times / \mathbb{S}_p\)
consists of the elements \(\mathbb{S}_p\) and \(\mathbb{T}_p\),
where \(\mathbb{S}_p\) is the identity element and the <a href="#group-order">order of the group</a> is \(2\).
Since the <a href="#element-order">order</a> of \(\mathbb{T}_p\) cannot be greater than \(2\),
we have \(\mathbb{T}_p \cdot \mathbb{T}_p = \mathbb{S}_p\).
This means
that \(\mathbb{Z}_p^\times / \mathbb{S}_p \href{#group-isomorphisms}{\cong} \href{#additive-group-notations}{\mathbb{Z}_2^+}\)
as <a href="#lagrange-consequences">groups of prime order are cyclic</a>
and <a href="#isomorphism-of-cyclic-groups">cyclic groups are isomorphic to the additive group of the same order</a>.</p>

  <p>For the above table to be correct, \(0\) has to be excluded from the set of quadratic residues.
Otherwise, a residue times a non-residue can result in a residue
because <a href="#multiplication-by-zero">\(0\) times any number is \(0\)</a>.
|residues| = |non-residues| wouldn’t hold either otherwise.</p>

</details>

<h3 id="eulers-criterion">Euler’s criterion</h3>

<p>Given an odd prime \(p\), there’s a simple formula for determining whether an integer \(a\)
is a <a href="#quadratic-residues">quadratic residue modulo \(p\)</a>:</p>

\[a^\frac{p - 1}{2} =_p \begin{cases}
1 &amp;\text{if } a \text{ is a quadratic residue modulo } p \text{,} \\
-1 &amp;\text{if } a \text{ is a quadratic non-residue modulo } p \text{,} \\
0 &amp;\text{if } a \text{ is a multiple of } p \text{.}
\end{cases}\]

<p>This is known as <a href="https://en.wikipedia.org/wiki/Euler%27s_criterion">Euler’s criterion</a>,
named after <a href="https://en.wikipedia.org/wiki/Leonhard_Euler">Leonhard Euler</a> (1707 − 1783).
According to <a href="#fermats-little-theorem">Fermat’s little theorem</a>,
<!-- --> \(a^{p - 1} - 1 =_p 0\) for all integers \(a\) which are coprime with \(p\).
Since \(p\) is odd, \(p - 1\) is even.
Thus, the previous equation can be factored as follows:</p>

\[\big(a^\frac{p - 1}{2} - 1\big) \cdot \big(a^\frac{p - 1}{2} + 1\big) =_p 0\]

<p>For every \(a \in \mathbb{Z}_p\) except \(0\),
either the first or the second factor has to be \(0\)
because a field has <a href="#no-non-trivial-zero-divisors">no non-trivial zero divisors</a>.
If \(a\) is a quadratic residue, there is an integer \(x\) so that \(a =_p x^2\).
Since Fermat’s little theorem holds for \(x\) as well, we have:</p>

\[a^\frac{p - 1}{2} =_p (x^2)^\frac{p - 1}{2} =_p x^{p - 1} =_p 1\]

<p>Therefore, the first factor is \(0\) for the <a href="#quadratic-residues">\(\frac{p - 1}{2}\)</a> quadratic residues modulo \(p\).
Since \(f(a) =_p a^\frac{p - 1}{2} - 1\) can be \(0\) for at most \(\frac{p - 1}{2}\) elements of the field
as mentioned <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">earlier</a>,
the \(\frac{p - 1}{2}\) quadratic non-residues make the second factor \(0\).</p>

<details>
  <summary id="more-intuitive-proof">
More intuitive proof
</summary>

  <p>Since \(p\) is an odd prime, <a href="#multiplicative-group-notations">\(\mathbb{Z}_p^\times\)</a>
is <a href="#why-multiplicative-groups-modulo-a-prime-are-cyclic">cyclic</a> and its <a href="#group-order">order</a> is even.
In a <a href="#cyclic-groups">cyclic group</a> of even order,
an element \(A = G^a\) is a <a href="#quadratic-residues">quadratic residue</a>
<a href="#if-and-only-if">if and only if</a> the exponent \(a\) is even,
where \(G\) is a <a href="#group-generators">generator of the group</a>.
The reason for this is that a quadratic residue is of the form \(A = X^2 = (G^x)^2 = G^{2 \cdot x}\).
Since the <a href="#modular-arithmetic">modulus</a> \(p - 1\) of the <a href="#repetition-ring">repetition ring</a> is even,
wrapping around cannot make an even exponent odd,
i.e. \(2 \cdot x \text{ \href{#modulo-operation}{mod} } p - 1\) is still even.
This can be visualized as follows:</p>

  <figure>
    <svg id="figure-eulers-criterion" data-name="eulers-criterion" width="267.199" height="265.5" viewBox="-134.449 -132.75 267.199 265.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <circle cx="0" cy="0" r="90"></circle>
    <line x1="0" y1="-85" x2="0" y2="-95"></line>
    <line x1="49.962" y1="-68.766" x2="55.84" y2="-76.857"></line>
    <line x1="80.84" y1="-26.266" x2="90.35" y2="-29.357"></line>
    <line x1="80.84" y1="26.266" x2="90.35" y2="29.357"></line>
    <line x1="49.962" y1="68.766" x2="55.84" y2="76.857"></line>
    <line x1="0" y1="85" x2="0" y2="95"></line>
    <line x1="-49.962" y1="68.766" x2="-55.84" y2="76.857"></line>
    <line x1="-80.84" y1="26.266" x2="-90.35" y2="29.357"></line>
    <line x1="-80.84" y1="-26.266" x2="-90.35" y2="-29.357"></line>
    <line x1="-49.962" y1="-68.766" x2="-55.84" y2="-76.857"></line>
    <text text-anchor="middle">
        <tspan x="0" y="-114.1"><tspan>G<tspan dy="-6">p − 1</tspan><tspan dy="6">​</tspan> =<tspan dy="3">p</tspan><tspan dy="-3">​</tspan> G<tspan dy="-6">0</tspan><tspan dy="6">​</tspan> =<tspan dy="3">p</tspan><tspan dy="-3">​</tspan> 1</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70.534" y="-91.182"><tspan>G<tspan dy="-6">1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="114.127" y="-31.182"><tspan>G<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="114.127" y="42.982"><tspan>G<tspan dy="-6">3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70.534" y="102.982"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="125.9"><tspan>G<tspan dy="-6">(p − 1) / 2</tspan><tspan dy="6">​</tspan> =<tspan dy="3">p</tspan><tspan dy="-3">​</tspan> −1</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-70.534" y="102.982"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-114.127" y="42.982"><tspan>G<tspan dy="-6">p − 4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-114.127" y="-31.182"><tspan>G<tspan dy="-6">p − 3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-70.534" y="-91.182"><tspan>G<tspan dy="-6">p − 2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <path d="M 0,-60 A 60 60 0 0 1 0,60 L -0.009976,60.000688" marker-end="url(#arrow-blue)" stroke-dasharray="181"></path>
    <text text-anchor="middle">
        <tspan x="0" y="8.9"><tspan>ℤ</tspan><tspan><tspan dy="-6">×</tspan><tspan dy="6">​</tspan></tspan><tspan dx="-12">​</tspan><tspan><tspan dy="3">p</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>

The cyclic group \(\mathbb{Z}_p^\times\) with quadratic residues in green and quadratic non-residues in red.

</figcaption>
  </figure>

  <p>If you repeat any element \(p - 1\) times, you get the \(1\).
For the elements of the form \(A = X^2\), this is the case already after \(\frac{p - 1}{2}\) repetitions.
All other elements need to be squared one more time to get there
(i.e. to have an exponent which is a multiple of \(p - 1\)).
As explained <a href="#multiplicative-group-repetition-table">earlier</a>,
the element midway through the cycle is \(-1\).</p>

</details>

<details>
  <summary id="legendre-symbol">
Legendre symbol
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Adrien-Marie_Legendre">Adrien-Marie Legendre</a> (1752 − 1833)
introduced the following notation for <a href="#eulers-criterion">Euler’s criterion</a>,
called the <a href="https://en.wikipedia.org/wiki/Legendre_symbol">Legendre symbol</a>:</p>

\[\left(\frac{a}{p}\right) =_p a^\frac{p - 1}{2}\]

</details>

<details>
  <summary id="eulers-criterion-of-a-product">
Euler’s criterion of a product
</summary>

  <p>Given two integers \(a\) and \(b\),
<a href="#eulers-criterion">Euler’s criterion</a> of their product equals the product of their Euler’s criteria:
<!-- --> \((a \cdot b)^\frac{p - 1}{2} =_p a^\frac{p - 1}{2} \cdot b^\frac{p - 1}{2}\).
This makes it much easier to analyze whether the products of residues and non-residues
are <a href="#products-of-residues-and-non-residues">residues or non-residues</a>.</p>

</details>

<h3 id="square-roots">Square roots</h3>

<p>In the previous two sections, we learned what a <a href="#quadratic-residues">quadratic residue</a> is
and how we can determine whether an element is a quadratic residue using <a href="#eulers-criterion">Euler’s criterion</a>.
In this section, we want to compute a <a href="https://en.wikipedia.org/wiki/Square_root">square root</a> \(x\)
of a quadratic residue \(a\) <a href="#modulo-operation">modulo</a> an odd prime \(p\) so that \(x^2 =_p a\).
As shown <a href="#solutions-of-squares">earlier</a>, a square root of a field element is unique up to its sign.
We use the <a href="https://en.wikipedia.org/wiki/Radical_symbol">radical symbol</a>
and the <a href="https://en.wikipedia.org/wiki/Plus%E2%80%93minus_sign">plus-minus sign</a> to write this as \(\sqrt{a} =_p ±x\).
If \(p + 1\) is divisible by \(4\) (i.e. \(p =_4 3\)), we can compute the square root of \(a\) as follows:</p>

\[\sqrt{a} =_p ±a^\frac{p + 1}{4}
\quad \textsf{because} \quad
\big(±a^\frac{p + 1}{4}\big)^2 =_p a^\frac{p + 1}{2} =_p a \cdot a^\frac{p - 1}{2}
\href{#eulers-criterion}{=_p} a \cdot 1 =_p a\]

<p>The following tool implements this calculation.
In practice, it’s common to skip Euler’s criterion
and to verify simply whether the square of the output is equal to the input.
If \(p + 1\) is not divisible by \(4\) (i.e. \(p =_4 1\)),
you can use the <a href="#tonelli-shanks-algorithm">Tonelli-Shanks algorithm</a>.</p>



<details>
  <summary id="tonelli-shanks-algorithm">
Tonelli-Shanks algorithm
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm">Tonelli-Shanks algorithm</a>,
named after <a href="https://it.wikipedia.org/wiki/Alberto_Tonelli">Alberto Tonelli</a> (1849 − 1920)
and <a href="https://en.wikipedia.org/wiki/Daniel_Shanks">Daniel Shanks</a> (1917 − 1996),
finds a <a href="#square-roots">square root</a> \(x\) of a <a href="#quadratic-residues">quadratic residue</a> \(a\)
modulo any odd prime \(p\) by repeatedly adjusting an initial guess
with the help of any quadratic non-residue \(b\).
The best known algorithm for finding a quadratic non-residue is to compute <a href="#eulers-criterion">Euler’s criterion</a>
for random elements of the <a href="#field-axioms">field</a> <a href="#field-notation">\(\mathbb{Z}_p\)</a> until you find a non-residue.
Since <a href="#quadratic-residues">half of all elements are non-residues</a>,
it takes on average just two attempts to find a non-residue
(because this is a <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric distribution</a>
with a <a href="https://en.wikipedia.org/wiki/Bernoulli_trial">success probability</a> of \(\frac{1}{2}\)).
Since \(p\) is odd, \(p - 1\) is even and can be written as \(2^c \cdot d\),
where \(c &gt; 0\) and \(d\) is odd.
Given that \(a\) is a quadratic residue and \(b\) is a quadratic non-residue, we have:</p>

\[\begin{aligned}
p - 1 &amp;= 2^c \cdot d \\[2pt]
a^\frac{p - 1}{2} &amp;=_p a^{2^{c - 1} \cdot d} =_p (a^d)^{(2^{c - 1})} =_p 1 \\[2pt]
b^\frac{p - 1}{2} &amp;=_p b^{2^{c - 1} \cdot d} =_p (b^d)^{(2^{c - 1})} =_p -1
\end{aligned}\]

  <p>We set \(x =_p a^\frac{d + 1}{2}\) initially.
At the core of the algorithm is the expression \((x^2 \cdot a^{-1})^{(2^e)}\) with an exponent \(e\).
When \(e = c - 1\), the expression evaluates to \((x^2 \cdot a^{-1})^{(2^{c - 1})}
=_p ((a^\frac{d + 1}{2})^2 \cdot a^{-1})^{(2^{c - 1})}
=_p (a^{d + 1} \cdot a^{-1})^{(2^{c - 1})} =_p (a^d)^{(2^{c - 1})} =_p 1\).
Next, we want to decrement \(e\) while making sure that the expression keeps evaluating to \(1\).
If we can get \(e\) to \(0\) so that \((x^2 \cdot a^{-1})^{(2^e)} =_p x^2 \cdot a^{-1} =_p 1\),
then \(x\) is a square root of \(a\).
As explained when we discussed the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>,
<!-- --> \(1\) and \(-1\) are the only possible square roots of \(1\) modulo a prime number.
If the expression still evaluates to \(1\) for an \(e\) decremented by \(1\),
we can keep decrementing \(e\) if \(e\) is still greater than \(0\) without doing anything.
If, on the other hand, the expression evaluates to \(-1\) for some \(e &lt; c - 1\),
we have to adjust the value of \(x\) to keep the expression at \(1\).
You get from \(-1\) to \(1\) with a factor of \(-1\).
Since \(x\) is raised to the \(2^{e + 1}\)-th power,
we look for a value \(y\) such that \(y^{(2^{e + 1})} =_p -1\).
As it turns out, \(y = (b^d)^{(2^{c - e - 2})}\) does the trick
(\(c - e - 2 ≥ 0\) because \(e ≤ c - 2\) at this point):
<!-- --> \(((b^d)^{(2^{c - e - 2})})^{(2^{e + 1})} =_p (b^d)^{(2^{c - 1})} =_p -1\).
Therefore, multiplying \(x\) by \((b^d)^{(2^{c - e - 2})}\) brings the expression back to \(1\),
thereby maintaining our <a href="https://en.wikipedia.org/wiki/Loop_invariant">loop invariant</a>.
If we haven’t reached \(e = 0\), we decrement \(e\) again.</p>

  <p>The following tool implements the Tonelli-Shanks algorithm for arbitrarily large numbers.
To make the output deterministic, it searches for a quadratic non-residue in the natural order of the field’s elements.
In an <a href="#required-number-of-miller-rabin-rounds">adversarial context</a>,
this can affect the performance of the algorithm negatively.
If \(c = 1\), \(e = c - 1 = 0\) immediately,
which means that the initial \(x\) is the final \(x\), and thus the search for a quadratic non-residue can be skipped.
The tool displays the adjusted \(x\) only in the next row.
If the value in the third column is \(1\) (in green),
the same \(x\) is used in the next row and the value in the last column is ignored (in gray).
I included the ignored values in the last column anyway
so that you can see that the last column does not depend on the input \(a\)
and that it’s easier to observe that each value in the last column is the square of the value above it.
When you step through the quadratic residues of the field with the buttons next to the input \(a\),
you’ll see that \(x\) sometimes has to be adjusted in every step and other times not at all.
The algorithm presented here can be optimized in several ways.
For example, computing the multiplicative inverse of \(a\) can be avoided
(see <a href="https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm#Core_ideas">Wikipedia</a>),
but I think my version of the algorithm is the easiest one to understand.</p>

  

</details>

<details>
  <summary id="square-roots-modulo-composite-numbers">
Square roots modulo composite numbers
</summary>

  <p>Given an integer \(a\) and a composite modulus \(m\), how can we compute an \(x\) so that \(x^2 =_m a\)?
If we know the <a href="#prime-factorization">prime factorization</a> \(\prod_{i=1}^l p_i^{e_i}\) of \(m\),
we can determine a square root modulo each of the factors
<a href="#composite-groups">since</a> \(\mathbb{Z}_m \cong \mathbb{Z}_{p_1^{e_1}} \times … \times \mathbb{Z}_{p_l^{e_l}}\),
and then use the <a href="#chinese-remainder-theorem">Chinese remainder theorem</a> to revert the <a href="#group-isomorphisms">isomorphism</a>.
If we don’t know the prime factorization of \(m\), determining whether \(a\) is a quadratic residue modulo \(m\)
and computing square roots modulo \(m\) is generally (but not always)
<a href="#why-integer-factorization-isnt-more-difficult">as difficult</a> as factorizing \(m\).
<a href="https://en.wikipedia.org/wiki/Quadratic_residuosity_problem">This fact</a>
is used in <a href="https://en.wikipedia.org/wiki/Cocks_IBE_scheme">some</a>
<a href="https://en.wikipedia.org/wiki/Goldwasser%E2%80%93Micali_cryptosystem">cryptosystems</a>.
<a href="#tonelli-shanks-algorithm">So far</a>, we have discussed only how to compute a square modulo an odd prime \(p\).
Modulo a <a href="https://en.wikipedia.org/wiki/Prime_power">prime power</a> \(p^e\) for some integer \(e ≥ 1\),
there are several cases to consider, which I derived mostly myself:</p>
  <ul>
    <li>\(a =_{p^e} 0\): \(x =_{p^e} cp^d\), where \(d = \lceil \frac{e}{2} \rceil\) and \(c \in \{0, 1, …, p^{e - d} - 1\}\).</li>
    <li>\(a =_{p^e} p^b\) for some integer \(b ≥ 1\):
If \(b\) is even, \(x =_{p^e} ±(p^{b / 2} + cp^d)\),
where \(d = \operatorname{max}(\lceil \frac{e}{2} \rceil, e - \frac{b}{2} - (1 - p\ \href{#modulo-operation}{\%}\ 2))\)
and \(c \in \{0, 1, …, p^{e - d} - 1\}\),
because \(x^2 =_{p^e} (p^{b / 2} + cp^d)^2 =_{p^e} p^b + 2 c p^{b/2 + d} + c^2 p^{2d} =_{p^e} a\)
due to the previous choice of \(d\).
Otherwise, there are no square roots
because \(p^b =_{p^e} x^2 \iff p^b + tp^e = p^b(1 + tp^{e-b}) = x^2\) for some integer \(t\).
As the <a href="#prime-factorization">prime factorization</a> of an integer is <a href="#unique-factorization-theorem">unique</a>,
an integer has an integer square root <a href="#if-and-only-if">if and only if</a>
every exponent of its prime factorization is even.
Since \(1 + tp^{e-b}\) is not a multiple of \(p\) (it is one off from a multiple of \(p\)),
its prime factors don’t include \(p\), which leaves us with the odd exponent \(b\) for the prime factor \(p\).
Thus, \(p^b(1 + tp^{e-b})\) has no square roots among the integers.</li>
    <li>\(\operatorname{\href{#greatest-common-divisor}{gcd}}(a, p^e) = 0\):
      <ul>
        <li><strong>\(p\) is odd</strong>: As we saw <a href="#why-multiplicative-groups-modulo-a-power-of-an-odd-prime-are-cyclic">earlier</a>,
the <a href="#multiplicative-groups">multiplicative group</a> modulo a power of an odd prime is <a href="#cyclic-groups">cyclic</a>,
and <a href="#eulers-criterion">Euler’s criterion</a> can be generalized to any cyclic multiplicative group
by replacing \(p - 1\) with \(\href{#eulers-totient-function}{\varphi}(p^e)\) in <a href="#more-intuitive-proof">this box</a>.
With the same replacement, you can also generalize the <a href="#tonelli-shanks-algorithm">Tonelli-Shanks algorithm</a>
to any cyclic multiplicative group.
Alternatively, you can <a href="https://en.wikipedia.org/wiki/Hensel%27s_lemma#Hensel_lifting">“lift”</a>
a solution modulo \(p^{e-1}\) to modulo \(p^e\) (recursively starting from \(p^1\))
as explained in section 12.5.2 of <a href="https://shoup.net/ntb/ntb-v2.pdf">Victor Shoup’s book</a>.</li>
        <li><strong>\(p\) is even</strong> (i.e. \(p = 2\)): This case is almost always ignored,
and the <a href="https://www.johndcook.com/blog/quadratic_congruences/">only algorithm I’ve found</a> had no explanation.
Fortunately, we can derive an algorithm for powers of 2 with the following observations:
          <ol>
            <li>If \(x^2 =_{p^e} a\) (i.e. \(x^2 - a\) is a multiple of \(p^e\)),
then \(x^2 =_{p^d} a\) for some positive integer \(d ≤ e\)
because any multiple of \(p^e\) is also a multiple of \(p^d\).</li>
            <li>Whenever \(x^2 =_{p^e} a\), \(-x\) is also a solution because \((-x)^2
\href{#multiplication-by-minus-one}{=} ((-1)x)^2 = (-1)^2x^2
\href{#multiplication-by-minus-one}{=} (-(-1))x^2 \href{#double-inverse-theorem}{=} x^2\).</li>
            <li>Whenever \(x^2 =_{2^e} a\), \(x + 2^{e-1}\) is also a solution
because \((x + 2^{e-1})^2 =_{2^e} x^2 + 2x2^{e-1} + 2^{2(e-1)} =_{2^e} x^2\).</li>
            <li>If \(e ≥ 3\), \(x^2 =_{2^e} 1\) has <a href="https://math.stackexchange.com/a/845498/947937">exactly four solutions</a>,
namely \(1\), \(1 + 2^{e-1}\), \(-1\), and \(-(1 + 2^{e-1}) =_{2^e} -1 + 2^{e-1}\),
as \(-2^{e-1} =_{2^e} 2^{e-1}\).
Since \(x^2 - 1 = (x + 1)(x - 1)\) is a multiple of \(2^e\) and \((x + 1) - (x - 1) = 2\),
both \(x + 1\) and \(x - 1\) are even (if they both were odd, their product couldn’t be a multiple of \(2^e\)),
and one of them is not a multiple of \(4\).
Consequently, the other one has to be a multiple of \(2^{e-1}\) for their product to be a multiple of \(2^e\).
Since the only multiples of \(2^{e-1}\) modulo \(2^e\) are \(0\) and \(2^{e-1}\), \(x\) has to be next to them,
which gives us the four aforementioned solutions.</li>
            <li>In the case of \(e = 3\), the solutions of \(x^2 =_8 1\) are \(1\), \(3\), \(5\), and \(7\)
according to the previous point, which you can verify with the <a href="#tool-table-multiplicative-group-repetition&amp;modulus=8&amp;coprime=false&amp;repeat=true&amp;order=false&amp;totient=false">repetition table of multiplicative groups</a>.
As you can also see, \(3\), \(5\), and \(7\) have no square roots modulo \(8\).</li>
            <li>Combined with the first observation, \(x^2 =_{2^e} a\) for some \(e ≥ 3\) has no solutions
if \(a\) is odd and \(a\ \%\ 8 ≠ 1\).</li>
            <li>The integers which are coprime with the modulus (i.e. all odd integers in the case of \(m = 2^e\))
form a <a href="#multiplicative-groups">multiplicative group</a>.
As we saw <a href="#a-faster-algorithm-for-finding-a-generator">earlier</a>,
the <a href="#power-function-and-its-preimage">power function</a> (squaring in this case) is a <a href="#homomorphisms">homomorphism</a>.
As explained in the fourth observation, the size of its <a href="#kernel">kernel</a> is \(4\).
Since a homomorphism maps two inputs to the same output
if and only if they belong to the same <a href="#subgroup-cosets">coset</a> of its kernel,
an odd \(a\) has either four square roots or none modulo \(2^e\) for some \(e ≥ 3\)
since all cosets contain the same number of elements as the kernel.
Given a solution \(x\), you obtain the other solutions by multiplying \(x\) with each element of the kernel.
Since the odd integer \(x\) can be written as \(1 + b \cdot 2\) for some integer \(b\),
<!-- --> \(x(1 + 2^{e-1}) =_{2^e} x + (1 + b \cdot 2)2^{e-1} =_{2^e} x + 2^{e-1} + b \cdot 2^e =_{2^e} x + 2^{e-1}\),
which matches our third observation.</li>
            <li>The four solutions \(x\), \(x + 2^e\), \(-x\), and \(-x + 2^e\) to \(x^2 =_{2^{e+1}} a\) for an odd \(a\)
and some \(e ≥ 3\) are also solutions to \(x^2 =_{2^e} a\) according to the first observation.
In this case, however, \(x + 2^e =_{2^e} x\) and \(-x + 2^e =_{2^e} -x\),
which means that the four solutions modulo \(2^{e+1}\) map to two of the four solutions modulo \(2^e\).
Moreover, either \(x\) or \(x + 2^e\) modulo \(2^{e+1}\) is already between \(0\) and \(2^e\), which means
that one element stays the same when the two halves are mapped to one half by computing modulo \(2^e\).
The same is true for \(-x\) and \(-x + 2^e\) as well, which we can depict as follows:
              
            </li>
            <li>Given a solution \(x\) to \(x^2 =_{2^e} a\),
either \(x\) or \(x + 2^{e-1}\) is also a solution to \(x^2 =_{2^{e+1}} a\)
because the two solutions which \(x^2 =_{2^e} a\) and \(x^2 =_{2^{e+1}} a\) have in common
differ in their sign and not by \(2^{e-1}\) according to the previous point.
              <figure>
                <table>
   <thead>
     <tr>
       <th></th>
       <th colspan="2">$$±2^{e-1}$$</th>
     </tr>
   </thead>
   <tbody>
     <tr>
       <td rowspan="2">$$\cdot (-1)$$</td>
       <td>$$x$$</td>
       <td>$$x + 2^{e-1}$$</td>
     </tr>
     <tr>
       <td>$$-x$$</td>
       <td>$$-x + 2^{e-1}$$</td>
     </tr>
   </tbody>
 </table>
                <figcaption>
When given any of the four solutions to \(x^2 =_{2^e} a\), the initial solution may be in the wrong column.
The row, on the other hand, doesn’t matter: If \(x\) isn’t a solution to \(x^2 =_{2^{e+1}} a\), then neither is \(2^e - x\).
</figcaption>
              </figure>
            </li>
          </ol>

          <p>These observations result in the following algorithm:
Since \(\operatorname{gcd}(a, 2^e) = 0\) in this branch, \(a\) and any solution \(x\) are odd.
If \(e = 1\), return \(\{1\}\).
If \(e = 2\), return \(\{1, 3\}\) if \(a =_4 1\) and <a href="https://en.wikipedia.org/wiki/Empty_set">\(\{\}\)</a> otherwise.
(There are only two solutions in this case because \(x + 2 =_4 -x\) for \(x \in \{1, 3\}\).)
If \(a\ \%\ 8 ≠ 1\), return \(\{\}\).
Set \(x := 1\).
For \(i\) from \(3\) to \(e - 1\), add \(2^{i-1}\) to \(x\) if \(x^2 ≠_{2^{i+1}} a\).
Return \(\{x, 2^{e-1} - x, 2^{e-1} + x, 2^e - x\}\).</p>
        </li>
      </ul>
    </li>
    <li>\(\operatorname{gcd}(a, p^e) = p^b\) for some integer \(b ≥ 1\):
This means that \(a =_{p^e} p^bc\) for some integer \(c\), where \(\operatorname{gcd}(c, p^e) = 0\).
You get the solutions by multiplying each solution \(x_1\) to \(x^2 =_{p^e} p^b\)
with each solution \(x_2\) to \(x^2 =_{p^e} c\).
You find the solutions to these subproblems according to the previous two cases.
Please note that these products are not all different from one another.
Clearly, all these products are solutions to \(x^2 =_{p^e} a\)
because \((x_1x_2)^2 =_{p^e} x_1^2x_2^2 =_{p^e} p^bc =_{p^e} a\).
It’s less obvious why these are the only solutions.
Since \(p^bc =_{p^e} x^2 \iff p^bc + tp^e = p^b(c + tp^{e-b}) = x^2\) for some integer \(t\)
and \(c + tp^{e-b}\) is not a multiple of \(p\) because \(c\) isn’t a multiple of \(p\),
the prime factorization of \(x\) has to include \(p\) with an exponent of \(\frac{b}{2}\).
But as noted in the second case, solutions to \(x^2 =_{p^e} p^b\) can be shifted by multiples of \(p^d\).
The other prime factors are determined by \(c + tp^{e-b} = x^2 \iff c =_{p^{e-b}} x^2\),
which means that you can use the solutions to \(x^2 =_{p^{e-b}} c\) instead of the solutions to \(x^2 =_{p^e} c\).</li>
  </ul>

  <figure id="square-roots-modulo-power-of-2-source">
    <svg id="figure-square-roots-modulo-power-of-2" data-name="square-roots-modulo-power-of-2" width="582.238" height="164" viewBox="-5.975 -82.75 582.238 164" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 315,-5 A 140 70 0 0 0 35,-5 L 34.998166,-4.99017" marker-end="url(#arrow-green)" stroke-dasharray="332"></path>
    <line x1="315" y1="-5" x2="315" y2="-2.5"></line>
    <line x1="35" y1="-5" x2="35" y2="-2.5"></line>
    <path d="M 525,-5 A 140 70 0 0 0 245,-5 L 244.998166,-4.99017" marker-end="url(#arrow-green)" stroke-dasharray="332"></path>
    <line x1="525" y1="-5" x2="525" y2="-2.5"></line>
    <line x1="245" y1="-5" x2="245" y2="-2.5"></line>
    <text text-anchor="middle">
        <tspan x="280" y="-70"><tspan>±2<tspan dy="-6">e</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <path d="M 175,5 A 70 52.5 0 0 1 35,5 L 34.998726,4.990081" marker-end="url(#arrow-blue)" stroke-dasharray="186"></path>
    <line x1="175" y1="5" x2="175" y2="2.5"></line>
    <line x1="35" y1="5" x2="35" y2="2.5"></line>
    <path d="M 105,5 A 70 52.5 0 0 0 245,5 L 245.001274,4.990081" marker-end="url(#arrow-blue)" stroke-dasharray="186"></path>
    <line x1="105" y1="5" x2="105" y2="2.5"></line>
    <line x1="245" y1="5" x2="245" y2="2.5"></line>
    <text text-anchor="middle">
        <tspan x="140" y="78"><tspan>±2<tspan dy="-6">e−1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <line x1="0" y1="0" x2="560" y2="0"></line>
    <line x1="0" y1="-5" x2="0" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="0" y="28.5"><tspan>0</tspan></tspan>
    </text>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>2<tspan dy="-6">e−1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="280" y="28.5"><tspan>2<tspan dy="-6">e</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>2<tspan dy="-6">e+1</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
The four solutions to \(x^2 =_{2^{e+1}} a\) in green are mapped to two of the four solutions modulo \(2^e\) in blue.
When given any of the four solutions in blue, you may have to add \(2^{e-1}\) to obtain a solution in green.
</figcaption>
  </figure>

  <p>The following tool computes the square roots of the given input modulo the specified composite integer as described above:</p>

  

</details>

<details>
  <summary id="why-integer-factorization-isnt-more-difficult">
Why integer factorization isn’t more difficult
</summary>

  <p>In the <a href="#square-roots-modulo-composite-numbers">previous box</a>,
we saw how the square roots modulo a composite number can be computed efficiently
if the <a href="#prime-factorization">prime factorization</a> of the modulus is known.
This means that an efficient algorithm for factorizing integers would lead to an efficient algorithm
for computing the square roots modulo a composite number.
In this box, we show that the opposite is also true:
An efficient algorithm for computing the square roots modulo a composite number
would lead to an efficient algorithm for factorizing integers.
Being able to reduce each of these two <a href="https://en.wikipedia.org/wiki/Computational_problem">problems</a>
to the other one efficiently (i.e. in <a href="https://en.wikipedia.org/wiki/Time_complexity#Polynomial_time">polynomial time</a>)
implies that these two problems have similar <a href="#computational-complexity-theory">computational complexity</a>.
Since no efficient algorithm is known for either of these two problems,
both problems are believed to be difficult to solve for large inputs.</p>

  <p>For the sake of simplicity, we assume that the number \(n\), which we want to factorize,
is the product of two odd primes \(p\) and \(q\) (i.e. \(n = p \cdot q\)).
Since there are two solutions to \(x^2 =_p a\) and two solutions to \(x^2 =_q a\)
as proven <a href="#solutions-of-squares">earlier</a>, there are four solutions to \(x^2 =_n a\)
because <a href="#composite-groups">\(\mathbb{Z}_n \cong \mathbb{Z}_p \times \mathbb{Z}_q\)</a>.
(Two of the solutions are the additive inverses of the other two.)
Since we haven’t specified whether the algorithm has to find one square root of the given input \(a\) or all of them,
there are two possibilities to consider:</p>
  <ul>
    <li>The efficient algorithm for computing square roots modulo a composite number <a href="https://www.quora.com/How-is-the-theoretical-modular-square-root-on-composite-modulus-considered-equivalent-to-integer-factorization/answer/Senia-Sheydvasser">returns all four solutions</a>:
Compute the four square roots of an arbitrary <a href="#quadratic-residues">quadratic residue</a> \(a\), such as \(1\).
Choose distinct \(x\) and \(y\) from the four square roots so that \(x ≠_n -y\).
Since \(x^2 =_n y^2 =_n a\), \(x^2 - y^2 = (x + y)(x - y)\) is a multiple of \(n\).
However, \(n\) divides neither \(x + y\) (as \(x ≠_n -y\)) nor \(x - y\) (as \(x ≠_n y\)),
which means that \(p\) has to divide one of the factors and \(q\) the other.
(If the prime factorization of one of these factors contained both \(p\) and \(q\), \(n\) would divide this factor.)
Therefore, \(\operatorname{gcd}(x ± y, n)\),
which can be computed efficiently with the <a href="#euclidean-algorithm">Euclidean algorithm</a>,
equals either \(p\) or \(q\), which means that we have successfully factorized \(n\).</li>
    <li>The efficient algorithm for computing square roots modulo a composite number <a href="https://www.quora.com/How-is-the-theoretical-modular-square-root-on-composite-modulus-considered-equivalent-to-integer-factorization/answer/Mark-Gritter">returns just one pair of solutions</a>:
Choose a random \(x\) between \(0\) and \(n\), and compute \(a =_n x^2\).
By feeding this value \(a\) into the square-root-finding algorithm, you get a value \(y\) so that \(y^2 =_n a\).
Since the value \(x\) has been chosen randomly, the chance that \(y =_n ±x\) is exactly 50%.
If \(y =_n ±x\), you repeat the process for another randomly chosen \(x\) until \(x ≠_n ±y\).
Now again, \(\operatorname{gcd}(x ± y, n)\) equals either \(p\) or \(q\).</li>
  </ul>

</details>

<h2 id="elliptic-curves" data-toc-text="Elliptic curves">Elliptic curves (<abbr title="Elliptic Curve">EC</abbr>)</h2>

<p><a href="https://en.wikipedia.org/wiki/Elliptic_curve">Elliptic curves</a>
are the second popular way to construct <a href="#linear-one-way-functions">linear one-way functions</a>.
Many cryptosystems which rely on the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
of <a href="#multiplicative-groups">multiplicative groups</a> have been adapted to work over elliptic curves.
Since <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">elliptic-curve cryptography (<abbr title="Elliptic-Curve Cryptography">ECC</abbr>)</a>
is in practice always implemented with
<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Implementation">standardized elliptic curves</a>,
we’ll focus on how to work with given <a href="#curve-parameters">curve parameters</a>
instead of how to come up with new parameters.
Unlike earlier chapters, this chapter covers just the bare minimum without any proofs.</p>

<h3 id="curve-equation">Curve equation</h3>

<p>An elliptic curve consists of the <a href="https://en.wikipedia.org/wiki/Two-dimensional_Euclidean_space">two-dimensional points</a>
whose \(x\)- and \(y\)-<a href="https://en.wikipedia.org/wiki/Coordinate_system">coordinates</a>
satisfy the equation \(y^2 = x^3 + a \cdot x + b\),
where \(a\) and \(b\) are the <a href="#curve-parameters">parameters of the curve</a>.
By an appropriate <a href="https://en.wikipedia.org/wiki/Change_of_variables">change of variables</a> (see <a href="#what-about-x2">below</a>),
almost any <a href="https://en.wikipedia.org/wiki/Cubic_plane_curve">cubic curve</a> can be written in the above form,
which is known as the Weierstrass normal form,
named after <a href="https://en.wikipedia.org/wiki/Karl_Weierstrass">Karl Theodor Weierstrass</a> (1815 − 1897).
The equation is defined over a <a href="#field-axioms">field</a>, to which \(a\), \(b\), and all coordinates belong.
Over the <a href="https://en.wikipedia.org/wiki/Real_number">real numbers</a>, an elliptic curve looks like this:</p>

<figure>
  <svg id="figure-elliptic-curve-continuous" data-name="elliptic-curve-continuous" width="337.53" height="482.748" viewBox="-185.03 -227.999 337.53 482.748" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <line x1="-151.875" y1="-180" x2="151.875" y2="-180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-174.1">3</tspan>
    </text>
    <line x1="-151.875" y1="-120" x2="151.875" y2="-120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-114.1">2</tspan>
    </text>
    <line x1="-151.875" y1="-60" x2="151.875" y2="-60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-54.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-164.5" y="5.9">0</tspan>
    </text>
    <line x1="-151.875" y1="60" x2="151.875" y2="60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="65.9">−1</tspan>
    </text>
    <line x1="-151.875" y1="120" x2="151.875" y2="120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="125.9">−2</tspan>
    </text>
    <line x1="-151.875" y1="180" x2="151.875" y2="180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="185.9">−3</tspan>
    </text>
    <line x1="-120" y1="-227.374" x2="-120" y2="227.374"></line>
    <text text-anchor="middle">
        <tspan x="-120" y="251.499">−2</tspan>
    </text>
    <line x1="-60" y1="-227.374" x2="-60" y2="227.374"></line>
    <text text-anchor="middle">
        <tspan x="-60" y="251.499">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="251.499">0</tspan>
    </text>
    <line x1="60" y1="-227.374" x2="60" y2="227.374"></line>
    <text text-anchor="middle">
        <tspan x="60" y="251.499">1</tspan>
    </text>
    <line x1="120" y1="-227.374" x2="120" y2="227.374"></line>
    <text text-anchor="middle">
        <tspan x="120" y="251.499">2</tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>

</svg>

  <figcaption>
The curve \(y^2 = x^3 - x + 1\) over the real numbers.
</figcaption>
</figure>

<details>
  <summary id="smoothness">
Smoothness
</summary>

  <p>For the group operation to be <a href="https://en.wikipedia.org/wiki/Well-defined_expression">well defined</a>
(see the <a href="#point-addition">next section</a>), the curve has to be <a href="https://en.wikipedia.org/wiki/Smoothness">smooth</a>,
which means every point on the curve has a unique <a href="https://en.wikipedia.org/wiki/Tangent">tangent</a>.
An elliptic curve is smooth (<a href="https://en.wikipedia.org/wiki/Singular_point_of_an_algebraic_variety">non-singular</a>)
if it has no <a href="https://en.wikipedia.org/wiki/Cusp_(singularity)">cusps</a> and does not intersect itself.
This is the case <a href="#if-and-only-if">if and only if</a> the <a href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a>
on the right-hand side of the equation has <a href="https://en.wikipedia.org/wiki/Square-free_polynomial">no repeated roots</a>,
which is the case if and only if its <a href="https://en.wikipedia.org/wiki/Discriminant#Degree_3">discriminant</a>
<!-- --> \(-4a^3 - 27b^2\) is not zero.
Let’s look at two examples, where this is not the case:</p>

  <figure>
    <svg id="figure-elliptic-curve-cusp" data-name="elliptic-curve-cusp" width="337.53" height="506.092" viewBox="-185.03 -239.671 337.53 506.092" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="238.421" x2="0" y2="-239.671" marker-end="url(#arrow-gray)" stroke-dasharray="471"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-218.171"><tspan>y</tspan></tspan>
    </text>
    <line x1="-151.875" y1="-180" x2="151.875" y2="-180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-174.1">3</tspan>
    </text>
    <line x1="-151.875" y1="-120" x2="151.875" y2="-120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-114.1">2</tspan>
    </text>
    <line x1="-151.875" y1="-60" x2="151.875" y2="-60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-54.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-164.5" y="5.9">0</tspan>
    </text>
    <line x1="-151.875" y1="60" x2="151.875" y2="60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="65.9">−1</tspan>
    </text>
    <line x1="-151.875" y1="120" x2="151.875" y2="120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="125.9">−2</tspan>
    </text>
    <line x1="-151.875" y1="180" x2="151.875" y2="180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="185.9">−3</tspan>
    </text>
    <line x1="-120" y1="-239.046" x2="-120" y2="239.046"></line>
    <text text-anchor="middle">
        <tspan x="-120" y="263.171">−2</tspan>
    </text>
    <line x1="-60" y1="-239.046" x2="-60" y2="239.046"></line>
    <text text-anchor="middle">
        <tspan x="-60" y="263.171">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="263.171">0</tspan>
    </text>
    <line x1="60" y1="-239.046" x2="60" y2="239.046"></line>
    <text text-anchor="middle">
        <tspan x="60" y="263.171">1</tspan>
    </text>
    <line x1="120" y1="-239.046" x2="120" y2="239.046"></line>
    <text text-anchor="middle">
        <tspan x="120" y="263.171">2</tspan>
    </text>
    <polyline points="150,237.171 147.938,232.298 143.217,221.266 138.429,210.264 133.57,199.292 128.709,188.511 123.863,177.965 119.033,167.659 114.221,157.596 109.428,147.781 104.656,138.219 99.904,128.915 95.177,119.873 90.474,111.099 85.798,102.599 81.152,94.379 76.537,86.444 71.958,78.802 67.415,71.46 62.914,64.424 58.459,57.703 54.054,51.305 49.703,45.238 45.414,39.511 41.194,34.133 37.049,29.113 32.991,24.463 29.028,20.191 25.175,16.307 21.445,12.82 17.855,9.74 14.425,7.073 11.176,4.824 8.134,2.995 5.326,1.587 2.711,0.576 0.001,0 0.001,0 2.711,-0.576 5.326,-1.587 8.134,-2.995 11.176,-4.824 14.425,-7.073 17.855,-9.74 21.445,-12.82 25.175,-16.307 29.028,-20.191 32.991,-24.463 37.049,-29.113 41.194,-34.133 45.414,-39.511 49.703,-45.238 54.054,-51.305 58.459,-57.703 62.914,-64.424 67.415,-71.46 71.958,-78.802 76.537,-86.444 81.152,-94.379 85.798,-102.599 90.474,-111.099 95.177,-119.873 99.904,-128.915 104.656,-138.219 109.428,-147.781 114.221,-157.596 119.033,-167.659 123.863,-177.965 128.709,-188.511 133.57,-199.292 138.429,-210.264 143.217,-221.266 147.938,-232.298 150,-237.171"></polyline>

</svg>

    <figcaption>
When \(a = 0\) and \(b = 0\), we have \(y^2 = x^3\) with a cusp at \((0, 0)\).
(\(0\) is a <a href="https://en.wikipedia.org/wiki/Multiplicity_(mathematics)#Multiplicity_of_a_root_of_a_polynomial">root of multiplicity \(3\)</a>.)
</figcaption>
  </figure>

  <figure>
    <svg id="figure-elliptic-curve-intersection" data-name="elliptic-curve-intersection" width="337.53" height="413.588" viewBox="-185.03 -193.419 337.53 413.588" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="192.169" x2="0" y2="-193.419" marker-end="url(#arrow-gray)" stroke-dasharray="379"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-171.919"><tspan>y</tspan></tspan>
    </text>
    <line x1="-151.875" y1="-180" x2="151.875" y2="-180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-174.1">3</tspan>
    </text>
    <line x1="-151.875" y1="-120" x2="151.875" y2="-120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-114.1">2</tspan>
    </text>
    <line x1="-151.875" y1="-60" x2="151.875" y2="-60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-54.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-164.5" y="5.9">0</tspan>
    </text>
    <line x1="-151.875" y1="60" x2="151.875" y2="60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="65.9">−1</tspan>
    </text>
    <line x1="-151.875" y1="120" x2="151.875" y2="120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="125.9">−2</tspan>
    </text>
    <line x1="-151.875" y1="180" x2="151.875" y2="180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="185.9">−3</tspan>
    </text>
    <line x1="-120" y1="-192.794" x2="-120" y2="192.794"></line>
    <text text-anchor="middle">
        <tspan x="-120" y="216.919">−2</tspan>
    </text>
    <line x1="-60" y1="-192.794" x2="-60" y2="192.794"></line>
    <text text-anchor="middle">
        <tspan x="-60" y="216.919">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="216.919">0</tspan>
    </text>
    <line x1="60" y1="-192.794" x2="60" y2="192.794"></line>
    <text text-anchor="middle">
        <tspan x="60" y="216.919">1</tspan>
    </text>
    <line x1="120" y1="-192.794" x2="120" y2="192.794"></line>
    <text text-anchor="middle">
        <tspan x="120" y="216.919">2</tspan>
    </text>
    <polyline points="150,190.919 149.646,190.042 145.12,178.929 140.542,167.837 135.909,156.768 131.217,145.724 126.464,134.706 121.647,123.716 116.762,112.756 111.806,101.828 106.774,90.935 101.663,80.079 96.466,69.264 91.27,58.677 86.074,48.321 80.878,38.201 75.682,28.321 70.486,18.685 65.291,9.298 60.096,0.166 54.9,8.707 49.705,17.314 44.51,25.649 39.315,33.705 34.121,41.476 28.928,48.954 23.735,56.129 18.545,62.994 13.356,69.538 8.171,75.751 2.991,81.621 -2.182,87.136 -7.346,92.28 -12.496,97.04 -17.629,101.4 -22.737,105.341 -27.812,108.847 -32.843,111.898 -37.814,114.478 -42.706,116.572 -47.498,118.168 -52.158,119.263 -56.656,119.863 -60.955,119.989 -65.019,119.676 -68.817,118.976 -72.329,117.952 -75.545,116.672 -78.468,115.204 -81.18,113.56 -83.78,111.711 -86.26,109.679 -88.614,107.486 -90.843,105.153 -92.946,102.701 -94.93,100.147 -96.798,97.505 -98.557,94.788 -100.212,92.006 -101.77,89.169 -103.237,86.283 -104.616,83.354 -105.915,80.388 -107.137,77.388 -108.286,74.359 -109.366,71.301 -110.381,68.219 -111.334,65.114 -112.228,61.986 -113.065,58.837 -113.848,55.667 -114.579,52.477 -115.259,49.266 -115.89,46.035 -116.474,42.781 -117.012,39.504 -117.504,36.2 -117.953,32.869 -118.358,29.504 -118.72,26.1 -119.04,22.65 -119.316,19.141 -119.55,15.558 -119.738,11.872 -119.88,8.044 -120,0 -120,0 -119.88,-8.044 -119.738,-11.872 -119.55,-15.558 -119.316,-19.141 -119.04,-22.65 -118.72,-26.1 -118.358,-29.504 -117.953,-32.869 -117.504,-36.2 -117.012,-39.504 -116.474,-42.781 -115.89,-46.035 -115.259,-49.266 -114.579,-52.477 -113.848,-55.667 -113.065,-58.837 -112.228,-61.986 -111.334,-65.114 -110.381,-68.219 -109.366,-71.301 -108.286,-74.359 -107.137,-77.388 -105.915,-80.388 -104.616,-83.354 -103.237,-86.283 -101.77,-89.169 -100.212,-92.006 -98.557,-94.788 -96.798,-97.505 -94.93,-100.147 -92.946,-102.701 -90.843,-105.153 -88.614,-107.486 -86.26,-109.679 -83.78,-111.711 -81.18,-113.56 -78.468,-115.204 -75.545,-116.672 -72.329,-117.952 -68.817,-118.976 -65.019,-119.676 -60.955,-119.989 -56.656,-119.863 -52.158,-119.263 -47.498,-118.168 -42.706,-116.572 -37.814,-114.478 -32.843,-111.898 -27.812,-108.847 -22.737,-105.341 -17.629,-101.4 -12.496,-97.04 -7.346,-92.28 -2.182,-87.136 2.991,-81.621 8.171,-75.751 13.356,-69.538 18.545,-62.994 23.735,-56.129 28.928,-48.954 34.121,-41.476 39.315,-33.705 44.51,-25.649 49.705,-17.314 54.9,-8.707 60.096,-0.166 65.291,-9.298 70.486,-18.685 75.682,-28.321 80.878,-38.201 86.074,-48.321 91.27,-58.677 96.466,-69.264 101.663,-80.079 106.774,-90.935 111.806,-101.828 116.762,-112.756 121.647,-123.716 126.464,-134.706 131.217,-145.724 135.909,-156.768 140.542,-167.837 145.12,-178.929 149.646,-190.042 150,-190.919"></polyline>

</svg>

    <figcaption>
When \(a = -3\) and \(b = 2\), we have \(y^2 = x^3 - 3x + 2 = (x - 1)^2 (x + 2)\).
(\(1\) is a root of multiplicity \(2\).)
</figcaption>
  </figure>

</details>

<details>
  <summary id="what-about-x2">
What about x<sup>2</sup>?
</summary>

  <p>A <a href="https://en.wikipedia.org/wiki/Cubic_function">cubic polynomial</a> of the form \(c(z) = sz^3 + tz^2 + uz + v\)
can be turned into a so-called <a href="https://en.wikipedia.org/wiki/Cubic_equation#Depressed_cubic">depressed cubic</a>
of the form \(d(x) = x^3 + ax + b\) by replacing \(z\) with \(x - \frac{t}{3s}\),
thereby shifting the input, which means \(c(x - \frac{t}{3s}) = d(x) \iff c(z) = d(z + \frac{t}{3s})\):</p>

\[\begin{aligned}
c(x - \frac{t}{3s}) &amp;= s(x - \frac{t}{3s})^3 + t(x - \frac{t}{3s})^2 + u(x - \frac{t}{3s}) + v \\[8pt]
&amp;= s(x^3 - 3\frac{t}{3s}x^2 + 3\frac{t^2}{3^2s^2}x - \frac{t^3}{3^3s^3})
+ t(x^2 - 2\frac{t}{3s}x + \frac{t^2}{3^2s^2}) + u(x - \frac{t}{3s}) + v \\[8pt]
&amp;= sx^3 + ((-t) + t)x^2 + (\frac{t^2}{3s} - 2\frac{t^2}{3s} + u)x
+ (-\frac{t^3}{3^3s^2}) + \frac{t^3}{3^2s^2} - u\frac{t}{3s} + v \\[8pt]
&amp;= sx^3 + \frac{3su - t^2}{3s}x + \frac{2t^3 - 9stu + 27s^2v}{27s^2}
\end{aligned}\]

  <p>In order to get the promised form, we need to divide the polynomial by \(s\), thereby scaling the output.
Therefore, we have:</p>

\[\begin{aligned}
a &amp;= \frac{3su - t^2}{3s^2} \\[8pt]
b &amp;= \frac{2t^3 - 9stu + 27s^2v}{27s^3}
\end{aligned}\]

  <p>This <a href="https://en.wikipedia.org/wiki/Change_of_variables">change of variable</a> doesn’t work
if the polynomial is defined over a <a href="#finite-fields">finite field</a>
whose so-called <a href="https://en.wikipedia.org/wiki/Characteristic_(algebra)">characteristic</a> is \(3\)
because in this case, \(3s = 0\), and <a href="https://en.wikipedia.org/wiki/Division_by_zero">we cannot divide by \(0\)</a>.
In the case of elliptic curves, there are even more terms to consider, such as \(xy\),
which <a href="https://en.wikipedia.org/wiki/Elliptic_curve#Elliptic_curves_over_a_general_field">you cannot get rid of</a>
if the characteristic of the underlying field is \(2\).
As you can see, things become complicated quickly.</p>

</details>

<h3 id="point-addition">Point addition</h3>

<p>Together with the <a href="#point-at-infinity">point at infinity</a>, which we’ll discuss in the next section,
the points on an elliptic curve form a <a href="#group-axioms">group</a> under the operation described in this and the next section.
Even though this operation has nothing to do with <a href="https://en.wikipedia.org/wiki/Addition">arithmetical addition</a>,
it’s called point addition, and it’s written using the <a href="#notation">additive notation</a>.
I denote the \(x\)-coordinate of a point \(A\) as \(A_x\) and its \(y\)-coordinate as \(A_y\), which means that
the point \(A\) is defined by the <a href="https://en.wikipedia.org/wiki/Ordered_pair">ordered pair</a> \((A_x, A_y)\).
Given two points \(A\) and \(B\) where \(A_x ≠ B_x\), you get their sum \(C = A + B\) by determining
where the <a href="https://en.wikipedia.org/wiki/Line_(geometry)">straight line</a> which passes through \(A\) and \(B\)
<a href="https://en.wikipedia.org/wiki/Intersection">intersects</a> the elliptic curve for the third time
and then reflecting this point across the \(x\) <a href="https://en.wikipedia.org/wiki/Axis_(mathematics)">axis</a>:</p>

<figure>
  <svg id="figure-elliptic-curve-addition" data-name="elliptic-curve-addition" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-75" y1="32.692" x2="22.2" y2="32.692"></line>
    <text text-anchor="middle">
        <tspan x="-26.4" y="56.192">dx</tspan>
    </text>
    <line x1="22.2" y1="32.692" x2="22.2" y2="-49.501"></line>
    <text text-anchor="start">
        <tspan x="34.2" y="-2.505">dy</tspan>
    </text>
    <line x1="-150" y1="96.112" x2="150" y2="-157.569"></line>
    <line x1="95.703" y1="111.655" x2="95.703" y2="-111.655"></line>
    <circle cx="-75" cy="32.692" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-103.532" y="29.321"><tspan><tspan>A</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-42.27" y="-24.348"><tspan><tspan>+</tspan></tspan></tspan>
    </text>
    <circle cx="22.2" cy="-49.501" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="22.2" y="-73.601"><tspan><tspan>B</tspan></tspan></tspan>
    </text>
    <circle cx="95.703" cy="-111.655" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="74.49" y="-126.969"><tspan><tspan>−C</tspan></tspan></tspan>
    </text>
    <circle cx="95.703" cy="111.655" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="69.54" y="143.718"><tspan><tspan>= C</tspan></tspan></tspan>
    </text>

</svg>

  <figcaption>
The sum \(C\) of \(A\) and \(B\) where \(A_x ≠ B_x\).
</figcaption>
</figure>

<p>As we will see in the <a href="#point-at-infinity">next section</a>,
the point \(-C = (C_x, -C_y)\) is the <a href="#group-axioms">inverse</a> of \(C\).
Since the <a href="#curve-equation">curve equation</a> is \(y^2 = x^3 + a \cdot x + b\)
and <a href="#solutions-of-squares">\(y^2 = (-y)^2\)</a> in any <a href="#field-axioms">field</a>,
every elliptic curve is symmetric around the \(x\) axis,
and thus \(C\) is guaranteed to be on the curve as well.
In order to implement elliptic curves on a computer,
we have to work out the geometric operation <a href="https://en.wikipedia.org/wiki/Elementary_algebra">algebraically</a>,
i.e. as equations involving <a href="https://en.wikipedia.org/wiki/Variable_(mathematics)">variables</a>.
The <a href="https://en.wikipedia.org/wiki/Line_(geometry)#In_Cartesian_coordinates">equation of a straight line</a>
is \(y = s \cdot x + t\), where \(s\) is the <a href="https://en.wikipedia.org/wiki/Slope">slope</a> of the line
and \(t\) is the value at which the line crosses the \(y\) axis.
The slope of the line which passes through \(A\) and \(B\) is calculated as
the ratio of their vertical difference (marked as \(dy\) in the graph above)
and their horizontal difference (marked as \(dx\)):</p>

\[s = \frac{dy}{dx} = \frac{B_y - A_y}{B_x - A_x} = \frac{A_y - B_y}{A_x - B_x}\]

<p>Since the formulas for \(C_x\) and \(C_y\) won’t involve \(t\), we don’t have to determine its value.
The line through \(A\) and \(B\) intersects the elliptic curve
wherever they have the same \(y\) value for the same \(x\) value.
This means that the \(x\)-coordinate of any intersection point has to fulfill \((sx + t)^2 = x^3 + ax + b\),
which can be rewritten as \(x^3 - s^2x^2 + (a - 2sd)x + b - d^2 = 0\).
Based on the geometric interpretation,
we know that the solutions of this equation are \(A_x\), \(B_x\), and \(C_x\).
Since a value \(r\) is a so-called <a href="https://en.wikipedia.org/wiki/Zero_of_a_function">root</a>
of a <a href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a> \(f(x)\) <a href="#if-and-only-if">if and only if</a>
<!-- --> \((x - r)\) divides \(f(x)\) (we’ll discuss this in the article about coding theory,
see <a href="https://en.wikipedia.org/wiki/Polynomial#Solving_equations">Wikipedia</a> for now),
we have \(x^3 \allowbreak \htmlClass{color-pink}{-} \allowbreak \htmlClass{color-pink}{s^2}x^2 + (a - 2sd)x + b - d^2
= (x - A_x)(x - B_x)(x - C_x)
= x^3 + \htmlClass{color-pink}{(-A_x - B_x - C_x)}x^2 + (A_xB_xC_x + A_xC_x + B_xC_x)x - A_xB_xC_x\).
Since the <a href="https://en.wikipedia.org/wiki/Coefficient">coefficients</a>
of two equal polynomials <a href="https://en.wikipedia.org/wiki/Equating_coefficients">are equal</a>,
we have \(\htmlClass{color-pink}{-s^2 = -A_x - B_x - C_x}\), which we can solve for \(C_x\):</p>

\[C_x = s^2 - A_x - B_x\]

<p>We get the value \(-C_y\) by extrapolating the slope from \(A\) or \(B\):
<!-- --> \(-C_y = A_y + s(C_x - A_x) = B_y + s(C_x - B_x)\).
Therefore:</p>

\[C_y = s(A_x - C_x) - A_y = s(B_x - C_x) - B_y\]

<p>Based on the geometric construction and these formulas,
it’s apparent that this operation is <a href="#commutative-groups">commutative</a>, i.e. \(A + B = B + A\).
We can move the points \(A\) and \(B\) closer and closer together until \(A = B\),
at which point the line through \(A\) and \(B\) <a href="https://en.wikipedia.org/wiki/Limit_(mathematics)">becomes</a>
a <a href="https://en.wikipedia.org/wiki/Tangent">tangent</a>:</p>

<figure>
  <svg id="figure-elliptic-curve-tangent" data-name="elliptic-curve-tangent" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-150" y1="-48.107" x2="150" y2="-108.627"></line>
    <line x1="86.442" y1="95.805" x2="86.442" y2="-95.805"></line>
    <circle cx="-42" cy="-69.894" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-46.693" y="-93.625"><tspan><tspan>A + A</tspan></tspan></tspan>
    </text>
    <circle cx="86.442" cy="-95.805" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="65.229" y="-111.118"><tspan><tspan>−D</tspan></tspan></tspan>
    </text>
    <circle cx="86.442" cy="95.805" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="60.279" y="127.868"><tspan><tspan>= D</tspan></tspan></tspan>
    </text>

</svg>

  <figcaption>
The sum \(D\) of \(A\) and \(A\)
(called <a href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication#Point_doubling">doubling</a>).
</figcaption>
</figure>

<p>Since in this case \(dx = B_x - A_x = 0\), we can no longer compute the slope \(s\) as \(\frac{dy}{dx}\).
Instead, we have to differentiate the function \(f(x) = (x^3 + ax + b)^\frac{1}{2}\),
whose <a href="https://en.wikipedia.org/wiki/Derivative">derivative</a>
is \(f&#39;(x) = \frac{1}{2}(x^3 + ax + b)^{-\frac{1}{2}}(3x^2 + a) = \frac{3x^2 + a}{2f(x)}\)
according to the <a href="https://en.wikipedia.org/wiki/Chain_rule">chain rule</a>.
We get the slope \(s&#39;\) of the tangent by evaluating \(f&#39;\) at \(A_x\).
The coordinates of the point \(D\) are then determined similarly to the point \(C\) above:</p>

\[\begin{aligned}
s&#39; &amp;= \frac{3A_x^2 + a}{2A_y} \\[8pt]
D_x &amp;= s&#39;^2 - 2A_x \\
D_y &amp;= s&#39;(A_x - D_x) - A_y
\end{aligned}\]

<p>Please note that you can get a tangent not just by doubling a point.
The same tangent is used when determining \((-D) + A = -A\) with the previous set of equations.
In other words, the point \(-C\) can be equal to the point \(A\) or \(B\) in the first graphic of this section.</p>

<details>
  <summary id="associativity-of-point-addition">
Associativity of point addition
</summary>

  <p>In order to form a <a href="#group-axioms">group</a>, <a href="#point-addition">point addition</a> has to be <a href="#group-axioms">associative</a>,
i.e. for any points \(A\), \(B\), and \(C\), it has to be that \((A + B) + C = A + (B + C)\).
Unfortunately, it’s rather difficult to prove that this is always the case.
You find explanations for this fact <a href="https://books.google.ch/books?id=2_PLCQAAQBAJ&amp;pg=PA14">here</a>
and <a href="https://www.maths.tcd.ie/pub/Maths/Courseware/EllipticCurves/2016/Associativity.pdf">here</a>.
I’ll just visualize what associativity means geometrically:</p>

  <figure>
    <svg id="figure-elliptic-curve-associativity" data-name="elliptic-curve-associativity" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-150" y1="76.866" x2="150" y2="-133.009"></line>
    <line x1="28.165" y1="47.775" x2="28.165" y2="-47.775"></line>
    <line x1="-150" y1="-156.362" x2="150" y2="187.371"></line>
    <line x1="113.603" y1="-145.668" x2="113.603" y2="145.668"></line>
    <line x1="-150" y1="-40.662" x2="150" y2="-95.895"></line>
    <line x1="-12.966" y1="65.891" x2="-12.966" y2="-65.891"></line>
    <line x1="-150" y1="-20.482" x2="150" y2="168.609"></line>
    <circle cx="-76.8" cy="25.656" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-106.741" y="33.44"><tspan><tspan>A</tspan></tspan></tspan>
    </text>
    <circle cx="78" cy="-82.639" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="60.366" y="-101.009"><tspan><tspan>B</tspan></tspan></tspan>
    </text>
    <circle cx="-63" cy="-56.679" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-59.24" y="-80.543"><tspan><tspan>C</tspan></tspan></tspan>
    </text>
    <circle cx="28.165" cy="-47.775" r="7.5"></circle>
    <circle cx="28.165" cy="47.775" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="71.597" y="33.238"><tspan><tspan>A + B</tspan></tspan></tspan>
    </text>
    <circle cx="113.603" cy="145.668" r="7.5"></circle>
    <circle cx="113.603" cy="-145.668" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="61.123" y="-164.463"><tspan><tspan>A + B + C</tspan></tspan></tspan>
    </text>
    <circle cx="-12.966" cy="-65.891" r="7.5"></circle>
    <circle cx="-12.966" cy="65.891" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-36.478" y="104.152"><tspan><tspan>B + C</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
No matter whether you add \(A + B\) or \(B + C\) first, you end up in the same spot when determining \(A + B + C\).
</figcaption>
  </figure>

</details>

<details>
  <summary id="why-is-there-always-a-third-intersection">
Why is there always a third intersection?
</summary>

  <p>As explained <a href="#point-addition">above</a>, a point is at an intersection of an elliptic curve and a straight line
<a href="#if-and-only-if">if and only if</a> its \(x\)-coordinate satisfies \(x^3 - s^2x^2 + (a - 2sd)x + b - d^2 = 0\).
The left-hand side of this equation is a <a href="https://en.wikipedia.org/wiki/Cubic_function">cubic function</a>,
which crosses the \(x\) axis at least once because it is <a href="https://en.wikipedia.org/wiki/Continuous_function">continuous</a>
and goes from \(\href{https://en.wikipedia.org/wiki/Limit_(mathematics)}{f(-\infin)}
= \href{https://en.wikipedia.org/wiki/Infinity_symbol}{-\infin}\) to \(f(\infin) = \infin\) or vice versa.
This can be visualized as follows:</p>

  <figure>
    <svg id="figure-cubic-function-1" data-name="cubic-function-1" width="135.53" height="250.045" viewBox="-103.03 -111.875 135.53 250.045" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-69.25" y1="0" x2="32.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="95"></line>
    <line x1="0" y1="110.17" x2="0" y2="-111.875" marker-end="url(#arrow-gray)" stroke-dasharray="215"></line>
    <text text-anchor="end">
        <tspan x="20.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-90.375"><tspan>y</tspan></tspan>
    </text>
    <line x1="-69.875" y1="-80" x2="31.875" y2="-80"></line>
    <text text-anchor="end">
        <tspan x="-82.5" y="-74.1">2</tspan>
    </text>
    <line x1="-69.875" y1="-40" x2="31.875" y2="-40"></line>
    <text text-anchor="end">
        <tspan x="-82.5" y="-34.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-82.5" y="5.9">0</tspan>
    </text>
    <line x1="-69.875" y1="40" x2="31.875" y2="40"></line>
    <text text-anchor="end">
        <tspan x="-82.5" y="45.9">−1</tspan>
    </text>
    <line x1="-69.875" y1="80" x2="31.875" y2="80"></line>
    <text text-anchor="end">
        <tspan x="-82.5" y="85.9">−2</tspan>
    </text>
    <line x1="-40" y1="-111.25" x2="-40" y2="110.795"></line>
    <text text-anchor="middle">
        <tspan x="-40" y="134.92">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="134.92">0</tspan>
    </text>
    <polyline points="-68,108.92 -67.679,106.915 -67.354,104.911 -67.025,102.906 -66.694,100.902 -66.358,98.898 -66.018,96.893 -65.675,94.89 -65.328,92.886 -64.976,90.882 -64.621,88.879 -64.261,86.875 -63.896,84.872 -63.527,82.869 -63.153,80.867 -62.774,78.865 -62.39,76.863 -62.001,74.861 -61.607,72.859 -61.206,70.858 -60.8,68.858 -60.388,66.857 -59.97,64.857 -59.545,62.858 -59.114,60.859 -58.676,58.861 -58.23,56.863 -57.777,54.866 -57.316,52.87 -56.847,50.874 -56.37,48.879 -55.883,46.885 -55.388,44.892 -54.883,42.901 -54.368,40.91 -53.842,38.921 -53.305,36.933 -52.756,34.946 -52.196,32.962 -51.622,30.979 -51.035,28.998 -50.434,27.02 -49.817,25.044 -49.185,23.072 -48.535,21.102 -47.868,19.136 -47.182,17.174 -46.475,15.217 -45.747,13.265 -44.996,11.318 -44.221,9.379 -43.419,7.447 -42.589,5.524 -41.729,3.61 -40.836,1.708 -39.91,-0.18 -38.946,-2.054 -37.942,-3.909 -36.896,-5.744 -35.806,-7.555 -34.667,-9.338 -33.479,-11.09 -32.238,-12.804 -30.943,-14.477 -29.594,-16.102 -28.191,-17.674 -26.568,-19.358 -24.598,-21.227 -22.033,-23.419 -18.08,-26.398 -11.436,-30.899 -7.227,-33.843 -4.993,-35.553 -3.249,-36.993 -1.783,-38.293 -0.411,-39.593 0.912,-40.933 2.187,-42.313 3.414,-43.73 4.595,-45.184 5.732,-46.671 6.827,-48.191 7.881,-49.74 8.897,-51.316 9.877,-52.918 10.823,-54.544 11.737,-56.191 12.62,-57.858 13.475,-59.544 14.303,-61.246 15.106,-62.964 15.884,-64.697 16.64,-66.442 17.375,-68.201 18.09,-69.97 18.785,-71.75 19.463,-73.54 20.123,-75.339 20.767,-77.146 21.396,-78.962 22.01,-80.785 22.61,-82.614 23.197,-84.45 23.771,-86.293 24.333,-88.141 24.884,-89.994 25.423,-91.852 25.952,-93.715 26.471,-95.583 26.981,-97.455 27.481,-99.331 27.972,-101.21 28.454,-103.094 28.928,-104.98 29.395,-106.87 29.853,-108.763 30,-109.375"></polyline>
    <circle cx="-40" cy="0" r="6"></circle>

</svg>

    <figcaption>
<!-- --> \(y = x^3 + x^2 + x + 1 = (x + 1)(x^2 + 1)\)
</figcaption>
  </figure>

  <p>The cubic function \(x^3 + x^2 + x + 1\) has only a single <a href="https://en.wikipedia.org/wiki/Zero_of_a_function">root</a>
because its <a href="https://en.wikipedia.org/wiki/Polynomial#Factoring">factor</a> \(x^2 + 1\)
has no roots among the <a href="https://en.wikipedia.org/wiki/Real_number">real numbers</a>
(but \(i\) and \(-i\) among the <a href="https://en.wikipedia.org/wiki/Complex_number">complex numbers</a>).
Other cubic functions cross the \(x\) axis three times, which is apparent from their factors:</p>

  <figure>
    <svg id="figure-cubic-function-3" data-name="cubic-function-3" width="169.53" height="259.12" viewBox="-101.03 -116.185 169.53 259.12" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-67.25" y1="0" x2="68.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="129"></line>
    <line x1="0" y1="114.935" x2="0" y2="-116.185" marker-end="url(#arrow-gray)" stroke-dasharray="224"></line>
    <text text-anchor="end">
        <tspan x="56.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-94.685"><tspan>y</tspan></tspan>
    </text>
    <line x1="-67.875" y1="-80" x2="67.875" y2="-80"></line>
    <text text-anchor="end">
        <tspan x="-80.5" y="-74.1">2</tspan>
    </text>
    <line x1="-67.875" y1="-40" x2="67.875" y2="-40"></line>
    <text text-anchor="end">
        <tspan x="-80.5" y="-34.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-80.5" y="5.9">0</tspan>
    </text>
    <line x1="-67.875" y1="40" x2="67.875" y2="40"></line>
    <text text-anchor="end">
        <tspan x="-80.5" y="45.9">−1</tspan>
    </text>
    <line x1="-67.875" y1="80" x2="67.875" y2="80"></line>
    <text text-anchor="end">
        <tspan x="-80.5" y="85.9">−2</tspan>
    </text>
    <line x1="-40" y1="-115.56" x2="-40" y2="115.56"></line>
    <text text-anchor="middle">
        <tspan x="-40" y="139.685">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="139.685">0</tspan>
    </text>
    <line x1="40" y1="-115.56" x2="40" y2="115.56"></line>
    <text text-anchor="middle">
        <tspan x="40" y="139.685">1</tspan>
    </text>
    <polyline points="-66,113.685 -65.718,111.676 -65.434,109.668 -65.147,107.659 -64.857,105.65 -64.563,103.642 -64.267,101.633 -63.968,99.624 -63.665,97.615 -63.359,95.606 -63.049,93.597 -62.736,91.588 -62.419,89.58 -62.099,87.571 -61.775,85.562 -61.446,83.553 -61.114,81.544 -60.777,79.535 -60.436,77.526 -60.09,75.517 -59.739,73.508 -59.384,71.499 -59.023,69.491 -58.657,67.482 -58.286,65.473 -57.909,63.465 -57.526,61.456 -57.137,59.448 -56.742,57.439 -56.34,55.431 -55.931,53.423 -55.514,51.415 -55.09,49.408 -54.658,47.4 -54.218,45.393 -53.768,43.386 -53.31,41.38 -52.841,39.373 -52.362,37.368 -51.873,35.363 -51.371,33.358 -50.857,31.354 -50.33,29.352 -49.789,27.349 -49.232,25.349 -48.66,23.349 -48.069,21.351 -47.46,19.354 -46.831,17.36 -46.179,15.368 -45.502,13.379 -44.799,11.394 -44.066,9.413 -43.299,7.437 -42.496,5.468 -41.65,3.508 -40.757,1.558 -39.81,-0.378 -38.799,-2.295 -37.715,-4.186 -36.543,-6.043 -35.269,-7.85 -33.873,-9.583 -32.335,-11.205 -30.639,-12.662 -28.791,-13.875 -26.83,-14.759 -24.83,-15.262 -22.862,-15.394 -20.965,-15.206 -19.145,-14.759 -17.4,-14.107 -15.72,-13.292 -13.987,-12.277 -12.057,-10.961 -9.807,-9.218 -6.939,-6.73 -2.235,-2.228 3.424,3.399 6.501,6.329 8.641,8.238 10.446,9.734 12.12,11.007 13.867,12.2 15.695,13.279 17.607,14.196 19.585,14.89 21.584,15.299 23.536,15.388 25.379,15.163 27.087,14.666 28.662,13.946 30.118,13.043 31.469,11.991 32.729,10.817 33.909,9.541 35.018,8.18 36.063,6.749 37.052,5.259 37.991,3.72 38.885,2.137 39.738,0.519 40.554,-1.131 41.336,-2.808 42.088,-4.509 42.812,-6.231 43.51,-7.971 44.184,-9.728 44.837,-11.499 45.469,-13.284 46.083,-15.08 46.678,-16.888 47.258,-18.705 47.822,-20.531 48.371,-22.365 48.907,-24.206 49.43,-26.055 49.942,-27.91 50.441,-29.77 50.93,-31.637 51.409,-33.508 51.878,-35.384 52.337,-37.264 52.788,-39.149 53.231,-41.038 53.665,-42.93 54.092,-44.825 54.511,-46.724 54.923,-48.626 55.329,-50.531 55.728,-52.438 56.12,-54.348 56.507,-56.261 56.888,-58.176 57.263,-60.093 57.633,-62.012 57.998,-63.933 58.358,-65.856 58.712,-67.781 59.063,-69.708 59.408,-71.637 59.75,-73.567 60.087,-75.498 60.419,-77.431 60.748,-79.366 61.073,-81.302 61.395,-83.239 61.712,-85.177 62.026,-87.117 62.337,-89.058 62.644,-91 62.948,-92.943 63.248,-94.887 63.546,-96.832 63.841,-98.778 64.132,-100.725 64.421,-102.673 64.707,-104.622 64.99,-106.572 65.271,-108.522 65.548,-110.474 65.824,-112.426 66,-113.685"></polyline>
    <circle cx="-40" cy="0" r="6"></circle>
    <circle cx="0" cy="0" r="6"></circle>
    <circle cx="40" cy="0" r="6"></circle>

</svg>

    <figcaption>
<!-- --> \(y = x^3 - x = (x + 1)x(x - 1)\)
</figcaption>
  </figure>

  <p>Instead of crossing the \(x\) axis again, a cubic function, such as \(x^3 - x^2 - x + 1\),
can just “touch” the \(x\) axis (at \((1, 0)\) in this case):</p>

  <figure>
    <svg id="figure-cubic-function-2" data-name="cubic-function-2" width="172.32999999999998" height="238.65499999999997" viewBox="-93.03 -101.36 172.32999999999998 238.65499999999997" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-59.25" y1="0" x2="79.3" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="132"></line>
    <line x1="0" y1="109.295" x2="0" y2="-101.36" marker-end="url(#arrow-gray)" stroke-dasharray="204"></line>
    <text text-anchor="end">
        <tspan x="67.3" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-79.86"><tspan>y</tspan></tspan>
    </text>
    <line x1="-59.875" y1="-80" x2="78.675" y2="-80"></line>
    <text text-anchor="end">
        <tspan x="-72.5" y="-74.1">2</tspan>
    </text>
    <line x1="-59.875" y1="-40" x2="78.675" y2="-40"></line>
    <text text-anchor="end">
        <tspan x="-72.5" y="-34.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-72.5" y="5.9">0</tspan>
    </text>
    <line x1="-59.875" y1="40" x2="78.675" y2="40"></line>
    <text text-anchor="end">
        <tspan x="-72.5" y="45.9">−1</tspan>
    </text>
    <line x1="-59.875" y1="80" x2="78.675" y2="80"></line>
    <text text-anchor="end">
        <tspan x="-72.5" y="85.9">−2</tspan>
    </text>
    <line x1="-40" y1="-100.735" x2="-40" y2="109.92"></line>
    <text text-anchor="middle">
        <tspan x="-40" y="134.045">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="134.045">0</tspan>
    </text>
    <line x1="40" y1="-100.735" x2="40" y2="109.92"></line>
    <text text-anchor="middle">
        <tspan x="40" y="134.045">1</tspan>
    </text>
    <polyline points="-58,108.045 -57.754,106.037 -57.507,104.028 -57.257,102.019 -57.005,100.011 -56.751,98.002 -56.495,95.993 -56.237,93.985 -55.976,91.976 -55.713,89.967 -55.448,87.958 -55.18,85.949 -54.91,83.94 -54.637,81.931 -54.361,79.922 -54.083,77.913 -53.802,75.904 -53.519,73.894 -53.232,71.885 -52.942,69.876 -52.65,67.866 -52.354,65.857 -52.055,63.848 -51.753,61.838 -51.447,59.828 -51.138,57.819 -50.825,55.809 -50.508,53.8 -50.188,51.79 -49.863,49.78 -49.535,47.77 -49.202,45.761 -48.864,43.751 -48.523,41.741 -48.176,39.731 -47.825,37.721 -47.468,35.712 -47.107,33.702 -46.74,31.692 -46.367,29.682 -45.988,27.672 -45.603,25.663 -45.212,23.653 -44.814,21.644 -44.409,19.634 -43.997,17.625 -43.577,15.616 -43.149,13.607 -42.712,11.598 -42.267,9.589 -41.812,7.581 -41.347,5.573 -40.872,3.565 -40.386,1.558 -39.887,-0.449 -39.376,-2.455 -38.852,-4.461 -38.313,-6.466 -37.759,-8.469 -37.188,-10.472 -36.599,-12.473 -35.99,-14.473 -35.359,-16.471 -34.706,-18.467 -34.026,-20.459 -33.318,-22.449 -32.579,-24.434 -31.803,-26.413 -30.987,-28.386 -30.125,-30.35 -29.21,-32.302 -28.234,-34.238 -27.185,-36.153 -26.049,-38.037 -24.81,-39.877 -23.446,-41.648 -21.931,-43.314 -20.246,-44.812 -18.391,-46.048 -16.416,-46.914 -14.421,-47.347 -12.491,-47.372 -10.66,-47.062 -8.926,-46.49 -7.278,-45.713 -5.706,-44.776 -4.198,-43.711 -2.747,-42.545 -1.337,-41.29 0.184,-39.815 1.864,-38.053 3.793,-35.881 6.17,-33.025 9.629,-28.611 14.436,-22.234 19.02,-16.237 21.084,-13.661 22.78,-11.635 24.28,-9.928 25.705,-8.392 27.189,-6.892 28.743,-5.444 30.383,-4.068 32.121,-2.798 33.967,-1.682 35.913,-0.793 37.912,-0.212 39.877,-0.001 41.723,-0.152 43.418,-0.609 44.969,-1.311 46.395,-2.208 47.715,-3.263 48.942,-4.445 50.089,-5.732 51.166,-7.104 52.181,-8.548 53.14,-10.051 54.05,-11.604 54.916,-13.198 55.742,-14.829 56.532,-16.49 57.29,-18.178 58.018,-19.889 58.719,-21.62 59.396,-23.37 60.049,-25.135 60.681,-26.914 61.294,-28.706 61.889,-30.51 62.466,-32.324 63.028,-34.147 63.575,-35.979 64.109,-37.819 64.629,-39.666 65.137,-41.52 65.633,-43.379 66.119,-45.245 66.594,-47.115 67.059,-48.991 67.515,-50.871 67.961,-52.755 68.4,-54.644 68.83,-56.536 69.253,-58.431 69.668,-60.33 70.076,-62.232 70.477,-64.137 70.872,-66.045 71.261,-67.955 71.643,-69.868 72.02,-71.783 72.391,-73.701 72.757,-75.62 73.118,-77.542 73.474,-79.466 73.824,-81.391 74.171,-83.318 74.512,-85.247 74.85,-87.178 75.183,-89.11 75.512,-91.043 75.837,-92.978 76.158,-94.914 76.475,-96.852 76.789,-98.791 76.8,-98.86"></polyline>
    <circle cx="-40" cy="0" r="6"></circle>
    <circle cx="40" cy="0" r="6"></circle>

</svg>

    <figcaption>
<!-- --> \(y = x^3 - x^2 - x + 1 = (x + 1)(x - 1)^2\)
</figcaption>
  </figure>

  <p>As you can see from its factors, the root at \(x = 1\) has a
<a href="https://en.wikipedia.org/wiki/Multiplicity_(mathematics)#Multiplicity_of_a_root_of_a_polynomial">multiplicity</a> of \(2\).
This has to be the case because when you factor out two roots from a <a href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a>
of <a href="https://en.wikipedia.org/wiki/Degree_of_a_polynomial">degree</a> \(3\),
you’re left with a polynomial of degree \(1\), which always has a root.
Therefore, a cubic function has either one or three real roots, which don’t have to be distinct.
Since <a href="#point-addition">point addition</a> involves two points (roots),
you’re guaranteed to find a third point (root) on the same line,
where a <a href="https://en.wikipedia.org/wiki/Tangent">point of tangency</a> is simply counted twice.</p>

</details>

<details>
  <summary id="why-flip-the-intersection-over-the-x-axis">
Why flip the intersection over the x axis?
</summary>

  <p>If we <a href="https://crypto.stackexchange.com/questions/53974/when-adding-two-points-on-an-elliptic-curve-why-flip-over-the-x-axis">didn’t reflect</a>
the third intersection across the \(x\) axis,
we would have \(A + B = C\), \(A + C = B\), and \(B + C = A\)
because the <a href="https://en.wikipedia.org/wiki/Collinearity">collinearity</a> of the three points is symmetric
(i.e. if \(C\) lies on the same line as \(A\) and \(B\), \(B\) lies on the same line as \(A\) and \(C\)):</p>

  <figure>
    <svg id="figure-elliptic-curve-collinearity" data-name="elliptic-curve-collinearity" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-150" y1="96.112" x2="150" y2="-157.569"></line>
    <line x1="-75" y1="32.692" x2="-75" y2="-32.692"></line>
    <line x1="22.2" y1="-49.501" x2="22.2" y2="49.501"></line>
    <line x1="95.703" y1="-111.655" x2="95.703" y2="111.655"></line>
    <circle cx="-75" cy="32.692" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-103.532" y="29.321"><tspan><tspan>A</tspan></tspan></tspan>
    </text>
    <circle cx="22.2" cy="-49.501" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="22.2" y="-73.601"><tspan><tspan>B</tspan></tspan></tspan>
    </text>
    <circle cx="95.703" cy="-111.655" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="74.49" y="-126.969"><tspan><tspan>C</tspan></tspan></tspan>
    </text>
    <circle cx="-75" cy="-32.692" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-111.544" y="-32.58"><tspan><tspan>−A</tspan></tspan></tspan>
    </text>
    <circle cx="22.2" cy="49.501" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="22.2" y="90.401"><tspan><tspan>−B</tspan></tspan></tspan>
    </text>
    <circle cx="95.703" cy="111.655" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="64.882" y="143.052"><tspan><tspan>−C</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
Three collinear points \(A\), \(B\), and \(C\) with their reflections.
</figcaption>
  </figure>

  <p>By inserting the value of \(B\) from the second equation into the first equation, we would get \(A + (A + C) = C\).
Assuming that point addition forms a <a href="#group-axioms">group</a> (this is our goal after all),
<!-- --> \(A + A\) would have to equal the <a href="#group-axioms">identity element</a>.
Since \(A\) is an arbitrary point on the elliptic curve,
every point on the curve would have an <a href="#element-order">order</a> of \(2\),
which is not <a href="#repetitions">what we want</a>.
We can see this more directly by repeating an element \(D\).
If \(D + D\) equaled \(E\), we would get back to \(D\) by adding \(D\) again, i.e. \(E + D = D\):</p>

  <figure>
    <svg id="figure-elliptic-curve-only-tangent" data-name="elliptic-curve-only-tangent" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-150" y1="-48.107" x2="150" y2="-108.627"></line>
    <circle cx="-42" cy="-69.894" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-46.693" y="-93.625"><tspan><tspan>D</tspan></tspan></tspan>
    </text>
    <circle cx="86.442" cy="-95.805" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="65.229" y="-111.118"><tspan><tspan>E</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
The tangent at \(D\) intersects the elliptic curve at \(E\).
</figcaption>
  </figure>

  <p>This would make any such point \(E\) an <a href="#group-axioms">identity element</a>,
which contradicts the uniqueness of the identity element in a group.
Moreover, the modified operation would not be <a href="#associativity-of-point-addition">associative</a>,
which can be seen on the basis of the following <a href="https://en.wikipedia.org/wiki/Counterexample">counterexample</a>:</p>

  <figure>
    <svg id="figure-elliptic-curve-no-associativity" data-name="elliptic-curve-no-associativity" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-150" y1="14.547" x2="150" y2="-126.299"></line>
    <line x1="-150" y1="-46.343" x2="150" y2="-68.746"></line>
    <line x1="-150" y1="-28.401" x2="150" y2="-114.883"></line>
    <line x1="-150" y1="36.23" x2="150" y2="-194.963"></line>
    <circle cx="-78" cy="-19.256" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-54.474" y="-2.286"><tspan><tspan>X</tspan></tspan></tspan>
    </text>
    <circle cx="87" cy="-96.722" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="74.272" y="-103.549"><tspan><tspan>Y</tspan></tspan></tspan>
    </text>
    <circle cx="-66" cy="-52.616" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-86.411" y="-65.883"><tspan><tspan>Z</tspan></tspan></tspan>
    </text>
    <circle cx="4.225" cy="-57.86" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-7.209" y="-16.771"><tspan><tspan>X + Y</tspan></tspan></tspan>
    </text>
    <circle cx="62.11" cy="-62.182" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="90.794" y="-21.609"><tspan><tspan>(X + Y) + Z</tspan></tspan></tspan>
    </text>
    <circle cx="-16.014" cy="-67.025" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-40.763" y="-85.874"><tspan><tspan>Y + Z</tspan></tspan></tspan>
    </text>
    <circle cx="129.647" cy="-179.278" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="67.829" y="-193.464"><tspan><tspan>X + (Y + Z)</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
How associativity is violated by the modified operation.
(I know that this graph is ugly, but it wasn’t easy to keep all the intersections in the image.)
</figcaption>
  </figure>

  <p>Now let’s go back to the three collinear points \(A\), \(B\), and \(C\) at the beginning of this box.
If \(A + B = C\) and \(A + C = B\), then \(A + B - C = A - B + C\),
which works only if each element is its own inverse.
If, on the other hand, \(A + B = -C\) and \(A + C = -B\),
which corresponds to the <a href="#point-addition">actual point addition above</a>,
we get the same expression in both cases, namely \(A + B + C = O\),
where \(O\) is the identity element, which we’ll discuss <a href="#point-at-infinity">next</a>.</p>

</details>

<h3 id="point-at-infinity">Point at infinity</h3>

<p>Due to <a href="#group-axioms">closure</a>, we have to be able to add any two points together,
including a point and its opposite reflected across the \(x\) axis.
In this case, however, the line which passes through them intersects the elliptic curve only twice
because every element of a field has <a href="#solutions-of-squares">at most two roots</a>.
Since a vertical line cannot be expressed as \(y = s \cdot x + t\),
this does not violate the explanation of why you
<a href="#why-is-there-always-a-third-intersection">always find a third intersection</a>.
In order to give vertical lines a third intersection,
we introduce a special point,
which is known as the <a href="https://en.wikipedia.org/wiki/Point_at_infinity">point at infinity</a>
and usually denoted by the capital letter \(O\).
It is a single point which lies on every vertical line.
Since <a href="https://en.wikipedia.org/wiki/Parallel_(geometry)">parallel lines</a>
don’t intersect in a normal <a href="https://en.wikipedia.org/wiki/Two-dimensional_Euclidean_space">Euclidean plane</a>,
elliptic curves are defined in a so-called <a href="https://en.wikipedia.org/wiki/Projective_plane">projective plane</a>,
where any two distinct lines intersect at exactly one point.
The point at infinity serves as the <a href="#group-axioms">identity element</a> of our <a href="#finite-groups">group</a>.
The inverse of any element other than \(O\) is its reflection across the \(x\) axis, i.e. \(-A = (A_x, -A_y)\).
The point at infinity is its own inverse, though, i.e. \(-O = O\).
This is why you can’t imagine \(O\) to be at \((0, \infin)\),
unless you’re willing to turn the plane into a <a href="https://en.wikipedia.org/wiki/Cylinder">cylinder</a>
in order to make \((0, -\infin) = (0, \infin)\).
The idea of fitting a line through the points that we add breaks down anyway in the case of \(O\).
By being the identity element, it results in itself when it is added to itself, i.e. \(O + O = O\).
Therefore, don’t imagine too much and simply treat \(O\) as a special case.</p>

<figure>
  <svg id="figure-elliptic-curve-infinity" data-name="elliptic-curve-infinity" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="60" y1="-225.499" x2="60" y2="225.499"></line>
    <circle cx="60" cy="-60" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="35.729" y="-71.734"><tspan><tspan>A</tspan></tspan></tspan>
    </text>
    <circle cx="60" cy="60" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="31.684" y="86.472"><tspan><tspan>−A</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="35.729" y="-191.734"><tspan><tspan>O</tspan></tspan></tspan>
    </text>

</svg>

  <figcaption>
<!-- --> \(A + (-A) = O\), but also \(O + A = A\) by reflecting the other intersection.
</figcaption>
</figure>

<p>Where the elliptic curve crosses the \(x\) axis,
the point of intersection is its own inverse,
and the tangent to the curve is vertical:</p>

<figure>
  <svg id="figure-elliptic-curve-zero" data-name="elliptic-curve-zero" width="305" height="455.998" viewBox="-152.5 -227.999 305 455.998" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="226.749" x2="0" y2="-227.999" marker-end="url(#arrow-gray)" stroke-dasharray="448"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-206.499"><tspan>y</tspan></tspan>
    </text>
    <polyline points="150,225.499 147.4,219.389 142.884,208.913 138.423,198.746 134.024,188.896 129.692,179.376 125.433,170.194 121.254,161.36 117.16,152.884 113.158,144.775 109.254,137.039 105.453,129.682 101.761,122.708 98.182,116.118 94.72,109.911 91.376,104.083 88.152,98.629 85.047,93.538 82.058,88.801 79.184,84.403 76.42,80.33 73.759,76.567 71.197,73.097 68.725,69.903 66.337,66.971 64.023,64.284 61.776,61.828 59.587,59.59 57.446,57.557 55.322,55.701 53.124,53.957 50.843,52.344 48.471,50.889 45.996,49.619 43.412,48.568 40.712,47.769 37.899,47.258 34.989,47.059 32.014,47.181 29.014,47.605 26.029,48.293 22.659,49.339 18.468,50.96 9.543,55.154 -1.144,60.569 -11.9,65.467 -19.325,68.112 -25.418,69.652 -30.708,70.426 -35.404,70.602 -39.603,70.292 -43.357,69.592 -46.7,68.59 -49.663,67.367 -52.468,65.885 -55.156,64.131 -57.705,62.127 -60.099,59.9 -62.329,57.481 -64.393,54.896 -66.292,52.173 -68.034,49.332 -69.624,46.393 -71.072,43.37 -72.385,40.273 -73.572,37.11 -74.638,33.888 -75.59,30.609 -76.434,27.273 -77.173,23.877 -77.811,20.415 -78.35,16.876 -78.791,13.24 -79.13,9.474 -79.363,5.536 -79.483,0 -79.483,0 -79.363,-5.536 -79.13,-9.474 -78.791,-13.24 -78.35,-16.876 -77.811,-20.415 -77.173,-23.877 -76.434,-27.273 -75.59,-30.609 -74.638,-33.888 -73.572,-37.11 -72.385,-40.273 -71.072,-43.37 -69.624,-46.393 -68.034,-49.332 -66.292,-52.173 -64.393,-54.896 -62.329,-57.481 -60.099,-59.9 -57.705,-62.127 -55.156,-64.131 -52.468,-65.885 -49.663,-67.367 -46.7,-68.59 -43.357,-69.592 -39.603,-70.292 -35.404,-70.602 -30.708,-70.426 -25.418,-69.652 -19.325,-68.112 -11.9,-65.467 -1.144,-60.569 9.543,-55.154 18.468,-50.96 22.659,-49.339 26.029,-48.293 29.014,-47.605 32.014,-47.181 34.989,-47.059 37.899,-47.258 40.712,-47.769 43.412,-48.568 45.996,-49.619 48.471,-50.889 50.843,-52.344 53.124,-53.957 55.322,-55.701 57.446,-57.557 59.587,-59.59 61.776,-61.828 64.023,-64.284 66.337,-66.971 68.725,-69.903 71.197,-73.097 73.759,-76.567 76.42,-80.33 79.184,-84.403 82.058,-88.801 85.047,-93.538 88.152,-98.629 91.376,-104.083 94.72,-109.911 98.182,-116.118 101.761,-122.708 105.453,-129.682 109.254,-137.039 113.158,-144.775 117.16,-152.884 121.254,-161.36 125.433,-170.194 129.692,-179.376 134.024,-188.896 138.423,-198.746 142.884,-208.913 147.4,-219.389 150,-225.499"></polyline>
    <line x1="-79.483" y1="-225.499" x2="-79.483" y2="225.499"></line>
    <circle cx="-79.483" cy="0" r="7.5"></circle>
    <text text-anchor="middle">
        <tspan x="-100.696" y="-15.313"><tspan><tspan>B</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-108.208" y="33.737"><tspan><tspan>−B</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-100.696" y="-195.313"><tspan><tspan>O</tspan></tspan></tspan>
    </text>

</svg>

  <figcaption>
<!-- --> \(B = -B\) and \(B + B = O\).
</figcaption>
</figure>

<p>With different <a href="#curve-parameters">parameters</a>,
an elliptic curve can cross the \(x\) axis more than once.
You find an example of this in the <a href="#example-of-separated-curve">first box below</a>.</p>

<details>
  <summary id="example-of-separated-curve">
Example of separated curve
</summary>

  <p>An <a href="#curve-equation">elliptic curve</a> separates into two components
if its <a href="https://en.wikipedia.org/wiki/Discriminant#Degree_3">discriminant</a> \(-4a^3 - 27b^2\) is positive:</p>

  <figure>
    <svg id="figure-elliptic-curve-separated" data-name="elliptic-curve-separated" width="337.53" height="466.492" viewBox="-185.03 -219.871 337.53 466.492" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-151.25" y1="0" x2="152.5" y2="0" marker-end="url(#arrow-gray)" stroke-dasharray="297"></line>
    <line x1="0" y1="218.621" x2="0" y2="-219.871" marker-end="url(#arrow-gray)" stroke-dasharray="431"></line>
    <text text-anchor="end">
        <tspan x="140.5" y="21.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-12" y="-198.371"><tspan>y</tspan></tspan>
    </text>
    <line x1="-151.875" y1="-180" x2="151.875" y2="-180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-174.1">3</tspan>
    </text>
    <line x1="-151.875" y1="-120" x2="151.875" y2="-120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-114.1">2</tspan>
    </text>
    <line x1="-151.875" y1="-60" x2="151.875" y2="-60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="-54.1">1</tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-164.5" y="5.9">0</tspan>
    </text>
    <line x1="-151.875" y1="60" x2="151.875" y2="60"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="65.9">−1</tspan>
    </text>
    <line x1="-151.875" y1="120" x2="151.875" y2="120"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="125.9">−2</tspan>
    </text>
    <line x1="-151.875" y1="180" x2="151.875" y2="180"></line>
    <text text-anchor="end">
        <tspan x="-164.5" y="185.9">−3</tspan>
    </text>
    <line x1="-120" y1="-219.246" x2="-120" y2="219.246"></line>
    <text text-anchor="middle">
        <tspan x="-120" y="243.371">−2</tspan>
    </text>
    <line x1="-60" y1="-219.246" x2="-60" y2="219.246"></line>
    <text text-anchor="middle">
        <tspan x="-60" y="243.371">−1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="243.371">0</tspan>
    </text>
    <line x1="60" y1="-219.246" x2="60" y2="219.246"></line>
    <text text-anchor="middle">
        <tspan x="60" y="243.371">1</tspan>
    </text>
    <line x1="120" y1="-219.246" x2="120" y2="219.246"></line>
    <text text-anchor="middle">
        <tspan x="120" y="243.371">2</tspan>
    </text>
    <polyline points="0,0 -2.031,11.032 -2.199,11.479 -2.615,12.514 -3.25,13.943 -4.095,15.639 -5.142,17.501 -6.38,19.454 -7.795,21.442 -9.374,23.424 -11.105,25.367 -12.979,27.245 -14.987,29.036 -17.123,30.72 -19.382,32.273 -21.762,33.674 -24.26,34.894 -26.874,35.902 -29.6,36.657 -32.432,37.113 -35.355,37.212 -38.341,36.893 -41.337,36.097 -44.268,34.789 -47.042,32.977 -49.581,30.716 -51.834,28.088 -53.789,25.171 -55.451,22.032 -56.837,18.711 -57.964,15.232 -58.846,11.597 -59.489,7.784 -59.88,3.789 -60,0 -60,0 -59.88,-3.789 -59.489,-7.784 -58.846,-11.597 -57.964,-15.232 -56.837,-18.711 -55.451,-22.032 -53.789,-25.171 -51.834,-28.088 -49.581,-30.716 -47.042,-32.977 -44.268,-34.789 -41.337,-36.097 -38.341,-36.893 -35.355,-37.212 -32.432,-37.113 -29.6,-36.657 -26.874,-35.902 -24.26,-34.894 -21.762,-33.674 -19.382,-32.273 -17.123,-30.72 -14.987,-29.036 -12.979,-27.245 -11.105,-25.367 -9.374,-23.424 -7.795,-21.442 -6.38,-19.454 -5.142,-17.501 -4.095,-15.639 -3.25,-13.943 -2.615,-12.514 -2.199,-11.479 -2.031,-11.032 0,0"></polyline>
    <polyline points="150,217.371 147.044,210.16 142.451,199.074 137.805,188.01 133.106,176.969 128.351,165.952 123.54,154.959 118.671,143.991 113.745,133.049 108.761,122.133 103.723,111.242 98.634,100.373 93.503,89.524 88.346,78.686 83.187,67.847 78.073,56.983 75.008,50.329 72.932,45.713 71.387,42.19 70.173,39.354 68.983,36.497 67.818,33.608 66.684,30.677 65.588,27.698 64.538,24.657 63.546,21.539 62.623,18.324 61.79,14.984 61.07,11.482 60.496,7.763 60.12,3.8 60,0 60,0 60.12,-3.8 60.496,-7.763 61.07,-11.482 61.79,-14.984 62.623,-18.324 63.546,-21.539 64.538,-24.657 65.588,-27.698 66.684,-30.677 67.818,-33.608 68.983,-36.497 70.173,-39.354 71.387,-42.19 72.932,-45.713 75.008,-50.329 78.073,-56.983 83.187,-67.847 88.346,-78.686 93.503,-89.524 98.634,-100.373 103.723,-111.242 108.761,-122.133 113.745,-133.049 118.671,-143.991 123.54,-154.959 128.351,-165.952 133.106,-176.969 137.805,-188.01 142.451,-199.074 147.044,-210.16 150,-217.371"></polyline>
    <circle cx="-60" cy="0" r="7.5"></circle>
    <circle cx="0" cy="0" r="7.5"></circle>
    <circle cx="60" cy="0" r="7.5"></circle>

</svg>

    <figcaption>
The curve \(y^2 = x^3 - x\) (i.e. \(a = -1\) and \(b = 0\)).</figcaption>
  </figure>

</details>

<details>
  <summary id="pseudocode-for-point-addition">
Pseudocode for point addition
</summary>

  <p>We can combine the various cases of <a href="#point-addition">point addition</a>
into the following <a href="https://en.wikipedia.org/wiki/Pseudocode">pseudocode</a>,
but make sure to read the warnings below:</p>

  <p>\[\text{const } a := … \\
\text{function } add(A, B)\ \{ \\
\quad \text{if }(A = O)\ \{ \\
\quad \quad \text{return } B \\
\quad \} \text{ else if }(B = O)\ \{ \\
\quad \quad \text{return } A \\
\quad \} \text{ else if }(A = -B)\ \{ \\
\quad \quad \text{return } O \\
\quad \} \text{ else } \{ \\
\quad \quad \text{let } s \\
\quad \quad \text{if }(A = B)\ \{ \\
\quad \quad \quad s := \frac{3A_x^2 + a}{2A_y} \\
\quad \quad \} \text{ else } \{ \\
\quad \quad \quad s := \frac{B_y - A_y}{B_x - A_x} \\
\quad \quad \} \\
\quad \quad \text{let } x := s^2 - A_x - B_x \\
\quad \quad \text{return new } Point(x, s(A_x - x) - A_y) \\
\quad \} \\
\} \\\]
</p>

  <p>While this code works and is exactly how I implemented point addition for the tools in this chapter,
you should not use it for cryptographic purposes.
In order to avoid <a href="https://en.wikipedia.org/wiki/Timing_attack">timing attacks</a>,
cryptographic algorithms should run in <a href="https://en.wikipedia.org/wiki/Timing_attack#Avoidance">constant time</a>,
i.e. perform the same operations no matter the inputs.
How to achieve this is beyond the scope of this article.
<a href="https://crypto.stackexchange.com/questions/86692/what-is-a-constant-time-work-around-when-dealing-with-the-point-at-infinity-fo">Common techniques</a>
include using <a href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">homogeneous/projective coordinates</a>
instead of <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">Cartesian coordinates</a>
and working with <a href="https://en.wikipedia.org/wiki/Twisted_Edwards_curve">(twisted) Edwards curves</a>,
named after <a href="https://en.wikipedia.org/wiki/Harold_Edwards_(mathematician)">Harold Mortimer Edwards</a> (1936 − 2020),
instead of <a href="#curve-equation">curves in Weierstrass form</a>.
The advantages of <a href="https://en.wikipedia.org/wiki/Edwards_curve">Edwards curves</a>
are that the formulas for addition and doubling are the same
and that the <a href="#group-axioms">identity element</a> is an ordinary point.</p>

</details>

<h3 id="discrete-curves">Discrete curves</h3>

<p>Elliptic curves as <a href="#curve-equation">presented so far</a> are not suitable for computers
because computers can represent <a href="https://en.wikipedia.org/wiki/Real_number">real numbers</a>
only with <a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic">limited precision</a>,
which leads to <a href="https://en.wikipedia.org/wiki/Numerical_stability">inaccuracies</a>.
Fortunately, we can define elliptic curves also over <a href="#finite-fields">finite fields</a>,
using the same equations for <a href="#point-addition">point addition</a> as before,
even though a <a href="https://en.wikipedia.org/wiki/Tangent">tangent</a> is no longer
<a href="https://en.wikipedia.org/wiki/Well-defined_expression">well defined</a>.
The elliptic curve we used so far looks as follows over <a href="#field-notation">\(\mathbb{F}_{19}\)</a>:</p>

<figure>
  <svg id="figure-elliptic-curve-discrete" data-name="elliptic-curve-discrete" width="566.682" height="559.75" viewBox="-52.152 -511 566.682 559.75" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="0" y1="-504" x2="0" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="0" y="23.5">0</tspan>
    </text>
    <line x1="28" y1="-504" x2="28" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="28" y="23.5">1</tspan>
    </text>
    <line x1="56" y1="-504" x2="56" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="56" y="23.5">2</tspan>
    </text>
    <line x1="84" y1="-504" x2="84" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="84" y="23.5">3</tspan>
    </text>
    <line x1="112" y1="-504" x2="112" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="112" y="23.5">4</tspan>
    </text>
    <line x1="140" y1="-504" x2="140" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="140" y="23.5">5</tspan>
    </text>
    <line x1="168" y1="-504" x2="168" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="168" y="23.5">6</tspan>
    </text>
    <line x1="196" y1="-504" x2="196" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="196" y="23.5">7</tspan>
    </text>
    <line x1="224" y1="-504" x2="224" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="224" y="23.5">8</tspan>
    </text>
    <line x1="252" y1="-504" x2="252" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="252" y="23.5">9</tspan>
    </text>
    <line x1="280" y1="-504" x2="280" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="280" y="23.5">10</tspan>
    </text>
    <line x1="308" y1="-504" x2="308" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="308" y="23.5">11</tspan>
    </text>
    <line x1="336" y1="-504" x2="336" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="336" y="23.5">12</tspan>
    </text>
    <line x1="364" y1="-504" x2="364" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="364" y="23.5">13</tspan>
    </text>
    <line x1="392" y1="-504" x2="392" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="392" y="23.5">14</tspan>
    </text>
    <line x1="420" y1="-504" x2="420" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="420" y="23.5">15</tspan>
    </text>
    <line x1="448" y1="-504" x2="448" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="448" y="23.5">16</tspan>
    </text>
    <line x1="476" y1="-504" x2="476" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="476" y="23.5">17</tspan>
    </text>
    <line x1="504" y1="-504" x2="504" y2="0"></line>
    <text text-anchor="middle">
        <tspan x="504" y="23.5">18</tspan>
    </text>
    <line x1="0" y1="0" x2="504" y2="0"></line>
    <text text-anchor="end">
        <tspan x="-12" y="5.9">0</tspan>
    </text>
    <line x1="0" y1="-28" x2="504" y2="-28"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-22.1">1</tspan>
    </text>
    <line x1="0" y1="-56" x2="504" y2="-56"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-50.1">2</tspan>
    </text>
    <line x1="0" y1="-84" x2="504" y2="-84"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-78.1">3</tspan>
    </text>
    <line x1="0" y1="-112" x2="504" y2="-112"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-106.1">4</tspan>
    </text>
    <line x1="0" y1="-140" x2="504" y2="-140"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-134.1">5</tspan>
    </text>
    <line x1="0" y1="-168" x2="504" y2="-168"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-162.1">6</tspan>
    </text>
    <line x1="0" y1="-196" x2="504" y2="-196"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-190.1">7</tspan>
    </text>
    <line x1="0" y1="-224" x2="504" y2="-224"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-218.1">8</tspan>
    </text>
    <line x1="0" y1="-252" x2="504" y2="-252"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-246.1">9</tspan>
    </text>
    <line x1="0" y1="-280" x2="504" y2="-280"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-274.1">10</tspan>
    </text>
    <line x1="0" y1="-308" x2="504" y2="-308"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-302.1">11</tspan>
    </text>
    <line x1="0" y1="-336" x2="504" y2="-336"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-330.1">12</tspan>
    </text>
    <line x1="0" y1="-364" x2="504" y2="-364"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-358.1">13</tspan>
    </text>
    <line x1="0" y1="-392" x2="504" y2="-392"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-386.1">14</tspan>
    </text>
    <line x1="0" y1="-420" x2="504" y2="-420"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-414.1">15</tspan>
    </text>
    <line x1="0" y1="-448" x2="504" y2="-448"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-442.1">16</tspan>
    </text>
    <line x1="0" y1="-476" x2="504" y2="-476"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-470.1">17</tspan>
    </text>
    <line x1="0" y1="-504" x2="504" y2="-504"></line>
    <text text-anchor="end">
        <tspan x="-12" y="-498.1">18</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="252" y="45.5"><tspan>x</tspan></tspan>
    </text>
    <text text-anchor="end">
        <tspan x="-42.56" y="-246.1"><tspan>y</tspan></tspan>
    </text>
    <circle cx="0" cy="-28" r="5"></circle>
    <circle cx="0" cy="-504" r="5"></circle>
    <circle cx="28" cy="-28" r="5"></circle>
    <circle cx="28" cy="-504" r="5"></circle>
    <circle cx="56" cy="-224" r="5"></circle>
    <circle cx="56" cy="-308" r="5"></circle>
    <circle cx="84" cy="-140" r="5"></circle>
    <circle cx="84" cy="-392" r="5"></circle>
    <circle cx="112" cy="-56" r="5"></circle>
    <circle cx="112" cy="-476" r="5"></circle>
    <circle cx="140" cy="-224" r="5"></circle>
    <circle cx="140" cy="-308" r="5"></circle>
    <circle cx="224" cy="-196" r="5"></circle>
    <circle cx="224" cy="-336" r="5"></circle>
    <circle cx="336" cy="-224" r="5"></circle>
    <circle cx="336" cy="-308" r="5"></circle>
    <circle cx="364" cy="0" r="5"></circle>
    <circle cx="420" cy="-168" r="5"></circle>
    <circle cx="420" cy="-364" r="5"></circle>
    <circle cx="504" cy="-28" r="5"></circle>
    <circle cx="504" cy="-504" r="5"></circle>

</svg>

  <figcaption>
The elliptic curve \(y^2 =_{19} x^3 - x + 1\) over the field \(\mathbb{F}_{19}\).
</figcaption>
</figure>

<p>We can make several observations based on this example:</p>
<ul>
  <li><strong>Symmetry</strong>: The elliptic curve is still symmetric about the \(x\) axis,
i.e. if \(y\) is a solution to the <a href="#curve-equation">curve equation</a> for some value of \(x\),
then so is <a href="#solutions-of-squares">\(-y\) but no other value</a>.
Since \(-y\) is usually represented as \(p - y\) when computing <a href="#modulo-operation">modulo</a> \(p\),
the symmetry that you see in the graph above is about \(y = \frac{p}{2} = 9.5\) rather than about \(y = 0\)
because the values from \(-9\) to \(-1\) are displayed above and not below the values from \(0\) to \(9\).
If we ignore <a href="https://en.wikipedia.org/wiki/Field_extension">extension fields</a>,
<!-- --> \(p\) is odd and thus either \(y\) or \(p - y\) is even while the other value is odd.</li>
  <li><strong>Gaps</strong>: Not every element of a finite field has <a href="#square-roots">square roots</a>.
If \(x^3 + a \cdot x + b\) results in a <a href="#quadratic-residues">quadratic non-residue</a>,
the elliptic curve has no points at such an \(x\) value.
In the example above, this is the case for \(x \in \{6, 7, 9, 10, 11, 14, 16, 17\}\).</li>
  <li><strong>Order</strong>: The point at \((13, 0)\) is its own inverse.
Since its order is \(2\), we know that this group has <a href="#lagrange-consequences">an even number of points</a>.
(You will count only \(21\) points, but you also have to include the <a href="#point-at-infinity">point at infinity</a>.)</li>
</ul>

<details>
  <summary id="counting-the-points-on-elliptic-curves">
Counting the points on elliptic curves
</summary>

  <p>The elements of an elliptic-curve group
are \(\{ (x, y) \in \href{https://en.wikipedia.org/wiki/Cartesian_product}{\mathbb{F} \times \mathbb{F}}
\mid y^2 = x^3 + a \cdot x + b \href{#logical-conjunction}{\land} 4a^3 + 27b^2 ≠ 0 \} \cup \{ O \}\).
In order to determine the <a href="#group-order">group’s order</a>,
we have to <a href="https://en.wikipedia.org/wiki/Counting_points_on_elliptic_curves">count the points on the elliptic curve</a>.
A naive approach of doing so is to determine for each possible \(x\)
whether \(x^3 + a \cdot x + b\) is a <a href="#quadratic-residues">quadratic residue</a>.
If this is the case, you increase your counter by \(2\).
If \(x^3 + a \cdot x + b = 0\), you increase your counter by \(1\).
However, this approach is <a href="#computational-complexity-theory">computationally infeasible</a>
for the large <a href="#finite-fields">finite fields</a>
that we need in <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">elliptic-curve cryptography</a>.
<a href="https://en.wikipedia.org/wiki/Ren%C3%A9_Schoof">René Schoof</a> (born in 1955)
published an <a href="https://en.wikipedia.org/wiki/Schoof%27s_algorithm">efficient algorithm</a>
for counting the points on elliptic curves over finite fields in 1985.
Unfortunately, his algorithm is too complicated for this introductory article.</p>

</details>

<h3 id="point-calculator">Point calculator</h3>

<p>The following tool <a href="#pseudocode-for-point-addition">implements point addition</a> and <a href="#fast-repetitions">repetition</a> for
elliptic curves in <a href="#curve-equation">Weierstrass normal form</a> over <a href="#integers-modulo-p">prime fields</a> of arbitrary size.
If you want a visualization of point addition on <a href="#discrete-curves">discrete curves</a>,
you can use <a href="https://andrea.corbellini.name/ecc/interactive/modk-add.html">this tool</a>
by <a href="https://andrea.corbellini.name/about/">Andrea Corbellini</a>.</p>



<h3 id="elliptic-curve-operation-table">Operation table</h3>

<p>The following tool generates the <a href="#additive-group-operation-table">operation table</a>
for elliptic curves in <a href="#curve-equation">Weierstrass normal form</a>
over <a href="#integers-modulo-p">prime fields</a> smaller than 100:</p>



<p>Since <a href="#point-addition">point addition</a> is <a href="#commutative-groups">commutative</a>,
the above table is symmetric about the diagonal from the upper left to the lower right.
The tool highlights the <a href="#point-at-infinity">point at infinity</a> with a green background
and elements which are their own inverse (i.e. elements whose \(y\)-coordinate is \(0\)) with a gray background.
Since inverses are displayed next to each other
and \(A + B = C\) <a href="#inversion-of-combination">implies that</a> \((-A) + (-B) = (-C)\),
you have two by two squares with inverses diagonally opposite of each other:</p>

<figure>

  <table>
  <thead>
    <tr>
      <th>∘</th>
      <th>⋯</th>
      <th>B</th>
      <th>−B</th>
      <th>⋯</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>⋮</th>
      <td></td>
      <td>⋮</td>
      <td>⋮</td>
      <td></td>
    </tr>
    <tr>
      <th>A</th>
      <td>⋯</td>
      <td>C</td>
      <td>D</td>
      <td>⋯</td>
    </tr>
    <tr>
      <th>−A</th>
      <td>⋯</td>
      <td>−D</td>
      <td>−C</td>
      <td>⋯</td>
    </tr>
    <tr>
      <th>⋮</th>
      <td></td>
      <td>⋮</td>
      <td>⋮</td>
      <td></td>
    </tr>
  </tbody>
</table>

  <figcaption>
Symmetries within the operation table.
</figcaption>
</figure>

<h3 id="elliptic-curve-repetition-table">Repetition table</h3>

<p>Since the points on an elliptic curve together with the <a href="#point-at-infinity">point at infinity</a>
form a <a href="#group-axioms">group</a> under <a href="#point-addition">point addition</a>,
<a href="#element-repetitions">repeatedly adding a point to itself</a>,
which is known as <a href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication">point multiplication</a>,
generates a <a href="#subgroups">subgroup</a>,
whose order divides the <a href="#group-order">order of the group</a> according to <a href="#lagranges-theorem">Lagrange’s theorem</a>.
You can verify that this is the case for moduli up to 100 with the following tool:</p>



<p>If you play around with the above tool, you can observe the following facts:</p>
<ul>
  <li><strong>Non-cyclic groups</strong>: Not all elliptic curves are <a href="#cyclic-groups">cyclic</a>.
Example: <a href="#tool-table-elliptic-curve-repetition&amp;modulus=7&amp;parameterA=3&amp;parameterB=0">p = 7, a = 3, b = 0</a>.</li>
  <li><strong>Groups of prime order</strong>: There are elliptic curves whose order is prime,
which is not possible in the case of <a href="#multiplicative-groups">multiplicative groups</a>.
Example: <a href="#tool-table-elliptic-curve-repetition&amp;modulus=7&amp;parameterA=3&amp;parameterB=5">p = 7, a = 3, b = 5</a>.</li>
  <li><strong>Elements of even order</strong>: Whenever an element has an even <a href="#element-order">order</a>,
the element at half its order is its own inverse and thus marked with a gray background.
Example: <a href="#tool-table-elliptic-curve-repetition&amp;modulus=7&amp;parameterA=3&amp;parameterB=1">p = 7, a = 3, b = 1</a>.</li>
</ul>

<h3 id="elliptic-curve-subgroup-cosets">Subgroup cosets</h3>

<p>For the sake of completeness,
the following tool shows the <a href="#subgroup-cosets">cosets</a> of the <a href="#subgroups">subgroup</a>
which is generated by the given point (see <a href="#additive-group-subgroup-cosets">above</a>):</p>



<h3 id="elliptic-curve-discrete-logarithm-problem" data-toc-text="Elliptic curve DLP">Elliptic-curve discrete-logarithm problem (<abbr title="Elliptic-Curve Discrete-Logarithm Problem">ECDLP</abbr>)</h3>

<p>Similar to the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
of <a href="#multiplicative-groups">multiplicative groups</a>,
it’s <a href="#computational-complexity-theory">believed</a> that determining how many times a point
on an <a href="#curve-equation">elliptic curve</a> has been repeated is computationally infeasible
if the <a href="#element-order">order of the point</a> is large enough and the curve has no
<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Domain_parameters">known weakness</a>.
This means that under the right conditions, you cannot find the coefficient \(k\)
so that \(kG = K\) in a reasonable amount of time,
where \(G\) is a <a href="#group-generators">generator</a> and \(K\) is an arbitrary point on the curve.
Since <a href="#dl-algorithms">many algorithms</a> for finding the number of repetitions work
in multiplicative groups and on elliptic curves,
this <a href="https://en.wikipedia.org/wiki/Computational_problem">problem</a> is still known as the discrete-logarithm problem,
even though “point-division problem” would be more accurate,
given that the <a href="#notation">additive notation</a> is used for groups based on elliptic curves.</p>

<h3 id="curve-parameters">Curve parameters</h3>

<p>In <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">elliptic-curve cryptography</a>, an elliptic curve is defined
by the following <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Domain_parameters">six parameters</a>:</p>
<ul>
  <li>\(p\) specifies the <a href="#integers-modulo-p">prime field \(\mathbb{F}_p\)</a> over which the elliptic curve is defined.</li>
  <li>\(a\) is the first parameter of the <a href="#curve-equation">curve equation</a> \(y^2 = x^3 + a \cdot x + b\).</li>
  <li>\(b\) is the second parameter of the curve equation \(y^2 = x^3 + a \cdot x + b\).</li>
  <li>\(G\) is the <a href="#group-generators">generator</a> which all users of a particular curve share.</li>
  <li>\(n\) specifies the <a href="#element-order">order</a> of \(G\), i.e. \(n = \vert G \vert\) and \(nG = O\).</li>
  <li>\(h\) is the <a href="#index-and-cofactor">cofactor</a> of the <a href="#subgroups">subgroup</a> generated by \(G\).</li>
</ul>

<p>As mentioned in the <a href="#elliptic-curve-discrete-logarithm-problem">previous section</a>, certain choices of parameters
have <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Domain_parameters">known weaknesses</a>
and should thus be avoided.
The bigger problem in the standardization of elliptic curves are potential weaknesses which are not yet publicly known.
Ideally, all parameters are chosen
<a href="https://en.wikipedia.org/wiki/Nothing-up-my-sleeve_number">in a predictable manner</a>
in order to reduce the risk of a hidden <a href="https://en.wikipedia.org/wiki/Backdoor_(computing)">backdoor</a>.</p>

<details>
  <summary id="curve-secp256k1">
Curve secp256k1
</summary>

  <p><a href="https://en.wikipedia.org/wiki/Bitcoin">Bitcoin</a>, <a href="https://en.wikipedia.org/wiki/Ethereum">Ethereum</a>, and many
other <a href="https://en.wikipedia.org/wiki/Cryptocurrency">cryptocurrencies</a> use an <a href="#elliptic-curves">elliptic curve</a>
called <a href="https://en.bitcoin.it/wiki/Secp256k1"><code>secp256k1</code></a> in their signature algorithm,
which is defined in <a href="https://www.secg.org/sec2-v2.pdf">Standards for Efficient Cryptography (<abbr title="Standards for Efficient Cryptography">SEC</abbr>)</a>
by the <a href="https://www.secg.org/">Standards for Efficient Cryptography Group (<abbr title="Standards for Efficient Cryptography Group">SECG</abbr>)</a>.
The letter <code>p</code> indicates that the curve is defined over a <a href="#integers-modulo-p">prime field</a>.
It is followed by the length of the <a href="#curve-parameters">prime \(p\)</a> in <a href="https://riskmusings.substack.com/internet/#number-encoding">bits</a>.
The letter <code>k</code> stands for <a href="https://www.iacr.org/archive/crypto2001/21390189.pdf">Koblitz curve</a>,
named after <a href="https://en.wikipedia.org/wiki/Neal_Koblitz">Neal Koblitz</a> (born in 1948),
which allows for especially efficient implementations.
The <code>1</code> at the end is just a sequence number.
<code>secp256k1</code> has the following <a href="#curve-parameters">curve parameters</a>
in <a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal notation</a>
(see <a href="https://www.secg.org/sec2-v2.pdf">section 2.4.1 on page 9</a>):</p>
  <ul>
    <li>\(p =\) <a href="#tool-integer-conversion&amp;integer=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+FFFFFC2F"><code>FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F</code></a> \(= 2^{256} - 2^{32} - 2^{9} - 2^{8} - 2^{7} - 2^{6} - 2^{4} - 1\)
(The proximity to \(2^{256}\) allows for
<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Fast_reduction_(NIST_curves)">faster implementations</a>
of the <a href="#modulo-operation">modulo operation</a>.)</li>
    <li>
      <!-- -->
      <p>\(a = 0\)</p>
    </li>
    <li>
      <!-- -->
      <p>\(b = 7\)</p>
    </li>
    <li>\(G =\) (<a href="#tool-integer-conversion&amp;integer=79BE667E+F9DCBBAC+55A06295+CE870B07+029BFCDB+2DCE28D9+59F2815B+16F81798"><code>79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798</code></a>, <a href="#tool-integer-conversion&amp;integer=483ADA77+26A3C465+5DA4FBFC+0E1108A8+FD17B448+A6855419+9C47D08F+FB10D4B8"><code>483ADA77 26A3C465 5DA4FBFC 0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8</code></a>)</li>
    <li>\(n =\) <a href="#tool-integer-conversion&amp;integer=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+BAAEDCE6+AF48A03B+BFD25E8C+D0364141"><code>FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE BAAEDCE6 AF48A03B BFD25E8C D0364141</code></a></li>
    <li>
      <!-- -->
      <p>\(h = 1\)</p>
    </li>
  </ul>

  <p>You can click on the hexadecimal numbers to convert them to <a href="https://en.wikipedia.org/wiki/Decimal">decimal numbers</a>
with the tool in the <a href="#integer-conversion">next box</a>.
You can <a href="#tool-integer-miller-rabin-primality-test&amp;input=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+FFFFFC2F&amp;bases=&amp;seed=0&amp;rounds=64&amp;abort=true">verify with the Miller-Rabin primality test</a>
that \(p\) is indeed prime.
Given the above \(a\) and \(b\), the <a href="#curve-equation">curve equation</a> is \(y^2 =_p x^3 + 7\).
While <a href="#counting-the-points-on-elliptic-curves">counting the points on elliptic curves</a> is complicated,
you can verify with the <a href="#point-calculator">point calculator</a> above that <a href="#tool-elliptic-curve-operations&amp;p=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+FFFFFC2F&amp;a=0&amp;b=7&amp;Ax=79BE667E+F9DCBBAC+55A06295+CE870B07+029BFCDB+2DCE28D9+59F2815B+16F81798&amp;Ay=true&amp;Bx=1&amp;By=true&amp;c=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+BAAEDCE6+AF48A03B+BFD25E8C+D0364141">\(nG = O\)</a>
(the tool also recovers the \(y\)-coordinate of \(G\) correctly).
Since <a href="#tool-integer-modulo&amp;integer=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+FFFFFC2F&amp;modulus=4">\(p\ \%\ 4 = 3\)</a>,
computing <a href="#square-roots">square roots modulo \(p\)</a> is simple.
Since <a href="#tool-integer-miller-rabin-primality-test&amp;input=FFFFFFFF+FFFFFFFF+FFFFFFFF+FFFFFFFE+BAAEDCE6+AF48A03B+BFD25E8C+D0364141&amp;bases=&amp;seed=0&amp;rounds=64&amp;abort=true">\(n\) is prime</a>
and \(G\) is not the <a href="#point-at-infinity">point at infinity</a>,
the <a href="#element-order">order of \(G\)</a> cannot be smaller than \(n\).
Since the <a href="#index-and-cofactor">cofactor</a> is \(1\), \(G\) generates all points on the elliptic curve.
Since \(n\) is prime, every element except \(O\) <a href="#lagrange-consequences">is a generator</a>.
And since \(n\) is odd, we know that the curve has <a href="#discrete-curves">no point with a \(y\)-coordinate of \(0\)</a>.</p>

</details>

<details>
  <summary id="integer-conversion">
Integer conversion
</summary>

  <p>The following tools converts the given integer to the <a href="https://en.wikipedia.org/wiki/Decimal">decimal</a>
and the <a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal</a>
<a href="https://en.wikipedia.org/wiki/Numeral_system">numeral system</a>
in the <a href="#formatting-preferences">preferred formatting</a>:</p>

  

</details>

<h2 id="dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</h2>

<p>We now have two families of <a href="#finite-groups">finite groups</a>
for which it is presumably <a href="#computational-complexity-theory">difficult</a>
to determine how many times <a href="#element-repetitions">an element has been repeated</a>
if the parameters of the group have been chosen <a href="#pohlig-hellman-algorithm">carefully</a>:</p>
<ul>
  <li><a href="#multiplicative-groups"><strong>Multiplicative groups</strong></a>:
Given a modulus \(m\), a <a href="#group-generators">generator</a> \(G\), and an element \(K\),
it’s hard to find the integer \(k\) so that \(G^k =_m K\).</li>
  <li><a href="#elliptic-curves"><strong>Elliptic curves</strong></a>:
Given an elliptic curve, a generator \(G\), and a point \(K\),
it’s hard to find the integer \(k\) so that \(kG = K\).</li>
</ul>

<p>In both groups, this is known as the <a href="#discrete-logarithm-problem">discrete-logarithm problem (<abbr title="Discrete-Logarithm Problem">DLP</abbr>)</a>; in the latter case
also as the <a href="#elliptic-curve-discrete-logarithm-problem">elliptic-curve discrete-logarithm problem (<abbr title="Elliptic-Curve Discrete-Logarithm Problem">ECDLP</abbr>)</a>.
Since group operations are <a href="#group-axioms">associative</a> and repeating an element <a href="#fast-repetitions">is fast</a>,
this gives us the <a href="#linear-one-way-functions">linear one-way function</a> we were aiming for.
In this chapter, we’ll study some of the best
<a href="https://en.wikipedia.org/wiki/Discrete_logarithm#Algorithms">known algorithms for solving the discrete-logarithm problem</a>.
This allows us to understand why the number of steps we need to solve a discrete-logarithm problem
is <a href="#pollards-rho-algorithm">at most the square root</a> of <a href="#pohlig-hellman-algorithm">the largest prime factor</a>
of the <a href="#element-order">generator’s order</a>,
and why it’s <a href="#index-calculus-algorithm">even less</a> in the case of multiplicative groups.
Before we do so, we’ll revisit how an element of a group can be <a href="#fast-repetitions">repeated efficiently</a>.
This gives you a better feeling for why one direction of the linear one-way function is so much easier than the other.</p>

<h3 id="repetition-revisited">Repetition revisited</h3>

<p>As explained <a href="#fast-repetitions">earlier</a>,
repeating a <a href="#group-generators">generator</a> \(G\) \(k\) times takes just \(\log_2(k)\) steps,
which corresponds to the <a href="https://en.wikipedia.org/wiki/Bit-length">bit-length</a> of \(k\).
The algorithm below uses the fact that one can “rebuild” a binary number by doubling, thereby shifting the current
<a href="https://en.wikipedia.org/wiki/Bit">binary digits (bits)</a> one to the left, and by adding one, thereby setting the
<a href="https://en.wikipedia.org/wiki/Bit_numbering#Bit_significance_and_indexing">least-significant bit</a> to \(1\).
Using <a href="https://en.wikipedia.org/wiki/Subscript_and_superscript">subscripts</a> to denote the \(l\) bits of \(k\)
from right to left so that \(k = (k_{l-1} … k_0)_2 = \sum_{i = 0}^{l - 1} k_i2^i\) and \(k_{l-1} = 1\),
we can rebuild the positive integer \(k\) in the coefficient or exponent of \(G\)
by combining the current result with itself and by combining it with \(G\):</p>

<p>

$$
\text{function }binaryRepeat(G, k)\ \{ \\
\quad \text{let }K := G \\
\quad \text{for }(i\text{ from }l - 2\text{ to }0)\ \{ \\
\quad \quad K := 2K \\
\quad \quad \text{if }(k_i = 1)\ \{ \\
\quad \quad \quad K := K + G \\
\quad \quad \} \\
\quad \} \\
\quad \text{return } K \\
\} \\
$$

$$
\text{function }binaryRepeat(G, k)\ \{ \\
\quad \text{let }K := G \\
\quad \text{for }(i\text{ from }l - 2\text{ to }0)\ \{ \\
\quad \quad K := K^2 \\
\quad \quad \text{if }(k_i = 1)\ \{ \\
\quad \quad \quad K := K \cdot G \\
\quad \quad \} \\
\quad \} \\
\quad \text{return } K \\
\} \\
$$

</p>

<p>This algorithm is similar to the one I covered <a href="#non-recursive-algorithm">earlier</a>,
but this time we work explicitly with a binary representation of \(k\)
and process its bits from the left to the right instead of the other way around.
The following tool implements this algorithm for <a href="#multiplicative-groups">multiplicative groups</a>
and <a href="#elliptic-curves">elliptic curves</a>.
You can change which group is being displayed in all the remaining tools <a href="#notation">by double-clicking on its tab</a>.</p>



<details>
  <summary id="limitations-of-the-above-tool">
Limitations of the above tool
</summary>

  <p>The <a href="#tool-discrete-logarithm-binary-repetition">above tool</a> shares its state with the other tools in this chapter.
Since some algorithms for solving the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
work only if the <a href="#element-order">order</a> of the <a href="#group-generators">generator</a> is known,
we have to determine it even in the tools that don’t need it.
In order to <a href="#determining-the-order-of-an-element">determine the order of an element</a>,
you have to know the <a href="#prime-factorization">prime factorization</a> of the <a href="#group-order">group’s order</a>,
which is itself not always easy to determine.
Hence, the tools in this chapter have the following limitations:</p>
  <ul>
    <li><a href="#multiplicative-groups"><strong>Multiplicative groups</strong></a>:
In order to determine the order of a multiplicative group,
we have to evaluate <a href="#eulers-totient-function">Euler’s totient function</a> for its modulus \(m\),
which requires the <a href="#prime-factorization">prime factorization</a> of \(m\).
If \(m\) isn’t prime, the tools in this chapter perform up to 100’000 rounds of
<a href="#pollards-rho-factorization-algorithm">Pollard’s rho factorization algorithm</a>,
which is usually enough to factorize the product of two 35-bit primes, i.e. numbers with up to 21 decimal digits.
If successful, it performs at most another 100’000 rounds of the same algorithm to factorize the group’s order.
If either of these factorizations fail, you have to enter the order of \(G\) yourself,
which gives you the option of choosing the modulus <a href="#search-for-a-group-generator">in a smart way</a>.
If you just want to know the result of a <a href="https://en.wikipedia.org/wiki/Modular_exponentiation">modular exponentiation</a>,
you can use the <a href="#tool-ring-operations">calculator for rings</a> above,
which doesn’t have this limitation.</li>
    <li><a href="#elliptic-curves"><strong>Elliptic curves</strong></a>:
Since I didn’t implement <a href="#counting-the-points-on-elliptic-curves">Schoof’s algorithm</a>,
the tool counts the number of points only for elliptic curves whose modulus \(p\) is smaller than 100’000.
Once the order of the group has been determined, it also performs up to 100’000 rounds
of Pollard’s rho factorization algorithm in order to determine the order of \(G\).
If \(p\) &gt; 100’000 or the factorization fails, you have to enter the order of \(G\) yourself,
which you can determine with <a href="https://en.wikipedia.org/wiki/SageMath">SageMath</a>
as explained in the <a href="#playground-of-sagemath">next box</a>.
If you just want to know the result of a
<a href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication">point multiplication</a>,
you can use the <a href="#point-calculator">point calculator</a> above,
which doesn’t have this limitation.</li>
  </ul>

</details>

<details>
  <summary id="playground-of-sagemath">
Playground of SageMath
</summary>

  <p><a href="https://en.wikipedia.org/wiki/SageMath">SageMath</a> is an
<a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">open-source</a>
<a href="https://en.wikipedia.org/wiki/Library_(computing)">software library</a> for mathematics.
You can use <a href="https://sagecell.sagemath.org/">its playground</a>
for <a href="https://doc.sagemath.org/html/en/reference/index.html">many things</a>,
which includes computations on <a href="https://doc.sagemath.org/html/en/reference/arithmetic_curves/sage/schemes/elliptic_curves/ell_finite_field.html">elliptic curves over finite fields</a>
(see the documentation of
<a href="https://doc.sagemath.org/html/en/reference/arithmetic_curves/sage/schemes/elliptic_curves/ell_finite_field.html#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality"><code>cardinality</code></a>,
<a href="https://doc.sagemath.org/html/en/reference/arithmetic_curves/sage/schemes/elliptic_curves/ell_point.html#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code>order</code></a>,
<a href="https://doc.sagemath.org/html/en/reference/arithmetic_curves/sage/schemes/elliptic_curves/ell_generic.html#sage.schemes.elliptic_curves.ell_generic.EllipticCurve_generic.lift_x"><code>lift_x</code></a>,
and <a href="https://doc.sagemath.org/html/en/reference/plotting/sage/plot/plot.html#sage.plot.plot.plot"><code>plot</code></a>):</p>

  

</details>

<h3 id="exhaustive-search">Exhaustive search</h3>

<p>The simplest algorithm for solving the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
is to simply <a href="https://en.wikipedia.org/wiki/Brute-force_search">try all possible values for \(k\)</a>.
The effort for doing so scales exponentially with the <a href="https://en.wikipedia.org/wiki/Bit-length">bit-length</a> of \(k\).
The search for the input \(k\) so that you get the output \(K\) can be visualized as follows:</p>

<p data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <figure>
    <svg id="figure-dlp-exhaustive-search-additive" data-name="dlp-exhaustive-search-additive" width="539.98" height="52" viewBox="27.771 -20.25 539.98 52" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="35" y1="0" x2="560" y2="0"></line>
    <path d="M 35,-5 A 17.5 14 0 0 1 70,-5 L 70.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <path d="M 70,-5 A 17.5 14 0 0 1 105,-5 L 105.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <path d="M 105,-5 A 17.5 14 0 0 1 140,-5 L 140.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <path d="M 140,-5 A 17.5 14 0 0 1 175,-5 L 175.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <path d="M 175,-5 A 17.5 14 0 0 1 210,-5 L 210.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <path d="M 210,-5 A 17.5 14 0 0 1 245,-5 L 245.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <path d="M 245,-5 A 17.5 14 0 0 1 280,-5 L 280.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <path d="M 280,-5 A 17.5 14 0 0 1 315,-5 L 315.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <path d="M 315,-5 A 17.5 14 0 0 1 350,-5 L 350.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <path d="M 350,-5 A 17.5 14 0 0 1 385,-5 L 385.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>2G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>3G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>4G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>5G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>6G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>kG = K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>O</tspan></tspan>
    </text>

</svg>

    <figcaption>
You count how many times you have to repeat the generator \(G\) to reach the output \(K\).
</figcaption>
  </figure>

  <figure>
    <svg id="figure-dlp-exhaustive-search-multiplicative" data-name="dlp-exhaustive-search-multiplicative" width="535.98" height="52" viewBox="27.771 -20.25 535.98 52" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="35" y1="0" x2="560" y2="0"></line>
    <path d="M 35,-5 A 17.5 14 0 0 1 70,-5 L 70.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <path d="M 70,-5 A 17.5 14 0 0 1 105,-5 L 105.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <path d="M 105,-5 A 17.5 14 0 0 1 140,-5 L 140.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <path d="M 140,-5 A 17.5 14 0 0 1 175,-5 L 175.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <path d="M 175,-5 A 17.5 14 0 0 1 210,-5 L 210.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <path d="M 210,-5 A 17.5 14 0 0 1 245,-5 L 245.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <path d="M 245,-5 A 17.5 14 0 0 1 280,-5 L 280.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <path d="M 280,-5 A 17.5 14 0 0 1 315,-5 L 315.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <path d="M 315,-5 A 17.5 14 0 0 1 350,-5 L 350.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <path d="M 350,-5 A 17.5 14 0 0 1 385,-5 L 385.003828,-4.990762" marker-end="url(#arrow-blue)" stroke-dasharray="43"></path>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>G<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>G<tspan dy="-6">3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>G<tspan dy="-6">4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>G<tspan dy="-6">5</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>G<tspan dy="-6">6</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>G<tspan dy="-6">k</tspan><tspan dy="6">​</tspan> = K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>I</tspan></tspan>
    </text>

</svg>

    <figcaption>
You count how many times you have to repeat the generator \(G\) to reach the output \(K\).
</figcaption>
  </figure>

</p>

<p>Please note that the above graphic is linear only for the coefficient/exponent of \(G\).
If you ordered the elements on the line according to their value
(such as the \(x\)-coordinate in the case of <a href="#point-addition">elliptic curve points</a>),
the steps in blue would look completely chaotic
(see the repetition tables of <a href="#multiplicative-group-repetition-table">multiplicative groups</a>
and <a href="#elliptic-curve-repetition-table">elliptic curves</a> for actual sequences).
The following tool implements exhaustive search for <a href="#multiplicative-groups">multiplicative groups</a>
and <a href="#elliptic-curves">elliptic curves</a>.
The tool spends most of its time waiting so that you can actually see what’s happening.
If you want the result as quickly as possible,
<a href="#tool-discrete-logarithm-multiplicative-group-exhaustive-search&amp;d=0">set the delay to 0</a>,
in which case the tool updates its output only every 1 million steps.</p>



<details>
  <summary id="output-not-in-generated-subgroup">
Output not in generated subgroup
</summary>

  <p>The tools in this chapter don’t require that \(G\) <a href="#group-generators">generates</a> the whole <a href="#finite-groups">group</a>.
In the case of <a href="#multiplicative-groups">multiplicative groups</a>,
it can be desirable for \(G\) to generate just a <a href="#subgroups">subgroup</a>
so that its <a href="#element-order">order</a> can be prime (as mentioned <a href="#multiplicative-group-repetition-table">earlier</a>)
and that the size of <a href="https://en.wikipedia.org/wiki/Key_(cryptography)">cryptographic keys</a>
and <a href="https://en.wikipedia.org/wiki/Digital_signature">signatures</a>
can be smaller (as explained <a href="#bits-of-security">later</a>).
Moreover, some <a href="https://en.wikipedia.org/wiki/Cryptosystem">cryptosystems</a>,
such as <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA</a>,
use <a href="#cyclic-groups">non-cyclic groups</a>, which have no generators.
If \(G\) doesn’t generate the whole group,
you can set the output \(K\) to an element which isn’t in the subgroup generated by \(G\).
While <a href="#subgroup-membership-test-in-cyclic-groups">subgroup membership can be tested easily in cyclic groups</a>,
I didn’t implement this check because
there is no simple formula to determine whether an <a href="#elliptic-curves">elliptic curve</a> is cyclic
and I had to handle this case anyway for non-cyclic groups.</p>

</details>

<details>
  <summary id="subgroup-membership-test-in-cyclic-groups">
Subgroup membership test in cyclic groups
</summary>

  <div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

    <div>

      <p>Given two elements \(G\) and \(K\) of a <a href="#cyclic-groups">cyclic group</a>,
there exists an integer \(k\) so that \(kG = K\)
<a href="#if-and-only-if">if and only if</a> \((\href{#element-order}{\lvert G \rvert})K = O\).
Proof:</p>
      <ul>
        <li>If \(kG = K\), \(K \in \href{#group-generators}{⟨G⟩}\).
According to <a href="#lagrange-consequences">Lagrange’s theorem</a>, \(\lvert K \rvert\) divides \(\lvert G \rvert\).
Therefore, \((\lvert G \rvert)K = O\).</li>
        <li>If \((\lvert G \rvert)K = O\), \(\lvert K \rvert\) divides \(\lvert G \rvert\).
Now, \(K\) and \(\frac{\lvert G \rvert}{\lvert K \rvert}G\) <a href="#group-generators">generate</a>
a <a href="#subgroups">subgroup</a> of <a href="#group-order">order</a> \(\lvert K \rvert\).
As proven <a href="#all-subgroups-of-cyclic-groups-are-cyclic">earlier</a>,
a cyclic group has a single subgroup of order \(\lvert K \rvert\).
Thus, \(⟨K⟩ = ⟨\frac{\lvert G \rvert}{\lvert K \rvert}G⟩\).
Since \(K \in ⟨G⟩\), there exists an integer \(k\) so that \(kG = K\).</li>
      </ul>

    </div>

    <div>

      <p>Given two elements \(G\) and \(K\) of a <a href="#cyclic-groups">cyclic group</a>,
there exists an integer \(k\) so that \(G^k = K\)
<a href="#if-and-only-if">if and only if</a> \(K^{\href{#element-order}{\lvert G \rvert}} = I\).
Proof:</p>
      <ul>
        <li>If \(G^k = K\), \(K \in \href{#group-generators}{⟨G⟩}\).
According to <a href="#lagrange-consequences">Lagrange’s theorem</a>, \(\lvert K \rvert\) divides \(\lvert G \rvert\).
Therefore, \(K^{\lvert G \rvert} = I\).</li>
        <li>If \(K^{\lvert G \rvert} = I\), \(\lvert K \rvert\) divides \(\lvert G \rvert\).
Now, \(K\) and \(G^{\lvert G \rvert / \lvert K \rvert}\) <a href="#group-generators">generate</a>
a <a href="#subgroups">subgroup</a> of <a href="#group-order">order</a> \(\lvert K \rvert\).
As proven <a href="#all-subgroups-of-cyclic-groups-are-cyclic">earlier</a>,
a cyclic group has a single subgroup of order \(\lvert K \rvert\).
Thus, \(⟨K⟩ = ⟨G^{\lvert G \rvert / \lvert K \rvert}⟩\).
Since \(K \in ⟨G⟩\), there exists an integer \(k\) so that \(G^k = K\).</li>
      </ul>

    </div>

  </div>

</details>

<h3 id="baby-step-giant-step">Baby-step giant-step</h3>

<p>We can increase the landing area of <a href="#exhaustive-search">exhaustive search</a> by computing some neighbors of \(K\),
which allows us to make bigger steps:</p>

<p data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <figure>
    <svg id="figure-dlp-giant-step-right-additive" data-name="dlp-giant-step-right-additive" width="539.98" height="74.4" viewBox="27.771 -42.65 539.98 74.4" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 455,-5 A 17.5 14 0 0 1 490,-5 L 490.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 420,-5 A 17.5 14 0 0 1 455,-5 L 455.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 385,-5 A 17.5 14 0 0 1 420,-5 L 420.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <line x1="35" y1="0" x2="560" y2="0"></line>
    <path d="M 35,-5 A 70 36.4 0 0 1 175,-5 L 175.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <path d="M 175,-5 A 70 36.4 0 0 1 315,-5 L 315.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <path d="M 315,-5 A 70 36.4 0 0 1 455,-5 L 455.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>2G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>3G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>4G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>5G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>6G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="420" y="28.5"><tspan>K+G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="455" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>O</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="-17"><tspan>+ sG</tspan></tspan>
    </text>

</svg>

    <figcaption>
If the landing area consists of \(s\) elements, we can take \(s\) steps at once without missing it.
</figcaption>
  </figure>

  <figure>
    <svg id="figure-dlp-giant-step-right-multiplicative" data-name="dlp-giant-step-right-multiplicative" width="535.98" height="74.4" viewBox="27.771 -42.65 535.98 74.4" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 455,-5 A 17.5 14 0 0 1 490,-5 L 490.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 420,-5 A 17.5 14 0 0 1 455,-5 L 455.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 385,-5 A 17.5 14 0 0 1 420,-5 L 420.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <line x1="35" y1="0" x2="560" y2="0"></line>
    <path d="M 35,-5 A 70 36.4 0 0 1 175,-5 L 175.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <path d="M 175,-5 A 70 36.4 0 0 1 315,-5 L 315.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <path d="M 315,-5 A 70 36.4 0 0 1 455,-5 L 455.002395,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>G<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>G<tspan dy="-6">3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>G<tspan dy="-6">4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>G<tspan dy="-6">5</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>G<tspan dy="-6">6</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="420" y="28.5"><tspan>KG</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="455" y="28.5"><tspan>KG<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="490" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>I</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="-17"><tspan>· G<tspan dy="-6">s</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
If the landing area consists of \(s\) elements, we can take \(s\) steps at once without missing it.
</figcaption>
  </figure>

</p>

<p>Since you make giant steps (in blue) after a series of baby steps (in green),
this algorithm is known as <a href="https://en.wikipedia.org/wiki/Baby-step_giant-step">baby-step giant-step</a>.
As you may want to compute the discrete logarithm of several elements,
you typically compute the neighbors of \(G\) instead of \(K\)
and then take the giant steps backwards from the current element \(K\)
so that you can reuse the computed neighbors in later runs:</p>

<p data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <figure>
    <svg id="figure-dlp-giant-step-left-additive" data-name="dlp-giant-step-left-additive" width="539.98" height="74.4" viewBox="27.771 -42.65 539.98 74.4" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 105,-5 A 17.5 14 0 0 1 140,-5 L 140.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 70,-5 A 17.5 14 0 0 1 105,-5 L 105.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 35,-5 A 17.5 14 0 0 1 70,-5 L 70.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <line x1="35" y1="0" x2="560" y2="0"></line>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <path d="M 245,-5 A 70 36.4 0 0 0 105,-5 L 104.997605,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <path d="M 385,-5 A 70 36.4 0 0 0 245,-5 L 244.997605,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>2G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>3G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>4G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>5G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>6G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>O</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="315" y="-17"><tspan>− sG</tspan></tspan>
    </text>

</svg>

    <figcaption>
In the more common variant of the algorithm, you take the giant steps backwards instead of forwards.
</figcaption>
  </figure>

  <figure>
    <svg id="figure-dlp-giant-step-left-multiplicative" data-name="dlp-giant-step-left-multiplicative" width="535.98" height="74.4" viewBox="27.771 -42.65 535.98 74.4" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <path d="M 105,-5 A 17.5 14 0 0 1 140,-5 L 140.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 70,-5 A 17.5 14 0 0 1 105,-5 L 105.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <path d="M 35,-5 A 17.5 14 0 0 1 70,-5 L 70.003828,-4.990762" marker-end="url(#arrow-green)" stroke-dasharray="43"></path>
    <line x1="35" y1="0" x2="560" y2="0"></line>
    <line x1="35" y1="-5" x2="35" y2="5"></line>
    <line x1="70" y1="-5" x2="70" y2="5"></line>
    <path d="M 245,-5 A 70 36.4 0 0 0 105,-5 L 104.997605,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="105" y1="-5" x2="105" y2="5"></line>
    <line x1="140" y1="-5" x2="140" y2="5"></line>
    <line x1="175" y1="-5" x2="175" y2="5"></line>
    <line x1="210" y1="-5" x2="210" y2="5"></line>
    <path d="M 385,-5 A 70 36.4 0 0 0 245,-5 L 244.997605,-4.990291" marker-end="url(#arrow-blue)" stroke-dasharray="164"></path>
    <line x1="245" y1="-5" x2="245" y2="5"></line>
    <line x1="280" y1="-5" x2="280" y2="5"></line>
    <line x1="315" y1="-5" x2="315" y2="5"></line>
    <line x1="350" y1="-5" x2="350" y2="5"></line>
    <line x1="385" y1="-5" x2="385" y2="5"></line>
    <line x1="420" y1="-5" x2="420" y2="5"></line>
    <line x1="455" y1="-5" x2="455" y2="5"></line>
    <line x1="490" y1="-5" x2="490" y2="5"></line>
    <line x1="525" y1="-5" x2="525" y2="5"></line>
    <line x1="560" y1="-5" x2="560" y2="5"></line>
    <text text-anchor="middle">
        <tspan x="35" y="28.5"><tspan>G</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="70" y="28.5"><tspan>G<tspan dy="-6">2</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="105" y="28.5"><tspan>G<tspan dy="-6">3</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="140" y="28.5"><tspan>G<tspan dy="-6">4</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="175" y="28.5"><tspan>G<tspan dy="-6">5</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="210" y="28.5"><tspan>G<tspan dy="-6">6</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="245" y="28.5"><tspan>…</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="385" y="28.5"><tspan>K</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="560" y="28.5"><tspan>I</tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="315" y="-17"><tspan>/ G<tspan dy="-6">s</tspan><tspan dy="6">​</tspan></tspan></tspan>
    </text>

</svg>

    <figcaption>
In the more common variant of the algorithm, you take the giant steps backwards instead of forwards.
</figcaption>
  </figure>

</p>

<p>To look up whether you have reached one of the green elements
in <a href="https://en.wikipedia.org/wiki/Time_complexity#Constant_time">constant time</a>,
you store these elements with their index in a <a href="https://en.wikipedia.org/wiki/Hash_table">hash table</a>.
If you have enough storage for \(\sqrt{n}\) elements (\(n = \href{#element-order}{\lvert G \rvert}\)),
it takes \(\sqrt{n}\) baby steps to compute them and at most \(\sqrt{n}\) giant steps to reach one of them from \(K\).
This is a massive improvement over <a href="#exhaustive-search">exhaustive search</a>,
which takes in the order of \(n\) steps to find \(k\),
assuming that \(k\) was chosen randomly between \(0\) and \(n\).
The following tool implements the baby-step giant-step algorithm,
but it makes at most 99 baby steps for the sake of visualization.
If you’re just interested in the result, you can use the <a href="#pollards-rho-algorithm">next algorithm</a>.</p>



<h3 id="pollards-rho-algorithm">Pollard’s rho algorithm</h3>

<p>The goal of <a href="https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm_for_logarithms">Pollard’s rho algorithm</a>,
which is named after <a href="https://en.wikipedia.org/wiki/John_Pollard_(mathematician)">John M. Pollard</a> (born in 1941),
is to find integers \(a_1\), \(a_2\), \(b_1\), and \(b_2\) so that:</p>

<p>

$$
a_1G + b_1K = a_2G + b_2K \textsf{, where } b_1 ≠_n b_2 \textsf{ and } n = \href{#element-order}{\lvert G \rvert}
$$

$$
G^{a_1} \cdot K^{b_1} = G^{a_2} \cdot K^{b_2} \textsf{, where } b_1 ≠_n b_2 \textsf{ and } n = \href{#element-order}{\lvert G \rvert}
$$

</p>

<p>Once we’ve found such integers, we can solve for \(k\)
(see the <a href="#solving-modular-equations">box below</a> for how to do this)
in the <a href="#repetition-ring">repetition ring</a> of the <a href="#group-generators">generator \(G\)</a>:</p>

<p>

$$
\begin{aligned}
a_1G + b_1K &amp;= a_2G + b_2K \\
b_1K - b_2K &amp;= a_2G - a_1G \\
(b_1 - b_2)kG &amp;= (a_2 - a_1)G \\
(b_1 - b_2)k &amp;=_n a_2 - a_1 \\
\end{aligned}
$$

$$
\begin{aligned}
G^{a_1} \cdot K^{b_1} &amp;= G^{a_2} \cdot K^{b_2} \\
K^{b_1} / K^{b_2} &amp;= G^{a_2} / G^{a_1} \\
(G^k)^{b_1 - b_2} &amp;= G^{a_2 - a_1} \\
(b_1 - b_2)k &amp;=_n a_2 - a_1 \\
\end{aligned}
$$

</p>

<p>So how can we find such integers \(a_1\), \(a_2\), \(b_1\), and \(b_2\)?
First, we define a <a href="https://en.wikipedia.org/wiki/Sequence">sequence</a> of elements \(S_i\)
with a function such as the following:</p>

<p>

$$
S_{i+1} = f(S_i) = \begin{cases}
S_i + G &amp;\text{if } (S_i)_x =_3 0 \text{,} \\
S_i + K &amp;\text{if } (S_i)_x =_3 1 \text{,} \\
S_i + S_i &amp;\text{if } (S_i)_x =_3 2 \text{.}
\end{cases}
$$

$$
S_{i+1} = f(S_i) = \begin{cases}
S_i \cdot G &amp;\text{if } S_i =_3 0 \text{,} \\
S_i \cdot K &amp;\text{if } S_i =_3 1 \text{,} \\
S_i \cdot S_i &amp;\text{if } S_i =_3 2 \text{.}
\end{cases}
$$

</p>

<p>If <a href="#output-not-in-generated-subgroup">\(K\) is in the subgroup generated by \(G\)</a>
and we start with the <a href="#group-axioms">identity element</a> as \(S_1\),
all the elements \(S_i\) of the sequence are in the <a href="#subgroups">subgroup</a> <a href="#group-generators">generated by \(G\)</a>.
Since we’re interested only in <a href="#group-order">finite groups</a> with finitely many elements,
the sequence has to reach an element which was already encountered earlier at some point.
Since the next element of the sequence \(S_{i+1}\) depends only on the previous element \(S_i\),
the sequence repeats from there.
Such a sequence thus forms the <a href="https://en.wikipedia.org/wiki/Rho">Greek letter ρ (rho)</a> with a tail and a cycle:</p>

<figure>
  <svg id="figure-pollards-rho-partial" data-name="pollards-rho-partial" width="131.494" height="230.5" viewBox="-65.747 -73.25 131.494 230.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-48.497" y1="11.688" x2="-48.497" y2="-10.75" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="-34.37" y1="-36.156" x2="-14.939" y2="-47.375" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="14.127" y1="-47.844" x2="33.558" y2="-36.625" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="48.497" y1="-11.688" x2="48.497" y2="10.75" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="34.37" y1="36.156" x2="14.939" y2="47.375" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="-14.127" y1="47.844" x2="-33.558" y2="36.625" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="28" r="16"></circle>
    <circle cx="-48.497" cy="-28" r="16"></circle>
    <circle cx="0" cy="-56" r="16"></circle>
    <circle cx="48.497" cy="-28" r="16"></circle>
    <circle cx="48.497" cy="28" r="16"></circle>
    <circle cx="0" cy="56" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="33.9"><tspan>S<tspan dy="3">3</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-48.497" y="-22.1"><tspan>S<tspan dy="3">4</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="-50.1"><tspan>S<tspan dy="3">5</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="48.497" y="-22.1"><tspan>S<tspan dy="3">6</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="48.497" y="33.9"><tspan>S<tspan dy="3">7</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="61.9"><tspan>S<tspan dy="3">8</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <line x1="-48.497" y1="67.688" x2="-48.497" y2="45.25" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="84" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="89.9"><tspan>S<tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <line x1="-48.497" y1="123.688" x2="-48.497" y2="101.25" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="140" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="145.9"><tspan>S<tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>

</svg>

  <figcaption>
The sequence repeats at \(S_9 = S_3\).
</figcaption>
</figure>

<p>In general, the tail can be empty, and the cycle can consist of a single element, which the function \(f\) maps to itself.
Now,
we can use <a href="https://en.wikipedia.org/wiki/Cycle_detection#Floyd.27s_Tortoise_and_Hare">Floyd’s cycle-finding algorithm</a>,
named after <a href="https://en.wikipedia.org/wiki/Robert_W._Floyd">Robert W. Floyd</a> (1936 − 2001),
to find two elements \(S_u\) and \(S_v\) in this sequence so that \(S_u = S_v\) and \(u ≠ v\).
The algorithm moves two elements with different speeds along the sequence.
Alluding to <a href="https://en.wikipedia.org/wiki/The_Tortoise_and_the_Hare">one of Aesop’s fables</a>,
these elements are usually called the <a href="https://en.wikipedia.org/wiki/Tortoise">tortoise</a>
and the <a href="https://en.wikipedia.org/wiki/Hare">hare</a>.
They both start at \(S_1\), but whenever the tortoise makes one step, the hare makes two.
As a consequence, the hare is ahead until the tortoise enters the cycle as well.
Since the hare cannot jump over the tortoise
(if the hare is one element behind the tortoise, they will be at the same element after the next iteration),
the hare then catches up to the tortoise until they meet again.
All that is left to do is to keep track of the integers \(a\) and \(b\) so that \(S_i = G^a \cdot K^b\)
(respectively \(S_i = aG + bK\)) for both the tortoise and the hare:
Starting with the identity element, where \(a =_n 0\) and \(b =_n 0\),
you add \(1\) to \(a\) if \(S_i =_3 0\), add \(1\) to \(b\) if \(S_i =_3 1\),
and double both \(a\) and \(b\) if \(S_i =_3 2\).
Once the tortoise and the hare meet again, you get the equation at the beginning of this section.
In the rare case that \(b_1 =_n b_2\), you can start the sequence at a different \(S_1\)
by choosing the initial \(a\) and \(b\) randomly instead of setting them both to \(0\).
(I implemented this only in the <a href="#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a> below.)</p>

<p>The following tool implements Pollard’s rho algorithm.
It visualizes the chase of the tortoise and the hare if \(G\)’s order \(n ≤ 400\) and there is a delay.
Since (without the visualization) you have to store only the current element \(C\)
with the corresponding integers \(a\) and \(b\) for both the tortoise \(\square_1\) and the hare \(\square_2\),
the algorithm requires only a very small and fixed amount of memory.
As we’ll see in the <a href="#birthday-paradox">second box</a>,
it requires on average only around \(\sqrt{n}\) iterations until \(C_1 = C_2\).
Therefore, Pollard’s rho algorithm has the same expected running time as <a href="#baby-step-giant-step">baby-step giant-step</a>
and is usually preferable to the latter due to its minimal memory consumption.</p>



<details>
  <summary id="solving-modular-equations">
Solving modular equations
</summary>

  <p>How can we solve an equation of the form \(a \cdot x =_m c\) for \(x\)?
If \(a\) has a <a href="#multiplicative-inverse-revisited">multiplicative inverse</a> modulo \(m\),
<!-- --> \(x =_m c \cdot a^{-1}\).
If \(m\) is prime, a multiplicative inverse exists for every \(a ≠_m 0\).
As we’ll see in the <a href="#pohlig-hellman-algorithm">next section</a>,
we have to run <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a> only for generators of prime order.
In the meantime, I want to explain how to solve this equation
if \(a\) isn’t coprime with the modulus \(m\) and thus has no multiplicative inverse.
As we saw <a href="#least-common-multiple-and-0">earlier</a>, \(a \cdot x =_m c\)
has \(d = \operatorname{\href{#greatest-common-divisor}{gcd}}(a, m)\) solutions in <a href="#integers-modulo-m">\(\mathbb{Z}_m\)</a>
if \(c\) is a multiple of \(d\) and <a href="#bezouts-identity">no solution otherwise</a>.
Using the <a href="#extended-euclidean-algorithm">extended Euclidean algorithm</a>,
we can find integers \(b\) and \(n\) so that \(d = a \cdot b + m \cdot n\).
After multiplying both sides by \(c / d\), we get \(c = a \cdot (b \cdot c / d) + m \cdot (n \cdot c / d)\).
Modulo \(m\), we have \(a \cdot (b \cdot c / d) =_m c\),
which means that \(x =_m b \cdot c / d\) is a solution to \(a \cdot x =_m c\).
Since the \(d\) solutions are equally apart, we get the other \(d - 1\) solutions
by adding multiples of the offset \(o = m / d\) to \(x\).
The following tool does all of that for you:</p>

  

  <p>In <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a>,
we then just have to test all solutions for \(k\).
Depending on the <a href="#prime-factorization">prime factorization</a> of \(G\)’s <a href="#element-order">order</a> \(n\),
there can be quite a lot of solutions to check, unfortunately.</p>

</details>

<details>
  <summary id="birthday-paradox">
Birthday paradox
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Birthday_problem">birthday paradox</a> denotes the counterintuitive fact
that in a group of 23 people, it’s likelier than not that at least two of them have the same birthday.
Since we’re not interested in birthdays, we analyze this problem more generally:
When we put \(i\) items randomly into \(n\) buckets,
how likely is it that at least one bucket contains at least two items?
If \(i &gt; n\), the probability of this happening is \(1\) according to the
<a href="https://en.wikipedia.org/wiki/Pigeonhole_principle">pigeonhole principle</a>.
If \(i ≤ n\), we first analyze the probability \(\overline{P}(i, n)\) that this is not happening,
i.e. the probability that all buckets contain at most one item.
The probability that the first item lands in an empty bucket is \(1\).
For the second item, \(n - 1\) of the \(n\) buckets are still empty.
The probability of landing in one of those is \(\frac{n - 1}{n}\).
Thus:</p>

\[\overline{P}(i, n) = \frac{n}{n} \cdot \frac{n - 1}{n} \cdot \frac{n - 2}{n} \cdot … \cdot \frac{n - i + 1}{n}
= \frac{n \cdot (n - 1) \cdot (n - 2) \cdot … \cdot (n - i + 1)}{n^i} = \frac{n\href{https://en.wikipedia.org/wiki/Factorial}{!}}{n^i(n - i)!}\]

  <p>The probability that at least one bucket contains at least two items is then \(P(i, n) = 1 - \overline{P}(i, n)\).
Applied to the birthday paradox, we have \(P(23, 365) = 1 - 365! / (365^{23}(365 - 23)!) =
\href{https://www.wolframalpha.com/input?i=1-365%21%2F%28365%5E23*%28365-23%29%21%29}{0.5073}\).
So how is this related to <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a>?
If the function \(f(S_i)\) gives us a random element in the subgroup generated by \(G\) of <a href="#group-order">order</a> \(n\),
<!-- --> \(P(i, n)\) describes how likely it is that \(f\) returned at least one element twice after \(i\) invocations.
Unlike the birthday paradox, we’re not interested in the <a href="https://en.wikipedia.org/wiki/Median">median</a>
but rather in the expected number of iterations \(E(n)\) until we obtain an element twice.
The <a href="https://en.wikipedia.org/wiki/Expected_value">expected value</a>
of a <a href="https://en.wikipedia.org/wiki/Random_variable">random variable</a>
is determined as the sum of each possible outcome multiplied by the probability of this outcome.
The first possible outcome is that we get a repetition in the second iteration.
The probability that we get the element from the first iteration again in the second iteration is \(\frac{1}{n}\).
The probability that we get the first repetition in the third iteration is the probability
that we don’t get a repetition in the second iteration (\(\frac{n - 1}{n}\)) times the probability
that we get one of the first two elements in the third iteration (\(\frac{2}{n}\)).
The probability that we sample \(n\) different elements and get the repetition only in the \((n + 1)\)th iteration
is \(\frac{(n-1)!}{n^{n-1}} = \frac{n!}{n^n}\).
Thus:</p>

\[\begin{aligned}
E(n) &amp;= 2 \cdot \frac{1}{n} + 3 \cdot \frac{n - 1}{n} \cdot \frac{2}{n}
+ 4 \cdot \frac{n - 1}{n} \cdot \frac{n - 2}{n} \cdot \frac{3}{n} + … + (n + 1) \cdot \frac{n!}{n^n} \\[8pt]
&amp;= \sum_{i=2}^{n+1} \frac{i \cdot (n - 1)! \cdot (i - 1)}{(n - i + 1)! \cdot n^{i - 1}}
= \sum_{i=2}^{n+1} \frac{i \cdot (i - 1)}{n - i + 1} \cdot \frac{n!}{(n - i)! \cdot n^i}
\end{aligned}\]

  <p>This formula determines the colored area of the following outcome × probability table
by adding up the area of each column:</p>

  <figure>
    <svg id="figure-sampling-until-repetition" data-name="sampling-until-repetition" width="291.64" height="291.5" viewBox="-45.75 -24.75 291.64 291.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <rect x="0" y="0" width="240" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="25.9">1</tspan>
    </text>
    <rect x="0" y="40" width="48" height="40" rx="0" ry="0"></rect>
    <rect x="48" y="40" width="192" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="65.9">2</tspan>
    </text>
    <rect x="48" y="80" width="76.8" height="40" rx="0" ry="0"></rect>
    <rect x="124.8" y="80" width="115.2" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="105.9">3</tspan>
    </text>
    <rect x="124.8" y="120" width="69.12" height="40" rx="0" ry="0"></rect>
    <rect x="193.92" y="120" width="46.08" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="145.9">4</tspan>
    </text>
    <rect x="193.92" y="160" width="36.864" height="40" rx="0" ry="0"></rect>
    <rect x="230.784" y="160" width="9.216" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="185.9">5</tspan>
    </text>
    <rect x="230.784" y="200" width="9.216" height="40" rx="0" ry="0"></rect>
    <text text-anchor="end">
        <tspan x="-12" y="225.9">6</tspan>
    </text>
    <line x1="0" y1="0" x2="240" y2="0"></line>
    <line x1="0" y1="40" x2="240" y2="40"></line>
    <line x1="0" y1="80" x2="240" y2="80"></line>
    <line x1="0" y1="120" x2="240" y2="120"></line>
    <line x1="0" y1="160" x2="240" y2="160"></line>
    <line x1="0" y1="200" x2="240" y2="200"></line>
    <line x1="0" y1="240" x2="240" y2="240"></line>
    <line x1="0" y1="0" x2="0" y2="240"></line>
    <line x1="48" y1="0" x2="48" y2="240"></line>
    <line x1="124.8" y1="0" x2="124.8" y2="240"></line>
    <line x1="193.92" y1="0" x2="193.92" y2="240"></line>
    <line x1="230.784" y1="0" x2="230.784" y2="240"></line>
    <line x1="240" y1="0" x2="240" y2="240"></line>
    <text text-anchor="middle">
        <tspan x="0" y="-12">0</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="240" y="-12">1</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="120" y="-12">Probability</tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="120" y="263.5">n = 5</tspan>
    </text>
    <text transform="rotate(-90, -33, 120)" text-anchor="middle">
        <tspan x="-33" y="120">Iterations</tspan>
    </text>

</svg>

    <figcaption>
The green area indicates the iteration in which the first repetition occurs.
The width of each column indicates how likely the particular outcome is.
As just explained, the width of each column is determined by \(\frac{n! (i - 1)}{(n - i + 1)! n^i}\).
</figcaption>
  </figure>

  <p>We can simplify \(E(n)\) by summing over the rows instead of the columns.
After the first iteration, the probability that we need at least one more iteration is \(1\).
After the second iteration, the probability that we didn’t get a repetition
and thus need more iterations is \(\frac{n - 1}{n}\).
After the third iteration, we have to multiply this probability times the probability
that the third element wasn’t one of the first two: \(\frac{n - 1}{n} \cdot \frac{n - 2}{n}\).
This gives us the following formula \(Q(n)\) for the blue area in the above graphic:</p>

\[Q(n) = 1 + \frac{n - 1}{n} + \frac{n - 1}{n} \cdot \frac{n - 2}{n} + …
= \sum_{i=1}^{n} \frac{n!}{(n - i)! \cdot n^i} = \frac{n!}{n^n} \cdot \sum_{i=1}^{n} \frac{n^{n-i}}{(n - i)!}\]

  <p>By adding \(1\) for the green area, we have \(E(n) = 1 + Q(n)\).
To approximate the value of \(Q(n)\), we need another formula \(R(n)\):</p>

\[R(n) = 1 + \frac{n}{n + 1} + \frac{n}{n + 1} \cdot \frac{n}{n + 2} + …
= \sum_{i=0}^{\infty} \frac{n! \cdot n^i}{(n + i)!} = \frac{n!}{n^n} \cdot \sum_{i=0}^{\infty} \frac{n^{n+i}}{(n + i)!}\]

  <p>For sufficiently large \(n\), \(Q(n) \approx R(n)\) because the difference between \(\frac{n - 1}{n}\)
and \(\frac{n}{n + 1}\) gets smaller and smaller as \(n\) gets larger, and the addends from \(i = n + 1\)
to \(\infty\) get vanishingly small as they are the product of lots of numbers smaller than \(1\).
Using the <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor series</a>,
named after <a href="https://en.wikipedia.org/wiki/Brook_Taylor">Brook Taylor</a> (1685 − 1731),
of the <a href="https://en.wikipedia.org/wiki/Exponential_function">exponential function</a>
(i.e. \(e^n = \sum_{i=0}^{\infty} \frac{n^i}{i!}\))
and <a href="https://en.wikipedia.org/wiki/Stirling%27s_approximation">Stirling’s formula</a>,
named after <a href="https://en.wikipedia.org/wiki/James_Stirling_(mathematician)">James Stirling</a> (1692 − 1770),
to approximate <a href="https://en.wikipedia.org/wiki/Factorial">factorials</a>
(i.e. \(n! \approx \sqrt{2 \pi n}\frac{n^n}{\mathrm{e}^n}\)), we get:</p>

\[Q(n) + R(n)
= \frac{n!}{n^n} \cdot \Big( \sum_{i=1}^{n} \frac{n^{n-i}}{(n - i)!} + \sum_{i=0}^{\infty} \frac{n^{n+i}}{(n + i)!} \Big)
= \frac{n!}{n^n} \cdot \Big( \sum_{i=0}^{\infty} \frac{n^i}{i!} \Big)
= \frac{n!}{n^n} \cdot \mathrm{e}^n \approx \sqrt{2 \pi n}\]

  <p>Therefore, \(Q(n) \approx \frac{1}{2} \sqrt{2 \pi n} = \sqrt{\frac{\pi}{2} n} \approx 1.25 \sqrt{n}\)
since \(\frac{1}{2} = \sqrt{\frac{1}{4}}\),
which means that it takes <a href="https://en.wikipedia.org/wiki/Big_O_notation">in the order of</a> \(\sqrt{n}\) iterations until <a href="https://en.wikipedia.org/wiki/Birthday_problem#Average_number_of_people_to_get_at_least_one_shared_birthday">you get a repetition when randomly sampling from \(n\) elements</a>.
The functions \(Q(n)\) and \(R(n)\) were introduced for this analysis
by <a href="https://en.wikipedia.org/wiki/Donald_Knuth">Donald Ervin Knuth</a> (born in 1938)
in section 1.2.11.3 in the first volume of his book
<a href="https://en.wikipedia.org/wiki/The_Art_of_Computer_Programming">The Art of Computer Programming</a>.</p>

  <p>While the function \(f(S_i)\) used by <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a> isn’t random,
it is random enough for \(\sqrt{n}\) to be a really good estimate for how many steps are needed.
In order to make it easier for you to judge this, the <a href="#tool-discrete-logarithm-pollards-rho-algorithm">tool above</a>
displays the number of steps that it took to find a repetition at the top
and the square root (<abbr title="SQuare RooT">sqrt</abbr>) of \(G\)’s order \(n\) below the problem statement.
The above <a href="#figure-pollards-rho-partial">graphic depicting \(\rho\)</a>
showed only the elements in the sequence defined by the starting element and \(f(S_i)\).
However, \(f(S_i)\) maps any of the \(n\) elements to a somewhat random other element.
No matter where you start, you get a first repetition and thus a loop after around \(1.25 \sqrt{n}\) steps on average.
The complete picture looks like this:</p>

  <figure>
    <svg id="figure-pollards-rho-complete" data-name="pollards-rho-complete" width="567.972" height="258.5" viewBox="-211.24 -73.25 567.972 258.5" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">

    <line x1="-48.497" y1="11.688" x2="-48.497" y2="-10.75" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="-34.37" y1="-36.156" x2="-14.939" y2="-47.375" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="14.127" y1="-47.844" x2="33.558" y2="-36.625" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="48.497" y1="-11.688" x2="48.497" y2="10.75" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="34.37" y1="36.156" x2="14.939" y2="47.375" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <line x1="-14.127" y1="47.844" x2="-33.558" y2="36.625" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="28" r="16"></circle>
    <circle cx="-48.497" cy="-28" r="16"></circle>
    <circle cx="0" cy="-56" r="16"></circle>
    <circle cx="48.497" cy="-28" r="16"></circle>
    <circle cx="48.497" cy="28" r="16"></circle>
    <circle cx="0" cy="56" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="33.9"><tspan>S<tspan dy="3">3</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="-48.497" y="-22.1"><tspan>S<tspan dy="3">4</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="-50.1"><tspan>S<tspan dy="3">5</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="48.497" y="-22.1"><tspan>S<tspan dy="3">6</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="48.497" y="33.9"><tspan>S<tspan dy="3">7</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <text text-anchor="middle">
        <tspan x="0" y="61.9"><tspan>S<tspan dy="3">8</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <line x1="-48.497" y1="67.688" x2="-48.497" y2="45.25" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="84" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="89.9"><tspan>S<tspan dy="3">2</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <line x1="-48.497" y1="123.688" x2="-48.497" y2="101.25" marker-end="url(#arrow)" stroke-dasharray="15"></line>
    <circle cx="-48.497" cy="140" r="16"></circle>
    <text text-anchor="middle">
        <tspan x="-48.497" y="145.9"><tspan>S<tspan dy="3">1</tspan><tspan dy="-3">​</tspan></tspan></tspan>
    </text>
    <circle cx="-96.995" cy="168" r="16"></circle>
    <line x1="-82.868" y1="159.844" x2="-63.436" y2="148.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="0" cy="168" r="16"></circle>
    <line x1="-14.127" y1="159.844" x2="-33.558" y2="148.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-96.995" cy="112" r="16"></circle>
    <line x1="-82.868" y1="103.844" x2="-63.436" y2="92.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-145.492" cy="140" r="16"></circle>
    <line x1="-131.365" y1="131.844" x2="-111.934" y2="120.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-145.492" cy="84" r="16"></circle>
    <line x1="-131.365" y1="92.156" x2="-111.934" y2="103.375" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-193.99" cy="112" r="16"></circle>
    <line x1="-179.863" y1="103.844" x2="-160.431" y2="92.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-96.995" cy="-56" r="16"></circle>
    <line x1="-82.868" y1="-47.844" x2="-63.436" y2="-36.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="-145.492" cy="-28" r="16"></circle>
    <line x1="-131.365" y1="-36.156" x2="-111.934" y2="-47.375" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="96.995" cy="56" r="16"></circle>
    <line x1="82.868" y1="47.844" x2="63.436" y2="36.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="96.995" cy="0" r="16"></circle>
    <line x1="82.868" y1="8.156" x2="63.436" y2="19.375" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="145.492" cy="-28" r="16"></circle>
    <line x1="159.619" y1="-19.844" x2="179.051" y2="-8.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="242.487" cy="-28" r="16"></circle>
    <line x1="228.36" y1="-19.844" x2="208.929" y2="-8.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="242.487" cy="28" r="16"></circle>
    <line x1="242.487" y1="11.687" x2="242.487" y2="-10.75" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="193.99" cy="0" r="16"></circle>
    <line x1="208.117" y1="8.156" x2="227.548" y2="19.375" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="193.99" cy="56" r="16"></circle>
    <line x1="208.117" y1="47.844" x2="227.548" y2="36.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="193.99" cy="112" r="16"></circle>
    <line x1="193.99" y1="95.687" x2="193.99" y2="73.25" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="290.985" cy="56" r="16"></circle>
    <line x1="276.857" y1="47.844" x2="257.426" y2="36.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="242.487" cy="84" r="16"></circle>
    <line x1="256.614" y1="75.844" x2="276.046" y2="64.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>
    <circle cx="339.482" cy="84" r="16"></circle>
    <line x1="325.355" y1="75.844" x2="305.923" y2="64.625" marker-end="url(#arrow-gray)" stroke-dasharray="15"></line>

</svg>

    <figcaption>
The \(n\) elements are depicted as circles and the mappings defined by \(f(S_i)\) as arrows.
</figcaption>
  </figure>

</details>

<details>
  <summary id="pollards-rho-factorization-algorithm">
Pollard’s rho factorization algorithm
</summary>

  <p>We can apply <a href="#pollards-rho-algorithm">the same idea</a> to <a href="#prime-factorization">integer factorization</a>.
Confusingly, this algorithm is also called
<a href="https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm">Pollard’s rho algorithm</a>.
Given a composite number \(n\) and a <a href="#divisor">divisor</a> \(d\) of \(n\),
the sequence of integers \(s_i\) defined by a somewhat random function \(f(x)\), such as \(f(x) =_d x^2 + 1\),
where \(s_{i+1} = f(s_i)\), repeats <a href="#birthday-paradox">on average after around \(\sqrt{d}\) iterations</a>
because there are only \(d\) integers between \(0\) and \(d - 1\).
Now the problem is that we don’t know \(d\), otherwise we’ve already found a factorization of \(n\).
If \(a\) denotes the tortoise and \(b\) denotes the hare of our
<a href="https://en.wikipedia.org/wiki/Cycle_detection#Floyd.27s_Tortoise_and_Hare">cycle-finding algorithm</a>,
<!-- --> \(a =_d b\) <a href="#if-and-only-if">if and only if</a> \(\lvert a - b \rvert\) is a multiple of \(d\).
If \(\lvert a - b \rvert\) is a multiple of \(d\),
then \(\operatorname{\href{#greatest-common-divisor}{gcd}}(n, \lvert a - b \rvert) = c \cdot d\)
for some integer \(c ≥ 1\).
Therefore, we can compute \(f(x)\) <a href="#modulo-operation">modulo</a> \(n\) instead of \(d\) and still detect
the same repetition by computing \(\operatorname{gcd}(n, \lvert a - b \rvert)\) after every iteration.
This results in the following algorithm:</p>

  <p>\[\text{let } o := 1 \\
\text{function } f(x, n)\ \{ \\
\quad \text{return } (x^2 + o)\ \href{#modulo-operation}{\%}\ n \\
\} \\[14pt]
\text{function } factorize(n)\ \{ \\
\quad \text{let } a := 2 \\
\quad \text{let } b := 2 \\
\quad \text{let } d := 1 \\
\quad \text{while }(d = 1)\ \{ \\
\quad \quad a := f(a, n) \\
\quad \quad b := f(f(b, n), n) \\
\quad \quad d := \operatorname{gcd}(n, \lvert a - b \rvert) \\
\quad \} \\
\quad \text{if }(d = n)\ \{ \\
\quad \quad \text{return \textquotedblleft failure\textquotedblright} \\
\quad \} \text{ else } \{ \\
\quad \quad \text{return } d \\
\quad \} \\
\} \\\]
</p>

  <p>Usually, this algorithm finds the smallest prime factors of \(n\) first,
but the returned \(d\) can be any divisor of \(n\) and doesn’t have to be prime.
If you want to find the <a href="#prime-factorization">prime factorization</a> of \(n\),
you <a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)">recursively</a>
factorize \(d\) and \(\frac{n}{d}\) until all factors are prime,
which you can test efficiently with a <a href="#probabilistic-primality-tests">probabilistic primality test</a>,
such as the <a href="#miller-rabin-primality-test">Miller-Rabin primality test</a>.
If \(a =_n b\), \(\operatorname{gcd}(n, \lvert a - b \rvert) = n\), and the algorithm fails.
In this case, you can increment the offset \(o\) in the function \(f(x)\) and try again.
If the input \(n = 4\), neither incrementing \(o\) nor starting from a different value makes the algorithm succeed.
For this reason, it’s common to halve the input \(n\) until it is odd
and then to run Pollard’s rho factorization algorithm from there.
The algorithm can be optimized in two ways:</p>
  <ul>
    <li>Use <a href="https://en.wikipedia.org/wiki/Cycle_detection#Brent.27s_algorithm">Brent’s cycle-finding algorithm</a>,
named after <a href="https://en.wikipedia.org/wiki/Richard_P._Brent">Richard Peirce Brent</a> (born in 1946):
Instead of moving both the tortoise and the hare along the sequence in each iteration,
you move only the hare one step ahead, replacing three evaluations of \(f(x)\) with one.
After every power of \(2\) steps, you set the tortoise to the current value of the hare.
The tortoise then acts as a waypoint so that it can stop the hare when it passes by.</li>
    <li><a href="https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm#Variants">Combine several differences</a>
before running the <a href="#euclidean-algorithm">Euclidean algorithm</a>:
Instead of computing the <a href="#greatest-common-divisor">greatest common divisor</a> in every iteration,
you compute the product of the differences \(\lvert a - b \rvert\) modulo \(n\) over several iterations
and run the Euclidean algorithm only once in a while.
This works because if \(\operatorname{gcd}(n, x) &gt; 1\),
then \(\operatorname{gcd}(n, x \cdot y) &gt; 1\) for any \(x\) and \(y\).</li>
  </ul>

  <p>The following tool implements Pollard’s rho factorization algorithm.
Unlike <a href="#tool-integer-factorization-trial-division">my implementation of trial division above</a>,
it checks whether the remaining factor is prime.
Its <a href="https://en.wikipedia.org/wiki/Time_complexity">running time</a>
is thus <a href="https://en.wikipedia.org/wiki/Big_O_notation">in the order of</a>
the <a href="https://en.wikipedia.org/wiki/Square_root">square root</a> of the second largest prime factor
if the exponent of the largest prime factor is \(1\).
(It’s possible to test for <a href="https://en.wikipedia.org/wiki/Perfect_power">perfect powers</a> efficiently
as explained in the note 3.6 in the <a href="https://cacr.uwaterloo.ca/hac/about/chap3.pdf">Handbook of Applied Cryptography</a>
and <a href="https://en.wikipedia.org/wiki/Perfect_power#Detecting_perfect_powers">on Wikipedia</a>;
I just didn’t implement this because you rarely encounter them.)</p>

  

</details>

<h3 id="pohlig-hellman-algorithm">Pohlig-Hellman algorithm</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm">Pohlig-Hellman algorithm</a>,
which is named after <a href="https://en.wikipedia.org/wiki/Stephen_Pohlig">Stephen Pohlig</a> (1953 − 2017)
and <a href="https://en.wikipedia.org/wiki/Martin_Hellman">Martin Edward Hellman</a> (born in 1945),
is a technique for reducing the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a>
in large <a href="#finite-groups">groups</a> of non-prime <a href="#group-order">order</a>
to several discrete-logarithm problems in smaller groups, which are easier to solve
since the <a href="https://en.wikipedia.org/wiki/Time_complexity">running time</a>
of the above <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a> depend on the size of the group.
Given a <a href="#group-generators">generator</a> \(G\), its <a href="#element-order">order</a> \(n\),
and an output \(K\) of the <a href="#linear-one-way-functions">linear one-way function</a>,
the Pohlig-Hellman algorithm finds the input \(k\) as follows:</p>

<div data-titles="Additive | Multiplicative | Both" data-default="Multiplicative">

  <ol>
    <li>Find the <a href="#prime-factorization">prime factorization</a> of \(n\) so that \(n = p_1^{e_1} \cdot … \cdot p_l^{e_l}\)
for distinct primes \(p_i\) and integers \(e_i ≥ 1\).
Since the Pohlig-Hellman decomposition succeeds only if all the prime factors are sufficiently small,
<a href="#pollards-rho-factorization-algorithm">Pollard’s rho factorization algorithm</a> is a good choice for this step.
If the factorization fails because some factors are too large, the steps below wouldn’t work either.</li>
    <li>For \(i\) from \(1\) to \(l\), do the following:
      <ol>
        <li>Compute \(G_i := (n/p_i^{e_i})G\).
Since the order of \(G\) is \(n\), the order of \(G_i\) is \(p_i^{e_i}\).</li>
        <li>Compute \(K_i := (n/p_i^{e_i})K\).
Since \(kG = K\) for some integer \(k\), \((n/p_i^{e_i})(kG) = (n/p_i^{e_i})K\), and thus \(kG_i = K_i\).
Our goal is now to determine a \(k_i\) so that \(k_iG_i = K_i\).
Since the order of \(G_i\) is \(p_i^{e_i}\), \(k_i \in \{0, …, p_i^{e_i} - 1\}\) and \(k =_{p_i^{e_i}} k_i\).
(\(k\) is a solution to \(kG_i = K_i\), but \(k_i\) is not necessarily a solution to \(k_iG = K\).)
          <div>
<p><strong>Idea</strong>: We can write \(k_i\) in <a href="https://en.wikipedia.org/wiki/Radix">base</a> \(p_i\) as
</p><!-- --><p> \(k_i = d_0 + d_1p_i + d_2p_i^2 + … + d_{e_i-1}p_i^{e_i-1} = \sum_{j=0}^{e_i-1} d_jp_i^j\),
where each digit \(d_j \in \{0, …, p_i - 1\}\).
Now, \(k_iG_i = (d_0 + d_1p_i + … + d_{e_i-1}p_i^{e_i-1})G_i = d_0G_i + d_1p_iG_i + … + d_{e_i-1}p_i^{e_i-1}G_i = K_i\).
When we multiply both sides by \(p_i^{e_i-1}\),
we get \(p_i^{e_i-1}(d_0G_i) = d_0(\htmlClass{color-purple}{p_i^{e_i-1}G_i}) = p_i^{e_i-1}K_i\)
because for all other factors, \(p_i^{e_i-1}(d_jp_i^{1+?}G_i) = d_j(p_i^{e_i+?}G_i) = d_jO = O\).
Once we have determined \(d_0\) in the group of order \(p_i\) with one of the above
<a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a>, we can take \(d_0G_i\) to the other side of the equation:
</p><!-- --><p> \(d_1p_iG_i + … + d_{e_i-1}p_i^{e_i-1}G_i = K_i - \htmlClass{color-pink}{d_0}G_i\).
When we multiply both sides by \(p_i^{e_i-2}\),
we get \(p_i^{e_i-2}(d_1p_iG_i) = d_1(\htmlClass{color-purple}{p_i^{e_i-1}G_i}) = p_i^{e_i-2}(K_i - d_0G_i)\)
because all the other factors vanish again.
After determining \(d_1\), we move \(d_1p_iG_i\) also to the other side of the equation,
which gives us \(K_i - d_0G_i - d_1p_iG_i = K_i - (\htmlClass{color-pink}{d_0 + d_1p_i})G_i\).
Continuing like this, we can determine all the digits \(d_j\)
without ever having to solve the discrete-logarithm problem in a group larger than \(p_i\).
</p></div>
        </li>
        <li>Compute \(H_i := \htmlClass{color-purple}{p_i^{e_i-1}G_i}\).
Since the order of \(G_i\) is \(p_i^{e_i}\), the order of \(H_i\) is \(p_i\).
As indicated with the color, each digit \(d_j\) is determined in the group generated by \(H_i\).</li>
        <li>For \(j\) from \(0\) to \(e_i - 1\), do the following:
          <ol>
            <li>If \(j = 0\), set \(s_j := 0\).
Otherwise, set \(s_j := \htmlClass{color-pink}{s_{j-1} + d_{j-1} \cdot p_i^{j-1}}\).
As indicated with the color, \(s_j\) is the sum of all the digits that we have found so far,
where each digit is multiplied by the value of its <a href="https://en.wikipedia.org/wiki/Positional_notation">position</a>.</li>
            <li>Compute \(D_j := p_i^{e_i-1-j}(K_i - s_jG_i)\).</li>
            <li>Find \(d_j\) so that \(d_jH_i = D_j\) with one of the above <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a>.</li>
          </ol>
        </li>
        <li>Compute \(k_i := d_0 + d_1p_i + d_2p_i^2 + … + d_{e_i-1}p_i^{e_i-1} = \sum_{j=0}^{e_i-1} d_jp_i^j\).
(Alternatively, set \(k_i := s_{e_i-1} + d_{e_i-1}p_i^{e_i-1}\).)</li>
      </ol>
    </li>
    <li>Use the <a href="#chinese-remainder-theorem">Chinese remainder theorem</a> to solve
the system of <a href="#congruence-relation">congruences</a> \(k =_{p_i^{e_i}} k_i\).</li>
    <li>Return \(k\) as the solution to \(kG = K\).</li>
  </ol>

  <!-- -->

  <ol>
    <li>Find the <a href="#prime-factorization">prime factorization</a> of \(n\) so that \(n = p_1^{e_1} \cdot … \cdot p_l^{e_l}\)
for distinct primes \(p_i\) and integers \(e_i ≥ 1\).
Since the Pohlig-Hellman decomposition succeeds only if all the prime factors are sufficiently small,
<a href="#pollards-rho-factorization-algorithm">Pollard’s rho factorization algorithm</a> is a good choice for this step.
If the factorization fails because some factors are too large, the steps below wouldn’t work either.</li>
    <li>For \(i\) from \(1\) to \(l\), do the following:
      <ol>
        <li>Compute \(G_i := G^{n/p_i^{e_i}}\).
Since the order of \(G\) is \(n\), the order of \(G_i\) is \(p_i^{e_i}\).</li>
        <li>Compute \(K_i := K^{n/p_i^{e_i}}\).
Since \(G^k = K\) for some integer \(k\), \((G^k)^{n/p_i^{e_i}} = K^{n/p_i^{e_i}}\), and thus \(G_i^k = K_i\).
Our goal is now to determine a \(k_i\) so that \(G_i^{k_i} = K_i\).
Since the order of \(G_i\) is \(p_i^{e_i}\), \(k_i \in \{0, …, p_i^{e_i} - 1\}\) and \(k =_{p_i^{e_i}} k_i\).
(\(k\) is a solution to \(G_i^k = K_i\), but \(k_i\) is not necessarily a solution to \(G^{k_i} = K\).)
          <div>
<p><strong>Idea</strong>: We can write \(k_i\) in <a href="https://en.wikipedia.org/wiki/Radix">base</a> \(p_i\) as
</p><!-- --><p> \(k_i = d_0 + d_1p_i + d_2p_i^2 + … + d_{e_i-1}p_i^{e_i-1} = \sum_{j=0}^{e_i-1} d_jp_i^j\),
where each digit \(d_j \in \{0, …, p_i - 1\}\).
Now, \(G_i^{k_i} = G_i^{d_0 + d_1p_i + … + d_{e_i-1}p_i^{e_i-1}} = G_i^{d_0} \cdot G_i^{d_1p_i} \cdot … \cdot G_i^{d_{e_i-1}p_i^{e_i-1}} = K_i\).
When we raise both sides to the power of \(p_i^{e_i-1}\),
we get \((G_i^{d_0})^{p_i^{e_i-1}} = (\htmlClass{color-purple}{G_i^{p_i^{e_i-1}}})^{d_0} = K_i^{p_i^{e_i-1}}\)
because for all other factors, \((G_i^{d_jp_i^{1+?}})^{p_i^{e_i-1}} = (G_i^{p_i^{e_i+?}})^{d_j} = I^{d_j} = I\).
Once we have determined \(d_0\) in the group of order \(p_i\) with one of the above
<a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a>, we can take \(G_i^{d_0}\) to the other side of the equation:
</p><!-- --><p> \(G_i^{d_1p_i} \cdot … \cdot G_i^{d_{e_i-1}p_i^{e_i-1}} = K_i / G_i^{\htmlClass{color-pink}{d_0}}\).
When we raise both sides to the power of \(p_i^{e_i-2}\),
we get \((G_i^{d_1p_i})^{p_i^{e_i-2}} = (\htmlClass{color-purple}{G_i^{p_i^{e_i-1}}})^{d_1} = (K_i / G_i^{d_0})^{p_i^{e_i-2}}\)
because all the other factors vanish again.
After determining \(d_1\), we move \(G_i^{d_1p_i}\) also to the other side of the equation,
which gives us \(K_i / G_i^{d_0} / G_i^{d_1p_i} = K_i / G_i^{\htmlClass{color-pink}{d_0 + d_1p_i}}\).
Continuing like this, we can determine all the digits \(d_j\)
without ever having to solve the discrete-logarithm problem in a group larger than \(p_i\).
</p></div>
        </li>
        <li>Compute \(H_i := \htmlClass{color-purple}{G_i^{p_i^{e_i-1}}}\).
Since the order of \(G_i\) is \(p_i^{e_i}\), the order of \(H_i\) is \(p_i\).
As indicated with the color, each digit \(d_j\) is determined in the group generated by \(H_i\).</li>
        <li>For \(j\) from \(0\) to \(e_i - 1\), do the following:
          <ol>
            <li>If \(j = 0\), set \(s_j := 0\).
Otherwise, set \(s_j := \htmlClass{color-pink}{s_{j-1} + d_{j-1} \cdot p_i^{j-1}}\).
As indicated with the color, \(s_j\) is the sum of all the digits that we have found so far,
where each digit is multiplied by the value of its <a href="https://en.wikipedia.org/wiki/Positional_notation">position</a>.</li>
            <li>Compute \(D_j := (K_i / G_i^{s_j})^{p_i^{e_i-1-j}}\).</li>
            <li>Find \(d_j\) so that \(H_i^{d_j} = D_j\) with one of the above <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a>.</li>
          </ol>
        </li>
        <li>Compute \(k_i := d_0 + d_1p_i + d_2p_i^2 + … + d_{e_i-1}p_i^{e_i-1} = \sum_{j=0}^{e_i-1} d_jp_i^j\).
(Alternatively, set \(k_i := s_{e_i-1} + d_{e_i-1}p_i^{e_i-1}\).)</li>
      </ol>
    </li>
    <li>Use the <a href="#chinese-remainder-theorem">Chinese remainder theorem</a> to solve
the system of <a href="#congruence-relation">congruences</a> \(k =_{p_i^{e_i}} k_i\).</li>
    <li>Return \(k\) as the solution to \(G^k = K\).</li>
  </ol>

</div>

<p>The above algorithm shows that the difficulty of computing discrete logarithms is determined
by the size of the largest prime factor \(p_l\) of the group’s order \(n\), ignoring even its exponent \(e_l\).
This means that if the <a href="#multiplicative-groups">multiplicative group</a> or the <a href="#elliptic-curves">elliptic curve</a>
isn’t chosen carefully, it can be relatively easy to invert the linear one-way function.
For example, the tool below computes discrete logarithms modulo the 107-digit/354-bit prime
22’<wbr/>708’<wbr/>823’<wbr/>198’<wbr/>678’<wbr/>103’<wbr/>974’<wbr/>314’<wbr/>518’<wbr/>195’<wbr/>029’<wbr/>102’<wbr/>158’<wbr/>525’<wbr/>052’<wbr/>496’<wbr/>759’<wbr/>285’<wbr/>596’<wbr/>453’<wbr/>269’<wbr/>189’<wbr/>798’<wbr/>311’<wbr/>427’<wbr/>475’<wbr/>159’<wbr/>776’<wbr/>411’<wbr/>276’<wbr/>642’<wbr/>277’<wbr/>139’<wbr/>650’<wbr/>833’<wbr/>937
<a href="#tool-discrete-logarithm-multiplicative-group-pohlig-hellman-algorithm&amp;m=22%27708%27823%27198%27678%27103%27974%27314%27518%27195%27029%27102%27158%27525%27052%27496%27759%27285%27596%27453%27269%27189%27798%27311%27427%27475%27159%27776%27411%27276%27642%27277%27139%27650%27833%27937&amp;G=14%27136%27903%27746%27155%27542%27756%27936%27318%27521%27399%27536%27141%27677%27114%27490%27014%27478%27332%27748%27609%27939%27845%27161%27528%27382%27171%27444%27487%27618%27906%27406%27429%27937%27620%27299&amp;n=22%27708%27823%27198%27678%27103%27974%27314%27518%27195%27029%27102%27158%27525%27052%27496%27759%27285%27596%27453%27269%27189%27798%27311%27427%27475%27159%27776%27411%27276%27642%27277%27139%27650%27833%27936&amp;K=13%27975%27782%27396%27137%27250%27709%27191%27883%27099%27679%27318%27661%27105%27537%27856%27900%27563%27390%27003%27561%27208%27048%27584%27578%27667%27386%27417%27480%27181%27203%27426%27948%27149%27158%27235">in a matter of seconds</a>
because the largest prime factor of this prime minus one is just 350’<wbr/>377.
(I took this example from the note 3.66 in the
<a href="https://cacr.uwaterloo.ca/hac/about/chap3.pdf">Handbook of Applied Cryptography</a>.)
On the other hand, if you choose a <a href="#sophie-germain-and-safe-primes">safe prime</a> as the modulus of a multiplicative group,
the Pohlig-Hellman algorithm reduces the difficulty of the group’s discrete-logarithm problem only by a single bit.
In the case of elliptic curves, it makes sense to choose the <a href="#curve-parameters">parameters</a>
such that the group contains a prime number of points to begin with.</p>

<p>The following tool implements the Pohlig-Hellman algorithm.
Since <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a> has a decent chance of total failure in small groups,
the tool uses <a href="#exhaustive-search">exhaustive search</a> to find the discrete logarithm in groups smaller than 100
and Pollard’s rho algorithm with a randomly chosen starting element in the case of failure otherwise.
Unlike the other <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a>, you cannot configure a delay
because the only aspects worth animating are the sub-algorithms that we’ve already covered.
This tool simply links to the corresponding tool with the current values
so that you can inspect the steps of the sub-algorithm there.</p>



<details>
  <summary id="potential-for-backdoors-in-multiplicative-groups">
Potential for backdoors in multiplicative groups
</summary>

  <p>Before you rely on a <a href="#multiplicative-groups">multiplicative group</a> which was provided by someone else
to be a <a href="#linear-one-way-functions">linear one-way function</a>,
you have to verify that the <a href="#group-order">group’s order</a> has a <a href="#bits-of-security">sufficiently large</a> prime factor.
If the group’s order or its <a href="#prime-factorization">prime factorization</a> is not known to you
(because they aren’t provided to you or you can’t determine them), you shouldn’t use the group.
Otherwise, an attacker can choose the modulus \(m\) as the product of two large primes \(p\) and \(q\),
where both \(p - 1\) and \(q - 1\) have only relatively small prime factors.
Since it’s difficult to factorize such a modulus \(m\),
only the attacker can determine the group’s order \(\href{#eulers-totient-function}{\varphi}(m) = (p - 1) \cdot (q - 1)\)
and use the <a href="#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a> to compute discrete logarithms in this group.
In order to avoid <a href="https://crypto.stackexchange.com/a/39268/76600">such a backdoor</a>,
you have to insist that the other party shares the group’s order and its prime factorization with you.</p>

</details>

<h3 id="index-calculus-algorithm">Index-calculus algorithm</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Index_calculus_algorithm">index-calculus algorithm</a>
computes discrete logarithms in <a href="#multiplicative-groups">multiplicative groups</a>
much faster than <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a>.
It exploits the circumstance that sufficiently many integers are sufficiently <a href="#smooth-numbers">smooth</a>,
i.e. their <a href="#prime-factorization">prime factorization</a> contains no factors larger than some integer \(S\).
Let \(P_1\), …, \(P_l\) denote all the prime numbers smaller than \(S\).
An \(S\)-smooth number \(A\) can then be written as \(A = P_1^{e_1} \cdot … \cdot P_l^{e_l}\),
where \(e_i = 0\) if \(P_i\) is not a prime factor of \(A\) for each \(i \in \{1, …, l\}\).
If we assume for now that the modulus \(m\) is prime and greater than \(S\),
and that \(G\) generates the whole group <a href="#multiplicative-group-notations">\(\mathbb{Z}_m^\times\)</a>,
there exists an integer \(p_i\) for each \(P_i\) so that \(G^{p_i} =_m P_i\).
To determine these integers, we repeatedly choose a random integer \(r \in \{1, … n\}\),
where \(n = \href{#element-order}{\lvert G \rvert}\), until \(G^r =_m R\) is \(S\)-smooth:</p>

\[G^r =_m R
= P_1^{e_1} \cdot … \cdot P_l^{e_l}
=_m (G^{p_1})^{e_1} \cdot … \cdot (G^{p_1})^{e_l}
= G^{e_1 \cdot p_1 + … + e_l \cdot p_l}\]

<p>After taking the <a href="https://en.wikipedia.org/wiki/Logarithm">logarithm</a>
to <a href="https://en.wikipedia.org/wiki/Base_(exponentiation)">base</a> \(G\) on both ends,
we get \(r =_n e_1 \cdot p_1 + … + e_l \cdot p_l\) in the <a href="#repetition-ring">repetition ring</a> of \(G\).
If we find enough such equations,
we can solve the following <a href="https://en.wikipedia.org/wiki/System_of_linear_equations">system of linear equations</a>
using <a href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a>,
named after <a href="https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss">Carl Friedrich Gauss</a> (1777 − 1855).
(I’ll explain <a href="https://en.wikipedia.org/wiki/Matrix_multiplication">matrix multiplication</a>
and Gaussian elimination in the article about coding theory.)</p>

<p>\[\begin{aligned}
e_{1,1} \cdot p_1 + … + e_{1,l} \cdot p_l &amp;=_n r_1 \\
\vdots \quad &amp;=_n \, \vdots \\
e_{l,1} \cdot p_1 + … + e_{l,l} \cdot p_l &amp;=_n r_l
\end{aligned}
\quad \iff \quad
\begin{bmatrix}
e_{1,1} &amp; \cdots &amp; e_{1,l} \\
\vdots &amp; &amp; \vdots \\
e_{l,1} &amp; \cdots &amp; e_{l,l} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
p_1 \\
\vdots \\
p_l \\
\end{bmatrix}
=_n
\begin{bmatrix}
r_1 \\
\vdots \\
r_l \\
\end{bmatrix}\]
</p>

<p>Since not all rows are <a href="https://en.wikipedia.org/wiki/Linear_independence">linearly independent</a> from one another
and not all elements are invertible in the <a href="#commutative-rings">ring</a> of <a href="#integers-modulo-m">integers modulo \(n\)</a>,
we usually need more than just \(l\) equations to solve for the integers \(p_1\) to \(p_l\).
Once we have found these values,
we increment a counter \(c\) starting from \(0\) until \(K \cdot G^c =_m T\) is \(S\)-smooth.
(We <a href="#dl-algorithms">want to find</a> an integer \(k\) so that \(G^k =_m K\).)
Given \(K \cdot G^c =_m T = P_1^{e_1} \cdot … \cdot P_l^{e_l} =_m (G^{p_1})^{e_1} \cdot … \cdot (G^{p_1})^{e_l}
= G^{e_1 \cdot p_1 + … + e_l \cdot p_l}\) for some new exponents \(e_1\) to \(e_l\),
we can determine \(k\) as follows:</p>

<p>\[\begin{aligned}
k + c &amp;=_n e_1 \cdot p_1 + … + e_l \cdot p_l \\
k &amp;=_n e_1 \cdot p_1 + … + e_l \cdot p_l - c
\end{aligned}\]
</p>

<p>If you want to compute several discrete logarithms in the same group,
you have to determine the integers \(p_1\) to \(p_l\) only once,
which makes the index-calculus algorithm even faster.
(The discrete logarithm of \(P_i\) with respect to \(G\) is also called the <em>index</em> of \(P_i\) with respect to \(G\),
hence the name <em>index <a href="https://en.wikipedia.org/wiki/Calculus_(disambiguation)">calculus</a></em>.)
The algorithm doesn’t work for <a href="#elliptic-curves">elliptic curves</a>
because points cannot be <a href="#prime-factorization">factorized</a>.</p>

<p>The following tool implements the index-calculus algorithm.
In order to make its output <a href="https://en.wikipedia.org/wiki/Reproducibility">reproducible</a>,
the tool increments \(r\) starting from \(1\) in its search for smooth group elements instead of choosing \(r\) randomly.
It continues the search until the matrix of exponents becomes
<a href="https://en.wikipedia.org/wiki/Invertible_matrix">invertible</a> modulo \(n\).
As long as you <a href="#tool-discrete-logarithm-multiplicative-group-index-calculus-algorithm&amp;d=0">disable the delay</a>,
it handles 50-bit moduli just fine.
For example, it takes only around 7’800’000 steps
to compute discrete logarithms modulo the <a href="#sophie-germain-and-safe-primes">safe prime</a>
<a href="#tool-discrete-logarithm-multiplicative-group-index-calculus-algorithm&amp;m=627%27789%27652%27071%27083&amp;G=482%27296%27703%27860%27973&amp;n=627%27789%27652%27071%27082&amp;k=274%27527%27666%27048%27997&amp;K=571%27301%27098%27261%27669&amp;d=0">627’789’652’071’083</a>.
In order to share its inputs with the <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithms</a> above,
the tool doesn’t allow you to configure the number of prime bases yourself.
It chooses \(l = \operatorname{min}(\log_\mathrm{e}(n), 50)\).</p>



<details>
  <summary id="index-calculus-in-subgroups">
Index calculus in subgroups
</summary>

  <p>What if \(G\) <a href="#group-generators">generates</a> only a proper <a href="#subgroups">subgroup</a>
of <a href="#multiplicative-group-notations">\(\mathbb{Z}_m^\times\)</a>?
Since the <a href="https://en.wikipedia.org/wiki/Time_complexity">running time</a>
of the <a href="#index-calculus-algorithm">index-calculus algorithm</a> depends on the modulus \(m\)
rather than \(G\)’s <a href="#element-order">order</a> \(n\),
<a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a> is faster than the index-calculus algorithm when \(n\) is small enough.
If \(n\) has many small factors, the <a href="#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a> is even faster, of course.
(Since the index-calculus algorithm is not the best choice for relatively small subgroups,
it usually doesn’t make sense to use it as the <a href="#dl-algorithms"><abbr title="Discrete Logarithm">DL</abbr> algorithm</a> in the Pohlig-Hellman algorithm.)
If \(n\) is neither small nor smooth,
you can solve the <a href="#discrete-logarithm-problem">discrete-logarithm problem</a> \(G^k =_m K\) as follows
according to section 3.6.6 of the <a href="https://cacr.uwaterloo.ca/hac/about/chap3.pdf">Handbook of Applied Cryptography</a>:</p>
  <ol>
    <li>Find an element \(H \in \mathbb{Z}_m^\times\),
which <a href="#a-faster-algorithm-for-finding-a-generator">generates the whole group</a>.</li>
    <li>Use the index-calculus algorithm to find an integer \(g\) so that \(H^g =_m G\).</li>
    <li>Use the index-calculus algorithm to find an integer \(h\) so that \(H^h =_m K\).</li>
    <li>Determine the <a href="#index-and-cofactor">cofactor</a> \(c := (m - 1) / n\).
(We still assume that \(m\) is prime, and thus \(\lvert \mathbb{Z}_m^\times \rvert = m - 1\).)</li>
    <li>Return \(k :=_n (h / c) \cdot (g / c)^{-1}\).</li>
  </ol>

  <p>This works because \((H^g)^k =_m H^h\) implies that \(g \cdot k =_{m-1} h\).
Since \(n\) divides \(m - 1\), \(g \cdot k - h\) is also a multiple of \(n\), and thus \(g \cdot k =_n h\).
Since \(k\) is unique up to a multiple of \(n\), \(g\) has to be invertible modulo \(n\).
Therefore, \(k =_n h \cdot g^{-1}\).
Furthermore, \(c\) divides \(g\) because \(c\) is the smallest exponent so that \(H^c\) generates
the <a href="#all-subgroups-of-cyclic-groups-are-cyclic">unique subgroup</a> of <a href="#group-order">order</a> \(n\).
All the \(n\) elements in this subgroup, including \(H^g\), can be expressed
as \(H^{c \cdot d}\) for some \(d \in \{0, …, n - 1\}\).
Assuming that \(K\) is in the subgroup generated by \(G\) (abort <a href="#output-not-in-generated-subgroup">otherwise</a>),
<!-- --> \(c\) also divides \(h\) for the same reason.
Thus, \(k =_n h \cdot g^{-1} =_n h \cdot c^{-1} \cdot (c^{-1})^{-1} \cdot g^{-1} =_n (h / c) \cdot (g / c)^{-1}\).</p>

  <p>Interestingly, the above tool succeeds even if one of the bases \(P_i\) is not in the subgroup generated by \(G\).
For example, it solves discrete logarithms in the subgroup of order 32 modulo 96
<a href="#tool-discrete-logarithm-multiplicative-group-index-calculus-algorithm&amp;m=97&amp;G=20&amp;n=32&amp;K=27">just fine</a>.
I have no idea why the index-calculus algorithm still works in this case,
and I haven’t found any information about this phenomenon.
If you know the answer, please <a href="mailto:contact@ef1p.com">let me know</a>.</p>

</details>

<details>
  <summary id="index-calculus-with-composite-moduli">
Index calculus with composite moduli
</summary>

  <p>If the modulus \(m\) is composite,
the <a href="#tool-discrete-logarithm-multiplicative-group-index-calculus-algorithm">above tool</a>
fails to invert the matrix of exponents.
I understand that the prime factors of \(G\)’s <a href="#element-order">order</a> \(n\) determine
which exponents have a <a href="#multiplicative-inverse-revisited">multiplicative inverse</a> modulo \(n\),
which is why the above tool displays the <a href="#prime-factorization">prime factorization</a> of \(n\).
However, \(n\) can have many small factors no matter whether \(m\) is composite or prime.
If you find a composite modulus for which the tool succeeds,
or if you know why this isn’t possible, please <a href="mailto:contact@ef1p.com">let me know</a>.</p>

</details>

<h3 id="bits-of-security">Bits of security</h3>

<p>As we learned in this chapter, it takes only around <a href="#birthday-paradox">\(\sqrt{n}\) steps</a>
to compute discrete logarithms in <a href="#finite-groups">groups</a> of prime <a href="#group-order">order</a> \(n\)
due to <a href="#pollards-rho-algorithm">Pollard’s rho algorithm</a>.
If the order \(n\) is composite, the <a href="#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a>
reduces the difficulty of computing discrete logarithms to the square root of the largest prime factor of \(n\).
In the case of <a href="#multiplicative-groups">multiplicative groups</a>,
it takes even fewer steps due to the <a href="#index-calculus-algorithm">index-calculus algorithm</a>.
The <a href="https://en.wikipedia.org/wiki/Bit-length">bit-length</a> of the expected number of steps required
to break a <a href="https://en.wikipedia.org/wiki/Cryptographic_primitive">cryptographic primitive</a>
defines its <a href="https://en.wikipedia.org/wiki/Security_level">security level</a>.
When we say that a primitive has \(s\) bits of security, it takes on average around \(2^s\) steps to break it.
Given the current state of computers, cryptographic primitives become
<a href="https://en.wikipedia.org/wiki/Computational_complexity_theory#Intractability">computationally intractable</a>
at <a href="https://en.wikipedia.org/wiki/Discrete_logarithm_records">around 128 bits of security</a>.
In order to ensure that our <a href="#linear-one-way-functions">linear one-way functions</a>
are indeed <a href="https://en.wikipedia.org/wiki/One-way_function">one-way functions</a>,
we have to choose sufficiently large parameters as follows:</p>

<figure>

  <table>
  <thead>
    <tr>
      <th>Bits of security</th>
      <th><a href="#elliptic-curves">Elliptic curves</a>:</th>
      <th><a href="#multiplicative-groups">Multiplicative groups</a>:</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>80</td>
      <td>160</td>
      <td>1&#39;024</td>
    </tr>
    <tr>
      <td>112</td>
      <td>224</td>
      <td>2&#39;048</td>
    </tr>
    <tr>
      <td>128</td>
      <td>256</td>
      <td>3&#39;072</td>
    </tr>
    <tr>
      <td>192</td>
      <td>384</td>
      <td>7&#39;680</td>
    </tr>
    <tr>
      <td>256</td>
      <td>512</td>
      <td>15&#39;360</td>
    </tr>
  </tbody>
</table>

  <figcaption>
Comparable security lengths as listed in section 5.6.1.1 starting on page 53
in <a href="https://doi.org/10.6028/NIST.SP.800-57pt1r5">this recommendation</a>
by the <a href="https://en.wikipedia.org/wiki/National_Institute_of_Standards_and_Technology">National Institute of Standards and Technology (<abbr title="National Institute of Standards and Technology">NIST</abbr>)</a>.
The security level with the red background can no longer be considered secure.
</figcaption>
</figure>

<p>As explained <a href="#index-calculus-in-subgroups">earlier</a>,
just the modulus of multiplicative groups have to be this large.
The subgroup generated by \(G\) can be as “small” as an elliptic curve group of the same security level.
As we will see in the next article about <a href="https://en.wikipedia.org/wiki/Cryptosystem">cryptosystems</a>,
the input \(k\) to the linear one-way function is usually a <a href="https://riskmusings.substack.com/internet/#digital-signatures">private key</a>,
while the output \(K\) is the corresponding <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public key</a>.
The advantages of elliptic curves over multiplicative groups are that their public keys are smaller
and that their group operations are faster since the numbers are smaller.</p>

<h2 id="group-properties" data-toc-text="Group properties">Group properties (appendix)</h2>

<h3 id="reduced-group-axioms">Reduced group axioms</h3>

<p>Using <a href="#universal-and-existential-quantifiers">universal and existential quantifiers</a>
to make statements about the elements of a set, the <a href="#group-axioms">group axioms</a> can be reduced to:</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

  <ul>
    <li><strong>Closure (G1)</strong>: \(\forall\ A, B \in \mathbb{G}\ A \circ B \in \mathbb{G}\)</li>
    <li><strong>Associativity (G2)</strong>: \(\forall\ A, B, C \in \mathbb{G}\ (A \circ B) \circ C = A \circ (B \circ C)\)</li>
    <li><strong>Identity (G3)</strong>: \(\exists\ E \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ A \circ E = A\)</li>
    <li><strong>Invertibility (G4)</strong>: \(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ A \circ B = E\)</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Closure (G1)</strong>: \(\forall\ A, B \in \mathbb{G}\ A + B \in \mathbb{G}\)</li>
    <li><strong>Associativity (G2)</strong>: \(\forall\ A, B, C \in \mathbb{G}\ (A + B) + C = A + (B + C)\)</li>
    <li><strong>Identity (G3)</strong>: \(\exists\ O \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ A + O = A\)</li>
    <li><strong>Invertibility (G4)</strong>: \(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ A + B = O\)</li>
  </ul>

  <!-- -->

  <ul>
    <li><strong>Closure (G1)</strong>: \(\forall\ A, B \in \mathbb{G}\ A \cdot B \in \mathbb{G}\)</li>
    <li><strong>Associativity (G2)</strong>: \(\forall\ A, B, C \in \mathbb{G}\ (A \cdot B) \cdot C = A \cdot (B \cdot C)\)</li>
    <li><strong>Identity (G3)</strong>: \(\exists\ I \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ A \cdot I = A\)</li>
    <li><strong>Invertibility (G4)</strong>: \(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ A \cdot B = I\)</li>
  </ul>

</div>

<p><a href="#commutative-groups">Commutative groups</a> have an additional axiom:</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

  <p><strong>Commutativity (G5)</strong>: \(\forall\ A, B \in \mathbb{G}\ A \circ B = B \circ A\)</p>

  <p><strong>Commutativity (G5)</strong>: \(\forall\ A, B \in \mathbb{G}\ A + B = B + A\)</p>

  <p><strong>Commutativity (G5)</strong>: \(\forall\ A, B \in \mathbb{G}\ A \cdot B = B \cdot A\)</p>

</div>

<details>
  <summary id="less-ambiguous-notation">
Less ambiguous notation
</summary>

  <p>Since the third axiom (G3) does not specify how many identity elements there are,
this notation is still a bit sloppy as it leaves the meaning of the identity element in the last axiom (G4) open.
Must each element have an inverse for some identity element or for all identity elements?
Keeping the <a href="#universal-and-existential-quantifiers">quantifiers</a> at the beginning of the statement
and using the <a href="#logical-conjunction">logical conjunction \(\land\)</a> (“and”),
the group axioms can be written less ambiguously as:</p>

  <p>

$$
\exists\ E \in \mathbb{G}\ \forall\ A, B, C \in \mathbb{G}\ \exists\ D \in \mathbb{G}
\ A \circ B \in \mathbb{G} \land
(A \circ B) \circ C = A \circ (B \circ C) \land
A \circ E = A \land
A \circ D = E
$$

$$
\exists\ E \in \mathbb{G}\ \forall\ A, B, C \in \mathbb{G}\ \exists\ D \in \mathbb{G}
\ A + B \in \mathbb{G} \land
(A + B) + C = A + (B + C) \land
A + O = A \land
A + D = O
$$

$$
\exists\ E \in \mathbb{G}\ \forall\ A, B, C \in \mathbb{G}\ \exists\ D \in \mathbb{G}
A \cdot B \in \mathbb{G} \land
(A \cdot B) \cdot C = A \cdot (B \cdot C) \land
A \cdot I = A \land
A \cdot D = I
$$

</p>

  <p>If, on the other hand, we replace the invertibility axiom with the following,
then we <a href="https://math.stackexchange.com/questions/127646/minimal-axioms-for-a-group">do not define a group</a>:</p>

  <div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

    <p><strong>Fake invertibility</strong>:
\(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ \forall\ C \in \mathbb{G}\ C \circ (A \circ B) = C\)</p>

    <p><strong>Fake invertibility</strong>:
\(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ \forall\ C \in \mathbb{G}\ C + (A + B) = C\)</p>

    <p><strong>Fake invertibility</strong>:
\(\forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}\ \forall\ C \in \mathbb{G}\ C \cdot (A \cdot B) = C\)</p>

  </div>

  <p>For example, the binary operation could then be defined as \(X \circ Y = X\)
so that every element is a right identity and every element is a right inverse for every element,
which is clearly not the same (and therefore not a group).
We will see soon that there can be only <a href="#uniqueness-of-right-identity">one identity element</a>
and that each element has a <a href="#uniqueness-of-inverses">unique inverse</a>,
which is why this aspect is <a href="https://math.stackexchange.com/questions/65239/right-identity-and-right-inverse-implies-a-group#comment154089_65239">often ignored</a>.</p>

</details>

<details>
  <summary id="group-like-algebraic-structures">
Group-like algebraic structures
</summary>

  <p>If you remove one or several axioms from the above definition,
you get <a href="https://en.wikipedia.org/wiki/Group_(mathematics)#Generalizations">other algebraic structures</a>,
most of which have names:</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>Structure</th>
          <th>Closure</th>
          <th>Associativity</th>
          <th>Identity</th>
          <th>Invertibility</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Semigroupoid">Semigroupoid</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Category_(mathematics)">Small category</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Groupoid">Groupoid</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Magma_(algebra)">Magma</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Quasigroup">Quasigroup</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Unital_magma">Unital magma</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Semigroup">Semigroup</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Loop_(algebra)">Loop</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Inverse_semigroup">Inverse semigroup</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Monoid">Monoid</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
        <tr>
          <td><a href="https://en.wikipedia.org/wiki/Group_(mathematics)">Group</a></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
          <td><i></i></td>
        </tr>
      </tbody>
    </table>

    <figcaption>
The axioms of various group-like algebraic structures.
</figcaption>
  </figure>

</details>

<details>
  <summary id="alternative-group-axioms">
Alternative group axioms
</summary>

  <p>Instead of requiring that there is an identity and that each element has an inverse,
we can simply require the <a href="https://planetmath.org/alternativedefinitionofgroup">following axiom</a>:</p>

  <div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

    <p><strong>Solvability</strong>: \(\forall\ A, B \in \mathbb{G}\ \exists\ X, Y \in \mathbb{G}\ X \circ A = A \circ Y = B\)</p>

    <p><strong>Solvability</strong>: \(\forall\ A, B \in \mathbb{G}\ \exists\ X, Y \in \mathbb{G}\ X + A = A + Y = B\)</p>

    <p><strong>Solvability</strong>: \(\forall\ A, B \in \mathbb{G}\ \exists\ X, Y \in \mathbb{G}\ X \cdot A = A \cdot Y = B\)</p>

  </div>

  <p>This means that any element can be reached from any other element both from the left and from the right.
This implies that every element can be reached from itself, i.e. every element has an identity element.
In order to prove that this axiom, together with closure and associativity,
defines the same algebraic structure as <a href="#reduced-group-axioms">above</a>,
we just need show that the identity element is the same for all elements:</p>

  <div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

    <div>
      <p>For arbitrary elements \(A\) and \(B\), there exist</p>
      <ul>
        <li>\(E_A\) and \(E_B\) so that \(E_A \circ A = A\) and \(B \circ E_B = B\),</li>
        <li>and \(X\) and \(Y\) so that \(X \circ B = E_A\) and \(A \circ Y = E_B\).</li>
      </ul>

      <p>Thus, \(E_A = X \circ B = X \circ (B \circ E_B) = (X \circ B) \circ E_B = E_A \circ E_B = E_A \circ (A \circ Y) = (E_A \circ A) \circ Y = A \circ Y = E_B\).</p>
    </div>

    <div>
      <p>For arbitrary elements \(A\) and \(B\), there exist</p>
      <ul>
        <li>\(O_A\) and \(O_B\) so that \(O_A + A = A\) and \(B + O_B = B\),</li>
        <li>and \(X\) and \(Y\) so that \(X + B = O_A\) and \(A + Y = O_B\).</li>
      </ul>

      <p>Thus, \(O_A = X + B = X + (B + O_B) = (X + B) + O_B = O_A + O_B = O_A + (A + Y) = (O_A + A) + Y = A + Y = O_B\).</p>
    </div>

    <div>
      <p>For arbitrary elements \(A\) and \(B\), there exist</p>
      <ul>
        <li>\(I_A\) and \(I_B\) so that \(I_A \cdot A = A\) and \(B \cdot I_B = B\),</li>
        <li>and \(X\) and \(Y\) so that \(X \cdot B = I_A\) and \(A \cdot Y = I_B\).</li>
      </ul>

      <p>Thus, \(I_A = X \cdot B = X \cdot (B \cdot I_B) = (X \cdot B) \cdot I_B = I_A \cdot I_B = I_A \cdot (A \cdot Y) = (I_A \cdot A) \cdot Y = A \cdot Y = I_B\).</p>
    </div>

  </div>

  <p>As every equation with two known values and one unknown value has a solution (see the axiom),
every element has an inverse.</p>

</details>

<h3 id="properties-of-equality">Properties of equality</h3>

<p>Before we can derive properties from the above group axioms, we need to discuss
the <a href="https://en.wikipedia.org/wiki/Equality_(mathematics)#Basic_properties">four basic properties of equality</a>:</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Reflexive_relation"><strong>Reflexivity (E1)</strong></a>:
\(\forall\ A \in \mathbb{G}\ A = A\)</li>
  <li><a href="https://en.wikipedia.org/wiki/Symmetric_relation"><strong>Symmetry (E2)</strong></a>:
\(\forall\ A, B \in \mathbb{G}\ A = B \implies B = A\)</li>
  <li><a href="https://en.wikipedia.org/wiki/Transitive_relation"><strong>Transitivity (E3)</strong></a>:
\(\forall\ A, B, C \in \mathbb{G}\ A = B \land B = C \implies A = C\)</li>
  <li><a href="https://en.wikipedia.org/wiki/Substitution_(algebra)"><strong>Substitution (E4)</strong></a>:
\(\forall\ F: \mathbb{G} \to \mathbb{G}\ \forall\ A, B \in \mathbb{G}\ A = B \implies F(A) = F(B)\)</li>
</ul>

<p>These properties will be used a lot in the proofs below.
Because they are so elementary, I won’t point out when I use them.</p>

<details>
  <summary id="logical-conjunction">
Logical conjunction \(\land\)
</summary>

  <p>The <a href="https://en.wikipedia.org/wiki/Logical_conjunction">logical conjunction \(\land\)</a> (“and”) is true
<a href="#if-and-only-if">if and only if</a> both operands are true (\(\htmlClass{color-green}{\top}\))
instead of false (\(\htmlClass{color-red}{\bot}\)):</p>

  <figure>

    <table>
      <thead>
        <tr>
          <th>\(P\)</th>
          <th>\(Q\)</th>
          <th>\(P \land Q\)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
          <td>\(\htmlClass{color-red}{\bot}\)</td>
        </tr>
        <tr>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
          <td>\(\htmlClass{color-green}{\top}\)</td>
        </tr>
      </tbody>
    </table>

    <figcaption>
The definition of \(\land\).
</figcaption>
  </figure>

  <p>If you struggle to remember which of \(\land\) and \(\lor\) is which,
it may help to know that the logical conjunction \(\land\) corresponds
to the <a href="https://en.wikipedia.org/wiki/Intersection_(set_theory)">intersection \(\cap\)</a>
of the two <a href="https://en.wikipedia.org/wiki/Event_(probability_theory)">“events”</a> \(P\) and \(Q\),
and that the <a href="#logical-disjunction">logical disjunction \(\lor\)</a> corresponds
to their <a href="https://en.wikipedia.org/wiki/Union_(set_theory)">union \(\cup\)</a>.</p>

</details>

<h3 id="derived-group-properties">Derived group properties</h3>

<h4 id="preservation-of-equality">Preservation of equality (G6)</h4>

<p>It follows directly from the <a href="#properties-of-equality">substitution property</a>
that equality is preserved when we apply the same element on both sides:</p>

<p>

$$
\forall\ A, B, C \in \mathbb{G}\ A = B \implies A \circ C = B \circ C \\[4pt]
\textsf{using \href{#properties-of-equality}{substitution (E4)} with } F(X) = X \circ C
$$

$$
\forall\ A, B, C \in \mathbb{G}\ A = B \implies A + C = B + C \\[4pt]
\textsf{using \href{#properties-of-equality}{substitution (E4)} with } F(X) = X + C
$$

$$
\forall\ A, B, C \in \mathbb{G}\ A = B \implies A \cdot C = B \cdot C \\[4pt]
\textsf{using \href{#properties-of-equality}{substitution (E4)} with } F(X) = X \cdot C
$$

</p>

<h4 id="generalized-associative-law">Generalized associative law (G7)</h4>

<p>We prove <a href="https://en.wikipedia.org/wiki/Mathematical_induction">by induction</a>
that every possible <a href="https://en.wiktionary.org/wiki/parenthesization">parenthesization</a>
of \(n &gt; 3\) elements <a href="https://groupprops.subwiki.org/wiki/Associative_implies_generalized_associative">is equivalent</a>
(\(n = 3\) is covered by the axiom <a href="#group-axioms">G2</a>):</p>

<div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

  <p>Every parenthesization of \(A_1 \circ A_2 \circ A_3 \circ … \circ A_n\) is equal to
the left-associated expression \((((A_1 \circ A_2) \circ A_3) \circ …) \circ A_n\)
because any such expression can be written as \(B \circ C\),
where \(B = A_1 \circ … \circ A_m\), \(C = A_{m + 1} \circ … \circ A_n\),
and \(m\) is the position of the outermost operation.
Both \(B\) and \(C\) are parenthesized in an unknown way,
but since they both contain fewer elements than \(n\),
we know by induction that they have left-associated equivalents \(B&#39;\) and \(C&#39;\).
If \(m = n - 1\), \(B&#39; \circ C\) is a left-associated expression and we are done.
Otherwise, \(C&#39;\) can be written as \(D \circ A_n\).
Now, \(B&#39; \circ (D \circ A_n) = (B&#39; \circ D) \circ A_n\) because of <a href="#group-axioms">associativity (G2)</a>.
Since \(B&#39; \circ D\) contains less than \(n\) elements,
it has a left-associated equivalent, which makes the expression left-associated.
(We know that \(B&#39;\) and \(D\) can be represented by elements of the set because of <a href="#group-axioms">closure (G1)</a>.)</p>

  <p>Every parenthesization of \(A_1 + A_2 + A_3 + … + A_n\) is equal to
the left-associated expression \((((A_1 + A_2) + A_3) + …) + A_n\)
because any such expression can be written as \(B + C\),
where \(B = A_1 + … + A_m\), \(C = A_{m + 1} + … + A_n\),
and \(m\) is the position of the outermost operation.
Both \(B\) and \(C\) are parenthesized in an unknown way,
but since they both contain fewer elements than \(n\),
we know by induction that they have left-associated equivalents \(B&#39;\) and \(C&#39;\).
If \(m = n - 1\), \(B&#39; + C\) is a left-associated expression and we are done.
Otherwise, \(C&#39;\) can be written as \(D + A_n\).
Now, \(B&#39; + (D + A_n) = (B&#39; + D) + A_n\) because of <a href="#group-axioms">associativity (G2)</a>.
Since \(B&#39; + D\) contains less than \(n\) elements,
it has a left-associated equivalent, which makes the expression left-associated.
(We know that \(B&#39;\) and \(D\) can be represented by elements of the set because of <a href="#group-axioms">closure (G1)</a>.)</p>

  <p>Every parenthesization of \(A_1 \cdot A_2 \cdot A_3 \cdot … \cdot A_n\) is equal to
the left-associated expression \((((A_1 \cdot A_2) \cdot A_3) \cdot …) \cdot A_n\)
because any such expression can be written as \(B \cdot C\),
where \(B = A_1 \cdot … \cdot A_m\), \(C = A_{m + 1} \cdot … \cdot A_n\),
and \(m\) is the position of the outermost operation.
Both \(B\) and \(C\) are parenthesized in an unknown way,
but since they both contain fewer elements than \(n\),
we know by induction that they have left-associated equivalents \(B&#39;\) and \(C&#39;\).
If \(m = n - 1\), \(B&#39; \cdot C\) is a left-associated expression and we are done.
Otherwise, \(C&#39;\) can be written as \(D \cdot A_n\).
Now, \(B&#39; \cdot (D \cdot A_n) = (B&#39; \cdot D) \cdot A_n\) because of <a href="#group-axioms">associativity (G2)</a>.
Since \(B&#39; \cdot D\) contains less than \(n\) elements,
it has a left-associated equivalent, which makes the expression left-associated.
(We know that \(B&#39;\) and \(D\) can be represented by elements of the set because of <a href="#group-axioms">closure (G1)</a>.)</p>

</div>

<h4 id="uniqueness-of-right-identity">Uniqueness of right identity (G8)</h4>

<details open="">
  <summary id="idempotence">
Idempotence
</summary>

  <p>We say that an element is <a href="https://en.wikipedia.org/wiki/Idempotence">idempotent</a>
if it equals itself when it is combined with itself:</p>

  <div data-titles="Generic | Additive | Multiplicative | All" data-default="Generic">

    <p><strong>Idempotence (IP)</strong>: \(A \circ A = A\)</p>

    <p><strong>Idempotence (IP)</strong>: \(A + A = A\)</p>

    <p><strong>Idempotence (IP)</strong>: \(A \cdot A = A\)</p>

  </div>

</details>

<p>All elements which are idempotent are <a href="https://math.stackexchange.com/a/174035/947937">equal to the same identity element</a>:</p>

<p>

$$
\exists\ E \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}
\ A \circ E \stackrel{\text{\href{#group-axioms}{G3}}}{=} A
\land A \circ B \stackrel{\text{\href{#group-axioms}{G4}}}{=} E
\land \\[4pt]
\big(A \circ A \stackrel{\text{\href{#idempotence}{IP}}}{=} A \implies
A \stackrel{\text{\href{#group-axioms}{G3}}}{=} A \circ E
\stackrel{\text{\href{#group-axioms}{G4}}}{=} A \circ (A \circ B)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (A \circ A) \circ B
\stackrel{\text{\href{#idempotence}{IP}}}{=} A \circ B
\stackrel{\text{\href{#group-axioms}{G4}}}{=} E\big)
$$

$$
\exists\ O \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}
\ A + O \stackrel{\text{\href{#group-axioms}{G3}}}{=} A
\land A + B \stackrel{\text{\href{#group-axioms}{G4}}}{=} O
\land \\[4pt]
\big(A + A \stackrel{\text{\href{#idempotence}{IP}}}{=} A \implies
A \stackrel{\text{\href{#group-axioms}{G3}}}{=} A + O
\stackrel{\text{\href{#group-axioms}{G4}}}{=} A + (A + B)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (A + A) + B
\stackrel{\text{\href{#idempotence}{IP}}}{=} A + B
\stackrel{\text{\href{#group-axioms}{G4}}}{=} O\big)
$$

$$
\exists\ I \in \mathbb{G}\ \forall\ A \in \mathbb{G}\ \exists\ B \in \mathbb{G}
\ A \cdot I \stackrel{\text{\href{#group-axioms}{G3}}}{=} A
\land A \cdot B \stackrel{\text{\href{#group-axioms}{G4}}}{=} I
\land \\[4pt]
\big(A \cdot A \stackrel{\text{\href{#idempotence}{IP}}}{=} A \implies
A \stackrel{\text{\href{#group-axioms}{G3}}}{=} A \cdot I
\stackrel{\text{\href{#group-axioms}{G4}}}{=} A \cdot (A \cdot B)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (A \cdot A) \cdot B
\stackrel{\text{\href{#idempotence}{IP}}}{=} A \cdot B
\stackrel{\text{\href{#group-axioms}{G4}}}{=} I\big)
$$

</p>

<p>Since an identity element is an identity for all elements, including itself, it is idempotent.
Thus, all identity elements are the same.
As a consequence, we no longer need to <a href="#universal-and-existential-quantifiers">quantify</a> the identity element.
Depending on the <a href="#notation">notation</a>, \(E\), \(O\), or \(I\) simply refers to the unique identity element from now on.
The identity element can also be seen as the output of a <a href="https://en.wikipedia.org/wiki/Arity#Nullary">nullary function</a>.</p>

<details>
  <summary id="unique-identity-in-commutative-groups">
Unique identity in commutative groups
</summary>

  <p>If the operation is <a href="#commutative-groups">commutative</a>, it’s much easier to see why any two identities are the same:</p>

  <p>

$$
E_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} E_1 \circ E_2
\stackrel{\text{\href{#commutative-groups}{G5}}}{=} E_2 \circ E_1
\stackrel{\text{\href{#group-axioms}{G3}}}{=} E_2
$$

$$
O_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} O_1 + O_2
\stackrel{\text{\href{#commutative-groups}{G5}}}{=} O_2 + O_1
\stackrel{\text{\href{#group-axioms}{G3}}}{=} O_2
$$

$$
I_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} I_1 \cdot I_2
\stackrel{\text{\href{#commutative-groups}{G5}}}{=} I_2 \cdot I_1
\stackrel{\text{\href{#group-axioms}{G3}}}{=} I_2
$$

</p>

</details>

<h4 id="right-inverses-are-left-inverses">Right inverses are left inverses (G9)</h4>

<p>We show that when we apply any right inverse from the left,
the resulting element is <a href="#idempotence">idempotent</a>
and thus equal to the <a href="#uniqueness-of-right-identity">only identity</a>:</p>

<p>

$$
\forall\ A, B \in \mathbb{G}\ A \circ B \stackrel{\text{\href{#group-axioms}{G4}}}{=} E \\[2pt]
\Downarrow \\[2pt]
(B \circ A) \circ (B \circ A)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B \circ (A \circ B)) \circ A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \circ E) \circ A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B \circ A
\stackrel{\text{\href{#uniqueness-of-right-identity}{G8}}}{=} E
$$

$$
\forall\ A, B \in \mathbb{G}\ A + B \stackrel{\text{\href{#group-axioms}{G4}}}{=} O \\[2pt]
\Downarrow \\[2pt]
(B + A) + (B + A)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B + (A + B)) + A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B + O) + A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B + A
\stackrel{\text{\href{#uniqueness-of-right-identity}{G8}}}{=} O
$$

$$
\forall\ A, B \in \mathbb{G}\ A \cdot B \stackrel{\text{\href{#group-axioms}{G4}}}{=} I \\[2pt]
\Downarrow \\[2pt]
(B \cdot A) \cdot (B \cdot A)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B \cdot (A \cdot B)) \cdot A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \cdot I) \cdot A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B \cdot A
\stackrel{\text{\href{#uniqueness-of-right-identity}{G8}}}{=} I
$$

</p>

<details>
  <summary id="alternative-proof">
Alternative proof
</summary>

  <p>We can also prove that a right inverse is also a left inverse
<a href="https://math.stackexchange.com/questions/3374804/alternative-axioms-for-groups">as follows</a>:</p>

  <p>

$$
\forall\ A, B, C \in \mathbb{G}
\ A \circ B \stackrel{\text{\href{#group-axioms}{G4}}}{=} E
\land \ B \circ C \stackrel{\text{\href{#group-axioms}{G4}}}{=} E \\[2pt]
\Downarrow \\[2pt]
B \circ A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} (B \circ A) \circ E
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \circ A) \circ (B \circ C)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B \circ (A \circ B)) \circ C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \circ E) \circ C
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B \circ C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} E
$$

$$
\forall\ A, B, C \in \mathbb{G}
\ A + B \stackrel{\text{\href{#group-axioms}{G4}}}{=} O
\land \ B + C \stackrel{\text{\href{#group-axioms}{G4}}}{=} O \\[2pt]
\Downarrow \\[2pt]
B + A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} (B + A) + O
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B + A) + (B + C)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B + (A + B)) + C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B + O) + C
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B + C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} O
$$

$$
\forall\ A, B, C \in \mathbb{G}
\ A \cdot B \stackrel{\text{\href{#group-axioms}{G4}}}{=} I
\land \ B \cdot C \stackrel{\text{\href{#group-axioms}{G4}}}{=} I \\[2pt]
\Downarrow \\[2pt]
B \cdot A
\stackrel{\text{\href{#group-axioms}{G3}}}{=} (B \cdot A) \cdot I
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \cdot A) \cdot (B \cdot C)
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (B \cdot (A \cdot B)) \cdot C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (B \cdot I) \cdot C
\stackrel{\text{\href{#group-axioms}{G3}}}{=} B \cdot C
\stackrel{\text{\href{#group-axioms}{G4}}}{=} I
$$

</p>

</details>

<h4 id="right-identity-is-left-identity">Right identity is left identity (G10)</h4>

<p>The <a href="#uniqueness-of-right-identity">unique right identity</a> is also an identity element when applied from the left:</p>

<p>

$$
\forall\ A, B \in \mathbb{G}\ A \circ B \stackrel{\text{\href{#group-axioms}{G4}}}{=} E \\[2pt]
\Downarrow \\[2pt]
E \circ A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A \circ B) \circ A
\stackrel{\text{\href{#group-axioms}{G2}}}{=} A \circ (B \circ A)
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} A \circ E
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A
$$

$$
\forall\ A, B \in \mathbb{G}\ A + B \stackrel{\text{\href{#group-axioms}{G4}}}{=} O \\[2pt]
\Downarrow \\[2pt]
O + A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A + B) + A
\stackrel{\text{\href{#group-axioms}{G2}}}{=} A + (B + A)
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} A + O
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A
$$

$$
\forall\ A, B \in \mathbb{G}\ A \cdot B \stackrel{\text{\href{#group-axioms}{G4}}}{=} I \\[2pt]
\Downarrow \\[2pt]
I \cdot A
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A \cdot B) \cdot A
\stackrel{\text{\href{#group-axioms}{G2}}}{=} A \cdot (B \cdot A)
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} A \cdot I
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A
$$

</p>

<p>Using the same reasoning as <a href="#uniqueness-of-right-identity">above</a>, the left identity is also unique.</p>

<h4 id="uniqueness-of-inverses">Uniqueness of inverses (G11)</h4>

<p>It follows that any two inverses of the same element are the same:</p>

<p>

$$
\forall\ A, B_1, B_2 \in \mathbb{G}\
A \circ B_1 \stackrel{\text{\href{#group-axioms}{G4}}}{=} E \land
A \circ B_2 \stackrel{\text{\href{#group-axioms}{G4}}}{=} E \\[2pt]
\Downarrow \\[2pt]
B_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} B_1 \circ E
\stackrel{\text{\href{#group-axioms}{G4}}}{=} B_1 \circ (A \circ B_2)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (B_1 \circ A) \circ B_2
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} E \circ B_2
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{=} B_2
$$

$$
\forall\ A, B_1, B_2 \in \mathbb{G}\
A + B_1 \stackrel{\text{\href{#group-axioms}{G4}}}{=} O \land
A + B_2 \stackrel{\text{\href{#group-axioms}{G4}}}{=} O \\[2pt]
\Downarrow \\[2pt]
B_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} B_1 + O
\stackrel{\text{\href{#group-axioms}{G4}}}{=} B_1 + (A + B_2)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (B_1 + A) + B_2
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} O + B_2
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{=} B_2
$$

$$
\forall\ A, B_1, B_2 \in \mathbb{G}\
A \cdot B_1 \stackrel{\text{\href{#group-axioms}{G4}}}{=} I \land
A \cdot B_2 \stackrel{\text{\href{#group-axioms}{G4}}}{=} I \\[2pt]
\Downarrow \\[2pt]
B_1 \stackrel{\text{\href{#group-axioms}{G3}}}{=} B_1 \cdot I
\stackrel{\text{\href{#group-axioms}{G4}}}{=} B_1 \cdot (A \cdot B_2)
\stackrel{\text{\href{#group-axioms}{G2}}}{=} (B_1 \cdot A) \cdot B_2
\stackrel{\text{\href{#right-inverses-are-left-inverses}{G9}}}{=} I \cdot B_2
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{=} B_2
$$

</p>

<p>Given that every element of the group has an inverse
and that the inverse is unique for each element,
inversion is a <a href="https://en.wikipedia.org/wiki/Unary_operation">unary operation</a> on the set of elements.
Instead of <a href="#universal-and-existential-quantifiers">quantifying</a> the inverse as above,
we can use a much simpler notation for the inverse from now on:</p>

<p>

$$
\forall\ A \in \mathbb{G}\ A \circ \overline{A} = \overline{A} \circ A = E
$$

$$
\forall\ A \in \mathbb{G}\ A + (-A) = (-A) + A = O
$$

$$
\forall\ A \in \mathbb{G}\ A \cdot A^{-1} = A^{-1} \cdot A = I
$$

</p>

<h4 id="cancellation-property">Cancellation property (G12)</h4>

<p>Equality is also preserved when you remove the same element from both sides,
which is known as the <a href="https://en.wikipedia.org/wiki/Cancellation_property">cancellation property</a>:</p>

<p>

$$
\begin{aligned}
\forall\ A, B, C \in \mathbb{G}\ A \circ C &amp;= B \circ C \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (A \circ C) \circ \overline{C} &amp;= (B \circ C) \circ \overline{C} \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} A \circ (C \circ \overline{C}) &amp;= B \circ (C \circ \overline{C}) \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} A \circ E &amp;= B \circ E \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} A &amp;= B
\end{aligned}
$$

$$
\begin{aligned}
\forall\ A, B, C \in \mathbb{G}\ A + C &amp;= B + C \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (A + C) + (-C) &amp;= (B + C) + (-C) \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} A + (C + (-C)) &amp;= B + (C + (-C)) \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} A + O &amp;= B + O \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} A &amp;= B
\end{aligned}
$$

$$
\begin{aligned}
\forall\ A, B, C \in \mathbb{G}\ A \cdot C &amp;= B \cdot C \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (A \cdot C) \cdot C^{-1} &amp;= (B \cdot C) \cdot C^{-1} \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} A \cdot (C \cdot C^{-1}) &amp;= B \cdot (C \cdot C^{-1}) \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} A \cdot I &amp;= B \cdot I \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} A &amp;= B
\end{aligned}
$$

</p>

<h4 id="unique-solution-revisited">Unique solution (G13)</h4>

<p>As we saw <a href="#unique-solution">earlier</a>,
the following equation has a unique solution in every group (also if the element to be determined is on the right):</p>

<p>

$$
\begin{aligned}
\forall\ X, A, B \in \mathbb{G}\ X \circ A &amp;= B \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (X \circ A) \circ \overline{A} &amp;= B \circ \overline{A} \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} X \circ (A \circ \overline{A}) &amp;= B \circ \overline{A} \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} X \circ E &amp;= B \circ \overline{A} \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} X &amp;= B \circ \overline{A}
\end{aligned}
$$

$$
\begin{aligned}
\forall\ X, A, B \in \mathbb{G}\ X + A &amp;= B \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (X + A) + (-A) &amp;= B + (-A) \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} X + (A + (-A)) &amp;= B + (-A) \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} X + O &amp;= B + (-A) \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} X &amp;= B + (-A)
\end{aligned}
$$

$$
\begin{aligned}
\forall\ X, A, B \in \mathbb{G}\ X \cdot A &amp;= B \\
\stackrel{\text{\href{#preservation-of-equality}{G6}}}{\implies} (X \cdot A) \cdot A^{-1} &amp;= B \cdot A^{-1} \\
\stackrel{\text{\href{#group-axioms}{G2}}}{\implies} X \cdot (A \cdot A^{-1}) &amp;= B \cdot A^{-1} \\
\stackrel{\text{\href{#group-axioms}{G4}}}{\implies} X \cdot I &amp;= B \cdot A^{-1} \\
\stackrel{\text{\href{#group-axioms}{G3}}}{\implies} X &amp;= B \cdot A^{-1}
\end{aligned}
$$

</p>

<p>The solution is unique because any two solutions \(X_1\) and \(X_2\) are the same:</p>

<p>

$$
\forall\ X_1, X_2, A, B \in \mathbb{G}\ X_1 \circ A = B \land X_2 \circ A = B \\[2pt]
\begin{aligned}
\stackrel{\text{\href{#properties-of-equality}{E3}}}{\implies} X_1 \circ A &amp;= X_2 \circ A \\
\stackrel{\text{\href{#cancellation-property}{G12}}}{\implies} X_1 &amp;= X_2
\end{aligned}
$$

$$
\forall\ X_1, X_2, A, B \in \mathbb{G}\ X_1 + A = B \land X_2 + A = B \\[2pt]
\begin{aligned}
\stackrel{\text{\href{#properties-of-equality}{E3}}}{\implies} X_1 + A &amp;= X_2 + A \\
\stackrel{\text{\href{#cancellation-property}{G12}}}{\implies} X_1 &amp;= X_2
\end{aligned}
$$

$$
\forall\ X_1, X_2, A, B \in \mathbb{G}\ X_1 \cdot A = B \land X_2 \cdot A = B \\[2pt]
\begin{aligned}
\stackrel{\text{\href{#properties-of-equality}{E3}}}{\implies} X_1 \cdot A &amp;= X_2 \cdot A \\
\stackrel{\text{\href{#cancellation-property}{G12}}}{\implies} X_1 &amp;= X_2
\end{aligned}
$$

</p>

<h4 id="double-inverse-theorem">Double inverse theorem (G14)</h4>

<p>The inverse of the inverse is the original element again:</p>

<p>

$$
\forall\ A \in \mathbb{G}\ A \circ \overline{A} = E
\stackrel{\text{\href{#unique-solution-revisited}{G13}}}{\implies} A = E \circ \overline{\overline{A}}
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{\implies} A = \overline{\overline{A}}
$$

$$
\forall\ A \in \mathbb{G}\ A + (-A) = O
\stackrel{\text{\href{#unique-solution-revisited}{G13}}}{\implies} A = O + (-(-A))
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{\implies} A = -(-A)
$$

$$
\forall\ A \in \mathbb{G}\ A \cdot A^{-1} = I
\stackrel{\text{\href{#unique-solution-revisited}{G13}}}{\implies} A = I \cdot (A^{-1})^{-1}
\stackrel{\text{\href{#right-identity-is-left-identity}{G10}}}{\implies} A = (A^{-1})^{-1}
$$

</p>

<h4 id="inversion-of-combination">Inversion of combination (G15)</h4>

<p>We can invert a combination of two elements by combining their inverses in reverse order:</p>

<p>

$$
\forall\ A \in \mathbb{G}\ (A \circ B) \circ (\overline{B} \circ \overline{A})
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (A \circ (B \circ \overline{B})) \circ \overline{A}
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A \circ E) \circ \overline{A}
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A \circ \overline{A}
\stackrel{\text{\href{#group-axioms}{G4}}}{=} E \\[3pt]
\Downarrow\text{\scriptsize{\href{#uniqueness-of-inverses}{G11}}} \\[4pt]
\overline{A \circ B} = \overline{B} \circ \overline{A}
$$

$$
\forall\ A \in \mathbb{G}\ (A + B) + ((-B) + (-A))
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (A + (B + (-B))) + (-A)
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A + O) + (-A)
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A + (-A)
\stackrel{\text{\href{#group-axioms}{G4}}}{=} O \\[3pt]
\Downarrow\text{\scriptsize{\href{#uniqueness-of-inverses}{G11}}} \\[4pt]
-(A + B) = (-B) + (-A)
$$

$$
\forall\ A \in \mathbb{G}\ (A \cdot B) \cdot (B^{-1} \cdot A^{-1})
\stackrel{\text{\href{#generalized-associative-law}{G7}}}{=} (A \cdot (B \cdot B^{-1})) \cdot A^{-1}
\stackrel{\text{\href{#group-axioms}{G4}}}{=} (A \cdot I) \cdot A^{-1}
\stackrel{\text{\href{#group-axioms}{G3}}}{=} A \cdot A^{-1}
\stackrel{\text{\href{#group-axioms}{G4}}}{=} I \\[3pt]
\Downarrow\text{\scriptsize{\href{#uniqueness-of-inverses}{G11}}} \\[4pt]
(A \cdot B)^{-1} = B^{-1} \cdot A^{-1}
$$

</p>




            
            
        </article>
    </div></div>
  </body>
</html>
