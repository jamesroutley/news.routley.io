<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/kffl/speedbump">Original</a>
    <h1>Speedbump: TCP proxy for simulating variable, yet predictable network latency</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/kffl/speedbump/raw/HEAD/assets/speedbump.gif"><img alt="speedbump logo" src="https://github.com/kffl/speedbump/raw/HEAD/assets/speedbump.gif" width="480" height="auto" data-animated-image=""/></a>
</p>
Speedbump is a TCP proxy written in Go which allows for simulating variable network latency.
<p dir="auto"><a href="https://github.com/kffl/speedbump/actions"><img src="https://github.com/kffl/speedbump/workflows/CI/badge.svg" alt="CI Workflow"/></a> <a href="https://goreportcard.com/report/github.com/kffl/speedbump" rel="nofollow"><img src="https://camo.githubusercontent.com/298a99339926cb866f2097df7001430806ff4f7b87723cb255892f30463cd497/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f6b66666c2f737065656462756d70" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/kffl/speedbump"/></a> <a href="https://hub.docker.com/r/kffl/speedbump" rel="nofollow"><img src="https://camo.githubusercontent.com/078a6163e8e499543b071565ab92446e9da83a4a3a0cd6fd10bd814b9679e7a5/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f6b66666c2f737065656462756d70" alt="Docker Pulls" data-canonical-src="https://img.shields.io/docker/pulls/kffl/speedbump"/></a> <a href="https://hub.docker.com/r/kffl/speedbump" rel="nofollow"><img src="https://camo.githubusercontent.com/7ac63ba2992dfabc0c3743c9a71f6aa2a9d49ce38448f4b95fc67a52ad446437/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f762f6b66666c2f737065656462756d70" alt="Docker Image Version" data-canonical-src="https://img.shields.io/docker/v/kffl/speedbump"/></a> <a href="https://godoc.org/github.com/kffl/speedbump/lib" rel="nofollow"><img src="https://camo.githubusercontent.com/6257b2739dc9f4316622afbbcd4517b13db463f485595cd4e4226107fdfafe76/68747470733a2f2f676f646f632e6f72672f6769746875622e636f6d2f6b66666c2f737065656462756d702f6c69623f7374617475732e737667" alt="GoDoc" data-canonical-src="https://godoc.org/github.com/kffl/speedbump/lib?status.svg"/></a></p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<h3 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h3>
<p dir="auto">The easiest way to install speedbump is to download pre-built binaries for your platform that are automatically attached to each <a href="https://github.com/kffl/speedbump/releases/">release</a> under <em>Assets</em>. If you wish to build speedbump from source, clone this repository and run <code>go build</code>. Alternatively, you can run speedbump as a container using the <a href="https://hub.docker.com/r/kffl/speedbump" rel="nofollow">kffl/speedbump</a> image.</p>
<h3 dir="auto"><a id="user-content-basic-usage-examples" aria-hidden="true" href="#basic-usage-examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic usage examples</h3>
<p dir="auto">Spawn a new instance listening on port 2000 that proxies TCP traffic to localhost:80 with a base latency of 100ms and sine wave amplitude of 100ms (resulting in maximum added latency being 200ms and minimum being 0), period of which is 1 minute:</p>
<div data-snippet-clipboard-copy-content="speedbump --latency=100ms --sine-amplitude=100ms --sine-period=1m --port=2000 localhost:80"><pre><code>speedbump --latency=100ms --sine-amplitude=100ms --sine-period=1m --port=2000 localhost:80
</code></pre></div>
<p dir="auto">or when running speedbump using the <a href="https://hub.docker.com/r/kffl/speedbump" rel="nofollow">kffl/speedbump</a> container image:</p>
<div data-snippet-clipboard-copy-content="docker run --net=host kffl/speedbump:latest --latency=100ms --sine-amplitude=100ms \
           --sine-period=1m --port=2000 localhost:80"><pre><code>docker run --net=host kffl/speedbump:latest --latency=100ms --sine-amplitude=100ms \
           --sine-period=1m --port=2000 localhost:80
</code></pre></div>
<p dir="auto">Spawn a new instance with a base latency of 300ms and a sawtooth wave latency summand with amplitude of 200ms and period of 2 minutes (visualized by the graph below):</p>
<div data-snippet-clipboard-copy-content="speedbump --latency=300ms --saw-amplitude=200ms --saw-period=2m --port=2000 localhost:80"><pre><code>speedbump --latency=300ms --saw-amplitude=200ms --saw-period=2m --port=2000 localhost:80
</code></pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/kffl/speedbump/raw/HEAD/assets/sawtooth.svg"><img alt="speedbump sawtooth wave graph" src="https://github.com/kffl/speedbump/raw/HEAD/assets/sawtooth.svg" width="800" height="auto"/></a>
</p>
<h3 dir="auto"><a id="user-content-combining-latency-summands" aria-hidden="true" href="#combining-latency-summands"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Combining latency summands</h3>
<p dir="auto">It is possible to run speedbump with multiple latency summands at once:</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/kffl/speedbump/raw/HEAD/assets/combined.svg"><img alt="speedbump sawtooth + sine graph" src="https://github.com/kffl/speedbump/raw/HEAD/assets/combined.svg" width="800" height="auto"/></a>
</p>
<h2 dir="auto"><a id="user-content-cli-arguments-reference" aria-hidden="true" href="#cli-arguments-reference"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CLI Arguments Reference:</h2>
<p dir="auto">Output of <code>speedbump --help</code>:</p>
<div data-snippet-clipboard-copy-content="usage: speedbump [&lt;flags&gt;] &lt;destination&gt;

TCP proxy for simulating variable network latency.

Flags:
  --help              Show context-sensitive help (also try --help-long and --help-man).
  --port=8000         Port number to listen on.
  --buffer=64KB       Size of the buffer used for TCP reads.
  --queue-size=1024   Size of the delay queue storing read buffers.
  --latency=5ms       Base latency added to proxied traffic.
  --log-level=INFO    Log level. Possible values: DEBUG, TRACE, INFO, WARN, ERROR.
  --sine-amplitude=0  Amplitude of the latency sine wave.
  --sine-period=0     Period of the latency sine wave.
  --saw-amplitude=0   Amplitude of the latency sawtooth wave.
  --saw-period=0      Period of the latency sawtooth wave.
  --version           Show application version.

Args:
  &lt;destination&gt;  TCP proxy destination in host:post format."><pre><code>usage: speedbump [&lt;flags&gt;] &lt;destination&gt;

TCP proxy for simulating variable network latency.

Flags:
  --help              Show context-sensitive help (also try --help-long and --help-man).
  --port=8000         Port number to listen on.
  --buffer=64KB       Size of the buffer used for TCP reads.
  --queue-size=1024   Size of the delay queue storing read buffers.
  --latency=5ms       Base latency added to proxied traffic.
  --log-level=INFO    Log level. Possible values: DEBUG, TRACE, INFO, WARN, ERROR.
  --sine-amplitude=0  Amplitude of the latency sine wave.
  --sine-period=0     Period of the latency sine wave.
  --saw-amplitude=0   Amplitude of the latency sawtooth wave.
  --saw-period=0      Period of the latency sawtooth wave.
  --version           Show application version.

Args:
  &lt;destination&gt;  TCP proxy destination in host:post format.
</code></pre></div>
<h2 dir="auto"><a id="user-content-using-speedbump-as-a-library" aria-hidden="true" href="#using-speedbump-as-a-library"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using speedbump as a library</h2>
<p dir="auto">Speedbump can be used as a Go library via its <code>lib</code> package. Check <code>lib</code> <a href="https://github.com/kffl/speedbump/blob/master/lib/README.md">README</a> for additional information.</p>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">Copyright Paweł Kuffel 2022, licensed under Apache 2.0 License.</p>
<p dir="auto">Speedbump logo contains the Go Gopher mascot which was originally designed by Renee French (<a href="http://reneefrench.blogspot.com/" rel="nofollow">http://reneefrench.blogspot.com/</a>) and licensed under Creative Commons 3.0 Attributions license.</p>
</article>
          </div></div>
  </body>
</html>
