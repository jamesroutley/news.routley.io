<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.andreinc.net/2024/11/18/a-function-to-approximate-raising-small-numbers-to-small-irrational-powers">Original</a>
    <h1>A joke in approximating numbers raised to irrational powers</h1>
    
    <div id="readability-page-1" class="page"><div>
      
        <header>
          
          

  <p>
    
      
      <span>
        <i aria-hidden="true"></i>
        
        <time datetime="2024-11-18T00:00:00+00:00">November 18, 2024</time>
      </span>
    

    <span></span>

    
      
      

      <span>
        <i aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section itemprop="text">
        
        <h2 id="how-it-started">How it started</h2>

<p>The story behind this post surprisingly starts on Facebook, on a group dedicated to mathematics. A math teacher asked audience to find the \(\lfloor 3^{\sqrt{3}}\rfloor\) without using a calculator. Of course, it was a matter of proving \(\lfloor 3^{\sqrt{3}}\rfloor=6\), or that \(\lfloor 3^{\sqrt{3}}\rfloor=7\) (my intuition said it’s 7).</p>

<p>After a few back and forth discussions, everyone agreed the following solution (by Mihai Cris) is the <em>most acceptable</em>:</p>

\[3^{7}&gt;2^{10} \Rightarrow 3^{7}*3^{10}&gt;2^{10}*3^{10} \Rightarrow 3^{17} &gt; 6^{10} \Rightarrow 3^{\frac{17}{10}}&gt;6 \Rightarrow 3^{1.7} &gt; 6\]

<p>In the same time:</p>

\[3^7=2187&lt;2401=7^4 \Rightarrow 3^{7/4} &lt; 7 \Rightarrow 3^{1.75}&lt;7\]

<p>Because \(\sqrt{3}\approx 1.73 \Rightarrow \lfloor 3^{\sqrt{3}}\rfloor=6\).</p>

<h2 id="the-new-problem">The new problem</h2>

<p>The previous problem was cute, but it made me wonder if I can find a way to approximate (small) numbers raised to (small) irrational powers <strong>without using a calculator</strong> (no logarithms and radicals), by relying solely on <strong>addition</strong> and <strong>multiplication</strong>. Basically I was looking for a solution where pen, paper and patience are enough.</p>

<p>This is mostly a joke, so in case you don’t want to continue reading, here is the answer:</p>

\[a^{\sqrt{c}} \approx \frac{-120-60[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}-[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}{-120+60[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}+[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}\]

<p>(… as long as \(\frac{1}{2} &lt; \ln a * \sqrt{c} &lt; 3\))</p>

<h2 id="the-first-attempt">The first attempt</h2>

<p>The <em><a href="https://en.wikipedia.org/wiki/Logarithm">Logarithmic</a></em> and the <em><a href="https://en.wikipedia.org/wiki/Exponential_function">Exponential</a></em> functions came to the rescue.</p>

<ol>
  <li>We start by writing \(3^{\sqrt{3}}=(e^{\ln 3})^{\sqrt{3}}=e^{\sqrt{3}\ln 3}\). We know this is true because \(3=e^{\ln 3}=3^{\ln e}=3\).</li>
  <li>We use the <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor Series</a> expansion of \(e^x=1+\frac{x^1}{1!}+\frac{x^2}{2!}+\frac{x^3}{3!}+\frac{x^4}{4!}+\dots\) .</li>
  <li>So approximating \(3^{\sqrt{3}}\) is just a matter of computing \(1+\frac{(\sqrt{3}\ln 3)^1}{1!}+\frac{(\sqrt{3}\ln 3)^2}{2!}+\frac{(\sqrt{3}\ln 3)^3}{3!}+\frac{(\sqrt{3}\ln 3)^4}{4!}+\dots\).</li>
</ol>

<p>To get even closer to the actual result, I had to compute 8 terms for the series expansion, and no, it wasn’t by hand, as I’ve used <a href="https://www.wolframalpha.com/">WolframAlpha</a> do it for me:</p>

<div><div><pre><code>1+Sqrt[3]*Ln[3]+(Sqrt[3]*Ln[3])^2/2!+(Sqrt[3]*Ln[3])^3/3!+(Sqrt[3]*Ln[3])^4/4!+(Sqrt[3]*Ln[3])^5/5!+(Sqrt[3]*Ln[3])^6/6!+(Sqrt[3]*Ln[3])^7/7!+(Sqrt[3]*Ln[3])^8/8!
</code></pre></div></div>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/wa1.png" alt="img" height="50%" width="50%"/></p>

<h2 id="the-eureka">The eureka!</h2>

<p>At this point I had a few <em>flashbacks</em> from my school days.</p>

<p>Firstly, there was something called <em><a href="https://en.wikipedia.org/wiki/Small-angle_approximation">Small Angle Approximations</a></em>, that happen when the angle is, as you would expect, (very) very small:</p>

\[\sin(x) \approx x \\
\cos(x) \approx 1-\frac{x^2}{2} \\
\tan(x) \approx x\]

<p>So I’ve wondered if there isn’t something similar for \(e^x, \ln x\) and \(\sqrt{x}\), anything that works for small numbers.</p>

<p>Secondly, I remember watching a few months ago a video from <a href="https://www.youtube.com/@MichaelPennMath">Michael Penn</a>, about something called <em>Padé  Approximations</em>: <a href="https://www.youtube.com/watch?v=Y3PukSgFWRc">Pade Approximation – unfortunately missed in most Caclulus courses</a>. It was a subject worth exploring.</p>

<h2 id="pade-approximations-are-smooth">Pade approximations are “smooth”</h2>

<p>So, without going into too much details, a Padé approximation is a rational function (the ratio of two polynomials) used to represent a given function. The smart idea behind this technique is to distribute the <em>control points</em> of a polynomial between the denominator and the numerator of the rational function.</p>

<p>A Padé approximation of order <code>[m/n]</code> for a function \(f(x)\) is expressed as:</p>

\[f(x) \approx P_{[m,n]}(x)=\frac{a_0+a_1x+a_2x^2+\dots+a_mx^m}{1+b_1x+b_2x^2+\dots+b_nx^n}\]

<p>Compared to <em>Taylor Series</em>, Padé seem to handle exponential behaviors and discontinuities better, plus in a lot of cases it converges faster.</p>

<p>Needless to say, I was curious how well those approximations actually work, so I’ve computed the Padé aproximation of order <code>[1/1]</code>, \(P_{[1/1]}(x)\) for \(e^x\). (For in depth <em>tutorial</em> follow the Professor’s Penn <em>tutorial</em>, linked above).</p>

\[P_{[1/1]}(x)=\frac{a_0+a_1x}{b_1x+1}\]

<p>To find \(a_0, a_1, b_1\) we need to solve the following system of equations:</p>

\[\begin{cases}
e^0=P(0)=a_0=1 \\
e^0=P&#39;(0)=a_1-b_1=1 \\
e^0=P&#39;&#39;(0)=2b_1(b_1-a_1)=1 \\
\end{cases}\]

<p>After solving this, we will get \(P_{[1/1]}=\frac{2+x}{2-x}\).</p>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/padeex11.png" alt="img" height="50%" width="50%"/></p>

<p>We can already see that the \(P_{[1/1]}\) follows nicely \(e^x\) for the numbers around \(0\).</p>

<p>\(P_{[2/2]}=\frac{x^2+6x+12}{x^2-6x+12}\) is even better at approximating \(e^x\), at least up to a certain point.</p>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/padeex22.png" alt="img" height="50%" width="50%"/></p>

<p>So, in a way, \(e^x \approx \frac{x^2+6x+12}{x^2-6x+12}\) is true for small numbers, just like \(\sin(x) \approx x\) is true for small angles.</p>

<p>Or, even better, \(e^x \approx \frac{-120-60x-12x^{2}-x^{3}}{-120+60x-12x^{2}+x^{3}}\) is true for small small numbers, just like \(\sin(x) \approx x\) is true for small angles.</p>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/padeex33.png" alt="img" height="75%" width="75%"/></p>

<p>And it’s get better, for the \(\ln x\) function the equivalent <code>[2/2]</code> Padé approximation is: \(\frac{3(x-1)(x+1)}{x^{2}+4x+1}\). Notice how the approximation is bad if \(x &lt; 0.5\). For this we should find a better function.</p>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/padelog22.png" alt="img" height="75%" width="75%"/></p>

<p>And for \(\sqrt{x}\) the <code>[2/2]</code> approximation will be \(\frac{5x^{2}+10x+1}{x^{2}+10x+5}\).</p>

<p><img src="https://www.andreinc.net/assets/images/2024-12-12-a-function-to-approximate-raising-small-numbers-to-small-irrational-powers/padesqrt22.png" alt="img" height="75%" width="75%"/></p>

<h2 id="the-monster-function">The “monster” function</h2>

<p>Putting all together.</p>

<ol>
  <li>To compute \(e^x\) for \(x \in (0,4)\), we use: \(\frac{-120-60x-12x^{2}-x^{3}}{-120+60x-12x^{2}+x^{3}}\).</li>
  <li>To compute \(\ln x\) for \(x \in (0.5, 4)\) we use: \(\frac{3(x-1)(x+1)}{x^{2}+4x+1}\).</li>
  <li>To compute \(\sqrt{x}\) for \(x \in (0, 4)\) we use: \(\frac{5x^{2}+10x+1}{x^{2}+10x+5}\).</li>
</ol>

<p>So for “small numbers” we can approximate \(a^b\) using the following expression:</p>

\[a^b \approx \frac{-120-60[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}-[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}{-120+60[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}+[b*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}\]

<p>Or we can compute:</p>

\[a^{\sqrt{c}} \approx \frac{-120-60[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}-[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}{-120+60[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]-12[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{2}+[\frac{5c^{2}+10c+1}{c^{2}+10c+5}*\frac{3(a-1)(a+1)}{a^{2}+4a+1}]^{3}}\]

<hr/>

<h2 id="testing-the-monster-function">Testing the “monster” function</h2>

<p>Now, to test our marvelous approximation, let’s compute \(2^{\sqrt{2}}\):</p>

<ol>
  <li>We start approximating the logarithm: \(\ln 2=\frac{3(2-1)(2+1)}{2^2+8+1}=\frac{3*1*3}{4+8+1}=\frac{9}{13} \approx 0.69\).</li>
  <li>We continue approximating the radical: \(\sqrt{2}=\frac{5*2^2+20+1}{4+20+5}=\frac{20+20+1}{29}=\frac{41}{29} \approx 1.41\)</li>
  <li>We compute the product: \(0.69*1.41 \approx 0.97\).</li>
  <li>We actually compute the power: \(2^{\sqrt{2}}=e^{\sqrt{2}\ln 2} \approx e^{0.97}=\frac{-120-60*(0.97)-12*(0.97)^{2}-(0.97)^{3}}{-120+60*(0.97)-12*(0.97)^{2}+(0.97)^{3}} \approx 2.6612\)</li>
</ol>

<p>The actual result should’ve been: \(2.6651\). Not bad.</p>

<p>Computing \(3^{\sqrt{3}}\) with our function yields: \(6.58\) instead of \(6.70\). Not terrible.</p>

<h2 id="bonus">Bonus</h2>

<p>This is the python code used to generate the plots:</p>

<div><div><pre><code><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
<span>import</span> <span>matplotlib.pyplot</span> <span>as</span> <span>plt</span>

<span># [3/3] Pade approximation of e^x
</span><span>def</span> <span>approx_exp</span><span>(</span><span>x</span><span>):</span>
    <span>return </span><span>(</span><span>-</span><span>120</span><span>-</span><span>60</span><span>*</span><span>x</span><span>-</span><span>12</span><span>*</span><span>x</span><span>**</span><span>2</span><span>-</span><span>x</span><span>**</span><span>3</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>120</span><span>+</span><span>60</span><span>*</span><span>x</span><span>-</span><span>12</span><span>*</span><span>x</span><span>**</span><span>2</span><span>+</span><span>x</span><span>**</span><span>3</span><span>)</span>

<span># [2/2] Pade approximation of ln(x)
</span><span>def</span> <span>approx_log</span><span>(</span><span>x</span><span>):</span>
    <span>return</span> <span>3</span><span>*</span><span>(</span><span>x</span><span>-</span><span>1</span><span>)</span><span>*</span><span>(</span><span>x</span><span>+</span><span>1</span><span>)</span> <span>/</span> <span>(</span><span>x</span><span>**</span><span>2</span><span>+</span><span>4</span><span>*</span><span>x</span><span>+</span><span>1</span><span>)</span>

<span># [2/2] Pade approximation of sqrt(x)
</span><span>def</span> <span>approx_radical</span><span>(</span><span>x</span><span>):</span>
    <span>return </span><span>(</span><span>5</span><span>*</span><span>x</span><span>**</span><span>2</span><span>+</span><span>10</span><span>*</span><span>x</span><span>+</span><span>1</span><span>)</span> <span>/</span> <span>(</span><span>x</span><span>**</span><span>2</span><span>+</span><span>10</span><span>*</span><span>x</span><span>+</span><span>5</span><span>)</span>

<span>true_function</span> <span>=</span> <span>np</span><span>.</span><span>log</span> <span>#change with np.exp or np.sqrt
</span><span>approx_function</span> <span>=</span> <span>approx_log</span> <span>#change with approx_exp or approx_radical
</span><span>title</span><span>=</span><span>&#34;</span><span>Log[x] and [3/3] Padé Approximation on (0, 4)</span><span>&#34;</span>

<span>x_values</span> <span>=</span> <span>np</span><span>.</span><span>linspace</span><span>(</span><span>0</span><span>,</span> <span>4</span><span>,</span> <span>1000</span><span>)[</span><span>1</span><span>:]</span> 

<span># Evaluate functions
</span><span>true_values</span> <span>=</span> <span>true_function</span><span>(</span><span>x_values</span><span>)</span>
<span>approx_values</span> <span>=</span> <span>approx_function</span><span>(</span><span>x_values</span><span>)</span>
<span>deviation</span> <span>=</span> <span>np</span><span>.</span><span>abs</span><span>(</span><span>true_values</span> <span>-</span> <span>approx_values</span><span>)</span>
<span>annotation_points</span> <span>=</span> <span>np</span><span>.</span><span>linspace</span><span>(</span><span>0.5</span><span>,</span> <span>4</span><span>,</span> <span>10</span><span>)</span> 

<span>#Plotting
</span><span>plt</span><span>.</span><span>figure</span><span>(</span><span>figsize</span><span>=</span><span>(</span><span>12</span><span>,</span> <span>6</span><span>))</span>
<span>plt</span><span>.</span><span>plot</span><span>(</span><span>x_values</span><span>,</span> <span>true_values</span><span>,</span> <span>label</span><span>=</span><span>&#39;</span><span>sqrt(x)</span><span>&#39;</span><span>,</span> <span>color</span><span>=</span><span>&#39;</span><span>blue</span><span>&#39;</span><span>,</span> <span>linewidth</span><span>=</span><span>2</span><span>)</span>
<span>plt</span><span>.</span><span>plot</span><span>(</span><span>x_values</span><span>,</span> <span>approx_values</span><span>,</span> <span>label</span><span>=</span><span>&#39;</span><span>Padé [2/2] sqrt(x))</span><span>&#39;</span><span>,</span> <span>color</span><span>=</span><span>&#39;</span><span>orange</span><span>&#39;</span><span>,</span> <span>linestyle</span><span>=</span><span>&#39;</span><span>--</span><span>&#39;</span><span>,</span> <span>linewidth</span><span>=</span><span>2</span><span>)</span>
<span>plt</span><span>.</span><span>fill_between</span><span>(</span><span>x_values</span><span>,</span> <span>0</span><span>,</span> <span>deviation</span><span>,</span> <span>color</span><span>=</span><span>&#39;</span><span>red</span><span>&#39;</span><span>,</span> <span>alpha</span><span>=</span><span>0.3</span><span>,</span> <span>label</span><span>=</span><span>&#39;</span><span>Deviation</span><span>&#39;</span><span>)</span>

<span># Annotate deviation at key points
</span><span>for</span> <span>x</span> <span>in</span> <span>annotation_points</span><span>:</span>
    <span>y_true</span> <span>=</span> <span>true_function</span><span>(</span><span>x</span><span>)</span>
    <span>y_approx</span> <span>=</span> <span>approx_function</span><span>(</span><span>x</span><span>)</span>
    <span>dev</span> <span>=</span> <span>np</span><span>.</span><span>abs</span><span>(</span><span>y_true</span> <span>-</span> <span>y_approx</span><span>)</span>
    <span>plt</span><span>.</span><span>text</span><span>(</span><span>x</span><span>,</span> <span>dev</span> <span>+</span> <span>0.0005</span><span>,</span> <span>f</span><span>&#34;</span><span>{</span><span>dev</span><span>:</span><span>.</span><span>5</span><span>f</span><span>}</span><span>&#34;</span><span>,</span> <span>color</span><span>=</span><span>&#39;</span><span>black</span><span>&#39;</span><span>,</span> <span>fontsize</span><span>=</span><span>10</span><span>,</span> <span>ha</span><span>=</span><span>&#39;</span><span>center</span><span>&#39;</span><span>)</span>

<span># Add labels, legend, and set default y-axis scale
</span><span>plt</span><span>.</span><span>title</span><span>(</span><span>title</span><span>,</span> <span>fontsize</span><span>=</span><span>16</span><span>)</span>
<span>plt</span><span>.</span><span>xlabel</span><span>(</span><span>&#39;</span><span>x</span><span>&#39;</span><span>,</span> <span>fontsize</span><span>=</span><span>14</span><span>)</span>
<span>plt</span><span>.</span><span>ylabel</span><span>(</span><span>&#39;</span><span>y</span><span>&#39;</span><span>,</span> <span>fontsize</span><span>=</span><span>14</span><span>)</span>
<span>plt</span><span>.</span><span>legend</span><span>(</span><span>fontsize</span><span>=</span><span>12</span><span>)</span>
<span>plt</span><span>.</span><span>grid</span><span>(</span><span>True</span><span>)</span>

<span># Show the plot
</span><span>plt</span><span>.</span><span>tight_layout</span><span>()</span>
<span>plt</span><span>.</span><span>show</span><span>()</span>
</code></pre></div></div>

        
      </section>

      

      


      
    </div></div>
  </body>
</html>
