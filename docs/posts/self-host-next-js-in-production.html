<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/opennextjs/opennextjs-aws">Original</a>
    <h1>Show HN: Self-Host Next.js in Production</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <a href="https://opennext.js.org" rel="nofollow">
    <themed-picture data-catalyst-inline="true"><picture>
      <source media="(prefers-color-scheme: dark)" srcset="/opennextjs/opennextjs-aws/raw/main/docs/public/logo-dark.svg"/>
      <img alt="OpenNext" src="https://github.com/opennextjs/opennextjs-aws/raw/main/docs/public/logo-light.svg" width="300"/>
    </picture></themed-picture>
  </a>
</p>
<p dir="auto">
  <a href="https://discord.gg/opennextjs" rel="nofollow"><img alt="Discord" src="https://camo.githubusercontent.com/0b0839810f54a68bb81a00b946cf53610d2389b89b0944859761c28cc4e4afe5/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f313238333132383936383134303136313036353f7374796c653d666c61742d737175617265" data-canonical-src="https://img.shields.io/discord/1283128968140161065?style=flat-square"/></a>
  <a href="https://www.npmjs.com/package/@opennextjs/aws" rel="nofollow"><img alt="npm" src="https://camo.githubusercontent.com/3cbdfb414a7bf72f567ef58465f220454b52df6c918d1ac03e9654f3dd79410f/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f406f70656e6e6578746a732f6177732e7376673f7374796c653d666c61742d737175617265" data-canonical-src="https://img.shields.io/npm/v/@opennextjs/aws.svg?style=flat-square"/></a>
</p>
<hr/>


<p dir="auto">OpenNext takes the Next.js build output and converts it into packages that can be deployed across a variety of environments. Natively OpenNext has support for AWS Lambda, and classic Node.js Server.</p>

<p dir="auto">OpenNext aims to support all Next.js 14 features. Some features are work in progress. If you are running into any problems make sure to check the <a href="https://opennext.js.org/aws" rel="nofollow">docs</a> first before you open a <a href="https://github.com/opennextjs/opennextjs-aws/blob/main/issues/new">new issue</a> or visit our <a href="https://discord.gg/opennextjs" rel="nofollow">Discord</a> to let us know!</p>
<ul>
<li> App &amp; Pages Router</li>
<li> API routes</li>
<li> Dynamic routes</li>
<li> Static site generation (SSG)</li>
<li> Server-side rendering (SSR)</li>
<li> Incremental static regeneration (ISR)</li>
<li> Middleware</li>
<li> Server actions</li>
<li> Image optimization</li>
<li> <a href="https://next-auth.js.org" rel="nofollow">NextAuth.js</a></li>
<li> Running at edge</li>
<li> <a href="#coldstart">Almost no coldstart (*)</a></li>
</ul>

<p dir="auto"><a href="https://uk.gymshark.com" rel="nofollow">Gymshark UK</a>, <a href="https://engineering.udacity.com/deploying-next-js-on-the-edge-with-sst-is-sst-the-game-changer-its-claimed-to-be-1f05a0abc27c" rel="nofollow">Udacity</a>, <a href="https://www.tudn.com" rel="nofollow">TUDN</a>, <a href="https://github.com/nhs-england-tools/terraform-aws-opennext">NHS England</a></p>


<p dir="auto">For personalisation you need to create a file <code>open-next.config.ts</code> at the same place as your <code>next.config.js</code>, and export a default object that satisfies the <code>OpenNextConfig</code> interface. It is possible to not have an open-next.config.ts file, the default configuration will then be applied automatically.</p>

<p dir="auto">OpenNext can be executed in debug mode by setting the environment variable <code>OPEN_NEXT_DEBUG=true</code> before your build.</p>
<p dir="auto">This will output A LOT of additional logs to the console. This also disable minifying in esbuild, and add source maps to the output. This can result in code that might be up to 2-3X larger than the production build. Do <strong>not</strong> enable this in production.</p>
<p dir="auto">You can read more about the configuration in the <a href="https://opennext.js.org/aws/config" rel="nofollow">docs</a></p>

<p dir="auto">Besides the standard npm releases we also automatically publish prerelease packages on branch pushes (using <a href="https://github.com/stackblitz-labs/pkg.pr.new"><code>pkg.pr.new</code></a>):</p>
<ul dir="auto">
<li><code>https://pkg.pr.new/@opennextjs/aws@main</code>:
Updated with every push to the <code>main</code> branch, this prerelease contains the most up to date yet (reasonably) stable version of the package.</li>
<li><code>https://pkg.pr.new/@opennextjs/aws@experimental</code>
Updated with every push to the <code>experimental</code> branch, this prerelease contains the latest experimental version of the package (containing features that we want to test/experiment on before committing to).</li>
</ul>
<p dir="auto">Which you can simply install directly with your package manager of choice, for example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="npm i https://pkg.pr.new/@opennextjs/aws@main"><pre>npm i https://pkg.pr.new/@opennextjs/aws@main</pre></div>

<p dir="auto">To run <code>OpenNext</code> locally:</p>
<ol dir="auto">
<li>Clone this repository.</li>
<li>Build <code>open-next</code>:
<div dir="auto" data-snippet-clipboard-copy-content="cd packages/open-next
pnpm build"><pre><span>cd</span> packages/open-next
pnpm build</pre></div>
</li>
<li>Run <code>open-next</code> in watch mode:

</li>
<li>Now, you can make changes in <code>open-next</code> and build your Next.js app to test the changes.
<div dir="auto" data-snippet-clipboard-copy-content="cd path/to/my/nextjs/app
path/to/open-next/packages/open-next/dist/index.js build"><pre><span>cd</span> path/to/my/nextjs/app
path/to/open-next/packages/open-next/dist/index.js build</pre></div>
</li>
</ol>

<p dir="auto">OpenNext provide you with a warmer function that can be used to reduce cold start.</p>
<p dir="auto">On Lambda, there are multiple scenarios where a lambda will trigger a cold start even if you have some warmed instance. For example if you have more requests than warm instances you&#39;ll get a cold start. Also NextJs lazy load the routes, so even if you hit a warm instance, this specific route might not have been loaded yet.</p>

<p dir="auto">We are grateful for the projects that inspired OpenNext and the amazing tools and libraries developed by the community:</p>
<ul dir="auto">
<li><a href="https://github.com/sladg/nextjs-lambda">nextjs-lambda</a> by <a href="https://github.com/sladg">Jan</a> for serving as inspiration for packaging Next.js&#39;s standalone output to Lambda.</li>
<li><a href="https://github.com/jetbridge/cdk-nextjs/">CDK NextJS</a> by <a href="https://github.com/jetbridge">JetBridge</a> for its contribution to the deployment architecture of a Next.js application on AWS.</li>
<li><a href="https://github.com/dougmoscrop/serverless-http">serverless-http</a> by <a href="https://github.com/dougmoscrop">Doug Moscrop</a> for developing an excellent library for transforming AWS Lambda events and responses.</li>
<li><a href="https://github.com/serverless-nextjs/serverless-next.js">serverless-nextjs</a> by <a href="https://github.com/serverless">Serverless Framework</a> for paving the way for serverless Next.js applications on AWS.</li>
</ul>
<p dir="auto">Special shoutout to <a href="https://github.com/khuezy">@khuezy</a> and <a href="https://github.com/conico974">@conico974</a> for their outstanding contributions to the project.</p>
<hr/>
<p dir="auto">Maintained by <a href="https://sst.dev" rel="nofollow">SST</a>. Join our community: <a href="https://discord.gg/opennextjs" rel="nofollow">Discord</a> | <a href="https://www.youtube.com/c/sst-dev" rel="nofollow">YouTube</a> | <a href="https://twitter.com/SST_dev" rel="nofollow">Twitter</a></p>
</article></div></div>
  </body>
</html>
