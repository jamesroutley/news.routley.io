<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bastionzero.com/blog/i-read-the-federal-governments-zero-trust-memo-so-you-dont-have-to">Original</a>
    <h1>I read the federal government’s Zero-Trust Memo so you don’t have to</h1>
    
    <div id="readability-page-1" class="page"><div><div id="w-node-_00375525-3bbf-c047-fda4-80cfa31b040b-3717964d"><div id="w-node-_2fe16bba-c4c3-593b-a7ff-960779af9613-3717964d"><p>Yesterday, the Office and Management and Budget (OMB) released a <a href="https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf">memo</a>:“Moving the U.S. Government Towards Zero Trust Cybersecurity Principles”.  The memo is a <a href="https://www.cnn.com/2022/01/26/politics/white-house-cybersecurity-strategy/index.html">reaction</a> to 2020’s <a href="https://www.npr.org/2021/04/16/985439655/a-worst-nightmare-cyberattack-the-untold-story-of-the-solarwinds-hack">SolarWinds incident</a> and 2021’s <a href="https://en.wikipedia.org/wiki/Colonial_Pipeline_ransomware_attack">Colonial Pipeline rasomware attack</a>, and advises the Federal Government on what steps each agency must take to improve its cybersecurity.</p><p>Many of the items in the memo go well-beyond even what the top enterprises and tech startups are doing today. It looks like the government is planning to position itself as a cybersecurity leader (rather than a laggard), while also pushing the private sector into a more robust cybersecurity posture. </p><p>Also, if you get into it, this memo is actually about a lot more than zero trust.  </p><p>Sure, it covers authentication, network segmentation and role-based access control, which are all things that we’re used to thinking about when we say zero trust.  But it also talks about more controversial things like bug-bounty programs and encrypted DNS. It tells us to stop rotating passwords, and stop putting in those annoying special characters as requirements in password policies. (Hooray!)  And it comes down unexpectedly hard on VPNs.  </p><p>Let’s get into the details.</p><p>‍</p><h3><strong>The memo</strong> <strong>mandates “zero-trust” authentication: SSO along with MFA and device context.</strong></h3><p>Zero trust is used in a variety of different ways, <a href="https://docs.bastionzero.com/product-docs/home/security-model#the-basics-of-zero-trust-security" target="_blank">but to me zero-trust means something very simple</a>: </p><h4>Do not give long-lived credentials to your users. </h4><p>This is very sensible.  If you don’t give your users long-standing credentials, you don’t have to worry about them walking away with those credentials when they leave the organization. You don’t have to worry that a compromise of their devices later leads to a compromise of their credentials. </p><p>The memo advocates the well-established as the modern approach to zero-trust: centralized SSO, along with MFA. </p><p>It also says that while role-based access control (RBAC) is good, agencies should not rely too much on “static predefined roles”. Instead, access should be more “fine-grained” and “dynamic”. This sounds like Just-In-Time (JIT) access control, where a user is granted access to a resource only while she needs it, and that access is revoked when she is done. </p><p><strong>But what kind of MFA?</strong> </p><p>Here’s where it gets interesting. The memo comes right out and tells agencies to</p><blockquote>“discontinue support for protocols that register phone numbers for SMS or voice calls, supply one-time codes, or receive push notifications&#39;&#39;.  </blockquote><p>We can all get behind the elimination of SMS/phone based 2FA, which is known to be vulnerable to <a href="https://therecord.media/more-than-1200-phishing-toolkits-capable-of-intercepting-2fa-detected-in-the-wild/">phishing</a> and <a href="https://en.wikipedia.org/wiki/SIM_swap_scam">sim-swapping</a> attacks. </p><p>But the memo also dismisses the popular one-time code approaches like the <a href="https://en.wikipedia.org/wiki/Time-based_one-time_password">TOTP</a> protocol (the Google Authenticator on your phone), which is basically the state of the art for SaaS business everywhere.  </p><figure><p><img src="https://uploads-ssl.webflow.com/61ae685f49a92d4263a45f3a/61f2a8f288df92705cf17c40_tuIVaUZsOw6KHdfF2pfDtQ8IvFWybdqgSl30U_9bPQKUVC84lQqPuQu__XkENFDjkosessAC2zHm9Ntk-XUUZ4eeTMfZEUMbo5CJLfPGyttB1UOeWoJb8QLsT33X-XVBbgcfEKx0.png" alt="Person holding a smartphone with a one time password application open"/></p><figcaption><a href="https://www.androidguys.com/tips-tools/setting-up-google-authenticator-is-as-easy-as-scanning-a-qr-code/">Image from Android Guys</a></figcaption></figure><p>Instead, users should be issued “phishing resistant tokens”, like PIV cards and yubikeys.  This seems very feasible in the context of a government agency, because each employee can receive her token as part of her onboarding when she is hired.  However, this sort of thing is harder to do if you are a SaaS service (e.g. a payroll service, a bank) that is seeking to offer MFA to a broad swath of your customers. </p><p>It will be interesting to see if these MFA recommendations will have any impact beyond the government.  Maybe phone-based MFA will finally go away? (Doubt it.)</p><p><strong>Adding in device context. </strong></p><p>The memo also goes beyond MFA to mandate that authentication should “incorporate at least one device-level signal alongside identity information”.  That is, that authentication also checks that the user is authenticated from a “trusted” device.  </p><p>This feature is already prevalent by most IdP&#39;s. (Here’s an example of a rudimentary device context <a href="https://help.okta.com/en/prod/Content/Topics/Apps/pass-device-context-limited-access.htm">feature</a> that you can use with Okta SSO. )</p><p>But most companies don’t use it. Why? Because they would have to do things like push device certs to signal a managed device or integrate device posture checks with authentication.  In other words, supporting device context in a bring-your-own-device (BYOD) pretty hard, as it requires IT teams to manage and inventory user devices. </p><p>‍</p><h3>Passwords are deprecated! </h3><p> Here I’ll just screenshot the memo directly, since it makes itself pretty clear: </p><p>‍</p><figure><p><img src="https://uploads-ssl.webflow.com/61ae685f49a92d4263a45f3a/61f2aaf9bb25f8d2d8923e2c_password.PNG" loading="lazy" alt=""/></p><figcaption>“Agencies are encouraged to pursue greater use of passwordless multi-factor authentication as they modernize their authentication systems. However, when passwords are in use, they are a “factor” in multi-factor authentication. If outdated password requirements lead agency staff to reuse passwords from their personal life, store passwords insecurely, or otherwise use weak passwords, adversaries will find it much easier to obtain unauthorized account access—even within a system that uses MFA.”<br/></figcaption></figure><p>Those outdated password requirements are all the annoying things we all hate when logging into government websites.  The memo says “Password policies must not require use of special characters or regular rotation.” </p><h3>VPNs are deprecated! </h3><p>I didn’t expect the memo to come out quite so hard on VPNs.  But the very first section says: </p><blockquote> “the Federal Government can no longer depend on conventional perimeter-based defenses”.</blockquote><p>And later, the memo says:</p><blockquote>	“Users should log into applications, rather than networks”</blockquote><p>So that’s it. Your VPN is not good enough. Users should log into each application separately, using the zero-trust authentication described above.  </p><p>Importantly, the memo is not only deprecating old fashioned VPNs where users hold long-lived credentials. It’s also deprecating more <em>modern </em>VPN approaches where users login to the VPN with SSO+MFA (e.g. all the new VPN services based on wiregard).  Because even with these new approaches, the user is still logging into the network, not the application.</p><p>So why is authentication on the application layer more valuable than at the network layer? The network layer is too formless (it’s like giving out keys to office buildings).  Meanwhile, the application layer maps onto individual user actions (it’s like assigning and enforcing specific organizational roles and responsibilities). </p><p>The memo is advocating for a <a href="https://cloud.google.com/beyondcorp">BeyondCorp</a> approach.  In fact, it goes even further by suggesting that we don’t really need VPNs anymore: </p><blockquote>	“Enterprise applications should be able to be used over the public internet.”</blockquote><p>RIP VPNs? </p><p>‍</p><h3>The memo takes a stand on several controversial network security issues. </h3><p>The memo also opines on several core internet protocols. </p><p><strong>HTTP. </strong>The memo mandates encryption of HTTP traffic. Ok, this is tablestakes.  One slightly new thing is mandating the encryption of internal traffic too. This is kind of also tablestakes. (The community was already pretty much there when we saw that hand-drawn “encryption added and removed here” slide leaked from the NSA in 2013. And if you don’t know what I’m talking about, read <a href="https://www.washingtonpost.com/world/national-security/nsa-infiltrates-links-to-yahoo-google-data-centers-worldwide-snowden-documents-say/2013/10/30/e51d661e-4166-11e3-8b74-d89d714ca4dd_story.html">this</a>!) </p><p><strong>DNS! </strong>But, the memo also mandates the encryption of DNS traffic!  This is new.  Most DNS traffic is not encrypted. And there’s plenty of <a href="https://www.wired.com/story/dns-over-https-encrypted-web/">controversy</a> around this topic, including that it consolidates DNS traffic around a smaller number of resolvers that support encryption, and the fact that encrypted DNS makes it harder to tell when attackers are using DNS for botnet command-and-control, or to exfil data from a network.  These are all legitimate arguments.  </p><p>But no.  The memo comes out unequivocally on the side of encrypting DNS. </p><p>This could have a major impact. How long before AWS starts to offer encrypted DNS? </p><p><strong>Email? </strong>Finally, it looks like encrypted email might be a thing (again!). The memo is bit vague here: “FedRAMP will evaluate options for encrypting email in transit.”  I, personally, am fascinated.  (But then again  I’m someone who once wrote a <a href="https://link.springer.com/chapter/10.1007/978-3-319-76481-8_12">research paper</a> about email security.)  </p><p>Today’s email protocols use the STARTTLS protocol for encryption; it is laughably easy to do a protocol downgrade attack that turns off the encryption.  (See for instance this <a href="https://dl.acm.org/doi/10.1145/2815675.2815695">paper</a>.) Meanwhile encryption with <a href="https://latacora.micro.blog/2019/07/16/the-pgp-problem.html">PGP has been a complete failure</a>, due to problems with key distribution and user experience.  I don’t see any concrete recommendations here, so it&#39;s hard to say what the technical implementation could be.</p><h3>Maybe we can all finally stop worrying so much about the CFAA?</h3><p>I’ll wrap up by pointing out that the memo includes a statement about responsible disclosure and bug bounties. This is pretty fantastic.</p><blockquote> “In addition to robust internal testing programs, agencies should scrutinize their applications as our nation’s adversaries do. This requires welcoming external partners and independent perspectives to evaluate the real-world security of agency applications, and a process for coordinated disclosure of vulnerabilities by the general public.”</blockquote><p>Later it says:</p><blockquote>“Agencies must maintain an effective and welcoming public vulnerability disclosure system for their internet accessible systems.”</blockquote><p>In other words, the agencies should support external researchers that scrutinize their systems and responsibly disclose vulnerabilities.  </p><p>While this is hardly a shocking position to take in 2022, it’s great to see it coming from the government.</p><p>Even today, <a href="https://www.eff.org/document/cfaa-and-security-researchers">the law is not on the side of security researchers</a>. In particular,  the 1985 <a href="https://www.law.cornell.edu/uscode/text/18/1030">Computer Fraud and Abuse Act</a> can be used to hold security researchers criminally liable for “exceeding authorized access” to find vulnerabilities in live systems. It seems ridiculous that companies would do this, but even just a few months ago the <a href="https://www.kmov.com/news/post-dispatch-reporter-called-hacker-after-discovering-vulnerability-in-state-website/article_375874da-2d06-11ec-a2d7-a7fa94ab0531.html">State of Missouri was seeking to prosecute</a> a St. Louis Post-Dispatch reporter who identified and disclosed a vulnerability in a state website (by viewing its HTML source!).  </p><p>The memo suggests that nonsense like this should just stop.  <strong>Which is a good thing.</strong></p><h3>Conclusion</h3><p>All in, the memo is pushing for a cybersecurity posture that is well beyond where many companies are today. </p><p>Old fashioned technologies like passwords and VPNs are out. Users should authenticate to individual applications, BeyondCorp style, and their access should be monitored and logged.   Organizations should inventory user devices, and device context should be provided as part of each authentication to each application --- something that is not easy to do in our BYOD world.</p><p>MFA should be “phishing resistant” and TOTP authentication is out -- this can probably work in the context of government but I’m skeptical if it will have much impact beyond that. </p><p>Bug bounties are a good thing, and we should all stop arguing and just encrypt the DNS.</p><p>All in, a good set of recommendations. Looking forward to seeing how they impact the industry  over the coming months and years.</p><h4>By Sharon Goldberg, PhD.</h4><h4>CEO of BastionZero</h4></div></div></div></div>
  </body>
</html>
