<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://david.guillot.me/en/posts/tech/following-up-mother-of-all-htmx-demos/">Original</a>
    <h1>Following up &#34;Mother of all Htmx demos&#34;</h1>
    
    <div id="readability-page-1" class="page"><div><h2 id="_quick-aside-almost-2-years-of-silence_"><em>Quick aside: almost 2 years of silence</em></h2>
<p><em>Initially I wanted to publish such a blog post a year ago. It had been a crazy year since DjangoCon Europe 2022, and I thought that writing some follow-up a year after that talk would be relevant. Well you know what, the year after that has been even crazier. I am so exhausted that I had to quit the awesome company called <a href="https://www.contexte.com/" target="_blank">Contexte</a>
 after more than 7 years.</em></p>
<p><em>Now here I am: taking some time for myself, <a href="https://david.guillot.me/en/posts/2024-07-welcome/">launching this blog</a>
, and finally taking, with this post, the opportunity to answer some questions that have arisen in the many discussions around htmx. Sorry that took me so long.</em></p>
<h2 id="the-mother-of-all-htmx-demos">The “Mother of all htmx demos”</h2>
<h3 id="a-brief-history">A brief history</h3>
<ol>
<li>2021: working on a SaaS product with a fairly sophisticated user experience, I am frustrated by seeing how our React front-end is bulky, and by not being able to fix it because I am a “back-end developer”</li>
<li>Late 2021: learning about the hypermedia approach, watching <a href="https://youtu.be/Z2DU0qLfPIY?feature=shared&amp;t=919" target="_blank">Chris McCords introducing Phoenix.LiveView</a>
 back in 2018, learning about <a href="https://hotwired.dev/" target="_blank">Hotwire</a>
 and <a href="https://unpoly.com/" target="_blank">Unpoly</a>
, I decide to clone our front-end, just to see where the limits are, using Django and <a href="https://htmx.org/" target="_blank">htmx</a>
.</li>
<li>2022: after we decide to switch from React to htmx because my proof-of-concept was convincing, I think about telling our story and how it made us happier. My talk proposal is accepted by the awesome <a href="https://2024.djangocon.eu/" target="_blank">DjangoCon Europe</a>
 event.</li>
<li>Late 2022: <a href="https://www.youtube.com/watch?v=3GObi93tjZI" target="_blank">the video of my talk</a>
 is published, Carson Gross himself <a href="https://htmx.org/essays/a-real-world-react-to-htmx-port/" target="_blank">highlights it on the htmx website</a>
, gives it this flattering “Mother of all htmx demos” nickname, and makes a buzz around it from <a href="https://lobste.rs/s/bmsmbu/real_world_react_htmx_port_67_reduction" target="_blank">lobste.rs</a>
 to <a href="https://news.ycombinator.com/item?id=33218439" target="_blank">the orange site front page</a>
, pushing the video to 30k views in a few months (80k+ today).</li>
<li>Summer 2023: famous twitcher/youtuber <a href="https://www.youtube.com/@ThePrimeagen" target="_blank">ThePrimeagen</a>
 makes <a href="https://www.youtube.com/watch?v=wIzwyyHolRs" target="_blank">a video of his own</a>
 where he hilariously comments mine and where he adds some good points and asks some good questions. Today his video has been viewed 310k times, pushing my talk to almost 400k views in 1.5 year, which is crazy.</li>
</ol>
<h3 id="impact-on-htmx">Impact on htmx</h3>
<p>This graph of the evolution of htmx Github stars makes me immensely proud, because I feel like my work had an impact on my industry, which seems to have been making wrong decisions for almost a decade:</p>
<p><img loading="lazy" src="https://david.guillot.me/en/posts/tech/following-up-mother-of-all-htmx-demos/htmx-github-stars.png" alt="Evolution of htmx Github stars: it’s a continued growth but you can see a peak in the few days after the video of my talk has been published, and another one after ThePrimeagen published his." title="Credits to https://starchart.cc/"/>
</p>
<h3 id="impact-on-my-own-github-profile">Impact on my own Github profile</h3>
<p>Without me doing anything, my Github profile is now followed by hundreds of people.</p>
<ul>
<li>Makes me feel responsible, this is why I am so sorry for being so late in the publishing of this follow-up.</li>
<li>Also makes me feel proud, especially because many of my followers come from developing countries, where building a team may not be as easy as in EU or in the US. I hope that the hypermedia approach makes it easier for people in these countries to launch their SaaS products.</li>
</ul>
<h2 id="some-questions-or-statements-ive-read-and-would-like-to-answer-to">Some questions or statements I’ve read and would like to answer to</h2>
<h3 id="your-js-dev-must-have-been-a-terrible-js-dev">“Your JS dev must have been a terrible JS dev”</h3>
<p>I’m not interested in judging the guy. We had our issues, but I don’t see them as the primary cause of the failure that our front-end was.</p>
<p>He was constantly running after two things:</p>
<ul>
<li>The Javascript ecosystem (breaking changes, security updates, new approaches, new silver-bullet promises…). A vibrant ecosystem is nice, but it can also be overwhelming.</li>
<li>The complexity of client-side application state management when the single source of truth about application state is the server.</li>
</ul>
<p>That did not let him enough time and energy to focus on what really matters on the front-end side when you’re building a B2B SaaS product: the UX.</p>
<p>Maybe some more talented developer would have done it better. But exceptional talent has an exceptional cost, and that Contexte could not afford. And would the resulting implementation have been more efficient than the one I made with htmx? Not sure.</p>
<h3 id="you-must-hate-javascript">“You must hate Javascript”</h3>
<p><em>(Oh boy I’ve seen that one a lot)</em></p>
<p>Of course not, who would hate it? Javascript is the only programming language available on the client side of the web platform, and it’s getting better and better every year! I use it whenever I need pure client-side interactions, as “the right tool for the job”.</p>
<p><strong>I do not make UX trade-offs in order to avoid using Javascript</strong>. I did not engage the React-to-htmx migration to avoid writing Javascript code, I did it to enhance our UX while reducing our overall costs.</p>
<h3 id="with-a-server-framework-like-django-css-and-js-are-probably-second-class-citizens-of-your-codebase-and-your-js-is-probably-written-like-old-jquery-plugins">“With a server framework like Django, CSS and JS are probably second-class citizens of your codebase, and your JS is probably written like old jQuery plugins”</h3>
<p>The “front-end” ecosystem worked really hard these past years on improving tooling, why would anyone refuse to take advantage of that?</p>
<ul>
<li>The Javascript parts (mainly <a href="https://stimulus.hotwired.dev/" target="_blank">Stimulus</a>
 controllers), are written as ES6, with nice <code>import</code> statements, etc. It may not be the latest trend, but it’s modern, efficient and testable.</li>
<li>The Javascript dependencies are declared in a <code>package.json</code> file in order to easily manage updates through something like <a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide" target="_blank">Dependabot</a>
, and avoid CDN usage.</li>
<li><a href="https://esbuild.github.io/" target="_blank">esbuild</a>
 takes care of transpiling the Javascript to something that works on every browser chosen by the team, and bundles the whole thing in a timely manner.</li>
<li>The CSS parts are written as SCSS, with nice variables, nesting and mixins.</li>
</ul>
<h4 id="but-how-does-that-integrate-with-django-and-its-old-fashioned-static-folder">“But how does that integrate with Django and its old-fashioned <code>static</code> folder?”</h4>
<p>Now that’s where the magic happens. The original idea came from <a href="https://github.com/timonweb/django-tailwind" target="_blank">Tim Kamanins django-tailwind integration</a>
: simply put the JS/CSS/SVG/PNG files in a <code>static_src/</code> folder of each Django app, then build them with esbuild using the <code>static/</code> folder of the corresponding Django app as the output folder.</p>
<p>So let’s say you have a web page where you want to use a <code>Dropdown</code> Stimulus controller which code lives in another Django app. Let’s look at how it’s done:</p>
<p>The controller, which is reusable for all our Django apps, lives in <code>ui/static_src/components/dropdown.js</code>:</p>
<div><pre tabindex="0"><code data-lang="js"><span><span><span>import</span> { <span>Controller</span> } <span>from</span> <span>&#34;@hotwired/stimulus&#34;</span>
</span></span><span><span>
</span></span><span><span><span>class</span> <span>Dropdown</span> <span>extends</span> <span>Controller</span> {
</span></span><span><span>...
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span><span>export</span> { <span>Dropdown</span> }
</span></span></code></pre></div><p>It’s exposed with other reusable components by <code>ui/static_src/components/index.js</code>:</p>
<div><pre tabindex="0"><code data-lang="js"><span><span>...
</span></span><span><span><span>export</span> <span>*</span> <span>from</span> <span>&#34;./dropdown&#34;</span>
</span></span><span><span>...
</span></span></code></pre></div><p>Now in another Django app, you have a JS file dedicated to some specific page, <code>myapp/static_src/myapp/mypage/main.js</code>:</p>
<div><pre tabindex="0"><code data-lang="js"><span><span><span>import</span> { <span>Application</span> } <span>from</span> <span>&#34;@hotwired/stimulus&#34;</span>
</span></span><span><span>
</span></span><span><span><span>import</span> { <span>Dropdown</span> } <span>from</span> <span>&#34;../../../../ui/static_src/ui/components&#34;</span>
</span></span><span><span>
</span></span><span><span>window.<span>stimulusApp</span> <span>=</span> <span>Application</span>.<span>start</span>()
</span></span><span><span><span>stimulusApp</span>.<span>register</span>(<span>&#34;dropdown&#34;</span>, <span>Dropdown</span>)
</span></span></code></pre></div><p>It’s modern ES6, it compiles crazily fast with esbuild, and the result goes to <code>myapp/static/myapp/mypage/main.js</code>.</p>
<p>Of course, since the compiled JS files live in <code>static/</code> folder of each Django app:</p>
<ul>
<li>At dev time, you get nice auto-completion when using the native Django <code>{% static %}</code> template tag to refer to them</li>
<li>At commit time, you can avoid adding them to git with a simple <code>.gitignore</code></li>
<li>At build time, they are seen by Django native <code>collectstatic</code> management command</li>
<li>At deployment time, they take advantage of Django’s awesome <code>staticfiles.storage.ManifestStaticFilesStorage</code> to get filename-based cache-busting for free (cf. <a href="https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/#manifeststaticfilesstorage" target="_blank">docs</a>
)</li>
</ul>
<p>Now, can this be called “Old-school JS as second-class citizen”, or “Modern JS as a first-class citizen”? You tell me.</p>
<h3 id="what-about-locality-of-behavior-lob-why-stimulus-and-not-alpine-or-hyperscript">“What about Locality of Behavior (LoB)? Why Stimulus and not Alpine or Hyperscript?”</h3>
<p>Because:</p>
<ul>
<li>Both Hyperscript and Alpine make your HTML heavier (especially when implementing some sophisticated behavior that is replicated is multiple places), which is not good when HTML is sent over the wire.</li>
<li>Hyperscript means learning a new language, which has a cost.</li>
</ul>
<p>Stimulus, on the other hand, gives us nice standard ES6 code that’s easily auto-completed, linted, tested, reusable, etc. Writing Stimulus controllers is kind of always the same, almost boring, but it feels so safe. As for what LoB is supposed to bring (an immediate view on the code triggered by a function call or a user action), the right tooling can provide that: with the right plugin in your IDE, when you see <code>data-action=&#34;click-&gt;mycontroller#mymethod&#34;</code>, Ctrl+clicking <code>mycontroller</code> gets you to the right class in the right JS file, and Ctrl+clicking <code>mymethod</code> get you to the right method.</p>
<h3 id="why-not-tailwind">“Why not Tailwind?”</h3>
<p><em>(This is a bit off-topic but ThePrimagen mocked us <a href="https://youtu.be/wIzwyyHolRs?feature=shared&amp;t=1133" target="_blank">here</a>
, so I had to answer 😉)</em></p>
<p>Because:</p>
<ul>
<li>Tailwind makes the HTML your styling language, while it’s supposed to be your HyperText (some text with special ability like links/forms and, thanks to htmx, the same magic of links/forms applied to anything).</li>
<li>Tailwind makes your HTML heavier, which is not a good thing when HTML is sent over the wire.</li>
<li>Tailwind means learning a new language, which has a cost.</li>
<li>CSS is easier than 10 years ago.</li>
<li>Naming CSS classes isn’t horrible since <a href="https://getbem.com/" target="_blank">BEM</a>
, and is even quite nice since <a href="https://css-tricks.com/abem-useful-adaptation-bem/" target="_blank">A-BEM</a>
</li>
</ul>
<h3 id="why-not-a-global-event-bus">“Why not a global event bus?”</h3>
<p><em>(here again, ThePrimagen)</em></p>
<p>You know what’s a global event bus? <strong>Your browser</strong>. The Javascript standard Web API exposes a global event bus, and the Hypermedia approach is nothing more than leveraging this global event bus to update the server-side application state and make your web application react to application state changes.</p>
<h3 id="are-you-still-using-htmx-or-at-least-the-hypermedia-approach">“Are you still using htmx, or at least the hypermedia approach?”</h3>
<p>Yes.</p>
<p>To be completely honest, when it comes to the past 2 years at Contexte:</p>
<ul>
<li>We didn’t get to implement any new UI that would be more complex/interactive than what I demonstrated during the DjangoCon talk. Contexte is a media, and most of its web development consists of CRUD and advanced CSS, so <a href="https://htmx.org/essays/when-to-use-hypermedia/" target="_blank">the hypermedia approach (aka HTML over the wire, aka server-side templating) is very well suited</a>
.</li>
<li>Sometimes htmx has shown some caveats when trying to apply it to user-generated content where we wanted some links to be boosted but some others not. But with a few lines of Javascript we were able to achieve quite the same feature, so this doesn’t disqualify the hypermedia approach.</li>
<li>At some point Contexte needed to implement a custom real-time collaborative editor ; obviously this was one of these use cases where the hypermedia approach is not the right approach, so it has been implemented as a Vue app, and that story is told <a href="https://about.contexte.com/fr/notre-actualite/how-we-developed-a-custom-collaborative-editor-for-our-journalists" target="_blank">there</a>
.</li>
</ul>
<p>The point is: I would recommend it anytime, to any team that is working on a SaaS product with no intent of real-time collaboration or no client-side-first application state. Every day I use SaaS products that would benefit the Hypermedia approach, with lower latency, less bugs, smaller costs…</p>
<h3 id="but-what-if-i-need-a-mobile-app-whats-the-point-of-htmx-if-i-still-need-an-api-i-dont-want-to-have-2-back-ends">“But what if I need a mobile app? What’s the point of htmx if I still need an API? I don’t want to have 2 back-ends…”</h3>
<p>Many ways to answer that:</p>
<ul>
<li>Do you really need a mobile app? Wouldn’t a PWA do the trick? (I will probably talk about this in a separate post later…)</li>
<li>Do you really need an API for your mobile app? I haven’t tested <a href="https://hyperview.org/" target="_blank">Hyperview</a>
 yet, but since its creator wrote the <a href="https://hypermedia.systems/" target="_blank">hypermedia.systems</a>
 book with Carson Gross, I would give it a try…</li>
<li>Okay you do need a mobile app and you think it must be done the traditional way, with an API, then please be informed that:
<ul>
<li>Nowadays, implementing a JSON/HTTP API has a very low cost: <a href="https://www.django-rest-framework.org/" target="_blank">django-rest-framework</a>
, <a href="https://api-platform.com/" target="_blank">API-Platform</a>
, probably many others in any programming language used to serve dynamic content on the web, not to mention <a href="https://docs.postgrest.org/en/v12/" target="_blank">PostgREST</a>
. All these amazing technologies allow you to create an API in a declarative way.</li>
<li>That JSON/HTTP API would not consist of a separate back-end ; it would be implemented in the server-side framework you already have, and hosted on the web servers you already have. And as htmx has no cost at all, you would not pay for two different ways of serving contents to you web app and your mobile app.</li>
</ul>
</li>
</ul>


  </div></div>
  </body>
</html>
