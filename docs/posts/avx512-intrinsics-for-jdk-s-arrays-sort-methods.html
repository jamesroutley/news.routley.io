<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/openjdk/jdk/pull/14227">Original</a>
    <h1>AVX512 intrinsics for JDKâ€™s Arrays.sort methods</h1>
    
    <div id="readability-page-1" class="page"><div>
        <div>
  
  <task-lists disabled="" sortable="">
    <div>
      <p dir="auto">The goal is to develop faster sort routines for x86_64 CPUs by taking advantage of AVX512 instructions. This enhancement provides an order of magnitude speedup for Arrays.sort() using int, long, float and double arrays.</p>
<p dir="auto">This PR shows upto ~13x improvement for 32-bit datatypes (int, float) and upto 8x improvement for 64-bit datatypes (long, double) as shown in the performance data below.</p>
<p dir="auto"><strong>Arrays.sort performance data</strong></p>
<table role="table">
<thead>
<tr>
<th>Arrays.sort benchmark</th>
<th>Array Size</th>
<th>Baseline (us/op)</th>
<th>AVX512 Sort (us/op)</th>
<th>Speedup</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArraysSort.doubleSort</td>
<td>100</td>
<td>0.639</td>
<td>0.217</td>
<td>2.9x</td>
</tr>
<tr>
<td>ArraysSort.doubleSort</td>
<td>1000</td>
<td>8.707</td>
<td>3.421</td>
<td>2.5x</td>
</tr>
<tr>
<td>ArraysSort.doubleSort</td>
<td>10000</td>
<td>349.267</td>
<td>43.56</td>
<td><strong>8.0x</strong></td>
</tr>
<tr>
<td>ArraysSort.doubleSort</td>
<td>100000</td>
<td>4721.17</td>
<td>579.819</td>
<td><strong>8.1x</strong></td>
</tr>
<tr>
<td>ArraysSort.floatSort</td>
<td>100</td>
<td>0.722</td>
<td>0.129</td>
<td>5.6x</td>
</tr>
<tr>
<td>ArraysSort.floatSort</td>
<td>1000</td>
<td>9.1</td>
<td>2.356</td>
<td>3.9x</td>
</tr>
<tr>
<td>ArraysSort.floatSort</td>
<td>10000</td>
<td>336.472</td>
<td>26.706</td>
<td><strong>12.6x</strong></td>
</tr>
<tr>
<td>ArraysSort.floatSort</td>
<td>100000</td>
<td>4804.716</td>
<td>427.397</td>
<td><strong>11.2x</strong></td>
</tr>
<tr>
<td>ArraysSort.intSort</td>
<td>100</td>
<td>0.61</td>
<td>0.111</td>
<td>5.5x</td>
</tr>
<tr>
<td>ArraysSort.intSort</td>
<td>1000</td>
<td>8.534</td>
<td>2.025</td>
<td>4.2x</td>
</tr>
<tr>
<td>ArraysSort.intSort</td>
<td>10000</td>
<td>310.97</td>
<td>24.082</td>
<td><strong>12.9x</strong></td>
</tr>
<tr>
<td>ArraysSort.intSort</td>
<td>100000</td>
<td>4484.94</td>
<td>381.01</td>
<td><strong>11.8x</strong></td>
</tr>
<tr>
<td>ArraysSort.longSort</td>
<td>100</td>
<td>0.636</td>
<td>0.28</td>
<td>2.3x</td>
</tr>
<tr>
<td>ArraysSort.longSort</td>
<td>1000</td>
<td>8.646</td>
<td>4.425</td>
<td>2.0x</td>
</tr>
<tr>
<td>ArraysSort.longSort</td>
<td>10000</td>
<td>322.116</td>
<td>53.094</td>
<td><strong>6.1x</strong></td>
</tr>
<tr>
<td>ArraysSort.longSort</td>
<td>100000</td>
<td>4448.171</td>
<td>696.773</td>
<td><strong>6.4x</strong></td>
</tr>
</tbody>
</table>

<hr/>
<h3 dir="auto">Progress</h3>
<ul>
<li> Change must be properly reviewed (1 review required, with at least 1 <a href="https://openjdk.org/bylaws#reviewer" rel="nofollow">Reviewer</a>)</li>
<li> Change must not contain extraneous whitespace</li>
<li> Commit message must refer to an issue</li>
</ul>
<h3 dir="auto">Issue</h3>
<ul dir="auto">
<li><a href="https://bugs.openjdk.org/browse/JDK-8309130" rel="nofollow">JDK-8309130</a>: x86_64 AVX512 intrinsics for Arrays.sort methods (int, long, float and double arrays)</li>
</ul>
<h3 dir="auto">Reviewing</h3>
<details><summary>Using <code>git</code></summary>
<p dir="auto">Checkout this PR locally: </p>
<p dir="auto">Update a local copy of the PR: </p>
</details>
<details><summary>Using Skara CLI tools</summary>
<p dir="auto">Checkout this PR locally: </p>
<p dir="auto">View PR using the GUI difftool: </p>
</details>
<details><summary>Using diff file</summary>
<p dir="auto">Download this PR as a diff file: </p>
</details>
<h3 dir="auto">Webrev</h3>
<p dir="auto"><a href="https://git.openjdk.org/jdk/pull/14227#issuecomment-1568931001" rel="nofollow">Link to Webrev Comment</a></p>
    </div>
  </task-lists>
  
</div>

      </div></div>
  </body>
</html>
