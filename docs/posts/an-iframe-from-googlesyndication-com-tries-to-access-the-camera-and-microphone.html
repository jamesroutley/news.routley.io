<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://techsparx.com/software-development/security/csp-camera-microphone.html">Original</a>
    <h1>An iframe from googlesyndication.com tries to access the Camera and Microphone</h1>
    
    <div id="readability-page-1" class="page"><div>
        
      <nav aria-label="breadcrumb" id="breadcrumbTrail">
<ol>
 <li> <a href="https://techsparx.com/index.html">TechSparx</a> </li> <li> <a href="https://techsparx.com/software-development/index.html">Software Development</a> </li> <li> <a href="https://techsparx.com/software-development/security/index.html">Secure Software Development</a> </li> <li> <a href="https://techsparx.com/software-development/security/csp-camera-microphone.html">An iframe from googlesyndication.com tries to access the Camera and Microphone
</a> </li>
</ol>
</nav>
      <p><small>;
    Date: Tue Dec 14 2021

</small></p>
      <p>Tags: <span>
 <a href="https://techsparx.com/tags/content-security-policy.html">Content Security Policy</a>  »»»»  <a href="https://techsparx.com/tags/feature-policy.html">Feature Policy</a> 
</span></p>
      <p><strong>The last thing we want is for an advertising network to access the Camera or Microphone on our computer.  But, while looking for something else, I stumbled upon messages in the Safari JavaScript console saying that an iframe loaded from <em>safeframe.googlesyndication.com</em> tried to do exactly that.
</strong></p>

        
        
    <figure>
        
            <img src="https://techsparx.com/software-development/security/img/adverts-access-camera.jpg"/>
        
        
        
    </figure>


        
        

      <p>In case you&#39;re not aware, there is extreme alarm about the possibility that the web-camera or microphone built-in to laptops, smart phones, and the like, could be surreptitiously turned on.  What if Big Brother were to turn on the camera, without turning on the indicator light, and take pictures, or record audio from the built-in microphone?  There&#39;s a long list of possible nefarious results, and this has to be seen as a serious privacy intrusion.</p>
<p>There is no legitimate purpose for an advertising network to access either the camera or microphone.  But, going by the messages I found in the JavaScript console, that appears to be what an advertisement tried to do.</p>
<p>Trying to search for information on <em>googlesyndication connecting to camera or microphone</em> turns up results indicating that many believe <code>safeframe.googlesyndication.com</code> is some kind of malware or virus distribution server.  That&#39;s a strange assumption to make, considering the purpose for the <code>GoogleSyndication.com</code> domain.</p>
<p>Namely, that domain is affiliated with the Google Ads and Google Adsense advertising networks.  The purpose is delivering tailored marketing (advertisements) to people.  Whether you think this is malware, I suppose, depends on how you consider Google Ads or Google Adsense.</p>
<p>The <code>GoogleSyndication.com</code> domain is part of Google&#39;s legitimate ad serving service.  Given Google&#39;s policies around that service it is extremely unlikely for malware to be distributed through that particular service.</p>
<p>But... if that&#39;s the case, how can you explain these messages?</p>
<figure>
        
        <img src="https://techsparx.com/software-development/security/img/access-camera-microphone.jpg"/>
        
        
</figure>

<p>These messages appeared in the JavaScript console on Safari while browsing multiple pages on <code>techsparx.com</code>.  At first I saw it on one page, then checked other pages and got the same messages.  This site is using Ezoic&#39;s advertising system, which in turn uses Google Ad Manager for some advertising.</p>
<p>The messages are somewhat clear -- that an <code>&lt;iframe&gt;</code> loading stuff from <code>safeframe.googlesyndication.com</code> triggered a Feature Policy check.  Fortunately the policy checks for Camera and Microphone failed.  The same script, <code>talon-1.0.37.js</code>, also tried to enumerate (list) the available devices, which failed.</p>
<ul>
<li>URL: <code>https://cdn.js7k.com/ix/talon-1.0.37.js</code></li>
</ul>
<p>Fortunately the feature policy settings in Safari disallowed this.  I shudder what to think of what an advertiser would do after turning on the Camera or Microphone on my laptop.</p>
<h2>Browser settings to limit Camera or Microphone access</h2>
<p>In Google Chrome we can allow or disallow websites to access the Camera or Microphone.  To take a look at this, take your mouse to the upper-right-corner of the browser where there are three vertical dots.  This is the Chrome browser menu, and one of the choices is <em>Settings</em>.  In the Settings area, navigate to <em>Privacy and Security</em>, then to <em>Site Settings</em>.  There you&#39;ll find areas dedicated to Camera and Microphone, and in both areas you can set a default policy, and set which websites are allowed to access these devices.</p>
<p>In Firefox, open the Preferences dialog, then navigate to <em>Privacy &amp; Security</em>.  You&#39;ll find <em>Camera</em> and <em>Microphone</em> areas in which you can select websites that are allowed to access these devices.</p>
<p>In Safari, open the Preferences dialog, and navigate to Websites.  You&#39;ll find tabs for Camera and Microphone, each of which list domains that are allowed (or not) to access these devices.</p>
<figure>
        
        <img src="https://techsparx.com/software-development/security/img/safari-policies.jpg"/>
        
        
</figure>

<p>Notice that I have set one domain to <em>Deny</em>.  That&#39;s because the scripts in question came from that domain - <code>https://cdn.js7k.com/ix/talon-1.0.37.js</code>.</p>
<h2>What&#39;s blocking access is a Feature Policy</h2>
<p>It is incumbent for website publishers to provide a safe browsing experience to our visitors.  Modern web standards have at least two HTTP headers which affect security policies in the web browser.</p>
<ul>
<li>The <em>Content-Security-Policy</em> header lets the website inform the web browser from which domains it should allow content to be loaded.</li>
<li>The <em>Feature-Policy</em> header lets the website inform the possible browser features that will be needed.  This includes not just the Camera and Microphone but things like Accelerometers, Gyroscope, displaying in Fullscreen, and so forth.</li>
</ul>
<p>What blocked the Camera and Microphone access in this case was Feature Policy settings in Safari.</p>
<p>Apparently the <em>Feature-Policy</em> header is being renamed to <em>Permissions-Policy</em> by the standards committee.  For now, use <em>Feature-Policy</em>.</p>
<p>Both policy headers are set in the HTTP response headers sent by your web server.  If you are not able to set HTTP headers, you can use a header like this:</p>
<pre><code>&lt;meta <span>http-equiv</span>=<span>&#34;Content-Security-Policy&#34;</span> <span>content</span>=<span>&#34;default-src &#39;self&#39;&#34;</span>&gt;
</code></pre>
<p>This header is to be put in the <code>&lt;head&gt;&lt;/head&gt;</code> section.  The <code>&lt;meta http-equiv&gt;</code> tag is to be interpreted as if the corresponding HTTP header was set.</p>
<p>The 
               <img src="https://www.google.com/s2/favicons?domain=developer.mozilla.org" alt="(developer.mozilla.org)"/>
               <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Feature_Policy/Using_Feature_Policy" target="_blank">Mozilla Developer Network</a> has examples of using <em>Feature-Policy</em> in both HTTP headers and on <code>&lt;iframe&gt;</code> elements.  For <em>iframes</em>, the <code>allow=...</code> attribute sets the policy for it.</p>
<p>Unfortunately, the normal way Google Adsense and Google Ads advertising gets into a web page does not allow website publishers to control attributes on the <code>&lt;iframe&gt;</code>.</p>

      

      <div>
<h3>About the Author(s)</h3>

<p><a href="https://techsparx.com/about.html"><img src="https://techsparx.com/img/headshot-new.jpg"/></a>
<strong>
<a href="https://techsparx.com/about.html">David Herron</a>
</strong>: <span>
David Herron is a writer and software engineer focusing on the wise use of technology.  He is especially interested in clean energy technologies like solar power, wind power, and electric cars.  David worked for nearly 30 years in Silicon Valley on software ranging from electronic mail systems, to video streaming, to the Java programming language, and has published several books on Node.js programming and electric vehicles.
</span>

</p></div>

        
      
      <p><a href="https://click.linksynergy.com/fs-bin/click?id=PPTIpcZ17qI&amp;offerid=507388.1387&amp;subid=0&amp;type=4" rel="" target="_blank">
            <img src="https://techsparx.com/imgz/udemy/39197_1387.png"/>
            </a>
    </p>



      



    </div></div>
  </body>
</html>
