<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gist.github.com/simonw/35732f187edbe4fbd0bf976d013f22c8">Original</a>
    <h1>Claude Cowork runs Linux VM via Apple virtualization framework</h1>
    
    <div id="readability-page-1" class="page"><div>
  <div id="file-linux-container-environment-report-md">
      
      <div id="file-linux-container-environment-report-md-readme" tabindex="0" role="region" aria-label="linux-container-environment-report.md content, created by simonw on 11:17PM on January 12.">
    <article itemprop="text">
<p dir="auto"><strong>Generated:</strong> January 13, 2026
<strong>Session ID:</strong> brave-loving-maxwell</p>
<hr/>

<p dir="auto">This report details the Linux container environment powering the Claude AI assistant&#39;s &#34;Cowork mode.&#34; The environment is a lightweight, highly sandboxed Ubuntu 22.04 LTS virtual machine running on ARM64 architecture, designed to provide secure code execution capabilities while maintaining strict isolation from the host system.</p>
<hr/>


<ul dir="auto">
<li><strong>Distribution:</strong> Ubuntu 22.04.5 LTS (Jammy Jellyfish)</li>
<li><strong>Kernel:</strong> Linux 6.8.0-90-generic (PREEMPT_DYNAMIC)</li>
<li><strong>Architecture:</strong> aarch64 (ARM64)</li>
<li><strong>Hostname:</strong> claude</li>
</ul>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Resource</th>
<th>Specification</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>4 ARM64 cores @ 48 BogoMIPS each</td>
</tr>
<tr>
<td>RAM</td>
<td>3.8 GiB total, ~2.8 GiB available</td>
</tr>
<tr>
<td>Swap</td>
<td>None configured</td>
</tr>
<tr>
<td>Root Disk</td>
<td>10 GB NVMe (nvme0n1)</td>
</tr>
<tr>
<td>Session Disk</td>
<td>10 GB NVMe (nvme1n1)</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">The ARM64 processor includes advanced features such as hardware cryptographic acceleration (AES, SHA1, SHA2, SHA3, SHA512), atomic operations, pointer authentication (PACA/PACG), and branch target identification (BTI) for security.</p>
<hr/>

<div dir="auto"><h3 dir="auto">Bubblewrap (bwrap) Isolation</h3><a id="user-content-bubblewrap-bwrap-isolation" aria-label="Permalink: Bubblewrap (bwrap) Isolation" href="#bubblewrap-bwrap-isolation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The container uses <strong>Bubblewrap</strong> as its primary sandboxing mechanism. Key isolation features include:</p>
<ul dir="auto">
<li><strong>Network Isolation:</strong> <code>--unshare-net</code> creates a separate network namespace</li>
<li><strong>PID Isolation:</strong> <code>--unshare-pid</code> provides process namespace isolation</li>
<li><strong>Die-with-parent:</strong> Container terminates when parent process exits</li>
<li><strong>New Session:</strong> Prevents terminal hijacking attacks</li>
</ul>

<p dir="auto">The environment employs strict seccomp (Secure Computing Mode) filtering:</p>
<ul dir="auto">
<li><strong>Seccomp Mode:</strong> 2 (filter mode)</li>
<li><strong>Active Filters:</strong> 2 seccomp filters applied</li>
<li><strong>NoNewPrivs:</strong> Enabled (prevents privilege escalation)</li>
<li><strong>Capabilities:</strong> All capabilities dropped (CapEff = 0)</li>
</ul>
<p dir="auto">A custom BPF (Berkeley Packet Filter) program at <code>/usr/local/lib/node_modules_global/lib/node_modules/@anthropic-ai/sandbox-runtime/vendor/seccomp/arm64/unix-block.bpf</code> enforces syscall restrictions.</p>
<div dir="auto"><h3 dir="auto">Network Proxy Architecture</h3><a id="user-content-network-proxy-architecture" aria-label="Permalink: Network Proxy Architecture" href="#network-proxy-architecture"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">All network traffic is proxied through local tunnels:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Protocol</th>
<th>Proxy</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP/HTTPS</td>
<td><code>http://localhost:3128</code></td>
</tr>
<tr>
<td>SOCKS5</td>
<td><code>socks5h://localhost:1080</code></td>
</tr>
<tr>
<td>FTP/GRPC</td>
<td><code>socks5h://localhost:1080</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><strong>socat</strong> processes forward traffic through Unix sockets to the host:</p>
<ul dir="auto">
<li>HTTP: <code>/tmp/claude-http-*.sock</code></li>
<li>SOCKS: <code>/tmp/claude-socks-*.sock</code></li>
</ul>
<hr/>


<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Device</th>
<th>Mount Point</th>
<th>Size</th>
<th>Usage</th>
<th>Filesystem</th>
</tr>
</thead>
<tbody>
<tr>
<td>nvme0n1p1</td>
<td>/</td>
<td>9.6G</td>
<td>75%</td>
<td>ext4</td>
</tr>
<tr>
<td>nvme0n1p15</td>
<td>/boot/efi</td>
<td>98M</td>
<td>7%</td>
<td>vfat</td>
</tr>
<tr>
<td>nvme1n1</td>
<td>/sessions</td>
<td>10G</td>
<td>&lt;1%</td>
<td>ext4</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div dir="auto"><h3 dir="auto">Session Directory Structure</h3><a id="user-content-session-directory-structure" aria-label="Permalink: Session Directory Structure" href="#session-directory-structure"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>/sessions/brave-loving-maxwell/
├── .bash_logout
├── .bashrc
├── .profile
├── mnt/
│   ├── .claude/          # Claude configuration
│   ├── .skills/          # Available skill modules
│   │   └── skills/
│   │       ├── algorithmic-art/
│   │       ├── canvas-design/
│   │       ├── docx/
│   │       ├── pdf/
│   │       ├── pptx/
│   │       ├── skill-creator/
│   │       └── xlsx/
│   ├── outputs/          # User-accessible output directory
│   └── uploads/          # User file uploads
└── tmp/                  # Temporary files
</code></pre>

<p dir="auto">Several directories use <strong>bindfs</strong> to map host filesystem locations with controlled permissions:</p>
<ul dir="auto">
<li><code>/sessions/brave-loving-maxwell/mnt/.skills</code> (927G available - host disk)</li>
<li><code>/sessions/brave-loving-maxwell/mnt/outputs</code> (user&#39;s workspace folder)</li>
<li><code>/sessions/brave-loving-maxwell/mnt/uploads</code> (uploaded files)</li>
<li><code>/sessions/brave-loving-maxwell/mnt/.claude</code> (configuration)</li>
</ul>
<hr/>


<p dir="auto">The environment includes approximately <strong>1,201 packages</strong>. Key development tools:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Tool</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>3.10.12</td>
</tr>
<tr>
<td>Node.js</td>
<td>22.21.0</td>
</tr>
<tr>
<td>npm</td>
<td>10.9.4</td>
</tr>
<tr>
<td>pip</td>
<td>22.0.2</td>
</tr>
<tr>
<td>GCC</td>
<td>11.4.0</td>
</tr>
<tr>
<td>Java (OpenJDK)</td>
<td>11.0.29</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><strong>Note:</strong> Go, Rust, and Docker are not available in this environment.</p>

<ul dir="auto">
<li>core20 (versions 2683, 2690)</li>
<li>lxd (version 36562)</li>
<li>snapd (versions 25585, 25939)</li>
</ul>
<hr/>


<markdown-accessiblity-table><table>
<thead>
<tr>
<th>PID</th>
<th>Process</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>bwrap</td>
<td>Bubblewrap sandbox orchestrator</td>
</tr>
<tr>
<td>2</td>
<td>bash</td>
<td>Shell wrapper managing proxy daemons</td>
</tr>
<tr>
<td>3</td>
<td>socat</td>
<td>HTTP proxy forwarder (port 3128)</td>
</tr>
<tr>
<td>4</td>
<td>socat</td>
<td>SOCKS proxy forwarder (port 1080)</td>
</tr>
<tr>
<td>5</td>
<td>claude</td>
<td>Main Claude Code agent process</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">The main Claude process runs with the <code>claude-opus-4-5-20251101</code> model and has access to specific allowed tools: Task, Bash, Glob, Grep, Read, Edit, Write, and more.</p>
<div dir="auto"><h3 dir="auto">MCP (Model Context Protocol) Servers</h3><a id="user-content-mcp-model-context-protocol-servers" aria-label="Permalink: MCP (Model Context Protocol) Servers" href="#mcp-model-context-protocol-servers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Two MCP servers are configured:</p>
<ol dir="auto">
<li><strong>Claude in Chrome</strong> - Browser automation capabilities</li>
<li><strong>b89c1e3a-f5c6-4dec-9d8a-0b3db0a78353</strong> - Cloudflare integration</li>
</ol>
<hr/>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Limit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Open Files</td>
<td>524,288</td>
</tr>
<tr>
<td>Max User Processes</td>
<td>14,813</td>
</tr>
<tr>
<td>Stack Size</td>
<td>8 MB</td>
</tr>
<tr>
<td>Max Locked Memory</td>
<td>8 MB</td>
</tr>
<tr>
<td>CPU Time</td>
<td>Unlimited</td>
</tr>
<tr>
<td>Virtual Memory</td>
<td>Unlimited</td>
</tr>
<tr>
<td>File Size</td>
<td>Unlimited</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>


<ul dir="auto">
<li><strong>Username:</strong> brave-loving-maxwell</li>
<li><strong>UID/GID:</strong> 1002:1002</li>
<li><strong>Home:</strong> /sessions/brave-loving-maxwell</li>
<li><strong>Shell:</strong> /bin/bash</li>
</ul>

<ul dir="auto">
<li>User runs with zero capabilities</li>
<li>NoNewPrivs flag prevents privilege escalation</li>
<li>Seccomp filters restrict available syscalls</li>
<li>Network access only via controlled proxies</li>
</ul>
<hr/>


<ol dir="auto">
<li><strong>Multi-layer Isolation:</strong> Combines namespace isolation, seccomp filtering, and capability dropping</li>
<li><strong>Network Control:</strong> All traffic proxied and monitorable</li>
<li><strong>Ephemeral Sessions:</strong> Filesystem resets between tasks (except workspace folder)</li>
<li><strong>No Root Access:</strong> User has no elevated privileges</li>
<li><strong>Die-with-parent:</strong> Ensures cleanup on session termination</li>
</ol>

<pre><code>┌─────────────────────────────────────────────────────────┐
│                     Host System                          │
│  ┌───────────────────────────────────────────────────┐  │
│  │              Bubblewrap Sandbox                    │  │
│  │  ┌─────────────────────────────────────────────┐  │  │
│  │  │            Ubuntu 22.04 VM                   │  │  │
│  │  │  ┌────────────────────────────────────────┐ │  │  │
│  │  │  │         Claude Code Agent              │ │  │  │
│  │  │  │  - Opus 4.5 Model                      │ │  │  │
│  │  │  │  - Tool Access (Bash, Read, Write...)  │ │  │  │
│  │  │  └────────────────────────────────────────┘ │  │  │
│  │  │                     │                        │  │  │
│  │  │  ┌─────────┐   ┌────┴────┐   ┌───────────┐  │  │  │
│  │  │  │ socat   │   │ socat   │   │ Session   │  │  │  │
│  │  │  │ :3128   │   │ :1080   │   │ Storage   │  │  │  │
│  │  │  └────┬────┘   └────┬────┘   └───────────┘  │  │  │
│  │  └───────┼─────────────┼───────────────────────┘  │  │
│  └──────────┼─────────────┼──────────────────────────┘  │
│             │             │                              │
│      Unix Socket    Unix Socket                          │
│             │             │                              │
│         HTTP Proxy    SOCKS Proxy                        │
└─────────────────────────────────────────────────────────┘
</code></pre>
<hr/>

<p dir="auto">This container environment represents a thoughtfully designed sandbox for AI-assisted computing. It balances functionality (full development toolchain, file manipulation, network access) with security (strict isolation, capability dropping, traffic monitoring). The ephemeral nature of the session filesystem combined with persistent workspace folders provides both safety and utility for end users.</p>
<p dir="auto">The environment is specifically optimized for the Claude Code agent, providing the tools necessary for code execution, file creation, and web access while maintaining strong isolation boundaries to protect both the user&#39;s system and the broader infrastructure.</p>
</article>
  </div>

  </div>
</div></div>
  </body>
</html>
