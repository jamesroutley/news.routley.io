<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/devrim/cloudflare-noip">Original</a>
    <h1>Free DDNS with Cloudflare and a Cronjob</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">This project provides a free alternative to paid dynamic DNS services like NoIP.com. It allows you to update your DNS records on Cloudflare automatically using a free Cloudflare account and a cronjob on your computer.</p>

<ol dir="auto">
<li>
<p dir="auto">Clone this repository to your local machine.</p>
</li>
<li>
<p dir="auto">Create a <code>keys.json</code> file in the <code>~/.cloudflare-noip/</code> directory with the following structure:</p>
</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="{
    &#34;api_key&#34;: &#34;your_cloudflare_api_key&#34;,
    &#34;email&#34;: &#34;your_cloudflare_email&#34;,
    &#34;zone_id&#34;: &#34;your_cloudflare_zone_id&#34;
}"><pre>{
    <span>&#34;api_key&#34;</span>: <span><span>&#34;</span>your_cloudflare_api_key<span>&#34;</span></span>,
    <span>&#34;email&#34;</span>: <span><span>&#34;</span>your_cloudflare_email<span>&#34;</span></span>,
    <span>&#34;zone_id&#34;</span>: <span><span>&#34;</span>your_cloudflare_zone_id<span>&#34;</span></span>
}</pre></div>
<p dir="auto">To get your Cloudflare API key and zone ID:</p>
<ul dir="auto">
<li>Log in to your Cloudflare account and go to the &#34;My Profile&#34; section.</li>
<li>Click on &#34;API Tokens&#34; and create a new token with the &#34;Zone&#34; permission.</li>
<li>Copy the API key and zone ID from the token details.</li>
</ul>
<ol start="3" dir="auto">
<li>Create a <code>records.json</code> file in the <code>~/.cloudflare-noip/</code> directory with the following structure:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="[
	{
        &#34;record_name&#34;: &#34;sub.domain.xyz&#34;,
        &#34;record_type&#34;: &#34;A&#34;,
        &#34;proxied&#34;: true
	},
	{
	...
	}
]"><pre>[
	{
        <span>&#34;record_name&#34;</span>: <span><span>&#34;</span>sub.domain.xyz<span>&#34;</span></span>,
        <span>&#34;record_type&#34;</span>: <span><span>&#34;</span>A<span>&#34;</span></span>,
        <span>&#34;proxied&#34;</span>: <span>true</span>
	},
	{
	<span>...</span>
	}
]</pre></div>
<p dir="auto">The <code>content</code> field will be automatically updated with the IP address of the machine running the script.</p>
<ol start="4" dir="auto">
<li>Set up a cronjob to run the script at the desired interval. Here are examples for Ubuntu, macOS, and Windows:</li>
</ol>
<p dir="auto"><strong>Ubuntu/Debian:</strong></p>

<p dir="auto">Add the following line to run the script every 5 minutes:</p>
<div dir="auto" data-snippet-clipboard-copy-content="*/60 * * * * cd /path/to/cloudflare-noip &amp;&amp; /usr/bin/python3 main.py"><pre><span>*</span>/60 <span>*</span> <span>*</span> <span>*</span> <span>*</span> <span>cd</span> /path/to/cloudflare-noip <span>&amp;&amp;</span> /usr/bin/python3 main.py</pre></div>
<p dir="auto">restart cronjobs</p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo systemctl restart cron"><pre>sudo systemctl restart cron</pre></div>
<p dir="auto"><strong>macOS (using launchd):</strong></p>
<ol dir="auto">
<li>Create a new file in <code>~/Library/LaunchAgents/</code> called <code>com.example.cloudflare-noip.plist</code> with the following contents:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;!DOCTYPE plist PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt;
&lt;plist version=&#34;1.0&#34;&gt;
&lt;dict&gt;
	&lt;key&gt;Label&lt;/key&gt;
	&lt;string&gt;com.example.cloudflare-noip&lt;/string&gt;
	&lt;key&gt;ProgramArguments&lt;/key&gt;
	&lt;array&gt;
		&lt;string&gt;/usr/bin/python3&lt;/string&gt;
		&lt;string&gt;/Users/d/Projects/cloudflare-noip/main.py&lt;/string&gt;
	&lt;/array&gt;
	&lt;key&gt;StartInterval&lt;/key&gt;
	&lt;integer&gt;10&lt;/integer&gt;
&lt;/dict&gt;
&lt;/plist&gt;"><pre>&lt;?<span>xml</span><span> version</span>=<span><span>&#34;</span>1.0<span>&#34;</span></span><span> encoding</span>=<span><span>&#34;</span>UTF-8<span>&#34;</span></span>?&gt;
&lt;!<span>DOCTYPE</span> <span>plist</span> PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt;
&lt;<span>plist</span> <span>version</span>=<span><span>&#34;</span>1.0<span>&#34;</span></span>&gt;
&lt;<span>dict</span>&gt;
	&lt;<span>key</span>&gt;Label&lt;/<span>key</span>&gt;
	&lt;<span>string</span>&gt;com.example.cloudflare-noip&lt;/<span>string</span>&gt;
	&lt;<span>key</span>&gt;ProgramArguments&lt;/<span>key</span>&gt;
	&lt;<span>array</span>&gt;
		&lt;<span>string</span>&gt;/usr/bin/python3&lt;/<span>string</span>&gt;
		&lt;<span>string</span>&gt;/Users/d/Projects/cloudflare-noip/main.py&lt;/<span>string</span>&gt;
	&lt;/<span>array</span>&gt;
	&lt;<span>key</span>&gt;StartInterval&lt;/<span>key</span>&gt;
	&lt;<span>integer</span>&gt;10&lt;/<span>integer</span>&gt;
&lt;/<span>dict</span>&gt;
&lt;/<span>plist</span>&gt;</pre></div>
<ol start="2" dir="auto">
<li>Load the launch agent:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="launchctl load ~/Library/LaunchAgents/com.example.cloudflare-noip.plist"><pre>launchctl load <span>~</span>/Library/LaunchAgents/com.example.cloudflare-noip.plist</pre></div>
<p dir="auto"><strong>Windows (using Task Scheduler):</strong></p>
<ol dir="auto">
<li>Open the Task Scheduler: Press the Windows key + R, type <code>taskschd.msc</code>, and press Enter.</li>
<li>Create a new task:
<ul dir="auto">
<li>General: Give the task a name and description.</li>
<li>Triggers: Create a new trigger with the desired interval (e.g., every 5 minutes).</li>
<li>Actions: Create a new action to start a program: <code>python.exe</code> with the argument <code>/path/to/cloudflare_noip.py</code>.</li>
<li>Conditions: Set any additional conditions as needed.</li>
</ul>
</li>
<li>Save the task.</li>
</ol>
<p dir="auto">The script will update the DNS records on Cloudflare with the current IP address of the machine running the script at the specified interval.</p>
</article></div></div>
  </body>
</html>
