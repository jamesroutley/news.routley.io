<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.npmjs.com/package/@imgly/background-removal-node">Original</a>
    <h1>Show HN: Open-source background removal in Node.js</h1>
    
    <div id="readability-page-1" class="page"><div><article><div id="readme">
<p>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2702bd345ccd46505878ca2a6fdde53d9ad8cbc86fb027b20f8e203ad036da83/68747470733a2f2f696d672e6c792f73686f7763617365732f636573646b2f7765622f732f636173652d7468756d626e61696c2f6261636b67726f756e642d72656d6f76616c2f6261636b67726f756e642d72656d6f76616c2d302e706e673f75746d5f736f757263653d6769746875622675746d5f6d656469756d3d70726f6a6563742675746d5f63616d706169676e3d62672d72656d6f76616c"><img src="https://camo.githubusercontent.com/2702bd345ccd46505878ca2a6fdde53d9ad8cbc86fb027b20f8e203ad036da83/68747470733a2f2f696d672e6c792f73686f7763617365732f636573646b2f7765622f732f636173652d7468756d626e61696c2f6261636b67726f756e642d72656d6f76616c2f6261636b67726f756e642d72656d6f76616c2d302e706e673f75746d5f736f757263653d6769746875622675746d5f6d656469756d3d70726f6a6563742675746d5f63616d706169676e3d62672d72656d6f76616c" alt="background removal js showcase" data-canonical-src="https://img.ly/showcases/cesdk/web/s/case-thumbnail/background-removal/background-removal-0.png?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal"/></a>
</p>
<p>Remove backgrounds from images in NodeJs environment with ease and no additional costs or privacy concerns.
Explore an <a href="https://img.ly/showcases/cesdk/web/background-removal/web?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal" rel="nofollow">interactive demo</a>.</p>
<h2 id="user-content-news"><a href="#news">News<span aria-hidden="true"></span></a></h2>
<ul>
<li>
<strong><code>September 12th, 2023</code>:</strong> We released the code of Background Removal NodeJS.</li>
</ul>
<h2 id="user-content-overview"><a href="#overview">Overview<span aria-hidden="true"></span></a></h2>
<p><code>@imgly/background-removal-node-node</code> is a powerful npm package that allows developers to seamlessly remove the background from images in NodeJs. With its unique features and capabilities, this package offers an innovative and cost-effective solution for background removal tasks without compromising data privacy.</p>
<p>The key features of <code>@imgly/background-removal-node-node</code> are:</p>
<ul>
<li>
<strong>Seamless Integration with IMG.LY&#39;s CE.SDK</strong>: <code>@imgly/background-removal-node</code> provides seamless integration with <a href="https://img.ly/products/creative-sdk?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal" rel="nofollow">IMG.LY&#39;s CE.SDK</a>, allowing developers to easily incorporate powerful NodeJS image matting and background removal capabilities into their projects.</li>
</ul>
<p>The Neural Network (<a href="https://onnx.ai/" rel="nofollow">ONNX model</a>) are hosted on <a href="https://www.unpkg.com/" rel="nofollow">UNPKG</a>, making it readily available for download to all users of the library. See the section Custom Asset Serving if you want to host data on your own servers.</p>
<h2 id="user-content-installation"><a href="#installation">Installation<span aria-hidden="true"></span></a></h2>
<p>You can install <code>@imgly/background-removal-node</code> via npm or yarn. Use the following commands to install the package:</p>
<h3 id="user-content-npm"><a href="#npm">NPM<span aria-hidden="true"></span></a></h3>
<div><pre>npm install @imgly/background-removal-node</pre></div>
<h2 id="user-content-usage"><a href="#usage">Usage<span aria-hidden="true"></span></a></h2>
<div><pre><span>import</span> <span>{</span><span>removeBackground</span><span>}</span> <span>from</span> <span>&#34;@imgly/background-removal-node&#34;</span><span>;</span>
<span>// const {removeBackground} = require(&#34;@imgly/background-removal-node&#34;);</span>

<span>let</span> <span>image_src</span>: <span>ImageData</span> <span>|</span> <span>ArrayBuffer</span> <span>|</span> <span>Uint8Array</span> <span>|</span> <span>Blob</span> <span>|</span> <span>URL</span> <span>|</span> <span>string</span> <span>=</span> ...<span>;</span>

<span>removeBackground</span><span>(</span><span>image_src</span><span>)</span><span>.</span><span>then</span><span>(</span><span>(</span><span>blob</span>: <span>Blob</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// The result is a blob encoded as PNG. It can be converted to an URL to be used as HTMLImage.src</span>
<span>}</span><span>)</span></pre></div>
<p>Note: On the first run the wasm and onnx model files are fetched. This might, depending on the bandwidth, take time. Therefore, the first run takes proportionally longer than each consecutive run. Also, all files are cached by the browser and an additional model cache.</p>
<h2 id="user-content-advanced-configuration"><a href="#advanced-configuration">Advanced Configuration<span aria-hidden="true"></span></a></h2>
<p>The library does not need any configuration to get started. However, there are optional parameters that influence the behaviour and give more control over the library.</p>
<div><pre><span>type</span> <span>Config</span> <span>=</span> <span>{</span>
  <span>publicPath</span>: <span>string</span><span>;</span> <span>// The public path used for model a</span>
  <span>debug</span>: <span>bool</span><span>;</span> <span>// enable or disable useful console.log outputs</span>
  <span>model</span>: <span>&#39;small&#39;</span> <span>|</span> <span>&#39;medium&#39;</span><span>;</span> <span>// The model to use. (Default &#34;medium&#34;)</span>
<span>}</span><span>;</span></pre></div>
<h3 id="user-content-download-size-vs-quality"><a href="#download-size-vs-quality">Download Size vs Quality<span aria-hidden="true"></span></a></h3>
<p>The onnx model is shipped in various sizes and needs.</p>
<ul>
<li>small (~40 MB) is the smallest model and is in most cases working fine but sometimes shows some artifacts. It&#39;s a quantized model.</li>
<li>medium (~80MB) is the default model.</li>
</ul>
<h3 id="user-content-download-progress-monitoring"><a href="#download-progress-monitoring">Download Progress Monitoring<span aria-hidden="true"></span></a></h3>
<p>On the first run, the necessary data will be fetched and stored in the browser cache. Since the download might take some time, you have the option to tap into the download progress.</p>
<div><pre><span>let</span> <span>config</span>: <span>Config</span> <span>=</span> <span>{</span>
  <span>progress</span>: <span>(</span><span>key</span><span>,</span> <span>current</span><span>,</span> <span>total</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>`Downloading <span><span>${</span><span>key</span><span>}</span></span>: <span><span>${</span><span>current</span><span>}</span></span> of <span><span>${</span><span>total</span><span>}</span></span>`</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span><span>;</span></pre></div>
<h3 id="user-content-custom-asset-serving"><a href="#custom-asset-serving">Custom Asset Serving<span aria-hidden="true"></span></a></h3>
<p>Currently, the wasm and onnx neural networks are served via unpkg. For production use, we advise you to host them yourself. Therefore, copy all .wasm and .onnx files to your public path <code>$PUBLIC_PATH</code> and reconfigure the library.</p>
<div><pre>cp node_modules/@imgly/background-removal-node/dist/<span>*</span>.<span>*</span> <span>$PUBLIC_PATH</span></pre></div>
<div><pre><span>import</span> <span>{</span> <span>removeBackground</span><span>,</span> <span>Config</span><span>}</span> <span>from</span> <span>&#34;@imgly/background-removal-node&#34;</span>

<span>const</span> <span>public_path</span> <span>=</span> <span>&#34;file://${ASSET_PATH}&#34;</span> <span>;</span> <span>// the path on the local file system</span>

<span>//const public_path = &#34;https://example.com/assets/&#34; ; // the path assets are served from</span>

<span>let</span> <span>config</span>: <span>Config</span> <span>=</span>  <span>{</span>
  <span>publicPath</span>: <span>public_path</span><span>,</span> <span>// path to the wasm files</span>
<span>}</span><span>;</span>

<span>let</span> <span>image_src</span>: <span>Buffer</span> <span>|</span> <span>ArrayBuffer</span> <span>|</span> <span>Uint8Array</span> <span>|</span> <span>Blob</span> <span>|</span> <span>URL</span> <span>|</span> <span>string</span> <span>=</span> ...<span>;</span>

<span>removeBackground</span><span>(</span><span>image_src</span><span>,</span> <span>config</span><span>)</span><span>.</span><span>then</span><span>(</span><span>(</span><span>blob</span>: <span>Blob</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// result is a blob encoded as PNG.</span>
  <span>// It can be converted to an URL to be used as HTMLImage.src</span>
  <span>const</span> <span>url</span> <span>=</span> <span>URL</span><span>.</span><span>createObjectURL</span><span>(</span><span>blob</span><span>)</span><span>;</span>
<span>}</span><span>)</span></pre></div>
<h3 id="user-content-debug-outputs"><a href="#debug-outputs">Debug Outputs<span aria-hidden="true"></span></a></h3>
<p>Enable debug outputs and logging to the console</p>
<div><pre><span>let</span> <span>config</span>: <span>Config</span> <span>=</span> <span>{</span>
  <span>debug</span>: <span>true</span>
<span>}</span><span>;</span></pre></div>
<h3 id="user-content-cross-origin-resource-sharing-cors"><a href="#cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)<span aria-hidden="true"></span></a></h3>
<p>If you are running into CORS issues you might want to pass additional parameters to the fetch function via</p>
<div><pre><span>let</span> <span>config</span>: <span>Config</span> <span>=</span> <span>{</span>
  <span>fetchArgs</span>: <span>{</span>
    <span>mode</span>: <span>&#39;no-cors&#39;</span>
  <span>}</span>
<span>}</span><span>;</span></pre></div>
<p><code>fetchArgs</code> are passed as second parameters to the fetch function as described in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="nofollow">MDN</a>.</p>
<h2 id="user-content-who-is-it-for"><a href="#who-is-it-for">Who is it for?<span aria-hidden="true"></span></a></h2>
<p><code>@imgly/background-removal-node</code> is ideal for developers and projects that require efficient and cost-effective background removal directly in the browser. It caters to a wide range of use cases, including but not limited to:</p>
<ul>
<li>
<p><em>E-commerce applications</em> that need to remove backgrounds from product images in real time.</p>
</li>
<li>
<p><em>Image editing applications</em> that require background removal capabilities for enhancing user experience.</p>
</li>
<li>
<p><em>Web-based graphic design tools</em> that aim to simplify the creative process with in-browser background removal.</p>
</li>
</ul>
<p>Whether you are a professional developer or a hobbyist, <code>@imgly/background-removal-node</code> empowers you to deliver impressive applications and services with ease.</p>
<h2 id="user-content-license"><a href="#license">License<span aria-hidden="true"></span></a></h2>
<p>The software is free for use under the GPL License. Please contact <a href="mailto:support@img.ly?subject=Background-Removal-Node%20License">support@img.ly</a> for questions about other licensing options.</p>

<p>This library is made by IMG.LY shipping the world&#39;s premier SDKs for building creative applications.
Start your trial of the <a href="https://img.ly/products/creative-sdk?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal-node" rel="nofollow">CreativeEditor SDK</a>, <a href="https://img.ly/products/photo-sdk?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal-node" rel="nofollow">PhotoEditor SDK</a> &amp; <a href="https://img.ly/products/video-sdk?utm_source=github&amp;utm_medium=project&amp;utm_campaign=bg-removal-node" rel="nofollow">VideoEditor SDK</a>.</p>
</div></article></div></div>
  </body>
</html>
