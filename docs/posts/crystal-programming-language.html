<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://crystal-lang.org/">Original</a>
    <h1>Crystal Programming Language</h1>
    
    <div id="readability-page-1" class="page"><div>
  <nav role="navigation">
  
</nav>


  

<main>
  

<div>
  

  <hr/>

  <div>
    <div>
      <h2>Syntax</h2>
      <p>Crystal’s syntax is heavily inspired by Ruby’s, so it feels natural to read and easy to write, and has the
        added benefit of a lower learning curve for experienced Ruby devs.</p>
      <div>
        <figure><pre><code data-lang="crystal"><span># A very basic HTTP server</span>
<span>require</span> <span>&#34;http/server&#34;</span>

<span>server</span> <span>=</span> <span>HTTP</span><span>::</span><span>Server</span><span>.</span><span>new</span> <span>do</span> <span>|</span><span>context</span><span>|</span>
  <span>context</span><span>.</span><span>response</span><span>.</span><span>content_type</span> <span>=</span> <span>&#34;text/plain&#34;</span>
  <span>context</span><span>.</span><span>response</span><span>.</span><span>print</span> <span>&#34;Hello world, got </span><span>#{</span><span>context</span><span>.</span><span>request</span><span>.</span><span>path</span><span>}</span><span>!&#34;</span>
<span>end</span>

<span>puts</span> <span>&#34;Listening on http://127.0.0.1:8080&#34;</span>
<span>server</span><span>.</span><span>listen</span><span>(</span><span>8080</span><span>)</span></code></pre></figure>

      </div>
      <p><a href="https://crystal-lang.org/reference/getting_started/">Start learning Crystal with the Language
          Reference</a></p>
    </div>
  </div>

  <div>
    <div>
      <h2>Type system</h2>
      <p>Crystal is statically type checked, so any type errors will be caught early by the compiler rather than fail on
        runtime. Moreover, and to keep the language clean, Crystal has built-in type inference, so most type annotations
        are unneeded.</p>
      <div>
        <figure><pre><code data-lang="crystal"><span>def</span> <span>shout</span><span>(</span><span>x</span><span>)</span>
  <span># Notice that both Int32 and String respond_to `to_s`</span>
  <span>x</span><span>.</span><span>to_s</span><span>.</span><span>upcase</span>
<span>end</span>

<span>foo</span> <span>=</span> <span>ENV</span><span>[</span><span>&#34;FOO&#34;</span><span>]?</span> <span>||</span> <span>10</span>

<span>typeof</span><span>(</span><span>foo</span><span>)</span> <span># =&gt; (Int32 | String)</span>
<span>typeof</span><span>(</span><span>shout</span><span>(</span><span>foo</span><span>))</span> <span># =&gt; String</span></code></pre></figure>

      </div>
      <p><a href="https://crystal-lang.org/reference/syntax_and_semantics/types_and_methods.html">Read more
          about Crystal&#39;s type system</a></p>
    </div>
  </div>

  <div>
    <div>
      <h2>Null reference checks</h2>
      <p>All types are non-nilable in Crystal, and nilable variables are represented as a union between the type and
        nil. As a consequence, the compiler will automatically check for null references in compile time, helping
        prevent the dreadful <a href="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare" target="_blank">billion-dollar mistake</a>.</p>
      <div>
        <figure><pre><code data-lang="crystal"><span>if</span> <span>rand</span><span>(</span><span>2</span><span>)</span> <span>&gt;</span> <span>0</span>
  <span>my_string</span> <span>=</span> <span>&#34;hello world&#34;</span>
<span>end</span>

<span>puts</span> <span>my_string</span><span>.</span><span>upcase</span></code></pre></figure>

      </div>
      <p>Running the previous file:</p>
      <div>
        <figure>
          <pre><code>
$ crystal hello_world.cr
Error in hello_world.cr:5: undefined method &#39;upcase&#39; for <span>Nil (compile-time type is (String | Nil))</span>

puts my_string.upcase
               <span>^~~~~~</span>
</code></pre>

        </figure>
      </div>
    </div>
  </div>

  <div>
    <div>
      <h2>Macros</h2>
      <p>Crystal’s answer to metaprogramming is a powerful macro system, which ranges from basic templating and AST
        inspection, to types inspection and running arbitrary external programs.</p>
      <div>
        <figure><pre><code data-lang="crystal"><span>class</span> <span>Object</span>
  <span>def</span> <span>has_instance_var?</span><span>(</span><span>name</span><span>)</span> <span>:</span> <span>Bool</span>
    <span>{{</span> <span>@type</span><span>.</span><span>instance_vars</span><span>.</span><span>map</span> <span>&amp;</span><span>.</span><span>name</span><span>.</span><span>stringify</span> <span>}}.</span><span>includes?</span> <span>name</span>
  <span>end</span>
<span>end</span>

<span>person</span> <span>=</span> <span>Person</span><span>.</span><span>new</span> <span>&#34;John&#34;</span><span>,</span> <span>30</span>
<span>person</span><span>.</span><span>has_instance_var?</span><span>(</span><span>&#34;name&#34;</span><span>)</span> <span>#=&gt; true</span>
<span>person</span><span>.</span><span>has_instance_var?</span><span>(</span><span>&#34;birthday&#34;</span><span>)</span> <span>#=&gt; false</span></code></pre></figure>

      </div>
      <p><a href="https://crystal-lang.org/reference/syntax_and_semantics/macros.html">Read more about
          macros</a></p>
    </div>
  </div>

  <div>
    <div>
      <h2>Concurrency Model</h2>
      <p>Crystal uses green threads, called fibers, to achieve concurrency. Fibers communicate with each other using
        channels, as in Go or Clojure, without having to turn to shared memory or locks. </p>
      <div>
        <figure><pre><code data-lang="crystal"><span>channel</span> <span>=</span> <span>Channel</span><span>(</span><span>Int32</span><span>).</span><span>new</span>
<span>total_lines</span> <span>=</span> <span>0</span>
<span>files</span> <span>=</span> <span>Dir</span><span>.</span><span>glob</span><span>(</span><span>&#34;*.txt&#34;</span><span>)</span>

<span>files</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>f</span><span>|</span>
  <span>spawn</span> <span>do</span>
    <span>lines</span> <span>=</span> <span>File</span><span>.</span><span>read_lines</span><span>(</span><span>f</span><span>)</span>
    <span>channel</span><span>.</span><span>send</span> <span>lines</span><span>.</span><span>size</span>
  <span>end</span>
<span>end</span>

<span>files</span><span>.</span><span>size</span><span>.</span><span>times</span> <span>do</span>
  <span>total_lines</span> <span>+=</span> <span>channel</span><span>.</span><span>receive</span>
<span>end</span>

<span>puts</span> <span>total_lines</span></code></pre></figure>

      </div>
      <p><a href="https://crystal-lang.org/reference/guides/concurrency.html">Read more about Crystal&#39;s
          concurrency model</a></p>
    </div>
  </div>

  <div>
    <div>
      <h2>C-bindings</h2>
      <p>Crystal has a dedicated syntax to easily call native libraries, eliminating the need to reimplement low-level
        tasks.</p>
      <div>
        <figure><pre><code data-lang="crystal"><span># Fragment of the BigInt implementation that uses GMP</span>
<span>@[Link(&#34;gmp&#34;)]</span>
<span>lib</span> <span>LibGMP</span>
  <span>alias</span> <span>Int</span> <span>=</span> <span>LibC</span><span>::</span><span>Int</span>
  <span>alias</span> <span>ULong</span> <span>=</span> <span>LibC</span><span>::</span><span>ULong</span>

  <span>struct</span> <span>MPZ</span>
    <span>_mp_alloc</span> <span>:</span> <span>Int32</span>
    <span>_mp_size</span> <span>:</span> <span>Int32</span>
    <span>_mp_d</span> <span>:</span> <span>ULong</span><span>*</span>
  <span>end</span>

  <span>fun</span> <span>init_set_str</span> <span>=</span> <span>__gmpz_init_set_str</span><span>(</span><span>rop</span> <span>:</span> <span>MPZ</span><span>*</span><span>,</span> <span>str</span> <span>:</span> <span>UInt8</span><span>*</span><span>,</span> <span>base</span> <span>:</span> <span>Int</span><span>)</span> <span>:</span> <span>Int</span>
  <span>fun</span> <span>cmp</span> <span>=</span> <span>__gmpz_cmp</span><span>(</span><span>op1</span> <span>:</span> <span>MPZ</span><span>*</span><span>,</span> <span>op2</span> <span>:</span> <span>MPZ</span><span>*</span><span>)</span> <span>:</span> <span>Int</span>
<span>end</span>

<span>struct</span> <span>BigInt</span> <span>&lt;</span> <span>Int</span>
  <span>def</span> <span>initialize</span><span>(</span><span>str</span> <span>:</span> <span>String</span><span>,</span> <span>base</span> <span>=</span> <span>10</span><span>)</span>
    <span>err</span> <span>=</span> <span>LibGMP</span><span>.</span><span>init_set_str</span><span>(</span><span>out</span> <span>@mpz</span><span>,</span> <span>str</span><span>,</span> <span>base</span><span>)</span>
    <span>raise</span> <span>ArgumentError</span><span>.</span><span>new</span><span>(</span><span>&#34;invalid BigInt: </span><span>#{</span><span>str</span><span>}</span><span>&#34;</span><span>)</span> <span>if</span> <span>err</span> <span>==</span> <span>-</span><span>1</span>
  <span>end</span>

  <span>def</span> <span>&lt;</span><span>=&gt;</span><span>(</span><span>other</span> <span>:</span> <span>BigInt</span><span>)</span>
    <span>LibGMP</span><span>.</span><span>cmp</span><span>(</span><span>mpz</span><span>,</span> <span>other</span><span>)</span>
  <span>end</span>
<span>end</span></code></pre></figure>

      </div>
      <p><a href="https://crystal-lang.org/reference/syntax_and_semantics/c_bindings/">Learn how to bind to
          C libraries</a></p>
    </div>
  </div>

  <div>
    <div>
      <h2>Dependencies</h2>
      <p>Crystal libraries are packed as Shards, and distributed via Git without needing a centralised repository. Built
        in commands allow dependencies to be easily specified through a YAML file and fetched from their respective
        repositories.</p>
      <div>
        <figure><pre><code data-lang="yaml"><span>name</span><span>:</span> <span>my-project</span>
<span>version</span><span>:</span> <span>0.1</span>
<span>license</span><span>:</span> <span>MIT</span>

<span>crystal</span><span>:</span> <span>1.5.0</span>

<span>dependencies</span><span>:</span>
  <span>mysql</span><span>:</span>
    <span>github</span><span>:</span> <span>crystal-lang/crystal-mysql</span></code></pre></figure>

      </div>
      <p><a href="https://github.com/crystal-lang/shards">Read more about Shards in the repo</a></p>
    </div>
  </div>

  

  

  

  

  <hr/>
  

  

  

  

</div>



</main>


  

</div></div>
  </body>
</html>
