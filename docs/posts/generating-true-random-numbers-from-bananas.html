<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.valerionappi.it/brng-en/">Original</a>
    <h1>Generating true random numbers from bananas</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<figure><img src="https://www.valerionappi.it/wp-content/uploads/2018/03/IMG_20180317_232109-1200x900.jpg" alt=""/></figure>



<p>It was a dreary afternoon in Milan last year when, procrastinating on studying, I was struck by a<strong> flash of genius</strong>. “<em>What would happen if I made a banana-powered random number generator?</em>“. I immediately went to tell my roommate, who was also an electronic engineer.</p>



<p>Before being taken for a fool: <strong>it really does make sense</strong>, and this post is here to explain it to you. Let’s start at the root of the problem: <strong>computers are deterministic systems</strong>. Put in a less complicated way, if we always give them the same input data, <strong>they always return the same output values</strong>. Which is exactly what we expect from a computer. It is clear from the start, however, that <strong>determinism and randomness are not great friends</strong>. In fact, a computer, per se, is not capable of doing anything random.</p>



<p>If the reader is one of the lucky ones to have written some C programs, you will surely have run into some <strong>rand()</strong> function call. <strong>I myself have made extensive use of it</strong> in posts (<a href="#note1">[1]</a><a href="#note2">[2]</a>) about the calculation of pi with the Monte Carlo method.</p>



<p><strong>So we’ve been fooled. Unfortunately, friends, we’ve all been fooled. </strong>I take my share of responsibility, too, for flippantly calling them random numbers in posts about Pi. <strong>We should have called them <em>pseudo-</em>random numbers</strong>. Which is the name computer scientists give t<strong>o those sets of numbers that have the distribution in line with random numbers</strong>, but which are not actually random.</p>



<p>To understand it better, to be called <strong>random</strong>, a set of numbers must have at least (a necessary but not sufficient condition) these two characteristics:</p>



<ol><li>Each number must have the same probability as every other number to appear in our list (taken a reference interval). <strong>This is what we call uniform distribution</strong>;</li><li>The sequence of numbers must not be <strong>predictable in advance</strong>.</li></ol>



<p>Clearly, <strong>the difficulty with deterministic machines is in answering point 2.</strong> Point 1 is easily solved, and gives rise to what we have just called <strong>pseudo-random numbers</strong>. Numbers which <strong>respect the uniform distribution</strong>, but which are not <strong>actually <em>truly </em>random.</strong></p>



<blockquote><p><em>But what do bananas have to do with anything?!</em></p></blockquote>



<p>Now we are getting there!</p>



<p>The possible way using bananas is that of radioactive decay.<strong> Bananas in fact are known to contain a lot of potassium, and a small but significant percentage of the potassium present in nature is radioactive.</strong> Specifically we are talking about the 40K isotope, which makes up 0.01% of potassium in nature. <strong>Plus they’re delicious with lemon and sugar</strong>, which alone would be a great reason to always have one on hand.</p>



<div><figure><img src="https://vignette.wikia.nocookie.net/diepio/images/3/38/Banana-potassium-intensifies-weird-vibrating-shaking-1380578639M.gif/revision/latest?cb=20161001214741" alt=""/></figure></div>



<p>Now that the “banana-powered random number generator” statement makes a little more sense or at least has some context, one question remains:<strong> what do we do with true random numbers in a computer?</strong> My answer would like to be <em>“I don’t care, I want the focus of my project to be limited to generating them”</em>, <strong>but I’m sure that would leave many unsatisfied.</strong></p>



<p>So I’ll try to answer this question as well: <strong>encryption</strong>. This is the main reason why random numbers and their relationship with computers are studied. Random numbers are used to generate cryptographic keys, which are the only factor that determines the effectiveness of an encryption system. As <strong>Kerckhoffs Principle</strong> states: “<em>the security of a cryptosystem should not depend on keeping the crypto-algorithm hidden, but only on keeping the key hidden</em>“. (Copy that, NXP?)</p>



<blockquote><p>Okay but… if random is random, how do we distinguish good random from bad random?</p></blockquote>



<figure><img src="https://i.imgur.com/uR4WuQ0.gif" alt=""/><figcaption><a href="http://dilbert.com/strip/2001-10-25">da dilbert.com</a></figcaption></figure>



<p>In order to analyze the quality of random number generators, specially designed software tools are usually used. Two of the most popular ones are <strong>ent </strong>[4] and <strong>dieharder </strong>[5]. The first one is designed as a lightweight test for radioactive decay random number generators,<strong> it is very simple and fast, requires little data but the result is purely indicative.</strong></p>



<p>Let’s prepare the data to run a first test with ent.</p>



<p>The sample collected during two days consists of <strong>90628 16-bit numbers</strong>, one per line. However, the numbers <strong>are saved as ascii text files, while ent analyzes binary files</strong>. You can write a very short program in C to convert them to binary:</p>



<pre>#include &lt;stdio.h&gt;
#include &lt;assert.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
 
int main(int argc, char const *argv[]) {
 
  FILE * lettura = fopen(&#34;textsample.txt&#34;, &#34;r&#34;);
  assert(lettura != NULL);
 
  FILE * scrittura = fopen(&#34;sample.txt&#34;, &#34;wb&#34;);
  assert(scrittura != NULL);
 
  uint16_t N = 0; //N is 16 bytes
  char bytes[2];
  char buffer[6]; // 5 char + terminator
 
  do{
    fscanf(lettura,&#34;%s&#34;,buffer); // put one line in the buffer
    N = atoi(buffer); // from char array to integer
    bytes[0] = (N &gt;&gt; 8); // take the 8 msb
    bytes[1] = (N &amp; 0xFF); // take the 8 lsb
    fwrite(bytes, 1, sizeof(bytes), scrittura); // output raw msb and lsb
  }while (!feof(lettura));
 
  fclose(lettura);
  fclose(scrittura);
  return 0;
}</pre>



<p>Done this, we can run the ent test for the first time:</p>



<pre><span>valerio</span><span>@</span><span>valerio </span><span>~/tests </span><span>$ </span><span>./ent campione.txt 
Entropy = 7.997995 bits per byte.

Optimum compression would reduce the size of this 181256 byte file by 0 percent.

Chi square distribution for 181256 samples is 498.15, and randomly would exceed this value less than 0.01 percent of the times.

Arithmetic mean value of data bytes is 127.4942 (127.5 = random).
Monte Carlo value for Pi is 3.138799695 (error 0.09 percent).
Serial correlation coefficient is 0.005408 (totally uncorrelated = 0.0).

</span></pre>



<p>Ent gives us several parameters:</p>



<ul><li><strong>Entropy</strong>: entropy is the amount of “randomness” contained in a portion of information. Information theory tells us that the minimum size theoretically obtainable through compression <strong>without loss of information, is represented by the value of entropy.</strong></li><li><strong>Chi-square distribution</strong>: this test is used to understand how well the distribution of our values adheres to a theoretical distribution (in our case the uniform distribution). From the ent manual, this value should be as close as possible to 256, with percentage values between 10 and 90%.</li><li><strong>Arithmetic mean</strong>: The simple arithmetic mean of our bits. Since our values are between 0 and 255, it should be about equal to 127.</li><li><strong>Value of pi with Monte Carlo method</strong>: The method should be well known by those who follow my posts, but in this context is more a nice data than a useful one.</li><li><strong>Autocorrelation</strong>: represents the dependence between the values of the series. In the optimal case must be equal to zero.</li></ul>



<p>From this first test all values are passable, except the chi square. In the next post we will explore why and possible solutions.</p>



<p>The second part is available <a href="https://www.valerionappi.it/chi-squared/">here</a>.</p>



<figure><img loading="lazy" width="1024" height="664" src="https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-1024x664.jpg" alt="" srcset="https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-1024x664.jpg 1024w, https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-300x195.jpg 300w, https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-768x498.jpg 768w, https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-1536x997.jpg 1536w, https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-2048x1329.jpg 2048w, https://www.valerionappi.it/wp-content/uploads/2022/04/7022861525451037999-1200x779.jpg 1200w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 1362px) 62vw, 840px"/><figcaption>The PCB of the generator</figcaption></figure>



<p>Notes:</p>



<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"></a>This work is licensed under a <a rel="noreferrer noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

<!-- BEGIN License added by Creative-Commons-Configurator plugin for WordPress -->
<p prefix="dct: http://purl.org/dc/terms/ cc: http://creativecommons.org/ns#"><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="CC BY-NC-SA 4.0" src="https://www.valerionappi.it/wp-content/plugins/creative-commons-configurator-1/media/cc/by-nc-sa/4.0/88x31.png" width="88" height="31"/></a>
This work is licensed under a <a rel="license" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
<!-- END License added by Creative-Commons-Configurator plugin for WordPress -->
	</div></div>
  </body>
</html>
