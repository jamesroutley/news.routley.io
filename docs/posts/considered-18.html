<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://daniel.haxx.se/blog/2022/05/02/considered-18/">Original</a>
    <h1>Considered &#34;18&#43;&#34;</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<p><strong>Vodafone UK</strong> has taken it on themselves to make the world better by marking this website (<code>daniel.haxx.se</code>) “adult content”. I suppose in order to protect the children.</p>



<p>It was first reported to me on May 2, with this screenshot from a <a href="https://twitter.com/miniyarov/status/1520896974110797824">Vodafone customer</a>:</p>



<div><figure><a href="https://daniel.haxx.se/blog/wp-content/uploads/2022/05/vodafone-uk-daniel-haxx-se.jpg"><img loading="lazy" width="2186" height="1320" src="https://daniel.haxx.se/blog/wp-content/uploads/2022/05/vodafone-uk-daniel-haxx-se.jpg" alt=""/></a></figure></div>



<p>And later followed up with some <a href="https://twitter.com/justsitandgrin/status/1521028402790252545">more details</a> from another user in this screenshot</p>



<div><figure><a href="https://daniel.haxx.se/blog/wp-content/uploads/2022/05/vodafone-uk-daniel-haxx-se-2.jpg"><img loading="lazy" width="2048" height="2048" src="https://daniel.haxx.se/blog/wp-content/uploads/2022/05/vodafone-uk-daniel-haxx-se-2.jpg" alt=""/></a></figure></div>



<p>Customers can opt out of this “protection” and then apparently Vodafone will no longer block my site.</p>



<h2>How</h2>



<p>I was graciously given more logs (<a href="https://gist.github.com/bagder/b46386b7e7b41753b6f316416f06f2db">my copy</a>) showing DNS resolves and curl command line invokes.</p>



<p>It shows that this filter is for this specific host name only, not for the entire <strong>haxx.se</strong> domain.</p>



<p>It also shows that the DNS resolves are unaffected as they returned the expected Fastly IP addresses just fine. I suspect they have equipment that inspects outgoing traffic that catches this TLS connection based on the SNI field.</p>



<p>As the log shows, they then make their server do a TLS handshake in which they respond with a certificate that has <code>daniel.haxx.se</code> in the CN field.</p>



<p>The curl verbose output shows this:</p>



<pre><code>* SSL connection using TLSv1.2 / ECDHE-ECDSA-CHACHA20-POLY1305
* ALPN, server did not agree to a protocol
* Server certificate:
*  subject: CN=daniel.haxx.se
*  start date: Dec 16 13:07:49 2016 GMT
*  expire date: Dec 16 13:07:49 2026 GMT
*  issuer: C=ES; ST=Madrid; L=Madrid; O=Allot; OU=Allot; CN=allot.com/emailAddress=info@allot.com
*  SSL certificate verify result: self signed certificate in certificate chain (19), continuing anyway.
&gt; HEAD / HTTP/1.1
&gt; Host: daniel.haxx.se
&gt; User-Agent: curl/7.79.1
&gt; Accept: */*
&gt; </code></pre>



<p>The allot.com clue is <a href="https://www.allot.com/service-providers/url-traffic-filtering/">the technology they use</a> for this filtering. To quote their website, you can “protect citizens” with it.</p>



<div><figure><img loading="lazy" src="https://daniel.haxx.se/blog/wp-content/uploads/2022/05/Screenshot-2022-05-02-at-10-58-14-URL-Traffic-Filtering-for-Service-Providers-Allot.png" alt="" width="341" height="199"/></figure></div>



<p>I am not unique, clearly this has also hit other website owners. I have no idea if there is any way to appeal against this classification or something, but if you are a Vodafone UK customer, I would be happy if you did and maybe linked me to a public issue about it.</p>



<h2>Update</h2>



<p>I was pointed to <a href="https://www.blocked.org.uk/check/live">the page</a> where you can request to unblock specific sites so I have done that now (at 12:00 May 2).</p>



<h2>Update on May 3</h2>



<p>My unblock request for <code>daniel.haxx.se</code> is apparently “on hold” according to <a href="https://www.blocked.org.uk/reported-sites">the web site</a>.</p>



<p>I got an email from an anonymous (self-proclaimed) insider who says he works at Allot, the company doing this filtering for Vodafone. In this email, he says</p>



<pre>Most likely, Vodafone is using their parental control a threat protection module which works based on a DNS resolving.</pre>



<p>and then</p>



<pre>After the business logic decides to block the website, it tells the DNS server to reply with a custom IP to a server that always shows a block page, because how HTTPS works, there is no way to trick it, either with Self-signed certificate, or using a signed certificate for a different domain, hence the warning.</pre>



<p>What is weird here is that this explanation does not quite match what I have seen the logs provided to me. They showed this filtering clearly <em>not</em> being DNS based – since the DNS resolves got <em>the exact same</em> IP address a non-filtered resolver does.</p>



<p>Someone on Vodafone UK could of course easily test this by simply using a different DNS server, like 1.1.1.1 or 8.8.8.8.</p>



<p>Discussed on <a href="https://news.ycombinator.com/item?id=31248250">hacker news</a>.</p>
	</div></div>
  </body>
</html>
