<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cachewarpattack.com/">Original</a>
    <h1>CacheWarp: A new software fault attack on AMD SEV-ES and SEV-SNP</h1>
    
    <div id="readability-page-1" class="page"><div>




<nav>
  <div>
      <div>
        <p><img src="https://cachewarpattack.com/logo.svg"/></p>
      </div>
      <ul>
        <li id="homelink" data-block="home">
          CacheWarp
        </li>
        
        
        <li data-block="demo">
          Demo
        </li>
        
        
        
        <li data-block="sev">
          About
        </li>
        
        
        
        
        
        
        
        <li data-block="faq">
          FAQ
        </li>
        
        
        
        <li data-block="who-found-it">
          Researcher
        </li>
        
        
        
        
      </ul>
      
  </div>
</nav>

<section id="home">
  <div>
    <p><img src="https://cachewarpattack.com/logo.svg"/></p><div>
      
      <div id="innerhomecontainer"><p>CacheWarp is a new software fault attack on AMD SEV-ES and SEV-SNP.
It allows attackers to hijack control flow, break into encrypted VMs, and perform privilege escalation inside the VM.</p>

</div>
    </div>
  </div>
</section>















<section id="demo">
  <div>
    <h2>Demo</h2>
    <div>
  
  <div>
    <p>
  <iframe src="https://www.youtube.com/embed/B3RH15gQ0dI" allowfullscreen="" title="YouTube Video"></iframe>
</p>

  </div>
  
  <div>
    <p>
  <iframe src="https://www.youtube.com/embed/Za6KVLVF1AA" allowfullscreen="" title="YouTube Video"></iframe>
</p>

  </div>
  
</div>


  </div>
</section>









<section id="sev">
  <div>
    
    <div>
  
  <p><img src="https://cachewarpattack.com/amd-sev.svg" alt="AMD SEV."/></p>
  <div><h2>Securing Virtual Machines.</h2>
<h3>AMD SEV.</h3>
<p><strong>AMD Secure Encrypted Virtualization (SEV)</strong> is a CPU extension enabling a more secure separation between virtual machines (VMs) and the underlying hypervisor.
AMD SEV allows developers to deploy VMs in an untrusted hypervisor environment securely.
In other words, this means that computations in the cloud can be performed on confidential data even if the cloud provider is untrusted or compromised.</p>
<p>AMD SEV achieves this level of protection by encrypting the VM’s data.
The encryption applies to the VM’s memory as well as its register state upon context switches.
The latest and most secure variant of SEV, namely, AMD SEV-SNP, additionally prevents cloud providers from altering the data stored inside the VM.</p>
</div>
</div>


  </div>
</section>











<section id="cachewarp">
  <div>
    
    <div>
  
  <p><img src="https://cachewarpattack.com/logo.svg" alt="Jump back"/></p>
  <div><h2>CacheWarp.</h2>
<h3>Traveling Through Time and Memory.</h3>
<p><strong>CacheWarp</strong> is a software-based fault injection attack on SEV VMs.
It allows the hypervisor to revert data modifications of the VM on a single-store granularity, leading to an old (stale) view of memory for the VM.</p>
<p><strong>But why is that bad?</strong>
For a simple example, assume you have a variable determining whether a user is successfully authenticated.
By exploiting CacheWarp, an attacker can revert the variable to a previous state and thus take over an old (already authenticated) session.
Furthermore, an attacker can revert the return addresses stored on the stack and, by that, change the control flow of a victim program.</p>
</div>
</div>


  </div>
</section>









<section id="implications">
  <div>
    
    <div>
  
  <p><img src="https://cachewarpattack.com/security-breach.svg" alt="Security Breach"/></p>
  <div><h2>Practical Impact.</h2>
<h3>Security Implications.</h3>
<p>CacheWarp enables attackers to attack AMD SEV VMs.
As shown in the above videos, attackers can exploit CacheWarp to, for example, gain <strong>remote code execution</strong> and <strong>privilege escalation</strong> in the targeted virtual machine.</p>
<p>Fortunately, AMD has tracked the issue as CVE-2023-20592 and provides a microcode update fixing the vulnerability.
For more detailed information, we recommend reading the official <a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-3005.html">AMD Security Bulletin</a>.</p>
</div>
</div>


  </div>
</section>











<section id="faq">
  <div>
    <h2>FAQ</h2>
    <div><div>
    <p>Is my computer vulnerable to this attack?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <div><p>If you have an AMD CPU supporting AMD SEV, yes, your machine is affected.
Nevertheless, if you do not rely on deploying secure virtual machines using AMD SEV, this vulnerability cannot be leveraged by an attacker.</p>
<p>For more details, please refer to the official <a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-3005.html">AMD Security Bulletin</a>.</p>
</div>
</div>

<div><div>
    <p>What is AMD SEV?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  
</div>

<div><div>
    <p>Does this work against all variants of AMD SEV, including SEV-SNP?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>Yes, while the exploitation for AMD SEV-SNP is more challenging, CacheWarp can be exploited in all current variants of AMD SEV.</p>
</div>

<div><div>
    <p>Does CacheWarp affect traditional virtual machine isolation?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>No, CacheWarp only affects AMD SEV, as traditional virtual machines do not offer any protection against malicious hypervisors.</p>
</div>

<div><div>
    <p>Is this a software or a hardware bug?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>CacheWarp is a <strong>hardware bug</strong> in AMD CPUs.
For guidance mitigating this vulnerability on affected CPUs, we refer to the official <a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-3005.html">AMD Security Bulletin</a>.</p>
</div>

<div><div>
    <p>Is this a transient-execution attack?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>No, CacheWarp is an <strong>architectural</strong> bug and thus does not fall into the category of transient-execution attacks like Meltdown and Spectre. It is also not a side-channel attack.</p>
</div>

<div><div>
    <p>Is this exploited in the wild?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>We do not know.</p>
</div>

<div><div>
    <p>Is there more technical information about CacheWarp?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>Yes, there is an academic <a href="https://cachewarpattack.com/paper.pdf">paper</a>.</p>
</div>

<div><div>
    <p>What is CVE-2023-20592?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  <p>CVE-2023-20592 is the official reference to CacheWarp. CVE is the standard for information security vulnerability names maintained by MITRE.</p>
</div>

<div><div>
    <p>Can I use the logo?</p>
    <p><img src="https://cachewarpattack.com/chevron-arrow.svg"/>
  </p></div>
  
</div>


  </div>
</section>









<section id="who-found-it">
  
</section>













<section id="acknowledgements">
  <div>
    <h2>Acknowledgements</h2>
    <p>We would like to thank AMD for working with us during the responsible disclosure.
We want to thank our shepherd and the anonymous reviewers for their guidance, comments and valuable suggestions, as well as Leon Trampert, Moritz Lipp, and Xinyue Shen for helpful feedback on this work. This work was supported in part by Semiconductor Research Corporation (SRC) Hardware Security Program (HWS). This research is supported in part by the European Research Council (ERC project FSSec 101076409). Additional funding was provided by a generous gift from AWS. Any opinions, findings, and conclusions or recommendations expressed in this paper are those of the authors and do not necessarily reflect the views of the funding parties.</p>

  </div>
</section>




    </div></div>
  </body>
</html>
