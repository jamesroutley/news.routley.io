<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://turborepo.org/blog/turbo-1-2-0">Original</a>
    <h1>Turborepo 1.2: High-performance build system for monorepos</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><main>
<!-- -->
<p>Friday, April 8th, 2022</p>

<p>Since releasing Turborepo v1.1 in late January, we&#39;ve seen incredible adoption and community growth:</p>
<ul>
<li><strong>6.5k+</strong> <a target="_blank" rel="noreferrer" href="https://github.com/vercel/turborepo">GitHub Stars</a></li>
<li><strong>140k+</strong> weekly NPM downloads (doubling since our <a href="https://turborepo.org/blog/turbo-1-1-0">last blog post for v1.1</a>)</li>
<li><strong>95+</strong> OSS contributors</li>
<li><strong>900+</strong> members of the <a target="_blank" rel="noreferrer" href="https://turborepo.org/discord">Turborepo Community Discord</a></li>
<li><strong>1.6 years</strong> of Time Saved through Remote Caching on Vercel, saving more than 2.5 months every week</li>
</ul>
<p>We&#39;ve further improved ergonomics, observability, and security with Turborepo v1.2 featuring:</p>
<ul>
<li><a href="#new-task-filtering-api"><strong>New Task Filtering API</strong></a>: <code>--filter</code> adds more powerful task filtering capabilities to <code>turbo run</code></li>
<li><a href="#debug-and-automate-with---dry-run"><strong>Human-readable and JSON dry runs</strong></a>: <code>--dry-run</code> flag can print out information about a <code>turbo run</code> without executing any tasks, in both human and JSON-parse friendly formats</li>
<li><a href="#improved-internal-scheduler-and-graph"><strong>Improved Internal Scheduler and Graph</strong></a>: We refactored <code>turbo</code> &#39;s internal scheduler and graph to be more ergonomic and predictable</li>
<li><a href="#cache-outputs-integrity-and-signature-verification"><strong>Enhanced Remote Cache Security</strong></a>: Cryptographically sign remote cache artifacts with your own secret key</li>
</ul>
<p>Update today by running <code>npm install turbo@latest</code>. After running <code>turbo run</code> for the first time, you&#39;ll see instructions about how to use <code>@turbo/codemod</code> to run automatic migrations for <code>v1.2</code>.</p>
<h2><span id="new-task-filtering-api"></span><a href="#new-task-filtering-api">New Task Filtering API<span aria-hidden="true">#</span></a></h2>
<p>We are excited to release one of our most requested features: the ability to expressively filter tasks through a <code>--filter</code> flag. The <code>--filter</code> flag is the much more powerful successor to the current combination of <code>--scope</code>, <code>--include-dependencies</code>, <code>--since</code>, and <code>--no-deps</code> flags.</p>
<p>With <code>--filter</code> you can tell <code>turbo</code> to restrict executing commands to a subset of matched packages in your monorepo based on name, folder, or even if it has changed since a git commit ref.</p>
<p>Take a look at some examples of what you can accomplish with the new <code>--filter</code> command:</p>
<ul>
<li><code>--filter=&lt;package_name&gt;</code> - match by exact package name or glob pattern</li>
<li><code>--filter=...&lt;package_name&gt;</code>- match by package name/glob and include all dependent packages of matches</li>
<li><code>--filter=...^&lt;package_name&gt;</code>- match by package name/glob and include all dependent packages of matches, but exclude the matches themselves</li>
<li><code>--filter=&lt;package_name&gt;...</code> - match by package name/glob and include all the matched packages&#39; dependencies</li>
<li><code>--filter=&lt;package_name&gt;^...</code> - match by package name/glob and include all matched package dependencies, but exclude the matches themselves</li>
<li><code>--filter={./path/to/package}</code> - match by path or filesystem glob pattern</li>
<li><code>--filter=[origin/main]</code> - match by changed packages since a git commit ref</li>
</ul>
<p>You can use multiple filters together to get even more granular filtering as well as combine each part of the above patterns <code>{}</code>, <code>[]</code> , <code>^</code> , and <code>...</code> to express more complex behavior.</p>
<p>For example, if you had an app located in <code>./apps/web</code> directory with local packages used as dependencies, and a Turborepo pipeline where <code>test</code> depends on <code>^build</code> <a target="_blank" rel="noreferrer" href="https://turborepo.org/docs/glossary#topological-order">topologically</a>, running:</p>
<div data-rehype-pretty-code-fragment="" data-nextra-code=""><pre><code data-language="sh" data-theme="default"><span><span>turbo run </span><span>test</span><span> --filter={./apps/web}[HEAD^1]^...</span></span></code></pre></div>
<p>would tell <code>turbo</code> to ensure dependencies are built and to run the <code>test</code> script in all of the local dependencies of the app located in <code>./apps/web</code>, not including that app itself, if the app has changed since HEAD^1.</p>
<p>For more details and examples, refer to the new <a href="https://turborepo.org/docs/features/filter">filtering documentation</a>.</p>
<h2><span id="debug-and-automate-with---dry-run"></span><a href="#debug-and-automate-with---dry-run">Debug and Automate with <code>--dry-run</code><span aria-hidden="true">#</span></a></h2>
<p>You can now see the impact of <code>turbo run</code> without actually executing any commands by appending either <code>--dry-run</code> or <code>--dry-run=json</code> to any <code>turbo run</code> command. This will result in either human or JSON output.</p>
<p>Dry runs are incredibly useful for two situations:</p>
<ul>
<li>Debugging and testing run options</li>
<li>Using <code>turbo</code> filtering and task graphs for building automations</li>
</ul>
<p><img src="https://turborepo.org/images/blog/turbo-1-2-0/turbo-dry-run.png" alt="Turborepo Dry Run"/></p>
<p>We hope that this will improve visibility into what <code>turbo</code> is doing, speeding up debugging, and make it easier to leverage <code>turbo</code> in dynamic CI/CD systems.</p>
<h2><span id="improved-internal-scheduler-and-graph"></span><a href="#improved-internal-scheduler-and-graph">Improved Internal Scheduler and Graph<span aria-hidden="true">#</span></a></h2>
<p>When using <code>turbo run</code>, every <code>package.json</code> task is added to an internal graph to map dependencies based on the inferred relationships defined in your Turborepo <code>pipeline</code>. This task graph allows Turborepo to efficiently schedule incremental concurrent task running and cache task outputs for later use.</p>
<p>We have made major improvements to the internal task scheduler and resulting graph structure, resulting in better performance and a better developer experience. For example, in many cases, you will no longer need to use <code>--include-dependencies</code>. Instead, after specifying your task entry points, the new and improved graph will automatically handle this graph resolution on your behalf.</p>
<h2><span id="cache-outputs-integrity-and-signature-verification"></span><a href="#cache-outputs-integrity-and-signature-verification">Cache Outputs Integrity and Signature Verification<span aria-hidden="true">#</span></a></h2>
<p>You can now configure Turborepo to sign remote cache outputs using HMAC-SHA256 with a secret key before uploading them to the Remote Cache. When Turborepo downloads signed cache artifacts, it will now verify the artifact&#39;s integrity and authenticity. Any artifact that fails to verify will be ignored, discarded, and treated as a cache miss by Turborepo.</p>
<p>To enable this feature, set the <code>remoteCache</code> options in your <code>turbo.json</code> config file to include <code>signature: true</code>. Then specify your secret key by declaring the <code>TURBO_REMOTE_CACHE_SIGNATURE_KEY</code> environment variable.</p>
<div data-rehype-pretty-code-fragment="" data-nextra-code=""><pre><code data-language="jsonc" data-theme="default"><span><span>{</span></span>
<span><span>  </span><span>&#34;$schema&#34;</span><span>:</span><span> </span><span>&#34;[https://turborepo.org/schema.json](https://turborepo.org/schema.json)&#34;</span><span>,</span></span>
<span><span>  </span><span>&#34;remoteCache&#34;</span><span>:</span><span> {</span></span>
<span><span>    </span><span>// Indicates if signature verifcation is enabled.</span></span>
<span><span>    </span><span>&#34;signature&#34;</span><span>:</span><span> </span><span>true</span></span>
<span><span>  }</span></span>
<span><span>}</span></span></code></pre></div>
<h2><span id="other-bug-fixes-and-improvements"></span><a href="#other-bug-fixes-and-improvements">Other bug fixes and improvements<span aria-hidden="true">#</span></a></h2>
<ul>
<li><code>--sso-team</code> flag now enables teams with SAML tokens to log in through <code>turbo login</code> with correct team permissions</li>
<li><code>--log-output</code> flag allows you to control what logs are printed to the terminal, and when, allowing you to focus only on what&#39;s new</li>
<li><code>FORCE_COLOR</code> environment variable is now supported</li>
<li><code>TURBO_FORCE=true</code> environment variable will now force execution</li>
<li><code>--remote-only</code> and <code>TURBO_REMOTE_ONLY=true</code> will tell <code>turbo</code> to only use Remote Caching</li>
<li>We now show <code>&gt;&gt;&gt; FULL TURBO</code> when there&#39;s at least one task attempted</li>
<li>Yarn v2+ with Plug&#39;n&#39;Play (PnP linker) is supported for the <code>turbo run</code> command, but <code>turbo prune</code> is still not fully supported</li>
<li>Fixed regression with chrome tracing if <code>--profile</code> is specified</li>
<li>You can now set concurrency by percentage of CPUs with <code>--concurrency=50%</code></li>
</ul>
<h2><span id="were-hiring"></span><a href="#were-hiring">We&#39;re hiring!<span aria-hidden="true">#</span></a></h2>
<p>The Turborepo team at <a target="_blank" rel="noreferrer" href="https://vercel.com">Vercel</a> is hiring! We&#39;re up to five core team members already this year and are looking to hire even more. We&#39;re specifically looking for full-time <a target="_blank" rel="noreferrer" href="https://vercel.com/careers/senior-build-systems-engineer-turborepo-us-4383106004">Senior Build Systems Engineers</a>.</p>
<h2><span id="whats-next"></span><a href="#whats-next">What&#39;s next?<span aria-hidden="true">#</span></a></h2>
<p>Along with seamless incremental adoption/migration and speeding up CI/CD, we&#39;ve been focusing on improving Turborepo&#39;s day-to-day ergonomics, security, and observability. The new <code>--filter</code> flag, signed artifacts, and dry runs are important steps toward those goals.</p>
<p>Next up, we&#39;ll be focusing an enhanced local development experience, codebase automations, and overall CLI performance.</p>
<h2><span id="thank-you-contributors"></span><a href="#thank-you-contributors">Thank you, contributors<span aria-hidden="true">#</span></a></h2>
<p>Turborepo is the result of the combined work of over 95 individual developers and our core team.</p>
<p>This release was brought to you by the contributions of: @gsoltis09, @jaredpalmer, @gaspar09, @shuding, @rajatkulkarni95, @VanTanev, @Kikobeats, @tknickman, @thebanjomatic, @chelkyl, @elado, @finn-orsini, @becca, @weyert, @ekosz</p></main></article></div></div></div>
  </body>
</html>
