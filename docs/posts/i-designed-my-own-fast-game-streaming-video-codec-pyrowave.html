<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://themaister.net/blog/2025/06/16/i-designed-my-own-ridiculously-fast-game-streaming-video-codec-pyrowave/">Original</a>
    <h1>I designed my own fast game streaming video codec ‚Äì PyroWave</h1>
    
    <div id="readability-page-1" class="page"><article id="post-851">
	
	<!-- .entry-header -->

	<div>
		<p>Streaming gameplay from one machine to another over a network is a reasonably popular use case these days. These use cases demand very, very low latency. Every millisecond counts here. We need to:</p>
<ul>
<li>Send controller input from machine A to B over network</li>
<li>B renders a frame on the GPU</li>
<li>B encodes the frame into a bitstream</li>
<li>B sends the result over a network to A</li>
<li>A decodes the bitstream</li>
<li>A displays image on screen</li>
<li>Dopamine is released in target brain</li>
</ul>
<p>Every step in this chain adds latency and we want to minimize this as much as possible. The go-to solution here is GPU accelerated video compression using whatever codec you have available, usually H.264, HEVC or if you‚Äôre really fancy, AV1. Ideally, we want all of this to complete in roughly ~20 ms.</p>
<p>To make this use case work well, we have to strangle the codecs quite a bit. Modern video codecs love latency since it allows tricks like flexible rate control and B-frames. That is what allows these codecs to operate at ridiculous compression ratios, but we have to throw away most of these tricks now. Since the codec cannot add latency, and we‚Äôre working on a fixed bit-rate budget (the ethernet cable or WiFi antenna), we‚Äôre left with:</p>
<ul>
<li>Hard-capped constant bit rate
<ul>
<li>There is no buffer that can soak up variable bit rate</li>
</ul>
</li>
<li>Infinite GOP P-frames or intra-refresh
<ul>
<li>Either choice deals with packet loss differently</li>
</ul>
</li>
</ul>
<p>When game streaming, the expectation is that we have a lot of bandwidth available. Streaming locally on a LAN in particular, bandwidth is basically free. Gigabit ethernet is ancient technology and hundreds of megabits over WiFi is no problem either. This shifts priorities a little bit for me at least.</p>
<p>Back in my student days, I designed a very simple low-complexity video codec for my master thesis, and after fiddling with Vulkan video and PyroFling for a while, that old itch was scratched again. <a href="https://github.com/Themaister/pyrowave">I wanted to see what would happen if I designed a codec with laser focus on local streaming with the absolute lowest possible latency, what could go wrong?</a></p>
<h3>Throwing out motion prediction ‚Äì intra-only</h3>
<p>This is the grug-brained approach to video, but it‚Äôs not as silly as it sounds. Bit-rates explode of course, but we gain:</p>
<ul>
<li>Excellent error resilience
<ul>
<li>Even on local WiFi streaming to a handheld device, this does matter quite a lot, at least in my experience</li>
</ul>
</li>
<li>Simplicity
<ul>
<li>Duh</li>
</ul>
</li>
<li>Consistent quality
<ul>
<li>With CBR, video quality is heavily dependent on how good of a job motion estimation can do</li>
</ul>
</li>
</ul>
<p>Intra-only has use cases in digital cinema (motion JPEG2000) and more professionally oriented applications where these concerns are likely more important than squeezing bandwidth. We‚Äôre now working at 100+ Mbits/s instead of ~10-20 Mbit/s, so streaming over the internet is no longer feasible outside of peer-to-peer with fiber links. For reference, raw 1080p60 with 420 chroma subsampling is in the range of 1.5 Gbit/s, and it only gets worse from there.</p>
<h3>Throwing out entropy coding</h3>
<p>Entropy coding is an absolute nightmare for parallelization, which means encoding solely on the GPU with compute shaders becomes an extremely painful affair. Let‚Äôs just throw that out and see how far we get. Gotta go fast!</p>
<p>There are codecs in this domain too, but it‚Äôs getting very specialized at this point. In the professional broadcasting space, there are codecs designed to squeeze more video through existing infrastructure with ‚Äúzero‚Äù lag and minimal hardware cost. My master thesis was about this, for example. A more consumer oriented example is VESA display stream compression (I‚Äôm not sure if it does entropy coding, but the compression ratios are small enough I doubt it). There isn‚Äôt much readily available software in this domain, it‚Äôs generally all implemented in tiny ASICs. If FFmpeg doesn‚Äôt support it, it doesn‚Äôt exist for mere mortals.</p>
<h2>Discrete Wavelet Transforms</h2>
<p>While modern codecs are all block-based Discrete Cosine Transform (DCT) + a million hacks on top to make it good, there is an alternative that tried its best in the 90s to replace DCTs, but kinda failed in the end. <a href="https://www.youtube.com/watch?v=UGXeRx0Tic4">https://www.youtube.com/watch?v=UGXeRx0Tic4</a> is a nice video explaining some of the lore. DWT-based compression has a niche today, but only in intra video compression. It‚Äôs a shame, because it‚Äôs quite elegant. <a href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform">https://en.wikipedia.org/wiki/Discrete_wavelet_transform</a></p>
<p><img fetchpriority="high" decoding="async" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Jpeg2000_2-level_wavelet_transform-lichtenstein.png/330px-Jpeg2000_2-level_wavelet_transform-lichtenstein.png" width="330" height="330"/></p>
<p>A graphics programmer will be familiar with this structure immediately, because this is just good old mip-maps with spice. Effectively, we downsample images, and also compute the ‚Äúerror‚Äù between the high-res picture and low-res picture. With signal processing lenses on, we can say it‚Äôs a critically sampled filter-bank. After processing N pixels, we obtain N / 2 low-pass and N / 2 high-pass pixels. The filters designed to do this are very particular (I really don‚Äôt know or care how they were made), but it‚Äôs basically just a basic convolution kernel, nothing too wild. The number of levels can vary but I chose 5 levels of decomposition.</p>
<p>Once the image is filtered into different bands, the values are quantized. Quantizing wavelets is a little tricky since we need to consider that during reconstruction, the filters have different gains. For the CDF 9/7 filter, high-pass is attenuated by 6 dB, and there are other effects when upsampling the lower resolution bands (zero-insertion). Rather than sweating out new graphs, I‚Äôll just copy paste from my thesis. CDF 9/7 has very similar looking spectrum to the 5/3 I used here.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205217.png"><img decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205217.png" alt="" width="676" height="599" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205217.png 676w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205217-300x266.png 300w" sizes="(max-width: 676px) 100vw, 676px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205240.png"><img decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205240.png" alt="" width="676" height="565" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205240.png 676w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205240-300x251.png 300w" sizes="(max-width: 676px) 100vw, 676px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205254.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205254.png" alt="" width="505" height="504" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205254.png 505w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205254-300x300.png 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_205254-150x150.png 150w" sizes="auto, (max-width: 505px) 100vw, 505px"/></a></p>
<p>After normalizing the noise power, higher frequency bands can be quantized much harder than low-frequency bands. This exploits human psychovisual effects. This effect is used during rate control, which is another interesting problem. In the end, the higher frequency bands quantize to zero for most of the frame, with bits being allocated to critical regions of the image.</p>
<h3>Classic artifacts of wavelets</h3>
<p>The JPEG blocking artifact is infamous. Wavelet‚Äôs typical failure mode is that all high-pass information is quantized to 0, even where it shouldn‚Äôt be. This leads to a blurring ‚Äì and if severe ‚Äì ringing artifact. Given how blurry games these days can be with TAA, maybe this simply isn‚Äôt all that noticeable? üòÄ Modern problems require modern solutions.</p>
<h2>Packing coefficients into blocks really fast</h2>
<p>Fiddling with this part of the codec was the thing that took the longest, but I think I landed on something alright eventually.</p>
<p>The basic block is 32√ó32 coefficients. This forms a standalone unit of the bitstream that can be decoded independently. If there is packet loss, we can error correct by simply assuming all coefficients are zero. This leads to a tiny blur somewhere random in the frame which is likely not even going to be perceptible.</p>
<p>The 32√ó32 block is further broken down into 8√ó8 blocks, which are then broken down into 4√ó2 blocks. This design is optimized for GPUs hierarchy of threads:</p>
<ul>
<li>1 thread: 4√ó2 coefficients</li>
<li>Cluster of threads (subgroup): 8√ó8 block</li>
<li>Workgroup: 32√ó32 block (128 threads)</li>
</ul>
<p>8 coefficients per thread is deliberately chosen so that we can be byte oriented. Vulkan widely supports 8-bit storage of SSBOs, so I rely on that. We absolutely cannot be in a situation where we do bit fiddling on memory. That makes GPUs sad.</p>
<p>Like most wavelet codecs, I went with bit-plane encoding, but rather than employing a highly complicated (and terribly slow) entropy coding scheme, the bit-planes are just emitted raw as-is. I did this in my master thesis project and I found it surprisingly effective. The number of bits per coefficient are signaled at a 4√ó2 block level. I did some experiments on these block sizes and 4√ó2 was the right tradeoff. Using subgroup operations and some light prefix sums across the workgroup, it‚Äôs very efficient to decode and encode data this way. For non-zero coefficients, sign bits are tightly packed to the end of the 32√ó32 block. This was mildly tricky to implement, but not too bad.</p>
<p>The details are in my <a href="https://github.com/Themaister/pyrowave/blob/master/bitstream/bitstream.md">draft of the bitstream</a>.</p>
<h2>Accurate and fast rate control</h2>
<p>In this style of compression, rate control is extremely important. We have a fixed (but huge) budget we have to meet. Most video codecs struggle with this requirement since the number of bits we get out of entropy coding is not easily knowable before we have actually done the compression. There is usually a lot of slack available to codecs when operating under normal VBR constraints. If a frame overshoots by 30%, we can amortize that over a few frames no problem, but that slack does not exist here since we‚Äôre assuming zero buffering latency.</p>
<p>Without entropy coding, we can trivialize the problem. For every 32√ó32 block, I test what happens if I throw away 1, 2, 3, ‚Ä¶ bits. I measure psychovisually weighted error (MSE) and bit-cost from that and store it in a buffer for later.</p>
<p>During RD analysis I can loosely sort the decisions to throw away bits by order of least distortion per bit saved. After the required number of bits have been saved through some prefix summing, we have achieved a roughly optimal rate distortion across the entire image in fixed time.</p>
<p>In the final pass, every 32√ó32 block checks how many bits to throw away and packs out the final bit-stream to a buffer. The result is guaranteed to be within the rate limit we set, usually ~10-20 bytes under the target.</p>
<p>Being able to rate limit like this is a common strength of wavelet codecs. Most of them end up iterating from most significant to least significant bit-plane and can stop encoding when rate limit is met, which is pretty cool, but also horribly slow ‚Ä¶</p>
<h2>Gotta go ridiculously fast üòÄ</h2>
<p>So ‚Ä¶ is it fast? I think so. Here‚Äôs a 1080p 4:2:0 encode and decode of Expedition 33, which I found to be on the ‚Äúbrutal‚Äù end for image compression. Lots of green foliage and a lot of TAA noise is quite hard to encode.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743-1024x576.jpg" alt="" width="660" height="371" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743-1024x576.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743-300x169.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743-768x432.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743-1536x864.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_214743.jpg 1920w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221-1024x595.png" alt="" width="660" height="383" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221-1024x595.png 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221-300x174.png 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221-768x446.png 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215221.png 1531w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p>0.13 ms on a RX 9070 XT on RADV. Decoding is also very fast. Under 100 microseconds. I don‚Äôt think anything else even comes close. The DWT pass was quite heavily optimized. It‚Äôs one of the few times where I found that packed FP16 math actually helped a lot, even on a beast like RDNA4. The quantizer pass does the most work of all the passes, and it took some effort to optimize too. Doing DWT in FP16 does have a knock-on effect on the maximum quality metrics we can achieve though.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312-1024x595.png" alt="" width="660" height="383" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312-1024x595.png 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312-300x174.png 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312-768x446.png 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215312.png 1531w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p>Encoding more ‚Äúnormal‚Äù games, the quant + analysis pass has an easier time. 80 microsecond encode is pretty good.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746-1024x687.png" alt="" width="660" height="443" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746-1024x687.png 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746-300x201.png 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746-768x515.png 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746-1536x1030.png 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215746.png 1738w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p>Here‚Äôs a 4K 4:2:0 encode of the infamous ParkJoy scene.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1024x574.jpg" alt="" width="660" height="370" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1024x574.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-300x168.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-768x431.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1536x861.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837.jpg 1901w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848-1024x687.png" alt="" width="660" height="443" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848-1024x687.png 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848-300x201.png 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848-768x515.png 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848-1536x1030.png 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_215848.png 1738w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p>0.25 ms, showing that 1080p struggles a bit to keep the GPU fully occupied. An interesting data point is that transferring a 4K RGBA8 image over the PCI-e bus is far slower than compressing it on the GPU like this, followed by copying over the compressed payload. Maybe there is a really cursed use case here ‚Ä¶</p>
<p>I think this is an order of magnitude faster than even dedicated hardware codecs on GPUs. This performance improvement translates directly to lower latency (less time to encode and less time to decode), so maybe I‚Äôm onto something here.</p>
<p>Power consumption on the Steam Deck when decoding is also barely measurable. Not sure it‚Äôs less than the hardware video decoder, but I actually wouldn‚Äôt be surprised if it were.</p>
<h2>Quality comparisons</h2>
<p>Given how niche and esoteric this codec is, it‚Äôs hard to find any actual competing codecs to compare against. Given the domain is game streaming the only real alternative is to test against the GPU vendors‚Äô encoders with H.264/HEVC/AV1 codecs in FFmpeg. NVENC is the obvious one to test here. VAAPI is also an option but at least FFmpeg‚Äôs implementation of VAAPI fails to meet CBR targets which is cheating and broken for this particular use case. It‚Äôs possible I held it wrong, but I‚Äôm not going to try debugging that.</p>
<p>Over 200mbit/s at 60 fps, I find it hard to tell any compression artifacts without side-by-side comparisons + zooming in, which is about 1.5 bpp. For something as simple as this codec, that‚Äôs quite neat. For objective metrics, I made use of <a href="https://github.com/psy-ex/metrics">https://github.com/psy-ex/metrics</a>.</p>
<p>To even begin to compare a trivial codec like this against these codecs is a little silly, but we can level the playing field a bit by putting these codecs under the same harsh restriction that we have in PyroWave:</p>
<ul>
<li>Intra-only</li>
<li>CBR with hard cap
<ul>
<li>Encoder is not allowed any slack, which should make the rate control really sweat</li>
</ul>
</li>
<li>Fastest modes (not sure it matters that much to intra-only)</li>
</ul>
<p>Example command line here:</p>
<pre>ffmpeg -y -i input.y4m -b:v 100000k -c:v hevc_nvenc -preset p1 -tune ull -g 1 -rc cbr -bufsize 1667k out.mkv</pre>
<p>No one in their right mind would stream like this, but let‚Äôs try anyway. üôÇ</p>
<p>The video clips from the games are 5s clips I captured myself to raw NV12 video. I don‚Äôt think it‚Äôs super useful to upload those. My hacked up scripts to generate the graphs can be found <a href="https://github.com/Themaister/pyrowave/blob/master/metrics/triage.sh">here</a> for reference.</p>
<p>I ran the NVENC tests on an RTX 4070 on 575 drivers.</p>
<h3>ParkJoy</h3>
<p>I included this as a baseline since this sequence has been seared into the mind of every video engineer out there (I think?) ‚Ä¶ This clip is 50 fps, but since my test script is hard-coded for 1080p60, I hex-edited the .y4m :‚Äô)</p>
<h3><a href="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1024x574.jpg" alt="" width="660" height="370" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1024x574.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-300x168.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-768x431.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837-1536x861.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/Screenshot_20250616_220837.jpg 1901w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></h3>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>O_O. One thing to note here is that AV1/HEVC rate control kinda fails in this scenario. It ends up using less than the allotted budget, probably because it has to be conservative to meet the ridiculous hard-capped CBR. The graphs are done using the final encoded size however.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>‚Ä¶ VMAF, are you drunk?</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssim.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssim.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssim.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssim-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>Back to reality.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>The more typical metrics look more like what I would expect. XPSNR is supposed to be a weighted PSNR that takes psychovisual effects into account, but I have no idea if it‚Äôs a good objective metric.</p>
<h3>Expedition 33</h3>
<p>Quite hard to encode. It was this game that actually gave me the last push to make this codec since even at 50 mbit/s with motion estimation, I recall some sections giving the encoder real trouble. Bumping bit rates just never cleaned things up properly for whatever reason ‚Ä¶</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/test.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/test-1024x576.jpg" alt="" width="660" height="371" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/test-1024x576.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/test-300x169.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/test-768x432.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/test-1536x864.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/test.jpg 1920w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-2.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-2.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-2.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-2-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-1.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-1.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-1.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-1-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>I don‚Äôt know why, but VMAF really likes PyroWave.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-1.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-1.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-1.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssim-1-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-1.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-1.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-1.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-1-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<h3>Stellar Blade</h3>
<p>Surprisingly easy to code. Must be the blurred backgrounds in play.</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/test-1.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/test-1-1024x576.jpg" alt="" width="660" height="371" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/test-1-1024x576.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/test-1-300x169.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/test-1-768x432.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/test-1-1536x864.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/test-1.jpg 1920w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-3.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-3.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-3.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-3-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-2.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-2.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-2.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-2-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-2.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-2.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-2.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssim-2-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-2.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-2.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-2.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-2-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>The use of FP16 kinda limits how high the PSNR can go. This is way beyond transparency, so, whatever.</p>
<h3>Street Fighter 6</h3>
<p>This scene is arguably a good argument for 4:4:4 ‚Ä¶</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/test-2.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/test-2-1024x576.jpg" alt="" width="660" height="371" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/test-2-1024x576.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/test-2-300x169.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/test-2-768x432.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/test-2-1536x864.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/test-2.jpg 1920w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-4.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-4.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-4.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-4-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-3.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-3.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-3.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-3-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-3.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-3.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-3.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssim-3-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-3.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-3.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-3.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-3-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<h3>FF VII Rebirth</h3>
<p>More foliage, which I expected to be kinda hard. The game‚Äôs presentation is very soft and it shows in the compression rates üôÇ</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/test-3.jpg"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/test-3-1024x576.jpg" alt="" width="660" height="371" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/test-3-1024x576.jpg 1024w, https://themaister.net/blog/wp-content/uploads/2025/06/test-3-300x169.jpg 300w, https://themaister.net/blog/wp-content/uploads/2025/06/test-3-768x432.jpg 768w, https://themaister.net/blog/wp-content/uploads/2025/06/test-3-1536x864.jpg 1536w, https://themaister.net/blog/wp-content/uploads/2025/06/test-3.jpg 1920w" sizes="auto, (max-width: 660px) 100vw, 660px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-5.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-5.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-5.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssimulacra2-5-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-4.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-4.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-4.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/vmaf-4-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>VMAF really seems like a joke metric for these use cases ‚Ä¶</p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-4.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-4.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/ssim-4.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/ssim-4-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p><a href="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-4.png"><img loading="lazy" decoding="async" src="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-4.png" alt="" width="700" height="500" srcset="https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-4.png 700w, https://themaister.net/blog/wp-content/uploads/2025/06/xpsnr-4-300x214.png 300w" sizes="auto, (max-width: 700px) 100vw, 700px"/></a></p>
<p>Another example of PSNR flattening off due to lowered internal precision.</p>
<h2>Conclusion</h2>
<p>I‚Äôm quite happy with this as-is, and having a 100% DIY streaming solution for my own use is fun.</p>
	</div><!-- .entry-content -->

	
	<!-- .entry-footer -->

</article></div>
  </body>
</html>
