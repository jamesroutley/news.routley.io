<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sidhion.com/blog/posts/nixos_server_issues/">Original</a>
    <h1>NixOS is a good server OS, except when it isn&#39;t</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Ever since I built my first NixOS system (I started by building a custom image to upload on DigitalOcean), I’ve been bothered by one thing:
the default installation size is large.
To give you an idea, this simple system (using flakes):</p>
<pre tabindex="0"><code>nixpkgs.lib.nixosSystem {
    system = &#34;x86_64-linux&#34;;
    modules = [
        (nixpkgs.outPath + &#34;/nixos/modules/profiles/minimal.nix&#34;)
        (nixpkgs.outPath + &#34;/nixos/modules/profiles/headless.nix&#34;)
        {
            fileSystems.&#34;/&#34;.device = &#34;/dev/sda1&#34;;
            boot.loader.systemd-boot.enable = true;
        }
    ];
}
</code></pre><p>ends up taking ~900MB of disk size on my system<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>!
Minimal and headless!</p>
<p>When I started working on improving this, I expected the eventual blog post to be very different than what it became, but you can’t win everything in life.
There’s a bit of pain ahead.</p>

<p>I really like Nix and NixOS (I wouldn’t be spending time <a href="https://sidhion.com/blog/posts/joining-nix-documentation/">helping with their documentation</a> otherwise).
After spending some time managing NixOS servers, I really can’t see myself going back to other systems unless required by some external factor.
I’m also working on a system that has worker machines which will spin up a bunch of microVMs.</p>
<p>Naturally, I wanted to use NixOS both for the worker machines and the microVMs themselves.
Currently, the system on the microVMs is taking ~210MB (including kernel) of disk space, but it’s based on <a href="https://alpinelinux.org/">Alpine</a>.
The worker machines are already using NixOS, but I’d like them to be as lean as possible.</p>
<p>NixOS makes it very simple to manage a server from the outside.
You can push an entirely new system configuration without the server changing its behaviour, and then almost atomically switch the server to the new configuration.
You can easily configure the whole thing deterministically, deploy the same configuration to multiple servers, and even deploy the same configuration under a VM so you can locally test things if you wish to.</p>
<p>I envisioned a world where all my worker machines ran the bare minimum software required for things to work, which would be an amazing help to lock the system down, prevent any escalations in case some piece of software was broken into, and would also make deployments and tests faster.</p>
<p>And if I could achieve something like that on those machines, why not extend this to the OS running on the microVMs and keep things really lean?
This would be super helpful to cut boot times as much as possible, short of using a unikernel.</p>
<p>I knew from my previous experience with NixOS that it didn’t generate lean images by default, so a couple days ago I started looking into this to see if I could fix things, or at least significantly improve them.</p>
<p><strong>Important:</strong> what follows is an analysis of NixOS specifically for the purposes stated here.
I don’t really care about having some runtime-flexible server OS which lets me install packages and configure things ad-hoc, I want a thin, locked-down server with the single purpose of running the software I declare, and not a single extra tool in it.
(yes, I know I essentially want containers without containers.
I comment on this at the end.)</p>

<p>A curious thing about the Nix ecosystem is that it has some pretty powerful tools, but they’re severely underdocumented, sometimes functionality is hidden by their naming, and/or some tools have some really specific assumptions, which makes it harder to use them more generally.</p>
<p>One such tool is <a href="https://nixos.org/manual/nix/stable/command-ref/nix-store/query"><code>nix-store --query</code></a> (to be honest, it is way more known than some other more “obscure” tools).
More specifically, <code>nix-store --query --tree</code> will give you a tree of packages<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>, starting from a package you specify, and show you the dependencies of that package, and their dependencies, and so on…
Running it will give you some output like this:</p>
<pre tabindex="0"><code>/nix/store/g4ppw7x76dyykj33x99xzf30zq5ym29z-nixos-system-nixos-24.05.20240323.44d0940
├───/nix/store/09fpwkb108ckhljahy7p84if7m8qh1wh-firmware
├───/nix/store/0v0wrr6ngh9d487lhwicwr5z61kz40zw-kmod-31
│   ├───/nix/store/1rm6sr6ixxzipv5358x0cmaw8rs84g2j-glibc-2.38-44
│   │   ├───/nix/store/3sxwxqzkkrgpgaibkm27ggb9kjbzdy31-xgcc-13.2.0-libgcc
│   │   ├───/nix/store/n9sq1bvghs9z0qg6cmwg27y4jmszwgqi-libidn2-2.3.7
│   │   │   ├───/nix/store/77yhmwrwism02371kzyda4d127kdwdnf-libunistring-1.1
│   │   │   │   └───/nix/store/77yhmwrwism02371kzyda4d127kdwdnf-libunistring-1.1 [...]
│   │   │   └───/nix/store/n9sq1bvghs9z0qg6cmwg27y4jmszwgqi-libidn2-2.3.7 [...]
...
</code></pre><p>To complement that, <code>nix-store --query --size</code> gives you (roughly) the size that a specific package takes on disk.
It’s slightly more complicated than this, but for our purposes it will be enough to understand how much disk is used.</p>
<p>There are some tools which help visualise all this information in cool ways.
Two of my favorites are <a href="https://github.com/utdemir/nix-tree">nix-tree</a> and <a href="https://github.com/craigmbooth/nix-visualize">nix-visualize</a>.
However, ideally I wanted an interactive graph so I could see each node in the graph by their size on disk, and inspect their dependencies, search things, and so on.
nix-visualize was the closest of the tools to give me a graph, but it wasn’t interactive and the node sizes weren’t based on disk usage, so I decided to write my own.</p>
<p>It took me some hours to come up with code that generated a <a href="https://graphviz.org/">graphviz</a> file, with node sizes based on disk usage.
Coupled with <a href="https://github.com/tintinweb/vscode-interactive-graphviz">vscode-interactive-graphviz</a>, I felt like I had a good approach to interactively working with the graph, but the visualisations turned out to be too crowded.
I tried to add some more space into things, but it was kind of a hack because graphviz likes to be the one to position elements.
In the end, I gave up on that idea and decided to just generate a CSV, which worked way better than I expected.
No wonder we still use spreadsheets for a lot of things!</p>
<p>The repository with the code and the final config of the NixOS system from this post is <a href="https://github.com/DanielSidhion/nixos-investigation">here</a>.</p>

<p>With a way to see each package, its disk usage, and all its dependencies, let’s look at the minimal, headless system I mentioned in the beginning of the post.
The one that takes ~900MB.</p>
<figure><img src="https://sidhion.com/nixos_bare_starting.png" alt="A list of the heaviest packages by disk usage, viewed with the Edit csv extension for VSCode"/><figcaption>
<p>A list of the heaviest packages by disk usage, viewed with the <a href="https://marketplace.visualstudio.com/items?itemName=janisdd.vscode-edit-csv">Edit csv</a> extension for VSCode</p>
</figcaption>
</figure>
<p>Each subsection below will be a small report of me investigating some items in this CSV<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup>.
It starts “easy” and gets progressively more complicated.
Feel free to skim and skip any part if you don’t feel like it.</p>
<h2 id="getting-rid-of-nix-179mb-reduction">Getting rid of Nix (~179MB reduction)</h2>
<p>The heaviest item in that list is a mysterious “source” package.
A quick look into what the heck could be taking 170MB of disk space shows it’s actually a complete copy of Nixpkgs!</p>
<pre tabindex="0"><code>❯ ls /nix/store/amxd2p02wx78nyaa4bkb0hjvgwhz1dq7-source
CONTRIBUTING.md  README.md    doc        lib          nixos
COPYING          default.nix  flake.nix  maintainers  pkgs
</code></pre><p>Searching for that package’s <code>pos</code> (just an identifier I used in the code that generates the CSV and the graphviz files) shows that it’s only used by this other package:</p>
<p><img src="https://sidhion.com/etc_nix_registry.png" alt="etc-nix-registry.json using that package"/></p>
<p>That package is a single file which doesn’t have a lot in it other than a link to the “source” package.
A search through Nixpkgs shows the file coming from <a href="https://github.com/NixOS/nixpkgs/blob/05677341df3102d5387629b7855afeff6069a6f3/nixos/modules/config/nix-flakes.nix#L90">here</a>, the actual content of <code>registry</code> coming from <a href="https://github.com/NixOS/nixpkgs/blob/6f414604e2a627ae3d8bc8f58573d8b50fb16829/nixos/modules/misc/nixpkgs-flake.nix#L91-L94">here</a>, and the <code>source</code> attribute being set <a href="https://github.com/NixOS/nixpkgs/blob/6f414604e2a627ae3d8bc8f58573d8b50fb16829/flake.nix#L39">here</a>.</p>
<p>I’m building this system with flakes and I’m using that <code>nixosSystem</code> function from Nixpkgs’s <code>flake.nix</code>, which means by default I get this extra 170MB in the system.
I <em>think</em> it would’ve been easy to just undo what Nixpkgs’s <code>flake.nix</code> is doing, but if you look at the list of the heaviest packages again, you’ll see that Nix itself is the 10th heaviest package in the system.</p>
<p>Nix also pulls a lot of dependencies, each one taking quite some space as well (for example, <code>aws-sdk-cpp-1.11.207</code> eats another 5.7MB by itself, and is <strong>only</strong> used by Nix).</p>
<p>After some thinking, I realised that I don’t need Nix in any of these systems.
I definitely don’t need it in a microVM, but I also don’t need it in my servers, because I’m building their configurations in an external machine and deploying the built bits directly.
So let’s add this to the system configuration:</p>
<pre tabindex="0"><code>nix.enable = false;
</code></pre><p>After rebuilding the system, we’re at ~733MB.</p>
<h2 id="getting-rid-of-perl-python-242mb-reduction">Getting rid of Perl, Python (~242MB reduction)</h2>
<p>After removing Nix, the 2nd heaviest package is Python3, and 3rd is Perl.</p>
<p>Python only comes in because of <code>install-systemd-boot.sh</code> (truly a shame, why waste so much disk space like this!), and Perl comes in through a bunch of perl-envs (search for <code>perl-5.38.2-env</code> in the CSV and you’ll see them).
Those perl-envs are all used in the top-level package, so let’s figure out where they’re being used there:</p>
<pre tabindex="0"><code>❯ grep -nr &#39;perl-5.38.2-env&#39; /nix/store/7z0y5sscnpx4hczzkjh3jvjgn2mq3106-nixos-system-nixos-24.05.20240323.44d0940
/nix/store/7z0y5sscnpx4hczzkjh3jvjgn2mq3106-nixos-system-nixos-24.05.20240323.44d0940/dry-activate:23:/nix/store/d3qxgm4ffhi2ixx3n9clwqlr6z21dd8i-perl-5.38.2-env/bin/perl \
/nix/store/7z0y5sscnpx4hczzkjh3jvjgn2mq3106-nixos-system-nixos-24.05.20240323.44d0940/activate:43:/nix/store/d3qxgm4ffhi2ixx3n9clwqlr6z21dd8i-perl-5.38.2-env/bin/perl \
/nix/store/7z0y5sscnpx4hczzkjh3jvjgn2mq3106-nixos-system-nixos-24.05.20240323.44d0940/activate:63:/nix/store/zkmm5iha0rsm4ypwfc67byq52gz0jb8b-perl-5.38.2-env/bin/perl /nix/store/rg5rf512szdxmnj9qal3wfdnpfsx38qi-setup-etc.pl /nix/store/jq5a0yw04ichvggf7dx80xc438z2v1gv-etc/etc
/nix/store/7z0y5sscnpx4hczzkjh3jvjgn2mq3106-nixos-system-nixos-24.05.20240323.44d0940/bin/switch-to-configuration:1:#! /nix/store/8mlvyl3sab5hxpxz2naz5g2sfd42a40q-perl-5.38.2-env/bin/perl
</code></pre><p>To make it easier to parse this bunch of text:
Perl is used in the <code>dry-activate</code>, <code>activate</code>, and <code>bin/switch-to-configuration</code> scripts.
<code>dry-activate</code> only needs Perl to run the <code>update-users-groups.pl</code> script, while the <code>activate</code> script runs the same script and also <code>setup-etc.pl</code>, and <code>bin/switch-to-configuration</code> is a Perl script from the beginning.</p>
<p><strong>Fun fact:</strong> the minimal profile disables man pages and most other documentation bits, but the perl man pages are the only thing that still get included in the system because of the perl-envs!</p>
<p>I thought Perl was going to be hard to remove, but I was determined to at least take a look.
After all, judging only by the naming, <code>update-users-groups.pl</code> doesn’t seem like the kind of thing I need - I don’t expect my servers to create any extra users or groups dynamically, so there’s nothing to update.</p>
<p>(note that I have no idea what <code>update-users-groups.pl</code> actually does, this was just my thinking from reading its name)</p>
<p>I decided to search Nixpkgs for that script name to get an idea of how it was being added to the system.
It was through this search that I stumbled upon a Nixpkgs tracking issue called <a href="https://github.com/NixOS/nixpkgs/issues/267982">Perlless Activation - Tracking Issue</a>.</p>
<p>Someone decided it wasn’t a good idea to have Perl in the base NixOS system for slightly different reasons, and they did a lot of work to get rid of it!
Luckily for me, I could piggyback off their work and include the following module in my system configuration:</p>
<pre tabindex="0"><code>modules = [
    ...
    (nixpkgs.outPath + &#34;/nixos/modules/profiles/perlless.nix&#34;)
];
</code></pre><p>After rebuilding the system, we’re at ~491MB.
As a bonus, Python is now gone as well!</p>
<h2 id="deduplicating-systemd-14mb-reduction">Deduplicating systemd (~14MB reduction)</h2>
<p>systemd is now the 2nd heaviest package.
It has some stuff inside that I think could be removed, but since it’s an integral part of the system, let’s overlook it for now.
Going through the list of packages, what’s this in 5th place?</p>
<p><img src="https://sidhion.com/systemd_minimal.png" alt="systemd-minimal is also in the list of packages!"/></p>
<p>For some reason, our NixOS system has both systemd <strong>and</strong> systemd-minimal!
A look through which packages use systemd-minimal show that only dbus uses it.
It comes from <a href="https://github.com/NixOS/nixpkgs/blob/71c7097220cf92a2b005d82904afc590e05b3a5a/pkgs/development/libraries/dbus/default.nix#L7">here</a>.</p>
<p>Nixpkgs has a lot of packages, and sometimes due to circular dependencies or to keep the size of dependencies smaller, it introduces variants of packages/functions that have reduced functionality.
If you contribute to Nixpkgs, chances are that at some point, someone will give some feedback on ways you can use variants that have a smaller dependency chain, or smaller size (a common example is using <code>stdenvNoCC</code> instead of <code>stdenv</code>).
systemd-minimal probably exists to avoid certain circular dependencies, but I’m not sure.
It’s defined <a href="https://github.com/NixOS/nixpkgs/blob/2726f127c15a4cc9810843b96cad73c7eb39e443/pkgs/top-level/all-packages.nix#L28207-L28251">here</a>.</p>
<p>In any case, I’d like to get rid of systemd-minimal, since we already have the full systemd in our system anyway.
There is no easy way to override the package used by the NixOS module that brings in dbus, so we’ll have to add a <a href="https://nixos.org/manual/nixpkgs/unstable/#chap-overlays">Nixpkgs overlay</a> to change the dbus package directly:</p>
<pre tabindex="0"><code>nixpkgs.overlays = [
(
    self: super:
    {
        dbus = super.dbus.override {
            systemdMinimal = self.systemd;
        };
    }
)
];
</code></pre><p>After rebuilding the system, we’re now at ~477MB.</p>
<h2 id="removing-udev-lvm-sudo-and-security-wrappers-30mb-reduction">Removing udev, lvm, sudo and security wrappers (~30MB reduction)</h2>
<p>This is where things start to get very messy.
While looking through the list of heaviest packages, I saw an “hwdb.bin” package which seems linked to udev.
I don’t know about udev too much, but it feels like it’s only needed for scenarios that won’t happen on the kind of servers I want to manage.</p>
<p>In case it is actually used for something important and this breaks the system, I have a feeling that a workaround could be hard-coded and wouldn’t require udev anyway.
I’d gladly go into that rabbit hole, but (spoiler alert) you’ll see that I gave up well before that.</p>
<p>There’s an option to disable it:</p>
<pre tabindex="0"><code>services.udev.enable = false;
</code></pre><p>While looking through the stuff adjacent to udev, I noticed that lvm is also enabled by default.
Similar reasoning to udev, I don’t think I’d need lvm for these servers, so I disabled it.</p>
<pre tabindex="0"><code>services.lvm.enable = false;
</code></pre><p>Before proceeding with more of this, I took a break and looked at some more packages in the list.
At that point, it became clear that I’d have to butcher a LOT of NixOS config to remove many packages in there.
I made a decision to continue with this exercise, but make it less about keeping a working system throughout and more about understanding the efforts to just get rid of some of these packages.
To get to a barebones system, I’d need to remove a lot of them.</p>
<p>While looking through the lvm stuff, I noticed fuse2 and fuse3 are hard-coded by default (and changing those gets complicated quickly).
I saw they’re used by some security wrappers, which also set other security wrappers for mount, umount, sudo, and a bunch of other binaries.
This is needed because Nix doesn’t support sid/gid binaries by design, so NixOS has a binary that dynamically sets some capabilities and permissions, and then executes any other binary with the elevated bits.</p>
<p>I don’t like having this functionality.
Instead of a single wrapper binary which receives an argument with the binary to execute with elevated permissions, I’d rather have X wrapper binaries with hardcoded paths and no parametrisation of any kind (one for each of the X things I want to execute), and that’s only IF I actually need this functionality.</p>
<p>For anything I want to run in these servers, I think I can configure the proper permissions through systemd unit configs.</p>
<p>The security wrappers module doesn’t have an <code>enable</code> option to toggle it off, so one way to get rid of it completely is to add it to the <a href="https://nixos.org/manual/nixos/unstable/#sec-replace-modules"><code>disabledModules</code> attribute</a>.
This requires me to provide dummy options that were provided by the security wrappers module earlier, because when building a NixOS system, by default <strong>every module</strong> gets evaluated (most of them just won’t do anything because they’re not enabled).
Some of these modules set additional wrappers, so the dummy options are needed to make the module system happy.</p>
<pre tabindex="0"><code>({ lib, pkgs, ... }: {
    disabledModules = [ &#34;security/wrappers/default.nix&#34; ];

    options.security = {
        wrappers = lib.mkOption {
            type = lib.types.attrs;
            default = { };
        };
        wrapperDir = lib.mkOption {
            type = lib.types.path;
            default = &#34;/run/wrappers/bin&#34;;
        };
    };

    config = {
        # ...
    };
})
</code></pre><p>I <em>think</em> doing this could break some script that calls mount or umount or fuse (because those are hardcoded in the security wrappers module), but I also think that most scripts that use those are being run directly as root, so I’m not sure.</p>
<p>To finish this section, let’s also disable sudo completely because it’s useless without its security wrapper.</p>
<pre tabindex="0"><code>security.sudo.enable = false;
</code></pre><p>We’re at ~447MB now.</p>
<h2 id="some-other-minimal-shenanigans">Some other minimal shenanigans</h2>
<p>At this point, the 10th and 11st heaviest packages are util-linux and util-linux-minimal, respectively.
Well, this seems similar to that systemd-minimal thing from a while ago!</p>
<p>Let’s look at where these are being used:</p>
<ul>
<li>util-linux
<ul>
<li>system-path, a bunch of systemd services and a “mount-pstore” shell script.</li>
</ul>
</li>
<li>util-linux-minimal
<ul>
<li>fuse2 and fuse3, and etc-systemd-system.conf</li>
</ul>
</li>
</ul>
<p>Removing fuse is very annoying (although to be honest, with all the mess in the config so far, it wouldn’t even look that bad anymore).
But we can at least try to make them use util-linux instead of util-linux-minimal, right?</p>
<p>To get there, let’s look at how these packages <a href="https://github.com/NixOS/nixpkgs/blob/6504cbb171517dc371c40b502a55fe4a32aad6d1/pkgs/top-level/all-packages.nix#L27345-L27349">are declared in <code>all-packages.nix</code></a>.
We’ll need an overlay, but trying to change <code>fusePackages</code> to use the normal util-linux will hit an infinite recursion error, so I’ll start by overlaying <code>fuse3</code>:</p>
<pre tabindex="0"><code>nixpkgs.overlays = [(
    self: super: {
        fuse3 = (self.lib.dontRecurseIntoAttrs (self.callPackage (nixpkgs.outPath + &#34;/pkgs/os-specific/linux/fuse&#34;) { })).fuse_3;
    }
)];
</code></pre><p>This builds nicely, but the moment I try to do this with fuse2, the infinite recursion error is back.
<em>Sigh</em>.
Whatever.</p>
<p>Browsing through the list of packages, I also see systemd-minimal-libs sneaking in there.
It’s being used by a bunch of other packages, and it’s equally difficult to add more overlays to get rid of it.
Infinite recursions all around.</p>
<p>This is where I look at the current system config, look at all the notes I made of things to look into that I haven’t yet (the list is right there in the next section), think about how much worse it’ll get by trying to fix all of this, and give up.</p>
<h2 id="things-i-noted-but-didnt-look-at">Things I noted, but didn’t look at</h2>
<ul>
<li>
<p>With Nix gone, the heaviest package was the linux kernel at ~136MB.
I know I can get it down to ~50MB easily (the kernel used by default on NixOS has a lot of modules and extra things that a server doesn’t need), so I left that for later because it was easy.</p>
</li>
<li>
<p>One disadvantage of a perlless system is that it can’t switch to a different configuration at runtime, because the script that does this is written in Perl.
This isn’t an issue for most of the servers in my scenario.
MicroVMs don’t need that, and I’d be perfectly ok just killing a bunch of other servers and starting new ones with the updated configuration.</p>
<p>However, I made a note to look into that perl script and figure out how much work it would be to build a replacement.
This is something that needs to happen anyway at some point, and would benefit the NixOS community at large.</p>
</li>
<li>
<p>A bunch of packages build with all locales and some internationalisation content.
Those end up taking some good space, so I made a note to look at how to simplify this and get rid of most of the locales and files I wouldn’t need.</p>
</li>
<li>
<p>The system has both libressl and openssl packages.
libressl is only used for netcat, but I don’t really need it in the servers.
In fact, NixOS includes a lot of utilities by default (and marks them as required, making it super annoying to remove them) which aren’t really needed on the servers.</p>
</li>
<li>
<p>A bunch of extra default config files that aren’t needed (such as bashrc) could be removed.
This would also remove some packages that they use, such as bash-completion, which won’t ever be needed in the servers.</p>
</li>
<li>
<p>coreutils and util-linux are both kind of heavy, but it’s very likely that the scripts and things that use them only really need a few binaries from each one.
Perhaps an overlay that filters the binaries only to the list that are used would help free up quite a bunch of disk space.</p>
</li>
<li>
<p><code>nix-store</code> has a command to <a href="https://nixos.org/manual/nix/stable/command-ref/nix-store/optimise">optimise</a> disk space by finding identical files and hard-linking them.
This could be helpful in some cases, but might not be possible in others, depending on how a server is imaged, or how new configuration gets pushed to it.
It could be useful to decrease the disk space used by some of those “-minimal” packages (as long as they share exactly the same file).</p>
</li>
</ul>
<h2 id="leaving-this-to-the-future">Leaving this to the future</h2>
<p>There is a huge audience that uses NixOS as a personal OS, and a lot of the defaults and modules present in NixOS reflect that.
NixOS can still be used as a server OS, but it requires a very different set of configurations, and it still ends up not being adequate in every situation.</p>
<p>I can (and will) still apply many of the configs I used in this post to my existing servers and make them leaner, which will already be useful, because it cuts ~300MB of stuff I don’t need.
I got some experience and figured out some tools to help me investigate these issues more whenever I feel the need to.</p>
<p>But over the 2 days I spent looking at this, I concluded that trying to mold NixOS into the shape I envisioned just isn’t the way to go, but I also don’t like the other option if I want to stick with it, which is creating a “fork” of NixOS that is <strong>very</strong> opinionated and completely focused on server scenarios.</p>
<p>I was trying to bring NixOS to a bare minimum, which is an exercise similar to building containers with the bare minimum required for the software in the container to run.
I think this is a worthy endeavour.
I think we have all the tools in regular non-docker, non-kubernetes linux to get to a similar outcome, except we won’t need docker or kubernetes or whatever in this new land, thus removing quite a bunch of complexity from the systems we build.</p>
<p>But doing it on top of NixOS currently feels like a bad path to take.</p>

</div></div>
  </body>
</html>
