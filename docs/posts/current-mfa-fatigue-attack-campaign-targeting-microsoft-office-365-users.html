<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.gosecure.net/blog/2022/02/14/current-mfa-fatigue-attack-campaign-targeting-microsoft-office-365-users/">Original</a>
    <h1>Current MFA fatigue attack campaign targeting Microsoft Office 365 users</h1>
    
    <div id="readability-page-1" class="page"><div>
					<p><img loading="lazy" src="https://notebook.wesleyac.com/wp-content/uploads/mfa-1024x682-1.jpg" alt="Multifactor Authentication Phone" width="661" height="440"/></p>

<h3>Current Attack Campaigns</h3>
<p>GoSecure Titan Labs identified new threat vectors using MFA Fatigue attacks based on recent investigations. Our team has also observed a significant increase in the number of attacks performed using this technique.</p>
<p>In the wild, highly motivated and known threat actors are <a target="_blank" href="https://www.mandiant.com/resources/russian-targeting-gov-business">actively using this kind of method to penetrate Office 365 accounts</a> and compromise entire organizations. As app-based authentication mechanisms are being adopted increasingly as a safer way to authenticate a user (versus SMS or phone call) it is expected that this tendency will grow in the future, even be encouraged by <a target="_blank" href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752">Microsoft itself</a>.</p>

<h3>What is MFA Fatigue?</h3>
<p>The term “MFA Fatigue” refers to the overload of notifications or prompts via MFA applications, in multiple accounts, that the user receives during the day to perform logins or approve different actions. It should not be confused with “<a target="_blank" href="https://en.wikipedia.org/wiki/Password_fatigue">Password Fatigue</a>” in which the user is overwhelmed with the number of passwords or PINs they must remember for multiple accounts or events. MFA Fatigue and Password Fatigue do share a similar theme, that the user is “fatigued” (or overwhelmed by volume) and will start setting security best practices aside and become careless, putting their organization and their accounts in danger of compromise. </p>
<p>As previously mentioned, MFA can use a diverse set of mediums to authenticate the user, such as SMS messages or phone calls where the user authenticates their identity via a pre-configured phone number. One Time Password or OTP is another way to verify the user’s identity by generating a passcode that is updated in fixed time intervals. Another choice is push notifications from an app. This  is the authentication method we are going to be focusing on, as it enables an attacker to perform a <b>push notification spamming</b> attack.</p>

<h4>What is Push Notification Spamming?</h4>
<p>This technique is simple as it only requires the attacker to manually, or even automatically, send repeated push notifications while trying to log into the victim’s account. The credentials used could be obtained via brute forcing, password reuse or spraying. Once the attacker obtains valid credentials, they will perform the push notification spamming repeatedly until the user approves the login attempt and lets the attacker gain access to the account. This usually happens because the user is distracted or overwhelmed by the notifications and, in some cases, it can be misinterpreted as a bug or confused with other legitimate authentication requests. </p>
<p>This attack is particularly effective not because of the technology involved, but because it targets the human factor of MFA. Many MFA users are not familiar with this type of attack  and would not understand they are approving a fraudulent notification. Others just want to make it disappear and are simply not aware of what they are doing since they approve similar notifications all the time. They can’t see through the ‘notification overload’ to spot the threat. </p>


<h3>How to Detect Multiple Push Notifications Attempts in Microsoft 365? </h3>
<p>Luckily, this type of attack can be detected directly from the <a target="_blank" href="https://portal.azure.com/">Azure portal</a> by inspecting the <a target="_blank" href="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins">Sign-in Logs</a>. We highly recommend that IT professionals take the following steps: </p>
<ol>
<li>Go to the <a target="_blank" href="https://aad.portal.azure.com/">Azure Active Directory</a> administration center.</li>
<li>Under the <b>Monitoring</b> you will find <b>Sign-in Logs</b>, where the information about user’s sign-ins and resources are logged.</li>
<li>Then filter the sign-in <b>Status</b> by <b>Failure</b> to obtain a list of MFA push notifications denied.<img loading="lazy" src="https://notebook.wesleyac.com/wp-content/uploads/sing-in-logs-1024x256-1.png" alt="Sing-in Logs" width="796" height="199"/></li>
<li>From here, start investigating each activity individually by going to the <b>Authentication Details</b>.</li>
<li>Multiple events should be seen as <b>Mobile app notification </b>under the Authentication Method column.</li>
<li>Push notifications spamming should be <b>false</b> under the Succeed column and <b>MFA denied; user declined the authentication</b> under Result detail.<img loading="lazy" src="https://notebook.wesleyac.com/wp-content/uploads/activity-details-logs-980x337-1.png" alt="Activity Details logs" width="1024" height="352"/></li>
</ol>

<h4>Log Analytics &amp; Sentinel</h4>
<p>Azure Log Analytics can also be used to analyze the queries in search of this kind of behavior. A query like this can retrieve a lot of information that can be used to detect these attacks: </p>
<pre>SigninLogs 
| where TimeGenerated &gt;= ago(31d) 
| where ResultType == 500121 
| where Status has &#34;MFA Denied; user declined the authentication&#34; </pre>
<p>This query should retrieve the entries found in the last month and can be customized to retrieve even more results or <a target="_blank" href="https://docs.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-log#create-a-log-alert-rule-in-the-azure-portal">create alert rules</a> to be notified based on the results of searches. </p>
<p>If Azure Sentinel is in use, then hunting queries can be applied to also catch, alert and even mitigate these attacks by implementing <a target="_blank" href="https://github.com/Azure/Azure-Sentinel/tree/master/Playbooks">playbooks</a> in response to matches. Some examples can be found in the <a target="_blank" href="https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/MultipleDataSources/AADPrivilegedAccountsFailedMFA.yaml">Azure Sentinel hunting queries repository</a>. </p>

<h3>How to Mitigate Push Notification Spamming</h3>
<p>There are many ways to mitigate this type of attack. Here, we are going to highlight some of them so that M365 administrators can choose whatever fits their needs. We are going focus on push notifications, since password complexity rules and password reuse mitigations should already be in place. </p>

<h4>Configuring Service Limits </h4>
<p>One effective way to protect your Microsoft 365 accounts against this attack is to configure the default limits of the Multi-Factor Authentication service. These limits, both default and maximum, can be found in <a target="_blank" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits#multi-factor-authentication-limits">Azure Resource Manager documentation</a>. </p>

<h4>Phone Sign-In </h4>
<p>A user can help prevent inadvertent access to their account by using the Microsoft Authenticator’s phone sign-in verification method. In this scenario, a unique two-digit number is generated and must be confirmed on both sides. This is very hard for an attacker to compromise since the attacker is shown a number that must be guessed in the phone (which the attacker doesn’t have access to). Only the attacker will know the number and to approve access, the user would have to pick a number out of three options. This way it will diminish the possibilities of approving said access. <a target="_blank" href="https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-authentication-passwordless-phone">Here you can learn more about this verification method</a>. </p>
<div id="attachment_3726"><p><img aria-describedby="caption-attachment-3726" loading="lazy" src="https://notebook.wesleyac.com/wp-content/uploads/phone-sign-in-1024x657-1.png" alt="Phone Sign-in" width="591" height="379"/></p><p id="caption-attachment-3726">Courtesy of Microsoft.</p></div>

<h4>Disable Push Notifications as Verification Method </h4>
<p>This is a radical move, but a quick solution as will disable the use of push notification as a <a target="_blank" href="https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-mfasettings#verification-methods">verification method</a>. These are the steps to make this change: </p>
<ol>
<li>Go to the <a target="_blank" href="https://aad.portal.azure.com/">Azure Active Directory</a> administration center. </li>
<li>Select <b>Per-user MFA</b>.</li>
<li>Under <b>Multi-factor Authentication</b> at the top of the page, select <b>Service Settings</b>.</li>
<li>On the <b>Service Settings</b> page, under <b>verification options</b>, and clear the <b>Notification through mobile app</b> checkbox.</li>
<li>Then click <b>Save</b>. </li>
</ol>

<h3>Conclusion <i></i></h3>
<p>As we discussed in this post, MFA Fatigue is a real concern with potential implications to compromise Microsoft Office 365 accounts, but there are many ways to protect ourselves from MFA Fatigue and the current rise in Push Notification Spamming attacks. To learn more about GoSecure Titan Labs latest updates and research, check this blog regularly and follow GoSecure on <a target="_blank" href="https://twitter.com/GoSecure_Inc">Twitter</a> and <a target="_blank" href="https://www.linkedin.com/company/gosecure/">LinkedIn</a>. </p>
</div></div>
  </body>
</html>
