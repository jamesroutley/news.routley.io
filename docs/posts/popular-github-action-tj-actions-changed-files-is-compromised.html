<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://semgrep.dev/blog/2025/popular-github-action-tj-actionschanged-files-is-compromised/">Original</a>
    <h1>Popular GitHub Action tj-actions/changed-files is compromised</h1>
    
    <div id="readability-page-1" class="page">
    <!-- Google Tag Manager (noscript) -->
    

    
      <section>
  
</section>
    
    
<section>
  <div>
    <div>
      <div>
        <div>
          
            <p><label>Security</label></p>
          <p>Popular GitHub Action tj-actions/changed-files has been compromised with a payload that appears to attempt to dump secrets, impacting thousands of CI pipelines.</p>
          
          
          <div>
            
  
    <div>
      <p><img src="https://semgrep.dev/assets/people/isaac-evans.jpeg"/></p><div>
        <p><span>Isaac Evans</span></p><p><a href="https://www.linkedin.com/in/isaacevans/" target="_blank">
              <img src="https://semgrep.dev/build/assets/linkedin-BOc8hy7f.svg"/>
            </a>
          

          
        </p>
      </div>
    </div>
  
    <div>
      <p><img src="https://semgrep.dev/assets/people/lewis-ardern.jpeg"/></p><div>
        <p><span>Lewis Ardern</span></p><p><a href="https://www.linkedin.com/in/lewis-ardern-83373a40/" target="_blank">
              <img src="https://semgrep.dev/build/assets/linkedin-BOc8hy7f.svg"/>
            </a>
          

          
        </p>
      </div>
    </div>
  
    <div>
      <p><img src="https://semgrep.dev/assets/people/kurt-boberg.jpg"/></p><div>
        <p><span>Kurt Boberg</span></p><p><a href="https://www.linkedin.com/in/kurt-boberg-00932664/" target="_blank">
              <img src="https://semgrep.dev/build/assets/linkedin-BOc8hy7f.svg"/>
            </a>
          

          
        </p>
      </div>
    </div>
  
    <div>
      <p><img src="https://semgrep.dev/assets/people/bence-nagy.jpeg"/></p><div>
        <p><span>Bence Nagy</span></p><p><a href="https://linkedin.com/in/underyx" target="_blank">
              <img src="https://semgrep.dev/build/assets/linkedin-BOc8hy7f.svg"/>
            </a>
          

          
        </p>
      </div>
    </div>
  

          </div><p>
          

          March 14th, 2025
        </p></div>
      </div>
    </div>
  </div>
</section>
<div>
  <div>
    <div>
      <div>
        <div>
          <div>
            <div>
              <div>
  
    <div>
  

   
   
  <p>
    Your privacy matters to us. By submitting this form, you agree to our <a href="https://semgrep.dev/legal/privacy/" target="_blank">Privacy Policy</a>
  </p>
  
</div>
  

  
</div>
            </div>
            <!-- TODO: INTEGRATE SHARE LINKS /-->

            
            
          </div>
        </div>
        <div>
          <main>
            <div>
              
                
                  <div>
                    <p>Popular GitHub Action <a rel="noopener noreferrer" href="https://github.com/tj-actions/changed-files">tj-actions/changed-files</a> has been compromised (<a rel="noopener noreferrer" href="https://github.com/tj-actions/changed-files/issues/2463">GitHub issue</a>) with a payload that appears to attempt to dump secrets, impacting thousands of CI pipelines. This isn’t the first security issue with tj-actions/changed-files—see prior vulnerability <a rel="noopener noreferrer" href="https://www.cve.org/CVERecord?id=CVE-2023-51664">CVE-2023-51664</a>.</p><h3>What you should do</h3><ol start="1"><li><p><strong>Find out where you&#39;re affected</strong></p><ol start="1"><li><p>The simplest way to find this is to grep for <code>tj-actions</code> in your codebase.</p></li><li><p>If you&#39;re on GitHub, look at the results of this query, replacing YOURORG with your organization&#39;s name on GitHub: </p></li><li><p>Arguably, Semgrep is overkill for this case. But Lewis Ardern on our team <a href="https://semgrep.dev/playground/r/10Uz5qo/semgrep.tj-actions-compromised">wrote a Semgrep rule to find usages of tj-actions</a>, which you can run locally (without sending code to the cloud) via: <code>semgrep --config r/10Uz5qo/semgrep.tj-actions-compromised</code>. And if we find more information about what tags &amp; commits are affected, we can update the rule over time to become more precise about whether or not you could be impacted. At time of writing, it looks like all versions are compromised.</p></li><li><p>For users of <a href="https://semgrep.dev/login">Semgrep AppSec Platform</a>, we recommend placing <a href="https://semgrep.dev/playground/r/10Uz5qo/semgrep.tj-actions-compromised">the detection rule in blocking mode immediately</a>: visit the rule, click “add to policy”, and select “blocking mode.”</p></li></ol></li></ol><ol start="2"><li><p><strong>Stop using </strong><code>tj-actions/changed-files</code><strong> immediately.</strong> Switch to a safer alternative or inline your file-change detection logic.</p><ol start="1"><li><p>Just removing it from the main branch of your repository won’t be enough — it could still run on other branches depending on how your actions are configured. So you need to remove it from <strong>all</strong> branches to be safe.</p></li><li><p>As an alternative, <a href="https://docs.github.com/en/organizations/managing-organization-settings/disabling-or-limiting-github-actions-for-your-organization#allowing-select-actions-and-reusable-workflows-to-run">GitHub has a feature that lets you allow-list GitHub actions</a> so you can ensure it won’t run, even if it’s still in your code.</p><ol start="1"><li><p>You’ll need a list of GitHub Actions used at your org. Run this query on your codebase:</p><pre><code>$ semgrep -e &#39;uses: $ACTION&#39; -l yaml --json .github  | jq -r &#39;.results[].extra.metavars[&#34;$ACTION&#34;].abstract_content&#39; | grep -vE &#39;^(actions/|docker://|[.]/[.]github/|tj-actions/)&#39; | awk -F&#39;@&#39; &#39;{print $1 &#34;@*,&#34;}&#39; | sort | uniq
DataDog/synthetics-ci-github-action@*,
actions-rs/toolchain@*,
astral-sh/setup-uv@*,
aws-actions/amazon-ecr-login@*,</code></pre></li><li><p>Remove tj-actions/changed-files from the list of GitHub Actions.</p></li><li><p>Go to GitHub settings and configure like this at:</p></li></ol></li><li><p><strong>Generally, pin all GitHub Actions to specific commit SHAs (rather than version tags) you know are safe.</strong> In this case, it appears that all versions are compromised.</p></li><li><p><strong>Audit past workflow runs for signs of compromise.</strong> Check logs for suspicious outbound network requests. Prioritize repos where your CI runner logs are public, as secrets are dumped to stdout in the payload.</p></li></ol></li></ol><h3>Affected versions</h3><p>At time of writing (2025-03-14T23:55:00Z), we assessed by inspecting tag pointers in the source repo that all versions of tj-actions/changed-files are compromised. Users may verify with <code>git tag --points-at 0e58ed8</code> . See <a href="https://github.com/tj-actions/changed-files/commit/0e58ed8671d6b60d0890c21b07f8835ace038e67">commit 0e58ed8</a> in <a href="https://github.com/tj-actions/changed-files.">https://github.com/tj-actions/changed-files.</a></p><h3>Further reading</h3><ul><li><p><a href="https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised">StepSecurity’s Incident Analysis</a></p></li><li><p><a href="https://github.com/tj-actions/changed-files/issues/2463">https://github.com/tj-actions/changed-files/issues/2463</a></p></li><li><p><a href="https://www.cve.org/CVERecord?id=CVE-2023-51664">CVE-2023-51664</a></p></li></ul>
                  </div>
                
               
            </div>
          </main>
          <div>
  <header>
    <h4>About</h4>
    <img src="https://semgrep.dev/build/assets/semgrep-logo-dark-F_zJCZNg.svg"/>
  </header>
  <p>
    Semgrep lets security teams partner with developers and shift left organically, without introducing friction. Semgrep gives security teams confidence that they are only surfacing true, actionable issues to developers, and makes it easy for developers to fix these issues in their existing environments. 
  </p>
</div>
        </div>
      </div>
    </div>
  </div>
  <section>
  <div>
    <div>
      <div>
        
          <h4>Featured posts from the <a href="https://semgrep.dev/blog">Semgrep blog</a>, written by our engineering team</h4>
        
        
      </div>
    </div>
  </div>
</section>
    
  <section>
  <div>
    <div>
      <div>
        <div>
          <header>
            
            <h3>Find and fix the issues that matter before build time</h3>
          </header><p>
          Semgrep helps organizations shift left without the developer productivity tax.
          
            </p>
          
        </div>
      </div>
    </div>
  </div>
  
</section>
</div>
    
        
    
  

</div>
  </body>
</html>
