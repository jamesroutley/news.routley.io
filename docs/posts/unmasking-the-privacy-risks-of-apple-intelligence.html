<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.lumia.security/blog/applestorm">Original</a>
    <h1>Unmasking the Privacy Risks of Apple Intelligence</h1>
    
    <div id="readability-page-1" class="page"><div fs-toc-offsettop="4rem" fs-richtext-element="rich-text" fs-toc-element="contents"><h2>Executive Summary</h2><ul role="list"><li>Lumia’s Research Team revealed that messages dictated via Siri, including WhatsApp and iMessage are not sent to the Private Cloud Compute. In fact, there is no assurance as to what Apple does with these messages.</li><li>Siri transmits metadata about installed and active apps without the user’s ability to control these privacy settings.</li><li>Audio playback metadata such as ‘recording names’, is sent without consent. No user control or visibility exists over these background data flows.</li><li>Apple uses two distinct privacy policies (Siri vs. Apple Intelligence), meaning similar queries may fall under different data-handling rules.</li></ul><h2>TL;DR</h2><p>We reveal AppleStorm, our investigation into how Apple AI’s eco-system quietly transmits messages (WhatsApp, iMessage) sent via Siri to Apple servers, even when it isn’t needed to complete the task. This happens without the user having any control whatsoever over when and what can be sent.Also more data than messages is sent to Siri’s servers. Let’s deep dive.</p><h2>Introduction</h2><p>Lately, Apple’s AI has been making headlines. From promising robust security measures to developing localized models that process data directly on devices, Apple has positioned itself as a champion of privacy and productivity.</p><p>How safe are these innovations? Despite the numerous advancements, recent news has highlighted critical concerns about Apple’s AI suite. A lawsuit regarding <a href="https://www.forbes.com/sites/kateoflahertyuk/2025/01/06/apple-siri-eavesdropping-payout-heres-whos-eligible-and-how-to-claim/" target="_blank">Siri eavesdropping,</a> settled last January, raises questions about user privacy. More recently, allegations surfaced that Apple Intelligence generated <a href="https://www.bbc.com/news/articles/cq5ggew08eyo" target="_blank">false notifications,</a> including a summary of BBC news with inaccurate information on behalf of the BBC.</p><p>When Apple launched Apple Intelligence which relied on on-device and cloud models <a href="https://security.apple.com/blog/private-cloud-compute/" target="_blank">(Private Cloud Compute)</a> they introduced a variety of AI tools such as Writing Tools, Image Background and Siri is even more powerful with the capabilities of Apple Intelligence.</p><p>Before technologies like these get out of control, it&#39;s crucial to identify any potential security loopholes we might be overlooking. This blog explores privacy risks and unusual behaviors discovered regarding Siri and intersection of Siri and Apple Intelligence.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689355b3b726ba1ac2b9a627_img_2.png" loading="lazy" alt=""/></p><figcaption>Siri as taken from <a href="https://www.apple.com/apple-intelligence/" target="_blank">Apple Intelligence website</a></figcaption></figure><h2>Apple Intelligence 101</h2><p>Apple Intelligence relies on a <a href="https://machinelearning.apple.com/research/introducing-apple-foundation-models" target="_blank">hybrid infrastructure</a> that combines <strong>on-device processing</strong> with <strong>Apple-managed cloud servers</strong> to provide AI-driven features while maintaining strong privacy protections. The cloud component primarily operates through <strong>Private Cloud Compute (PCC).</strong></p><p><strong>‍</strong>But Siri also interacts with other Apple’s server infrastructures that are outside of the Apple Intelligence’s PCC.</p><p>The services that make up Apple’s AI apps can mainly be broken down into four groups, which are listed below. This is based on Apple’s guide for using <a href="https://support.apple.com/en-us/101555" target="_blank">Apple’s products on enterprise networks.</a></p><ol start="" role="list"><li>Private Cloud Compute (PCC)</li><li>Siri’s Dictation Servers</li><li>Siri’s Search Services</li><li>Use Case-Driven Collection</li></ol><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689355cdb726ba1ac2b9b53b_img_3.png" loading="lazy" alt=""/></p><figcaption>Apple’s Private Cloud Compute architecture</figcaption></figure><h2>Creating a Research Environment</h2><p><strong>Prerequisite</strong></p><ul role="list"><li>Disabling <a href="https://developer.apple.com/documentation/security/disabling-and-enabling-system-integrity-protection" target="_blank">Apple’s SIP mechanism</a></li></ul><p><strong>Operating System &amp; Platform</strong></p><ul role="list"><li>macOS Sequoia</li><li>Apple Intelligence enabled</li></ul><p><strong>Tools Used</strong></p><ol start="" role="list"><li>mitmproxy – An interactive HTTPS proxy.</li><li>Frida – A dynamic instrumentation toolkit.</li></ol><h2>What is the Weather Today?</h2><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689355ebfb9adb19ea346e45_img_4.png" loading="lazy" alt=""/></p></figure><p>To investigate, the open-source proxy tool <strong>mitmproxy</strong> was used to intercept Siri’s network traffic. Initially, simple prompts such as &#34;Hello&#34;, &#34;What can you do?&#34; and &#34;What is the time right now?&#34; were tested, but no network activity was observed, suggesting that these queries could be handled locally without requiring external communication.</p><p>Since some queries might be handled locally, it was necessary to issue a prompt that would require external evaluation. Testing the query <strong>&#34;What is the weather today?&#34; </strong>resulted in the transmission of two packets.</p><p>The first packet was directed to <strong>guzzoni.apple.com,</strong> identified as Apple&#39;s dictation server, but we can’t see any content.</p><p>The second packet, sent to <strong>api-glb-aeun1a.smoot.apple.com,</strong> the search service for Siri. Let’s start with this one.</p><p>After extracting and decompressing the frame, the <strong>ProtoBuf-Inspector</strong> Python library was used to parse the ProtoBuf data. Without access to the original.proto files used to compile the data, the analysis required a best-effort approach to interpret the content. </p><p>Let’s see what we can find.</p><h3>App Lists</h3><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689488ed25ecc2a313fd1bf8_img_5.png" loading="lazy" alt=""/></p><figcaption>Unpinned traffic — Decoded packet</figcaption></figure><p>The first app listed was the official Apple Weather app, which was expected. However, the second one raised questions—it appeared to be related to <strong>Parallels,</strong> a virtual desktop Mac application that enables running the Windows operating system. A review of the Parallels settings on the device, including the applications running within the virtual machine, showed the following information:</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/6894851eadfc5c8fcbcae246_img_6.png" loading="lazy" alt=""/></p><figcaption>App id from a virtual machine that appears in Siri communication</figcaption></figure><p>This turned out to be the ID of the official Windows Weather app installed on the virtual machine.</p><p>Based on this observation, it appears that <strong>Siri scans the device for apps related to the prompt’s topic.</strong> To test this theory, a question about emails was entered, and the packet revealed a list of all email clients installed on the device.</p><p>So, it’s confirmed — <strong>Siri actively searches for apps on the device that match the topic of the prompt, and reports them back to Apple.</strong></p><h3>Precise Location</h3><p>A question arises: how does Siri determine the weather without the location being mentioned in the prompt? A review of the ProtoBuf content revealed two numbers next to the apps list that appear to be coordinates.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/6894853b290acee435855108_img_7.png" loading="lazy" alt=""/></p><figcaption>Location coordinates sent in the packet</figcaption></figure><p>A quick Google search confirmed this theory, showing the cafe I was working from.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/68935977e65f14896e89c332_img_8.png" loading="lazy" alt=""/></p><figcaption>Coordinates point to my accurate location</figcaption></figure><p>According to <a href="https://www.apple.com/legal/privacy/data/en/ask-siri-dictation/">Siri’s Privacy Policy</a> (Notice it&#39;s Siri&#39;s privacy policy and not Apple Intelligence. More on that soon), they specifically mention this behavior. In fact, it is possible to disable location sharing information with Siri, but if you do consent to location sharing, <strong>your location will be appended to every request</strong> (regardless of the necessity).</p><blockquote>Once again, personal information is being leaked. This raises the question of what else Apple knows about our habits.</blockquote><h3>Audio Metadata</h3><p>During the investigation of the weather request packet, the following content was encountered:</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/6894854925ecc2a313f9fdaa_img_9.png" loading="lazy" alt=""/></p></figure><p>Initially, the appearance of a confidential document title from the Notion app in Siri’s traffic was surprising.</p><p>Once again, <strong>personal information is being leaked.</strong> This raises the question of what else Apple knows about our habits. We still have other traffic that we cannot see. Maybe Apple uses some pinning mechanism…</p><h2>Pinned Traffic</h2><p><strong>What is Certificate Pinning</strong></p><p><strong>Certificate Pinning </strong>is an additional security measure used to protect against <strong>machine-in-the-middle (MITM) attacks</strong> and fraudulent certificates. Instead of relying solely on the Certificate Authority system, pinning allows a website or application to specify which exact certificate or public key should be trusted when connecting to a particular domain. This prevents attackers from tricking users into accepting a malicious certificate issued by a compromised or unauthorized CA.</p><p><strong>Bypassing the Certificate Pinning</strong></p><p>Under macOS Sequoia’s SSL pinning mechanism, each SSL context uses a dedicated verification routine. To bypass the pinning, we could modify the behavior to skip the verification. To achieve this, we must alter Apple’s built-in verification logic by hooking the relevant symbols in Siri’s process - assistantd.</p><p>Using Frida, we created <a href="https://github.com/LumiaSecurity/mitmproxy-ace/blob/main/disable_certificate_pinning.js">this</a> script to disable the pinning.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/6894857b60d806c9cb9bc655_img_10.png" loading="lazy" alt=""/></p><figcaption>Siri’s pinned traffic headers</figcaption></figure><h3>More Apps?</h3><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/68935b765d648a65905d895c_img_11.png" loading="lazy" alt=""/></p><figcaption>Active process list in Siri’s traffic</figcaption></figure><p>Among the recognizable strings in the ACE packet, many correspond to familiar application names, clearly indicating that these are the apps currently active on the device.</p><p>So, it’s cleared — <strong>Siri actively looks for open apps on the device, and reports them back to Apple’s servers.</strong></p><h3>End-to-End Encryption? I’m Not Sure</h3><p>One of the main features of Siri is the ability to interact with different apps on the device, like summarizing notes, composing emails and more.</p><p>Siri has the functionality to send messages to contacts in WhatsApp. For example, you can ask Siri, by voice or text (Using Apple Intelligence), “Send the message Good morning to Bob” and it will send the message “Good morning” to a contact named Bob.</p><p>While recording the traffic of Siri while sending a message with Siri, a single, pinned packet is generated. Extracting it shows that it contains a base64 string. Decoding it revealed the following:</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689487a61134bfb813d636ed_img_12.png" loading="lazy" alt=""/></p></figure><p>Siri indeed <strong>sends</strong> the content of the WhatsApp message, the recipient phone number and other identifiers back to Apple’s servers.</p><p>This raises a significant concern about WhatsApp’s end-to-end encryption, as the messages are apparently leaving the device even though they were sent from the device itself.</p><p>Initially, I suspected this might be due to the Siri and Apple Intelligence settings that allow it to “learn” from certain apps; however, the behaviour persists even when not permitting them to learn from WhatsApp.</p><p>However, sending a message to WhatsApp via Siri also works when blocking communication between Siri to Apple’s servers. The heavy processing already occurred (reasoning the target application is WhatsApp, who the recipient is, and the message to send) so why is it sent externally, and to a server that isn’t part of Private Cloud Compute? If all data resides locally, why is there any need to send it to their servers?</p><p>So, it’s clear — Siri has access to your WhatsApp messages sent via Siri (but not to messages sent outside of Siri), and reports them back to Apple’s servers, regardless of whether permission is granted for learning from them.</p><h2>What Happens When It Comes to ChatGPT</h2><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/68937d2bde5653169bcf936a_img_13.png" loading="lazy" alt=""/></p></figure><p>Disclosure Process and Apple’s ResponseWe informed Apple of this privacy issue in February 2025. In March 2025, after some back and forth with their security team and sending additional information, Apple acknowledged the issue and said they will be working towards a fix.However, in July 2025, Apple reached out to say that this is actually not a privacy issue related to Apple Intelligence. Rather it’s a privacy issue related to the usage of third party services that rely on Siri. For example, the misuse of SiriKit (Siri’s extension that allows third party integrations to Siri) by WhatsApp.</p><p>Via Apple Intelligence, users can interact with ChatGPT through Siri and Writing Tools. For example, Siri can tap into ChatGPT to provide answers when that might be helpful for certain requests.</p><p>According to Apple, every request to ChatGPT is routed through Apple Intelligence’s Extensions service. This happens also if you use your private or business account.</p><p>However, when using Siri, these requests are duplicated: requests are sent to the extensions’s service and to Siri servers. The request to Siri’s servers is redundant for the user.</p><h2>Disclosure Process and Apple’s Response</h2><p>We informed Apple of this privacy issue in February 2025. In March 2025, after some back and forth with their security team and sending additional information, Apple acknowledged the issue and said they will be working towards a fix.</p><p>However, in July 2025, Apple reached out to say that this is actually <strong>not a privacy issue related to Apple Intelligence.</strong> Rather it’s a privacy issue related to the usage of third party services that rely on Siri. For example, the misuse of SiriKit (Siri’s extension that allows third party integrations to Siri) by WhatsApp.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/68935f3f30098db69ee803e3_img_14.png" loading="lazy" alt=""/></p></figure><p>After a quick overview, we saw the same behavior on iMessage as that of WhatsApp when sending a message via Siri. So, before reaching WhatsApp on this issue I took this matter deeply. I built an app, straight from Apple’s documentation, that uses SiriKit with messaging integration, and I was amazed to see the same behavior also happening in this test.</p><p>Apple also explicitly mentioned that Siri’s servers are not part of Apple’s Private Cloud Compute. It seems that there are features that belong to Siri core and other features that are based on Apple Intelligence. The user, however, is unaware of which is used when.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689485ea311359f02185a4a1_img_15.png" loading="lazy" alt=""/></p><figcaption>Message sent via Siri through a custom app built from Apple’s documentation</figcaption></figure><h2>Two Privacy Policies, Two Practices, Same App</h2><p>Herein the privacy issues become even further complex: when you dictate a message to Siri, two underlying flows might happen - you might be using Siri flows, but you may also be using Apple Intelligence flows. As a user, you have no idea if Siri will take on its flow, and when it will take on its Apple Intelligence flow.</p><p>For example, the query: “Hey Siri, what is the weather today?” will send the data to Siri servers. However, the query: “Hey Siri, ask ChatGPT what is the weather today?” will send the message to Apple Intelligence’s Private Cloud Compute. </p><p>Two similar questions, two different traffic flows, two different privacy policies.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/689360ce7196382ef51fb63d_img_16.png" loading="lazy" alt=""/></p><figcaption>A single interface, two terms of use, two privacy policies.</figcaption></figure><h2>Potential Mitigations</h2><p>For organizations managing Apple devices, we recommend taking on a three-prong approach:</p><ol start="" role="list"><li>Firewall and network restrictions on Siri domains<ul role="list"><li>Set your firewall to block any network traffic to Siri’s dictation domain, guzzoni.apple.com. This should not hinder any Siri functionality</li><li>For stricter environments, setting your firewall to also block Siri’s search domain smoot.apple.com and its subdomains is also possible, though it will impair Siri capabilities.</li></ul></li><li>Apple device and knowledge sharing policies<ul role="list"><li>Disable any “Learn from this app” settings to be on the safe side.</li></ul></li><li>Network traffic analysis and monitoring<ul role="list"><li>Create a policy on AI usage for employees and place necessary controls for enforcement.</li><li>Monitor your network traffic to gain visibility into AI usage across the organization. With this visibility, you can hone your controls to ensure compliance with the defined policy.</li></ul></li></ol><h2>Why it Matters</h2><p>On a smaller, personal scale, this means that sensitive data is leaving your Apple device unnecessarily, shattering your privacy expectations and giving you limited, perhaps even zero, control over your data.</p><p>For enterprises, it raises serious compliance and security risks when sensitive corporate information leaks outside the organization’s network.</p><p>This leads to a wider discussion, as this issue goes beyond just Apple and its incorporation of AI. AI capabilities are now all around us. Any typical app these days incorporates AI, whether it’s Grammarly, Canva or Salesforce. Knowing when a feature is powered by AI or not, is not really trivial anymore, and it requires understanding of the technical flow of the feature — something that a typical user has no time, skill or desire to do.</p><figure><p><img src="https://cdn.prod.website-files.com/688b0aebbdc1dbb6fcf296d5/68937737ad38c72d02341064_img_17.png" loading="lazy" alt=""/></p></figure><h2>How Lumia Can Help</h2><p>At Lumia, our mission is to help organizations adopt AI safely, responsibly, and governed — without disrupting productivity.</p><p>Apple Intelligence is just one aspect in the world of AI. However, the findings of our AppleStorm research highlight why visibility and control are essential in the age of AI-powered productivity tools. Lumia’s platform provides full visibility into AI-related data flows across thousands of applications and protocols, including hidden behaviors like those we uncovered in Siri.</p></div></div>
  </body>
</html>
