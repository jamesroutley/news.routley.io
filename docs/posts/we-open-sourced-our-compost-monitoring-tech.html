<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/gtls64/MontyHome-Hackers-Guide">Original</a>
    <h1>Show HN: We open-sourced our compost monitoring tech</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Welcome to the <strong>Monty Home Device Hacking Guide</strong> repository! This guide provides step-by-step instructions for extending the functionality of the Monty Home BLE device using a Raspberry Pi. Originally designed for compost monitoring, the Monty Home device collects valuable data on temperature, humidity, and other environmental metrics. Through this guide, you’ll learn how to retrieve, display, and automate actions based on this data.</p>

<p dir="auto"><a href="https://montycompost.co/" rel="nofollow">https://montycompost.co/</a></p>

<ul dir="auto">
<li><a href="#overview">Overview</a></li>
<li><a href="#projects">Projects</a>
<ul dir="auto">
<li><a href="#project-1-temperature-based-led-control">Project 1: Temperature-Based LED Control</a></li>
<li><a href="#project-2-display-temperature-and-humidity-on-i2c-display">Project 2: Display Temperature and Humidity on I2C Display</a></li>
<li><a href="#project-3-temperature-alert-via-ifttt">Project 3: Temperature Alert via IFTTT</a></li>
</ul>
</li>
<li><a href="#setup">Setup</a>
<ul dir="auto">
<li><a href="#hardware-requirements">Hardware Requirements</a></li>
<li><a href="#software-requirements">Software Requirements</a></li>
</ul>
</li>
<li><a href="#ble-commands">BLE Commands</a></li>
<li><a href="#running-the-code">Running the Code</a></li>
<li><a href="#customization">Customization</a></li>
<li><a href="#additional-resources">Additional Resources</a></li>
</ul>
<hr/>

<p dir="auto">This guide is designed for anyone interested in working with Bluetooth Low Energy (BLE) devices, IoT applications, or environmental monitoring. The Monty Home device communicates over BLE, providing real-time data on temperature, humidity, battery level, and more. In this repository, you’ll find three projects that use Python, BLE, and Raspberry Pi to interact with the Monty Home device.</p>
<p dir="auto">Each project covers different functionalities:</p>
<ol dir="auto">
<li><strong>Basic LED Control Based on Temperature Thresholds</strong></li>
<li><strong>Displaying Data on an OLED Screen Using I2C</strong></li>
<li><strong>Sending Notifications via IFTTT When Conditions Are Met</strong></li>
</ol>
<hr/>

<div dir="auto"><h3 tabindex="-1" dir="auto">Project 1: Temperature-Based LED Control</h3><a id="user-content-project-1-temperature-based-led-control" aria-label="Permalink: Project 1: Temperature-Based LED Control" href="#project-1-temperature-based-led-control"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Objective</strong>: Use the temperature data from the Monty Home device to control an LED on the Raspberry Pi. If the temperature exceeds a specified threshold, the LED lights up to indicate a warning.</p>
<p dir="auto"><strong>Skills Gained</strong>:</p>
<ul dir="auto">
<li>Setting up GPIO control for an LED.</li>
<li>Querying BLE data.</li>
<li>Basic Python programming and condition handling.</li>
</ul>
<p dir="auto"><strong>Hardware Needed</strong>:</p>
<ul dir="auto">
<li>Raspberry Pi with BLE support</li>
<li>LED and 330-ohm resistor</li>
</ul>
<hr/>
<div dir="auto"><h3 tabindex="-1" dir="auto">Project 2: Display Temperature and Humidity on I2C Display</h3><a id="user-content-project-2-display-temperature-and-humidity-on-i2c-display" aria-label="Permalink: Project 2: Display Temperature and Humidity on I2C Display" href="#project-2-display-temperature-and-humidity-on-i2c-display"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Objective</strong>: Display real-time temperature and humidity data from the Monty Home device on an OLED screen connected to the Raspberry Pi.</p>
<p dir="auto"><strong>Skills Gained</strong>:</p>
<ul dir="auto">
<li>Working with I2C devices.</li>
<li>Displaying dynamic data using the SSD1306 OLED display.</li>
<li>Implementing BLE data retrieval and display updates.</li>
</ul>
<p dir="auto"><strong>Hardware Needed</strong>:</p>
<ul dir="auto">
<li>Raspberry Pi with BLE support</li>
<li>SSD1306 OLED Display (128x32 or 128x64)</li>
</ul>
<hr/>
<div dir="auto"><h3 tabindex="-1" dir="auto">Project 3: Temperature Alert via IFTTT</h3><a id="user-content-project-3-temperature-alert-via-ifttt" aria-label="Permalink: Project 3: Temperature Alert via IFTTT" href="#project-3-temperature-alert-via-ifttt"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Objective</strong>: Configure the Raspberry Pi to send a notification via IFTTT if the temperature from the Monty Home device exceeds a specific threshold.</p>
<p dir="auto"><strong>Skills Gained</strong>:</p>
<ul dir="auto">
<li>Integrating with IFTTT for IoT automation.</li>
<li>Sending HTTP requests with the <code>requests</code> library.</li>
<li>Combining BLE data with cloud-based notifications.</li>
</ul>
<p dir="auto"><strong>Hardware Needed</strong>:</p>
<ul dir="auto">
<li>Raspberry Pi with Wi-Fi</li>
<li>IFTTT account</li>
</ul>
<hr/>


<ol dir="auto">
<li><strong>Raspberry Pi</strong> (Zero 2 or another model with BLE support).</li>
<li><strong>Monty Home BLE Device</strong>.</li>
<li>Additional hardware specific to each project, such as an LED, OLED display, and IFTTT account.</li>
</ol>

<ol dir="auto">
<li><strong>Raspberry Pi OS</strong>: Install Raspberry Pi OS Lite (for headless) or Raspberry Pi OS with Desktop (for graphical interface).</li>
<li><strong>Python 3</strong>: Make sure Python 3 and <code>pip</code> are installed.</li>
<li><strong>Libraries</strong>:
<ul dir="auto">
<li><strong>Bleak</strong> for BLE communication: <code>pip install bleak</code></li>
<li><strong>Requests</strong> for IFTTT integration: <code>pip install requests</code></li>
<li><strong>Adafruit CircuitPython SSD1306</strong> for OLED control: <code>pip install adafruit-circuitpython-ssd1306</code></li>
<li><strong>Pillow</strong> for image manipulation on OLED: <code>pip install pillow</code></li>
</ul>
</li>
</ol>
<hr/>

<p dir="auto">Use these commands to interact with the Monty Home device. Each command requests specific data or performs an action. You can replace or modify commands in the Python scripts as needed.</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>;QA\r\n</code></td>
<td>Returns the index of all data in flash memory.</td>
</tr>
<tr>
<td><code>;QP\r\n</code></td>
<td>Returns index of pending data in flash memory.</td>
</tr>
<tr>
<td><code>;QR\r\n</code></td>
<td>Returns a record by index, NACK if index not found.</td>
</tr>
<tr>
<td><code>;QS\r\n</code></td>
<td>Returns the status of the device.</td>
</tr>
<tr>
<td><code>;QL\r\n</code></td>
<td>Returns the battery level as a percentage.</td>
</tr>
<tr>
<td><code>;QT\r\n</code></td>
<td>Returns the temperature reading from the NTC sensor.</td>
</tr>
<tr>
<td><code>;QH\r\n</code></td>
<td>Returns the relative humidity reading.</td>
</tr>
<tr>
<td><code>;QO\r\n</code></td>
<td>Returns the most recent TVOC reading.</td>
</tr>
<tr>
<td><code>;QC\r\n</code></td>
<td>Returns the most recent CO2 reading.</td>
</tr>
<tr>
<td><code>;QU\r\n</code></td>
<td>Returns the unique ID of the device.</td>
</tr>
<tr>
<td><code>;QV\r\n</code></td>
<td>Returns the firmware version of the device.</td>
</tr>
<tr>
<td><code>;CR\r\n</code></td>
<td>Reboots the device.</td>
</tr>
<tr>
<td><code>;CF\r\n</code></td>
<td>Performs a factory reset.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>

<p dir="auto">Each project contains a Python script that establishes a BLE connection, sends queries, and processes data. To run a script:</p>
<ol dir="auto">
<li>Open a terminal on the Raspberry Pi.</li>
<li>Navigate to the project folder:

</li>
<li>Run the script:
<div dir="auto" data-snippet-clipboard-copy-content="python3 project_script.py"><pre>python3 project_script.py</pre></div>
Replace <code>project_script.py</code> with the actual script file name, such as <code>project1_temperature_led.py</code>.</li>
</ol>
<hr/>


<p dir="auto">You can modify the BLE commands in the code to retrieve different types of data from the Monty Home device. For example, to query humidity instead of temperature, replace:</p>

<p dir="auto">with:</p>

<div dir="auto"><h3 tabindex="-1" dir="auto">Expanding Notification Handlers</h3><a id="user-content-expanding-notification-handlers" aria-label="Permalink: Expanding Notification Handlers" href="#expanding-notification-handlers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To process multiple types of data (e.g., temperature, humidity), add conditions within the <code>notification_handler</code> function to decode and display different readings.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Integrating with Other Platforms</h3><a id="user-content-integrating-with-other-platforms" aria-label="Permalink: Integrating with Other Platforms" href="#integrating-with-other-platforms"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Consider integrating data into IoT platforms or dashboards for real-time data visualization, logging, or further automation.</p>
<hr/>

<ul dir="auto">
<li><a href="https://realpython.com/python-raspberry-pi/" rel="nofollow">Python on Raspberry Pi</a></li>
<li><a href="https://www.instructables.com/Control-Bluetooth-LE-Devices-From-A-Raspberry-Pi/" rel="nofollow">BLE on Raspberry Pi Guide</a></li>
<li><a href="https://ifttt.com/maker_webhooks" rel="nofollow">IFTTT Webhooks Documentation</a></li>
<li><a href="https://learn.adafruit.com/monochrome-oled-breakouts" rel="nofollow">Adafruit CircuitPython SSD1306 Guide</a></li>
</ul>
<hr/>

<p dir="auto">Feel free to submit pull requests, report issues, or suggest features. Any contributions to improve this guide and add new projects are welcome!</p>
<hr/>
<p dir="auto">This README provides everything needed for users to get started with BLE communication, project setup, and code customization. Let me know if you need further details or additional sections!</p>
</article></div></div>
  </body>
</html>
