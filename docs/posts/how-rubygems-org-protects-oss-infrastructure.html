<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.rubygems.org/2025/08/25/rubygems-security-response.html">Original</a>
    <h1>How RubyGems.org protects OSS infrastructure</h1>
    
    <div id="readability-page-1" class="page"><div>
      
        <p>Recently, Socket.dev published <a href="https://socket.dev/blog/60-malicious-ruby-gems-used-in-targeted-credential-theft-campaign">research</a> highlighting malicious gems
designed to steal social media credentials. We wanted to use this as an
opportunity to share more about how RubyGems.org security operates, how
we proactively handled this incident (and others), and the work our team
is doing each day to keep the ecosystem safe.</p>



<p><strong>RubyGems.org security uses a proactive and multi-layered approach:</strong></p>

<p><strong>1. Automated detection:</strong> Every gem upload is analyzed using both
static and dynamic code analysis, including behavioral checks and
metadata review. Much of this capability comes from Mend.io’s
supply chain security tooling (originally built by our own Maciej
Mensfeld, a maintainer on the RubyGems team).</p>

<p><strong>2. Risk scoring:</strong> Each package is given a score. Higher-risk gems
are escalated for manual review by a member of our security team.</p>

<p><strong>3. Retroactive scanning:</strong> As detection techniques improve, older
packages are automatically rescanned, which allows us to catch
threats that may have slipped through in the past. (This is how we
found the threat actor that Socket.dev later investigated.)</p>

<p><strong>4. External sources:</strong> We sometimes receive alerts from vulnerability
databases, industry partners, and cross-registry collaborations,
which help us identify patterns across ecosystems.</p>

<p>Through steps 1 - 3, our team detects the majority (roughly 70-80%) of
malicious packages before they are ever reported to us or the public.</p>



<p><strong>Once a gem is flagged, we:</strong></p>

<p><strong>1. Verify:</strong> A RubyGems security engineer reviews the code to confirm
malicious intent (about 95% of flagged packages prove to be
legitimate).</p>

<p><strong>2. Double-check:</strong> When there’s any doubt, we seek a second opinion
within the team.</p>

<p><strong>3. Remove:</strong> Confirmed malicious gems are removed via a standardized
process in our admin panel.</p>

<p><strong>4. Document:</strong> Every action is logged with reasoning for
traceability.</p>

<p><strong>5. Protect further:</strong> In some cases, we preemptively block suspicious
gem names (for example, ones mimicking company internals) to
prevent possible abuse.</p>



<p><strong>This is the timeline of the actions our team took concerning the
incident reported by Socket.dev:</strong></p>

<ul>
  <li>
    <p><strong>July 20, 2025 –</strong> Our systems flagged suspicious gems, and the
team confirmed malicious credential-stealing behavior. We would
like to specifically credit RubyGems maintainer Maciej Mensfeld
for this.</p>
  </li>
  <li>
    <p><strong>July 23–28 –</strong> We removed nearly all of the affected packages
and terminated the associated accounts. We would like to
acknowledge again Maciej Mensfeld for his security work here, as
well as Josef Šimánek, who provided a second opinion and helped
with package removal.</p>
  </li>
  <li>
    <p><strong>August 7 –</strong> Socket.dev published their report and notified us of
16 additional gems from related accounts, which we also removed.</p>
  </li>
</ul>

<p>In total, we removed all malicious packages from this threat actor,
including two not covered in the original report.</p>

<p>Socket.dev has also <a href="https://socket.dev/blog/follow-up-on-malicious-ruby-gems-campaign">published an updated accounting</a> of this incident
after talking directly with our team and clarifying key details about
our response.</p>

<p><strong>It’s also important to note:</strong> this campaign involved a small number
of gems. Widely used and trusted packages were not affected.</p>



<p>We welcome and encourage researchers and community members to work with
us by reporting issues through these channels:</p>

<ul>
  <li>
    <p><strong>Email:</strong> You can also reach us at
<a href="mailto:security@rubygems.org">security@rubygems.org</a>.</p>
  </li>
  <li>
    <p><strong>Slack:</strong> Join the <a href="https://join.slack.com/t/bundler/shared_invite/zt-1rrsuuv3m-OmXKWQf8K6iSla4~F1DBjQ">Bundler
Slack</a>
to connect with the RubyGems.org team and community of committers
and developers.</p>
  </li>
</ul>

<p>Once we receive reports, we acknowledge them, review them quickly, and
follow up with the person who made the report. We are grateful for every
contribution that helps keep RubyGems and the Ruby ecosystem secure.</p>



<p>RubyGems.org is smaller than ecosystems like
<a href="https://github.com/npm">npm</a> but malicious activity is
still a serious threat. On average, we remove about one malicious or
spam package per week, though that number can spike higher.</p>

<p>This work is resource-intensive. Most of our efforts are currently
supported by sponsors, including <a href="http://mend.io">Mend.io</a>
and <a href="https://alpha-omega.dev/">Alpha-Omega</a>, but a
significant portion of time comes from contributions by volunteer
maintainers. Many of these maintainers have personally dedicated over a
decade to this critical work, driven by their passion and commitment to
keeping the Ruby ecosystem secure.</p>

<p><strong>If your company depends on RubyGems.org, consider supporting its
maintenance and security directly through our <a href="https://rubycentral.org/news/rubygems-org-funding-model-a-new-path-for-community-led-growth/">RubyGems Supporter
Program</a>.</strong>
Community funding enables us to continue to invest in the people,
infrastructure, and security work that keep RubyGems safe and keep
RubyGems.org a community-led service.</p>



<p><strong>This recent incident shows our security systems working as intended:</strong>
threats were detected, removed, and contained before they could cause
widespread harm.</p>

<p>Security in open source will always be a shared effort. We want to thank
Socket.dev for their research, as well as the broader community for
continuing to report issues.</p>

<p>You are welcome to reach out to us through the above channels if you
have any additional questions.</p>

<p><em>RubyGems Security Team</em></p>

      
    </div></div>
  </body>
</html>
