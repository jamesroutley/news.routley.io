<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://crypto.stackexchange.com/questions/99767/how-easy-is-it-in-2022-to-find-a-sha1-collision">Original</a>
    <h1>How easy is it in 2022 to find a SHA1 collision?</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="text">
<p>According to some <a href="https://openbenchmarking.org/test/pts/hashcat&amp;eval=306f31f896ee6afac758df6db7589b6a2a232723#metrics" rel="noreferrer">Hashcat benchmarks</a>, a current Nvidia GPU can compute SHA-1 hashes at a rate of:</p>
<blockquote>
<ul>
<li>NVIDIA GeForce RTX 3090    ~22.6×10<sup>9</sup> hashes per second</li>
<li>NVIDIA GeForce RTX 3080 Ti ~21.7×10<sup>9</sup> hashes per second</li>
</ul>
</blockquote>
<p>And AMD graphics cards seems to perform in the same range as per <a href="https://gist.github.com/epixoip/99085955a1145ff61ec83512a50421a7" rel="noreferrer">this benchmark</a>:</p>
<blockquote>
<p>SHA-1 Speed.#1.........: 20.6×10<sup>9</sup></p>
</blockquote>
<p>Given its MSRP price of ~\$649, the AMD RX 6800 XT seems to be our best candidate to conduct a similar attack. (Notwithstanding any chip shortage driving the prices up like crazy...)</p>
<p>Next, according to the 2017 <a href="https://shattered.it/" rel="noreferrer">shattered.it</a> website and paper:</p>
<blockquote>
<p>This attack required over 9,223,372,036,854,775,808 SHA1 computations [9×10<sup>18</sup>]. This took the equivalent processing power as 6,500 years of single-CPU computations and 110 years of single-GPU computations.</p>
</blockquote>
<p>But as mentioned in <a href="https://crypto.stackexchange.com/questions/99767/how-easy-is-it-in-2022-to-find-a-sha1-collision#comment215623_99767">fgrieu&#39;s comment</a>, in 2020, <a href="https://eprint.iacr.org/2020/014.pdf" rel="noreferrer">a new paper (&#34;SHA-1 is a Shambles&#34;)</a> came out, further improving the SHAttered attack in which they estimated the cost of their attack to <span>$~2^{61.6} = 3.5\times 10^{18}$</span> SHA-1 computations vs. the <span>$2^{63}$</span> computations in the SHAttered one (see Table 4.)</p>
<p>We can thus compute that with the current GPUs it takes:</p>
<p><span>$$\frac{2^{61.6}}{20.6×10^9} \approx 169\times10^6$$</span></p>
<p>seconds with a single GPU, which is ~5.36 years.
But this parallelizes relatively well, so you could just add more GPUs to the mix and you could get one in six months with 10 GPUs, or in 2 months with 30 GPUs... And that&#39;s at a theoretical cost of ~\$19,470 of GPUs, plus ~ \$2,000 of electricity costs running your 30 GPUs for 2 months...</p>
<p>You can also just rent three p3.16xlarge AWS instance <a href="https://gist.github.com/iam1980/808f696a14b0c42b26621a01f91a8b18" rel="noreferrer">with a hash rate of ~135GH/s</a> each at a cost of ~\$24.48 per instance per hour, for a total of 405GH/s for \$73.44 per hour. That would take you ~2397.12 hours (3 months) and cost you ~\$176,044.</p>
<p>Remarkably, we can see that in only 5 years, we&#39;re down from an attack costing ~110 GPU years to an attack costing ~8 GPU-years in 2020 (thanks to theoretical improvements &amp; newer GPUs) to just ~5.4 GPU years nowadays (thanks to newer, faster GPUs).</p>
<p>Also note that this is not taking possible ASICs into account, unlike <a href="https://www.pure.ed.ac.uk/ws/portalfiles/portal/208131275/On_The_Cost_CHATTOPADHYAY_DOA18022021_AFV.pdf" rel="noreferrer">this 2021 paper (&#34;On The Cost of ASIC Hardware Crackers: A SHA-1 Case Study&#34;)</a> which answers your question when assuming custom ASICs are an option:</p>
<blockquote>
<p>In particular, we remark that the chosen-prefix collisions for SHA-1 can be generated in under a minute, with an ASIC cluster that costs a few dozen Millions dollars. Such ability would allow an attacker to apply the SLOTH attack on TLS or SSH connections using SHA-1.</p>
</blockquote>
    </div></div>
  </body>
</html>
