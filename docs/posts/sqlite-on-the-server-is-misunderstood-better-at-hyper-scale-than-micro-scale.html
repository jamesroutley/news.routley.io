<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rivet.gg/blog/2025-02-16-sqlite-on-the-server-is-misunderstood">Original</a>
    <h1>SQLite-on-the-server is misunderstood: Better at hyper-scale than micro-scale</h1>
    
    <div id="readability-page-1" class="page"><article><img blurwidth="8" blurheight="4" alt="Promo Image" loading="lazy" width="2334" height="1024" decoding="async" data-nimg="1" src="https://cranberrymuffin.github.io/_next/static/media/image.f86d756a.png"/>
<p>We&#39;re Rivet, a new open-source, self-hostable serverless platform. We&#39;ve been in the weeds with SQLite-on-the-server recently and – boy – do we have a lot of thoughts to share. <a href="https://github.com/rivet-gg/rivet">Give us a star on GitHub</a>, we&#39;ll be sharing a lot more about SQLite soon!</p>
<p>There&#39;s been <a href="https://lobste.rs/s/t1enph/siren_call_sqlite_on_server">a lot of discussion</a> recently about the pros and cons of SQLite on the server. After reading many of these conversations, I realized that my perspective on the power of SQLite-on-the-server is lopsided from popular opinion: SQLite&#39;s strengths really shine at scale, instead of with small hobbyist deployments that it&#39;s frequently referenced in.</p>
<hr/>
<p>Before jumping in to my perspective on the benefits of SQLite at scale, it&#39;s helpful to understand some background on SQLite-on-the-server for micro-scale apps.</p>

<img loading="lazy" width="2500" height="1786" decoding="async" data-nimg="1" src="https://cranberrymuffin.github.io/_next/static/media/sqlite-microscale.5d171f3e.png"/>
<p>Most developers consider server-side SQLite a simple, cost-effective choice for small-scale applications. It&#39;s often valued for:</p>
<ul>
<li><strong>Low infrastructure costs</strong>: No need for separate database servers—just a single file.</li>
<li><strong>Seamless development and testing</strong>: The same database file can be used across client and server.</li>
<li><strong>Minimal management overhead</strong>: No complex configurations or database daemons.</li>
<li><strong>Proven reliability</strong>: It&#39;s been around forever. It&#39;s the <a href="https://www.sqlite.org/mostdeployed.html">world&#39;s most widely deployed database</a> and <a href="https://hackernoon.com/the-story-of-dwayne-richard-hipp-and-the-development-of-sqlite-in-1999-yc4v356q">built to withstand battleships getting blown to bits</a>.</li>
</ul>
<p>These characteristics make SQLite an attractive option for personal projects, lightweight applications, and prototypes.</p>

<p>Tools like <a href="https://github.com/superfly/litefs">LiteFS</a>, <a href="https://litestream.io/">Litestream</a>, <a href="https://github.com/rqlite/rqlite">rqlite</a>, <a href="https://dqlite.io/">Dqlite</a>, and <a href="https://bedrockdb.com/">Bedrock</a> enhance SQLite with replication and high availability for micro-scale deployments.</p>
<p>However, this post focuses on <a href="https://developers.cloudflare.com/durable-objects/get-started/tutorial-with-sql-api/">Cloudflare Durable Objects</a> and <a href="https://turso.tech/">Turso</a> to highlight the often-overlooked advantages of SQLite at scale.</p>
<hr/><h2 id="databases-at-hyper-scale-today-sharded-databases-and-partitioning-keys"><a href="#databases-at-hyper-scale-today-sharded-databases-and-partitioning-keys"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#databases-at-hyper-scale-today-sharded-databases-and-partitioning-keys">Databases at Hyper-Scale Today: Sharded Databases &amp; Partitioning Keys</a></h2>
<img loading="lazy" width="1934" height="2178" decoding="async" data-nimg="1" src="https://cranberrymuffin.github.io/_next/static/media/cassandra.bb9addd0.png"/>
<p>In high-scale systems, companies frequently struggle scaling databases like <a href="https://www.postgresql.org/">Postgres</a> or <a href="https://www.mysql.com/">MySQL</a>. Instead, they often turn to sharded databases such as <a href="https://cassandra.apache.org/">Cassandra</a>, <a href="https://www.scylladb.com/">ScyllaDB</a>, <a href="https://aws.amazon.com/dynamodb/">DynamoDB</a>, <a href="https://vitess.io/">Vitess</a> (sharded MySQL), and <a href="https://www.citusdata.com/">Citus</a> (sharded Postgres).</p>
<p>These systems use partitioning keys to co-locate related &amp; similarly structured data. For example, a typical chat application on Cassandra might define:</p>
<div><div><div dir="ltr"><div data-radix-scroll-area-viewport=""><p><span><pre tabindex="0"><code><span><span>CREATE</span><span> TABLE</span><span> chat_channel</span><span> (</span></span>
<span><span>    -- Partition Key: Groups all messages for a single chat in the same partition</span></span>
<span><span>    channel_id UUID,</span></span>
<span></span>
<span><span>    -- Clustering Key: Orders messages within the chat (think ORDER BY)</span></span>
<span><span>    sent_at </span><span>TIMESTAMP</span><span>,</span></span>
<span><span>    message_id UUID,</span></span>
<span></span>
<span><span>    -- Row data</span></span>
<span><span>    message</span><span> TEXT</span><span>,</span></span>
<span></span>
<span><span>    PRIMARY KEY</span><span> (channel_id, sent_at, message_id)</span></span>
<span><span>) </span><span>WITH</span><span> CLUSTERING </span><span>ORDER BY</span><span> (sent_at </span><span>ASC</span><span>, message_id </span><span>ASC</span><span>);</span></span>
<span></span></code></pre></span></p></div></div></div><div><div><p>schema.cql</p></div></div></div>
<p>To query messages from this partition, you could write:</p>
<div><div><div dir="ltr"><div data-radix-scroll-area-viewport=""><p><span><pre tabindex="0"><code><span><span>SELECT</span><span> *</span><span> FROM</span><span> user_chat </span><span>WHERE</span><span> channel_id </span><span>=</span><span> ? </span><span>ORDER BY</span><span> sent_at </span><span>ASC</span><span>, message_id </span><span>ASC</span><span>;</span></span>
<span></span></code></pre></span></p></div></div></div><div><div><p>query.cql</p></div></div></div>
<h3 id="benefits-of-sharded-databases"><a href="#benefits-of-sharded-databases"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#benefits-of-sharded-databases">Benefits of Sharded Databases</a></h3>
<p>Sharded databases power almost every large tech company because they provide:</p>
<ul>
<li>Efficient batch reads with data grouped in the same partition.</li>
<li>Horizontal scalability by partitioning data across nodes.</li>
<li>Optimized writes for high-ingestion workloads</li>
</ul>
<div role="alert"><h5><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="lightbulb-on" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M69.3 4l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3S58.3-3.3 69.3 4zM597.3 44l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zM24 160l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm528 0l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM117.3 332l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zm432-39.9l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3s22.3-14 33.3-6.7zm-100.1 5.7c-19.8 27.1-39.7 54.4-49.2 86.2l-160 0c-9.6-31.9-29.5-59.1-49.2-86.2c0 0 0 0 0 0s0 0 0 0c-5.2-7.1-10.4-14.2-15.4-21.4C155.6 247.9 144 213.3 144 176C144 78.8 222.8 0 320 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3c-5 7.2-10.2 14.3-15.4 21.4c0 0 0 0 0 0s0 0 0 0zM400 432c0 44.2-35.8 80-80 80s-80-35.8-80-80l0-16 160 0 0 16zM320 96c8.8 0 16-7.2 16-16s-7.2-16-16-16c-61.9 0-112 50.1-112 112c0 8.8 7.2 16 16 16s16-7.2 16-16c0-44.2 35.8-80 80-80z"></path></svg>Fun Fact</h5><p>Apple runs the world&#39;s largest known number of Cassandra/ScyllaDB instances <a href="https://x.com/erickramirezau/status/1578063811495477248">with roughly 300,000 nodes as of 2022</a>. Almost all large companies have shared that they also run massive clusters of partitioned databases in the thousands of nodes.</p></div>
<h3 id="challenges-with-current-partitioning-solutions"><a href="#challenges-with-current-partitioning-solutions"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#challenges-with-current-partitioning-solutions">Challenges with Current Partitioning Solutions</a></h3>
<p>While partitioning strategies improve scalability, they introduce significant challenges:</p>
<ul>
<li><strong>Rigid schemas</strong>: Unlike Postgres or MySQL, the schema must exactly match the intended query patterns exactly, limiting flexibility.</li>
<li><strong>Complex schema changes</strong>: Adding a new index or relation requires significant operational overhead to create &amp; populate a new table in a live system.</li>
<li><strong>Complex cross-partition operations</strong>: Enforcing ACID properties across partitions is difficult. Companies often resort to complicated <a href="https://en.wikipedia.org/wiki/Two-phase_commit_protocol">two-phase commits</a> or design with an acceptable level of data inconsistency.</li>
<li><strong>Data inconsistency</strong>: Without strong constraints between tables &amp; partitions, data frequently becomes &#34;dirty&#34; because of interrupted transactions or failure to propagate changes.</li>
</ul>
<hr/><h2 id="enter-sq-lite-at-scale-cloudflare-durable-objects-and-turso"><a href="#enter-sq-lite-at-scale-cloudflare-durable-objects-and-turso"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#enter-sq-lite-at-scale-cloudflare-durable-objects-and-turso">Enter SQLite at Scale: Cloudflare Durable Objects &amp; Turso</a></h2>
<p><a href="https://developers.cloudflare.com/durable-objects/get-started/tutorial-with-sql-api/">Cloudflare Durable Objects</a> and <a href="https://turso.tech/">Turso</a> demonstrate how SQLite will change how hyper-scale applications may be architected in the future.</p>
<p>These databases provide:</p>
<ul>
<li><strong>Dynamic scaling</strong>: Instantly provision databases per entity, reducing infrastructure complexity.</li>
<li><strong>Infinite, cheap databases</strong>: Similar to partitions, you can spawn an infinite number of SQLite databases because they are incredibly cheap to create &amp; manage.</li>
<li><strong>Global distribution</strong>: Databases are placed closer to users, improving query performance.</li>
<li><strong>Built-in replication and durability</strong>: Unlike traditional SQLite, these services replicate data across multiple regions for high availability.</li>
</ul>
<h3 id="a-better-hyper-scale-database-sq-lite-database-per-partition"><a href="#a-better-hyper-scale-database-sq-lite-database-per-partition"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#a-better-hyper-scale-database-sq-lite-database-per-partition">A Better Hyper-Scale Database: SQLite Database Per Partition</a></h3>
<img loading="lazy" width="1674" height="2172" decoding="async" data-nimg="1" src="https://cranberrymuffin.github.io/_next/static/media/sqlite-hyperscale.94d4d0af.png"/>
<p>Using SQLite with Cloudflare Durable Objects &amp; Turso allows defining databases per entity, effectively replacing partitioning keys.</p>
<p>Instead of storing chat logs in a single partition, each chat channel can have its own SQLite database that also includes more tables, like participants and reactions. A sample schema could look like this:</p>
<div><div><div dir="ltr"><div data-radix-scroll-area-viewport=""><p><span><pre tabindex="0"><code><span><span>-- Notice there is no channel_id in this table, since all of this data is local</span></span>
<span><span>-- to a single SQLite database per channel.</span></span>
<span><span>--</span></span>
<span><span>-- The channel ID will be specified when defining which Durable Object to</span></span>
<span><span>-- connect to below (see )`CHAT_DO.idFromName(channelId)` below.</span></span>
<span><span>CREATE</span><span> TABLE</span><span> messages</span><span> (</span></span>
<span><span>  id </span><span>INTEGER</span><span> PRIMARY KEY</span><span>,</span></span>
<span><span>  sent_at </span><span>TIMESTAMP</span><span>,</span></span>
<span><span>  sender_id UUID,</span></span>
<span><span>  message</span><span> TEXT</span></span>
<span><span>);</span></span>
<span></span>
<span><span>CREATE</span><span> INDEX</span><span> ON</span><span> messages (sent_at </span><span>ASC</span><span>);</span></span>
<span></span>
<span><span>CREATE</span><span> TABLE</span><span> participants</span><span> (</span></span>
<span><span>  user_id UUID </span><span>PRIMARY KEY</span><span>,</span></span>
<span><span>  joined_at </span><span>TIMESTAMP</span></span>
<span><span>);</span></span>
<span></span></code></pre></span></p></div></div></div><div><div><p>schema.sql</p></div></div></div>
<p>From Cloudflare Durable Objects or Turso, this SQLite partition database could be queried like this:</p>
<div><div dir="ltr" data-orientation="horizontal"><div dir="ltr"><div data-radix-scroll-area-viewport=""><div></div></div></div><div data-state="active" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-:R9ekvffbmtdb:-trigger-cloudflare_worker.js" id="radix-:R9ekvffbmtdb:-content-cloudflare_worker.js" tabindex="0"><div><div><div dir="ltr"><div data-radix-scroll-area-viewport=""><p><span><pre tabindex="0"><code><span><span>// This Durable Object represents one partition</span></span>
<span><span>//</span></span>
<span><span>// It contains a completely isolated SQLite database</span></span>
<span><span>export</span><span> class</span><span> ChatChannel</span><span> extends</span><span> DurableObject</span><span> {</span></span>
<span><span>  async</span><span> getMessages</span><span>() {</span></span>
<span><span>    // Execute query</span></span>
<span><span>    let</span><span> result </span><span>=</span><span> this</span><span>.</span><span>ctx</span><span>.</span><span>storage</span><span>.</span><span>sql</span><span>.exec</span><span>(</span><span>&#39;SELECT * FROM messages ORDER BY sent_at ASC&#39;</span><span>)</span><span>.one</span><span>();</span></span>
<span><span>    return</span><span> result;</span></span>
<span><span>  }</span></span>
<span><span>}</span></span>
<span></span>
<span><span>function</span><span> getMessages</span><span>(channelId</span><span>:</span><span> string</span><span>) {</span></span>
<span><span>  // Here, the channel ID corresponds to the database partition</span></span>
<span><span>  const</span><span> id</span><span> =</span><span> env</span><span>.</span><span>CHAT_CHANNEL_DURABLE_OBJECT</span><span>.idFromName</span><span>(channelId);</span></span>
<span><span>  const</span><span> channelDurableObject</span><span> =</span><span> c</span><span>.</span><span>env</span><span>.</span><span>CHAT_CHANNEL_DURABLE_OBJECT</span><span>.get</span><span>(id);</span></span>
<span></span>
<span><span>  // Execute the query</span></span>
<span><span>  return</span><span> await</span><span> channelDurableObject</span><span>.getMessages</span><span>();</span></span>
<span><span>}</span></span>
<span></span></code></pre></span></p></div></div></div><div></div></div></div></div></div>
<h3 id="benefits-of-sq-lite-per-partition"><a href="#benefits-of-sq-lite-per-partition"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#benefits-of-sq-lite-per-partition">Benefits of SQLite-Per-Partition</a></h3>
<ul>
<li><strong>Local ACID transactions</strong>: Complex SQL queries can be within each partition without cross-partition complexities.</li>
<li><strong>Efficient I/O</strong>: SQLite enables performing complex queries within the partition with very high performance.</li>
<li><strong>Leverage existing SQLite extensions</strong>: SQLite has a rich ecosystem of existing extensions, such as <a href="https://www.sqlite.org/fts5.html">FTS5</a>, <a href="https://www.sqlite.org/json1.html">JSON1</a>, <a href="https://www.sqlite.org/rtree.html">R*Tree</a>, and <a href="https://www.gaia-gis.it/fossil/libspatialite/index">SpatiaLite</a>.</li>
<li><strong>Full Power of SQL migrations</strong>: SQLite provides the full power of SQL migrations &amp; leveraging existing migrations tools such as Drizzle &amp; Prisma.</li>
<li><strong>Lazy schema migrations</strong>: Changing schema is tricky at scale. Assuming your migrations are lightweight, they can be executed on demand after the SQLite database is opened at the cost of a slightly higher p99 after deploys.</li>
</ul>
<div role="alert"><h5><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="lightbulb-on" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M69.3 4l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3S58.3-3.3 69.3 4zM597.3 44l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zM24 160l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm528 0l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM117.3 332l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zm432-39.9l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3s22.3-14 33.3-6.7zm-100.1 5.7c-19.8 27.1-39.7 54.4-49.2 86.2l-160 0c-9.6-31.9-29.5-59.1-49.2-86.2c0 0 0 0 0 0s0 0 0 0c-5.2-7.1-10.4-14.2-15.4-21.4C155.6 247.9 144 213.3 144 176C144 78.8 222.8 0 320 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3c-5 7.2-10.2 14.3-15.4 21.4c0 0 0 0 0 0s0 0 0 0zM400 432c0 44.2-35.8 80-80 80s-80-35.8-80-80l0-16 160 0 0 16zM320 96c8.8 0 16-7.2 16-16s-7.2-16-16-16c-61.9 0-112 50.1-112 112c0 8.8 7.2 16 16 16s16-7.2 16-16c0-44.2 35.8-80 80-80z"></path></svg>Who are the Turso founders?</h5><p>It&#39;s no coincidence that the founders of Turso used to work at ScyllaDB, where they saw firsthand the complexities of large-scale partitioned databases on a daily basis.</p></div>
<hr/><h2 id="where-sq-lite-still-falls-short"><a href="#where-sq-lite-still-falls-short"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#where-sq-lite-still-falls-short">Where SQLite Still Falls Short</a></h2>
<p>Despite its benefits, SQLite at scale presents a few challenges:</p>
<ul>
<li>Lack of an open-source, self-hosted solution.</li>
<li>No built-in cross-database querying, making complex analytics difficult without a dedicated data lake.</li>
<li>Limited database tooling, such as SQL browsers, ETL pipelines, monitoring, and backups. <a href="https://starbasedb.com/">StarbaseDB</a> is addressing this for Cloudflare Durable Objects with SQLite.</li>
<li>Non-standard protocols for communicating with SQLite-on-the-server. In contrast, PostgreSQL, MySQL, and Cassandra all have a well standardized wire protocols across all cloud providers that has led to a rich community of tools.</li>
<li>There are no case studies like Cassandra &amp; DynamoDB have of using SQLite with this architecture at hyper-scale. This will change with time.</li>
</ul>
<div role="alert"><h5><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="lightbulb-on" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M69.3 4l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3S58.3-3.3 69.3 4zM597.3 44l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zM24 160l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm528 0l64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM117.3 332l-48 32c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l48-32c11-7.4 25.9-4.4 33.3 6.7s4.4 25.9-6.7 33.3zm432-39.9l48 32c11 7.4 14 22.3 6.7 33.3s-22.3 14-33.3 6.7l-48-32c-11-7.4-14-22.3-6.7-33.3s22.3-14 33.3-6.7zm-100.1 5.7c-19.8 27.1-39.7 54.4-49.2 86.2l-160 0c-9.6-31.9-29.5-59.1-49.2-86.2c0 0 0 0 0 0s0 0 0 0c-5.2-7.1-10.4-14.2-15.4-21.4C155.6 247.9 144 213.3 144 176C144 78.8 222.8 0 320 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3c-5 7.2-10.2 14.3-15.4 21.4c0 0 0 0 0 0s0 0 0 0zM400 432c0 44.2-35.8 80-80 80s-80-35.8-80-80l0-16 160 0 0 16zM320 96c8.8 0 16-7.2 16-16s-7.2-16-16-16c-61.9 0-112 50.1-112 112c0 8.8 7.2 16 16 16s16-7.2 16-16c0-44.2 35.8-80 80-80z"></path></svg>Tip</h5><p>We&#39;re shipping an open-source &amp; self-hostable alternative to Cloudflare Durable Objects with SQLite in the near future. Follow us on <a href="https://x.com/rivet_gg">X</a>, <a href="https://bsky.app/profile/rivet.gg">Bluesky</a>, or <a href="https://rivet.gg/discord">Discord</a> to get notified on updates.</p></div>
<hr/><h2 id="conclusion"><a href="#conclusion"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a><a href="#conclusion">Conclusion</a></h2>
<p>SQLite on the server is more than a lightweight solution for small deployments – it&#39;s an increasingly viable alternative to traditional partitioned databases. By leveraging SQLite-per-partition solutions like Turso and Durable Objects, developers gain rich SQL capabilities, ACID compliance, and significant operational advantages.</p><div><a href="https://cranberrymuffin.github.io/rss/feed.xml" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="square-rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path></svg></a><a href="https://x.com/share?text=SQLite-on-the-Server%20Is%20Misunderstood%3A%20Better%20At%20Hyper-Scale%20Than%20Micro-Scale%20https%3A%2F%2Frivet.gg%2Fblog%2F2025-02-16-sqlite-on-the-server-is-misunderstood%20via%20%40rivet_gg" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Frivet.gg%2Fblog%2F2025-02-16-sqlite-on-the-server-is-misunderstood&amp;t=SQLite-on-the-Server%20Is%20Misunderstood%3A%20Better%20At%20Hyper-Scale%20Than%20Micro-Scale" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="hacker-news" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z"></path></svg></a><a href="https://www.reddit.com/submit?url=https://rivet.gg/blog/2025-02-16-sqlite-on-the-server-is-misunderstood&amp;title=SQLite-on-the-Server%20Is%20Misunderstood%3A%20Better%20At%20Hyper-Scale%20Than%20Micro-Scale" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z"></path></svg></a></div></article></div>
  </body>
</html>
