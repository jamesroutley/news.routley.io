<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.infoq.com/news/2022/12/apple-swift-foundation-rewrite/">Original</a>
    <h1>Apple announces full Swift rewrite of the Foundation framework (2022)</h1>
    
    <div id="readability-page-1" class="page"><div>
								<p>The Swift team has <a href="https://www.swift.org/blog/future-of-foundation/">started to work on a new open-source implementation of the Foundation framework</a>. To be written entirely in Swift, the new Foundation aims to improve performance by getting rid of conversion costs between Objective-C and Swift as well as to provide the opportunity for modularizing and clean it up.</p>

<blockquote>
<p>With a native Swift implementation of Foundation, the framework no longer pays conversion costs between C and Swift, resulting in faster performance.</p>
</blockquote>

<p>As Apple engineer Tony Parker <a href="https://forums.swift.org/t/what-s-next-for-foundation/61939/31">explained</a> on Swift forum, the performance benefit can be significant:</p>

<blockquote>
<p>A reimplementation of <em>Calendar</em> in Swift is 1.5x to 18x as fast as the C one (calling from Swift in various synthetic benchmarks like creation, date calculation).</p>
</blockquote>

<p>The Foundation framework is a cornerstone of most macOS and iOS apps, providing a large number of ubiquitous abstractions, including <code>NSObject</code>, <code>NSString</code>, <code>NSArray</code> and <code>NSDictionary</code>, and many more.</p>

<p>Originally written in Objective-C, and largely drawing on its dynamic properties, Foundation can be currently used in Swift apps that run on Apple OSes thanks to Swift interoperability with the Objective-C runtime. This is not an option though for other platforms where Swift is supported but only the original GNUstep Objective-C runtime is available, such as Linux. To circumvent this limitation, when Apple open sourced Swift they built <a href="https://github.com/apple/swift-corelibs-foundation"><code>swift-corelibs-foundation</code></a>, a Swift wrapper around Core Foundation, a lower-level C API lying at the heart of Foundation and providing &#34;toll-free bridged&#34; abstractions mapping to Foundation, including <code>CFString</code>, <code>CFDictionary</code> and so on.</p>

<p>As mentioned, the Swift rewrite will be the occasion for rearchitecturing the Foundation framework. At the moment, five distinct packages are devised, including <code>FoundationEssentials</code>, <code>FoundationInternationalization</code>, <code>FoundationNetworking</code>, <code>FoundationXML</code>, and <code>FoundationObjCCompatibility</code>. This will allow developers to bring in only the dependencies they actually need for a specific app. For example, a developer starting from scratch and wanting to cut all ties to the Darwin Foundation layer could skip the Obj-C compatibility layer altogether.</p>

<p>With the decision to rewrite Foundation, Apple is swapping the ordering between C, Objective-C, and Swift layers and making the Swift layer the underpinning to Foundation across all platforms. This will bring the opportunity to remove a number of features that are currently provided directly from the Swift language and standard library such as <code>NSCoding</code> and <code>NSKeyedArchiver</code>, replaced by <code>Codable</code>, or <code>Lock</code>, <code>OperationQueue</code>, and other concurrency primitives that are replaced by Swift <a href="https://developer.apple.com/news/?id=2o3euotz">structured concurrency</a>. Those features will be provided by a separate package available on the Darwin platform to ensure compatibility with existing code, though.</p>

<p>The announcement prompted many comments on the Swift Forums, most of them hinting at the convenience of giving several existing APIs a rethink as well as of ensuring Swift-types, such as <code>Codable</code>, or <a href="https://developer.apple.com/news/?id=2o3euotz">structured concurrency</a> are made powerful enough to fully replace the Obj-C types that are slated for removal from the core Foundation layer.</p>

<p>The Foundation rewrite is foreseeably a medium-term effort for which no schedule has been announced yet and Apple is inviting the Swift community to join the discussion to define its future.</p>

								









  
    

							</div></div>
  </body>
</html>
