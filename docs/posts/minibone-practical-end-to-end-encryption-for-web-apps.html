<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/backbone-hq/minibone">Original</a>
    <h1>Minibone: practical end-to-end encryption for web apps</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/5c56f40f6fd6063317c5a90a0ebfbe7d2fca395f391ed5df26caca647f770ec7/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f6261636b626f6e652d68712f6d696e69626f6e652f6d61696e2e796d6c3f6272616e63683d6d6173746572"><img src="https://camo.githubusercontent.com/5c56f40f6fd6063317c5a90a0ebfbe7d2fca395f391ed5df26caca647f770ec7/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f6261636b626f6e652d68712f6d696e69626f6e652f6d61696e2e796d6c3f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://img.shields.io/github/actions/workflow/status/backbone-hq/minibone/main.yml?branch=master"/></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/213f290ebc1d3e39a4e94af8a5a0bc2f01b6919f463b6a117c879217f01db4fa/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6261636b626f6e652d68712f6d696e69626f6e65"><img src="https://camo.githubusercontent.com/213f290ebc1d3e39a4e94af8a5a0bc2f01b6919f463b6a117c879217f01db4fa/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6261636b626f6e652d68712f6d696e69626f6e65" alt="GitHub License" data-canonical-src="https://img.shields.io/github/license/backbone-hq/minibone"/></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1c6f3a4b35f19ecc8bcaf5aaa2a7092cdc9297be6a952f6c1c609d754f69f9f3/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f6d696e69626f6e653f6c6f676f3d6e706d"><img src="https://camo.githubusercontent.com/1c6f3a4b35f19ecc8bcaf5aaa2a7092cdc9297be6a952f6c1c609d754f69f9f3/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f6d696e69626f6e653f6c6f676f3d6e706d" alt="NPM Version" data-canonical-src="https://img.shields.io/npm/v/minibone?logo=npm"/></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/f7e4636bce6e47aca895f08f4e14f0eb21278162cabe34b4f74ae2643f2e7be9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d6164655f62792d6261636b626f6e652d626c7565"><img src="https://camo.githubusercontent.com/f7e4636bce6e47aca895f08f4e14f0eb21278162cabe34b4f74ae2643f2e7be9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d6164655f62792d6261636b626f6e652d626c7565" alt="Made by Backbone" data-canonical-src="https://img.shields.io/badge/made_by-backbone-blue"/></a></p>
<p dir="auto">Minibone is a compact, versatile, and misuse-resistant library designed to make incorporating end-to-end encryption in your applications <strong>remarkably simple</strong>. It allows you to store and manage your users&#39; sensitive data while ensuring that only the users themselves can access and decrypt the information â€” helping you minimize the blast radius of breaches, meet compliance requirements, enhance privacy, and build trust.</p>
<p dir="auto">Building <em>secure-by-design</em> applications is <em>hard</em>. Minibone makes it <em>practical</em>.</p>

<p dir="auto">Minibone is built atop the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API" rel="nofollow">Web Crypto API</a>. It&#39;s restricted to a <em>conservative</em> suite of symmetric algorithms for quantum resistance and robustness.</p>
<p dir="auto">Specifically, Minibone uses <code>AES-GCM-256</code> for encryption, <code>HKDF-SHA-256</code> for key derivation, and <code>PBKDF2-SHA-256</code> with 500,000 iterations for password-based key derivation. Minibone also opts to keep its dependencies to the bare minimum to reduce the risk of supply-chain attacks.</p>

<p dir="auto">Minibone is designed to run on a <code>client</code> device (e.g., your desktop, mobile, or web-based app), storing data with a <code>provider</code> (e.g., a SaaS platform) through a <code>communication channel</code> (e.g., HTTPS). In this scenario, Minibone is designed to assure confidentiality and integrity, but not availability [1] or freshness [2], when the <code>provider</code> and/or the <code>communication channel</code> are compromised.</p>
<p dir="auto">We assume that the client application and device are not compromised and not otherwise vulnerable to side-channel attacks.</p>
<ol dir="auto">
<li>A malicious <code>provider</code> could selectively delete data they store.
Â  Â A compromised <code>communication channel</code> could selectively drop messages based on metadata.</li>
<li>A malicious <code>provider</code> could selectively revert data to earlier versions.
Â  Â A compromised <code>communication channel</code> could replay messages associated with earlier versions.</li>
</ol>

<p dir="auto">Minibone is hosted on <a href="https://www.npmjs.com/package/minibone" rel="nofollow">NPM</a>.
You can add it to your project by running the <code>npm</code> command below or an equivalent command in your package manager.</p>


<div dir="auto" data-snippet-clipboard-copy-content="import Minibone from &#39;minibone&#39;

// Define a unique service identifier
const serviceIdentifier: any = &#39;my-unique-service-identifier&#39;

// Virtual API, communication channel and storage provider
class Backend {
    private userBundles: Map&lt;string, Uint8Array&gt; = new Map()
    private dataBundles: Map&lt;string, Uint8Array&gt; = new Map()

    registerUser = async (uid: string, bundle: Uint8Array): Promise&lt;void&gt; =&gt; {this.userBundles.set(uid, bundle)}
    fetchUser = async (uid: string): Promise&lt;Uint8Array&gt; =&gt; this.userBundles.get(uid) ?? new Uint8Array()
    putData = async (uid: string, data: Uint8Array): Promise&lt;void&gt; =&gt; {this.dataBundles.set(uid, data)}
    fetchData = async (uid: string): Promise&lt;Uint8Array&gt; =&gt; this.dataBundles.get(uid) ?? new Uint8Array()
}
const virtualBackend = new Backend();

// Register a user; initialize their minibone instance
const minibone: Minibone = await Minibone.create()

// Encrypt and send the user&#39;s minibone to the provider
const userName: any = &#39;some-unique-user-name&#39;
const payload: Uint8Array = await minibone.save(&#39;secure-user-secret&#39;, [serviceIdentifier, userName])
await virtualBackend.registerUser(userName, payload)

// Encrypt user data
const data: any = {
    sq6wmgv2zcsrix6t: &#39;BETWEEN SUBTLE SHADING AND THE ABSENCE OF LIGHT LIES THE NUANCE OF IQLUSION.&#39;,
}
const encrypted: Uint8Array = await minibone.encrypt(data)
await virtualBackend.putData(minibone.uid, encrypted)

// Fetch and load the user&#39;s minibone. You probably want to guard payload retrieval behind multi-factor authentication in production.
const payload: Uint8Array = await virtualBackend.fetchUser(userName)
const loadedMinibone: Minibone = await Minibone.load(payload, &#39;secure-user-secret&#39;, [serviceIdentifier, userName])

// Decrypt data using the reconstructed minibone
const fetched: Uint8Array = await virtualBackend.fetchData(minibone.uid)
const decryptedData: any = await loadedMinibone.decrypt(fetched)"><pre><span>import</span> <span>Minibone</span> <span>from</span> <span>&#39;minibone&#39;</span>

<span>// Define a unique service identifier</span>
<span>const</span> <span>serviceIdentifier</span>: <span>any</span> <span>=</span> <span>&#39;my-unique-service-identifier&#39;</span>

<span>// Virtual API, communication channel and storage provider</span>
<span>class</span> <span>Backend</span> <span>{</span>
    <span>private</span> <span>userBundles</span>: <span>Map</span><span>&lt;</span><span>string</span><span>,</span> <span>Uint8Array</span><span>&gt;</span> <span>=</span> <span>new</span> <span>Map</span><span>(</span><span>)</span>
    <span>private</span> <span>dataBundles</span>: <span>Map</span><span>&lt;</span><span>string</span><span>,</span> <span>Uint8Array</span><span>&gt;</span> <span>=</span> <span>new</span> <span>Map</span><span>(</span><span>)</span>

    <span>registerUser</span> <span>=</span> <span>async</span> <span>(</span><span>uid</span>: <span>string</span><span>,</span> <span>bundle</span>: <span>Uint8Array</span><span>)</span>: <span>Promise</span><span>&lt;</span><span><span>void</span></span><span>&gt;</span> <span>=&gt;</span> <span>{</span><span>this</span><span>.</span><span>userBundles</span><span>.</span><span>set</span><span>(</span><span>uid</span><span>,</span> <span>bundle</span><span>)</span><span>}</span>
    <span>fetchUser</span> <span>=</span> <span>async</span> <span>(</span><span>uid</span>: <span>string</span><span>)</span>: <span>Promise</span><span>&lt;</span><span>Uint8Array</span><span>&gt;</span> <span>=&gt;</span> <span>this</span><span>.</span><span>userBundles</span><span>.</span><span>get</span><span>(</span><span>uid</span><span>)</span> <span>??</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>)</span>
    <span>putData</span> <span>=</span> <span>async</span> <span>(</span><span>uid</span>: <span>string</span><span>,</span> <span>data</span>: <span>Uint8Array</span><span>)</span>: <span>Promise</span><span>&lt;</span><span><span>void</span></span><span>&gt;</span> <span>=&gt;</span> <span>{</span><span>this</span><span>.</span><span>dataBundles</span><span>.</span><span>set</span><span>(</span><span>uid</span><span>,</span> <span>data</span><span>)</span><span>}</span>
    <span>fetchData</span> <span>=</span> <span>async</span> <span>(</span><span>uid</span>: <span>string</span><span>)</span>: <span>Promise</span><span>&lt;</span><span>Uint8Array</span><span>&gt;</span> <span>=&gt;</span> <span>this</span><span>.</span><span>dataBundles</span><span>.</span><span>get</span><span>(</span><span>uid</span><span>)</span> <span>??</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>)</span>
<span>}</span>
<span>const</span> <span>virtualBackend</span> <span>=</span> <span>new</span> <span>Backend</span><span>(</span><span>)</span><span>;</span>

<span>// Register a user; initialize their minibone instance</span>
<span>const</span> <span>minibone</span>: <span>Minibone</span> <span>=</span> <span>await</span> <span>Minibone</span><span>.</span><span>create</span><span>(</span><span>)</span>

<span>// Encrypt and send the user&#39;s minibone to the provider</span>
<span>const</span> <span>userName</span>: <span>any</span> <span>=</span> <span>&#39;some-unique-user-name&#39;</span>
<span>const</span> <span>payload</span>: <span>Uint8Array</span> <span>=</span> <span>await</span> <span>minibone</span><span>.</span><span>save</span><span>(</span><span>&#39;secure-user-secret&#39;</span><span>,</span> <span>[</span><span>serviceIdentifier</span><span>,</span> <span>userName</span><span>]</span><span>)</span>
<span>await</span> <span>virtualBackend</span><span>.</span><span>registerUser</span><span>(</span><span>userName</span><span>,</span> <span>payload</span><span>)</span>

<span>// Encrypt user data</span>
<span>const</span> <span>data</span>: <span>any</span> <span>=</span> <span>{</span>
    <span>sq6wmgv2zcsrix6t</span>: <span>&#39;BETWEEN SUBTLE SHADING AND THE ABSENCE OF LIGHT LIES THE NUANCE OF IQLUSION.&#39;</span><span>,</span>
<span>}</span>
<span>const</span> <span>encrypted</span>: <span>Uint8Array</span> <span>=</span> <span>await</span> <span>minibone</span><span>.</span><span>encrypt</span><span>(</span><span>data</span><span>)</span>
<span>await</span> <span>virtualBackend</span><span>.</span><span>putData</span><span>(</span><span>minibone</span><span>.</span><span>uid</span><span>,</span> <span>encrypted</span><span>)</span>

<span>// Fetch and load the user&#39;s minibone. You probably want to guard payload retrieval behind multi-factor authentication in production.</span>
<span>const</span> <span>payload</span>: <span>Uint8Array</span> <span>=</span> <span>await</span> <span>virtualBackend</span><span>.</span><span>fetchUser</span><span>(</span><span>userName</span><span>)</span>
<span>const</span> <span>loadedMinibone</span>: <span>Minibone</span> <span>=</span> <span>await</span> <span>Minibone</span><span>.</span><span>load</span><span>(</span><span>payload</span><span>,</span> <span>&#39;secure-user-secret&#39;</span><span>,</span> <span>[</span><span>serviceIdentifier</span><span>,</span> <span>userName</span><span>]</span><span>)</span>

<span>// Decrypt data using the reconstructed minibone</span>
<span>const</span> <span>fetched</span>: <span>Uint8Array</span> <span>=</span> <span>await</span> <span>virtualBackend</span><span>.</span><span>fetchData</span><span>(</span><span>minibone</span><span>.</span><span>uid</span><span>)</span>
<span>const</span> <span>decryptedData</span>: <span>any</span> <span>=</span> <span>await</span> <span>loadedMinibone</span><span>.</span><span>decrypt</span><span>(</span><span>fetched</span><span>)</span></pre></div>

<p dir="auto">Minibone is designed to be simple to use and difficult to abuse. That said, there are a few important aspects to keep in mind when interfacing with Minibone.</p>
<ol dir="auto">
<li>It&#39;s important for the context vector (the second parameter of <code>minibone.save</code> and third parameter of <code>Minibone.load</code>) to be <em>globally</em> unique to reduce the risk of key reuse and maximize the marginal cost of <a href="https://en.wikipedia.org/wiki/Rainbow_table" rel="nofollow">rainbow table</a> attacks.</li>
<li>When prompting end users for a passphrase or master secret, this secret <strong>must</strong> remain client-side. We recommend using a battle-tested password strength estimator (e.g., <a href="https://github.com/dropbox/zxcvbn">zxcvbn</a>). <strong>User secrets should be deleted immediately after use</strong> to make it just that bit harder for attackers.</li>
</ol>

<p dir="auto">Minibone relies <em>solely</em> on symmetric cryptography. While this makes it robust against a number of contemporary and future attacks, it also makes data sharing, assured identity, access control, and real-time collaborative workflows infeasible to implement.</p>
<p dir="auto">Minibone&#39;s enterprise counterpart, <a href="https://backbone.dev" rel="nofollow">Backbone</a>, was designed from first principles to support complex multi-user, multi-enterprise workflows under total end-to-end encryption with a stricter threat model.</p>
<p dir="auto">If these are a priority, reach out to us by emailing us at <a href="mailto:root@backbone.dev">root@backbone.dev</a>.</p>
<hr/>
<p dir="auto">Built with ðŸ¦´ by <a href="https://backbone.dev" rel="nofollow">Backbone</a></p>
</article></div></div>
  </body>
</html>
