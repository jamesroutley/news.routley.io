<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jakearchibald.com/2021/f1-perf-part-3/">Original</a>
    <h1>Who has the fastest F1 website (2021)</h1>
    
    <div id="readability-page-1" class="page"><div><p>I once spent an hour creating an <a href="https://f1-start.jakearchibald.com/">F1 lights-out reaction test</a> which went viral and was even <a href="https://www.youtube.com/watch?v=6fgGJ-M6X2s">played by F1 drivers</a>. That sounds like a brag, and it kinda is, but now whenever I pour days or even weeks of work into something, it just seems so inefficient compared to that time I spent <em>an hour</em> on something that went big. Wait! You&#39;re not my therapist! Let&#39;s look at another F1 website…</p>
<p>This is part 3 in a multi-part series looking at the loading performance of F1 websites. Not interested in F1? It shouldn&#39;t matter. This is just a performance review of 10 recently-built/updated sites that have broadly the same goal, but are built by different teams, and have different performance issues.</p><ol><li><a href="https://jakearchibald.com/2021/f1-perf-part-1/"> Part 1: Methodology &amp; Alpha Tauri</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-2/"> Part 2: Alfa Romeo</a></li><li>➡️ Part 3: Red Bull</li><li><a href="https://jakearchibald.com/2021/f1-perf-part-4/"> Part 4: Williams</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-5/"> Part 5: Aston Martin</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-6/"> Part 6: Ferrari</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-7/"> Part 7: Haas</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-8/"> Part 8: McLaren</a></li><li><a href="https://jakearchibald.com/2021/io-site-perf/"> Bonus: Google I/O</a></li><li>…more coming soon…</li></ol>



<h2 id="red-bull"><a href="#red-bull">Red Bull</a></h2>
<figure>
<svg viewBox="0 0 408 592"></svg>
<video src="/c/red-bull-bc1c17cd.mp4" controls=""></video>
</figure>

<figure>
<picture>
  <source type="image/avif" srcset="/c/red-bull-film-303a9440.avif"/>
  <img width="14444" height="236" alt="" decoding="async" loading="lazy" src="https://jakearchibald.com/c/red-bull-film-5689a5d1.png"/>
</picture>
</figure>
<dl>
  <dt>Link</dt>
  <dd>
    
  </dd>
  <dt>First run</dt>
  <dd>
    
  </dd>
  <dt>Second run</dt>
  <dd>
    
  </dd>
  <dt>Total</dt>
  <dd>
    <p>8.6s</p>
  </dd>
  <dt>2019 total</dt>
  <dd>
    
  </dd>
</dl>

<p>Now we&#39;re talking! This is a graphically rich, engaging site, and the performance is pretty good! In fact, it&#39;s significantly faster than its 2019 site. But there&#39;s still room for improvement.</p>
<h3 id="possible-improvements"><a href="#possible-improvements">Possible improvements</a></h3>
<ul>
<li><strong>3 second delay to content-render</strong> caused by unnecessary inlining. Covered in detail below.</li>
<li><strong>10 second delay to main image</strong> caused by a JavaScript responsive images implementation, <a href="https://jakearchibald.com/2021/f1-perf-part-2/#issue-delayed-primary-image">like we saw in part 2</a>. These should be <a href="https://jakearchibald.com/2015/anatomy-of-responsive-images/">real responsive images</a>.</li>
<li><strong>Additional 2 second delay to main image</strong> caused by an extra connection. This problem is <a href="https://jakearchibald.com/2021/f1-perf-part-1/#avoid-blocking-resources-on-other-servers">covered in part 1</a>, but the solution here is just to move the images to the same server as the page.</li>
<li><strong>Additional 2 second delay to main image</strong> caused by poor optimisation. Covered in detail below.</li>
<li><strong>40 second delay to key image</strong> caused by loading it with JavaScript. Covered in detail below.</li>
<li><strong>Additional 30 second delay to that image</strong> caused by poor optimisation. Covered in detail below.</li>
<li><strong>2 second delay to fonts</strong> caused by extra connection. Again, this is <a href="https://jakearchibald.com/2021/f1-perf-part-1/#avoid-blocking-resources-on-other-servers">covered in part 1</a>, but the solution here is just to move the fonts to the same server.</li>
<li><strong>40+ second delay to content-blocking cookie modal</strong> caused by… a number of things, <a href="https://jakearchibald.com/2021/f1-perf-part-1/#key-issue-late-modal">covered in part 1</a>.</li>
</ul>
<p>Remember these delays overlap in some cases.</p>
<h3 id="issue-unnecessary-inlining"><a href="#issue-unnecessary-inlining">Issue: Unnecessary inlining</a></h3>
<p>Here&#39;s the first bit of the timeline:</p>
<figure>
<img width="440" height="180" alt="" decoding="async" loading="lazy" src="https://jakearchibald.com/c/red-bull-waterfall-873d54ef.png"/>
</figure>

<p>The page renders around the 6s mark, which is while the HTML is still downloading. Browsers can stream HTML and render it while it&#39;s downloading; it&#39;s a great feature of parsed-HTML that many sites don&#39;t get the benefit of due to blocking resources. Because the page renders with that one resource, we know there are <em>no</em> blocking resources. This suggests the CSS is inlined, and from looking at the source, yep, it is.</p>
<p>Inlining avoids request/response overhead, which is great for render-blocking resources. But also, since it&#39;s part of the <em>page</em>, you can tailor the inlining for <em>that page</em>.</p>
<p>However, that doesn&#39;t seem to be what&#39;s happening here. Here&#39;s what I see in <a href="https://developers.google.com/web/tools/chrome-devtools/coverage">Chrome DevTools&#39; coverage panel</a>:</p>
<figure>
<img width="1472" height="93" alt="" decoding="async" loading="lazy" src="https://jakearchibald.com/c/red-bull-coverage-9cd8514d.png"/>
</figure>

<p>The code in the page is 79.5% unused, which amounts to over 600kB. Compare this to the coverage on <a href="https://squoosh.app/">Squoosh</a>:</p>
<figure>
<img width="1494" height="166" alt="" decoding="async" loading="lazy" src="https://jakearchibald.com/c/squoosh-coverage-a789620f.png"/>
</figure>

<p>…where we used inline content just for the CSS and script needed for the first interaction. The first row there is a non-blocking resource, where coverage doesn&#39;t matter so much, but the bottom row is the page, where only 7kB is unused. You can also click on these lines which takes you to a code view of used and unused code:</p>
<figure>
<img width="785" height="402" alt="" decoding="async" loading="lazy" src="https://jakearchibald.com/c/coverage-code-71706884.png"/>
</figure>

<p>Anyway, we aren&#39;t here to talk about Squoosh. Around three seconds could be shaved off time-to-content on the Red Bull site by making the inlined code tailored to what the page needs for that content-render. The rest can be loaded via external resources.</p>


<h3 id="issue-large-primary-image"><a href="#issue-large-primary-image">Issue: Large primary image</a></h3>
<figure>
<div><div><div><div></div></div></div></div>
</figure>

<p>It&#39;s great to see them using WebP, but the quality is just set too high. Yes, some detail is lost in the compressed versions, but remember this image has text over the top, and another image over the top.</p>
<p>Actually, let&#39;s talk about that image…</p>
<h3 id="issue-large-overlay-image"><a href="#issue-large-overlay-image">Issue: Large overlay image</a></h3>
<figure>
<div><div><div><div></div></div><a href="https://jakearchibald.com/2020/avif-has-landed/demos/compare/?show=redBull&amp;img=undefined" target="_blank"><svg viewBox="0 0 24 24" title="View in full page"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14c0 1.1.9 2 2 2h14a2 2 0 002-2v-7h-2v7zM14 3v2h3.6l-9.8 9.8 1.4 1.4L19 6.4V10h2V3h-7z"></path></svg></a></div></div>
</figure>

<p>This image sits over the top of the main carousel, and it&#39;s a great part of the design. Again, they&#39;re using WebP, but maybe not with the right settings. But even with optimised settings, the WebP is still big.</p>
<p>When WebP was created, they designed the alpha channel around things like logos, and things cut-out of photos. In these cases the alpha channel is dominated by large areas of the same value:</p>
<figure>
<div><div><div><div></div></div></div></div>
</figure>

<p>Because of this, they used the WebP <em>lossless</em> mode for the alpha channel, even if the colour data is using the lossy mode. This works well in general, except in cases like this:</p>
<figure>
<div><div><div><div></div></div></div></div>
</figure>

<p>…where the alpha channel is frequently changing. This is something a lossy codec handles much better. AVIF can perform lossy encoding of all channels, including the alpha channel, so it performs an order of magnitude better than WebP in this case.</p>
<p>For cases where you need genuine lossless images, WebP is a better choice. AVIF supports lossless encoding, but the sizes are usually around 2x of WebP.</p>
<h3 id="issue-overlay-image-loaded-with-javascript"><a href="#issue-overlay-image-loaded-with-javascript">Issue: Overlay image loaded with JavaScript</a></h3>
<p>That overlay image doesn&#39;t start loading until the user has been on the site for over 50 seconds, which almost certainly means something is blocking it. The &#39;initiator&#39; column in the network panel didn&#39;t help this time, so I searched the source for the image URL, and found it in a blob of JSON at the end of the document. If it&#39;s JSON, that means JavaScript is handling the load of that image in some way.</p>
<p>I would switch this for an <code>&lt;img&gt;</code> so <a href="https://jakearchibald.com/2015/anatomy-of-responsive-images/">responsive images</a> could be used to select the best format for the job. This will trigger the download much earlier.</p>
<p>There&#39;s a risk that the massive WebP version could end up taking bandwidth from more important things. If this happened, I&#39;d use preloads to bump the priority of more-important content.</p>
<h3 id="issue-large-inlined-blurry-image"><a href="#issue-large-inlined-blurry-image">Issue: Large inlined blurry image</a></h3>
<p>The performance issues the Red Bull site has with images are pretty well disguised using a low-quality inlined image, but with a <code>blur(7px)</code> effect. Unfortunately the image they use isn&#39;t an accurate preview of the image being loaded, as it&#39;s cropped incorrectly, so there&#39;s a jump when the final version loads. However, I really like this method, as it provides more structure than something like a <a href="https://blurha.sh/">BlurHash</a>, but it does use more bytes.</p>
<p>Their blurred images are 6kB each, which is quite a lot to inline, especially when the well-optimised mobile version of the image is only around twice the size. 150x150 is also an odd choice for creating a tiny JPEG, since JPEG is encoded in 8x8 blocks. If you&#39;re interested in details like this, <a href="https://www.youtube.com/watch?v=F1kYBnY6mwg&amp;t=294s">I gave a talk on how JPEG works</a>.</p>
<p>Anyway, I had a play around to see what I could do with 1kB:</p>
<figure>
<div><div><div><div></div></div></div></div>
</figure>

<p>JPEG suffers from heavy blocking artefacts, so I had to increase the blur to hide it. WebP is much better, so I was able to go with a higher resolution and less blur.</p>
<p>If you&#39;re going to create super-small images like this, you&#39;ll want to disable &#34;chroma subsampling&#34; in the codec. Subsampling uses lower-resolution colour data, which usually works well for compression, but it&#39;s really noticeable at small sizes like this.</p>
<p><a href="https://squoosh.app/">Squoosh</a> lets you disable subsampling for JPEG and AVIF, but it can&#39;t be disabled for WebP, as the format doesn&#39;t support it. To work around this, the WebP encoder has a &#34;sharp RGB to YUV&#34; option which tries to limit the impact of subsampling at the cost of some colour bleeding. I used that option above.</p>
<p>AVIF does ok here, displaying less noise than WebP, but since the AVIF format has around 300B of headers, we don&#39;t really see the usual AVIF &#39;magic&#39; that we see with other images.</p>
<p>When it comes to an inline preview like this, you can only pick one image size and format. I&#39;d go for the WebP, since it has decent quality and <a href="https://caniuse.com/webp">pretty good support</a>.</p>
<h3 id="how-fast-could-it-be"><a href="#how-fast-could-it-be">How fast could it be?</a></h3>
<p>The Red Bull site is pretty good, but how fast would it be if they cut their inlining down to the essentials, and optimised those images? Well…</p>
<figure>
<svg viewBox="0 0 816 592"></svg>
<video src="/c/red-bull-compare-7c4a9f66.mp4" controls=""></video>
</figure>
<dl>
  <dt>Original</dt>
  <dd>
    
  </dd>
  <dt>Optimised</dt>
  <dd></dd>
</dl>

<p>Not as big a difference as with previous sites, but still worth doing.</p>
<h2 id="scoreboard"><a href="#scoreboard">Scoreboard</a></h2>
<figure><div><picture><source srcset="/c/scores-bg-a5d983b0.avif" type="image/avif"/><img alt="" src="https://jakearchibald.com/c/scores-bg-b8399ee4.jpg"/></picture><table><thead><tr><th></th><th></th><th>Score</th><th>vs 2019</th><th></th></tr></thead><tbody><tr><th></th><th><div><p>Red Bull</p><p><img width="1" height="1" src="https://jakearchibald.com/c/red-bull-54fa9710.svg" alt=""/></p></div></th><td>8.6</td><td>-7.2</td><td>Leader</td></tr><tr><th></th><th><div><p>Alpha Tauri</p><p><img width="1" height="1" src="https://jakearchibald.com/c/alpha-tauri-88fc7f38.svg" alt=""/></p></div></th><td>22.1</td><td>+9.3</td><td>+13.5</td></tr><tr><th></th><th><div><p>Alfa Romeo</p><p><img width="1" height="1" src="https://jakearchibald.com/c/alfa-romeo-94dd0f5a.svg" alt=""/></p></div></th><td>23.4</td><td>+3.3</td><td>+14.8</td></tr></tbody></table></div></figure>

<p>Red Bull <em>leaps</em> into first place, but will they stay there? Find out in part 4.</p>
<ol><li><a href="https://jakearchibald.com/2021/f1-perf-part-1/"> Part 1: Methodology &amp; Alpha Tauri</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-2/"> Part 2: Alfa Romeo</a></li><li>➡️ Part 3: Red Bull</li><li><a href="https://jakearchibald.com/2021/f1-perf-part-4/"> Part 4: Williams</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-5/"> Part 5: Aston Martin</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-6/"> Part 6: Ferrari</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-7/"> Part 7: Haas</a></li><li><a href="https://jakearchibald.com/2021/f1-perf-part-8/"> Part 8: McLaren</a></li><li><a href="https://jakearchibald.com/2021/io-site-perf/"> Bonus: Google I/O</a></li><li>…more coming soon…</li></ol>
</div></div>
  </body>
</html>
