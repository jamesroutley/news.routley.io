<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mgree.github.io/ffs/">Original</a>
    <h1>The File Filesystem</h1>
    
    <div id="readability-page-1" class="page"><section id="main_content">
          <p>The Unix shell is a powerful tool, and the Unix ecosystem provides an
incredible array of tools for working with strings. But the shell
really only knows how to work with one data <em>structure</em>: the
filesystem. Modern systems use all kinds of
<a href="https://en.m.wikipedia.org/wiki/Semi-structured_data"><em>semi-structured</em></a>
data, like JSON or YAML. These semi-structured formats are essentially
trees, and string processing is a bad match‚Äîediting JSON with sed is
not a very good idea!</p>

<p><img src="https://mgree.github.io/ffs/assets/images/inplace_demo.gif" alt="Demo of in-place editing, starting from an empty JSON object to building up a compound one; transcript is below"/></p>

<p>ffs‚Äîshort for the <strong>f</strong>ile <strong>f</strong>ile<strong>s</strong>ystem‚Äîlets you mount
semi-structured data as a filesystem, letting you work with modern
formats using your familiar shell tools.</p>

<p>Currently, ffs supports <a href="https://www.json.org/">JSON</a>,
<a href="https://yaml.org/">YAML</a>, and <a href="https://toml.io/en/">TOML</a>, with more
to come.</p>

<p>You can read more about it in <a href="https://mgree.github.io/ffs/ffs.1.html">the <code>ffs</code> manpage</a>.</p>



<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/B8dQCyPVU4I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>Run <code>ffs [file]</code> to mount <code>file.blah</code> at the mountpoint <code>file</code>. The
final, updated version of the file will be outputted on stdout.</p>

<div><div><pre><code><span>$</span><span> </span><span>cat </span>object.json 
<span>{ &#34;name&#34;: &#34;Michael Greenberg&#34;, &#34;eyes&#34;: 2, &#34;fingernails&#34;: 10, &#34;human&#34;: true }
</span><span>$</span><span> </span>ffs <span>-o</span> object_edited.json object.json &amp;
<span>[1] 60182
</span><span>$</span><span> </span>tree object
<span>object
‚îú‚îÄ‚îÄ eyes
‚îú‚îÄ‚îÄ fingernails
‚îú‚îÄ‚îÄ human
‚îî‚îÄ‚îÄ name

0 directories, 4 files
</span><span>$</span><span> </span><span>echo </span>Mikey Indiana <span>&gt;</span>object/name
<span>$</span><span> </span><span>echo </span>1 <span>&gt;</span>object/nose
<span>$</span><span> </span><span>mkdir </span>object/pockets
<span>$</span><span> </span><span>cd </span>object/pockets/
<span>$</span><span> </span><span>echo </span>keys <span>&gt;</span>pants
<span>$</span><span> </span><span>echo </span>pen <span>&gt;</span>shirt
<span>$</span><span> </span><span>cd</span> ..
<span>$</span><span> </span><span>cd</span> ..
<span>$</span><span> </span>umount object
<span>$</span><span> 
</span><span>[1]+  Done                    ffs -o object_edited.json object.json
</span><span>$</span><span> </span><span>cat </span>object_edited.json 
<span>{&#34;eyes&#34;:2,&#34;fingernails&#34;:10,&#34;human&#34;:true,&#34;name&#34;:&#34;Mikey Indiana&#34;,&#34;nose&#34;:1,&#34;pockets&#34;:{&#34;pants&#34;:&#34;keys&#34;,&#34;shirt&#34;:&#34;pen&#34;}}
</span></code></pre></div></div>

<p>Notice a few things: the <code>nose</code> key of the resulting object has a
number as its value, not a string; the <code>pockets</code> directory got turned
into an object.</p>

<p>You can specify an explicit mountpoint by running <code>ffs -m MOUNT file</code>;
you can specify an output file with <code>-o OUTPUT</code>. You can edit a file
in place by running <code>ffs -i file</code> (as in the gif above)‚Äîwhen the
volume is unmounted, the resulting output will be written back to
<code>file</code>. Here‚Äôs the transcript:</p>

<div><div><pre><code><span>~/ffs/demo $</span><span> </span><span>echo</span> <span>&#39;{}&#39;</span> <span>&gt;</span>demo.json
<span>~/ffs/demo $</span><span> </span>ffs <span>-i</span> demo.json &amp;
<span>[1] 56827
</span><span>~/ffs/demo $</span><span> </span><span>cd </span>demo
<span>~/ffs/demo/demo $</span><span> </span><span>echo </span>47 <span>&gt;</span>favorite_number
<span>~/ffs/demo/demo $</span><span> </span><span>mkdir </span>likes
<span>~/ffs/demo/demo $</span><span> </span><span>echo true</span> <span>&gt;</span>likes/dogs
<span>~/ffs/demo/demo $</span><span> </span><span>echo false</span> <span>&gt;</span>likes/cats
<span>~/ffs/demo/demo $</span><span> </span><span>touch </span>mistakes
<span>~/ffs/demo/demo $</span><span> </span><span>echo </span>Michael Greenberg <span>&gt;</span>name
<span>~/ffs/demo/demo $</span><span> </span><span>echo </span>https://mgree.github.io <span>&gt;</span>website
<span>~/ffs/demo/demo $</span><span> </span><span>cd</span> ..
<span>~/ffs/demo $</span><span> </span>umount demo
<span>~/ffs/demo $</span><span> 
</span><span>[1]+  Done                    ffs -i demo.json
</span><span>~/ffs/demo $</span><span> </span><span>cat </span>demo.json 
<span>{&#34;favorite_number&#34;:47,&#34;likes&#34;:{&#34;cats&#34;:false,&#34;dogs&#34;:true},&#34;mistakes&#34;:null,&#34;name&#34;:&#34;Michael Greenberg&#34;,&#34;website&#34;:&#34;https://mgree.github.io&#34;}~/ffs/demo $</span><span> 
</span><span>~/ffs/demo $</span><span>
</span></code></pre></div></div>



<p>On Linux you need <a href="https://github.com/libfuse/libfuse">FUSE</a>; on
macOS, you need <a href="https://osxfuse.github.io/">macFUSE</a>. You can then
download a single executable. These are the <a href="https://github.com/mgree/ffs/releases/tag/latest">latest development builds</a>:</p>

<ul>
  <li><a href="https://github.com/mgree/ffs/releases/download/latest/ffs.linux">Linux</a></li>
  <li><a href="https://github.com/mgree/ffs/releases/download/latest/ffs.macos">macOS</a></li>
</ul>

<p>See the <a href="https://github.com/mgree/ffs/releases">release page</a> for
particular releases; the current version is 0.1.2. You can also build
ffs from <a href="https://github.com/mgree/ffs">source</a>.</p>



<p>Check out the paper <a href="https://dl.acm.org/doi/10.1145/3477113.3487265">‚ÄúFiles-as-Filesystems for POSIX Shell Data
Processing‚Äù</a> from
<a href="https://plos-workshop.org/2021/">PLOS 2021</a>. The pre-recorded demo is
above; the pre-recorded talk is below.</p>

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/VIphHPBj9ms" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>



<p>Tools like <a href="https://stedolan.github.io/jq/">jq</a> and
<a href="https://github.com/tomnomnom/gron">gron</a> are meant to help you work
with JSON on the command line. They‚Äôre great tools!</p>

<p>Why might ffs be the right choice for you?</p>

<ul>
  <li>
    <p>ffs supports multiple formats.</p>
  </li>
  <li>
    <p>ffs lets you edit using familiar shell tools.</p>
  </li>
  <li>
    <p>ffs doesn‚Äôt involve learning a new language.</p>
  </li>
</ul>

<p>Why might ffs <em>not</em> be the right choice for you?</p>

<ul>
  <li>
    <p>You use Windows. (Sorry. üò•)</p>
  </li>
  <li>
    <p>You can‚Äôt use FUSE.</p>
  </li>
  <li>
    <p>You only need to search, not edit.</p>
  </li>
  <li>
    <p>Your files are very large.</p>
  </li>
</ul>



<p>ffs is licensed under
<a href="https://raw.githubusercontent.com/mgree/ffs/main/LICENSE">GPLv3</a>.</p>

        </section></div>
  </body>
</html>
