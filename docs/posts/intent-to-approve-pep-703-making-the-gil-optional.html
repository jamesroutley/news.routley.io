<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://discuss.python.org/t/a-steering-council-notice-about-pep-703-making-the-global-interpreter-lock-optional-in-cpython/30474">Original</a>
    <h1>Intent to approve PEP 703: making the GIL optional</h1>
    
    <div id="readability-page-1" class="page"><div id="main-outlet" role="main">
        

  

    <div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
      <meta itemprop="headline" content="A Steering Council notice about PEP 703 (Making the Global Interpreter Lock Optional in CPython)"/>
        <meta itemprop="articleSection" content="Core Development"/>
      <meta itemprop="keywords" content=""/>
      

          <div id="post_1">
            
            <div itemprop="articleBody">
              <p>Posting for the whole Steering Council, on the subject of <a href="https://discuss.python.org/u/colesbury">@colesbury</a>’s <a href="https://peps.python.org/pep-0703/">PEP 703 (Making the Global Interpreter Lock Optional in CPython)</a>.</p>
<p>Thank you, everyone, for responding to the <a href="https://discuss.python.org/t/poll-feedback-to-the-sc-on-making-cpython-free-threaded-and-pep-703/28540">poll on the no-GIL proposal</a>. It’s clear that the overall sentiment is positive, both for the general idea and for PEP 703 specifically. The Steering Council is also largely positive on both. We intend to accept PEP 703, although we’re still working on the acceptance details.</p>
<p>As we’ve done a few times in the past, we want to communicate our intent to accept the PEP along with where our current thinking is on the details around acceptance.</p>
<p>Our base assumptions are:</p>
<ul>
<li>Long-term (probably 5+ years), the no-GIL build should be the only build. We do not want to create a permanent split between with-GIL and no-GIL builds (and extension modules).</li>
<li>We want to be very careful with backward compatibility. We do not want another Python 3 situation, so any changes in third-party code needed to accommodate no-GIL builds should just work in with-GIL builds (although backward compatibility with older Python versions will still need to be addressed). This is not Python 4. We are still considering the requirements we want to place on ABI compatibility and other details for the two builds and the effect on backward compatibility.</li>
<li>Before we commit to switching entirely to the no-GIL build, we need to see community support for it. We can’t just flip the default and expect the community to figure out what work they need to do to support it. We, the core devs, need to gain experience with the new build mode and all it entails. We will probably need to figure out new C APIs and Python APIs as we sort out thread safety in existing code. We also need to bring along the rest of the Python community as we gain those insights and make sure the changes we want to make, and the changes we want them to make, are palatable.</li>
<li>We want to be able to change our mind if it turns out, any time before we make no-GIL the default, that it’s just going to be too disruptive for too little gain. Such a decision could mean rolling back all of the work, so until we’re certain we want to make no-GIL the default, code specific to no-GIL should be somewhat identifiable.</li>
</ul>
<p>As such, what we currently see as the way forward is three stages:</p>
<ul>
<li>Short term, we add the no-GIL build as an experimental build mode, presumably in 3.13 (if it slips to 3.14, that is not a problem). We want the build mode to be experimental to make it clear that while the core devs support that build mode, we can’t expect the community to support it outright. We need time to figure out what we need to do, at the very least in terms of API design and packaging and distribution, to enable the community to support it. We also want to discourage distributors from shipping the experimental no-GIL build as a default interpreter.</li>
<li>Mid-term, after we have confidence that there is enough community support to make production use of no-GIL viable, we make the no-GIL build supported but not the default (yet), and set a target date/Python version for making it the default. The timing is going to depend a lot on, for example, how backward compatible the API changes end up being (e.g., what to do about the stable ABI), and how much work the community thinks they still need to do. We expect this to take at least a year or two, possibly more. Once we declare it supported we expect some distributors may start shipping no-GIL by default, although it will probably vary greatly by how many other Python packages support no-GIL at that point.</li>
<li>Long-term, we want no-GIL to be the default, and to remove any vestiges of the GIL (without unnecessarily breaking backward compatibility). We don’t want to wait too long with this, because having two common build modes may be a heavy burden on the community (as, for example, it can double test resources and debugging scenarios), but we can’t rush it either. We think it may take as much as five years to get to this stage.</li>
</ul>
<p>Throughout the process we (the core devs, not just the SC) will need to re-evaluate the progress and the suggested timelines. We don’t want this to turn into another ten year backward compatibility struggle, and we want to be able to call off PEP 703 and find another solution if it looks to become problematic, and so we need to regularly check that the continued work is worth it.</p>
<p>We hope that this gives some clarity into the future of the PEP while we work on the exact acceptance details. The SC will work to finalise the acceptance over the coming weeks.</p>
            </div>

            

            

          </div>
          <div id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/bjkeefe"><span itemprop="name">bjkeefe</span></a>
                (bjkeefe)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-28T22:39:51Z">
                    July 28, 2023, 10:39pm
                  </time>
                  <meta itemprop="dateModified" content="2023-07-28T22:39:51Z"/>
              <span itemprop="position">2</span>
              </span>
            </p></div>
            <p>I wish I had the words to express my gratitude for the work that you folks put in on things like this.  I don’t, so, just: thank you, so much.  Another reason why I am really glad I decided to start teaching myself Python.</p>

            

            

          </div>
          <div id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>I respect the decision however unfortunately I am not in favor of it. Nevertheless I hope for and wish the core devs all the success and luck for a good positive outcome.</p>

            

            

          </div>
          <div id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/Eclips4"><span itemprop="name">Eclips4</span></a>
                (Kirill Podoprigora)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-28T23:00:43Z">
                    July 28, 2023, 11:00pm
                  </time>
                  <meta itemprop="dateModified" content="2023-07-28T23:00:43Z"/>
              <span itemprop="position">4</span>
              </span>
            </p></div>
            <p>Glad to hear that news. That’s incredible news for CPython. I hope that I can help in some way in realization of it. Good luck!</p>

            

            

          </div>
          <div id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/diegor"><span itemprop="name">diegor</span></a>
                (Diego Russo)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-28T23:26:27Z">
                    July 28, 2023, 11:26pm
                  </time>
                  <meta itemprop="dateModified" content="2023-07-28T23:26:27Z"/>
              <span itemprop="position">5</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>Thanks for the carefulness you are applying to the whole process whilst being positive in getting the changes. The whole CPython community will really appreciate <em>not</em> to have again a python2/3 situation.</p>
<p>Thanks and good luck!</p>
            </div>

            

            

          </div>
          <div id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/itamaro"><span itemprop="name">itamaro</span></a>
                (Itamar Oren)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T00:11:20Z">
                    July 29, 2023, 12:11am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T00:11:20Z"/>
              <span itemprop="position">6</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>Thank you for sharing this notice in anticipation of the official acceptance - this is super exciting!</p>
<p><a href="https://discuss.python.org/u/colesbury">@colesbury</a> is currently out on vacation, but should be back in a couple of weeks.</p>
            </div>

            

            

          </div>
          <div id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              
<p>I’m happy to be an early adopter, and I know that a handful of packages have already been modified to work with <code>nogil</code>. Are those versions available somewhere?</p>
<p>Maybe this question is jumping the gun and there will be a more “official” way to do this in the future?</p>
            </div>

            

            

          </div>
          <div id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/ofek"><span itemprop="name">ofek</span></a>
                (Ofek Lev)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T01:23:48Z">
                    July 29, 2023,  1:23am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T01:23:48Z"/>
              <span itemprop="position">8</span>
              </span>
            </p></div>
            <p>I am absolutely elated! When the initial implementation is released I will make sure we promptly begin testing <a href="https://discuss.python.org/t/pep-703-making-the-global-interpreter-lock-optional-3-12-updates/26503/92">at work</a>.</p>

            

            

          </div>
          <div id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/Tinche"><span itemprop="name">Tinche</span></a>
                (Tin Tvrtković)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T01:52:42Z">
                    July 29, 2023,  1:52am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T01:52:42Z"/>
              <span itemprop="position">9</span>
              </span>
            </p></div>
            <p>Huge congratulations to everyone involved! Exciting times ahead.</p>

            

            

          </div>
          <div id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/davidism"><span itemprop="name">davidism</span></a>
                (David Lord)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T02:09:06Z">
                    July 29, 2023,  2:09am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T02:09:06Z"/>
              <span itemprop="position">10</span>
              </span>
            </p></div>
            <p>Excited to follow this! As soon as cibuildwheel supports it, I’ll add the additional wheels for MarkupSafe. Or add some experimental builds somewhere before that.</p>

            

            

          </div>
          <div id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/rednafi"><span itemprop="name">rednafi</span></a>
                (Redowan Delowar)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T02:43:25Z">
                    July 29, 2023,  2:43am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T02:43:25Z"/>
              <span itemprop="position">11</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>I’m beyond stoked for this. If Python can run truly concurrent code without sacrificing the current single core execution speed of 3.12, that’d be a huge win for the community and people who are heavily invested in this ecosystem.</p>
<p>I’ll start testing it on my code the moment the nogil flag becomes publicly available. Also curious to see how it’ll break single threaded code with tons of mutable state.</p>
            </div>

            

            

          </div>
          <div id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/rednafi"><span itemprop="name">rednafi</span></a>
                (Redowan Delowar)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T02:45:02Z">
                    July 29, 2023,  2:45am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T02:45:02Z"/>
              <span itemprop="position">12</span>
              </span>
            </p></div>
            <p>Meta is doing some fantastic work on the LLM side as well as on the core Python side. This is fantastic to see <img src="https://emoji.discourse-cdn.com/apple/pray.png?v=12" title=":pray:" alt=":pray:" loading="lazy" width="20" height="20"/></p>

            

            

          </div>
          <div id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <p>This is delightful news! I will make it a goal to get PyO3 ready to support nogil / PEP 703 as soon as possible!</p>

            

            

          </div>
          <div id="post_14" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/itamaro"><span itemprop="name">itamaro</span></a>
                (Itamar Oren)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T06:27:32Z">
                    July 29, 2023,  6:27am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T06:27:32Z"/>
              <span itemprop="position">14</span>
              </span>
            </p></div>
            <p>It is very much NOT official, but you should be able to play with the prototype implementation <a href="https://discuss.python.org/u/colesbury">@colesbury</a> published together with the PEP (iirc there’s a 3.9-based implementation and a 3.12-alpha (or beta?) based implementation)</p>

            

            

          </div>
          <div id="post_15" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/hugovk"><span itemprop="name">hugovk</span></a>
                (Hugo van Kemenade)
              </span></p>

                

              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T06:39:31Z">
                    July 29, 2023,  6:39am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T06:39:31Z"/>
              <span itemprop="position">15</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>3.12.0a4 proof-of-concept:</p>


<p>3.9.10 proof-of-concept:</p>


            </div>

            

            

          </div>
          <div id="post_16" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/sunmy2019"><span itemprop="name">sunmy2019</span></a>
                (Steven Sun)
              </span></p>


              <p><span>
                  <time itemprop="datePublished" datetime="2023-07-29T07:03:27Z">
                    July 29, 2023,  7:03am
                  </time>
                  <meta itemprop="dateModified" content="2023-07-29T07:03:27Z"/>
              <span itemprop="position">16</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>Hope for backward compatibility and easy migration.</p>
<p>Data races caused by removing GIL are sometimes hard to catch and reproduce. Migrating single-threaded code is much more error-prone than writing everything in a multi-threaded fashion in the first place.</p>
            </div>

            

            

          </div>
    </div>






    </div></div>
  </body>
</html>
