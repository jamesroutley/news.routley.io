<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ai.facebook.com/blog/ai-rsc/">Original</a>
    <h1>The AI Research SuperCluster</h1>
    
    <div id="readability-page-1" class="page"><div><p><img src="https://scontent-sea1-1.xx.fbcdn.net/v/t39.2365-6/271822034_411075774126909_4701282566086735295_n.jpg?_nc_cat=111&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=FpxnkROKyvkAX9zugF_&amp;_nc_ht=scontent-sea1-1.xx&amp;oh=00_AT8eAaNK5btohM4KIHeMf6623SDGcUhiQCvZG-LDb8vcGQ&amp;oe=61F40B65" alt=""/></p><div id="u_0_2h_UU"><div id="u_0_2i_Ql"><div tabindex="0" id="u_0_2j_jq"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_2k_NC"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_2n_ar"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div><p>Developing the next generation of advanced AI will require powerful new computers capable of quintillions of operations per second. Today, Meta is announcing that we’ve designed and built the AI Research SuperCluster (RSC) — which we believe is among the fastest AI supercomputers running today and will be the fastest AI supercomputer in the world when it’s fully built out in mid-2022. Our researchers have already started using RSC to train large models in natural language processing (NLP) and computer vision for research, with the aim of one day training models with trillions of parameters.</p><p>RSC will help Meta’s AI researchers build new and better AI models that can learn from trillions of examples; work across hundreds of different languages; seamlessly analyze text, images, and video together; develop new augmented reality tools; and much more. Our researchers will be able to train the largest models needed to develop advanced AI for <a href="https://ai.facebook.com/blog/detectron-everingham-prize/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>computer vision</span></a>, <a href="https://ai.facebook.com/blog/building-a-conversational-parser-for-on-device-voice-assistants/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>NLP</span></a>, <a href="https://ai.facebook.com/blog/hubert-self-supervised-representation-learning-for-speech-recognition-generation-and-compression/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>speech recognition</span></a>, and more. We hope RSC will help us build entirely new AI systems that can, for example, power real-time voice translations to large groups of people, each speaking a different language, so they can seamlessly collaborate on a research project or play an AR game together. Ultimately, the work done with RSC will pave the way toward building technologies for the next major computing platform — the <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Ftech.fb.com%2Fconnect-2021-our-vision-for-the-metaverse%2F&amp;h=AT0U0aP-0s1faWH5ZNrcgu2Av6hvdOVvQBWUZIYyv1E-AC1uF6aoPFp2ln5E93OTjgKBEP1Czm5wUl-v0nKH6yQlyjgq42N5GBSEjcAQeC20tPWLheaIVfcGu4zjTYxH2XOWne3Vb7MnOkOe" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>metaverse</span></a>, where AI-driven applications and products will play an important role.</p><p><img src="https://scontent-sea1-1.xx.fbcdn.net/v/t39.2365-6/271968481_646114456433383_6290834212134746876_n.jpg?_nc_cat=100&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=gFb8VNK0YmMAX9X_HZv&amp;_nc_ht=scontent-sea1-1.xx&amp;oh=00_AT9xNYTWKs8xQsWUHstlbAQ81oaDqlK6Jqi4PP9GyqaF3Q&amp;oe=61F3B5F2" alt=""/></p><h2>Why do we need an AI supercomputer at this scale?</h2><p>Meta has been <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fengineering.fb.com%2F2018%2F12%2F05%2Fai-research%2Ffair-fifth-anniversary%2F&amp;h=AT3QxcLQyLvJKR2AJfKCcoZsr1MEjWNlET8AGdQX6153lQLqunkNPIXYQ94t_aLUcQ7V3LL2WJ8LZOMldq6QkvIyPExnRaP9OCB4ZxVJN8dZfi3dCPhOvXhp7HkzdoNkSjZ7ZBxGzjE0lMI8" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>committed to long-term investment in AI</span></a> since 2013, when we created the Facebook AI Research lab. In recent years, we’ve made significant strides in AI thanks to our leadership in a number of areas, including <a href="https://ai.facebook.com/blog/self-supervised-learning-the-dark-matter-of-intelligence/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>self-supervised learning</span></a>, where algorithms can learn from vast numbers of unlabeled examples, and <a href="https://ai.facebook.com/blog/end-to-end-object-detection-with-transformers/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>transformers</span></a>, which allow AI models to reason more effectively by focusing on certain areas of their input.</p><p>To fully realize the benefits of self-supervised learning and transformer-based models, various domains, whether vision, speech, language, or for critical use cases like <a href="https://ai.facebook.com/blog/harmful-content-can-evolve-quickly-our-new-ai-system-adapts-to-tackle-it/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>identifying harmful content</span></a>, will require training increasingly <a href="https://ai.facebook.com/blog/introducing-many-to-many-multilingual-machine-translation/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>large</span></a>, <a href="https://ai.facebook.com/blog/ai-gets-better-every-day-heres-what-that-means-for-stopping-hate-speech/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>complex</span></a>, and <a href="https://ai.facebook.com/blog/harmful-content-can-evolve-quickly-our-new-ai-system-adapts-to-tackle-it/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>adaptable</span></a> models. Computer vision, for example, needs to process larger, longer videos with higher data sampling rates. Speech recognition needs to work well even in challenging scenarios with lots of background noise, such as parties or concerts. NLP needs to understand more languages, dialects, and accents. And advances in other areas, including <a href="https://ai.facebook.com/blog/teaching-robots-to-perceive-understand-and-interact-through-touch/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>robotics</span></a>, <a href="https://ai.facebook.com/blog/new-milestones-in-embodied-ai/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>embodied AI</span></a>, and <a href="https://ai.facebook.com/blog/simmc-a-data-set-for-developing-next-generation-shopping-assistants/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>multimodal AI</span></a> will help people accomplish useful tasks in the real world.</p><p>High-performance computing infrastructure is a critical component in training such large models, and Meta’s AI research team has been building these high-powered systems for many years. The first generation of this infrastructure, designed in 2017, has 22,000 NVIDIA V100 Tensor Core GPUs in a single cluster that performs 35,000 training jobs a day. Up until now, this infrastructure has set the bar for Meta’s researchers in terms of its performance, reliability, and productivity. </p><p>In early 2020, we decided the best way to accelerate progress was to design a new computing infrastructure from a clean slate to take advantage of new GPU and network fabric technology. We wanted this infrastructure to be able to train models with more than a trillion parameters on data sets as large as an exabyte — which, to provide a sense of scale, is the equivalent of 36,000 years of high-quality video.</p><p>While the high-performance computing community has been tackling scale for decades, we also had to make sure we have all the needed security and privacy controls in place to protect any training data we use. Unlike with our previous AI research infrastructure, which leveraged only open source and other publicly available data sets, RSC also helps us ensure that our research translates effectively into practice by allowing us to include real-world examples from Meta’s production systems in model training. By doing this, we can help advance research to perform downstream tasks such as identifying harmful content on our platforms as well as research into <a href="https://ai.facebook.com/blog/new-milestones-in-embodied-ai/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>embodied AI</span></a> and <a href="https://ai.facebook.com/blog/ai-that-understands-speech-by-looking-as-well-as-hearing/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>multimodal AI</span></a> to help improve user experiences on our family of apps. We believe this is the first time performance, reliability, security, and privacy have been tackled at such a scale. </p><h2>RSC: Under the hood</h2><p><img src="https://scontent-sea1-1.xx.fbcdn.net/v/t39.2365-6/272129674_454504216213565_903503002058288683_n.jpg?_nc_cat=100&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=S3B7cJC_sAgAX8Ilj3S&amp;_nc_ht=scontent-sea1-1.xx&amp;oh=00_AT-5ukjpsbfS7TBZYoctbagpdE5FonUt8GWJoQc2sueWoQ&amp;oe=61F49D84" alt=""/></p><p>AI supercomputers are built by combining multiple GPUs into compute nodes, which are then connected by a high-performance network fabric to allow fast communication between those GPUs. RSC today comprises a total of 760 NVIDIA DGX A100 systems as its compute nodes, for a total of 6,080 GPUs — with each A100 GPU being more powerful than the V100 used in our previous system. The GPUs communicate via an NVIDIA Quantum 200 Gb/s InfiniBand two-level Clos fabric that has no oversubscription. RSC’s storage tier has 175 petabytes of Pure Storage FlashArray, 46 petabytes of cache storage in Penguin Computing Altus systems, and 10 petabytes of Pure Storage FlashBlade.</p><p>Early benchmarks on RSC, compared with Meta’s legacy production and research infrastructure, have shown that it runs computer vision workflows up to 20 times faster, runs the NVIDIA Collective Communication Library (NCCL) more than nine times faster, and trains large-scale NLP models three times faster. That means a model with tens of billions of parameters can finish training in three weeks, compared with nine weeks before.</p><p><img src="https://scontent-sea1-1.xx.fbcdn.net/v/t39.2365-6/272600494_980161572916475_3328327650672559297_n.jpg?_nc_cat=102&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=iNrIHMF-3TIAX80rj8G&amp;_nc_ht=scontent-sea1-1.xx&amp;oh=00_AT9hkWchsPDMy-s1TCGvXvuiQgb9My2f3jP4slrtJGlkSQ&amp;oe=61F43D9C" alt=""/></p><h2>Building an AI supercomputer…</h2><p><img src="https://scontent-sea1-1.xx.fbcdn.net/v/t39.2365-6/272088836_328320132525651_4571982321198327334_n.jpg?_nc_cat=109&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=VrnaYu5e6dAAX_TbD_W&amp;_nc_ht=scontent-sea1-1.xx&amp;oh=00_AT_BYowKBi3wRkmEYBCDHcQo6CzFCh5JBBSp1cqa1GFUTg&amp;oe=61F32721" alt=""/></p><p>Designing and building something like RSC isn’t a matter of performance alone but performance at the largest scale possible, with the most advanced technology available today. When RSC is complete, the InfiniBand network fabric will connect 16,000 GPUs as endpoints, making it one of the largest such networks deployed to date. Additionally, we designed a caching and storage system that can serve 16 TB/s of training data, and we plan to scale it up to 1 exabyte. </p><p>All this infrastructure must be extremely reliable, as we estimate some experiments could run for weeks and require thousands of GPUs. Lastly, the entire experience of using RSC has to be researcher-friendly so our teams can easily explore a wide range of AI models.</p><p>A big part of achieving this was in working with a number of long-time partners, all of whom also helped design the first generation of our AI infrastructure in 2017. Penguin Computing, an SGH company, our architecture and managed services partner, worked with our operations team on hardware integration to deploy the cluster and helped set up major parts of the control plane. Pure Storage provided us with a robust and scalable storage solution. And NVIDIA provided us with its AI computing technologies featuring cutting-edge systems, GPUs, and InfiniBand fabric, and software stack components like NCCL for the cluster.</p><h2>…and doing it remotely, during a pandemic</h2><p>But there were other unexpected challenges that arose in RSC’s development — namely the coronavirus pandemic. RSC began as a completely remote project that the team took from a simple shared document to a functioning cluster in about a year and a half. COVID-19 and industry-wide wafer supply constraints also brought supply chain issues that made it difficult to get everything from chips to components like optics and GPUs, and even construction materials — all of which had to be transported in accordance with new safety protocols. To build this cluster efficiently, we had to design it from scratch, creating many entirely new Meta-specific conventions and rethinking previous ones along the way. We had to write new rules around our data center designs — including their cooling, power, rack layout, cabling, and networking (including a completely new control plane), among other important considerations. We had to ensure that all the teams, from construction to hardware to software and AI, were working in lockstep and in coordination with our partners.</p><p>Beyond the core system itself, there was also a need for a powerful storage solution, one that can serve terabytes of bandwidth from an exabyte-scale storage system. To serve AI training’s growing bandwidth and capacity needs, we developed a storage service, AI Research Store (AIRStore), from the ground up. To optimize for AI models, AIRStore utilizes a new data preparation phase that preprocesses the data set to be used for training. Once the preparation is performed one time, the prepared data set can be used for multiple training runs until it expires. AIRStore also optimizes data transfers so that cross-region traffic on Meta’s inter-datacenter backbone is minimized. </p><h2>How we safeguard data in RSC</h2><p>To build new AI models that benefit the people using our services — whether that’s detecting harmful content or creating new AR experiences — we need to teach models using real-world data from our production systems. RSC has been designed from the ground up with privacy and security in mind, so that Meta’s researchers can safely train models using encrypted user-generated data that is not decrypted until right before training. For example, RSC is isolated from the larger internet, with no direct inbound or outbound connections, and traffic can flow only from Meta’s production data centers.</p><p>To meet our privacy and security requirements, the entire data path from our storage systems to the GPUs is end-to-end encrypted and has the necessary tools and processes to verify that these requirements are met at all times. Before data is imported to RSC, it must go through a privacy review process to confirm it has been correctly anonymized. The data is then encrypted before it can be used to train AI models and decryption keys are deleted regularly to ensure older data is not still accessible. And since the data is only decrypted at one endpoint, in memory, it is safeguarded even in the unlikely event of a physical breach of the facility.</p><h2>Phase two and beyond</h2><p>RSC is up and running today, but its development is ongoing. Once we complete phase two of building out RSC, we believe it will be the fastest AI supercomputer in the world, performing at nearly 5 exaflops of mixed precision compute. Through 2022, we’ll work to increase the number of GPUs from 6,080 to 16,000, which will increase AI training performance by more than 2.5x. The InfiniBand fabric will expand to support 16,000 ports in a two-layer topology with no oversubscription. The storage system will have a target delivery bandwidth of 16 TB/s and exabyte-scale capacity to meet increased demand.</p><p>We expect such a step function change in compute capability to enable us not only to create more accurate AI models for our existing services, but also to enable completely new user experiences, especially in the metaverse. Our long-term investments in self-supervised learning and in building next-generation AI infrastructure with RSC are helping us create the foundational technologies that will power the metaverse and advance the broader AI community as well.</p></div></div>
  </body>
</html>
