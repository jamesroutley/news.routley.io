<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://leetcode.com/problems/sudoku-solver/discuss/15796/Singapore-prime-minister-Lee-Hsien-Loong%27s-Sudoku-Solver-code-runs-in-1ms">Original</a>
    <h1>Singapore prime minister Lee Hsien Loong&#39;s Sudoku Solver code runs in 1ms</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>Singapore&#39;s prime minister <a href="https://en.wikipedia.org/wiki/Lee_Hsien_Loong" rel="ugc">Lee Hsien Loong</a> showcased his Sudoku Solver C code. You can read his original Facebook post <a href="https://www.facebook.com/leehsienloong/photos/a.344710778924968.83425.125845680811480/905828379479869/?type=3&amp;permPage=1" rel="ugc">here</a> and another news reporting it <a href="https://arstechnica.com/information-technology/2015/05/04/prime-minister-of-singapore-shares-his-c-code-for-sudoku-solver/" rel="ugc">here</a>.</p><p>I have made some slight modification to adapt it so it can be <a href="https://leetcode.com/problems/sudoku-solver/">tested on LeetCode OJ</a>. It passed all 6/6 test cases with a runtime of <strong>1 ms</strong>. Pretty impressive for a prime minister, huh?</p><pre><code>


<span>int</span> InBlock[<span>81</span>], InRow[<span>81</span>], InCol[<span>81</span>];

<span>const</span> <span>int</span> BLANK = <span>0</span>;
<span>const</span> <span>int</span> ONES = <span>0x3fe</span>; 	

<span>int</span> Entry[<span>81</span>];	
<span>int</span> Block[<span>9</span>], Row[<span>9</span>], Col[<span>9</span>];	

<span>int</span> SeqPtr = <span>0</span>;
<span>int</span> Sequence[<span>81</span>];



<span><span>void</span> <span>SwapSeqEntries</span><span>(<span>int</span> S1, <span>int</span> S2)</span>
</span>{
     <span>int</span> temp = Sequence[S2];
     Sequence[S2] = Sequence[S1];
     Sequence[S1] = temp;
}


<span><span>void</span> <span>InitEntry</span><span>(<span>int</span> i, <span>int</span> j, <span>int</span> val)</span>
</span>{
	 <span>int</span> Square = <span>9</span> * i + j;
	 <span>int</span> valbit = <span>1</span> &lt;&lt; val;
     <span>int</span> SeqPtr2;

     
     
	 Entry[Square] = valbit;
	 Block[InBlock[Square]] &amp;= ~valbit;
	 Col[InCol[Square]] &amp;= ~valbit; 
	 Row[InRow[Square]] &amp;= ~valbit; 

     SeqPtr2 = SeqPtr;
     <span>while</span> (SeqPtr2 &lt; <span>81</span> &amp;&amp; Sequence[SeqPtr2] != Square)
           SeqPtr2++ ;

     SwapSeqEntries(SeqPtr, SeqPtr2);
     SeqPtr++;
}


<span><span>void</span> <span>PrintArray</span><span>(<span>char</span> **board)</span>
</span>{
     <span>int</span> i, j, valbit, val, Square;
     <span>char</span> ch;
     
     Square = <span>0</span>;

     <span>for</span> (i = <span>0</span>; i &lt; <span>9</span>; i++) {
         <span>for</span> (j = <span>0</span>; j &lt; <span>9</span>; j++) {
             valbit = Entry[Square++];
             <span>if</span> (valbit == <span>0</span>) ch = <span>&#39;-&#39;</span>;
             <span>else</span> {
                 <span>for</span> (val = <span>1</span>; val &lt;= <span>9</span>; val++) 
                     <span>if</span> (valbit == (<span>1</span> &lt;&lt; val)) {
                        ch = <span>&#39;0&#39;</span> + val;
                        <span>break</span>;
                     }
             }    
             board[i][j] = ch;
         }
     }
}


<span><span>int</span> <span>NextSeq</span><span>(<span>int</span> S)</span>
</span>{
    <span>int</span> S2, Square, Possibles, BitCount;
    <span>int</span> T, MinBitCount = <span>100</span>;

    <span>for</span> (T = S; T &lt; <span>81</span>; T++) {
        Square = Sequence[T];
        Possibles = Block[InBlock[Square]] &amp; Row[InRow[Square]] &amp; Col[InCol[Square]];
        BitCount = <span>0</span>;
        <span>while</span> (Possibles) {
           Possibles &amp;= ~(Possibles &amp; -Possibles);
           BitCount++;
        }

        <span>if</span> (BitCount &lt; MinBitCount) {
           MinBitCount = BitCount;
           S2 = T;
        }
    }

    <span>return</span> S2;
}


<span><span>void</span> <span>Place</span><span>(<span>int</span> S, <span>char</span>** board)</span>
</span>{
    <span>if</span> (S &gt;= <span>81</span>) {
        PrintArray(board);
        <span>return</span>;
    }

    <span>int</span> S2 = NextSeq(S);
    SwapSeqEntries(S, S2);

    <span>int</span> Square = Sequence[S];

    <span>int</span> 	BlockIndex = InBlock[Square],
			RowIndex = InRow[Square],
			ColIndex = InCol[Square];

    <span>int</span> 	Possibles = Block[BlockIndex] &amp; Row[RowIndex] &amp; Col[ColIndex];
    <span>while</span> (Possibles) {
          <span>int</span> valbit = Possibles &amp; (-Possibles); 
          Possibles &amp;= ~valbit;
          Entry[Square] = valbit;
          Block[BlockIndex] &amp;= ~valbit;
          Row[RowIndex] &amp;= ~valbit;
          Col[ColIndex] &amp;= ~valbit;
				
          Place(S + <span>1</span>, board);

          Entry[Square] = BLANK; 
          Block[BlockIndex] |= valbit;
          Row[RowIndex] |= valbit;
          Col[ColIndex] |= valbit;
	}

    SwapSeqEntries(S, S2);
}

<span><span>void</span> <span>solveSudoku</span><span>(<span>char</span> **board, <span>int</span> m, <span>int</span> n)</span> </span>{
    SeqPtr = <span>0</span>;
    <span>int</span> i, j, Square;

	<span>for</span> (i = <span>0</span>; i &lt; <span>9</span>; i++)
		<span>for</span> (j = <span>0</span>; j &lt; <span>9</span>; j++) {
			Square = <span>9</span> * i + j;
			InRow[Square] = i;
			InCol[Square] = j;
			InBlock[Square] = (i / <span>3</span>) * <span>3</span> + ( j / <span>3</span>);
		}


	<span>for</span> (Square = <span>0</span>; Square &lt; <span>81</span>; Square++) {
        Sequence[Square] = Square;
		Entry[Square] = BLANK;
    }
    
	<span>for</span> (i = <span>0</span>; i &lt; <span>9</span>; i++) 
		Block[i] = Row[i] = Col[i] = ONES;
    
    <span>for</span> (<span>int</span> i = <span>0</span>; i &lt; <span>9</span>; ++i)
       <span>for</span> (<span>int</span> j = <span>0</span>; j &lt; <span>9</span>; ++j) {
           <span>if</span> (<span>&#39;.&#39;</span> != board[i][j])
                InitEntry(i, j, board[i][j] - <span>&#39;0&#39;</span>);
       }
       
    Place(SeqPtr, board);
}
</code></pre></div></div></div>
  </body>
</html>
