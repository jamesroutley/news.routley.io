<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/tqbf/status/1516570590211153922">Original</a>
    <h1>Crypto bug of the year: ECDSA signatures broken in Java</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-31574" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516570590211153922" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="23" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:12:59.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:12:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516570590211153922" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516570590211153922" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__dsrj05c03ns id__suwd0vmz2jl id__qelfmm8zpce id__p1vwfl490d id__ukyjmfoizl id__bz6hksn2ztt id__h3wu2cysbwd id__sbxphke0t1o id__liuwa20cf7o id__e8r0gjyx9lh id__f826mpg5rig id__aw5oluz5h7 id__i81wf6eglu id__7xmu78um9ud id__h8la1oznb8b id__mnk4adov4vm" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__bz6hksn2ztt"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody"><div><p><span>Welp. It’s the crypto bug of the year. Mark it down for April. Java 15-18 ECDSA doesn’t sanity check that the random x coordinate and signature proof are nonzero; a (0,0) signature validates any message. Breaks JWT, SAML, &amp;c.</span></p></div></div></div><div><div aria-labelledby="id__vsc29udb0ls id__xoyf2o9j7uh" id="id__aw5oluz5h7"><div><div aria-labelledby="id__d3hr6rbfwjn id__acpx2gso9dl" id="id__xoyf2o9j7uh" data-testid="card.wrapper"><div aria-hidden="true" id="id__d3hr6rbfwjn" data-testid="card.layoutLarge.media"><a href="https://t.co/t2WgnS0g3A" rel="noopener noreferrer" target="_blank" role="link" tabindex="-1"><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/card_img/1516509858928934916/suvA8gJZ?format=jpg&amp;name=small"/></p></div></div></div></a></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516570870671630339" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:14:06.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:14:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516570870671630339" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516570590211153922" itemprop="isPartOf"/><div><article aria-labelledby="id__ztsbcywg2yf id__qyea738c2f id__8amyb4yzdvd id__8ebwepxxsa3 id__rj9ji054c5 id__tt0a4g7c4eh id__4yyik9he4n id__kax18bldxg id__ok6ss5xlj0n id__2sxnej6j5dk id__k896pcphg8r id__9h8d6c1xj3k id__y4lg12etygr id__br6p2gnppsw id__01zshwj79oj1 id__8ah7ogq02xq" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__tt0a4g7c4eh"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>These are my very most favorite crypto bugs and are endemic to asymmetric primitives (similar things happen in SRP and DH).</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516575164812738563" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:31:10.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:31:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516575164812738563" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516570870671630339" itemprop="isPartOf"/><div><article aria-labelledby="id__r4xepzc0l1 id__a68w6hplyl id__zlncyh7tkr id__pf4zlcwvgzh id__et682e10t6 id__toly66oq5v id__xhnrc7notcg id__tde5anupa8r id__2p8lk0v7yk id__dwm7ck0m35c id__utquhdnnajj id__d7uk1z57rfu id__o04c2pudkak id__17did0y61fq id__iggapjlxc2a id__43ivjoqfocl" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__toly66oq5v"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>I’ll take a shot at this and see how wrong I can be in a couple tweets. 

An ECDSA sig is (r,s). r is a random value derived (infamously) from a nonce k. s is a signature proof mixing r, a hash, and the private key, divided by k.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516575513686552577" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:32:33.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:32:33.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516575513686552577" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516575164812738563" itemprop="isPartOf"/><div><article aria-labelledby="id__w6n8n1q6hak id__7u5pfbm4xw8 id__sfcumkt9ns8 id__rokug73pr0e id__zsxh2sare8 id__l9n8kuahfz8 id__sbaf2fc68pa id__t92ep1frneh id__9y6po5anzet id__2xt1tepm2ie id__wwjxyzun3n8 id__ap1j44hg5m4 id__8o1aznedgue id__7yqxvuak6y2 id__kv1snf39y4 id__3pxw629y904" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__l9n8kuahfz8"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>ECDSA verification uses the pubkey and the hash to extract r’ from s and then checks to make sure r’ matches r. 

If they’re both zero… there’s not much to check!</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516576413176020998" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:36:08.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:36:08.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516576413176020998" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516575513686552577" itemprop="isPartOf"/><div><article aria-labelledby="id__6y3r336t0b9 id__jfknzyb4e89 id__0pbqjumvdnin id__vukgb4hhgp id__68rru23lqwe id__uyk95yhi5p id__4zvfi5n2liv id__efki9i0peu id__oi12fg25hv id__nxd8hyyfcy id__hh6ldhhgmve id__ywohw76qks id__pkh98pm6fqh id__etnldvxx7r5 id__fxnpxegg7u9 id__c27qaltxbbu" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__uyk95yhi5p"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The broader issue here isn’t that Java 15+ rewrote their C++ ECDSA in pure Java and broke it, though that’s an issue (see: Wycheproof for more). It’s that people use ECDSA in things like JWT without extremely compelling reasons to.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516576615408541702" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:36:56.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:36:56.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516576615408541702" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516576413176020998" itemprop="isPartOf"/><div><article aria-labelledby="id__8wi76t2kmnh id__s3mdgnvfj1f id__139gb1ytuua id__b7dgsc80rbh id__gceqfgmq6aj id__oe9uwg50zhq id__uu0djz57as id__3fgu0zpjfor id__rcmox6agqts id__rl8mhs3jum id__l3uw0bualff id__cpex334nc3 id__9nyqxfl9d6i id__0j14sembk2oa id__8utq77glx7k id__9e5l9l91od8" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__oe9uwg50zhq"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Just a basic cryptographic risk management principle that cryptography people get mad at me for saying (because it’s true) is: don’t use asymmetric cryptography unless you absolutely need it.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516577012361662466" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:38:31.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:38:31.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516577012361662466" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516576615408541702" itemprop="isPartOf"/><div><article aria-labelledby="id__xmjkddme2y id__jreq2zxx72 id__3rqnioxntz id__ypn5g0y3f7m id__ox5i0k01fir id__yj5h7w15znm id__ocurw0i8b6 id__x1jv89u3dal id__huw0nwdmi28 id__4m00i03fnug id__8ytw3wegcx id__v8ukwwcuvx id__ldyv9m3lwz id__13hj18twg8ah id__f69wum9yctq id__5gn1azfdtd3" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__yj5h7w15znm"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>It is nevertheless funny that there is a Wycheproof test for this bug (of course there is, it’s the most basic implementation check in ECDSA) and nobody bothered to run it against one of the most important ECDSA’s until now.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516577229597204488" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:39:22.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:39:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tqbf/status/1516577229597204488" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516577012361662466" itemprop="isPartOf"/><div><article aria-labelledby="id__fedxxpft2k id__rafnk8841ig id__l0muo1se0ee id__cx3gw51gyt id__1sa588e8xkj id__uld5pqoq3u9 id__3jrrrhex2w5 id__h4wv582ft2s id__myv2gsw630b id__99vu8g5o6ah id__soz3o01kt99 id__5kgkchcgevl id__52hv35nxuv2 id__95rj5c0cp3w id__2nkm7b6sft2 id__aaia0v2qjys" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__uld5pqoq3u9"><div><div><div><div><a href="https://twitter.com/tqbf" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1440053758084272132/dF6N7UBk_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>but like, that’s WHY you shouldn’t use asymmetric cryptography unless you absolutely need it, because you have to assume nothing like Wycheproof ran against your implementation; I shit you not people have claimed to verify implementations by having them pass spec test vectors.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516574908444286977" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T00:30:09.000Z" itemprop="dateCreated"/><meta content="2022-04-20T00:30:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Jacob_Henner/status/1516574908444286977" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516570590211153922" itemprop="isPartOf"/><div><article aria-labelledby="id__turpulz5cj id__5lllljlg1zv id__kmpwvi81gv id__6fpiy552jwf id__pklxp07mnso id__at13hlpmk id__dwgyn571s3k id__enp0ls1k0p id__ua9om4s15j id__v9nifnlwajc id__25kswu7sv1t id__ovoqwq6prk id__dudmj9rpaz9 id__rxtyqykevac id__rkzeonr4zpr id__lh1tu7rcmqj" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__at13hlpmk"><div><div><div><div><a href="https://twitter.com/Jacob_Henner" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/921719882730917889/jjbatJjM_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Thankfully many big orgs using Java are still years away from adopting anything newer than Java 11 </span><span>😆</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516598888874057728" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T02:05:26.000Z" itemprop="dateCreated"/><meta content="2022-04-20T02:05:26.000Z" itemprop="datePublished"/><meta content="https://twitter.com/leo60228/status/1516598888874057728" itemprop="url"/><meta content="https://twitter.com/Jacob_Henner/status/1516574908444286977" itemprop="isPartOf"/><div><article aria-labelledby="id__cmxwix1qyej id__s1ksqdptm1a id__4wkxveh66vu id__9xs89qw5acu id__cqyt4s7p3ll id__iv738wp1jds id__q2fzhurt6vo id__jngwedvqovg id__v5jjjhhbnt id__dtxn1j3bzy id__l5wf0ha2ahi id__ajxfqljqfhp id__bu0h4y55arn id__vbjfnw68owi id__fcvyvmo8f7i id__dyub25gfrpk" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__iv738wp1jds"><div><div><div><div><a href="https://twitter.com/leo60228" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1233118413570093057/8dGSqVqU_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>android is just getting around to java 11!</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1516592625557536768" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-20T01:40:33.000Z" itemprop="dateCreated"/><meta content="2022-04-20T01:40:33.000Z" itemprop="datePublished"/><meta content="https://twitter.com/chadloder/status/1516592625557536768" itemprop="url"/><meta content="https://twitter.com/tqbf/status/1516570590211153922" itemprop="isPartOf"/><div><article aria-labelledby="id__gby29hkcxea id__yd0isc3e3o id__rmwgfkddcf id__rjewwkicuqb id__z8pu3bnt91h id__ynr0gqaymhq id__0drhiinf243u id__e969qboyjdw id__uxekwu4t2gs id__txim3q1n1c id__ny5gltdq86a id__pos7hzlhnd id__jgjqr339n0a id__51w8lrtrkt7 id__z8y5cvzxgnn id__g66zvcsio0k" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ynr0gqaymhq"><div><div><div><div><a href="https://twitter.com/chadloder" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1390734860449288193/GK2lltlb_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
