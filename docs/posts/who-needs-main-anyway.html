<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2023/01/20/mainless/">Original</a>
    <h1>Who needs main() anyway?</h1>
    
    
<p>
Want to inflict terrible things on other programmers who show up later 
to do maintenance work?  Write C++ code that doesn't need a main().  
Then write C++ code that doesn't *have* a main().  Yes.  
</p><p>
I
<a href="/w/2011/12/03/spooky/">mentioned this</a>
quite a while back, calling it "spooky action at a distance" in code, 
but looking at that now, it seems like it was a very long and drawn out 
demonstration.
</p><p>
Instead, tonight, I present a far simpler version.   Usual disclaimers 
apply: may summon Ancient Ones who will haunt your soul.  Probably won't 
work on all systems or compilers.  It didn't work for me until I gave 
it -O2, and even then, it still gives a magnificent segfault.
</p><p>
At any rate, enjoy the evil.
</p><p>
<pre>
$ cat <a href="https://knowyourmeme.com/memes/laughing-lizard-hhhehehe">hhhehehehe</a>.cc 
#include &lt;unistd.h&gt;
 
class wat {
 public:
  wat() { write(1, "wat\n", 4); }
};
 
static wat wat_;
 
// no main.  nothing else.
$ g++ -O2 -Wall -nostartfiles -o hhhehehehe hhhehehehe.cc
/usr/bin/ld: warning: cannot find entry symbol _start; [...]
$ ./hhhehehehe 
wat
Segmentation fault
$ 
</pre>
</p><p>
That's it.
</p>

  </body>
</html>
