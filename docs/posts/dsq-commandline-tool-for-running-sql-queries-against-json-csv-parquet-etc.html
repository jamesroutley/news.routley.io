<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://datastation.multiprocess.io/blog/2022-01-11-dsq.html">Original</a>
    <h1>Dsq: Commandline tool for running SQL queries against JSON, CSV, Parquet, etc.</h1>
    
    <div id="readability-page-1" class="page"><section>
  <div>
    <p><label>What is DataStation?</label><small>DataStation is an open-source data IDE for developers. It allows you to easily build graphs and tables with data pulled from SQL databases, logging databases, metrics databases, HTTP servers, and all kinds of text and binary files. Need to join or munge data? Write embedded scripts as needed in Python, JavaScript, Ruby, R, or Julia. All in one application.</small></p>
    
<p>
  <a href="https://github.com/multiprocessio/dsq">dsq</a> is a commandline tool for running SQL queries against all the
  data file types that <a href="https://github.com/multiprocessio/datastation">DataStation</a> supports (JSON, CSV, Parquet,
  Excel, etc.). Here is a simple example:
</p>
<pre><code>$ cat users.csv
name,age
Jorge,30
Nina,32
Cal,28
Mona,27
$ dsq users.csv &#34;SELECT * FROM {} ORDER BY CAST(age AS INT) DESC&#34; | jq
[
  {
    &#34;age&#34;: &#34;32&#34;,
    &#34;name&#34;: &#34;Nina&#34;
  },
  {
    &#34;age&#34;: &#34;30&#34;,
    &#34;name&#34;: &#34;Jorge&#34;
  },
  {
    &#34;age&#34;: &#34;28&#34;,
    &#34;name&#34;: &#34;Cal&#34;
  },
  {
    &#34;age&#34;: &#34;27&#34;,
    &#34;name&#34;: &#34;Mona&#34;
  }
]</code></pre>
<p>
  dsq
  uses <a href="https://github.com/multiprocessio/datastation">DataStation</a>
  libraries under-the-hood and DataStation in turn uses SQLite for
  these kinds of queries.
</p>
<p>
  The dsq source code
  is <a href="https://github.com/multiprocessio/dsq">available on
  Github</a>.
</p>
<h2>Install</h2>
<p>
  dsq originated as a subproject in the DataStation repo but now
  exists <a href="https://github.com/multiprocessio/dsq">on its
  own</a>. You can install it with Go 1.17+:
</p>
<pre><code>$ go install github.com/multiprocessio/dsq@latest</code></pre>
<h2>Multiple files and joins</h2>
<p>
  If you pass multiple files to dsq, they become available under the
  alias <code>{N}</code> where <code>N</code> is the 0-based index of
  the list of files passed on the commandline. <code>{}</code> is an
  alias for <code>{0}</code>. For example:
</p>
<pre><code>$ cat ids.json
[
  {&#34;id&#34;: 1, &#34;name&#34;: &#34;Jorge&#34;},
  {&#34;id&#34;: 2, &#34;name&#34;: &#34;Mona&#34;},
  {&#34;id&#34;: 3, &#34;name&#34;: &#34;Cal&#34;},
  {&#34;id&#34;: 4, &#34;name&#34;: &#34;Nina&#34;}
]
$ dsq users.csv ids.json &#34;SELECT id, {0}.name FROM {0} JOIN {1} ON {0}.name = {1}.name&#34; | jq
[
  {
    &#34;id&#34;: 1,
    &#34;name&#34;: &#34;Jorge&#34;
  },
  {
    &#34;id&#34;: 4,
    &#34;name&#34;: &#34;Nina&#34;
  },
  {
    &#34;id&#34;: 3,
    &#34;name&#34;: &#34;Cal&#34;
  },
  {
    &#34;id&#34;: 2,
    &#34;name&#34;: &#34;Mona&#34;
  }
]</code></pre>
<h2>File type support</h2>
<p>
  As of today dsq supports: JSON, CSV, TSV, Excel, Parquet, OpenOffice
  Sheets, and Apache2 and nginx logs. This list will continue to grow
  over time.
</p>
<p>
  The complete list of file extensions and mimetypes
  is <a href="https://github.com/multiprocessio/dsq#supported-data-types">in
  the README here</a>.
</p>
<h2>Comparison to other tools</h2>
<p>
  There are a number of existing tools
  like <a href="http://harelba.github.io/q/">q</a>, <a href="https://github.com/dinedal/textql">textql</a>
  and <a href="https://github.com/cube2222/octosql">octosql</a>. These
  are mature tools and there wouldn&#39;t be a need for dsq. But
  DataStation already supports the core logic so exposing this CLI is
  very simple. Moreover DataStation supports more file types than
  these existing tools.
</p>
<p>
  A detailed comparison table is available in
  the <a href="https://github.com/multiprocessio/dsq#comparisons">repo
  README here</a>.
</p>
<h2>Try it out!</h2>
<p>
  Give it a go, share any bugs or feedback! The code
  is <a href="https://github.com/multiprocessio/dsq">available on
  Github</a>.
</p>
<h4>Share</h4>
<blockquote><p lang="en" dir="ltr">dsq now supports joining against multiple files (of any supported type!). It also now supports .tsv and .ods (OpenOffice Sheets) files.</p>â€” Multiprocess Labs (@multiprocessio) <a href="https://twitter.com/multiprocessio/status/1480920718439329797?ref_src=twsrc%5Etfw">January 11, 2022</a></blockquote> 

    <p>
      Questions? Feedback? Feel free to reach the author at phil@multiprocess.io.
    </p>
  </div>
</section></div>
  </body>
</html>
