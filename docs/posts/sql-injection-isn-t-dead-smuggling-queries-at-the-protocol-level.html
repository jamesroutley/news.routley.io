<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simonwillison.net/2024/Aug/12/smuggling-queries-at-the-protocol-level/">Original</a>
    <h1>SQL Injection Isn&#39;t Dead: Smuggling Queries at the Protocol Level</h1>
    
    <div id="readability-page-1" class="page"><div>


<p><strong><a href="https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Paul%20Gerste%20-%20SQL%20Injection%20Isn%27t%20Dead%20Smuggling%20Queries%20at%20the%20Protocol%20Level.pdf">SQL Injection Isn&#39;t Dead: Smuggling Queries at the Protocol Level</a></strong> (<a href="https://lobste.rs/s/mxgp7v/sql_injection_isn_t_dead_smuggling" title="lobste.rs">via</a>) PDF slides from a presentation by <a href="https://twitter.com/pspaul95">Paul Gerste</a> at DEF CON 32. It turns out some databases have vulnerabilities in their binary protocols that can be exploited by carefully crafted SQL queries.</p>
<p>Paul demonstrates an attack against PostgreSQL (which works in some but not all of the PostgreSQL client libraries) which uses a message size overflow, by embedding a string longer than 4GB (2**32 bytes) which overflows the maximum length of a string in the underlying protocol and writes data to the subsequent value. He then shows a similar attack against MongoDB.</p>
<p>The current way to protect against these attacks is to ensure a size limit on incoming requests. This can be more difficult than you may expect - Paul points out that alternative paths such as WebSockets might bypass limits that are in place for regular HTTP requests, plus some servers may apply limits before decompression, allowing an attacker to send a compressed payload that is larger than the configured limit.</p>
<p><img alt="How Web Apps Handle Large Payloads. Potential bypasses: - Unprotected endpoints - Compression - WebSockets (highlighted) - Alternate body types - Incrementation.  Next to WebSockets:  - Compression support - Large message size - Many filters don&#39;t apply" src="https://static.simonwillison.net/static/2024/sql-injection-websockets.jpg"/></p>



</div></div>
  </body>
</html>
