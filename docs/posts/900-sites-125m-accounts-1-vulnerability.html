<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://env.fail/posts/firewreck-1/">Original</a>
    <h1>900 Sites, 125M accounts, 1 Vulnerability</h1>
    
    <div id="readability-page-1" class="page"><div><article><div><p><strong>TLDR</strong>:</p>
<p>- Firebase allows for easy misconfiguration of security rules with zero warnings</p>
<p>- This has resulted in hundreds of sites exposing a total of ~125 Million user records, including <strong>plaintext passwords</strong> &amp; <strong>sensitive billing information</strong></p>
<hr/>
<p>After the initial buzz of <a href="https://mrbruh.com/chattr/">pwning Chattr.ai</a> had settled down, we set to work on <strong>scanning the entire internet</strong> for exposed PII via misconfigured Firebase instances.</p>
<h2>Attempt 1</h2>
<p><a href="https://env.fail/writer/mrbruh">MrBruh</a> wrote up a rudimentary scanner in Python that would check for Firebase configuration variables in websites or their loaded .js bundles.</p>
<p>It worked... until it didn&#39;t.</p>
<p>Turns out that a Python program with ~500 threads will start to chew up memory over time. For us that meant it was OOM&#39;ing within an hour of starting it.</p>
<h2>Attempt 2</h2>
<p><a href="https://env.fail/writer/logykk">Logykk</a> rewrote the scanner in Go, unlike the prior it didn&#39;t seem to leak memory.</p>
<p>Our initial estimate was that this was going to take ~11 days to scan through the 5 1/2 Million domains, but it turned out to be closer to 2-3 weeks which made this very much a waiting game.</p>
<h2>Manually checking every domain</h2>
<p>We first went and started manually looking at each entry in the 550k line text file, seeing if we could find anything interesting, this was time consuming and very repetitive.</p>
<p>In the end, we went through quite a lot of it and had 136 sites and 6.2 million records, but we all knew that we needed to do something fully automated, because this was taking way too long.</p>
<h2>Catalyst</h2>
<p>Once we had acquired our shortlist of potentially affected sites we ran it through a secondary scanner that <a href="https://env.fail/writer/xyzeva">Eva</a> had made called Catalyst.</p>
<p>This would take the site (or .js bundle) we found, then automatically check for read access to common Firebase collections &amp; any that were explicitly mentioned in the JavaScript itself.</p>
<p>When it found read access to a collection it would attempt to calculate the impact of the exposed data by gathering a sample of 100 records, <strong>checking the type of information contained and extrapolating that by the total size of the collection</strong>.</p>
<p>We then, decided the database to use to store all of these results, and we chose <a href="https://supabase.com">Supabase</a> (which uses PostgreSQL under the hood) a open source Firebase competitor, just for the irony.</p>
<p>Once all that had been completed the data was formatted and uploaded to a private database table.</p>
<p><img src="https://env.fail/files/img/posts/firewreck-1/supabase_table.png" alt="A database table viewer of data, with the columns of projectId, websiteUrls, allCount, namesCount, emailCount, phoneCount, hashedPwdCount, plaintextPwdCount, billingCount"/></p>
<h2>The Numbers</h2>
<ul>
<li>All (records): 124,605,664</li>
<li>Names: 84,221,169</li>
<li>Emails: 106,266,766</li>
<li>Phone Numbers: 33,559,863</li>
<li>Passwords: 20,185,831</li>
<li>Billing Info (Bank details, invoices, etc): 27,487,924</li>
</ul>
<p>These numbers should be taken with a grain of salt. <strong><em>They are likely larger than shown here.</em></strong></p>

<h3>1. Silid LMS</h3>
<p><img src="https://env.fail/files/img/posts/firewreck-1/silidlms.png" alt="SilidLMS, a learning platform for teachers"/></p>
<ul>
<li>Learning management system for students &amp; teachers</li>
<li>Most total exposed user records, at <strong>27 Million affected users</strong>. (Names, Emails &amp; Phone numbers)</li>
</ul>
<h3>2. Online gambling network</h3>
<p><img src="https://env.fail/files/img/posts/firewreck-1/gambling_ring.png" alt="Carousel of 6 animal themed login pages, on different websites, all very clearly a look alike"/></p>
<ul>
<li>Comprised of 9 sites which are all reskins of each other.</li>
<li>Some <strong>spins are rigged</strong> to have a 0% chance of winning.</li>
<li>Customer support tried to flirt with me when attempting to report the issue.
<img src="https://env.fail/files/img/posts/firewreck-1/gambling_msgs.png" alt=""/></li>
<li>Contains the <strong>most amount of exposed bank account details (logins) out of all of our records. (8 Million)</strong></li>
<li>Also contains the most plaintext passwords out of all of the affected websites, at <strong>10 Million passwords being exposed</strong>.</li>
</ul>
<h3>3. Lead Carrot</h3>
<p><img src="https://env.fail/files/img/posts/firewreck-1/leadcarrot.png" alt="Online lead company, &#34;Fill your pipeline with accurate leads today&#34;"/></p>
<ul>
<li>Online “lead” generator for cold calling</li>
<li>Top 3 in total amount of exposed user information, siting at <strong>22 Million affected people</strong>.</li>
</ul>
<h3>4. MyChefTool</h3>
<p><img src="https://env.fail/files/img/posts/firewreck-1/mycheftool.png" alt="&#34;More than just a PoS&#34; top header with &#34;The definitive app for managing your business&#34; main header"/></p>
<ul>
<li>Business management app &amp; Point of Service application for restaurants</li>
<li>1st place for most exposed Names &amp; 2nd place for exposed Emails. <strong>(14 Million &amp; 13 Million respectively)</strong></li>
</ul>
<h2>The aftermath</h2>
<ul>
<li>842 Emails sent over 13 days</li>
<li>85% Emails delivered</li>
<li>9% Emails bounced</li>
<li>24% of Site owners fixed the misconfiguration</li>
<li>1% of Site owners emailed us back</li>
<li>0.2% (2) Sites owners offered a bug bounty</li>
</ul>
</div></article></div></div>
  </body>
</html>
