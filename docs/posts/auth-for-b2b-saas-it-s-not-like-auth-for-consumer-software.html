<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tesseral.com/blog/b2b-auth-isnt-that-similar-to-b2c-auth">Original</a>
    <h1>Auth for B2B SaaS: it&#39;s not like auth for consumer software</h1>
    
    <div id="readability-page-1" class="page"><div><p><em>Auth</em> for business software (B2B) shouldn’t look the same as auth for consumer software  (B2C). In many cases, it actually <em>can’t</em> work the same way.</p>
<p>I’ll cover three important buckets of differences between B2B auth and B2C auth:</p>
<ol>
<li>Logical isolation and tenancy models</li>
<li>Priorities and trade-offs</li>
<li>Protocols and features</li>
</ol>
<p>By the way – let’s use <em>auth</em> loosely here and let it subsume related stuff like user management. Similarly, let’s just imagine away the vague grey area between consumers and businesses (e.g., software for sole proprietors) and focus solely on obvious consumer apps and obvious enterprise products. A simplified model of the world helps make things clear.</p>
<h2>Logical isolation and tenancy models</h2>
<p>In B2C software, your customers are your users. They’re individual people that control their own accounts. Things don’t work that way in B2B software. Businesses want to control their users’ access; and within a given business, not all users should work the same way. This has pretty significant implications for auth.</p>
<p>Let’s first look at tenancy in consumer software and then take a glance at business software.</p>
<h3>Users: First-class tenancy in consumer software</h3>
<p>In a consumer application, we primarily care about individual users.</p>
<p>To illustrate what this looks like, I went to Club Penguin Legacy and created an account for myself. Signing up for a CPL account is pretty easy. Aside from email verification, all you need is a username and a password.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/6XFhc8NZ9xFkr4OhnBmA6a/b4a843a9ed6184a9d3cc56679270771c/clubpenguin1.png" alt="club-penguin1"/></p>
<p>Club Penguin associates all of my data with my penguin. I get to edit some of my penguin’s data if I want. For example, each penguin gets an igloo. I get to edit my own igloo.</p>
<p>No one else gets to edit my igloo.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/7vdtKPoQVAyMXi7I7al00E/e604cee07091a87712bf05f8a8e9db8d/club-penguin2.png" alt="club-penguin2"/></p>
<p>If I want to upgrade my igloo, Club Penguin checks to see how many coins I have. This is a property that’s associated with my user account. Regrettably, I do not have enough coins to purchase the undersea igloo theme.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/67xq067wQf687fNWqioSVg/433aa2ca590c03ba7d311ea615e29515/clubpenguin3.png" alt="club-penguin3"/></p>
<p>None of what I’ve covered here should seem surprising. This all seems kind of obvious – kind of normal – doesn’t it?</p>
<p>I have an account for myself, and data lives on the account level. I alone exercise control over my account. My content is mine, at least in the sense that it doesn’t belong to another user. It’s just me and the penguin.</p>
<p><em>Isn’t this how pretty much all software works</em>, you might wonder. This is how we learn to build software in school, right? It’s the most obvious way to implement logical isolation; it makes intuitive sense.</p>
<p>But this tenancy model doesn’t work for business software. If you use the Club Penguin tenancy model in business software, you’re going to have a very bad time.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/2GtVXtYEzKxzWVxaMAEIvv/798ffc8a0bffa5f5577a811ab7a897d5/bad-time.gif" alt="bad-time"/></p>
<h3>Organizations: First-class tenancy in business software</h3>
<p>The tenancy model for business software doesn’t put end users first. When you’re selling B2B, your customer isn’t an end user. It’s more complicated than that. Your customer is a company. And the company wants control over its users.</p>
<p>I like to use Slack as an example here.</p>
<p>If you’ve ever used Slack, you have a sense for what it’s like. You can send passive aggressive GIFs to your coworkers. You can upload custom reactions that are just cropped pictures of your boss’s face lifted from college-era Facebook photos. You can scroll all the way up in #general to find gossip that HR hasn’t thought to remove.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/3NOPgn51EWkbnb1eJ58pua/74d313e3b08331a5cd6d719538aa9d21/scim-slack.png" alt="scim-slack"/></p>
<p>All of Slack’s useful features require that you and your colleagues can exchange messages, so you all need to be clustered together in the same software-defined place. Slack calls these places <em>Workspaces</em>. Normally, each <em>Workspace</em> maps onto a unique business customer. And end users – employees of business customers – all belong to <em>Workspaces</em>. We can say that the <em>Workspace</em> is the first-class tenant. We can say that a <em>tenancy firewall</em> exists between such tenants.</p>
<p>Business software pretty much always implements tenancy like this. You need some concept of company-level tenancy to support the features that business customers expect. (More on this later.)</p>
<p><em>Now, in the real world, this actually ends up being a bit complicated. Keeping Slack as an example, one of my former employers actually had dozens of Workspaces across the company; IT had some convoluted enterprise-y way of managing these in a hierarchy. Plus, Slack now has its Connect feature that allows you to communicate across tenants. But let’s imagine all of these wrinkles away.</em></p>
<p>It’s certainly possible to bolt-on a B2B multitenancy model when you already have some users. We see this from time to time. However, it&#39;s usually complicated and laborious. A lot of sensitive code needs to get rewritten when you change your tenancy model.</p>
<p>Life is easier when you get this right from the start.</p>
<h2>Different priorities</h2>
<h3>Performance at scale</h3>
<p>Consumer software must always anticipate the possibility of many users.</p>
<p>At the extreme end of scale, Meta, reports 3.35 <strong>billion</strong> Daily Active People (DAP) across its different applications (Instagram, WhatsApp, Facebook, etc.). Even a relatively niche app like chess.com reports more than <a href="https://www.chess.com/members">200 million users</a>; it’s normal at any time for several hundred thousand users to be active.</p>
<p>Maintaining any reasonable standard of performance can force a major consumer software application to do complicated things. An example from a Meta whitepaper:</p>
<blockquote>
<p>The public-key nature of certificate-based tokens can be problematic in high-performance settings. If Alerts expects to receive millions of requests per second from Messages, having to validate signatures on each such request can quickly consume the computation time of Alerts.</p>
</blockquote>
<p>These performance considerations aren’t often relevant in business software. Immense B2B companies like Salesforce or Zoom aside, control planes for business software applications tend not to operate at such extreme scale. And even when they do, sharding’s an option (not so for Facebook – everyone needs to live in the same Facebook.com!).</p>
<p>Consequently, B2B applications rarely need to invent new, bespoke things.</p>
<h3>End user experience</h3>
<p>End user experience is <strong>everything</strong> in consumer software. Consumers use products that they like, and they’re often picky.</p>
<p>Teams that build consumer software try very hard to prevent users from churning – or even failing to <a href="https://www.lennysnewsletter.com/p/how-to-determine-your-activation">activate</a> altogether. Consider that a freemium product will consider itself unusually successful if it converts ~1% of users to its paid tier. Against that low base rate, even very subtle optimizations can be powerful.</p>
<p>Consumer applications have strong incentives not to introduce friction into sign-up or log-in flows. For example, Reddit doesn’t try very hard to get users to adopt multi-factor authentication.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/2hGgxmsKaIdqRxsubqsGFx/1fe547e3450d46462d2fb3fa0bf3d8e6/reddit-mfa.png" alt="reddit-mfa"/></p>
<p>By contrast, end users of business software don’t get to pick their software – at least not very often. They generally use the software that their employers choose. As a consequence, end user experience tends not to matter quite as much as in consumer software. Little speed bumps are okay if they serve a business need.</p>
<p>This means that business software can force annoying – but important – security onto end users. We can make people eat their metaphorical vegetables.</p>
<h3>Support as an escape hatch</h3>
<p>Consumer software and business software have pretty different unit economics. A typical user of consumer software is worth a lot less than a typical user of business software. The different unit economics have design implications throughout entire products, of course, but for the purposes of this article, we’ll just focus on user auth.</p>
<p>Consider Pinterest. That’s a pretty successful consumer software company, right? I mean, at time of writing, Pinterest trades at roughly a $25B market cap. Even for a company as successful as Pinterest, the average user isn’t worth much. For FY24, average revenue per user (ARPU) for Pinterest <a href="https://investor.pinterestinc.com/news-and-events/press-releases/press-releases-details/2025/Pinterest-Announces-Fourth-Quarter-and-Full-Year-2024-Results-Delivers-First-Billion-Dollar-Revenue-Quarter/default.aspx">came in at $6.94</a>. I’m not missing a digit here. An average Pinterest user is worth about as much to Pinterest as a San Francisco cold brew.</p>
<p>That’s pretty different from a B2B app like Zendesk, which charges $1,380 per user per year for its <em>Suite Professional</em> product. I’m handwaving a bit with this comparison, but still. That’s almost exactly 200x the value of a Pinterest user.</p>
<p>That huge disparity in the value of an average user means you can do some pretty different things in business software.</p>
<p>If you’re locked out of consumer software, you’re usually left to navigate some labyrinthine bureaucracy. Sometimes you won’t succeed at all; for example, there are many posts online of people interminably locked out of <a href="https://www.reddit.com/r/applehelp/comments/1iamxq9/apple_id_locked_and_apple_support_wont_unlock_it/">their Apple accounts.</a></p>
<p>In business software, life can be pretty simple. Business software vendors don’t really need a lot of process; they’re just not dealing with the same sort of support volume. You can plausibly even have an engineer run a one-off script for a customer.</p>
<p>Business software vendors can afford to take shortcuts, provided their auth systems come with the right features. For example, it’s common for a business software vendor to guide a customer through implementation or to tweak some settings. To do this, business software vendors often turn on <em>user impersonation</em>. This means that a support person can grant himself a session, logging in as his customer. It’s a pretty neat trick that circumvents long email chains.</p>
<h3>Threat model: outsiders vs. insiders</h3>
<p>In consumer software, we mostly worry about managing scams, fraud, and abuse.</p>
<p>Phishing scams are a big problem – someone tries to trick you into handing over your <a href="https://www.ksat.com/news/local/2022/04/05/these-criminals-are-ruthless-usaa-warns-of-new-scam-attempting-to-get-online-bank-login-information/">bank login</a> or <a href="https://www.pcmag.com/news/watch-out-for-this-gmail-account-takeover-scam">your Gmail</a>. Account sharing can be an issue: if you want to make Uber Eats deliveries, you need to <a href="https://help.uber.com/en/driving-and-delivering/article/3---complete-your-background-check?nodeId=2b518fd0-9642-4f1b-9569-3e5f39818ce3">pass a background check</a>; it’s a problem for Uber if drivers can share accounts, because a person can circumvent the background check by simply using someone else’s account.</p>
<p>Consumer software also has to battle <a href="https://www.theguardian.com/technology/2023/sep/09/x-twitter-bots-republican-primary-debate-tweets-increase">bots</a> and <a href="https://www.reddit.com/r/facebookdisabledme/comments/1dyksp9/permanent_ban/">ban users</a> that can’t abide by content moderation policies. This often means that consumer auth systems often need to support <a href="https://liveramp.com/blog/what-is-identity-resolution/">identity resolution</a>. They need to link different accounts using incomplete information. If I’ve been banned from Facebook on an account linked to the phone number (800) 867 5309, Facebook should likely extend the ban on my account to any subsequent sign-ups using the same phone number. Even if I change the email address and use a different name, Facebook can still correctly link me to the original banned account.</p>
<p>Now, business software developers share some problems with their peers building consumer software. We still have to be paranoid. Phishing is still a problem. Attackers will still try credential stuffing attacks, and the man in the middle isn’t going anywhere. It’s just that the dynamics are a little different.</p>
<p>One unique dynamic in business software is the focus on insider attacks.</p>
<p>Consider what happens if a company parts ways with an employee on less-than-amicable terms. That employee might surreptitiously hold on to old credentials and <a href="https://apnews.com/general-news-national-national-463e41083b75b83c44fc6a9d00dc952c">commit sabotage</a>. Or we might see a repeat of the 2008 <a href="https://abcnews.go.com/Technology/story?id=5432751&amp;page=1">Terry Childs</a> incident: a man locked out all other San Francisco municipal employees from accessing parts of their internal network.</p>
<p>We need to build resilience from insider attacks into business software. That generally means we need to build different features into our auth systems (more on this later).</p>
<h2>Features and protocols</h2>
<p>In general, business software requires auth features that aren’t relevant in consumer software. Previously, I mentioned <em>user impersonation</em> as an example. That certainly counts, but it’s honestly a small detail. It’s kind of a nice-to-have. There are other features that just aren’t especially negotiable.</p>
<h3>Support for enterprise identity providers</h3>
<p>Businesses of scale have thousands of employees, and each employee needs some relatively unique subset of enterprise software. These large companies can’t handle access management by hand. Instead, they use centralized IT software applications called identity providers (IDPs) to manage employees&#39; access to software.</p>
<p>To a first approximation, businesses use IDPs as if they were databases. IDPs maintain lists of employees and lists of software applications that a company pays for. They maintain associations between employees and software, e.g. <em>Jerry in the Omaha office gets to use Netsuite.</em></p>
<p>On top of that database-esque functionality, IDPs centralize the company’s control over software applications. If a company revokes an employee’s access to software, the IDP enforces that revocation. If a company promotes an employee, the IDP propagates the employee’s updated job title and any relevant permissions (e.g. becoming an <em>admin</em>) to all of the relevant software applications.</p>
<p>If you sell business software, you will eventually need to support a broad range of different identity providers. Sure, support for Okta and Entra gets you pretty far, but people use <em>all kinds</em> of IDPs in the real world, from reasonable options like old-school ADFS or Sailpoint to chaotic custom builds that no one’s touched since 2005.</p>
<h3>Enterprise single sign-on (SSO)</h3>
<p>Enterprise customers will almost universally want their vendors to offer enterprise single sign-on.</p>
<p>They want their employees to authenticate once in an identity provider (e.g., Okta, Entra) and extend that authentication context into third party software (e.g., Slack, Zoom). If you’ve worked at a big company, you’ve probably accessed software using enterprise single sign-on.</p>
<p>Enterprise single sign-on nearly always relies on a strange, archaic protocol called SAML. That’s not because SAML is a uniquely great standard. It’s more like an accident of history. SAML’s been around a really long time, and people are just accustomed to it. That’s especially true in industries like healthcare that tend to be a bit risk-averse and slow to adopt new technologies.</p>
<p>A detailed treatment of SAML isn’t really in-scope here. I’d just highlight the following:</p>
<ol>
<li>SAML is <a href="https://tesseral.com/blog/gentle-intro-to-saml">weird</a>. Just brace yourself for the first customer that asks for SAML. You’ll figure out how it works eventually, but know that it takes some time to really understand.</li>
<li>You have to be <strong>really</strong> careful with a SAML implementation. It’s very easy to introduce major security problems. We’ve written a bit about this <a href="https://tesseral.com/blog/ruby-saml-pwned-by-xml-signature-wrapping-attacks">here</a>.</li>
<li>SAML isn’t like <em>Login with Google</em>. Every one of your business customers that uses SAML will need its own manual configuration – and therefore time from your engineering team.</li>
</ol>
<p>Whether you like it or not (you probably don’t), business software usually needs to support SAML SSO.</p>
<h3>Provisioning (SCIM)</h3>
<p>Enterprise customers often want to control their user data in your software. They’ll want to set up an integration between your software and their identity provider (again, e.g., Okta, Entra). In particular, they’ll want to (a) provision new users and (b) deprovision existing users. They’ll also want to update certain users’ attributes (e.g., if someone gets promoted), but that’s not generally critical.</p>
<p>Companies care about automating new employees’ access to systems. It’s just really inconvenient for an IT admin to manually click around adding people one-by-one to every different software application.</p>
<p>Companies care even more about making sure they can deprovision users. If someone parts ways with the company, it’s both practical and important for security to turn off his account. It seems silly, but recently departed employees retaining valid credentials remains a huge security problem for big companies. To use one example that recently made news, Disney let an employee go but neglected to revoke his access to their parks’ menu design system – he made a number of malicious edits that resulted in <a href="https://www.nbcnews.com/news/us-news/former-disney-worker-sentenced-3-years-hacking-park-menus-changing-all-rcna202975">a prison sentence</a>.</p>
<p>SCIM is a standardized protocol for these provisioning integrations between identity providers and service providers. If you want to learn more about SCIM, you can check out my explainer <a href="https://tesseral.com/blog/what-a-developer-needs-to-know-about-scim">here</a>.</p>
<h3>Role-based access control</h3>
<p>Not every user within a given organization should be able to do the same things. Different people have different jobs – and different responsibilities.</p>
<p>I like to use expense management apps as an example for this.</p>
<p>Everyone in a company should probably have the ability to request reimbursement for a business expense. Someone in sales might take a client out to lunch. Someone in engineering might buy a new mechanical keyboard with cool LEDs.</p>
<p>But not everyone in a company should have the ability to approve or pay out an expense – especially large expenses. Intuitively, we should recognize that an intern shouldn’t be approving $100,000 invoices. That should probably be an executive’s responsibility.</p>
<p>In business software, we most commonly rely on an authorization pattern called role-based access control (RBAC). We define some list of actions (e.g., <code>expense.submit</code>, <code>expense.approve</code>, <code>expense.pay_out</code>). We map those actions to some number of roles (e.g., <code>superadmin</code>). Then, we assign roles to users. A given user’s authorization largely extends from his assigned roles.</p>
<p>RBAC is usually pretty simple, but it can get complicated. My favorite example of this is Salesforce. For those who aren’t acquainted, Salesforce is a pretty generic piece of software – you can make it do all kinds of crazy stuff. Consequently, it has a very complex permissions system that it exposes to its customers. A Salesforce admin can create arbitrarily complex <em>custom roles</em>.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/2yLbUZpBx5NqucSaGIBWQb/1c93791321db682f8cb3fbedbbb1751e/sfdc-custom-roles.png" alt="sfdc-custom-roles"/></p>
<p>At a certain level of maturity, it often becomes essential for business software to look like this. It’s a lot of work to get RBAC exactly right.</p>
<h3>Organization-level control</h3>
<p>Some customers are pickier than others. They might have different compliance regimes to navigate. They might just be picky.</p>
<p>But you’ll eventually encounter support tickets that look like this:</p>
<ul>
<li><em>Can you make sure users can’t log in with their email?</em></li>
<li><em>Can you make sure our users can’t invite people to our organization?</em></li>
<li><em>Can you require all of our users to use Yubikeys for MFA?</em></li>
<li><em>Can you make sure users never log in from [list of high-risk countries]?</em></li>
</ul>
<p>Customers of a certain scale expect the answer to be <em>yes</em>.</p>
<p>If you’ve built your auth system to be the same for all users – irrespective of their organization – you’ll have a hard time accommodating those requests. You might end up writing some weird custom code. We’ve seen this before. It usually looks something like this.</p>
<pre tabindex="0"><code><span><span>if</span><span> (customer_id </span><span>==</span><span> “X”):</span></span>
<span><span>	# do stuff</span></span>
<span><span>else</span><span>:</span></span>
<span><span>	# do something else</span></span></code></pre>
<h3>API keys</h3>
<p>Consumer software doesn’t often expose public APIs. After all, consumers don’t normally write code. A consumer app that exposes a public API has probably approached substantial scale.</p>
<p>By contrast, business software frequently needs to offer API keys even at a pretty small scale. And managing API keys is a bit of a pain, especially if you need them to be performant. It’s just another thing to worry about if you’re building business software.</p>
<h3>Audit logs</h3>
<p>Enterprise customers often expect comprehensive logs of everything that happens in their organization. That means they need a record of their employees’ actions in your software. There are a few major reasons.</p>
<p>Sometimes, the motivation is legal. Companies need a long-lived archive of employees’ actions in case they wind up in litigation, a criminal enquiry, or some other unpleasant matter. I’m reminded of the Rippling-Deel <a href="https://x.com/parkerconrad/status/1901615179718406276">espionage issues</a>, in which Rippling’s logs of employees’ actions in Slack served as pretty convincing evidence. <em>How does this relate to auth</em>, you might wonder. Well, you really need to know <em>who a user is</em> for the logs to be very useful.</p>
<p><img src="https://images.ctfassets.net/336y06gasq8n/1hF6I2RJft1olcXE8ITZvg/e7e925fe79e7f283455f87a1734785c5/rippling-deel-logs.png" alt="rippling-deel-logs"/></p>
<p>Audit logging is probably more relevant – and more closely tied to auth – for its security applications. Security teams often want to know what’s going on. For example, an attacker might try an incorrect username/password pair for <code>john.doe@parnellaerospace.com,</code> then try <code>bob.jones@parnellaerospace.com</code> and so on. In this case, Parnell Aerospace probably wants a heads-up that this is going on. For this reason, security-conscious organizations often request that vendors can pass audit logging events into <a href="https://en.wikipedia.org/wiki/Security_information_and_event_management">SIEM systems</a>.</p>
<h3>Wrapping up</h3>
<p>B2B software and B2C software need different things from their auth systems. If you’re building your own auth system for B2B, you should be aware of the long list of annoying enterprise requirements you’ll run into. If you’re shopping for an auth vendor, try to make sure that your vendor focuses on business software – it’s rare for a vendor to do both B2B and B2C well.</p>
<p>Tesseral is an open source auth service designed uniquely for business software. You can learn more at <a href="https://tesseral.com/docs">https://tesseral.com/docs</a> or visit us <a href="https://github.com/tesseral-labs/tesseral">on GitHub</a>.</p></div></div>
  </body>
</html>
