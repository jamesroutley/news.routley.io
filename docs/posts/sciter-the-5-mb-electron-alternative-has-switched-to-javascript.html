<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://terrainformatica.com/2021/04/25/sciter-uses-javascript-from-now-and-on/">Original</a>
    <h1>Sciter, the 5 MB Electron alternative, has switched to JavaScript</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<p>Without too much fanfares Sciter has officially transitioned from TIScript to JavaScript this week.</p>



<p>To be precise, there are two Sciter’s at the moment: Sciter.TIS and Sciter.JS. It is just from now and on <em>Sciter</em> is a synonym of <em>Sciter.JS</em>. And so Sciter.JS is the official, mainstream version. </p>



<p>But Sciter.TIS is still supported and maintained until I have customers that use it.</p>



<p><a rel="noreferrer noopener" href="https://www.codeproject.com/Articles/33662/TIScript-Language-A-Gentle-Extension-of-JavaScript" target="_blank">TIScript</a> was serving Sciter exceptionally well all these 10 years, however 6 months ago I decided to switch to JavaScript. Reasons of why:</p>



<ul><li>In ES2020 specification JavaScript finally has reached feature set of TIScript.</li><li><a rel="noreferrer noopener" href="https://bellard.org/quickjs/" target="_blank">Fabrice Bellard have created his QuickJS</a> embeddable JS engine, pretty compact and fast and Sciter uses slightly <a rel="noreferrer noopener" href="https://github.com/c-smile/quickjspp/" target="_blank">modified QuickJS</a> version.</li><li>We’ve got tons of JavaScript libraries that can be used as they are in Sciter context.</li><li>Sciter can be used by any creative Web Front End developer without the need to learn new language.</li></ul>



<h2>Paying tributes to TIScript</h2>



<p><a rel="noreferrer noopener" href="https://www.codeproject.com/Articles/33662/TIScript-Language-A-Gentle-Extension-of-JavaScript" target="_blank">TIScript</a> is rooted at <a rel="noreferrer noopener" href="https://terrainformatica.com/org/bob_article.htm" target="_blank">David Betz’ Bob Language that was published in DDJ in 2002</a>.  While I’ve made TIScript syntax explicitly close to JavaScript, its architecture and implementation inherits original structure and features of Bob:</p>



<ul><li>Single pass compiler that produces bytecodes;</li><li>Stack based VM executing those bytecodes;</li><li>Compacting (copying) GC;</li></ul>



<p>Such foundation worked very well and allowed to evolve original Bob to TIScript with a lot of features of modern PL: real classes, iterators and generators, await/async, built-in persistability, symbols, etc. </p>



<p>TIScript is good and is close to JavaScript but it is not JavaScript though. You cannot take existing JS library and use it in Sciter as it is. So, not without regret, I have decided to switch to JavaScript. QuickJS in particular.</p>



<h2>QuickJS, new kid in the block</h2>



<p>QuickJS is relatively recent addition to the list of <a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/List_of_ECMAScript_engines" target="_blank">JS implementations</a> . And here are key reasons why I decided to use it:</p>



<ul><li>API and integration principles are close to what TIScript uses – it took me just 1 month to add QuickJS to Sciter core. And 4 months more to expose HTML/CSS runtime to JS.</li><li>Relatively compact implementation – QuickJS is slightly more fatty (by 100 kb) but still in acceptable range. For the note: full version of V8 is about 40 mb – 5 times larger than Sciter itself;</li><li>Liberal MIT license. Sciter cannot use GPL/LGPL code – many customers expressed this requirement;</li><li>Readable source code. Well… almost readable.</li></ul>



<h2>Architecture of QuickJS:</h2>



<ul><li>Almost single pass bytecode compiler with additional bytecode passes;</li><li>Stack based VM;</li><li>Reference counting GC with loops detection;</li></ul>



<p>If to compare with TIScript the only major difference is reference counting GC and I have mixed feeling about it. <a rel="noreferrer noopener" href="https://rebelsky.cs.grinnell.edu/Courses/CS302/99S/Presentations/GC/" target="_blank">RC memory management has as pros as cons</a> , in context of HTML/CSS/UI in particular. Anyway Python uses it all these years in similar circumstances so it definitely will work.</p>



<p>Major benefit of RC GC is that memory management is more deterministic. For example: an object created inside a function can be freed at its exit (if it is not stored anywhere). This may lead to better memory consumption. </p>



<p>On other hand there is a possibility of memory fragmentation on long runs. But we can use other than default memory allocator in QuickJS if this will be a problem. We will see.</p>



<h2>TIScript features that are not in JavaScript. Yet?</h2>



<p>JavaScript in general is quite foreign to HTML and CSS. While I’ve added better HTML support to QuickJS by adding <a rel="noreferrer noopener" href="https://sciter.com/tutorials/reactor-jsx/" target="_blank">JSX</a> and reactivity (VNode literals), at the same time CSS constructs are still can be expressed only by their string representations. This involves parsing at runtime when you need to set CSS properties from script – not that good. </p>



<p>TIScript syntax and runtime has the following CSS helper features in this regard:</p>



<ul><li><strong>Length, Duration, Angle units.</strong> </li><li><strong>Tuples.</strong></li><li><strong>CSS name tokens.</strong></li></ul>



<p>We can live without all these of course, sky will not fall on us, but aesthetics of our sources is what makes us, developers, at least a bit more happier  among boring pages full of JSON and the like constructs. </p>



<p>So welcome to new Sciter!</p>
	</div></div>
  </body>
</html>
