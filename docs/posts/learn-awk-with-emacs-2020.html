<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jherrlin.github.io/posts/learn-awk/">Original</a>
    <h1>Learn Awk with Emacs (2020)</h1>
    
    <div id="readability-page-1" class="page"><div id="outline-text-headline-2">
<p>
  I just read a few chapters in the &#34;The AWK programming language&#34; book and found AWK to be
  awesome and I want to learn more of the language. I begin to think about my approach for
  learning AWK. My goal is to be efficient with AWK in smaller scripts and one liners. AWK
  is Turing complete and can be used for larger applications. But if I write larger
  applications my weapon of choice is a functional lisp with immutable data structures. I
  see AWK as a natural tool in my tool box and the perfect language to filtering logs,
  search for patterns in files, reduce a couple of files, transform my accounting data or
  other things related to text with some kind of structure. And in combination with programs
  like <code>find</code>, <code>sed</code>, <code>grep</code> and <code>sort</code> AWK can be super powerful and efficient. This is
  where AWK shines for me.</p>
<p>
  One reason why I started to think about my learning process is that I feel that I don&#39;t
  have the time to learn a new language in one go and keep the knowledge fresh. I wanna
  progress slowly and over time. If I forget something or is kept away from AWK for a while
  I quickly wanna get back on track fast without needing to read a book again or consult to
  much documentation. This is of course not completely possible, but if I can keep the most
  essential parts of AWK in my second brain I am more than happy.</p>
<p>
  What I came up with is a workflow combined of <a href="https://orgmode.org/worg/org-contrib/org-drill.html">Org-drill</a> and <a href="https://orgmode.org/">Org mode</a> source blocks
  together with provided text files. Org-drill is an Emacs mode that uses a spaced
  repetition algorithm together with flash cards to provide you with questions and then the
  answer. The questions and answers are written by me and most often based around &#34;famous&#34;
  text files like Nginx access log, /etc/passwd or .ledger files.</p>
<p>
  A typical workflow to fill my source with questions and answers is to read a chapter in a
  book or a documentation page. If I find something that I think is useful I write one or
  more flash cards. This way I can increase my knowledge source and when I feel I have some
  time over I can run the learning workflow.</p>
<p>
  The learning workflow looks like this:</p>
<ol>
<li>
<p>Open 2 Emacs sessions</p>
</li>
<li>
<p>Open the file containing the flash cards in one session</p>
</li>
<li>
<p>Open a note book file in the other</p>
</li>
<li>
<p>Start org-drill in the flash cards session</p>
</li>
<li>
<p>Write your answers in the note book session</p>
</li>
</ol>
<p>Together with the note book file and the flash cards are a couple of text files. The text
  files are examples of the &#34;famous&#34; files. The note book file contains Org mode source
  blocks for each of the files. And the questions states what source block to use for that
  particular question.</p>
<p>
  A source block inside the note book file looks like this.</p>
<div>
<div><pre><code data-lang="org"><span>#+BEGIN_SRC </span><span>awk</span><span> :results output code :in-file ./text-files/access.log
</span><span></span>  <span>{</span> <span>print</span> <span>}</span>
<span>#+END_SRC</span></code></pre></div>
</div>
<p>
  It tells that the language to evaluated is AWK. Results should be inserted in the note
  book document just beneath the source block. The file that your AWK program have as input
  is in the <code>:in-file</code> argument. If <code>C-c C-c</code> is executed on this source block it will
  insert all of the content of <code>./text-files/access.log</code> file in the note book document. If
  an error occurs, the error message is inserted into the document.</p>
<p>
  Below is an example on how it can look like when you develop your answer. You write your
  AWK answer and use <code>C-c C-c</code> to see the result. If you are satisfied and think you have
  the correct answer, tell that to the org-drill session and it will then provide you with
  the correct answer. You correct yourself by telling org-drill how good you did on a scale
  from 1-5. Depending how you rate your answer, org-drill will set a date for the next time
  the question should appear.</p>
<div>
<div><pre><code data-lang="org"><span>#+BEGIN_SRC </span><span>awk</span><span> :results output code :in-file ./text-files/access.log
</span><span></span>  <span>{</span> <span>ips</span><span>[</span><span>$</span><span>1</span><span>]</span><span>+=</span><span>1</span> <span>}</span>
  <span>END</span> <span>{</span> <span>for</span> <span>(</span><span>i</span> <span>in</span> <span>ips</span><span>)</span> <span>{</span> <span>print</span> <span>i</span><span>,</span> <span>ips</span><span>[</span><span>i</span><span>]</span> <span>|</span> <span>&#34;sort -rk 2,2&#34;</span><span>}}</span>
<span>#+END_SRC</span>

<span>#+RESULTS</span><span>:</span>
<span>#+begin_src </span><span>awk</span><span>
</span><span></span><span>121.204</span><span>.</span><span>106.181</span> <span>8</span>
<span>191.54</span><span>.</span><span>160.135</span> <span>7</span>
<span>111.185</span><span>.</span><span>35.101</span> <span>1</span>
<span>111.85</span><span>.</span><span>5.44</span> <span>1</span>
<span>101.11</span><span>.</span><span>117.117</span> <span>1</span>
<span>#+end_src</span></code></pre></div>
</div>
<p>
  Below is an example on how the flash card looks. If you know basic with Org mode this
  structure will feel very familiar. One great benefit of this is that it&#39;s just text. No
  database or weird stuff. Just plain text that is easy to search in and easy to version
  control.</p>
<div>
<div><pre><code data-lang="org"><span>**</span> Print line 7 to 10 of file                                    <span> :awk:drill:</span>

   How do you print line 7 to 10 with a range pattern?

   :in-file ./text-files/ledger.ledger

<span>***</span> Answer

<span>    #+BEGIN_SRC </span><span>awk</span><span> :results output code :in-file ./text-files/ledger.ledger
</span><span></span>      <span>FNR</span><span>==</span><span>7</span><span>,</span><span>FNR</span><span>==</span><span>10</span>
<span>    #+END_SRC</span>

    #+RESULTS:
<span>    #+begin_src </span><span>awk</span><span>
</span><span></span>    <span>2020</span><span>-</span><span>04</span><span>-</span><span>17</span> <span>*</span> <span>Dustin</span><span>.</span> <span>KÃ¶p</span> <span>av</span> <span>tangentbord</span><span>.</span>
       <span>;;</span> <span>~</span><span>/company/incomming-invoices/2020/2020-04-17-lenovo-keyboard-swedbank-transaction.pdf</span>
       <span>2</span><span>:</span><span>4</span><span>:</span><span>4</span><span>:</span><span>0</span>                                   <span>667.00</span> <span>SEK</span>
       <span>2</span><span>:</span><span>0</span><span>:</span><span>1</span><span>:</span><span>8</span>                                  <span>-</span><span>667.00</span> <span>SEK</span>
<span>    #+end_src</span></code></pre></div>
</div>
<p>
  This kind of setup for learning languages feels very appealing to me. I think that AWK
  fits extra good as it&#39;s possible to have predefined text files as input and AWK programs
  can be short and efficient. When writing this post I have just finished the workflow and
  got all of the pieces together. Now it&#39;s time to fill my second brain with good
  questions and answers and continue my path to be a happy AWK user. If you wanna help me
  optimize any of the workflows or contribute with good flash cards, I am more than happy
  to receive pull requests via GitHub or feedback via Twitter.</p>
<p>
  Here are a couple of resources related to the post:</p>
<ul>
<li>
<p><a href="https://ia802309.us.archive.org/25/items/pdfy-MgN0H1joIoDVoIC7/The_AWK_Programming_Language.pdf">The AWK programming language book</a></p>
</li>
<li>
<p><a href="https://www.gnu.org/software/gawk/">Gnus AWK implementation called GAWK</a></p>
</li>
<li>
<p><a href="https://github.com/jherrlin/learn-awk">GitHub project that implements the ideas</a></p>
</li>
<li>
<p><a href="https://www.gnu.org/software/emacs/">Emacs</a></p>
</li>
<li>
<p><a href="https://orgmode.org/">Org mode</a></p>
</li>
<li>
<p><a href="https://orgmode.org/worg/org-contrib/org-drill.html">Org-drill</a></p>
</li>
</ul>
<p>
  Here is a gif showing the learning workflow.</p>
<p>
  <img src="https://jherrlin.github.io/learn-awk.gif" alt="/learn-awk.gif" title="/learn-awk.gif"/></p>
<p>
  A mp4 video with better quality can be found here <code>http://jherrlin.github.io/learn-awk.mp4</code> (11M).</p>
</div></div>
  </body>
</html>
