<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.coryzue.com/writing/make-ai-pictures-of-yourself/">Original</a>
    <h1>How to Train an AI Image Model on Yourself</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
                <p>Yesterday I had a couple hours to kill and decided to try out a project I’ve been meaning to explore for a long time:
training my own AI image model so I can generate pictures of myself that look like this:</p>

<p><img src="https://www.coryzue.com/images/ai-images/superme.webp" alt="Me as Superman"/></p>

<p>Me as Superman</p>

<p>I had a few reasons for wanting to do this:</p>

<ol>
  <li>It sounded fun.</li>
  <li>I thought my kids would like playing with it.</li>
  <li>I’d learn more about the innards of custom models / deeper AI stuff that I’ve only ever scratched the surface of.</li>
  <li>It might be an interesting future add-on to my <a href="https://www.saaspegasus.com/">SaaS / AI starter project</a>, SaaS Pegasus.</li>
</ol>

<p>What surprised me was just how easy it is to do something like this now.
I halfheartedly tried to do this 12 or 18 months ago and quickly gave up in frustration.
This time, I built my model and was making pictures like the above in under 2 hours, coming in with basically zero knowledge.
Most of that time was just wrapping my head around the right tools to use.</p>

<p>In this post I’ll quickly summarize what I did and how you can do it yourself.</p>

<h2 id="choosing-a-model--training-pattern">Choosing a model / training pattern</h2>

<p>The main things you need to make these models are:</p>

<ol>
  <li>A base model.</li>
  <li>A training/fine-tuning technique.</li>
  <li>A training dataset—basically some pictures of yourself or your subject.</li>
</ol>

<p>If you ask ChatGPT, Claude or even DeepSeek about how to do this they will probably recommend
using Stable Diffusion for this, but I remembered <a href="https://x.com/levelsio/">Pieter Levels</a>,
who makes <a href="https://photoai.com/">PhotoAI</a>, talking about a model called <a href="https://blackforestlabs.ai/">Flux</a>
that performs much better, so I decided to use that as my base model.
Flux has an open-source/open-weight model that is not state of the art, but definitely good enough for my purposes.</p>

<p>For a training technique, there are a bunch, but the one that seems to be recommended today is <a href="https://en.wikipedia.org/wiki/Fine-tuning_(deep_learning)#Low-rank_adaptation"><em>LoRA</em> (Low-Rank Adaptation)</a>.
I learned exactly as much about LoRA as I needed to, but conceptually you basically train a tiny part of the model
and associate it with a magic, uncommon word that you invent (e.g. “czue”).
Then when you prompt the model to create the invented word it is heavily influenced by that training data.
This ends up being much faster and more efficient than fine-tuning the whole model, and works well!
Don’t ask me any follow-up questions about this, because that is the extent of what I learned.</p>

<h2 id="create-a-training-set">Create a training set</h2>

<p>Once you have your model you need a training set, which is basically a bunch of pictures of the thing you want the model to learn.
For this part I just grabbed 10-15 random photos of myself with different expressions / scenes / lighting / angles.
The more diverse the dataset the better. Also I think it’s important that you’re the only person in the photos
(I didn’t try any with more than one person).</p>

<p><img src="https://www.coryzue.com/images/ai-images/training-set.png" alt="Training Set"/></p>

<p>Some of the photos I used for my training set. I tried to capture different angles, lighting, hairstyles, and so
on, though sadly most of the photos I have are selfies.</p>

<p>As part of the training, the model needs text descriptions for the model to learn from, and these should,
I think, include your magic word.
So, for example, you’d upload a picture of yourself on the beach and—if your magic word was czue—you’d then add
a text description that said “a photo of czue on the beach, wearing a blue shirt.”</p>

<p>That said—you don’t actually have to label your images yourself, because the tools today will auto-generate these captions
for you with LLMs. So you might read somewhere this is necessary, but you can skip it, since it gets handled for you.</p>

<h2 id="training-your-model">Training your model</h2>

<p>At first I thought it’d be fun to train the model on my laptop. But I quickly ruled that out because I don’t have anything close
to the hardware necessary (GPUs and lots of RAM).
Then I thought it might be fun to figure out how to run the code on some beefy GPU cloud server,
but I quickly bailed on that idea too, and landed on <a href="https://replicate.com/">Replicate</a>.</p>

<p>Replicate is basically GPU-rentals-as-a-service.
But they also have a rich ecosystem of pre-built stuff that you can spin up and run instantly.
So rather than write your own training code and install all the dependencies and such, you grab someone else’s “recipe”
and just plug in the parameters you need.</p>

<p>For this use case, I learned that the easiest way to train the flux model with LoRA is with the
<a href="https://replicate.com/ostris/flux-dev-lora-trainer/">ostris/flux-dev-lora-trainer</a> recipe.
You need to create a Replicate account and set up billing, and then you can enter the parameters you need on that page
which correspond to how you’re going to train the model.</p>

<p>The most important settings:</p>

<ul>
  <li><strong>input_images</strong>: The zip file of your training photos.</li>
  <li><strong>trigger_word</strong>: The magic word you’ll use for your LoRA trigger. This should be something unusual. I chose “czue”.</li>
  <li><strong>hf_repo_id</strong> and <strong>hf_token</strong>: Hugging face repository and API key (see below).</li>
  <li><strong>autocaption_prefix</strong>: I’m not sure if this is necessary, but I made this “A photo of czue,” matching my trigger word.
This will get prepended to all the image captions generated by the LLM that I mentioned above.</li>
</ul>

<p>Now would probably be a good time to mention that there are a bunch of YouTube videos that walk through this process
in detail. <a href="https://www.youtube.com/watch?v=sNpQ9ULDMoo">This is the one</a> I mostly followed.
If you want to know more about how to fill in the training parameters you can watch that, though the above covers the essentials.</p>

<p>After filling in everything you click “Create Training” and you’re off!
Replicate shows you progress as it trains your model and will finish in about 20 minutes.
You’re done training!</p>

<h3 id="saving-your-model-to-hugging-face">Saving your model to Hugging Face</h3>

<p><a href="https://huggingface.co/">Hugging Face</a> is basically just a place to store and share models—kind of like Github, but for AI.
Using it is optional, because Replicate also saves your model somewhere after training it,
but Hugging Face makes it easier to access and integrate your model with other tools later.
Plus it’s free and easy to set up, so I used it.</p>

<p>I created an account and empty model on hugging face, and then plugged it in under <code>hf_repo_id</code> in the training form above.
You also need an access token, which you can get <a href="https://huggingface.co/settings/tokens">from your hugging face settings page</a>,
and then put under <code>hf_token</code>.</p>

<p>If you do this step, then when your model is done training, your hugging face repo will be populated with your trained model.
This is basically a giant (180Mb) file called “lora.safetensors”.
In all worlds, the model will also be available under the “trainings” tab in Replicate.</p>

<h3 id="using-your-model-to-make-pictures">Using your model to make pictures</h3>

<p>Ok, payoff time! The last step is to do some <em>inference</em>.
In other words, give our model some captions and have it make pictures for us.</p>

<p>Again, I briefly explored running this myself and again I quickly bailed and used Replicate.
In this case you can use the <a href="https://replicate.com/lucataco/flux-dev-lora">lucataco/flux-dev-lora</a> recipe for it.
The key modification you need to make is the <strong>hf_lora</strong> field, which should either be your hugging face repo ID
(<em>it must be public for this to work</em>) or a link to your trained model on Replicate
(a “trained_model.tar” file from “Trainings” –&gt; “[your training]” –&gt; “Download Weights”).</p>

<p>Then put in a prompt, being sure to include your secret word for the person you trained on:</p>



<p>Press “Run”, and you should get a picture of yourself (or someone who looks at least plausibly like you) surfing:</p>

<p><img src="https://www.coryzue.com/images/ai-images/surferme.webp" alt="Me Surfing"/></p>

<p>Lekker!</p>

<h3 id="running-the-model-programmatically">Running the model programmatically</h3>

<p>You can also run your model programmatically via the API.
This is much faster for experimenting with different prompts, saving images to your computer and so on.</p>

<p>Here’s a simple Python script that demonstrates the process.
I’ve also <a href="https://github.com/czue/flux-dev-lora-runner">published it to Github</a>, and may make future updates there.
Most of the code is just plumbing around arguments and filenames, and the acutal API call is a single line (<code>replicate.run(...)</code>).</p>

<div><div><pre><code><span># /// script
# requires-python = &#34;&gt;=3.12&#34;
# dependencies = [
#     &#34;replicate&#34;,
# ]
# ///
</span><span>import</span> <span>argparse</span>
<span>import</span> <span>os</span>
<span>import</span> <span>re</span>
<span>import</span> <span>replicate</span>
<span>import</span> <span>uuid</span>

<span>DEFAULT_MODEL</span> <span>=</span> <span>&#34;czue/me-v1&#34;</span>
<span>DEFAULT_COUNT</span> <span>=</span> <span>1</span>


<span>def</span> <span>get_input</span><span>(</span><span>prompt</span><span>,</span> <span>model</span><span>=</span><span>DEFAULT_MODEL</span><span>,</span> <span>count</span><span>=</span><span>DEFAULT_COUNT</span><span>):</span>
    <span>return</span> <span>{</span>
        <span>&#34;prompt&#34;</span><span>:</span> <span>prompt</span><span>,</span>
        <span>&#34;hf_lora&#34;</span><span>:</span> <span>model</span><span>,</span>
        <span>&#34;num_outputs&#34;</span><span>:</span> <span>count</span>
    <span>}</span>


<span>def</span> <span>main</span><span>():</span>
    <span>parser</span> <span>=</span> <span>argparse</span><span>.</span><span>ArgumentParser</span><span>()</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;prompt&#34;</span><span>,</span> <span>help</span><span>=</span><span>&#34;Prompt for the photo&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--model&#34;</span><span>,</span> <span>default</span><span>=</span><span>DEFAULT_MODEL</span><span>,</span>
                      <span>help</span><span>=</span><span>&#34;Model to use (default: %(default)s)&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--count&#34;</span><span>,</span> <span>default</span><span>=</span><span>DEFAULT_COUNT</span><span>,</span>
                      <span>help</span><span>=</span><span>&#34;Number of photos to generate (default: %(default)s)&#34;</span><span>,</span> <span>type</span><span>=</span><span>int</span><span>)</span>
    <span>args</span> <span>=</span> <span>parser</span><span>.</span><span>parse_args</span><span>()</span>

    <span>input</span> <span>=</span> <span>get_input</span><span>(</span><span>args</span><span>.</span><span>prompt</span><span>,</span> <span>args</span><span>.</span><span>model</span><span>,</span> <span>args</span><span>.</span><span>count</span><span>)</span>
    <span>output</span> <span>=</span> <span>replicate</span><span>.</span><span>run</span><span>(</span>
        <span>&#34;lucataco/flux-dev-lora:091495765fa5ef2725a175a57b276ec30dc9d39c22d30410f2ede68a3eab66b3&#34;</span><span>,</span>
        <span>input</span><span>=</span><span>input</span>
    <span>)</span>

    <span>output_dir</span> <span>=</span> <span>&#34;output&#34;</span>
    <span>os</span><span>.</span><span>makedirs</span><span>(</span><span>output_dir</span><span>,</span> <span>exist_ok</span><span>=</span><span>True</span><span>)</span>

    <span># Use the last few words of the prompt, remove special characters and convert to lowercase for the filename
</span>    <span>prompt_slug</span> <span>=</span> <span>&#34;-&#34;</span><span>.</span><span>join</span><span>(</span><span>args</span><span>.</span><span>prompt</span><span>.</span><span>split</span><span>(</span><span>&#34; &#34;</span><span>)[</span><span>-</span><span>3</span><span>:])</span>
    <span>prompt_slug</span> <span>=</span> <span>re</span><span>.</span><span>sub</span><span>(</span><span>r</span><span>&#39;[^a-zA-Z0-9\-]&#39;</span><span>,</span> <span>&#39;&#39;</span><span>,</span> <span>prompt_slug</span><span>).</span><span>lower</span><span>()</span>

    <span>for</span> <span>index</span><span>,</span> <span>item</span> <span>in</span> <span>enumerate</span><span>(</span><span>output</span><span>):</span>
        <span>file_id</span> <span>=</span> <span>uuid</span><span>.</span><span>uuid4</span><span>().</span><span>hex</span><span>[:</span><span>5</span><span>]</span>  <span># append a random hash to avoid conflicts
</span>        <span>output_path</span> <span>=</span> <span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span>(</span><span>output_dir</span><span>,</span> <span>f</span><span>&#34;</span><span>{</span><span>prompt_slug</span><span>}</span><span>-</span><span>{</span><span>file_id</span><span>}</span><span>.webp&#34;</span><span>)</span>
        <span>with</span> <span>open</span><span>(</span><span>output_path</span><span>,</span> <span>&#34;wb&#34;</span><span>)</span> <span>as</span> <span>file</span><span>:</span>
            <span>file</span><span>.</span><span>write</span><span>(</span><span>item</span><span>.</span><span>read</span><span>())</span>
            <span>print</span><span>(</span><span>f</span><span>&#34;Saved photo </span><span>{</span><span>output_path</span><span>}</span><span>&#34;</span><span>)</span>


<span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span><span>:</span>
    <span>main</span><span>()</span>
</code></pre></div></div>

<p>A Python script to run prompts against your model. Also available <a href="https://github.com/czue/flux-dev-lora-runner">on Github</a>.</p>

<p>You car run this with, e.g.:</p>

<div><div><pre><code>uv run main.py &#34;a photo of czue, a 40 year old man, writing a blog post&#34; \
 --model=&#34;czue/me-v1&#34; \
 --count=4
</code></pre></div></div>

<h3 id="results">Results</h3>

<p>Overall I’ve found results have been…mixed?
Sometimes the model produces something that looks quite similar to the trained person, and sometimes it only has a mild resemblance.</p>

<p>One trick I’ve found is that appending some extra hints about the person seems to help (e.g. “a 40 year old man” for me,
or “a six year old boy” for my son). Without this prompt it was often turning my boys into girls, and making other
amusing mistakes.</p>

<p>Here are some example results for the prompt “a photo of czue, a 40 year old man, writing a blog post”:</p>

<p><img src="https://www.coryzue.com/images/ai-images/blog-post-combined.webp" alt="Me Writing &#34;good&#34;"/></p>

<p>Versus “a photo of czue writing a blog post”:</p>

<p><img src="https://www.coryzue.com/images/ai-images/blog-post-combined-bad.webp" alt="Me Writing &#34;bad&#34;"/></p>

<p>Neither set is <em>great</em> but the first set is much closer to what I actually look like, and more consistent with itself.
The second set is kind of all over the place.</p>

<p>Another thing I noticed is that it seems to break down if you try to include other people.
For example, when I tried to put myself next to Barack Obama it kind of merged some of my features
into his face and vice versa.</p>

<p><img src="https://www.coryzue.com/images/ai-images/with-barack.webp" alt="Me and Barack"/></p>

<p>I’m sure you can get better results by playing around with prompting.
I’ve only really scratched the surface of experimentation.</p>

<p>But, overall, the results have been good enough that both me and my kids have had fun making pictures of ourselves in
different scenarios—which was my primary goal.</p>

<p>Win!</p>

<h2 id="costs">Costs</h2>

<p>This isn’t free, but it’s also not expensive.</p>

<p>I trained three models (one on myself and one on each of my kids).
The training costs were ~$2.50 per model.
Then generating images is about $.03 / image, or 30 for a dollar.</p>

<p>I ended up spending just shy under $10 on the whole little experiment. Not bad!</p>

<p>Overall, this was a fun little exercise and I was happily surprised by how easy and cheap the whole process was.
If you’ve wanted to do this yoursef, but been intimidated by all the options and buzzwords,
hopefully this post is enough to convince you to give it a shot.</p>

            </div></div>
  </body>
</html>
