<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lumalabs.ai/news/inductive-moment-matching">Original</a>
    <h1>Beyond Diffusion: Inductive Moment Matching</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><header><p><span>Authors</span><span>Jiaming Song</span><span>Linqi Zhou</span></p><p>March 11, 2025</p></header><div><p><span>Generated samples on ImageNet-256×256 using 8 steps.</span></p></div></div><div><h3>Fully unlocking the potential of rich multi-modal data</h3><div><p>There is a growing sentiment in the AI community that generative pre-training is reaching a limit. However, we argue that these limits are not due to a lack of data itself, but rather a stagnation in algorithmic innovation. The field remains dominated by just two paradigms since around mid-2020: autoregressive models for discrete signals and diffusion models for continuous signals. This stagnation has created a bottleneck that prevents us from fully unlocking the potential of rich multi-modal data, which in turn limits the progress on multimodal intelligence.</p><p>At Luma, we aim to overcome this algorithmic ceiling through the lens of efficient inference-time compute scaling. Today we are introducing a new method, Inductive Moment Matching (IMM), a pre-training technique that not only delivers superior sample quality compared to diffusion models but also offers over a tenfold increase in sampling efficiency. In contrast to consistency models (CMs), which are unstable as a pre-training technique and require special hyperparameter designs, IMM employs a single objective with enhanced stability across diverse settings.</p></div><div><p><span>Sample quality during training for IMM vs. CM. CM is highly unstable and collapses easily.</span></p></div><div><p>To facilitate future research, we release the code and checkpoints (<a href="https://github.com/lumalabs/imm" target="_blank">https://github.com/lumalabs/imm</a>), a technical paper over the details of the IMM (<a href="https://arxiv.org/abs/2503.07565" target="_blank">https://arxiv.org/abs/2503.07565</a>), and a position paper on how to advance generative pre-training algorithms from an efficient inference-time scaling perspective (<a href="https://arxiv.org/abs/2503.07154" target="_blank">https://arxiv.org/abs/2503.07154</a>).</p></div><h3>How Inductive Moment Matching Works</h3><p>Inference can generally be scaled along two dimensions: extending sequence length (in autoregressive models), and augmenting the number of refinement steps (in diffusion models). While adding more refinement steps significantly boosts diffusion models, simply increasing the model capacity does not yield proportional improvements. This is because diffusion models inherently require more granular steps to converge to an optimal solution, regardless of the networks’ representational power. This shows that, from an inference-time perspective, diffusion models are not optimal in utilizing the networks’ capacity.</p><div><p><span>Diffusion models&#39; performance grows slowly with number of steps, regardless of its model size. In contrast, IMM scales much more efficiently.</span></p></div><p>We illustrate these limitations from an inference perspective by examining the DDIM sampler for diffusion models. In each DDIM iteration, the network first generates a prediction using the current input and timestep, then linearly interpolates this prediction toward that of the next timestep. This constrains the expressive capacity of each iteration as it is linear with respect to the next timestep, ultimately capping performance regardless of the training method employed (see figure below).</p><div><div><div><p><span>The original DDIM sampler using the diffusion model network is not flexible over the target timestep during inference.</span></p></div></div><div><div><p><span>Adding the target timestep allows the sampler to be flexible enough for few step generation.</span></p></div></div></div><p>We design our new pre-training algorithm by first aiming to mitigate this inference limitation. Our new method, Inductive Moment Matching (IMM), introduces a subtle yet powerful modification: alongside the current timestep, the network also processes the target timestep to jump towards. This change enhances the flexibility of each inference iteration, paving the way for state-of-the-art performance and efficiency. We realize this improvement by incorporating maximum mean discrepancy — a robust moment matching technique that was developed more than 15 years ago.</p><h3>Scaling and Stability</h3><p>We test IMM on various hyperparameters and model architectures. On ImageNet 256x256, IMM achieves 1.99 Frechet Inception Distance (FID) and surpasses diffusion models (2.27 FID) and Flow Matching (2.15 FID) with 30x fewer sampling steps. It similarly achieves state-of-the-art 2-step FID of 1.98 on the standard CIFAR-10 dataset for a model trained from scratch.</p><div><p><img alt="Sample quality versus sampling compute. IMM dominates the optimal frontier for methods with inference-time scaling." loading="lazy" width="2070" height="822" decoding="async" data-nimg="1" srcset="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2F176c9baec064e414dbc5000155f53bb9e1977a81-2070x822.png&amp;w=3840&amp;q=75 1x" src="https://lumalabs.ai/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2F176c9baec064e414dbc5000155f53bb9e1977a81-2070x822.png&amp;w=3840&amp;q=75"/></p><p><span>Sample quality versus sampling compute. IMM dominates the optimal frontier for methods with inference-time scaling.</span></p></div><p>IMM scales with training and inference compute as well as model size. We show in the figure below FID vs. training and inference compute, and we find strong correlation between compute used and performance.</p><div dir="ltr" data-orientation="horizontal"><div data-state="active" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-:Rhsvf9uubta:-trigger-c1eeb914a2e8" id="radix-:Rhsvf9uubta:-content-c1eeb914a2e8" tabindex="0"><div><div><p><img alt="Scaling compute improves generative quality." loading="lazy" width="2070" height="822" decoding="async" data-nimg="1" srcset="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Fb56e0474f671e939b0085480d52cb77cb78af8c3-2070x822.png&amp;w=3840&amp;q=75 1x" src="https://lumalabs.ai/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Fb56e0474f671e939b0085480d52cb77cb78af8c3-2070x822.png&amp;w=3840&amp;q=75"/></p><p><span>Scaling compute improves generative quality.</span></p></div></div></div><div data-state="inactive" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-:Rhsvf9uubta:-trigger-26f862a95628" id="radix-:Rhsvf9uubta:-content-26f862a95628" tabindex="0"><div><div><p><img alt="Scaling compute improves generative quality." loading="lazy" width="2070" height="822" decoding="async" data-nimg="1" srcset="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Faa276f26d771fa044bbfc5838ca82807302ab0ba-2070x822.png&amp;w=3840&amp;q=75 1x" src="https://lumalabs.ai/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Faa276f26d771fa044bbfc5838ca82807302ab0ba-2070x822.png&amp;w=3840&amp;q=75"/></p><p><span>Scaling compute improves generative quality.</span></p></div></div></div><div data-state="inactive" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-:Rhsvf9uubta:-trigger-2169346ea705" id="radix-:Rhsvf9uubta:-content-2169346ea705" tabindex="0"><div><div><p><img alt="Scaling compute improves generative quality." loading="lazy" width="2070" height="822" decoding="async" data-nimg="1" srcset="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Fff6227fbb6247800468a216d5fac3086b7261aa3-2070x822.png&amp;w=3840&amp;q=75 1x" src="https://lumalabs.ai/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2Fff6227fbb6247800468a216d5fac3086b7261aa3-2070x822.png&amp;w=3840&amp;q=75"/></p><p><span>Scaling compute improves generative quality.</span></p></div></div></div></div><p>Unlike consistency models, which have been shown to have unstable training dynamics, IMM is stable to train across various hyperparameters and architectures.</p><div><p><img alt="IMM trains more stably than consistency models." loading="lazy" width="2809" height="1118" decoding="async" data-nimg="1" srcset="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2F953c4df410c1e51e9d0fb6249b4458f57c70fbdd-2809x1118.png&amp;w=3840&amp;q=75 1x" src="https://lumalabs.ai/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F2ylxvaa2%2Fproduction%2F953c4df410c1e51e9d0fb6249b4458f57c70fbdd-2809x1118.png&amp;w=3840&amp;q=75"/></p><p><span>IMM trains more stably than consistency models.</span></p></div><h3>What’s next</h3><div><p>Notably, IMM does not rely on denoising score matching or the score-based stochastic differential equations on which the foundations of diffusion models are built. The key driver of our performance gains is not only moment matching itself, but also our shift towards an inference-first perspective. This not only reveals the inherent limitations in current pre-training paradigms but also empowers us to develop innovative algorithms designed to break through the current limits of pre-training.</p><p>We believe that this is just the beginning of a paradigm shift towards multi-modal foundation models that transcends current boundaries and fully unlock creative intelligence.</p><p>If you are interested in the mission, <a href="https://lumalabs.ai/join">join us</a>.</p></div><h3>References</h3><p>Linqi Zhou, Stefano Ermon, Jiaming Song. “Inductive Moment Matching”.</p></div></div></div></div>
  </body>
</html>
