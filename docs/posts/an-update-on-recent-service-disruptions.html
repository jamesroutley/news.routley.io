<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.blog/2022-03-23-an-update-on-recent-service-disruptions/">Original</a>
    <h1>An update on recent service disruptions</h1>
    
    <div id="readability-page-1" class="page"><div><div>


<div id="post-63774">
	<p>Over the past few weeks, we have experienced multiple incidents due to the health of our database, which resulted in degraded service of our platform. We know this impacts many of our customers’ productivity and we take that very seriously. We wanted to share with you what we know about these incidents while our team continues to address these issues.</p>
<p>The underlying theme of our issues over the past few weeks has been due to resource contention in our <code>mysql1</code> cluster, which impacted the performance of a large number of our services and features during periods of peak load. Over the past several years, <a href="https://github.blog/2021-09-27-partitioning-githubs-relational-databases-scale/">we’ve shared</a> how we’ve been partitioning our main database in addition to adding clusters to support our growth, but we are still actively working on this problem today. We will share more in our next <a href="https://github.blog/tag/github-availability-report/">Availability Report</a>, but I’d like to be transparent and share what we know now.</p>
<h3>Timeline</h3>
<h4>March 16 14:09 UTC (lasting 5 hours and 36 minutes)</h4>
<p>At this time, GitHub saw an increased load during peak hours on our <code>mysql1</code> database, causing our database proxying technology to reach its maximum number of connections. This particular database is shared by multiple services and receives heavy read/write traffic. All write operations were unable to function during this outage, including git operations, webhooks, pull requests, API requests, issues, GitHub Packages, GitHub Codespaces, GitHub Actions, and GitHub Pages services.</p>
<p>The incident appeared to be related to peak load combined with poor query performance for specific sets of circumstances. Our MySQL clusters <a href="https://github.blog/2018-06-20-mysql-high-availability-at-github/">use a classic primary-replica set up for high-availability</a> where a single node primary is able to accept writes, while the rest of the cluster consists of replica nodes that serve read traffic. We were able to recover by failing over to a healthy replica and started investigations into traffic patterns at peak load related to query performance during these times.</p>
<h4>March 17 13:46 UTC (lasting 2 hours and 28 minutes)</h4>
<p>The following day, we saw the same peak traffic pattern and load on <code>mysql1</code>. We were not able to pinpoint and address the query performance issues before this peak, and we decided to proactively failover before the issue escalated. Unfortunately, this caused a new load pattern that introduced connectivity issues on the new failed-over primary, and applications were once again unable to connect to <code>mysql1</code> while we worked to reset these connections. We were able to identify the load pattern during this incident and subsequently implemented an index to fix the main performance problem.</p>
<h4>March 22 15:53 UTC (lasting 2 hours and 53 minutes)</h4>
<p>While we had reduced load seen in the previous incidents, we were not fully confident in the mitigations. We wanted to do more to analyze performance on this database to prevent future load patterns or performance issues. In this third incident, we enabled memory profiling on our database proxy in order to look more closely at the performance characteristics during peak load. At the same time, client connections to <code>mysql1</code> started to fail, and we needed to again perform a primary failover in order to recover.</p>
<h4>March 23 14:49 UTC (lasting 2 hours and 51 minutes)</h4>
<p>We again saw a recurrence of load characteristics that caused client connections to fail and again performed a primary failover in order to recover. In order to reduce load, we throttled webhook traffic and will continue to use that as a mitigation to prevent future recurrence during peak load times as we continue to investigate further mitigations.</p>
<h3>Next steps</h3>
<p>In order to prevent these types of incidents from occurring in the future, we have started an audit of load patterns for this particular database during peak hours and a series of performance fixes based on these audits. As part of this, we are moving traffic to other databases in order to reduce load and speed up failover time, as well as reviewing our change management procedures, particularly as it relates to monitoring and changes during high load in production. As the platform continues to grow, we have been working to scale up our infrastructure including sharding our databases and scaling hardware.</p>
<h3>In summary</h3>
<p>We sincerely apologize for the negative impacts these disruptions have caused. We understand the impact these types of outages have on customers who rely on us to get their work done every day and are committed to efforts ensuring we can gracefully handle disruption and minimize downtime. We look forward to sharing additional information as part of our March Availability Report in the next few weeks.</p>

    

</div>


</div></div></div>
  </body>
</html>
