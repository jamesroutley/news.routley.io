<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/microsandbox/microsandbox">Original</a>
    <h1>Microsandbox: Virtual Machines that feel and perform like containers</h1>
    
    <div id="readability-page-1" class="page"><div><div><p><a href="https://queuedle.com">Queuedle</a> is a daily word-sliding puzzle game inspired by Wordle and Scrabble. It combines the positional gameplay of Scrabble with the daily puzzle and discovery elements of Wordle. Everyone plays the same board and it can be played quickly or slowly.</p><p>Players pull from a letter queue and push onto the board, and words are automatically highlighted. Your score is the number of letters used in words. Letters can count twice so <code>MOON</code> is actually two words: <code>MOO</code> and <code>MOON</code>.</p><p>During playtesting, players who were into things like NYT puzzles tended to plan several moves ahead. Because part of the letter queue is hidden, it&#39;s not a game of perfect information, but you can still strategize many moves ahead. A big vocabulary helps, as does knowing the Scrabble dictionary (but two-letter words don’t count).</p><h2 id="daily-puzzles">Daily Puzzles</h2><p>Famously, Wordle had the next day&#39;s puzzle embedded in the source code. You could look it up if you wanted to spoil yourself. However, for Queuedle, there&#39;s a bit more setup required. I need to generate a board and a letter queue.</p><p>I didn&#39;t attempt to do this manually as it&#39;s far too much work. I don&#39;t think there&#39;s much of a payoff for the user if I design interesting starting states because there are too many starting <em>moves</em> – and each move jumbles the board.</p><p>In order to generate a board and a letter queue with the same <em>vibe</em> as Scrabble, I use the Scrabble letter distribution when I randomly pick letters (Qs are rare, Es are everywhere).</p><pre><div><div><p><span>// Scrabble tile frequencies</span><span></span></p><p><span></span><span>const</span><span> </span><span>SCRABBLE_TILES</span><span> </span><span>=</span><span> </span><span>[</span><span></span></p><p><span>  </span><span>{</span><span> letter</span><span>:</span><span> </span><span>&#39;a&#39;</span><span>,</span><span> count</span><span>:</span><span> </span><span>9</span><span> </span><span>}</span><span>,</span><span></span></p><p><span>  </span><span>// ..</span><span></span></p><p><span>  </span><span>{</span><span> letter</span><span>:</span><span> </span><span>&#39;e&#39;</span><span>,</span><span> count</span><span>:</span><span> </span><span>12</span><span> </span><span>}</span><span>,</span><span></span></p><p><span>  </span><span>// ..</span><span></span></p><p><span>  </span><span>{</span><span> letter</span><span>:</span><span> </span><span>&#39;z&#39;</span><span>,</span><span> count</span><span>:</span><span> </span><span>1</span><span> </span><span>}</span><span></span></p><p><span></span><span>]</span><span>;</span></p></div></div></pre><p>To have everyone around the world play the same board at the same time, I use a seeded pseudorandom number generator. Given a starting state, the same endless list of numbers is generated.</p><p>Everyone who plays Queuedle does so with a shared seed: the current date.</p><pre><div><div><p><span>// Get the current local day as a seed</span><span></span></p><p><span></span><span>export</span><span> </span><span>const</span><span> getCurrentDaySeed </span><span>=</span><span> </span><span>(</span><span>)</span><span>:</span><span> </span><span>number</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span></p><p><span>  </span><span>const</span><span> now </span><span>=</span><span> </span><span>new</span><span> </span><span>Date</span><span>(</span><span>)</span><span>;</span><span></span></p><p><span>  </span><span>const</span><span> localDate </span><span>=</span><span> </span><span>new</span><span> </span><span>Date</span><span>(</span><span>now</span><span>.</span><span>getFullYear</span><span>(</span><span>)</span><span>,</span><span> now</span><span>.</span><span>getMonth</span><span>(</span><span>)</span><span>,</span><span> now</span><span>.</span><span>getDate</span><span>(</span><span>)</span><span>)</span><span>;</span><span></span></p><p><span>  </span><span>return</span><span> localDate</span><span>.</span><span>getTime</span><span>(</span><span>)</span><span>;</span><span></span></p><p><span></span><span>}</span><span>;</span></p></div></div></pre><p>Each date becomes a unique seed. The <a href="https://en.wikipedia.org/wiki/Lehmer_random_number_generator">Lehmer random number generator</a> algorithm which consumes this is ~1 line of code. Giving us a new Queuedle game every single day.</p><pre><div><div><p><span>  </span><span>// Generate a random number between 0 and 1</span><span></span></p><p><span>  </span><span>next</span><span>(</span><span>)</span><span>:</span><span> </span><span>number</span><span> </span><span>{</span><span></span></p><p><span>    </span><span>this</span><span>.</span><span>seed</span><span> </span><span>=</span><span> </span><span>(</span><span>this</span><span>.</span><span>seed</span><span> </span><span>*</span><span> </span><span>16807</span><span>)</span><span> </span><span>%</span><span> </span><span>2147483647</span><span>;</span><span></span></p><p><span>    </span><span>return</span><span> </span><span>(</span><span>this</span><span>.</span><span>seed</span><span> </span><span>-</span><span> </span><span>1</span><span>)</span><span> </span><span>/</span><span> </span><span>2147483646</span><span>;</span><span></span></p><p><span>  </span><span>}</span><span></span></p><p><span>  </span><span>// Generate a random integer between min (inclusive) and max (inclusive)</span><span></span></p><p><span>  </span><span>nextInt</span><span>(</span><span>min</span><span>:</span><span> </span><span>number</span><span>,</span><span> max</span><span>:</span><span> </span><span>number</span><span>)</span><span>:</span><span> </span><span>number</span><span> </span><span>{</span><span></span></p><p><span>    </span><span>return</span><span> </span><span>Math</span><span>.</span><span>floor</span><span>(</span><span>this</span><span>.</span><span>next</span><span>(</span><span>)</span><span> </span><span>*</span><span> </span><span>(</span><span>max </span><span>-</span><span> min </span><span>+</span><span> </span><span>1</span><span>)</span><span>)</span><span> </span><span>+</span><span> min</span><span>;</span><span></span></p><p><span>  </span><span>}</span></p></div></div></pre><p>The first time I set up the game generation logic, I ran into a problem. The starting board sometimes contained multiple outlined words! In retrospective, it&#39;s unsurprising that a random 5x5 board of letters would contain at least one three letter word from the 178691 words in the Scrabble tournament word list.</p><p>I decided to throw the user&#39;s CPU at this problem. I simply generate boards, deterministically, until the starting board contains zero words.</p><pre><div><div><p><span>// Generate a valid game state with no words on the board</span><span></span></p><p><span></span><span>export</span><span> </span><span>const</span><span> </span><span>generateValidGameState</span><span> </span><span>=</span><span> </span><span>(</span><span>baseSeed</span><span>:</span><span> </span><span>number</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span></p><p><span>  </span><span>let</span><span> attempt </span><span>=</span><span> </span><span>0</span><span>;</span><span></span></p><p><span>  </span><span>while</span><span> </span><span>(</span><span>true</span><span>)</span><span> </span><span>{</span><span></span></p><p><span>    </span><span>// Deterministically alter the seed</span><span></span></p><p><span>    </span><span>const</span><span> seed </span><span>=</span><span> baseSeed </span><span>+</span><span> attempt</span><span>;</span><span></span></p><p><span>    </span><span>const</span><span> </span><span>{</span><span> grid</span><span>,</span><span> queue </span><span>}</span><span> </span><span>=</span><span> </span><span>generateGameState</span><span>(</span><span>seed</span><span>)</span><span>;</span><span></span></p><p><span>    </span><span>const</span><span> highlights </span><span>=</span><span> </span><span>findWords</span><span>(</span><span>grid</span><span>)</span><span>;</span><span></span></p><p><span>    </span><span>if</span><span> </span><span>(</span><span>highlights</span><span>.</span><span>length</span><span> </span><span>===</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span><span></span></p><p><span>      </span><span>return</span><span> </span><span>{</span><span> grid</span><span>,</span><span> queue</span><span>,</span><span> attempt </span><span>}</span><span>;</span><span></span></p><p><span>    </span><span>}</span><span></span></p><p><span>    attempt</span><span>++</span><span>;</span><span></span></p><p><span>  </span><span>}</span><span></span></p><p><span></span><span>}</span><span>;</span></p></div></div></pre><p>This sometimes requires ~50 board generation cycles. With my unoptimised JavaScript code, this only takes a handle of milliseconds.</p><h2 id="game-ui">Game UI</h2><p>I like the understated design of Wordle and didn&#39;t spend too long on Queuedle&#39;s interface. The tiles and arrows have a slight shadow and respond to actions with brief animations.</p><p>I used <a href="https://motion.dev">Motion</a> (my first time doing so) and my use case seems to live within the happy path of this library. I only needed to pass a few lines of configuration.</p><pre><div><div><p><span>export</span><span> </span><span>default</span><span> </span><span>function</span><span> </span><span>Tile</span><span>(</span><span>{</span><span> letter</span><span>,</span><span> isNew </span><span>}</span><span>:</span><span> </span><span>TileProps</span><span>)</span><span> </span><span>{</span><span></span></p><p><span>  </span><span>if</span><span> </span><span>(</span><span>isNew</span><span>)</span><span> </span><span>{</span><span></span></p><p><span>    </span><span>return</span><span> </span><span>(</span><span></span></p><p><span>      </span><span>&lt;</span><span>motion.div</span><span></span></p><p><span>        </span><span>initial</span><span>=</span><span>{</span><span>{</span><span> scale</span><span>:</span><span> </span><span>0.7</span><span>,</span><span> opacity</span><span>:</span><span> </span><span>0</span><span> </span><span>}</span><span>}</span><span></span></p><p><span>        </span><span>animate</span><span>=</span><span>{</span><span>{</span><span> scale</span><span>:</span><span> </span><span>1</span><span>,</span><span> opacity</span><span>:</span><span> </span><span>1</span><span> </span><span>}</span><span>}</span><span></span></p><p><span>        </span><span>transition</span><span>=</span><span>{</span><span>{</span><span> type</span><span>:</span><span> </span><span>&#39;spring&#39;</span><span>,</span><span> stiffness</span><span>:</span><span> </span><span>400</span><span>,</span><span> damping</span><span>:</span><span> </span><span>22</span><span> </span><span>}</span><span>}</span><span></span></p><p><span>        </span><span>className</span><span>=</span><span>{</span><span>`</span><span></span></p><p><span>          m-1 p-1.5</span></p><p><span>          w-11 h-11 flex items-center justify-center</span></p><p><span>          rounded-lg</span></p><p><span>          text-2xl font-bold</span></p><p><span>          transition-colors duration-200</span></p><p><span>          bg-[#f5e6c5]</span></p><p><span>          shadow-sm</span></p><p><span>        </span><span>`</span><span>}</span><span></span></p><p><span>      </span><span>&gt;</span><span></span></p><p><span>        </span><span>{</span><span>letter</span><span>.</span><span>toUpperCase</span><span>(</span><span>)</span><span>}</span><span></span></p><p><span>      </span><span>&lt;/</span><span>motion.div</span><span>&gt;</span><span></span></p><p><span>    </span><span>)</span><span>;</span><span></span></p><p><span>  </span><span>}</span></p></div></div></pre><p>I added a fade-in delay to the outline to better communicate the effect of the user&#39;s move. I suppose this is subjective, but without the delay it felt like the outline was being drawn almost in advance of the move.</p><p>The animation of the found words serves no function. I just like it.</p><p>One design problem I haven&#39;t solved yet is how to better communicate when a letter is used by multiple worlds. In the case of <code>MOO</code> and <code>MOON</code>, it&#39;s quite obvious that the <code>MOO</code> part is used twice as it&#39;s wrapped in two outlines. However, if words have multiple used-twice letters, it gets busy and confusing.</p><p>I tried to solve this problem by cycling through a small pallete of rainbow colors for the different word outlines to better distinguish one word outline from another. However, players kept asking me what the different colors mean, hah.</p><p>One idea I had, was to highlight the words a letter belongs to when it&#39;s tapped. But I don&#39;t want to give up the simple controls of: just tap the arrows. For example, on desktop, if I show that letters are clickable, people will try to move them, etc.</p><p>My goal was for <a href="https://queuedle.com">Queuedle</a> to be roughly as hard to pick up for the first time as Wordle. I think I got there. I thought about adding a tutorial animation ... but I always skip them.</p></div></div></div>
  </body>
</html>
