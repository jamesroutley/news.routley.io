<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.chrome.com/blog/oblivious-http-for-k-anon-server-with-fastly/">Original</a>
    <h1>Partnering with Fastly–Oblivious HTTP relay for FLEDGE&#39;s 𝑘-anonymity server</h1>
    
    <div id="readability-page-1" class="page"><div><p><a href="https://developer.chrome.com/docs/privacy-sandbox/fledge/">FLEDGE is a Privacy Sandbox proposal</a> to serve remarketing and custom audience use cases, designed with the intent of preventing third-parties from tracking user browsing behavior across sites. The browser will provide protection against microtargeting, by only rendering an ad if the same rendering URL is being shown to a sufficiently large number of people. We will require a crowd of 50 users per creative within the past 7 days before the ad can be rendered. This also helps protect users from cross-site tracking by preventing reporting rendered URLs that don&#39;t meet the minimum threshold.</p><p>This protection is referred to as 𝑘-anonymity, and is enabled by a centralized server operated by Google that maintains global counts. Once a creative meets the minimum threshold, it is cleared to be rendered to users. You can check out <a href="https://github.com/WICG/turtledove/blob/main/FLEDGE_k_anonymity_server.md">our explainer</a> for further details on the 𝑘-threshold, and how the 𝑘-anonymity service is designed within FLEDGE.</p><figure><img width="800" height="450" src="https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format" sizes="(min-width:800px) 800px,calc(100vw - 48px)" loading="lazy" decoding="async" alt="A diagram showing that multiple sites in Chrome send requests to the 𝑘-anonymity server to serve FLEDGE ads." srcset="https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=200 200w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=228 228w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=260 260w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=296 296w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=338 338w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=385 385w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=439 439w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=500 500w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=571 571w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=650 650w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=741 741w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=845 845w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=964 964w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=1098 1098w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=1252 1252w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=1428 1428w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/c7P1fh4VtUCFU5QNNrdY.png?auto=format&amp;w=1600 1600w"/><figcaption>When sites request FLEDGE ads, Google&#39;s 𝑘-anonymity server ensures ads can only be shown if they pass the 𝑘-anonymity threshold. When requests for the ads are made to the advertising company, the IP address is visible to them.</figcaption></figure><p>While the 𝑘-anonymity service provides a key privacy protection, it also could expose sensitive user data to this centralized server, such as IP address and the browser&#39;s User-Agent string. This is why we are improving Chrome’s privacy measures by <a href="https://www.fastly.com/blog/enabling-privacy-on-the-internet-with-oblivious-http">partnering with Fastly</a>, an edge cloud platform that provides content delivery, edge compute, security, and observability services, to operate an <a href="https://github.com/WICG/turtledove/blob/main/FLEDGE_k_anonymity_server.md#oblivious-http">Oblivious HTTP relay (OHTTP relay)</a> as part of FLEDGE’s 𝑘-anonymity server.</p><p>With data being relayed through an OHTTP relay, Google 𝑘-anonymity servers do not receive the IP addresses of end users. The 𝑘-anonymity server is an incremental step towards the full implementation of FLEDGE. Note that this doesn&#39;t impact IP addresses exposed to publisher origins through usual browsing behavior.</p><p>With <a href="https://ietf-wg-ohai.github.io/oblivious-http/draft-ietf-ohai-ohttp.html#name-introduction">Oblivious HTTP (OHTTP)</a>, a client can make multiple requests to a server without the server being able to use the properties of the requests to identify them as originating from the same client. It not only hides the client&#39;s IP address from the server, but also prevents TLS sessions from being used to correlate multiple requests from the same client.</p><p>To implement OHTTP, we partnered with Fastly to operate a relay resource on our behalf. The user&#39;s Chrome browser will send an encrypted payload in the body of an HTTP <code>POST</code> message for the 𝑘-anonymity server to this relay. The browser encrypts the message using keys that it fetches directly from the 𝑘-anonymity server on the Google domain. The relay will forward the request to a gateway that will run on Google servers. The relay therefore doesn&#39;t see the content of the request but is aware of the user&#39;s IP address. Conversely, the 𝑘-anonymity server (and gateway) are unaware of the user&#39;s identity but can see the content of the request.</p><p>No action is required from developers or users, but we wanted to share some infrastructure that we&#39;re putting in place to improve user privacy across the entire FLEDGE process.</p><p>Google intends to operate the 𝑘-anonymity server on behalf of all Chrome users who are using FLEDGE. 𝑘-anonymity checks apply to all third-party ad tech and Google&#39;s own advertising services. The user is the person that benefits from 𝑘-anonymity, and the browser is the software that can choose to implement and enforce it.</p><figure><img width="800" height="450" src="https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format" sizes="(min-width:800px) 800px,calc(100vw - 48px)" loading="lazy" decoding="async" alt="A diagram showing that multiple sites in Chrome send requests to the 𝑘-anonymity server to serve FLEDGE ads with the OHTTP relay in between." srcset="https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=200 200w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=228 228w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=260 260w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=296 296w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=338 338w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=385 385w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=439 439w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=500 500w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=571 571w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=650 650w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=741 741w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=845 845w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=964 964w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=1098 1098w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=1252 1252w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=1428 1428w,https://wd.imgix.net/image/udVScdcCFAdRjZwFdLk2jWAFQyr1/pGB4JTgbiG1VNO2oO524.png?auto=format&amp;w=1600 1600w"/><figcaption>When sites request FLEDGE ads, Google&#39;s 𝑘-anonymity server ensures ads can only be shown if they pass the 𝑘-anonymity threshold. Fastly&#39;s relay protects user privacy by implementing OHTTP to hide the IP addresses.</figcaption></figure><p>The privacy-preserving properties of FLEDGE apply equally to Google and the broader ecosystem. This server will be called from Chrome, with support for Android expected later in 2023.</p><p><em>Photo by <a href="https://unsplash.com/fr/@ianjbattaglia?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Ian Battaglia</a> on <a href="https://unsplash.com/photos/9drS5E_Rguc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></em></p></div></div>
  </body>
</html>
