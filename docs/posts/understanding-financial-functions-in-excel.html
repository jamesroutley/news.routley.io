<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ciju.in/writings/understanding-financial-functions-excel-sheets">Original</a>
    <h1>Understanding Financial Functions in Excel</h1>
    
    <div id="readability-page-1" class="page"><div id="content"><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow></mrow><annotation encoding="application/x-tex">\gdef\pv{\textcolor{BEA1A5}{\small\it{PV}}}
\gdef\fv{\textcolor{BE4BDB}{\small\it{FV}}}
\gdef\pmt{\textcolor{008FD3}{\small\it{PMT}}}
\gdef\rate{\textcolor{32B67A}{\small\it{RATE}}}
\gdef\nper{\textcolor{FF4552}{\small\it{NPER}}}</annotation></semantics></math></span><span aria-hidden="true"></span></span></span></p><p>You might have used functions like FV, PV, XIRR in excel/google sheets<span><span></span><label for="ref-«R21mkfesdb»"></label><span><span id="ref-«R21mkfesdb»"><span>In rest of the article, I will use excel to mean Excel, Google Sheets, OpenOffice etc</span></span></span></span>. In my case, whenever I needed to model some financial calculations, I would struggle with search junk, find out some function, lookup the parameter order, try it out etc. More than that, I couldn&#39;t even think of functions like PMT, RATE etc. Turns out, understanding the underlying model makes it much easier to remember and use these functions. <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pv, \rate, \nper, \pmt, \fv</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span><span>,</span><span></span><span><span><span>RATE</span></span></span><span>,</span><span></span><span><span><span>NPER</span></span></span><span>,</span><span></span><span><span><span>PMT</span></span></span><span>,</span><span></span><span><span><span>FV</span></span></span></span></span></span> are related. Given any four, the fifth value can be derived<span><span></span><label for="ref-«R61mkfesdb»"></label><span><span id="ref-«R61mkfesdb»"><span>It&#39;s almost as if all these functions are different sides of the same coin, or more concretely, different ways of using the same equation.</span></span></span></span>. Moreover, the underlying model could be quite useful in common man&#39;s financial jouney, be it loans or retirement. And it&#39;s not complicated. Here is a visual representation of the underlying model.</p>
<div><svg viewBox="0 55 600 200"><defs><marker id="head" orient="auto" markerWidth="5" markerHeight="8" refX="0.1" refY="4"><path d="M0,0 V8 L4,4 Z" fill="currentColor"></path></marker></defs><line marker-end="url(#head)" x1="0" y1="200" x2="590" y2="200" stroke="currentColor"></line><line stroke="currentColor" x1="186.66666666666666" x2="186.66666666666666" y1="100" y2="200"></line><line stroke="currentColor" x1="333.3333333333333" x2="333.3333333333333" y1="100" y2="200"></line><text fill="currentColor" x="406.66666666666663" y="150" text-anchor="middle">...</text><line stroke="currentColor" x1="480" x2="480" y1="100" y2="200"></line><line stroke="currentColor" x1="40" x2="40" y1="200" y2="230"></line><text x="35" y="225" fill="#BEA1A5" text-anchor="end">PV</text><line stroke="currentColor" x1="480" x2="480" y1="200" y2="230"></line><text x="45" y="225" fill="currentColor">t<tspan dy="10">0</tspan></text><text x="191.66666666666666" y="225" fill="currentColor">t<tspan dy="10">1</tspan></text><text x="338.3333333333333" y="225" fill="currentColor">t<tspan dy="10">2</tspan></text><text x="475" y="225" fill="currentColor" text-anchor="end">t<tspan fill="#FF4552" dy="4">NPER</tspan></text><text x="490" y="225" fill="#BE4BDB" text-anchor="start">FV</text><text fill="#008FD3" x="186.66666666666666" y="90" text-anchor="middle">PMT</text><text fill="#008FD3" x="333.3333333333333" y="90" text-anchor="middle">PMT</text><text fill="#008FD3" x="480" y="90" text-anchor="middle">PMT</text><text fill="currentColor" x="181.66666666666666" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text fill="currentColor" x="328.3333333333333" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text fill="currentColor" x="475" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text x="530" y="195" fill="currentColor" text-anchor="start">time</text></svg><p>Rest of the article explains this visual and adds some more details.</p><div><h2 id="cashflows---a-visual-representation">Cashflows - a visual representation</h2><p>These functions work on cashflows. What is cashflow? Basically money moving in and out of an asset or a liability. Assets (investments, etc) and liability (loans, etc) are handled the same way. It&#39;s just a matter of passing in different numbers (and their signs, +ve/-ve) to the functions.</p><div data-step="example"><p>Let&#39;s start with a concrete example. Say you want to plan for an expense of <span>$100,000</span> in <strong>5 years</strong>. And you have access to an investment vehicle which gives you a return of <strong>10% per annum</strong> (no risk, no volatility, no taxes). You have <span>$3,000</span> to start with. You want to figure out how much you should <strong>invest each year</strong>. Here is how the question looks like, in the visual model. You want to figure out <span>PMT</span>.</p><p>To find the value, you would use <span>PMT</span> function in excel: <code>PMT(0.10, 5, 3000, -100000)</code></p></div><p>Now, let&#39;s remove the specifics. First, it doesn&#39;t matter if the period 5 was years, months, quarters or something else. As long as the <strong>payments are done each period</strong>. And the <strong>interest rate is per period</strong>. So, we abstract away 5 years to <strong>5 periods</strong> and rename it <span>NPER</span> (presumably for N PERiods). Payment in each period is <span>PMT</span>. Rename the money we expect in the end to <span>FV</span> (Future Value). Rename 10% interest to <span>RATE</span>. And the <span>$3,000</span> initial money to <span>PV</span> (Present Value). Here is the same excel calculation with new names: <code>PMT(RATE, NPER, PV, FV)</code>.</p><h2 id="functions-on-cashflow">Functions on cashflow</h2><p>Now, looking at this general visual representation of cashflow, we could wonder, what if we want to know RATE, given NPER, PMT, PV, FV. Or some other combination. And it does work. Here is the list of these related functions available in most excel implementations.</p><pre></pre><p>Isn&#39;t it nice that even the parameters have a certain order? You can see the parameter order across functions, below. Pick the function you want to caculate, move it forward and rest is the order of the parameters to that function. In general, you start with some money (could be +ve, -ve or 0), put some money in (or take out), every period, for NPER periods. And in the end, you take out (or owe) some money. The parameters in <code>[]</code> are optional and if not give, default to 0.</p><pre></pre><p>The last parameter, <code>end_or_begining</code> or <code>when_due</code>, is a flag for when the payments are made. 0 for end, 1 for begining of the period. See the visual model.</p><p>And here is an interesting one use of this model <code>NPER(interest, -savings_rate, 0, (1-savings_rate) ÷ withdrawal_rate)</code>, copied from <a href="https://bou.ke/blog/formulas/">Bouke&#39;s blog</a>. Given a interest rate for all future and your savings rate, it calculates the number of years till you have retirement money<span><span></span><label for="ref-«Rdf2mkfesdb»"></label><span><span id="ref-«Rdf2mkfesdb»"><span>Assumes your withdrawl rate would be same after retirment. And rate is real interest rate. Is calculating with real interest correct? It seems so. Calculating with real interest instead of nominal, seems to be a pretty good approximation. See this <a href="https://docs.google.com/spreadsheets/d/1fyM7dbM6v9b5gqLZpNJf4M11hdRht0V3wwMlzIxnq7w/edit?usp=sharing">Google Sheet</a>.</span></span></span></span>.</p><p><span data-after=" "><p>Now, to test your understanding, try calculating <code>CAGR</code> with
one of these functions?</p><p>If you are in India, here is another interesting one. Calculate the effective
annual rate of return for a ULIP that you have come across.</p></span></p><p>Till now we dealt with cases where PMT (the money you pay/receive every period) and the period are same for the cashflows. In other words, you pay/receive the same amount every period. What if you have cashflows with different amount of payments. What if you have different cashflows and uneven periods (when you made the payments).</p></div></div>
<h3 id="functions-on-changing-cashflows">Functions on changing cashflows</h3>
<p>First, let&#39;s consider the case where periods are same, with only the payments per period could be different from one period to another. The function IRR gives the rate of return. It&#39;s a single rate, which accounts for all the cashflows. NPV is the other function, to get the present value of the cashflows. There is no NFV, not sure why.  <span><span></span><label for="ref-«R24mkfesdb»"></label><span><span id="ref-«R24mkfesdb»"><span>What about NPER, PMT? Given the payments, we implicitly have the payments and the periods!</span></span></span></span>.</p>
<pre></pre>
<p>What if both the payments and when you made them, can vary? E.g. ocassional investments made to a mutual fund. XIRR is a way to understand returns for these cashflows. And XNPV for present value. Again, no XNFV, although it seems to be less useful.</p>
<pre></pre>
<p>These calculations for uneven periods and different payments, are iterative. Solving them involves guessing a value, and then iteratively improving on the guess. Unlike the ones for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo separator="true">,</mo><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\rate, \nper, \pmt, \pv, \fv</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>RATE</span></span></span><span>,</span><span></span><span><span><span>NPER</span></span></span><span>,</span><span></span><span><span><span>PMT</span></span></span><span>,</span><span></span><span><span><span>PV</span></span></span><span>,</span><span></span><span><span><span>FV</span></span></span></span></span></span>.</p>
<h2 id="underlying-calculation">Underlying calculation</h2>
<p>For constant period and payments, the underlying equation is relatively straighforward.</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mo>−</mo><mn>1</mn></mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\fv\space+\space\pv\times(1+\rate)^{\nper}\space+\space\pmt \times \frac{(1+\rate)^{\nper} - 1}{\rate} = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>FV</span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PV</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>RATE</span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span></p>
<div><p>First consider the <span>PV</span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle><mtext> </mtext><mo>+</mo><mtext> </mtext><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup></mrow><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mo>−</mo><mn>1</mn></mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\fv\space+\space\htmlClass{bg-gray-200 py-1}{ \pv\times(1+\rate)^{\nper} }\space+\space\pmt \times \frac{(1+\rate)^{\nper} - 1}{\rate} = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>FV</span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span><span>PV</span></span></span><span></span><span>×</span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>RATE</span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span></p><p>The first year, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pv</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span></span></span></span> grows to</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pv * (1+\rate)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span></span></span></span></p><p>Next year, it grows to</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\pv * (1+ \rate) * (1 + \rate) \implies \pv * (1+\rate)^2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span><span></span><span></span><span>⟹</span><span></span><span></span></span><span><span></span><span><span><span>PV</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span>.</p><p>After <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span></span></span></span> years, the PV grows to</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup></mrow><annotation encoding="application/x-tex">\pv * (1+\rate)^{\nper}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>This is the end value of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pv</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PV</span></span></span></span></span></span>. Now let&#39;s consider <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mo>−</mo><mn>1</mn></mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mfrac></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\fv\space+\space\pv\times(1+\rate)^{\nper}\space+\space\htmlClass{bg-gray-200 py-3}{\pmt \times \frac{(1+\rate)^{\nper} - 1}{\rate}} = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>FV</span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PV</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>RATE</span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span></p><p>The first <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span></span></span></span> payment has <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\nper-1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span><span></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span> years to grow. So, by the end of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span></span></span></span> period, it would be</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mo stretchy="false">(</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\pmt * (1+\rate)^{(\nper-1)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>(</span><span><span><span>NPER</span></span></span><span>−</span><span>1</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span></p><p>Second <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span></span></span></span> has <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\nper-2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span><span></span><span>−</span><span></span></span><span><span></span><span>2</span></span></span></span> years to grow. So, at the end of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span></span></span></span> period, it will be
<span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mo stretchy="false">(</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\pmt * (1+\rate)^{(\nper-2)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span><span></span><span>∗</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>(</span><span><span><span>NPER</span></span></span><span>−</span><span>2</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span></p><p>And so on. If we add up value of all payments (<span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span></span></span></span>) at the end of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>NPER</span></span></span></span></span></span>, it would be</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo><mo>+</mo><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt \times (1+\rate)^{\nper - 1} + \pmt \times (1+\rate)^{\nper - 2} + \ldots + \pmt \times (1+\rate) + \pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>…</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>PMT</span></span></span></span></span></span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mrow><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow><annotation encoding="application/x-tex">\implies\pmt \times \Big( (1+\rate)^{\nper - 1} + (1+\rate)^{\nper - 2} + \ldots + (1+\rate) + 1\Big)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span></span><span>⟹</span><span></span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span>(</span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>…</span><span></span><span>+</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span><span><span>)</span></span></span></span></span></span></p><p>Squint at it a little and you will see the part in the big bracket being similar to.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^{n-1} + x^{n-2} + \ldots + x + 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>…</span><span></span><span>+</span><span></span></span><span><span></span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span></span></p><p>Where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = (1 + \rate)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span></span><span>=</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span>)</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">n = \nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>NPER</span></span></span></span></span></span>.</p><p>To simplify this equation, let&#39;s assume</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">S = x^{n-1} + x^{n-2} + \ldots + x + 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>…</span><span></span><span>+</span><span></span></span><span><span></span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span></span></p><p>Multiply both sides by <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mi>S</mi><mo>=</mo><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">xS = x^{n} + x^{n-1} + \ldots + x^2 + x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>…</span><span></span><span>+</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>x</span></span></span></span></span></p><p>Substracting the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>S</span></span></span></span> from <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">xS</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span>S</span></span></span></span>, we get.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mi>S</mi><mo>=</mo><msup><mi>x</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(x - 1)\times S = x^{n} - 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>x</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span><span>)</span><span></span><span>×</span><span></span></span><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mi>S</mi><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>x</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\implies
S = \frac{x^{n} - 1}{x-1}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span></span><span>⟹</span><span></span><span></span></span><span><span></span><span>S</span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>x</span><span></span><span>−</span><span></span><span>1</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>x</span><span><span><span><span><span><span></span><span><span><span>n</span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>Substituting back values of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">x = 1+\rate</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">n = \nper</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span>NPER</span></span></span></span></span></span>, we get.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mo>−</mo><mn>1</mn></mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mfrac></mrow><annotation encoding="application/x-tex">\pmt \times \frac{(1+\rate)^{\nper} - 1}{\rate}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>RATE</span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>That gives us contribution from <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\pmt</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>PMT</span></span></span></span></span></span>. Now let&#39;s look at the whole equation again.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#BE4BDB"><mstyle mathsize="0.9em"><mrow><mi>F</mi><mi>V</mi></mrow></mstyle></mstyle><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#BEA1A5"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>V</mi></mrow></mstyle></mstyle><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><mstyle mathcolor="#008FD3"><mstyle mathsize="0.9em"><mrow><mi>P</mi><mi>M</mi><mi>T</mi></mrow></mstyle></mstyle><mo>×</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle><msup><mo stretchy="false">)</mo><mstyle mathcolor="#FF4552"><mstyle mathsize="0.9em"><mrow><mi>N</mi><mi>P</mi><mi>E</mi><mi>R</mi></mrow></mstyle></mstyle></msup><mo>−</mo><mn>1</mn></mrow><mstyle mathcolor="#32B67A"><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>A</mi><mi>T</mi><mi>E</mi></mrow></mstyle></mstyle></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\fv\space+\space\pv\times(1+\rate)^{\nper}\space+\space\pmt \times \frac{(1+\rate)^{\nper} - 1}{\rate} = 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span>FV</span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PV</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span> </span><span></span><span>+</span><span> </span><span></span></span><span><span></span><span><span><span>PMT</span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>RATE</span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span><span><span>RATE</span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span><span><span>NPER</span></span></span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span></span></span></span></span></p><p>Why does the sum equal to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0</span></span></span></span>?. My understanding is that it&#39;s a convention. You can think of it as putting some money in an investment, and after some time, taking everything out. The amount in the investment should be 0.</p></div>
<h3 id="irr-npv-xirr-xnpv-calculations">IRR, NPV, XIRR, XNPV calculations</h3>
<p><a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html">OpenOffice Document Format</a> documents functions on irregular cashflows in regular periods (<a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html#NPV">NPV</a>, <a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html#IRR">IRR</a>), and irregular cashflows in irregular periods (<a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html#XNPV">XNPV</a>, <a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html#XIRR">XIRR</a>). To understand calculations for these, it helps to understand NPV first. I might add the explanation here, in future. But till then, you could try <a href="https://www.investopedia.com/terms/n/npv.asp">investopedia explanation</a>. IRR is the rate at which NPV is 0. And similarly, XIRR is the rate at which XNPV is 0.</p>
<h2 id="conclusion">Conclusion</h2>
<svg viewBox="0 55 600 200"><defs><marker id="head" orient="auto" markerWidth="5" markerHeight="8" refX="0.1" refY="4"><path d="M0,0 V8 L4,4 Z" fill="currentColor"></path></marker></defs><line marker-end="url(#head)" x1="0" y1="200" x2="590" y2="200" stroke="currentColor"></line><line stroke="currentColor" x1="186.66666666666666" x2="186.66666666666666" y1="100" y2="200"></line><line stroke="currentColor" x1="333.3333333333333" x2="333.3333333333333" y1="100" y2="200"></line><text fill="currentColor" x="406.66666666666663" y="150" text-anchor="middle">...</text><line stroke="currentColor" x1="480" x2="480" y1="100" y2="200"></line><line stroke="currentColor" x1="40" x2="40" y1="200" y2="230"></line><text x="35" y="225" fill="#BEA1A5" text-anchor="end">PV</text><line stroke="currentColor" x1="480" x2="480" y1="200" y2="230"></line><text x="45" y="225" fill="currentColor">t<tspan dy="10">0</tspan></text><text x="191.66666666666666" y="225" fill="currentColor">t<tspan dy="10">1</tspan></text><text x="338.3333333333333" y="225" fill="currentColor">t<tspan dy="10">2</tspan></text><text x="475" y="225" fill="currentColor" text-anchor="end">t<tspan fill="#FF4552" dy="4">NPER</tspan></text><text x="490" y="225" fill="#BE4BDB" text-anchor="start">FV</text><text fill="#008FD3" x="186.66666666666666" y="90" text-anchor="middle">PMT</text><text fill="#008FD3" x="333.3333333333333" y="90" text-anchor="middle">PMT</text><text fill="#008FD3" x="480" y="90" text-anchor="middle">PMT</text><text fill="currentColor" x="181.66666666666666" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text fill="currentColor" x="328.3333333333333" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text fill="currentColor" x="475" y="190" text-anchor="end"><tspan>x</tspan>(1+<tspan fill="#32B67A">RATE</tspan>)</text><text x="530" y="195" fill="currentColor" text-anchor="start">time</text></svg>
<p>This picture and a mental model around what it means, should help you remember many of the financial functions in most excel implementations.</p>
<!-- -->
<h2 id="acknowledgement">Acknowledgement</h2>
<p>Thanks to <a href="https://ananthakumaran.in/">Anantha Kumaran</a> for feedback.</p><p><span><span>.</span><span>.</span><span>.</span></span></p></div></div>
  </body>
</html>
