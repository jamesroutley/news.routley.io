<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://learncodethehardway.com/blog/29-solving-the-worst-problem-in-programming-education-windows/">Original</a>
    <h1>Solving the Worst Problem in Programming Education: Windows</h1>
    
    <div id="readability-page-1" class="page"><div><info><author><b>By</b> Zed A. Shaw</author></info><!-- HTML_TAG_START --><p>Over the years I&#39;ve tried my best to support Microsoft Windows in my courses because 95% of the world uses Windows. If I want everyone to take my courses then I have to support the operating system that everyone uses. It&#39;d also be ridiculous to tell someone they need to spend $2000 USD on a Mac just to learn to code. Windows is a fully functioning Operating System just like Linux or macOS, so it should be completely reasonable to support everyone who uses it.</p><p>The problem you encounter on Windows (and to some degree macOS) is Microsoft heavily prioritizes their Visual Studio system for all programming tasks, so if you want to use something outside that world you&#39;re in for quite a bit of obnoxious friction. If you want to code C# or C++ desktop apps for Windows then Visual Studio is the way to go. If you want to learn Python, Rust, Go, JavaScript, C, or many, many other languages it&#39;s a slog.</p><p>The question is then, why fight Microsoft? Just tell people to use Visual Studio? Because even though the world of non-programmers uses Windows, the world of <em>programmers</em> decidedly do <em>not</em> use Windows. I think if you were to analyze what people use in the vast world of startups, corporations, open source projects, and other places you&#39;d find it&#39;s inverted with 95% of programmers <em>not</em> using Windows. Even Microsoft had to admit defeat on this and start supporting Linux in Windows.</p><p>This means, if I want to create independent programmers who aren&#39;t beholden to any company for their future, then I have to teach them how to use tools outside of the Microsoft platform, but I still need to support people <em>on</em> that platform until they choose to use something else (or not).</p><p>There&#39;s a secondary practical reason for my own courses: It&#39;s easier to support. If I tell people to install Visual Studio I&#39;ll then have to create 2 sets of instructions. One set for Linux and macOS people, then another completely different set of instructions for Windows people. In addition to that the instructions for Windows will require screenshots or convoluted videos showing people where to click on stuff.</p><p>That means, I need to help people who use Windows get a setup that is more like a Linux and macOS &#34;traditional&#34; configuration. Then they&#39;ll be able to use the OS they already have to learn &#34;classical style&#34; programming without spending extra money. This helps students explore more programming languages and platforms so they don&#39;t become a slave to the whims of Microsoft.</p><h2 id="past-attempts">Past Attempts</h2><p>In my previous instructions I&#39;ve had to rely on lists of links to installers. I&#39;d give a list of things to install, tell them to install each one, then have a big test to confirm everything installed. No matter what I did there was always about 30% of people where the instructions wouldn&#39;t work. Either that person was on Windows Home vs. Windows Pro or accidentally ran <code>cmd.exe</code> instead of <code>PowerShell</code> or had an Anti-Virus running that blocked something. It was always some weird thing I could only figure out with hands on help over chat or emails.</p><p>Here&#39;s just a few of the problems I&#39;ve ran into with this approach:</p><ol><li><strong>The official Python Installer</strong> The guy who works on this is employed by Microsoft so big surprise it refuses to add Python to the PATH.</li><li><strong>Anaconda</strong> For some reason the people who created the Anaconda installer believe the lie that adding Python to the PATH will &#34;destroy the computer.&#34; Yeah? Then why does the Python in the Microsoft store add itself to the PATH?</li><li><strong>Cmder</strong> I got fed up with these idiots after they seemed to purposefully sabotage PowerShell by adding the <code>-NoProfile</code> option by default which kills many tools that need to alter the PowerShell environment. It took me an entire <em>year</em> to find this stupid bug.</li><li><strong>Notepad++</strong> This guy thinks his text editor is a political statement rather than just a damn text editor, which makes him hard to trust even if I agree with most of his views. I can&#39;t have some wannabe activist deciding to erase all my students&#39; computers because they happen to live in the wrong state or country.</li></ol><p>Each of these have caused me weeks, months, or <em>years</em> of support problems because of their stupid decisions. It&#39;s so bad I had to create a special page just for the Python print book that I can update with install instructions when things go wrong.</p><h2 id="what-i-really-want">What I Really Want</h2><p>After years of this total bullshit I decided to sit down and design a solution. The basic features I wanted are:</p><ol><li>An automated meta-install system that can install the required software for each course.</li><li>One that will update this software when there&#39;s updates.</li><li>It should be able to install software that&#39;s outside of Microsoft&#39;s control.</li><li>The final result should be a developer environment that&#39;s similar to a classic Unix environment. That means there&#39;s a command line terminal and tools.</li><li>Since this is Windows it should setup a basic grahpical programmer&#39;s editor that&#39;s keyboard/mouse friendly.</li><li>It shouldn&#39;t exclude people who want to use other tools, so if someone really likes Visual Studio Code then they can use that and still use the installed developer environment.</li><li>Finally, an ability to update these installers quickly to help people remove rogue projects. I call this &#34;The Notepad++ Rule.&#34; If a project realizes I&#39;m driving traffic to them and decides to screw over my users I will rat them out to my users and provide a script to violently eject them from our existence...if the user wants that.</li></ol><p>I started working on this plan a few months back, taking a look at <a href="https://github.com/microsoft/winget-cli">winget</a> and <a href="https://chocolatey.org/">choco</a> which both work but had a couple of annoying things that didn&#39;t make them optimal. With <code>winget</code> or <code>choco</code> I&#39;d mostly be replacing a list of links to installers with a list of installer commands to run. It wouldn&#39;t really reduce the complexity of getting started by much so I was stuck.</p><h2 id="enter-chris-titus-winutil">Enter Chris Titus&#39; WinUtil</h2><blockquote><p>What do you call someone who speaks 3 languages? Trilingual</p><p>How about 2 languages? Bilingual</p><p>And 1 language? An American.</p></blockquote><p>I&#39;m a big critic of Youtube being trash at introducing people to new things, but one day I&#39;m watching Youtube on my TV and up pops Chris Titus&#39; <a href="https://github.com/ChrisTitusTech/winutil">WinUtil</a>. I don&#39;t even know how they figured out I was interested in something like this. You may think it&#39;s because of my search history but keep in ming my TV isn&#39;t logged into any account, and usually I get ads in Spanish and Hindi when I never watch anything in those languages. Yet randomly Youtube shows me one of Chris&#39;s videos and his <code>winutil</code> looked like almost exactly what I needed.</p><p>What <code>winutil</code> does is use PowerShell to create a nice GUI meta-installer. It uses a mix of <code>choco</code> and <code>winget</code> to install the various software packages you select, as well as provide a bunch of tweaks for Windows. You can also use it to craft minimalist ISO installers, prevent tracking, turn off features, and many other things. Its list of packages are also a good list of possibly improved tools for your Windows experience. Best of all, it was just a straight forward PowerShell script you can install with just this:</p><pre><code>irm <span>&#34;https://christitus.com/win&#34;</span> <span>|</span> iex
<span aria-hidden="true"><span></span></span></code></pre><p>Now <em>THAT</em> is the experience I&#39;m looking for, and actually I don&#39;t even want his GUI. It&#39;s nice, but what I really want is a couple of commands and someone gets a simplified standard dev environment. Thankfully, Chris was nice enough to release his project MIT so I could investigate how he&#39;s doing this and possibly steal some his code.</p><h2 id="borrowing-from-winutil">Borrowing from WinUtil</h2><p>After learning enough PowerShell to be deadlier than ebola in a kindergarten I was able to fork Chris&#39; WinUtil a bit to create my own installer. The only thing I stole from WinUtil is the initial setup of <code>winget</code> and <code>choco</code>. I did have to add an additional feature to reduce the amount of <code>Administrator</code> usage since I need to keep people safe who use it. If you <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/base.ps1">view the modified base.ps1 script</a> you&#39;ll see I&#39;m doing two things:</p><ol><li>From Chris&#39; script I use the checking for <code>winget</code> and <code>choco</code> and the installation of those in the <code>Install-WinUtilWinget</code> function.</li><li>However, I have a small chunk of code that checks if you are running as <code>Administrator</code> and if you&#39;re not (which you should not be) it re-launches itself to perform the <code>Install-WinUtilWinget</code> function as <code>Administrator</code>.</li><li>This is one part that <em>must</em> be run as <code>Administrator</code> and after that all other installs can be done as a normal user. Any installers that do need <code>Administrator</code> rights will properly ask for an <code>Administrator</code> password.</li><li>The other place that needs to be <code>Administrator</code> is at the end when <code>choco</code> is first run to install a few more tools, but I&#39;d like to reduce that as well.</li></ol><p>Now when you run this <code>base.ps1</code> script it&#39;ll automatically get you a base install going with a bare minimum programming environment that&#39;s ready for other languages. See the <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers#windows-install-scripts-for-real-programmers">Project README.md</a> for a list of what&#39;s installed or look at the end of the script.</p><h2 id="composible-language-installers">Composible Language Installers</h2><p>The next thing I wanted was an ability for someone to get a basic setup going via the <code>base.ps1</code> but then install as many different languages as they need. To accomplish this I created one <code>.ps1</code> script for each language. These scripts simply confirm that <code>winget</code> and <code>choco</code> is installed (and therefore you <em>probably</em> ran the <code>base.ps1</code>) before then installing packages that create a simple developer experience for that language.</p><p>For example, the <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/cpp.ps1">cpp.ps1</a> just needs to install <code>conan</code> and <code>meson</code> since <code>winlibs</code> is installed by <code>base.ps1</code>, but I go ahead and install <code>winlibs</code> again just to be sure it&#39;s there. This works because <code>choco</code> and <code>winget</code> are idempotent, meaning they&#39;ll only install the package once, or update it if there&#39;s a new one.</p><p>Another example is <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/rust.ps1">rust.ps1</a> which only installs the &#39;Rustlang.Rust.GNU&#39; package to get the base <code>rust</code> compiler package that works with <code>winlibs</code>.</p><p>Or, the <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/python.ps1">python.ps1</a> script that installs <a href="https://www.anaconda.com/">Anaconda</a> and the Microsoft Python from the Microsoft Store because everyone working on Python is a bought and paid for grifter for Microsoft these days, and fighting that is too hard for a little guy like me.</p><p>As of this writing I have installers for the following language environments (in Alphabetical order since people seem to be deeply attached to grifting for their favorite language to win some contest):</p><ul><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/bunjs.ps1">Bun.js</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/cpp.ps1">C/C++</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/crystal.ps1">Crystal</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/go.ps1">Go</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/nodejs.ps1">Node.js</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/python.ps1">Python</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/ruby.ps1">Ruby</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/rust.ps1">Rust</a></li><li><a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/zig.ps1">Zig</a></li></ul><p>The project repository has lists of everything that&#39;s installed in each script, and I have people save the file so you can view what gets installed and modify it if they want.</p><h2 id="how-it-works">How It Works</h2><p>Let&#39;s say you want to install Python and Go. First, you install the <code>base.ps1</code> package like so:</p><pre><code>irm https://learncodethehardway.com/setup/base.ps1 <span>-outfile</span> base.ps1
powershell <span>-executionpolicy</span> bypass .<span>\</span>base.ps1
<span aria-hidden="true"><span></span><span></span></span></code></pre><p>Then you repeat the process with <code>python.ps1</code>:</p><pre><code>irm https://learncodethehardway.com/setup/python.ps1 <span>-outfile</span> python.ps1
powershell <span>-executionpolicy</span> bypass .<span>\</span>python.ps1
<span aria-hidden="true"><span></span><span></span></span></code></pre><p>And finally you do it again for <code>go.ps1</code>:</p><pre><code>irm https://learncodethehardway.com/setup/go.ps1 <span>-outfile</span> go.ps1
powershell <span>-executionpolicy</span> bypass .<span>\</span>go.ps1
<span aria-hidden="true"><span></span><span></span></span></code></pre><p>That&#39;s it. You&#39;ll need to be at your computer to enter an <code>Administrator</code> user&#39;s password, but other than that it should install most of the things you need. I also recommend you take a look at the bottom of these scripts and confirm it&#39;s installing what you want. I also list all of the projects these install on the <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers#windows-install-scripts-for-real-programmers">project README.md</a> and give alternative commands you can run instead of running the scripts.</p><h2 id="how-its-tested">How It&#39;s Tested</h2><p>Finally, the way I&#39;m testing this is with the <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers/src/branch/master/bigtest.ps1">bigtest.ps1</a> script. I run this test like this:</p><ol><li>I fire up a base Windows Home install that has no packages installed yet.</li><li>I then use the above install process to run <code>base.ps1</code> and get an initial config working.</li><li>Next I run <code>bigtest.ps1</code> using the same process and just wait to enter in all the passwords manually until it&#39;s done.</li></ol><p>I&#39;d like to fully automate this process if I can, but that&#39;s a task for another day. I&#39;d also like to automatically download a project for each language to confirm that the language&#39;s installs are working as expected. For example, grab a simple <code>rust</code> project and try to build it.</p><h2 id="please-steal-these">Please Steal These</h2><p>The project is MIT licensed and hosted on my <a href="https://git.learnjsthehardway.com/learn-code-the-hard-way/lcthw-windows-installers">git repository</a>. I&#39;ve also included Chris&#39;s license for the pieces of his code I used, which he also MIT licensed.</p><p>If you&#39;re working on a programming language I highly recommend you take a look at these scripts and adapt them to your language. They solve a ton of problems since the <code>base.ps1</code> script sets up most everything you need for basic C/C++ compilation. If you take that you can extend it to add any additional packages you need for your language, run compilation steps, and more easily support Windows.</p><p>As I&#39;ve already said, 95% of the world uses Windows. If you want your language to grow then making it easy to install on Windows will help. In the past Windows had bizarre APIs but these days it&#39;s fairly normalized given how Microsoft has gone full open source to extract free labor out of the same programmers they used to insult on a daily basis.</p><p>C&#39;mon! It&#39;ll be fun. I promise.</p><h2 id="report-bugs">Report Bugs</h2><p>You can email me at <a href="mailto:help@learncodethehardway.com">help@learncodethehardway.com</a> to report bugs or bother me on <a href="https://twitter.com/lzsthw">Twitter @lzsthw</a>. If you have a language you&#39;d like me to include then email me the script. I&#39;ll take a look and try to include it if I can, and even if I&#39;m not planning on teaching that language. I want these installers to simply bring more alternatives to Windows and to keep the &#34;classical programming&#34; style alive.</p><p>Thank you for your time.</p><!-- HTML_TAG_END --><hr/><h6>More from Learn Code the Hard Way</h6></div></div>
  </body>
</html>
