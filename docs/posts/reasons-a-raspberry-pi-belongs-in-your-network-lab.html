<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blogs.cisco.com/learning/5-reasons-a-raspberry-pi-belongs-in-your-network-lab">Original</a>
    <h1>Reasons a Raspberry Pi Belongs in Your Network Lab</h1>
    
    <div id="readability-page-1" class="page"><article id="post-393746">
<div>
	<!-- .entry-header -->

	 <!-- .blog-post-header -->
	<div>
		<p>It’s Pi Day, everyone — my favorite crowd-sourced holiday. And not just because of my deep affection for fruit/sugar-filled pastries. Nope, since it was first released ten years ago, I’ve loved the Raspberry Pi microcomputer. So, when I was asked if I had any ideas for a Pi-Day blog, I knew exactly what I wanted to write. So, I bring you… <em>5 Reasons a Raspberry Pi Belongs in Your Network Lab!</em></p>
<figure id="attachment_393785" aria-describedby="caption-attachment-393785"><img srcset="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/3-rpi-1-apple-switch-300x159.jpg 300w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/3-rpi-1-apple-switch-768x407.jpg 768w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/3-rpi-1-apple-switch-1024x542.jpg 1024w" sizes="(max-width: 1024px) 100vw, 1024px" src="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/3-rpi-1-apple-switch-1024x542.jpg" alt="3 Raspberry Pis &amp; 1 Apple Pie in a Network Lab" width="640" height="339"/><figcaption id="caption-attachment-393785">3 RPis and 1 Apple Pie in the Lab</figcaption></figure>
<h2><strong>Reason #1: Raspberry Pi powered network services</strong></h2>
<p>I remember when I was studying for my CCIE and building out my network lab. This was before the route/switch (now called enterprise networks) lab was virtualized, and my lab was made up of 4 Catalyst 3K switches and 6 ISR G2 routers. While most of the blueprint focused on routing protocols, layer 2 networking, and spanning-tree (so much spanning-tree), a CCIE is still expected to understand and work with network services.</p>
<p>What do I mean by “network service”? In this case, I’m referring to protocols like DHCP, DNS, NTP, TACACS, RADIUS, TFTP, FTP, etc, etc. These services are fundamental to the proper operation of just about any production network, but it can be a bit of a pain and feel like a waste of time and resources to set them up in the network lab you use for studying. When engineers don’t just skip them completely, often they will take advantage of the minimal capabilities available on network devices themselves within the lab. And while a Cisco router can act as a DHCP or DNS server, it isn’t exactly a realistic setup; there are limitations on what you can do.</p>
<p>Enter the Raspberry Pi.  For anywhere between 15 to 40 dollars, you can add a Linux server to your lab that can run these services and, in some cases, use the same software used in your production network.</p>
<p>Always looking for a good reason to lab something up, I started a new <a href="https://github.com/hpreston/rpi-networklab">git repository</a> and decided to try some of these out myself.</p>
<p>You want to see an example? Of course, I can never say no to you. Let me show you a preview of…</p>
<h2>Pi-DHCP</h2>
<p><span><em>For a more thorough walkthrough of setting up ISC DHCP Server on a Raspberry Pi see <a href="https://github.com/hpreston/rpi-networklab/blob/main/dhcp-server.md" target="_blank" rel="noopener noreferrer">Using a Raspberry Pi as a DHCP Server</a> in my git repository.</em></span></p>
<p>ISC DHCP Server (sometimes just called “dhcpd”) is a widely used DHCP server, and a great one to add to your lab. In fact, many of the example DHCP configuration guides from Cisco use ISC DHCP as the reference server. Installing it onto a Raspberry Pi is as easy as:</p>
<div>
<pre>sudo apt-get install isc-dhcp-server</pre>
</div>
<p>Like most Linux applications, you configure the DHCP server with a config file. Here’s the one I put together for my home lab:</p>
<pre># dhcpd.conf

# DNS Configuration for the network lab
option domain-name &#34;lab.example&#34;;
option domain-name-servers 192.168.192.11;

# Setting the default lease time to 2 minutes and max to 1 hour
default-lease-time 120;
max-lease-time 3600;

# This is the subnet on my home network. No configuration is 
# provided because I don&#39;t want to listen/reply to requests
# but adding it avoids errors/warnings from the service
subnet 10.92.1.0 netmask 255.255.255.128 {
}

# This is my network lab segment configured on eth0
# A range of IPs to assign is provided, as well as the 
# default gateway/router
subnet 192.168.192.0 netmask 255.255.255.0 {
  range 192.168.192.101 192.168.192.120;
  option routers 192.168.192.1;
}

# This assigns a static IP address to a lab client device
host lab-client {
  hardware ethernet b8:27:eb:d3:22:e7;
  fixed-address 192.168.192.12;
}
</pre>
<p>Once it’s started up and running, I configured my lab switch to request an IP address from DHCP on a VLAN interface.</p>
<pre>lab-switch#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
lab-switch(config)#interface vlan 192
lab-switch(config-if)#ip address dhcp 
</pre>
<p>I watch the DHCP logs on the Raspberry Pi and can watch the full DHCP process happen.</p>
<pre>Feb 26 16:00:05 lab-server dhcpd[828]: DHCPDISCOVER from a0:ec:f9:ab:39:d3 via eth0
Feb 26 16:00:06 lab-server dhcpd[828]: DHCPOFFER on 192.168.192.101 to a0:ec:f9:ab:39:d3 (lab-switch) via eth0
Feb 26 16:00:06 lab-server dhcpd[828]: DHCPREQUEST for 192.168.192.101 (192.168.192.11) from a0:ec:f9:ab:39:d3 (lab-switch) via eth0
Feb 26 16:00:06 lab-server dhcpd[828]: DHCPACK on 192.168.192.101 to a0:ec:f9:ab:39:d3 (lab-switch) via eth0
</pre>
<p>How awesome is that!? As a Linux server, a Raspberry Pi can provide just about any network service you need in your lab. Here are some other guides I put together for some of my favorite services in my network lab.</p>
<ul>
<li><a href="https://github.com/hpreston/rpi-networklab/blob/main/dhcp-server.md" target="_blank" rel="noopener noreferrer">DHCP Server with ISC DHCP Server</a></li>
<li><a href="https://github.com/hpreston/rpi-networklab/blob/main/dns-server.md" target="_blank" rel="noopener noreferrer">DNS Server with Bind9</a></li>
<li><a href="https://github.com/hpreston/rpi-networklab/blob/main/dynamic-dns.md" target="_blank" rel="noopener noreferrer">Dynamic DNS fro ISC DHCP and Bind</a></li>
<li><a href="https://github.com/hpreston/rpi-networklab/blob/main/tacacs-server.md" target="_blank" rel="noopener noreferrer">TACACS Server with tac_plus</a></li>
</ul>
<h2><strong>Reason #2: Raspberry Pi network clients</strong></h2>
<p>While experimenting and learning how routing protocols, VLANs, and spanning-trees work can keep a network engineer busy for hours, at some point you are probably going to want to see some traffic from clients on your network. Where do you get clients? Maybe you have some old computers lying around gathering dust. Or maybe you bought an old server off eBay. Or in a pinch, you can use one of your network routers or switches as a client. Those options work… but each of them has their own downsides.</p>
<p>Things like:</p>
<ul>
<li>Even old laptops, desktops, and servers can cost a lot of money</li>
<li>Maintaining 5+-year-old hardware can be a big-time investment</li>
<li>Space, noise, power, ugliness</li>
</ul>
<p>A Raspberry Pi is a great option. For the same money as a couple of old, obsolete servers you can buy several brand-new Raspberry Pis. They are simple devices, easy to setup and reset to default by imaging an SD card. And they are small, silent, and take up far less power than an old server.</p>
<p>There are several different Raspberry Pi models available today, so be sure to order the one that has the network connectivity that meets your needs.  I generally like to pick up models that have both wireless networking and a physical Ethernet interface included.</p>
<figure id="attachment_393789" aria-describedby="caption-attachment-393789"><img srcset="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi3-300x225.jpg 300w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi3-768x576.jpg 768w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi3-1024x768.jpg 1024w" sizes="(max-width: 1024px) 100vw, 1024px" loading="lazy" src="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi3-1024x768.jpg" alt="Raspberry Pi 3B" width="640" height="480"/><figcaption id="caption-attachment-393789">A Raspberry Pi 3B with wired and wireless networking</figcaption></figure>
<p>This is one of the Raspberry Pi Model 3Bs that I have in my lab. Sure, it was released in 2015, but still runs like a champ. I have about five of these that I use for different projects.</p>
<h2><strong>Reason #3: Raspberry Pi lab management station</strong></h2>
<p>Building on the second reason, the Raspberry Pi can be more than just a simple client endpoint in your lab. It makes a pretty darn good lab management station. What I mean by ‘lab management station’ is the workstation you use for doing network configurations, managing devices, upgrading software, etc. Basically, all the things you probably use your laptop for.</p>
<p>I know what you are thinking… “Hank, are you telling me to throw away my laptop? I really like my laptop. It’s got stickers and everything all over it.”</p>
<p>No, that’s not what I’m saying. I don’t know about your lab setup, but I’ve got my network lab tucked away in a corner of my office. And while it’s not as uncomfortable or awkward as some data closets or data centers I’ve worked in, it isn’t exactly as ergonomically designed as my normal desk area. But a lot of network lab work requires console connections to devices, moving network cables from one device to another, starting something and coming back hours later.</p>
<p>The approach I’ve taken is using one of my Raspberry Pis as a dedicated lab management station.</p>
<figure id="attachment_393790" aria-describedby="caption-attachment-393790"><img srcset="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi-Console-300x170.jpg 300w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi-Console-768x434.jpg 768w, https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi-Console-1024x579.jpg 1024w" sizes="(max-width: 1024px) 100vw, 1024px" loading="lazy" src="https://storage.googleapis.com/blogs-images/ciscoblogs/1/2022/03/RPi-Console-1024x579.jpg" alt="Raspberry Pi Console Server" width="640" height="362"/><figcaption id="caption-attachment-393790">Raspberry Pi with USB Console into Cisco Switch</figcaption></figure>
<p>Some Raspberry Pi models come with 4 or more USB ports, so I can connect and leave console cables to the switches and routers for <a href="https://github.com/hpreston/rpi-networklab/blob/main/console-access.md">easy console access</a> whenever I make a mistake and need to get direct access.</p>
<pre># Find the USB Console device for my switch
pi@lab-client:~ $ ls -l /dev/ttyAC*
crw-rw---- 1 root dialout 166, 0 Mar  4 14:48 /dev/ttyACM0

# Open a serial connection to the switch 
pi@lab-client:~ $ screen /dev/ttyACM0 9600

# Configure / Manage the switch
lab-switch&gt;en
Password: 
lab-switch#show ip int bri | exc unas
Interface              IP-Address      OK? Method Status                Protocol
Vlan192                192.168.192.101 YES DHCP   up                    up      
</pre>
<p>I connect the Raspberry Pi to my home wireless, and the physical ethernet connection to the lab switch. This dual attached network setup allows me to SSH into the Raspberry Pi from the comfort of my desk and have the same connectivity as if I were sitting on the floor next to the gear.</p>
<p><span>Tip from Hank: When you connect a computer to both wireless and wired networks at the same time, all modern operating systems will prefer the wired connection over the wireless one.  This makes complete sense from a performance perspective, but in a lab use case like this it may not be what you want.  This is controlled by a route “metric” just like on a network router.  You can configure the Raspberry Pi to have a higher metric for the ethernet interface than wireless.  Example:</span></p>
<pre><span>interface eth0
static ip_address=192.168.192.12/24
static routers=192.168.192.1

# By default ethernet interfaces are given a metric 
# 200 + interface index. This would make the eth0 
# routes preferred over wlan0. But I need wlan0 to
# be preferred to allow internet access. So I set 
# the metric for the eth0 interface to 500
metric 500
</span></pre>
<p><span>For more details on network configuration of a Raspberry Pi see my short guide <a href="https://github.com/hpreston/rpi-networklab/blob/main/network-interface-config.md" target="_blank" rel="noopener noreferrer">TL:DR for Configuring Network Interfaces on Raspberry Pi</a> in my git repository.</span></p>
<p>There is one more benefit to using a Raspberry Pi as a lab management station; it gives you a chance to learn and explore Linux. Linux continues to grow in visibility and importance for network engineers, and IT professionals in general. While Linux can be a bit intimidating for engineers more used to the world of Windows or macOS, using a Raspberry Pi as your lab management station gives you the chance to use Linux as part of your exploration and work. You can learn basic Linux skills such as:</p>
<ul>
<li>file management</li>
<li>network configuration and tools</li>
<li>installing applications</li>
<li>configuring and managing services</li>
<li>how to exit vim without unplugging your computer</li>
</ul>
<h2><strong>Reason #4: Raspberry Pi as a network sensor/traffic analysis device</strong></h2>
<p>Is there anything that gets a network engineer as excited as sniffing packets on the network? I’m not sure there is… Maybe the first successful ping across a newly built network. That is a <em>pretty sweet</em> feeling as well.</p>
<p>But back to capturing packets… the Raspberry Pi can do this too. And the models that have both wireless and wired network connections are very well suited to the job of network sniffer because you can connect to it over the wireless connection while the wired connection is busy slurping packets.</p>
<p>First up, I install tcpdump on my Raspberry Pi.</p>
<pre>sudo apt-get install tcpdump</pre>
<p><span>What about Wireshark you ask?  Wireshark can run on a Raspberry Pi too, but it’s a much “heavier” application than tcpdump.  What I generally have found best is to capture with tcpdump on the Raspberry Pi, and then analysis the captured file on my main workstation with Wireshark. </span></p>
<p>Second, configure a monitor session on my lab switch (a Cat 3650) to send all traffic destined to the Raspberry Pi that acts as my DHCP and DNS server to my new sniffer.</p>
<pre>! Connection to my lab-server Raspberry Pi
monitor session 1 source interface Gi1/0/1

! Connection to my lab-sniffer Raspberry Pi 
monitor session 1 destination interface Gi1/0/11

! Check configuration
show monitor session 1

# Output 
Session 1
---------
Type                     : Local Session
Source Ports             : 
    Both                 : Gi1/0/1
Destination Ports        : Gi1/0/11
    Encapsulation        : Native
          Ingress        : Disabled
</pre>
<p>And finally, I use tcpdump to capture all DHCP traffic.</p>
<pre>sudo tcpdump -i eth0 -v port 67 or port 68

# Output
tcpdump: listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
20:46:02.181634 IP (tos 0x0, ttl 64, id 40790, offset 0, flags [DF], proto UDP (17), length 328)
    192.168.192.102.bootpc &gt; 192.168.192.11.bootps: BOOTP/DHCP, Request from b8:27:eb:d3:22:e7 (oui Unknown), length 300, xid 0xde321e7e, secs 65535, Flags [none]
        Client-IP 192.168.192.102
        Client-Ethernet-Address b8:27:eb:d3:22:e7 (oui Unknown)
        Vendor-rfc1048 Extensions
            Magic Cookie 0x63825363
            DHCP-Message (53), length 1: Request
            Client-ID (61), length 7: ether b8:27:eb:d3:22:e7
            MSZ (57), length 2: 1472
            Hostname (12), length 10: &#34;lab-client&#34;
            Unknown (145), length 1: 1
            Parameter-Request (55), length 14: 
            Subnet-Mask (1), Classless-Static-Route (121), Static-Route (33), Default-Gateway (3)
            Domain-Name-Server (6), Hostname (12), Domain-Name (15), MTU (26)
            BR (28), Lease-Time (51), Server-ID (54), RN (58)
            RB (59), Unknown (119)
20:46:02.194360 IP (tos 0x0, ttl 64, id 39778, offset 0, flags [DF], proto UDP (17), length 328)
    192.168.192.11.bootps &gt; 192.168.192.102.bootpc: BOOTP/DHCP, Reply, length 300, xid 0xde321e7e, secs 65535, Flags [none]
        Client-IP 192.168.192.102
        Your-IP 192.168.192.102
        Client-Ethernet-Address b8:27:eb:d3:22:e7 (oui Unknown)
        Vendor-rfc1048 Extensions
            Magic Cookie 0x63825363
            DHCP-Message (53), length 1: ACK
            Server-ID (54), length 4: 192.168.192.11
            Lease-Time (51), length 4: 300
            Subnet-Mask (1), length 4: 255.255.255.0
            Default-Gateway (3), length 4: 192.168.192.1
            Domain-Name-Server (6), length 4: 192.168.192.11
            Domain-Name (15), length 11: &#34;lab.example&#34;
</pre>
<p>Pretty slick!</p>
<p><span>For a more thorough walkthrough of doing packet capture/analysis on a Raspberry Pi check out the guide <a href="https://github.com/hpreston/rpi-networklab/blob/main/traffic-analysis.md" target="_blank" rel="noopener noreferrer">Traffic Analysis and Capture</a> in my git repository.</span></p>
<h2><strong>Reason #5: Raspberry Pi as an application server</strong></h2>
<p>And our final reason for today, you can add “applications” to your network lab by running them on the Raspberry Pi.  Why would you want to do that you wonder… There are many reasons you might want an application in your home lab.</p>
<ul>
<li>Generate realistic client/server traffic for packet capture</li>
<li>Experiment with quality-of-service configurations to either prioritize or restrict application access</li>
<li>Build firewall rules around application access</li>
<li>Create NAT/PAT rules for accessing an application</li>
<li>Explore and understand protocols like HTTP and REST APIs</li>
</ul>
<p>And while you could certainly write your own application, in this open-source world there is almost no end to the applications you can quickly install and run on your Raspberry Pi with very limited effort. And it can be even easier if you install Docker on your Raspberry Pi and leverage the large number of ARM-based images available.</p>
<p>Some ideas for applications to run in on your Raspberry Pi</p>
<ul>
<li>NetBox – Network Source of Truth</li>
<li>WordPress – Blog / Website</li>
<li>Zabbix – Network Monitoring</li>
<li>Postfix – Email Server</li>
<li>Plex – Media Server</li>
<li>RetroPi – Game Emulator (this one is mostly just for fun, might not be a lot of network traffic)</li>
</ul>
<p>Note: I have not installed all of the above applications on Raspberry Pi so can’t comment firsthand on their setup.</p>
<h2><strong>In Summary</strong></h2>
<p>Well, there you are. Five excellent reasons a Raspberry Pi should be the next addition you make to your lab. Are you already using a Raspberry Pi in your lab? Tell me about it in the comments or over on Twitter (<a href="https://twitter.com/hfpreston">@hfpreston</a>). So long for now, I’m off to eat that apple pie from the picture. Happy Pi Day!</p>
<blockquote>
<h2><strong>Follow Cisco Learning &amp; Certifications</strong></h2>
<h3><strong><a href="https://twitter.com/LearningatCisco">Twitter</a>, <a href="https://www.facebook.com/learningatcisco">Facebook</a>, <a href="https://www.linkedin.com/showcase/cisco_training_and_certification">LinkedIn</a> and <a href="https://www.instagram.com/learningatcisco/">Instagram</a>.</strong></h3>
</blockquote>
	
	   </div><!-- .entry-content -->
		</div>
	<!-- .entry-footer -->
</article></div>
  </body>
</html>
