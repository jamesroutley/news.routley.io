<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.theregister.com/2023/01/30/wan_router_ip_address_change/">Original</a>
    <h1>WAN router IP address change blamed for global Microsoft 365 outage</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
<p>The global outage of Microsoft 365 services that last week prevented some users from accessing resources for more than half a working day was down to a packet bottleneck caused by a router IP address change.</p>
<p>Microsoft&#39;s wide area network <a target="_blank" href="https://www.theregister.com/2023/01/25/network_issues_causing_outage_in/">toppled a bunch of services</a> from 07:05 UTC on January 25 and although some regions and services had come back online by 09:00, intermittent packet loss woes weren&#39;t fully mitigated until 12:42. The wobble also affected Azure Government cloud services.</p>
<p>In a <a target="_blank" rel="nofollow" href="https://status.azure.com/en-us/status/history/#:~:text=Preliminary%20Post%20Incident%20Review%20(PIR)%20%E2%80%93%20Azure%20Networking%20%E2%80%93%20Global%20WAN%20issues%20(Tracking%20ID%20VSG1%2DB90)">postmortem</a>, Microsoft said that changes made to its WAN had hit connectivity between clients and Azure, across regions and cross-premises via ExpressRoute.</p>

    

<p>&#34;As part of a planned change to update the IP address on a WAN router, a command given to the router caused it to send messages to all other routers in the WAN, which resulted in all of them recomputing their adjacency and forwarding tables. During this re-computation process, the routers were unable to correctly forward packets traversing them.</p>

        


        

<p>&#34;The command that caused the issue has different behaviors on different network devices, and the command had not been vetted using our full qualification process on the router on which it was executed.&#34;</p>
<p>This meant users were unable to access resources hosted in Azure or other Microsoft 365 and Power Platform services.</p>

        

<p>Microsoft said monitoring systems detected DNS and WAN-related troubles at 07:12, some seven minutes after they began.</p>
<p>By 08:20, resident techies at Microsoft had spotted the &#34;problematic command that triggered the issues&#34; and some 40 minutes later networking telemetry indicated many of the services were running again.</p>
<ul>

<li><a href="https://www.theregister.com/2022/10/18/uk_government_in_talks_with/">UK government in talks with datacenter operators over blackouts</a></li>

<li><a href="https://www.theregister.com/2022/09/21/uptime_institute_datacenter_outages/">Datacenter outages are costing more, $1m+ failures now common</a></li>

<li><a href="https://www.theregister.com/2022/12/02/microsoft_teams_exchange_apac_outage/">Exchange Online and Microsoft Teams went down in APAC because Microsoft broke itself</a></li>

<li><a href="https://www.theregister.com/2022/07/21/teams_outage/">Microsoft Teams outage widens to take out M365 services, admin center</a></li>
</ul>
<p>However, Microsoft said the initial problem with the WAN meant automated systems for maintaining its health were paused. This included systems for identifying and expelling unhealthy devices, as well as the traffic engineering system for optimizing the flow of data across the network.</p>
<p>&#34;Due to the pause in these systems, some paths in the network experienced increased packet loss from 09:35 UTC until those systems were manually restarted, restoring the WAN to optimal operating conditions. This recovery was completed at 12:43 UTC,&#34; the postmortem added.</p>
<p>Efforts Microsoft is taking to make similar incidents less likely or severe include blocking &#34;highly impactful command from getting executed on the devices&#34; and requiring all command execution on devices to follow safe guidelines.</p>

        

<p>The final post-incident report is scheduled to be published a fortnight after the outage. Â®</p>                                


                    </div></div>
  </body>
</html>
