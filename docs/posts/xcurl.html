<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://daniel.haxx.se/blog/2023/11/30/xcurl/">Original</a>
    <h1>XCurl</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<p>It is often said that <em>Imitation is the Sincerest Form of Flattery</em>.</p>



<p>Also, remember <a href="https://daniel.haxx.se/blog/2019/06/19/google-to-reimplement-curl-in-libcrurl/" data-type="post" data-id="12576">libcrurl</a>? That was the name of the thing Google once planned to do:  reimplement the libcurl API on top of their Chrome networking library. Flattery or not, it never went anywhere.</p>



<p>The other day I received an email asking me about details regarding something called <strong>xCurl</strong>. Not having a clue what that was, a quick search soon had me enlightened.</p>



<p>xCurl is, using <a href="https://learn.microsoft.com/en-us/gaming/gdk/_content/gc/networking/overviews/web-requests/intro-xcurl">their own words</a>, <em>a Microsoft Game Development Kit (GDK) compliant implementation of the libCurl API</em>.</p>



<h2>A Frankencurl</h2>



<p>The article I link to above describes how xCurl differs from libcurl: </p>



<blockquote>
<p>xCurl differs from libCurl in that xCurl is implemented on top of WinHttp and automatically follows all the extra Microsoft Game Development Kit (GDK) requirements and best practices. While libCurl itself doesn’t meet the security requirements for the Microsoft Game Development Kit (GDK) console platform, use xCurl to maintain your same libCurl HTTP implementation across all platforms while changing only one header include and library linkage.</p>
</blockquote>



<p>I don’t know anything about WinHttp, but since that is an HTTP API I can only presume that making libcurl use that instead of plain old sockets has to mean a pretty large surgery and code change. I also have no idea what the mentioned “security requirements” might be. I’m not very familiar with Windows internals nor with their game development setups.</p>



<p>The article then goes on to describe with some detail exactly which libcurl options that work, and which don’t and what libcurl build options that were used when xCurl was built. No DoH, no proxy support, no cookies etc.</p>



<p>The provided functionality is certainly a very stripped down and limited version of the libcurl API. A fun detail is that the quite bluntly just link to the <a href="https://curl.se/libcurl/c/">libcurl API documentation</a> to describe how xCurl works. It is easy and convenient of course, and it will certainly make xCurl “forced” to stick to the libcurl behavior</p>



<p>With large invasive changes of this kind we can certainly hope that the team making it has invested time and spent serious effort on additional testing, both before release and ongoing.</p>



<h2>Source code?</h2>



<p>I have not been able to figure out how to download xCurl in any form, and since I can’t find the source code I cannot really get a grip of exactly how much and how invasive Microsoft has patched this. They have not been in touch or communicated about this work of theirs to anyone in the curl project.</p>



<p>Therefore, I also cannot say which libcurl version this is based on – as there is no telling of that on the page describing xCurl.</p>



<p>The email that triggered me to crawl down this rabbit hole included a copyright file that seems to originate from an xCurl package, and that includes the curl license. The curl license file has the specific detail that it shows the copyright year range at the top and this file said </p>



<pre>Copyright (c) 1996 - 2020, Daniel Stenberg, daniel@haxx.se, and many contributors, see the THANKS file.</pre>



<p>It <em>might</em> indicate that they use a libcurl from a few years back. Only <em>might</em>, because it is quite common among users of libcurl to “forget” (sometimes I’m sure on purpose) to update this copyright range even when they otherwise upgrade the source code. This makes the year range a rather weak evidence of the actual age of the libcurl code this is based on.</p>



<h2>Updates</h2>



<p>curl (including libcurl) ships a new version <em>at least</em> once every eight weeks. We merge bugfixes at a rate of around three bugfixes <em>per day</em>. Keeping a heavily modified libcurl version in sync with the latest curl releases is hard work.</p>



<p>Of course, since they deliberately limit the scope of the functionality of their clone, lots of upstream changes in curl will not affect xCurl users.</p>



<h2>License</h2>



<p>curl is licensed under… <a href="https://curl.se/docs/copyright.html">the curl license</a>! It is an MIT license that I was unclever enough to slightly modify many years ago. The changes are enough for organizations such as SPDX to consider it a separate one: <a href="https://spdx.org/licenses/curl.html">curl</a>. I normally still say that curl is MIT licensed because the changes are minuscule and do not change the spirit of the license.</p>



<p>The curl license of course allows Microsoft or anyone else do to this kind of stunt and they don’t even have to provide the source code for their changes or the final product and they don’t have to ask or tell anyone:</p>



<p><em>Permission to use, copy, modify, and distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.</em></p>



<p>I once picked this license for curl exactly because it allows this. Sure it might sometimes then make people do things in secret that they never contribute back, and we miss out on possible improvements because of that, but I think the more important property is that no company feels scared or restricted as to when and where they can use this code. A license designed for maximum adoption.</p>



<p>I have always had the belief that it is our relentless update scheme and never-ending flood of bugfixes that is what will keep users wanting to use the real thing and avoid maintaining long-running external patches. There will of course always be exceptions to that.</p>
	</div></div>
  </body>
</html>
