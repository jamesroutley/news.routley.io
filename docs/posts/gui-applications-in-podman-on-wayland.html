<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/mody5bundle/capps">Original</a>
    <h1>Show HN: GUI Applications in Podman on Wayland</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<ul dir="auto">
<li>restrict scope of file system access</li>
<li>run any application without root privileges</li>
<li>creates usable &#34;Desktop applications&#34; to integrate into your normal workflow</li>
<li>cut network access for applications that work with confidential stuff to prevent accidental leakage</li>
<li>set MEM and CPU boundaries for your applications (disclaimer: cpu limits not implemented yet)</li>
<li>easy rollback with version pinning</li>
<li>works on wayland</li>
</ul>

<div data-snippet-clipboard-copy-content="capps.py [-h] [-a app1 app2 ... [app1 app2 ... ...]] [-c /path/to/config.yaml] [-b] [-r] [-i] [-v] [-s] [-d] [-l]

Start podman container apps.

options:
  -h, --help            show this help message and exit
  -a app1 app2 ... [app1 app2 ... ...], --application-list app1 app2 ... [app1 app2 ... ...]
                        List of applications to run as defined in config file
  -c /path/to/config.yaml, --config /path/to/config.yaml
                        Path to config file (defaults to config.yaml)
  -b, --build           (re)build list of provided apps
  -r, --run             run containers of all provided apps (default)
  -i, --install         install as desktop application
  -v, --verbose         enable verbose log output
  -s, --stats           enable stats output
  -d, --debug           enable debug log output
  -l, --list            print available container"><pre><code>capps.py [-h] [-a app1 app2 ... [app1 app2 ... ...]] [-c /path/to/config.yaml] [-b] [-r] [-i] [-v] [-s] [-d] [-l]

Start podman container apps.

options:
  -h, --help            show this help message and exit
  -a app1 app2 ... [app1 app2 ... ...], --application-list app1 app2 ... [app1 app2 ... ...]
                        List of applications to run as defined in config file
  -c /path/to/config.yaml, --config /path/to/config.yaml
                        Path to config file (defaults to config.yaml)
  -b, --build           (re)build list of provided apps
  -r, --run             run containers of all provided apps (default)
  -i, --install         install as desktop application
  -v, --verbose         enable verbose log output
  -s, --stats           enable stats output
  -d, --debug           enable debug log output
  -l, --list            print available container
</code></pre></div>

<div data-snippet-clipboard-copy-content="podman run --rm -d --hostname firefox \
--name firefox-$RANDOM \
--cap-drop=ALL \
--read-only=true \
--read-only-tmpfs=false \
--systemd=false \
--userns=keep-id \
--security-opt=no-new-privileges \
--memory=2048mb \
--cap-add cap_sys_chroot \
--volume $HOME/Downloads/:/home/firefox/Downloads:rw \
--volume /run/user/$UID/pulse/native:/run/user/$UID/pulse/native:ro \
--volume $XDG_RUNTIME_DIR/$WAYLAND_DISPLAY:/tmp/$WAYLAND_DISPLAY:ro \
localhost/firefox"><pre><code>podman run --rm -d --hostname firefox \
--name firefox-$RANDOM \
--cap-drop=ALL \
--read-only=true \
--read-only-tmpfs=false \
--systemd=false \
--userns=keep-id \
--security-opt=no-new-privileges \
--memory=2048mb \
--cap-add cap_sys_chroot \
--volume $HOME/Downloads/:/home/firefox/Downloads:rw \
--volume /run/user/$UID/pulse/native:/run/user/$UID/pulse/native:ro \
--volume $XDG_RUNTIME_DIR/$WAYLAND_DISPLAY:/tmp/$WAYLAND_DISPLAY:ro \
localhost/firefox
</code></pre></div>

<div data-snippet-clipboard-copy-content="default_permissions: &amp;default_permissions
  cap-drop: ALL
  read-only: true
  read-only-tmpfs: true
  systemd: false
  userns: keep-id
  security-opt: &#34;no-new-privileges&#34;
volumes:
  - &amp;sound &#34;/run/user/$UID/pulse/native:/run/user/$UID/pulse/native:ro&#34;
  - &amp;wayland &#34;$XDG_RUNTIME_DIR/$WAYLAND_DISPLAY:/tmp/$WAYLAND_DISPLAY:ro&#34;
  - &amp;x11 /tmp/.X11-unix:/tmp/.X11-unix:ro
container:
  firefox:
    versioncmd: &#34;firefox --version | awk \&#34;&#39;\&#34;{print \\$3}\&#34;&#39;\&#34;&#34;
    repo: &#34;localhost&#34;
    file: &#34;firefox.dockerfile&#34;
    path: &#34;./container/firefox/&#34;
    icon: &#34;firefox.png&#34;
    permissions:
      memory: 2048mb
      &lt;&lt;: *default_permissions
      read-only-tmpfs: false
      cap-add:
        - &#34;cap_sys_chroot&#34;
      volume:
        - &#34;$HOME/Downloads/:/home/firefox/Downloads:rw&#34;
        - *sound
        - *wayland"><pre><code>default_permissions: &amp;default_permissions
  cap-drop: ALL
  read-only: true
  read-only-tmpfs: true
  systemd: false
  userns: keep-id
  security-opt: &#34;no-new-privileges&#34;
volumes:
  - &amp;sound &#34;/run/user/$UID/pulse/native:/run/user/$UID/pulse/native:ro&#34;
  - &amp;wayland &#34;$XDG_RUNTIME_DIR/$WAYLAND_DISPLAY:/tmp/$WAYLAND_DISPLAY:ro&#34;
  - &amp;x11 /tmp/.X11-unix:/tmp/.X11-unix:ro
container:
  firefox:
    versioncmd: &#34;firefox --version | awk \&#34;&#39;\&#34;{print \\$3}\&#34;&#39;\&#34;&#34;
    repo: &#34;localhost&#34;
    file: &#34;firefox.dockerfile&#34;
    path: &#34;./container/firefox/&#34;
    icon: &#34;firefox.png&#34;
    permissions:
      memory: 2048mb
      &lt;&lt;: *default_permissions
      read-only-tmpfs: false
      cap-add:
        - &#34;cap_sys_chroot&#34;
      volume:
        - &#34;$HOME/Downloads/:/home/firefox/Downloads:rw&#34;
        - *sound
        - *wayland
</code></pre></div>
<h2 dir="auto"><a id="user-content-list-images" aria-hidden="true" href="#list-images"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>list images</h2>
<div data-snippet-clipboard-copy-content="./capps.py -l
Available Containers in config:
firefox: 	Mem: 2048mb, 	Capabilities:  [&#39;cap_sys_chroot&#39;], 	cap-drop: ALL
Available images on host for firefox:
[&#39;localhost/firefox:latest&#39;, &#39;localhost/firefox:98.0&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1178 MB	 	3391 Minutes old.
[&#39;localhost/firefox:97.0.1&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1182 MB	 	26452 Minutes old.
[&#39;localhost/firefox:96.0&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1156 MB	 	96024 Minutes old."><pre><code>./capps.py -l
Available Containers in config:
firefox: 	Mem: 2048mb, 	Capabilities:  [&#39;cap_sys_chroot&#39;], 	cap-drop: ALL
Available images on host for firefox:
[&#39;localhost/firefox:latest&#39;, &#39;localhost/firefox:98.0&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1178 MB	 	3391 Minutes old.
[&#39;localhost/firefox:97.0.1&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1182 MB	 	26452 Minutes old.
[&#39;localhost/firefox:96.0&#39;]	Entrypoint: [&#39;/bin/sh&#39;, &#39;-c&#39;, &#39;/usr/bin/firefox --private --private-window&#39;]	Size: 1156 MB	 	96024 Minutes old.
</code></pre></div>
<h2 dir="auto"><a id="user-content-get-stats-on-started-container" aria-hidden="true" href="#get-stats-on-started-container"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>get stats on started container</h2>
<div data-snippet-clipboard-copy-content="./capps.py -a firefox -s
NAME			MEM			                     CPU	 READ/WRITE   PIDS
firefox-18685:	 232.1MB / 2.147GB / 10.81% 	 3.17% 	 -- / -- 57
firefox-18685:	 497.1MB / 2.147GB / 23.15% 	 2.24% 	 0B / 2.049MB 226"><pre><code>./capps.py -a firefox -s
NAME			MEM			                     CPU	 READ/WRITE   PIDS
firefox-18685:	 232.1MB / 2.147GB / 10.81% 	 3.17% 	 -- / -- 57
firefox-18685:	 497.1MB / 2.147GB / 23.15% 	 2.24% 	 0B / 2.049MB 226
</code></pre></div>
<h2 dir="auto"><a id="user-content-selinux" aria-hidden="true" href="#selinux"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Selinux:</h2>
<div data-snippet-clipboard-copy-content="cat capps.te
checkmodule -M -m -o capps.mod capps.te
semodule_package -o capps.pp -m capps.mod
semodule -i capps.pp
rm -rf capps.{pp,mod}"><pre><code>cat capps.te
checkmodule -M -m -o capps.mod capps.te
semodule_package -o capps.pp -m capps.mod
semodule -i capps.pp
rm -rf capps.{pp,mod}
</code></pre></div>
</article>
          </div></div>
  </body>
</html>
