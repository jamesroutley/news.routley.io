<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pop.fsck.pl/projects/secondlife-ups-MkII.html">Original</a>
    <h1>Second Life UPS Mark II</h1>
    
    <div id="readability-page-1" class="page"><div id="content">



<div id="outline-container-orgf92f6b8">
<h2 id="orgf92f6b8"><span>1.</span> Introduction</h2>
<div id="text-1">
<p>
The Secondlife UPS Mark II was envisioned as a successor to the <a href="https://pop.fsck.pl/projects/secondlife-ups.html">Secondlife UPS Mark I</a> model with the following improvements:
</p>

<ul>
<li>increased battery capacity</li>
<li>increased power budget</li>
<li>circuit simplification</li>
<li>modularity</li>
<li>improved load connectors</li>
<li>various other usability improvements (for example moving the fuses to the front of the enclosure)</li>
<li>better documentation</li>
</ul>

<p>
The basic premise is to provide a short depth (~250 mm) rack mountable UPS which instead of 230V AC can provide typical low voltages suitable for 
powering of CCTV cameras, sensors, routers, 802.11 access points, modems, switches, embedded systems (like a Raspberry Pi) and other small devices. 
This approach is advantegous in terms of saving rack space where a PDU does not have to be mounted as well as potential power efficiency gains
of having fewer AC &lt;-&gt; DC power conversion steps.
</p>

<p>
The UPS design is built using off-the-shelf or recycled components with a few custom made printed circuit boards. Most notably, the UPS is designed to
be enclosed using typical 19″ Ethernet switches. These can be obtained very cheap or even given away for free when equipment is discarded. Apart from a
reusability solarpunk vibe Ethernet switch enclosures provide us with ready-made cutouts in their front panels. These originally house Ethernet connectors
and have typical dimensions. This fact makes it easy to build a modular UPS device with standarised parts.
</p>

<p>
Even though any Ethernet 19″ rack switch enclosure can be used for this build, this particular UPS is going to be housed in an enclosure from a
damaged <a href="https://wikidevi.wi-cat.ru/Netgear_GS748T_v4">Netgear GS748T</a> switch.
</p>

<p>
The UPS design is focused around two buses providing standard 12V and 5V voltages using buck converters as well as a &#34;direct&#34; bus (labeled later as V<sub>rail</sub>)
which is connected directly to the battery or AC power supply. The peculiarity of this bus is that the voltage on it has a significant swing - from 11.2V 
when operating on an almost depleted battery towards 24V when operating on AC power. The advantage of using V<sub>rail</sub> is that its current capacity is not limited
by the DC-DC buck converters and can power more power-hungry equipment - for example a <a href="https://wikidevi.wi-cat.ru/Netgear_ReadyNAS_RN3138">Netgear RN3138 NAS</a>.
</p>
</div>

<div id="outline-container-org7d24018">
<h4 id="org7d24018"><span>1.0.1.</span> More battery capacity</h4>
<p>
In order to provide more power as well as longer runtime, the UPS will contain a 4S24P Lithium-Ion battery pack built from refurbished 18650 cells having a capacity
of around 600 Wh (if 2000 mAh cells are used).
</p>
</div>

<div id="outline-container-org92c4625">
<h4 id="org92c4625"><span>1.0.2.</span> More power</h4>
<div id="text-1-0-2">
<p>
After <a href="https://pop.fsck.pl/projects/secondlife-ups.html">Secondlife UPS Mark I</a> has been deployed there have been a number of changes and additions to my home infrastructure equipment rack. Power requirements have
increased. In order to come up with more detailed power requirements for each voltage  I measured the amount of current draw during normal operation for each
piece of equipment and came up with the following calculations for the power budget requirements of the UPS. As the voltage on the V<sub>rail</sub> bus is not constant and
changes from 11.2V when operating on a discharged battery and 24V when operating on AC its more useful to specify it&#39;s performance in terms of power not current.
</p>

<table id="orgad71154">
<caption><span>Table 1:</span> Devices connected to the UPS</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Device</th>
<th scope="col">12V Current [A] (measured)</th>
<th scope="col">12V Current [A] (max)</th>
<th scope="col">5V Current [A] (max)</th>
<th scope="col">V<sub>rail</sub> power [W] (measured)</th>
<th scope="col">V<sub>rail</sub> power [W] (max)</th>
<th scope="col">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Router</td>
<td> </td>
<td>5</td>
<td> </td>
<td> </td>
<td> </td>
<td>Axiomtek NA342</td>
</tr>

<tr>
<td>GPON Modem</td>
<td> </td>
<td>0.5</td>
<td> </td>
<td> </td>
<td> </td>
<td><a href="https://halny.com/portfolio/hl-1ge">HALNY HL-1GE</a></td>
</tr>

<tr>
<td>Core Ethernet switch</td>
<td>1.33</td>
<td>4</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>

<tr>
<td>Planet GSD-800S switch</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>21</td>
<td>PoE injected</td>
</tr>

<tr>
<td>Ubiquity Unify AC Lite AP</td>
<td>0.16</td>
<td>0.54</td>
<td> </td>
<td> </td>
<td> </td>
<td>Via boost converter and PoE injected, rated at 6.5 W (see <a href="https://dl.ui.com/datasheets/unifi/UniFi_AC_APs_DS.pdf">datasheet</a>), passive 24V PoE Mode B (230V/0.02A)</td>
</tr>

<tr>
<td>Raspberry Pi</td>
<td> </td>
<td> </td>
<td>2.1</td>
<td> </td>
<td> </td>
<td> </td>
</tr>

<tr>
<td>Gate magnetic lock</td>
<td>0.25</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>

<tr>
<td><a href="https://wikidevi.wi-cat.ru/Netgear_ReadyNAS_3138">Network Attached Storage</a></td>
<td> </td>
<td> </td>
<td> </td>
<td>40</td>
<td>100</td>
<td>Built-in ATX power supply is 180W but real power draw has not exceeded 100W</td>
</tr>

<tr>
<td>Network Video Recorder</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>40</td>
<td>Boost converter to 48V</td>
</tr>

<tr>
<td>Security Cameras (total)</td>
<td>0.75</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>

<tr>
<td>Miscelaneous (ie. rack fan)</td>
<td> </td>
<td>0.5</td>
<td>0.5</td>
<td> </td>
<td> </td>
<td> </td>
</tr>
</tbody>
<tbody>
<tr>
<td>Total</td>
<td>2.49</td>
<td>10.54</td>
<td>2.6</td>
<td>40</td>
<td>161</td>
<td> </td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org4024310">
<h4 id="org4024310"><span>1.0.3.</span> Capacity planning for power buses</h4>
<div id="text-1-0-3">
<p>
We take into account an efficiency of 0.8 for the buck converters and assume that the lowest battery voltage will be 11.2V which corresponds to the BMS cutoff voltage of 
2.8V per cell (11.2V = 3 * 2.8V).
</p>

<table id="org4b4b1bc">
<caption><span>Table 2:</span> Maximum current and power values for each bus</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Bus</th>
<th scope="col">Voltage [V]</th>
<th scope="col">Max current [A]</th>
<th scope="col">Max power [W]</th>
<th scope="col">V<sub>rail</sub> load on batt power [A]</th>
<th scope="col">V<sub>rail</sub> load on AC power [A]</th>
</tr>
</thead>
<tbody>
<tr>
<td>12 V</td>
<td>12</td>
<td>10.54</td>
<td>126.48</td>
<td>14.116071</td>
<td>5.02</td>
</tr>

<tr>
<td>5 V</td>
<td>5</td>
<td>2.6</td>
<td>13.</td>
<td>1.4508929</td>
<td>0.4375</td>
</tr>

<tr>
<td>Direct</td>
<td> </td>
<td> </td>
<td>161</td>
<td>14.375</td>
<td>6.7083333</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Total</td>
<td> </td>
<td> </td>
<td>300.48</td>
<td>29.941964</td>
<td>12.165833</td>
</tr>
</tbody>
</table>

<p>
All of the above calculations allow us to select:
</p>

<ul>
<li>internal wiring cross-section (AWG)</li>
<li>internal and external connector types</li>
<li>fuses</li>
<li>buck converters maximum power and current</li>
<li>AC power supply maximum power and current</li>
</ul>

<p>
An AC power supply with at least 300W is needed to power the loads with some room needed to charge the battery. For this reason a 400W power supply has been selected
(see summary in BOM).
</p>
</div>
</div>

<div id="outline-container-orgc80cb0b">
<h4 id="orgc80cb0b"><span>1.0.4.</span> Solid-state operation</h4>
<div id="text-1-0-4">
<p>
Instead of the previously used relay-based power path switching scheme a solid-state power switch based on MOSFETs driven by the LTC4416 PowerPath controller will be used.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/ideal-diode.svg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/ideal-diode.png" alt="ideal-diode.png"/></a>
</p>
</div>
</div>

<div id="outline-container-org2fbe1ab">
<h4 id="org2fbe1ab"><span>1.0.5.</span> Modularity</h4>
<div id="text-1-0-5">
<p>
One disadvantage of the previous Secondlife UPS design was the fact that the front connectors where loads can be powered were placed on hand-made breadboard PCBs.
After some thought I have decided that this approach makes the design hard to replicate and adapt. To improve this I designed a number of standard sized PCBs that
host common load connectors and fuse sockets. All of the PCBs fit into cutouts in Ethernet switch enclosures hosting 4x2 Ethernet ports. This is the most common
cutout size in an Ethernet switch and it allows a user to mix and match modules based on their needs. Currently the available modules include:
</p>

<ul>
<li>a fanout with 8 x DEGSON 13EDGVC-3.5 pluggable load connectors with a power indicator LED, this module is designed to power low-power loads</li>
<li>a fanout with 6 x XT-60 pluggable load connectors with a power indicator LED, this module is designed to power high-power loads</li>
<li>a fuse module containing two fuse sockets accepting typical 5x20mm glass fuses</li>
<li>a fuse module containing one fuse socket accepting a 6.3mmx32mm glass fuse</li>
</ul>

<p>
All of these modules share a common mechanical design and can be used to build many types of front panel layouts. If the project is successful I&#39;m planning to
design other modules such as a PoE injector or a battery SoC (State of Charge) indicator module. Another future improvement idea is a 3D-printable drilling guide
which will help with precision while drilling mounting holes in the enclosure.
</p>

<p>
As an example in the Secondlife UPS described in this document the following modules are mounted on a long (48 port) cutout in the enclosure:
</p>

<ul>
<li>one fanout with 8 x DEGSON 13EDGVC-3.5 pluggable load connectors module powered by the 5V bus</li>
<li>one fanout with 8 x DEGSON 13EDGVC-3.5 pluggable load connectors module powered by the 12V bus</li>
<li>one fuse module containing two fuse sockets accepting typical 5x20mm glass fuses protecting the 12V and 5V buses</li>
<li>one fanout with 6 x XT-60 pluggable load connectors module powered by the V<sub>rail</sub> bus</li>
<li>one fuse module containing one fuse socket accepting a 6.3mmx32mm glass fuse protecting the V<sub>rail</sub> bus</li>
</ul>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/assembled-front-panel.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-assembled-front-panel.jpg" alt="thumb-assembled-front-panel.jpg"/></a>
</p>

<p>
The exposed through-hole component leads have been covered with hot glue. In the future dedicated 3D-printable plastic covers might be introduced for
each specific module which can be screwed on to improve the aesthetics.
</p>
</div>
</div>
</div>

<div id="outline-container-org8a07f73">
<h2 id="org8a07f73"><span>2.</span> Overall schematics</h2>
<div id="text-2">
<p>
The overall schematics of the UPS. Some modules (for example the ideal diode circuit or the BMS) are drawn on a conceptual level only.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/hw.svg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/hw.png" alt="hw.png"/></a>
</p>
</div>
</div>

<div id="outline-container-orgf284c12">
<h2 id="orgf284c12"><span>3.</span> Build instructions</h2>

<div id="outline-container-org716cb19">
<h3 id="org716cb19"><span>3.1.</span> Planning</h3>
<div id="text-3-1">
<p>
As the initial step all of the parts need to be placed in the enclosure to check if everything will fit, plan overall wiring and airflow.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/initial-placement.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-initial-placement.jpg" alt="thumb-initial-placement.jpg"/></a>
</p>

<p>
Please note, that the cells should be placed in the cell holders or mock cells need to be used to plan the layout.
</p>
</div>
</div>

<div id="outline-container-orgf673711">
<h3 id="orgf673711"><span>3.2.</span> Enclosure preparation</h3>
<p>
The steps below describe the preparation of an empty 19″ 1U enclosure for placement of UPS submodules. Most internal components from the device that you
are reusing should be removed, some like AC sockets, grounding lugs or fans can be left in the case.
</p>

<div id="outline-container-org9f55005">
<h4 id="org9f55005"><span>3.2.1.</span> Stud removal</h4>
<div id="text-3-2-1">
<p>
After placing the batteries, AC power supply, DC-DC converters, BMS and other components some studs will need to be removed:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/studs-removed.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-studs-removed.jpg" alt="thumb-studs-removed.jpg"/></a>
</p>

<p>
Some notes on the process:
</p>

<ul>
<li>Thoroughly deburr the corners of the drilled holes with a deburring tool or a Dremel. Leftover burrs can damage 18650 cell insulation sleeves and cause a short.</li>
<li>Drill with a 5mm metal drill</li>
<li>Drill from the bottom of the case</li>
<li>Use a puncturing tool for easier drilling. A cheap one can be bought for 2-3 EUR.</li>
<li>Support the chassis with 40mmx40mm wood cubes to prevent bending</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org504f48e">
<h3 id="org504f48e"><span>3.3.</span> Front panel assembly</h3>
<div id="text-3-3">
<p>
As described before the front panel is built up out of modular PCBs screwed to the front of the enclosure with screws and nuts.
</p>

<p>
The module PCBs have M2.5 screw holes drilled and in my case I used M2.5 x 8mm screws, washers and nuts to attach the modules. Each module covers the space of
4x2 RJ45 ports which is a typical cutout size for Ethernet switches.
</p>

<p>
Plan your layout first taking into consideration the routing of internal wires and other components like the power supply and batteries which can be pretty big.
Plan for some clearance between elements.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/layout.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-layout.jpg" alt="thumb-layout.jpg"/></a>
</p>

<p>
Usually the front of the enclosure can be detached from the rest of the case and this should be done first.
</p>

<p>
Tools needed for attaching the modules to the enclosure front:
</p>
<ul>
<li>drill press (optimal)</li>
<li>hand drill (usable)</li>
<li>a 3mm metal drill</li>
<li>dremel or <a href="https://www.mcmaster.com/products/deburring-tools/">deburring tool</a></li>
<li>hole punch</li>
<li>sharp pen for hole marking</li>
</ul>

<p>
The module PCBs can be placed inside or outside the front panel assembly depending on how the front panel latches onto the rest of the enclosure.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/mount-inside.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-mount-inside.jpg" alt="thumb-mount-inside.jpg"/></a>
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/mount-outside.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-mount-outside.jpg" alt="thumb-mount-outside.jpg"/></a>
</p>

<p>
In my case the PCBs needed to be mounted outside with screws pointing outwards in order for the enclosure front to fit the rest of the case. Test the
entire assembly process in order to be confident that there will be no problems later.
</p>
</div>

<div id="outline-container-org89a5d11">
<h4 id="org89a5d11"><span>3.3.1.</span> Mounting the main battery fuse</h4>
<div id="text-3-3-1">
<p>
The main battery fuse socket should be selected to handle the battery current and be easily mountable in the enclosure. The most practical sockets are those
that can be mounted with just round holes. The fuse selected needs to be a DC fuse rated for the voltage that the battery operates on. Those types of fuses
can be often found distributed under the &#34;solar&#34; or PV categories. The fuse that I used in my build is linked in the BOM at the end. As the fuse socket is
pretty large, care needs to be taken to drill the main mounting hole exactly on the center of the back plane.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/fuse-socket-marked.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-fuse-socket-marked.jpg" alt="thumb-fuse-socket-marked.jpg"/></a> 
</p>

<p>
In my socket, M4 screws were used for mounting, 22mm hole was drilled with a step drill. Remember about lubricant, my <a href="https://www.metabo.com/com/en/tools/cordless-tools/screwdriving-drilling-chiselling-stirring/cordless-drills-screwdrivers/powermaxx-bs-12-bl-q-601045800-cordless-drill-screwdriver.html?listtype=search&amp;searchparam=BS%2B12">Metabo BS 12 BL Q</a> 20 Nm cordless drill
was struggling a bit but you can do it with some patience.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/fuse-socket-mounted1.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-fuse-socket-mounted1.jpg" alt="thumb-fuse-socket-mounted1.jpg"/></a>
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/fuse-socket-mounted2.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-fuse-socket-mounted2.jpg" alt="thumb-fuse-socket-mounted2.jpg"/></a>
</p>
</div>
</div>
</div>

<div id="outline-container-org24b0daf">
<h3 id="org24b0daf"><span>3.4.</span> Circuit assembly</h3>
<div id="text-3-4">
<p>
The BMS, ideal diode circuit and DC-DC converters are mounted on a baseplate made from a prototype PCB using some of the leftover studs in the enclosure:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/circuit-baseboard.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-circuit-baseboard.jpg" alt="thumb-circuit-baseboard.jpg"/></a>
</p>

<p>
All of the other modules can be then mounted either with either screws or doublesided tape:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/circuit-mounted-modules.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-circuit-mounted-modules.jpg" alt="thumb-circuit-mounted-modules.jpg"/></a>
</p>
</div>
</div>

<div id="outline-container-org3ddc7b0">
<h3 id="org3ddc7b0"><span>3.5.</span> Battery assembly</h3>

<div id="outline-container-orge346f5c">
<h4 id="orge346f5c"><span>3.5.1.</span> Battery cell selection</h4>
<div id="text-3-5-1">
<p>
The 18650 cells used for the making of the battery pack can be new or refurbished from e-bike, cordless tools, old laptop batteries or other sources. Consult
more specialised forums like <a href="https://secondlifestorage.com/index.php">Secondlife storage</a> for tips on selecting, obtaining and testing reused 18650 cells. Two critical points to keep in mind are:
</p>

<ul>
<li>always check the specifications for the cells you are using (find and read datasheets) so as not to exceed current or voltage limits</li>
<li>measure and match the discharge capacity and internal resistance of the cells in a battery pack to be as close as possible</li>
</ul>
</div>
</div>

<div id="outline-container-orgf08c2ad">
<h4 id="orgf08c2ad"><span>3.5.2.</span> Nickel strip thickness calculations</h4>
<div id="text-3-5-2">
<p>
The battery will be built by welding nickel strips onto the cells in a certain pattern. The basis of the calculation of the required width of the nickel strips is the
following table. Unfortunately the exact methodology of how these numbers have been obtained is unclear but it&#39;s the best data I have found so far:
</p>

<table>
<caption><span>Table 3:</span> Nickel strip current carrying capacity</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Strip size</th>
<th scope="col">Optimal [A]</th>
<th scope="col">Acceptable [A]</th>
<th scope="col">Poor [A]</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.1mm x 5mm</td>
<td>&lt; 2.1</td>
<td>3.0</td>
<td>&gt; 4.2</td>
</tr>

<tr>
<td>0.1mm x 7mm</td>
<td>&lt; 3.0</td>
<td>4.5</td>
<td>&gt; 6.0</td>
</tr>

<tr>
<td>0.15mm x 7mm</td>
<td>&lt; 4.7</td>
<td>7.0</td>
<td>&gt; 9.4</td>
</tr>

<tr>
<td>0.2mm x 7mm</td>
<td>&lt; 6.4</td>
<td>9.6</td>
<td>&gt; 12.8</td>
</tr>

<tr>
<td>0.3mm x 7mm</td>
<td>&lt; 10.0</td>
<td>15</td>
<td>&gt; 20.0</td>
</tr>
</tbody>
</table>

<p>
<a href="https://cellsaviors.com/blog/how-to-size-wire-fuses-and-nickel-strip-for-a-lithium-battery-pack">Reference</a>
</p>

<p>
As previously calculated, the maximum battery current will be around 30A during discharge therefore the current collectors at the battery terminals need to use 
two 0.3mm strips. Additionally, the strips that I am using are 8mm wide not 7mm wide giving some headroom for current capacity.
</p>
</div>
</div>

<div id="outline-container-orgb6b8b17">
<h4 id="orgb6b8b17"><span>3.5.3.</span> Welding the cells</h4>
<div id="text-3-5-3">
<p>
The general approach is to connect the cells together with 8mm wide nickel strips using spot welding. In order to facilitate cell voltage verification and equalization
within each of the 24P blocks first only one side of the block (the positive cell terminals in my case) is welded first, then cells charge is equalized and then the second 
cell terminals (negative cell terminals in my case) are welded together. Most welds are performed with 0.1mm and 0.12mm nickel strips but the terminal connections for the 
entire battery are built out of 0.3mm strips for designed current capacity.
</p>

<p>
A welding jig is used to keep the cells in place during welding. Such a jig can be purchased or manufactured by yourself as it&#39;s simply a set of four pieces of wood
with a long slot cut alongside their length. The design for such a jig can be found below:
</p>


<p><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/welding-jig.svg" alt="welding-jig.svg"/>
</p>

<p>
The cells for each of the four 24P blocks are inserted into 4x2 cell holders refurbished from old &#34;hoverboard&#34; battery packs and aligned using the jig.
This is recommended as the welded nickel strips cannot be used as the only mechanical support for the cells:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/cells-inside-jig.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-cells-inside-jig.jpg" alt="thumb-cells-inside-jig.jpg"/></a>
</p>

<p>
Nickel strips are secured to the cells using small neodymium magnets to not move during the welding process:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/cell-tacking-magnets.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-cell-tacking-magnets.jpg" alt="thumb-cell-tacking-magnets.jpg"/></a>
</p>

<p>
The strips are welded to the cells using a <a href="https://www.keenlab.de/">kWeld from Keenlab</a> spot welder powered by a <a href="https://www.lrp.cc/en/product/hv-stock-spec-graphene-3-7300mah-hardcase-battery-76v-lipo-130c65c-1/">HV Stock Spec GRAPHENE-3 7300mAh Hardcase battery - 7.6V LiPo - 130C/65C</a>.
The effect of welding both 0.1mm and 0.12mm thickness strips that connect the cells can be seen below:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/cells-welded-first-side.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-cells-welded-first-side.jpg" alt="thumb-cells-welded-first-side.jpg"/></a>
</p>

<p>
The cells in all four 24P blocks are first checked with a voltmeter and if some of them have self-discharged below 4V they are charged individually. I use a DIY &#34;charger&#34;
which connects together 5 cheap &#34;Li-Ion charger&#34; modules based around the popular <a href="https://octopart.com/tp4056x-42-esop8-toppower-125439323?r=sp">TP4056</a> chip. 
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/cells-equalized.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-cells-equalized.jpg" alt="thumb-cells-equalized.jpg"/></a>
</p>

<p>
The strips used for terminal current collectors (providing the positive and negative for the entire battery) are longer than the length of the block to be bent together
and soldered to 4mm² wires.
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/terminal-current-collectors.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-terminal-current-collectors.jpg" alt="thumb-terminal-current-collectors.jpg"/></a>
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/terminal-wire-soldered.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-terminal-wire-soldered.jpg" alt="thumb-terminal-wire-soldered.jpg"/></a>
</p>

<p>
After all blocks are welded and equalized they are aligned side-by-side in the welding jig and connected with more 0.1mm/0.12mm strips. This process can be seen below. Care needs
to be taken at this stage in order to properly orient the blocks taking into account the polarity as well as final wiring in the enclosure. A quick photo summary of
these steps can be found below:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/blocks-inside-jig.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-blocks-inside-jig.jpg" alt="thumb-blocks-inside-jig.jpg"/></a>
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/interblock-nickel-strips.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-interblock-nickel-strips.jpg" alt="thumb-interblock-nickel-strips.jpg"/></a>
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/interblock-nickel-strips-welded.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-interblock-nickel-strips-welded.jpg" alt="thumb-interblock-nickel-strips-welded.jpg"/></a>
</p>

<p>
Additional tips on the cell welding process are:
</p>

<ul>
<li>take some old cells and practice welding settings and technique with different nickel strip thickness before starting to weld the battery</li>
<li>as a rule of thumb for a proper weld, when you pull off the strip from the cell there should be a hold left in the strip, in other words the weld should be stronger than
the nickel strip itself</li>
<li>keep the cells and nickel strip clean (degrease with isopropyl alcohol if required) and use work cotton gloves during assembly</li>
<li>for best results use pure nickel strips, some places sell nickel plated steel strips which are cheaper but have more resistance</li>
</ul>
</div>
</div>

<div id="outline-container-org9a885d5">
<h4 id="org9a885d5"><span>3.5.4.</span> Attaching voltage sense wires</h4>
<div id="text-3-5-4">
<p>
The voltage sense wires are soldered to allow the BMS to measure the voltage for each 24P block and react accordingly when voltage limits are reached:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/voltage-sense-wires.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-voltage-sense-wires.jpg" alt="thumb-voltage-sense-wires.jpg"/></a>
</p>
</div>
</div>

<div id="outline-container-orgf3a044c">
<h4 id="orgf3a044c"><span>3.5.5.</span> Final assembly</h4>
<div id="text-3-5-5">
<p>
The final assembly involves isolating and securing all exposed nickel strips and wires with electrical tape:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/blocks-isolation.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-blocks-isolation.jpg" alt="thumb-blocks-isolation.jpg"/></a>
</p>

<p>
After this the pack is bent into a flat shape:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/flattened-battery-pack.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-flattened-battery-pack.jpg" alt="thumb-flattened-battery-pack.jpg"/></a>
</p>

<p>
This allows the pack to be slided into the enclosure:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/battery-pack-inserted.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-battery-pack-inserted.jpg" alt="thumb-battery-pack-inserted.jpg"/></a>
</p>
</div>
</div>

<div id="outline-container-org00ff5ac">
<h4 id="org00ff5ac"><span>3.5.6.</span> Attaching thermal fuses</h4>
<div id="text-3-5-6">
<p>
During battery assembly sense wires and thermal fuses are attached. 4 thermal fuses connected in series are 60°C Normally-Connected fuses. They are attached to
the battery cells using a thermally conductive glue. Magnets are used to secure the sensors as the glue takes around 24h to fully solidify. 
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/thermal-fuses.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-thermal-fuses.jpg" alt="thumb-thermal-fuses.jpg"/></a>
</p>
</div>
</div>

<div id="outline-container-org17c466d">
<h4 id="org17c466d"><span>3.5.7.</span> Battery Management System</h4>
<p>
The BMS used with the battery pack is a <a href="https://www.aliexpress.com/item/1005002066419577.html">EGBO Store 4S/100A</a> based on the <a href="https://pdf1.alldatasheet.com/datasheet-pdf/view/1253599/ETC1/BM3451.html">BM3451</a> made by BYD. Apart from ordinary battery protection from overvoltage, undervoltage,
overcurrent, etc. it can detect the disconnection of sense wires and shut the pack down in such an instance. This feature is used to both connect thermal fuses
to the battery as well as a &#34;Battery cutoff&#34; switch on the front panel. Both of these work by breaking the connection of one of the voltage sense wires causing
the BMS to stop charging or discharging the battery.
</p>
</div>
</div>
</div>

<div id="outline-container-org66f859d">
<h2 id="org66f859d"><span>4.</span> Final assembly photo</h2>
<div id="text-4">
<p>
The final UPS assembled before the chassis being closed:
</p>


<p><a href="https://pop.fsck.pl/projects/secondlife-ups-MkII/final-assembly.jpg"><img src="https://pop.fsck.pl/projects/secondlife-ups-MkII/thumb-final-assembly.jpg" alt="thumb-final-assembly.jpg"/></a>
</p>
</div>
</div>

<div id="outline-container-orgd48be7f">
<h2 id="orgd48be7f"><span>5.</span> Bill of Materials</h2>
<div id="text-5">
<ul>
<li>Shipping costs and taxes are not included.</li>
<li>All prices are in EUR.</li>
</ul>

<table>
<caption><span>Table 4:</span> Bill of Materials</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Item</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
<th scope="col">Unit</th>
<th scope="col">Amount</th>
<th scope="col">Price per unit [EUR]</th>
<th scope="col">Line total [EUR]</th>
<th scope="col">Purchase date</th>
<th scope="col">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Battery cells</td>
<td>Various</td>
<td>Li-Ion 3.6V 18650 Cells</td>
<td>pcs</td>
<td>96</td>
<td>0</td>
<td>0</td>
<td>N/A</td>
<td>From existing stock</td>
</tr>

<tr>
<td>AC Power supply</td>
<td><a href="https://www.aliexpress.com/item/32950139524.html">Coleen CB-400W-24V</a></td>
<td>AC 230V, 24V/16.6A</td>
<td>pcs</td>
<td>1</td>
<td>19.9</td>
<td>19.9</td>
<td><span><span>&lt;2023-04-07 pią&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>Battery fuse socket</td>
<td><a href="https://www.tme.eu/pl/katalog/gniazda-bezpiecznikowe-na-panel_113040/?art=PMG-KB-01-Q2S">PMG-KB-01-Q2S</a></td>
<td>Fuse holder; 10.3x38.1mm; 30A; on panel; Cutout: Ø22.4mm; UL94V-1</td>
<td>pcs</td>
<td>1</td>
<td>8.77</td>
<td>8.77</td>
<td><span><span>&lt;2023-04-07 pią&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>Battery fuse</td>
<td><a href="https://www.tme.eu/pl/en/details/0090.0030/fuses-10-3x38mm-fast/schurter/">0090.0030 SCHURTER</a></td>
<td>Fuse: fuse; gPV; 30A; 1kVDC; ceramic,cylindrical,industrial; ASO</td>
<td>pcs</td>
<td>1</td>
<td>8.68</td>
<td>8.68</td>
<td><span><span>&lt;2023-07-13 czw&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>12V Buck Converter</td>
<td><a href="https://www.aliexpress.com/item/1005002603980974.html">DN121</a></td>
<td>VOLTAGE REGULATOR 24V to 12V 10A DC/DC Converter Step Down Voltage Transformer Buck Regulator Voltage for Solar for LED</td>
<td>pcs</td>
<td>1</td>
<td>8.62</td>
<td>8.62</td>
<td><span><span>&lt;2023-03-15 śro&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>5V Buck Converter</td>
<td><a href="https://pl.aliexpress.com/item/1005004778421166.html">LM2596 Step Down Module</a></td>
<td>LM2596 Step Down Module DC to DC Adjustable Buck</td>
<td>pcs</td>
<td>1</td>
<td>3.00</td>
<td>3.</td>
<td><span><span>&lt;2023-03-15 śro&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>CC/CV Charger</td>
<td><a href="https://www.aliexpress.com/item/1005004153906058.html">XL4015</a></td>
<td>Efficient Adjustable 5A DC-DC Buck Module Constant Current Voltage Regulator Step Down Converter Charging Board 5V 12V 24V</td>
<td>pcs</td>
<td>1</td>
<td>2.31</td>
<td>2.31</td>
<td><span><span>&lt;2023-03-15 śro&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>Battery Management System</td>
<td><a href="https://www.aliexpress.com/item/1005002066419577.html">EGBO Store 4S/100A</a></td>
<td>3s 4s 5s Bms 12v 16.8v 21v 3.7v 100a Li-ion Lmo Ternary Lithium Battery Protection Circuit Board Li-polymer Balance Charging</td>
<td>pcs</td>
<td>1</td>
<td>2.27</td>
<td>2.27</td>
<td><span><span>&lt;2023-05-07 nie&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>Pluggable terminal blocks (sockets)</td>
<td><a href="https://www.tme.eu/Document/83e7173fe653a2d0e44585e87978945b/opr014R8.pdf">15EDGVC-3.5-02P-14-00A(H)</a></td>
<td>Pluggable terminal block; 3.5mm; ways: 2; straight; socket; male</td>
<td>pcs</td>
<td>16</td>
<td>0.19</td>
<td>3.04</td>
<td><span><span>&lt;2023-04-07 pią&gt;</span></span></td>
<td> </td>
</tr>

<tr>
<td>Pluggable terminal blocks (plugs)</td>
<td><a href="https://www.tme.eu/Document/580c900c7460c0af0ff973aec46ec4f5/15edgk.pdf">15EDGK-3.5-02P-14-00AH</a></td>
<td>Pluggable terminal block; 3.5mm; ways: 2; straight; plug; female</td>
<td>pcs</td>
<td>20</td>
<td>0.42</td>
<td>8.4</td>
<td><span><span>&lt;2023-04-07 pią&gt;</span></span></td>
<td>4 spare units</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Total</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>67.18</td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div id="postamble">

<p>Created: 2023-08-23 18:38</p>
<p><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div></div>
  </body>
</html>
