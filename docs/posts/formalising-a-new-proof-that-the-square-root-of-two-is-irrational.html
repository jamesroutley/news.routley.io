<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lawrencecpaulson.github.io//2023/01/18/Sqrt2_irrational.html">Original</a>
    <h1>Formalising a new proof that the square root of two is irrational</h1>
    
    <div id="readability-page-1" class="page"><section>

      
<p>18 Jan 2023</p>

<span>[
  
    
    <a href="https://lawrencecpaulson.github.io/tag/examples"><code><nobr>examples</nobr></code> </a>
  
    
    <a href="https://lawrencecpaulson.github.io/tag/newbies"><code><nobr>newbies</nobr></code> </a>
  
]</span>

<p>Recently, somebody shared on Twitter a 
<a href="https://theapproximatepresent.tumblr.com/post/51484587425/a-favourite-proof-of-mine-first-demonstrated-to">new proof</a> 
of the irrationality of √2. Its claimed advantage is that “it requires no knowledge of mathematics above the definition of what it means for a number to be irrational, and can be written almost in one line.” 
These claims are dubious: the 
usual proof, which I’ve formalised in a <a href="https://lawrencecpaulson.github.io/2022/05/04/baby-examples.html">previous post</a>,
requires only the natural numbers and 
the notion of divisibility.
The “beautiful” proof involves real numbers, 
potentially infinite sets and the nontrivial claim that the square root of two actually exists. 
Nevertheless, formalising it in Isabelle/HOL is an interesting exercise.
In particular, it illustrates reasoning about the least element of a set. So here we go.</p>

<p><img src="https://lawrencecpaulson.github.io/images/sqrt2-figure.jpg" alt="beautiful proof that sqrt 2 is irrational" width="800"/></p>



<p>Before we begin, it’s necessary to explain the meanings of the symbols ℕ, ℤ, ℚ, ℝ
in Isabelle/HOL. They denote sets, not types: namely, they denote the sets of natural numbers,
integers, rationals, real numbers (respectively) as <strong>images</strong> embedded in some larger type.
Here we are mostly going to work within type <code>real</code>, where ℕ and ℚ 
will denote sets of real numbers. Through the magic of <a href="https://lawrencecpaulson.github.io/2022/03/02/Type_classes.html">type classes</a>, 
these symbols denote the right set for other types, such as <code>complex</code>, 
<a href="https://www.isa-afp.org/entries/Quaternions.html">quaternions</a>
and any other types (including those yet to be defined) that inherit the necessary structure.</p>

<p>We need to be careful with types here. I’ve used the function <code>real</code>, which injects natural numbers into type <code>real</code>. Most numeric coercions can be omitted in Isabelle:
they are inserted automatically. 
But things are delicate in this example, so it’s better to be explicit.</p>

<h3 id="defining-r-and-k">Defining $R$ and $k$</h3>

<p>We begin with the theorem statement and the two definitions shown in the blackboard figure:</p>

<pre><span>proposition</span> <span><span><span>&#34;</span>sqrt</span> <span>2</span> <span>∉</span></span> <span>ℚ</span><span>&#34;</span><span>
</span><span>proof</span><span>
  </span><span>define</span> <span>R</span> <span>where</span> <span><span><span>&#34;</span><span>R</span> <span>≡</span> <span>{</span><span>n</span><span>.</span> <span>n</span> <span>&gt;</span></span> <span>0</span></span> <span>∧</span> real <span>n</span> <span>*</span> sqrt <span>2</span> <span>∈</span> <span>ℕ</span><span>}</span><span>&#34;</span><span>
  </span><span>define</span> <span>k</span> <span>where</span> <span><span><span>&#34;</span><span>k</span> <span>≡</span> Inf</span> <span>R</span><span>&#34;</span></span>
</pre>

<p>Already an error: 0 is a natural number,
but it needs to be excluded from the set $R$ because otherwise $k=0$
and the argument falls apart.</p>

<p>The traditional proof of irrationality begins by claiming
that there are no integers $p$ and $q$ such that $(\frac{p}{q})^2 = 2$.
The proof involves simply showing that both $p$ and $q$ would have to be even numbers,
while every rational number can be written in the form $\frac{p}{q}$ where $p$ and $q$ 
are coprime.
We could even make a distinction between the rational number $\frac{p}{q}$
and the real quotient $p/q$ in order to prove the theorem in the absence of the reals.</p>

<p>Our proof today begins by finding $p$ and $q$ such that $p/q = \sqrt2$.</p>

<pre>  <span>assume</span> <span><span><span>&#34;</span>sqrt</span> <span>2</span> <span>∈</span></span> <span>ℚ</span><span>&#34;</span><span>
  </span><span>then</span> <span>obtain</span> <span>p</span> <span>q</span> <span>where</span> <span><span><span>&#34;</span><span>q</span><span>≠</span></span><span>0</span></span><span>&#34;</span> <span><span><span>&#34;</span>real</span> <span>p</span> <span>/</span></span> real <span>q</span> <span>=</span> <span>¦</span>sqrt <span>2</span><span>¦</span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>metis</span> Rats_abs_nat_div_natE<span>)</span><span>
  </span><span>then</span> <span>have</span> <span><span><span>&#34;</span><span>R</span> <span>≠</span></span> <span>{}</span></span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> R_def <span>field_simps</span><span>)</span> <span>(</span><span>metis</span> of_nat_in_Nats<span>)</span><span>
  </span><span>then</span> <span>have</span> <span><span><span>&#34;</span><span>k</span> <span>∈</span></span> <span>R</span><span>&#34;</span></span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> Inf_nat_def1 k_def<span>)</span><span>
  </span><span>then</span> <span>have</span> kR<span>:</span> <span><span><span>&#34;</span>real</span> <span>k</span> <span>*</span></span> sqrt <span>2</span> <span>∈</span> <span>ℕ</span><span>&#34;</span> <span>and</span> <span><span><span>&#34;</span><span>k</span> <span>&gt;</span></span> <span>0</span></span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>auto</span> <span>simp</span> <span>add</span><span>:</span> R_def<span>)</span>
</pre>

<p>We have already defined $k$ to be the infimum of $R$, but for this to be useful
we need to show that the set $R$ is nonempty. It then follows that
$k$ belongs to $R$ and satisfies its characteristic properties.</p>

<h3 id="defining-k">Defining $k’$</h3>

<p>The informal proof takes advantage of the typelessness of traditional mathematics
(apologies to those offended) by writing the real number $k(\sqrt2-1)$
and showing it to be a natural number: a seamless transition.
The Isabelle script begins by calling this quantity $x$ and then,
having shown it to belong to ℕ, obtains the corresponding natural number: $k’$.
Looking at blackboard carefully, we can see that a few steps have been skipped.</p>

<pre>  <span>define</span> <span>x</span> <span>where</span> <span><span><span>&#34;</span><span>x</span> <span>≡</span> real</span> <span>k</span> <span>*</span></span> <span>(</span>sqrt <span>2</span> <span>-</span> <span>1</span><span>)</span><span>&#34;</span><span>
  </span><span>have</span> <span><span><span>&#34;</span><span>x</span> <span>∈</span></span> <span>ℕ</span></span><span>&#34;</span><span>
    </span><span>using</span> <span><span><span>‹</span><span>0</span></span> <span>&lt;</span></span> <span>k</span><span>›</span> <span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> kR right_diff_distrib&#39; x_def<span>)</span><span>
  </span><span>then</span> <span>obtain</span> <span>k&#39;</span> <span>where</span> k&#39;<span>:</span> <span><span><span>&#34;</span><span>x</span> <span>=</span></span> real</span> <span>k&#39;</span><span>&#34;</span><span>
    </span><span>using</span> Nats_cases <span>by</span> <span>blast</span><span>
  </span><span>have</span> <span><span><span>&#34;</span><span>k&#39;</span> <span>&gt;</span></span> <span>0</span></span><span>&#34;</span><span>
    </span><span>using</span> <span><span><span>‹</span><span>0</span></span> <span>&lt;</span></span> <span>k</span><span>›</span> k&#39; of_nat_eq_0_iff x_def <span>by</span> <span>fastforce</span>
</pre>

<h3 id="showing-kin-r">Showing $k’\in R$</h3>

<p>We have already shown that $k’&gt;0$, but the nontrivial part of our task
is the third line of the blackboard proof. Breaking it up into stages as shown
keeps the proof justifications simple.
We could skip some steps, when <a href="https://lawrencecpaulson.github.io/2022/04/13/Sledgehammer.html">Sledgehammer</a> 
would obligingly find a monster proof.</p>

<pre>  <span>have</span> <span><span><span>&#34;</span>real</span> <span>k&#39;</span> <span>*</span></span> sqrt <span>2</span> <span>=</span> <span>2</span> <span>*</span> <span>k</span> <span>-</span> <span>k</span> <span>*</span> sqrt <span>2</span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> x_def <span>algebra_simps</span> <span>flip</span><span>:</span> k&#39;<span>)</span><span>
  </span><span>moreover</span> <span>have</span> <span><span><span>&#34;</span>real</span> <span>k&#39;</span> <span>*</span></span> sqrt <span>2</span> <span>≥</span> <span>0</span><span>&#34;</span><span>
    </span><span>by</span> <span>simp</span><span>
  </span><span>ultimately</span> <span>have</span> <span><span><span>&#34;</span>real</span> <span>k&#39;</span> <span>*</span></span> sqrt <span>2</span> <span>∈</span> <span>ℕ</span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> kR<span>)</span><span>
  </span><span>with</span> R_def <span><span><span>‹</span><span>0</span></span> <span>&lt;</span></span> <span>k&#39;</span><span>›</span> <span>have</span> <span><span><span>&#34;</span><span>k&#39;</span> <span>∈</span></span> <span>R</span><span>&#34;</span></span><span>
    </span><span>by</span> <span there="operator">blast</span>
</pre>

<h3 id="finishing-up">Finishing up</h3>

<p>Once we can show $k’&lt;k$, the result follows by the minimality of $k$.</p>

<pre>  <span>have</span> <span><span><span>&#34;</span><span>x</span> <span>&lt;</span></span> real</span> <span>k</span><span>&#34;</span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> <span><span><span>‹</span><span>0</span></span> <span>&lt;</span></span> <span>k</span><span>›</span> sqrt2_less_2 x_def<span>)</span><span>
  </span><span>then</span> <span>have</span> <span><span><span>&#34;</span><span>k&#39;</span> <span>&lt;</span></span> <span>k</span><span>&#34;</span></span><span>
    </span><span>by</span> <span>(</span><span>simp</span> <span>add</span><span>:</span> k&#39;<span>)</span><span>
  </span><span>then</span> <span>show</span> <span>False</span><span>
    </span><span>using</span> <span><span><span>‹</span><span>k&#39;</span> <span>∈</span></span> <span>R</span><span>›</span></span> k_def linorder_not_less wellorder_Inf_le1 <span>by</span> <span>auto</span><span>
</span><span>qed</span>
</pre>

<p>The Isabelle theory file is <a href="https://lawrencecpaulson.github.io/Isabelle-Examples/Sqrt2_Irrational.thy">available to download</a>.</p>

<h3 id="postscript">Postscript</h3>

<p>This proof assumes a more sophisticated background theory 
than the traditional one, which would have been a problem 30 years ago
when few proof assistants supported the real numbers.
A couple of Isabelle formalisations of the traditional proof 
<a href="https://isabelle.in.tum.de/dist/library/HOL/HOL-Examples/Sqrt.html">are available</a>
and it’s up to you to decide which approach is clearer.</p>

<p>A <a href="https://lawrencecpaulson.github.io/2022/06/08/baby-descriptions.html">previous post</a> 
discussed reasoning about the least element in the more general context
of descriptions, but this example came from the wild (Twitter, anyway).</p>







      


    </section></div>
  </body>
</html>
