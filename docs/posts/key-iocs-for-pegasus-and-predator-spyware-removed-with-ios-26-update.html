<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://iverify.io/blog/key-iocs-for-pegasus-and-predator-spyware-cleaned-with-ios-26-update">Original</a>
    <h1>Key IOCs for Pegasus and Predator Spyware Removed with iOS 26 Update</h1>
    
    <div id="readability-page-1" class="page"><div data-framer-name="Post Body" data-framer-component-type="RichTextContainer"><p>As iOS 26 is being rolled out, our team noticed a particular change in how the operating system handles the shutdown.log file: it effectively erases crucial evidence of Pegasus and Predator spyware infections. This development poses a serious challenge for forensic investigators and individuals seeking to determine if their devices have been compromised at a time when spyware attacks are becoming more common.</p><h3><strong></strong></h3><p>For years, the shutdown.log file has been an invaluable, yet often overlooked, artifact in the detection of iOS malware. Located within the Sysdiagnoses in the Unified Logs section (specifically, Sysdiagnose Folder -&gt; system_logs.logarchive -&gt; Extra -&gt; shutdown.log), it has served as a silent witness to the activities occurring on an iOS device, even during its shutdown sequence.</p><p>In 2021, the <!--$--><a href="https://securelist.com/shutdown-log-lightweight-ios-malware-detection-method/111734/" rel="noopener">publicly known version</a><!--/$--> of Pegasus spyware was found to leave discernible traces within this shutdown.log. These traces provided a critical indicator of compromise, allowing security researchers to identify infected devices. However, the developers behind Pegasus, NSO Group, are constantly refining their techniques, and by 2022 Pegasus had evolved.</p><h3><strong></strong></h3><p>While still leaving evidence in the shutdown.log, their methods became more sophisticated. Instead of leaving obvious entries, they began to completely wipe the shutdown.log file. Yet, even with this attempted erasure, their own processes still left behind subtle traces. This meant that even a seemingly clean shutdown.log that began with evidence of a Pegasus sample was, in itself, an indicator of compromise. Multiple cases of this behavior were observed until the end of 2022, highlighting the continuous adaptation of these malicious actors.</p><p>Following this period, it is believed that Pegasus developers implemented even more robust wiping mechanisms, likely monitoring device shutdown to ensure a thorough eradication of their presence from the shutdown.log. Researchers have noted instances where devices known to be active had their shutdown.log cleared, alongside other IOCs for Pegasus infections. This led to the conclusion that a cleared shutdown.log could serve as a good heuristic for identifying suspicious devices.</p><h3><strong></strong></h3><p>The sophisticated Predator spyware, observed in 2023, also appears to have learned from the past. Given that Predator was actively monitoring the shutdown.log, and considering the similar behavior seen in earlier Pegasus samples, it is highly probable that Predator, too, left traces within this critical log file.</p><h3><strong></strong></h3><p><img alt="" width="960" height="612" src="https://framerusercontent.com/images/80Bnh5BpBJdOKHBVErHNnmlYARM.png?width=1920&amp;height=1224" srcset="https://framerusercontent.com/images/80Bnh5BpBJdOKHBVErHNnmlYARM.png?scale-down-to=512&amp;width=1920&amp;height=1224 512w,https://framerusercontent.com/images/80Bnh5BpBJdOKHBVErHNnmlYARM.png?scale-down-to=1024&amp;width=1920&amp;height=1224 1024w,https://framerusercontent.com/images/80Bnh5BpBJdOKHBVErHNnmlYARM.png?width=1920&amp;height=1224 1920w" data-framer-original-sizes="" sizes="(min-width: 1200px) 100vw, (min-width: 810px) and (max-width: 1199.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>With iOS 26 Apple introduced a change—either an intentional design decision or an unforeseen bug—that causes the shutdown.log to be overwritten on every device reboot instead of appended with a new entry every time, preserving each as its own snapshot. This means that any user who updates to iOS 26 and subsequently restarts their device will inadvertently erase all evidence of older Pegasus and Predator detections that might have been present in their shutdown.log.</p><p>This automatic overwriting, while potentially intended for system hygiene or performance, effectively sanitizes the very forensic artifact that has been instrumental in identifying these sophisticated threats. It could hardly come at a worse time - spyware attacks have been a constant in the news and recent headlines show that high-power executives and celebrities, not just civil society, are being targeted.</p><h3><strong></strong></h3><p>For those still on iOS versions prior to 26, a specific IOC for Pegasus 2022 infections involved the presence of a /private/var/db/com.apple.xpc.roleaccountd.staging/com.apple.WebKit.Networking entry within the shutdown.log. This particular IOC also revealed a significant shift in NSO Group&#39;s tactics: they began using normal system process names instead of easily identifiable, similarly named processes, making detection more challenging.</p><p><img alt="An image of a shutdown.log file" width="960" height="287" src="https://framerusercontent.com/images/ba34Gafw8AOzzYHAvI4gRLzfPw.png?width=1920&amp;height=574" srcset="https://framerusercontent.com/images/ba34Gafw8AOzzYHAvI4gRLzfPw.png?scale-down-to=512&amp;width=1920&amp;height=574 512w,https://framerusercontent.com/images/ba34Gafw8AOzzYHAvI4gRLzfPw.png?scale-down-to=1024&amp;width=1920&amp;height=574 1024w,https://framerusercontent.com/images/ba34Gafw8AOzzYHAvI4gRLzfPw.png?width=1920&amp;height=574 1920w" data-framer-original-sizes="" sizes="(min-width: 1200px) 100vw, (min-width: 810px) and (max-width: 1199.98px) 100vw, (max-width: 809.98px) 100vw"/></p><h3><strong></strong></h3><p>For devices running iOS 18 or earlier, a more comprehensive approach to detection involved correlating containermanagerd log entries with shutdown.log events. Containermanagerd logs contain boot events and can retain data for several weeks. By comparing these boot events with shutdown.log entries, investigators could identify discrepancies. For example, if numerous boot events were observed before shutdown.log entries, it suggested that something was amiss and potentially being hidden.</p><h3><strong></strong></h3><p>Given the implications of iOS 26&#39;s shutdown.log handling, it is crucial for users to take proactive steps:</p><ul><li data-preset-tag="p"><p><strong>Before updating to iOS 26, immediately take and save a sysdiagnose of your device.</strong> This will preserve your current shutdown.log and any potential evidence it may contain.</p></li><li data-preset-tag="p"><p><strong>Consider holding off on updating to iOS 26</strong> until Apple addresses this issue, ideally by releasing a bug fix that prevents the overwriting of the shutdown.log on boot.</p></li></ul></div></div>
  </body>
</html>
