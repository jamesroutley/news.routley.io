<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cceckman.com/writing/wallpaper/">Original</a>
    <h1>Website Wallpaper</h1>
    
    <div id="readability-page-1" class="page"><p>I spent a little time this morning making this site’s background.
You can see the results - well, right here.</p><p>One cool activity at <a href="https://www.recurse.com/scout/click?t=8238c6d9149cbd0865752e535795d509">the Recurse Center</a>
is a weekly “Creative Coding” meetup.
Just before the session, someone picks a prompt– often a line or phrase from a poem.
We get together to discuss ideas, implement them, and share them.</p><p>A couple weeks ago, the prompt was “proud-pied”, glossed as “gorgeously variegated”.
I put together <a href="https://cceckman.github.io/pied/">this page</a>,
which generates a background by simulating an interleaving of several variegated yarn
strands. See more at <a href="https://github.com/cceckman/pied">the source</a>.</p><p>That was a neat exploration into Javascript’s canvas, and I’m happy with how it came out.
Especially with the dynamism– refreshing can give very different results.</p><p>But (as implemented) it’s relatively resource-intensive on the client, and I don’t
want to require a client to run Javascript for it to look good.</p><p>When I was quite young, my parents asked me what color I wanted my
bedroom painted. I said I wanted it to look like blue jeans.
They delivered: growing up, my walls were blue-jean blue, with
thin, irregular white lines criss-crossing it.</p><p>I realized this would be pretty simple to simulate.
Draw blue, add some random vertical and horizontal lines,
tweak the randomness curve to make it match my memories.</p><p>Moreover, I could tweak the build process for my site to
generate a new background on each deploy– giving it some dynamism
over time, but not requiring anything dynamic on the user’s side.</p><p>There’s plenty to tweak- in particular, this mechanism doesn’t necessarily give me
the density that I want.</p><div><div>
<table><tbody><tr><td>
<pre tabindex="0"><code><span id="hl-0-1"><a href="#hl-0-1"> 1</a>
</span><span id="hl-0-2"><a href="#hl-0-2"> 2</a>
</span><span id="hl-0-3"><a href="#hl-0-3"> 3</a>
</span><span id="hl-0-4"><a href="#hl-0-4"> 4</a>
</span><span id="hl-0-5"><a href="#hl-0-5"> 5</a>
</span><span id="hl-0-6"><a href="#hl-0-6"> 6</a>
</span><span id="hl-0-7"><a href="#hl-0-7"> 7</a>
</span><span id="hl-0-8"><a href="#hl-0-8"> 8</a>
</span><span id="hl-0-9"><a href="#hl-0-9"> 9</a>
</span><span id="hl-0-10"><a href="#hl-0-10">10</a>
</span><span id="hl-0-11"><a href="#hl-0-11">11</a>
</span><span id="hl-0-12"><a href="#hl-0-12">12</a>
</span><span id="hl-0-13"><a href="#hl-0-13">13</a>
</span><span id="hl-0-14"><a href="#hl-0-14">14</a>
</span><span id="hl-0-15"><a href="#hl-0-15">15</a>
</span><span id="hl-0-16"><a href="#hl-0-16">16</a>
</span><span id="hl-0-17"><a href="#hl-0-17">17</a>
</span><span id="hl-0-18"><a href="#hl-0-18">18</a>
</span><span id="hl-0-19"><a href="#hl-0-19">19</a>
</span><span id="hl-0-20"><a href="#hl-0-20">20</a>
</span><span id="hl-0-21"><a href="#hl-0-21">21</a>
</span><span id="hl-0-22"><a href="#hl-0-22">22</a>
</span><span id="hl-0-23"><a href="#hl-0-23">23</a>
</span><span id="hl-0-24"><a href="#hl-0-24">24</a>
</span><span id="hl-0-25"><a href="#hl-0-25">25</a>
</span><span id="hl-0-26"><a href="#hl-0-26">26</a>
</span><span id="hl-0-27"><a href="#hl-0-27">27</a>
</span><span id="hl-0-28"><a href="#hl-0-28">28</a>
</span><span id="hl-0-29"><a href="#hl-0-29">29</a>
</span><span id="hl-0-30"><a href="#hl-0-30">30</a>
</span><span id="hl-0-31"><a href="#hl-0-31">31</a>
</span><span id="hl-0-32"><a href="#hl-0-32">32</a>
</span><span id="hl-0-33"><a href="#hl-0-33">33</a>
</span><span id="hl-0-34"><a href="#hl-0-34">34</a>
</span><span id="hl-0-35"><a href="#hl-0-35">35</a>
</span><span id="hl-0-36"><a href="#hl-0-36">36</a>
</span><span id="hl-0-37"><a href="#hl-0-37">37</a>
</span><span id="hl-0-38"><a href="#hl-0-38">38</a>
</span><span id="hl-0-39"><a href="#hl-0-39">39</a>
</span><span id="hl-0-40"><a href="#hl-0-40">40</a>
</span><span id="hl-0-41"><a href="#hl-0-41">41</a>
</span><span id="hl-0-42"><a href="#hl-0-42">42</a>
</span><span id="hl-0-43"><a href="#hl-0-43">43</a>
</span><span id="hl-0-44"><a href="#hl-0-44">44</a>
</span><span id="hl-0-45"><a href="#hl-0-45">45</a>
</span><span id="hl-0-46"><a href="#hl-0-46">46</a>
</span><span id="hl-0-47"><a href="#hl-0-47">47</a>
</span><span id="hl-0-48"><a href="#hl-0-48">48</a>
</span><span id="hl-0-49"><a href="#hl-0-49">49</a>
</span><span id="hl-0-50"><a href="#hl-0-50">50</a>
</span><span id="hl-0-51"><a href="#hl-0-51">51</a>
</span><span id="hl-0-52"><a href="#hl-0-52">52</a>
</span><span id="hl-0-53"><a href="#hl-0-53">53</a>
</span><span id="hl-0-54"><a href="#hl-0-54">54</a>
</span><span id="hl-0-55"><a href="#hl-0-55">55</a>
</span><span id="hl-0-56"><a href="#hl-0-56">56</a>
</span><span id="hl-0-57"><a href="#hl-0-57">57</a>
</span><span id="hl-0-58"><a href="#hl-0-58">58</a>
</span><span id="hl-0-59"><a href="#hl-0-59">59</a>
</span><span id="hl-0-60"><a href="#hl-0-60">60</a>
</span><span id="hl-0-61"><a href="#hl-0-61">61</a>
</span><span id="hl-0-62"><a href="#hl-0-62">62</a>
</span><span id="hl-0-63"><a href="#hl-0-63">63</a>
</span><span id="hl-0-64"><a href="#hl-0-64">64</a>
</span><span id="hl-0-65"><a href="#hl-0-65">65</a>
</span><span id="hl-0-66"><a href="#hl-0-66">66</a>
</span><span id="hl-0-67"><a href="#hl-0-67">67</a>
</span><span id="hl-0-68"><a href="#hl-0-68">68</a>
</span><span id="hl-0-69"><a href="#hl-0-69">69</a>
</span><span id="hl-0-70"><a href="#hl-0-70">70</a>
</span><span id="hl-0-71"><a href="#hl-0-71">71</a>
</span><span id="hl-0-72"><a href="#hl-0-72">72</a>
</span><span id="hl-0-73"><a href="#hl-0-73">73</a>
</span><span id="hl-0-74"><a href="#hl-0-74">74</a>
</span><span id="hl-0-75"><a href="#hl-0-75">75</a>
</span><span id="hl-0-76"><a href="#hl-0-76">76</a>
</span><span id="hl-0-77"><a href="#hl-0-77">77</a>
</span><span id="hl-0-78"><a href="#hl-0-78">78</a>
</span><span id="hl-0-79"><a href="#hl-0-79">79</a>
</span><span id="hl-0-80"><a href="#hl-0-80">80</a>
</span><span id="hl-0-81"><a href="#hl-0-81">81</a>
</span><span id="hl-0-82"><a href="#hl-0-82">82</a>
</span><span id="hl-0-83"><a href="#hl-0-83">83</a>
</span><span id="hl-0-84"><a href="#hl-0-84">84</a>
</span><span id="hl-0-85"><a href="#hl-0-85">85</a>
</span><span id="hl-0-86"><a href="#hl-0-86">86</a>
</span><span id="hl-0-87"><a href="#hl-0-87">87</a>
</span><span id="hl-0-88"><a href="#hl-0-88">88</a>
</span><span id="hl-0-89"><a href="#hl-0-89">89</a>
</span><span id="hl-0-90"><a href="#hl-0-90">90</a>
</span></code></pre></td>
<td>
<pre tabindex="0"><code data-lang="go"><span><span><span>package</span> <span>main</span>
</span></span><span><span>
</span></span><span><span><span>import</span> (
</span></span><span><span>	<span>&#34;fmt&#34;</span>
</span></span><span><span>	<span>&#34;image&#34;</span>
</span></span><span><span>	<span>&#34;image/color&#34;</span>
</span></span><span><span>	<span>&#34;image/png&#34;</span>
</span></span><span><span>	<span>&#34;math/rand&#34;</span>
</span></span><span><span>	<span>&#34;os&#34;</span>
</span></span><span><span>)
</span></span><span><span>
</span></span><span><span><span>const</span> (
</span></span><span><span>	<span>DIMENSIONS</span> = <span>512</span>
</span></span><span><span>	<span>HALF</span>       = <span>DIMENSIONS</span> <span>/</span> <span>2</span>
</span></span><span><span>	<span>QUARTER</span>    = <span>HALF</span> <span>/</span> <span>2</span>
</span></span><span><span>)
</span></span><span><span>
</span></span><span><span><span>var</span> (
</span></span><span><span>	<span>white1</span> = <span>color</span>.<span>RGBA</span>{<span>220</span>, <span>220</span>, <span>220</span>, <span>255</span>}
</span></span><span><span>	<span>white2</span> = <span>color</span>.<span>RGBA</span>{<span>160</span>, <span>200</span>, <span>245</span>, <span>255</span>}
</span></span><span><span>	<span>white3</span> = <span>color</span>.<span>RGBA</span>{<span>215</span>, <span>229</span>, <span>247</span>, <span>255</span>}
</span></span><span><span>	<span>blue</span>   = <span>color</span>.<span>RGBA</span>{<span>65</span>, <span>151</span>, <span>232</span>, <span>255</span>}
</span></span><span><span>)
</span></span><span><span>
</span></span><span><span><span>// We draw the image modulo-half-the-image.
</span></span></span><span><span><span>// Rewrite each coordinate.
</span></span></span><span><span><span></span><span>func</span> <span>mod</span>(<span>coord</span> <span>int</span>) <span>int</span> {
</span></span><span><span>	<span>return</span> <span>coord</span> <span>%</span> <span>HALF</span>
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span><span>func</span> <span>makeImage</span>() <span>image</span>.<span>Image</span> {
</span></span><span><span>	<span>palette</span> <span>:=</span> <span>color</span>.<span>Palette</span>{
</span></span><span><span>		<span>blue</span>, <span>white1</span>, <span>white2</span>, <span>white3</span>,
</span></span><span><span>	}
</span></span><span><span>
</span></span><span><span>	<span>img</span> <span>:=</span> <span>image</span>.<span>NewPaletted</span>(<span>image</span>.<span>Rect</span>(<span>0</span>, <span>0</span>, <span>DIMENSIONS</span>, <span>DIMENSIONS</span>), <span>palette</span>)
</span></span><span><span>	<span>for</span> <span>y</span> <span>:=</span> <span>0</span>; <span>y</span> &lt; <span>img</span>.<span>Bounds</span>().<span>Min</span>.<span>Y</span>; <span>y</span> <span>+=</span> <span>1</span> {
</span></span><span><span>		<span>for</span> <span>x</span> <span>:=</span> <span>0</span>; <span>x</span> &lt; <span>img</span>.<span>Bounds</span>().<span>Min</span>.<span>X</span>; <span>x</span> <span>+=</span> <span>1</span> {
</span></span><span><span>			<span>img</span>.<span>Set</span>(<span>x</span>, <span>y</span>, <span>blue</span>)
</span></span><span><span>		}
</span></span><span><span>	}
</span></span><span><span>
</span></span><span><span>	<span>// First, the columns.
</span></span></span><span><span><span></span>	<span>// More spaced out.
</span></span></span><span><span><span></span>	<span>for</span> <span>x</span> <span>:=</span> <span>0</span>; <span>x</span> &lt; <span>img</span>.<span>Bounds</span>().<span>Max</span>.<span>X</span>; <span>x</span> <span>+=</span> <span>12</span> {
</span></span><span><span>		<span>white</span> <span>:=</span> <span>palette</span>[<span>1</span>:][<span>rand</span>.<span>Intn</span>(<span>3</span>)]
</span></span><span><span>
</span></span><span><span>		<span>// Intentionally biased towards thinner lines, slightly.
</span></span></span><span><span><span></span>		<span>width</span> <span>:=</span> <span>rand</span>.<span>Int</span>() <span>%</span> <span>3</span>
</span></span><span><span>		<span>// We allow overlapping columns; they may be of different widths.
</span></span></span><span><span><span></span>		<span>start</span> <span>:=</span> <span>rand</span>.<span>Intn</span>(<span>DIMENSIONS</span>)
</span></span><span><span>		<span>length</span> <span>:=</span> <span>rand</span>.<span>Intn</span>(<span>QUARTER</span>)
</span></span><span><span>		<span>for</span> <span>i</span> <span>:=</span> <span>0</span>; <span>i</span> &lt; <span>length</span>; <span>i</span> <span>+=</span> <span>1</span> {
</span></span><span><span>			<span>for</span> <span>j</span> <span>:=</span> <span>0</span>; <span>j</span> &lt; <span>width</span>; <span>j</span><span>++</span> {
</span></span><span><span>				<span>img</span>.<span>Set</span>(<span>mod</span>(<span>x</span><span>+</span><span>j</span>), <span>mod</span>(<span>i</span><span>+</span><span>start</span>), <span>white</span>)
</span></span><span><span>				<span>img</span>.<span>Set</span>(<span>mod</span>(<span>x</span><span>+</span><span>j</span>)<span>+</span><span>HALF</span>, <span>mod</span>(<span>i</span><span>+</span><span>start</span>), <span>white</span>)
</span></span><span><span>				<span>img</span>.<span>Set</span>(<span>mod</span>(<span>x</span><span>+</span><span>j</span>)<span>+</span><span>HALF</span>, <span>mod</span>(<span>i</span><span>+</span><span>start</span>)<span>+</span><span>HALF</span>, <span>white</span>)
</span></span><span><span>				<span>img</span>.<span>Set</span>(<span>mod</span>(<span>x</span><span>+</span><span>j</span>), <span>mod</span>(<span>i</span><span>+</span><span>start</span>)<span>+</span><span>HALF</span>, <span>white</span>)
</span></span><span><span>			}
</span></span><span><span>		}
</span></span><span><span>	}
</span></span><span><span>
</span></span><span><span>	<span>// Rows
</span></span></span><span><span><span></span>	<span>for</span> <span>y</span> <span>:=</span> <span>0</span>; <span>y</span> &lt; <span>img</span>.<span>Bounds</span>().<span>Max</span>.<span>Y</span>; <span>y</span> <span>+=</span> <span>6</span> {
</span></span><span><span>		<span>white</span> <span>:=</span> <span>palette</span>[<span>1</span>:][<span>rand</span>.<span>Intn</span>(<span>3</span>)]
</span></span><span><span>		<span>// Just single-width lines.
</span></span></span><span><span><span></span>		<span>// Mostly shorter lines.
</span></span></span><span><span><span></span>		<span>start</span> <span>:=</span> <span>rand</span>.<span>Intn</span>(<span>DIMENSIONS</span>)
</span></span><span><span>		<span>length</span> <span>:=</span> <span>rand</span>.<span>Intn</span>(<span>QUARTER</span> <span>/</span> <span>3</span>)
</span></span><span><span>		<span>for</span> <span>i</span> <span>:=</span> <span>0</span>; <span>i</span> &lt; <span>length</span>; <span>i</span> <span>+=</span> <span>1</span> {
</span></span><span><span>			<span>img</span>.<span>Set</span>(<span>mod</span>(<span>start</span><span>+</span><span>i</span>), <span>mod</span>(<span>y</span>), <span>white</span>)
</span></span><span><span>			<span>img</span>.<span>Set</span>(<span>mod</span>(<span>start</span><span>+</span><span>i</span>)<span>+</span><span>HALF</span>, <span>mod</span>(<span>y</span>), <span>white</span>)
</span></span><span><span>			<span>img</span>.<span>Set</span>(<span>mod</span>(<span>start</span><span>+</span><span>i</span>)<span>+</span><span>HALF</span>, <span>mod</span>(<span>y</span>)<span>+</span><span>HALF</span>, <span>white</span>)
</span></span><span><span>			<span>img</span>.<span>Set</span>(<span>mod</span>(<span>start</span><span>+</span><span>i</span>), <span>mod</span>(<span>y</span>)<span>+</span><span>HALF</span>, <span>white</span>)
</span></span><span><span>		}
</span></span><span><span>	}
</span></span><span><span>
</span></span><span><span>	<span>// We generated four tiles, so we only need to actually pick up one quarter.
</span></span></span><span><span><span></span>	<span>return</span> <span>img</span>.<span>SubImage</span>(<span>image</span>.<span>Rect</span>(<span>0</span>, <span>0</span>, <span>HALF</span>, <span>HALF</span>))
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span><span>func</span> make() <span>error</span> {
</span></span><span><span>	<span>return</span> <span>png</span>.<span>Encode</span>(<span>os</span>.<span>Stdout</span>, <span>makeImage</span>())
</span></span><span><span>}
</span></span><span><span>
</span></span><span><span><span>func</span> <span>main</span>() {
</span></span><span><span>	<span>if</span> <span>err</span> <span>:=</span> make(); <span>err</span> <span>!=</span> <span>nil</span> {
</span></span><span><span>		<span>fmt</span>.<span>Fprintf</span>(<span>os</span>.<span>Stderr</span>, <span>&#34;encountered error: %s&#34;</span>, <span>err</span>)
</span></span><span><span>	}
</span></span><span><span>}
</span></span></code></pre></td></tr></tbody></table>
</div>
</div></div>
  </body>
</html>
