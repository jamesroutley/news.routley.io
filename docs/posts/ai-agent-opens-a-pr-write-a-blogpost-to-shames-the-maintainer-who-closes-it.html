<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/matplotlib/matplotlib/pull/31132">Original</a>
    <h1>AI agent opens a PR write a blogpost to shames the maintainer who closes it</h1>
    
    <div id="readability-page-1" class="page"><div data-partial-name="pullRequestsConversationsRoute.Timeline">

    


      

      


      

      <div data-gid="C_kwDORNbmQtoAKDBhODcyZjljMGEwZGMzODNiNjg2Nzc1M2U2NWIxZjE0OTA4MWEyZWU">
  
        <div>
  <div>
      <div data-view-component="true">
  
  
  <div data-view-component="true">          <div>
  <div>
    <div>
      
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/crabby-rathbun/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/crabby-rathbun">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/258478242?s=40&amp;v=4" width="20" height="20" alt="@crabby-rathbun"/>
</a>  </p>
</div>

      

      

      

      
    </div>
  </div>
    <div>
      <pre>â€¦s only)

Per issue <a data-error-text="Failed to load title" data-id="3923735898" data-permission-text="Title is private" data-url="https://github.com/matplotlib/matplotlib/issues/31130" data-hovercard-type="issue" data-hovercard-url="/matplotlib/matplotlib/issues/31130/hovercard" href="https://github.com/matplotlib/matplotlib/issues/31130">matplotlib#31130</a>, np.column_stack is slower than np.vstack().T because
it has to interleave elements in memory whereas np.vstack().T does contiguous
memory copies and returns a view.

This commit only transforms safe cases where both arrays are 1D arrays of the
same length. Cases where arrays have different dimensions or are 2D are NOT
transformed as the behavior would differ.

Benchmark results from issue:
- With broadcast: np.column_stack -&gt; 36.47 us, np.vstack().T -&gt; 27.67 us
- Without broadcast: np.column_stack -&gt; 20.63 us, np.vstack().T -&gt; 13.18 us

Changes:
- lib/matplotlib/lines.py: Line2D.recache() - both x and y are raveled to 1D
- lib/matplotlib/path.py: Path.unit_regular_polygon() - cos/sin are both 1D
- lib/matplotlib/patches.py: StepPatch - x and y are both 1D arrays

Related: <a data-error-text="Failed to load title" data-id="3923735898" data-permission-text="Title is private" data-url="https://github.com/matplotlib/matplotlib/issues/31130" data-hovercard-type="issue" data-hovercard-url="/matplotlib/matplotlib/issues/31130/hovercard" href="https://github.com/matplotlib/matplotlib/issues/31130">matplotlib#31130</a></pre>
    </div>
</div>

</div>
</div>  </div>
</div>


</div>

      

      <div data-gid="C_kwDORNbmQtoAKGUyN2E3NWM5OTkwNzA2ODQ0YmY3M2QyM2QxMmNjNmFkODA3NjU4Njk">
  
        <div>
  <div>
      <div data-view-component="true">
  
  
  <div data-view-component="true">          <div>
  <div>
    <div>
      
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/crabby-rathbun/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/crabby-rathbun">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/258478242?s=40&amp;v=4" width="20" height="20" alt="@crabby-rathbun"/>
</a>  </p>
</div>

      

      

      

      
    </div>
  </div>
    <div>
      <pre>When replacing np.column_stack with vstack/hstack for performance,
we need to handle cases where one array is 2D and another is 1D
differently.

For cases like:
  np.column_stack([c, np.ones(len(c))]) where c is (19, 3)
The correct replacement is:
  np.hstack([c, np.ones(len(c)).reshape(-1, 1)])

For cases where all arrays are 1D:
  np.column_stack([a, b, c]) where all are 1D
The correct replacement is:
  np.vstack([a, b, c]).T

This fixes the build error in colors.py where 1D arrays were being
passed to vstack, which expects all arrays to have the same shape.</pre>
    </div>
</div>

</div>
</div>  </div>
</div>


</div>

      

      


      

      


      


      


      


      


      



  

        


        

        


        


        


        


        


        


        


        


        


        


        


        


        

        


        


        


        


        


        


        


        


        


        


        


        


        


        

        




  <!-- Rendered timeline since 2026-02-12 05:21:16 -->
  








<template>
  <div data-view-component="true">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <p><span>
      This file contains hidden or bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span></p>
</div></template>
<template>
  <span aria-label="This line has hidden Unicode characters" data-view-component="true">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

</div></div>
  </body>
</html>
