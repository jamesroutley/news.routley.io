<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/nathan-barry/gpt2-webgl">Original</a>
    <h1>Show HN: GPT-2 implemented using graphics shaders</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A browser-based, WebGL2 implementation of GPT-2.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/nathan-barry/gpt2-webgl/blob/main/assets/demo.gif"><img src="https://github.com/nathan-barry/gpt2-webgl/raw/main/assets/demo.gif" alt="Demo" data-animated-image=""/></a></p>

<ul dir="auto">
<li>Full GPT-2 small (117M) forward pass in the GPU via WebGL2 shaders</li>
<li>BPE tokenization using <code>js-tiktoken</code> in the browser (no WASM fetch)</li>
<li>Simple Python script to download the pretrained weights</li>
</ul>
<hr/>

<ul dir="auto">
<li><strong>Node.js</strong> ‚â• 16.x and <strong>npm</strong></li>
<li><strong>Python</strong> ‚â• 3.8</li>
<li>A modern browser with WebGL2 support (Chrome, Firefox, Safari, Edge)</li>
</ul>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">üêç Download the GPT-2 Weights</h2><a id="user-content--download-the-gpt-2-weights" aria-label="Permalink: üêç Download the GPT-2 Weights" href="#-download-the-gpt-2-weights"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">We rely on HuggingFace‚Äôs <code>transformers</code> to pull down the official GPT-2 weights and emit raw <code>Float32Array</code> blobs:</p>
<ol dir="auto">
<li>Install Python dependencies:
<div dir="auto" data-snippet-clipboard-copy-content="pip install torch numpy transformers"><pre>pip install torch numpy transformers</pre></div>
</li>
<li>Run the downloader:
<div dir="auto" data-snippet-clipboard-copy-content="python download_weights.py"><pre>python download_weights.py</pre></div>
This will fetch:
<ul dir="auto">
<li><code>wte.bin</code> (token embeddings)</li>
<li><code>wpe.bin</code> (positional embeddings)</li>
<li><code>c_attn_q_w_0.bin</code> ‚Ä¶ <code>c_attn_q_w_11.bin</code></li>
<li><code>c_attn_k_w_0.bin</code> ‚Ä¶ etc.</li>
<li><code>lm_head_w.bin</code>, <code>lm_head_b.bin</code></li>
<li>And a generated <code>manifest.json</code> mapping names ‚Üí URLs</li>
</ul>
</li>
</ol>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">‚öôÔ∏è  Front-end Setup with Vite</h2><a id="user-content-Ô∏è--front-end-setup-with-vite" aria-label="Permalink: ‚öôÔ∏è  Front-end Setup with Vite" href="#Ô∏è--front-end-setup-with-vite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">We use Vite to bundle TS, serve ESM modules &amp; handle <code>js-tiktoken</code>:</p>
<ol dir="auto">
<li>Install JS dependencies:

</li>
<li>Start the local dev server:

</li>
<li>Open your browser at

</li>
</ol>
<p dir="auto">Any changes under <code>src/</code> will trigger HMR and live-reload.</p>
<hr/>

<p dir="auto">MIT</p>
</article></div></div>
  </body>
</html>
