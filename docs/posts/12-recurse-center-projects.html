<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.jacobvosmaer.nl/0012-recurse-projects/">Original</a>
    <h1>12. Recurse Center projects</h1>
    
    <div id="readability-page-1" class="page"><div><p><i><a href="https://blog.jacobvosmaer.nl/">Jacob Vosmaer&#39;s blog</a></i></p>

<p>2023-12-07</p>

<p>I am currently participating in the <a href="https://www.recurse.com/">Recurse Center</a> programming retreat. I am using my time there to work on projects that bring me joy and help me grow my programming skills. I hope to write blog posts about each of these but to get myself started I will give an overview of the projects I have worked on so far, in chronological order.</p>

<p>Most of these projects are running on the <a href="https://www.electro-smith.com/daisy">Daisy</a> embedded audio platform.</p>

<h2>DaisyAudioMangler: slowing and reversing audio</h2>

<p><a href="https://github.com/jacobvosmaer/DaisyAudioMangler">GitHub</a></p>

<p>I&#39;ve been listening to Aphex Twin a lot and I notice that he regularly uses an effect where part of the sound gets reversed for 1 or 2 beats. It should be straightforward to implement this in a Digital Audio Workstation (DAW) but with my music setup I don&#39;t have the option to do that. Because the Daisy has audio in, audio out and plenty of sample memory, I wondered if I could have it continuously record all incoming sound, and reverse it on demand.</p>

<p>Once I got that working I also added the ability to slow the sound down and to stop it and &#34;scratch&#34; back and forth.</p>

<p>Right now this works on the <a href="https://www.electro-smith.com/daisy/pod">Daisy Pod</a> hardware. The physical controls of Daisy Pod trigger the various effects. To make this usable in my music, which is all MIDI sequenced, I will have to make the effects MIDI-controllable.</p>

<p>Here is a demo of the mangler mangling some of my own <a href="https://soundcloud.com/collector-current/5x4-wave-shaper">music</a>.</p>



<h2>FV1toDaisy: run FV-1 DSP code on Daisy hardware (unfinished)</h2>

<p><a href="https://github.com/jacobvosmaer/FV1toDaisy">GitHub</a></p>

<p>I&#39;m curious about how reverb effects work. I really like the <a href="https://www.muzines.co.uk/articles/alesis-midiverb/4840">Alesis MidiVerb</a> so when I found out that its creator, the late Keith Barr, had developed a DSP platform specifically for audio effects I wanted to know more about it. That platform is the <a href="http://www.spinsemi.com/products.html">Spin FV-1</a>. You could think of the FV-1 as a precursor of the Daisy platform except with less CPU horsepower and a custom assembly programming language specifically designed for audio effects. (Daisy, in comparison, has a general purpose processor.)</p>

<p>Because I have Daisy hardware but no FV-1, I thought it would be a nice challenge to write a program that takes FV-1 assembly and somehow outputs a Daisy C++ program that sounds the same. I bailed out after a couple of days because it felt like too much work, and I was being challenged on too many fronts.</p>

<h2><a id="daisyx7">DaisyX7</a>: real-time tweakable DX7 sound engine running on Daisy</h2>

<p><a href="https://github.com/jacobvosmaer/DaisyX7">GitHub</a></p>

<p>The <a href="https://yamahablackboxes.com/collection/yamaha-dx7-synthesizer/">Yamaha DX7</a> was a popular synthesizer keyboard in the mid-1980s. It uses a digital synthesis method that Yamaha called &#34;Frequency Modulation&#34; (but which really is phase modulation) which allowed for a level of expressiveness that is not achievable with the dominant synthesis paradigm of its time (substractive synthesis). Yamaha FM synthesis can produce a wide range of timbres (&#34;sound colours&#34;) using a small number of parameters and it can vary the timbre of the sound in unique ways.</p>

<p>Concretely, it allowed you to program sounds that sound really different depending on whether you play quiet or loud on the keyboard, as opposed to just having the sound be quieter and a bit duller when you play softly.</p>

<p>The DX7 was a best-selling product in its time and people still love it today out of nostalgia for the songs of the time it was used in. Among synthesizer enthusiasts it is notorious however for the difficulty of making your own sounds with it. There are lots of presets available for it but a big part of the fun of synthesizers is being able to create and sculpt your own sounds.</p>

<p>Inspired by the reverse engineering work of <a href="https://www.righto.com/search/label/dx7">Ken Shirriff</a>, I decided it would be fun to implement the DX7 synthesis engine in C on the Daisy. At first just to see if it would sound more or less correct. I later ported the code to the <a href="https://www.electro-smith.com/daisy/field">Daisy Field</a> so that I could break out more sound parameters onto physical knobs.</p>

<p>I don&#39;t expect to use this project as a synthesizer. My goal is to improve my mental model of what is possible with the DX7 sound engine. I can then apply my knowledge when I program my own (real) DX7.</p>

<p>Here is a demo of me making weird drone sounds with the DaisyX7. Warning: there are abrupt jumps in volume.</p>



<h2>sineko: a Linux kernel module that generates sine wave PCM data</h2>

<p>See <a href="https://blog.jacobvosmaer.nl/0013-sineko/">this post</a>.</p>

<h2>MidiRecorder: record raw MIDI UART data</h2>

<p><a href="https://github.com/jacobvosmaer/MidiRecorder">GitHub</a></p>

<p>I found a bug in a new synthesizer I bought which I could trigger by just playing a <a href="https://en.wikipedia.org/wiki/MIDI">MIDI</a> keyboard into it. I reached out to the manufacturer and we had a hard time figuring out where the problem was coming from. I had a very strong suspicion that it had to do with their software incorrectly handling incoming MIDI data.</p>

<p>It sounded like they developed the firmware and only tested it with USB MIDI. The original MIDI protocol is from 1983 and there are some differences between the original UART protocol and the USB version.</p>

<p>The difficulty now was that all the methods at my disposal for recording MIDI data to share with the manufacturer went through a USB device at some point in the chain, which would then hide (convert) the non-USB behavior.</p>

<p>The Daisy Pod has a MIDI in port that uses the original UART protocol. It also has a MicroSD slot. So, I made a Daisy program that records incoming MIDI to RAM until you tell it to stop. Then it gets written to the SD card as a file that you can inspect on the computer.</p>

<p>This revealed that in my studio, MIDI note-on message were getting fragmented by MIDI clock messages. This is allowed in the original protocol because it has a low data rate (31250 bits per second) and by giving the clock messages higher priority you achieve better clock accuracy. USB 1.1 has a data rate of 12 million bits per second, so there is little to gain by fragmenting messages. The USB MIDI protocol does not have fragmented messages so if you only ever test with USB MIDI, your code may not handle these fragmented messages correctly.</p>

<p>Being able to see that raw UART bytes was really helpful in analyzing this problem.</p>

<h2>CZengine: run the Casio CZ engine on Daisy</h2>

<p><a href="https://github.com/jacobvosmaer/CZengine">GitHub</a></p>

<p>Although I&#39;m not done yet working on DaisyX7, I got curious if I could build something similar for a contemporary of the DX7: the <a href="https://en.wikipedia.org/wiki/Casio_CZ_synthesizers">Casio CZ</a> series synthesizers. This is still work in progress but the software is already able to synthesize some of the waveforms by applying piecewise linear transformations to the phase of a cosine wave.</p>
<p>Tags:
<a href="https://blog.jacobvosmaer.nl/music.html">music</a>
<a href="https://blog.jacobvosmaer.nl/dx7.html">dx7</a>
<a href="https://blog.jacobvosmaer.nl/recurse.html">recurse</a>
</p><details><summary>Edit history</summary><table>
<tbody><tr><td>2023-12-08</td><td></td><td>0012: spell out what sineko does</td></tr>
<tr><td>2023-12-08</td><td></td><td>Remove embedded dates in favor of meta.json</td></tr>
<tr><td>2023-12-08</td><td></td><td>Add dates to header</td></tr>
<tr><td>2023-12-08</td><td></td><td>0012: add daisyx7 demo</td></tr>
<tr><td>2023-12-08</td><td></td><td>0012: add mangler demo</td></tr>
<tr><td>2023-12-08</td><td></td><td>Add 0013-sineko</td></tr>
<tr><td>2023-12-07</td><td></td><td>Add atom.xml</td></tr>
<tr><td>2023-12-07</td><td></td><td>0012: small fixes</td></tr>
<tr><td>2023-12-07</td><td></td><td>Add date</td></tr>
<tr><td>2023-12-07</td><td></td><td>Add 0012-recurse-projects</td></tr>
</tbody></table></details><p><a href="https://blog.jacobvosmaer.nl/">Back</a></p>
</div></div>
  </body>
</html>
