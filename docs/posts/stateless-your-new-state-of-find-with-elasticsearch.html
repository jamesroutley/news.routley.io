<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.elastic.co/blog/stateless-your-new-state-of-find-with-elasticsearch">Original</a>
    <h1>Stateless – Your new state of find with Elasticsearch</h1>
    
    <div id="readability-page-1" class="page"><div id=""><div><div><div><div><div><h2>Where we started</h2><p><span>The first version of </span><a href="https://www.elastic.co/what-is/elasticsearch" target="_self"><span>Elasticsearch</span></a><span> was released in 2010 as a distributed scalable search engine allowing users to quickly search for and surface critical insights. Twelve years and over 65,000 commits later, Elasticsearch continues to provide users with battle-tested solutions to a wide variety of search problems. Thanks to the efforts of over 1,500 contributors, including hundreds of full-time Elastic employees, Elasticsearch has constantly evolved to meet the new challenges that arise in the field of search.</span></p><p><span>Early in Elasticsearch&#39;s life when data loss concerns were raised, the Elastic team underwent a </span><a href="https://www.elastic.co/blog/a-new-era-for-cluster-coordination-in-elasticsearch" target="_self"><span>multiyear effort</span></a><span> to rewrite the cluster coordination system to guarantee that acknowledged data is stored safely. When it became clear that managing indices in large clusters was a hassle, the team worked on implementing an extensive </span><a href="https://www.elastic.co/blog/elasticsearch-data-lifecycle-management-with-data-tiers" target="_self"><span>ILM solution</span></a><span> to automate this work by allowing users to predefine index patterns and lifecycle actions. As users found a need to store significant amounts of metric and time series data, various features such as better compression were added to reduce data size. As the storage cost of searching extensive amounts of cold data grew we invested in creating </span><a href="https://www.elastic.co/blog/introducing-elasticsearch-searchable-snapshots" target="_self"><span>Searchable Snapshots</span></a><span> as a way to search user data directly on low cost object stores.</span></p><p><span>These investments lay the groundwork for the next evolution of Elasticsearch. With the growth of cloud-native services and new orchestration systems, we have decided it is time to evolve Elasticsearch to improve the experience when working with cloud-native systems. We believe that these changes present opportunities for operational, performance, and cost improvements while running Elasticsearch on </span><a href="https://www.elastic.co/cloud/" target="_self"><span>Elastic Cloud</span></a><span>.</span></p><h2>Where we are going — future is stateless</h2><p><span>One of the primary challenges when operating or orchestrating Elasticsearch is that it depends on numerous pieces of persistent state, it is therefore a stateful system. The three primary pieces are the translog, index store, and cluster metadata. This state means that storage must be persistent and cannot be lost during a node restart or replacement.</span></p><p><span>The existing Elasticsearch architecture on Elastic Cloud must duplicate indexing across multiple availability zones to provide redundancy in the case of outages. We intend to shift the persistence of this data from local disks to an object store, like AWS S3. By relying on external services for storing this data, we will remove the need for indexing replication, significantly reducing the hardware associated with ingestion. This architecture also provides very high durability guarantees because of the way cloud object stores such as AWS S3, GCP Cloud Storage, and Azure Blob Storage replicate data across availability zones.</span></p><p><span>Offloading index storage into an external service will also allow us to re-architect Elasticsearch by separating indexing and search responsibilities. Instead of having primary and replica instances handling both workloads, we intend to have an indexing tier and a search tier. Separating these workloads will allow them to be scaled independently and hardware selection to be more targeted for the respective use cases. It also helps solve a longstanding challenge where search and indexing load can impact one another.</span></p><p><span>After undertaking a multi-month proof-of-concept and experimental phase, we are convinced that these object store services meet the requirements we envision for index storage and cluster metadata. Our testing and benchmarks indicate that these storage services can meet the high indexing needs of the largest clusters we have seen in Elastic Cloud. Additionally, backing the data in the object store reduces indexing costs and allows for simple tuning of the performance of search. In order to search data, Elasticsearch will use the battled-tested Searchable Snapshots model where data is permanently persisted in the cloud-native object store and local disks are used as caches for frequently accessed data.</span></p></div></div></div></div></div></div></div>
  </body>
</html>
