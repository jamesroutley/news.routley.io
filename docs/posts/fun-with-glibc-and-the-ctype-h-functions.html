<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2021/09/29/alnum/">Original</a>
    <h1>Fun with glibc and the ctype.h functions</h1>
    
    
<p>
I got really bored tonight and went down some rabbit holes and turned up 
something from about a year ago.  If you follow the latest Linux type 
stuff, you probably remember this, but if not, this might seem new to 
you.  It&#39;s just something dumb and amusing.
</p>
<p>
To say it again: I did not discover this.  I just don&#39;t think this got 
nearly enough attention when it went around the first time.
</p>
<p>
Go grab a Linux box with glibc on it.  Then compile and run this C code:
</p>
<pre class="terminal">#include &lt;ctype.h&gt;
#include &lt;stdio.h&gt;
 
int main() {
  int i;
 
  for (i = 0; ; ++i) {
    printf(&#34;[%d] : %d\n&#34;, i, isalnum(i));
  }
 
  return 0;
}
</pre>
<p>
Then run it and watch what happens.  If you have multiple machines, try 
it on some of them and compare the results.  If the results are 
different, why do you suppose that is?
</p>
<p>
If you run this in a debugger, note the line number of the crash.  Can 
you figure out what&#39;s going on there?  (My guess is massive amounts of 
inlining leading to nothing else going on the stack.)
</p>
<p>
Neat, right?  It makes me want to go looking for places where people are 
calling these functions with ints that I can control to see if I can 
blow it up.
</p>
<p>
Now, remember how I said this is not even close to something that I 
found?  Go check out the 
<a href="https://drewdevault.com/2020/09/25/A-story-of-two-libcs.html">source</a>
to see how the sausage is made by someone who did the work already.
</p>
<p>
Enjoy!
</p>
<p>
...
</p>
<p>
After writing the initial cut of this and just before posting it, that 
little evil part of my head that goes &#34;what about...&#34; woke up, and I 
tried it with a different function.  This time, it was isdigit().  It 
blew up just the same!  Cool!  So I went for isalpha(), and yep, same 
thing.  I&#39;m not going to exhaustively test all of them right now, but my 
guess is that it&#39;s pretty consistent across the whole set of them.
</p>
<p>
This is awesome because it&#39;s that many more possibilities.  I had been 
grepping source for &#34;isalnum&#34; to try to find inputs I can control, but 
now I realize that FAR more functions give a way into this.  Have fun!
</p>

  </body>
</html>
