<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.freespeechextremist.com/blog/fse-vs-fbi.html">Original</a>
    <h1>FSE meets the FBI</h1>
    
    <div id="readability-page-1" class="page"><section><section id="md-content"><p>Pete, Apr 06, 2025</p><p>I have for you a bizarre tale of scrapers, feds, data poisoning, Torswats, and everyone&#39;s favorite fedi instance.  It veers technical, because I suspect it will be of interest to other people running servers with UGC (i.e., every fedi instance), and also because the mechanics of how I figured out what I figured out might be useful.  It&#39;s also got information about how the FBI collects data, which is of interest to everyone, but especially US citizens.  I have a few pieces of the puzzle, maybe someone with interlocking pieces can say more; I&#39;m happy to compare notes.
</p>
<p>To summarize, the FBI pays some shady companies to scrape data, the data is scanned for keywords (yep, just like <a href="https://en.wikipedia.org/wiki/Carnivore_%28software%29">CARNIVORE</a>).  Links and content are then fed into Facebook, organized by topic based on the keywords.  Some rudimentary analysis is performed (sentiment analysis at least, but as friendly as Microsoft is with the feds, and as LLMs have gotten popular, the influence of machines has probably expanded) and perused by agents, using some FBI internal interface.
</p>
<p>The TL;DR above probably implies this, but this is the longest post on here to date, by a wide margin.  I expect that most people will skip around instead of reading straight through:  probably only people running instances are going to be interested in the <a href="#Crash_course">technical parts</a>, and when building out <a href="#Who_is__a_href__https___boardreader_com___boardreader_com__a">the chronology</a> I erred on the side of providing too much information rather than simplifying.
</p>
<p><em>A note about links that go to fedi sites</em>:  some of them (like the main FSE site) are down, but if you put the links into your own instance&#39;s search box, you can generally find the post (if it federated; obviously if your instance is newer or if it&#39;s configured to scrub old posts, you might not have it) and view it on your own instance.  In either case, it&#39;s generally better to try searching for the post&#39;s URL on your home instance, whether that instance is currently live or not, because then you can interact with it locally.  (FSE is actually just a few commits from resuming federation, though being ready to use is a bit farther out.  Within the next few days, probably, it&#39;ll be possible to resume fetching objects from it; I have a couple of bugs to fix in the way Revolver stores users, though it&#39;s serving objects just fine.)
</p>

<p>Pedophiles were showing up on FSE.  The rest of this section is background, the TL;DR is I had a problem getting pedophiles to stay away from FSE and I wanted to stop waking up in a cold sweat.  You can <a href="#Doing_some_digging">skip this bit</a> without missing much besides my woes and what I did about them.
</p>
<p>As far as I could reason, pedophiles were, besides being a problem themselves, the most likely reason for FSE to attract attention from law enforcement.  Nobody wants to host CP (or be in its vicinity) or get their gear seized because they fell asleep on the wheel and they let the pedos have free or they got CP-raided.  (If you are not familiar, this is a type of false-flag where a group of people floods a place with CP and then immediately alerts the FBI, usually done to get the site taken down.  Of course, you have to have it to upload it and usually if it results in any arrests, it results in the arrest of the attackers.)
</p>
<p>I was not happy about their arrival because, like with most fedi instances, it represented the primary existential threat to FSE, but as long as they weren&#39;t bothering any kids or uploading anything illegal, FSE has zero viewpoint censorship.  Almost invariably, they would immediately do something illegal.
</p>
<p>My initial suspicion was that they misunderstood the rules, the <a href="https://parkerhiggins.net/blog/what-is-freedom-of-speech.html">meaning of freedom of speech</a>, something like that.  It turns out that a lot of them have a habit of just dumping illegal stuff <em>everywhere</em> and coming back in a week to see which accounts have been banned and which places have admins that are asleep (an approach that basically leaves no doubt that they are knowingly parasitic), then telling their friends&#34;, so you have to stay on top of it and get rid of them early, or they bring more.  It should not be a surprise that if someone&#39;s gratification is predicated on getting what they want without regard for who it hurts, that person is happy to engage in parasitic behavior like this:  violating a server and panicking an adult is no big deal if you&#39;re willing to violate a child and potentially ruin the kid&#39;s life.
</p>
<p>I&#39;d like to also thank <a href="https://fba.ryona.agency/?domain=freespeechextremist.com">fediblock</a> for never fact-checking anything ever, <a href="https://media.freespeechextremist.com/rvl/full/1d4b93bc31ef7f0923fa8ba902c64e48b1ca45f5725814b52f42c61b288cc004">giving the false impression</a> that <a href="https://parkerhiggins.net/blog/the-loli-question.html">things that FSE has never permitted</a> were allowed.  FSE being fedi&#39;s equivalent of a dive bar, I understand people on &#34;gated community&#34; instances not wanting to deal with it (though <a href="https://media.freespeechextremist.com/rvl/full/917fcd965d2a27d5b62f02494dc2e32cf11cfe6c8c965dda0b4c6d3beed234ec">it turns out</a> that instance-blocking is ham-fisted and just blocking a handful of accounts solves the problem), but I would prefer if they did not lie about their reasons or about me personally.  That sort of thing doesn&#39;t help when pedos show up having heard that there are no rules.  The blocks don&#39;t help them, either:  I&#39;ve sent messages to admins on instances that were (hopefully unknowingly) hosting CP but got no response because they blocked FSE.  That&#39;s <em>their</em> problem, though; hope the block was worth it.
</p>
<p>It does mean that when <a href="https://www.eff.org/deeplinks/2023/07/fbi-seizure-mastodon-server-wakeup-call-fediverse-users-and-hosts-protect-their">the FBI seized the kolektiva.social database backups</a>, nothing from FSE was in there.  As combative and block-happy as that instance was, very few other instances actually did make it into their database; for all anyone knows, the &#34;accidental seizure&#34; might have been just cover for a CI:  if the FBI wanted the database and the CI had it, serving an overly broad warrant lets them collect it without burning that informant.  I don&#39;t know anything about the people involved, but the FBI has used that tactic before.
</p>
<p>So when someone came looking for or attempting to provide CP I started just posting their IP and email and UA and whatever I had or could dig up.  (If you&#39;ve punched a waiter, you can&#39;t complain that he refuses to bring you food.  Likewise with anyone trying to get me to host CP and then whining about me leaving them at the mercy of the internet.  I&#39;m happy to care about your expectations for reasonable terms of service until you intentionally try something that you know is not just against the rules anywhere, but that can get the site eliminated and get me arrested.  I will do my best to discourage you from proceeding.)  I wanted to convey, completely unambiguously, that this is a hostile place to people doing that kind of thing:  the thing that <em>really</em> worries pedos is transparency.
</p>
<p>But it turns out that almost none of them were even paying attention:  they were just here to dump files or grab files and leave, or they expected to be banned 90% of the time and were looking for places where they didn&#39;t get banned.  So it didn&#39;t work, and I kept digging to figure out where they were coming from.
</p>

<p>If you are running an instance, it&#39;s even odds that you&#39;re doing it because you&#39;re interested in computers in general and the best way to learn is solving the problems that crop up.  This is great!  I have some helpful information; I post about it a lot but I haven&#39;t put it in one place.  Here is one place.  It&#39;s hopefully helpful to people that don&#39;t have a lot of experience with the topic and possibly has some bits that are of interest even to people that have been at this a long time.
</p>
<p>I&#39;ve got a bigger piece about this in the larder but here&#39;s a survival guide:  it should give you enough that you can fill in the gaps by hitting the books, and enough of the technical background to understand the rest of the story.  It&#39;s a little dense in parts.
</p>
<h2 id="Why">Why?</h2>
<p>Unfortunately, a lot of the documentation for any given piece of software ignores the problems that crop up:  coders like to think their software is painless and they treat information to the contrary as a bug in their code (or sometimes as a bug in the real world).  Pleroma and <a href="https://fedilist.com/source-code">similar software</a> also have two audiences:  users and people with their hands in the guts, and people with their hands in the guts need the real info.  But workarounds, real troubleshooting information, things like this are a little embarrassing to include.  &#34;This is how much it&#39;ll tolerate before it breaks&#34; is critical information, but the first thought a coder usually has is &#34;It shouldn&#39;t break&#34; and try to come up with a solution rather than document the tolerances.  (Eventually, <a href="https://aphyr.com/tags/Jepsen">everything breaks</a>.  You just don&#39;t know how much it takes or what happens when it breaks if you don&#39;t test it.)  Combine that with the the fact that most complaints come from people that expect the software to Just Work™ and you can expect that you won&#39;t get too many tips for learning how to deal with Weird, and if you run networked software that talks to the open internet, you will encounter Weird.  There are bots and scanners and worms, and as fedi grows, all servers become more interesting targets.  And if it&#39;s a high-traffic server with open registrations, you&#39;ll attract at least a little targeted attention.  (And of course, more if you call the server something like &#34;freespeechextremist.com&#34;:  I may as well make the favicon a big, red bullseye.  But I like encountering Weird, so it&#39;s no trouble for me.)
</p>
<p>But the Weird is only weird until you have an answer, so between that and the paucity of documentation of the Weird (because it is nebulous, because coders often don&#39;t know all the bugs and if they do, they often don&#39;t like to document them, and because high-traffic servers are rare on fedi), your best bet is to get good at diagnostic tooling and analyzing data.  Half of running a server of any sort is being able to tell if something undesirable is going on and the other half is figuring out the shape of it.  (Actually fixing it tends to be trivial.)  That is, you come up with questions and then you figure out how to answer them.  A lot of the questions are going to be &#34;Why is this slow?&#34; or &#34;Why did this stop working?&#34; but if you understand the stream of logs, sometimes the questions are going to be &#34;What the hell is <em>that</em>?&#34;
</p>
<p>You want to be able to understand the logs directly, but you will also need to be able to understand them in aggregate and correlate them with other logs.  Luckily for you, it&#39;s all text streams and text files and Unix is <em>full</em> of tools for answering questions about text.  Here&#39;s the <a href="https://media.freespeechextremist.com/rvl/full/2d50aa0f78a11a3b5d3cac3c5580a16085811bd3fd2db5fc6cd4322accdcc8e7">crash course</a>!
</p>
<h2 id="Crash_course">Crash course!</h2>
<p>This is dense but not difficult:  if you can set up Postgres and Pleroma and nginx, this material is all within your grasp.  Learn one of the things below and you will get some use out of it, and the use is exponential the more of them that you learn.
</p>
<p>If you know any scripting languages, you can learn enough awk for it to be useful in 30 minutes:  every awk program is <code>predicate1{action1} predicate2{action2} [...]</code>.  If you don&#39;t, you can probably pick up awk in a few hours.  (I&#39;m serious, no exaggerating.  Do yourself a favor.)  If you combine this with <code>tail -f</code> and <code>mawk -Winteractive</code> then this is as much as you need in order to do real-time analysis of your log files.  I can&#39;t speak highly enough of awk&#39;s usefulness:  it&#39;s like the SQL of plain text.
</p>
<p>If you are any good with awk and some basic networking tools (dig, whois, traceroute, tcpdump, iftop), you know how to use datasets (<a href="https://github.com/RIPE-NCC/nro-delegated-stats">NRO delegated stats</a>, for example; whois on IPs will often give a geofeed URL, etc.) and services (whois again, <a href="https://blog.shodan.io/5-free-things-for-everybody/">Shodan</a> is a good start, DDG <a href="https://duckduckgo.com/bangs">lists several services</a> that it integrates), it&#39;s possible to figure out just from your webserver logs who is who, when someone signed up (grep the logs for the <code>POST</code> to the accounts endpoint), from where, whether or not it was a <a href="https://check.torproject.org/exit-addresses">Tor exit</a> or proxy, what language they have told their browser to say they speak, things like that.  There is no shortage of tools for network exploration, and the more you learn about how the Internet works, the better you&#39;ll be able to use them.  That should suffice:  do a few hours of reading and you have just put your competence into the top 10% of fedi admins, and learned some things that you can apply anywhere.
</p>
<p>nginx, lighttpd, Apache httpd, and almost all of the other webservers that are popular to set in front of fedi for load-balancing or caching or filtering or rate-limiting, they all have a some directives that allow you to control the format of the logfiles, log arbitrary headers, timing information.  It&#39;s not always necessary, but keep it in your pocket for when you need it.  With FSE (and other servers I run, not just fedi stuff), I usually strip most of the quote marks added in the <a href="https://en.wikipedia.org/wiki/Common_Log_Format">common log format</a>, I add a lot of timing information (especially time required to get a response from the backend).  I also use tabs, effectively making the log files a big <a href="https://en.wikipedia.org/wiki/Tab-separated_values">TSV</a>:  the extra space makes the files a little easier to read visually, a little simpler to use with awk, but also opens up the tooling options:  R, sed, sort, nearly anything can read TSVs.  Read the output of grep into irb or some other REPL that&#39;s good at string-mangling; set <code>IFS</code> and pipe it into a <code>while read line</code> loop in bash.  Or if you have some favorite spreadsheet software, they can all read TSVs (but you&#39;ll probably want to filter it or split it into chunks unless you have the kind of spreadsheet software that doesn&#39;t choke on a 20GB file).  (Of course, because I deal with 20GB files, the tooling I use <a href="https://livefreeordichotomize.com/posts/2019-06-04-using-awk-and-r-to-parse-25tb/index.html">can handle pretty big files</a>.)  In fact, although awk is like SQL for delimited text, you can even use regular SQL:  <a href="https://til.simonwillison.net/sqlite/one-line-csv-operations">sqlite3 can operate on text pipelines</a>.  And if you&#39;re good with SQL, check the man page for psql:  you can have it emit TSVs pretty easily!  A full SQL tutorial would take longer than awk, but SQL is very useful to pick up.
</p>
<p>Really simple numerical analysis is indispensable when you are looking for aberrances:  the Weird sticks out.  If you&#39;re tailing the logs and piping that somewhere, you can keep a running average and calculate standard deviations and find the outliers.  <a href="https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule">68, 95, 99.7</a>:  calculate the standard deviation of your window, and you can find things that stick out.  (In awk, this is really concise, since it keeps track of line—technically &#34;record&#34;—numbers automatically:  <code>{a[NR%1000]=$0}</code> keeps the last thousand records in the array <code>a</code>.)  Some endpoints start to get a disproportionate amount of traffic out of nowhere, some IPs show up out of nowhere and flood you.  Finding things that stick out is the point of data analysis.  (This is the sort of tool I was writing/using when I would post things like &#34;90% of the POSTs are coming from the same address&#34;.)  On fedi, network-based DDoS tends to be more popular than targeting specific endpoints; if you see <a href="https://techhub.social/users/Drand">someone suddenly hammering TWKN</a>, and it&#39;s probably <a href="https://nya.social/notes/818c3d1bdb3e20788eb08e25">a scraper</a>.  (Probably!)
</p>
<p>The last thing to learn is when you&#39;re being too paranoid:  sometimes it&#39;s not a DDoS, someone just linked to a post from a popular site like <a href="https://news.ycombinator.com/">HN</a>, sometimes <a href="https://nya.social/notes/818c3d1bdb3e20788eb08e25">an idiot wrote the scraper and doesn&#39;t understand rate-limiting</a>.  (Always include a mechanism to limit the rate, even if you are making <a href="https://git.freespeechextremist.com/gitweb/?p=embot;a=blob;f=embot;h=21a11493cec9b361ee54884dd3de10fce8750cb2;hb=HEAD#l220">a trivial Markov bot</a>.)  Sometimes, it&#39;s just someone trying to write a new client and the client has a bug:  fedi is exciting like that, there are hackers all over.
</p>
<h2 id="Scar_Tissue">Scar Tissue</h2>
<p>Over time, running a service, you bump into problems, and your service grows solutions to those problems, and you keep the solutions around so that you don&#39;t have the same problem twice.  The service acquires scar tissue, reminders of problems, marks that distinguish it from a new service.  (The scar tissue is one of the reasons that you encounter so many surprises when doing a big rewrite.)
</p>
<p>Early in FSE&#39;s history, we had some malicious signups:  just normal spammers.  I view captchas as hostile to legitimate users and ineffective (and of course, <a href="https://huggingface.co/spaces/captchaboy/pleroma_captcha_solver">Pleroma&#39;s captchas have been cracked</a> since then).  Likewise with email verification, except that expecting a real email isn&#39;t just hostile design, it&#39;s also a privacy risk.  There&#39;s a tradeoff there:  I have to manually generate password resets if people forget them, FSE can&#39;t send out email notifications, things like that, but on the other hand, someone that wants email addresses isn&#39;t going to target FSE, and in the event FSE <em>is</em> compromised, the email addresses aren&#39;t leaked.  (If someone has an email address and a password, the first thing they&#39;ll do is try to use that combination on other services.  If they don&#39;t have a real email address, though, they can&#39;t.)  But there are a lot of tradeoffs you have to make and people that don&#39;t like the ones I made can make different servers or join different ones.
</p>
<p>There&#39;s work stuff where, if you can use an off-the-shelf solution to a problem, that&#39;s usually what you want; it&#39;s generally an explicit policy to spend as little time as possible on things that aren&#39;t part of your core business.  That&#39;s reasonable but I don&#39;t think web applications have gotten <em>more</em> reliable in the decade and a half since this became conventional wisdom, so maybe it&#39;s worth considering the emergent properties of this kind of policy.  So when I&#39;m on my own, a project where I have no boss and no reason to compromise, I generally roll my own solutions.  I like coding anyway so it&#39;s not a costly experiment, and these solutions generally end up faster, more reliable, and more flexible; aside from that, I&#39;m not at a vendor&#39;s mercy for bugfixes.  (There are always bugs.  The difference is whether I&#39;ve got to try to find them in someone else&#39;s 200kLOC codebase or in my own 4-line script.  Additionally, you can guess whether it&#39;s faster to bash a four-line script into the text editor or tweak a 400-line config file.)
</p>
<p>So I needed a way to tamp down on the spam without making the site suck:  my solution was to tail the logs, send them through an awk script, and it would just email me when it saw someone do <code>POST /api/v1/accounts</code> and get a 200 back.  Eventually I expanded the script and it would do things like check <code>pidof xlock</code> as a reasonable approximation of whether I was at my desk and if xlock wasn&#39;t running, it would pipe <a href="https://media.freespeechextremist.com/rvl/full/4741d89afcf57973a9afcc973a43804a6ce4e6134b96d38dcd87173ed5b1e9e9">a message</a> through <code>espeak -s120 -v other/en-sc</code>.  (I call him &#34;scotbot&#34;.  As you can hear, I did have it correctly pluralize &#34;user&#34; but forgot to change &#34;there are&#34; to &#34;there is&#34; when only one occurred.)  At some point, we got a really big hit, and I had nginx rate-limit signups to one per minute.  Later on, I did the welcomebot, so new signups would be announced in public.
</p>
<p>So I would keep an eye on new users arriving:  usually it was just merry shiptoasters, but once in a while I see a pedo show and this sets off the self-preservation instincts, so I dump the stuff they&#39;ve done and if they are still there and I haven&#39;t had to hit the red button yet (that is, they haven&#39;t done <code>POST /api/v1/media</code> yet, compelling me to kill off their IP and account and delete all of the shit they uploaded), I can watch them move around, look at what they are searching for.
</p>
<p>The pedos would land on a page, some post or something, usually a local mirror of a post from another instance, then they&#39;d sign up, start mashing search terms into the box (which is usually how I noticed them:  some search terms were added to an awk script that would ping me), follow a handful of accounts, and usually just leave.  A peculiar thing stuck out:  a lot of them were coming from <a href="https://boardreader.com/">boardreader.com</a>, based on the <code>Referer</code> header, so I tugged on that thread, and that thread turned out to be the weird one.
</p>

<p>I&#39;d never heard of them, so I looked around, and <a href="https://boardreader.com/">boardreader.com</a> was a strange site indeed:  very barebones, didn&#39;t work over Tor, no contact information listed anywhere.  (Some time in the interim, they added a SocialGist banner at the bottom...that goes to a 404 now that SocialGist has moved.)  I bashed in some of the search queries that the pedos had used on FSE and was pretty horrified to find the posts they landed on, all of which originated on other servers, but all of which were also ascribed to FSE.
</p>
<p>It turns out that BoardReader was a tool for searching forums.  The authors don&#39;t appear to understand what fedi is, so they had treated FSE as a forum, and all of the public posts that came to FSE from elsewhere as forum posts made on some forum called &#34;freespeechextremist.com&#34;.
</p>
<p>Apparently it was a small search index for forums and it got big enough to be bought by a Japanese company, the two founders had issues with the new owners, and the company eventually was sloughed off and acquired by <a href="https://socialgist.com/">SocialGist</a> (which now redirects you to <a href="https://www.socialgist.ai/">socialgist.ai</a>).  SocialGist purports to sell &#34;accessible social data&#34;, they list <a href="https://web.archive.org/web/20230201153015/https://socialgist.com/data-sources/">several data sources</a>, and per <a href="https://web.archive.org/web/20250124110504/https://socialgist.com/blog/">their blog</a>, <a href="https://web.archive.org/web/20240415001121/https://blog.socialgist.com/understanding-how-we-find-data">their developers are in Serbia</a>, which lines up with the IP they were using, so I&#39;ve started thinking I&#39;ve got the right people.
</p>
<p>Most of the search results indicated that long ago, BoardReader identified itself in the User-Agent header and most of the targets viewed it as hostile:  it&#39;s present on a lot of lists of poorly behaved bots.  There are also complaints about it on a lot of forums, and there are threads where people are asking how to stop it; in those threads, some people show up from nowhere and suggest that the person running the board should be grateful for the traffic bump.  (If you owned a search engine for discussion boards, wouldn&#39;t you use it to search for mentions of your engine?  And if you were running a somewhat aggressive crawler that was annoying people, it&#39;s a matter of temperament to decide whether to ask what would bother people less versus showing up to argue with them.  I give it even odds that those posts were made by owners or employees at BoardReader itself.)
</p>

<h2 id="2023_03_05__Sunday">2023-03-05 (Sunday)</h2>
<p>I went over and grepped the logs to see if they&#39;d been to FSE:  nothing.  But they had to be getting data from FSE:  they had posts from other instances and links to FSE.  So I kept looking and found a large amount of scraping on <code>/api/v1/timelines/public?local=false</code> from a browser claiming to be Chrome, and coming through way faster than a human could scroll even if they were leaning on the Page Down key.
</p>
<p>spider1.boardreader.com through spider43 all had <a href="https://en.wikipedia.org/wiki/List_of_DNS_record_types#A">A records</a>, but traffic was coming through 45.15.176.187 (which was, at the time, <a href="https://media.freespeechextremist.com/rvl/full/b110271c6ec2ed688cbbce406a6a1ca9379145ec3d54ba2c7a73927970df47dc">owned by DediPath</a>).  That was odd, right:  why would BoardReader go to the trouble of making A records for their spiders and then go through some other service?
</p>
<p>So, I tell the server to drop traffic from the IPs that were scraping.  Problem solved!  Then immediately I start seeing a large number of attempts from different IPs.  Residential IPs in the US:  they&#39;re buying residential proxies.  It&#39;s one thing to lie in the User-Agent header, but it&#39;s a step past that to pay money to evade detection.  Someone that has money to burn wants FSE scraped, probably a business.  At this point I&#39;m certain enough that it&#39;s BoardReader.  I dash off a quick email to <a href="mailto:info@boardreader.com">info@boardreader.com</a> asking for information on their crawler.  Since they are going to lengths to hide what they are doing, I don&#39;t expect much, but it doesn&#39;t hurt.
</p>
<h2 id="2023_03_08__Wednesday">2023-03-08 (Wednesday)</h2>
<p>So I need an automated approach if they&#39;re automatically hopping proxies.  <code>awk</code> and <code>iptables</code> plus a really quick Ruby script to sit between nginx and Pleroma for that endpoint, and I can start dropping traffic from any IP that tries to hit FSE with that token.  If I keep it there, I&#39;ll exhaust their proxies before they fill their cache.
</p>
<p>Eventually, the requests dry up and I see a request from an IP owned by a Serbian ISP that leads back to <a href="https://devtools.boardreader.com/">devtools.boardreader.com</a>.  It acts like a normal browser:  it loads all the resources, grabs a Bearer token, executes JavaScript, and subsequent to that, the scraping resumes using that token.  They&#39;re trying to play back a browser session:  that&#39;s clever.  Watching the logs confirms it:  bots using that token start arriving, playing back the sequence of requests, and then hammering the hell out of the public timeline again.  To verify, I wander back through their site and see that they are indeed getting new posts from that batch of requests.
</p>
<p>I start severely limiting TWKN by cranking the rate-limiting way up.  At this point, it starts throwing 429s even at legitimate users, so I finally <a href="https://freespeechextremist.com/objects/8061b855-1dd7-4fbb-95de-cd812dd04a49">talked about the problem in public some</a> after mostly keeping it to myself or in DMs.  (And, of course, writing this has made me regret not having taken notes with timestamps.  I&#39;ve had to piece everything together from scattered notes, timestamps on scripts and logs, DMs, etc.  The first draft of this post was missing some information and had the chronology wrong.)
</p>
<p>BoardReader is sneaky and annoying and using fraudulent means to extract data from FSE over my objections, but now thay I can isolate their traffic, I can I try a lot of different approaches.  They aren&#39;t going to get any legitimate data again, but I can see how their crawler behaves.  I start just sending back 429s:  their scraper responds by sending <em>more</em> requests.  Apparently, if it doesn&#39;t get the response it wants, it just repeats the request immediately, no delay.  Rude, but they have some confidence in their ability to get around restrictions, so they don&#39;t have to be polite.  But this is worse:  they send the reqs back so fast that it actually saturates the pipe, it&#39;s basically a worse DoS than before.  Unsurprisingly, sending back 401s, 403s, 500s, same result.  So I start just sending <a href="https://datatracker.ietf.org/doc/html/rfc2616#section-10.4.3">402 Payment Required</a>, an idea I got from <a href="https://poa.st/users/graf">graf</a>.  Unfortunately, this means no one gets anything from TWKN for a while.
</p>
<h2 id="2023_03_13__Monday">2023-03-13 (Monday)</h2>
<p>...And that&#39;s when they finally get back to me.  I had sent an email to <a href="mailto:info@boardreader.com">info@boardreader.com</a> on the 5th telling them that I was looking for information on their crawler, and on the 13th, after the server has started adamantly refusing to I finally get an email from <a href="mailto:dave@socialgist.com">dave@socialgist.com</a> asking what I want to know.  Noncommittal.  I reply to him a few hours later, at 20:45 UTC, explaining the problem and telling him if he wants to index that he&#39;ll need to only fetch local posts and use a UA that identifies BoardReader.  He tells me at 21:01 that he&#39;ll forward it to the engineering team and asks what domains I&#39;d like them to quit crawling.  I give the entire IP range that I owned and complain about the pedophiles.  While we&#39;re corresponding, their developers are still scraping and actively debugging the scraper, so I mention that he could save them some time.  I can another Serbian IP address.  Over email, I offer to talk to their devs, I pass a few links to <a href="https://fedilist.com/">FediList</a> (which was still on the <code>demo.</code> subdomain at the time), I try to explain how fedi works.
</p>
<pre>[2023-03-13T10:24:39+00:00] https://freespeechextremist.com/main/all [200] 109.92.154.188 https://devtools.boardreader.com/
[2023-03-13T10:53:48+00:00] https://freespeechextremist.com/main/all [200] 109.92.154.188 https://devtools.boardreader.com/
[2023-03-13T13:57:18+00:00] https://freespeechextremist.com/main/all [200] 109.92.154.188 https://devtools.boardreader.com/
</pre>
<p>So obviously I don&#39;t trust them.  Dave stops replying to emails, and they&#39;re not only &#39;&#39;still&#39; scraping, but they are trying to get around the countermeasures:  SocialGist is lying.  They&#39;re actively putting work into continuing to do something they&#39;ve promised to stop doing:  they can&#39;t get anything out of TWKN (the last real post they got from FSE was on the 8th), and they&#39;re doing their damnedest to try to rectify this, while telling me that they&#39;ll stop.  If they felt really good about it, they&#39;d have no reason to lie, so either their motivations are not what what they say, or the person I&#39;m dealing with is not the same person that has decided to put FSE on the list and then told the devs to make sure they can get posts from it.
</p>

<h2 id="2023_03_14__Tuesday">2023-03-14 (Tuesday)</h2>
<p>The morning after Dave ghosted me, I got <a href="https://media.freespeechextremist.com/rvl/full/1e24f117e3892a83e9f998f5fb636a3b99711e27e3ff37743f20746708b1b6e4">an email</a> from an fbi.gov email address, the subject line &#34;Emergency Disclosure Request&#34;, and this in the body:
</p>
<blockquote>
<p>This is Special Agent Peter Christenson, with the FBI. I am requesting subscriber information for the user &#34;WitchKingOfAngmar.&#34; This user posted the attached threat. Please let me know if you can assist with this request.
</p>
</blockquote>
<p>It also includes <a href="https://media.freespeechextremist.com/rvl/full/8601d634946331754840b13513cddfabcf559f4e2f62122d72c4015c5e57390e">FSE Screen Shot.PNG</a>.  I&#39;ve never seen someone outside fedi refer to freespeechextremist.com as FSE, so my first thought is it was a prank, but the headers and my mail server&#39;s logs and the SPF info for fbi.gov all indicated that this was a real email from the place it claimed to be from.
</p>
<p>This was the attached screenshot, which, despite being labeled &#34;FSE Screen Shot&#34;, is not a screenshot of FSE:
</p>
<img src="https://media.freespeechextremist.com/rvl/full/8601d634946331754840b13513cddfabcf559f4e2f62122d72c4015c5e57390e" alt="Not a screenshot of FSE"/>
<p>So after I was reasonably certain that it was a legitimate email, my first reaction was to rack my brain trying to remember who the hell &#34;WitchKingOfAngmar&#34; was.  He didn&#39;t sound familiar to me.  I checked and this was a user at <a href="https://sneed.social/">sneed.social</a> (which was dead for a long time, but appears to have <a href="https://fedilist.com/instance/sneed.social">come back recently</a>).  The screenshot had some interesting bits in it.  For one thing, despite being named &#34;FSE Screen Shot&#34;, FSE has never looked like that.  It also described FSE as a &#34;forum&#34;.  In fact, the top said &#34;Forum • Blackrock Executiv...&#34;.  Some text is highlighted, &#34;kill blackrock&#34; &#34;larry fink&#34;, as if those were search terms.  There was also some rudimentary sentiment analysis.  The post itself was from 26 days before the email was sent, but the screenshot read &#34;11 hours ago&#34; and &#34;13 hours&#34;.  (So much for &#34;Emergency&#34; from the subject line, but it also indicates that it takes two hours for a post to go through whatever that system is.)
</p>
<p>Obviously, you don&#39;t expect to receive an email from the FBI, so it took me a minute to figure out what to make of it.  WitchKingOfAngmar&#39;s post was clearly a threat but it was also clearly absurd, an obvious joke, not a credible threat.  And obviously, he wrote it to troll the admins of the site.
</p>
<p>I know a couple of pretty good lawyers in case anything crazy happens, but the goal is always to make sure that nothing crazy happens.  So, best-case scenario, everything from FSE is public:  if you can&#39;t see it, I don&#39;t have it.  Ideally, the FBI gets that and I don&#39;t have to do any convincing.  Worst-case scenario is they kick in the door and grab the server.  They&#39;d need a warrant to do that, and they wouldn&#39;t ask politely if they had a warrant already...unless they were trying to get me to say no or they were trying to see how I respond.
</p>
<p>Dealing with law enforcement is usually an uphill battle to convince a person afflicted with motivated reason of the obvious.  They are looking for something, their job performance is predicated on finding it, and when that&#39;s the case, it&#39;s hard to get them to look at something that isn&#39;t the thing they&#39;re looking for, even if that thing demonstrates very clearly that what they are looking for is not here.
</p>
<p>On top of that, I&#39;m paranoid.  I go ask the dead spacemen for their thoughts and one of them points out that posting about it might count as obstruction and the FBI had lately been somewhat zealous about obstruction charges.  (Good to have solid friends with level heads.)
</p>
<p>And the previous day, fresh on my mind because the memes were flying, <a href="https://media.freespeechextremist.com/rvl/full/9c7e72e28d6b8f9add669ef70f40ded4bba81bde46e6726537f63f2caea47fac">Mike Chitwood</a> (mostly notable for <a href="https://www.mambaonline.com/2017/06/06/newspaper-outs-18-men-arrested-cruising-florida-parks/">publicizing mugshots of people arrested for, though not convicted of, cruising</a>, part of his <a href="https://edramatica.com/The_Daytona_Nine">long-running battle to stop gay dudes in Daytona Beach since at least 2006</a>) had just <a href="https://www.volusiasheriff.gov/news/volusia-county-sheriff/video-new-jersey-man-identified-arrested-following-online-threat-to-murder-sheriff-chitwood.stml">had Richard Golden extradited</a> for saying &#34;Just shoot him in the head&#34; on, uh, apparently it was &#34;<a href="https://www.news-journalonline.com/story/news/crime/2023/03/15/richard-golden-what-we-know-about-the-new-jersey-man-accused-of-threatening-sheriff-mike-chitwood/70012169007/">a 4CHAN chatroom, a communications platform shared by extremist groups</a>&#34;.  (Informed citizens may recognize 4chan as <a href="https://media.freespeechextremist.com/rvl/full/e427aa87b4a334f0ed4f59f6ab2485cf4e9bbd381fa8bc5353a495a80040e0f2">a far-left website</a> as well.)  It is kind of interesting that Chitwood used the same &#34;eradicating scumbags&#34; language about neo-Nazi propagandists and gay dudes bangin&#39; in the woods.  But anyway, I couldn&#39;t help noticing that there had just been a case where cops were getting excited about anonymous internet threats.
</p>
<p>The timing was a little obvious:  they got it from BoardReader.  I go and find the post on BoardReader, to make sure it&#39;s in their index.  It is:
</p>
<img src="https://media.freespeechextremist.com/rvl/full/1337eade3854b2802404520b99448300a920d821cff0c5d1ba9f8599f7944c02" title="Fans of long-ass hashes may notice that this one starts with 1337!" alt="Exactly the same shit the FBI sent me, just a different UI."/>
<p>The odds that the FBI and BoardReader would screw up the Unicode in exactly the same way are pretty low.  (The original Unicode codepoints, 1f9e2, 1f438, and 1f44d, got turned into question mark boxes indicating invalid Unicode.  BoardReader&#39;s codebase being a mess of PHP, no surprise.)  A common glitch is not absolute, but there is the other unlikely mistake, that a post from somewhere else is ascribed to FSE.  Guess now I know why Dave ghosted:  they&#39;re scraping for the FBI, he can&#39;t turn it off.  Legally, the FBI can&#39;t pay a private organization to do something that they can&#39;t do, but if the organization is doing something on their own and the FBI &#34;doesn&#39;t&#34; (<em>cough</em>) know and doesn&#39;t ask, they&#39;re just buying access to a stream of data, not paying someone to violate the CFAA.
</p>
<p>🧢🐸👍</p>
<p>I had been saying for a while that the three-letter agencies don&#39;t really &#34;get&#34; fedi.  Decentralized networks take some explaining to regular people, but individuals can get them.  But there&#39;s a long way from an individual understanding it to an organization understanding it.  (If you haven&#39;t ever worked in a stultifying bureaucracy, think about the amount of time that passes between a rumor propagating through your extended family and any sort of concrete change in behavior propagating.  Something can be obvious to everyone and still not obvious to the organization as a whole.)  Apparently the <a href="https://media.freespeechextremist.com/rvl/full/faa13e7f66b7ff9e97634aaf04f6fd4faab95cf3931080fd03b0d98d76c7df2a?name=hydra-on-the-web.pdf">German feds</a> get it and the feds in the US are <a href="https://media.freespeechextremist.com/rvl/full/835374c1bfa10895663d4d1c94500049823ea928fb7e9c47b01a6b7f8f07c091?name=nsf-staff-report.pdf">starting to get it</a>.  But this more or less confirmed it:  SocialGist doesn&#39;t understand what fedi is, really, and the FBI saw &#34;It came from this website&#34; and they just rolled with it.
</p>
<p>So I get my head together and reply, explaining that since the guy was on another server, I don&#39;t have the information he is looking for, that BoardReader wrote &#34;Free Speech Extremist&#34; on the post but that it didn&#39;t come from FSE.  And, miraculously, that works:  he asks who to ask, I tell him to check the origin server, and ask him if he&#39;d rather I not discuss the exchange in public, with no response.
</p>
<h2 id="2023_03_15__Wednesday">2023-03-15 (Wednesday)</h2>
<p>BoardReader is still hammering FSE and getting only 402s in response.
</p>
<p>Still corresponding with Special Agent Christenson, but no reply until East Coast business hours start.  (My last email was 15:50 on the 14th in LA, 18:50 in Quantico.)  The last email is him saying thanks, I ask him one more time if it would bother the FBI if I said something, and nothing.  In the mean time, I&#39;ve been alternating between disappearing from fedi and running around TWKN being twitchy and paranoid while the actual endpoint is spewing errors.  It&#39;s better to be transparent and I usually am but people are asking questions.  The FBI guy probably can&#39;t say &#34;Sure, write whatever, here&#39;s a selfie!&#34; but if they wanted me not to say anything, he could definitely tell me not to say anything, so I figure it&#39;s fine.  On the other hand, the whole thing still made no sense.  (Maybe it made no sense to him either and he was just doing what his boss said.)  So I give a limited explanation and a promise to deliver a full explanation, then wait for the flashbang to come through my window, because, although I was certain I wasn&#39;t doing anything wrong or illegal, I am really paranoid:
</p>
<img src="https://media.freespeechextremist.com/media/9dfbbd87-4a30-48d6-8148-9f1db8001501/2023-03-15_post.png" alt="Long-ass post and I always fuck up at least one of the ejimos because no autocomplete in bloatfe and I compose the longer ones in acme anyway and in any case, I consider cosmetic fuckups to be acceptable collateral damage"/>
<p>(That post was also available at <a href="https://freespeechextremist.com/objects/19711ab5-5025-4733-8b7d-602c309621ed">https://freespeechextremist.com/objects/19711ab5-5025-4733-8b7d-602c309621ed</a> if you are playing along from your home instance.)
</p>
<p>I realize that was a screenshot of a very long post in the middle of a very long article; you&#39;ll notice that it ends with an announcement that FSE is going into lockdown until further notice:  no viewing TWKN or public timelines without an account, and registrations closed.  I recommended everyone else do the same.  I hate doing that and I hate when other instances do it, but a lot of instances follow suit.
</p>

<h2 id="2023_03_16__Thursday__and_a_while_after">2023-03-16 (Thursday) and a while after</h2>
<p>I&#39;m on the edge of my seat, watching BoardReader continue to fail to get around the wall of 402s.  (As verifying the bearer token means a round-trip to the DB, I&#39;m still mostly kicking them out by using nginx, along with a pile of awk scripts that .)  They&#39;re using residential proxies, they&#39;re using Tor, they&#39;re rotating the User-Agent strings every request  No word from them <em>or</em> the FBI for a week.
</p>
<p>I don&#39;t say much beyond the public post, but I ping the admin of sneed.social and ask him if the FBI agent contacted him, I send him the link to my post.  (I didn&#39;t know him, but everyone said he was reasonable to deal with when it was something like this, and he was.)  He goes to check his email, says that he&#39;ll reach out, and remarks that the user in question was actively trying to get banned, due to some other issue; I didn&#39;t ask.
</p>
<h2 id="2023_03_20__Monday">2023-03-20 (Monday)</h2>
<p><a href="https://detroitriotcity.com/">Detroit Riot City</a> trolls the neo-Nazi admin of <a href="https://fedilist.com/instance/pieville.net">Pieville</a>, Alex Linder.  (Neo-Nazis are notorious for having no sense of humor; they take themselves too seriously.  They also tend to have difficulty with subtlety.)  <em>Purely by coincidence</em>, right after Linder blocks them, someone registers a new account on DRC to <a href="https://media.freespeechextremist.com/rvl/full/e46f62ce82ff1663ec67924950e0cd4a38f6a25eea10e59db0a0e517507ba762">post a threat to blow up some Jewish hospitals</a>, and then someone reports this post to the FBI in under a minute, less time than it would have taken to read it.
</p>
<p>This dissipates pretty quickly:  the fed checks it out because he&#39;s got to, but it&#39;s pretty obvious, isn&#39;t it?  Your guess is as good as mine with regards to why no one was arrested for sending the FBI a false report.
</p>

<h2 id="2023_03_21__Tuesday">2023-03-21 (Tuesday)</h2>
<p>At this point, I figure enough time has elapsed that if the FBI wanted me to keep their secrets, they would have asked by now, so I just dump everything I had at that point.  The above covers it more thoroughly, and there&#39;s no screenshot this time; the raw post has the object ID <a href="https://freespeechextremist.com/objects/5c7246c1-024b-4e74-b4e2-7e88ef019024">https://freespeechextremist.com/objects/5c7246c1-024b-4e74-b4e2-7e88ef019024</a> if you want to dump that into your instance&#39;s search bar.  You can grab the <a href="https://media.freespeechextremist.com/rvl/full/3b728f5a93f3e4d6a8efb0022cbac0aa30e76a5fa20163743de8637d1a5e3368">raw JSON representing the post</a> if you want.
</p>
<p>There are a couple of bits worth including here, so I&#39;ll quote them.  I&#39;ve <a href="https://blog.freespeechextremist.com/blog/on-human-bots.html">mentioned this before on the blog</a>, but the tone on fedi is significantly less formal (one is less likely to tell the same joke at work on Monday morning that they told at the bar on Friday night), so please bear with me while I quote myself.  If you&#39;re unfamiliar with the slang, a &#34;fedpost&#34; is a post that includes threats of violence, and a &#34;glowie&#34; is a federal agent.  These terms are usually used humorously.
</p>
<blockquote>
<p>I can&#39;t find any other fedi instances on there, but this is a pretty annoying scraper to get rid of.
</p>
</blockquote>
<p>This hasn&#39;t changed; as far as I know, FSE is the only one they were scraping.
</p>
<blockquote>
<p>The glowies are (or want to convey that they are) specifically looking at threats against Blackrock executives.
</p>
</blockquote>
<p>It turns out that &#34;want to convey that they are&#34; was correct, but I didn&#39;t know that until much later.
</p>
<blockquote>
<p>Remember everyone that was freaking out about the various search engines on fedi, most recently as:Public? Remember that I keep saying that there are scrapers getting at fedi *without* identifying themselves? It turns out that I was right and this is because I AM A GODDAMN GENIUS and EVERYONE THAT HAS EVER TOLD ME THAT I AM WRONG IS A RETARDED COPROPHILIAC. There are scrapers getting data out of fedi without identifying themselves and at least one of them is selling data to the FBI.
</p>
</blockquote>
<p>This has still not sunk in for most of the people that are worried about, e.g., Archive Team, as:Public, FediList, etc.  (Especially the text in all-caps.)  I have linked to some other cases above.
</p>
<blockquote>
<p>I recommend that you be careful of fedposters on your instance.
</p>
</blockquote>
<p>I continue to recommend this.
</p>
<blockquote>
<p>I think I&#39;m going to reopen the public timeline and registrations, but that&#39;s tentative. Since boardreader.com is still attempting to scrape TWKN, if I reopen TWKN to people that aren&#39;t logged in, it will be with the terrible hacks I was using before to get boardreader.com to stop scraping.
</p>
</blockquote>
<p>I had <a href="https://archive.is/2cNG3">kept TWKN unavailable to the outside</a> still.
</p>

<p>It is important to note here that <em>every</em> sentence in the following paragraph is <em>completely</em> wrong.
</p>
<p>It looked like the situation with the FBI was over and they had what they wanted.  They were just following up on some idiot making a random threat on the internet.  So the balance remaining was just mopping-up and getting BoardReader off my back.  That shouldn&#39;t be too difficult!
</p>
<h2 id="2023_03_23__Thursday">2023-03-23 (Thursday)</h2>
<p>Despite promising to stop, BoardReader hasn&#39;t just kept scraping, but they are still trying to debug their scraper so that it can resume collecting posts:
</p>
<pre>[2023-03-22T14:57:57+00:00] 109.92.154.76 https://freespeechextremist.com/main/all [402] &#34;https://devtools.boardreader.com/&#34;
[2023-03-22T14:57:58+00:00] 109.92.154.76 https://freespeechextremist.com/main/all [402] &#34;https://devtools.boardreader.com/&#34;
[2023-03-22T14:58:03+00:00] 109.92.154.76 https://freespeechextremist.com/main/all [402] &#34;https://devtools.boardreader.com/&#34;
</pre>
<p>So I send SocialGist another email:
</p>
<blockquote>
<p>I sure would like to hear back from you confirming when your company plans to either comply with acceptable use or stop scraping my sites. I&#39;d expect ten days would be enough time.
</p>
</blockquote>
<p>I&#39;ve been keeping track of traffic referred to FSE by BoardReader.  Unsurprisingly, this post, written by a Markov bot that lives on a completely different server (and as always, attributed to FSE by BoardReader), is the most frequent URL that people land on if they come from BoardReader:
</p>
<img src="https://media.freespeechextremist.com/rvl/full/af87db5891bb570942ee3a1eb82eb9fdd608aab3c8be8e1a12da9b2bf181aa0d" alt="a bot rambling about CSAM for some reason"/>
<p>Anyone that is putting search terms into BoardReader and getting <em>that</em> post is someone that I would like to discourage from signing up.
</p>
<h2 id="2023_03_24__Friday__and_subsequent_weeks">2023-03-24 (Friday) and subsequent weeks</h2>
<p>Clearly, sending them emails and making sure that they can&#39;t scrape were not working, and they&#39;re still trying to fix their scraper, they&#39;re still hammering the API endpoint for fetching the posts.  Pedophiles are still landing on FSE, coming from boardreader.com.  That was the issue from the beginning, and it&#39;s been weeks.  I want to open the timelines back up, re-open registrations.  We&#39;ve been on lockdown too long!  Plus, the site is slow as hell because BoardReader is choking my server (even though they&#39;re getting no data, they&#39;re still sending multiple requests per second), and on top of that, I&#39;m paying bandwidth overage charges.
</p>
<p>Since I&#39;ve talked to them and got them to agree and I&#39;ve stopped sending them data, and they&#39;re still trying to get around the restrictions and still sending pedophiles, I&#39;ve exhausted reasonable methods.
</p>
<p>So I grab some samples of the timeline, and bash out a small <a href="https://web.archive.org/web/20100127161358/http://hoohoo.ncsa.illinois.edu/cgi/">CGI script</a>:  it just does string substitutions, mashing together accounts that do not exist and generating posts that do not exist.  (Initially the IDs were just random 32-bit numbers.  Eventually half the number varied per post and half was derived from the timestamp of the request, so I could trace the posts through BoardReader more easily.)  I don&#39;t bother making the URLs match actual Pleroma URLs:  why would I?  They just have to be unique.  I also have to start up <a href="https://www.lighttpd.net/">lighttpd</a> to serve it:  FSE uses nginx, but since nginx doesn&#39;t support CGI scripts (a travesty), I&#39;ve got to send the requests for that endpoint to lighttpd.  Because I was still all the way in awk mode, of course I just used awk.  For fun, I grabbed some lists of words to include in the posts:  some based on search terms people had used on BoardReader, and then rounded out with the CARNIVORE list.  (First search result; I don&#39;t know if it was the real list or not but it didn&#39;t really matter.)
</p>
<p>It worked:  you can see <a href="https://archive.is/aDKNA">an archived sample of the gibberish</a> or a <a href="https://media.freespeechextremist.com/rvl/full/1d4a30d103f90230ad734aa74e80ef292194a5ad4551946f4a3d4c529ea80831">screenshot of different gibberish</a>.  Of course, it worked beautifully:
</p>
<img src="https://media.freespeechextremist.com/rvl/full/1fb168a7c52fa9324326c4c0026488d2088e6493daadff22bdc8a825d606be75" alt="Searching for FSE posts on boardreader.com just gives gibberish"/>
<p>The only problem was that the scraper loved it <em>too</em> much.  We were suddenly getting DoS&#39;d by their scraper.  So I built in a little delay and then had a fun idea:  jam the BoardReader search terms in.  And I saw something <em>really</em> weird very suddenly:
</p>
<img src="https://media.freespeechextremist.com/rvl/full/7fd1ea217eb279e31a4fae7a6a976fa5be00e5bf65d8b7dfbf322b6b92fd99be" alt="timestamps and a large number of blue 4s and hyphens, explained below"/>
<p>This is an awk script that draws a histogram of the requests coming into FSE.  The basic idea is really simple:  the first version of it just printed a &#34;.&#34; and then when the timestamp changed, it printed a newline, too.  This draws a histogram for you of the number of requests per second, in real-time if you can convince awk not to buffer excessively (e.g., <code>mawk -Winteractive</code>).  By this time, it had gotten somewhat more sophisticated:  the hyphens represent requests that received a <a href="https://datatracker.ietf.org/doc/html/rfc2616#section-10.2">2xx status code</a>, the blue hyphens representing POST requests and the others GETs.  When the request resulted in some other status code, the first digit was printed.  The end of the line contains summary data:  number of requests that second in brackets, followed by the number of 5xx errors, followed by the ratio of server errors to total requests (as a fraction and a percentage) and the average number of requests per second.  Like many scripts that were unreasonably useful and then gew bit by bit (usually under duress, while trying to fix a problem with the server), it is nearly unreadable but is surprisingly compact and reliable.  (<a href="https://media.freespeechextremist.com/rvl/full/1965c57f5e3becafa64b68431d9d279ed6f7bcfcd94933c08a0f2496c8f1fb37">Here is the version that I was running when I took the screenshot</a> for the curious; you probably won&#39;t get any direct use out of it unless you&#39;re using the same logfile format as me, but if you can read it, it should be pretty straightforward:  it&#39;s messy, but not complex.)
</p>
<p>The big field of green-on-blue 4s sticks out:  those are requests that resulted in a 402, in this case almost all originating from Facebook, and all of them requesting URLs matching the fake posts.  Facebook shouldn&#39;t have been crawling FSE&#39;s public timeline.
</p>
<p>You might have noticed that the random IDs were present in the posts:  the script generating the random gibberish didn&#39;t keep any history, because I didn&#39;t want the problem of storing infinite random gibberish, but I could match posts on BoardReader to URLs in the webserver logs by just pasting these random IDs into the search form on BoardReader.  So I dropped IDs from the posts into the BoardReader search box, and that more or less confirmed it:  Facebook was fetching these posts shortly after BoardReader indexed them.  Apparently BoardReader was giving Facebook a feed of their data, but it wasn&#39;t just that:  there was a common thread in the gibberish, a pattern in the posts that Facebook was interested in.  You can probably guess the hypothesis, the test, and the result:  I opened up the CGI script and, where there had been a long, random list of words to cram into the posts, I replaced it with just one phrase:  &#34;larry fink&#34;.
</p>
<p>Almost as soon as I saved the file, Facebook started flooding my server.  I wanted my keystrokes to start echoing again so I un-did it, replacing the list with the previous version except without &#34;larry fink&#34;, and the flow slowed to a trickle and then stopped.  Curiosity got the best of me so I re-did it, and after the wait for Boardreader to index it, the flood resumed.
</p>
<p>So the pipeline was my terrible awk script generating JSON that represented gibberish posts, and that went out through lighttpd, then nginx, then it left my machine and went into BoardReader&#39;s crawlers, from there into their index (however that was built) and straight out to Facebook, and presumably from there to the FBI, and from there into whatever UI that was that they were using to search.  (Zuckerberg had just testified in Congress that Facebook was critical national infrastructure:  maybe he wasn&#39;t lying.)
</p>

<p>How <em>do</em> you get BoardReader to stop?  I couldn&#39;t get them to respond to emails and filling their database with gibberish wasn&#39;t helping.
</p>
<p>So I shoved some more delays in:  eventually I spaced out the writes until they were a trickle designed to finish exactly one second before the timeout happened.  That solved the bandwidth overages:  they were just using a trickle.  For fun, I tossed in a little more randomness:  once in a while, I&#39;d omit some random characters from the end so that it wouldn&#39;t parse.  Maybe if the error rate spiked, they&#39;d notice.  You can get partial data out of something like that if you&#39;re using an event-based parser or you&#39;ve structured it to use coroutines or thunks or whatever; the type of thing that builds up a data structure piecemeal and leaves you with a valid (if incomplete) data structure (and this approach can let you work with JSON structures that are too big to fit in memory, of course), but the overwhelming majority of JSON parsers just take a string and give you a data structure or an error:  it&#39;s easier to call something like that.  It looks like BoardReader is using the common type, so they spend about a minute on a single request and end up with no useful data.  The situation stays <a href="https://archive.is/U0CNN">exactly like that</a> for a while.
</p>
<p>It&#39;s annoying, but I don&#39;t have to worry about it too often.  I pop in and tweak the random timeline script&#39;s output or its behavior once in a while.  And then I have a pretty evil idea:  I just start putting Dave&#39;s phone number into the randomly generated posts.  The following morning I get a reply from Dave:
</p>
<blockquote>
<p>hey peter, sorry for the radio silence. i&#39;ve filed a jira ticket this week and hopefully will have an answer for you shortly. if we need any more information i&#39;ll loop in one of our engineers.
</p>
</blockquote>
<p>Guess it worked!  We go back and forth very briefly and they stop scraping pretty quickly, though it takes about a week for them to get FSE out of their index.  It shouldn&#39;t take a week for that to happen; whether they were stalling or it actually took that long, I probably won&#39;t find out.
</p>

<p>The story wrapped up just short of a year after it started, in a very unexpected way.
</p>

<p>Alan Winston Filion of Lancaster, CA—not too far from <a href="https://media.freespeechextremist.com/rvl/full/3bb1dad6a6d79223a2b49222bc03ab431734f4686acb5029722f2f16aabf61d5">my home</a>—is arrested:  <a href="https://www.wired.com/story/alan-filion-torswats-swatting-arrest/">https://www.wired.com/story/alan-filion-torswats-swatting-arrest/</a>, <a href="https://www.wired.com/story/torswats-swatting-arrest/">https://www.wired.com/story/torswats-swatting-arrest/</a>.
</p>
<p>Torswats.  The guy responsible for creating hundreds of bomb scares, fake hostage situations.  This was essentially a griefing tactic, and he had a long enough run that he was able to build up a little business making anonymous calls to the police and the FBI.
</p>
<p>It turns out that that&#39;s who the FBI was looking for.  That was &#34;WitchKingOfAngmar&#34;, which apparently is a &#34;Lord of the Rings&#34; reference.  That was why they were so interested in threats against Larry Fink:  apparently, Torswats had a habit of tirades full of nonsensical threats against Larry Fink.  Apparently there&#39;s a lot of information about Torswats on KiwiFarms:  <a href="https://archive.ph/yqwuA">https://archive.ph/yqwuA</a>.
</p>
<p>And that&#39;s it:  most of the things that didn&#39;t make sense about the story fit together after that.  There are still some murky bits:  what is BoardReader at present?  Just a front to give a plausible excuse to SocialGist to scrape?  Around 2010, scraping social media to find ISIS recruitment got popular, and of course, <a href="https://en.wikipedia.org/wiki/PRISM">PRISM</a> was the logical conclusion of that:  is BoardReader even a legitimate site at this point, or just the forum-scraping division of SocialGist?  What was Facebook doing in the pipeline?  Are they providing the FBI with tools for this kind of thing or do they just act as a convenient repository for this kind of data?
</p>

<p>The best advice is the advice that you are almost guaranteed not to take:  don&#39;t scrape fedi, it&#39;s evil.
</p>
<p>If you want data from fedi, just make a fake instance and cram it onto a bunch of <a href="https://fedilist.com/instance?software=activityrelay">relays</a>.  You&#39;re still a shady jagoff, but at least you don&#39;t break anyone else&#39;s server, it&#39;s easier than scraping, and the data gets delivered to you in real-time and dumped in your database rather than you having to make some Rube Goldberg system to extract it from unwilling participants.
</p>
<p>I usually make a remark like &#34;I wonder why they don&#39;t do this&#34; but I can&#39;t be sure they&#39;re not:  how <em>would</em> you know if anyone actually is doing that?  Maybe the only scrapers we know about are the noisy ones doing conventional scraping and the other ones don&#39;t make enough noise to cause problems.  People only noticed newjack.city because it was full of followbots, but you don&#39;t need to use followbots any more.  There are several varieties of <a href="https://fedilist.com/source-code">ActivityPub relay and ActivityPub software</a> and some of them lend themselves to repurposing as a scraper.  As demonstrated by <a href="https://fedilist.com/instance/gangstalking.services">gangstalking.services</a> (a <a href="https://media.freespeechextremist.com/rvl/full/987672a2f1853b5c21fe8de9e0b8ee012d9e476e0d82c047d72b5fa17061eda5">signed-fetch workaround</a> and <a href="https://media.freespeechextremist.com/rvl/full/61c804fbb9e9d9f83128bde6ddecc7ed20cd404a14f596ff5fa181afbcbf8628">proof of concept</a>) as well as <a href="https://fedilist.com/instance/pls.zuck.dad">pls.zuck.dad</a> and other instances, a lot of normal fedi software can be repurposed for this kind of thing.
</p>
<p>So, if you&#39;re not a shady asshole and you&#39;re just trying to run a server, keep it in mind.  A company like SocialGist can make themselves hard to find:  I only knew about them because they screwed up, but once I knew where to look, it wasn&#39;t difficult to create a trail of breadcrumbs.  How many people or organizations are out there doing the same thing, but <em>without</em> SocialGist&#39;s mistakes?  How would you know?
</p>
</section></section></div>
  </body>
</html>
