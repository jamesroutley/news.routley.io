<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/smparsons/retroboy">Original</a>
    <h1>Retro Boy: simple Game Boy emulator written in Rust, can be played on the web</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/logo.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/logo.png" width="175px" height="175px"/></a>
  </p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Introduction</h2><a id="user-content-introduction" aria-label="Permalink: Introduction" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Retro Boy is a cycle-accurate Game Boy emulator written in Rust. It uses <code>wasm-pack</code> to translate the Rust code into WebAssembly so it can be played on the web. The web frontend then uses Web Audio API and HTML Canvas for audio and graphics. It also leverages the browser&#39;s local storage to persist cartridge RAM data for battery-backed MBC cartridges.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Accurate CPU that passes all <a href="https://github.com/adtennant/GameboyCPUTests">JSON CPU tests</a></li>
<li>Accurate audio emulation</li>
<li>Graphics emulation built using a scanline-based renderer</li>
<li>MBC1, MBC3, MBC5, and HuC1 support</li>
<li>RTC support for MBC3 cartridges</li>
<li>Cartridge RAM that persists to browser local storage for battery-backed cartridges</li>
<li>Support for GameShark or GameGenie cheats</li>
<li>A web frontend that supports:
<ul dir="auto">
<li>Fullscreen mode</li>
<li>Pausing/resuming</li>
<li>Selectable monochrome or color modes</li>
<li>Customizable key map for game controls</li>
<li>Management and enabling/disabling of game cheat codes</li>
<li>A mobile-friendy responsive design</li>
</ul>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">How to Compile to WebAssembly</h2><a id="user-content-how-to-compile-to-webassembly" aria-label="Permalink: How to Compile to WebAssembly" href="#how-to-compile-to-webassembly"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To compile the implementation to WebAssembly, you will first need to install wasm-pack with the command <code>cargo install wasm-pack</code> if you haven&#39;t done so already. Then, run <code>sh ./build-wasm.sh</code> to build the core project and generate the Javascript binding code in the web frontend directory.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Web Frontend</h2><a id="user-content-web-frontend" aria-label="Permalink: Web Frontend" href="#web-frontend"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The web frontend for this emulator is a React/TypeScript app designed with Material UI. It is located in the frontends/web folder. The UI provides the ability to load a ROM as well as play, pause, or reset the emulator. It also provides a fullscreen mode.</p>
<p dir="auto">To run the web frontend:</p>
<ol dir="auto">
<li>Compile the Rust code to WebAssembly and generate the Javascript binding code as described in the &#34;How to Compile to WebAssembly&#34; section.</li>
<li>When the binding code is generated, it will be added to the frontends/web/src/core directory.</li>
<li>Run <code>yarn install</code> in the frontends/web directory to install all dependencies.</li>
<li>Run <code>yarn start</code> in the same directory to run the application locally.</li>
</ol>
<div dir="auto"><h2 tabindex="-1" dir="auto">Screenshots</h2><a id="user-content-screenshots" aria-label="Permalink: Screenshots" href="#screenshots"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/pokemon-red.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/pokemon-red.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/pokemon-crystal.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/pokemon-crystal.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/yugioh-dds.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/yugioh-dds.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/marble-madness.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/marble-madness.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/pacman.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/pacman.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/super-mario-land.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/super-mario-land.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/tetris.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/tetris.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/kirby.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/kirby.png" width="240"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://www.wildlondon.org.uk/smparsons/retroboy/blob/main/images/screenshots/links-awakening.png"><img src="https://www.wildlondon.org.uk/smparsons/retroboy/raw/main/images/screenshots/links-awakening.png" width="240"/></a>
</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Test ROMs</h2><a id="user-content-test-roms" aria-label="Permalink: Test ROMs" href="#test-roms"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This emulator passes the following test suites from Blargg&#39;s test ROM collection:</p>
<ol dir="auto">
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/cpu_instrs">CPU instruction tests</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/instr_timing">CPU instruction timing tests</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/mem_timing">Memory timing tests</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/mem_timing-2">Memory timing tests 2</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/interrupt_time">Interrupt timing tests (CGB)</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/dmg_sound">APU tests (DMG)</a></li>
<li><a href="https://github.com/retrio/gb-test-roms/tree/master/cgb_sound">APU tests (CGB)</a></li>
</ol>
<p dir="auto">Additionally, this emulator passes all <a href="https://github.com/adtennant/GameboyCPUTests">JSON CPU tests</a>, and
only some tests from the <a href="https://github.com/Gekkio/mooneye-test-suite">Mooneye test ROM collection</a>.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Test Suite</h2><a id="user-content-test-suite" aria-label="Permalink: Test Suite" href="#test-suite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This project holds a fairly extensive test suite, as the bulk of the logic was designed using a TDD approach. There are a lot of tests that exercise CPU opcodes, and basic tests that exercise the GPU. Run <code>cargo test</code> to run the test suite.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Helpful Resources</h2><a id="user-content-helpful-resources" aria-label="Permalink: Helpful Resources" href="#helpful-resources"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">For convenience, here is a list of the resources I used to build this emulator:</p>
<ol dir="auto">
<li><a href="http://marc.rawer.de/Gameboy/Docs/GBCPUman.pdf" rel="nofollow">Gameboy CPU Manual</a></li>
<li><a href="https://gbdev.io/pandocs/" rel="nofollow">Pan Docs</a></li>
<li><a href="https://github.com/retrio/gb-test-roms">Blargg&#39;s Test ROM Collection</a></li>
<li><a href="https://github.com/robert/gameboy-doctor">Gameboy Doctor</a></li>
<li><a href="https://imrannazar.com/series/gameboy-emulation-in-javascript" rel="nofollow">Imran Nazar&#39;s Gameboy Emulator Tutorial</a></li>
</ol>
</article></div></div>
  </body>
</html>
