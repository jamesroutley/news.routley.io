<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.mozilla.ai/map-features-in-openstreetmap-with-computer-vision/">Original</a>
    <h1>Map Features in OpenStreetMap with Computer Vision</h1>
    
    <div id="readability-page-1" class="page"><section>
            <h3 id="motivation">Motivation</h3><p>At Mozilla.ai, we believe that there are a lot of opportunities where artificial intelligence (AI) can empower communities driven by open collaboration. </p><p>These opportunities need to be designed carefully, though, as many members of these communities (and people in general) are increasingly worried about the amount of <a href="https://en.wikipedia.org/wiki/AI_slop?ref=blog.mozilla.ai"><u>AI slop</u></a> flooding the internet.</p><p>With this idea in mind we developed and released the <a href="https://github.com/mozilla-ai/osm-ai-helper?ref=blog.mozilla.ai"><u>OpenStreetMap AI Helper</u></a> Blueprint. If you love maps and are interested in training your own computer vision model, you’ll enjoy diving into this Blueprint.</p><h3 id="why-openstreetmap">Why OpenStreetMap?</h3><p>Data is one of the most important components of any AI application, and <a href="https://www.openstreetmap.org/?ref=blog.mozilla.ai"><u>OpenStreetMap</u></a> has a vibrant community that collaborates to maintain and extend the most complete open map database available. </p><p>If you haven’t heard of it, <a href="https://www.openstreetmap.org/?ref=blog.mozilla.ai"><u>OpenStreetMap</u></a> is an open, editable map of the world created by a community of mappers who contribute and maintain data about roads, trails, cafés, railway stations, and more.</p><p>Combined with other sources, like satellite imagery, this database offers infinite possibilities to train different AI models.</p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeQ5_VUhyWiLkZAqDkmqKu7p3vT5hC873l9vFSbduVam2uC3odROrGsOWLUdbYi9ZHAyWLHR-QT2SoowtHgqxcR_aaaJu6joEG6cNMhxdV2IiAvAToa_TQkic9Qx8sgkFxzTPBZ?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="624" height="351"/></figure><p>As a long-time user and contributor to <a href="https://www.openstreetmap.org/?ref=blog.mozilla.ai"><u>OpenStreetMap</u></a> , I wanted to build an end-to-end application where a model is first trained with this data and then used to contribute back.</p><p>The idea is to use AI to speed up the slower parts of the mapping process (roaming around the map, drawing polygons) while keeping a human in the loop for the critical parts (verifying that the generated data is correct).</p><h3 id="why-computer-vision">Why Computer Vision?</h3><p>Large Language Models (LLM) and, more recently, Visual Language Models (VLM) are sucking all the oxygen out of the AI room, but there are a lot of interesting applications that don’t (need to) use this type of models.</p><p>Many of the <a href="https://wiki.openstreetmap.org/wiki/Map_features?ref=blog.mozilla.ai"><u>Map Features</u></a> you can find in OpenStreetMap are represented with a polygon (&#39;Area&#39;). It turns out that finding and drawing these polygons is a very time consuming task for a human, but Computer Vision models can be easily trained for the task (when provided with enough data).</p><p>We chose to split the work of finding and drawing map features into 2 computer vision tasks using state-of-the-art non-LLM models: </p><ul><li><strong>Object Detection</strong> with <a href="https://docs.ultralytics.com/es/models/yolo11/?ref=blog.mozilla.ai"><u>YOLOv11</u></a>, by <a href="https://www.ultralytics.com/?ref=blog.mozilla.ai" rel="noreferrer">Ultralytics</a>, which identifies where relevant features exist in an image.</li><li><strong>Segmentation </strong>with <a href="https://ai.meta.com/sam2/?ref=blog.mozilla.ai"><u>SAM2</u></a>, by <a href="https://ai.meta.com/?ref=blog.mozilla.ai" rel="noreferrer">Meta</a>, which refines the detected features by outlining their exact shape.</li></ul><p>These models are lightweight, fast, and local-friendly – it’s refreshing to work with models that don’t demand a high-end GPU just to function. As an example, the combined weights of YOLOv11 and SAM2 take much less disk space (&lt;250MB) than any of the smallest Visual Language Models available, like <a href="https://huggingface.co/HuggingFaceTB/SmolVLM-Base?ref=blog.mozilla.ai"><u>SmolVLM </u></a>(4.5GB).</p><p>By combining these models, we can automate much of the mapping process while keeping humans in control for final verification.</p><h3 id="the-openstreetmap-ai-helper-blueprint">The OpenStreetMap AI Helper Blueprint</h3><p>The Blueprint can be divided into 3 stages:</p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeAMhkrtYiDH7ZMsybzM7GF1KSiJMUTddPlc-xyfzlVdW6Mkd1xrtEFK81P_27vNHCMCnHGpEwEQN5-wIrkGKax_JpiBrClnzi1hVzMrrVvfpHk3fwd1fu_uiHmxxrpGiZcnKsqBA?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="624" height="160"/></figure><p><strong>Stage 1: Create an Object Detection dataset from OpenStreetMap</strong></p><p>The first stage involves fetching data from OpenStreetMap, combining it with satellite images, and transforming it into a format suitable for training.</p><p>You can run it yourself in the <a href="https://colab.research.google.com/github/mozilla-ai/osm-ai-helper/blob/main/demo/create_dataset.ipynb?ref=blog.mozilla.ai"><u>Create Dataset Colab</u></a>.</p><p>For fetching OpenStreetMap data, we use:</p><ul><li>The <a href="https://nominatim.org/?ref=blog.mozilla.ai"><u>Nominatim API</u></a> to provide users with a flexible way of selecting an area of interest. In our swimming pool example, we use <a href="https://nominatim.openstreetmap.org/ui/details.html?osmtype=R&amp;osmid=349036&amp;class=boundary&amp;ref=blog.mozilla.ai"><u>Galicia</u></a> for training and <a href="https://nominatim.openstreetmap.org/ui/details.html?osmtype=R&amp;osmid=3808752&amp;class=boundary&amp;ref=blog.mozilla.ai"><u>Viana do Castelo</u></a> for validation.</li><li>The <a href="https://wiki.openstreetmap.org/wiki/Overpass_API?ref=blog.mozilla.ai"><u>Overpass API</u></a> to download all the relevant polygons using specific <a href="https://wiki.openstreetmap.org/wiki/Tags?ref=blog.mozilla.ai"><u>tags</u></a> within the selected area of interest. In our swimming pool example, we use <a href="https://wiki.openstreetmap.org/wiki/Tag:leisure=swimming_pool?ref=blog.mozilla.ai"><u>leisure=swimming_pool</u></a> discarding the ones also tagged with <a href="https://wiki.openstreetmap.org/wiki/Tag:location%3Dindoor?ref=blog.mozilla.ai"><u>location=indoor</u></a>.</li></ul><p>Once all the polygons have been downloaded, you can choose a <a href="https://docs.mapbox.com/help/glossary/zoom-level/?ref=blog.mozilla.ai"><u>zoom level</u></a>. We use this zoom level to first identify all the tiles that contain a polygon and then download them using the <a href="https://docs.mapbox.com/api/maps/static-tiles/?ref=blog.mozilla.ai"><u>Static Tiles API</u></a> from <a href="https://www.mapbox.com/?ref=blog.mozilla.ai"><u>Mapbox</u></a>.</p><p>The polygons in latitude and longitude coordinates are transformed to a bounding box in pixel coordinates relative to each tile and then saved in the <a href="https://docs.ultralytics.com/datasets/detect/?ref=blog.mozilla.ai#ultralytics-yolo-format"><u>Ultralytics YOLO format</u></a>.</p><p>Finally, the dataset is uploaded to the <a href="https://huggingface.co/docs/hub/datasets?ref=blog.mozilla.ai"><u>Hugging Face Hub</u></a>. You can check our example <a href="https://huggingface.co/datasets/mozilla-ai/osm-swimming-pools?ref=blog.mozilla.ai"><u>mozilla-ai/osm-swimming-pools</u></a>.</p><p><strong>Stage 2 - Finetune an Object Detection model</strong></p><p>Once the dataset is uploaded in the right format, finetuning a <a href="https://docs.ultralytics.com/models/yolo11/?ref=blog.mozilla.ai"><u>YOLOv11</u></a> (or any other model supported by Ultralytics) is quite easy. </p><p>You can run it yourself in the <a href="https://colab.research.google.com/github/mozilla-ai/osm-ai-helper/blob/main/demo/finetune_model.ipynb?ref=blog.mozilla.ai"><u>Finetune Model Colab</u></a> and check all the <a href="https://docs.ultralytics.com/modes/train/?ref=blog.mozilla.ai#augmentation-settings-and-hyperparameters"><u>available hyperparameters</u></a>.</p><p>Once the model is trained, it is also uploaded to the <a href="https://huggingface.co/docs/hub/datasets?ref=blog.mozilla.ai"><u>Hugging Face Hub</u></a>. You can check our example <a href="https://huggingface.co/mozilla-ai/swimming-pool-detector?ref=blog.mozilla.ai"><u>mozilla-ai/swimming-pool-detector</u></a>.</p><p><strong>Stage 3 - Contributing to OpenStreetMap</strong></p><p>Once you have a finetuned Object Detection model, you can use it to run inference across multiple tiles. </p><p>You can run inference yourself in the <a href="https://colab.research.google.com/github/mozilla-ai/osm-ai-helper/blob/main/demo/run_inference.ipynb?ref=blog.mozilla.ai"><u>Run Inference Colab</u></a>. </p><p>We also provide a hosted demo where you can try our example swimming pool detector: <a href="https://huggingface.co/spaces/mozilla-ai/osm-ai-helper?ref=blog.mozilla.ai"><u>HuggingFace Demo</u></a>.</p><p>The inference requires a couple of human interactions. First, you need to first pick a point of interest in the map:</p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXczl1Ib_aQv-G0IUYx7lKv4s1eTCGt1AKHI8G_d9IpbUKtRfV--HyjkxVYT-AdiZ5e-5VeF-TuhRotvvsMOx4SWVFDDaoZtPPxuoYHStzl-a1aWrIn_hy8WpxBbx97sQtEvMEaniw?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="624" height="315"/></figure><p>After a point is selected, a bounding box is computed around it based on the <em>margin </em>argument.</p><p>All the existing elements of interest are downloaded from <a href="https://www.openstreetmap.org/?ref=blog.mozilla.ai"><u>OpenStreetMap</u></a>, and all the tiles are downloaded from <a href="https://www.mapbox.com/?ref=blog.mozilla.ai"><u>Mapbox</u></a> and joined to create a stacked image.</p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeP6u-8eEa5cfLIZurqx4zcct2TeWMMFD999MfRNC0F4uQ7kaqBZPmdeUdQrVwB1fiS4MBPlpL86Vljev1WlvxtZhXGB5qy9d1Ghbh9lKlim3UsDyZTkANaU2TLwgx13URfCJRJnQ?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="599" height="601"/></figure><p>The stacked image is divided into overlapping tiles. For each tile, we run the Object Detection model (<a href="https://docs.ultralytics.com/models/yolo11/?ref=blog.mozilla.ai">YOLOv11</a>). If an object of interest is detected (e.g. a swimming pool), we pass the bounding box to the Segmentation model (<a href="https://github.com/facebookresearch/sam2?ref=blog.mozilla.ai"><u>SAM2</u></a>) to obtain a segmentation mask.</p><figure><img src="https://blog.mozilla.ai/content/images/2025/02/image.png" alt="" loading="lazy" width="1106" height="590" srcset="https://blog.mozilla.ai/content/images/size/w600/2025/02/image.png 600w, https://blog.mozilla.ai/content/images/size/w1000/2025/02/image.png 1000w, https://blog.mozilla.ai/content/images/2025/02/image.png 1106w" sizes="(min-width: 720px) 720px"/></figure><p>All the predicted polygons are checked against the existing ones, downloaded from OpenStreetMap, in order to avoid duplicates. All those identified as <em>new </em>are displayed one by one for manual verification and filtering.</p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfwAlhR0KxRyrjR8RPsYBbhdhYQn6udmJi_QeeAelz52YHK_K5UNLIbvI7RsAG1tsgzb0HKGB1MTezBjOlZRtfdpAfhIY1UMOlAmM_GxPSyQeYcn1J_cB9FdMLlu9-mUG7k13FAiQ?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="624" height="301"/></figure><p>The ones you chose to keep will be then uploaded to OpenStreetMap in a single <a href="https://wiki.openstreetmap.org/wiki/Changeset?ref=blog.mozilla.ai"><u>changeset</u></a><u>.</u></p><figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXewc5Qru4SyT3SBDxHV7EDGZ8XEjwV7P4uFAIhY-zkIafmJ_GP8yBeul4yNb9qAVOVfsIgFrfs7oaLq2Tb0HKuF_oWWXcx75likKPmGkyUF_uc9hCDhsgLXOC4OthbZZVGSZAcf?key=ZPV5MptphH1GvdigS7RavJFc" alt="" loading="lazy" width="624" height="293"/></figure><h3 id="closing-thoughts">Closing thoughts</h3><p>OpenStreetMap is a powerful example of open collaboration to create a rich, community-driven map of the world. </p><p>The OpenStreatMap AI Helper Blueprint shows that, with the right approach, AI can enhance human contributions while keeping human verification at the core. In the fully manual process it takes about 1 min to map 2-3 swimming pools, whereas using the blueprint, even without an optimized UX, I can map about 10-15 in the same time (~5x more).</p><p>It also highlights the value of high-quality data from projects like OpenStreetMap, which enables to easily train models like YOLOv11 to perform object detection – proving that you shouldn’t always throw an LLM at the problem.</p><p>We’d love for you to try the <a href="https://github.com/mozilla-ai/osm-ai-helper?ref=blog.mozilla.ai"><u>OpenStreetMap AI Helper Blueprint</u></a> and experiment with training a model on a different map feature. If you’re interested, feel free to contribute to the repo to help improve it, or fork it to extend it even further!</p><p>To find other Blueprints we’ve released, check out the <a href="https://developer-hub.mozilla.ai/blueprints?ref=blog.mozilla.ai" rel="noopener noreferrer">Blueprints Hub</a>.</p>
        </section></div>
  </body>
</html>
