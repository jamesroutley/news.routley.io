<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hacks.mozilla.org/2022/02/version-100-in-chrome-and-firefox/">Original</a>
    <h1>Version 100 in Chrome and Firefox</h1>
    
    <div id="readability-page-1" class="page"><article role="article">
    <p>Chrome and Firefox will reach version 100 in a <a href="https://developer.chrome.com/blog/force-major-version-to-100/">couple</a> of <a href="https://www.otsukare.info/2021/04/20/ua-three-digits-get-ready">months</a>. This has the potential to cause breakage on sites that rely on identifying the browser version to perform business logic.  This post covers the timeline of events, the strategies that Chrome and Firefox are taking to mitigate the impact, and how you can help.</p>
<h2>User-Agent string</h2>
<p><a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-5.5.3">User-Agent (UA)</a> is a string that browsers send in HTTP headers, so servers can identify the browser.  The string is also accessible through JavaScript with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/userAgent">navigator.userAgent</a>. It’s usually formatted as follows:</p>
<p><code>browserName/majorVersion.minorVersion</code></p>
<p>For example, the latest release versions of browsers at the time of publishing this post are:</p>
<ul>
<li aria-level="1"><code>Chrome: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.54 Safari/537.36</code></li>
<li aria-level="1"><code>Firefox: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:96.0) Gecko/20100101 Firefox/96.0</code></li>
<li aria-level="1"><code>Safari: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15</code></li>
</ul>
<h2>Major version 100—three-digit version number</h2>
<p>Major version 100 is a big milestone for both Chrome and Firefox. It also has the potential to cause breakage on websites as we move from a two-digit to a <b>three-digit version number</b>.  Web developers use all kinds of techniques for parsing these strings, from custom code to using User-Agent parsing libraries, which can then be used to determine the corresponding processing logic. The User-Agent and any other version reporting mechanisms will soon report a three-digit version number.</p>
<h3>Version 100 timelines</h3>
<p>Version 100 browsers will be first released in experimental versions (Chrome Canary, Firefox Nightly), then beta versions, and then finally on the stable channel.</p>

<h2 id="three-digit">Why can a three-digit version number be problematic?</h2>
<p>When browsers first reached version 10 a little over 12 years ago, <a href="https://maqentaer.com/devopera-static-backup/http/dev.opera.com/articles/view/opera-ua-string-changes/index.html">many issues were discovered</a> with User-Agent parsing libraries as the major version number went from one digit to two.</p>
<p>Without a single specification to follow, <a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/User-Agent">different browsers have different formats</a> for the User-Agent string, and site-specific User-Agent parsing. It’s possible that some parsing libraries may have hard-coded assumptions or bugs that don’t take into account three-digit major version numbers.  Many libraries improved the parsing logic when browsers moved to two-digit version numbers, so hitting the three-digit milestone is expected to cause fewer problems. Mike Taylor, an engineer on the Chrome team, has done a survey of common UA parsing libraries which didn’t uncover any issues. Running Chrome experiments in the field has surfaced some issues, which are being worked on.</p>
<h2>What are browsers doing about it?</h2>
<p>Both Firefox and Chrome have been running experiments where current versions of the browser report being at major version 100 in order to detect possible website breakage. This has led to a few <a href="https://github.com/webcompat/web-bugs/labels/version100">reported</a> <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1273958">issues</a>, some of which have already been fixed. These experiments will continue to run until the release of version 100.</p>
<p>There are also backup mitigation strategies in place, in case version 100 release to stable channels causes more damage to websites than anticipated.</p>
<h2 id="firefox-mitigation">Firefox mitigation</h2>
<p>In Firefox, the strategy will depend on how important the breakage is. Firefox has a <a href="https://wiki.mozilla.org/Compatibility/Interventions_Releases">site interventions mechanism</a>. Mozilla webcompat team can hot fix broken websites in Firefox using this mechanism. If you type <code>about:compat</code> in the Firefox URL bar, you can see what is currently being fixed. If a site breaks with the major version being 100 on a specific domain, it is possible to fix it by sending version 99 instead.</p>
<p>If the breakage is widespread and individual site interventions become unmanageable, Mozilla can temporarily freeze Firefox’s major version at 99 and then test other options.</p>
<h2 id="chrome-mitigation">Chrome mitigation</h2>
<p>In Chrome, the backup plan is to use a flag to freeze the major version at 99 and report the real major version number in the minor version part of the User-Agent string (the code has already <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3341658">landed</a>).</p>
<p>The Chrome version as reported in the User-Agent string follows the pattern &lt;major_version&gt;.&lt;minor_version&gt;.&lt;build_number&gt;.&lt;patch_number&gt;.</p>
<p>If the backup plan is employed, then the User-Agent string would look like this:</p>
<p><code>99.101.4988.0</code></p>
<p>Chrome is also running experiments to ensure that reporting a three-digit value in the minor version part of the string does not result in breakage, since the minor version in the Chrome User-Agent string has reported 0 for a very long time. The Chrome team will decide on whether to resort to the backup option based on the number and severity of the issues reported.</p>
<h2>What can you do to help?</h2>
<p>Every strategy that adds complexity to the User-Agent string has a strong impact on the ecosystem. Let’s work together to avoid yet another quirky behavior. In Chrome and Firefox Nightly, you can configure the browser to report the version as 100 right now and report any issues you come across.</p>
<h3 id="firefox-config">Configure Firefox Nightly to report the major version as 100</h3>
<ol>
<li aria-level="1">Open Firefox Nightly’s Settings menu.</li>
<li aria-level="1">Search for “Firefox 100” and then check the “Firefox 100 User-Agent String” option.</li>
</ol>
<h3 id="chrome-config">Configure Chrome to report the major version as 100</h3>
<ol>
<li aria-level="1">Go to chrome://flags/#force-major-version-to-100</li>
<li aria-level="1">Set the option to `Enabled`.</li>
</ol>
<h3 id="test-report">Test and file reports</h3>
<ul>
<li aria-level="1"><b>If you are a website maintainer</b>, test your website with Chrome and Firefox 100. Review your User-Agent parsing code and libraries, and ensure they are able to handle three-digit version numbers. We have compiled some of the <a href="https://www.otsukare.info/2022/01/14/broken-ua-detection">patterns that are currently breaking</a>.</li>
<li aria-level="1"><b>If you develop a User-Agent parsing library</b>, add tests to parse versions greater than and equal to 100. Our early tests show that recent versions of libraries can handle it correctly. But the Web is a legacy machine, so if you have old versions of parsing libraries, it’s probably time to check and eventually upgrade.</li>
<li aria-level="1"><b>If you are browsing the web</b> and notice any issues with the major version 100, <a href="https://webcompat.com/issues/new?label=version100">file a report on webcompat.com</a>.</li>
</ul>
    <section>
                                
                      <p><a href="http://www.otsukare.info/2013/08/01/why-now">Always elsewhere</a>.</p>
                                <p><a href="https://hacks.mozilla.org/author/kdubostmozilla-com/">More articles by Karl Dubost…</a></p>
                  
                      <p>Chris is a developer on Mozilla&#39;s Firefox for Android team.</p>
                                <p><a href="https://hacks.mozilla.org/author/chrispeterson/">More articles by Chris Peterson…</a></p>
                  
                      <p>Ali Beyad is a Staff Software Engineer at Google
</p>
                                <p><a href="https://hacks.mozilla.org/author/">More articles by Ali Beyad…</a></p>
                  </section>
  </article></div>
  </body>
</html>
