<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.evanmiller.org/statistical-formulas-for-programmers.html">Original</a>
    <h1>Statistical Formulas for Programmers (2013)</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
        
        <div>

<p>By <a href="https://www.evanmiller.org/">Evan Miller</a></p>

<p><em>May 19, 2013</em></p>





<p>Being able to apply statistics is like having a secret superpower.</p>

<p>Where most people see averages, you see confidence intervals.</p>

<p>When someone says “7 is greater than 5”, you declare that they’re really the same.</p>

<p>In a cacophony of noise, you hear a cry for help.</p>

<p><img src="https://www.evanmiller.org/images/formulas/superman.jpg" height="280"/>
</p>

<p>Unfortunately, not enough programmers have this superpower. That’s a shame, because the application of statistics can almost always enhance the display and interpretation of data.</p><p>As my modest contribution to developer-kind, I’ve collected together the statistical formulas that I find to be most useful; this page presents them all in one place, a sort of statistical cheat-sheet for the practicing programmer.</p>

<p>Most of these formulas can be found in Wikipedia, but others are buried in journal articles or in professors’ web pages. They are all classical (not Bayesian), and to motivate them I have added concise commentary. I’ve also added links and references, so that even if you’re unfamiliar with the underlying concepts, you can go out and learn more. Wearing a red cape is optional.</p>

<p>Send suggestions and corrections to emmiller@gmail.com</p>

<hr/>

<h2>Table of Contents</h2>

<ol>
    <li><strong><a href="#mean">Formulas For Reporting Averages</a></strong>
    <ol>
        <li><a href="#mean_sd">Corrected Standard Deviation</a>
        </li><li><a href="#mean_se">Standard Error of the Mean</a>
        </li><li><a href="#mean_ci">Confidence Interval Around the Mean</a>
        </li><li><a href="#mean_t">Two-Sample T-Test</a>
    </li></ol>
    </li><li><strong><a href="#prop">Formulas For Reporting Proportions</a></strong>
    <ol>
        <li><a href="#prop_ci">Confidence Interval of a Bernoulli Parameter</a>
        </li><li><a href="#prop_mci">Multinomial Confidence Intervals</a>
        </li><li><a href="#prop_chi">Chi-Squared Test</a>
    </li></ol>
    </li><li><strong><a href="#count">Formulas For Reporting Count Data</a></strong>
    <ol>
        <li><a href="#count_sd">Standard Deviation of a Poisson Distribution</a>
        </li><li><a href="#count_ci">Confidence Interval Around the Poisson Parameter</a>
        </li><li><a href="#count_test">Conditional Test of Two Poisson Parameters</a>
    </li></ol>
    </li><li><strong><a href="#dist">Formulas For Comparing Distributions</a></strong>
    <ol>
        <li><a href="#dist_1">Comparing an Empirical Distribution to a Known Distribution</a>
        </li><li><a href="#dist_2">Comparing Two Empirical Distributions</a>
        </li><li><a href="#dist_k">Comparing Three or More Empirical Distributions</a>
    </li></ol>
    </li><li><strong><a href="#trend">Formulas For Drawing a Trend Line</a></strong>
    <ol>
        <li><a href="#trend_slope">Slope of a Best-Fit Trend Line</a>
        </li><li><a href="#trend_se">Standard Error of the Slope</a>
        </li><li><a href="#trend_ci">Confidence Interval Around the Slope</a>
    </li></ol>
</li></ol>

<hr/>

<h2>1. Formulas For Reporting Averages</h2>

<p>One of the first programming lessons in any language is to compute an average. But rarely does anyone stop to ask: what does the average actually tell us about the underlying data?</p>

<h3>1.1 Corrected Standard Deviation</h3>

<p>The standard deviation is a single number that reflects how <em>spread out</em> the data actually is. It should be reported alongside the average (unless the user will be confused).</p><p>

\[
s = \sqrt{\frac{1}{N-1} \sum_{i=1}^N(x_i - \bar{x})^2}
\]

</p><p>Where:</p>
<ul>
    <li>\(N\) is the number of observations</li>
    <li>\(x_i\) is the value of the \(i\)<sup>th</sup> observation</li>
    <li>\(\bar{x}\) is the average value of \(x_i\)</li>
</ul>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Standard_deviation">Standard deviation (Wikipedia)</a></p>

<h3>1.2 Standard Error of the Mean</h3>

<p>From a statistical point of view, the &#34;average&#34; is really just an <em>estimate</em> of an underlying population mean. That estimate has uncertainty that is summarized by the standard error.</p><p>

\[
SE = \frac{s}{\sqrt{N}}
\]

</p><p>Reference: <a href="https://en.wikipedia.org/wiki/Standard_error">Standard error (Wikipedia)</a></p>

<h3>1.3 Confidence Interval Around the Mean</h3>

<p>A confidence interval reflects the set of statistical hypotheses that won’t be rejected at a given significance level. So the confidence interval around the mean reflects all possible values of the mean that can’t be rejected by the data. It is a multiple of the standard error added to and subtracted from the mean.</p><p>

\[
CI = \bar{x} \pm t_{\alpha/2} SE
\]

</p><p>Where:</p>
<ul>
    <li>\(\alpha\) is the significance level, typically 5% (one minus the confidence level)</li>
    <li>\(t_{\alpha/2}\) is the \(1-\alpha/2\) quantile of a t-distribution with \(N-1\) degrees of freedom</li>
</ul>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Confidence_interval#Theoretical_example">Confidence interval (Wikipedia)</a></p>

<h3>1.4 Two-Sample T-Test</h3>

<p>A two-sample t-test can tell whether two groups of observations differ in their mean.</p>

<p>The test statistic is given by:</p><p>

\[
t = \frac{\bar{x_1} - \bar{x_2}}{\sqrt{s^2_1/n_1 + s^2_2/n_2}}
\]

</p><p>The hypothesis of equal means is rejected if \(|t|\) exceeds the \((1-\alpha/2)\) quantile of a t distribution with degrees of freedom equal to:</p><p>

\[
{\rm df} = \frac{(s_1^2/n_1+s_2^2/n_2)^2}{(s_1^2/n_1)^2/(n_1-1)+(s_2^2/n_2)^2/(n_2-1)}
\]

</p><p>You can see a demonstration of these concepts in <a href="https://www.evanmiller.org/ab-testing/t-test.html">Evan’s Awesome Two-Sample T-Test</a>.</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#Unequal_.28or_equal.29_sample_sizes.2C_unequal_variances">Student’s t-test (Wikipedia)</a></p>

<hr/>

<h2>2. Formulas For Reporting Proportions</h2>

<p>It’s common to report the relative proportions of binary outcomes or categorical data, but in general these are meaningless without confidence intervals and tests of independence.</p>

<h3>2.1 Confidence Interval of a Bernoulli Parameter</h3>

<p>A Bernoulli parameter is the proportion underlying a binary-outcome event (for example, the percent of the time a coin comes up heads). The confidence interval is given by:</p><p>

\[
CI = \left(p + \frac{z^2_{\alpha/2}}{2N} \pm z_{\alpha/2} \sqrt{[p(1-p) + z^2_{\alpha/2}/4N]/N}\right)/(1+z^2_{\alpha/2}/N)
\]

</p><p>Where:</p>
<ul>
    <li>\(p\) is the observed proportion of interest</li>
    <li>\(z_{\alpha/2}\) is the \((1-\alpha/2)\) quantile of a normal distribution</li>
</ul>

<p>This formula can also be used as a <a href="https://www.evanmiller.org/how-not-to-sort-by-average-rating.html">sorting criterion</a>.</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Wilson_score_interval">Binomial proportion confidence interval (Wikipedia)</a></p>

<h3>2.2 Multinomial Confidence Intervals</h3>

<p>If you have more than two categories, a multinomial confidence interval supplies upper and lower confidence limits on all of the category proportions at once. The formula is nearly identical to the preceding one.</p><p>

\[
CI = \left(p_j + \frac{z^2_{\alpha/2}}{2N} \pm z_{\alpha/2} \sqrt{[p_j(1-p_j) + z^2_{\alpha/2}/4N]/N}\right)/(1+z^2_{\alpha/2}/N)
\]
</p><p>Where:</p>
<ul>
    <li>\(p_j\) is the observed proportion of the \(j\)th category</li>
</ul>

<p>Reference: <a href="http://www.math.wsu.edu/faculty/genz/papers/mvnsing/node8.html">Confidence Intervals for Multinomial Proportions</a></p>

<h3>2.3 Chi-Squared Test</h3>

<p>Pearson’s chi-squared test can detect whether the distribution of row counts seem to differ across columns (or vice versa). It is useful when comparing two or more sets of category proportions.</p>

<p>The test statistic, called \(X^2\), is computed as:</p><p>

\[
X^2 = \sum_{i=1}^{n}\sum_{j=1}^m \frac{(O_{i,j} - E_{i,j})^2}{E_{i,j}}
\]

</p><p>Where:</p>
<ul>
    <li>\(n\) is the number of rows</li>
    <li>\(m\) is the number of columns</li>
    <li>\(O_{i,j}\) is the observed count in row \(i\) and column \(j\)</li>
    <li>\(E_{i,j}\) is the expected count in row \(i\) and column \(j\)</li>
</ul>

<p>The expected count is given by:</p><p>

\[
E_{i,j} = \frac{\sum_{k=1}^nO_{k,j} \sum_{l=1}^mO_{i,l} }{N}
\]
</p><p>Where:</p>
<ul>
    <li>\(N\) is the sum of all the cells, i.e., the total number of observations</li>
</ul>

<p>A statistical dependence exists if \(X^2\) is greater than the (\(1-\alpha\)) quantile of a \(\chi^2\) distribution with \((m-1)\times(n-1)\) degrees of freedom.</p>

<p>You can see a 2x2 demonstration of these concepts in <a href="https://www.evanmiller.org/ab-testing/chi-squared.html">Evan’s Awesome Chi-Squared Test</a>.</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson’s chi-squared test (Wikipedia)</a></p>

<hr/>

<h2>3. Formulas For Reporting Count Data</h2>

<p>If the incoming events are independent, their counts are well-described by a Poisson distribution. A Poisson distribution takes a parameter \(\lambda\), which is the distribution’s mean — that is, the average arrival rate of events per unit time.</p>

<h3>3.1. Standard Deviation of a Poisson Distribution</h3>

<p>The standard deviation of Poisson data usually doesn’t need to be explicitly calculated. Instead it can be inferred from the Poisson parameter:</p><p>

\[
\sigma = \sqrt{\lambda}
\]

</p><p>This fact can be used to read an <a href="https://www.evanmiller.org/how-to-read-an-unlabeled-sales-chart.html">unlabeled sales chart</a>, for example.</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution (Wikipedia)</a></p>

<h3>3.2. Confidence Interval Around the Poisson Parameter</h3>

<p>The confidence interval around the Poisson parameter represents the set of arrival rates that can’t be rejected by the data. It can be inferred from a single data point of \(c\) events observed over \(t\) time periods with the following formula:</p><p>

\[
CI = \left(\frac{\gamma^{-1}(\alpha/2, c)}{t}, \frac{\gamma^{-1}(1-\alpha/2, c+1)}{t}\right)
\]

</p><p>Where:</p>
<ul>
    <li>\(\gamma^{-1}(p, c)\) is the inverse of the lower incomplete gamma function</li>
</ul>

<p>Reference: <a href="http://www.math.mcmaster.ca/peter/s743/poissonalpha.html">Confidence Intervals for the Mean of a Poisson Distribution</a></p>

<h3>3.3. Conditional Test of Two Poisson Parameters</h3>

<p>Please never do this:</p>

<center>
    <img src="https://www.evanmiller.org/images/formulas/count-change.png"/>
</center>

<p>From a statistical point of view, 5 events is indistinguishable from 7 events. Before reporting in bright red text that one count is greater than another, it’s best to perform a test of the two Poisson means.</p>

<p>The p-value is given by:</p><p>

\[
p = 2\times\frac{c!}{t^c}\times\min\left\{ 
\sum_{i=0}^{c_1} \frac{t_1^i t_2^{c-i}}{i!(c-i)!},
\sum_{i=c_1}^{c} \frac{t_1^i t_2^{c-i}}{i!(c-i)!}
\right\}
\]

</p><p>Where:</p>
<ul>
    <li>Observation 1 consists of \(c_1\) events over \(t_1\) time periods</li>
    <li>Observation 2 consists of \(c_2\) events over \(t_2\) time periods</li>
    <li>\(c = c_1 + c_2\) and \(t = t_1 + t_2\)</li>
</ul>

<p>You can see a demonstration of these concepts in <a href="https://www.evanmiller.org/ab-testing/poisson-means.html">Evan’s Awesome Poisson Means Test</a>.</p>

<p>Reference: <a href="http://www.ucs.louisiana.edu/~kxk4695/JSPI-04.pdf">A more powerful test for comparing two Poisson means (PDF)</a></p>

<hr/>

<h2>4. Formulas For Comparing Distributions</h2>

<p>If you want to test whether groups of observations come from the same (unknown) distribution, or if a single group of observations comes from a known distribution, you’ll need a Kolmogorov-Smirnov test. A K-S test will test the entire distribution for equality, not just the distribution mean.</p>

<h3>4.1. Comparing An Empirical Distribution to a Known Distribution</h3>

<p>The simplest version is a one-sample K-S test, which compares a sample of \(n\) points having an observed cumulative distribution function \(F\) to a known distribution function having a c.d.f. of \(G\). The test statistic is:</p><p>

\[
D_n = \sup_x|F(x) - G(x)|
\]

</p><p>In plain English, \(D_n\) is the absolute value of the largest difference in the two c.d.f.s for any value of \(x\).</p>

<p>The critical value of \(D_n\) at significance level \(\alpha\) is given by \(K_\alpha/\sqrt{n}\), where \(K_\alpha\) is the value of \(x\) that solves:</p><p>

\[
1 - \alpha = \frac{\sqrt{2\pi}}{x}\sum_{k=1}^\infty \exp{\left(-(2k-1)^2\pi^2/(8x^2)\right)}
\]

</p><p>The critical must be solved iteratively, e.g. by Newton’s method. If only the p-value is needed, it can be computed directly by solving the above for \(\alpha\).</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Kolmogorov–Smirnov_test">Kolmogorov-Smirnov Test (Wikipedia)</a></p>

<h3>4.2. Comparing Two Empirical Distributions</h3>

<p>The two-sample version is similar, except the test statistic is given by:</p><p>

\[
D_{n_1,n_2} = \sup_x|F_1(x) - F_2(x)|
\]

</p><p>Where \(F_1\) and \(F_2\) are the empirical c.d.f.s of the two samples, having \(n_1\) and \(n_2\) observations, respectively. The critical value of the test statistic is \(K_\alpha/\sqrt{n_1 n_2/(n_1 + n_2)}\) with the same value of \(K_\alpha\) above.</p>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Kolmogorov–Smirnov_test#Two-sample_Kolmogorov.E2.80.93Smirnov_test">Kolmogorov-Smirnov Test (Wikipedia)</a></p>

<h3>4.3. Comparing Three or More Empirical Distributions</h3>

<p>A \(k\)-sample extension of Kolmogorov-Smirnov was described by J. Kiefer in a <a href="http://www.jstor.org/stable/10.2307/2237091">1959 paper</a>. The test statistic is:</p><p>

\[
T = \sup_x \sum_{j=1}^k n_j |F_j(x) - \bar{F}(x)|
\] 

</p><p>Where \(\bar{F}\) is the c.d.f. of the combined samples. The critical value of \(T\) is \(a^2\) where \(a\) solves:</p><p>

\[
1 - \alpha = \frac{4}{\Gamma\left(\frac{h}{2}\right)2^{h/2}a^h} 
\sum_{n=1}^\infty \frac{(\gamma_{(h-2)/2,n})^{h-2}\exp[-(\gamma_{(h-2)/2,n})^2/2a^2]}{[J_{h/2}(\gamma_{(h-2)/2,n})]^2}
\]

</p><p>Where:</p>
<ul>
    <li>\(h=k-1\)</li>
    <li>\(J_{h/2}\) is a Bessel function of the first kind with order \(h/2\)</li>
    <li>\(\gamma_{(h-2)/2,n}\) is the \(n\)<sup>th</sup> zero of \(J_{(h-2)/2}\)
</li></ul>

<p>To compute the critical value, this equation must also be solved iteratively. When \(k=2\), the equation reduces to a two-sample Kolmogorov-Smirnov test. The case of \(k=4\) can also be reduced to a simpler form, but for other values of \(k\), the equation cannot be reduced.</p>

<p>Reference: <a href="http://www.jstor.org/stable/10.2307/2237091">K-sample analogues of the Kolmogorov-Smirnov and Cramer-v. Mises tests (JSTOR)</a></p>

<hr/>

<h2>5. Formulas For Drawing a Trend Line</h2>

<p>Trend lines (or best-fit lines) can be used to establish a relationship between two variables and predict future values.</p>

<h3>5.1. Slope of a Best-Fit Line</h3>

<p>The slope of a best-fit (least squares) line is:</p><p>

\[
m = \frac{\sum_{i=1}^N(x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^N(x_i - \bar{x})^2}
\]

</p><p>Where:</p>
<ul>
    <li>\(\{x_1, \ldots, x_N\}\) is the independent variable with sample mean \(\bar{x}\)</li>
    <li>\(\{y_1, \ldots, y_N\}\) is the dependent variable with sample mean \(\bar{y}\)</li>
</ul>

<h3>5.2. Standard Error of the Slope</h3>

<p>The standard error around the estimated slope is:</p><p>

\[
SE = \frac{\sqrt{\sum_{i=1}^N(y_i - \bar{y} - m (x_i - \bar{x}))^2/(N-2)}}{\sqrt{\sum_{i=1}^N(x_i - \bar{x})^2}}
\]

<a name="trend_ci"></a></p><h3>5.3. Confidence Interval Around the Slope</h3>

<p>The confidence interval is constructed as:</p><p>

\[
CI = m \pm t_{\alpha/2} SE
\]
</p><p>Where:</p>
<ul>
    <li>\(\alpha\) is the significance level, typically 5% (one minus the confidence level)</li>
    <li>\(t_{\alpha/2}\) is the \(1-\alpha/2\) quantile of a t-distribution with \(N-2\) degrees of freedom</li>
</ul>

<p>Reference: <a href="https://en.wikipedia.org/wiki/Simple_linear_regression">Simple linear regression (Wikipedia)</a></p>


<hr/>

<p><em>You’re reading <a href="https://www.evanmiller.org/">evanmiller.org</a>, a random collection of math, tech, and musings. If you liked this you might also enjoy:
    </em></p><ul><em>
        <li><a href="https://www.evanmiller.org/bayesian-ab-testing.html">Formulas for Bayesian A/B Testing</a>
        </li><li><a href="https://www.evanmiller.org/how-not-to-sort-by-average-rating.html">How Not To Sort By Average Rating</a>
        </li><li><a href="https://www.evanmiller.org/how-to-read-an-unlabeled-sales-chart.html">How To Read an Unlabeled Sales Chart</a>
    </li></em></ul>

<hr/>
<p><em>Get new articles as they’re published, via <a href="https://www.linkedin.com/in/evanmmiller/">LinkedIn</a>, <a href="https://twitter.com/EvMill">Twitter</a>, or <a href="https://www.evanmiller.org/news.xml">RSS</a>.</em></p>

<hr/>

<p><em>Want to look for statistical patterns in your MySQL, PostgreSQL, or SQLite database? My desktop statistics software <strong><a href="https://www.wizardmac.com/">Wizard</a></strong> can help you analyze <strong>more data in less time</strong> and <strong>communicate discoveries visually</strong> without spending days struggling with pointless command syntax. Check it out!</em></p>
<div>
<p><a href="https://www.wizardmac.com/"><img height="128" width="128" src="https://www.evanmiller.org/images/index/wizard2.png"/></a></p></div>


<hr/>

<p><a href="https://www.evanmiller.org/">Back to Evan Miller’s home page</a> 
– <a href="https://www.evanmiller.org/news.xml">Subscribe to RSS</a>
– <a href="https://www.linkedin.com/in/evanmmiller/">LinkedIn</a>
– <a href="https://twitter.com/EvMill">Twitter</a> 
</p>

<hr/>

</div>
</div></div>
  </body>
</html>
