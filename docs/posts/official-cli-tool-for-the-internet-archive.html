<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://archive.org/developers/internetarchive/cli.html">Original</a>
    <h1>Official CLI Tool for the Internet Archive</h1>
    
    <div id="readability-page-1" class="page"><div id="main-content" role="main">
                
              <div>
                
  <section id="command-line-interface">

<p>The <code><span>ia</span></code> command-line tool is installed with <code><span>internetarchive</span></code>, or <a href="https://solar.lowtechmagazine.com/2023/10/thematic-book-series-how-to-downsize-a-transport-network/installation.html#binaries">available as a binary</a>. <code><span>ia</span></code> allows you to interact with various archive.org services from the command-line.</p>
<section id="getting-started">
<h2>Getting Started<a href="#getting-started" title="Permalink to this headline">#</a></h2>
<p>The easiest way to start using <code><span>ia</span></code> is downloading a binary. The only requirements of the binary are a Unix-like environment with Python installed. To download the latest binary, and make it executable simply:</p>
<div><div><pre><span></span>$ curl -LOs https://archive.org/download/ia-pex/ia
$ chmod +x ia
$ ./ia <span>help</span>
A <span>command</span> line interface to archive.org.

usage:
    ia <span>[</span>--help <span>|</span> --version<span>]</span>
    ia <span>[</span>--config-file FILE<span>]</span> <span>[</span>--log <span>|</span> --debug<span>]</span> <span>[</span>--insecure<span>]</span> &lt;command&gt; <span>[</span>&lt;args&gt;<span>]</span>...

options:
    -h, --help
    -v, --version
    -c, --config-file FILE  Use FILE as config file.
    -l, --log               Turn on logging <span>[</span>default: False<span>]</span>.
    -d, --debug             Turn on verbose logging <span>[</span>default: False<span>]</span>.
    -i, --insecure          Use HTTP <span>for</span> all requests instead of HTTPS <span>[</span>default: false<span>]</span>

commands:
    <span>help</span>      Retrieve <span>help</span> <span>for</span> subcommands.
    configure Configure <span>`</span>ia<span>`</span>.
    metadata  Retrieve and modify metadata <span>for</span> items on archive.org.
    upload    Upload items to archive.org.
    download  Download files from archive.org.
    delete    Delete files from archive.org.
    search    Search archive.org.
    tasks     Retrieve information about your archive.org catalog tasks.
    list      List files <span>in</span> a given item.

See <span>&#39;ia help &lt;command&gt;&#39;</span> <span>for</span> more information on a specific command.
</pre></div>
</div>
</section>
<section id="metadata">
<h2>Metadata<a href="#metadata" title="Permalink to this headline">#</a></h2>
<section id="reading-metadata">
<h3>Reading Metadata<a href="#reading-metadata" title="Permalink to this headline">#</a></h3>
<p>You can use <code><span>ia</span></code> to read and write metadata from archive.org. To retrieve all of an item’s metadata in JSON, simply:</p>
<div><div><pre><span></span>$ ia metadata TripDown1905
</pre></div>
</div>
<p>A particularly useful tool to use alongside <code><span>ia</span></code> is <a href="https://stedolan.github.io/jq/">jq</a>. <code><span>jq</span></code> is a command-line tool for parsing JSON. For example:</p>
<div><div><pre><span></span>$ ia metadata TripDown1905 <span>|</span> jq <span>&#39;.metadata.date&#39;</span>
<span>&#34;1906&#34;</span>
</pre></div>
</div>
</section>
<section id="modifying-metadata">
<h3>Modifying Metadata<a href="#modifying-metadata" title="Permalink to this headline">#</a></h3>
<p>Once <code><span>ia</span></code> has been <a href="https://solar.lowtechmagazine.com/2023/10/thematic-book-series-how-to-downsize-a-transport-network/quickstart.html#configuring">configured</a>, you can modify <a href="https://archive.org/services/docs/api/metadata-schema">metadata</a>:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --modify<span>=</span><span>&#34;foo:bar&#34;</span> --modify<span>=</span><span>&#34;baz:foooo&#34;</span>
</pre></div>
</div>
<p>You can remove a metadata field by setting the value of the given field to <code><span>REMOVE_TAG</span></code>.
For example, to remove the metadata field <code><span>foo</span></code> from the item <code><span>&lt;identifier&gt;</span></code>:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --modify<span>=</span><span>&#34;foo:REMOVE_TAG&#34;</span>
</pre></div>
</div>
<p>Note that some metadata fields (e.g. <code><span>mediatype</span></code>) cannot be modified, and must instead be set initially on upload.</p>
<p>The default target to write to is <code><span>metadata</span></code>. If you would like to write to another target, such as <code><span>files</span></code>, you can specify so using the <code><span>--target</span></code> parameter. For example, if we had an item whose identifier was <code><span>my_identifier</span></code> and we wanted to add a metadata field to a file within the item called <code><span>foo.txt</span></code>:</p>
<div><div><pre><span></span>$ ia metadata my_identifier --target<span>=</span><span>&#34;files/foo.txt&#34;</span> --modify<span>=</span><span>&#34;title:My File&#34;</span>
</pre></div>
</div>
<p>You can also create new targets if they don’t exist:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --target<span>=</span><span>&#34;extra_metadata&#34;</span> --modify<span>=</span><span>&#34;foo:bar&#34;</span>
</pre></div>
</div>
<p>There is also an <code><span>--append</span></code> option which allows you to append a string to an existing metadata strings (Note: use <code><span>--append-list</span></code> for appending elements to a list).
For example, if your item’s title was <code><span>Foo</span></code> and you wanted it to be <code><span>Foo</span> <span>Bar</span></code>, you could simply do:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --append<span>=</span><span>&#34;title: Bar&#34;</span>
</pre></div>
</div>
<p>If you would like to add a new value to an existing field that is an array (like <code><span>subject</span></code> or <code><span>collection</span></code>), you can use the <code><span>--append-list</span></code> option:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --append-list<span>=</span><span>&#34;subject:another subject&#34;</span>
</pre></div>
</div>
<p>This command would append <code><span>another</span> <span>subject</span></code> to the items list of subjects, if it doesn’t already exist (i.e. no duplicate elements are added).</p>
<p>Metadata fields or elements can be removed with the <code><span>--remove</span></code> option:</p>
<div><div><pre><span></span>$ ia metadata &lt;identifier&gt; --remove<span>=</span><span>&#34;subject:another subject&#34;</span>
</pre></div>
</div>
<p>This would remove <code><span>another</span> <span>subject</span></code> from the items subject field, regardless of whether or not the field is a single or multi-value field.</p>
<p>Refer to <a href="https://archive.org/services/docs/api/metadata-schema/index.html">Internet Archive Metadata</a> for more specific details regarding metadata and archive.org.</p>
</section>
<section id="modifying-metadata-in-bulk">
<h3>Modifying Metadata in Bulk<a href="#modifying-metadata-in-bulk" title="Permalink to this headline">#</a></h3>
<p>If you have a lot of metadata changes to submit, you can use a CSV spreadsheet to submit many changes with a single command.
Your CSV must contain an <code><span>identifier</span></code> column, with one item per row. Any other column added will be treated as a metadata field to modify. If no value is provided in a given row for a column, no changes will be submitted. If you would like to specify multiple values for certain fields, an index can be provided: <code><span>subject[0]</span></code>, <code><span>subject[1]</span></code>. Your CSV file should be UTF-8 encoded. See <a href="https://archive.org/download/ia-pex/metadata.csv">metadata.csv</a> for an example CSV file.</p>
<p>Once you’re ready to submit your changes, you can submit them like so:</p>
<div><div><pre><span></span>$ ia metadata --spreadsheet<span>=</span>metadata.csv
</pre></div>
</div>
<p>See <code><span>ia</span> <span>help</span> <span>metadata</span></code> for more details.</p>
</section>
</section>
<section id="upload">
<h2>Upload<a href="#upload" title="Permalink to this headline">#</a></h2>
<p><code><span>ia</span></code> can also be used to upload items to archive.org. After <a href="https://solar.lowtechmagazine.com/2023/10/thematic-book-series-how-to-downsize-a-transport-network/quickstart.html#configuring">configuring ia</a>, you can upload files like so:</p>
<div><div><pre><span></span>$ ia upload &lt;identifier&gt; file1 file2 --metadata<span>=</span><span>&#34;mediatype:texts&#34;</span> --metadata<span>=</span><span>&#34;blah:arg&#34;</span>
</pre></div>
</div>
<div>
<p>Warning</p>
<p>Please note that, unless specified otherwise, items will be uploaded with a <code><span>data</span></code> mediatype. <strong>This cannot be changed afterwards.</strong> Therefore, you should specify a mediatype when uploading, eg. <code><span>--metadata=&#34;mediatype:movies&#34;</span></code>. Similarly, if you want your upload to end up somewhere else than the default collection (currently <a href="https://archive.org/details/opensource">community texts</a>), you should also specify a collection with <code><span>--metadata=&#34;collection:foo&#34;</span></code>. See <a href="https://archive.org/services/docs/api/metadata-schema">metadata documentation</a> for more information.</p>
</div>
<p>You can upload files from <code><span>stdin</span></code>:</p>
<div><div><pre><span></span>$ curl http://dumps.wikimedia.org/kywiki/20130927/kywiki-20130927-pages-logging.xml.gz <span>\</span>
  <span>|</span> ia upload &lt;identifier&gt; - --remote-name<span>=</span>kywiki-20130927-pages-logging.xml.gz --metadata<span>=</span><span>&#34;title:Uploaded from stdin.&#34;</span>
</pre></div>
</div>
<p>You can use the <code><span>--retries</span></code> parameter to retry on errors (i.e. if IA-S3 is overloaded):</p>
<div><div><pre><span></span>$ ia upload &lt;identifier&gt; file1 --retries <span>10</span>
</pre></div>
</div>
<p>Note that <code><span>ia</span> <span>upload</span></code> makes a backup of any files that are clobbered.
They are saved to a directory in the item named <code><span>history/files/</span></code>.
The files are named in the format <code><span>$key.~N~</span></code>.
These files can be deleted like normal files.
You can also prevent the backup from happening on clobbers by adding <code><span>-H</span> <span>x-archive-keep-old-version:0</span></code> to your command.</p>
<p>Refer to <a href="https://archive.org/services/docs/api/metadata-schema/index.html#archive-org-identifiers">archive.org Identifiers</a> for more information on creating valid archive.org identifiers.
Please also read the <a href="https://archive.org/services/docs/api/items.html">Internet Archive Items</a> page before getting started.</p>
<section id="bulk-uploading">
<h3>Bulk Uploading<a href="#bulk-uploading" title="Permalink to this headline">#</a></h3>
<p>Uploading in bulk can be done similarly to <a href="#modifying-metadata-in-bulk">Modifying Metadata in Bulk</a>. The only difference is that you must provide a <code><span>file</span></code> column which contains a relative or absolute path to your file. Please see <a href="https://archive.org/download/ia-pex/uploading.csv">uploading.csv</a> for an example.</p>
<p>Once you are ready to start your upload, simply run:</p>
<div><div><pre><span></span>$ ia upload --spreadsheet<span>=</span>uploading.csv
</pre></div>
</div>
</section>
<section id="bulk-uploading-special-columns">
<h3>Bulk Uploading Special Columns<a href="#bulk-uploading-special-columns" title="Permalink to this headline">#</a></h3>
<p>You can set a remote filename that differs from your local filename by specifying a remote filename in a column named <code><span>REMOTE_NAME</span></code> (Added to <code><span>ia</span></code> in <code><span>v2.0.0</span></code>).</p>
<p>See <code><span>ia</span> <span>help</span> <span>upload</span></code> for more details.</p>
</section>
<section id="setting-file-level-metadata-on-upload">
<h3>Setting File-Level Metadata on Upload<a href="#setting-file-level-metadata-on-upload" title="Permalink to this headline">#</a></h3>
<p>You can set file-level metadata at time of upload via a JSON/JSONL file.
The JSON or JSONL must have a dict for each file, with the local path to the file stored under the key, <code><span>name</span></code>.
For example, you could upload two files named <code><span>foo.txt</span></code> and <code><span>bar.txt</span></code> with a file-level <code><span>title</span></code> with the following JSONL file (named <code><span>file_md.jsonl</span></code>):</p>
<div><div><pre><span></span><span>{</span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;foo.txt&#34;</span><span>,</span><span> </span><span>&#34;title&#34;</span><span>:</span><span> </span><span>&#34;my foo file&#34;</span><span>}</span><span></span>
<span>{</span><span>&#34;name&#34;</span><span>:</span><span> </span><span>&#34;bar.txt&#34;</span><span>,</span><span> </span><span>&#34;title&#34;</span><span>:</span><span> </span><span>&#34;my foo file&#34;</span><span>}</span><span></span>
</pre></div>
</div>
<p>And the following command:</p>
<div><div><pre><span></span>$ ia upload &lt;id&gt; --file-metadata file_md.jsonl
</pre></div>
</div>
</section>
</section>
<section id="download">
<h2>Download<a href="#download" title="Permalink to this headline">#</a></h2>
<p>Download an entire item:</p>
<div><div><pre><span></span>$ ia download TripDown1905
</pre></div>
</div>
<p>Download specific files from an item:</p>
<div><div><pre><span></span>$ ia download TripDown1905 TripDown1905_512kb.mp4 TripDown1905.ogv
</pre></div>
</div>
<p>Download specific files matching a glob pattern:</p>
<div><div><pre><span></span>$ ia download TripDown1905 --glob<span>=</span><span>&#34;*.mp4&#34;</span>
</pre></div>
</div>
<p>Note that you may have to escape the <code><span>*</span></code> differently depending on your shell (e.g. <code><span>\*.mp4</span></code>, <code><span>&#39;*.mp4&#39;</span></code>, etc.).</p>
<p>Download specific files matching a glob pattern, but excluding files matching a different glob pattern:</p>
<div><div><pre><span></span>$ ia download TripDown1905 --glob<span>=</span><span>&#34;*.mp4&#34;</span> --exclude <span>&#34;*512kb*&#34;</span>
</pre></div>
</div>
<p>Note that <code><span>--exclude</span></code> can only be used in conjunction with <code><span>--glob</span></code>.</p>
<p>Download only files of a specific format:</p>
<div><div><pre><span></span>$ ia download TripDown1905 --format<span>=</span><span>&#39;512Kb MPEG4&#39;</span>
</pre></div>
</div>
<p>Note that <code><span>--format</span></code> cannot be used with <code><span>--glob</span></code> or <code><span>--exclude</span></code>.
You can get a list of the formats of a given item like so:</p>
<div><div><pre><span></span>$ ia metadata --formats TripDown1905
</pre></div>
</div>
<p>Download an entire collection:</p>
<div><div><pre><span></span>$ ia download --search <span>&#39;collection:glasgowschoolofart&#39;</span>
</pre></div>
</div>
<p>Download from an itemlist:</p>
<div><div><pre><span></span>$ ia download --itemlist itemlist.txt
</pre></div>
</div>
<p>See <code><span>ia</span> <span>help</span> <span>download</span></code> for more details.</p>
<section id="downloading-on-the-fly-files">
<h3>Downloading On-The-Fly Files<a href="#downloading-on-the-fly-files" title="Permalink to this headline">#</a></h3>
<p>Some files on archive.org are generated on-the-fly as requested. This currently includes non-original files of the formats EPUB, MOBI, DAISY, and archive.org’s own MARCXML. These files can be downloaded using the <code><span>--on-the-fly</span></code> parameter:</p>
<div><div><pre><span></span>$ ia download goodytwoshoes00newyiala --on-the-fly
</pre></div>
</div>
</section>
</section>
<section id="delete">
<h2>Delete<a href="#delete" title="Permalink to this headline">#</a></h2>
<p>You can use <code><span>ia</span></code> to delete files from archive.org items:</p>
<div><div><pre><span></span>$ ia delete &lt;identifier&gt; &lt;file&gt;
</pre></div>
</div>
<p>Delete all files associated with the specified file, including upstream derivatives and the original:</p>
<div><div><pre><span></span>$ ia delete &lt;identifier&gt; &lt;file&gt; --cascade
</pre></div>
</div>
<p>Delete all files in an item:</p>
<div><div><pre><span></span>$ ia delete &lt;identifier&gt; --all
</pre></div>
</div>
<p>Note that <code><span>ia</span> <span>delete</span></code> makes a backup of any files that are deleted.
They are saved to a directory in the item named <code><span>history/files/</span></code>.
The files are named in the format <code><span>$key.~N~</span></code>.
These files can be deleted like normal files.
You can also prevent the backup from happening on deletes by adding <code><span>-H</span> <span>x-archive-keep-old-version:0</span></code> to your command.</p>
<p>See <code><span>ia</span> <span>help</span> <span>delete</span></code> for more details.</p>
</section>
<section id="search">
<h2>Search<a href="#search" title="Permalink to this headline">#</a></h2>
<p><code><span>ia</span></code> can also be used for retrieving archive.org search results in JSON:</p>
<div><div><pre><span></span>$ ia search <span>&#39;subject:&#34;market street&#34; collection:prelinger&#39;</span>
</pre></div>
</div>
<p>By default, <code><span>ia</span> <span>search</span></code> attempts to return all items meeting the search criteria,
and the results are sorted by item identifier. If you want to just select the top <code><span>n</span></code>
items, you can specify a <code><span>page</span></code> and <code><span>rows</span></code> parameter. For example, to get the
top 20 items matching the search ‘dogs’:</p>
<div><div><pre><span></span>$ ia search --parameters<span>=</span><span>&#34;page=1&amp;rows=20&#34;</span> <span>&#34;dogs&#34;</span>
</pre></div>
</div>
<p>You can use <code><span>ia</span> <span>search</span></code> to create an itemlist:</p>
<div><div><pre><span></span>$ ia search <span>&#39;collection:glasgowschoolofart&#39;</span> --itemlist &gt; itemlist.txt
</pre></div>
</div>
<p>You can pipe your itemlist into a GNU Parallel command to download items concurrently:</p>
<div><div><pre><span></span>$ ia search <span>&#39;collection:glasgowschoolofart&#39;</span> --itemlist <span>|</span> parallel <span>&#39;ia download {}&#39;</span>
</pre></div>
</div>
<p>See <code><span>ia</span> <span>help</span> <span>search</span></code> for more details.</p>
</section>
<section id="tasks">
<h2>Tasks<a href="#tasks" title="Permalink to this headline">#</a></h2>
<p>You can also use <code><span>ia</span></code> to retrieve information about your catalog tasks, after <a href="https://github.com/jjjake/internetarchive#configuring">configuring ia</a>.
To retrieve the task history for an item, simply run:</p>

<p>View all of your queued and running archive.org tasks:</p>

<p>See <code><span>ia</span> <span>help</span> <span>tasks</span></code> for more details.</p>
</section>
<section id="list">
<h2>List<a href="#list" title="Permalink to this headline">#</a></h2>
<p>You can list files in an item like so:</p>
<div><div><pre><span></span>$ ia list goodytwoshoes00newyiala
</pre></div>
</div>
<p>See <code><span>ia</span> <span>help</span> <span>list</span></code> for more details.</p>
</section>
<section id="copy">
<h2>Copy<a href="#copy" title="Permalink to this headline">#</a></h2>
<p>You can copy files in archive.org items like so:</p>
<div><div><pre><span></span>$ ia copy &lt;src-identifier&gt;/&lt;src-filename&gt; &lt;dest-identifier&gt;/&lt;dest-filename&gt;
</pre></div>
</div>
<p>If you’re copying your file to a new item, you can provide metadata as well:</p>
<div><div><pre><span></span>$ ia copy &lt;src-identifier&gt;/&lt;src-filename&gt; &lt;dest-identifier&gt;/&lt;dest-filename&gt; --metadata <span>&#39;title:My New Item&#39;</span> --metadata collection:test_collection
</pre></div>
</div>
<p>Note that <code><span>ia</span> <span>copy</span></code> makes a backup of any files that are clobbered.
They are saved to a directory in the item named <code><span>history/files/</span></code>.
The files are named in the format <code><span>$key.~N~</span></code>.
These files can be deleted like normal files.
You can also prevent the backup from happening on clobbers by adding <code><span>-H</span> <span>x-archive-keep-old-version:0</span></code> to your command.</p>
</section>
<section id="move">
<h2>Move<a href="#move" title="Permalink to this headline">#</a></h2>
<p><code><span>ia</span> <span>move</span></code> works just like <code><span>ia</span> <span>copy</span></code> except the source file is deleted after the file has been successfully copied.</p>
<p>Note that <code><span>ia</span> <span>move</span></code> makes a backup of any files that are clobbered or deleted.
They are saved to a directory in the item named <code><span>history/files/</span></code>.
The files are named in the format <code><span>$key.~N~</span></code>.
These files can be deleted like normal files.
You can also prevent the backup from happening on clobbers or deletes by adding <code><span>-H</span> <span>x-archive-keep-old-version:0</span></code> to your command.</p>
</section>
</section>


              </div>
              
            </div></div>
  </body>
</html>
