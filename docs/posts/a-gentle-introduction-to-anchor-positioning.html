<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://webkit.org/blog/17240/a-gentle-introduction-to-anchor-positioning/">Original</a>
    <h1>A gentle introduction to anchor positioning</h1>
    
    <div id="readability-page-1" class="page"><div>
                                
                <p>Anchor positioning allows you to place an element on the page based on where another element is. It makes it easier to create responsive menus and tooltips with less code using only CSS. Here’s how it works.</p>
<p>Let’s say you have an avatar in your nav, like this:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-25.png" alt="Nav bar with two text options and one avatar" class="wp-image-17137"/></figure>
<p>When you click the avatar, you want a menu to appear right below it. The clicking interaction can be handled with just CSS using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Popover_API">Popover API</a>. But once you click, where does your menu show up?</p>
<p>Figuring this out typically requires some JavaScript. But now, with anchor positioning, you can accomplish this with just a few lines of CSS. Anchor positioning will use where the avatar is to determine where the menu will go.</p>
<p>For example, you might want to place it just below the avatar, nice and left-aligned, like this:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-26.png" alt="Nav bar with avatar&#39;s menu expanded and left aligned." class="wp-image-17137"/></figure>
<p>Or you can have it hang out on the side of the avatar, having a party off to the right, like this:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-27.png" alt="Nav bar with avatar&#39;s menu expanded to the right of the photo." class="wp-image-17137"/></figure>
<p>You can position it in a number of places, but I think that first example looks good. It’s something you’d frequently see on the web on sites and web apps. Let’s walk through the code of how to make it happen.</p>
<p>The first step in placing your menu is letting it know about your avatar.</p>
<p>A great way to think about the relationship between your avatar and your menu is to think of your menu as if it’s anchored to your avatar. With that in mind, we’ll refer to your avatar as your anchor and your menu as your target.</p>
<p>You’ll name your anchor by declaring an <code>anchor-name</code> on the avatar element. Since your avatar represents your profile and is behaving like button, let’s give it a class of <code>profile-button</code>.</p>
<p>Here’s what it looks like:</p>
<pre><code>.profile-button {
  anchor-name: --profile-button;
}
</code></pre>
<p>Then you’ll go to your menu (your target) and declare a <code>position-anchor</code> where the value is the <code>anchor-name</code> of the anchor that you previously declared. This is what establishes the connection and tells the target about the anchor.</p>
<p>Let’s go to your target and declare it there:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
}
</code></pre>
<p>And the final step is giving your menu an absolute or fixed position, like this:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
}
</code></pre>
<p>Great, you’ve established your connection! Now you need to decide where to put your menu.</p>
<h2>Position-area</h2>
<p>One way to do this is to use the <code>position-area</code> property.</p>
<p>The <code>position-area</code> allows you to place your element on a nine-square grid where the anchor takes the center spot. The space that contains this grid is the containing block of the anchor.</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-28.png" alt="Black grid with nine squares and avatar in the center labeled left, center, right, top, bottom." class="wp-image-17137"/></figure>
<p>You can use this grid to determine where you want to position your menu. Do you want the menu to show up on the top right? Great! You can write <code>top right</code>.</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  position-area: top right;
}
</code></pre>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-29.png" alt="Black grid with blue box on the top right and avatar in the center." class="wp-image-17137"/></figure>
<p>But here’s the thing about <code>top right</code> — it might feel like an intuitive way to describe where you want your target to be placed, but it’s actually not the best way to go about it.</p>
<p>Whenever possible, you want to use logical properties, not physical ones, in your CSS. That’s a more inclusive way to describe what you’re trying to do that doesn’t make assumptions about writing mode or language.</p>
<p>Here’s the same nine-square grid using logical properties:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-30.png" alt="Black grid with avatar in the center with labels start/block-start, center, end/block-end, end/inline-end, start/inline-start" class="wp-image-17137"/></figure>
<p>If you rewrite your above physical property as a logical one, you’d go from <code>top right</code> to <code>block-start inline-end</code>, like this:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  position-area: block-start inline-end;
}
</code></pre>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-33.png" alt="Black grid with avatar in the center and the top right block in blue with block-start inline-end in it" class="wp-image-17137"/></figure>
<p>Do you want it to be on the bottom center of your grid? No problem, we’d write that logically as <code>block-end center</code>.</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  position-area: block-end center;
}
</code></pre>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-32.png" alt="Black grid with avatar in the center and the bottom center block being blue with block-end center written on it" class="wp-image-17137"/></figure>
<p>In your example, you want to put the menu under the avatar, left-aligned, to create that layout you’re going for. But, in this case, there’s a problem: the menu is wider than the avatar. So when you use <code>block-end center</code> as your <code>position-area</code> value, it crosses the grid lines and pokes out like this:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-34.png" alt="Table showing values, flexbox and grid columns for Item Flow properties." class="wp-image-17137"/></figure>
<p>Let’s take the grid lines away and see what that would look like.</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-35.png" alt="Nav bar with two text items and one avatar with expanded menu left aligned under avatar." class="wp-image-17137"/></figure>
<p>That’s not the look you’re going for. How do you get that clean, left-alignment instead?</p>
<p>You can set <code>position-area</code> to <code>block-end span-inline-end</code>. Instead of centering the element, that’ll start the position directly below the avatar and let it spill over to end of the inline direction, like this:</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-36.png" alt="Table showing values, flexbox and grid columns for Item Flow properties." class="wp-image-17137"/></figure>
<p>And here’s the code:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  position-area: block-end span-inline-end;
}
</code></pre>
<p>Great, exactly what you want!</p>
<p>The main logical values you can use are <code>start/block-start</code>, <code>end/block-end</code>, <code>start/inline-start</code> and <code>end/inline-end</code>. And, if you must, you can use the physical values: <code>left</code>, <code>center</code>, <code>right</code>, <code>top</code>, <code>bottom</code>.</p>
<p>For a full list of values you can use, check out MDN’s resource <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/position-area">here</a>. Let’s get back to the positioning.</p>
<p>The positioning you set for your menu works on desktop, where you’re got plenty of space on the right for the element to spill over, but what about on mobile where your viewport is more narrow?</p>
<p>In mobile view, it’s probably better to do a right-align and allow the menu to spill over to the left instead. To do that, what we want is a way to tell the menu to switch to a different position when it’s run out of room.</p>
<p>And anchor positioning can do that! The benefit of anchor positioning is you get this responsive flexibility. It knows when there’s no room for your defined position and it’ll happily try something else. So let’s give it a different position to try when it’s out of space. To do that, you’ll use <code>position-try</code>.</p>
<p>Here’s what that looks like:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  position-area: block-end span-inline-end;
  position-try: block-end span-inline-start;
}
</code></pre>
<p><code>position-try</code> allows you to give your element a new position to try, hence the name. Here’s what the results look like in action.</p>
<figure><video src="https://webkit.org/wp-content/uploads/Screen-Recording-2025-07-15-at-3.35.57-PM.mov" playsinline="" muted="" autoplay="" loop=""><figcaption>Shows how menu under avatar shifts to the left when window size gets small enough.</figcaption></video></figure>
<h2>Anchor()</h2>
<p>The <code>anchor()</code> function uses a different framework than <code>position-area</code> for placing your target. Whereas <code>position-area</code> uses the concept of a grid to place the target, <code>anchor()</code> is all about placing your target based on the <em>edges</em> of your anchor.</p>
<p>It can only be used within the inset properties. Inset properties allow you to control where the element is located by declaring the offsets from its default positions. They can be the physical insets, which are <code>top</code> , <code>right</code>, <code>bottom</code>, and <code>left</code>, the logical inset properties, which are <code>inset-block-start</code> , <code>inset-block-end</code>,  <code>inset-inline-start</code> and <code>inset-inline-end</code>, and the short-hand inset properties, <code>inset-block</code> and <code>inset-inline</code> .</p>
<p>So to recreate the above effect where the left side of the avatar is aligned to the left side of the menu, you would use the <code>left</code> inset property and assign it to <code>anchor(left)</code>. Now the two sides are lined up to each other. And then to line up the top of the menu with the bottom of the avatar, you would set the <code>top</code> inset property of the menu to <code>anchor(bottom)</code>.</p>
<p>Here’s the code put together:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  left: anchor(left);
  top: anchor(bottom);
}
</code></pre>
<p>This uses physical properties, but once again, we really should be using logical properties, so let’s rewrite this.</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  inset-inline-start: anchor(start);
  inset-block-start: anchor(end);
}
</code></pre>
<p>Here, <code>left</code> and <code>right</code> values are replaced with <code>inset-inline-start</code> and <code>inset-block-start</code>. For the <code>anchor()</code> function,  there are a few logical values to pick from. <code>start</code> and <code>end</code> allow you to set the start and end of the anchor’s containing block based on whatever axis the inset property you’re using is on. You also have <code>self-start</code> and <code>self-end</code> which are based on the anchor element’s content instead of its containing block.</p>
<p><code>anchor()</code> also allows you to be specific about what anchor you’re working with. You can pass in an optional <code>anchor-name</code> and be explicit about your anchor. If you did that here, here’s what it would look like:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  left: anchor(--profile-button left);
  top: anchor(--profile-button bottom);
}
</code></pre>
<p>But in this situation, you only have the one anchor, so if you don’t explicitly state it, it’ll use whatever you set as your <code>position-anchor</code>.</p>
<p>The <code>anchor()</code> function can also be used in the <code>calc()</code> function. So far, you’ve been aligning the menu with the avatar’s container which includes some padding. Let’s say you wanted to align it with just the photo minus the padding, what would you do?</p>
<p>One way is to use the <code>calc()</code> function and add the padding (which is 1.25em) to the <code>anchor(start)</code> value, like this:</p>
<pre><code>.profile-menu {
  position-anchor: --profile-button;
  position: absolute;
  inset-inline-start: calc(anchor(start) + 1.25em);
  inset-block-start: anchor(bottom);
}
</code></pre>
<p>That’ll get you this result (the pink line is to illustrate alignment):</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/Image-37.png" alt="Table showing values, flexbox and grid columns for Item Flow properties." class="wp-image-17137"/></figure>
<p><code>position-area</code> and <code>anchor()</code> both help you position your targets based on your anchor. Which one you use depends on your preferred mental model. Thinking of anchor positioning as a grid that you place things on can be a helpful and intuitive way of writing your code. But if you prefer to think of positioning as assigning values to the edges of your anchor, that’s fine too. They can both help you accomplish your goals.</p>
<p>To play around with the different ways to position your target, check out <a href="https://codepen.io/sarony/pen/EaVVpxz">this CodePen</a> I set up for you to experiment. Replace the <code>position-area</code> with your own values and see how the target element moves around. Try to put it in different places and give <code>anchor()</code> a spin too.</p>
<p>There are more things you can do with anchor positioning but the information in this blog post should get you pretty far. For more details on additional properties, checkout MDN’s resource <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_anchor_positioning">here</a>.  You can also check out this fun game, <a href="https://anchoreum.com/">Anchoreum</a>, to teach you anchor positioning.</p>
<p>And let me know what you think of this post. Send me, Saron Yitbarek, a message on <a href="https://bsky.app/profile/saron.bsky.social">BlueSky</a>, or reach out to our other evangelists — Jen Simmons, on <a href="https://bsky.app/profile/jensimmons.bsky.social">Bluesky</a> / <a href="https://front-end.social/@jensimmons">Mastodon</a>, and Jon Davis, on <a href="https://bsky.app/profile/jondavis.bsky.social">Bluesky</a> / <a href="https://mastodon.social/@jondavis">Mastodon</a>. You can also follow WebKit <a href="https://www.linkedin.com/in/apple-webkit/">on LinkedIn</a>. If you find a bug or problem, please file a <a href="https://bugs.webkit.org/">WebKit bug report</a>.</p>

                            </div></div>
  </body>
</html>
