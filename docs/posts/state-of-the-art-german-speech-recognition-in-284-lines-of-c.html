<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/DeutscheKI/tevr-asr-tool">Original</a>
    <h1>Show HN: State-of-the-Art German Speech Recognition in 284 lines of C&#43;&#43;</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<ul dir="auto">
<li>state-of-the-art performance
<ul dir="auto">
<li>3.64% WER on Common Voice German</li>
<li>rank #1 on <a href="https://paperswithcode.com/sota/speech-recognition-on-common-voice-german" rel="nofollow">paperswithcode.com</a></li>
</ul>
</li>
<li>no GPU needed</li>
<li>100% offline</li>
<li>100% private</li>
<li>100% free</li>
<li>MIT license</li>
<li>Linux x86_64</li>
<li>command-line tool</li>
<li>easy to understand
<ul dir="auto">
<li>only 284 lines of C++ code</li>
<li>AI model on HuggingFace</li>
</ul>
</li>
</ul>
<h2 dir="auto"><a id="user-content-high-transcription-quality" href="#high-transcription-quality" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>High Transcription Quality</h2>
<p dir="auto">In August 2022, we ranked
<strong>#1 on &#34;Speech Recognition on Common Voice German (using extra training data)&#34;</strong>
with a 3.64% word error rate.
Accordingly, the performance of this tool is considered to be
the best of what&#39;s currently possible
in German speech recognition:
<a href="https://paperswithcode.com/sota/speech-recognition-on-common-voice-german?p=tevr-improving-speech-recognition-by-token" rel="nofollow"><img src="https://camo.githubusercontent.com/070bf31db2eb6744dfb723d2d00c9d1c8f42ec19cc311d11c865ddb60fc4cc73/68747470733a2f2f696d672e736869656c64732e696f2f656e64706f696e742e7376673f75726c3d68747470733a2f2f70617065727377697468636f64652e636f6d2f62616467652f746576722d696d70726f76696e672d7370656563682d7265636f676e6974696f6e2d62792d746f6b656e2f7370656563682d7265636f676e6974696f6e2d6f6e2d636f6d6d6f6e2d766f6963652d6765726d616e" alt="PWC" data-canonical-src="https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/tevr-improving-speech-recognition-by-token/speech-recognition-on-common-voice-german"/></a></p>
<h2 dir="auto"><a id="user-content-how-does-this-work" href="#how-does-this-work" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How does this work?</h2>
<p dir="auto"><a href="https://github.com/DeutscheKI/tevr-asr-tool/blob/v1.0.0/tevr_asr_tool.cc#L175-L185">L175-L185</a>
load the WAV file.
<a href="https://github.com/DeutscheKI/tevr-asr-tool/blob/v1.0.0/tevr_asr_tool.cc#L189-L229">L189-L229</a>
execute the acoustic AI model.
<a href="https://github.com/DeutscheKI/tevr-asr-tool/blob/v1.0.0/tevr_asr_tool.cc#L260-L275">L260-L275</a>
convert the predicted token logits into string snippets.
<a href="https://github.com/DeutscheKI/tevr-asr-tool/blob/v1.0.0/tevr_asr_tool.cc#L73-L162">L73-L162</a>
implement the Beam search re-scoring based on a KenLM language model.</p>
<p dir="auto">If you&#39;re curious how the acoustic AI model works
and why I designed it that way, here&#39;s the paper:
<a href="https://arxiv.org/abs/2206.12693" rel="nofollow">https://arxiv.org/abs/2206.12693</a>
and here&#39;s a pre-trained HuggingFace transformers model:
<a href="https://huggingface.co/fxtentacle/wav2vec2-xls-r-1b-tevr" rel="nofollow">https://huggingface.co/fxtentacle/wav2vec2-xls-r-1b-tevr</a></p>
<h2 dir="auto"><a id="user-content-install-the-debianubuntu-package" href="#install-the-debianubuntu-package" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install the Debian/Ubuntu package</h2>
<p dir="auto">Download <code>tevr_asr_tool-1.0.0-Linux-x86_64.deb</code> from GitHub
and extract the multipart ZIP:</p>
<div data-snippet-clipboard-copy-content="wget &#34;https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.001&#34;
wget &#34;https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.002&#34;
wget &#34;https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.003&#34;
wget &#34;https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.004&#34;
wget &#34;https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.005&#34;
cat tevr_asr_tool-1.0.0-Linux-x86_64.zip.00* &gt; tevr_asr_tool-1.0.0-Linux-x86_64.zip
unzip tevr_asr_tool-1.0.0-Linux-x86_64.zip"><pre>wget <span><span>&#34;</span>https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.001<span>&#34;</span></span>
wget <span><span>&#34;</span>https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.002<span>&#34;</span></span>
wget <span><span>&#34;</span>https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.003<span>&#34;</span></span>
wget <span><span>&#34;</span>https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.004<span>&#34;</span></span>
wget <span><span>&#34;</span>https://github.com/DeutscheKI/tevr-asr-tool/releases/download/v1.0.0/tevr_asr_tool-1.0.0-Linux-x86_64.zip.005<span>&#34;</span></span>
cat tevr_asr_tool-1.0.0-Linux-x86_64.zip.00<span>*</span> <span>&gt;</span> tevr_asr_tool-1.0.0-Linux-x86_64.zip
unzip tevr_asr_tool-1.0.0-Linux-x86_64.zip</pre></div>
<p dir="auto">Install it:</p>
<div data-snippet-clipboard-copy-content="sudo dpkg -i tevr_asr_tool-1.0.0-Linux-x86_64.deb"><pre>sudo dpkg -i tevr_asr_tool-1.0.0-Linux-x86_64.deb</pre></div>
<h2 dir="auto"><a id="user-content-install-from-source-code" href="#install-from-source-code" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install from Source Code</h2>
<p dir="auto">Download submodules:</p>
<div data-snippet-clipboard-copy-content="git submodule update --init"><pre>git submodule update --init</pre></div>
<p dir="auto">CMake configure and build:</p>
<div data-snippet-clipboard-copy-content="cmake -DCMAKE_BUILD_TYPE=MinSizeRel -DCPACK_CMAKE_GENERATOR=Ninja -S . -B build
cmake --build build --target tevr_asr_tool -j 16"><pre>cmake -DCMAKE_BUILD_TYPE=MinSizeRel -DCPACK_CMAKE_GENERATOR=Ninja -S <span>.</span> -B build
cmake --build build --target tevr_asr_tool -j 16</pre></div>
<p dir="auto">Create debian package:</p>
<div data-snippet-clipboard-copy-content="(cd build &amp;&amp; cpack -G DEB)"><pre>(cd build <span>&amp;&amp;</span> cpack -G DEB)</pre></div>
<p dir="auto">Install it:</p>
<div data-snippet-clipboard-copy-content="sudo dpkg -i build/tevr_asr_tool-1.0.0-Linux-x86_64.deb"><pre>sudo dpkg -i build/tevr_asr_tool-1.0.0-Linux-x86_64.deb</pre></div>
<h2 dir="auto"><a id="user-content-usage" href="#usage" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<div data-snippet-clipboard-copy-content="tevr_asr_tool --target_file=test_audio.wav 2&gt;log.txt"><pre>tevr_asr_tool --target_file=test_audio.wav <span>2&gt;</span>log.txt</pre></div>
<p dir="auto">should display the correct transcription
<code>mückenstiche sollte man nicht aufkratzen</code>.
And <code>log.txt</code> will contain the diagnostics and progress
that was logged to stderr during execution.</p>
<h2 dir="auto"><a id="user-content-gpu-acceleration-for-developers" href="#gpu-acceleration-for-developers" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>GPU Acceleration for Developers</h2>
<p dir="auto">I plan to release a Vulkan &amp; OpenGL-accelerated
real-time low-latency transcription
software for developers soon.
It&#39;ll run 100% private + 100% offline
just like this tool,
but instead of processing a WAV file on CPU
it&#39;ll stream the real-time GPU transcription
of your microphone input
through a WebRTC-capable REST API
so that you can easily integrate it
with your own voice-controlled projects.
For example, that&#39;ll enable
hackable voice typing
together with <code>pynput.keyboard</code>.</p>
<p dir="auto">If you want to get notified when it launches,
please enter your email at
<a href="https://madmimi.com/signups/f0da3b13840d40ce9e061cafea6280d5/join" rel="nofollow">https://madmimi.com/signups/f0da3b13840d40ce9e061cafea6280d5/join</a></p>
<h2 dir="auto"><a id="user-content-commercial-customization" href="#commercial-customization" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Commercial Customization</h2>
<p dir="auto">This tool itself is free to use also for commercial use.
And of course it comes with no warranty of any kind.</p>
<p dir="auto">But if you have an idea for a commercial use-case for
a customized version of this tool or for similar
technology - ideally something that helps
small and medium-sized businesses in northern Germany
become more competitive -
then please contact me at <a href="mailto:moin@DeutscheKI.de">moin@DeutscheKI.de</a></p>
<h2 dir="auto"><a id="user-content-research-citation" href="#research-citation" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Research Citation</h2>
<p dir="auto">If you use this for research, please cite:</p>
<div data-snippet-clipboard-copy-content="@misc{https://doi.org/10.48550/arxiv.2206.12693,
  doi = {10.48550/ARXIV.2206.12693},
  url = {https://arxiv.org/abs/2206.12693},
  author = {Krabbenhöft, Hajo Nils and Barth, Erhardt},  
  keywords = {Computation and Language (cs.CL), Sound (cs.SD), Audio and Speech Processing (eess.AS), FOS: Computer and information sciences, FOS: Computer and information sciences, FOS: Electrical engineering, electronic engineering, information engineering, FOS: Electrical engineering, electronic engineering, information engineering, F.2.1; I.2.6; I.2.7},  
  title = {TEVR: Improving Speech Recognition by Token Entropy Variance Reduction},  
  publisher = {arXiv},  
  year = {2022}, 
  copyright = {Creative Commons Attribution 4.0 International}
}"><pre><span>@misc</span>{<span>https://doi.org/10.48550/arxiv.2206.12693</span>,
  <span>doi</span> = <span><span>{</span>10.48550/ARXIV.2206.12693<span>}</span></span>,
  <span>url</span> = <span><span>{</span>https://arxiv.org/abs/2206.12693<span>}</span></span>,
  <span>author</span> = <span><span>{</span>Krabbenhöft, Hajo Nils and Barth, Erhardt<span>}</span></span>,  
  <span>keywords</span> = <span><span>{</span>Computation and Language (cs.CL), Sound (cs.SD), Audio and Speech Processing (eess.AS), FOS: Computer and information sciences, FOS: Computer and information sciences, FOS: Electrical engineering, electronic engineering, information engineering, FOS: Electrical engineering, electronic engineering, information engineering, F.2.1; I.2.6; I.2.7<span>}</span></span>,  
  <span>title</span> = <span><span>{</span>TEVR: Improving Speech Recognition by Token Entropy Variance Reduction<span>}</span></span>,  
  <span>publisher</span> = <span><span>{</span>arXiv<span>}</span></span>,  
  <span>year</span> = <span><span>{</span>2022<span>}</span></span>, 
  <span>copyright</span> = <span><span>{</span>Creative Commons Attribution 4.0 International<span>}</span></span>
}</pre></div>
<h2 dir="auto"><a id="user-content-replace-the-ai-model" href="#replace-the-ai-model" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Replace the AI Model</h2>
<p dir="auto">The German AI model and my training scripts can be found on HuggingFace:
<a href="https://huggingface.co/fxtentacle/wav2vec2-xls-r-1b-tevr" rel="nofollow">https://huggingface.co/fxtentacle/wav2vec2-xls-r-1b-tevr</a></p>
<p dir="auto">The model has undergone XLS-R cross-language pre-training.
You can directly fine-tune it with a different
language dataset - for example CommonVoice English -
and then re-export the files in the
<code>tevr-asr-data</code> folder.</p>
<p dir="auto">Alternatively, you can donate roughly 2 weeks of
A100 GPU credits to me
and I&#39;ll train a suitable recognition model
and upload it to HuggingFace.</p>
</article>
          </div></div>
  </body>
</html>
