<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.dhsdevelopments.com/array-languages-vs">Original</a>
    <h1>Array languages vs. the curse of the spreadsheet</h1>
    
    <div id="readability-page-1" class="page"><div><p>It has been said that the most popular programming language in the world is the spreadsheet (and in particular these days, Excel).</p>

<p>There is a valid argument that the spreadsheet embodies an array programming model, making Excel the most popular array programming language in the world.</p>

<p>As the author of an array programming language based on the ideas of APL, I see the popularity of the spreadsheet as both a problem (because it&#39;s so error-prone) and an opportunity (because while the fans of imperative languages like Python are probably too set in their ways to consider an alternative model of computation, users of spreadsheets are already thinking in terms of matrices of values, and some of those users may be more open to the idea of performing the same computation in a more reliable way).</p>

<p>Before discussing how to leverage the power of spreadsheets with a proper array based programming language, there is a need to discuss how spreadsheets are used today, and some of the problems with them.</p>

<h2 id="the-different-uses-of-spreadsheets" id="the-different-uses-of-spreadsheets">The different uses of spreadsheets</h2>

<p>When people use a spreadsheet, it&#39;s to do one of several things. In short, spreadsheets are used to perform many different activities, which can roughly be grouped into 3 main categories:</p>
<ul><li>Data entry</li>
<li>Computation</li>
<li>Presentation</li></ul>

<h3 id="data-entry" id="data-entry">Data entry</h3>

<p>Ever since VisiCalc was released in 1979, the spreadsheet has presented the user with a hugely inviting blank sheet of empty cells when the program was started.</p>

<table>
<thead>
<tr>
<th><img src="https://i.snap.as/yOXZFHEs.png" alt="Screenshot of the LibreOffice initial page"/></th>
</tr>
</thead>

<tbody>
<tr>
<td><em>What do you want to calculate today?</em></td>
</tr>
</tbody>
</table>

<p>The page almost calls out to the user to start inputting numbers. Our innate desire to organise things in categories is what has made this design so successful. The VisiCalc initial screen looked like this, as does the latest version of LibreOffice some 45 years later.</p>

<p>All you have to do is to move the cursor to the cell you want to edit, type the values and things will just work. While data entry specialist is still a job title in use today, there was a time when <em>any</em> data input was a complicated process that required specialist knowledge. The spreadsheet changed this to allow anyone to record anything they wanted in digital form.</p>

<h3 id="computation" id="computation">Computation</h3>

<p>Once the data is in the spreadsheet, you inevitably want to work with the numbers to produce some output.</p>

<p>Spreadsheets makes it very easy to take the step from simple data entry to computation of results. All you have to do is to add a <code>=sum(a1:a5)</code> to the sheet you&#39;ll have the sum in the cell you want.</p>

<h3 id="presentation" id="presentation">Presentation</h3>

<p>Spreadsheets aren&#39;t just about entering data and computing some results based on that data. It&#39;s also about presenting it in an appealing manner.</p>

<p>This is really where the you can see the genius of the invention. From something as simple as looking at a set of numbers, with the sum of those numbers neatly displayed as <strong>“Total:”</strong> below the values, to a complex form with coloured highlighting and different text styles to emphasise the results.</p>

<p>These sheets also become interactive without any extra work, since any change in the source data will automatically propagate to the sheet that contains the results.</p>

<h2 id="the-problems-with-spreadsheets-as-a-programming-environment" id="the-problems-with-spreadsheets-as-a-programming-environment">The problems with spreadsheets as a programming environment</h2>

<h3 id="the-spreadsheet-paradigm-hides-what-s-important-the-formulas-in-favour-of-the-superficial-the-data" id="the-spreadsheet-paradigm-hides-what-s-important-the-formulas-in-favour-of-the-superficial-the-data">The spreadsheet paradigm hides what&#39;s important (the formulas) in favour of the superficial (the data)</h3>

<p>Once you&#39;ve taken that first step to compute a sum in a spreadsheet, it&#39;s not a very long road until you find yourself in one of those multi-sheet monsters most people who work in a large company have seen. I&#39;ve certainly spent more time than I want to admit trying to untangle one of those bowls of spaghetti trying to find out why a certain number is computed the way it is.</p>

<p><img src="https://i.snap.as/qREaEZBm.png" alt="Screenshot of LibreOffice showing some products, its prices, amounts and the totals"/></p>

<p>Here&#39;s a silly quiz: Can you spot the error in the above spreadsheet?</p>

<p>I don&#39;t think is possible to tell just by looking at the screenshot. The problem is that cell D5 has the actual value entered instead of a formula (this could have happened due to some simple copy&amp;paste error).</p>

<p>And this is the true danger of spreadsheets. These kinds of mistakes are completely invisible when they happen. Instead, the results start to deviate (probably slowly) once the input data start to change, and you could be looking at invalid numbers for quite some time before anyone notices the problem. And if the dataset is large, it may be a lot of work to actually find the underlying mistake.</p>

<p>And this bring us to my proposition: <strong>Spreadsheets are doing a great job at data entry and presentation, but it&#39;s severely lacking as a computation tool.</strong></p>

<p>However, very few tools allow you to have a seamless workflow using a proper language for computation while still using spreadsheets for the other aspects of the workflow. Once a spreadsheet has grown too large, someone decides to write a Python application to replicate it, which inevitably means that they have to build a webapp around it, which is probably going to be much less user-friendly since spreadsheets have had 40+ years of UI refinements, while the webapp was put together in an afternoon.</p>

<h3 id="spreadsheets-intentionally-hides-errors-in-an-attempt-to-do-what-the-user-thinks-they-want" id="spreadsheets-intentionally-hides-errors-in-an-attempt-to-do-what-the-user-thinks-they-want">Spreadsheets intentionally hides errors in an attempt to do what the user thinks they want</h3>

<p>Since this section could become very large if I listed all the examples where spreadsheets (and Excel in particular) fails to highlight problems, so here&#39;s a sample:</p>
<ul><li>Numbers tend to be floating point, which means that the moment a value is entered, there are precision issues. This is actually something that could be improved simply by supporting rational arithmetic, although I don&#39;t think there are any spreadsheets that do.</li>
<li>If a number is entered as a string, it will look identical to an actual number (except that the alignment will be different by default). If you&#39;re lucky, you&#39;ll get an error later which will manifest as an <a href="https://blog.dhsdevelopments.com/tag:ERR"><span>#</span><span>ERR</span></a> field, and then you&#39;ll have a fun time finding the source of that issue.</li>
<li>The system invites the user to write long single-line formulas in a language that is not suited for long, single-line formulas. It all ends up being crammed into a space that is nowhere near large enough to hold it. This makes editing the code an absolutely painful experience.</li>
<li>Various errors, such as exceeding limits tend to be ignored instead of invalidating the entire document. This is something the <a href="https://www.bbc.com/news/technology-54423988">UK government was made painfully aware of</a>.</li></ul>



<p>The <a href="https://kapdemo.dhsdevelopments.com/">Kap</a> programming language provides an alternative. Or rather, it&#39;s a work in progress so it&#39;s probably better to say it <em>aims</em> to provide an alternative. That said, I already use it for many tasks where a spreadsheet would be the go-to tool for many people.</p>

<p>Like most APL derivatives, the way you use it is often not by opening a test editor and start writing a program. Instead, you start it, you are presented with a prompt, and you start using it more as a calculator than a traditional programming language. This makes sense, since a large number of programming tasks that would take a lot of code in another language, can be solved in just a few characters in Kap.</p>

<p><img src="https://i.snap.as/ZnCmOdri.png" alt="Screenshot of the Kap welcome screen"/></p>

<p>When given a problem to solve, you typically look at the problem and then reach for the tool that is the most efficient way to solve that problem, given tool availability and the person&#39;s preferences. For example:</p>
<ul><li>You need to compute the square of the number 54321. Most people would likely reach for their desktop environment&#39;s calculator here.</li>
<li>You want to compute the sum of some set of numbers. A natural choice here would be to use a spreadsheet.</li>
<li>You&#39;re given a dictionary and asked to find the longest word which contains no more than 2 vowels. I suspect a lot of people would open an editor and start writing Python code to solve this.</li></ul>

<p>For me, in all of these cases I open the Kap interactive tool, type a few characters and the problem is solved.</p>

<p>This is how I solved the third problem, by the way:</p>

<pre><code>{ ⊃ ⍵ ⊇⍨ ↑⍒≢¨ ⍵ /⍨ 2≥ (⊂&#34;aeiou&#34;) (+/∊⍨)¨ ⍵ } io:read &#34;dict.txt&#34;
</code></pre>

<p>At this point, comments suggesting the code is “unreadable” are bound to be thrown around, but once you learn a handful of symbols, this is in fact significantly more readable than the kinds of formulas I see on a regular basis in Excel. This is proof that one is not more difficult to learn than the other, and that the problem is one of marketing rather than technological.</p>

<p>In case anyone is curious about the above code, the next blog post will be a breakdown of the code above to explain how it works. Check this blog in the coming days.</p>

<p>The point I am trying to make by showing this example at all is to try to evoke the same kind of response as beginners get when faced with any code of any kind.</p>

<h2 id="the-kap-approach-to-spreadsheet-integration" id="the-kap-approach-to-spreadsheet-integration">The Kap approach to spreadsheet integration</h2>

<h3 id="the-array-editor" id="the-array-editor">The array editor</h3>

<p>The array editor is a graphical tool that allows the user to edit arrays in a way that is similar to a spreadsheet. The goal of this tool is to be as familiar as possible to someone who has used spreadsheets in the past.</p>

<p>The tool also allows you to type Kap expressions to manipulate values in the sheet. This is not like formulas, but rather direct modification of the data.</p>

<p>Funnily enough, this is actually something that is not obvious how to do in Excel. If you have a set of numbers, and you want to add some constant to them, the way you&#39;d do that is to create a formula that adds the constant to a cell and put that into a different location, usually on the same sheet, and then paste that formula to all the cells in an area with the same size as the original data, and hope that you got the dimensions right.</p>

<p>The array editor allows you to easily edit the content of an array. Of course, you can always do it programmatically, but I think the prevalence of spreadsheets has shown that it&#39;s convenient to do it in a visual manner.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/ps9olHDleCA" title="YouTube video player" frameborder="0" allowfullscreen=""></iframe>

<h3 id="data-import" id="data-import">Data import</h3>

<p>I have been participating in discussion forums and chat channels about APL and other array languages for a while now, and when a beginner starts learning one of these languages, after they have gone through all the tutorials, there comes a time where they want to work with real data and the first question is: <em>How do I get my data into the system?</em></p>

<p>After all, that&#39;s what I asked myself and was frustrated when I realised that preparing the data was harder than actually working with it.</p>

<p>So, when I started working on my own implementation, one of the most important goals was that loading pre-existing data into the interpreter was one of the most important features.</p>

<p>What&#39;s the most common format of array-based data today? It&#39;s probably not very far fetched to assume it&#39;s Excel. For this reason, being able to read spreadsheets into Kap has been a priority, and at the time of writing the following methods are supported:</p>
<ul><li>Using functions such as <code>msoffice:read</code> function in the language itself. There are similar functions to load data in other formats, such as CSV and JSON.</li>
<li>Open the a spreadsheet file (Excel or LibreOffice) in the gui-based array editor.</li>
<li>Copy&amp;paste directly from the spreadsheet.</li></ul>

<p>By the way, you can also paste any table data into the array editor. Here&#39;s an example of using Wikipedia content:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/Dwm-KUms6I0" title="YouTube video player" frameborder="0" allowfullscreen=""></iframe>

<h3 id="presentation-1" id="presentation-1">Presentation</h3>

<p>This is the part of the Kap UI tool that needs to most work. The vision is to provide a user interface that makes it just as easy to create a presentation of results as it is in Excel. However, it would only be used for presentation purposes, and not for data entry nor computation.</p>

<p>While there is some actual code there that can be tested, it&#39;s still not usable except as a demonstration of what the current ideas in this direction are.</p>

<h2 id="the-goal-of-kap-is-to-be-a-complement-to-spreadsheets" id="the-goal-of-kap-is-to-be-a-complement-to-spreadsheets">The goal of Kap is to be a complement to spreadsheets</h2>

<p>When someone needs to compute something, they typically look at the problem and then decide to open a tool that helps them solve said problem. While Kap is a great tool to solve a variety of problems, I tend to believe that it particularly excels in the kinds of problems where the solution would otherwise involve a spreadsheet.</p>

<p>Kap is a fully open source project available under the MIT license. If you want to learn more about Kap, visit the <a href="https://kapdemo.dhsdevelopments.com/">Kap website</a>. Feedback is always welcome.</p>
</div></div>
  </body>
</html>
