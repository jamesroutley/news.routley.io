<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/hollance/neural-engine">Original</a>
    <h1>What we know about the Apple Neural Engine</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">Most new iPhones and iPads have a <strong>Neural Engine</strong>, a special processor that makes machine learning models really fast, but not much is publicly known about how this processor actually works.</p>
<p dir="auto">The Apple Neural Engine (or ANE) is a type of <strong>NPU</strong>, which stands for Neural Processing Unit. It&#39;s like a GPU, but instead of accelerating graphics an NPU accelerates neural network operations such as convolutions and matrix multiplies.</p>
<p dir="auto">The ANE isn&#39;t the only NPU out there â€” many companies besides Apple are developing their own AI accelerator chips. Besides the Neural Engine, the most famous NPU is <a href="https://en.wikipedia.org/wiki/Tensor_processing_unit" rel="nofollow">Google&#39;s TPU</a> (or Tensor Processing Unit).</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-why-this-document" aria-hidden="true" href="#why-this-document"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Why this document?</h2>
<p dir="auto">When I was still providing ML consulting services for iOS, I would often get email from people who are confused why their model doesn&#39;t appear to be running on the Neural Engine, or <strong>why it is so slow</strong> when the ANE is supposed to be way faster than the GPU...</p>
<p dir="auto">It turns out that <strong>not every Core ML model can make full use of the ANE</strong>. The reason why can be complicated, hence this document tries to answer the most common questions.</p>
<p dir="auto">The ANE is great for making ML models run really fast on iPhones and iPads. A model that is optimized for the ANE will seriously outperform the CPU and GPU. But the ANE also has limitations. Unfortunately <strong>Apple isn&#39;t giving third-party developers any guidance</strong> on how to optimize their models to take advantage of the ANE. It&#39;s mostly a process of trial-and-error to figure out what works and what doesn&#39;t.</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> Everything here was obtained by experimentation. I do not work at Apple and never have, so I am not privy to any implementation details of this chip. Some of this information is probably wrong. It&#39;s definitely incomplete. If you know something that isn&#39;t explained here, or if you find information that is wrong or missing, please <a href="https://github.com/hollance/neural-engine/issues">file an issue</a> or <a href="https://github.com/hollance/neural-engine/pulls">make a pull request</a>. Thanks!</p>
</blockquote>
<p dir="auto">I was originally planning to make this a <a href="http://machinethink.net/blog" rel="nofollow">blog post</a> but decided to put it on GitHub to make it a community resource and so that other people could contribute to it too. Please do!</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-table-of-contents" aria-hidden="true" href="#table-of-contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Table of contents</h2>
<ul dir="auto">
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/supported-devices.md">Which devices have an ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/why-care.md">Why should I care about the ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/running-on-ane.md">How do I make my model run on the ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/prevent-running-on-ane.md">How do I prevent my model from running on the ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/is-model-using-ane.md">Is my model using the ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/programming-ane.md">Can I program the ANE directly?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/ane-vs-gpu.md">Isn&#39;t the ANE the same as the GPU?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/16-bit.md">Is the ANE 16-bit?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/unsupported-layers.md">Which Core ML layers are not supported by the ANE?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/os-log.md">Use os_log to look at warning / error messages</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/model-surgery.md">How to replace unsupported layers</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/internals.md">How does the ANE work internally?</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/other.md">Other weird issues</a></li>
<li><a href="https://ntietz.com/hollance/neural-engine/blob/master/docs/reverse-engineering.md">Reverse engineering the ANE</a></li>
</ul>
</article>
          </div></div>
  </body>
</html>
