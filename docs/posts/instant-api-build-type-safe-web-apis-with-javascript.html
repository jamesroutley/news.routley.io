<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/instant-dev/api">Original</a>
    <h1>Show HN: Instant API – Build type-safe web APIs with JavaScript</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/70104140dd1dcacd2e818d098fb8fc1f8b82143885a40a2a78d53b0bc8da30f2/68747470733a2f2f7472617669732d63692e6f72672f696e7374616e742d6465762f6170692e7376673f6272616e63683d6d61696e"><img src="https://camo.githubusercontent.com/70104140dd1dcacd2e818d098fb8fc1f8b82143885a40a2a78d53b0bc8da30f2/68747470733a2f2f7472617669732d63692e6f72672f696e7374616e742d6465762f6170692e7376673f6272616e63683d6d61696e" alt="travis-ci build" data-canonical-src="https://travis-ci.org/instant-dev/api.svg?branch=main"/></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/19c36b7f826e8a7e15c2112b55ef9657e2982190d521f1f3b3a31c615660c6e8/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f40696e7374616e742e6465762f6170693f6c6162656c3d"><img src="https://camo.githubusercontent.com/19c36b7f826e8a7e15c2112b55ef9657e2982190d521f1f3b3a31c615660c6e8/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f40696e7374616e742e6465762f6170693f6c6162656c3d" alt="npm version" data-canonical-src="https://img.shields.io/npm/v/@instant.dev/api?label="/></a></p>

<h2 tabindex="-1" id="user-content-spec-generation-and-llm-streaming" dir="auto"><a href="#spec-generation-and-llm-streaming">Spec generation and LLM streaming<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><strong>Instant API</strong> is a framework for building APIs with JavaScript that implements
<strong>type-safety at the HTTP interface</strong>. By doing so, it eliminates the need for
schema validation libraries entirely. Simply write a JSDoc-compliant comment
block for a function that represents your API endpoint and stop worrying about
validation, sanitization and testing for user input. The OpenAPI specification
for your API is then automatically generated in both JSON and YAML at
<code>localhost:8000/.well-known/openapi.json</code> and
<code>localhost:8000/.well-known/openapi.yaml</code>, respectively.</p>
<p dir="auto">Additionally, Instant API comes a number of features optimized for integrations
with LLMs and chat bots:</p>
<ul dir="auto">
<li>First class support for Server-Sent Events using <code>text/event-stream</code> makes streaming LLM responses easy</li>
<li><a href="https://openai.com/blog/function-calling-and-other-api-updates" rel="nofollow">LLM function calling</a> can be integrated
easily via JSON schema output at <code>localhost:8000/.well-known/schema.json</code></li>
<li>Experimental auto-generation of <code>localhost:8000/.well-known/ai-plugin.json</code></li>
<li>The ability to instantly return <code>200 OK</code> responses and execute in the background for Slack, Discord webhooks</li>
</ul>
<p dir="auto">You will find Instant API is a very full-featured framework despite being an
early release. It has been in development for six years as the engine behind the
<a href="https://autocode.com" rel="nofollow">Autocode</a> serverless platform where it has horizontally scaled
to handle over 100M API requests per day.</p>
<h2 tabindex="-1" id="user-content-quick-example-standard-api" dir="auto"><a href="#quick-example-standard-api">Quick example: Standard API<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Here&#39;s an example API endpoint built with Instant API. It would be available
at the URL <code>example.com/v1/weather/current</code> via HTTP GET. It has length
restrictions on <code>location</code>, range restrictions on <code>coords.lat</code> and <code>coords.lng</code>,
and <code>tags</code> is an array of string. The <code>@returns</code> definitions ensure that the API
contract with the user is upheld: if the wrong data is returned an error will be
thrown.</p>
<p dir="auto">File: <code>/functions/v1/weather/current.mjs</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * Retrieve the weather for a specific location
 * @param {?string{1..64}} location   Search by location
 * @param {?object}        coords     Provide specific latitude and longitude
 * @param {number{-90,90}} coords.lat Latitude
 * @param {number{-90,90}} coords.lng Longitude
 * @param {string[]}       tags       Nearby locations to include
 * @returns {object} weather             Your weather result
 * @returns {number} weather.temperature Current tmperature of the location
 * @returns {string} weather.unit        Fahrenheit or Celsius
 */
export async function GET (location = null, coords = null, tags = []) {

  if (!location &amp;&amp; !coords) {
    // Prefixing an error message with a &#34;###:&#34; between 400 and 404
    //   automatically creates the correct client error:
    //     BadRequestError, UnauthorizedError, PaymentRequiredError,
    //     ForbiddenError, NotFoundError
    // Otherwise, will throw a RuntimeError with code 420
    throw new Error(`400: Must provide either location or coords`);
  } else if (location &amp;&amp; coords) {
    throw new Error(`400: Can not provide both location and coords`);
  }

  // Fetch your own API data
  await getSomeWeatherDataFor(location, coords, tags);

  // mock a response
  return {
    temperature: 89.2
    units: `°F`
  };

}"><pre><span>/**</span>
<span> * Retrieve the weather for a specific location</span>
<span> * <span>@param</span> {<span>?string{1..64</span>}} location   Search by location</span>
<span> * <span>@param</span> {<span>?object</span>}        coords     Provide specific latitude and longitude</span>
<span> * <span>@param</span> {<span>number{-90,90</span>}} coords.lat Latitude</span>
<span> * <span>@param</span> {<span>number{-90,90</span>}} coords.lng Longitude</span>
<span> * <span>@param</span> {<span>string[]</span>}       tags       Nearby locations to include</span>
<span> * <span>@returns</span> {<span>object</span>} weather             Your weather result</span>
<span> * <span>@returns</span> {<span>number</span>} weather.temperature Current tmperature of the location</span>
<span> * <span>@returns</span> {<span>string</span>} weather.unit        Fahrenheit or Celsius</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>location</span> <span>=</span> <span>null</span><span>,</span> <span>coords</span> <span>=</span> <span>null</span><span>,</span> <span>tags</span> <span>=</span> <span>[</span><span>]</span><span>)</span> <span>{</span>

  <span>if</span> <span>(</span><span>!</span><span>location</span> <span>&amp;&amp;</span> <span>!</span><span>coords</span><span>)</span> <span>{</span>
    <span>// Prefixing an error message with a &#34;###:&#34; between 400 and 404</span>
    <span>//   automatically creates the correct client error:</span>
    <span>//     BadRequestError, UnauthorizedError, PaymentRequiredError,</span>
    <span>//     ForbiddenError, NotFoundError</span>
    <span>// Otherwise, will throw a RuntimeError with code 420</span>
    <span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>`400: Must provide either location or coords`</span><span>)</span><span>;</span>
  <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>location</span> <span>&amp;&amp;</span> <span>coords</span><span>)</span> <span>{</span>
    <span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>`400: Can not provide both location and coords`</span><span>)</span><span>;</span>
  <span>}</span>

  <span>// Fetch your own API data</span>
  <span>await</span> <span>getSomeWeatherDataFor</span><span>(</span><span>location</span><span>,</span> <span>coords</span><span>,</span> <span>tags</span><span>)</span><span>;</span>

  <span>// mock a response</span>
  <span>return</span> <span>{</span>
    <span>temperature</span>: <span>89.2</span>
    <span>units</span>: <span>`°F`</span>
  <span>}</span><span>;</span>

<span>}</span></pre></div>
<h2 tabindex="-1" id="user-content-quick-example-llm-streaming" dir="auto"><a href="#quick-example-llm-streaming">Quick example: LLM Streaming<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">LLM streaming is simple. It relies on a special <code>context</code> object and defining
<code>@stream</code> parameters to create a <code>text/event-stream</code> response. You can think
of <code>@stream</code> as similar to <code>@returns</code>, where you&#39;re specifying the schema
for the output to the user. If this contract is broken, your API will throw an
error. In order to send a stream to the user, we add a special <code>context</code> object
to the API footprint as the last parameter and use an exposed <code>context.stream()</code>
method.</p>
<p dir="auto">File: <code>/functions/v1/ai-helper.mjs</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="import OpenAI from &#39;openai&#39;;
const openai = new OpenAI(process.env.OPENAI_API_KEY);

/**
 * Streams results for our lovable assistant
 * @param {string} query The question for our assistant
 * @stream {object}   chunk
 * @stream {string}   chunk.id
 * @stream {string}   chunk.object
 * @stream {integer}  chunk.created
 * @stream {string}   chunk.model
 * @stream {object[]} chunk.choices
 * @stream {integer}  chunk.choices[].index
 * @stream {object}   chunk.choices[].delta
 * @stream {?string}  chunk.choices[].delta.role
 * @stream {?string}  chunk.choices[].delta.content
 * @returns {object} message
 * @returns {string} message.content
 */
export async function GET (query, context) {
  const completion = await openai.chat.completions.create({
    messages: [
      {role: `system`, content: `You are a lovable, cute assistant that uses too many emojis.`},
      {role: `user`, content: query}
    ],
    model: `gpt-3.5-turbo`,
    stream: true
  });
  const messages = [];
  for await (const chunk of completion) {
    // Stream our response as text/event-stream when ?_stream parameter added
    context.stream(&#39;chunk&#39;, chunk); // chunk has the schema provided above
    messages.push(chunk?.choices?.[0]?.delta?.content || &#39;&#39;);
  }
  return {content: messages.join(&#39;&#39;)};
};"><pre><span>import</span> <span>OpenAI</span> <span>from</span> <span>&#39;openai&#39;</span><span>;</span>
<span>const</span> <span>openai</span> <span>=</span> <span>new</span> <span>OpenAI</span><span>(</span><span>process</span><span>.</span><span>env</span><span>.</span><span>OPENAI_API_KEY</span><span>)</span><span>;</span>

<span>/**</span>
<span> * Streams results for our lovable assistant</span>
<span> * <span>@param</span> {<span>string</span>} query The question for our assistant</span>
<span> * <span>@stream</span> {object}   chunk</span>
<span> * <span>@stream</span> {string}   chunk.id</span>
<span> * <span>@stream</span> {string}   chunk.object</span>
<span> * <span>@stream</span> {integer}  chunk.created</span>
<span> * <span>@stream</span> {string}   chunk.model</span>
<span> * <span>@stream</span> {object[]} chunk.choices</span>
<span> * <span>@stream</span> {integer}  chunk.choices[].index</span>
<span> * <span>@stream</span> {object}   chunk.choices[].delta</span>
<span> * <span>@stream</span> {?string}  chunk.choices[].delta.role</span>
<span> * <span>@stream</span> {?string}  chunk.choices[].delta.content</span>
<span> * <span>@returns</span> {<span>object</span>} message</span>
<span> * <span>@returns</span> {<span>string</span>} message.content</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>query</span><span>,</span> <span>context</span><span>)</span> <span>{</span>
  <span>const</span> <span>completion</span> <span>=</span> <span>await</span> <span>openai</span><span>.</span><span>chat</span><span>.</span><span>completions</span><span>.</span><span>create</span><span>(</span><span>{</span>
    <span>messages</span>: <span>[</span>
      <span>{</span><span>role</span>: <span>`system`</span><span>,</span> <span>content</span>: <span>`You are a lovable, cute assistant that uses too many emojis.`</span><span>}</span><span>,</span>
      <span>{</span><span>role</span>: <span>`user`</span><span>,</span> <span>content</span>: <span>query</span><span>}</span>
    <span>]</span><span>,</span>
    <span>model</span>: <span>`gpt-3.5-turbo`</span><span>,</span>
    <span>stream</span>: <span>true</span>
  <span>}</span><span>)</span><span>;</span>
  <span>const</span> <span>messages</span> <span>=</span> <span>[</span><span>]</span><span>;</span>
  <span>for</span> <span>await</span> <span>(</span><span>const</span> <span>chunk</span> <span>of</span> <span>completion</span><span>)</span> <span>{</span>
    <span>// Stream our response as text/event-stream when ?_stream parameter added</span>
    <span>context</span><span>.</span><span>stream</span><span>(</span><span>&#39;chunk&#39;</span><span>,</span> <span>chunk</span><span>)</span><span>;</span> <span>// chunk has the schema provided above</span>
    <span>messages</span><span>.</span><span>push</span><span>(</span><span>chunk</span><span>?.</span><span>choices</span><span>?.</span><span>[</span><span>0</span><span>]</span><span>?.</span><span>delta</span><span>?.</span><span>content</span> <span>||</span> <span>&#39;&#39;</span><span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>{</span><span>content</span>: <span>messages</span><span>.</span><span>join</span><span>(</span><span>&#39;&#39;</span><span>)</span><span>}</span><span>;</span>
<span>}</span><span>;</span></pre></div>
<p dir="auto">By default, this method will return something like;</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;content&#34;: &#34;Hey there! 💁‍♀️ I&#39;m doing great, thank you! 💖✨ How about you? 😊🌈&#34;
}"><pre>{
  <span>&#34;content&#34;</span>: <span><span>&#34;</span>Hey there! 💁‍♀️ I&#39;m doing great, thank you! 💖✨ How about you? 😊🌈<span>&#34;</span></span>
}</pre></div>
<p dir="auto">However, if you append <code>?_stream</code> to query parameters or <code>{&#34;_stream&#34;: true}</code> to
body parameters, it will turn into a <code>text/event-stream</code> with your <code>context.stream()</code>
events sandwiched between a <code>@begin</code> and <code>@response</code> event. The <code>@response</code> event
will be an object containing the details of what the HTTP response would have contained
had the API call been made normally.</p>
<div dir="auto" data-snippet-clipboard-copy-content="id: 2023-10-25T04:29:59.115000000Z/2e7c7860-4a66-4824-98fa-a7cf71946f19
event: @begin
data: &#34;2023-10-25T04:29:59.115Z&#34;

[... more events ...]

event: chunk
data: {&#34;id&#34;:&#34;chatcmpl-8DPoluIgN4TDIuE1usFOKTLPiIUbQ&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1698208199,&#34;model&#34;:&#34;gpt-3.5-turbo-0613&#34;,&#34;choices&#34;:[{&#34;index&#34;:0,&#34;delta&#34;:{&#34;content&#34;:&#34; 💯&#34;},&#34;finish_reason&#34;:null}]}

[... more events ...]

event: @response
data: {&#34;statusCode&#34;:200,&#34;headers&#34;:{&#34;X-Execution-Uuid&#34;:&#34;2e7c7860-4a66-4824-98fa-a7cf71946f19&#34;,&#34;X-Instant-Api&#34;:&#34;true&#34;,&#34;Access-Control-Allow-Origin&#34;:&#34;*&#34;,&#34;Access-Control-Allow-Methods&#34;:&#34;GET, POST, OPTIONS, HEAD, PUT, DELETE&#34;,&#34;Access-Control-Allow-Headers&#34;:&#34;&#34;,&#34;Access-Control-Expose-Headers&#34;:&#34;x-execution-uuid, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid&#34;,&#34;Content-Type&#34;:&#34;application/json&#34;},&#34;body&#34;:&#34;{\&#34;content\&#34;:\&#34;Hey there! 🌞 I&#39;m feeling 💯 today! Full of energy and ready to help you out. How about you? How are you doing? 🌈😊\&#34;}&#34;}"><pre>id: 2023-10-25T04:29:59.115000000Z/2e7c7860-4a66-4824-98fa-a7cf71946f19
event: @begin
data: <span><span>&#34;</span>2023-10-25T04:29:59.115Z<span>&#34;</span></span>

[... more events ...]

event: chunk
data: {<span><span>&#34;</span>id<span>&#34;</span></span>:<span><span>&#34;</span>chatcmpl-8DPoluIgN4TDIuE1usFOKTLPiIUbQ<span>&#34;</span></span>,<span><span>&#34;</span>object<span>&#34;</span></span>:<span><span>&#34;</span>chat.completion.chunk<span>&#34;</span></span>,<span><span>&#34;</span>created<span>&#34;</span></span>:1698208199,<span><span>&#34;</span>model<span>&#34;</span></span>:<span><span>&#34;</span>gpt-3.5-turbo-0613<span>&#34;</span></span>,<span><span>&#34;</span>choices<span>&#34;</span></span>:[{<span><span>&#34;</span>index<span>&#34;</span></span>:0,<span><span>&#34;</span>delta<span>&#34;</span></span>:{<span><span>&#34;</span>content<span>&#34;</span></span>:<span><span>&#34;</span> 💯<span>&#34;</span></span>},<span><span>&#34;</span>finish_reason<span>&#34;</span></span>:null}]}

[... more events ...]

event: @response
data: {<span><span>&#34;</span>statusCode<span>&#34;</span></span>:200,<span><span>&#34;</span>headers<span>&#34;</span></span>:{<span><span>&#34;</span>X-Execution-Uuid<span>&#34;</span></span>:<span><span>&#34;</span>2e7c7860-4a66-4824-98fa-a7cf71946f19<span>&#34;</span></span>,<span><span>&#34;</span>X-Instant-Api<span>&#34;</span></span>:<span><span>&#34;</span>true<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Origin<span>&#34;</span></span>:<span><span>&#34;</span>*<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Methods<span>&#34;</span></span>:<span><span>&#34;</span>GET, POST, OPTIONS, HEAD, PUT, DELETE<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Headers<span>&#34;</span></span>:<span><span>&#34;</span><span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Expose-Headers<span>&#34;</span></span>:<span><span>&#34;</span>x-execution-uuid, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid<span>&#34;</span></span>,<span><span>&#34;</span>Content-Type<span>&#34;</span></span>:<span><span>&#34;</span>application/json<span>&#34;</span></span>},<span><span>&#34;</span>body<span>&#34;</span></span>:<span><span>&#34;</span>{<span>\&#34;</span>content<span>\&#34;</span>:<span>\&#34;</span>Hey there! 🌞 I&#39;m feeling 💯 today! Full of energy and ready to help you out. How about you? How are you doing? 🌈😊<span>\&#34;</span>}<span>&#34;</span></span>}</pre></div>
<h2 tabindex="-1" id="user-content-table-of-contents" dir="auto"><a href="#table-of-contents">Table of Contents<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<ol dir="auto">
<li><a href="#getting-started">Getting Started</a>
<ol dir="auto">
<li><a href="#quickstart">Quickstart</a></li>
<li><a href="#custom-installation">Custom installation</a></li>
</ol>
</li>
<li><a href="#endpoints-and-type-safety">Endpoints and Type Safety</a>
<ol dir="auto">
<li><a href="#creating-endpoints">Creating Endpoints</a></li>
<li><a href="#responding-to-http-methods">Responding to HTTP methods</a>
<ol dir="auto">
<li><a href="#endpoint-lifecycle">Endpoint lifecycle</a></li>
<li><a href="#typing-your-endpoint">Typing your endpoint</a>
<ol dir="auto">
<li><a href="#undocumented-parameters">Undocumented parameters</a></li>
<li><a href="#required-parameters">Required parameters</a></li>
<li><a href="#optional-parameters">Optional parameters</a></li>
</ol>
</li>
<li><a href="#context-object"><code>context</code> object</a></li>
<li><a href="#api-endpoints-functions-directory">API endpoints: <code>functions/</code> directory</a>
<ol dir="auto">
<li><a href="#index-routing-with-indexmjs">Index routing with <code>index.mjs</code></a></li>
<li><a href="#subdirectory-routing-with-404mjs">Subdirectory routing with <code>404.mjs</code></a></li>
</ol>
</li>
<li><a href="#static-files-www-directory">Static files: <code>www/</code> directory</a>
<ol dir="auto">
<li><a href="#index-routing-with-indexhtml">Index routing with <code>index.html</code></a></li>
<li><a href="#subdirectory-routing-with-404html">Subdirectory routing with <code>404.html</code></a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#type-safety">Type Safety</a>
<ol dir="auto">
<li><a href="#supported-types">Supported types</a></li>
<li><a href="#type-coercion">Type coercion</a></li>
<li><a href="#combining-types">Combining types</a></li>
<li><a href="#enums-and-restricting-to-specific-values">Enums and restricting to specific values</a></li>
<li><a href="#sizes-lengths">Sizes (lengths)</a></li>
<li><a href="#ranges">Ranges</a></li>
<li><a href="#arrays">Arrays</a></li>
<li><a href="#object-schemas">Object schemas</a></li>
</ol>
</li>
<li><a href="#parameter-validation">Parameter validation</a>
<ol dir="auto">
<li><a href="#query-and-body-parsing-with-applicationx-www-form-urlencoded">Query and Body parsing with <code>application/x-www-form-urlencoded</code></a></li>
<li><a href="#query-vs-body-parameters">Query vs. Body parameters</a></li>
</ol>
</li>
<li><a href="#cors-cross-origin-resource-sharing">CORS (Cross-Origin Resource Sharing)</a></li>
<li><a href="#returning-responses">Returning responses</a>
<ol dir="auto">
<li><a href="#returns-type-safety"><code>@returns</code> type safety</a></li>
<li><a href="#error-responses">Error responses</a></li>
<li><a href="#custom-http-responses">Custom HTTP responses</a></li>
<li><a href="#returning-files-with-buffer-responses">Returning files with Buffer responses</a></li>
<li><a href="#streaming-responses">Streaming responses</a></li>
<li><a href="#debug-responses">Debug responses</a></li>
</ol>
</li>
<li><a href="#throwing-errors">Throwing errors</a></li>
</ol>
</li>
<li><a href="#openapi-specification-generation">OpenAPI Specification Generation</a>
<ol dir="auto">
<li><a href="#openapi-output-example">OpenAPI Output Example</a></li>
<li><a href="#json-schema-output-example">JSON Schema Output Example</a></li>
<li><a href="#hiding-endpoints-with-private">Hiding endpoints with <code>@private</code></a></li>
</ol>
</li>
<li><a href="#streaming-and-llm-support">Streaming and LLM Support</a>
<ol dir="auto">
<li><a href="#stream-type-safety"><code>@stream</code> type safety</a></li>
<li><a href="#using-contextstream">Using <code>context.stream()</code></a></li>
<li><a href="#using-the-_stream-parameter">Using the <code>_stream</code> parameter</a>
<ol dir="auto">
<li><a href="#selectively-listening-to-specific-streams">Selectively listening to specific streams</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#background-execution-for-webhooks-and-chatbots">Background execution for webhooks and chatbots</a>
<ol dir="auto">
<li><a href="#background-directive"><code>@background</code> directive</a></li>
<li><a href="#using-the-_background-parameter">Using the <code>_background</code> parameter</a></li>
<li><a href="#background-modes">Background modes</a></li>
</ol>
</li>
<li><a href="#debugging">Debugging</a>
<ol dir="auto">
<li><a href="#using-contextlog-and-contexterror">Using <code>context.log()</code> and <code>context.error()</code></a></li>
<li><a href="#using-the-_debug-parameter">Using the <code>_debug</code> parameter</a></li>
</ol>
</li>
<li><a href="#built-in-errors">Built-in Errors</a></li>
<li><a href="#testing">Testing</a>
<ol dir="auto">
<li><a href="#quickstart-for-tests">Quickstart for tests</a></li>
<li><a href="#custom-installation-for-tests">Custom installation for tests</a></li>
<li><a href="#writing-tests">Writing tests</a></li>
<li><a href="#running-tests">Running tests</a></li>
</ol>
</li>
<li><a href="#deployment">Deployment</a>
<ol dir="auto">
<li><a href="#via-instant-deploy">via <code>instant deploy</code></a></li>
<li><a href="#custom-deployments">Custom deployments</a></li>
</ol>
</li>
<li><a href="#more-information">More Information</a>
<ol dir="auto">
<li><a href="#logging">Logging</a></li>
<li><a href="#error-monitoring">Error monitoring</a></li>
<li><a href="#middleware">Middleware</a></li>
</ol>
</li>
<li><a href="#roadmap-and-feedback">Roadmap and Feedback</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
</ol>
<h2 tabindex="-1" id="user-content-getting-started" dir="auto"><a href="#getting-started">Getting Started<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<h3 tabindex="-1" id="user-content-quickstart" dir="auto"><a href="#quickstart">Quickstart<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The quickest way to get started with Instant API is via the
<code>instant.dev</code> <a href="https://github.com/instant-dev/instant.dev">command line tools</a>.
It is the easiest way to get your Instant API project set up, generate new endpoints,
manage tests and comes with built-in deployment tooling for Vercel or AWS.
It comes packaged with the <a href="https://github.com/instant-dev/orm">Instant ORM</a> which
makes setting up a Postgres-based backend a breeze.</p>
<div dir="auto" data-snippet-clipboard-copy-content="npm i instant.dev -g
cd ~/projects
mkdir my-new-project
cd my-new-project
instant init"><pre>npm i instant.dev -g
<span>cd</span> <span>~</span>/projects
mkdir my-new-project
<span>cd</span> my-new-project
instant init</pre></div>
<p dir="auto">From there, you can use more advanced features:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Create an endpoint (test generated automatically)
instant g:endpoint first_endpoint

# Run your server
instant serve

# Run tests
instant test

# See all available commands
instant help"><pre><span><span>#</span> Create an endpoint (test generated automatically)</span>
instant g:endpoint first_endpoint

<span><span>#</span> Run your server</span>
instant serve

<span><span>#</span> Run tests</span>
instant <span>test</span>

<span><span>#</span> See all available commands</span>
instant <span>help</span></pre></div>
<h3 tabindex="-1" id="user-content-custom-installation" dir="auto"><a href="#custom-installation">Custom installation<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto"><strong>Note:</strong> Most of this documentation will assume you are using the
<a href="https://github.com/instant-dev/"><code>instant.dev</code> CLI</a>. It is the recommended
get your Instant API project set up, generate new endpoints, manage tests and
comes with built-in deployment tooling for Vercel or AWS.</p>
<p dir="auto">To use Instant API without the command line tools, you can do the following;</p>
<div dir="auto" data-snippet-clipboard-copy-content="cd path/to/my/project
npm i @instant.dev/api --save"><pre><span>cd</span> path/to/my/project
npm i @instant.dev/api --save</pre></div>
<p dir="auto">Then add the following to <code>package.json</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="  &#34;scripts&#34;: {
    &#34;start&#34;: &#34;node instant.mjs&#34;
  },"><pre>  <span>&#34;scripts&#34;</span>: {
    <span>&#34;start&#34;</span>: <span><span>&#34;</span>node instant.mjs<span>&#34;</span></span>
  },</pre></div>
<p dir="auto">And copy the following file to <code>instant.mjs</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// Third-party imports
import InstantAPI from &#39;@instant.dev/api&#39;;

// Native imports
import cluster from &#39;cluster&#39;;
import os from &#39;os&#39;;

// Shorthand references
const Daemon = InstantAPI.Daemon;
const Gateway = InstantAPI.Daemon.Gateway;
const EncryptionTools = InstantAPI.EncryptionTools;

// Constants
const ENVIRONMENT = process.env.NODE_ENV || &#39;development&#39;;
const PORT = process.env.PORT || 8000;

if (cluster.isPrimary) {

  // Multi-process daemon
  const daemon = new Daemon(
    ENVIRONMENT !== &#39;development&#39;
      ? os.cpus().length
      : 1
  );
  daemon.start(PORT);

} else {

  // Individual webserver startup
  const gateway = new Gateway({debug: ENVIRONMENT !== &#39;production&#39;});
  gateway.load(process.cwd());       // load routes from filesystem
  gateway.listen(PORT);              // start server

}"><pre><span>// Third-party imports</span>
<span>import</span> <span>InstantAPI</span> <span>from</span> <span>&#39;@instant.dev/api&#39;</span><span>;</span>

<span>// Native imports</span>
<span>import</span> <span>cluster</span> <span>from</span> <span>&#39;cluster&#39;</span><span>;</span>
<span>import</span> <span>os</span> <span>from</span> <span>&#39;os&#39;</span><span>;</span>

<span>// Shorthand references</span>
<span>const</span> <span>Daemon</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>Daemon</span><span>;</span>
<span>const</span> <span>Gateway</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>Daemon</span><span>.</span><span>Gateway</span><span>;</span>
<span>const</span> <span>EncryptionTools</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>EncryptionTools</span><span>;</span>

<span>// Constants</span>
<span>const</span> <span>ENVIRONMENT</span> <span>=</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>NODE_ENV</span> <span>||</span> <span>&#39;development&#39;</span><span>;</span>
<span>const</span> <span>PORT</span> <span>=</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>PORT</span> <span>||</span> <span>8000</span><span>;</span>

<span>if</span> <span>(</span><span>cluster</span><span>.</span><span>isPrimary</span><span>)</span> <span>{</span>

  <span>// Multi-process daemon</span>
  <span>const</span> <span>daemon</span> <span>=</span> <span>new</span> <span>Daemon</span><span>(</span>
    <span>ENVIRONMENT</span> <span>!==</span> <span>&#39;development&#39;</span>
      ? <span>os</span><span>.</span><span>cpus</span><span>(</span><span>)</span><span>.</span><span>length</span>
      : <span>1</span>
  <span>)</span><span>;</span>
  <span>daemon</span><span>.</span><span>start</span><span>(</span><span>PORT</span><span>)</span><span>;</span>

<span>}</span> <span>else</span> <span>{</span>

  <span>// Individual webserver startup</span>
  <span>const</span> <span>gateway</span> <span>=</span> <span>new</span> <span>Gateway</span><span>(</span><span>{</span><span>debug</span>: <span>ENVIRONMENT</span> <span>!==</span> <span>&#39;production&#39;</span><span>}</span><span>)</span><span>;</span>
  <span>gateway</span><span>.</span><span>load</span><span>(</span><span>process</span><span>.</span><span>cwd</span><span>(</span><span>)</span><span>)</span><span>;</span>       <span>// load routes from filesystem</span>
  <span>gateway</span><span>.</span><span>listen</span><span>(</span><span>PORT</span><span>)</span><span>;</span>              <span>// start server</span>

<span>}</span></pre></div>
<p dir="auto">To start your server, simply run:</p>

<h2 tabindex="-1" id="user-content-endpoints-and-type-safety" dir="auto"><a href="#endpoints-and-type-safety">Endpoints and Type Safety<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Instant API relies on a Function as a Service model for endpoint execution: every
{Route, HTTP Method} combination is modeled as an exported function. To add parameter
validation a.k.a. type safety to your endpoints, you simply document your exported
functions with a slightly modified JSDoc specification comment block. For example,
the simplest endpoint possible would look like this;</p>
<p dir="auto">File: <code>functions/index.js</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="export default async function () {
  return `hello world`;
}"><pre><span>export</span> <span>default</span> <span>async</span> <span>function</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello world`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">And you could execute it with;</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl localhost:8000/
&gt; &#34;hello world&#34;"><pre>curl localhost:8000/
<span>&gt;</span> <span><span>&#34;</span>hello world<span>&#34;</span></span></pre></div>
<p dir="auto">Assuming you are running <code>instant serve</code> or <code>npm start</code> on port <code>8000</code>. See
<a href="#getting-started">Getting started</a> for more details on starting your server.</p>
<h3 tabindex="-1" id="user-content-creating-endpoints" dir="auto"><a href="#creating-endpoints">Creating endpoints<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The easiest way to create endpoints for Instant API is via the <code>instant.dev</code>
<a href="https://github.com/instant-dev/instant">command line tools</a>. Once your project
has been initialized, you can write:</p>
<div dir="auto" data-snippet-clipboard-copy-content="instant g:endpoint path/to/endpoint"><pre>instant g:endpoint path/to/endpoint</pre></div>
<p dir="auto">And voila! A new blank endpoint has been created at <code>/functions/path/to/endpoint/index.mjs</code>.</p>
<p dir="auto">If you want to create an endpoint manually, just create a new <code>.mjs</code> file in the <code>functions/</code>
directory and make sure it outputs a function corresponding to at least one HTTP method:
<code>GET</code>, <code>POST</code>, <code>PUT</code> or <code>DELETE</code>.</p>
<h3 tabindex="-1" id="user-content-responding-to-http-methods" dir="auto"><a href="#responding-to-http-methods">Responding to HTTP methods<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">In the example above, we used <code>export default</code> to export a default function.
This function will respond to to all <code>GET</code>, <code>POST</code>, <code>PUT</code> and <code>DELETE</code> requests
with the same function. Alternatively, we can export functions for each method individually,
like so:</p>
<p dir="auto">File: <code>functions/index.js</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="export async function GET () {
  return `this was a GET request!`;
}

export async function POST () {
  return `this was a POST request!`;
}"><pre><span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>`this was a GET request!`</span><span>;</span>
<span>}</span>

<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>`this was a POST request!`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Any method not specified in this manner will automatically return an HTTP 501 error
(Not Implemented). You can test these endpoints like so;</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -X GET localhost:8000/
&gt; &#34;this was a GET request!&#34;

curl -X POST localhost:8000/
&gt; &#34;this was a POST request!&#34;

curl -X PUT localhost:8000/
&gt; {&#34;error&#34;:...} # Returns NotImplementedError (501)"><pre>curl -X GET localhost:8000/
<span>&gt;</span> <span><span>&#34;</span>this was a GET request!<span>&#34;</span></span>

curl -X POST localhost:8000/
<span>&gt;</span> <span><span>&#34;</span>this was a POST request!<span>&#34;</span></span>

curl -X PUT localhost:8000/
<span>&gt;</span> {<span><span>&#34;</span>error<span>&#34;</span></span>:...} <span><span>#</span> Returns NotImplementedError (501)</span></pre></div>
<p dir="auto"><strong>Note:</strong> Method names are <strong>case sensitive</strong>, they <strong>must</strong> be uppercase.
Instant API will throw an error if the exports aren&#39;t read properly.</p>
<h4 tabindex="-1" id="user-content-endpoint-lifecycle" dir="auto"><a href="#endpoint-lifecycle">Endpoint lifecycle<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">When endpoint files, like <code>functions/index.js</code> above, are accessed they
are imported <strong>only once per process</strong>. Code outside of <code>export</code> statements
is executed lazily the first time the function is executed. By default,
in a production server environment, Instant API will start one process per virtual core.</p>
<p dir="auto">Each exported function will be executed every time it is called. For the most part,
you should only use the area external to your <code>export</code> statements for critical library
imports and frequently accessed object caching; <strong>not for data persistence</strong>.</p>
<p dir="auto">Here&#39;s an example using <a href="https://github.com/instant-dev/orm">Instant ORM</a>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// DO THIS: Cache connections and commonly used objects, constructors

// Executed only once per process: lazily on first execution
import InstantORM from &#39;@instant.dev/orm&#39;;
const Instant = await InstantORM.connectToPool(); // connect to postgres
const User = Instant.Model(&#39;User&#39;); // access User model

/**
 * Find all users matching a provided username
 * @param {string} searchQuery Username portion to search for
 * @returns {object[]} users
 */
export async function GET (searchQuery) {
  // Executed each time endpoint called
  return await User.query()
    .where({username__icontains: searchUsername})
    .select();
}"><pre><span>// DO THIS: Cache connections and commonly used objects, constructors</span>

<span>// Executed only once per process: lazily on first execution</span>
<span>import</span> <span>InstantORM</span> <span>from</span> <span>&#39;@instant.dev/orm&#39;</span><span>;</span>
<span>const</span> <span>Instant</span> <span>=</span> <span>await</span> <span>InstantORM</span><span>.</span><span>connectToPool</span><span>(</span><span>)</span><span>;</span> <span>// connect to postgres</span>
<span>const</span> <span>User</span> <span>=</span> <span>Instant</span><span>.</span><span>Model</span><span>(</span><span>&#39;User&#39;</span><span>)</span><span>;</span> <span>// access User model</span>

<span>/**</span>
<span> * Find all users matching a provided username</span>
<span> * <span>@param</span> {<span>string</span>} searchQuery Username portion to search for</span>
<span> * <span>@returns</span> {<span>object[]</span>} users</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>searchQuery</span><span>)</span> <span>{</span>
  <span>// Executed each time endpoint called</span>
  <span>return</span> <span>await</span> <span>User</span><span>.</span><span>query</span><span>(</span><span>)</span>
    <span>.</span><span>where</span><span>(</span><span>{</span><span>username__icontains</span>: <span>searchUsername</span><span>}</span><span>)</span>
    <span>.</span><span>select</span><span>(</span><span>)</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Here&#39;s an example of what you should <strong>not</strong> do:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// DO NOT DO THIS: data persistence not reliable in production workloads
//    Could be on a multi-core server or serverless deployment e.g. Vercel

let pageViews = 0;

/**
 * Track views -- poorly. Persistence unreliable!
 */
export async function GET () {
  return `This page has been viewed ${++pageViews} times`;
}"><pre><span>// DO NOT DO THIS: data persistence not reliable in production workloads</span>
<span>//    Could be on a multi-core server or serverless deployment e.g. Vercel</span>

<span>let</span> <span>pageViews</span> <span>=</span> <span>0</span><span>;</span>

<span>/**</span>
<span> * Track views -- poorly. Persistence unreliable!</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>`This page has been viewed <span><span>${</span><span>++</span><span>pageViews</span><span>}</span></span> times`</span><span>;</span>
<span>}</span></pre></div>
<h4 tabindex="-1" id="user-content-typing-your-endpoint" dir="auto"><a href="#typing-your-endpoint">Typing your endpoint<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Endpoints can be typed using a slightly modified JSDoc specification that is
easily interpreted and syntax highlighted by most modern code editors. You
type your endpoint by (1) providing a comment block immediately preceding
your exported function and / or (2) providing default values for your
exported function.</p>
<p dir="auto"><strong>Note:</strong> Parameter documentation for typing is an all-or-none affair.
Instant API will refuse to start up if documented endpoints do not match the
function signature.</p>
<h5 tabindex="-1" id="user-content-undocumented-parameters" dir="auto"><a href="#undocumented-parameters">Undocumented parameters<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">By default, if you do not document your parameters <strong>at all</strong>, they will
be assumed to be type <code>any</code> and all be required. If you provided default
values, the parameters will be optional but will assume the type of their
default value.</p>
<div dir="auto" data-snippet-clipboard-copy-content="export async function GET (name, age = 25) {
  return `hello ${name} you are ${age}`;
}"><pre><span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>name</span><span>,</span> <span>age</span> <span>=</span> <span>25</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span> you are <span><span>${</span><span>age</span><span>}</span></span>`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">In this case, <code>name</code> is <strong>required</strong> by can take on any type. <code>age</code> is <strong>optional</strong>
but must be a <code>number</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -X GET localhost:8000/
&gt; {&#34;error&#34;:...} # Returns ParameterError (400) -- name is required

curl -X GET localhost:8000/?name=world
&gt; &#34;hello world you are 25&#34;

curl -X GET &#39;localhost:8000/?name=world&amp;age=lol&#39;
&gt; {&#34;error&#34;:...} # Returns ParameterError (400) -- age should be a number

curl -X GET &#39;localhost:8000/?name=world&amp;age=99&#39;
&gt; &#34;hello world you are 99&#34;"><pre>curl -X GET localhost:8000/
<span>&gt;</span> {<span><span>&#34;</span>error<span>&#34;</span></span>:...} <span><span>#</span> Returns ParameterError (400) -- name is required</span>

curl -X GET localhost:8000/<span>?</span>name=world
<span>&gt;</span> <span><span>&#34;</span>hello world you are 25<span>&#34;</span></span>

curl -X GET <span><span>&#39;</span>localhost:8000/?name=world&amp;age=lol<span>&#39;</span></span>
<span>&gt;</span> {<span><span>&#34;</span>error<span>&#34;</span></span>:...} <span><span>#</span> Returns ParameterError (400) -- age should be a number</span>

curl -X GET <span><span>&#39;</span>localhost:8000/?name=world&amp;age=99<span>&#39;</span></span>
<span>&gt;</span> <span><span>&#34;</span>hello world you are 99<span>&#34;</span></span></pre></div>
<h5 tabindex="-1" id="user-content-required-parameters" dir="auto"><a href="#required-parameters">Required parameters<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">A parameter is <strong>required</strong> if you <strong>do not provide a default value</strong> in the function
signature. For example;</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @param {string} name 
 */
export async function GET (name) {
  return `hello ${name}`;
}"><pre><span>/**</span>
<span> * <span>@param</span> {<span>string</span>} name </span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>name</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span>`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Will return a <code>ParameterError</code> with status code <code>400</code> indicating the <code>name</code>
parameter is required if no <code>name</code> is passed in to the endpoint.</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -X GET localhost:8000/
&gt; {&#34;error&#34;:...} # Returns ParameterError (400)

curl -X GET localhost:8000/?name=world
&gt; &#34;hello world&#34;"><pre>curl -X GET localhost:8000/
<span>&gt;</span> {<span><span>&#34;</span>error<span>&#34;</span></span>:...} <span><span>#</span> Returns ParameterError (400)</span>

curl -X GET localhost:8000/<span>?</span>name=world
<span>&gt;</span> <span><span>&#34;</span>hello world<span>&#34;</span></span></pre></div>
<h5 tabindex="-1" id="user-content-optional-parameters" dir="auto"><a href="#optional-parameters">Optional parameters<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">A parameter is <strong>optional</strong> if you:</p>
<ul dir="auto">
<li>prefix the type with a <code>?</code></li>
<li>AND / OR provide a default value in the function signature</li>
</ul>
<p dir="auto">If you prefix the type with <code>?</code>, the default value is assumed to be <code>null</code>.
You <strong>can not</strong> use <code>undefined</code> as an acceptable endpoint parameter value.</p>
<p dir="auto">For example;</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @param {?string} name 
 * @param {number} age
 */
export async function GET (name, age = 4.2e9) {
  return `hello ${name}, you are ${age}`;
}"><pre><span>/**</span>
<span> * <span>@param</span> {<span>?string</span>} name </span>
<span> * <span>@param</span> {<span>number</span>} age</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>name</span><span>,</span> <span>age</span> <span>=</span> <span>4.2e9</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span>, you are <span><span>${</span><span>age</span><span>}</span></span>`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Even though <code>name</code> was not provided in the function signature, the <code>?</code> in
<code>{?string}</code> indicates that this parameter is optional. It will be given a
default value of <code>null</code>. When included in a template string, null will be
printed as the string <code>&#34;null&#34;</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -X GET localhost:8000/
&gt; &#34;hello null, you are 4200000000&#34;

curl -X GET localhost:8000/?name=world
&gt; &#34;hello world, you are 4200000000&#34;

curl -X GET &#39;localhost:8000/?name=world&amp;age=101&#39;
&gt; &#34;hello world, you are 101&#34;"><pre>curl -X GET localhost:8000/
<span>&gt;</span> <span><span>&#34;</span>hello null, you are 4200000000<span>&#34;</span></span>

curl -X GET localhost:8000/<span>?</span>name=world
<span>&gt;</span> <span><span>&#34;</span>hello world, you are 4200000000<span>&#34;</span></span>

curl -X GET <span><span>&#39;</span>localhost:8000/?name=world&amp;age=101<span>&#39;</span></span>
<span>&gt;</span> <span><span>&#34;</span>hello world, you are 101<span>&#34;</span></span></pre></div>
<h4 tabindex="-1" id="user-content-context-object" dir="auto"><a href="#context-object"><code>context</code> object<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">The <code>context</code> object is a &#34;magic&#34; parameter that can be appended to any
function signature. It <strong>can not</strong> be documented and you <strong>can not</strong>
use &#34;context&#34; as a parameter name. The other magic parameters are
<code>_stream</code> (<a href="#streaming-and-llm-support">Streaming and LLM support</a>),
<code>_debug</code> (<a href="#debugging">Debug</a>) and <code>_background</code>. However, only
<code>context</code> can be added to your function signature.</p>
<p dir="auto">You can use <code>context</code> to access execution-specific information like so;</p>
<div dir="auto" data-snippet-clipboard-copy-content="export async function GET (context) {
  console.log(context.http.method);   // &#34;GET&#34;
  console.log(context.http.body);     // Request body (utf8)
  console.log(context.remoteAddress); // IP address
  return context;                     // ... and much more
}"><pre><span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>context</span><span>)</span> <span>{</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>context</span><span>.</span><span>http</span><span>.</span><span>method</span><span>)</span><span>;</span>   <span>// &#34;GET&#34;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>context</span><span>.</span><span>http</span><span>.</span><span>body</span><span>)</span><span>;</span>     <span>// Request body (utf8)</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>context</span><span>.</span><span>remoteAddress</span><span>)</span><span>;</span> <span>// IP address</span>
  <span>return</span> <span>context</span><span>;</span>                     <span>// ... and much more</span>
<span>}</span></pre></div>
<p dir="auto">It also comes with a <code>context.stream()</code> function which you can read about
in <a href="#streaming-and-llm-support">Streaming and LLM support</a>.</p>
<p dir="auto">A full list of available properties is as follows;</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;name&#34;: &#34;endpoint_name&#34;,
  &#34;alias&#34;: &#34;request_pathname&#34;,
  &#34;path&#34;: [&#34;request_pathname&#34;, &#34;split&#34;, &#34;by&#34;, &#34;/&#34;],
  &#34;params&#34;: {&#34;jsonified&#34;: &#34;params&#34;, &#34;passed&#34;: &#34;via_query_and_body&#34;},
  &#34;remoteAddress&#34;: &#34;ipv4_or_v6_address&#34;,
  &#34;uuid&#34;: &#34;request_uuid&#34;,
  &#34;http&#34;: {
    &#34;url&#34;: &#34;request_url&#34;,
    &#34;method&#34;: &#34;request_method&#34;,
    &#34;headers&#34;: {&#34;request&#34;: &#34;headers&#34;},
    &#34;body&#34;: &#34;request_body_utf8&#34;,
    &#34;json&#34;: &#34;request_body_json_if_applicable_else_null&#34;,
  },
  &#34;stream&#34;: function stream (name, value) { /* ... */ }
}"><pre><span>{</span>
  <span>&#34;name&#34;</span>: <span>&#34;endpoint_name&#34;</span><span>,</span>
  <span>&#34;alias&#34;</span>: <span>&#34;request_pathname&#34;</span><span>,</span>
  <span>&#34;path&#34;</span>: <span>[</span><span>&#34;request_pathname&#34;</span><span>,</span> <span>&#34;split&#34;</span><span>,</span> <span>&#34;by&#34;</span><span>,</span> <span>&#34;/&#34;</span><span>]</span><span>,</span>
  <span>&#34;params&#34;</span>: <span>{</span><span>&#34;jsonified&#34;</span>: <span>&#34;params&#34;</span><span>,</span> <span>&#34;passed&#34;</span>: <span>&#34;via_query_and_body&#34;</span><span>}</span><span>,</span>
  <span>&#34;remoteAddress&#34;</span>: <span>&#34;ipv4_or_v6_address&#34;</span><span>,</span>
  <span>&#34;uuid&#34;</span>: <span>&#34;request_uuid&#34;</span><span>,</span>
  <span>&#34;http&#34;</span>: <span>{</span>
    <span>&#34;url&#34;</span>: <span>&#34;request_url&#34;</span><span>,</span>
    <span>&#34;method&#34;</span>: <span>&#34;request_method&#34;</span><span>,</span>
    <span>&#34;headers&#34;</span>: <span>{</span><span>&#34;request&#34;</span>: <span>&#34;headers&#34;</span><span>}</span><span>,</span>
    <span>&#34;body&#34;</span>: <span>&#34;request_body_utf8&#34;</span><span>,</span>
    <span>&#34;json&#34;</span>: <span>&#34;request_body_json_if_applicable_else_null&#34;</span><span>,</span>
  <span>}</span><span>,</span>
  <span>&#34;stream&#34;</span>: <span>function</span> <span>stream</span> <span>(</span><span>name</span><span>,</span> <span>value</span><span>)</span> <span>{</span> <span>/* ... */</span> <span>}</span>
<span>}</span></pre></div>
<h4 tabindex="-1" id="user-content-api-endpoints-functions-directory" dir="auto"><a href="#api-endpoints-functions-directory">API endpoints: <code>functions/</code> directory<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">By default, anything in the root <code>functions/</code> directory of an Instant API
project is exported as an API endpoint. All <code>.js</code>, <code>.cjs</code> and <code>.mjs</code> files
are valid. We have not covered CommonJS-styled exports here as they are supported
for legacy purposes and not recommended for forward-facing development.</p>
<p dir="auto">Routing is handled by mapping the pathname of an HTTP request to the internal file
pathname of the function, not including <code>functions/</code> or the file extension. For example,
an HTTP request to <code>/v1/hello-world</code> will trigger <code>functions/v1/hello-world.js</code>.</p>
<p dir="auto">There are four &#34;magic&#34; filenames that can be used to handle indices or subdirectories.
<code>index.mjs</code> / <code>__main__.mjs</code> will act as a handler for the root directory and
<code>404.mjs</code> / <code>__notfound__.mjs</code> will act as a handler for any subdirectory or file
that is not otherwise defined.</p>
<h5 tabindex="-1" id="user-content-index-routing-with-indexmjs" dir="auto"><a href="#index-routing-with-indexmjs">Index routing with <code>index.mjs</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">Alias: <code>__main__.mjs</code></p>
<p dir="auto">Handler for the root directory. For example,
<code>functions/v1/stuff/index.mjs</code> is accessible via <code>/v1/stuff</code>.</p>
<h5 tabindex="-1" id="user-content-subdirectory-routing-with-404mjs" dir="auto"><a href="#subdirectory-routing-with-404mjs">Subdirectory routing with <code>404.mjs</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">Alias: <code>__notfound__.mjs</code></p>
<p dir="auto">Handler for subdirectories not otherwise defined. For example, with the following
directory structure:</p>
<div dir="auto" data-snippet-clipboard-copy-content="- functions/
  - v1/
    - stuff/
      - 404.mjs
      - abc.mjs"><pre>- <span>functions/</span>
  - <span>v1/</span>
    - <span>stuff/</span>
      - <span>404.mjs</span>
      - <span>abc.mjs</span></pre></div>
<p dir="auto">The following HTTP request pathnames would map to these endpoints;</p>
<ul dir="auto">
<li><code>/v1/stuff</code> -&gt; <code>functions/v1/stuff/404.mjs</code></li>
<li><code>/v1/stuff/abc</code> -&gt; <code>functions/v1/stuff/abc.mjs</code></li>
<li><code>/v1/stuff/abcd</code> -&gt; <code>functions/v1/stuff/404.mjs</code></li>
<li><code>/v1/stuff/abc/def</code> -&gt; <code>functions/v1/stuff/404.mjs</code></li>
</ul>
<p dir="auto">You can use this behavior to define custom routing schemes. If you want
custom 404 error pages we recommend using <a href="#subdirectory-routing-with-404html">Subdirectory routing with <code>404.html</code></a> instead.</p>
<h4 tabindex="-1" id="user-content-static-files-www-directory" dir="auto"><a href="#static-files-www-directory">Static files: <code>www/</code> directory<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Instant API comes with built-in static file hosting support. Instead
of putting files in the <code>functions/</code> directory, put any file you want
in the <code>www/</code> directory to automatically have it hosted as a standalone static
file.</p>
<p dir="auto">The rules for static hosting are as follows;</p>
<ul dir="auto">
<li>The server root <code>/</code> maps directly to <code>www/</code></li>
<li>e.g. <code>/image.png</code> -&gt; <code>www/image.png</code></li>
<li>All <code>.htm</code> and <code>.html</code> files will be available with AND without suffixes</li>
<li><code>/hello</code> -&gt; <code>www/hello.html</code></li>
<li><code>/hello.html</code> -&gt; <code>www/hello.html</code></li>
<li>API and static routes <strong>can not</strong> conflict</li>
<li><code>functions/wat.mjs</code> would overlap with <code>www/wat.htm</code> and is <strong>not</strong> allowed</li>
</ul>
<p dir="auto">There are four &#34;magic&#34; filenames that can be used to handle indices or subdirectories.
<code>index.html</code> / <code>index.htm</code> will act as a handler for the root directory and
<code>404.html</code> / <code>404.htm</code> will act as a handler for any subdirectory or file
that is not otherwise defined.</p>
<h5 tabindex="-1" id="user-content-index-routing-with-indexhtml" dir="auto"><a href="#index-routing-with-indexhtml">Index routing with <code>index.html</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">Alias: <code>index.htm</code></p>
<p dir="auto">Same behavior as <code>index.js</code> for API routes. Handler for the root pathname.</p>
<h5 tabindex="-1" id="user-content-subdirectory-routing-with-404html" dir="auto"><a href="#subdirectory-routing-with-404html">Subdirectory routing with <code>404.html</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h5>
<p dir="auto">Alias: <code>404.htm</code></p>
<p dir="auto">Same behavior as <code>404.js</code> for API routes. Handler for subdirectories that are
not otherwise defined. Ideal use case is for custom 404 error pages.</p>
<h3 tabindex="-1" id="user-content-type-safety" dir="auto"><a href="#type-safety">Type Safety<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Types are applied to parameter and schema validation based upon the comment block
preceding your exported endpoint function.</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * My GET endpoint
 * @param {any} myparam
 */
export async function GET (myparam) {
  // do something with myparam
}"><pre><span>/**</span>
<span> * My GET endpoint</span>
<span> * <span>@param</span> {<span>any</span>} myparam</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>myparam</span><span>)</span> <span>{</span>
  <span>// do something with myparam</span>
<span>}</span></pre></div>
<h4 tabindex="-1" id="user-content-supported-types" dir="auto"><a href="#supported-types">Supported types<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<table>
<thead>
<tr>
<th>Type</th>
<th>Definition</th>
<th>Example Parameter Input Values (JSON)</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>True or False</td>
<td><code>true</code> or <code>false</code></td>
</tr>
<tr>
<td>string</td>
<td>Basic text or character strings</td>
<td><code>&#34;hello&#34;</code>, <code>&#34;GOODBYE!&#34;</code></td>
</tr>
<tr>
<td>number</td>
<td>Any double-precision <a href="https://en.wikipedia.org/wiki/IEEE_floating_point" rel="nofollow">Floating Point</a> value</td>
<td><code>2e+100</code>, <code>1.02</code>, <code>-5</code></td>
</tr>
<tr>
<td>float</td>
<td>Alias for <code>number</code></td>
<td><code>2e+100</code>, <code>1.02</code>, <code>-5</code></td>
</tr>
<tr>
<td>integer</td>
<td>Subset of <code>number</code>, integers between <code>-2^53 + 1</code> and <code>+2^53 - 1</code> (inclusive)</td>
<td><code>0</code>, <code>-5</code>, <code>2000</code></td>
</tr>
<tr>
<td>object</td>
<td>Any JSON-serializable Object</td>
<td><code>{}</code>, <code>{&#34;a&#34;:true}</code>, <code>{&#34;hello&#34;:[&#34;world&#34;]}</code></td>
</tr>
<tr>
<td>object.http</td>
<td>An object representing an HTTP Response. Accepts <code>headers</code>, <code>body</code> and <code>statusCode</code> keys</td>
<td><code>{&#34;body&#34;: &#34;Hello World&#34;}</code>, <code>{&#34;statusCode&#34;: 404, &#34;body&#34;: &#34;not found&#34;}</code>, <code>{&#34;headers&#34;: {&#34;Content-Type&#34;: &#34;image/png&#34;}, &#34;body&#34;: Buffer.from(...)}</code></td>
</tr>
<tr>
<td>array</td>
<td>Any JSON-serializable Array</td>
<td><code>[]</code>, <code>[1, 2, 3]</code>, <code>[{&#34;a&#34;:true}, null, 5]</code></td>
</tr>
<tr>
<td>buffer</td>
<td>Raw binary octet (byte) data representing a file.</td>
<td><code>{&#34;_bytes&#34;: [8, 255]}</code> or <code>{&#34;_base64&#34;: &#34;d2h5IGRpZCB5b3UgcGFyc2UgdGhpcz8/&#34;}</code></td>
</tr>
<tr>
<td>any</td>
<td>Any value mentioned above</td>
<td><code>5</code>, <code>&#34;hello&#34;</code>, <code>[]</code></td>
</tr>
</tbody>
</table>
<h4 tabindex="-1" id="user-content-type-coercion" dir="auto"><a href="#type-coercion">Type coercion<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">The <code>buffer</code> type will automatically be converted to a <code>Buffer</code> from any <code>object</code> with a
<strong>single key-value pair matching the footprints</strong> <code>{&#34;_bytes&#34;: []}</code> or <code>{&#34;_base64&#34;: &#34;&#34;}</code>.</p>
<p dir="auto">Otherwise, parameters provided to a function are expected to match their
defined types. Requests made over HTTP GET via query parameters or POST data
with type <code>application/x-www-form-urlencoded</code> will be automatically
converted from strings to their respective expected types, when possible.</p>
<p dir="auto">Once converted, all types will undergo a final type validation. For example, passing
a JSON <code>array</code> like <code>[&#34;one&#34;, &#34;two&#34;]</code> to a parameter that expects an <code>object</code> will convert
from string to JSON successfully but fail the <code>object</code> type check.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Conversion Rule</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td><code>&#34;t&#34;</code> and <code>&#34;true&#34;</code> become <code>true</code>, <code>&#34;f&#34;</code> and <code>&#34;false&#34;</code> become <code>false</code>, otherwise will be kept as string</td>
</tr>
<tr>
<td>string</td>
<td>No conversion: already a string</td>
</tr>
<tr>
<td>number</td>
<td>Determine float value, if NaN keep as string, otherwise convert</td>
</tr>
<tr>
<td>float</td>
<td>Determine float value, if NaN keep as string, otherwise convert</td>
</tr>
<tr>
<td>integer</td>
<td>Determine float value, if NaN keep as string, otherwise convert: may fail integer check</td>
</tr>
<tr>
<td>object</td>
<td>Parse as JSON, if invalid keep as string, otherwise convert: may fail object check</td>
</tr>
<tr>
<td>object.http</td>
<td>Parse as JSON, if invalid keep as string, otherwise convert: may fail object.http check</td>
</tr>
<tr>
<td>array</td>
<td>Parse as JSON, if invalid keep as string, otherwise convert: may fail array check</td>
</tr>
<tr>
<td>buffer</td>
<td>Parse as JSON, if invalid keep as string, otherwise convert: may fail buffer check</td>
</tr>
<tr>
<td>any</td>
<td>No conversion: keep as string</td>
</tr>
</tbody>
</table>
<h4 tabindex="-1" id="user-content-combining-types" dir="auto"><a href="#combining-types">Combining types<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">You can combine types using the pipe <code>|</code> operator. For example;</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @param {string|integer} myparam String or an integer
 */
export async function GET (myparam) {
  // do something
} "><pre><span>/**</span>
<span> * <span>@param</span> {<span>string|integer</span>} myparam String or an integer</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>myparam</span><span>)</span> <span>{</span>
  <span>// do something</span>
<span>}</span> </pre></div>
<p dir="auto">Will accept a <code>string</code> or an <code>integer</code>. Types defined this way will validate against
the provided types in order of appearance. In this case, since it is a GET request and
all parameters are passed in as strings via query parameters, <code>myparam</code> will <strong>always</strong>
be received a string because it will successfully pass the string type coercion and
validation first.</p>
<p dir="auto">However, if you use a POST request:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @param {string|integer} myparam String or an integer
 */
export async function POST (myparam) {
  // do something
} "><pre><span>/**</span>
<span> * <span>@param</span> {<span>string|integer</span>} myparam String or an integer</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>myparam</span><span>)</span> <span>{</span>
  <span>// do something</span>
<span>}</span> </pre></div>
<p dir="auto">Then you can pass in <code>{&#34;myparam&#34;: &#34;1&#34;}</code> or <code>{&#34;myparam&#34;: 1}</code> via the body which would both
pass type validation.</p>
<p dir="auto">You can combine as many types as you&#39;d like:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {string|buffer|array|integer}"><pre>@<span>param</span> <span>{</span><span>string</span><span>|</span><span>buffer</span><span>|</span><span>array</span><span>|</span><span>integer</span><span>}</span></pre></div>
<p dir="auto">Including <code>any</code> in your list will, as expected, override any other type specifications.</p>
<h4 tabindex="-1" id="user-content-enums-and-restricting-to-specific-values" dir="auto"><a href="#enums-and-restricting-to-specific-values">Enums and restricting to specific values<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Similar to combining types, you can also include specific JSON values in your type definitions:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @param {&#34;one&#34;|&#34;two&#34;|&#34;three&#34;|4} myparam String or an integer
 */
export async function GET (myparam) {
  // do something
} "><pre><span>/**</span>
<span> * <span>@param</span> {<span>&#34;one&#34;|&#34;two&#34;|&#34;three&#34;|4</span>} myparam String or an integer</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>myparam</span><span>)</span> <span>{</span>
  <span>// do something</span>
<span>}</span> </pre></div>
<p dir="auto">This allows you to restrict possible inputs to a list of allowed values. In the case above,
sending <code>?myparam=4</code> via HTTP GET <strong>will</strong> successfully parse to  <code>4</code> (<code>Number</code>), because it
will fail validation against the three string options.</p>
<p dir="auto">You can combine specific values and types in your definitions freely:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {&#34;one&#34;|&#34;two&#34;|integer}"><pre>@<span>param</span> <span>{</span><span>&#34;one&#34;</span><span>|</span><span>&#34;two&#34;</span><span>|</span><span>integer</span><span>}</span></pre></div>
<p dir="auto">Just note that certain combinations will invalidate other list items. Like <code>{1|2|integer}</code> will
accept any valid integer.</p>
<h4 tabindex="-1" id="user-content-sizes-lengths" dir="auto"><a href="#sizes-lengths">Sizes (lengths)<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">The types <code>string</code>, <code>array</code> and <code>buffer</code> support sizes (lengths) via the <code>{a..b}</code> modifier on the type.
For example;</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {string{..9}}  alpha
@param {string{2..6}} beta
@param {string{5..}}  gamma"><pre>@<span>param</span> <span>{</span><span>string</span><span>{</span><span>.</span><span>.9</span><span>}</span><span>}</span>  <span>alpha</span>
@<span>param</span> <span>{</span><span>string</span><span>{</span><span>2.</span><span>.6</span><span>}</span><span>}</span> <span>beta</span>
@<span>param</span> <span>{</span><span>string</span><span>{</span><span>5.</span><span>.</span><span>}</span><span>}</span>  <span>gamma</span></pre></div>
<p dir="auto">Would expect <code>alpha</code> to have a maximum length of <code>9</code>, <code>beta</code> to have a minimum length of
<code>2</code> but a maximum length of <code>6</code>, and <code>gamma</code> to have a minimum length of <code>5</code>.</p>
<h4 tabindex="-1" id="user-content-ranges" dir="auto"><a href="#ranges">Ranges<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">The types <code>number</code>, <code>float</code> and <code>integer</code> support ranges via the <code>{a,b}</code> modifier on the type.
For example;</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {number{,1.2e9}} alpha
@param {number{-10,10}} beta
@param {number{0.870,}} gamma"><pre>@<span>param</span> <span>{</span><span>number</span><span>{</span><span>,</span><span>1.2e9</span><span>}</span><span>}</span> <span>alpha</span>
@<span>param</span> <span>{</span><span>number</span><span>{</span><span>-</span><span>10</span><span>,</span><span>10</span><span>}</span><span>}</span> <span>beta</span>
@<span>param</span> <span>{</span><span>number</span><span>{</span><span>0.870</span><span>,</span><span>}</span><span>}</span> <span>gamma</span></pre></div>
<p dir="auto">Would expect <code>alpha</code> to have a maximum value of <code>1 200 000 000</code>, <code>beta</code> to have a minimum value of
<code>-10</code> but a maximum value of <code>10</code>, and <code>gamma</code> to have a minimum value of <code>0.87</code>.</p>
<h4 tabindex="-1" id="user-content-arrays" dir="auto"><a href="#arrays">Arrays<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Arrays are supported via the <code>array</code> type. You can optionally specify a schema for the array
which applies to <strong>every element in the array</strong>. There are two formats for specifying array
schemas, you can pick which works best for you:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {string[]}      arrayOfStrings1
@param {array&lt;string&gt;} arrayOfStrings2"><pre>@<span>param</span> <span>{</span><span>string</span><span>[</span><span></span><span>]</span><span>}</span>      <span>arrayOfStrings1</span>
@<span>param</span> <span>{</span><span>array</span><span>&lt;</span><span>string</span><span>&gt;</span><span>}</span> <span>arrayOfStrings2</span></pre></div>
<p dir="auto">For multi-dimensional arrays, you can use nesting:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {integer[][]}           array2d
@param {array&lt;array&lt;integer&gt;&gt;} array2d_too"><pre>@<span>param</span> <span>{</span><span>integer</span><span>[</span><span>]</span><span>[</span><span>]</span><span>}</span>           <span>array2d</span>
@<span>param</span> <span>{</span>array<span></span><span>&lt;</span><span>array</span><span>&lt;</span><span>integer</span><span>&gt;&gt;</span><span>}</span> <span>array2d_too</span></pre></div>
<p dir="auto"><strong>Please note</strong>: Combining types are not currently available in array schemas. Open up an
issue and let us know if you&#39;d like them and what your use case is! In the meantime;</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {integer[]|string[]}"><pre>@<span>param</span> <span>{</span><span>integer</span><span>[</span><span></span><span>]</span><span>|</span><span>string</span><span>[</span><span></span><span>]</span><span>}</span></pre></div>
<p dir="auto">Would successfully define an array of integers or an array of strings.</p>
<h4 tabindex="-1" id="user-content-object-schemas" dir="auto"><a href="#object-schemas">Object schemas<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">To define object schemas, use the subsequent lines of the schema after your initial object
definition to define individual properties. For example, the object
<code>{&#34;a&#34;: 1, &#34;b&#34;: &#34;two&#34;, &#34;c&#34;: {&#34;d&#34;: true, &#34;e&#34;: []}</code> Could be defined like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {object}  myObject
@param {integer} myObject.a
@param {string}  myObject.b
@param {object}  myObject.c
@param {boolean} myObject.c.d
@param {array}   myObject.c.e"><pre>@<span>param</span> <span>{</span><span>object</span><span>}</span>  <span>myObject</span>
@<span>param</span> <span>{</span><span>integer</span><span>}</span> <span>myObject</span><span>.</span><span>a</span>
@<span>param</span> <span>{</span><span>string</span><span>}</span>  <span>myObject</span><span>.</span><span>b</span>
@<span>param</span> <span>{</span><span>object</span><span>}</span>  <span>myObject</span><span>.</span><span>c</span>
@<span>param</span> <span>{</span><span>boolean</span><span>}</span> <span>myObject</span><span>.</span><span>c</span><span>.</span><span>d</span>
@<span>param</span> <span>{</span><span>array</span><span>}</span>   <span>myObject</span><span>.</span><span>c</span><span>.</span><span>e</span></pre></div>
<p dir="auto">To define object schemas that are members of arrays, you must identify the array component in the
property name with <code>[]</code>. For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@param {object[]} topLevelArray
@param {integer}  topLevelArray[].value
@param {object}   myObject
@param {object[]} myObject.subArray
@param {string}   myObject.subArray[].name"><pre>@<span>param</span> <span>{</span><span>object</span><span>[</span><span></span><span>]</span><span>}</span> <span>topLevelArray</span>
@<span>param</span> <span>{</span><span>integer</span><span>}</span>  <span>topLevelArray</span><span>[</span><span></span><span>]</span><span>.</span><span>value</span>
@<span>param</span> <span>{</span><span>object</span><span>}</span>   <span>myObject</span>
@<span>param</span> <span>{</span><span>object</span><span>[</span><span></span><span>]</span><span>}</span> <span>myObject</span><span>.</span><span>subArray</span>
@<span>param</span> <span>{</span><span>string</span><span>}</span>   <span>myObject</span><span>.</span><span>subArray</span><span>[</span><span></span><span>]</span><span>.</span><span>name</span></pre></div>
<h3 tabindex="-1" id="user-content-parameter-validation" dir="auto"><a href="#parameter-validation">Parameter validation<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Parameter validation occurs based on types as defined per <a href="#type-safety">Type Safety</a>.
The process for parameter validation takes the following steps:</p>
<ol dir="auto">
<li>Read parameters from the HTTP query string as type <code>application/x-www-form-urlencoded</code></li>
<li>If applicable, read parameters from the HTTP body based on the request <code>Content-Type</code>
<ul dir="auto">
<li>Supported content types:
<ul dir="auto">
<li><code>application/json</code></li>
<li><code>application/x-www-formurlencoded</code></li>
<li><code>multipart/form-data</code></li>
<li><code>application/xml</code>, <code>application/atom+xml</code>, <code>text/xml</code></li>
</ul>
</li>
</ul>
</li>
<li>Query parameters <strong>can not</strong> conflict with body parameters, throw an error if they do</li>
<li>Perform type coercion on <code>application/x-www-form-urlencoded</code> inputs (query and body, if applicable)</li>
<li>Validate parameters against their expected types, throw an error if they do not match</li>
</ol>
<p dir="auto">During this process, you can encounter a <code>ParameterParseError</code> or a <code>ParameterError</code> both with
status code <code>400</code>. <code>ParameterParseError</code> means your parameters could not be parsed based on
the expected or provided content type, and <code>ParameterError</code> is a validation error against the
schema for your endpoint.</p>
<h4 tabindex="-1" id="user-content-query-and-body-parsing-with-applicationx-www-form-urlencoded" dir="auto"><a href="#query-and-body-parsing-with-applicationx-www-form-urlencoded">Query and Body parsing with <code>application/x-www-form-urlencoded</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Many different standards have been implemented and adopted over the years for
HTTP query parameters and how they can be used to specify objects and arrays.
To make things easy, Instant API supports all common query parameter parsing formats.</p>
<p dir="auto">Here are some query parameter examples of parsing form-urlencoded data:</p>
<ul dir="auto">
<li>Arrays
<ul dir="auto">
<li>Duplicates: <code>?arr=1&amp;arr=2</code> becomes <code>[1, 2]</code></li>
<li>Array syntax: <code>?arr[]=1&amp;arr[]=2</code> becomes <code>[1, 2]</code></li>
<li>Index syntax: <code>?arr[0]=1&amp;arr[2]=3</code> becomes <code>[1, null, 3]</code></li>
<li>JSON syntax: <code>?arr=[1,2]</code> becomes <code>[1, 2]</code></li>
</ul>
</li>
<li>Objects
<ul dir="auto">
<li>Bracket syntax: <code>?obj[a]=1&amp;obj[b]=2</code> becomes <code>{&#34;a&#34;: 1, &#34;b&#34;: 2}</code></li>
<li>Dot syntax: <code>?obj.a=1&amp;obj.b=2</code> becomes <code>{&#34;a&#34;: 1, &#34;b&#34;: 2}</code>
<ul dir="auto">
<li>Nesting: <code>?obj.a.b.c.d=t</code> becomes <code>{&#34;a&#34;: {&#34;b&#34;: {&#34;c&#34;: {&#34;d&#34;: true}}}}</code></li>
</ul>
</li>
<li>JSON syntax: <code>?obj={&#34;a&#34;:1,&#34;b&#34;:2}</code> becomes <code>{&#34;a&#34;: 1, &#34;b&#34;: 2}</code></li>
</ul>
</li>
</ul>
<h4 tabindex="-1" id="user-content-query-vs-body-parameters" dir="auto"><a href="#query-vs-body-parameters">Query vs. Body parameters<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">With Instant API, <strong>query and body parameters can be used interchangeably</strong>.
The general expectation is that <code>POST</code> and <code>PUT</code> endpoints should typically
only interface with the content body, but API consumers should be able to freely
manipulate query parameters if they want to play around.
For example, the endpoint defined by:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * Hello world endpoint
 * @param {string} name
 * @param {number} age
 */
export async function POST (name, age) {
  return `hello ${name}, you are ${age}!`;
}"><pre><span>/**</span>
<span> * Hello world endpoint</span>
<span> * <span>@param</span> {<span>string</span>} name</span>
<span> * <span>@param</span> {<span>number</span>} age</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>name</span><span>,</span> <span>age</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span>, you are <span><span>${</span><span>age</span><span>}</span></span>!`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Could be triggered successfull via;</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -X POST &#39;localhost:8000/hello-world?name=world&amp;age=99&#39;
curl -X POST &#39;localhost:8000/hello-world?name=world&#39; --data &#39;{&#34;age&#34;:99}&#39;
curl -X POST &#39;localhost:8000/hello-world&#39; --data &#39;{&#34;name&#34;:&#34;world&#34;,&#34;age&#34;:99}&#39;"><pre>curl -X POST <span><span>&#39;</span>localhost:8000/hello-world?name=world&amp;age=99<span>&#39;</span></span>
curl -X POST <span><span>&#39;</span>localhost:8000/hello-world?name=world<span>&#39;</span></span> --data <span><span>&#39;</span>{&#34;age&#34;:99}<span>&#39;</span></span>
curl -X POST <span><span>&#39;</span>localhost:8000/hello-world<span>&#39;</span></span> --data <span><span>&#39;</span>{&#34;name&#34;:&#34;world&#34;,&#34;age&#34;:99}<span>&#39;</span></span></pre></div>
<p dir="auto">Generally speaking, our motivation for this pattern comes from two observations;</p>
<ol dir="auto">
<li>In decades of software development we have never seen a legitimate use case for
query parameters and body parameters with the same name on a single endpoint</li>
<li>Exposing APIs this way is a lot easier for end users to play with</li>
</ol>
<p dir="auto">To prevent unexpected errors, naming collisions will throw an error at the gateway layer,
before your endpoint is executed.</p>
<h3 tabindex="-1" id="user-content-cors-cross-origin-resource-sharing" dir="auto"><a href="#cors-cross-origin-resource-sharing">CORS (Cross-Origin Resource Sharing)<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">By default, all endpoints have a <strong>completely open</strong> CORS policy, they all return
the header <code>Access-Control-Allow-Origin: *</code>.</p>
<p dir="auto">To restrict endpoints to specific URLs use the <code>@origin</code> directive. You can add
as many of these as you&#39;d like.</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * My CORS-restricted endpoint
 * @origin staging.my-website.com
 * @origin http://localhost:8000
 * @origin https://my-website.com
 * @origin =process.env.ALLOWED_ORIGIN
 * @origin =process.env.ANOTHER_ALLOWED_ORIGIN
 * @param {number} age
 */
export async function POST (name, age) {
  return `hello ${name}, you are ${age}!`;
}"><pre><span>/**</span>
<span> * My CORS-restricted endpoint</span>
<span> * <span>@origin</span> staging.my-website.com</span>
<span> * <span>@origin</span> http://localhost:8000</span>
<span> * <span>@origin</span> https://my-website.com</span>
<span> * <span>@origin</span> =process.env.ALLOWED_ORIGIN</span>
<span> * <span>@origin</span> =process.env.ANOTHER_ALLOWED_ORIGIN</span>
<span> * <span>@param</span> {<span>number</span>} age</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>name</span><span>,</span> <span>age</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span>, you are <span><span>${</span><span>age</span><span>}</span></span>!`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">The CORS <code>Access-Control-Allow-Origin</code> policy will be set like so;</p>
<ul dir="auto">
<li>If no protocol is specified, allow all traffic from the URL</li>
<li>If port is specified, only allow traffic from the URL on the specified port</li>
<li>If <code>http://</code> is specified, only allow <code>http</code> protocol traffic from the URL</li>
<li>If <code>https://</code> is specified, only allow <code>https</code> protocol traffic from the URL</li>
<li>If origin starts with <code>=process.env.</code>, it will rely on the specified environment variable</li>
</ul>
<p dir="auto">Note that <code>=process.env.ENV_NAME</code> entries will be loaded at startup time. Dynamically
changing <code>process.env</code> afterwards will have no effect on your allowed origins.</p>
<h3 tabindex="-1" id="user-content-returning-responses" dir="auto"><a href="#returning-responses">Returning responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Returning API responses from your endpoint is easy. Just add a <code>return</code> statement
with whatever data you would like to return.</p>
<div dir="auto" data-snippet-clipboard-copy-content="export async function GET () {
  return `hello world`; // works as expected
}"><pre><span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello world`</span><span>;</span> <span>// works as expected</span>
<span>}</span></pre></div>
<p dir="auto">By default, all responses will be <code>JSON.stringify()</code>-ed and returned with the
<code>Content-Type</code> header set to <code>application/json</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl localhost:8000/hello-world
&gt; &#34;hello world&#34;"><pre>curl localhost:8000/hello-world
<span>&gt;</span> <span><span>&#34;</span>hello world<span>&#34;</span></span></pre></div>
<p dir="auto">There are two exceptions: returning an <code>object.http</code> object
(containing <code>statusCode</code>, <code>headers</code>, and <code>body</code>) allows you to provide a
<a href="#custom-http-responses">Custom HTTP response</a> and returning a <code>Buffer</code>, which are
treated as <a href="#returning-files-with-buffer-responses">raw binary (file) data</a>.</p>
<h4 tabindex="-1" id="user-content-returns-type-safety" dir="auto"><a href="#returns-type-safety"><code>@returns</code> type safety<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Similar to <a href="#parameter-validation">Parameter validation</a>, you can enforce a type
schema on the return value of your endpoint like so;</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @returns {object} message
 * @returns {string} message.content
 */
export async function GET () {
  return {message: `hello world`};
}"><pre><span>/**</span>
<span> * <span>@returns</span> {<span>object</span>} message</span>
<span> * <span>@returns</span> {<span>string</span>} message.content</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>{</span><span>message</span>: <span>`hello world`</span><span>}</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">The difference between <code>@returns</code> type safety as compared to <code>@param</code> validation
is that this type safety mechanism is run <strong>after</strong> your code has been executed.
If you fail a <code>@returns</code> type safety check, the user receives a <code>ValueError</code> with
status code <code>502</code>: a server error. The function may have executed successfully
but the value does not fulfill the promised API contract. This functionality exists
to ensure users can trust the type contract of your API. To avoid production snafus,
we recommend <a href="#writing-tests">writing tests</a> to validate that your endpoints
return the values you expect them to.</p>
<h4 tabindex="-1" id="user-content-error-responses" dir="auto"><a href="#error-responses">Error responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Any uncaught promises or thrown errors will result in a <code>RuntimeError</code> with a status
code of <code>420</code> (unknown) by default. To customize error codes, check out
<a href="#throwing-errors">Throwing Errors</a>.</p>
<h4 tabindex="-1" id="user-content-custom-http-responses" dir="auto"><a href="#custom-http-responses">Custom HTTP responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">To return a custom HTTP response, simply return an object with one or all of the following
keys: <code>statusCode</code> (integer), <code>headers</code> (object) and <code>body</code> (Buffer). You can specify
this in the <code>@returns</code> schema, however Instant API will automatically detect the type.</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * I&#39;m a teapot
 */
export async function GET () {
  return {
    statusCode: 418,
    headers: {&#39;Content-Type&#39;, &#39;text/plain&#39;},
    body: Buffer.from(`I&#39;m a teapot!`)
  };
}"><pre><span>/**</span>
<span> * I&#39;m a teapot</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>{</span>
    <span>statusCode</span>: <span>418</span><span>,</span>
    <span>headers</span>: <span>{</span><span>&#39;Content-Type&#39;</span><span>,</span> <span>&#39;text/plain&#39;</span><span>}</span><span>,</span>
    <span>body</span>: <span>Buffer</span><span>.</span><span>from</span><span>(</span><span>`I&#39;m a teapot!`</span><span>)</span>
  <span>}</span><span>;</span>
<span>}</span></pre></div>
<h4 tabindex="-1" id="user-content-returning-files-with-buffer-responses" dir="auto"><a href="#returning-files-with-buffer-responses">Returning files with Buffer responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">If you would like to return a raw file from the file system, compose binary data into a
downloadable file, or dynamically generate an image (e.g. with Dall-E or Stable Diffusion)
you can build a custom HTTP response as per above - but Instant API makes it a little easier
than that.</p>
<p dir="auto">If you return a <code>Buffer</code> object you can optionally specify a <code>contentType</code> to set the
<code>Content-Type</code> http header like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import fs from &#39;fs&#39;;

/**
 * Return an image from the filesystem to be displayed
 */
export async function GET () {
  const buffer = fs.readFileSync(&#39;./path/to/image.png&#39;);
  buffer.contentType = &#39;image/png&#39;;
  return buffer;
}"><pre><span>import</span> <span>fs</span> <span>from</span> <span>&#39;fs&#39;</span><span>;</span>

<span>/**</span>
<span> * Return an image from the filesystem to be displayed</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>buffer</span> <span>=</span> <span>fs</span><span>.</span><span>readFileSync</span><span>(</span><span>&#39;./path/to/image.png&#39;</span><span>)</span><span>;</span>
  <span>buffer</span><span>.</span><span>contentType</span> <span>=</span> <span>&#39;image/png&#39;</span><span>;</span>
  <span>return</span> <span>buffer</span><span>;</span>
<span>}</span></pre></div>
<h4 tabindex="-1" id="user-content-streaming-responses" dir="auto"><a href="#streaming-responses">Streaming responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">Instant API has first-class support for streaming using the <code>text/event-stream</code>
content type and the &#34;magic&#34; <code>_stream</code> parameter.
You can read more in <a href="#streaming-and-llm-support">Streaming and LLM support</a>.</p>
<h4 tabindex="-1" id="user-content-debug-responses" dir="auto"><a href="#debug-responses">Debug responses<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">In <code>development</code> environments, e.g. when <code>process.env.NODE_ENV=development</code>, you
can stream the results of any function using the &#34;magic&#34; <code>_debug</code> parameter.
This allows you to monitor function execution in the browser for long-running jobs.
You can read more in <a href="#debugging">Debugging</a>.</p>
<h3 tabindex="-1" id="user-content-throwing-errors" dir="auto"><a href="#throwing-errors">Throwing Errors<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Whenever a <code>throw</code> statement is executed or a Promise is uncaught within the context
of an Instant API endpoint, the default behavior is to return a <code>RuntimeError</code> with
a status code of <code>420</code>: your browser will refer to this as &#34;unknown&#34;, we think of it
as &#34;confused&#34;.</p>
<p dir="auto">To specify a specific error code between 400 and 404, simply throw an error prefixed
with the code and a colon like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * Errors out
 */
export async function GET () {
  throw new Error(`400: No good!`);
}"><pre><span>/**</span>
<span> * Errors out</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>)</span> <span>{</span>
  <span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>`400: No good!`</span><span>)</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">When you execute this function you would see a <code>BadRequestError</code> with a status code of <code>400</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;error&#34;: {
    &#34;type&#34;: &#34;BadRequestError&#34;,
    &#34;message&#34;: &#34;No good!&#34;
  }
}"><pre>{
  <span>&#34;error&#34;</span>: {
    <span>&#34;type&#34;</span>: <span><span>&#34;</span>BadRequestError<span>&#34;</span></span>,
    <span>&#34;message&#34;</span>: <span><span>&#34;</span>No good!<span>&#34;</span></span>
  }
}</pre></div>
<p dir="auto">The following error codes will automatically map to error types:</p>
<ul dir="auto">
<li>400: <code>BadRequestError</code></li>
<li>401: <code>UnauthorizedError</code></li>
<li>402: <code>PaymentRequiredError</code></li>
<li>403: <code>ForbiddenError</code></li>
<li>404: <code>NotFoundError</code></li>
</ul>
<h2 tabindex="-1" id="user-content-openapi-specification-generation" dir="auto"><a href="#openapi-specification-generation">OpenAPI Specification Generation<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">OpenAPI specifications are extremely helpful for machine-readability but are
extremely verbose. Instant API allows you to manage all your type signatures
and parameter validation via JSDoc in a very terse manner while automatically
generating your OpenAPI specification for you. By default Instant API will
create three schema files based on your API:</p>
<ul dir="auto">
<li><code>localhost:8000/.well-known/openapi.json</code></li>
<li><code>localhost:8000/.well-known/openapi.yaml</code></li>
<li><code>localhost:8000/.well-known/schema.json</code></li>
</ul>
<p dir="auto">The first two are <a href="https://www.openapis.org/" rel="nofollow">OpenAPI schemas</a> and the
final one is a <a href="https://json-schema.org/" rel="nofollow">JSON schema</a> which outputs a
<code>{&#34;functions&#34;: [...]}</code> object. The latter is primarily intended for use
with <a href="https://openai.com/blog/function-calling-and-other-api-updates" rel="nofollow">OpenAI function calling</a>
and other LLM integrations.</p>
<h3 tabindex="-1" id="user-content-openapi-output-example" dir="auto"><a href="#openapi-output-example">OpenAPI Output Example<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">As a simple example, consider the following endpoint:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * Gets a &#34;Hello World&#34; message
 * @param {string} name
 * @param {number{12,199}} age
 * @returns {string} message
 */
export async function GET (name, age) {
  return `hello ${name}, you are ${age} and you rock!`
}

/**
 * Creates a new hello world message
 * @param {object} body
 * @param {string} body.content
 * @returns {object}  result
 * @returns {boolean} result.created
 */
export async function POST (body) {
  console.log(`Create body ... `, body);
  return {created: true};
}"><pre><span>/**</span>
<span> * Gets a &#34;Hello World&#34; message</span>
<span> * <span>@param</span> {<span>string</span>} name</span>
<span> * <span>@param</span> {<span>number{12,199</span>}} age</span>
<span> * <span>@returns</span> {<span>string</span>} message</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>name</span><span>,</span> <span>age</span><span>)</span> <span>{</span>
  <span>return</span> <span>`hello <span><span>${</span><span>name</span><span>}</span></span>, you are <span><span>${</span><span>age</span><span>}</span></span> and you rock!`</span>
<span>}</span>

<span>/**</span>
<span> * Creates a new hello world message</span>
<span> * <span>@param</span> {<span>object</span>} body</span>
<span> * <span>@param</span> {<span>string</span>} body.content</span>
<span> * <span>@returns</span> {<span>object</span>}  result</span>
<span> * <span>@returns</span> {<span>boolean</span>} result.created</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>body</span><span>)</span> <span>{</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>`Create body ... `</span><span>,</span> <span>body</span><span>)</span><span>;</span>
  <span>return</span> <span>{</span><span>created</span>: <span>true</span><span>}</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Once saved as part of your project, if you open <code>localhost:8000/.well-known/openapi.yaml</code>
in your browser, you should receive the following OpenAPI specification:</p>
<div dir="auto" data-snippet-clipboard-copy-content="openapi: &#34;3.1.0&#34;
info:
  version: &#34;development&#34;
  title: &#34;(No name provided)&#34;
  description: &#34;(No description provided)&#34;
servers:
  - url: &#34;localhost&#34;
    description: &#34;Instant API Gateway&#34;
paths:
  /hello-world/:
    get:
      summary: &#34;Gets a \&#34;Hello World\&#34; message&#34;
      description: &#34;Gets a \&#34;Hello World\&#34; message&#34;
      operationId: &#34;service_localhost_hello_world_get&#34;
      parameters:
        - in: &#34;query&#34;
          name: &#34;name&#34;
          schema:
            type: &#34;string&#34;
        - in: &#34;query&#34;
          name: &#34;age&#34;
          schema:
            type: &#34;number&#34;
            minimum: 12
            maximum: 199
      responses:
        200:
          content:
            application/json:
              schema:
                type: &#34;string&#34;
    post:
      summary: &#34;Creates a new hello world message&#34;
      description: &#34;Creates a new hello world message&#34;
      operationId: &#34;service_localhost_hello_world_post&#34;
      requestBody:
        content:
          application/json:
            schema:
              type: &#34;object&#34;
              properties:
                body:
                  type: &#34;object&#34;
                  properties:
                    content:
                      type: &#34;string&#34;
                  required:
                    - &#34;content&#34;
              required:
                - &#34;body&#34;
      responses:
        200:
          content:
            application/json:
              schema:
                type: &#34;object&#34;
                properties:
                  created:
                    type: &#34;boolean&#34;
                required:
                  - &#34;created&#34;"><pre><span>openapi</span>: <span><span>&#34;</span>3.1.0<span>&#34;</span></span>
<span>info</span>:
  <span>version</span>: <span><span>&#34;</span>development<span>&#34;</span></span>
  <span>title</span>: <span><span>&#34;</span>(No name provided)<span>&#34;</span></span>
  <span>description</span>: <span><span>&#34;</span>(No description provided)<span>&#34;</span></span>
<span>servers</span>:
  - <span>url</span>: <span><span>&#34;</span>localhost<span>&#34;</span></span>
    <span>description</span>: <span><span>&#34;</span>Instant API Gateway<span>&#34;</span></span>
<span>paths</span>:
  <span>/hello-world/</span>:
    <span>get</span>:
      <span>summary</span>: <span><span>&#34;</span>Gets a <span>\&#34;</span>Hello World<span>\&#34;</span> message<span>&#34;</span></span>
      <span>description</span>: <span><span>&#34;</span>Gets a <span>\&#34;</span>Hello World<span>\&#34;</span> message<span>&#34;</span></span>
      <span>operationId</span>: <span><span>&#34;</span>service_localhost_hello_world_get<span>&#34;</span></span>
      <span>parameters</span>:
        - <span>in</span>: <span><span>&#34;</span>query<span>&#34;</span></span>
          <span>name</span>: <span><span>&#34;</span>name<span>&#34;</span></span>
          <span>schema</span>:
            <span>type</span>: <span><span>&#34;</span>string<span>&#34;</span></span>
        - <span>in</span>: <span><span>&#34;</span>query<span>&#34;</span></span>
          <span>name</span>: <span><span>&#34;</span>age<span>&#34;</span></span>
          <span>schema</span>:
            <span>type</span>: <span><span>&#34;</span>number<span>&#34;</span></span>
            <span>minimum</span>: <span>12</span>
            <span>maximum</span>: <span>199</span>
      <span>responses</span>:
        <span>200</span>:
          <span>content</span>:
            <span>application/json</span>:
              <span>schema</span>:
                <span>type</span>: <span><span>&#34;</span>string<span>&#34;</span></span>
    <span>post</span>:
      <span>summary</span>: <span><span>&#34;</span>Creates a new hello world message<span>&#34;</span></span>
      <span>description</span>: <span><span>&#34;</span>Creates a new hello world message<span>&#34;</span></span>
      <span>operationId</span>: <span><span>&#34;</span>service_localhost_hello_world_post<span>&#34;</span></span>
      <span>requestBody</span>:
        <span>content</span>:
          <span>application/json</span>:
            <span>schema</span>:
              <span>type</span>: <span><span>&#34;</span>object<span>&#34;</span></span>
              <span>properties</span>:
                <span>body</span>:
                  <span>type</span>: <span><span>&#34;</span>object<span>&#34;</span></span>
                  <span>properties</span>:
                    <span>content</span>:
                      <span>type</span>: <span><span>&#34;</span>string<span>&#34;</span></span>
                  <span>required</span>:
                    - <span><span>&#34;</span>content<span>&#34;</span></span>
              <span>required</span>:
                - <span><span>&#34;</span>body<span>&#34;</span></span>
      <span>responses</span>:
        <span>200</span>:
          <span>content</span>:
            <span>application/json</span>:
              <span>schema</span>:
                <span>type</span>: <span><span>&#34;</span>object<span>&#34;</span></span>
                <span>properties</span>:
                  <span>created</span>:
                    <span>type</span>: <span><span>&#34;</span>boolean<span>&#34;</span></span>
                <span>required</span>:
                  - <span><span>&#34;</span>created<span>&#34;</span></span></pre></div>
<h3 tabindex="-1" id="user-content-json-schema-output-example" dir="auto"><a href="#json-schema-output-example">JSON Schema Output Example<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Using the same endpoint defined above would produce the following JSON schema
at <code>localhost:8000/.well-known/schema.json</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;functions&#34;: [
    {
      &#34;name&#34;: &#34;hello-world_get&#34;,
      &#34;description&#34;: &#34;Gets a \&#34;Hello World\&#34; message&#34;,
      &#34;route&#34;: &#34;/hello-world/&#34;,
      &#34;url&#34;: &#34;localhost/hello-world/&#34;,
      &#34;method&#34;: &#34;GET&#34;,
      &#34;parameters&#34;: {
        &#34;type&#34;: &#34;object&#34;,
        &#34;properties&#34;: {
          &#34;name&#34;: {
            &#34;type&#34;: &#34;string&#34;
          },
          &#34;age&#34;: {
            &#34;type&#34;: &#34;number&#34;,
            &#34;minimum&#34;: 12,
            &#34;maximum&#34;: 199
          }
        },
        &#34;required&#34;: [
          &#34;name&#34;,
          &#34;age&#34;
        ]
      }
    },
    {
      &#34;name&#34;: &#34;hello-world&#34;,
      &#34;description&#34;: &#34;Creates a new hello world message&#34;,
      &#34;route&#34;: &#34;/hello-world/&#34;,
      &#34;url&#34;: &#34;localhost/hello-world/&#34;,
      &#34;method&#34;: &#34;POST&#34;,
      &#34;parameters&#34;: {
        &#34;type&#34;: &#34;object&#34;,
        &#34;properties&#34;: {
          &#34;body&#34;: {
            &#34;type&#34;: &#34;object&#34;,
            &#34;properties&#34;: {
              &#34;content&#34;: {
                &#34;type&#34;: &#34;string&#34;
              }
            },
            &#34;required&#34;: [
              &#34;content&#34;
            ]
          }
        },
        &#34;required&#34;: [
          &#34;body&#34;
        ]
      }
    }
  ]
}"><pre>{
  <span>&#34;functions&#34;</span>: [
    {
      <span>&#34;name&#34;</span>: <span><span>&#34;</span>hello-world_get<span>&#34;</span></span>,
      <span>&#34;description&#34;</span>: <span><span>&#34;</span>Gets a <span>\&#34;</span>Hello World<span>\&#34;</span> message<span>&#34;</span></span>,
      <span>&#34;route&#34;</span>: <span><span>&#34;</span>/hello-world/<span>&#34;</span></span>,
      <span>&#34;url&#34;</span>: <span><span>&#34;</span>localhost/hello-world/<span>&#34;</span></span>,
      <span>&#34;method&#34;</span>: <span><span>&#34;</span>GET<span>&#34;</span></span>,
      <span>&#34;parameters&#34;</span>: {
        <span>&#34;type&#34;</span>: <span><span>&#34;</span>object<span>&#34;</span></span>,
        <span>&#34;properties&#34;</span>: {
          <span>&#34;name&#34;</span>: {
            <span>&#34;type&#34;</span>: <span><span>&#34;</span>string<span>&#34;</span></span>
          },
          <span>&#34;age&#34;</span>: {
            <span>&#34;type&#34;</span>: <span><span>&#34;</span>number<span>&#34;</span></span>,
            <span>&#34;minimum&#34;</span>: <span>12</span>,
            <span>&#34;maximum&#34;</span>: <span>199</span>
          }
        },
        <span>&#34;required&#34;</span>: [
          <span><span>&#34;</span>name<span>&#34;</span></span>,
          <span><span>&#34;</span>age<span>&#34;</span></span>
        ]
      }
    },
    {
      <span>&#34;name&#34;</span>: <span><span>&#34;</span>hello-world<span>&#34;</span></span>,
      <span>&#34;description&#34;</span>: <span><span>&#34;</span>Creates a new hello world message<span>&#34;</span></span>,
      <span>&#34;route&#34;</span>: <span><span>&#34;</span>/hello-world/<span>&#34;</span></span>,
      <span>&#34;url&#34;</span>: <span><span>&#34;</span>localhost/hello-world/<span>&#34;</span></span>,
      <span>&#34;method&#34;</span>: <span><span>&#34;</span>POST<span>&#34;</span></span>,
      <span>&#34;parameters&#34;</span>: {
        <span>&#34;type&#34;</span>: <span><span>&#34;</span>object<span>&#34;</span></span>,
        <span>&#34;properties&#34;</span>: {
          <span>&#34;body&#34;</span>: {
            <span>&#34;type&#34;</span>: <span><span>&#34;</span>object<span>&#34;</span></span>,
            <span>&#34;properties&#34;</span>: {
              <span>&#34;content&#34;</span>: {
                <span>&#34;type&#34;</span>: <span><span>&#34;</span>string<span>&#34;</span></span>
              }
            },
            <span>&#34;required&#34;</span>: [
              <span><span>&#34;</span>content<span>&#34;</span></span>
            ]
          }
        },
        <span>&#34;required&#34;</span>: [
          <span><span>&#34;</span>body<span>&#34;</span></span>
        ]
      }
    }
  ]
}</pre></div>
<h3 tabindex="-1" id="user-content-hiding-endpoints-with-private" dir="auto"><a href="#hiding-endpoints-with-private">Hiding endpoints with <code>@private</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Don&#39;t want all of your endpoints exposed to your end users? No problem.
Simply mark an endpoint as <code>@private</code>, like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * My admin function
 * @private
 */
export async function POST (context) {
  await authenticateAdminUser(context);
  doSomethingAdministrative();
  return `ok!`;
}"><pre><span>/**</span>
<span> * My admin function</span>
<span> * <span>@private</span></span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>POST</span> <span>(</span><span>context</span><span>)</span> <span>{</span>
  <span>await</span> <span>authenticateAdminUser</span><span>(</span><span>context</span><span>)</span><span>;</span>
  <span>doSomethingAdministrative</span><span>(</span><span>)</span><span>;</span>
  <span>return</span> <span>`ok!`</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">This will prevent it from being shown in either your OpenAPI or JSON schema
outputs.</p>
<h2 tabindex="-1" id="user-content-streaming-and-llm-support" dir="auto"><a href="#streaming-and-llm-support">Streaming and LLM support<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Instant API comes with built-in support for streaming
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events" rel="nofollow">Server-Sent Events</a>
with the <code>text/event-stream</code> content type. This allows you to send
events to a user as they are received, and is ideal for developing
LLM-based APIs.</p>
<p dir="auto">Streams are typed events that can be sent via a special <code>context.stream()</code>
method. They must be defined using the <code>@stream</code> directive in the JSDoc
descriptor for your API endpoint. Streams are typed like <code>@param</code> and <code>@returns</code>,
and these types are enforced: if you choose to <code>context.stream(name, payload)</code> the
wrong data format in <code>payload</code>, your function will throw an error.</p>
<p dir="auto">By default, functions <strong>will not stream</strong> even when a <code>@stream</code> is defined
and <code>context.stream()</code> is called. They will simply accept parameters and output a
returned response. In order to activate streaming, you must pass a <code>_stream</code> parameter
in the HTTP query parameters or body content - this will initiate a Server-Sent Event
with content type <code>text/event-stream</code>.</p>
<p dir="auto">An example of a simple custom streaming LLM agent endpoint built with Instant API
is below:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import OpenAI from &#39;openai&#39;;
const openai = new OpenAI(process.env.OPENAI_API_KEY);

/**
 * Streams results for our lovable assistant
 * @param {string} query The question for our assistant
 * @stream {object}   chunk
 * @stream {string}   chunk.id
 * @stream {string}   chunk.object
 * @stream {integer}  chunk.created
 * @stream {string}   chunk.model
 * @stream {object[]} chunk.choices
 * @stream {integer}  chunk.choices[].index
 * @stream {object}   chunk.choices[].delta
 * @stream {?string}  chunk.choices[].delta.role
 * @stream {?string}  chunk.choices[].delta.content
 * @returns {object} message
 * @returns {string} message.content
 */
export async function GET (query, context) {
  const completion = await openai.chat.completions.create({
    messages: [
      {role: `system`, content: `You are a lovable, cute assistant that uses too many emojis.`},
      {role: `user`, content: query}
    ],
    model: `gpt-3.5-turbo`,
    stream: true
  });
  const messages = [];
  for await (const chunk of completion) {
    // Stream our response as text/event-stream when ?_stream parameter added
    context.stream(&#39;chunk&#39;, chunk); // chunk has the schema provided above
    messages.push(chunk?.choices?.[0]?.delta?.content || &#39;&#39;);
  }
  return {content: messages.join(&#39;&#39;)};
};"><pre><span>import</span> <span>OpenAI</span> <span>from</span> <span>&#39;openai&#39;</span><span>;</span>
<span>const</span> <span>openai</span> <span>=</span> <span>new</span> <span>OpenAI</span><span>(</span><span>process</span><span>.</span><span>env</span><span>.</span><span>OPENAI_API_KEY</span><span>)</span><span>;</span>

<span>/**</span>
<span> * Streams results for our lovable assistant</span>
<span> * <span>@param</span> {<span>string</span>} query The question for our assistant</span>
<span> * <span>@stream</span> {object}   chunk</span>
<span> * <span>@stream</span> {string}   chunk.id</span>
<span> * <span>@stream</span> {string}   chunk.object</span>
<span> * <span>@stream</span> {integer}  chunk.created</span>
<span> * <span>@stream</span> {string}   chunk.model</span>
<span> * <span>@stream</span> {object[]} chunk.choices</span>
<span> * <span>@stream</span> {integer}  chunk.choices[].index</span>
<span> * <span>@stream</span> {object}   chunk.choices[].delta</span>
<span> * <span>@stream</span> {?string}  chunk.choices[].delta.role</span>
<span> * <span>@stream</span> {?string}  chunk.choices[].delta.content</span>
<span> * <span>@returns</span> {<span>object</span>} message</span>
<span> * <span>@returns</span> {<span>string</span>} message.content</span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>query</span><span>,</span> <span>context</span><span>)</span> <span>{</span>
  <span>const</span> <span>completion</span> <span>=</span> <span>await</span> <span>openai</span><span>.</span><span>chat</span><span>.</span><span>completions</span><span>.</span><span>create</span><span>(</span><span>{</span>
    <span>messages</span>: <span>[</span>
      <span>{</span><span>role</span>: <span>`system`</span><span>,</span> <span>content</span>: <span>`You are a lovable, cute assistant that uses too many emojis.`</span><span>}</span><span>,</span>
      <span>{</span><span>role</span>: <span>`user`</span><span>,</span> <span>content</span>: <span>query</span><span>}</span>
    <span>]</span><span>,</span>
    <span>model</span>: <span>`gpt-3.5-turbo`</span><span>,</span>
    <span>stream</span>: <span>true</span>
  <span>}</span><span>)</span><span>;</span>
  <span>const</span> <span>messages</span> <span>=</span> <span>[</span><span>]</span><span>;</span>
  <span>for</span> <span>await</span> <span>(</span><span>const</span> <span>chunk</span> <span>of</span> <span>completion</span><span>)</span> <span>{</span>
    <span>// Stream our response as text/event-stream when ?_stream parameter added</span>
    <span>context</span><span>.</span><span>stream</span><span>(</span><span>&#39;chunk&#39;</span><span>,</span> <span>chunk</span><span>)</span><span>;</span> <span>// chunk has the schema provided above</span>
    <span>messages</span><span>.</span><span>push</span><span>(</span><span>chunk</span><span>?.</span><span>choices</span><span>?.</span><span>[</span><span>0</span><span>]</span><span>?.</span><span>delta</span><span>?.</span><span>content</span> <span>||</span> <span>&#39;&#39;</span><span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>{</span><span>content</span>: <span>messages</span><span>.</span><span>join</span><span>(</span><span>&#39;&#39;</span><span>)</span><span>}</span><span>;</span>
<span>}</span><span>;</span></pre></div>
<h3 tabindex="-1" id="user-content-stream-type-safety" dir="auto"><a href="#stream-type-safety"><code>@stream</code> type safety<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">All <code>@stream</code> definitions follow the same <a href="#type-safety">Type Safety</a> rules
as <code>@param</code> and <code>@returns</code> directives.</p>
<h3 tabindex="-1" id="user-content-using-contextstream" dir="auto"><a href="#using-contextstream">Using <code>context.stream()</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">To send a streaming response to the client, use <code>context.stream(name, payload)</code>
where <code>name</code> is the name of the stream and <code>payload</code> adheres to the correct
type definition for the stream.</p>
<p dir="auto"><strong>Note:</strong> You must import <code>context</code> properly by adding it as the final parameter
in your function arguments.</p>
<h3 tabindex="-1" id="user-content-using-the-_stream-parameter" dir="auto"><a href="#using-the-_stream-parameter">Using the <code>_stream</code> parameter<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">By default, <strong>API endpoints will not stream responses</strong>. You must activate a
Server-Sent event by sending the <code>_stream</code> parameter. Provided the endpoint defined
above, here is what you would receive given different URL accession patterns:</p>
<div data-snippet-clipboard-copy-content="localhost:8000/assistant?query=how%20are%20you%20today?"><pre><code>localhost:8000/assistant?query=how%20are%20you%20today?
</code></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;content&#34;: &#34;Hey there! 💁‍♀️ I&#39;m doing great, thank you! 💖✨ How about you? 😊🌈&#34;
}"><pre>{
  <span>&#34;content&#34;</span>: <span><span>&#34;</span>Hey there! 💁‍♀️ I&#39;m doing great, thank you! 💖✨ How about you? 😊🌈<span>&#34;</span></span>
}</pre></div>
<p dir="auto">Appending <code>_stream</code> to your query parameters gives you a live stream between a
<code>@begin</code> and <code>@response</code> event, the latter returning an <code>object.http</code> payload
containing the typical expected response for the event:</p>
<div data-snippet-clipboard-copy-content="localhost:8000/assistant?query=how%20are%20you%20today?&amp;_stream"><pre><code>localhost:8000/assistant?query=how%20are%20you%20today?&amp;_stream
</code></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="id: 2023-10-25T04:29:59.115000000Z/2e7c7860-4a66-4824-98fa-a7cf71946f19
event: @begin
data: &#34;2023-10-25T04:29:59.115Z&#34;

[... more events ...]

event: chunk
data: {&#34;id&#34;:&#34;chatcmpl-8DPoluIgN4TDIuE1usFOKTLPiIUbQ&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1698208199,&#34;model&#34;:&#34;gpt-3.5-turbo-0613&#34;,&#34;choices&#34;:[{&#34;index&#34;:0,&#34;delta&#34;:{&#34;content&#34;:&#34; 💯&#34;},&#34;finish_reason&#34;:null}]}

[... more events ...]

event: @response
data: {&#34;statusCode&#34;:200,&#34;headers&#34;:{&#34;X-Execution-Uuid&#34;:&#34;2e7c7860-4a66-4824-98fa-a7cf71946f19&#34;,&#34;X-Instant-Api&#34;:&#34;true&#34;,&#34;Access-Control-Allow-Origin&#34;:&#34;*&#34;,&#34;Access-Control-Allow-Methods&#34;:&#34;GET, POST, OPTIONS, HEAD, PUT, DELETE&#34;,&#34;Access-Control-Allow-Headers&#34;:&#34;&#34;,&#34;Access-Control-Expose-Headers&#34;:&#34;x-execution-uuid, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid&#34;,&#34;Content-Type&#34;:&#34;application/json&#34;},&#34;body&#34;:&#34;{\&#34;content\&#34;:\&#34;Hey there! 🌞 I&#39;m feeling 💯 today! Full of energy and ready to help you out. How about you? How are you doing? 🌈😊\&#34;}&#34;}"><pre>id: 2023-10-25T04:29:59.115000000Z/2e7c7860-4a66-4824-98fa-a7cf71946f19
event: @begin
data: <span><span>&#34;</span>2023-10-25T04:29:59.115Z<span>&#34;</span></span>

[... more events ...]

event: chunk
data: {<span><span>&#34;</span>id<span>&#34;</span></span>:<span><span>&#34;</span>chatcmpl-8DPoluIgN4TDIuE1usFOKTLPiIUbQ<span>&#34;</span></span>,<span><span>&#34;</span>object<span>&#34;</span></span>:<span><span>&#34;</span>chat.completion.chunk<span>&#34;</span></span>,<span><span>&#34;</span>created<span>&#34;</span></span>:1698208199,<span><span>&#34;</span>model<span>&#34;</span></span>:<span><span>&#34;</span>gpt-3.5-turbo-0613<span>&#34;</span></span>,<span><span>&#34;</span>choices<span>&#34;</span></span>:[{<span><span>&#34;</span>index<span>&#34;</span></span>:0,<span><span>&#34;</span>delta<span>&#34;</span></span>:{<span><span>&#34;</span>content<span>&#34;</span></span>:<span><span>&#34;</span> 💯<span>&#34;</span></span>},<span><span>&#34;</span>finish_reason<span>&#34;</span></span>:null}]}

[... more events ...]

event: @response
data: {<span><span>&#34;</span>statusCode<span>&#34;</span></span>:200,<span><span>&#34;</span>headers<span>&#34;</span></span>:{<span><span>&#34;</span>X-Execution-Uuid<span>&#34;</span></span>:<span><span>&#34;</span>2e7c7860-4a66-4824-98fa-a7cf71946f19<span>&#34;</span></span>,<span><span>&#34;</span>X-Instant-Api<span>&#34;</span></span>:<span><span>&#34;</span>true<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Origin<span>&#34;</span></span>:<span><span>&#34;</span>*<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Methods<span>&#34;</span></span>:<span><span>&#34;</span>GET, POST, OPTIONS, HEAD, PUT, DELETE<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Headers<span>&#34;</span></span>:<span><span>&#34;</span><span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Expose-Headers<span>&#34;</span></span>:<span><span>&#34;</span>x-execution-uuid, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid<span>&#34;</span></span>,<span><span>&#34;</span>Content-Type<span>&#34;</span></span>:<span><span>&#34;</span>application/json<span>&#34;</span></span>},<span><span>&#34;</span>body<span>&#34;</span></span>:<span><span>&#34;</span>{<span>\&#34;</span>content<span>\&#34;</span>:<span>\&#34;</span>Hey there! 🌞 I&#39;m feeling 💯 today! Full of energy and ready to help you out. How about you? How are you doing? 🌈😊<span>\&#34;</span>}<span>&#34;</span></span>}</pre></div>
<h4 tabindex="-1" id="user-content-selectively-listening-to-specific-streams" dir="auto"><a href="#selectively-listening-to-specific-streams">Selectively listening to specific streams<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">If you do not want to listen to all streams, you can send in the <code>_stream</code> parameter as an object
with keys-value pairs corresponding to the streams you want to listen for. Anything with a truthy value
will be listened to, and <code>*</code> means &#34;all streams&#34;.</p>
<p dir="auto">e.g. <code>localhost:8000/assistant/?_stream={&#34;chunk&#34;:true}</code> would only listen for a <code>chunk</code> stream.</p>
<h2 tabindex="-1" id="user-content-background-execution-for-webhooks-and-chatbots" dir="auto"><a href="#background-execution-for-webhooks-and-chatbots">Background execution for webhooks and chatbots<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">When you are developing against external webhooks, especially chatbots,
sometimes it is important to immediately return a <code>200 OK</code> response to a third
party server to acknowledge receipt of the message. Instant API comes
packaged with a &#34;magic&#34; <code>_background</code> parameter which can enable background
execution on specified endpoints: the endpoint will return <code>200 OK</code> instantly
and continue processing as normal behind the scenes.</p>
<h3 tabindex="-1" id="user-content-background-directive" dir="auto"><a href="#background-directive"><code>@background</code> directive<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">To enable background processing for an endpoint, simply add a <code>@background</code> directive
to the endpoint&#39;s JSDoc comment block:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/**
 * @background
 */
export async function GET (context) {

  const params = context.params; // Get all JSON params sent to endpoint

  // pseudocode
  await doSomethingThatTakesAwhile();
  await sendDiscordMessage();
  return {&#34;complete&#34;: true};

}"><pre><span>/**</span>
<span> * <span>@background</span></span>
<span> */</span>
<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>context</span><span>)</span> <span>{</span>

  <span>const</span> <span>params</span> <span>=</span> <span>context</span><span>.</span><span>params</span><span>;</span> <span>// Get all JSON params sent to endpoint</span>

  <span>// pseudocode</span>
  <span>await</span> <span>doSomethingThatTakesAwhile</span><span>(</span><span>)</span><span>;</span>
  <span>await</span> <span>sendDiscordMessage</span><span>(</span><span>)</span><span>;</span>
  <span>return</span> <span>{</span><span>&#34;complete&#34;</span>: <span>true</span><span>}</span><span>;</span>

<span>}</span></pre></div>
<h3 tabindex="-1" id="user-content-using-the-_background-parameter" dir="auto"><a href="#using-the-_background-parameter">Using the <code>_background</code> parameter<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Background-enabled functions won&#39;t execute as background functions by default, you have to
supply them with the <code>_background</code> query or body parameter.</p>
<p dir="auto">If you execute the above endpoint normally, like <code>localhost:8000/my-webhook</code>, you would get;</p>

<p dir="auto">However, if you execute using <code>localhost:8000/my-webhook?_background</code> you see:</p>
<div data-snippet-clipboard-copy-content="initiated &#34;my-webhook#GET&#34; ..."><pre><code>initiated &#34;my-webhook#GET&#34; ...
</code></pre></div>
<p dir="auto">That means it&#39;s working as expected.</p>
<h3 tabindex="-1" id="user-content-background-modes" dir="auto"><a href="#background-modes">Background modes<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Multiple modes are supported for the <code>@background</code> directive: <code>info</code>, <code>empty</code> and <code>params</code>.</p>
<ul dir="auto">
<li><code>@background info</code> is the default and equivalent to <code>@background</code>, it will always
return <code>initiated function_name ...</code></li>
<li><code>@background empty</code> returns a completely empty body</li>
<li><code>@background params</code> returns all parameters provided to the function
<ul dir="auto">
<li>You can choose to return a subset of params by including them in a space-separated list</li>
<li>e.g. <code>@background params name created_at</code> would only reflect back <code>{&#34;name&#34;: &#34;...&#34;, &#34;created_at&#34;: &#34;...&#34;}</code>
if provided</li>
</ul>
</li>
</ul>
<h2 tabindex="-1" id="user-content-debugging" dir="auto"><a href="#debugging">Debugging<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Sometimes, and especially when dealing with LLMs, you find you have long-running
endpoints that can be a pain to debug. Instant API exposes two methods, <code>context.log()</code>
and <code>context.error()</code> that can be streamed to browser output as a Server-Sent Event
<strong>even if streaming is not enabled on your endpoint</strong>. Debugging is only available
when <code>NODE_ENV=development</code>.</p>
<p dir="auto">Simply append <code>_debug</code> to your query parameters (or add it to your request body)
to see <code>context.log()</code> and <code>context.error()</code> output in real-time.</p>
<h3 tabindex="-1" id="user-content-using-contextlog-and-contexterror" dir="auto"><a href="#using-contextlog-and-contexterror">Using <code>context.log()</code> and <code>context.error()</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">These methods are effectively wrappers for <code>context.stream(&#39;@stdout&#39;, payload)</code> and
<code>context.stream(&#39;@stderr&#39;, payload)</code> - only they don&#39;t require streams to be enabled
to use. They&#39;ll output as streams with the event types <code>@stdout</code> and <code>@stderr</code>, respectively,
when the <code>_debug</code> parameter is passed in.</p>
<h3 tabindex="-1" id="user-content-using-the-_debug-parameter" dir="auto"><a href="#using-the-_debug-parameter">Using the <code>_debug</code> parameter<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Given the following endpoint:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const sleep = t =&gt; new Promise(res =&gt; setTimeout(() =&gt; res(), t));

export async function GET (context) {
  context.log(`Started!`);
  await sleep(100);
  context.error(`Oh no.`);
  await sleep(500);
  context.log(`OK!`);
  return {complete: true};
}"><pre><span>const</span> <span>sleep</span> <span>=</span> <span>t</span> <span>=&gt;</span> <span>new</span> <span>Promise</span><span>(</span><span>res</span> <span>=&gt;</span> <span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>res</span><span>(</span><span>)</span><span>,</span> <span>t</span><span>)</span><span>)</span><span>;</span>

<span>export</span> <span>async</span> <span>function</span> <span>GET</span> <span>(</span><span>context</span><span>)</span> <span>{</span>
  <span>context</span><span>.</span><span>log</span><span>(</span><span>`Started!`</span><span>)</span><span>;</span>
  <span>await</span> <span>sleep</span><span>(</span><span>100</span><span>)</span><span>;</span>
  <span>context</span><span>.</span><span>error</span><span>(</span><span>`Oh no.`</span><span>)</span><span>;</span>
  <span>await</span> <span>sleep</span><span>(</span><span>500</span><span>)</span><span>;</span>
  <span>context</span><span>.</span><span>log</span><span>(</span><span>`OK!`</span><span>)</span><span>;</span>
  <span>return</span> <span>{</span><span>complete</span>: <span>true</span><span>}</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">Calling it normally would result in:</p>
<div data-snippet-clipboard-copy-content="localhost:8000/test-debug"><pre><code>localhost:8000/test-debug
</code></pre></div>

<p dir="auto">But appending <code>_debug</code> in a <code>development</code> environment...</p>
<div data-snippet-clipboard-copy-content="localhost:8000/test-debug?_debug"><pre><code>localhost:8000/test-debug?_debug
</code></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="id: 2023-10-26T00:16:42.732000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @begin
data: &#34;2023-10-26T00:16:42.732Z&#34;

id: 2023-10-26T00:16:42.732000001Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stdout
data: &#34;Started!&#34;

id: 2023-10-26T00:16:42.834000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stderr
data: &#34;Oh no.&#34;

id: 2023-10-26T00:16:43.337000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stdout
data: &#34;OK!&#34;

event: @response
data: {&#34;statusCode&#34;:200,&#34;headers&#34;:{&#34;X-Execution-Uuid&#34;:&#34;cae5a3c8-14df-4222-b762-fa3f16645fe7&#34;,&#34;X-Debug&#34;:true,&#34;X-Instant-Api&#34;:&#34;true&#34;,&#34;Access-Control-Allow-Origin&#34;:&#34;*&#34;,&#34;Access-Control-Allow-Methods&#34;:&#34;GET, POST, OPTIONS, HEAD, PUT, DELETE&#34;,&#34;Access-Control-Allow-Headers&#34;:&#34;&#34;,&#34;Access-Control-Expose-Headers&#34;:&#34;x-execution-uuid, x-debug, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid&#34;,&#34;Content-Type&#34;:&#34;application/json&#34;},&#34;body&#34;:&#34;{\&#34;complete\&#34;:true}&#34;}"><pre>id: 2023-10-26T00:16:42.732000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @begin
data: <span><span>&#34;</span>2023-10-26T00:16:42.732Z<span>&#34;</span></span>

id: 2023-10-26T00:16:42.732000001Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stdout
data: <span><span>&#34;</span>Started!<span>&#34;</span></span>

id: 2023-10-26T00:16:42.834000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stderr
data: <span><span>&#34;</span>Oh no.<span>&#34;</span></span>

id: 2023-10-26T00:16:43.337000000Z/cae5a3c8-14df-4222-b762-fa3f16645fe7
event: @stdout
data: <span><span>&#34;</span>OK!<span>&#34;</span></span>

event: @response
data: {<span><span>&#34;</span>statusCode<span>&#34;</span></span>:200,<span><span>&#34;</span>headers<span>&#34;</span></span>:{<span><span>&#34;</span>X-Execution-Uuid<span>&#34;</span></span>:<span><span>&#34;</span>cae5a3c8-14df-4222-b762-fa3f16645fe7<span>&#34;</span></span>,<span><span>&#34;</span>X-Debug<span>&#34;</span></span>:true,<span><span>&#34;</span>X-Instant-Api<span>&#34;</span></span>:<span><span>&#34;</span>true<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Origin<span>&#34;</span></span>:<span><span>&#34;</span>*<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Methods<span>&#34;</span></span>:<span><span>&#34;</span>GET, POST, OPTIONS, HEAD, PUT, DELETE<span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Allow-Headers<span>&#34;</span></span>:<span><span>&#34;</span><span>&#34;</span></span>,<span><span>&#34;</span>Access-Control-Expose-Headers<span>&#34;</span></span>:<span><span>&#34;</span>x-execution-uuid, x-debug, x-instant-api, access-control-allow-origin, access-control-allow-methods, access-control-allow-headers, x-execution-uuid<span>&#34;</span></span>,<span><span>&#34;</span>Content-Type<span>&#34;</span></span>:<span><span>&#34;</span>application/json<span>&#34;</span></span>},<span><span>&#34;</span>body<span>&#34;</span></span>:<span><span>&#34;</span>{<span>\&#34;</span>complete<span>\&#34;</span>:true}<span>&#34;</span></span>}</pre></div>
<h2 tabindex="-1" id="user-content-built-in-errors" dir="auto"><a href="#built-in-errors">Built-in Errors<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">As you develop with Instant API, you may encounter various error types as you test
the limits and boundariess of the framework. They are typically in the format:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
  &#34;error&#34;: {
    &#34;type&#34;: &#34;NamedError&#34;,
    &#34;message&#34;: &#34;error message&#34;,
    &#34;stack&#34;: &#34;&#34;,
    &#34;details&#34;: {}
  }
}"><pre>{
  <span>&#34;error&#34;</span>: {
    <span>&#34;type&#34;</span>: <span><span>&#34;</span>NamedError<span>&#34;</span></span>,
    <span>&#34;message&#34;</span>: <span><span>&#34;</span>error message<span>&#34;</span></span>,
    <span>&#34;stack&#34;</span>: <span><span>&#34;</span><span>&#34;</span></span>,
    <span>&#34;details&#34;</span>: {}
  }
}</pre></div>
<p dir="auto">Note that <code>error.stack</code> will <strong>not</strong> appear when <code>NODE_ENV=production</code>.
The <code>details</code> object may or may not be present. A list of errors you may encounter
are below:</p>
<table>
<thead>
<tr>
<th>Error Type</th>
<th>Description</th>
<th>Details Object</th>
</tr>
</thead>
<tbody>
<tr>
<td>WellKnownError</td>
<td>Error loading a schema from <code>/.well-known/</code> pathname</td>
<td>N/A</td>
</tr>
<tr>
<td>ClientError</td>
<td>Generic 4xx, usually 400 (Bad Request)</td>
<td>N/A</td>
</tr>
<tr>
<td>ServerError</td>
<td>Generic 5xx, usually 500 (Internal Server Error)</td>
<td>N/A</td>
</tr>
<tr>
<td>BadRequestError</td>
<td>Returned when <code>throw new Error(&#39;400: [...]&#39;)</code> is called</td>
<td>N/A</td>
</tr>
<tr>
<td>UnauthorizedError</td>
<td>Returned when <code>throw new Error(&#39;401: [...]&#39;)</code> is called</td>
<td>N/A</td>
</tr>
<tr>
<td>PaymentRequiredError</td>
<td>Returned when <code>throw new Error(&#39;402: [...]&#39;)</code> is called</td>
<td>N/A</td>
</tr>
<tr>
<td>ForbiddenError</td>
<td>Returned when <code>throw new Error(&#39;403: [...]&#39;)</code> is called</td>
<td>N/A</td>
</tr>
<tr>
<td>NotFoundError</td>
<td>Returned when <code>throw new Error(&#39;404: [...]&#39;)</code> is called</td>
<td>N/A</td>
</tr>
<tr>
<td>ParameterParseError</td>
<td>Could not parse parameters based on content-type</td>
<td>N/A</td>
</tr>
<tr>
<td>ParameterError</td>
<td><code>@param</code> validation failed</td>
<td><code>{[field]: {message: &#39;string&#39;, invalid: true, mismatch: &#39;obj.a.b&#39;, expected: {type}, actual: {value, type}}}</code></td>
</tr>
<tr>
<td>ValueError</td>
<td><code>@returns</code> validation failed</td>
<td>Same as <code>ParameterError</code>, only with <code>&#34;returns&#34;</code> as the field</td>
</tr>
<tr>
<td>StreamParameterError</td>
<td><code>@stream</code> validation failed</td>
<td>Same as <code>ParameterError</code>, only with the stream name as the field</td>
</tr>
<tr>
<td>StreamError</td>
<td>Stream specified with <code>context.stream()</code> does not exist</td>
<td>N/A</td>
</tr>
<tr>
<td>StreamListenerError</td>
<td>Specific stream <code>name</code> via <code>_stream: {name: true}</code> does not exist</td>
<td>N/A</td>
</tr>
<tr>
<td>OriginError</td>
<td>Invalid <code>@origin</code> specified</td>
<td>N/A</td>
</tr>
<tr>
<td>DebugError</td>
<td>Could not debug endpoint with <code>_debug</code>, usually permission issue</td>
<td>N/A</td>
</tr>
<tr>
<td>ExecutionModeError</td>
<td>Could not execute with <code>_stream</code> or <code>_background</code> because they are not enabled</td>
<td>N/A</td>
</tr>
<tr>
<td>TimeoutError</td>
<td>Endpoint took too long to execute. Configurable on gateway initialization.</td>
<td>N/A</td>
</tr>
<tr>
<td>FatalError</td>
<td>The gateway had a fatal crash event, status code <code>500</code></td>
<td>N/A</td>
</tr>
<tr>
<td>RuntimeError</td>
<td>An error was thrown during endpoint execution, status code <code>420</code></td>
<td>N/A</td>
</tr>
<tr>
<td>InvalidResponseHeaderError</td>
<td>A header specified in an <code>object.http</code> return statement was invalid</td>
<td>Object containing invalid headers</td>
</tr>
<tr>
<td>AccessSourceError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>AccessPermissionError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>AccessAuthError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>AccessSuspendedError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>OwnerSuspendedError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>OwnerPaymentRequiredError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>RateLimitError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>AuthRateLimitError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>UnauthRateLimitError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>SaveError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>MaintenanceError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>UpdateError</td>
<td>Placeholder: Currently unused, intended for platform gateways.</td>
<td>N/A</td>
</tr>
<tr>
<td>AutoformatError</td>
<td>Placeholder: Currently unused, intended error if formatting on static resources goes awry.</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 tabindex="-1" id="user-content-testing" dir="auto"><a href="#testing">Testing<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Instant API comes packaged with a <code>TestEngine</code> class for automated testing. It designed
to work best with <a href="https://mochajs.org/" rel="nofollow">mocha</a> and <a href="https://www.chaijs.com/" rel="nofollow">chai</a> but
can be used with any runtime.</p>
<h3 tabindex="-1" id="user-content-quickstart-for-tests" dir="auto"><a href="#quickstart-for-tests">Quickstart for tests<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The best way to get started with tests is via the <code>instant.dev</code>
<a href="https://github.com/instant-dev/instant">command line tools</a>. Once your project is initialized,
you can generate tests for your endpoints with:</p>
<div dir="auto" data-snippet-clipboard-copy-content="instant g:test --function path/to/index.mjs"><pre>instant g:test --function path/to/index.mjs</pre></div>
<p dir="auto">Where <code>./functions/path/to/index.mjs</code> is an endpoint. This will automatically create
a test for each exported function (HTTP method) on the endpoint in:
<code>./test/tests/functions/path/to/index.mjs</code>.</p>
<p dir="auto">Additionally, if you are using <a href="https://github.com/instant-dev/orm">Instant ORM</a>, you can
generate tests for individual models using:</p>
<div dir="auto" data-snippet-clipboard-copy-content="instant g:test --model users"><pre>instant g:test --model users</pre></div>
<p dir="auto">Which will create a test in <code>./test/tests/models/user.js</code>.</p>
<p dir="auto">Finally, To create blank (empty) tests use:</p>
<div dir="auto" data-snippet-clipboard-copy-content="instant g:test path/to/my_test_name"><pre>instant g:test path/to/my_test_name</pre></div>
<p dir="auto">Which will create an empty test in <code>./test/tests/path/to/my_test_name.mjs</code>.</p>
<p dir="auto">Tests can be run via:</p>

<h3 tabindex="-1" id="user-content-custom-installation-for-tests" dir="auto"><a href="#custom-installation-for-tests">Custom installation for tests<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">If you want to write your own tests without using the <code>instant.dev</code>
<a href="https://github.com/instant-dev/instant">command line tools</a>, you should
first install <code>mocha</code> and <code>chai</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="npm i mocha --save-dev
npm i chai --save-dev"><pre>npm i mocha --save-dev
npm i chai --save-dev</pre></div>
<p dir="auto">Next, create the file <code>./test/run.mjs</code> with the following contents:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import InstantAPI from &#39;@instant.dev/api&#39;;

const Gateway = InstantAPI.Gateway;
const TestEngine = InstantAPI.TestEngine;
const PORT = 7357; // Leetspeak for &#34;TEST&#34;; can be anything

// Load environment variables; make sure NODE_ENV is &#34;test&#34;
process.env.NODE_ENV = `test`;

// Initialize and load tests; set PORT for request mocking
const testEngine = new TestEngine(PORT);
await testEngine.initialize(&#39;./test/tests&#39;);

// Setup; create objects and infrastructure for tests
// Arguments returned here will be sent to .finish()
testEngine.setup(async () =&gt; {

  console.log();
  console.log(`# Starting test gateway on localhost:${PORT} ... `);
  console.log();

  // Start Gateway; {debug: true} will print logs
  const gateway = new Gateway({debug: false});
  gateway.load(process.cwd());       // load routes from filesystem
  gateway.listen(PORT);              // start server

  return { gateway };

});

// Run tests; use first argument to specify a test
const args = process.argv.slice(3);
if (args[0]) {
  await testEngine.run(args[0]);
} else {
  await testEngine.runAll();
}

// Finish; close Gateway and disconnect from database
// Receive arguments from .setup()
testEngine.finish(async ({ gateway }) =&gt; {
  gateway.close();
});"><pre><span>import</span> <span>InstantAPI</span> <span>from</span> <span>&#39;@instant.dev/api&#39;</span><span>;</span>

<span>const</span> <span>Gateway</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>Gateway</span><span>;</span>
<span>const</span> <span>TestEngine</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>TestEngine</span><span>;</span>
<span>const</span> <span>PORT</span> <span>=</span> <span>7357</span><span>;</span> <span>// Leetspeak for &#34;TEST&#34;; can be anything</span>

<span>// Load environment variables; make sure NODE_ENV is &#34;test&#34;</span>
<span>process</span><span>.</span><span>env</span><span>.</span><span>NODE_ENV</span> <span>=</span> <span>`test`</span><span>;</span>

<span>// Initialize and load tests; set PORT for request mocking</span>
<span>const</span> <span>testEngine</span> <span>=</span> <span>new</span> <span>TestEngine</span><span>(</span><span>PORT</span><span>)</span><span>;</span>
<span>await</span> <span>testEngine</span><span>.</span><span>initialize</span><span>(</span><span>&#39;./test/tests&#39;</span><span>)</span><span>;</span>

<span>// Setup; create objects and infrastructure for tests</span>
<span>// Arguments returned here will be sent to .finish()</span>
<span>testEngine</span><span>.</span><span>setup</span><span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>

  <span>console</span><span>.</span><span>log</span><span>(</span><span>)</span><span>;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>`# Starting test gateway on localhost:<span><span>${</span><span>PORT</span><span>}</span></span> ... `</span><span>)</span><span>;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>)</span><span>;</span>

  <span>// Start Gateway; {debug: true} will print logs</span>
  <span>const</span> <span>gateway</span> <span>=</span> <span>new</span> <span>Gateway</span><span>(</span><span>{</span><span>debug</span>: <span>false</span><span>}</span><span>)</span><span>;</span>
  <span>gateway</span><span>.</span><span>load</span><span>(</span><span>process</span><span>.</span><span>cwd</span><span>(</span><span>)</span><span>)</span><span>;</span>       <span>// load routes from filesystem</span>
  <span>gateway</span><span>.</span><span>listen</span><span>(</span><span>PORT</span><span>)</span><span>;</span>              <span>// start server</span>

  <span>return</span> <span>{</span> gateway <span>}</span><span>;</span>

<span>}</span><span>)</span><span>;</span>

<span>// Run tests; use first argument to specify a test</span>
<span>const</span> <span>args</span> <span>=</span> <span>process</span><span>.</span><span>argv</span><span>.</span><span>slice</span><span>(</span><span>3</span><span>)</span><span>;</span>
<span>if</span> <span>(</span><span>args</span><span>[</span><span>0</span><span>]</span><span>)</span> <span>{</span>
  <span>await</span> <span>testEngine</span><span>.</span><span>run</span><span>(</span><span>args</span><span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>
<span>}</span> <span>else</span> <span>{</span>
  <span>await</span> <span>testEngine</span><span>.</span><span>runAll</span><span>(</span><span>)</span><span>;</span>
<span>}</span>

<span>// Finish; close Gateway and disconnect from database</span>
<span>// Receive arguments from .setup()</span>
<span>testEngine</span><span>.</span><span>finish</span><span>(</span><span>async</span> <span>(</span><span>{</span> gateway <span>}</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>gateway</span><span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></pre></div>
<p dir="auto">Finally, you can then add the following to <code>package.json</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="  &#34;scripts&#34;: {
    &#34;test&#34;: &#34;mocha test/run.mjs&#34;
  }"><pre>  <span>&#34;scripts&#34;</span>: {
    <span>&#34;test&#34;</span>: <span><span>&#34;</span>mocha test/run.mjs<span>&#34;</span></span>
  }</pre></div>
<p dir="auto">Tests can then be run via:</p>

<h3 tabindex="-1" id="user-content-writing-tests" dir="auto"><a href="#writing-tests">Writing tests<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">All tests should be put in the <code>./test/tests</code> directory. This directory
will be used by <code>TestEngine</code> to load all of your tests. Tests are imported
<strong>when they are run</strong>, not when they are first initialized in <code>TestEngine</code>.</p>
<p dir="auto">The structure of a test should look like this;</p>
<div dir="auto" data-snippet-clipboard-copy-content="// Imports, setup to begin with
import chai from &#39;chai&#39;;
const expect = chai.expect;

// Optional: Name your test file
export const name = `Some tests`;

/**
 * Your tests
 * @param {any} setupResult Result of the function passed to `.setup()` in `test/run.mjs`
 */
export default async function (setupResult) {

  before(async () =&gt; {
    // any necessary setup
  });

  it(&#39;Should test for truthiness of &#34;true&#34;&#39;, async () =&gt; {

    expect(true).to.equal(true);

  });

  after(async () =&gt; {
    // any necessary teardown
  });

};"><pre><span>// Imports, setup to begin with</span>
<span>import</span> <span>chai</span> <span>from</span> <span>&#39;chai&#39;</span><span>;</span>
<span>const</span> <span>expect</span> <span>=</span> <span>chai</span><span>.</span><span>expect</span><span>;</span>

<span>// Optional: Name your test file</span>
<span>export</span> <span>const</span> <span>name</span> <span>=</span> <span>`Some tests`</span><span>;</span>

<span>/**</span>
<span> * Your tests</span>
<span> * <span>@param</span> {<span>any</span>} setupResult Result of the function passed to `.setup()` in `test/run.mjs`</span>
<span> */</span>
<span>export</span> <span>default</span> <span>async</span> <span>function</span> <span>(</span><span>setupResult</span><span>)</span> <span>{</span>

  <span>before</span><span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// any necessary setup</span>
  <span>}</span><span>)</span><span>;</span>

  <span>it</span><span>(</span><span>&#39;Should test for truthiness of &#34;true&#34;&#39;</span><span>,</span> <span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>

    <span>expect</span><span>(</span><span>true</span><span>)</span><span>.</span><span>to</span><span>.</span><span>equal</span><span>(</span><span>true</span><span>)</span><span>;</span>

  <span>}</span><span>)</span><span>;</span>

  <span>after</span><span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// any necessary teardown</span>
  <span>}</span><span>)</span><span>;</span>

<span>}</span><span>;</span></pre></div>
<h3 tabindex="-1" id="user-content-running-tests" dir="auto"><a href="#running-tests">Running tests<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Tests are run top-down, depth-first, alphabetically.
Given the following directory structure:</p>
<div dir="auto" data-snippet-clipboard-copy-content="- test/
  - tests/
    - a/
      - second.mjs
      - a/third.mjs
      - b/fourth.mjs
    - b/
      - fifth.mjs
    - first.mjs
"><pre>- <span>test/</span>
  - <span>tests/</span>
    - <span>a/</span>
      - <span>second.mjs</span>
      - <span>a/third.mjs</span>
      - <span>b/fourth.mjs</span>
    - <span>b/</span>
      - <span>fifth.mjs</span>
    - <span>first.mjs</span>
</pre></div>
<ul dir="auto">
<li>All tests in the root <code>test/tests</code> directory are executed first, alphabetically</li>
<li>All directories in <code>test/tests</code> are organized alphabetically</li>
<li>All tests in <code>test/tests/a/</code> would then run</li>
<li>Then tests in <code>test/tests/a/a/</code></li>
<li>Then tests in <code>test/tests/a/b/</code></li>
<li>then tests in <code>test/tests/b/</code></li>
</ul>
<p dir="auto">Giving a test order of:</p>
<div dir="auto" data-snippet-clipboard-copy-content="- test/tests/first.mjs
- test/tests/a/second.mjs
- test/tests/a/a/third.mjs
- test/tests/a/b/fourth.mjs
- test/tests/b/fifth.mjs"><pre>- <span>test/tests/first.mjs</span>
- <span>test/tests/a/second.mjs</span>
- <span>test/tests/a/a/third.mjs</span>
- <span>test/tests/a/b/fourth.mjs</span>
- <span>test/tests/b/fifth.mjs</span></pre></div>
<p dir="auto">If you set up via <code>instant.dev</code> <a href="https://github.com/instant-dev/instant">command line tools</a>,
just run:</p>

<p dir="auto">If you are running a custom installation, use:</p>

<h2 tabindex="-1" id="user-content-deployment" dir="auto"><a href="#deployment">Deployment<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Instant API can be deployed out-of-the-box to any host that respects the
<code>[package.json].scripts.start</code> field. This includes AWS Elastic Beanstalk and Heroku.
Vercel requires a little bit of finagling. However, the <code>instant.dev</code>
<a href="https://github.com/instant-dev/instant">command line tools</a> will automatically
manage deployments to both AWS Elastic Beanstalk and Vercel for you.</p>
<h3 tabindex="-1" id="user-content-via-instant-deploy" dir="auto"><a href="#via-instant-deploy">via <code>instant deploy</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Simple;</p>
<div dir="auto" data-snippet-clipboard-copy-content="instant deploy:config # follow instructions; choose Vercel or AWS
instant deploy --env staging # for Elastic Beanstalk
instant deploy --env preview # for Vercel
instant deploy --env production # Works for either"><pre>instant deploy:config <span><span>#</span> follow instructions; choose Vercel or AWS</span>
instant deploy --env staging <span><span>#</span> for Elastic Beanstalk</span>
instant deploy --env preview <span><span>#</span> for Vercel</span>
instant deploy --env production <span><span>#</span> Works for either</span></pre></div>
<h3 tabindex="-1" id="user-content-custom-deployments" dir="auto"><a href="#custom-deployments">Custom deployments<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">We defer to platform-specific Node.js deployment instructions. If you would
like to contribute some helpful tips, please submit a PR on this README!</p>
<h2 tabindex="-1" id="user-content-more-information" dir="auto"><a href="#more-information">More Information<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<h3 tabindex="-1" id="user-content-gateway-configuration" dir="auto"><a href="#gateway-configuration">Gateway Configuration<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You can configure some custom options in your <code>instant.mjs</code> startup script.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import InstantAPI from &#39;@instant.dev/api&#39;;

// ... other code ...

const Gateway = InstantAPI.Daemon.Gateway;

const gateway = new Gateway({
  port: 8000, //Defaults to 8170
  name: &#39;My API Server&#39;, // Defaults to &#34;InstantAPI.Gateway&#34;
  maxRequestSizeMB: 16, // Requests above this size will error. Defaults to 128MB.
  defaultTimeout: 10000 // Max execution time in ms. Defaults to 600000 (10 mins).
  debug: true // Whether to show logs or not, defaults to false
});"><pre><span>import</span> <span>InstantAPI</span> <span>from</span> <span>&#39;@instant.dev/api&#39;</span><span>;</span>

<span>// ... other code ...</span>

<span>const</span> <span>Gateway</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>Daemon</span><span>.</span><span>Gateway</span><span>;</span>

<span>const</span> <span>gateway</span> <span>=</span> <span>new</span> <span>Gateway</span><span>(</span><span>{</span>
  <span>port</span>: <span>8000</span><span>,</span> <span>//Defaults to 8170</span>
  <span>name</span>: <span>&#39;My API Server&#39;</span><span>,</span> <span>// Defaults to &#34;InstantAPI.Gateway&#34;</span>
  <span>maxRequestSizeMB</span>: <span>16</span><span>,</span> <span>// Requests above this size will error. Defaults to 128MB.</span>
  <span>defaultTimeout</span>: <span>10000</span> <span>// Max execution time in ms. Defaults to 600000 (10 mins).</span>
  <span>debug</span>: <span>true</span> <span>// Whether to show logs or not, defaults to false</span>
<span>}</span><span>)</span><span>;</span></pre></div>
<h3 tabindex="-1" id="user-content-logging" dir="auto"><a href="#logging">Logging<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Currently logging is controlled entirely via the <code>debug</code> parameter in
<code>new Gateway()</code> instatiation. When set to <code>true</code> this can very quickly overwhelm
log storage on high-volume API servers. We&#39;re interested in getting feedback
on your favorite log draining solutions and if there are elegant ways to integrate.
Submit an issue to talk to us about it!</p>
<h3 tabindex="-1" id="user-content-error-monitoring" dir="auto"><a href="#error-monitoring">Error monitoring<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The <code>Gateway</code> instant comes with a built-in <code>setErrorHandler()</code> method to
capture internal errors. You can add it to <code>instant.mjs</code> or your startup script easily.
Here&#39;s an example using <a href="https://sentry.io" rel="nofollow">Sentry</a>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import InstantAPI from &#39;@instant.dev/api&#39;;
import * as Sentry from &#39;@sentry/node&#39;;

Sentry.init({
  dsn: &#39;__DSN__&#39;,
  // ...
});

// ... other code ...

const Gateway = InstantAPI.Daemon.Gateway;

const gateway = new Gateway({port: process.env.PORT});
gateway.setErrorHandler(e =&gt; Sentry.captureException(e));
gateway.load(process.cwd());
gateway.listen();"><pre><span>import</span> <span>InstantAPI</span> <span>from</span> <span>&#39;@instant.dev/api&#39;</span><span>;</span>
<span>import</span> <span>*</span> <span>as</span> <span>Sentry</span> <span>from</span> <span>&#39;@sentry/node&#39;</span><span>;</span>

<span>Sentry</span><span>.</span><span>init</span><span>(</span><span>{</span>
  <span>dsn</span>: <span>&#39;__DSN__&#39;</span><span>,</span>
  <span>// ...</span>
<span>}</span><span>)</span><span>;</span>

<span>// ... other code ...</span>

<span>const</span> <span>Gateway</span> <span>=</span> <span>InstantAPI</span><span>.</span><span>Daemon</span><span>.</span><span>Gateway</span><span>;</span>

<span>const</span> <span>gateway</span> <span>=</span> <span>new</span> <span>Gateway</span><span>(</span><span>{</span><span>port</span>: <span>process</span><span>.</span><span>env</span><span>.</span><span>PORT</span><span>}</span><span>)</span><span>;</span>
<span>gateway</span><span>.</span><span>setErrorHandler</span><span>(</span><span>e</span> <span>=&gt;</span> <span>Sentry</span><span>.</span><span>captureException</span><span>(</span><span>e</span><span>)</span><span>)</span><span>;</span>
<span>gateway</span><span>.</span><span>load</span><span>(</span><span>process</span><span>.</span><span>cwd</span><span>(</span><span>)</span><span>)</span><span>;</span>
<span>gateway</span><span>.</span><span>listen</span><span>(</span><span>)</span><span>;</span></pre></div>
<p dir="auto">This will catch all internal errors with the exception of;</p>
<ul dir="auto">
<li>Validation errors:
<ul dir="auto">
<li>ExecutionModeError, ParameterParseError, ParameterError, StreamError, StreamParameterError</li>
</ul>
</li>
<li>Intentionally thrown client errors:
<ul dir="auto">
<li>BadRequestError, UnauthorizedError, PaymentRequiredError, ForbiddenError, NotFoundError</li>
</ul>
</li>
</ul>
<h3 tabindex="-1" id="user-content-middleware" dir="auto"><a href="#middleware">Middleware<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">For the most part, Instant API has pretty comprehensive body parsing and parameter
validation libraries built right in. However, you still might want to write or use
custome middleware for repeated tasks; like authenticating users based on <code>headers</code>.</p>
<p dir="auto">We recommend a simple approach of a <code>middleware/</code> directory with files that each output
a function that takes <code>context</code> as a single argument:</p>
<p dir="auto">e.g. in <code>./middleware/authenticate.mjs</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="export default async (context) {
  let headers = context.https.headers;
  let result = await authenticateUser(headers);
  if (result) {
    return true;
  } else {
    throw new Error(`401: Unauthorized, failed header validation`);
  }
}"><pre><span>export</span> <span>default</span> <span>async</span> <span>(</span><span>context</span><span>)</span><span></span> <span>{</span>
  <span>let</span> <span>headers</span> <span>=</span> <span>context</span><span>.</span><span>https</span><span>.</span><span>headers</span><span>;</span>
  <span>let</span> <span>result</span> <span>=</span> <span>await</span> <span>authenticateUser</span><span>(</span><span>headers</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>result</span><span>)</span> <span>{</span>
    <span>return</span> <span>true</span><span>;</span>
  <span>}</span> <span>else</span> <span>{</span>
    <span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>`401: Unauthorized, failed header validation`</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span></pre></div>
<p dir="auto">Then in your endpoints, you can do the following;</p>
<div dir="auto" data-snippet-clipboard-copy-content="import authenticate from &#39;../middleware/authenticate.mjs`;

export async function GET (context) =&gt; {
  await authenticate(context);
  return &#39;authenticated!&#39;;
}"><pre><span>import</span> <span>authenticate</span> <span>from</span> <span>&#39;../middleware/authenticate.mjs`;</span>
<span></span>
<span>export async function GET (context) =&gt; {</span>
<span>  await authenticate(context);</span>
<span>  return &#39;</span><span>authenticated</span><span>!</span>&#39;<span>;</span>
<span>}</span></pre></div>
<h2 tabindex="-1" id="user-content-roadmap-and-feedback" dir="auto"><a href="#roadmap-and-feedback">Roadmap and Feedback<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">We&#39;re just getting the first release of Instant API into the wild now, we&#39;re excited to hear feedback!
It&#39;s a pretty comprehensive framework we&#39;ve been developing for years and we&#39;re happy with the feature
set, but please let us know if there are things we are missing by opening an issue.</p>

<p dir="auto">Special thank you to <a href="https://x.com/threesided" rel="nofollow">Scott Gamble</a> who helps run all of the front-of-house work for instant.dev 💜!</p>
<table>
<thead>
<tr>
<th>Destination</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Home</td>
<td><a href="https://instant.dev" rel="nofollow">instant.dev</a></td>
</tr>
<tr>
<td>GitHub</td>
<td><a href="https://github.com/instant-dev">github.com/instant-dev</a></td>
</tr>
<tr>
<td>Discord</td>
<td><a href="https://discord.gg/puVYgA7ZMh" rel="nofollow">discord.gg/puVYgA7ZMh</a></td>
</tr>
<tr>
<td>X / instant.dev</td>
<td><a href="https://x.com/instantdevs" rel="nofollow">x.com/instantdevs</a></td>
</tr>
<tr>
<td>X / Keith Horwood</td>
<td><a href="https://x.com/keithwhor" rel="nofollow">x.com/keithwhor</a></td>
</tr>
<tr>
<td>X / Scott Gamble</td>
<td><a href="https://x.com/threesided" rel="nofollow">x.com/threesided</a></td>
</tr>
</tbody>
</table>
</article>
          </div></div>
  </body>
</html>
