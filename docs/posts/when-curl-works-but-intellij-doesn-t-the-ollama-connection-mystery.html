<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.tymscar.com/posts/intellijollamaconnectionmystery/">Original</a>
    <h1>When Curl Works but IntelliJ Doesn&#39;t: The Ollama Connection Mystery</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>I run a bunch of internal services through Traefik on my LAN, each with a proper domain name and TLS, so I don’t have to remember ports. One of them is Ollama, sitting on a beefy gaming PC at <code>10.0.0.105</code> and exposed as <code>https://ollama.tymscar.com</code>. From the terminal everything behaved exactly as expected: fast responses, certificate valid, models listed. Then IntelliJ IDEA decided this host basically didn’t exist. The “Test Connection” button just said “Failed to connect”. No detail. No hint. Just a smug little red failure.</p><p><img src="https://blog.tymscar.com/intellijOllamaConnectivity/failed-to-connect.png" alt="Failed connection dialog"/></p><p>Meanwhile:</p><div><pre tabindex="0"><code data-lang="bash"><span><span>curl -s https://ollama.tymscar.com/api/tags | jq <span>&#39;.models[].name&#39;</span> | head -n <span>4</span>
</span></span><span><span><span>&#34;gpt-oss:20b&#34;</span>
</span></span><span><span><span>&#34;llama3:8b-instruct-fp16&#34;</span>
</span></span><span><span><span>&#34;qwen3:32b&#34;</span>
</span></span><span><span><span>&#34;Supa-AI/mixtral-8x7b-instruct-v0.1:q4_k_m&#34;</span>
</span></span></code></pre></div><p>And the plain internal HTTP endpoint (skipping Traefik entirely) also worked:</p><div><pre tabindex="0"><code data-lang="bash"><span><span>curl -s http://10.0.0.105:11434/api/tags | jq <span>&#39;.models[].name&#39;</span> | head -n <span>4</span>
</span></span><span><span><span>&#34;gpt-oss:20b&#34;</span>
</span></span><span><span><span>&#34;llama3:8b-instruct-fp16&#34;</span>
</span></span><span><span><span>&#34;qwen3:32b&#34;</span>
</span></span><span><span><span>&#34;Supa-AI/mixtral-8x7b-instruct-v0.1:q4_k_m&#34;</span>
</span></span></code></pre></div><p>So networking, DNS, TLS termination, Ollama itself: all fine.</p><h2 id="false-start-1-maybe-intellij-just-doesnt-support-https-here">False Start #1: “Maybe IntelliJ just doesn’t support HTTPS here”<a href="#false-start-1-maybe-intellij-just-doesnt-support-https-here" arialabel="Anchor">#</a></h2><p>Not a wild idea. I’d already hit a similar limitation months before with Raycast’s Ollama support. I even tweeted about it at the time. Raycast was hardcoded to use plain HTTP for Ollama, so when I tried an HTTPS homelab endpoint it mangled the URL into something like <code>http://https://myDomain</code> and App Transport Security then blocked the non-local HTTP fallback. So the idea that IntelliJ might also just not support the HTTPS reverse-proxied variant first didn’t feel far-fetched.</p><p><img src="https://blog.tymscar.com/intellijOllamaConnectivity/raycast-tweet.png" alt="Old Raycast HTTPS issue tweet"/></p><p>So I bypassed Traefik completely and pointed IntelliJ straight at <code>http://10.0.0.105:11434</code>. Exact same failure dialog. So not HTTPS.</p><h2 id="false-start-2-macos-local-network-permission">False Start #2: “macOS local network permission?”<a href="#false-start-2-macos-local-network-permission" arialabel="Anchor">#</a></h2><p>Checked System Settings &gt; Privacy &amp; Security &gt; Local Network. IntelliJ was already allowed. Nothing to toggle. Still failed.</p><h2 id="false-start-3-firewall">False Start #3: “Firewall?”<a href="#false-start-3-firewall" arialabel="Anchor">#</a></h2><p>macOS firewall off. No third‑party blocker. Another dead end.</p><p>At this point the pattern was clear: <strong>if curl works to both the domain and the raw IP:port, and an IDE insists it can’t connect, the problem is very likely inside the JVM layer, not the network.</strong></p><h2 id="looking-at-the-logs">Looking at the logs<a href="#looking-at-the-logs" arialabel="Anchor">#</a></h2><p>The UI was useless, so I opened:</p><pre tabindex="0"><code>~/Library/Logs/JetBrains/IntelliJIdea2025.2/idea.log
</code></pre><p>There it was:</p><pre tabindex="0"><code>Failed to connect to Ollama @ http://10.0.0.105:11434/: java.net.ConnectException: No route to host
</code></pre><p>Important detail: that error is from the direct HTTP attempt, no Traefik, no TLS. <code>No route to host</code> when the host clearly routes fine for other processes usually screams: address family / IPv6 oddity / JVM fallback behavior.</p><h2 id="what-was-really-happening">What was really happening<a href="#what-was-really-happening" arialabel="Anchor">#</a></h2><p><code>curl</code> happily talks IPv4 to <code>10.0.0.105</code>. The JVM, however, was trying (or initializing toward) an IPv6 path first and not gracefully falling back, ending in “No route to host”. The LAN here is plain IPv4; there’s nothing meaningful for that IPv6 attempt to succeed with, so the connection attempt just died before any IPv4 retry happened.</p><h2 id="the-one-line-fix">The one-line fix<a href="#the-one-line-fix" arialabel="Anchor">#</a></h2><p>In IntelliJ:</p><pre tabindex="0"><code>Help &gt; Edit Custom VM Options…
</code></pre><p>Add:</p><pre tabindex="0"><code>-Djava.net.preferIPv4Stack=true
</code></pre><p>Save and restart.</p><p>After restart: both <code>http://10.0.0.105:11434</code> and <code>https://ollama.tymscar.com</code> connected instantly in the Test Connection dialog. Same configuration, nothing changed on Traefik or the host.</p><p><img src="https://blog.tymscar.com/intellijOllamaConnectivity/successful-connection.png" alt="Successful connection after adding IPv4 flag"/></p><h2 id="why-that-works">Why that works<a href="#why-that-works" arialabel="Anchor">#</a></h2><p>That flag disables the IPv6 stack for that JVM instance and forces straight IPv4 usage. Remove the early failing path, remove the misleading error. HTTPS “magically” working afterwards wasn’t magic (it was never a TLS problem), it just never got far enough previously to prove that.</p><p>(If someone wanted a softer approach they could try <code>-Djava.net.preferIPv4Addresses=true</code>, but I didn’t need nuance here.)</p><h2 id="final-thoughts">Final thoughts<a href="#final-thoughts" arialabel="Anchor">#</a></h2><p>I almost went down the rabbit hole of tweaking Traefik rules, reissuing certificates, or inventing a phantom permissions problem. The log had the answer the whole time. If a Java GUI refuses to reach something that <code>curl</code> clearly can, check its logs immediately and consider IPv6 preference issues before dismantling half your stack.</p></div></div></div>
  </body>
</html>
