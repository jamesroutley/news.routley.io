<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.yossarian.net/2025/11/21/We-should-all-be-using-dependency-cooldowns">Original</a>
    <h1>We should all be using dependency cooldowns</h1>
    
    <div id="readability-page-1" class="page">


<h2><em>Programming, philosophy, pedaling.</em></h2>

<ul>
    <li><a href="https://blog.yossarian.net/">Home</a></li>
    <li><a href="https://blog.yossarian.net/tags">Tags</a></li>
    <li><a href="https://blog.yossarian.net/series">Series</a></li>
    <li><a href="https://blog.yossarian.net/favorites">Favorites</a></li>
    <li><a href="https://blog.yossarian.net/archive">Archive</a></li>
    
    <li><a href="https://yossarian.net">Main Site</a></li>
    <li><a href="https://yossarian.net/til">TILs</a></li>
    
</ul>

<hr/>



<h2>
  <p>
    <span><em>Nov 21, 2025</em></span>

       

    
      <span>
        Tags:
        
        
          <a href="https://blog.yossarian.net/tags#oss">oss</a>,
        
          <a href="https://blog.yossarian.net/tags#security">security</a>
        
      </span>
    

       

    
  </p>
</h2>






<hr/>


<p><strong>TL;DR</strong>: Dependency cooldowns are a free, easy, and <strong>incredibly effective</strong>
way to mitigate the <em>large majority</em> of open source supply chain attacks.
More individual projects should apply cooldowns (via tools like Dependabot
and Renovate) to their dependencies, and packaging ecosystems should invest
in first-class support for cooldowns directly in their package managers.</p>

<hr/>

<p>“Supply chain security” is a serious problem. It’s also <strong>seriously overhyped</strong>,
in part because dozens of vendors have a vested financial interest in
convincing your that their <em>framing</em> of the underlying problem<sup id="fnref:problem"><a href="#fn:problem" rel="footnote" role="doc-noteref">1</a></sup> is (1)
correct, and (2) worth your money.</p>

<p>What’s consernating about this is that most open source supply chain
attacks have the same basic structure:</p>

<ol>
  <li>
    <p>An attacker compromises a popular open source project, typically via
a stolen credential or CI/CD vulnerabilty (such as <a href="https://securitylab.github.com/resources/github-actions-preventing-pwn-requests/">“pwn requests”</a> in
GitHub Actions).</p>
  </li>
  <li>
    <p>The attacker introduces a malicious change to the project and uploads
it somewhere that will have <strong>maximum effect</strong> (PyPI, npm, GitHub releases,
&amp;c., depending on the target).</p>

    <p>At this point, the <em>clock has started</em>, as the attacker has moved
 into the public.</p>
  </li>
  <li>
    <p>Users pick up the compromised version of the project via automatic
dependency updates or a lack of dependency pinning.</p>
  </li>
  <li>
    <p>Meanwhile, the aforementioned vendors are scanning public indices
as well as customer repositories for signs of compromise, and
provide alerts upstream (e.g. to PyPI).</p>

    <p>Notably, vendors are <em>incentivized</em> to report quickly and loudly upstream,
 as this increases the perceived value of their services in a crowded
 field.</p>
  </li>
  <li>
    <p>Upstreams (PyPI, npm, &amp;c.) remove or disable the compromised package
version(s).</p>
  </li>
  <li>
    <p>End-user remediation begins.</p>
  </li>
</ol>

<p>The key thing to observe is that the gap between (1) and (2) can be very large<sup id="fnref:gap"><a href="#fn:gap" rel="footnote" role="doc-noteref">2</a></sup>
(weeks or months), while the gap between (2) and (5) is <strong>typically very small</strong>:
hours or days. This means that, once the attacker has moved into the actual
exploitation phase, their <em>window of opportunity</em> to cause damage is pretty limited.</p>

<p><img src="https://blog.yossarian.net/assets/supply-chain-attack-timeline.png" alt="Figure: a not very scientific visualization of the phases above."/></p>

<p>We can see this with numerous prominent supply chain attacks over the last 18 months<sup id="fnref:filippo"><a href="#fn:filippo" rel="footnote" role="doc-noteref">3</a></sup>:</p>

<table>
  <thead>
    <tr>
      <th>Attack</th>
      <th>Approx. Window of Opportunity</th>
      <th>References</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xz-utils</td>
      <td>≈ 5 weeks<sup id="fnref:outlier"><a href="#fn:outlier" rel="footnote" role="doc-noteref">4</a></sup></td>
      <td><a href="https://research.swtch.com/xz-timeline">Source</a></td>
    </tr>
    <tr>
      <td>Ultralytics (phase 1)</td>
      <td>12 hours</td>
      <td><a href="https://blog.yossarian.net/2024/12/06/zizmor-ultralytics-injection#appendix-rough-timeline-of-events">Source</a></td>
    </tr>
    <tr>
      <td>Ultralytics (phase 2)</td>
      <td>1 hour</td>
      <td><a href="https://blog.yossarian.net/2024/12/06/zizmor-ultralytics-injection#appendix-rough-timeline-of-events">Source</a></td>
    </tr>
    <tr>
      <td>tj-actions</td>
      <td>3 days</td>
      <td><a href="https://www.legitsecurity.com/blog/github-actions-tj-actions-changed-files-attack">Source</a></td>
    </tr>
    <tr>
      <td>chalk</td>
      <td>&lt; 12 hours</td>
      <td><a href="https://cycode.com/blog/npm-debug-chalk-supply-chain-attack-the-complete-guide/">Source</a></td>
    </tr>
    <tr>
      <td>Nx</td>
      <td>4 hours</td>
      <td><a href="https://www.stepsecurity.io/blog/supply-chain-security-alert-popular-nx-build-system-package-compromised-with-data-stealing-malware">Source</a></td>
    </tr>
    <tr>
      <td>rspack</td>
      <td>1 hour</td>
      <td><a href="https://github.com/web-infra-dev/rspack/releases/tag/v1.1.8">Source</a></td>
    </tr>
    <tr>
      <td>num2words</td>
      <td>&lt; 12 hours</td>
      <td><a href="https://blog.pypi.org/posts/2025-07-31-incident-report-phishing-attack/#impact-analysis">Source</a></td>
    </tr>
    <tr>
      <td>Kong Ingress Controller</td>
      <td>≈ 10 days</td>
      <td><a href="https://konghq.com/blog/product-releases/december-2024-unauthorized-kong-ingress-controller-3-4-0-build">Source</a></td>
    </tr>
    <tr>
      <td>web3.js</td>
      <td>5 hours</td>
      <td><a href="https://threats.wiz.io/all-incidents/solana-web3js-supply-chain-attack">Source</a></td>
    </tr>
  </tbody>
</table>

<p>(Each of these attacks has significant downstream effect, of course, but only
<em>within</em> their window of opportunity. Subsequent compromises from each, like
<a href="https://www.wiz.io/blog/shai-hulud-npm-supply-chain-attack">Shai-Hulud</a>, represent <em>new</em> windows of opportunity where the attackers regrouped
and pivoted onto the <em>next</em> set of compromised credentials.)</p>

<p>My takeaway from this: some windows of opportunity are bigger, but the <em>majority</em>
of them are under a week long. Consequently, ordinary developers can <em>avoid
the bulk</em> of these types of attacks by instituting <strong>cooldowns</strong> on their dependencies.</p>

<h2 id="cooldowns">Cooldowns</h2>

<p>A “cooldown” is exactly what it sounds like: a window of time between when a dependency
is published and when it’s considered suitable for use. The dependency is public during
this window, meaning that “supply chain security” vendors can work their magic
while the rest of us wait any problems out.</p>

<p>I <strong>love</strong> cooldowns for several reasons:</p>

<ul>
  <li>
    <p>They’re empirically effective, per above. They won’t stop <em>all</em> attackers,
but they <em>do</em> stymie the majority of high-visibiity, mass-impact supply chain
attacks that have become more common.</p>
  </li>
  <li>
    <p>They’re <em>incredibly</em> easy to implement. Moreover, they’re <strong>literally free</strong>
to implement in most cases: most people can use <a href="https://docs.github.com/en/code-security/dependabot/working-with-dependabot/dependabot-options-reference#cooldown-">Dependabot’s functionality</a>,
<a href="https://docs.renovatebot.com/key-concepts/minimum-release-age/">Renovate’s functionality</a>, or the functionality build directly into their
package manager<sup id="fnref:pkgmanager"><a href="#fn:pkgmanager" rel="footnote" role="doc-noteref">5</a></sup>.</p>

    <p>This is how simple it is in Dependabot:</p>

    <div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
9
</pre></td><td><pre>  <span>version</span><span>:</span> <span>2</span>

  <span># update once a week, with a 7-day cooldown</span>
  <span>-</span> <span>package-ecosystem</span><span>:</span> <span>github-actions</span>
    <span>directory</span><span>:</span> <span>/</span>
    <span>schedule</span><span>:</span>
      <span>interval</span><span>:</span> <span>weekly</span>
    <span>cooldown</span><span>:</span>
      <span>default-days</span><span>:</span> <span>7</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>

    <p>(Rinse and repeat for other ecosystems as needed.)</p>
  </li>
  <li>
    <p>Cooldowns <strong>enforce positive behavior</strong> from supply chain security vendors:
vendors are still incentivized to discover and report attacks quickly,
but are <em>not</em> as incentivized to emit volumes of blogspam about “critical”
attacks on largely underfunded open source ecosystems.</p>
  </li>
</ul>

<h2 id="concluding--assorted-thoughts">Concluding / assorted thoughts</h2>

<p>In the very small sample set above, 8/10 attacks had windows of opportunity
of less than a week. Setting a cooldown of 7 days would have prevented
the vast majority of these attacks from reaching end users (and causing
knock-on attacks, which several of these were). Increasing the cooldown to 14
days would have prevented all but 1 of these attacks<sup id="fnref:apt"><a href="#fn:apt" rel="footnote" role="doc-noteref">6</a></sup>.</p>

<p>Cooldowns are, obviously, <strong>not a panacea</strong>: some attackers <em>will</em> evade detection,
and delaying the inclusion of potentially malicious dependencies by a week
(or two) does not fundamentally alter the fact that supply chain security is a
<em>social trust</em> problem, not a purely technical one. Still, an 80-90% reduction
in exposure through a technique that is free and easy seems hard to beat.</p>

<p>Related to the above, it’s unfortunate that cooldowns aren’t baked <em>directly</em>
into more packaging ecosystems: Dependabot and Renovate are great, but
<em>even better</em> would be if the package manager itself (as the source of ground
truth) could enforce cooldowns directly (including of dependencies not
introduced or bumped through automated flows).</p>

<hr/>




<hr/>




  






</div>
  </body>
</html>
