<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://clagnut.com/blog/2424">Original</a>
    <h1>An end to typographic widows on the web</h1>
    
    <div id="readability-page-1" class="page"><div>

<article>

<header>




</header>


<section>
<div>

<p>Currently shipping in <a href="https://www.google.com/intl/en_uk/chrome/canary/">Chrome Canary</a>, and thus soon to be in Blink-based browsers including Edge, is a relatively new <abbr>CSS</abbr> declaration which promises to virtually end typographic widows.</p>

<p>The <code>text-wrap:balance</code> declaration in <a href="https://www.w3.org/TR/css-text-4/#text-wrap">CSS Text Module Level 4</a> says that line breaks should be chosen to balance out the line lengths in a block of text. How exactly that is done is ‘UA-defined’, in other words it’s determined by the rendering engine rather than any specific rules or guidelines set in the <abbr>CSS</abbr> specifications. This is how today’s version of Chrome Canary balances out one of the longer headings in this blog:</p>

</div><!-- /.prose --><figure>
    <img loading="lazy" src="https://clagnut.com/images/2424/textwrap-wrap.png" alt="A screenshot showing a long heading with the final word dropped to the sewcond line as a widow"/>
    <figcaption>
        Default text wrapping
    </figcaption>
</figure><!-- /.prose --><figure>
    <img loading="lazy" src="https://clagnut.com/images/2424/textwrap-balance.png" alt="A screenshot showing the same long heading with the text split evenly over two lines"/>
    <figcaption>
        ‘Balanced’ text wrapping
    </figcaption>
</figure><div>

<p>What this <strong>is not</strong> is control over widows and orphans. My previous examples show how the text balancing algorithm in Chrome Canary does indeed prevent a widow (the single word dropped down), and that’s a highly likely outcome. But you have to remember that the balancing job shortens the lines, so this isn’t an approach you would take to prevent widows at the end of paragraphs. In fact Canary limits balancing to 4 lines (the spec itself recommends 10 or fewer). The <abbr>CSS</abbr> spec itself makes the application clear:</p>

<blockquote>
  <p>the balance value is intended for titles and captions, where equal length lines of text tend to be preferred</p>
</blockquote>

<p>With that in mind, this is the rule I’ve applied to this blog, and I’d say could end up in most people’s default reset:</p>

<figure data-element="code-block"><pre><code>h1, h2, h3, h4, h5, h6, caption, figcaption {
    text-wrap:balance;
}
</code></pre></figure>

<p>Balancing left-aligned headings is not always preferable. I would love to have a value for <code>text-wrap</code> whose sole purpose is to prevent widows, without any other formatting involved. One could borrow from the <code>widows</code> property of the <a href="https://www.w3.org/TR/css-break-3/#widows-orphans">Fragmentation Module</a>:</p>

<figure data-element="code-block"><pre><code>text-wrap: 2 widows  /* maybe one day */
</code></pre></figure>

<p>Where <code>2</code> in this case specifies the minimum number of words allowed on the final line of a text block. There would have to be slightly more  to it than this, in particular a single word should be allowed if the final two words together would be too long to fit inside the text block.</p>

</div><!-- /.prose --></section>
<section><div>

<p>Another value in the specification is <code>text-wrap:pretty</code>. If it’s ever implemented, this might – as an outcome – reduce widows and orphans in running text. For decades there have been sophisticated algorithms for wrapping text across multiple lines. For performance purposes, browsers use the most basic approach, the so-called first-fit/greedy algorithm, which takes one line at a time, wrapping if it’s too long, and moving on to the next. In typographers’ eyes this gives sub-optimal results, and is one of the reasons text justification is so awful on the web.</p>

<p>Better algorithms, such as <a href="https://github.com/bramstein/typeset/">Knuth-Plass</a>, take into account entire paragraphs and achieve a more nuanced approach to text wrapping by reducing and increasing spacing between words. The spec says that <q>as optimal results often take more time, <code>pretty</code> is offered as an opt-in to take more time for better results. The <code>pretty</code> value is intended for body text, where the last line is expected to be a bit shorter than the average line. [… The browser] should bias for better layout over speed, and is expected to consider multiple lines, when making break decisions.</q></p>

<p>Algorithms such as Knuth-Plass won’t necessarily eliminate widows and orphans, but might go some way to doing so. The reluctance to using such approaches is understandable, however, as they can be extremely demanding: the processing requirements increase quadratically with the paragraph length. That said, a value such as <code>pretty</code> gives the option to choose different text wrapping procedures depending on conditions (resident processing power, length of text, etc). Once day perhaps. Meanwhile I’d settle for direct control over widows and orphans in text blocks.</p></div> <!-- /.prose -->
</section>















</article>

</div></div>
  </body>
</html>
