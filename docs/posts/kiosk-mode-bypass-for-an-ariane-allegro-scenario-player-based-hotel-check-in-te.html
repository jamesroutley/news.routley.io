<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.pentagrid.ch/en/blog/ariane-allegro-hotel-check-in-terminal-kios-escape/">Original</a>
    <h1>Kiosk mode bypass for an Ariane Allegro Scenario Player based hotel check-in te</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody text">
    <p>A threat modeling workshop took us to a remote location where there was a new hotel. It was so small that there was no check-in staff, but a check-in terminal for self-service. What was bound to happen, happened.</p>
<p>The hotel check-in terminal is running an Ariane Allegro Scenario Player in a kiosk mode and the application crashed when entering a single quote character into the guest search. The application crash allowed access to the underlying Windows Desktop. According to Ariane, an outdated software version was installed in the new hotel.</p>
<p>According to the vendor Ariane Systems, &#34;Ariane is the world leader in providing self-check-in and out solutions for the hotel industry. [...] Ariane currently serves 3,000 hotels and 500,000 rooms in more than 25 countries. This includes one-third of the top 100 global hotel chains.&#34;</p>
<!-- TEASER_END -->
<section id="timeline"><h2>Timeline</h2>
<ul>
<li><p>2024-03-05: Vulnerability was discovered at a check-in terminal.</p></li>
<li><p>2024-03-06: Preliminary advisory written.</p></li>
<li><p>2024-03-06: Information sent to the hotel brand that uses the check-in terminal and asked about used application versions.</p></li>
<li><p>2024-03-07: Tried to find information how a vulnerability can be reported to Ariane Systems. The vendor does not use security.txt nor a DNS TXT record for security contact lookup. There is no information on the website how to contact the product security team. Therefore, Pentagrid initially contacted Ariane Systems via <a href="mailto:support@ariane.com">support@ariane.com</a>.</p></li>
<li><p>2024-03-14: Sent another request to the Ariane Systems support, after not receiving any feedback.</p></li>
<li><p>2024-03-14: Sent a status information to the affected hotel.</p></li>
<li><p>2024-03-14: Contacted Ariane Systems&#39; technical leader and chief product officer via Linkedin. Chief product officer responded and recommended to contact <a href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>.</p></li>
<li><p>2024-03-14: Sent e-mail to <a href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>.</p></li>
<li><p>2024-03-14: Verified all e-mails of previous communication attempts were received by Ariane Systems&#39; mail server by reviewing Pentagrid&#39;s mail server logs.</p></li>
<li><p>2024-03-15: Tried to get an e-mail receipt confirmation from the chief product officer via Linkedin, after not receiving any feedback.</p></li>
<li><p>2024-03-18: Tried to contact chief product officer via e-mail by guessing the e-mail address, after not receiveing any response, but e-mail address guessing failed.</p></li>
<li><p>2024-03-18: Contacted chief product officer via Linkedin again, to get a confirmation that Pentagrid&#39;s e-mail for starting the coordinated disclosure process has been received.</p></li>
<li><p>2024-03-18: Contacted Ariane Systems publicly via Linkedin.</p></li>
<li><p>2024-03-18: Sent vulnerability details to <a href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>, after getting a first contact confirmation via e-mail.</p></li>
<li><p>2024-03-18: Received first response, which stated that the systems are legacy systems, that USB ports are disabled and &#34;no PII or exploitable data can be retrieved from the kiosk&#34;.</p></li>
<li><p>2024-03-25: Disputing Ariane Systems&#39; claim that no PII data can be retrieved, because as part of the system design the kiosk produces and keeps accessible invoice files.</p></li>
<li><p>2024-04-11: Call with Ariane Systems.</p></li>
<li><p>2024-05-31: Asked Ariane for a status, but there was no response.</p></li>
<li><p>2024-06-05: Publication after 90 days.</p></li>
</ul></section><section id="kiosk-mode-bypass"><h2>Kiosk mode bypass</h2>
<pre>CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, 6.8 Medium</pre>
<section id="affected-components"><h3>Affected Components</h3>
<p>The check-in terminal is likely a terminal of type Ariane Duo 6000 series, which runs the Ariane Allegro Scenario Player.</p>
<p>A hotel brand from Liechtenstein and Switzerland uses the check-in terminal for smaller hotel locations. The check-in terminal supports room booking as well as checking into the hotel. It initiates the payment process via a POS terminal, provisions RFID transponders to open the booked hotel room and it prints an invoice.</p>
</section><section id="summary"><h3>Summary</h3>
<p>The check-in terminal allows searching for existing room reservations. Reservations can be looked up by booking code or by surname. When searching a reservation by name and the entered name contains a single-quote, the application hangs. When touching the screen of the terminal again, the Windows operating system will ask the user if Windows should wait any longer or stop the task. Selecting stop ends the kiosk mode application.</p>
</section><section id="impact"><h3>Impact</h3>
<p>When stopping the application, the kiosk mode is stopped and the user gets access to a Windows desktop.</p>
<p>With access to the Windows desktop, attacks on the hotel network could become possible as well as access to data stored on the terminal, which includes PII, reservations and invoices. With the ability to inject and execute program code, it seems possible to get room keys created for other rooms, because the functionality of provisioning RFID transponders is implemented in the terminal.</p>
</section><section id="technical-details"><h3>Technical Details</h3>
<p>When a user searches an existing reservation and adds a single-quote to the surname, the application hangs. An example input that causes the effect is &#34;O&#39;YOLO&#34;.</p>
<a href="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_enter_name.jpg"><img alt="Entering a name into the search field with a single-quote character. In this example, &#34;O&#39;YOLO&#34; is entered. The hotel&#39;s brand logo is masked in the photo." src="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_enter_name.thumbnail.jpg"/></a>
<p>The application hangs. By touching the Elo display again, Windows will ask how to proceed with the application.</p>
<a href="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_stop_kiosk_application.jpg"><img alt="Windows asks whether the application should be continued or stopped." src="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_stop_kiosk_application.thumbnail.jpg"/></a>
<p>When stopping the application, the Windows desktop becomes accessible.</p>
<a href="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_kiosk_mode_stopped.jpg"><img alt="Windows desktop is accessible after stopping the kiosk mode application." src="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_kiosk_mode_stopped.thumbnail.jpg"/></a>
</section><section id="precondition"><h3>Precondition</h3>
<p>An attacker needs physical access to a check-in terminal and depending on the attack preparation some time at the terminal. The terminal must be in a state where it allows self-service, for example as Hotels might only enable it during specific times.</p>
</section><section id="recommendation"><h3>Recommendation</h3>
<p>According to Ariane, the problem was fixed in the Allegro Scenario Player. Therefore, Pentagrid recommends hotels using the terminal:</p>
<ul>
<li><p>To ensure that a recent version of the software is installed. The version that fixes the issue is not known to Pentagrid. Hence Ariane Systems should be asked.</p></li>
<li><p>To isolate check-in terminals so that bypassing the kiosk mode does not allow attacks on the hotel network or the Windows domain.</p></li>
</ul></section><section id="credits"><h3>Credits</h3>
<p>This vulnerability was accidentally found by Martin &#34;O&#39;YOLO&#34; Schobert (Pentagrid).</p>
</section></section>
</div></div>
  </body>
</html>
