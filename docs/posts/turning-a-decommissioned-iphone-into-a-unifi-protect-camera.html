<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.caseyliss.com/2025/8/15/a-rube-goldberg-camera">Original</a>
    <h1>Turning a Decommissioned iPhone into a UniFi Protect Camera</h1>
    
    <div id="readability-page-1" class="page"><div>
                <!-- header -->
                <div>

<p>I’ve recently become a <a href="https://www.ui.com">Ubiquiti UniFi</a> disciple, including replacing our builder-basic
doorbell from 1998 with <a href="https://store.ui.com/us/en/products/uvc-g4-doorbell-pro">Ubituiti G4 Doorbell Pro</a>. This has brought me into the
<a href="https://ui.com/physical-security">UniFi Protect</a> ecosystem.</p>
<p>Protect is absolutely designed to work with UniFi cameras — as one would
expect — but they do have <a href="https://help.ui.com/hc/en-us/articles/26301104828439-Third-Party-Cameras-in-UniFi-Protect">some basic support</a> for third-party
cameras that support <a href="https://en.wikipedia.org/wiki/ONVIF">ONVIF</a>.</p>
<p>It occurred to me that I have a small collection of minicomputers in the house
that I’m not using anymore. Further, those minicomputers all have cameras built-in.
So that got me thinking, can I use one of these old iPhones as a third-party
camera in Protect?</p>
<hr/>
<p>My first step was to see if I could find an app on the App Store that natively
supports streaming via ONVIF. If one exists, I couldn’t find it.</p>
<p>However, while researching how to handle this, it became apparent that, to
my limited understanding, ONVIF is more of a handshaking protocol. When it
comes to video streaming, the assumption is that <a href="https://en.wikipedia.org/wiki/Real-Time_Streaming_Protocol">RTSP</a> will handle
the <em>actual</em> streaming.</p>
<p>Which got me wondering if I could do some combination of</p>
<pre><code>RTSP app → some sort of ONVIF wrapper/proxy → Protect
</code></pre>
<p>In principle, that <em>should</em> work.</p>
<hr/>
<p>I started by casting about to find an app that would stream RTSP from the
phone. I found a couple, but the one that seemed to work best for me is
<a href="https://apps.apple.com/us/app/ip-camera-lite/id1013455241">IP Camera Lite</a>. It’s not intuitive, but it has a free tier for me
to test with, and once I got my head around how the app works, it was
reasonably simple.</p>
<p>However, I needed to prove to myself that it was working. So, I turned
to my dear old friend <s><code>ffmpeg</code></s>, <a href="https://ffmpeg.org/ffplay.html"><code>ffplay</code></a>. Once I had
the app running and configured, I tried to play the stream:</p>
<p><code>ffplay rtsp://admin:admin@192.168.17.189:8554/live</code></p>
<p>Sure enough, I had a stream of the phone’s camera (and microphone).</p>
<hr/>
<p>Sometime recently I had stumbled upon <a href="https://www.reddit.com/r/Ubiquiti/comments/1mltdj0/how_i_solved_my_rtsp_to_onvif_issues_with_protect/?share_id=UCnuL_aq31wCpgqjttte6">a Reddit post</a> that explored a
person going down a vaguely similar path. They made mention of trying
to get <a href="https://github.com/p10tyr/rtsp-to-onvif">a Docker container</a> working to do the ONVIF side of things,
but couldn’t make heads nor tails of it.</p>
<p>I figured it couldn’t hurt to see if I could get it to work, as I’ve
been using Docker for a few years now.</p>
<p>At first, I was running things attached/live in the console, to see
logs and error messages as they came in. After beating my head against
the wall for a while, I got the container to the point that it wasn’t
erroring on startup.</p>
<p>I had to make a few changes to the <code>config.yaml</code>:</p>
<ol>
<li>I switched to <code>eth4</code>, which happens to be the 10GbE daughter card that
I installed in my Synology. You can determine this using <code>ifconfig</code>.</li>
<li>I set the correct IP address and path for the iPhone’s stream</li>
<li>I absolutely had to set the correct width/height, otherwise it wouldn’t
work. To do so, I just took a look at the <code>ffplay</code> console output from
earlier and cribbed the values from there.</li>
</ol>
<p>After getting things to the point that they seemed okay, I loaded UniFi Protect
on my computer, and navigated to <code>Settings</code> → <code>System</code> → <code>Advanced</code>, where I
had to tick on <code>Discover 3rd-Party Cameras</code>.</p>
<p>Then, in the <code>UniFi Devices</code> section (found in the left sidebar), I would see
the new device. I clicked on <code>Click to Adopt</code>, and was challenged for a
username and password. I used <code>admin</code> for both, which appears to be the default
for the IP Camera app.</p>
<p>At first, I was presented with an endless spinner, as I hadn’t configured things
properly. The documentation on Github is enough, but frustratingly, the failure
mode I ran into was the video just… not loading. However, I eventually got
it nailed down, and now I have a new camera in Protect.</p>
<p>Thanks to this, I can now retire both <a href="https://www.synology.com/en-global/surveillance">Surveillance Station</a> and <a href="https://www.scrypted.app">Scrypted</a>,
which I was using previously before I moved to Protect.</p>
                </div><!-- main -->
            </div></div>
  </body>
</html>
