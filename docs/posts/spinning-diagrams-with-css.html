<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://x.st/spinning-diagrams-with-css/">Original</a>
    <h1>Spinning Diagrams with CSS</h1>
    
    <div id="readability-page-1" class="page"><div>
<article>

<div>
<address>Harold Cooper</address>
<p><time datetime="2023-04-20T00:00:00-04:00">20th April 2023</time>
</p></div>
<p>I wrote a little <a href="https://x.st/visual-sum-of-cubes/">math thing</a> last year, which featured equations like this:</p>
<span><span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span>n</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>k</span><span><span><span><span><span><span></span><span><span>3</span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>2</span><span><span>(</span></span><span></span><span><span>)</span></span><span></span><span>−</span><span></span></span><span><span></span><span></span></span><span></span></span></span></span>
<p>Several people expressed surprise that the spinning diagrams don’t use any JavaScript or animated image formats, just HTML and CSS. So I thought I’d explain how they work before I forget.</p>
<h2 id="a-spinning-cube">A spinning cube</h2>
<p>We can build a spinning cube, with a letter at each vertex.</p>


<p>For the HTML, we make a div for each letter and position it with <code>translate3d</code>:</p>
<div><div><pre><code><span>&lt;div</span> <span>id=</span><span>&#34;cube&#34;</span> <span>style=</span><span>&#34;width: 4em; height: 8em;&#34;</span><span>&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(0em, 0em, 2em)&#34;</span><span>&gt;</span>A<span>&lt;/div&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(4em, 0em, 2em)&#34;</span><span>&gt;</span>B<span>&lt;/div&gt;</span>
  …
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(0em, 4em, -2em)&#34;</span><span>&gt;</span>G<span>&lt;/div&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(4em, 4em, -2em)&#34;</span><span>&gt;</span>H<span>&lt;/div&gt;</span>
<span>&lt;/div&gt;</span>
</code></pre></div></div>
<p><small><em>(I use <code>em</code> units, but <code>px</code> or any other unit is fine too. The cube is 4em wide and the vertices are centered around x=2em and z=0em, making it easy to spin about the center.)</em></small></p>
<p>For the CSS, we set an <code>animation</code> on the parent from <code>rotateY(0turn)</code> to <code>rotateY(1turn)</code>:</p>
<div><div><pre><code><span>#cube</span> <span>{</span>
  <span>position</span><span>:</span> <span>relative</span><span>;</span>
  <span>transform-style</span><span>:</span> <span>preserve-3d</span><span>;</span>
  <span>animation</span><span>:</span> <span>spin</span> <span>20s</span> <span>linear</span> <span>infinite</span><span>;</span>
<span>}</span>

<span>#cube</span> <span>&gt;</span> <span>div</span> <span>{</span>
  <span>position</span><span>:</span> <span>absolute</span><span>;</span>
  <span>transform-style</span><span>:</span> <span>preserve-3d</span><span>;</span>
<span>}</span>

<span>@keyframes</span> <span>spin</span> <span>{</span>
  <span>from</span> <span>{</span> <span>transform</span><span>:</span> <span>rotateX</span><span>(</span><span>-0.1turn</span><span>)</span> <span>rotateY</span><span>(</span><span>0turn</span><span>);</span> <span>}</span>
  <span>to</span> <span>{</span> <span>transform</span><span>:</span> <span>rotateX</span><span>(</span><span>-0.1turn</span><span>)</span> <span>rotateY</span><span>(</span><span>1turn</span><span>);</span> <span>}</span>
<span>}</span>
</code></pre></div></div>
<p><small><em>(Note that <code>1turn</code> equals <code>360deg</code>. And we add a slight tilt <code>rotateX(-0.1turn)</code> to make things look better. Finally, for the 3d positions to work, we need <code>preserve-3d</code> and <code>position: relative</code> on the parent, and <code>position: absolute</code> on the children.)</em></small></p>
<p>Put it all together and we get:</p>

<p>Notice that the letter glyphs themselves are rotating, which is neat, but could make the diagram hard to read.</p>
<h2 id="un-spinning-the-letters">Un-spinning the letters</h2>
<p>To keep the letters facing forwards, we can ‘un-spin’ them in sync with the spinning parent, but in the opposite direction.</p>


<p>To accomplish this we add another div around each letter, where we can perform the un-spinning without interfering with the existing <code>transform</code>:</p>
<div><div><pre><code><span>&lt;div</span> <span>id=</span><span>&#34;cube&#34;</span> <span>style=</span><span>&#34;width: 4em; height: 8em;&#34;</span><span>&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(0em, 0em, 2em)&#34;</span><span>&gt;&lt;div&gt;</span>A<span>&lt;/div&gt;&lt;/div&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(4em, 0em, 2em)&#34;</span><span>&gt;&lt;div&gt;</span>B<span>&lt;/div&gt;&lt;/div&gt;</span>
  …
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(0em, 4em, -2em)&#34;</span><span>&gt;&lt;div&gt;</span>G<span>&lt;/div&gt;&lt;/div&gt;</span>
  <span>&lt;div</span> <span>style=</span><span>&#34;transform: translate3d(4em, 4em, -2em)&#34;</span><span>&gt;&lt;div&gt;</span>H<span>&lt;/div&gt;&lt;/div&gt;</span>
<span>&lt;/div&gt;</span>
</code></pre></div></div>
<p>We keep the CSS from before, but give the new inner divs an un-spinning <code>animation</code> from <code>rotateY(0turn)</code> to <code>rotateY(-1turn)</code>:</p>
<div><div><pre><code><span>#cube</span> <span>&gt;</span> <span>div</span> <span>&gt;</span> <span>div</span> <span>{</span>
  <span>animation</span><span>:</span> <span>un-spin</span> <span>20s</span> <span>linear</span> <span>infinite</span><span>;</span>
<span>}</span>

<span>@keyframes</span> <span>un-spin</span> <span>{</span>
  <span>from</span> <span>{</span> <span>transform</span><span>:</span> <span>rotateY</span><span>(</span><span>0turn</span><span>);</span> <span>}</span>
  <span>to</span> <span>{</span> <span>transform</span><span>:</span> <span>rotateY</span><span>(</span><span>-1turn</span><span>);</span> <span>}</span>
<span>}</span>
</code></pre></div></div>
<p>All together this looks like:</p>

<p>I was pleasantly surprised that all this spinning and un-spinning seems to perform fine even on mobile browsers.</p>
<p>You can even select the rotating text and your selection will rotate as well—impressive work by the browser builders.</p>
<span><span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span><span><span><span><span></span><span><span><span>k</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span>n</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>k</span><span><span><span><span><span><span></span><span><span>3</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span>
<p><em>The original <a href="https://x.st/visual-sum-of-cubes/">math thing</a> involved a few other tricks—to embed the diagrams in LaTeX and generate their geometries—which for completeness I’ll describe as a footnote.<sup id="fnref:et-cetera" role="doc-noteref"><a href="#fn:et-cetera" rel="footnote">1</a></sup></em></p>

</article>
</div></div>
  </body>
</html>
