<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://computer.rip/2024-06-02-consumer-electronics-control.html">Original</a>
    <h1>Consumer Electronics Control</h1>
    
    <div id="readability-page-1" class="page"><article>


<p>In a previous episode, I discussed <a href="https://computer.rip/2024-01-21-multi-channel-audio-part-1.html">audio
transports</a>
and mention that they have become a much less important part of the modern home
theater landscape. One reason is the broad decline of the component system:
most consumers aren&#39;t buying a television, home theater receiver, several
playback devices, and speakers. Instead, they use a television and perhaps
(hopefully!) a soundbar system, which often supports wireless satellites if
there are satellites at all. The second reason for the decline of audio
transports is easy to see when we examine these soundbar systems: most connect
to the television by HDMI.</p>
<p>This is surprising if you consider that soundbars are neither sources nor sinks
for video. But it&#39;s not so surprising if you consider the long-term arc of HDMI
[1], towards being a general-purpose consumer AV interconnect. HDMI has become
the USB of home theater, and I mean that as a compliment and an insult. So,
like USB, HDMI comes in a confusing array of versions with various mandatory,
optional, and extension features. The capabilities of HDMI vary by the devices
on the ends, and in an increasing number of cases, even by the specific port
you use on the device.</p>
<p>HDMI actually comes to this degree of complexity more honestly than USB. USB
started out as a fairly pure and simple serial link, and then more use-cases
were piled on, culminating in the marriage of two completely different
interconnects (USB and Thunderbolt) in one physical connector. HDMI has always
been a Frankenstein creation. At its very core, HDMI is &#34;DVI plus some other
things with a smaller connector.&#34;</p>
<p>DVI, or really its precursors that established the actual video format, was
intended to be a fairly straightforward step from the analog VGA. As a result,
the logical design of DVI (and thus HDMI) video signals are pretty much the
same as the signals that have been used to drive CRT monitors for almost as
long as they&#39;ve existed. There are four TMDS data lines on an HDMI cable,
each a differential pair with its own dedicated shield. The four allow for
three color signals (which can be used for more than one color space) and a
clock. Two data pins plus a shield, times four, means 12 pins. That&#39;s <em>most,</em>
but not all, of the 19 pins on an HDMI connector.</p>
<p>A couple of other pins are used for an I2C connection, to allow a video source
to query the display for its specifications. A couple more are used for the
audio return channel or ethernet (you can&#39;t do both at the same time) feature
of HDMI. There&#39;s a 5V and a general signal ground. And then there&#39;s the CEC
pin.</p>
<p>The fact that CEC merits its own special pin suggests that it is an old part
of the standard, and indeed it is. CEC was planned from the very beginning,
although it didn&#39;t get a full specification as part of the HDMI standard until
HDMI 1.2a. Indeed, CEC is older than HDMI, dating to at least 1998, when it
was standardized as part of SCART. But let&#39;s take a step back and consider the
application.</p>
<p>One of the factors in the decline of component stereo systems is the remote
control. In the era of vinyl, when you had to get off the couch to start a
record anyway, remote controls weren&#39;t such an important part of the stereo
market. The television changed everything about the way consumers interact
with AV equipment: now we all stay on the couch.</p>
<p>I think we all know the problem, because we all lived through it: the
proliferation of remotes. When your TV, your VCR, and your home theater
receiver all have remote controls, you end up carrying around a bundle
of cheap plastic. You will inevitably drop them, and the battery cover
will pop off, and the batteries will go under the couch. This was one of
the principal struggles faced by the American home for decades.</p>
<p>There are, of course, promised solutions on the market. Many VCR remotes had
the ability to control a TV, and often the reverse as well. If you bought your
TV and VCR from the same manufacturer this worked. If you didn&#39;t, it might not,
or at least setup will be more complex. This is because the protocols used by
IR remotes are surprisingly unstandardized. Surprisingly unstandardized in that
curious way where there are few enough IR transceiver ICs that a lot of devices
actually are compatible (consider the ubiquitous Philips protocol), but no one
documents it and detailed button codes often vary in small and annoying ways.</p>
<p>So we got the universal remote. These remotes, often thrown in with home
theater receivers as a perk, have some combination of a database of remote
protocols pre-reverse-engineered by the manufacturer and a &#34;learn&#34; mode in
which they can record unknown protocols for naive playback. Results were...
variable. I heard that some of the expensive universal remotes like Logitech
Harmony (dead) and Control4 (still around) were actually pretty good, but
they required some emphasis on the word &#34;expensive.&#34; Universal remotes were
sort of a mixed bag, but they were fiddly enough to keep working that consumer
adoption doesn&#39;t seem to have been high.</p>
<p>So, another approach came to us from the French. In the Europe of the 1970s,
there was not yet a widely accepted norm for connecting a video source to a TV
(besides RF modulation). France addressed the matter by legislation, mandating
SCART in 1980. Over the following years, SCART became a norm in much of Europe.
SCART is a bit of an oddity to Americans, as it never achieved a footprint on
this continent. That&#39;s perhaps a bit disappointing, because SCART was ahead of
its time.</p>
<p>For example, much like HDMI, SCART carried bidirectional audio. It supported
multiple video formats over one cable. Most notably, though, SCART was designed
for daisy chaining. Some simple aspects of the SCART design provided a basic
form of video routing, where the TV could bidirectionally exchange video
signals with one of several devices in a chain. The idea of daisy-chainable
video interconnects continuously reappears but seldom finds much success, so
I&#39;d call this one of the more notable aspects of SCART.</p>
<p>That&#39;s not why we&#39;re here, though. Another interesting aspect of SCART was its
communications channel between devices. The core SCART specification included a
basic system of voltage signaling to indicate which device was active, but in
1998 CENELEC EN 50157-1 was standardized as a flexible serial link between
devices over the SCART cable. Most often called AV.link, this channel could be
used for video format negotiation, but also promised a solution to multiplying
remotes: the AV.link channel can transmit remote control commands between
devices. For example, your TV remote can have play/pause buttons, and when you
push them the TV can send AV.link play/pause commands to whichever video source
is active.</p>
<p>AV.link is a very simple design. A one wire (plus ground) serial bus operates
at a slow (but durable) 333bps with collision detection. Devices are identified
by four-bit addresses chosen at random (but checked for collision). Messages
have a simple format: a one-byte header with the sending and receiving
addresses, a one-byte opcode, and then whatever bytes are expected as
parameters to the opcode.</p>
<p>AV.link is one of those standards that never quite got its branding together.
Unlike, say, USB, where a consistent trademark identity is used, AV.link goes
by different names from different vendors. Wikipedia offers the names
nexTViewLink (horrible), SmartLink (mediocre), Q-Link (lazy), and EasyLink
(mediocre again). One wonders if consumers were confused by these different
vendor brands for the same thing, it&#39;s not a situation that happens very often
with consumer interconnects.</p>
<p>When HDMI was developed, the provision of a pin for AV.link was pretty much
copied over from SCART. Originally, the functionality wasn&#39;t even really
specified, and just assumed to be similar to SCART. Later HDMI versions
included a much more complete description of CEC as a supplement. Hardware
support for CEC is mandated for devices like TVs as part of the HDMI
certification process, but curiously, software support isn&#39;t really included.
As a result, it is very common, but not universal, that TVs fully support CEC.
Other AV devices like home theater receivers almost universally have CEC
support. Computers almost universally do not, as cost and licensing
considerations mean that GPUs do not provide a CEC transceiver.</p>
<p>Inconsistent implementations are not the only way that CEC is a little sketchy.
Remember how different vendors referred to SCART AV.link by different names?
CEC has the same problem. I won&#39;t bother with the whole list, but the names
you&#39;re more likely to have seen include Samsung Anynet+, LG SimpLink, and...
well, Philips EasyLink is still with us. In practice, a lot of people seem to
ignore these names, and CEC is a lot more common than Anynet+ when discussing
Samsung TVs. That doesn&#39;t stop Samsung from pushing their own branding in their
menus and port labeling, though.</p>
<p>Because CEC inherits the AV.link features designed for SCART, it has a
surprisingly rich featureset. For example, if you have an HDMI switch with real
CEC support (these don&#39;t seem to be that common!) and a TV with software
support, the TV can discover the topology of connected devices and remote
control the switch to use the switch inputs as an extension of its own input
selection menu.</p>
<p>Most CEC features are more prosaic, though. Considering the list of high-level
features in the specification, &#34;One Touch Play&#34; means that a device can
indicate that it has video to show (causing a TV to turn on and select that
input) while &#34;System Standby&#34; means that a device being turned off can tell the
other devices on the bus to turn off as well. &#34;One Touch Record,&#34; &#34;Deck
Control,&#34; &#34;Tuner Control,&#34; &#34;Device Menu Control,&#34; and &#34;System Audio Control&#34;
are all variations on devices forwarding simple remote commands (play, pause,
up, down, etc) to other devices that might care about them more. For example,
when you use a TV with a stereo receiver or soundbar, it should forward volume
up/down commands from the remote to the audio device via System Audio Control.</p>
<p>Considering the decline of component systems, there are basically two common
scenarios where CEC is used today. These are really the same scenario in a
lot of ways, but they vary in the details.</p>
<ul>
<li>The connection of a television to a home theater receiver. In these kinds of
configurations, the home theater receiver is often used for at least some video
switching. That means that the receiver is sending video to the TV, receiving
audio from the TV via audio return channel (ARC), and both are exchanging commands.
For example, the receiver can use CEC to turn on the TV when a video input is
selected. Conversely, the TV can turn on the receiver when it is turned on.</li>
<li>The connection of a television to a soundbar. In this case, ARC is used to
send audio from the TV to the soundbar. There really is no video involved in this
scenario, so in a sense the HDMI cable is mostly unused. CEC is used by the TV to
control the soundbar. Because soundbars don&#39;t often have a remote that the user
cares to keep around, this control tends to be mostly unidirectional, used by the
TV to turn the soundbar on and off.</li>
</ul>
<p>It is interesting, isn&#39;t it, that an interconnect with four very-high-speed
serial video channels is often put into use in a scenario where those channels
are useless. Instead, the much lower-rate ARC and CEC channels are the
important ones. Well, think about USB as a power connector... these things
happen.</p>
<p>CEC could be used in much more complex scenarios. For example, if you had a DVR
connected to your TV via CEC, you could browse the electronic program guide
(EPG) on your TV and choose a program to record. This would cause the TV to use
CEC Timer Programming to send the program details from the TV EPG to the DVR to
schedule the recording. How widely was this ever used? I don&#39;t know, I suspect
not very, because these days DVRs are almost invariably provided by the cable
or satellite company, who expect you to use the DVR&#39;s EPG rather than your TVs
anyway.</p>
<p>This is actually one of the scenarios where you see ARC used for reasons other
than synchronizing control of an audio output: set-top boxes (STBs). Media
companies that distribute STBs, mostly cable and satellite operators, tend to
be in a bit of a war to own your television watching experience. They face
stiff competition from &#34;Smart TVs.&#34; I have a suspicion that the complete
proliferation of smart TVs is largely an artifact of the television
manufacturers trying to win advertising surface area away from the STB
manufacturers, who have traditionally held most of it via the EPG.</p>
<p>As some evidence of this fight, consider the case of Xfinity Xumo (formerly
Flex), the compact STB that Xfinity offers to its internet customers for free.
Since it&#39;s advertised to people who don&#39;t necessarily have any TV service from
Xfinity, it&#39;s not really a conventional STB. It&#39;s more of a
slightly-weird-but-free Roku or Amazon Fire Stick. It doesn&#39;t really offer
anything that your TV doesn&#39;t already, but unlike your TV, it&#39;s controlled by
Comcast. This gives them the opportunity to upsell you on IPTV services, but
Comcast never seems to have pursued this route that far. Mostly it gives them
the opportunity to advertise to you, and to grab some partner revenue from
various streaming apps.</p>
<p>Anyway, that was a bit of a digression. The point is that Comcast and Dish
Network and all of their compatriots don&#39;t want you using your TV, they want
you using your STB. So they give you a big chunky remote (&#34;With Voice
Control!&#34;) and the STB attempts to use CEC to control the TV so you never have
to touch its small, svelte remote (&#34;With Voice Control!&#34;) and split their
sponsored content revenue with LG.</p>
<p>That&#39;s an interesting detail of this whole landscape, isn&#39;t it? CEC was
developed as a solution to a technical problem: people had multiple devices,
and hauling around multiple remotes was frustrating. Over the decades since, it
has evolved into a strategy to address a business problem: everyone that sells
you AV equipment prefers that you passionately navigate their on-screen menus
while completely forgetting about those of your other components.</p>
<p>That&#39;s pretty much what&#39;s happening with the audio devices as well. TV
manufacturers want to capture as much of your entertainment attention and
budget as possible, so ideally they sell you a TV and their matching soundbar
system (which can be fairly inexpensive since it is closely coupled to the TV
and needs very little of its own control logic). CEC here is an under-the-hood
implementation detail, something that happens behind the scenes to make your
soundbar do the few things it does.</p>
<p>Say you&#39;re a higher-end customer, though, with a home theater receiver. The AV
receiver industry has been surprisingly unambitious about capturing Platform
Revenue, probably because soundbars have pretty much eliminated everything but
higher-end, &#34;audiophile&#34;-focused brands. These companies either lack the
technical resources to develop a good Entertainment Platform or don&#39;t think
their customers will respond well to yet another remote with a Pluto TV button.
I would like to say it&#39;s mostly the latter, but given my experience with the
on-screen design and mobile apps of several leading AV receiver manufacturers,
I suspect it&#39;s mostly the former.</p>
<p>So CEC functions perhaps the most as it was originally intended: you can mainly
interact with your TV, and CEC carries control messages to the receiver as
needed so that you don&#39;t need to find its remote to select the right input.
Conceptually you can even use the TV to control non-video functions. For
example, my particular combination of a Samsung TV and Yamaha receiver
implements CEC completely enough that I can turn on the receiver, select the
turntable preamp input, and control the volume via the TV if I want to. Then I
still have to get up to actually put a record onto the turntable, and now the
TV is just on the whole time, so this isn&#39;t that appealing in practice. I am
still rummaging fro the receiver&#39;s own remote, that or using its terrible
Android app.</p>
<p>In the STB scenario, something like Xfinity X1 or Dish Hopper, we have an
inversion of control: the only remote you&#39;ll need, they hope, is the STB&#39;s
remote. It will remote control the TV via CEC as needed. This inevitably sets
up a power struggle where your Smart TV gets lonely and wants attention. I am
mostly kidding about this emotional interpretation of the situation, but
obviously the TV manufacturer does have an incentive to distract your attention
from the STB, which probably has something to do with the tendency of Smart TVs
to pop up a lot of on-screen chrome whenever you turn them on.</p>
<p>The coolest thing about CEC, in my mind, is that unlike HDMI it is multi-drop.
That is, when you connect a bunch of HDMI sources to a multi-input TV or
receiver or another switching device, they can all be connected to the same
unified CEC bus. That means that HDMI devices can communicate with each other
via CEC even when there&#39;s no active video or audio connection.</p>
<p>CEC even has a fairly complex addressing mechanism to take advantage. CEC
physical addresses are assigned based on bus topology, and a mapping protocol
is used to advertise a correspondence between new physical addresses and
logical addresses. Logical addresses, the same 4-bit addresses from AV.link,
are assigned based on capabilities. Typically logical address 0 will be the TV,
1 and 2 will be recorders, 3 will be a tuner, 4 a playback device, 5 a home
stereo receiver. You can have a fairly large component setup where everything
is controllable by sending CEC messages to standard logical addresses.</p>
<p>And other aspects of CEC are designed to accommodate these kinds of more complex
networks. For example, when the user selects a device to watch on their TV, the
TV can send a &#34;Set Stream Path&#34; message (opcode 0x86). The parameter on this
message is the physical CEC address of the desired device, and any CEC switches
in the path are expected to see the message and select the appropriate input to
form a path from the selected device to the TV. It&#39;s a little bit of
centrally-controlled circuit switching right in your entertainment center.
Neat!</p>
<p>You can even do broadcast messaging across the entire CEC topology. TVs often
use this to discover what devices they&#39;re connected to, saving the user some
menu setup.  That&#39;s about the only time you&#39;d notice it, though: like CEC&#39;s
other more advanced capabilities, routing and multi-device messaging are rarely
used outside of its very simplest application.</p>
<p>I want to pass some sort of tidy moral judgment, but CEC is a hard case. It&#39;s
kind of a mixed bag. The more basic functionality tends to work well and adds
convenience. The more complex functionality tends to either not work or be
buried deeply enough in configuration menus that no one uses it. It inevitably
leads to some weird, inelegant behavior. My husband will put a cab ride video
on the TV and then Spotify Cast to the receiver. But then what if you want to
listen to the video audio? Easiest way to get the receiver switched back to the
TV audio is, of course, to turn the TV off and on again. When you turn it on,
it uses CEC &#34;One Touch Play&#34; to signal the receiver to select it again.
The particular convergence of technologies here leads to a strange tic, sort
of a superstitious behavior, that works fine but feels bad.</p>
<p>If you&#39;re a weirdo like me, you use your TV heavily as a monitor for a
computer. You might find the gap here rather conspicuous: when I wiggle the
mouse to wake the computer up, the TV doesn&#39;t turn on. HDMI keeps gaining
features, video games are a big driver of high-end PC and television sales,
there is an inevitable convergence happening between &#34;monitor&#34; and &#34;TV,&#34; and
between &#34;video source&#34; and &#34;computer.&#34; But the computer video industry is,
well, a little slow to catch on.</p>
<p>You might remember that it took an awkwardly long time for PC GPUs to have
consistent support for HDMI audio, and then it was still weird and sketchy for
a good few years. Well, we haven&#39;t even quite made it to that point on the CEC
front. I don&#39;t think <em>any</em> conventional PCs have CEC transceivers. The
solution, if you are mad enough to want one, is a USB CEC adapter. They&#39;re
basically passthrough devices for HDMI, they just tap the CEC pin and hook it
up to a UART. Not many companies make them but they&#39;re cheap enough. Software
support is... minimal, but it&#39;ll let Kodi turn your TV on.</p>
<p>It&#39;s fun to think about, though. You know how CEC is multi-drop? You could hook
up multiple computers to an HDMI switch and they could talk to each other with
CEC. You could use some vendor-specific opcodes to convey IP. You could log
onto the internet over HDMI, at 333bps. You could put OpenSC over IP over HDMI
CEC and turn your lights on via your stereo receiver. What a dream! I was going
to say you could do DMX-512 over CEC but actually at CEC&#39;s slow speed the
register-broadcast model of DMX would become a pretty significant problem.</p>
<p>You could also log onto the internet over HDMI at 100Mbps, but that&#39;s using
different pins, your GPU definitely doesn&#39;t support it, and I don&#39;t even know
of a way to do HDMI Ethernet from a PC. CEC may be a bit of an awkward cousin
but at least it&#39;s more popular than HDMI Ethernet.</p>
<p>[1] pun not intended</p>
	</article></div>
  </body>
</html>
