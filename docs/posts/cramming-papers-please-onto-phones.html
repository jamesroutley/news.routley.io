<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dukope.com/devlogs/papers-please/mobile/">Original</a>
    <h1>Cramming &#39;Papers, Please&#39; onto Phones</h1>
    
    <div id="readability-page-1" class="page"><div>

    



    
<article itemscope="" itemtype="http://schema.org/BlogPosting">

  <div itemprop="articleBody">
  
    <p>
    
      Aug 06, 2022
       
    </p><hr/>

    <p>
  <img src="https://3909.co/dev/pp/img/Mobile-Title.jpg" alt="Mobile-Title"/>
</p>
<p>I created <em>Papers, Please</em> in 2013 specifically for desktop computers with mouse control. Now, here, in 2022, desktop computers no longer exist and all computing is done via handheld mobile telephone. Time to update this dinosaur.</p>
<p>These thousands of words and megabytes of images will cover some bits of porting the game from big desktop to little phone. As a winking throwback to days past, this is a big dump of text and inline img tags instead of exciting splashes of quick-cut video. In 9 years, I’ll port this post to VR.</p>
<p>Beyond the minimal amount necessary to make the interface work, there are no content changes or additions for this port. No wild story twists, no new characters, no voiced dialog, no stereoscopic ray-traced graphics, and most disappointingly, no cosmetic unlockables.</p>
<p>Same meal, different plate.</p>
<h2 id="step-1-to-unity">Step 1: To Unity</h2>
<p><em>Papers, Please</em> was originally written in <a href="https://www.haxe.org">Haxe</a>/<a href="https://www.openfl.org">OpenFL</a>, a combo of modern ECMA-ish language, Flash-alike API, and multi-platform build system. This was a great environment for getting the game together quickly in 2013 but over the years Haxe has moved away from its Flash-targeting roots, and keeping up with OpenFL changes to make game updates has required outsized effort.</p>
<p>When I finally committed to this port my first decision was to rewrite the game in C#/Unity. After Obra Dinn I’m a solid fan of <a href="https://unity.com">Unity</a> – the editor, the entity/component design, the build system, the ubiquity, just about everything.</p>
<p>I made it a few days into rewriting before finding that although I like C#, I like Haxe more. In making the game I’d leveraged a bunch of core Haxe features like super enums and implicit typing and it was all getting trickier and trickier to implement by hand in C#.</p>
<p>One option would’ve been to keep the Haxe part but switch from OpenFL to <a href="https://www.heaps.io">Heaps</a>, another Haxe-based engine and build system. Dead Cells, Northgard, and a few other games are built with Haxe/Heaps so it’s a perfectly capable system. Still it’s hard to overstate how appropriate Unity is for someone in my position: a solo developer targeting multiple platforms and desperate for a popular, proven, and well-supported engine and build system.</p>
<p>Fortunately, Haxe is a transpiled language, meaning that you write in one language (Haxe) and it gets converted to another language (Javascript, PHP, Python, C++, C#, Lua, etc) before being compiled/interpreted for whatever target you’ve got. So it’s possible to write code in Haxe and have it transpiled to C# that can be loaded and compiled in Unity. Which is how I decided to roll this.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-EngineTranspileHaxe.png" alt="Mobile-EngineTranspileHaxe"/></p><p>Haxe code</p>

<p>
  <img src="https://3909.co/dev/pp/img/Mobile-EngineTranspileCSharp.png" alt="Mobile-EngineTranspileCSharp"/></p><p>The same code transpiled to C#</p>

<p>First, I stripped all usage of the Flash-like API that OpenFL was providing. The display tree, input events, bitmap manipulation, resource management, sound playback – basically everything that wasn’t core game logic. Then I rebuilt it all with custom code, the goal being to create a sort of <em>PAPERS-PLEASE</em> black box that could take user input and spit out a list of quads to draw and audio commands to execute every frame.</p>
<p>This was probably the most fun part of the project. The full Flash API was overkill for Papers Please anyways, and building a fresh engine specifically for what I needed was cathartic.</p>
<p>I was slightly worried about performance here, since much of the OpenFL API is written in C++ and I was replacing it all with higher-level Haxe code. The requirements for the game are earth-core low though, and Haxe is pretty performant anyways so I only had to be a little bit careful to get good framerates.</p>
<p>The end result requires a minimal host shell to send input to the black box and render the quads and audio commands that it outputs every frame. This minimalism meant it was manageable for me to create two hosts: one in Heaps and one in Unity.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-Engine.png" alt="Mobile-Engine"/></p><p>All perfectly clear</p>

<p>Haxe itself compiles almost instantly and is well-supported in Visual Studio Code so writing and debugging in Haxe/Heaps is quick and easy. For making releases, I transpile to C#, tab over to Unity, and build the project there.</p>
<h2 id="step-2-phoneterface">Step 2: Phoneterface</h2>
<p>Maintenance aside, the main thing holding me back from getting this game onto phones was its user interface. <em>Papers, Please</em> was always meant to be played on a large device. The actual resolution is laughably low (570x320) but these pixels need to be big.</p>
<p>The screen is divided into three always-visible regions:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-RegionsDesktop.png" alt="Checkpoint, Booth, and Desk"/></p><p>Checkpoint, Booth, and Desk</p>

<p>Back in 2014, I separated out a chunk of interface layout code from the core logic in order to create an iPad version of the game. With a few adjustments I was able to preserve the “three regions” layout and drag-n-drop gameplay. The biggest changes are that the regions are stacked vertically with slight dynamic sizing ability, and the checkpoint area shows a horizontally scrollable window instead of the whole thing at once.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-RegionsTablet.png" alt="iPad layout. Checkpoint doesn&amp;rsquo;t fit."/></p><p>iPad layout. Checkpoint requires scrolling.</p>

<p>James Gray built on this to create the Vita version, which needed even more layout changes but kept all the same gameplay. The small screen required overlapping the checkpoint area with the booth and fullscreen vertical scrolling but the Vita’s combination of physical and touch controls offset these compromises pretty well.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-RegionsVita.png" alt="Vita layout. Overlapped booth/checkpoint and fullscreen vertical scroll."/></p><p>Vita layout. Overlapped booth/checkpoint and fullscreen vertical scroll.</p>

<p>For phones I wanted something that felt natural to the device, which meant a few subjective things:</p>
<ol>
<li>Played in portrait mode.</li>
<li>All three regions visible at all times.</li>
<li>No squinting, zooming, or precision required to read/manipulate documents.</li>
</ol>
<p>Starting with the iPad layout and throwing together a quick mockup using the latest iPhone screen aspect:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MockupSmallFace.png" alt="Mobile-MockupSmallFace"/></p><p>Wrenched into an extreme 10:22 aspect ratio</p>

<p>I tried a few permutations of this, all alike. Converting 16:9 content to 10:22 involves a special kind of desperation. One variation that I didn’t hate had the face a bit bigger:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MockupBigFace.png" alt="Mobile-MockupBigFace"/></p><p>Bigface</p>

<p>Some conclusions after churning through a bunch of mockups:</p>
<ol>
<li>The border checkpoint view at the top will have to scroll left/right even more than the iPad version. Thankfully, the important stuff still fits without scrolling.</li>
<li>The documents are too small and the desk area too crowded. There’s a fundamental conflict between readability and having enough space for arranging things.</li>
<li>Love that big face.</li>
</ol>
<p>The jumbo face felt so nice that I concluded the documents should also be big, and that uncorked the brew that defines this port: no more desk, no more drag-n-drop. I swung all the way to readability and eliminated the arrangeability requirements completely:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-NoDesk.png" alt="Mobile-NoDesk"/></p><p>Goodbye drag, so long drop</p>

<p>The desk where documents were manipulated has been replaced by two separate elements: a <em>carousel</em> for closeup work and a <em>rack</em> for quick navigation.</p>
<h2 id="the-carousel-and-the-rack">The Carousel and the Rack</h2>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-RegionsPhone.png" alt="Mobile-RegionsPhone"/></p><p>The carousel extends offscreen on both sides</p>

<p>With the carousel, documents are displayed full-size in a long, horizontal, snap-scrolling list. The rack at the bottom shows a representation of all documents in smaller form. Navigation is done either by swiping the documents directly, or tapping/dragging anywhere in the rack.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-Navigation.gif" alt="Mobile-Navigation"/></p><p>Navigatin&#39;</p>

<p>My first worry when considering this interface was that it changed the gameplay too much. Instead of organizing documents on a 2D surface, you’re just swiping around and viewing each document in near-isolation. The banner task from the desktop game is totally missing now.</p>
<p>That’s a good clue to turn back but I knew this port would require some blood. After testing my first basic carousel implementation, the arterial spray I expected from losing document management turned out to be more of a minor abrasion.</p>
<p>In the end, I’m happy with the trade-offs. Swiping feels natural on the phone, and dealing with document inspection has its own rhythm – different from the desktop version but still fun. Instead of arranging the documents and darting your eyes around to correlate information, you manipulate the documents as a group and eye-dart a little less.</p>
<p>This carousel + rack represents the big sea-change adaptation for the phone port, and it had ripple effects throughout every single other element of the game’s main interface. I’ll go through the more interesting of these changes in exhausting animated-gif-supplemented detail below.</p>
<p>But first a word about the pixel grid.</p>
<h2 id="the-pixel-grid">The Pixel Grid</h2>
<p>In working on a pixel-art game, one decision every developer has to make is how honest they’ll be about their pixel grid. There’s usually no actual restriction that all your pixels need to be the same size and even Nintendo’s Mario Maker series aerial kicks pixel size consistency directly in the face.</p>
<p>Resolution-wise, the phone interface settled into 208x405 based on how the game’s existing documents would fit legibly onto a modern non-Max iPhone. Not a lot of pixels quite frankly, and man that checkpoint region at the top is bulky.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-GridCheckpointBig.png" alt="Mobile-GridCheckpointBig"/></p><p>Chunky checkpoint</p>

<p>I definitely prefer maintaining a single consistent pixel grid but we’ve all got our price. In this case, cheating to two pixel grids solved a lot of problems. With a base scale of 3x, the main booth and document regions can run at 3x while the checkpoint is a more manageable 2x.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-GridCheckpointSmall.png" alt="Mobile-GridCheckpointSmall"/></p><p>Checkpoint at 2x, everything else at 3x</p>

<p>In code, this is handled with fractional 2/3 pixel scaling on the 2x stuff, which multiplies out to integer coordinates in the final 3x buffer.</p>
<p>With the pixel grid sorted there’s still the problem of scaling the whole image onto a phone screen. Thankfully the effective resolution of the game is basically only 208x450 and phone screens – especially retina ones – are delirious with pixels. A combination of integer scaling and bilinear filtering doesn’t hurt so bad here. The phone version handles aspect adjustments within a certain range and then scales the result to fill the device’s screen.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-GridOnDevice.jpg" alt="Mobile-GridOnDevice"/></p><p>Final image integer + bilinear scaled up to fill the screen</p>

<p>On to some specifics of how the core interface changes played out.</p>
<h2 id="too-narrow-doesnt-fit">Too Narrow, Doesn’t Fit</h2>
<p>Several of the game’s single visual elements don’t fit in the base 208 pixel width. Instead of redrawing them, the extra 2/3 scale option made some fixes easy, as with the title screen:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-NoFitTitleIntro.png" alt="Mobile-NoFitTitleIntro"/></p><p>Using selective 2/3 scale on that big eagle there</p>

<p>The night screen was a little more complex. It’s got way too much business going on, coasting easily in the desktop’s ocean of 570x320 but requiring a completely new layout and conditional 2/3 scaling to fit in 208x450.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-NoFitNightDesktop.png" alt="Mobile-NoFitNightDesktop"/></p><p>Night screen&#39;s roomy desktop layout</p>

<p>
  <img src="https://3909.co/dev/pp/img/Mobile-NoFitNightPhone.png" alt="Mobile-NoFitNightPhone"/></p><p>Adjusted phone layout with 2/3 scaling to fit status icons, tokens, etc</p>

<p>The start-of-day newspaper was another big boy and needed both the 2/3 scale plus a narrower 3-column layout to replace the orignal 4-column layout:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-NoFitNews.png" alt="Mobile-NoFitNews"/></p><p>Changed layout and scale to fit newspaper</p>

<p>This “needs new background image” requirement for the newspaper segues to a core engine feature implemented for the port: load-time image transmogrification.</p>
<h2 id="image-transmogrification">Image Transmogrification</h2>
<p><em>Papers, Please</em> has a boatload of documents and images that contain text. A good share of these are generated outside the game and have to be localized for each supported language. There’s <a href="https://dukope.tumblr.com/post/83177288060/localizing-papers-please-papers-please-was">tools</a> to help with that but one of my goals for this port was to do as little localization work as possible.</p>
<p>Instead of generating new images just for the phone layout, the game has a “mogrification” step when loading image assets that makes edits procedurally based on which platform it’s running. This is handled at a pretty low level so the higher level game logic doesn’t need to worry about it.</p>
<p>One example is the newspaper background, which has the localized name baked into the image. The mogrification process loads both the desktop-formatted localized image and the phone-formatted unlocalized image, then copies a section from one to the other to get a phone-formatted, localized image.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MogrifyNews.png" alt="Mobile-MogrifyNews"/></p><p>Localizing the newspaper banner at load-time</p>

<p>Another case is the bulletin page with inspection correlation instructions. Here, the mogrifier combines the localized lower half of this desktop-specific bulletin page with the unlocalized phone-specific upper half to get a localized phone-specific bulletin.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MogrifyBulletin.png" alt="Mobile-MogrifyBulletin"/></p><p>This here plus that there</p>

<p>These load-time adjustments go beyond images and into some document layouts too. For example, the rulebook is the widest document in the game and it, horrifyingly, doesn’t fit in 208 pixels. It’s close but not quite, and there are important tabs and page-turn links on the edges that need to be comfortably onscreen.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MogrifyRulesBefore.png" alt="Mobile-MogrifyRulesBefore"/></p><p>Original rulebook, designed for landscape layout on desktops</p>

<p>I wanted to keep the entire booth/documents area in one pixel grid, so 2/3 scaling wasn’t an option here.</p>
<p>Load-time mogrification works a number on this to crop each page, move all the active links, and rotate/re-position the tabs to fit within the 208 pixel width.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-MogrifyRulesAfter.png" alt="Mobile-MogrifyRulesAfter"/></p><p>Mogrified rulebook for the phone portrait layout. RIP spiral.</p>

<h2 id="hand-over-your-documents">Hand Over Your Documents</h2>
<p>In the desktop build, each traveler drops their documents on the countertop after they enter the booth. Plain and simple.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-DocCountertop.gif" alt="Mobile-Mobile-DocCountertop"/></p><p>Countertop docs</p>

<p>Due to the lack of space, the phone layout doesn’t have a functional countertop. An obvious alternative would be to have the docs just drop all the way down to the rack at the bottom and appear in the carousel automatically.</p>
<p>That seemed a bit passive to me though, losing the initial <em>“ok fine I’ll take these”</em> activity from the original desktop version when you drag them from the counter to the desk for reading. The solution I came up with is to float the documents first, requiring a tap to get them onto the rack and into the carousel. The order they’re tapped determines their order in the list.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-GrabFloating.gif" alt="Mobile-GrabFloating"/></p><p>Floating docs</p>

<p>This design highlights something used throughout the phone version: overlapping elements. The main carousel is intended to feel like you’re holding documents up to scrutinize them, enhanced a bit by overlapping the traveler and booth console. To stay practical, it’s possible to pull the carousel down for a better look.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-Pulldown.gif" alt="Mobile-Pulldown"/>
</p>
<p>The original design of the booth was always pretty spacey but there are some distinct activity modes. For this port it was generally possible to optimize the use of space by masking/overlapping things that weren’t needed in one activity with something else needed right now.</p>
<h2 id="custom-ui-api-ok">Custom UI API OK</h2>
<p>A notable benefit of writing my own UI system for this was that I could do some very specific things with touch and pointer input. <em>Papers, Please</em> looks like a pretty simple 2D game at a glance but representing all the document and interface interactions through standard input event callbacks in the original Haxe/OpenFL required a lot of uncomfortable hacks. The new input system doesn’t use callbacks and is cleaner now, which let me implement all the overlapping and passthrough input logic in a more manageable way.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-UiCodeOld.png" alt="Mobile-UiCodeOld"/></p><p>Old event system, where input handling logic is spread around in various callback functions</p>

<p>
  <img src="https://3909.co/dev/pp/img/Mobile-UiCodeNew.png" alt="Mobile-UiCodeNew"/></p><p>New react() event system, more centralized and flexible</p>

<h2 id="stamping">Stamping</h2>
<p>The desktop version has a stamp bar that slides out from the right side and hangs over the desk. To stamp a passport you just align it under the stamp and click.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-StampDesktop.gif" alt="Mobile-StampDesktop"/></p><p>Original desktop stamp bar</p>

<p>I had some trouble redesigning this for the phone layout because (A) you can’t just drag the passport around to align it under the stamp, and (B) I didn’t want to give up the satisfaction of stamping on press/touch. Without this second requirement it’s simple to just make the stamp itself draggable, to be dropped on the passport where it automatically stamps. But then you’re stamping on release/un-touch, which never felt right to me. Some concepts I worked through:</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-StampConcepts.png" alt="Mobile-StampConcepts"/></p><p>Ceiling attachment, Split bar, Laser sensor</p>

<p>These all felt weird, confusing or just flat out didn’t work. There was something implicitly sensible with the desktop stamp bar that I wasn’t getting.</p>
<p>Ater some more experiments I decided to re-introduce the original setup, behind a modal switch. From the carousel, passports can isolate into a temporary stamp desk to be dragged around and stamped willy nilly.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-Stampdesk.gif" alt="Mobile-Stampdesk"/></p><p>Opening a temporary desk just for stamping</p>

<p>This temporary stamp desk is opened with a pull chain, which allows me to save some screen space and helpfully indicate its availability only when a stampable document is focused. Also it’s marginally fun to play with the chain.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-StampChain.gif" alt="Mobile-StampChain"/></p><p>Swinging chain</p>

<h2 id="key-desk-too-sure-why-not">Key Desk Too, Sure Why Not</h2>
<p>This same temporary-desk mechanic is used for the rifle and tranquilizer gun sequences. When a border attack is in progress, it quickly flips to the keys on an isolated desk. Dragging the keys and unlocking a gun works the same here as the desktop version.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-KeyDesk.png" alt="Mobile-KeyDesk"/></p><p>Temporary key desk for unlocking guns</p>

<h2 id="pincher">Pincher</h2>
<p>The need for a modal stamp/key desk was a gradual realization born from failed experimentation. In contrast, I knew from the start of this port that I’d need a way to let the player align certain documents on top of each other.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PincherNeed.png" alt="Mobile-PincherNeed"/></p><p>&#39;Puzzles&#39;</p>

<p>To replicate this functionality in the new carousel mobile design, I added an alligator-clip style pincher. Like with the stamp desk pullchain, this pincher appears only when certain documents are focused in the carousel.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PincherAppear.gif" alt="Mobile-PincherAppear"/></p><p>Alligator-clip pincher appearing near pinchable document, for pinching</p>

<p>Tapping the pincher will grab the document and hold it above and out of the carousel, where it can be dragged around separately. The carousel remains scrollable underneath so things can be lined up.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PincherAction.gif" alt="Mobile-PincherAction"/></p><p>Pincher action</p>

<p>None of this is explained in-game so let’s assume the concept and mechanics are self-evident.</p>
<h2 id="wanted-criminal-poster">Wanted: Criminal Poster</h2>
<p>One emergent play pattern in the desktop version is how to deal with the daily criminal bulletin.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-CriminalBulletin.png" alt="Mobile-CriminalBulletin"/></p><p>Detain these people</p>

<p>Any traveler matching a photo here needs to be interrogated, and the best way to keep this in mind while working is to tuck it off to the side of the desk and leave it there throughout the day.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-CriminalTucked.png" alt="Mobile-CriminalTucked"/></p><p>You look familiar</p>

<p>Since the freeform desk is gone in this new phone layout, it’s easy to swipe away from the bulletin and completely forget about the mugshots. This is a problem I didn’t catch until playing through the mostly-finished port, where I missed having a way to see those three faces at all times.</p>
<p>Space is so tight in the phone layout that there’s no perfect place to put them but I did find a little spot on the back wall where they can be hung up.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-CriminalPoster.png" alt="Mobile-CriminalPoster"/></p><p>Mugshots helpfully posted on the wall</p>

<p>To preserve some of the desktop version’s intent, this isn’t automatic. The player needs to tap a pin in the bulletin to post them on the wall at the start of each day.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-CriminalPin.gif" alt="Mobile-CriminalPin"/></p><p>Pinning from the bulletin to the wall</p>

<h2 id="action-buttons-dont-fit">Action Buttons Don’t Fit</h2>
<p>This could’ve gone under <strong>Doesn’t Fit</strong>. The desktop version’s FINGERPRINT, SEARCH, and DETAIN buttons don’t fit.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-DropButtonsNoFit.png" alt="Mobile-DropButtonsNoFit"/></p><p>Too wide to arrange these horizontally in 208px</p>

<p>This was painful. These buttons drop down after an interrogation, and their appearance is a noisy eye-catching signal that the player has some new actions available. It’s rare, but possible, that all three are available at the same time.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-DropButtonsFit.png" alt="Mobile-DropButtonsFit"/></p><p>Plenty of space over here</p>

<p>With basically no place to put them and not wanting to scale them down I decided they couldn’t go in the main booth interface. There’s now an extra slide-out panel to hold them.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-DropRemote.png" alt="Mobile-DropRemote"/></p><p>Panel of buttons. This is an older version -- I removed the icons and right-aligned everything at the last second.</p>

<p>The panel pops out automatically when a new action becomes available, closes when clicking anywhere outside, and shows a flashing lever when hidden.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-DropRemote.gif" alt="Mobile-DropRemote"/></p><p>Opening the panel with a flashing lever</p>

<p>These buttons are fully localized as images, so reusing the same buttons and just putting them in a pop-out saves a bunch of trouble with the localization process.</p>
<h2 id="enhanced-inspect-mode">Enhanced Inspect Mode</h2>
<p>The original game treats its discrepancy-highlighting inspect mode as a quick aside. First the player arranges documents to get a clear view, then finds a discrepancy, enables inspect mode, highlights the problem, and finally interrogates. While inspect mode is active, documents can’t be moved and pages can’t be turned – things have to be in order before inspecting.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-InspectDesktop.gif" alt="Mobile-InspectDesktop"/></p><p>Interrogating a discrepancy in the desktop version</p>

<p>This process is impossible if you can’t see all your documents at once, as in  the phone port. The fix was conceptually pretty simple but a fairly big technical pain in the ass: the carousel and page turn buttons are still active during inspect mode, and highlighted elements remain partially onscreen when their documents scroll away.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-InspectPhone.gif" alt="Mobile-InspectPhone"/></p><p>Inspect mode in the phone version</p>

<h2 id="polishing-tweaks">Polishing Tweaks</h2>
<p>With all of the game’s interactions there was plenty of room for small frustrations. I did my best to fix these whenever I found them. None are critical but half the battle is just recognizing there’s some friction that could use smoothing, so I enjoy these kinds of tweaks.</p>
<p><strong>Auto Sorting</strong></p>
<p>The three most important documents are the all-day ones: the bulletin, audio transcript, and rulebook. Because everything’s in a flat list now, it’s important to keep these three close to where each entrant’s new docs appear on the right. To do this, the game performs an instant re-sort when calling an entrant, without affecting the focused view.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PolishResort.gif" alt="Mobile-PolishResort"/></p><p>Instant auto-sorting to keep important docs on right side</p>

<p><strong>Post-Give Smart Shift</strong></p>
<p>Once a passport is stamped, the only thing left to do is give the entrant all their documents back. Giving a document back removes it from the carousel list, shifting the next document into view. My first implementation was the naive one: if document <strong>n</strong> disappears, shift to <strong>n-1</strong>. For a sequence of giving, this means it may shift to a document that’s not meant to be given back, requiring the player to manually swipe around. Not a huge deal but it’s a lot less annoying when the carousel intelligently shifts to the next givable one.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PolishGive.gif" alt="Mobile-PolishGive"/></p><p>Shifting to the next givable document</p>

<p><strong>Peeking</strong></p>
<p>While looking for correlations and discrepancies there’s a lot of flipping back and forth. With swiping this is straightforward but if you keep your finger held on the screen and just slide it left and right, the reach isn’t enough to actually see whole documents on either side. Not immediately obvious but measurably frustrating while playing. My fix was to implement a “peek” feature that snaps the adjacent document fully into view when sliding just a little bit.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PolishPeek.gif" alt="Mobile-PolishPeek"/></p><p>Peeking at adjacent documents</p>

<h2 id="auto-player-testing">Auto Player Testing</h2>
<p>The original desktop game has a debug “soak” test mode for stressing memory and gameplay logic. Basically, a process plays through the game by calling internal debug functions to load a day, stamp documents, shoot attackers, etc. This was useful for making sure there were no errant memory leaks or serious logic errors but because it called directly into high-level functions it wasn’t much use for testing the whole game and engine environment.</p>
<p>Having full control over the entire software stack for this port enabled me to enhance this system considerably. Instead of a memory soak test, it’s now a full automatic player that controls the game using the same input messages that a real player would.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-Autoplayer.gif" alt="Mobile-Autoplayer"/></p><p>Auto player in action, showing the route, day, traveler, time, memory, etc.</p>

<p>The auto player is scriptable and follows “routes” to:</p>
<ol>
<li>Play through to all 20 endings, starting from the title screen.</li>
<li>Earn all tokens.</li>
<li>Play a few minutes of each Endless style and course.</li>
<li>Seed each playthrough with a different random seed.</li>
</ol>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-AutoPlan.png" alt="Mobile-AutoPlan"/></p><p>Defining a route plan</p>

<p>And because the entire rewritten game+engine is modular, it’s possible to run this auto player as fast as possible, with or without visuals. On a modern iPhone rendering every 1,000th frame, a full sweep through all ~30 routes takes about 15 minutes.</p>
<p>Creating this system was at least a solid month of initial work and a good amount of maintenance throughout. Quite a long time honestly but developing and using it has helped me find and fix countless bugs in the game. Since I develop on a Mac using Haxe/Heaps and deploy in Haxe/Unity, it’s also an invaluable way to verify that Heaps and Unity give the same result, and that Mac/iOS/Android all behave correctly. Smaller unit testing can validate some of this but nothing beats full playthroughs.</p>
<h2 id="platforms-plural">Platforms, Plural</h2>
<p>There are now three core interface modes for the game: desktop, tablet, and phone. This port deals with just the mobile interfaces and supports phone and tablet layouts in the same app/binary.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PlatMockups.png" alt="Mobile-PlatMockups"/></p><p>Both mobile layouts</p>

<p>Since everything is in one binary, the game needs to know where it’s running in order to pick the right interface on startup. On iOS, this is easy as there’s an explicit check you can make for iPhone or iPad. On Android, surprisingly, there’s no clear delineation between phones and tablets and the game has to wing it based on resolution and DPI.</p>
<p>In the cases where it guesses wrong, there’s an added setting to explicitly choose which mode you want.</p>
<p>
  <img src="https://3909.co/dev/pp/img/Mobile-PlatChoose.png" alt="Mobile-PlatChoose"/></p><p>Some devices get to choose</p>

<p>The final breakdown looks something like this:</p>
<ul>
<li>iPhone: <strong>phone</strong> layout only.</li>
<li>iPad: default <strong>tablet</strong> layout, optional <strong>phone</strong> layout.</li>
<li>Android Device: Optional <strong>phone</strong> and <strong>tablet</strong> layouts, default best guess.</li>
</ul>
<h2 id="finally">Finally</h2>
<p>A proper mobile version of <em>Papers, Please</em> has been a long time coming. Since the desktop release 9 years ago I’d dismissed the idea that the game could even work on phones but I guess a switch must’ve flipped in my head last year.</p>
<p>From start to finish this port took around 8 months of work. That sounds like an eternity but I enjoyed most of it so won’t complain too loudly. The sharpest cut is that it’s kept me away from working on <a href="https://dukope.itch.io/mars-after-midnight/devlog/261758/mars-after-midnight">anything else</a>.</p>
<p>After putting out whatever fires light up after release I’ll take a short break and then get back to making new stuff. See you then.</p>

  
  </div>
</article>


    


  </div></div>
  </body>
</html>
