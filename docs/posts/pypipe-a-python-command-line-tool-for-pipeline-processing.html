<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/bugen/pypipe">Original</a>
    <h1>Show HN: Pypipe â€“ A Python command-line tool for pipeline processing</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<div dir="auto" data-snippet-clipboard-copy-content="$ echo &#34;pypipe&#34; | ppp &#34;line[::2]&#34;
ppp"><pre>$ <span>echo</span> <span><span>&#34;</span>pypipe<span>&#34;</span></span> <span>|</span> ppp <span><span>&#34;</span>line[::2]<span>&#34;</span></span>
ppp</pre></div>
<p dir="auto"><strong>pypipe</strong> is a Python command-line tool for pipeline processing.</p>
<h2 tabindex="-1" id="user-content-demo-" dir="auto"><a href="#demo-">Demo <svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://www.scattered-thoughts.net/bugen/pypipe/blob/main/docs/demo.svg"><img src="https://www.scattered-thoughts.net/bugen/pypipe/raw/main/docs/demo.svg" alt="Alt text"/></a></p>
<h2 tabindex="-1" id="user-content-quick-links-" dir="auto"><a href="#quick-links-">Quick links <svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<ul dir="auto">
<li><a href="#installation">Installation</a></li>
<li><a href="#basic-usage-and-examples">Basic usage and Examples</a></li>
<li><a href="#pypipe-is-a-code-generator">pypipe is a code generator.</a></li>
</ul>
<h2 tabindex="-1" id="user-content-installation" dir="auto"><a href="#installation">Installation<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">pypipe is a single Python file and uses only the standard library. You can use it by placing pypipe.py in a directory included in your PATH (e.g., ~/.local/bin). If execute permission is not already present, please add it.</p>

<p dir="auto">To make it easier to type, it&#39;s recommended to create a symbolic link.</p>

<p dir="auto"><span><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span></p>
<h2 tabindex="-1" id="user-content-basic-usage-and-examples" dir="auto"><a href="#basic-usage-and-examples">Basic usage and Examples<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<h3 tabindex="-1" id="user-content--ppp-line" dir="auto"><a href="#-ppp-line"><code>| ppp line</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Processing line by line. You can get the line string as <code>line</code> or <code>l</code> and the line number as <code>i</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.txt |ppp &#39;i, line.upper()&#39;
1       NAME    WEIGHT  BIRTH   AGE     SPECIES CLASS
2       SIMBA   250     1994-06-15      29      LION    MAMMAL
3       DUMBO   4000    1941-10-23      81      ELEPHANT        MAMMAL
4       GEORGE  20      1939-01-01      84      MONKEY  MAMMAL
5       POOH    1       1921-08-21      102     TEDDY BEAR      ARTIFACT
6       BOB     0       1999-05-01      24      SPONGE  DEMOSPONGE"><pre>$ cat staff.txt <span>|</span>ppp <span><span>&#39;</span>i, line.upper()<span>&#39;</span></span>
1       NAME    WEIGHT  BIRTH   AGE     SPECIES CLASS
2       SIMBA   250     1994-06-15      29      LION    MAMMAL
3       DUMBO   4000    1941-10-23      81      ELEPHANT        MAMMAL
4       GEORGE  20      1939-01-01      84      MONKEY  MAMMAL
5       POOH    1       1921-08-21      102     TEDDY BEAR      ARTIFACT
6       BOB     0       1999-05-01      24      SPONGE  DEMOSPONGE</pre></div>
<h3 tabindex="-1" id="user-content--ppp-rec" dir="auto"><a href="#-ppp-rec"><code>| ppp rec</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Split each line by TAB. You can get the list includes splitted strings as <code>rec</code> or <code>r</code> and the record number as <code>i</code>..</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat staff.txt |ppp rec &#39;r[:3]&#39;
Name    Weight  Birth
Simba   250     1994-06-15
Dumbo   4000    1941-10-23
George  20      1939-01-01
Pooh    1       1921-08-21
Bob     0       1999-05-01"><pre>cat staff.txt <span>|</span>ppp rec <span><span>&#39;</span>r[:3]<span>&#39;</span></span>
Name    Weight  Birth
Simba   250     1994-06-15
Dumbo   4000    1941-10-23
George  20      1939-01-01
Pooh    1       1921-08-21
Bob     0       1999-05-01</pre></div>
<p dir="auto">Using the <code>-l LENGTH, --length LENGTH</code> option allows you to get the values of each field as <code>f1, f2, f3, ....</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="$ tail -n +2 staff.txt |ppp rec -l5 &#39;f&#34;{f1} is {f4} years old&#34;&#39;
Simba is 29 years old
Dumbo is 81 years old
George is 84 years old
Pooh is 102 years old
Bob is 24 years old"><pre>$ tail -n +2 staff.txt <span>|</span>ppp rec -l5 <span><span>&#39;</span>f&#34;{f1} is {f4} years old&#34;<span>&#39;</span></span>
Simba is 29 years old
Dumbo is 81 years old
George is 84 years old
Pooh is 102 years old
Bob is 24 years old</pre></div>
<p dir="auto">When using the <code>-H, --header</code> option, it treats the first line as a header line and skips it. The header values can be obtained from a list named <code>header</code>, and you can access the values of each field using the format <code>dic[&#34;FIELD_NAME&#34;]</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.txt |ppp rec -H &#39;rec[0], dic[&#34;Birth&#34;]&#39;
Simba   1994-06-15
Dumbo   1941-10-23
George  1939-01-01
Pooh    1921-08-21
Bob     1999-05-01"><pre>$ cat staff.txt <span>|</span>ppp rec -H <span><span>&#39;</span>rec[0], dic[&#34;Birth&#34;]<span>&#39;</span></span>
Simba   1994-06-15
Dumbo   1941-10-23
George  1939-01-01
Pooh    1921-08-21
Bob     1999-05-01</pre></div>
<p dir="auto">You can change the delimiter by using the <code>-d DELIMITER, --delimiter DELIMITER</code> option.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.csv |ppp rec -d , -l6  f1
Name
Simba
Dumbo
George
Pooh
Bob"><pre>$ cat staff.csv <span>|</span>ppp rec -d , -l6  f1
Name
Simba
Dumbo
George
Pooh
Bob</pre></div>
<h3 tabindex="-1" id="user-content--ppp-csv" dir="auto"><a href="#-ppp-csv"><code>| ppp csv</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto"><code>csv</code> is similar to <code>rec</code>, but the difference is that while <code>rec</code> simply splits the line using the specified DELIMITER like this, <code>&#39;line.split(DELIMITER))&#39;</code>, <code>csv</code> uses the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow">csv</a> library for parsing. Furthermore, <code>rec</code> is tab-separated by default, whereas <code>csv</code> is comma-separated.</p>
<p dir="auto">You can specify options to pass to csv.reader and csv.writer using the <code>-O NAME=VALUE, --csv-opt NAME=VALUE</code> option.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.csv |ppp csv -O &#39;quoting=csv.QUOTE_ALL&#39;
&#34;Name&#34;,&#34;Weight&#34;,&#34;Birth&#34;,&#34;Age&#34;,&#34;Species&#34;,&#34;Class&#34;
&#34;Simba&#34;,&#34;250&#34;,&#34;1994-06-15&#34;,&#34;29&#34;,&#34;Lion&#34;,&#34;Mammal&#34;
&#34;Dumbo&#34;,&#34;4000&#34;,&#34;1941-10-23&#34;,&#34;81&#34;,&#34;Elephant&#34;,&#34;Mammal&#34;
&#34;George&#34;,&#34;20&#34;,&#34;1939-01-01&#34;,&#34;84&#34;,&#34;Monkey&#34;,&#34;Mammal&#34;
&#34;Pooh&#34;,&#34;1&#34;,&#34;1921-08-21&#34;,&#34;102&#34;,&#34;Teddy bear&#34;,&#34;Artifact&#34;
&#34;Bob&#34;,&#34;0&#34;,&#34;1999-05-01&#34;,&#34;24&#34;,&#34;Sponge&#34;,&#34;Demosponge&#34;"><pre>$ cat staff.csv <span>|</span>ppp csv -O <span><span>&#39;</span>quoting=csv.QUOTE_ALL<span>&#39;</span></span>
<span><span>&#34;</span>Name<span>&#34;</span></span>,<span><span>&#34;</span>Weight<span>&#34;</span></span>,<span><span>&#34;</span>Birth<span>&#34;</span></span>,<span><span>&#34;</span>Age<span>&#34;</span></span>,<span><span>&#34;</span>Species<span>&#34;</span></span>,<span><span>&#34;</span>Class<span>&#34;</span></span>
<span><span>&#34;</span>Simba<span>&#34;</span></span>,<span><span>&#34;</span>250<span>&#34;</span></span>,<span><span>&#34;</span>1994-06-15<span>&#34;</span></span>,<span><span>&#34;</span>29<span>&#34;</span></span>,<span><span>&#34;</span>Lion<span>&#34;</span></span>,<span><span>&#34;</span>Mammal<span>&#34;</span></span>
<span><span>&#34;</span>Dumbo<span>&#34;</span></span>,<span><span>&#34;</span>4000<span>&#34;</span></span>,<span><span>&#34;</span>1941-10-23<span>&#34;</span></span>,<span><span>&#34;</span>81<span>&#34;</span></span>,<span><span>&#34;</span>Elephant<span>&#34;</span></span>,<span><span>&#34;</span>Mammal<span>&#34;</span></span>
<span><span>&#34;</span>George<span>&#34;</span></span>,<span><span>&#34;</span>20<span>&#34;</span></span>,<span><span>&#34;</span>1939-01-01<span>&#34;</span></span>,<span><span>&#34;</span>84<span>&#34;</span></span>,<span><span>&#34;</span>Monkey<span>&#34;</span></span>,<span><span>&#34;</span>Mammal<span>&#34;</span></span>
<span><span>&#34;</span>Pooh<span>&#34;</span></span>,<span><span>&#34;</span>1<span>&#34;</span></span>,<span><span>&#34;</span>1921-08-21<span>&#34;</span></span>,<span><span>&#34;</span>102<span>&#34;</span></span>,<span><span>&#34;</span>Teddy bear<span>&#34;</span></span>,<span><span>&#34;</span>Artifact<span>&#34;</span></span>
<span><span>&#34;</span>Bob<span>&#34;</span></span>,<span><span>&#34;</span>0<span>&#34;</span></span>,<span><span>&#34;</span>1999-05-01<span>&#34;</span></span>,<span><span>&#34;</span>24<span>&#34;</span></span>,<span><span>&#34;</span>Sponge<span>&#34;</span></span>,<span><span>&#34;</span>Demosponge<span>&#34;</span></span></pre></div>
<h3 tabindex="-1" id="user-content--ppp-text" dir="auto"><a href="#-ppp-text"><code>| ppp text</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">In <code>ppp text</code>, the entire standard input is read as a single piece of text. You can access the read text as <code>text</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.txt | ppp text &#39;len(text)&#39;
231"><pre>$ cat staff.txt <span>|</span> ppp text <span><span>&#39;</span>len(text)<span>&#39;</span></span>
231</pre></div>
<p dir="auto">For example, <code>ppp text</code> is particularly useful when working with a indented JSON file. Using the <code>-j, --json</code> option allows you to decode the text into JSON. The decoded data can be obtained as a <code>dic</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.json |ppp text -j &#39;dic[&#34;data&#34;][0]&#39;
{&#39;Name&#39;: &#39;Simba&#39;, &#39;Weight&#39;: 250, &#39;Birth&#39;: &#39;1994-06-15&#39;, &#39;Age&#39;: 29, &#39;Species&#39;: &#39;Lion&#39;, &#39;Class&#39;: &#39;Mammal&#39;}"><pre>$ cat staff.json <span>|</span>ppp text -j <span><span>&#39;</span>dic[&#34;data&#34;][0]<span>&#39;</span></span>
{<span><span>&#39;</span>Name<span>&#39;</span></span>: <span><span>&#39;</span>Simba<span>&#39;</span></span>, <span><span>&#39;</span>Weight<span>&#39;</span></span>: 250, <span><span>&#39;</span>Birth<span>&#39;</span></span>: <span><span>&#39;</span>1994-06-15<span>&#39;</span></span>, <span><span>&#39;</span>Age<span>&#39;</span></span>: 29, <span><span>&#39;</span>Species<span>&#39;</span></span>: <span><span>&#39;</span>Lion<span>&#39;</span></span>, <span><span>&#39;</span>Class<span>&#39;</span></span>: <span><span>&#39;</span>Mammal<span>&#39;</span></span>}</pre></div>
<p dir="auto"><span><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span></p>
<h3 tabindex="-1" id="user-content--ppp-file" dir="auto"><a href="#-ppp-file"><code>| ppp file</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">In <code>ppp file</code>, it receives a list of file paths from standard input. It then opens each received file path, reads the contents of the file into <code>text</code>, and repeats this process for each received file path in a loop. The received paths can be obtained as <code>path</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ls staff.txt staff.csv staff.json staff.xml |ppp file &#39;path, len(text)&#39;
staff.csv       231
staff.json      1046
staff.txt       231
staff.xml       1042"><pre>$ ls staff.txt staff.csv staff.json staff.xml <span>|</span>ppp file <span><span>&#39;</span>path, len(text)<span>&#39;</span></span>
staff.csv       231
staff.json      1046
staff.txt       231
staff.xml       1042</pre></div>
<p dir="auto">For example, <code>ppp file</code> is usuful, especially when processing a large number of JSON files.</p>
<div dir="auto" data-snippet-clipboard-copy-content="find . -name &#39;*.json&#39;| ppp file --json ..."><pre>find <span>.</span> -name <span><span>&#39;</span>*.json<span>&#39;</span></span><span>|</span> ppp file --json ...</pre></div>
<h3 tabindex="-1" id="user-content--ppp-custom--n-name" dir="auto"><a href="#-ppp-custom--n-name"><code>| ppp custom -N NAME</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You can easily create custom commands using pypipe. First, you define custom commands. The definition file is, by default, located at <code>~/.config/pypipe/pypipe_custom.py</code>. You can change the path of this file using the <code>PYPIPE_CUSTOM</code> environment variable.</p>
<p dir="auto">The following is an example of defining custom commands xpath and sum.</p>
<p dir="auto">~/.config/pypipe/pypipe_custom.py</p>
<div dir="auto" data-snippet-clipboard-copy-content="TEMPLATE_XPATH = r&#34;&#34;&#34;
from lxml import etree
{imp}

def output(e):
    if isinstance(e, etree._Element):
        print(etree.tostring(e).decode().rstrip())
    else:
        _print(e)

{pre}

tree = etree.parse(sys.stdin)
for e in tree.xpath(&#39;{path}&#39;):
{loop_head}
{loop_filter}
{main}

{post}
&#34;&#34;&#34;

TEMPLATE_SUM = r&#34;&#34;&#34;
import re
import sys
{imp}

ptn = re.compile(r&#39;{pattern}&#39;)
s = 0

def add_or_print(*args):
    global s
    rec = args[0]
    if len(args) == 2:
        if isinstance(args[1], int):
            i = args[1]
            if len(rec) &gt;= i:
                s += rec[i-1]
        else:
            print(args[1])
    else:
        print(*args[1:])


for line in sys.stdin:
    line = line.rstrip(&#39;\r\n&#39;)
    rec = [{type}(e) for e in ptn.findall(line)]
    if not rec:
        continue
{loop_head}
{loop_filter}
{main}

print(s)
&#34;&#34;&#34;

custom_command = {
    &#34;xpath&#34;: {
        &#34;template&#34;: TEMPLATE_XPATH,
        &#34;code_indent&#34;: 1,
        &#34;default_code&#34;: &#34;e&#34;,
        &#34;wrapper&#34;: &#39;output({})&#39;,
        &#34;options&#34;: {
            &#34;path&#34;: {&#34;default&#34;: &#39;/&#39;}
        }
    },
    &#34;sum&#34;: {
        &#34;template&#34;: TEMPLATE_SUM,
        &#34;code_indent&#34;: 1,
        &#34;default_code&#34;: &#34;1&#34;,
        &#34;wrapper&#34;: &#39;add_or_print(rec, {})&#39;,
        &#34;options&#34;: {
            &#34;pattern&#34;: {&#34;default&#34;: r&#39;\d+&#39;},
            &#34;type&#34;: {&#34;default&#34;: &#39;int&#39;}
        }
    },
}"><pre><span>TEMPLATE_XPATH</span> <span>=</span> <span>r&#34;&#34;&#34;</span>
<span>from lxml import etree</span>
<span>{imp}</span>
<span></span>
<span>def output(e):</span>
<span>    if isinstance(e, etree._Element):</span>
<span>        print(etree.tostring(e).decode().rstrip())</span>
<span>    else:</span>
<span>        _print(e)</span>
<span></span>
<span>{pre}</span>
<span></span>
<span>tree = etree.parse(sys.stdin)</span>
<span>for e in tree.xpath(&#39;{path}&#39;):</span>
<span>{loop_head}</span>
<span>{loop_filter}</span>
<span>{main}</span>
<span></span>
<span>{post}</span>
<span>&#34;&#34;&#34;</span>

<span>TEMPLATE_SUM</span> <span>=</span> <span>r&#34;&#34;&#34;</span>
<span>import re</span>
<span>import sys</span>
<span>{imp}</span>
<span></span>
<span>ptn = re.compile(r&#39;{pattern}&#39;)</span>
<span>s = 0</span>
<span></span>
<span>def add_or_print(*args):</span>
<span>    global s</span>
<span>    rec = args[0]</span>
<span>    if len(args) == 2:</span>
<span>        if isinstance(args[1], int):</span>
<span>            i = args[1]</span>
<span>            if len(rec) &gt;= i:</span>
<span>                s += rec[i-1]</span>
<span>        else:</span>
<span>            print(args[1])</span>
<span>    else:</span>
<span>        print(*args[1:])</span>
<span></span>
<span></span>
<span>for line in sys.stdin:</span>
<span>    line = line.rstrip(&#39;\r\n&#39;)</span>
<span>    rec = [{type}(e) for e in ptn.findall(line)]</span>
<span>    if not rec:</span>
<span>        continue</span>
<span>{loop_head}</span>
<span>{loop_filter}</span>
<span>{main}</span>
<span></span>
<span>print(s)</span>
<span>&#34;&#34;&#34;</span>

<span>custom_command</span> <span>=</span> {
    <span>&#34;xpath&#34;</span>: {
        <span>&#34;template&#34;</span>: <span>TEMPLATE_XPATH</span>,
        <span>&#34;code_indent&#34;</span>: <span>1</span>,
        <span>&#34;default_code&#34;</span>: <span>&#34;e&#34;</span>,
        <span>&#34;wrapper&#34;</span>: <span>&#39;output({})&#39;</span>,
        <span>&#34;options&#34;</span>: {
            <span>&#34;path&#34;</span>: {<span>&#34;default&#34;</span>: <span>&#39;/&#39;</span>}
        }
    },
    <span>&#34;sum&#34;</span>: {
        <span>&#34;template&#34;</span>: <span>TEMPLATE_SUM</span>,
        <span>&#34;code_indent&#34;</span>: <span>1</span>,
        <span>&#34;default_code&#34;</span>: <span>&#34;1&#34;</span>,
        <span>&#34;wrapper&#34;</span>: <span>&#39;add_or_print(rec, {})&#39;</span>,
        <span>&#34;options&#34;</span>: {
            <span>&#34;pattern&#34;</span>: {<span>&#34;default&#34;</span>: <span>r&#39;\d+&#39;</span>},
            <span>&#34;type&#34;</span>: {<span>&#34;default&#34;</span>: <span>&#39;int&#39;</span>}
        }
    },
}</pre></div>
<p dir="auto">You can use them as follows:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat staff.xml |ppp custom -N xpath -O path=&#39;./Animal/Age&#39;
&lt;Age&gt;29&lt;/Age&gt;
&lt;Age&gt;81&lt;/Age&gt;
&lt;Age&gt;84&lt;/Age&gt;
&lt;Age&gt;102&lt;/Age&gt;
&lt;Age&gt;24&lt;/Age&gt;"><pre>$ cat staff.xml <span>|</span>ppp custom -N xpath -O path=<span><span>&#39;</span>./Animal/Age<span>&#39;</span></span>
<span>&lt;</span>Age<span>&gt;</span>2<span>9&lt;</span>/Age<span>&gt;</span>
<span>&lt;</span>Age<span>&gt;</span>8<span>1&lt;</span>/Age<span>&gt;</span>
<span>&lt;</span>Age<span>&gt;</span>8<span>4&lt;</span>/Age<span>&gt;</span>
<span>&lt;</span>Age<span>&gt;</span>1<span>02&lt;</span>/Age<span>&gt;</span>
<span>&lt;</span>Age<span>&gt;</span>2<span>4&lt;</span>/Age<span>&gt;</span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="$ seq 10000| ppp c -Nsum -f &#39;rec[0] % 3 == 0&#39;
16668333"><pre>$ seq 10000<span>|</span> ppp c -Nsum -f <span><span>&#39;</span>rec[0] % 3 == 0<span>&#39;</span></span>
16668333</pre></div>
<h3 tabindex="-1" id="user-content--c---counter" dir="auto"><a href="#-c---counter"><code>-c, --counter</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Using the <code>-c, --counter</code> option allows for easy data aggregation. When you specify the <code>-c, --counter</code> option, it creates an instance of collections.Counter, which can be accessed as either <code>counter</code> or <code>c</code>. The <code>-c, --counter</code> option is available for use in all commands.</p>
<p dir="auto">An example of aggregating data by the &#39;Gender&#39; and &#39;Hobby&#39; fields.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat people.csv |ppp csv -H --counter &#39;dic[&#34;Gender&#34;], dic[&#34;Hobby&#34;]&#39;| head -n10
Female  Cooking 4
Male    Hiking  3
Female  Reading 3
Male    Gardening       3
Female  Traveling       3
Male    Playing Music   3
Female  Dancing 3
Female  Hiking  3
Female  Painting        2
Male    Photography     2"><pre>$ cat people.csv <span>|</span>ppp csv -H --counter <span><span>&#39;</span>dic[&#34;Gender&#34;], dic[&#34;Hobby&#34;]<span>&#39;</span></span><span>|</span> head -n10
Female  Cooking 4
Male    Hiking  3
Female  Reading 3
Male    Gardening       3
Female  Traveling       3
Male    Playing Music   3
Female  Dancing 3
Female  Hiking  3
Female  Painting        2
Male    Photography     2</pre></div>
<p dir="auto">This is an example to aggregate data based on whether female individuals are 30 years or older.</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat people.csv |ppp csv -H -c -f &#39;dic[&#34;Gender&#34;] == &#34;Female&#34;&#39; &#39;int(dic[&#34;Age&#34;]) &gt;= 30&#39;
False   16
True    10"><pre>cat people.csv <span>|</span>ppp csv -H -c -f <span><span>&#39;</span>dic[&#34;Gender&#34;] == &#34;Female&#34;<span>&#39;</span></span> <span><span>&#39;</span>int(dic[&#34;Age&#34;]) &gt;= 30<span>&#39;</span></span>
False   16
True    10</pre></div>
<p dir="auto">When using the <code>-c, --counter</code> option, it uses <code>counter[{}] += 1</code> as the wrapper. If you want to count in a different way, you can disable the wrapping by using the <code>-n, --no-wrapping</code> option and add your own counting code.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat population.csv |ppp csv -H -c -n &#39;counter[dic[&#34;State&#34;]] += int(dic[&#34;Population&#34;])&#39;
New York        8398748
Texas   7751480
California      7327731
Illinois        2705994
Arizona 1680992
Pennsylvania    1584138
Florida 903889
Ohio    892533
Indiana 876862
North Carolina  792862
Washington      753675
Michigan        673104"><pre>$ cat population.csv <span>|</span>ppp csv -H -c -n <span><span>&#39;</span>counter[dic[&#34;State&#34;]] += int(dic[&#34;Population&#34;])<span>&#39;</span></span>
New York        8398748
Texas   7751480
California      7327731
Illinois        2705994
Arizona 1680992
Pennsylvania    1584138
Florida 903889
Ohio    892533
Indiana 876862
North Carolina  792862
Washington      753675
Michigan        673104</pre></div>
<p dir="auto">Information about <a href="#code-wrappping">Code wrapping</a>.</p>
<h2 tabindex="-1" id="user-content-pypipe-is-a-code-generator" dir="auto"><a href="#pypipe-is-a-code-generator">pypipe is a code generator.<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">pypipe is a command-line tool for pipeline processing, but it can also be thought of as a code generator. It generates code internally using the given arguments and then executes the generated code using the <code>exec</code> function. Therefore, instead of executing the generated code, you have the option to print it to the standard output or save it to a file.</p>
<h3 tabindex="-1" id="user-content-print-generated-code--p---print" dir="auto"><a href="#print-generated-code--p---print">Print generated code. <code>-p, --print</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">To check the generated code, you can use the <code>-p, --print</code> option.</p>
<div dir="auto" data-snippet-clipboard-copy-content="ppp file -m rb -i hashlib -b &#39;total = 0&#39; -b &#39;_p(&#34;PATH&#34;, &#34;SIZE&#34;, &#34;MD5&#34;)&#39; -e &#39;size = len(text)&#39; -f &#39;path.stem == &#34;staff&#34;&#39; &#39;total += size&#39; &#39;path, size, hashlib.md5(text).hexdigest()&#39; -a &#39;print(f&#34;Total size: {total}&#34;, file=sys.stderr)&#39; -p"><pre>ppp file -m rb -i hashlib -b <span><span>&#39;</span>total = 0<span>&#39;</span></span> -b <span><span>&#39;</span>_p(&#34;PATH&#34;, &#34;SIZE&#34;, &#34;MD5&#34;)<span>&#39;</span></span> -e <span><span>&#39;</span>size = len(text)<span>&#39;</span></span> -f <span><span>&#39;</span>path.stem == &#34;staff&#34;<span>&#39;</span></span> <span><span>&#39;</span>total += size<span>&#39;</span></span> <span><span>&#39;</span>path, size, hashlib.md5(text).hexdigest()<span>&#39;</span></span> -a <span><span>&#39;</span>print(f&#34;Total size: {total}&#34;, file=sys.stderr)<span>&#39;</span></span> -p</pre></div>
<p dir="auto">The generated code is output as follows.</p>
<div dir="auto" data-snippet-clipboard-copy-content="# IMPORT
import sys
from functools import partial
import gzip
from pathlib import Path
import hashlib

def _open(path):
    if path.suffix == &#39;.gz&#39;:
        return gzip.open(path, &#39;rb&#39;)
    else:
        return open(path, &#39;rb&#39;)

# PRE
_p = partial(print, sep=&#34;\t&#34;)  # ABBREV
I, S, B, L, D, SET = 0, &#34;&#34;, False, [], {}, set()  # ABBREV

def _print(*args, delimiter=&#39;\t&#39;):
    if len(args) == 1 and isinstance(args[0], (list, tuple)):
        print(*args[0], sep=delimiter)
    else:
        print(*args, sep=delimiter)

total = 0
_p(&#34;PATH&#34;, &#34;SIZE&#34;, &#34;MD5&#34;)

for i, line in enumerate(sys.stdin, 1):
    path = Path(line.rstrip(&#39;\r\n&#39;))
    with _open(path) as file:
        text = file.read()
        # LOOP HEAD
        size = len(text)
        # LOOP FILTER
        if not (path.stem == &#34;staff&#34;): continue
        # MAIN
        total += size
        _print(path, size, hashlib.md5(text).hexdigest())

# POST
print(f&#34;Total size: {total}&#34;, file=sys.stderr)"><pre><span># IMPORT</span>
<span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>
<span>import</span> <span>gzip</span>
<span>from</span> <span>pathlib</span> <span>import</span> <span>Path</span>
<span>import</span> <span>hashlib</span>

<span>def</span> <span>_open</span>(<span>path</span>):
    <span>if</span> <span>path</span>.<span>suffix</span> <span>==</span> <span>&#39;.gz&#39;</span>:
        <span>return</span> <span>gzip</span>.<span>open</span>(<span>path</span>, <span>&#39;rb&#39;</span>)
    <span>else</span>:
        <span>return</span> <span>open</span>(<span>path</span>, <span>&#39;rb&#39;</span>)

<span># PRE</span>
<span>_p</span> <span>=</span> <span>partial</span>(<span>print</span>, <span>sep</span><span>=</span><span>&#34;<span>\t</span>&#34;</span>)  <span># ABBREV</span>
<span>I</span>, <span>S</span>, <span>B</span>, <span>L</span>, <span>D</span>, <span>SET</span> <span>=</span> <span>0</span>, <span>&#34;&#34;</span>, <span>False</span>, [], {}, <span>set</span>()  <span># ABBREV</span>

<span>def</span> <span>_print</span>(<span>*</span><span>args</span>, <span>delimiter</span><span>=</span><span>&#39;<span>\t</span>&#39;</span>):
    <span>if</span> <span>len</span>(<span>args</span>) <span>==</span> <span>1</span> <span>and</span> <span>isinstance</span>(<span>args</span>[<span>0</span>], (<span>list</span>, <span>tuple</span>)):
        <span>print</span>(<span>*</span><span>args</span>[<span>0</span>], <span>sep</span><span>=</span><span>delimiter</span>)
    <span>else</span>:
        <span>print</span>(<span>*</span><span>args</span>, <span>sep</span><span>=</span><span>delimiter</span>)

<span>total</span> <span>=</span> <span>0</span>
<span>_p</span>(<span>&#34;PATH&#34;</span>, <span>&#34;SIZE&#34;</span>, <span>&#34;MD5&#34;</span>)

<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>path</span> <span>=</span> <span>Path</span>(<span>line</span>.<span>rstrip</span>(<span>&#39;<span>\r</span><span>\n</span>&#39;</span>))
    <span>with</span> <span>_open</span>(<span>path</span>) <span>as</span> <span>file</span>:
        <span>text</span> <span>=</span> <span>file</span>.<span>read</span>()
        <span># LOOP HEAD</span>
        <span>size</span> <span>=</span> <span>len</span>(<span>text</span>)
        <span># LOOP FILTER</span>
        <span>if</span> <span>not</span> (<span>path</span>.<span>stem</span> <span>==</span> <span>&#34;staff&#34;</span>): <span>continue</span>
        <span># MAIN</span>
        <span>total</span> <span>+=</span> <span>size</span>
        <span>_print</span>(<span>path</span>, <span>size</span>, <span>hashlib</span>.<span>md5</span>(<span>text</span>).<span>hexdigest</span>())

<span># POST</span>
<span>print</span>(<span>f&#34;Total size: <span><span>{</span><span>total</span><span>}</span></span>&#34;</span>, <span>file</span><span>=</span><span>sys</span>.<span>stderr</span>)</pre></div>
<p dir="auto">Check that there are no issues with the generated code and execute it.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ find . -type f |ppp file -m rb -i hashlib -b &#39;total = 0&#39; -b &#39;_p(&#34;PATH&#34;, &#34;SIZE&#34;, &#34;MD5&#34;)&#39; -e &#39;size = len(text)&#39; -f &#39;path.stem == &#34;staff&#34;&#39; &#39;total += size&#39; &#39;path, size, hashlib.md5(text).hexdigest()&#39; -a &#39;print(f&#34;Total size: {total}&#34;, file=sys.stderr)&#39;
PATH    SIZE    MD5
my_zoo.csv      186     e091408cc9174f1da86b50ee8e2fba96
my_zoo.xml      888     9edd78d97e45eccbac2b80747bd9c70b
my_zoo.json     887     7f15b3b8a23b91b60184113a38fa3e19
my_zoo.txt      186     4581c312d81815c3662f785ba9e7bd50
Total size: 2147"><pre>$ find <span>.</span> -type f <span>|</span>ppp file -m rb -i hashlib -b <span><span>&#39;</span>total = 0<span>&#39;</span></span> -b <span><span>&#39;</span>_p(&#34;PATH&#34;, &#34;SIZE&#34;, &#34;MD5&#34;)<span>&#39;</span></span> -e <span><span>&#39;</span>size = len(text)<span>&#39;</span></span> -f <span><span>&#39;</span>path.stem == &#34;staff&#34;<span>&#39;</span></span> <span><span>&#39;</span>total += size<span>&#39;</span></span> <span><span>&#39;</span>path, size, hashlib.md5(text).hexdigest()<span>&#39;</span></span> -a <span><span>&#39;</span>print(f&#34;Total size: {total}&#34;, file=sys.stderr)<span>&#39;</span></span>
PATH    SIZE    MD5
my_zoo.csv      186     e091408cc9174f1da86b50ee8e2fba96
my_zoo.xml      888     9edd78d97e45eccbac2b80747bd9c70b
my_zoo.json     887     7f15b3b8a23b91b60184113a38fa3e19
my_zoo.txt      186     4581c312d81815c3662f785ba9e7bd50
Total size: 2147</pre></div>
<h3 tabindex="-1" id="user-content-save-generated-code-to-a-file--o-path---output-path" dir="auto"><a href="#save-generated-code-to-a-file--o-path---output-path">Save generated code to a file. <code>-o PATH, --output PATH</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">For writing more complex code, it&#39;s a good practice to create a template code with pypipe and edit the templated code manually. Here&#39;s the process you can follow:</p>
<ol dir="auto">
<li>Create a template code with pypipe and save it to a file, for example:
<div dir="auto" data-snippet-clipboard-copy-content="ppp line --output /tmp/pipe.py ..."><pre>ppp line --output /tmp/pipe.py ...</pre></div>
</li>
<li>Edit the code in /tmp/pipe.py to suit your needs.</li>
<li>Execute the modified code by piping input to it, for example:
<div dir="auto" data-snippet-clipboard-copy-content="cat sample.txt | /tmp/pipe.py"><pre>cat sample.txt <span>|</span> /tmp/pipe.py</pre></div>
</li>
</ol>
<h3 tabindex="-1" id="user-content-main-codes" dir="auto"><a href="#main-codes">Main codes<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The main code is specified as positional arguments. You can specify multiple main codes. The placement of the main code varies depending on the command. In commands like <code>line</code>, <code>rec</code>, <code>csv</code>, and <code>file</code>, the main code is added within the loop processing with proper indentation. However, in the <code>text</code> command, where there is no loop processing, the main code is added without indentation.
In the <code>custom</code> command, the main code is added according to the definitions provided in the <code>pypipe_custom.py</code> file.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp text -pqrn &#34;for word in text.split():&#34;  &#34;    print(word)&#34;"><pre>$ ppp text -pqrn <span><span>&#34;</span>for word in text.split():<span>&#34;</span></span>  <span><span>&#34;</span>    print(word)<span>&#34;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial

text = sys.stdin.read()
for word in text.split():  # &lt;- HERE
    print(word)            # &lt;- HERE"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>

<span>text</span> <span>=</span> <span>sys</span>.<span>stdin</span>.<span>read</span>()
<span>for</span> <span>word</span> <span>in</span> <span>text</span>.<span>split</span>():  <span># &lt;- HERE</span>
    <span>print</span>(<span>word</span>)            <span># &lt;- HERE</span></pre></div>
<p dir="auto">You can also write it with line breaks in the terminal as follows:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp text -pqrn &#39;
&gt; for word in text.split():
&gt;     print(word)
&gt; &#39;"><pre>$ ppp text -pqrn <span><span>&#39;</span></span>
<span>&gt; for word in text.split():</span>
<span>&gt;     print(word)</span>
<span>&gt; <span>&#39;</span></span></pre></div>
<h3 tabindex="-1" id="user-content-default-main-code" dir="auto"><a href="#default-main-code">Default main code<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">If no main code is specified in the arguments, pypipe adds a predefined default code. For example, the default code in Line mode is <code>&#39;line&#39;</code>.</p>

<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial


def _print(*args, delimiter=&#39;\t&#39;):
    if len(args) == 1 and isinstance(args[0], (list, tuple)):
        print(*args[0], sep=delimiter)
    else:
        print(*args, sep=delimiter)


for i, line in enumerate(sys.stdin, 1):
    line = line.rstrip(&#34;\r\n&#34;)
    _print(line)  # Default code with wrappping."><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>


<span>def</span> <span>_print</span>(<span>*</span><span>args</span>, <span>delimiter</span><span>=</span><span>&#39;<span>\t</span>&#39;</span>):
    <span>if</span> <span>len</span>(<span>args</span>) <span>==</span> <span>1</span> <span>and</span> <span>isinstance</span>(<span>args</span>[<span>0</span>], (<span>list</span>, <span>tuple</span>)):
        <span>print</span>(<span>*</span><span>args</span>[<span>0</span>], <span>sep</span><span>=</span><span>delimiter</span>)
    <span>else</span>:
        <span>print</span>(<span>*</span><span>args</span>, <span>sep</span><span>=</span><span>delimiter</span>)


<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>line</span> <span>=</span> <span>line</span>.<span>rstrip</span>(<span>&#34;<span>\r</span><span>\n</span>&#34;</span>)
    <span>_print</span>(<span>line</span>)  <span># Default code with wrappping.</span></pre></div>
<h3 tabindex="-1" id="user-content-code-wrappping" dir="auto"><a href="#code-wrappping">Code wrappping<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">By default, pypipe wraps the last code specified in the arguments with a predefined wrapper. For example, in <code>ppp line</code>, it uses <code>&#39;_print({})&#39;</code> as the wrapper. However, if the <code>-c, --counter</code> option is specified, it uses <code>&#39;counter[{}] += 1&#39;</code> as the wrapper instead.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp line &#39;year = int(line)&#39; year -pqr"><pre>$ ppp line <span><span>&#39;</span>year = int(line)<span>&#39;</span></span> year -pqr</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial


def _print(*args, delimiter=&#39;\t&#39;):
    if len(args) == 1 and isinstance(args[0], (list, tuple)):
        print(*args[0], sep=delimiter)
    else:
        print(*args, sep=delimiter)


for i, line in enumerate(sys.stdin, 1):
    line = line.rstrip(&#34;\r\n&#34;)
    year = int(line)
    _print(year)  # Wrapping"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>


<span>def</span> <span>_print</span>(<span>*</span><span>args</span>, <span>delimiter</span><span>=</span><span>&#39;<span>\t</span>&#39;</span>):
    <span>if</span> <span>len</span>(<span>args</span>) <span>==</span> <span>1</span> <span>and</span> <span>isinstance</span>(<span>args</span>[<span>0</span>], (<span>list</span>, <span>tuple</span>)):
        <span>print</span>(<span>*</span><span>args</span>[<span>0</span>], <span>sep</span><span>=</span><span>delimiter</span>)
    <span>else</span>:
        <span>print</span>(<span>*</span><span>args</span>, <span>sep</span><span>=</span><span>delimiter</span>)


<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>line</span> <span>=</span> <span>line</span>.<span>rstrip</span>(<span>&#34;<span>\r</span><span>\n</span>&#34;</span>)
    <span>year</span> <span>=</span> <span>int</span>(<span>line</span>)
    <span>_print</span>(<span>year</span>)  <span># Wrapping</span></pre></div>
<h4 tabindex="-1" id="user-content-disable-code-wrappping--n---no-wrapping" dir="auto"><a href="#disable-code-wrappping--n---no-wrapping">Disable code wrappping. <code>-n, --no-wrapping</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h4>
<p dir="auto">If you want to disable the wrapping of the last code specified in the arguments by a predefined wrapper, you can use the <code>-n, --no-wrapping</code> option.</p>
<div dir="auto" data-snippet-clipboard-copy-content="ppp line -n &#39;n = max(len(line), n)&#39; -a &#39;print(n)&#39; -pqr"><pre>ppp line -n <span><span>&#39;</span>n = max(len(line), n)<span>&#39;</span></span> -a <span><span>&#39;</span>print(n)<span>&#39;</span></span> -pqr</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial


for i, line in enumerate(sys.stdin, 1):
    line = line.rstrip(&#34;\r\n&#34;)
    n = max(len(line), n)  # No wrapping

print(n)"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>


<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>line</span> <span>=</span> <span>line</span>.<span>rstrip</span>(<span>&#34;<span>\r</span><span>\n</span>&#34;</span>)
    <span>n</span> <span>=</span> <span>max</span>(<span>len</span>(<span>line</span>), <span>n</span>)  <span># No wrapping</span>

<span>print</span>(<span>n</span>)</pre></div>
<h3 tabindex="-1" id="user-content-pre-and-post-codes--b-code---pre-code---a-code---post-code" dir="auto"><a href="#pre-and-post-codes--b-code---pre-code---a-code---post-code">Pre and Post codes. <code>-b CODE, --pre CODE</code>,  <code>-a CODE, --post CODE</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The code specified with <code>-b CODE, --pre CODE</code> will be added before the loop processing or the main code. This can be useful for declaring variables or performing any necessary setup before entering a loop or executing the main code. The code specified with <code>-a CODE, --post CODE</code> will be added after the loop processing or the main code. This can be useful for displaying aggregated results or performing any additional actions after the loop or main code execution.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp rec --pqrn -b &#39;TOTAL = 0&#39; -b &#39;MAX = 0&#39;  &#39;TOTAL += int(rec[0])&#39; &#39;MAX = max(MAX, int(rec[0]))&#39;  -a &#39;print(f&#34;TOTAL: {TOTAL}&#34;)&#39; -a &#39;print(f&#34;MAX: {MAX}&#34;)&#39;"><pre>$ ppp rec --pqrn -b <span><span>&#39;</span>TOTAL = 0<span>&#39;</span></span> -b <span><span>&#39;</span>MAX = 0<span>&#39;</span></span>  <span><span>&#39;</span>TOTAL += int(rec[0])<span>&#39;</span></span> <span><span>&#39;</span>MAX = max(MAX, int(rec[0]))<span>&#39;</span></span>  -a <span><span>&#39;</span>print(f&#34;TOTAL: {TOTAL}&#34;)<span>&#39;</span></span> -a <span><span>&#39;</span>print(f&#34;MAX: {MAX}&#34;)<span>&#39;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial


TOTAL = 0   # PRE
MAX = 0     # PRE

for i, line in enumerate(sys.stdin, 1):
    line = line.rstrip(&#34;\r\n&#34;)
    rec = line.split(&#39;\t&#39;)
    TOTAL += int(rec[0])
    MAX = max(MAX, int(rec[0]))

print(f&#34;TOTAL: {TOTAL}&#34;)  # POST
print(f&#34;MAX: {MAX}&#34;)      # POST"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>


<span>TOTAL</span> <span>=</span> <span>0</span>   <span># PRE</span>
<span>MAX</span> <span>=</span> <span>0</span>     <span># PRE</span>

<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>line</span> <span>=</span> <span>line</span>.<span>rstrip</span>(<span>&#34;<span>\r</span><span>\n</span>&#34;</span>)
    <span>rec</span> <span>=</span> <span>line</span>.<span>split</span>(<span>&#39;<span>\t</span>&#39;</span>)
    <span>TOTAL</span> <span>+=</span> <span>int</span>(<span>rec</span>[<span>0</span>])
    <span>MAX</span> <span>=</span> <span>max</span>(<span>MAX</span>, <span>int</span>(<span>rec</span>[<span>0</span>]))

<span>print</span>(<span>f&#34;TOTAL: <span><span>{</span><span>TOTAL</span><span>}</span></span>&#34;</span>)  <span># POST</span>
<span>print</span>(<span>f&#34;MAX: <span><span>{</span><span>MAX</span><span>}</span></span>&#34;</span>)      <span># POST</span></pre></div>
<h3 tabindex="-1" id="user-content-inner-loop--e-code---loop-head-code--f-code---filter-code" dir="auto"><a href="#inner-loop--e-code---loop-head-code--f-code---filter-code">Inner loop. <code>-e CODE, --loop-head CODE</code>, <code>-f CODE, --filter CODE</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">In the loop processing of <code>line</code>, <code>rec</code>, <code>csv</code>, and <code>file</code> commands, the code is added in the following positions:</p>
<div data-snippet-clipboard-copy-content="for ... :
    {loop_head}  # Added with the -e CODE, --loop-head CODE option.
    {filter}     # Added with the -f CODE, --filter CODE option.
    {main}       # The main code is added here."><pre><code>for ... :
    {loop_head}  # Added with the -e CODE, --loop-head CODE option.
    {filter}     # Added with the -f CODE, --filter CODE option.
    {main}       # The main code is added here.
</code></pre></div>
<p dir="auto">&#34;loop_head&#34; is added using the <code>-e CODE, --loop-head CODE</code> option, while &#34;filter&#34; is added using the <code>-f CODE, --filter CODE</code> option.
Please note that the &#34;loop_head&#34; code is added as-is, while the &#34;loop_filter&#34; is wrapped with <code>if not ({}): continue</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp line -pqrn -e &#39;line = line.replace(&#34;foo&#34;, &#34;bar&#34;)&#39; -e &#39;line = line.upper()&#39; -f &#39;&#34;BAR&#34; in line&#39; &#39;print(line)&#39;"><pre>$ ppp line -pqrn -e <span><span>&#39;</span>line = line.replace(&#34;foo&#34;, &#34;bar&#34;)<span>&#39;</span></span> -e <span><span>&#39;</span>line = line.upper()<span>&#39;</span></span> -f <span><span>&#39;</span>&#34;BAR&#34; in line<span>&#39;</span></span> <span><span>&#39;</span>print(line)<span>&#39;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial

for i, line in enumerate(sys.stdin, 1):
    line = line.rstrip(&#34;\r\n&#34;)
    line = line.replace(&#34;foo&#34;, &#34;bar&#34;)  # LOOP_HEAD
    line = line.upper()                # LOOP_HEAD
    if not (&#34;BAR&#34; in line): continue   # FILTER
    print(line)                        # MAIN"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>

<span>for</span> <span>i</span>, <span>line</span> <span>in</span> <span>enumerate</span>(<span>sys</span>.<span>stdin</span>, <span>1</span>):
    <span>line</span> <span>=</span> <span>line</span>.<span>rstrip</span>(<span>&#34;<span>\r</span><span>\n</span>&#34;</span>)
    <span>line</span> <span>=</span> <span>line</span>.<span>replace</span>(<span>&#34;foo&#34;</span>, <span>&#34;bar&#34;</span>)  <span># LOOP_HEAD</span>
    <span>line</span> <span>=</span> <span>line</span>.<span>upper</span>()                <span># LOOP_HEAD</span>
    <span>if</span> <span>not</span> (<span>&#34;BAR&#34;</span> <span>in</span> <span>line</span>): <span>continue</span>   <span># FILTER</span>
    <span>print</span>(<span>line</span>)                        <span># MAIN</span></pre></div>
<h3 tabindex="-1" id="user-content-import-modules--i-module---import-module" dir="auto"><a href="#import-modules--i-module---import-module">Import modules. <code>-i MODULE, --import MODULE</code><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">By using the <code>-i MODULE, --import MODULE</code> option, you can import any modules. If the value specified with <code>--import</code> is in the form of a sentence, like <code>import math</code> or <code>from math import sqrt</code>, it will be added as an import statement just as it is. If only the module name is provided, like <code>math</code>, it will automatically be given an import statement, such as <code>import math</code>.</p>
<p dir="auto">ppp text -i zlib -i &#39;from base64 import b64encode&#39; &#39;b64encode(zlib.compress(text.encode()))&#39;</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ppp text -pqrn -i zlib -i &#39;from base64 import b64encode&#39; &#39;print(b64encode(zlib.compress(text.encode())))&#39;"><pre>$ ppp text -pqrn -i zlib -i <span><span>&#39;</span>from base64 import b64encode<span>&#39;</span></span> <span><span>&#39;</span>print(b64encode(zlib.compress(text.encode())))<span>&#39;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="import sys
from functools import partial
import zlib                    # &lt;- HERE
from base64 import b64encode   # &lt;- HERE

text = sys.stdin.read()
print(b64encode(zlib.compress(text.encode())))"><pre><span>import</span> <span>sys</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>
<span>import</span> <span>zlib</span>                    <span># &lt;- HERE</span>
<span>from</span> <span>base64</span> <span>import</span> <span>b64encode</span>   <span># &lt;- HERE</span>

<span>text</span> <span>=</span> <span>sys</span>.<span>stdin</span>.<span>read</span>()
<span>print</span>(<span>b64encode</span>(<span>zlib</span>.<span>compress</span>(<span>text</span>.<span>encode</span>())))</pre></div>
<p dir="auto">Usage example.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ seq 5 |ppp -i math &#39;line, math.sqrt(int(line))&#39;
1       1.0
2       1.4142135623730951
3       1.7320508075688772
4       2.0
5       2.23606797749979"><pre>$ seq 5 <span>|</span>ppp -i math <span><span>&#39;</span>line, math.sqrt(int(line))<span>&#39;</span></span>
1       1.0
2       1.4142135623730951
3       1.7320508075688772
4       2.0
5       2.23606797749979</pre></div>

</article>
          </div></div>
  </body>
</html>
