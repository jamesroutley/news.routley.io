<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://discuss.python.org/t/pep-760-no-more-bare-excepts/67182">Original</a>
    <h1>PEP 760: No more bare excepts</h1>
    
    <div id="readability-page-1" class="page"><div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
      <meta itemprop="headline" content="PEP 760 – No More Bare Excepts"/>
      
      <meta itemprop="datePublished" content="2024-10-09T12:38:19Z"/>
        <meta itemprop="articleSection" content="PEPs"/>
      <meta itemprop="keywords" content=""/>
      


          <div id="post_1">
            <div>
              


              <p><span>
                  <time datetime="2024-10-09T12:38:19Z">
                    October 9, 2024, 12:38pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T20:05:14Z"/>
              <span itemprop="position">1</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p><img src="https://emoji.discourse-cdn.com/apple/bangbang.png?v=12" title=":bangbang:" alt=":bangbang:" loading="lazy" width="20" height="20"/><strong>Update: We have decided to withdraw the PEP as the consensus is that the benefits doesn’t justify the cost</strong></p>
<p>———-</p>
<p><img src="https://emoji.discourse-cdn.com/apple/wave.png?v=12" title=":wave:" alt=":wave:" loading="lazy" width="20" height="20"/>  Hi everyone,</p>
<p>As the evil twin of <a href="https://discuss.python.org/t/pep-758-allow-except-and-except-expressions-without-parentheses/66453">PEP 758: Allow `except` and `except*` expressions without parentheses</a>, <a href="https://jakelazaroff.com/u/brettcannon">@brettcannon</a> and me present you <strong>PEP 760: No more bare excepts</strong>.</p>
<p>This PEP proposes disallowing bare <code>except:</code> clauses in Python’s exception-handling syntax. Currently, Python allows catching all exceptions with a bare <code>except:</code> clause, which can lead to overly broad exception handling and mask important errors. This PEP suggests requiring explicit exception types in all except clauses, promoting more precise and intentional error handling.</p>
<p>Please <strong>review the entire document</strong> before commenting as it contains several aspects of how to address the deprecation, tooling, rejected ideas and more.</p>


<p>Vote in this poll:</p>


            </div>

            

                
          </div>
          <div id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/barry"><span itemprop="name">barry</span></a>
                (Barry Warsaw)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T00:35:09Z">
                    October 8, 2024, 12:35am
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T00:35:09Z"/>
              <span itemprop="position">2</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>I know this is off-topic for <em>this</em> thread, but I raised this as an issue with the PEP 760 PR (the PEP itself hasn’t been published yet).  I haven’t had time to look at the response from the PEP authors, but I would really like to preserve bare-<code>except</code> with an unconditional <code>raise</code> use case.  If that can’t be done, I suggested an alias for <code>BaseException</code> called <code>AnyException</code> so at least the modified code would read better:</p>
<pre data-code-wrap="python"><code>try:
    something()
except:
     transaction.abort()
     raise
else:
     transaction.commit()
</code></pre>
<p>would become</p>
<pre data-code-wrap="python"><code>try:
    something()
except AnyException:
     transaction.abort()
     raise
else:
     transaction.commit()
</code></pre>
            </div>

            

          </div>
          <div id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/brettcannon"><span itemprop="name">brettcannon</span></a>
                (Brett Cannon)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T22:03:41Z">
                    October 8, 2024, 10:03pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T22:03:41Z"/>
              <span itemprop="position">3</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Can I ask why? I don’t find that any clearer than <code>except BaseException</code>, and if you are using that pattern I feel you should understand what you’re doing. As such, I don’t think learning what <code>BaseException</code> means is too much to ask.</p>

<p>It’s the comma <em>in the appropriate contex</em>; not every comma makes a tuple, but you can’t syntactically make a tuple without a comma.</p>
            </div>

            

          </div>
          <div id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T22:32:44Z">
                    October 8, 2024, 10:32pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T22:32:44Z"/>
              <span itemprop="position">4</span>
              </span>
            </p>
            <div itemprop="text">
              
<p><code>BaseException</code> exposes the fact that it’s the root class in the exception hierarchy, and you have to connect that mentally to the fact that a) Python requires all exceptions to derive from it, and b) that pattern means “catch any exception”.  The latter just makes that obvious.  It’s obvious to <em>us</em> of course either way.</p>
<p>For me, I’d still prefer to allow a bare <code>except</code> if there’s an explicit empty <code>raise</code> in the body.</p>
            </div>

            

          </div>
          <div id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            
            <div itemprop="text">
              
<p>Ideally if you want to intercept an exception and pass it through, you would do it will <code>finally</code>:</p>
<div><a href="https://global.discourse-cdn.com/flex016/uploads/python1/original/3X/3/e/3ed521c6dd358e7c5d85f5b8a53d7e0f60fb1dc1.png" data-download-href="/uploads/short-url/8XQeE7K5hZdK0M2Aecfro4mbypz.png?dl=1" title="image"><img src="https://global.discourse-cdn.com/flex016/uploads/python1/optimized/3X/3/e/3ed521c6dd358e7c5d85f5b8a53d7e0f60fb1dc1_2_460x233.png" alt="image" data-base62-sha1="8XQeE7K5hZdK0M2Aecfro4mbypz" width="460" height="233" srcset="https://global.discourse-cdn.com/flex016/uploads/python1/optimized/3X/3/e/3ed521c6dd358e7c5d85f5b8a53d7e0f60fb1dc1_2_460x233.png, https://global.discourse-cdn.com/flex016/uploads/python1/optimized/3X/3/e/3ed521c6dd358e7c5d85f5b8a53d7e0f60fb1dc1_2_690x349.png 1.5x, https://global.discourse-cdn.com/flex016/uploads/python1/optimized/3X/3/e/3ed521c6dd358e7c5d85f5b8a53d7e0f60fb1dc1_2_920x466.png 2x" data-dominant-color="0F234E"/></a></div>
<p>It would be nice to not have to use <code>sys</code>. What if we added an option to bind the exception in a <code>finally</code> block, as in:</p>
<pre data-code-wrap="python"><code>try:
    raise Exception(&#34;Hello&#34;)
finally e:
    if e is not None:
        e.add_note(&#34;World&#34;)
</code></pre>
            </div>

            

          </div>
          <div id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/barry"><span itemprop="name">barry</span></a>
                (Barry Warsaw)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T23:26:46Z">
                    October 8, 2024, 11:26pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T23:26:46Z"/>
              <span itemprop="position">6</span>
              </span>
            </p>
            <p>I don’t think that handles the original use case: abort an in-progress transaction and re-raise when any exception occurs, and commit the transaction if no exception occurs.</p>

            

          </div>
          <div id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/iritkatriel"><span itemprop="name">iritkatriel</span></a>
                (Irit Katriel)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T23:27:50Z">
                    October 8, 2024, 11:27pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T23:59:03Z"/>
              <span itemprop="position">7</span>
              </span>
            </p>
            <div itemprop="text">
              <pre data-code-wrap="python"><code>try:
    transaction
finally e:
    if e is None:
         commit
    else:
         abort
</code></pre>
            </div>

            

          </div>
          <div id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/jamestwebber"><span itemprop="name">jamestwebber</span></a>
                (James Webber)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T23:39:11Z">
                    October 8, 2024, 11:39pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T23:39:11Z"/>
              <span itemprop="position">8</span>
              </span>
            </p>
            <div itemprop="text">
              <p>I do wonder, is there a point to removing bare excepts just to re-introduce them with new syntax in <code>finally</code> blocks?</p>
<p>But presumably this is a discussion for the PEP 760 thread, when it arrives.</p>
            </div>

            

          </div>
          <div id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/iritkatriel"><span itemprop="name">iritkatriel</span></a>
                (Irit Katriel)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-08T23:41:13Z">
                    October 8, 2024, 11:41pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-08T23:41:13Z"/>
              <span itemprop="position">9</span>
              </span>
            </p>
            <p>The finally block is not a bare except. It doesn’t suppress exceptions.</p>

            

          </div>
          <div id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/ncoghlan"><span itemprop="name">ncoghlan</span></a>
                (Alyssa Coghlan)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T00:25:34Z">
                    October 9, 2024, 12:25am
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:38:51Z"/>
              <span itemprop="position">10</span>
              </span>
            </p>
            <div itemprop="text">
              <p>Now there’s an interesting idea: don’t make bare except illegal, make it have an implicit raise at the end (and disallow return, break, and continue).</p>
<p><s>We’re well and truly off-topic for <em>this</em> thread, though…</s> (comment was moved to a thread where it is on-topic)</p>
            </div>

            

          </div>
          <div id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/iritkatriel"><span itemprop="name">iritkatriel</span></a>
                (Irit Katriel)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T09:32:21Z">
                    October 9, 2024,  9:32am
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T09:32:21Z"/>
              <span itemprop="position">11</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>As an alternative to my <code>finally</code> suggestion? I don’t think it would be coherent if <code>except</code> sometimes eats the exception and sometimes not.</p>
<p>Should we take this to another thread? Are the moderators able to move the comments on this subtopic to a new thread?</p>
            </div>

            

          </div>
          <div id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/pablogsal"><span itemprop="name">pablogsal</span></a>
                (Pablo Galindo Salgado)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T12:40:30Z">
                    October 9, 2024, 12:40pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T12:40:30Z"/>
              <span itemprop="position">12</span>
              </span>
            </p>
            <div itemprop="text">
              <p>I have moved the relevant comments from <a href="https://discuss.python.org/t/pep-758-allow-except-and-except-expressions-without-parentheses/66453/55">PEP 758: Allow `except` and `except*` expressions without parentheses - #55 by pablogsal</a> that pertain this discussion. Please flag any potential mistakes in the operation as discourse made this quite complex.</p>
            </div>

            

          </div>
          <div id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/zuo"><span itemprop="name">zuo</span></a>
                (Jan Kaliszewski)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T12:44:10Z">
                    October 9, 2024, 12:44pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T12:44:10Z"/>
              <span itemprop="position">13</span>
              </span>
            </p>
            <div itemprop="text">
              <p>I like the proposal, except that the <em>bare-except-with-unconditional-bare-raise</em> pattern:</p>
<pre data-code-wrap="python"><code>except:
    &lt;here cleanup / rollback / context-relevant log...&gt;
    raise
</code></pre>
<p>– is IMHO too convenient (also when it comes to reading the code) to get rid of.</p>
<p>For me, the necessity to make it more verbose would be a clear loss.</p>
            </div>

            

          </div>
          <div id="post_14" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/encukou"><span itemprop="name">encukou</span></a>
                (Petr Viktorin)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:19:33Z">
                    October 9, 2024,  1:19pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:19:33Z"/>
              <span itemprop="position">14</span>
              </span>
            </p>
            <div itemprop="text">
              <p>+1 to keeping bare <code>except:</code> with <code>raise</code>.</p>
<p>It would make the implementation harder, though.</p>
            </div>

            

          </div>
          <div id="post_15" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/pablogsal"><span itemprop="name">pablogsal</span></a>
                (Pablo Galindo Salgado)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:27:54Z">
                    October 9, 2024,  1:27pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:27:54Z"/>
              <span itemprop="position">15</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Although it’s straightforward the implementation would be quite verbose as this implies doing an entire ast visitor just to detect raises below the bare except (in C).</p>
<p>The task becomes much simpler if we restrict it to detecting raises only at the same level of nesting but that feels somewhat odd.</p>
<p>I think this is an interesting case but you could skip all of this by just doing except BaseException and then all is good.</p>
            </div>

            

          </div>
          <div id="post_16" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/saaketp"><span itemprop="name">saaketp</span></a>
                (Saaket Prakash)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:32:43Z">
                    October 9, 2024,  1:32pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:32:43Z"/>
              <span itemprop="position">16</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Implicit raise is also compatible (or well just as compatible as mandatory raise inside bare except block).</p>
            </div>

            

          </div>
          <div id="post_17" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/hroncok"><span itemprop="name">hroncok</span></a>
                (Miro Hrončok)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:32:48Z">
                    October 9, 2024,  1:32pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:32:48Z"/>
              <span itemprop="position">17</span>
              </span>
            </p>
            <p>This breaks so much existing code. Does the benefit outweigh this? IMHO it’s OK to emit warnings left and right, but outright rejecting bare excepts after just 3 releases of deprecation period seems… not cool. Please, be more conservative with breaking backward compatibility of the basic language. This is not an API of one standard library module, this is the Python language itself.</p>

            

          </div>
          <div id="post_18" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/zuo"><span itemprop="name">zuo</span></a>
                (Jan Kaliszewski)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:35:16Z">
                    October 9, 2024,  1:35pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:40:27Z"/>
              <span itemprop="position">18</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>I think that a reasonable approach would be to require that a <em>bare <code>except</code></em> block:</p>
<ul>
<li><em>must not</em> contain <code>return</code>, <code>break</code> or <code>continue</code> (at any level of nesting, except in nested <code>def</code>s)</li>
<li><em>must</em> contain <code>raise</code> at its top-level (open question: should only a bare <code>raise</code> or <em>any</em> <code>raise...</code> be required?)</li>
</ul>
            </div>

            

          </div>
          <div id="post_19" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/pablogsal"><span itemprop="name">pablogsal</span></a>
                (Pablo Galindo Salgado)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:45:43Z">
                    October 9, 2024,  1:45pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:45:43Z"/>
              <span itemprop="position">19</span>
              </span>
            </p>
            <p>I think requiring this is reasonable but I am uncomfortable with the maintenance consequences of having to keep an entire visitor just for restricting this too much. The exception also feels slightly odd to communicate when really we can avoid all of this by just writing <code>except BaseException</code></p>

            

          </div>
          <div id="post_20" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://discuss.python.org/u/pablogsal"><span itemprop="name">pablogsal</span></a>
                (Pablo Galindo Salgado)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-10-09T13:46:57Z">
                    October 9, 2024,  1:46pm
                  </time>
                  <meta itemprop="dateModified" content="2024-10-09T13:46:57Z"/>
              <span itemprop="position">20</span>
              </span>
            </p>
            <p>How many releases you think its reasonable?</p>

            

          </div>
    </div></div>
  </body>
</html>
