<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://zck.org/ruby-hashmap-syntax">Original</a>
    <h1>til: Ruby&#39;s hashmap syntax</h1>
    
    <div id="readability-page-1" class="page"><div>
  <p>I was writing some Ruby for the first time, and I made a hashmap with some data in it.</p>

  <p><code>
    <pre>map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}
    </pre>
  </code></p><p>I was then surprised to find out that I couldn&#39;t get any items out of it.</p>

  <p><code>
    <pre>&gt; map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}
&gt; map1[&#34;foo&#34;]
=&gt; nil
    </pre>
  </code></p><p>Heck, it didn&#39;t even seem to have the key stored in it!</p>

  <p><code>
    <pre>&gt; map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}
&gt; map1.has_key?(&#34;foo&#34;)
=&gt; false
    </pre>
  </code></p><p>So I dug a bit into <a href="https://ruby-doc.org/3.2.2/Hash.html#class-Hash-label-Hash+Data+Syntax">the documentation</a>. The problem is there are two syntaxes for creating hashmap literals, a json-like syntax, and what Ruby calls the <em>&#34;rocket&#34;</em> syntax.</p>

  <p><code>
    <pre>map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}     # the json-like syntax
map2 = {&#34;foo&#34; =&gt; 1, &#34;bar&#34; =&gt; 2} # &#34;rocket&#34; syntax
    </pre>
  </code></p><p>The json-like syntax is newer, and is the cause of my confusion. It silently converts each string key to a symbol.</p>

  <p><code>
    <pre>&gt; map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}
&gt; map1.keys
=&gt; [:foo, :bar]
    </pre>
  </code></p><p>The rocket syntax doesn&#39;t!</p>

  <p><code>
    <pre>&gt; map2 = {&#34;foo&#34; =&gt; 1, &#34;bar&#34; =&gt; 2}
&gt; map2.keys
=&gt; [&#34;foo&#34;, &#34;bar&#34;]
    </pre>
  </code></p><p>So, for any maps created by the json-like syntax, they must be accessed with symbols.</p>

  <p><code>
    <pre>&gt; map1 = {&#34;foo&#34;: 1, &#34;bar&#34;: 2}
&gt; map1[:foo]
=&gt; 1
    </pre>
  </code></p><p>Or, just create them with the rocket syntax, and you can access them with strings. Like you expect.</p>

  <p>I don&#39;t understand why this is the case. This conversion is surprising, especially since the json-like syntax is a <em>newer</em> addition to Ruby.</p>
</div></div>
  </body>
</html>
