<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/teslamotors/fleet-telemetry">Original</a>
    <h1>Tesla Fleet Telemetry</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto"><a href="https://github.com/teslamotors/fleet-telemetry/actions/workflows/build.yml"><img src="https://github.com/teslamotors/fleet-telemetry/actions/workflows/build.yml/badge.svg?branch=main" alt="Build and Test"/></a>
<a href="https://github.com/teslamotors/fleet-telemetry/tags"><img src="https://camo.githubusercontent.com/91bbf98e243076d513e1b3803b8199391125338411ecdc31fd5fce70faededd3/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f7461672f7465736c616d6f746f72732f666c6565742d74656c656d657472793f6c6162656c3d6c6174657374253230746167" alt="Current Version" data-canonical-src="https://img.shields.io/github/v/tag/teslamotors/fleet-telemetry?label=latest%20tag"/></a>
<a href="https://hub.docker.com/r/tesla/fleet-telemetry/tags" rel="nofollow"><img src="https://camo.githubusercontent.com/bca1d7eaa03c3dafd8eb964005cb65f8a1ced04121cb4bea8dd4985f290f1c09/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f762f7465736c612f666c6565742d74656c656d657472793f6c6162656c3d646f636b657225323074616773" alt="DockerHub Tags" data-canonical-src="https://img.shields.io/docker/v/tesla/fleet-telemetry?label=docker%20tags"/></a></p>

<hr/>
<p dir="auto">At Tesla we believe that security and privacy are core tenets of any modern technology. Customers should be able to decide what data they share with third parties, how they share it, and when it can be shared. We&#39;ve developed a decentralized framework: &#34;Fleet Telemetry&#34; that allows customers to create a secure and direct bridge from their Tesla devices to any provider they authorize. Fleet Telemetry is a simple, scalable, and secure data exchange service for vehicles and other devices.</p>
<p dir="auto">Fleet Telemetry is a server reference implementation. The service handles device connectivity, receives, and stores transmitted data. Once configured, devices establish a websocket connection to push configurable telemetry records. Fleet Telemetry provides clients with ack, error, or rate limit responses.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-configuring-and-running-the-service" aria-hidden="true" href="#configuring-and-running-the-service"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Configuring and running the service</h2>
<p dir="auto">As a service provider you will need to register a publically available endpoint to receive device connections. Tesla devices will rely on a mutual TLS (mTLS) websocket to create a connection with the backend. The application has been designed to operate on top of kubernetes but you can run it as a standalone binary if you prefer.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-install-on-kubernetes-with-helm-chart-recommended" aria-hidden="true" href="#install-on-kubernetes-with-helm-chart-recommended"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Install on kubernetes with Helm Chart (recommended)</h3>
<p dir="auto">Please follow these <a href="https://github.com/teslamotors/helm-charts/blob/main/charts/fleet-telemetry/README.md">instructions</a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-manual-install-skip-this-if-you-have-installed-with-helm-on-kubernetes" aria-hidden="true" href="#manual-install-skip-this-if-you-have-installed-with-helm-on-kubernetes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Manual install (Skip this if you have installed with Helm on Kubernetes)</h3>
<ol dir="auto">
<li>
<p dir="auto">Allocate and assign a <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name" rel="nofollow">FQDN</a>, this will be used in the server and client (vehicle) configuration.</p>
</li>
<li>
<p dir="auto">Design a simple hosting architecture.  We recommend: Firewall/Loadbalancer -&gt; Fleet Telemetry -&gt; Kafka.</p>
</li>
<li>
<p dir="auto">Ensure mTLS connections are terminated on the Fleet Telemetry service.</p>
</li>
<li>
<p dir="auto">Configure the Server</p>
</li>
</ol>
<div data-snippet-clipboard-copy-content="{
  &#34;host&#34;: string - hostname,
  &#34;port&#34;: int - port,
  &#34;log_level&#34;: string - trace, debug, info, warn, error,
  &#34;json_log_enable&#34;: bool,
  &#34;namespace&#34;: string - kafka topic prefix,
  &#34;reliable_ack&#34;: bool - for use with reliable datastores, recommend setting to true with kafka,
  &#34;monitoring&#34;: {
    &#34;prometheus_metrics_port&#34;: int,
    &#34;profiler_port&#34;: int,
    &#34;profiling_path&#34;: string - out path,
    &#34;statsd&#34;: { if you are not using prometheus
      &#34;host&#34;: string - host:port of the statsd server,
      &#34;prefix&#34;: string - prefix for statsd metrics,
      &#34;sample_rate&#34;: int - 0 to 100 percentage to sample stats,
      &#34;flush_period&#34;: int - ms flush period
    }
  },
  &#34;kafka&#34;: { //librdkafka kafka config, seen here: https://raw.githubusercontent.com/confluentinc/librdkafka/master/CONFIGURATION.md
    &#34;bootstrap.servers&#34;: &#34;kafka:9092&#34;,
    &#34;queue.buffering.max.messages&#34;: 1000000
  },
  &#34;kinesis&#34;: {
    &#34;max_retries&#34;: 3,
    &#34;streams&#34;: {
      &#34;V&#34;: &#34;custom_stream_name&#34;
    }
  },
  &#34;rate_limit&#34;: {
    &#34;enabled&#34;: bool,
    &#34;message_limit&#34;: int - ex.: 1000
  },
  &#34;records&#34;: { list of records and their dispatchers, currently: alerts, errors, and V(vehicle data)
    &#34;alerts&#34;: [
        &#34;logger&#34;
    ],
    &#34;errors&#34;: [
        &#34;logger&#34;
    ],
    &#34;V&#34;: [
        &#34;kinesis&#34;,
        &#34;kafka&#34;
    ]
  },
  &#34;tls&#34;: {
    &#34;server_cert&#34;: string - server cert location,
    &#34;server_key&#34;: string - server key location
  }
}"><pre><code>{
  &#34;host&#34;: string - hostname,
  &#34;port&#34;: int - port,
  &#34;log_level&#34;: string - trace, debug, info, warn, error,
  &#34;json_log_enable&#34;: bool,
  &#34;namespace&#34;: string - kafka topic prefix,
  &#34;reliable_ack&#34;: bool - for use with reliable datastores, recommend setting to true with kafka,
  &#34;monitoring&#34;: {
    &#34;prometheus_metrics_port&#34;: int,
    &#34;profiler_port&#34;: int,
    &#34;profiling_path&#34;: string - out path,
    &#34;statsd&#34;: { if you are not using prometheus
      &#34;host&#34;: string - host:port of the statsd server,
      &#34;prefix&#34;: string - prefix for statsd metrics,
      &#34;sample_rate&#34;: int - 0 to 100 percentage to sample stats,
      &#34;flush_period&#34;: int - ms flush period
    }
  },
  &#34;kafka&#34;: { //librdkafka kafka config, seen here: https://raw.githubusercontent.com/confluentinc/librdkafka/master/CONFIGURATION.md
    &#34;bootstrap.servers&#34;: &#34;kafka:9092&#34;,
    &#34;queue.buffering.max.messages&#34;: 1000000
  },
  &#34;kinesis&#34;: {
    &#34;max_retries&#34;: 3,
    &#34;streams&#34;: {
      &#34;V&#34;: &#34;custom_stream_name&#34;
    }
  },
  &#34;rate_limit&#34;: {
    &#34;enabled&#34;: bool,
    &#34;message_limit&#34;: int - ex.: 1000
  },
  &#34;records&#34;: { list of records and their dispatchers, currently: alerts, errors, and V(vehicle data)
    &#34;alerts&#34;: [
        &#34;logger&#34;
    ],
    &#34;errors&#34;: [
        &#34;logger&#34;
    ],
    &#34;V&#34;: [
        &#34;kinesis&#34;,
        &#34;kafka&#34;
    ]
  },
  &#34;tls&#34;: {
    &#34;server_cert&#34;: string - server cert location,
    &#34;server_key&#34;: string - server key location
  }
}
</code></pre></div>
<p dir="auto">Example: <a href="https://github.com/teslamotors/fleet-telemetry/blob/main/examples/server_config.json">server_config.json</a></p>
<ol start="5" dir="auto">
<li>Deploy and run the server.  Get the latest docker image information from <a href="https://hub.docker.com/r/tesla/fleet-telemetry/tags" rel="nofollow">docker hub</a>. This can be run as a binary via <code>./fleet-telemetry -config=/etc/fleet-telemetry/config.json</code> directly on a server, or as a kubernetes deployment.  Example snippet:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: fleet-telemetry
spec:
  replicas: 1
  selector:
    matchLabels:
      app: fleet-telemetry
  template:
    metadata:
      labels:
        app: fleet-telemetry
    spec:
      containers:
      - name: fleet-telemetry
        image: tesla/fleet-telemetry:&lt;tag&gt;
        command: [&#34;/fleet-telemetry&#34;, &#34;-config=/etc/fleet-telemetry/config.json&#34;]
        ports:
        - containerPort: 443
---
apiVersion: v1
kind: Service
metadata:
  name: fleet-telemetry
spec:
  selector:
    app: fleet-telemetry
  ports:
    - protocol: TCP
      port: 443
      targetPort: 443
  type: LoadBalancer"><pre>---
<span>apiVersion</span>: <span>apps/v1</span>
<span>kind</span>: <span>Deployment</span>
<span>metadata</span>:
  <span>name</span>: <span>fleet-telemetry</span>
<span>spec</span>:
  <span>replicas</span>: <span>1</span>
  <span>selector</span>:
    <span>matchLabels</span>:
      <span>app</span>: <span>fleet-telemetry</span>
  <span>template</span>:
    <span>metadata</span>:
      <span>labels</span>:
        <span>app</span>: <span>fleet-telemetry</span>
    <span>spec</span>:
      <span>containers</span>:
      - <span>name</span>: <span>fleet-telemetry</span>
        <span>image</span>: <span>tesla/fleet-telemetry:&lt;tag&gt;</span>
        <span>command</span>: <span>[&#34;/fleet-telemetry&#34;, &#34;-config=/etc/fleet-telemetry/config.json&#34;]</span>
        <span>ports</span>:
        - <span>containerPort</span>: <span>443</span>
---
<span>apiVersion</span>: <span>v1</span>
<span>kind</span>: <span>Service</span>
<span>metadata</span>:
  <span>name</span>: <span>fleet-telemetry</span>
<span>spec</span>:
  <span>selector</span>:
    <span>app</span>: <span>fleet-telemetry</span>
  <span>ports</span>:
    - <span>protocol</span>: <span>TCP</span>
      <span>port</span>: <span>443</span>
      <span>targetPort</span>: <span>443</span>
  <span>type</span>: <span>LoadBalancer</span></pre></div>
<ol start="6" dir="auto">
<li>Create and share a vehicle configuration with Tesla</li>
</ol>
<div data-snippet-clipboard-copy-content="{
  &#34;hostname&#34;: string - server hostname,
  &#34;ca&#34;: string - pem format ca certificate(s),
  &#34;fields&#34;: { map of field configurations
    name (string) -&gt; {
        &#34;interval_seconds&#34;: int - data polling interval in seconds
    }...
  },
  &#34;alert_types&#34;: [ string list - alerts audiences that should be pushed to the server, recommendation is to use only &#34;service&#34; ]
}"><pre><code>{
  &#34;hostname&#34;: string - server hostname,
  &#34;ca&#34;: string - pem format ca certificate(s),
  &#34;fields&#34;: { map of field configurations
    name (string) -&gt; {
        &#34;interval_seconds&#34;: int - data polling interval in seconds
    }...
  },
  &#34;alert_types&#34;: [ string list - alerts audiences that should be pushed to the server, recommendation is to use only &#34;service&#34; ]
}
</code></pre></div>
<p dir="auto">Example: <a href="https://github.com/teslamotors/fleet-telemetry/blob/main/examples/client_config.json">client_config.json</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-backendsdispatchers" aria-hidden="true" href="#backendsdispatchers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Backends/dispatchers</h2>
<p dir="auto">The following <a href="https://github.com/teslamotors/fleet-telemetry/blob/main/telemetry/producer.go#L10-L19">dispatchers</a> are supported</p>
<ul dir="auto">
<li>Kafka (preferred): Configure with the config.json file.  See implementation here: <a href="https://github.com/teslamotors/fleet-telemetry/blob/main/config/config.go">config/config.go</a></li>
<li>Kinesis: Configure with standard <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html" rel="nofollow">AWS env variables and config files</a>. The default aws credentials and config files are: <code>~/.aws/credentials</code> and <code>~/.aws/config</code>.
<ul dir="auto">
<li>By default stream names will be *configured namespace*_*topic_name*  ex.: tesla_V, tesla_errors, tesla_alerts, etc</li>
<li>Configure stream names directly by setting the streams config <code>&#34;kinesis&#34;: { &#34;streams&#34;: { *topic_name*: stream_name } }</code></li>
<li>Override stream names with env variables: KINESIS_STREAM_*uppercase topic* ex.: <code>KINESIS_STREAM_V</code></li>
</ul>
</li>
<li>Google pubsub: Along with the required pubsub config (See ./test/integration/config.json for example), be sure to set the environment variable <code>GOOGLE_APPLICATION_CREDENTIALS</code></li>
<li>Logger: This is a simple STDOUT logger that serializes the protos to json.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-metrics" aria-hidden="true" href="#metrics"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Metrics</h2>
<p dir="auto">Prometheus or a statsd interface supporting data store for metrics, this is required you should always monitor your applications.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-protos" aria-hidden="true" href="#protos"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Protos</h2>
<p dir="auto">Data is encapsulated into protobuf messages of different types. We do not recommend making changes but if you need to recompile them you can always do so with:</p>
<ol dir="auto">
<li>Install protoc, currently on version 3.21.12: <a href="https://grpc.io/docs/protoc-installation/" rel="nofollow">https://grpc.io/docs/protoc-installation/</a></li>
<li>Install protoc-gen-go: <code>go install google.golang.org/protobuf/cmd/protoc-gen-go@v1.28</code></li>
<li>Run make command</li>
</ol>


<h2 tabindex="-1" dir="auto"><a id="user-content-unit-tests" aria-hidden="true" href="#unit-tests"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Unit Tests</h2>
<p dir="auto">To run the unit tests: <code>make test</code></p>
<p dir="auto">Common Errors:</p>
<div data-snippet-clipboard-copy-content="~/fleet-telemetry➜ git:(main) ✗  make test
go build github.com/confluentinc/confluent-kafka-go/v2/kafka:
# pkg-config --cflags  -- rdkafka
Package rdkafka was not found in the pkg-config search path.
Perhaps you should add the directory containing `rdkafka.pc&#39;
to the PKG_CONFIG_PATH environment variable
No package &#39;rdkafka&#39; found
pkg-config: exit status 1
make: *** [install] Error 1"><pre><code>~/fleet-telemetry➜ git:(main) ✗  make test
go build github.com/confluentinc/confluent-kafka-go/v2/kafka:
# pkg-config --cflags  -- rdkafka
Package rdkafka was not found in the pkg-config search path.
Perhaps you should add the directory containing `rdkafka.pc&#39;
to the PKG_CONFIG_PATH environment variable
No package &#39;rdkafka&#39; found
pkg-config: exit status 1
make: *** [install] Error 1
</code></pre></div>
<p dir="auto">librdkafka is missing, on MAC OS you can install it via <code>brew install librdkafka pkg-config</code> or follow instructions here <a href="https://github.com/confluentinc/confluent-kafka-go#getting-started">https://github.com/confluentinc/confluent-kafka-go#getting-started</a></p>
<div data-snippet-clipboard-copy-content="~/fleet-telemetry➜ git:(main) ✗  make test
go build github.com/confluentinc/confluent-kafka-go/v2/kafka:
# pkg-config --cflags  -- rdkafka
Package libcrypto was not found in the pkg-config search path.
Perhaps you should add the directory containing `libcrypto.pc&#39;
to the PKG_CONFIG_PATH environment variable
Package &#39;libcrypto&#39;, required by &#39;rdkafka&#39;, not found
pkg-config: exit status 1
make: *** [install] Error 1

~/fleet-telemetry➜ git:(main) ✗  locate libcrypto.pc
/opt/homebrew/Cellar/openssl@3/3.0.8/lib/pkgconfig/libcrypto.pc

~/fleet-telemetry➜ git:(main) ✗  export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/opt/homebrew/Cellar/openssl@3/3.0.8/lib/pkgconfig/"><pre><code>~/fleet-telemetry➜ git:(main) ✗  make test
go build github.com/confluentinc/confluent-kafka-go/v2/kafka:
# pkg-config --cflags  -- rdkafka
Package libcrypto was not found in the pkg-config search path.
Perhaps you should add the directory containing `libcrypto.pc&#39;
to the PKG_CONFIG_PATH environment variable
Package &#39;libcrypto&#39;, required by &#39;rdkafka&#39;, not found
pkg-config: exit status 1
make: *** [install] Error 1

~/fleet-telemetry➜ git:(main) ✗  locate libcrypto.pc
/opt/homebrew/Cellar/openssl@3/3.0.8/lib/pkgconfig/libcrypto.pc

~/fleet-telemetry➜ git:(main) ✗  export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/opt/homebrew/Cellar/openssl@3/3.0.8/lib/pkgconfig/
</code></pre></div>
<p dir="auto">A reference to libcrypto is not set properly. To resolve find the reference to libcrypto by pkgconfig and set et the PKG_CONFIG_PATH accordingly.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-integration-tests" aria-hidden="true" href="#integration-tests"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Integration Tests</h2>
<p dir="auto">(Optional): If you want to recreate fake certs for your test: <code>make generate-certs</code></p>
<p dir="auto">To run the integration tests: <code>make integration</code></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-building-the-binary-for-linux-from-mac-arm64" aria-hidden="true" href="#building-the-binary-for-linux-from-mac-arm64"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Building the binary for linux from mac arm64</h2>
<div dir="auto" data-snippet-clipboard-copy-content="DOCKER_BUILD_KIT=1 DOCKER_CLI_EXPERIMENTAL=enabled docker buildx version
docker buildx create --name go-builder --driver docker-container --driver-opt network=host --buildkitd-flags &#39;--allow-insecure-entitlement network.host&#39; --use
docker buildx inspect --bootstrap
docker buildx build --no-cache --progress=plain --platform linux/amd64 -t &lt;name:tag&gt;(e.x.: fleet-telemetry:local.1.1) -f Dockerfile . --load
container_id=$(docker create fleet-telemetry:local.1.1) docker cp $container_id:/fleet-telemetry /tmp/fleet-telemetry"><pre>DOCKER_BUILD_KIT=1 DOCKER_CLI_EXPERIMENTAL=enabled docker buildx version
docker buildx create --name go-builder --driver docker-container --driver-opt network=host --buildkitd-flags <span><span>&#39;</span>--allow-insecure-entitlement network.host<span>&#39;</span></span> --use
docker buildx inspect --bootstrap
docker buildx build --no-cache --progress=plain --platform linux/amd64 -t <span>&lt;</span>name:tag<span><span>&gt;(</span>e.x.: fleet-telemetry:local.1.1<span>)</span></span> -f Dockerfile <span>.</span> --load
container_id=<span><span>$(</span>docker create fleet-telemetry:local.1.1<span>)</span></span> docker cp <span>$container_id</span>:/fleet-telemetry /tmp/fleet-telemetry</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-security-and-privacy-considerations" aria-hidden="true" href="#security-and-privacy-considerations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Security and Privacy considerations</h2>
<p dir="auto">System administrators should apply standard best practices, which are beyond
the scope of this README.</p>
<p dir="auto">Moreover, the following application-specific considerations apply:</p>
<ul dir="auto">
<li>Vehicles authenticate to the telemetry server with TLS client certificates
and use a variety of security measures designed to prevent unauthorized
access to the corresponding private key. However, as a defense-in-depth
precaution, backend services should anticipate the possibility that a
vehicle&#39;s TLS private key may be compromised. Therefore:
<ul dir="auto">
<li>Backend systems should sanitize data before using it.</li>
<li>Users should consider threats from actors that may be incentivized to
submit falsified data.</li>
<li>Users should filter by vehicle identification number (VIN) using an
allowlist if possible.</li>
</ul>
</li>
<li>Configuration-signing private keys should be kept offline.</li>
<li>Configuration-signing private keys should be kept in an HSM.</li>
<li>If telemetry data is compromised, threat actors may be able to make
inferences about driver behavior even if explicit location data is not
collected. Security policies should be set accordingly.</li>
<li>Tesla strongly encourages providers to only collect data they need, limited to
frequency that they need.</li>
<li>Providers agree to take full responsibility for privacy risks, as soon as data
leave the devices (for more info read our privacy policies).</li>
</ul>
</article>
          </div></div>
  </body>
</html>
