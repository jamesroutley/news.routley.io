<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://varun.ch/history">Original</a>
    <h1>Retrieving your browsing history through a CAPTCHA (2022)</h1>
    
    <div id="readability-page-1" class="page">
  
  <time datetime="2022-03-04">4 March, 2022</time>
  <p><a href="https://varun.ch/">‚Üê Back to varun.ch</a></p>
  <p>Proof of concept history sniffing, where visitors do the hard work.</p>
  <div>
    
    <h2>Select all the black cells to continue to your destination.</h2>
    <h3>Press &#34;DONE&#34; when you finish.</h3>
    
    </div>
  <div>
    <h2>Results</h2>
    <p>Waiting for you to finish the CAPTCHA...</p>
  </div>
  <h2 id="how">How it works</h2>
  <p>Web browsers have plenty of tiny features to make navigating the web less painful.</p>
  <p>One such feature is the browser history, helpfully recording a list of every page a user visits incase they want to
    come back to one later. Most browsers also highlight visited links by displaying them in purple. This too is pretty
    helpful, especially on search results or long lists of links.</p>
  <p>Browsers also let us style how visited links look, using the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:visited">:visited pseudo-class</a>. This is also pretty
    helpful, as the purple links don&#39;t match the style of every website.</p>
  <p>You might already be thinking of various ways to exploit this, perhaps using background-images to send GET requests
    to a server, or maybe by using window.getComputedStyle to get the colour of a link.</p>
  <p>Unfortunately (well, actually fortunately), <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Privacy_and_the_:visited_selector">browser vendors have
      thought of that</a> (or more likely: those methods have already been exploited), and most limit the CSS you can
    apply to visited links, alongside <a href="https://stackoverflow.com/a/5396422 ">making window.getComputedStyle lie
      sometimes</a>.</p>
  <p>People have done some pretty crazy tricks to bypass the limitations and sniff browsing history, for example take <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1205981">this report</a> by George Liu which
    demonstrates abusing transition events to find out if a link is visited.</p>
  <p>There&#39;s probably still a ton of similar ways to automatically exploit the CSS pseudo-class that no one has thought
    of yet, but it&#39;s a constant cat and mouse game between hackers and browser vendors.</p>
  <p>So, rather than using a computer to find out if a link is visited, why don&#39;t we trick our visitors into doing it
    for us instead! üòÄ</p>
  <p>This proof of concept looks somewhat like a reCAPTCHA challenge, and styles visited links to look like black
    squares. Visitors are told to select all the black squares to prove their humanity, when in reality they are telling
    us whether they have visited certain websites.</p>
  <p>I also covered up the links themselves with an overlaid div, so that the link tooltip doesn&#39;t appear when hovered,
    and so visitors can&#39;t actually click the links. Additionally, I included some fake squares to catch if visitors are
    trying to spoof their results.</p>
  <p>While this demo is harmless, a malicious website could employ something similar for various reasons. Perhaps a
    website could find out a user&#39;s political views, simply by checking if they&#39;ve seen an article or YouTube video. Or
    maybe a website could find out where a visitor lives, just by finding out if they&#39;ve seen some local websites.</p>
  <p>The sky is the limit, which is fairly concerning. This also can&#39;t be patched unless browsers stop allowing
    websites to style links, or by severely limiting the amount of scenarios where visited link appear purple
    altogether.</p>
  <h2>Conclusion</h2>
  <p>In conclusion, the :visited pseudo-class poses privacy risks for people who surf the web. As a user, you can stop
    web pages from tracking your history by disabling visited link highlighting in your web browser.</p>



</div>
  </body>
</html>
