<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/nedlir/OfficerBreaker">Original</a>
    <h1>OfficerBreaker â€“ pptx/docx/xlsx password remover</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/nedlir/OfficerBreaker/blob/master/readme/useless_lock.png"><img src="https://github.com/nedlir/OfficerBreaker/raw/master/readme/useless_lock.png" alt="useless_security_lock"/></a></p>
<p dir="auto">Officer Breaker is a simple program that removes the password from read-only protected files that belong to the Office Open XML format family (<em><strong>.pptx/.xlsx/.docx</strong></em> file types).</p>
<p dir="auto">Please read the <a href="#disclaimer">disclaimer</a>  before using this program or its source code.</p>
<p dir="auto">GUI artwork by <a href="https://twitter.com/cioccolato_kun" rel="nofollow">@Cioccolatodorima</a>.</p>
<h2 dir="auto"><a id="user-content-requirements-and-installation" aria-hidden="true" href="#requirements-and-installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Requirements and Installation</h2>
<p dir="auto">If you wish to build the project yourself you need:</p>
<ol dir="auto">
<li><a href="https://openjdk.org" rel="nofollow">JDK 8+</a></li>
<li><a href="https://ant.apache.org" rel="nofollow">Apache Ant </a></li>
<li>Go to the main repository folder and run:</li>
</ol>

<ol start="4" dir="auto">
<li>Open the executable file from <code>.dist/</code> folder of this repo.</li>
</ol>
<p dir="auto">Alternatively, download the prebuilt executable directly from the <a href="https://github.com/nedlir/OfficerBreaker/releases">releases</a> page.</p>
<h2 dir="auto"><a id="user-content-how-does-it-work" aria-hidden="true" href="#how-does-it-work"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How does it work?</h2>
<p dir="auto">All pptx/xlsx/docx files are part of the Office Open XML format family (for further reading please refer to <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000395.shtml" rel="nofollow">OOXML Format Family -- ISO/IEC 29500 and ECMA 376
</a>).</p>
<p dir="auto">For example, a standard <em><strong>.pptx</strong></em> file will have the following file tree structure:</p>
<div data-snippet-clipboard-copy-content="myFile.pptx
.
â”œâ”€â”€ docProps
â”‚   â”œâ”€â”€ app.xml
â”‚   â”œâ”€â”€ core.xml
â”‚   â”œâ”€â”€ custom.xml
â”‚   â””â”€â”€ thumbnail.jpeg
â”œâ”€â”€ ppt
â”‚   â”œâ”€â”€ handoutMasters
â”‚   â”œâ”€â”€ media
â”‚   â”œâ”€â”€ media
â”‚   ...
â”‚   ...
â”‚   ...
â”‚   â””â”€â”€ presentation.xml
â”œâ”€â”€ _rels
â”‚   â”œâ”€â”€ .rels
â””â”€â”€ [Content_Types].xml"><pre><code>myFile.pptx
.
â”œâ”€â”€ docProps
â”‚   â”œâ”€â”€ app.xml
â”‚   â”œâ”€â”€ core.xml
â”‚   â”œâ”€â”€ custom.xml
â”‚   â””â”€â”€ thumbnail.jpeg
â”œâ”€â”€ ppt
â”‚   â”œâ”€â”€ handoutMasters
â”‚   â”œâ”€â”€ media
â”‚   â”œâ”€â”€ media
â”‚   ...
â”‚   ...
â”‚   ...
â”‚   â””â”€â”€ presentation.xml
â”œâ”€â”€ _rels
â”‚   â”œâ”€â”€ .rels
â””â”€â”€ [Content_Types].xml
</code></pre></div>
<p dir="auto">We can see this structure by opening the file using a program like <a href="https://www.7-zip.org/" rel="nofollow">7zip</a> or by changing the filetype to <em><strong>.zip</strong></em> and then opening it.</p>
<p dir="auto">Each OOXML file type contains an <em><strong>.xml</strong></em> file with settings and preferences, including read-only protection. In our example the security element will be located inside <code>presentation.xml</code> file which is located inside the <code>ppt</code> folder of <code>myFile.pptx</code>.</p>
<p dir="auto">Inside <code>presentation.xml</code> there is a specific element we will focus on called <strong>p:modifyVerifier</strong> which should look like this:</p>
<div data-snippet-clipboard-copy-content="&lt;p:modifyVerifier cryptProviderType=&#34;rsaAES&#34; cryptAlgorithmClass=&#34;hash&#34; cryptAlgorithmType=&#34;typeAny&#34; cryptAlgorithmSid=&#34;14&#34; spinCount=&#34;100000&#34; saltData=&#34;3R1lmtJocEj5GzEGRn3MHA==&#34; hashData=&#34;iR0jIUtVcGsTx62z/hqcbzaReLJemv$eZyqTlpWhl0Lph+osBKEiEYmyReJHmypMy6wj+VFmDGuNZvsMA9tX9g==&#34;/&gt;"><pre><span>&lt;</span><span>p</span>:<span>modifyVerifier</span> <span>cryptProviderType</span><span>=</span><span>&#34;rsaAES&#34;</span> <span>cryptAlgorithmClass</span><span>=</span><span>&#34;hash&#34;</span> <span>cryptAlgorithmType</span><span>=</span><span>&#34;typeAny&#34;</span> <span>cryptAlgorithmSid</span><span>=</span><span>&#34;14&#34;</span> <span>spinCount</span><span>=</span><span>&#34;100000&#34;</span> <span>saltData</span><span>=</span><span>&#34;3R1lmtJocEj5GzEGRn3MHA==&#34;</span> <span>hashData</span><span>=</span><span>&#34;iR0jIUtVcGsTx62z/hqcbzaReLJemv$eZyqTlpWhl0Lph+osBKEiEYmyReJHmypMy6wj+VFmDGuNZvsMA9tX9g==&#34;</span><span>/</span><span>&gt;</span></pre></div>
<p dir="auto">The file editing is protected by a password which was salted and hashed which makes it nearly impossible to crack within reasonable time. But instead of trying to crack the password, we can just... Remove it. <g-emoji alias="shrug" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f937.png">ðŸ¤·</g-emoji></p>
<p dir="auto">Turns out that simply deleting the security element <strong>p:modifyVerifier</strong> as a whole will make <code>myFile.pptx</code> behave as if it never had any password at all. This kind of security measure is a bit like the photo in the title of this repository - a good lock placed on the door handle... <g-emoji alias="sweat_smile" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f605.png">ðŸ˜…</g-emoji></p>
<p dir="auto">The program will create a copy of <code>presentation.xml</code>, parse it and delete the security element. Once the element is deleted, the <em>copied</em> <code>presentation.xml</code> will be replaced with the <em>original</em> <code>presentation.xml</code> which will effectively remove the password from <code>myFile.pptx</code>.</p>
<p dir="auto">What makes this whole thing worse is the fact that we could simply remove the password created by the author, alter the file in some way and then return the original password of the author by inserting the same security element which was removed. This hurts the integrity of the whole OOXML format family.</p>
<h3 dir="auto"><a id="user-content-future-changes--possible-deprecation" aria-hidden="true" href="#future-changes--possible-deprecation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Future changes / possible deprecation</h3>
<p dir="auto">Future versions of OOXML file type may make drastic changes of naming convention of elements or/and structure of the folders or/and files. This might make this repo deprecated but not obsolete if the same security measures will be taken in future versions.
If a &#34;lock with different name&#34; (the hashing) will be placed on the &#34;door handle&#34; (removable <code>.xml</code> element), the file still could be altered/edited without a password. All that&#39;s needed is to find the new security element and simply remove it from the file.</p>
<h2 dir="auto"><a id="user-content-screens" aria-hidden="true" href="#screens"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Screens</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/nedlir/OfficerBreaker/blob/master/readme/app.gif"><img src="https://github.com/nedlir/OfficerBreaker/raw/master/readme/app.gif" alt="app_screens" data-animated-image=""/></a></p>
<h2 dir="auto"><a id="user-content-disclaimer" aria-hidden="true" href="#disclaimer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Disclaimer</h2>
<p dir="auto">This repository is for research purposes only, the use of this code is your responsibility.</p>
<p dir="auto">I take no responsibility and/or liability for how you choose to use any of the source code available here. By using any of the files available in this repository, you understand that you are agreeing to use it only on files you own or received permission to use the code on.</p>
<p dir="auto">This repository does not promote any hacking related activity. All the information in this repository is for educational purposes only.</p>
<p dir="auto">Once again, all files available here are for education and/or research purposes ONLY.</p>
</article>
          </div></div>
  </body>
</html>
