<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://triskweline.de/unpoly-rugb/#/">Original</a>
    <h1>Breaking up with JavaScript front ends</h1>
    
    <div id="readability-page-1" class="page"><div>
      <!-- Any section element inside of this container is displayed as a slide -->
      <div>
        <section>
          <h3>
            <p>
              It&#39;s not you, it&#39;s us
            </p>
            <p>
              We&#39;re breaking up with JavaScript frontends
            </p>
          </h3>
          <p>
            Henning Koch, makandra GmbH
            </p>
        </section>
        <section>
          <p>
            Give it 10 minutes.
          </p>
        </section>
        <section>
          <h3>Context</h3>
          <ul>
            <li>makandra is a Ruby on Rails consultancy</li>
            <li>We start a new application every 3 months</li>
            <li>
              We maintain apps for a <u>really</u> long time
              <ul>
                <li>50+ apps in maintenance</li>
                <li>Oldest app is from 2007</li>
              </ul>
            </li>
            <li>Will we be able to do this for another 10 years?</li>
          </ul>
        </section>
        <section>
          <h2>Tweet from 2025</h2>
          <img src="https://www.eviau.net/blogue/pictures/future_tweet.png"/>
        </section>
        <section>
          
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2005
            </p>
            <div>
              <div>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2008
            </p>
            <div>
              <div>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2009
            </p>
            <div>
              <div>
                <p>
                  API
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2011
            </p>
            <div>
              <div>
                <p>
                  Asset packing
                </p>
                <p>
                  API
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2013
            </p>
            <div>
              <div>
                <p>
                  Asset packing
                </p>
                <p>
                  API
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            <div>
              <div>
                <p>
                  Models / API client
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Client
              </p>
            </div>
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2014
            </p>
            <div>
              <div>
                <p>
                  Asset packing
                </p>
                <p>
                  API
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            <div>
              <div>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models / API client
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Client
              </p>
            </div>
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <div>
            <p>
              Complexity in 2015
            </p>
            <div>
              <div>
                <p>
                  Prerendering
                </p>
                <p>
                  Asset packing
                </p>
                <p>
                  API
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Server
              </p>
            </div>
            <div>
              <div>
                <p>
                  Virtual DOM
                </p>
                <p>
                  Authorization
                </p>
                <p>
                  Routing
                </p>
                <p>
                  Models / API client
                </p>
                <p>
                  Controllers
                </p>
                <p>
                  Views
                </p>
                <p>
                  Dependencies
                </p>
              </div>
              <p>
                Client
              </p>
            </div>
          </div>
          <p>
            Based on chart by <a href="https://twitter.com/ryanstout">@ryanstout</a>
          </p>
        </section>
        <section>
          <p>
            A look back at the 7 AngularJS projects that we wrote from 2013-2016:
          </p>
          
          
        </section>
        <section>
          <p>
            In hindsight, these are the projects that should have been a SPA:
          </p>
          
          <p>
            YMMV.
          </p>
        </section>
        <section>
          <h3>Learnings from 3 years of SPAs</h3>
          <ol>
            <li>
              SPAs are a good fit for a certain class of UI.
              </li>
            <li>
              There&#39;s a trade-off between UI fidelity and code complexity.
            </li>
            <li>
              We think we can fix most of the problems with server-side apps
              </li>
          </ol>
        </section>
        <section>
          <img height="600" src="https://www.eviau.net/blogue/pictures/trade_off.png"/>
        </section>
        <section>
          <h3>
            What server-side apps
            <p>
              do well
            </p>
          </h3>
          <ol>
            <li>Wide choice of great and mature languages</li>
            <li>Low complexity stack</li>
            <li>Synchronous data access</li>
            <li>Time to first render</li>
            <li>Works on low-end devices</li>
          </ol>
        </section>
        <section>
          <h3>
            What server-side apps
            <p>
              don&#39;t do well
            </p>
          </h3>
          <ol>
            <li>Slow interaction feedback</li>
            <li>
              Page loads destroy transient state
              <p>(scroll positions, unsaved form values, focus)</p>
            </li>
            <li>
              Layered interactions are hard
              <p>(modals, drop-downs, drawers)</p>
            </li>
            <li>Animation is complicated</li>
            <li>Complex forms</li>
          </ol>
        </section>
        <section>
          <h3>Demo of server-side app issues</h3>
          <p>
            <a href="http://demo.unpoly.com/" target="_blank">
              Link to demo app
            </a>
            </p>
          </section>
        <section>
          <h3>
            <p>
              How to fix server-side apps?
            </p>
            <p>
              A thought experiment
            </p>
          </h3>
          <img height="200" src="https://www.eviau.net/blogue/pictures/html6.png"/>
          <p>
            Imagine HTML6 was all about server-side apps
          </p>
          <p>
            What features would be in that spec?
            </p>
          <p>
            We can polyfill all of that!
            </p>
        </section>
        <section>
          <h2>
            <img src="https://www.eviau.net/blogue/pictures/logos/unpoly.png" width="50%"/>
          </h2>
          <ul>
            <li>25 new HTML attributes to write modern UI, but keep logic on the server</li>
            <li>
              <p>
                Works with existing code
              </p>
              <p>
                little to no changes required on the server side
              </p>
            </li>
            <li>
              Works with any backend language or framework
              <p>
                although we have some nice Rails bindings
              </p>
            </li>
            <li>In development for two years and in production with multiple apps</li>
          </ul>
        </section>
        <section>
          <h3>Demo of Unpoly-enhanced app</h3>
          <p>
            <a href="http://demo.unpoly.com/" target="_blank">
              Link to demo app
            </a>
            </p>
          <h4>
            Things to try and observe:
          </h4>
          <ol>
            <li>
              <p>Navigate between cards, open and cancel the form</p>
              <p>Page transitions are animated</p>
            </li>
            <li>
              <p>Navigate between cards in the left pane</p>
              <p>Scroll positions are kept in both panes</p>
            </li>
            <li>
              <p>Open the second page (&#34;More cards&#34; link at the bottom of the left pane)</p>
              <p>New page slides in smoothly</p>
              <p>Card in the right pane is kept</p>
            </li>
            <li>
              <p>Edit a card, change the title, then change the pattern</p>
              <div><p>Pattern selection happens in a modal dialog, </p></div>
            </li>
            <li>
              <p>Inspect links and see attributes with <code>up-*</code> prefix</p>
              
            </li>
          </ol>
        </section>
        <section>
          <h3>Classic page flow</h3>
          <img src="https://www.eviau.net/blogue/pictures/fragment_flow_vanilla.svg" width="100%"/>
          <p>
            Server renders full pages on every request.
            </p>
        </section>
        <section>
          <h3>Unpoly page flow</h3>
          <img src="https://www.eviau.net/blogue/pictures/fragment_flow_unpoly.svg" width="100%"/>
          <p>
            Server <b>still renders full pages</b>, but we only use fragments.
            </p>
        </section>
        <section>
          <h3>Layers</h3>
          
          <p>Unpoly apps may stack up to three HTML pages on top of each other</p>
          <p>Each layer has its own URL and can navigate without changing the others</p>
          <p>Use this to <b>keep context</b> during interactions</p>
        </section>
        <section>
          <img src="https://www.eviau.net/blogue/pictures/gmail.png"/>
        </section>
        <section>
          <img src="https://www.eviau.net/blogue/pictures/gmail_layers.png"/>
        </section>
        <section>
          <h3>Layers</h3>
          <pre><code data-noescape="">&lt;a href=&#34;/list&#34; up-target=&#34;.main&#34;&gt;Replace fragment&lt;/a&gt;

&lt;a href=&#34;/new&#34; up-modal=&#34;.main&#34;&gt;Open fragment in dialog&lt;/a&gt;

&lt;a href=&#34;/menu&#34; up-popup=&#34;.main&#34;&gt;Open fragment in dropdown&lt;/a&gt;
</code></pre>
          <p>Links in a layer prefer to update fragments within the layer</p>
          <p>Changing a fragment behind the layer will close the layer</p>
        </section>
        <section>
          <h3>Navigation</h3>
          <ul>
            <li>
              All fragment updates change the browser URL by default.
            </li>
            <li>
              <p>
                Back/Forward buttons work as expected.
              </p>
              <p>
                Even scroll positions are restored.
              </p>
            </li>
            <li>
              <p>
                Linking to a fragment will <b>scroll the viewport</b> to reveal the fragment.
              </p>
              <p>
                Unpoly is aware of fixed navigation bars and will scroll further/less.
              </p>
            </li>
            <li>
              Links to the current URL get an <a href="http://unpoly.com/up-current"><code>.up-current</code></a>
              class automatically.
            </li>
          </ul>
        </section>
        <section>
          <h3>But I have this really custom <span>JavaScript / jQuery library / behavior</span> that I need to integrate</h3>
          <p>
            Don&#39;t worry, we actually allow for massive customization:
          </p>
          <ul>
            <li>Pairing JavaScript snippets with HTML elements</li>
            <li>Integrating libraries (WYSIWYG editor, jQuery plugins, ...)</li>
            <li>Passing structured data to JavaScript snippets</li>
            <li>Reuse existing Unpoly functionality from your own code</li>
            <li>Invent your own UJS syntax</li>
            <li>Configure defaults</li>
          </ul>
        </section>
        <section>
          <h3>Activating JS snippets</h3>
          <p>
            Every app needs a way to pair JavaScript snippets</p>
          <ul>
            <li>A <code>textarea.wysiwyg</code> should activate Redactor on load</li>
            <li>
              An <code>input[type=search]</code> field should automatically request new results
              </li>
            <li>
              A <code>button.toggle-all</code> should toggle all checkboxes
              when clicked
            </li>
            <li>
              A <code>.map</code> should render a map via the Google Maps JS API
            </li>
          </ul>
        </section>
        <section>
          <h3>
            <p>
              Activating JS snippets
            </p>
            <p>
              Random.js
            </p>
          </h3>
          <pre><code data-noescape="">&lt;div class=&#34;map&#34;&gt;&lt;/span&gt;




</code></pre>
          <pre><code data-noescape="">document.addEventListener(&#39;DOMContentLoaded&#39;, function(event) {
  document.querySelectorAll(&#39;.map&#39;).forEach(function(element) {
    new google.maps.Map(element)
  })
})
</code></pre>
          <p>
            This is what you see in JavaScript tutorials.
            </p>
        </section>
        <section>
          <h3>
            <p>
              Activating JS snippets
            </p>
            <p>
              Unpoly
            </p>
          </h3>
          <pre><code data-noescape="">&lt;div class=&#34;map&#34;&gt;&lt;/span&gt;




</code></pre>
          <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element) {
  new google.maps.Map(element)
})


</code></pre>
          <p>
            Unpoly automatically compiles all fragments that it inserts or updates.
            </p>
        </section>
        <section>
          <h3>
            <p>Getting data into your JS</p>
            <p>Random.js</p>
          </h3>
          <pre><code data-noescape="">&lt;div class=&#34;map&#34;&gt;&lt;/div&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  initMap(document.querySelector(&#39;.map&#39;), { lat: 48.75, lng: 11.45 })
&lt;/script&gt;
</code></pre>
          <pre><code data-noescape="">function initMap(element, center) {
  new google.maps.Map(element, { center: center })
})


</code></pre>
          
        </section>
        <section>
          <h3>
            <p>Getting data into your JS</p>
            <p>Unpoly</p>
          </h3>
          <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;{ lat: 48.75, lng: 11.45 }&#34;&lt;/div&gt;
 
 
 
 
</code></pre>
          <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element, center) {
  new google.maps.Map(element, center: center)
})


</code></pre>
          <p>
            The <code>[up-data] </code> attribute value is parsed as JSON and passed
            </p>
        </section>
        <section>
          <h3>Symmetry to CSS components</h3>
          <p>
            If you are using some CSS component architecture like <a href="https://css-tricks.com/bem-101/">BEM</a>
            you will find a nice symmetry between your CSS components and Unpoly compilers:
          </p>
          <div>
            <div>
              <pre><code data-noescape=""><b>app/assets/stylesheets/blocks</b>
  carousel.css
  head.css
  map.css
  screenshot.css
  tail.css</code></pre>
            </div>
            <div>
              <pre><code data-noescape=""><b>app/assets/javascripts/compilers</b>
  carousel.js
  head.js
  map.js
  screenshot.js

</code></pre>
            </div>
          </div>
          <p>
            By sticking to this pattern you will always know where to find the CSS / JS that affects
            your
            <code>&lt;div class=&#39;map&#39;&gt;...&lt;/div&gt;</code> element.
          </p>
        </section>
        <section>
          <h2>Response times</h2>
        </section>
        <section>
          <h3>
            <p>
              Reponse times
            </p>
            <p>
              How fast are SPAs?
            </p>
          </h3>
          <p>
            We want to approximate the snappiness of a AngularJS SPA
            </p>
          <ul>
            <li>
              Most of our AngularJS interactions are making API requests
              </li>
            <li>
              <p>
                Rendering to JSON takes time, too.
              </p>
              <p>
                60-300ms for index views in non-trivial app
              </p>
            </li>
            <li>
              <p>
                Client-side rendering takes time, too.
              </p>
            </li>
            <li>
              <p>
                Users do like the instantaneous feedback
              </p>
              <p>
                (even if it just shows to an empty screen that is then populated over the wire)
              </p>
            </li>
          </ul>
        </section>
        <section>
          <h3>
            <p>
              Response times
            </p>
            <p>
              Unpoly&#39;s approach
            </p>
          </h3>
          <ul>
            <li>
              Provide instantaneous feedback to all user input
              so interactions</li>
            <li>Pick <u>all</u> the low-hanging fruit that&#39;s wasting 100s of milliseconds</li>
            <li>Free up enough time budget that we can afford to render</li>
            <li>Use best practices for server performance</li>
            <li>Provide options if all that is not enough</li>
          </ul>
        </section>
        <section>
          <h3>What you get out of the box</h3>
          <ul>
            <li>
              We no longer parse and execute CSS, JavaScript and build the DOM on every request
              <p>
                makandra deck on Cards (140 ms), AMC frontend (360 ms)
              </p>
            </li>
            <li>
              Clicked links/forms get an <a href="http://unpoly.com/up-active"><code>.up-active</code></a> class while loading
              <div><p>
                Get into a habit of styling <code>.up-active</code> for instantaneous feedback</p></div>
            </li>
            <li>
              Links with an <a href="http://unpoly.com/up-instant"><code>[up-instant]</code></a> attribute load on <code>mousedown</code> instead of <code>click</code>
              
            </li>
            <li>
              Links with <a href="http://unpoly.com/up-preload"><code>[up-preload]</code></a> attribute preload destination while hovering
              <p>
                Saves ~200-400 ms minus configured delay (<a href="http://instantclick.io/click-test" target="_blank">test yourself</a>)
              </p>
            </li>
            <li>
              Responses to <code>GET</code> requests are cached for 5 minutes
              <p>
                Any non-<code>GET</code> request clears the entire cache
              </p>
            </li>
          </ul>
        </section>
        <section>
          <p>
            Feel the response time of an Unpoly app by navigating between cards on
            </p>
          </section>
        <section>
          <h3>How you can optimize further</h3>
          <ul>
            <li>Server-side fragment caching</li>
            <li>Tailor responses for the requested selector</li>
            <li>Spinners for long-running requests</li>
            <li>We can still implement client-side interactions</li>
            <li>Go nuclear with two-way bindings</li>
          </ul>
        </section>
        <section>
          <h3>Tailor responses for the requested selector</h3>
          <pre><code data-noescape="">&lt;html&gt;
  &lt;body&gt;

    &lt;% if up.target?(&#39;.side&#39;) %&gt;
      &lt;div class=&#39;side&#39;&gt;
        ...
      &lt;/div&gt;
    &lt;% end %&gt;

    &lt;% if up.target?(&#39;.main&#39;) %&gt;
      &lt;div class=&#39;main&#39;&gt;
        ...
      &lt;/div&gt;
    &lt;% end %&gt;

  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
          <p>
            <code>up.target?(css)</code> looks at the <code>X-Up-Target</code> HTTP header
            </p>
        </section>
        <section>
          <h3>Spinners</h3>
          <p>
            For the occasional long-running request, you can configure this globally:
          </p>
          <pre><code data-noescape="">&lt;div class=&#34;spinner&#34;&gt;Please wait!&lt;/div&gt;
</code></pre>
          <pre><code data-noescape="">up.compiler(&#39;.spinner&#39;, function(element) {
  function show() { element.style.display = &#39;block&#39; }
  function hide() { element.style.display = &#39;none&#39; }
  up.on(&#39;up:proxy:slow&#39;, show)
  up.on(&#39;up:proxy:recover&#39;, hide)
  hide()
});
</code></pre>
          <p>
            The <code>up:proxy:slow</code> event is triggered after 300 ms (configurable).
          </p>
        </section>
        <section>
          <h3>We can still implement interactions on the client</h3>
          <pre><code data-noescape="">&lt;div class=&#39;greeter&#39;&gt;
  &lt;input class=&#39;greeter--input&#39;&gt;
  Hello &lt;span class=&#39;greeter--name&#39;&gt;&lt;span&gt;!
&lt;/div&gt;
</code></pre>
          <pre><code data-noescape="">up.compiler(&#39;.greeter&#39;, function(element) {
  let input = element.querySelector(&#39;.greeter--input&#39;)
  let name = element.querySelector(&#39;.greeter--name&#39;)
  input.addEventListener(&#39;input&#39;, function() {
    name.textContent = input.value
  })
})
</code></pre>
        </section>
        <section>
          <h3>
            <p>
              Going nuclear
            </p>
            <p>
              Two-way bindings
            </p>
          </h3>
          <p>
            With <a href="http://rivetsjs.com/">Rivets.js</a> (6 KB):
          </p>
          <pre><code data-noescape="">&lt;div class=&#39;template&#39; up-data=&#39;{ &#34;name&#34;: &#34;Arne&#34; }&#39;&gt;
  &lt;input rv-value=&#39;name&#39;&gt;
  Hello { name }!
&lt;/div&gt;
</code></pre>
          <pre><code data-noescape="">up.compiler(&#39;.template&#39;, function(element, data) {
  let view = rivets.bind(element, data)
  return function() { view.unbind } // clean up
})
</code></pre>
        </section>
        <section>
          <h2>
            Composability
          </h2>
          <p>
            Homegrown UJS syntax usually lacks composability.
            </p>
        </section>
        <section>
          <h3>
            <p>Composability</p>
            <p>JavaScript API</p>
          </h3>
          <p>
            Unpoly&#39;s default UJS behavior is a small layer around a JS API.
            </p>
          <h4><u>U</u>nobtrusive</h4>
          <pre><code data-noescape="">&lt;a href=&#34;full.html&#34; up-target=&#34;.story&#34;&gt;Continue&lt;/a&gt;
</code></pre>
          <h4><u>P</u>rogrammatic</h4>
          <pre><code>up.replace(&#39;.story&#39;, &#39;full.html&#39;)
</code></pre>
        </section>
        <section>
          <h3>
            <p>Composability</p>
            <p>Events</p>
          </h3>
          <pre><code>$(document).on(&#39;up:modal:open&#39;, function(event) {
  if (dontLikeModals()) {
    event.preventDefault()
  }
})
</code></pre>
        </section>
        <section>
          <h3>
            <p>Composability</p>
            <p>Invent your own UJS syntax</p>
          </h3>
          <h4>HTML</h4>
          <pre><code data-noescape="">&lt;a <mark>menu-link</mark> href=&#34;/details&#34;&gt;Show more&lt;/span&gt;
</code></pre>
          <div>
            <h4>JavaScript</h4>
            <pre><code>up.compiler(&#39;[menu-link]&#39;, function(element) {
  element.addEventListener(&#39;click&#39;, function(event) {
    event.preventDefault();
    up.popup.attach(element, {
      target: &#39;.menu&#39;,
      position: &#39;bottom-left&#39;,
      animation: &#39;roll-down&#39;
    });
  });
});
</code></pre>
          </div>
        </section>
        <section>
          <h3>The JavaScript API is extensive</h3>
          <p>
            View full documentation of JS functions,</p>
        </section>
        <section>
          <h2>Animation</h2>
          <p>
            When a new element enters the DOM, you can <b>animate</b> the appearance:
          </p>
          <pre><code data-noescape="">&lt;a href=&#34;/settings&#34; up-modal=&#34;.menu&#34; up-animation=&#34;fade-in&#34;&gt;
  Open settings
&lt;/a&gt;

</code></pre>
          <p>
            When you swap an element, you can <b>transition</b> between the old and new states:
          </p>
          <pre><code data-noescape="">&lt;a href=&#34;/users&#34; up-target=&#34;.list&#34; up-transition=&#34;cross-fade&#34;&gt;
  Show users
&lt;/a&gt;
</code></pre>
          <p>
            Animations are implemented via CSS transforms on a 3D-accelerated layer.
          </p>
        </section>
        <section>
          <h2>Forms</h2>
          <p>
            Painful things with forms:
          </p>
          <ul>
            <li>Submitting a form via AJAX</li>
            <li>File uploads via AJAX</li>
            <li>Detecting redirects of an AJAX form submission</li>
            <li>Dealing with validation errors of an AJAX form submission</li>
            <li>Server-side validations without a page load</li>
            <li>Dependencies between fields</li>
            <li>Submitting a form within a modal while keeping the modal open</li>
          </ul>
          <p>
            These are all solved by Unpoly.
          </p>
        </section>
        <section>
          <section>
            <h3>Ajax forms</h3>
            <p>
              A form with <code>[up-target]</code> will be submitted via AJAX
              and leave surrounding elements intact:
            </p>
            <pre><code data-noescape="">&lt;form method=&#34;post&#34; action=&#34;/users&#34; <mark>up-target=&#34;.main&#34;</mark>&gt;
  ...
&lt;/form&gt;
</code></pre>
            <p>A successful submission (status 200) will update <code>.main</code></p>
            <p>
              A failed submission (non-200 status) will update the form itself
              </p>
          </section>
          <section>
            <h3>Return non-200 status</h3>
            <pre><code data-noescape="">class UsersController &lt; ApplicationController

  def create
    user_params = params[:user].permit(:email, :password)
    @user = User.new(user_params)
    if @user.save?
      sign_in @user
    else
      render &#39;form&#39;, <mark>status: :bad_request</mark>
    end
  end

end
</code></pre>
          </section>
        </section>
        <section>
          <h3>Forms within a modal</h3>
          <p>
            To <b>stay</b> within the modal, target a selector <b>within</b> the modal:
          </p>
          <pre><code data-noescape="">&lt;form up-target=&#34;.selector-within-modal&#34;&gt;
  ...
&lt;/form&gt;
</code></pre>
          <p>
            To <b>close</b> the modal, target a selector <b>behind</b> the modal:
          </p>
          <pre><code data-noescape="">&lt;form up-target=&#34;.selector-behind-modal&#34;&gt;
  ...
&lt;/form&gt;
</code></pre>
        </section>
        <section>
          <h3>
            <p>Server-side validations</p>
            <p>without a page load</p>
          </h3>
          <pre><code data-noescape="">&lt;form action=&#34;/users&#34;&gt;

  &lt;fieldset&gt;
    &lt;label&gt;E-mail&lt;/label&gt;
    &lt;input type=&#34;text&#34; name=&#34;email&#34; <mark>up-validate</mark>&gt;
  &lt;/label&gt;

  &lt;fieldset&gt;
    &lt;label&gt;Password&lt;/label&gt;
    &lt;input type=&#34;password&#34; name=&#34;password&#34;&gt;
  &lt;/fieldset&gt;

  &lt;button type=&#34;submit&#34;&gt;Register&lt;/button&gt;

&lt;/form&gt;
</code></pre>
        </section>
        <section>
          <h3>
            <p>Server-side validations</p>
            <p>without a page load</p>
          </h3>
          <pre><code data-noescape="">&lt;form action=&#34;/users&#34;&gt;

  <mark>&lt;fieldset&gt;                                    </mark>
  <mark>  &lt;label&gt;E-mail&lt;/label&gt;                       </mark>
  <mark>  &lt;input type=&#34;text&#34; name=&#34;email&#34; up-validate&gt;</mark>
  <mark>&lt;/label&gt;                                      </mark>

  &lt;fieldset&gt;
    &lt;label&gt;Password&lt;/label&gt;
    &lt;input type=&#34;password&#34; name=&#34;password&#34;&gt;
  &lt;/fieldset&gt;

  &lt;button type=&#34;submit&#34;&gt;Register&lt;/button&gt;

&lt;/form&gt;
</code></pre>
        </section>
        <section>
          <h3>
            <p>Server-side validations</p>
            <p>without a page load</p>
          </h3>
          <pre><code data-noescape="">&lt;form action=&#34;/users&#34;&gt;

  <mark>&lt;fieldset class=&#34;has-error&#34;&gt;                                      </mark>
  <mark>  &lt;label&gt;E-mail has already been taken!&lt;/label&gt;                   </mark>
  <mark>  &lt;input type=&#34;text&#34; name=&#34;email&#34; up-validate value=&#34;foo@bar.com&#34;&gt;</mark>
  <mark>&lt;/label&gt;                                                          </mark>

  &lt;fieldset&gt;
    &lt;label&gt;Password&lt;/label&gt;
    &lt;input type=&#34;password&#34; name=&#34;password&#34;&gt;
  &lt;/fieldset&gt;

  &lt;button type=&#34;submit&#34;&gt;Register&lt;/button&gt;

&lt;/form&gt;
</code></pre>
        </section>
        <section>
          <h3>
            <p>Server-side validations</p>
            <p>without a page load</p>
          </h3>
          <pre><code data-noescape="">class UsersController &lt; ApplicationController

  def create
    @user = User.new(user_params)
    if @user.save
      sign_in @user
    else
      render &#39;form&#39;, status: :bad_request
    end
  end

end



</code></pre>
        </section>
        <section>
          <h3>
            <p>Server-side validations</p>
            <p>without a page load</p>
          </h3>
          <pre><code data-noescape="">class UsersController &lt; ApplicationController

  def create
    @user = User.new(user_params)
    <mark>if up.validate?</mark>
    <mark>  @user.valid? </mark> # run validations, but don&#39;t save to DB
    <mark>  render &#39;form&#39;</mark> # render form with error messages
    elsif @user.save?
      sign_in @user
    else
      render &#39;form&#39;, status: :bad_request
    end
  end

end
</code></pre>
        </section>
        <section>
          <h3>
            <p>Dependent fields</p>
            <p>Simple cases</p>
          </h3>
          <p>
            Use <a href="http://unpoly.com/up-switch" target="_blank"><code>[up-switch]</code></a> to show or hide existing elements based on a control value:
          </p>
          <pre><code data-noescape="">&lt;select name=&#34;advancedness&#34; up-switch=&#34;.target&#34;&gt;
  &lt;option value=&#34;basic&#34;&gt;Basic parts&lt;/option&gt;
  &lt;option value=&#34;advanced&#34;&gt;Advanced parts&lt;/option&gt;
&lt;/select&gt;

&lt;div class=&#34;target&#34; up-show-for=&#34;basic&#34;&gt;
  only shown for advancedness = basic
&lt;/div&gt;

&lt;div class=&#34;target&#34; up-hide-for=&#34;basic&#34;&gt;
  hidden for advancedness = basic
&lt;/div&gt;
</code></pre>
        </section>
        <section>
          <h3>
            <p>Dependent fields</p>
            <p>Harder cases</p>
          </h3>
          <p>
            Use <a href="http://unpoly.com/up-validate" target="_blank"><code>[up-validate]</code></a> to update a field from the server when a control value changes.
          </p>
          <p>
            In the example below we load a list of employees when the user selects a department:
          </p>
          <pre><code data-noescape="">&lt;form action=&#34;/contracts&#34;&gt;
  &lt;select name=&#34;department&#34; <mark>up-validate=&#34;[name=employee]&#34;</mark>&gt;...&lt;/select&gt;
  &lt;select name=&#34;employee&#34;&gt;...&lt;/select&gt;
&lt;/form&gt;

</code></pre>
        </section>
        <section>
          <h3>
            What server-side apps
            <p>
              don&#39;t do well
            </p>
          </h3>
          <ol>
            <li>Slow interaction feedback</li>
            <li>
              Page loads destroy transient state
              <p>(scroll positions, unsaved form values, focus)</p>
            </li>
            <li>
              Layered interactions are hard
              <p>(modals, drop-downs, drawers)</p>
            </li>
            <li>Animation is complicated</li>
            <li>Complex forms</li>
          </ol>
        </section>
        <section>
          <h3>
            What server-side apps
            <p>
              can actually be okay at
            </p>
          </h3>
          <ol>
            <li>Slow interaction feedback</li>
            <li>
              Page loads destroy transient state
              <p>(scroll positions, unsaved form values, focus)</p>
            </li>
            <li>
              Layered interactions are hard
              <p>(modals, drop-downs, drawers)</p>
            </li>
            <li>Animation is complicated</li>
            <li>Complex forms</li>
          </ol>
        </section>
        <section>
          <img height="600" src="https://www.eviau.net/blogue/pictures/trade_off.png"/>
        </section>
        <section>
          <h2>Getting started</h2>
          <ul>
            <li>
              Check out <a href="http://unpoly.com">unpoly.com</a>
              to get an overview of what&#39;s included
            </li>
            <li><code>npm install unpoly --save</code> or <code>gem &#39;unpoly-rails&#39;</code> (<a href="http://unpoly.com/install">other methods</a>)</li>
            <li>Replace half your JavaScript with <code>[up-target]</code> attributes</li>
            <li>Convert remaining JavaScripts into <code>up.compiler()</code></li>
          </ul>
        </section>
        <section>
          <img src="https://www.eviau.net/blogue/pictures/logos/unpoly.png" width="50%"/>
          <p>
            <a href="mailto:henning.koch@makandra.de">henning.koch@makandra.de</a>
            </p>
        </section>
        <section>
          <h2>Additional slides</h2>
        </section>
        <section>
          <h3>
            Update a page fragment
            <p>
              without JavaScript
            </p>
          </h3>
          <p>
            <a href="http://unpoly.com/examples/update-fragment/" target="_blank">Run example on unpoly.com</a>
          </p>
          <div>
            <div>
              <h4>short.html</h4>
              <pre><code data-noescape="">&lt;div class=&#34;story&#34;&gt;

  &lt;p&gt;Story summary&lt;/p&gt;

  &lt;a href=&#34;full.html&#34; <mark>up-target=&#34;.story&#34;</mark>&gt;
    Read full story
  &lt;/a&gt;

&lt;/div&gt;

<mark>&lt;p&gt;This text won&#39;t change&lt;/p&gt;</mark>
</code></pre>
            </div>
            <div>
              <h4>full.html</h4>
              <pre><code data-noescape="">&lt;div class=&#34;story&#34;&gt;

  &lt;h1&gt;Full story&lt;/h1&gt;

  &lt;p&gt;Lorem ipsum dolor sit amet.&lt;/p&gt;

  &lt;a href=&#34;short.html&#34; <mark>up-target=&#34;.story&#34;&gt;</mark>
    Read summary
  &lt;/a&gt;

&lt;/div&gt;</code></pre>
            </div>
          </div>
          <ul>
            <li>Unpoly requests <code>full.html</code> via AJAX</li>
            <li>Server renders a <u>full HTML page</u></li>
            <li>Unpoly extracts the fragment that matches <code>.story</code></li>
            <li>Unpoly swaps the old and new fragment</li>
            <li>Unpoly changes the browser URL to <code>http://host/full.html</code></li>
          </ul>
        </section>
        <section>
          <h3>
            Open fragment in modal dialog
            <p>
              without JavaScript
            </p>
          </h3>
          <p>
            <a href="http://unpoly.com/examples/modal/">Run example on unpoly.com</a>
          </p>
          <pre><code data-noescape="">&lt;div class=&#34;story&#34;&gt;

  &lt;p&gt;Story summary&lt;/p&gt;

  &lt;a href=&#34;full.html&#34; <mark>up-modal=&#34;.story&#34;</mark>&gt;
    Read full story
  &lt;/a&gt;

&lt;/div&gt;
</code></pre>
          <ul>
            <li>Unpoly requests <code>full.html</code> via AJAX</li>
            <li>Server renders a <u>full HTML page</u></li>
            <li>Unpoly extracts the fragment that matches <code>.story</code></li>
            <li>Unpoly displays the new fragment in a <code>&lt;div class=&#34;up-modal&#34;&gt;</code></li>
            <li>Unpoly changes the browser URL to <code>http://host/full.html</code></li>
          </ul>
        </section>
        <section>
          <h3>
            Open fragment in a popup menu
            <p>
              without JavaScript
            </p>
          </h3>
          <p>
            <a href="http://unpoly.com/examples/modal/">Run example on unpoly.com</a>
          </p>
          <pre><code data-noescape="">&lt;div class=&#34;story&#34;&gt;

  &lt;p&gt;Story summary&lt;/p&gt;

  &lt;a href=&#34;full.html&#34; <mark>up-popup=&#34;.story&#34;</mark>&gt;
    Read full story
  &lt;/a&gt;

&lt;/div&gt;
</code></pre>
          <ul>
            <li>Unpoly requests <code>full.html</code> via AJAX</li>
            <li>Server renders a <u>full HTML page</u></li>
            <li>Unpoly extracts the fragment that matches <code>.story</code></li>
            <li>Unpoly displays the new fragment in a <code>&lt;div class=&#34;up-popup&#34;&gt;</code></li>
            <li>Unpoly changes the browser URL to <code>http://host/full.html</code></li>
          </ul>
        </section>
        <section>
          <h3>
            <p>All Async actions return promises</p>
          </h3>
          <pre><code>up.replace(&#39;.story&#39;, &#39;full.html&#39;).then(function() {
  // Fragments were loaded and swapped
});
</code></pre>
          <pre><code>up.morph(&#39;.old&#39;, &#39;.new&#39;, &#39;cross-fade&#39;).then(function() {
  // Transition has completed
});
</code></pre>
          <p>
            <a href="https://makandracards.com/curriculum/35275-javascript-writing-asynchronous-code" target="_blank">Curriculum lesson on promises</a>
          </p>
        </section>
        <section>
          <h3>Appending instead of replacing</h3>
          <pre><code data-noescape="">&lt;div class=&#34;tasks&#34;&gt;
  &lt;li&gt;Wash car&lt;/li&gt;
  &lt;li&gt;Purchase supplies&lt;/li&gt;
  &lt;li&gt;Fix tent&lt;/li&gt;
&lt;/ul&gt;

&lt;a class=&#34;next-page&#34; href=&#34;/tasks?page=2&#34;
  up-target=&#34;<mark>.tasks:after</mark>, .next-page&#34;&gt;Next page&lt;/a&gt;
</code></pre>
          <p>
            This appends the second page to the task list
            and replaces the &#34;Next page&#34; button with a link to page 3.
          </p>
        </section>
        <section>
          <section>
            <h3>Persisting elements</h3>
            <pre><code data-noescape="">&lt;div class=&#34;story&#34;&gt;

  &lt;video <mark>up-keep</mark> src=&#34;movie.mp4&#34;&gt;&lt;/video&gt;

  &lt;p&gt;Story summary&lt;/p&gt;

  &lt;a href=&#34;full.html&#34; up-target=&#34;.story&#34;&gt;
    Read full story
  &lt;/a&gt;

&lt;/div&gt;



</code></pre>
          </section>
          <section>
            <h2>Updating persisted elements</h2>
          </section>
          <section>
            <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;[
  { lat: 48.36, lng: 10.99 },
  { lat: 48.75, lng: 11.45 }
]&#34;&gt;&lt;/div&gt;

&lt;form method=&#34;post&#34; action=&#34;/pins&#34; <mark>up-target=&#34;.map&#34;</mark>&gt;
  Lat: &lt;input name=&#34;lat&#34;&gt;
  Lng: &lt;input name=&#34;lng&#34;&gt;
  &lt;button&gt;Add pin&lt;/button&gt;
&lt;/form&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element, pins) {
  var map = new google.maps.Map(element)
  pins.forEach(function(pin) {
    var position = new google.maps.LatLng(pin.lat, pin.lng);
    new google.maps.Marker({
      position: position,
      map: map
    })
})
</code></pre>
          </section>
          <section>
            <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;&lt;%= @pins.to_json %&gt;&#34;&gt;&lt;/div&gt;
 
 
 
 
&lt;form method=&#34;post&#34; action=&#34;/pins&#34; <mark>up-target=&#34;.map&#34;</mark>&gt;
  Lat: &lt;input name=&#34;lat&#34;&gt;
  Lng: &lt;input name=&#34;lng&#34;&gt;
  &lt;button&gt;Add pin&lt;/button&gt;
&lt;/form&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element, pins) {
  var map = new google.maps.Map(element);
  pins.forEach(function(pin) {
    var position = new google.maps.LatLng(pin.lat, pin.lng)
    new google.maps.Marker({
      position: position,
      map: map
    })
})
</code></pre>
          </section>
          <section>
            <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;&lt;%= @pins.to_json %&gt;&#34;&gt;&lt;/div&gt;




&lt;%= form_for Pin.new, html: { &#39;up-target&#39; =&gt; &#39;.map&#39; } do |form| %&gt;
  Lat: &lt;%= form.text_field :lat %&gt;
  Lng: &lt;%= form.text_field :lng %&gt;
  &lt;%= form.submit &#39;Add pin&#39; %&gt;
&lt;% end %&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element, pins) {
  var map = new google.maps.Map(element)
  pins.forEach(function(pin) {
    var position = new google.maps.LatLng(pin.lat, pin.lng)
    new google.maps.Marker({
      position: position,
      map: map
    })
})
</code></pre>
          </section>
          <section>
            <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;&lt;%= @pins.to_json %&gt;&#34;&gt;&lt;/div&gt;




&lt;%= form_for Pin.new, html: { &#39;up-target&#39; =&gt; &#39;.map&#39; } do |form| %&gt;
  Lat: &lt;%= form.text_field :lat %&gt;
  Lng: &lt;%= form.text_field :lng %&gt;
  &lt;%= form.submit &#39;Add pin&#39; %&gt;
&lt;% end %&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function(element, initialPins) {
  var map = new google.maps.Map(element)
  function renderPins(pins) { ... }
  renderPins(initialPins)
});
 
 
 
 
</code></pre>
          </section>
          <section>
            <pre><code data-noescape="">&lt;div class=&#34;map&#34; up-data=&#34;&lt;%= @pins.to_json %&gt;&#34; <mark>up-keep</mark>&gt;&lt;/div&gt;




&lt;%= form_for Pin.new, html: { &#39;up-target&#39; =&gt; &#39;.map&#39; } do |form| %&gt;
  Lat: &lt;%= form.text_field :lat %&gt;
  Lng: &lt;%= form.text_field :lng %&gt;
  &lt;%= form.submit &#39;Add pin&#39; %&gt;
&lt;% end %&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.map&#39;, function($element, initialPins) {
  var map = new google.maps.Map($element);
  function renderPins(pins) { ... }
  renderPins(initialPins)
  <mark>element.addEventListener(&#39;up:fragment:keep&#39;, function(event) {</mark>
  <mark>  renderPins(event.newData)                                   </mark>
  <mark>})                                                            </mark>
})
 


</code></pre>
          </section>
        </section>
        <section>
          <h3>Find-as-you-type search</h3>
          <pre><code data-noescape="">&lt;form action=&#34;/users&#34; up-target=&#34;.list&#34; <mark>up-autosubmit</mark>&gt;
  &lt;input type=&#34;search&#34; name=&#34;query&#34; /&gt;
&lt;/form&gt;

&lt;div class=&#34;list&#34;&gt;
  &lt;% @users.each do |user| %&gt;
    &lt;%= link_to user.email, user &gt;
  &lt;% end %&gt;
&lt;/div&gt;



</code></pre>
        </section>
        <section>
          <section>
            <h2>
              <p>
                Memory leaks
              </p>
            </h2>
            <ul>
              <li>
                A regular Random.js app is <b>full of memory leaks</b>.
              </li>
              <li>
                We just don&#39;t notice because the JavaScript VM is reset between page loads!
              </li>
              <li>
                We can&#39;t have memory leaks in persistent JavaScript VMs
                <p>
                  like Angular.js, Unpoly, Turbolinks
                </p>
              </li>
              <li>
                Background: <a href="https://makandracards.com/makandra/31325-how-to-create-memory-leaks-in-jquery">one</a>,
                <a href="https://makandracards.com/makandra/31289-how-to-create-giant-memory-leaks-in-angularjs">two</a>.
              </li>
            </ul>
          </section>
          <section>
            <h3>Random.js</h3>
            <h4>HTML</h4>
            <pre><code data-noescape="">&lt;clock&gt;&lt;/clock&gt;
</code></pre>
            <h4>JavaScript</h4>
            <pre><code data-noescape="">$.unobtrusive(function() {
  $(this).find(&#39;clock&#39;, function() {

    var $clock = $(this);

    function updateClock() {
      var now = new Date();
      $clock.html(now.toString());
    }

    setInterval(updateClock, 1000);

  });
});
</code></pre>
          </section>
          <section>
            <h3>Random.js: <span>Leaky</span></h3>
            <h4>HTML</h4>
            <pre><code data-noescape="">&lt;clock&gt;&lt;/clock&gt;
</code></pre>
            <h4>JavaScript</h4>
            <pre><code data-noescape="">$.unobtrusive(function() {
  $(this).find(&#39;clock&#39;, function() {

    var $clock = $(this);

    function updateClock() {
      var now = new Date();
      $clock.html(now.toString());
    }

    <mark>setInterval(updateClock, 1000);</mark> // creates one interval per &lt;clock&gt;!

  });
});
</code></pre>
          </section>
          <section>
            <h3>Unpoly compiler: <span>Still leaky</span></h3>
            <h4>HTML</h4>
            <pre><code data-noescape="">&lt;clock&gt;&lt;/clock&gt;
</code></pre>
            <h4>JavaScript</h4>
            <pre><code data-noescape="">up.compiler(&#39;clock&#39;, function(clock) {

  function updateClock() {
    var now = new Date()
    clock.textContent = now.toString()
  }

  <mark>setInterval(updateClock, 1000)</mark> // this still leaks memory!
});
 
 
 
 
 
</code></pre>
          </section>
          <section>
            <h3>Unpoly compiler: <span>Clean</span></h3>
            <h4>HTML</h4>
            <pre><code data-noescape="">&lt;clock&gt;&lt;/clock&gt;
</code></pre>
            <h4>JavaScript</h4>
            <pre><code data-noescape="">up.compiler(&#39;clock&#39;, function(clock) {

  function updateClock() {
    var now = new Date()
    clock.textContent = now.toString()
  }

  var interval = setInterval(updateClock, 1000)

  <mark>return function() { clearInterval(interval) }</mark> // clean up when destroyed
})
 
 
 
</code></pre>
          </section>
          <section>
            <h3>Unpoly compiler: <span>Leaky</span></h3>
            <pre><code data-noescape="">up.compiler(&#39;textarea.wysiwyg&#39;, function(textarea) {
  $R(textarea)
})
 
 
 
</code></pre>
          </section>
          <section>
            <h3>Unpoly compiler: <span>Clean</span></h3>
            <pre><code data-noescape="">up.compiler(&#39;textarea.wysiwyg&#39;, function(textarea) {
  $R(textarea)
  return function() {
    $R(textarea, &#39;destroy&#39;)
  }
})

</code></pre>
          </section>
        </section>
        <section>
          <section data-background-color="#000">
            <h3>Why transitions are hard</h3>
            </section>
          <section data-background-color="#000">
            <h3>Why transitions are hard</h3>
            </section>
          <section>
            <h3>Ghosting</h3>
            <div>
              
              
              <div><p>
                Old (ghost)
                </p><p>
                  position: absolute
                </p>
              </div>
              <div><p>
                New (ghost)
                </p><p>
                  position: absolute
                </p>
              </div>
            </div>
          </section>
          <section data-background-color="#000">
            <h3>Without ghosting</h3>
            </section>
          <section data-background-color="#000">
            <h3>With ghosting</h3>
            </section>
          <section>
            <div>
              <div>
                <h4>Predefined animations</h4>
                <pre><code data-noescape="">fade-in
fade-out
move-to-top
move-from-bottom
move-to-bottom
move-from-top
move-to-left
move-from-right
move-to-right
move-from-left
</code></pre>
              </div>
              <div>
                <h4>Predefined transitions</h4>
                <pre><code data-noescape="">cross-fade
move-top
move-bottom
move-left
move-right
</code></pre>
              </div>
            </div>
          </section>
          <section>
            <h3>Custom animations</h3>
            <pre><code data-noescape="">up.animation(&#39;zoom-in&#39;, function(element, options) {

  var firstFrame = {
    opacity: 0,
    transform: &#39;scale(0.5)&#39;
  }

  var lastFrame = {
    opacity: 1,
    transform: &#39;scale(1)&#39;
  }

  up.element.setStyle(element, firstFrame)
  return up.animate(element, lastFrame, options)

})
</code></pre>
          </section>
        </section>
        <section>
          <section>
            <h3>
              <span>Toggle all: </span> On load
            </h3>
            <pre><code data-noescape="">&lt;span class=&#34;toggle-all&#34;&gt;Toggle all&lt;/span&gt;
</code></pre>
            <pre><code data-noescape="">document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
  document.querySelectorAll(&#39;.toggle-all&#39;).forEach(function(element) {
    element.addEventListener(&#39;click&#39;, function() {
      let form = element.closest(&#39;form&#39;);
      let checkboxes = form.querySelectorAll(&#39;input[type=checkox]&#39;);
      let someUnchecked = !!checkboxes.find(function(cb) { !cb.checked }
      checkboxes.forEach(function(cb) {
        cb.checked = someUnchecked
      })
    })
  })
})
 
 
</code></pre>
            <p>
              <a href="http://codepen.io/triskweline/pen/MyrVgG" target="_blank">Run example on codepen.io</a>.</p>
          </section>
          <section>
            <h3>
              <span>Toggle all: </span> Angular directive
            </h3>
            <pre><code data-noescape="">&lt;span class=&#34;toggle-all&#34;&gt;Toggle all&lt;/span&gt;
</code></pre>
            <pre><code data-noescape="">app.directive(&#39;toggle-all&#39;, function() {
  return {
    restrict: &#39;C&#39;,
    link: function(scope, $link) {
      $link.on(&#39;click&#39;, function() {
        var $form = $link.closest(&#39;form&#39;)
        var $checkboxes = $form.find(&#39;:checkbox&#39;)
        var someUnchecked = $checkboxes.is(&#39;:not(:checked)&#39;)
        $checkboxes.prop(&#39;checked&#39;, someUnchecked)
      })
    }
  }
})
</code></pre>
            <p>
              It&#39;s nice how Angular lets us register a compiling function for a CSS selector.
              </p>
          </section>
          <section>
            <h3>
              <span>Toggle all: </span> Unpoly compiler
            </h3>
            <pre><code data-noescape="">&lt;span class=&#34;toggle-all&#34;&gt;Toggle all&lt;/span&gt;
</code></pre>
            <pre><code data-noescape="">up.compiler(&#39;.toggle-all&#39;, function(element) {
  element.addEventListener(&#39;click&#39;, function() {
    let form = element.closest(&#39;form&#39;);
    let checkboxes = form.querySelectorAll(&#39;input[type=checkox]&#39;);
    let someUnchecked = !!checkboxes.find(function(cb) { !cb.checked }
    checkboxes.forEach(function(cb) {
      cb.checked = someUnchecked
    })
  })
})
</code></pre>
            <p>
              Unpoly automatically compiles all fragments that it inserts or updates.
            </p>
          </section>
        </section>
        <section>
          <h3>Legacy browsers</h3>
          <p>
            Unpoly gracefully degrades with old versions of Internet Explorer:
          </p>
          <table>
            <tbody><tr>
              <th>Edge</th>
              <td>Full support</td>
            </tr>
            <tr>
              <th>IE 10</th>
              <td>Full support</td>
            </tr>
            <tr>
              <th>IE 9</th>
              <td>
                Page updates that change browser history</td>
            </tr>
            <tr>
              <th>IE8</th>
              <td>Unpoly prevents itself from booting,</td>
            </tr>
          </tbody></table>
        </section>
        <section>
          <h3>Bootstrap integration</h3>
          <ul>
            <li>
              Include <a href="https://raw.githubusercontent.com/unpoly/unpoly/master/dist/unpoly-bootstrap3.js">unpoly-bootstrap3.js</a> and
              <a href="https://raw.githubusercontent.com/unpoly/unpoly/master/dist/unpoly-bootstrap3.css">unpoly-bootstrap3.css</a>
            </li>
            <li>
              Configures Unpoly to use Bootstrap styles for dialogs,</li>
            <li>
              Makes Unpoly aware of fixed Bootstrap layout components when scrolling the viewport.
            </li>
            <li>
              In general we try to not do things that would totally clash with Bootstrap.
            </li>
          </ul>
        </section>
        <section>
          <h3>Rails integration</h3>
          <p>
            Include <a href="http://www.rubydoc.info/gems/unpoly-rails/">unpoly-rails</a> In your <code>Gemfile</code>:
          </p>
          <pre><code>gem &#39;unpoly-rails&#39;
</code></pre>
          <p>
            In your controllers, views and helpers:
          </p>
          <pre><code>up?                            # request.headers[&#39;X-Up-Target&#39;].present?
up.target                      # request.headers[&#39;X-Up-Target&#39;]
up.title = &#39;Title from server&#39; # response.headers[&#39;X-Up-Title&#39;] = &#39;Title ...&#39;
up.validate?                   # request.headers[&#39;X-Up-Validate&#39;].present?
</code></pre>
          <p>
            The gem also provides the JS and CSS assets for the latest Unpoly.
          </p>
        </section>
        <section>
          <h3>Other installation methods</h3>
          <ul>
            <li>
              <a href="http://unpoly.com/download#bower">Install with Bower</a>
            </li>
            <li>
              <a href="http://unpoly.com/download#cdn">Link to a CDN</a>
            </li>
            <li>
              <a href="http://unpoly.com/download#zip">Download as ZIP</a>
            </li>
            <li>
              <a hrf="http://unpoly.com/download#git">Clone with Git</a>
            </li>
          </ul>
          <p>
            Although the Rails bindings are nice, Unpoly works with any kind of backend.</p>
        </section>
        <section>
          <section>
            <h3>Unit testing</h3>
            <p>
              Use <a href="http://jasmine.github.io/">Jasmine</a> to describe examples.</p>
            <pre><code data-noescape="">up.compiler(&#39;.current-year&#39;, function($element) {
  var year = new Date().getFullYear();
  $element.text(year);
});
</code></pre>
            <pre><code data-noescape="">describe(&#39;.current-year&#39;, function() {
  it(&#34;displays today&#39;s year&#34;, function() {
    $element = affix(&#39;.current-today&#39;);
    up.hello($element);
    year = new Date().getFullYear();
    expect($element).toHaveText(year.toString());
  });
});
</code></pre>
          </section>
          <section>
            <h3>Easier integration testing</h3>
            <p>
              Disable animation:
            </p>
            <pre><code data-noescape="">up.motion.config.enabled = false;
</code></pre>
            <p>
              Disable concurrent requests:
            </p>
            <pre><code data-noescape="">up.proxy.config.maxRequests = 1;
</code></pre>
            <p>
              Wait before you do things:
            </p>
            <pre><code data-noescape="">AfterStep do
  sleep 0.05 while page.evaluate_script(&#39;window.up &amp;&amp; up.proxy.isBusy()&#39;)
end</code></pre>
            <p>
              (Or use <a href="https://github.com/makandra/spreewald#waiting-for-page-load"><code>patiently</code></a>).
            </p>
          </section>
          <section>
            <p>
              Use <a href="https://github.com/jasmine/jasmine-ajax">jasmine-ajax</a> to mock the network:
            </p>
            <pre><code data-noescape="">up.compiler(&#39;.server-time&#39;, function($element) {
  $element.text(&#39;Loading ...&#39;);
  up.ajax(&#39;/time&#39;).then(function(time) { $element.text(time) };
});
</code></pre>
            <pre><code data-noescape="">describe(&#39;.current-year&#39;, function() {
  it(&#39;fetches and displays the current time from the server&#39;, function() {
    jasmine.Ajax.install();
    var $element = affix(&#39;.server-time&#39;);
    up.hello($element);
    expect($element).toHaveText(&#39;Loading...&#39;);
    jasmine.Ajax.requests.mostRecent().respondWith({
      status: 200,
      contentType: &#39;text/plain&#39;,
      responseText: &#39;13:37:00&#39;
    });
    expect($element).toHaveText(&#39;13:37:00&#39;);
  });
});

</code></pre>
          </section>
        </section>
        <section>
          <h3>Who else went back?</h3>
          <ul>
            <li>
              <a href="https://engineering.shopify.com/17489056-rebuilding-the-shopify-admin-improving-developer-productivity-by-deleting-28-000-lines-of-javascript">Shopify</a>
            </li>
            <li>
              Formkeep by Thoughtbot
            </li>
            <li>
              <a href="https://twitter.com/stympy/status/727495130018512897">Honeybadger</a>
            </li>
            <li>
              <a href="https://www.betterment.com/resources/inside-betterment/engineering/server-javascript-a-single-page-app-toa-single-page-app/">Betterment</a>
            </li>
          </ul>
        </section>
        <section>
          <h3>Project state</h3>
          <ul>
            <li>In development since October 2014</li>
            <li>
              ~ 500 specs
              <p>
                (how many specs has our Random.js?)
              </p>
            </li>
            <li>Has seen some real world pain, but we&#39;re still learning new things</li>
            <li><a href="http://unpoly.com/changelog">Changelog</a> lists breaking changes and compatible changes separately</li>
            <li><a href="http://unpoly.com/search/">API</a> marks features as either <i>stable</i> or <i>experimental</i>.</li>
            <li>There will be breaking changes, but always an upgrade path</li>
          </ul>
        </section>
        <section>
          <h3>Response times</h3>
          <ul>
            <li>
              <b>0.1 second</b> is about the limit for having the user feel that the system is reacting
              instantaneously,
              <span>meaning that no special feedback is necessary except to display the
              result.</span>
            </li>
            <li>
              <b>1.0 second</b> is about the limit for the user&#39;s flow of thought to stay uninterrupted, even
              though the user will notice the delay. <span>Normally, no special feedback is necessary during
              delays of more than 0.1 but less than 1.0 second, but the user does lose the feeling of
              operating directly on the data.</span>
            </li>
            <li>
              <b>10 seconds</b> is about the limit for keeping the user&#39;s attention focused on the dialogue.
              <span>
              For longer delays, users will want to perform other tasks while waiting for the computer
              to finish, so they should be given feedback indicating when the computer expects to be
              done. Feedback during the delay is especially important if the response time is likely to
              be highly variable, since users will then not know what to expect.</span>
            </li>
          </ul>
          <p>
            <cite>
              Miller 1968; Card et al. 1991; Jacob Nielsen 1993
            </cite>
          </p>
          <p>
            Also see Google&#39;s <a href="https://developers.google.com/web/tools/chrome-devtools/profile/evaluate-performance/rail">RAIL Performance Model</a>.
          </p>
        </section>
        <section>
          <h3>
            <p>Repurpose existing UJS syntax</p>
          </h3>
          <h4>HTML</h4>
          <pre><code data-noescape="">&lt;a menu-link href=&#34;/details&#34;&gt;Show more&lt;/span&gt;
</code></pre>
          <h4>JavaScript</h4>
          <pre><code>up.macro(&#39;[menu-link]&#39;, function($link) {
  $link.attr(
    &#39;up-target&#39;: &#39;.menu&#39;,
    &#39;up-position&#39;: &#39;bottom-left&#39;,
    &#39;up-animation&#39;: &#39;roll-down&#39;
  });
});
 
 
 



</code></pre>
        </section>
        <section>
          <h3>Is Unpoly right for my project?</h3>
          <p>
            ☑ You are not writing super ambitious UI
            </p>
          <p>
            Is your alternative home-growing an informal Random.js framework?
          </p>
        </section>
      </div>
    </div></div>
  </body>
</html>
