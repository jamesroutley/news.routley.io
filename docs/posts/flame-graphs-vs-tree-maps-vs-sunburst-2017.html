<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.brendangregg.com/blog/2017-02-06/flamegraphs-vs-treemaps-vs-sunburst.html">Original</a>
    <h1>Flame Graphs vs Tree Maps vs Sunburst (2017)</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Yesterday I posted about <a href="https://www.brendangregg.com/blog/2017-02-05/file-system-flame-graph.html">flame graphs for file systems</a>, showing how they can visualize where disk space is consumed. Many people have <a href="https://news.ycombinator.com/item?id=13574825">responded</a>, citing other tools and visualizations they prefer: du, ncdu, treemaps, and the sunburst layout. Since there&#39;s so much interest in this subject, I&#39;ve visualized the same files here (the source for linux 4.9.-rc5) in different ways for comparison.</p>

<h2>Flame Graphs</h2>

<p>Using <a href="https://github.com/brendangregg/FlameGraph">FlameGraph</a> (<a href="https://www.brendangregg.com/blog/images/2017/files_linux49.svg">SVG</a>):</p>



<p>While you can mouse-over and click to zoom, at first glance the long labeled rectangles tell the big picture, by comparing their lengths and looking at the longest first:</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_flamegraph02.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_flamegraph02.png" width="720"/></a></p>

<p>The drivers directory looks like it&#39;s over 50%, with drivers/net about 15% of the total. Many small rectangles are too thin to label, and, they also matter less overall. You can imagine printing the flame graph on paper, or including a screen shot in a slide deck, and it will still convey many high level details in not much space. Here&#39;s an <a href="https://twitter.com/ppcelery/status/828779560376299521">example</a> someone just posted to twitter.</p>

<h2>Tree Map</h2>

<p>Using <a href="https://sourceforge.net/projects/grandperspectiv/?source=typ_redirect">GrandPerspective</a> (on OSX):</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_treemap01.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_treemap01.png" width="720"/></a></p>

<p>What can you tell on first glance? Not those big picture details (drivers 50%, etc). You can mouse over tree map boxes to get more details, which this screenshot doesn&#39;t convey. It is, however, easier to see that there are a handful of large files with those boxes in the top left, which are under drivers/gpu/drm/amd.</p>

<p>Using <a href="http://www.marzocca.net/linux/baobab/index.html">Baobab</a> on Linux:</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_treemap03.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_treemap03.png" width="720"/></a></p>

<p>You can see that the drivers directory is large from the tree list on the left, which includes mini bar graphs for a visual line length comparison (good). You can&#39;t see into subdirectories without clicking to expand.</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_treemap03.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_treemap05.png" width="277"/></a></p>

<p>Here I&#39;ve highlighted the drivers/net box. What percentage is that of total from first glance?  It&#39;s a little bit more difficult to compare sizes than lengths (compare to earlier).</p>

<p>This is also missing labels, when compared to the flame graph, although other tree maps like <a href="http://www.aplusfreeware.com/categories/LFWV/SpaceMonger.html">SpaceMonger</a> do have them. An advantage to all tree maps is that we can more easily use vertical space.</p>

<h2>Sunburst</h2>

<p>Using <a href="http://www.marzocca.net/linux/baobab/index.html">Baobab</a> on Linux:</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_sunburst01.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_sunburst01.png" width="720"/></a></p>

<p>This is a flame graph (which is an adjacency diagram with an inverted icicle layout), using polar coordinates. It is very pretty, and as someone said &#34;it always wows&#34;. Sunbursts are the new pie chart.</p>

<p><a href="https://www.brendangregg.com/blog/images/2017/linux_sunburst04.png"><img src="https://www.brendangregg.com/blog/images/2017/linux_sunburst04.png"/></a></p>

<p>Deeper slices exaggerate their size, and look visually larger. 
The smaller-looking slice 2 in this image represents 27.7 Mbytes, whereas the larger-looking slice 1 is 25.6 Mbytes. This visualization is actually showing that slice 1 is smaller than slice 2, although I bet most people would think it was the other way around!
The problem is that to understand this correctly requires the comparison of angles, instead of lengths or areas, which has been evaluated as a more difficult perceptive task. </p>

<h2>ncdu</h2>

<pre>--- /home/bgregg/linux-4.9-rc5 -----------------------------------------------
                         /..          
  405.1 MiB [##########] /drivers
  139.1 MiB [###       ] /arch
   37.5 MiB [          ] /fs
   36.0 MiB [          ] /include
   35.8 MiB [          ] /Documentation
   32.6 MiB [          ] /sound
   27.8 MiB [          ] /net
   14.7 MiB [          ] /tools
    7.5 MiB [          ] /kernel
    6.0 MiB [          ] /firmware
    3.7 MiB [          ] /lib
    3.4 MiB [          ] /scripts
    3.3 MiB [          ] /mm
    3.2 MiB [          ] /crypto
    2.4 MiB [          ] /security
    1.1 MiB [          ] /block
  968.0 KiB [          ] /samples
[...]
</pre>

<p>This does have ASCII bar charts for line length comparisons, but it&#39;s only showing one directory level at a time.</p>

<h2>du</h2>

<pre>$ du -hs * | sort -hr
406M    drivers
140M    arch
38M fs
36M include
36M Documentation
33M sound
28M net
15M tools
7.5M    kernel
6.1M    firmware
3.7M    lib
3.5M    scripts
3.4M    mm
3.2M    crypto
2.4M    security
1.2M    block
968K    samples
[...]
</pre>

<p>Requires reading. Although this is so quick it&#39;s my usual starting point.</p>

<h2>Which to use</h2>

<p>If you&#39;re designing a file system usage tool, which should you use? Ideally, I&#39;d make flame graphs, tree maps, and sunbursts all available as different ways to understand the same data set. For the default view, I&#39;d probably use the flame graph, but I&#39;d want to check with many sample file systems to ensure it really works best with the data it&#39;s visualizing.</p>

<p>For more about flame graphs see my ACMQ article <a href="http://queue.acm.org/detail.cfm?id=2927301">The Flame Graph</a> (<a href="http://dl.acm.org/citation.cfm?id=2909476">CACM</a>), and for more about different visualizations see the ACMQ article <a href="http://queue.acm.org/detail.cfm?id=1805128">A Tour through the Visualization Zoo</a> (<a href="http://dl.acm.org/citation.cfm?id=1743546.1743567">CACM</a>), by Jeffrey Heer, Michael Bostock, and Vadim Ogievetsky, especially the section on Hierarchies.</p>

</div></div>
  </body>
</html>
