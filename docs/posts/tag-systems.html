<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://buttondown.email/hillelwayne/archive/tag-systems/">Original</a>
    <h1>Tag Systems</h1>
    
    <div id="readability-page-1" class="page"><div>

                

                
                    
                        <p>I’ve tried to write a blog post on tag systems for years now. Literally <em>years</em>, I think I first started drafting it out in 2018 or so? The problem is that there’s just <em>so much</em> to them, so many different approaches and models and concerns that trying to be comprehensive and rigorous is an exercise in madness.</p>
<p>So screw it. These are my noncomprehensive, poorly-researched thoughts on tag systems, thrown on the newsletter. <strong>This is not about implementation of tag systems, just their design</strong>.</p>
<h2>What is a Tag</h2>
<p>A tag is a metadata label associated with content. The tag name is also the id: two tags with the same name are the same tag. Tags appear in almost all large systems:</p>
<ul>
<li>Social media #hashtags.</li>
<li>Wikipedia categories.</li>
<li>Blog post/CMS labels.</li>
<li>AWS infrastructure tags.</li>
<li>ACM digital library index terms.</li>
</ul>
<p>Tags are primarily used for both <em>querying</em>, or discovering information based on tags, and <em>grouping</em>, or organizing content for processing. They are sometimes also used for business logic, like “all articles tagged <code>covid</code> are free even without a subscription” or “devs can upload to any s3 bucket with the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html#access_tags_control-tag-keys" target="_blank">qa</a> tag”.</p>
<p>Tags are primarily <em>client-driven</em>. You do not need to make changes to the codebase to add or a remove a tag. This is in contrast with the content <em>structure</em>, which requires dev intervention to change.</p>
<h2>Relationships between Tags</h2>
<p>In the simplest system, all tags are uniquely identified by their name. <code>horse</code> and <code>horses</code> are separate tags. This is easy to implement and reason about, but it’s also really annoying for taggers. Why should I have to tag everything with both <code>horse</code> and <code>horses</code> if they clearly mean the same thing?</p>
<h3>Tag Aliases</h3>
<p>The simplest relationship we could add are “tag aliases”: if A is aliased to B, then querying A is identical to querying B. While things could be tagged <code>horses</code>, the internal system only “knows” <code>horse</code>, and automatically converts searches for <code>horses</code> into searches for <code>horse</code>. </p>
<p>The best example of tag aliases is the fanfiction repository <a href="https://archiveofourown.org/faq/tags?language_id=en" target="_blank"><em>Archive of Our Own</em></a> (AO3). Fanfics use a lot of jargon to refer to various character pairings, which makes querying difficult. Teams of volunteers comb through stories and manually add aliases to tags, so that stories tagged <code>Snape/Harry</code> and <code>snarry</code> show up under the root tag <code>Harry/Snape</code>. </p>
<p>The additional tag structure adds expressiveness. But it also raises use-case questions, like “should users be able to query a <em>specific</em> tag alias?” ie, can I search for stories tagged with the <em>alias</em> <code>snarry</code>? There’s no correct choice here. AO3 went with “no”.</p>
<h3>Subtags</h3>
<p>In a subtag system, tags are placed into a hierarchy of parent tags and subtags. Anything tagged with the subtag also counts for the parent tag. For example, <code>quantum physics</code> could be a subtag of <code>physics</code>, which could be a subtag of <code>science</code>. Querying <code>science</code> would include content on quantum physics. A tag with no subtags is a <strong>leaf tag</strong>. This is arguably the most common kind of tag structure.</p>
<p>Implementation considerations: transitive queries are expensive, and you need to prevent cycles in the tag hierarchy (A’s parent is B, B’s parent is A). They also have major usage considerations:</p>
<ul>
<li>Can things be tagged with root tags or just leaf tags?</li>
<li>Can things be tagged with something <em>and</em> its subtag?</li>
<li>How do users search for X <em>without</em> its subtags?</li>
<li>How do set operations work? Does a book on particle physics and a book on elephant biology share the <code>science</code> tag?</li>
</ul>
<p><em>This post is sponsored by me. <a href="https://www.eventbrite.com/e/software-modeling-with-tla-workshop-tickets-520030754987?aff=email" target="_blank">I’m teaching an online TLA+ workshop</a> in March, May, and June. Use the code <code>C0MPUT3RTHINGS</code> for 15% off!</em></p>
<h3>DAG tags</h3>
<p>Most subtag systems form a forest (set of disjoint trees), where each tag has at most one parent. Wikipedia categories, on the other hand, can have multiple parents. “American Male Novelists” is a subtag of “American Male Writers” and “American Novelists”, both of which are subtags of “American Writers”. The tag system forms a directed acyclic graph, so let’s call these DAG tags.</p>
<p>DAG tags makes preventing cycles harder and adds “redundancy” as a structural design question. If A is the child of B, can C be the child of both A and B? Wikipedia <a href="https://en.wikipedia.org/wiki/Wikipedia:Categorization#Category_tree_organization" target="_blank">sort of has it both ways</a>, with “diffusing” vs “nondiffusing” subtags. Querying also gets complicated. How do we handle the query “all items with tag X but not tag Y” when an item has tag Z, which has as parents both X and Y? Is that even something you should let users query?</p>
<p>Notice that the more richness in structure we add, the more ambiguous our queries become. “Every article that shares a tag with article X that’s not also a tag on article Y” is unambiguous with simple tags, less so with a tag tree, even less so with a tag DAG. This is the standard “generality vs tractability” problem you see everywhere in CS, from static analysis to constraint solving to aliasing. Constraints liberate and liberties constraint.</p>
<h3>Smart Tags</h3>
<p>So far all the tags have been “simple”: the set of tagged items is the set specifically assigned to that tag. This is made more complicated with aliases and parent tags but the core idea of explicit assignment is there. “Smart tags” are instead based on a rule: anything matching that rule counts as having that tag. For example, any recipe that doesn’t have any nut ingredients is automatically tagged <em>nut-free</em>.</p>
<p>Smart tags are very expressive. They also play hell with any other kind structure and even themselves if you’re not careful. One mobile device manager (MDM) I worked with allowed for smart tags like “every iPad assigned to a classroom in Ferndale High School <em>that’s not tagged ABC</em>”. As a curious and extremely dumb engineer, I added two smart tags:</p>
<ul>
<li>A: “Anything tagged B”</li>
<li>B: “Anything not tagged A”</li>
</ul>
<p>And then the MDM crashed.</p>
<p>The lesson: don’t let users encode logical paradoxes. Also, don’t try making logical paradoxes on a production server.</p>
<p>Smart tags are computationally expensive. Any change to any item can potentially require a large set of re-computations. Between this and the logical paradoxes thing they’re a niche solution to specific problems. Which is a shame, I really like the idea of them.</p>
<h3>Hashtags</h3>
<p>Hashtags are a form of tagging where the tag is embedded as part of the content of the object. The archetypical example is Twitter: a tweet containing the string <code>#foo</code> is considered to have the <code>foo</code> tag. Tag membership is tested by searching the text of the content. In practice, many systems will opt to cache the tags associated with the content for performance reasons. Hashtags are very popular on social media because you don’t need to expose any additional input functionality to the user: they use the same textbox for both content and tags. </p>
<p>Hashtags have two limitations over other tagging systems. First, they have to be parsed as part of the content. This means Twitter cannot have the hashtag <code>#this tag</code> due to the parser interpreting the space as the end of the tag. It also means there’s no easy way to refer to the tag without including it. I can’t say “everybody who uses the #qanon tag is insane” without also tagging my post <code>qanon</code>! </p>
<p>Second, there is no place for additional metadata. You can’t do tag aliases or subtags or anything.</p>
<h3>Key-value tags</h3>
<p>Instead of a tag being a single label, the tag carries an additional semantic value that’s <em>not</em> the tag id. Then you can query either the raw tag or the tag’s value. This is used a lot in technical tooling. A sprint planner might tag some things as <code>priority: 1</code>, in AWS you can tag resources as <code>env: production</code>, etc.</p>
<p>For the most part I’ve only seen this done with string or enumerated values. While it’s plausible to tag something like <code>due date: 2023-01-30</code> so you can query by date range, in practice that’s usually lifted to built-in content structure instead of the ad-hoc tagging structure.</p>
<h2>Other Thoughts on Tags</h2>
<h3>Who creates the tags?</h3>
<p>All tag systems have an audience, who the content itself is for, and a set of taggers, who are <em>doing the tagging</em>. These can be the same people or completely different groups. Some possible breakdowns:</p>
<ul>
<li>Individuals tagging for themselves: MacOS Finder tagging. Personal photo tagging. Adding tags to bookmarks.</li>
<li>A group tagging for themselves: AWS tagging. Internal documentation. Bills.</li>
<li>Public content with private taggers: Archive of Our Own. Wikipedia(ish). Newspapers. Library of Congress.</li>
<li>Tagging for a distributed resource: Semantic web. Social media. Amazon Customer Stores.</li>
</ul>
<p>All of these have different design and usage concerns.</p>
<h3>The Instagram problem</h3>
<p>The last case, where everybody is tagging their own public content, poses two unique concerns. The obvious one is bad actors. In a distributed system everybody is competing with everybody else for attention, so there’s an incentive to add unrelated tags.</p>
<blockquote>
<p>Metadata exists in a competitive world. Suppliers compete to sell their goods, cranks compete to convey their crackpot theories (mea culpa), artists compete for audience. … That’s why a search for any commonly referenced term at a search-engine like Altavista will often turn up at least one porn link in the first ten results. — <a href="https://people.well.com/user/doctorow/metacrap.htm" target="_blank">Corey Doctorow</a></p>
</blockquote>
<p>The other problem is what I call “The Instagram Problem”. Instagram uses hashtags. Nobody coordinates the tags, so there’s no way of knowing <em>which</em> tags people will look at. Here’s a picture of <a href="https://www.instagram.com/p/CnsSNxZS4e_/" target="_blank">a friend’s horse</a>:<sup id="fnref:horse-girl"><a href="#fn:horse-girl">1</a></sup></p>
<p><img alt="A picture of a horse with 21 tags" src="https://buttondown-attachments.s3.us-west-2.amazonaws.com/images/0cd60413-ddee-4da3-9f80-a8bb054a83d2.png"/> </p>
<p>In order to be sure that other horse girls on Instagram saw the picture, she had to tag it <code>#horse</code> <em>and</em> <code>#horses</code> <em>and</em> <code>#horsegirl</code> <em>and</em> <code>#horsesofinstagram</code>. At some point “horse” stops being a word.</p>
<h3>Tags vs Structure</h3>
<p>I sometimes see tags used as a replacement for first class structure. Instead of having a “assigned to” field in a record, the record might be tagged with an “assigned to” property tag. This rankles me but I can’t quite place down why. People do this  because it’s more expressive and lot easier to set up. But you lose the advantages of having that structure made explicit.</p>
<h3>Libraries</h3>
<p>Library scientists have written a <em>lot</em> about tagging systems. <a href="https://www.amazon.com/Foundations-Library-Information-Science-Third/dp/1555706908" target="_blank">Foundations of Library and Information Science</a> book is a good intro to this (and other librarian topics). In my experience, they tend to focus on metadata strictly controlled by professionals for the purpose of knowledge categorization, which is not-entirely-in-line with how a lot of software systems use tagging. Even so, if you really want to get deep into the nuances of information classification, library science is the way to go. Some topics:</p>
<ul>
<li><a href="https://www.getty.edu/research/publications/electronic_publications/intro_controlled_vocab/what.pdf" target="_blank">Controlled Vocabulary</a></li>
<li><a href="https://library.buffalo.edu/scholarly/documents/Barry-Smith-Ontologies-What-Librarians-Need-to-Know.pdf" target="_blank">Ontologies</a></li>
<li><a href="https://ac.bslw.com/community/blog/2010/05/why-is-authority-control-important/" target="_blank">Authority Control</a></li>
<li><a href="https://groups.niso.org/higherlogic/ws/public/download/17446/Understanding%20Metadata.pdf" target="_blank">Metadata</a></li>
</ul>
<p><em><a href="https://www.eventbrite.com/e/software-modeling-with-tla-workshop-tickets-520030754987?aff=email" target="_blank">Thanks again to me for sponsoring this newsletter</a>.</em></p>
<hr/>
<h3>Update for the Internets</h3>
<p>This was sent as part of an email newsletter; you can subscribe <a href="https://buttondown.email/hillelwayne/" target="_blank">here</a>. Updates are 6x a month. I also have a <a href="https://www.hillelwayne.com/" target="_blank">website</a>.</p>

                    
                

                
            </div></div>
  </body>
</html>
