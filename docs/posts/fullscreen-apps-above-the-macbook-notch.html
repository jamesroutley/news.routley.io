<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://notes.alinpanaitiu.com/Fullscreen%20apps%20above%20the%20MacBook%20notch">Original</a>
    <h1>Fullscreen apps above the MacBook notch</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><a href="https://notes.alinpanaitiu.com/" title="Back to Notes">◀ Back to Notes</a><span>Published on <strong>April 12, 2023</strong></span></p></div><article>
<p>On MacBook laptops with a notch, the area above the notch is reserved for the menu bar for most applications. That is good for normal window usage, as the menubar no longer takes precious vertical space that could be used for the content.</p>
<p><a href="https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png"><picture> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@avif 64w" type="image/avif"/> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png@webp 64w" type="image/webp"/> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png 64w"/> <img src="https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/01E8D99D-A0A1-4D5D-ADD7-8332E29CB972.png" alt="image"/> </picture></a></p>
<p>Going fullscreen though, only makes that area black <em>(so as to hide the notch)</em> but apps will still render below the notch, leaving about 100k pixels useless.</p>
<p><a href="https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png"><picture> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@avif 64w" type="image/avif"/> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png@webp 64w" type="image/webp"/> <source sizes="(min-width: 60em) 630px, 90vw" srcset="https://img.panaitiu.com/_/1920/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1920w,https://img.panaitiu.com/_/1620/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1620w,https://img.panaitiu.com/_/1400/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1400w,https://img.panaitiu.com/_/1280/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1280w,https://img.panaitiu.com/_/1200/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1200w,https://img.panaitiu.com/_/1080/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1080w,https://img.panaitiu.com/_/1024/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 1024w,https://img.panaitiu.com/_/992/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 992w,https://img.panaitiu.com/_/768/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 768w,https://img.panaitiu.com/_/640/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 640w,https://img.panaitiu.com/_/576/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 576w,https://img.panaitiu.com/_/320/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 320w,https://img.panaitiu.com/_/64/plain/https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png 64w"/> <img src="https://notes.alinpanaitiu.com/md/Fullscreen%20apps%20above%20the%20MacBook%20notch_attachments/9D6E9F55-05E2-4F96-A749-A82D7EBE0323.png" alt="image"/> </picture></a></p>
<p>So here are some instructions on how to fullscreen a window above the notch in the most hackish way possible.</p>
<p><em>By the way, if you prefer that old MacBook without a notch design, my <a href="https://lunar.fyi">Lunar</a> app can disable the notch by applying a hidden resolution.</em>
</p>
<hr/>
<h2 id="old-style-fullscreen"><a href="#old-style-fullscreen">#</a> Old-style fullscreen</h2>
<p>Every macOS window is actually a <code>NSWindow</code>, and that class has a <code>toggleFullScreen()</code> method.</p>
<p>But what that does is move the window to its own special Mission Control <strong>Space</strong> and render it fullscreen below the notch. Not what I want.</p>
<p>There&#39;s a thing called <em>old-style fullscreen</em> which some apps support natively (Sublime Text, <a href="https://sw.kovidgoyal.net/kitty">kitty</a>, <a href="https://iina.io/">IINA</a> etc.).</p>
<p>Instead of calling <code>toggleFullScreen()</code>, this method does the following:</p>
<ul>
<li>makes the window <em>borderless</em></li>
<li>sets up the app to auto-hide the menubar and dock</li>
<li>sets the window frame equal to the screen frame</li>
</ul>
<p>Here&#39;s how IINA does it for example: <a href="https://github.com/iina/iina/blob/fc66b27d50d0e98b056205867055f462e87828c9/iina/MainWindowController.swift#L1401-L1423">iina/MainWindowController.swift · iina/iina · GitHub</a></p>
<p>The problem is that, while apps can change their own windows as they please, there&#39;s no way for an app to change those attributes on windows of other apps.</p>
<h2 id="injecting-code"><a href="#injecting-code">#</a> Injecting code</h2>
<p>Using <a href="https://frida.re/">Frida</a> we can inject and run code inside the context of any running process.</p>
<p>We first need to <strong><a href="https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection">disable SIP</a></strong> though, as code injection is restricted by default for obvious security reasons.</p>
<p>Below we define our Frida script, which we can save in <strong>~/Documents/OverNotch.js</strong> for later usage.</p>
<p><em>OverNotch.js</em></p>
<pre><code><span><span><span>var</span> <span>NSApplicationPresentationAutoHideMenuBar</span> <span>=</span> <span>1</span> <span>&lt;&lt;</span> <span>2</span>
</span></span><span><span><span>var</span> <span>NSApplicationPresentationAutoHideDock</span> <span>=</span> <span>1</span> <span>&lt;&lt;</span> <span>0</span>
</span></span><span><span><span>var</span> <span>NSWindowStyleMaskBorderless</span> <span>=</span> <span>0</span>
</span></span><span><span><span>var</span> <span>NSApplicationPresentationDefault</span> <span>=</span> <span>0</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>app</span> <span>=</span> <span>ObjC</span><span>.</span><span>classes</span><span>.</span><span>NSApplication</span><span>.</span><span>sharedApplication</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>arrayFromNSArray</span> <span>=</span> <span>(</span><span>nsArray</span><span>)</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>    <span>var</span> <span>jsArray</span> <span>=</span> <span>[]</span>
</span></span><span><span>    <span>var</span> <span>count</span> <span>=</span> <span>nsArray</span><span>.</span><span>count</span><span>()</span>
</span></span><span><span>    <span>for</span> <span>(</span><span>var</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>count</span><span>;</span> <span>i</span><span>++</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>jsArray</span><span>[</span><span>i</span><span>]</span> <span>=</span> <span>nsArray</span><span>.</span><span>objectAtIndex_</span><span>(</span><span>i</span><span>)</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>    <span>return</span> <span>jsArray</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>mainWindow</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>global</span><span>.</span><span>app</span><span>.</span><span>mainWindow</span><span>())</span> <span>{</span> <span>return</span> <span>global</span><span>.</span><span>app</span><span>.</span><span>mainWindow</span><span>()</span> <span>}</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>global</span><span>.</span><span>app</span><span>.</span><span>keyWindow</span><span>())</span> <span>{</span> <span>return</span> <span>global</span><span>.</span><span>app</span><span>.</span><span>keyWindow</span><span>()</span> <span>}</span>
</span></span><span><span>
</span></span><span><span>    <span>var</span> <span>windows</span> <span>=</span> <span>arrayFromNSArray</span><span>(</span><span>global</span><span>.</span><span>app</span><span>.</span><span>windows</span><span>())</span>
</span></span><span><span>    <span>var</span> <span>index</span> <span>=</span> <span>Math</span><span>.</span><span>min</span><span>(...</span><span>windows</span><span>.</span><span>map</span><span>((</span><span>w</span><span>)</span> <span>=&gt;</span> <span>w</span><span>.</span><span>orderedIndex</span><span>()))</span>
</span></span><span><span>    <span>return</span> <span>windows</span><span>.</span><span>find</span><span>((</span><span>w</span><span>)</span> <span>=&gt;</span> <span>w</span><span>.</span><span>orderedIndex</span><span>()</span> <span>==</span> <span>index</span><span>)</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>w</span> <span>=</span> <span>mainWindow</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>toggleFullScreen</span> <span>=</span> <span>(</span><span>windowNum</span><span>)</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>!</span><span>windowNum</span><span>)</span> <span>{</span> <span>windowNum</span> <span>=</span> <span>global</span><span>.</span><span>w</span><span>.</span><span>windowNumber</span><span>()</span> <span>}</span>
</span></span><span><span>
</span></span><span><span>    <span>var</span> <span>dict</span> <span>=</span> <span>ObjC</span><span>.</span><span>classes</span><span>.</span><span>NSThread</span><span>.</span><span>mainThread</span><span>().</span><span>threadDictionary</span><span>()</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>dict</span><span>.</span><span>valueForKey_</span><span>(</span><span>windowNum</span><span>.</span><span>toString</span><span>()))</span> <span>{</span>
</span></span><span><span>        <span>stopFullScreen</span><span>(</span><span>windowNum</span><span>)</span>
</span></span><span><span>    <span>}</span> <span>else</span> <span>{</span>
</span></span><span><span>        <span>makeFullScreen</span><span>(</span><span>windowNum</span><span>)</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>stopFullScreen</span> <span>=</span> <span>(</span><span>windowNum</span><span>)</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>    <span>Interceptor</span><span>.</span><span>revert</span><span>(</span><span>app</span><span>.</span><span>setPresentationOptions_</span><span>.</span><span>implementation</span><span>)</span>
</span></span><span><span>    <span>ObjC</span><span>.</span><span>schedule</span><span>(</span><span>ObjC</span><span>.</span><span>mainQueue</span><span>,</span> <span>()</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>        <span>global</span><span>.</span><span>app</span><span>.</span><span>setPresentationOptions_</span><span>(</span><span>NSApplicationPresentationDefault</span><span>)</span>
</span></span><span><span>    <span>})</span>
</span></span><span><span>
</span></span><span><span>    <span>var</span> <span>window</span> <span>=</span> <span>windowNum</span> <span>?</span> <span>global</span><span>.</span><span>app</span><span>.</span><span>windowWithWindowNumber_</span><span>(</span><span>windowNum</span><span>)</span> <span>:</span> <span>global</span><span>.</span><span>w</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>!</span><span>window</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>return</span> <span>console</span><span>.</span><span>log</span><span>(</span><span>&#39;Window not found&#39;</span><span>)</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>
</span></span><span><span>    <span>ObjC</span><span>.</span><span>schedule</span><span>(</span><span>ObjC</span><span>.</span><span>mainQueue</span><span>,</span> <span>()</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>        <span>var</span> <span>key</span> <span>=</span> <span>window</span><span>.</span><span>windowNumber</span><span>().</span><span>toString</span><span>()</span>
</span></span><span><span>        <span>var</span> <span>dict</span> <span>=</span> <span>ObjC</span><span>.</span><span>classes</span><span>.</span><span>NSThread</span><span>.</span><span>mainThread</span><span>().</span><span>threadDictionary</span><span>()</span>
</span></span><span><span>        <span>if</span> <span>(</span><span>dict</span><span>.</span><span>valueForKey_</span><span>(</span><span>key</span><span>))</span> <span>{</span>
</span></span><span><span>            <span>window</span><span>.</span><span>setStyleMask_</span><span>(</span><span>dict</span><span>.</span><span>valueForKey_</span><span>(</span><span>key</span><span>).</span><span>unsignedLongLongValue</span><span>())</span>
</span></span><span><span>            <span>dict</span><span>.</span><span>removeObjectForKey_</span><span>(</span><span>key</span><span>)</span>
</span></span><span><span>        <span>}</span>
</span></span><span><span>
</span></span><span><span>        <span>window</span><span>.</span><span>setFrameUsingName_</span><span>(</span><span>key</span><span>)</span>
</span></span><span><span>        <span>window</span><span>.</span><span>setIsMovable_</span><span>(</span><span>true</span><span>)</span>
</span></span><span><span>
</span></span><span><span>        <span>Interceptor</span><span>.</span><span>revert</span><span>(</span><span>app</span><span>.</span><span>setPresentationOptions_</span><span>.</span><span>implementation</span><span>)</span>
</span></span><span><span>    <span>})</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>global</span><span>.</span><span>makeFullScreen</span> <span>=</span> <span>(</span><span>windowNum</span><span>)</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>    <span>var</span> <span>window</span> <span>=</span> <span>windowNum</span> <span>?</span> <span>global</span><span>.</span><span>app</span><span>.</span><span>windowWithWindowNumber_</span><span>(</span><span>windowNum</span><span>)</span> <span>:</span> <span>global</span><span>.</span><span>w</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>!</span><span>window</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>return</span> <span>console</span><span>.</span><span>log</span><span>(</span><span>&#39;Window not found&#39;</span><span>)</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>
</span></span><span><span>    <span>ObjC</span><span>.</span><span>schedule</span><span>(</span><span>ObjC</span><span>.</span><span>mainQueue</span><span>,</span> <span>()</span> <span>=&gt;</span> <span>{</span>
</span></span><span><span>        <span>var</span> <span>key</span> <span>=</span> <span>window</span><span>.</span><span>windowNumber</span><span>().</span><span>toString</span><span>()</span>
</span></span><span><span>        <span>var</span> <span>dict</span> <span>=</span> <span>ObjC</span><span>.</span><span>classes</span><span>.</span><span>NSThread</span><span>.</span><span>mainThread</span><span>().</span><span>threadDictionary</span><span>()</span>
</span></span><span><span>        <span>var</span> <span>value</span> <span>=</span> <span>ObjC</span><span>.</span><span>classes</span><span>.</span><span>NSNumber</span><span>.</span><span>numberWithUnsignedLongLong_</span><span>(</span><span>window</span><span>.</span><span>styleMask</span><span>())</span>
</span></span><span><span>        <span>dict</span><span>.</span><span>setValue_forKey_</span><span>(</span><span>value</span><span>,</span> <span>key</span><span>)</span>
</span></span><span><span>        <span>window</span><span>.</span><span>saveFrameUsingName_</span><span>(</span><span>key</span><span>)</span>
</span></span><span><span>
</span></span><span><span>        <span>global</span><span>.</span><span>app</span><span>.</span><span>setPresentationOptions_</span><span>(</span><span>NSApplicationPresentationAutoHideDock</span> <span>|</span> <span>NSApplicationPresentationAutoHideMenuBar</span><span>)</span>
</span></span><span><span>        <span>window</span><span>.</span><span>setStyleMask_</span><span>(</span><span>NSWindowStyleMaskBorderless</span><span>)</span>
</span></span><span><span>        <span>window</span><span>.</span><span>setFrame_display_</span><span>(</span><span>window</span><span>.</span><span>screen</span><span>().</span><span>frame</span><span>(),</span> <span>true</span><span>)</span>
</span></span><span><span>        <span>window</span><span>.</span><span>setIsMovable_</span><span>(</span><span>false</span><span>)</span>
</span></span><span><span>
</span></span><span><span>        <span>Interceptor</span><span>.</span><span>replace</span><span>(</span><span>app</span><span>.</span><span>setPresentationOptions_</span><span>.</span><span>implementation</span><span>,</span> <span>new</span> <span>NativeCallback</span><span>((</span><span>mask</span><span>)</span> <span>=&gt;</span> <span>{}))</span>
</span></span><span><span>    <span>})</span>
</span></span><span><span><span>}</span>
</span></span></code></pre><p>Then as a test, have a Safari window open, and run the following to make it fullscreen:</p>
<pre><code><span><span>sudo frida -q -l ~/Documents/OverNotch.js -e <span>&#34;toggleFullScreen()&#34;</span> Safari
</span></span></code></pre><p><em>Note that this doesn&#39;t work with all windows, and some apps will crash when their window <code>styleMask</code> is changed.</em></p>
<h3 id="hotkey"><a href="#hotkey">#</a> Hotkey</h3>
<p>I prefer to bind <code>fn - a</code> to <em>fullscreen the current window</em> using <a href="https://github.com/koekeishiya/skhd">skhd</a>.</p>
<blockquote>
<p>I would usually bind <code>rcmd - a</code> as it&#39;s a bit easier to press, but since I surrendered the <code>⌘ Right Command</code> key to my <strong><a href="https://lowtechguys.com/rcmd">rcmd app switcher</a></strong>, I&#39;m using <code>fn</code> for these system-wide hotkeys.</p>
</blockquote>
<p>Here&#39;s what I added in <code>~/.skhdrc</code> to do that:</p>
<pre><code><span><span><span>fn</span> <span>-</span> <span>a</span>  <span>:</span> <span>sudo</span> <span>frida</span> <span>-</span><span>q</span> <span>-</span><span>l</span> <span>~/</span><span>Documents</span><span>/</span><span>OverNotch</span><span>.</span><span>js</span> <span>-</span><span>e</span> <span>&#34;toggleFullScreen()&#34;</span> <span>$</span><span>(</span><span>osascript</span> <span>-</span><span>e</span> <span>&#39;</span><span>tell</span> <span>application</span> <span>&#34;System Events&#34;</span> <span>to</span> <span>get</span> <span>unix</span> <span>id</span> <span>of</span> <span>first</span> <span>application</span> <span>process</span> <span>whose</span> <span>frontmost</span> <span>is</span> <span>true</span><span>&#39;</span><span>)</span>
</span></span></code></pre><hr/>
<h2 id="why-would-you-need-such-a-thing"><a href="#why-would-you-need-such-a-thing">#</a> Why would you need such a thing?</h2>
<p>I personally wanted it for having <strong>Windows 11</strong> look as natively as possible through <a href="https://www.parallels.com/eu/">Parallels Desktop</a>. I still need it from time to time for hardware that only provides a Windows configuration program.</p>

<p>You can also use it to get an immersive view of specific webpages. Here&#39;s <a href="https://incoherency.co.uk/nightdrive/">NightDrive</a> for example:</p>

<p>Or maybe have a more focused zen-mode on note taking apps. Here&#39;s <a href="https://noteplan.co/">NotePlan</a> in my case:</p>

<h2 id="sip-disabled-how-about-no"><a href="#sip-disabled-how-about-no">#</a> SIP disabled? How about no?</h2>
<p>Frida and other debuggers like lldb and gdb use the <code>task_for_pid</code> API for attaching to a running process.</p>
<p>That doesn&#39;t necessarily need SIP being disabled. For <code>task_for_pid</code> to succeed on a process, that process needs to meet one of the following requirements:</p>
<ul>
<li>be <strong>unsigned</strong></li>
<li>be signed <strong>without Hardened Runtime</strong></li>
<li>include the <code>com.apple.security.get-task-allow</code> entitlement</li>
</ul>
<p>Fortunately, we can alter the signature of any non-system app without disabling SIP.</p>
<p>Unfortunately that&#39;s not very straightforward because we need to ensure that we sign all the additional bundles inside the app, and we need to take care of not removing existing entitlements.</p>
<p>Because I&#39;m using <a href="https://fishshell.com/">fish shell</a>, here&#39;s how I approach this task:</p>
<pre><code><span><span><span>function</span> <span>resign</span>-bundle <span>-a</span> bundle
</span></span><span><span>    <span># Dump existing entitlements as a PLIST
</span></span></span><span><span><span></span>    <span>codesign</span> <span>-d</span> <span>--entitlements</span> <span>- --xml</span> <span>&#34;</span><span>$bundle</span><span>&#34;</span> <span>&gt;</span>/tmp/entitlements.xml
</span></span><span><span>    <span>if</span> <span>not</span> <span>test</span> <span>-s</span> /tmp/entitlements.xml
</span></span><span><span>        <span># Sign without Hardened Runtime
</span></span></span><span><span><span></span>        <span>codesign</span> <span>-fs</span> <span>$CODESIGN_CERT</span> <span>&#34;</span><span>$bundle</span><span>&#34;</span>
</span></span><span><span>        <span>return</span>
</span></span><span><span>    <span>end</span>
</span></span><span><span>
</span></span><span><span>    <span># Add `get-task-allow` to the entitlements to allow debuggers
</span></span></span><span><span><span></span>    /usr/libexec/PlistBuddy <span>-c</span> <span>&#34;Add :com.apple.security.get-task-allow bool true&#34;</span> /tmp/entitlements.xml
</span></span><span><span>    <span># Sign with Hardened Runtime and `get-task-allow`
</span></span></span><span><span><span></span>    <span>codesign</span> <span>-fs</span> <span>$CODESIGN_CERT</span> <span>-o</span> runtime <span>--timestamp</span> <span>--entitlements</span> /tmp/entitlements.xml <span>&#34;</span><span>$bundle</span><span>&#34;</span>
</span></span><span><span><span>end</span>
</span></span><span><span>
</span></span><span><span><span>function</span> <span>resign</span>-app <span>-a</span> app
</span></span><span><span>    <span># Backup existing app
</span></span></span><span><span><span></span>    <span>mkdir</span> <span>-p</span> ~/.cache/resign-app-backups/
</span></span><span><span>    <span>if</span> <span>not</span> <span>test</span> <span>-d</span> <span>&#34;~/.cache/resign-app-backups/</span><span>$(</span><span>basename &#34;</span><span>$app</span><span>&#34;)&#34;</span>
</span></span><span><span>        <span>rsync</span> <span>-avz</span> <span>&#34;</span><span>$app</span><span>&#34;</span> ~/.cache/resign-app-backups/
</span></span><span><span>    <span>end</span>
</span></span><span><span>
</span></span><span><span>    <span># Resign bundles inside the app
</span></span></span><span><span><span></span>    <span>fd</span> <span>-uu</span> <span>&#39;\.(app|framework|dylib|xpc|appex)$&#39;</span> <span>&#34;</span><span>$app</span><span>&#34;</span> <span>-j</span> <span>1</span> <span>-x</span> <span>fish</span> <span>-c</span> <span>&#39;resign-bundle {}&#39;</span>
</span></span><span><span>
</span></span><span><span>    <span># Resign the app itself
</span></span></span><span><span><span></span>    <span>resign-bundle</span> <span>&#34;</span><span>$app</span><span>&#34;</span>
</span></span><span><span><span>end</span>
</span></span></code></pre><p>Testing this on RealVNC Viewer:</p>
<pre><code><span><span><span>&gt;</span> resign-app <span>&#34;/Applications/VNC Viewer.app&#34;</span>
</span></span><span><span>
</span></span><span><span><span>Executable</span><span>=</span>/Applications/VNC <span>Viewer</span>.app/Contents/MacOS/vncviewer
</span></span><span><span>/Applications/VNC Viewer.app: replacing existing signature
</span></span></code></pre><p><em>showing how native fullscreen differs from legacy fullscreen</em>
</p>
<p>I also tried testing this on <a href="https://github.com/insidegui/VirtualBuddy">VirtualBuddy</a> but because it has a required entitlement (<code>com.apple.vm.networking</code>) and an embedded provisioning profile tied to the developer certificate, this got too complicated to warrant the effort.</p>
<p>System apps also can&#39;t work with this approach because some of them live in immutable volumes called Cryptexes. For example here&#39;s where Safari can be found on macOS Ventura:</p>
<pre><code><span><span><span># Safari lives at /System/Volumes/Preboot/Cryptexes/App/System/Applications/Safari.app</span>
</span></span><span><span>
</span></span><span><span>&gt; codesign --remove-signature <span>&#39;/System/Volumes/Preboot/Cryptexes/App/System/Applications/Safari.app&#39;</span>
</span></span><span><span>/System/Volumes/Preboot/Cryptexes/App/System/Applications/Safari.app: internal error in Code Signing subsystem
</span></span></code></pre></article></div>
  </body>
</html>
