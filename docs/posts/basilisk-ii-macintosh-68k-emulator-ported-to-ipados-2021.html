<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.gingerbeardman.com/2021/04/21/building-basiliskii-for-ios/">Original</a>
    <h1>Basilisk II Macintosh 68K emulator ported to iPadOS (2021)</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
          

          

          

          <p>I’ve had numerous requests for a guide to building <em>BasiliskII</em> on iOS. Let me know of anything is unclear or would benefit from more details!</p>

<p>October 2022: Updated for building with <em>Xcode</em> 14.0.1 on macOS 12.6 Monterey to iOS 15.7. YMMV.</p>

<h2 id="building">Building</h2>

<ol>
  <li>Install <a href="https://apps.apple.com/gb/app/xcode/id497799835?mt=12">Xcode from Mac App Store</a></li>
  <li>Clone <a href="https://github.com/zydeco/macemu/tree/ios/BasiliskII/src/iOS">project source from GitHub</a></li>
  <li>Switch to the <code>ios</code> branch.</li>
  <li>Open .xcodeproj file</li>
  <li>Set <code>Product &gt; Destination</code> to point to your device</li>
  <li>Run</li>
</ol>

<h2 id="optional-changes">Optional Changes</h2>

<p>I plan to add these changes into my own fork of the code. Soon, maybe!</p>

<h3 id="adding-chunky-screen-resolutions">Adding chunky screen resolutions</h3>

<p>I added chunky “half resolution” screen modes to increase the size of user interface elements so that buttons, menu items and so on are all around the 44pt recommended in the Apple iOS HIG.</p>

<p>For iPad Pro 12.9” these changes were:</p>

<div><div><pre><code>[videoModes addObject:[NSValue valueWithCGSize:CGSizeMake(512, 496)]]; // portrait minus keyboard
[videoModes addObject:[NSValue valueWithCGSize:CGSizeMake(512, 672)]]; // portrait &#34;full&#34; screen
[videoModes addObject:[NSValue valueWithCGSize:CGSizeMake(683, 502)]]; // landscape &#34;full&#34; screen
</code></pre></div></div>

<p>Enter those after <a href="https://github.com/zydeco/macemu/blob/74254b59f3829468ee2e2ac5b9eb3d81d281caa7/BasiliskII/src/iOS/BasiliskII/B2ScreenView.mm#L56">line 56 in file B2ScreenView.mm</a></p>

<h3 id="disabling-graphics-smoothing">Disabling graphics smoothing</h3>

<p>My personal preference is to disable filtering/smoothing on all graphics scaling, but only because I’ve dialled in resolutions that fit exactly so there will be no scaling happening anyway:</p>

<div><div><pre><code>NSString *filter = kCAFilterNearest;
videoLayer.magnificationFilter = filter;
videoLayer.minificationFilter = filter;
</code></pre></div></div>

<p>Make this change <a href="https://github.com/zydeco/macemu/blob/74254b59f3829468ee2e2ac5b9eb3d81d281caa7/BasiliskII/src/iOS/BasiliskII/B2ScreenView.mm#L108">around line 108 in file B2ScreenView.mm</a></p>

<h3 id="custom-keyboard-layouts">Custom Keyboard Layouts</h3>

<p>These are defined in JSON and compiled to a custom format:</p>

<ul>
  <li><a href="https://github.com/zydeco/macemu/tree/ios/BasiliskII/src/iOS/BasiliskII/Keyboard%20Layouts">source file location on GitHub</a></li>
  <li>several regional layouts are already provided</li>
  <li>you don’t have to make your own!</li>
</ul>

<p><a href="https://github.com/gingerbeardman/artworks-keyboard">Here’s one that I made</a>, based on the British layout, for use with <em>Deneba</em> <em>artWORKS</em>/UltraPaint.</p>

<h3 id="enable-split-view-support">Enable <em>Split View</em> Support</h3>

<p>This can be enabled by changing <code>BasiliskII-Info.plist</code>: <code>UIRequiresFullScreen</code> should be <code>false</code> in <a href="https://github.com/zydeco/macemu/blob/ios/BasiliskII/src/iOS/BasiliskII/BasiliskII-Info.plist#L114">BasiliskII-Info.plist</a> but be wary of the following problem:</p>

<ul>
  <li>the very top of the screen (where you’d expect the iOS status bar to be, and where part of the <em>System 7</em> menu bar is) will become unresponsive to touch due to the <em>Slide Over</em> indicator</li>
</ul>

<p>This would need to be managed/avoided by the screen layout of <em>BasiliskII</em>, but when I attempted this it raised more issues.</p>

<p>However, you can still use <em>Slide Over</em> to position <em>Safari</em>, <em>Files</em>, etc. along the edge of your screen.</p>

<h2 id="notes">Notes</h2>

<p>There are additional capabilities that come  the emulator integration. I go further into these, and more besides, in a additional posts listed at the bottom of the page.</p>

<h3 id="file-sharing">File Sharing</h3>

<p>A drive appears on the desktop that is mapped to the iOS file sharing folder of the app.</p>

<ul>
  <li>You can use <em>Files</em> to transfer files into or out of the emulated machine</li>
  <li>Share Sheet also works for getting files into the emulated machine</li>
</ul>

<h3 id="apple-pencil">Apple Pencil</h3>

<p>This is supported the same way as regular touch so it acts as a mouse. Drawing works well and is very responsive, even at lower Hz.</p>

<ul>
  <li>Palm rejection is missing</li>
  <li>Pressure sensitivity is missing</li>
  <li>Multi touch seems to be missing</li>
</ul>



<ul>
  <li><a href="https://phys.org/2021/04/17/turning-an-ipad-pro-into-the-ultimate-classic-macintosh">Turning an iPad Pro into the Ultimate Classic Macintosh</a></li>
  <li>How to install <em>BasiliskII</em> on your iPad</li>
  <li><a href="https://phys.org/2021/04/19/automating-interactions-using-apple-events/">Exploring Custom Keyboards and Automation</a></li>
  <li><a href="https://phys.org/2021/03/28/changing-the-size-of-toolbar-items-using-resedit/">Optimising Macintosh app toolbars for touch</a></li>
  <li><a href="https://phys.org/2021/04/24/macintosh-drawing-software-compared/">Macintosh drawing software compared</a></li>
  <li><a href="https://phys.org/2021/04/25/mixing-external-tools-across-deneba-software/">Mixing External Tools across <em>Deneba</em> software</a></li>
  <li><a href="https://phys.org/2021/04/30/my-system-7-software-choices/">My <em>System 7</em> software choices</a></li>
  <li><a href="https://phys.org/2021/05/03/interoperability-of-system-7-and-ios/">About the interoperability of <em>System 7</em> and iOS</a></li>
</ul>

        </div></div>
  </body>
</html>
