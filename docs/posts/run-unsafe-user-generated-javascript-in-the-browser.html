<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://workerbox.net/">Original</a>
    <h1>Show HN: Run unsafe user generated JavaScript in the browser</h1>
    
    <div id="readability-page-1" class="page">
  
  <p>
    Free and Open Source, on <a href="https://github.com/markwylde/workerbox">Github</a>
  </p>
  <p>A secure sandbox for you to run end user JavaScript safely away from
    your own application.
  </p>
  <ul>
    <li>Code is run in it&#39;s own subdomain of workerbox.net</li>
    <li>Code is run in a WebWorker</li>
  </ul>

  
  <p>The following is a demo of using WorkerBox to create a plugin
    architecture for a web UI. There are messages on the right,
    and an action bar that you can add commands to.
  </p>

  <p>It will be impossible for you to effect the DOM of this page, without
    using the deliberately exposed methods on the scope.
  </p>

  <h2>Scope</h2>
  <p>The scope is how you communicate with your users code.</p>

  <p>For this demo, you can&#39;t edit the scope, as it&#39;s hard coded into the demo app.</p>

  

<div>
  <div>
    <h2>User Playground</h2>
    <p>You can edit the code below and see the results on the right.</p>
    
  </div>

  <div>
    <h2>Result</h2>
    <h3>Toolbar</h3>
    
    <h3>Messages</h3>
    <ul id="messages">
      <li>Message one</li>
    </ul>

    <h3>Return:</h3>
    <pre><code id="codeOutput">Running</code></pre>
  </div>
</div>

<h2>How does it work?</h2>
<p>An iframe is inserted into the page from a completely separate domain.</p>

<p>The iframe then creates a web worker, and handles posting messages between
  the iframe, webworker and your own app.</p><p>Because the only communication between the user code and the workerbox instead
  is done through messaging, the argument inputs and outputs must all be JSON
  serializable.</p>

<h2>Caveats</h2>
<h3>1. Storage</h3>
<p>Web workers can&#39;t use cookies or localStorage, but even if they could they would be
isolated to third party domain that is running the code.</p>

<p>However, there are some ways to store data. For example, indexDB.</p>

<p>While your unsafe user code can not access the indexDB of your own site, it can use
  the instance on the server&#39;s site.</p>

<p>But remember, anyone can run untrusted user code on the workerbox site. So if your users
  store data on the workerbox domain, technically anyone can view that data.</p>

<p>Therefore, <strong>you should advise your users not to store any data using the web workers API</strong>.</p>

<p>Of course, you could provide an abstraction on the `scope` that would safely allow
  you to store data on your own domain.</p>


</div>
  </body>
</html>
