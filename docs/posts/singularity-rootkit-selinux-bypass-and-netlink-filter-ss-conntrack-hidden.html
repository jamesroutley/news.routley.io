<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/MatheuZSecurity/Singularity">Original</a>
    <h1>Singularity Rootkit: SELinux bypass and netlink filter (ss/conntrack hidden)</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/d448204682681244d94de6b822dd72bc9003d442f8b638623cc66eb1d2f3f6c3/68747470733a2f2f692e696d6775722e636f6d2f6e3355356673502e6a706567"><img src="https://camo.githubusercontent.com/d448204682681244d94de6b822dd72bc9003d442f8b638623cc66eb1d2f3f6c3/68747470733a2f2f692e696d6775722e636f6d2f6e3355356673502e6a706567" alt="Singularity Rootkit" width="600" data-canonical-src="https://i.imgur.com/n3U5fsP.jpeg"/></a></p>
<blockquote>
<p dir="auto"><em>&#34;Shall we give forensics a little work?&#34;</em></p>
</blockquote>
<p dir="auto"><strong>Singularity</strong> is a powerful Linux Kernel Module (LKM) rootkit designed for modern 6.x kernels. It provides comprehensive stealth capabilities through advanced system call hooking via ftrace infrastructure.</p>
<p dir="auto"><strong>Full Research Article (outdated version)</strong>: <a href="https://blog.kyntra.io/Singularity-A-final-boss-linux-kernel-rootkit" rel="nofollow">Singularity: A Final Boss Linux Kernel Rootkit</a></p>
<p dir="auto"><strong>EDR Evasion Case Study</strong>: <a href="https://matheuzsecurity.github.io/hacking/bypassing-elastic/" rel="nofollow">Bypassing Elastic EDR with Singularity</a></p>
<hr/>

<p dir="auto">Singularity is a sophisticated rootkit that operates at the kernel level, providing:</p>
<ul dir="auto">
<li><strong>Process Hiding</strong>: Make any process completely invisible to the system</li>
<li><strong>File &amp; Directory Hiding</strong>: Conceal files using pattern matching</li>
<li><strong>Network Stealth</strong>: Hide TCP/UDP connections, ports, and conntrack entries</li>
<li><strong>Privilege Escalation</strong>: Multiple methods to gain instant root access</li>
<li><strong>Log Sanitization</strong>: Filter kernel logs and system journals in real-time</li>
<li><strong>Self-Hiding</strong>: Remove itself from module lists and system monitoring</li>
<li><strong>Remote Access</strong>: ICMP-triggered reverse shell with automatic hiding</li>
<li><strong>Anti-Detection</strong>: Block eBPF tools, io_uring operations, and prevent module loading</li>
<li><strong>Audit Evasion</strong>: Drop audit messages for hidden processes at netlink level with statistics tracking</li>
<li><strong>Memory Forensics Evasion</strong>: Filter /proc/kcore, /proc/kallsyms, /proc/vmallocinfo</li>
<li><strong>Cgroup Filtering</strong>: Filter hidden PIDs from cgroup.procs</li>
<li><strong>Syslog Evasion</strong>: Hook do_syslog to filter klogctl() kernel ring buffer access</li>
<li><strong>Debugfs Evasion</strong>: Filter output of tools that read raw block devices</li>
<li><strong>Conntrack Filtering</strong>: Hide connections from /proc/net/nf_conntrack and netlink SOCK_DIAG/NETFILTER queries</li>
<li><strong>SELinux Evasion</strong>: Automatic SELinux enforcing mode bypass on ICMP trigger</li>
</ul>
<hr/>

<ul dir="auto">
<li>Environment-triggered privilege elevation via signals and environment variables</li>
<li>Complete process hiding from /proc and monitoring tools</li>
<li>Pattern-based filesystem hiding for files and directories</li>
<li>Network connection concealment from netstat, ss, conntrack, and packet analyzers</li>
<li>Advanced netlink filtering (SOCK_DIAG, NETFILTER/conntrack messages)</li>
<li>Real-time kernel log filtering for dmesg, journalctl, and klogctl</li>
<li>Module self-hiding from lsmod and /sys/module</li>
<li>Automatic kernel taint flag normalization</li>
<li>BPF syscall interception to prevent eBPF-based detection</li>
<li>io_uring protection against asynchronous I/O bypass</li>
<li>Prevention of new kernel module loading</li>
<li>Log masking for kernel messages and system logs</li>
<li>Evasion of standard rootkit detectors (unhide, chkrootkit, rkhunter)</li>
<li>Automatic child process tracking and hiding via tracepoint hooks</li>
<li>Multi-architecture support (x64 + ia32)</li>
<li>Network packet-level filtering with raw socket protection</li>
<li>Protection against all file I/O variants (read, write, splice, sendfile, tee, copy_file_range)</li>
<li>Netlink-level audit message filtering with statistics tracking to evade auditd detection</li>
<li>Cgroup PID filtering to prevent detection via <code>/sys/fs/cgroup/*/cgroup.procs</code></li>
<li>TaskStats netlink blocking to prevent PID enumeration</li>
<li>/proc/kcore filtering to evade memory forensics tools (Volatility, crash, gdb)</li>
<li>do_syslog hook to filter klogctl() and prevent kernel ring buffer leaks</li>
<li>Block device output filtering to evade debugfs and similar disk forensics tools</li>
<li>journalctl -k output filtering via write hook</li>
<li>SELinux enforcing mode bypass capability for ICMP-triggered shells</li>
</ul>
<hr/>


<ul dir="auto">
<li>Linux kernel 6.x (tested on 6.8.0-79-generic, 6.17.8-300.fc43.x86_64 and 6.12)</li>
<li>Kernel headers for your running kernel</li>
<li>GCC and Make</li>
<li>Root access</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="cd /dev/shm
git clone https://github.com/MatheuZSecurity/Singularity
cd Singularity
sudo bash setup.sh
sudo bash scripts/x.sh
cd .."><pre><span>cd</span> /dev/shm
git clone https://github.com/MatheuZSecurity/Singularity
<span>cd</span> Singularity
sudo bash setup.sh
sudo bash scripts/x.sh
<span>cd</span> ..</pre></div>
<p dir="auto">That&#39;s it. The module automatically:</p>
<ul dir="auto">
<li>Hides itself from lsmod, /proc/modules, /sys/module</li>
<li>Clears kernel taint flags</li>
<li>Filters sensitive strings from dmesg, journalctl -k, klogctl</li>
<li>Starts protecting your hidden files and processes</li>
</ul>

<p dir="auto"><strong>The module automatically hides itself after loading</strong></p>
<p dir="auto"><strong>There is no unload feature - reboot required to remove</strong></p>
<p dir="auto"><strong>Test in a VM first - cannot be removed without restarting</strong></p>
<hr/>


<p dir="auto"><strong>Edit <code>include/core.h</code>:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="#define YOUR_SRV_IP &#34;192.168.1.100&#34;  // Change this
#define YOUR_SRV_IPv6 { .s6_addr = { [15] = 1 } }  // IPv6 if needed"><pre><span>#define</span> <span>YOUR_SRV_IP</span> &#34;192.168.1.100&#34;  // Change this
<span>#define</span> <span>YOUR_SRV_IPv6</span> { .s6_addr = { [15] = 1 } }  // IPv6 if needed</pre></div>
<p dir="auto"><strong>Edit <code>modules/icmp.c</code>:</strong></p>

<hr/>


<div dir="auto" data-snippet-clipboard-copy-content="# Hide current shell
kill -59 $$

# Hide specific process
kill -59 &lt;PID&gt;"><pre><span><span>#</span> Hide current shell</span>
<span>kill</span> -59 <span>$$</span>

<span><span>#</span> Hide specific process</span>
<span>kill</span> -59 <span>&lt;</span>PID<span>&gt;</span></pre></div>
<p dir="auto">Process will be invisible to ps, top, htop, /proc, and all monitoring tools. All child processes are automatically tracked and hidden.</p>
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1e62d0337668613abc369c0144c39f715c4d1739f1f2f4f739ceca7a99162877/68747470733a2f2f692e696d6775722e636f6d2f775832673435392e706e67"><img src="https://camo.githubusercontent.com/1e62d0337668613abc369c0144c39f715c4d1739f1f2f4f739ceca7a99162877/68747470733a2f2f692e696d6775722e636f6d2f775832673435392e706e67" data-canonical-src="https://i.imgur.com/wX2g459.png"/></a>
</p>

<p dir="auto">Files matching your configured patterns are automatically hidden:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir singularity
echo &#34;secret&#34; &gt; singularity/data.txt

# Invisible to ls, find, locate
ls -la | grep singularity
# (no output)

# But you can still access it
cat singularity/data.txt
# secret

# cd is blocked for security
cd singularity
# bash: cd: singularity: No such file or directory"><pre>mkdir singularity
<span>echo</span> <span><span>&#34;</span>secret<span>&#34;</span></span> <span>&gt;</span> singularity/data.txt

<span><span>#</span> Invisible to ls, find, locate</span>
ls -la <span>|</span> grep singularity
<span><span>#</span> (no output)</span>

<span><span>#</span> But you can still access it</span>
cat singularity/data.txt
<span><span>#</span> secret</span>

<span><span>#</span> cd is blocked for security</span>
<span>cd</span> singularity
<span><span>#</span> bash: cd: singularity: No such file or directory</span></pre></div>
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1af72755932cc7362558ab8073bb69e1630c1ba95bd60ef89c69b60acd60591f/68747470733a2f2f692e696d6775722e636f6d2f61386562364b532e706e67"><img src="https://camo.githubusercontent.com/1af72755932cc7362558ab8073bb69e1630c1ba95bd60ef89c69b60acd60591f/68747470733a2f2f692e696d6775722e636f6d2f61386562364b532e706e67" data-canonical-src="https://i.imgur.com/a8eb6KS.png"/></a>
</p>

<p dir="auto"><strong>Method 1: Environment Variable</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="MAGIC=mtz bash
id  # uid=0(root)"><pre>MAGIC=mtz bash
id  <span><span>#</span> uid=0(root)</span></pre></div>
<p dir="auto"><strong>Method 2: Signal</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="kill -59 $$
id  # uid=0(root)"><pre><span>kill</span> -59 <span>$$</span>
id  <span><span>#</span> uid=0(root)</span></pre></div>
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/df121bd3f6a4cb1dcd0c8ea6f56e7239f6f51ffdcdb75ed6ae900d4a99e62d83/68747470733a2f2f692e696d6775722e636f6d2f6a436f69304c562e706e67"><img src="https://camo.githubusercontent.com/df121bd3f6a4cb1dcd0c8ea6f56e7239f6f51ffdcdb75ed6ae900d4a99e62d83/68747470733a2f2f692e696d6775722e636f6d2f6a436f69304c562e706e67" data-canonical-src="https://i.imgur.com/jCoi0LV.png"/></a>
</p>

<p dir="auto">Connections on your configured port are automatically hidden:</p>
<div dir="auto" data-snippet-clipboard-copy-content="nc -lvnp 8081

# Invisible to all monitoring
ss -tulpn | grep 8081        # (no output)
netstat -tulpn | grep 8081   # (no output)
lsof -i :8081                # (no output)
cat /proc/net/nf_conntrack | grep 8081  # (no output)

# Even advanced netlink queries are filtered
ss -tapen | grep 8081        # (no output)
conntrack -L | grep 8081     # (no output)"><pre>nc -lvnp 8081

<span><span>#</span> Invisible to all monitoring</span>
ss -tulpn <span>|</span> grep 8081        <span><span>#</span> (no output)</span>
netstat -tulpn <span>|</span> grep 8081   <span><span>#</span> (no output)</span>
lsof -i :8081                <span><span>#</span> (no output)</span>
cat /proc/net/nf_conntrack <span>|</span> grep 8081  <span><span>#</span> (no output)</span>

<span><span>#</span> Even advanced netlink queries are filtered</span>
ss -tapen <span>|</span> grep 8081        <span><span>#</span> (no output)</span>
conntrack -L <span>|</span> grep 8081     <span><span>#</span> (no output)</span></pre></div>
<p dir="auto">Packets are dropped at raw socket level (tpacket_rcv) and hidden from:</p>
<ul dir="auto">
<li>/proc/net/* interfaces (tcp, tcp6, udp, udp6)</li>
<li>/proc/net/nf_conntrack</li>
<li>Netlink SOCK_DIAG queries (used by ss, lsof)</li>
<li>Netlink NETFILTER/conntrack messages (used by conntrack tool)</li>
</ul>
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/dbdb816e5cb70620efcacfccb179cc3d7a3fe44ab98ad2e25a05c0a5477006b8/68747470733a2f2f692e696d6775722e636f6d2f5755754c7531712e706e67"><img src="https://camo.githubusercontent.com/dbdb816e5cb70620efcacfccb179cc3d7a3fe44ab98ad2e25a05c0a5477006b8/68747470733a2f2f692e696d6775722e636f6d2f5755754c7531712e706e67" data-canonical-src="https://i.imgur.com/WUuLu1q.png"/></a>
</p>

<p dir="auto">Trigger a hidden reverse shell remotely with automatic SELinux bypass:</p>
<p dir="auto"><strong>1. Start listener:</strong></p>

<p dir="auto"><strong>2. Send ICMP trigger:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo python3 scripts/trigger.py &lt;target_ip&gt;"><pre>sudo python3 scripts/trigger.py <span>&lt;</span>target_ip<span>&gt;</span></pre></div>
<p dir="auto"><strong>3. Receive root shell</strong> (automatically hidden with all child processes, SELinux enforcing mode bypassed if active)</p>
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/f27ea23729fa26469d60b33138b0b680f592cbb69b84f6feb67afbcc1c7eda2f/68747470733a2f2f692e696d6775722e636f6d2f34626d626d77592e706e67"><img src="https://camo.githubusercontent.com/f27ea23729fa26469d60b33138b0b680f592cbb69b84f6feb67afbcc1c7eda2f/68747470733a2f2f692e696d6775722e636f6d2f34626d626d77592e706e67" data-canonical-src="https://i.imgur.com/4bmbmwY.png"/></a>
</p>
<hr/>

<div dir="auto"><h3 tabindex="-1" dir="auto">Ftrace Control Protection</h3><a id="user-content-ftrace-control-protection" aria-label="Permalink: Ftrace Control Protection" href="#ftrace-control-protection"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">All attempts to disable ftrace are silently intercepted and blocked:</p>
<div dir="auto" data-snippet-clipboard-copy-content="echo 0 &gt; /proc/sys/kernel/ftrace_enabled       # Appears successful but does nothing"><pre><span>echo</span> 0 <span>&gt;</span> /proc/sys/kernel/ftrace_enabled       <span><span>#</span> Appears successful but does nothing</span></pre></div>
<p dir="auto">Protected syscalls: write, writev, pwrite64, pwritev, pwritev2, sendfile, sendfile64, splice, vmsplice, tee, copy_file_range, io_uring_enter (with intelligent per-PID caching)</p>

<p dir="auto">eBPF operations are intercepted and blocked:</p>
<ul dir="auto">
<li>BPF_PROG_LOAD (tracepoint, kprobe, tracing, LSM, ext types)</li>
<li>BPF_ITER_CREATE, BPF_PROG_GET_NEXT_ID, BPF_MAP_GET_NEXT_ID</li>
<li>BPF_RAW_TRACEPOINT_OPEN, BPF_LINK_CREATE</li>
<li>BPF_PROG_QUERY, BPF_OBJ_GET_INFO_BY_FD</li>
<li>All BPF operations from hidden PIDs</li>
</ul>

<p dir="auto">Protection against io_uring bypass in ftrace_enabled and tracing_on attempts with intelligent caching (1 second cache per PID to prevent repeated process scanning and reduce overhead)</p>

<p dir="auto">Real-time filtering of sensitive strings from all kernel log interfaces:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Interface</th>
<th>Hook</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dmesg</code></td>
<td>read hook on /proc/kmsg</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>journalctl -k</code></td>
<td>write hook (output filtering)</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>klogctl()</code> / <code>syslog()</code></td>
<td>do_syslog hook</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>/sys/kernel/debug/tracing/*</code></td>
<td>read hook</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>/var/log/kern.log</code>, <code>syslog</code>, <code>auth.log</code></td>
<td>read hook</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>/proc/kallsyms</code>, <code>/proc/kcore</code>, <code>/proc/vmallocinfo</code></td>
<td>read hook</td>
<td>✅ Filtered</td>
</tr>
<tr>
<td><code>/proc/net/nf_conntrack</code></td>
<td>read hook</td>
<td>✅ Filtered</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Filtered keywords: taint, journal, singularity, Singularity, matheuz, zer0t, kallsyms_lookup_name, obliviate, hook, hooked_, constprop, clear_taint, ftrace_helper, fh_install, fh_remove</p>
<p dir="auto"><strong>Note</strong>: Audit messages for hidden PIDs are dropped at netlink level with statistics tracking (get_blocked_audit_count, get_total_audit_count)</p>

<p dir="auto">Singularity hooks the write syscall to detect and filter output from disk forensics tools:</p>
<p dir="auto"><strong>How it works:</strong></p>
<ol dir="auto">
<li>Detects if process has a block device open (<code>/dev/sda</code>, <code>/dev/nvme0n1</code>, etc)</li>
<li>Detects debugfs-style output patterns (inode listings, filesystem metadata)</li>
<li>Sanitizes hidden patterns in-place (replaces with spaces to maintain buffer size/checksums)</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="# Hidden files are invisible even to raw disk analysis
debugfs /dev/sda3 -R &#39;ls -l /home/user/singularity&#39;
#            (spaces where &#34;singularity&#34; was)

# The pattern is sanitized in the output buffer
# Checksums remain valid, no corruption"><pre><span><span>#</span> Hidden files are invisible even to raw disk analysis</span>
debugfs /dev/sda3 -R <span><span>&#39;</span>ls -l /home/user/singularity<span>&#39;</span></span>
<span><span>#</span>            (spaces where &#34;singularity&#34; was)</span>

<span><span>#</span> The pattern is sanitized in the output buffer</span>
<span><span>#</span> Checksums remain valid, no corruption</span></pre></div>
<p dir="auto"><strong>Detected patterns:</strong></p>
<ul dir="auto">
<li><code>debugfs:</code> prefix</li>
<li>Inode listings with parentheses</li>
<li><code>Inode count:</code>, <code>Block count:</code>, <code>Filesystem volume name:</code></li>
<li><code>Filesystem UUID:</code>, <code>e2fsck</code>, <code>Inode:</code></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Process Hiding Implementation</h3><a id="user-content-process-hiding-implementation" aria-label="Permalink: Process Hiding Implementation" href="#process-hiding-implementation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Complete hiding from syscalls and kernel interfaces:</p>
<ul dir="auto">
<li>/proc/[pid]/* (openat, readlinkat blocked)</li>
<li>getdents, getdents64 (directory listing filtered)</li>
<li>stat, lstat, statx, newfstatat (metadata hidden)</li>
<li>kill with signal 0 (returns ESRCH)</li>
<li>getsid, getpgid, getpgrp (returns ESRCH)</li>
<li>sched_getaffinity, sched_getparam, sched_getscheduler, sched_rr_get_interval (returns ESRCH)</li>
<li>getpriority (returns ESRCH)</li>
<li>sysinfo (process count adjusted)</li>
<li>pidfd_open (returns ESRCH)</li>
<li>TaskStats netlink queries (returns ESRCH)</li>
<li>Cgroup PIDs filtered from cgroup.procs</li>
</ul>
<p dir="auto">Child processes automatically tracked via sched_process_fork tracepoint hook.</p>
<hr/>

<p dir="auto"><strong>Process Monitoring</strong>: ps, top, htop, etc</p>
<p dir="auto"><strong>Filesystem</strong>: ls, find, locate, stat, lstat, readlink</p>
<p dir="auto"><strong>Disk Forensics</strong>: debugfs, e2fsck (output filtered via write hook)</p>
<p dir="auto"><strong>Memory Forensics</strong>: Volatility, crash, gdb (via /proc/kcore filtering)</p>
<p dir="auto"><strong>Network</strong>: netstat, ss, lsof, tcpdump, wireshark, conntrack, /proc/net/*</p>
<p dir="auto"><strong>Logs &amp; Traces</strong>: dmesg, journalctl -k, klogctl, strace, ltrace, ftrace, perf, bpftrace, bpftool, libbpf</p>
<p dir="auto"><strong>Rootkit Detectors</strong>: unhide, chkrootkit, rkhunter</p>
<p dir="auto"><strong>Module Detection</strong>: lsmod, modinfo, /sys/module, /proc/modules, kmod</p>
<p dir="auto"><strong>Modern Detection</strong>: eBPF-based security tools (Tracee), io_uring-based monitors, and some Linux EDRs</p>
<hr/>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Syscall/Function</th>
<th>Module</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>getdents, getdents64</td>
<td>hiding_directory.c</td>
<td>Filter directory entries, hide PIDs</td>
</tr>
<tr>
<td>stat, lstat, newstat, newlstat, statx, newfstatat</td>
<td>hiding_stat.c</td>
<td>Hide file metadata, adjust nlink</td>
</tr>
<tr>
<td>getpriority</td>
<td>hiding_stat.c</td>
<td>Hide priority queries for hidden PIDs</td>
</tr>
<tr>
<td>openat</td>
<td>open.c</td>
<td>Block access to hidden /proc/[pid]</td>
</tr>
<tr>
<td>readlinkat</td>
<td>hiding_readlink.c</td>
<td>Block symlink resolution</td>
</tr>
<tr>
<td>chdir</td>
<td>hiding_chdir.c</td>
<td>Prevent cd into hidden dirs</td>
</tr>
<tr>
<td>read, pread64, readv, preadv</td>
<td>clear_taint_dmesg.c</td>
<td>Filter kernel logs, kcore, kallsyms, cgroup PIDs, nf_conntrack</td>
</tr>
<tr>
<td>do_syslog</td>
<td>clear_taint_dmesg.c</td>
<td>Filter klogctl()/syslog() kernel ring buffer</td>
</tr>
<tr>
<td>sched_debug_show</td>
<td>clear_taint_dmesg.c</td>
<td>Filter scheduler debug output</td>
</tr>
<tr>
<td>write, writev, pwrite64, pwritev, pwritev2</td>
<td>hooks_write.c</td>
<td>Block ftrace control + filter disk forensics + filter journalctl output</td>
</tr>
<tr>
<td>sendfile, sendfile64, copy_file_range</td>
<td>hooks_write.c</td>
<td>Block file copies to protected files</td>
</tr>
<tr>
<td>splice, vmsplice, tee</td>
<td>hooks_write.c</td>
<td>Block pipe-based writes to protected files</td>
</tr>
<tr>
<td>io_uring_enter</td>
<td>hooks_write.c</td>
<td>Block async I/O bypass with PID caching</td>
</tr>
<tr>
<td>kill, getuid</td>
<td>become_root.c</td>
<td>Root trigger + magic env detection</td>
</tr>
<tr>
<td>getsid, getpgid, getpgrp</td>
<td>become_root.c</td>
<td>Returns ESRCH for hidden PIDs</td>
</tr>
<tr>
<td>sched_getaffinity, sched_getparam, sched_getscheduler, sched_rr_get_interval</td>
<td>become_root.c</td>
<td>Returns ESRCH for hidden PIDs</td>
</tr>
<tr>
<td>sysinfo</td>
<td>become_root.c</td>
<td>Adjusts process count</td>
</tr>
<tr>
<td>pidfd_open</td>
<td>become_root.c</td>
<td>Returns ESRCH for hidden PIDs</td>
</tr>
<tr>
<td>tcp4_seq_show, tcp6_seq_show</td>
<td>hiding_tcp.c</td>
<td>Hide TCP connections from /proc/net</td>
</tr>
<tr>
<td>udp4_seq_show, udp6_seq_show</td>
<td>hiding_tcp.c</td>
<td>Hide UDP connections from /proc/net</td>
</tr>
<tr>
<td>tpacket_rcv</td>
<td>hiding_tcp.c</td>
<td>Drop packets at raw socket level</td>
</tr>
<tr>
<td>recvmsg</td>
<td>audit.c</td>
<td>Filter netlink SOCK_DIAG and NETFILTER messages</td>
</tr>
<tr>
<td>netlink_unicast</td>
<td>audit.c</td>
<td>Drop audit messages for hidden PIDs</td>
</tr>
<tr>
<td>bpf</td>
<td>bpf_hook.c</td>
<td>Block eBPF tracing operations</td>
</tr>
<tr>
<td>init_module, finit_module</td>
<td>hooking_insmod.c</td>
<td>Prevent module loading</td>
</tr>
<tr>
<td>icmp_rcv</td>
<td>icmp.c</td>
<td>ICMP-triggered reverse shell with SELinux bypass</td>
</tr>
<tr>
<td>taskstats_user_cmd</td>
<td>task.c</td>
<td>Block TaskStats queries for hidden PIDs</td>
</tr>
<tr>
<td>sched_process_fork (tracepoint)</td>
<td>trace.c</td>
<td>Track child processes</td>
</tr>
<tr>
<td>tainted_mask (kthread)</td>
<td>reset_tainted.c</td>
<td>Clear kernel taint flags</td>
</tr>
<tr>
<td>module_hide_current</td>
<td>hide_module.c</td>
<td>Remove from module lists and sysfs</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><strong>Multi-Architecture Support</strong>: x86_64 (<code>__x64_sys_*</code>) and ia32 (<code>__ia32_sys_*</code>, <code>__ia32_compat_sys_*</code>)</p>
<hr/>

<p dir="auto"><strong>Tested on</strong>: Kernel 6.8.0-79-generic ✅ | Kernel 6.12 ✅ | Kernel 6.17.8-300.fc43 ✅</p>
<p dir="auto"><strong>Architecture</strong>: x86_64 (primary) | ia32 (full support)</p>
<p dir="auto"><strong>May not work on</strong>: Kernels &lt; 6.x | Kernels without ftrace support</p>
<p dir="auto"><strong>Always test in a VM first</strong></p>
<hr/>

<p dir="auto">Unfortunately for some...</p>
<p dir="auto">Even with all these filters, protections, and hooks, there are still ways to detect this rootkit.</p>
<p dir="auto">But if you&#39;re a good forensic analyst, DFIR professional, or malware researcher, I&#39;ll let you figure it out on your own.</p>
<p dir="auto">I won&#39;t patch for this, because it will be much more OP ;)</p>
<hr/>

<p dir="auto"><strong>Singularity</strong> was created by <strong>MatheuZSecurity</strong> (Matheus Alves)</p>
<ul dir="auto">
<li>LinkedIn: <a href="https://www.linkedin.com/in/mathsalves/" rel="nofollow">mathsalves</a></li>
<li>Discord: <code>kprobe</code></li>
</ul>
<p dir="auto"><strong>Join Rootkit Researchers</strong>: Discord - <a href="https://discord.gg/66N5ZQppU7" rel="nofollow">https://discord.gg/66N5ZQppU7</a></p>

<ul dir="auto">
<li><a href="https://github.com/iurjscsi1101500/fuxSocy/tree/main">fuxSocy</a></li>
<li><a href="https://github.com/malefax/Adrishya/blob/main/Adrishya.c#L158">Adrishya</a></li>
<li><a href="https://github.com/MatheuZSecurity/Rootkit">MatheuZSecurity/Rootkit</a></li>
</ul>

<ul dir="auto">
<li><a href="https://github.com/carloslack/KoviD">KoviD</a></li>
<li><a href="https://github.com/lil-skelly/basilisk">Basilisk</a></li>
<li><a href="https://github.com/m0nad/Diamorphine">GOAT Diamorphine rootkit</a></li>
</ul>
<hr/>

<ul dir="auto">
<li>Submit pull requests for improvements</li>
<li>Report bugs via GitHub issues</li>
<li>Suggest new evasion techniques</li>
<li>Share detection methods (for research)</li>
</ul>
<p dir="auto"><strong>Found a bug?</strong> Open an issue or contact me on Discord: <code>kprobe</code></p>
<hr/>
<p dir="auto"><strong>FOR EDUCATIONAL AND RESEARCH PURPOSES ONLY</strong></p>
<p dir="auto">Singularity was created as a research project to explore the limits of kernel-level stealth techniques. The goal is to answer one question: <strong>&#34;How far can a rootkit hide if it manages to infiltrate and load into a system?&#34;</strong></p>
<p dir="auto">This project exists to:</p>
<ul dir="auto">
<li>Push the boundaries of offensive security research</li>
<li>Help defenders understand what they&#39;re up against</li>
<li>Provide a learning resource for kernel internals and evasion techniques</li>
<li>Contribute to the security community&#39;s knowledge base</li>
</ul>
<p dir="auto"><strong>I am not responsible for any misuse of this software.</strong> If you choose to use Singularity for malicious purposes, that&#39;s on you. This tool is provided as-is for research, education, and authorized security testing only.</p>
<p dir="auto">Test only on systems you own or have explicit written permission to test. Unauthorized access to computer systems is illegal in most jurisdictions.</p>
<p dir="auto"><strong>Be a researcher, not a criminal.</strong></p>
</article></div></div>
  </body>
</html>
