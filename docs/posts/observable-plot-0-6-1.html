<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/observablehq/plot/blob/main/CHANGELOG.md">Original</a>
    <h1>Observable Plot 0.6.1</h1>
    
    <div id="readability-page-1" class="page"><div>

    <div data-target="readme-toc.content">
      
  


        <div id="readme">
    <article itemprop="text">
<h2 dir="auto"><a id="user-content-061" aria-hidden="true" href="#061"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.6.1</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.6.1">Released December 12, 2022.</a></p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#geo">geo mark</a> renders GeoJSON geometries such as polygons, lines, and points. Together with Plot’s new <a href="https://observablehq.com/@observablehq/plot-projections" rel="nofollow">projection system</a>, Plot can now produce <a href="https://observablehq.com/@observablehq/plot-mapping" rel="nofollow">thematic maps</a>. For example, the choropleth map below shows unemployment rates by U.S. county.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-geo" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/choropleth.png" width="640" alt="A choropleth of unemployment rate by U.S. county"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.geo(counties, {fill: (d) =&gt; d.properties.unemployment}).plot({
  projection: &#34;albers-usa&#34;,
  color: {
    type: &#34;quantile&#34;,
    n: 8,
    scheme: &#34;blues&#34;,
    label: &#34;Unemployment (%)&#34;,
    legend: true
  }
})"><pre><span>Plot</span><span>.</span><span>geo</span><span>(</span><span>counties</span><span>,</span> <span>{</span><span>fill</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>d</span><span>.</span><span>properties</span><span>.</span><span>unemployment</span><span>}</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>projection</span>: <span>&#34;albers-usa&#34;</span><span>,</span>
  <span>color</span>: <span>{</span>
    <span>type</span>: <span>&#34;quantile&#34;</span><span>,</span>
    <span>n</span>: <span>8</span><span>,</span>
    <span>scheme</span>: <span>&#34;blues&#34;</span><span>,</span>
    <span>label</span>: <span>&#34;Unemployment (%)&#34;</span><span>,</span>
    <span>legend</span>: <span>true</span>
  <span>}</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new top-level <a href="https://github.com/observablehq/plot/blob/main/README.md#projection-options"><strong>projection</strong> option</a> controls how geometric coordinates are transformed to the screen and supports a variety of common geographic projections, including the composite U.S. Albers projection shown above, the Equal Earth projection, the Mercator projection, the orthographic and stereographic projections, several conic and azimuthal projections, among others. Projections can be fit to geometry using the projection.<strong>domain</strong> option, and rotated to an arbitrary aspect using the projection.<strong>rotate</strong> option.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-projections" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/orthographic.png" width="640" alt="A world map using the orthographic projection, centered somewhere around San Antonio, Texas"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  height: 640,
  inset: 1,
  projection: {type: &#34;orthographic&#34;, rotate: [100, -30]},
  marks: [
    Plot.graticule(),
    Plot.geo(land, {fill: &#34;currentColor&#34;}),
    Plot.sphere()
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>640</span><span>,</span>
  <span>inset</span>: <span>1</span><span>,</span>
  <span>projection</span>: <span>{</span><span>type</span>: <span>&#34;orthographic&#34;</span><span>,</span> <span>rotate</span>: <span>[</span><span>100</span><span>,</span> <span>-</span><span>30</span><span>]</span><span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>graticule</span><span>(</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>land</span><span>,</span> <span>{</span><span>fill</span>: <span>&#34;currentColor&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>sphere</span><span>(</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new graticule convenience mark renders meridians and parallels (lines of constant longitude and latitude), while the sphere convenience mark draws the outline of the sphere.</p>
<p dir="auto">Plot’s projection system works automatically with most of Plot’s mark types, including dots, vectors, lines, and rects. For geographic projections, <em>x</em> represents longitude and <em>y</em> represents latitude. For example, the map below uses vectors to show county-level vote margins in the 2020 U.S. presidential election: a margin for Biden is shown as a blue left-pointing arrow, while a margin for Trump is shown as a red right-pointing arrow; the length of the arrow is proportional to the margin.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-mapping" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/vector-map.png" width="640" alt="An arrow map showing the county-level vote margins in the 2020 U.S. presidential election; a margin for Biden is shown as a blue left-pointing arrow, and a margin for Trump is shown as a red right-pointing arrow"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  width: 975,
  projection: &#34;albers-usa&#34;,
  marks: [
    Plot.geo(statemesh, {strokeOpacity: 0.25}),
    Plot.geo(nation),
    Plot.vector(elections, {
      filter: (d) =&gt; d.votes &gt; 0,
      anchor: &#34;start&#34;,
      x: (d) =&gt; centroids.get(d.fips)?.[0],
      y: (d) =&gt; centroids.get(d.fips)?.[1],
      sort: (d) =&gt; Math.abs(d.results_trumpd - d.results_bidenj),
      stroke: (d) =&gt; (d.results_trumpd &gt; d.results_bidenj ? &#34;red&#34; : &#34;blue&#34;),
      length: (d) =&gt; Math.sqrt(Math.abs(d.margin2020 * d.votes)),
      rotate: (d) =&gt; (d.results_bidenj &lt; d.results_trumpd ? 60 : -60)
    })
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>width</span>: <span>975</span><span>,</span>
  <span>projection</span>: <span>&#34;albers-usa&#34;</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>statemesh</span><span>,</span> <span>{</span><span>strokeOpacity</span>: <span>0.25</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>nation</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>vector</span><span>(</span><span>elections</span><span>,</span> <span>{</span>
      <span>filter</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>d</span><span>.</span><span>votes</span> <span>&gt;</span> <span>0</span><span>,</span>
      <span>anchor</span>: <span>&#34;start&#34;</span><span>,</span>
      <span>x</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>centroids</span><span>.</span><span>get</span><span>(</span><span>d</span><span>.</span><span>fips</span><span>)</span><span>?.</span><span>[</span><span>0</span><span>]</span><span>,</span>
      <span>y</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>centroids</span><span>.</span><span>get</span><span>(</span><span>d</span><span>.</span><span>fips</span><span>)</span><span>?.</span><span>[</span><span>1</span><span>]</span><span>,</span>
      <span>sort</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>Math</span><span>.</span><span>abs</span><span>(</span><span>d</span><span>.</span><span>results_trumpd</span> <span>-</span> <span>d</span><span>.</span><span>results_bidenj</span><span>)</span><span>,</span>
      <span>stroke</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>(</span><span>d</span><span>.</span><span>results_trumpd</span> <span>&gt;</span> <span>d</span><span>.</span><span>results_bidenj</span> ? <span>&#34;red&#34;</span> : <span>&#34;blue&#34;</span><span>)</span><span>,</span>
      <span>length</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>Math</span><span>.</span><span>sqrt</span><span>(</span><span>Math</span><span>.</span><span>abs</span><span>(</span><span>d</span><span>.</span><span>margin2020</span> <span>*</span> <span>d</span><span>.</span><span>votes</span><span>)</span><span>)</span><span>,</span>
      <span>rotate</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>(</span><span>d</span><span>.</span><span>results_bidenj</span> <span>&lt;</span> <span>d</span><span>.</span><span>results_trumpd</span> ? <span>60</span> : <span>-</span><span>60</span><span>)</span>
    <span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">For the <a href="https://github.com/observablehq/plot/blob/main/README.md#line">line mark</a>, the specified projection doesn’t simply project control points; the projection has full control over how geometry is transformed from its native coordinate system (often spherical) to the screen. This allows line geometry to be represented as <a href="https://en.wikipedia.org/wiki/Geodesic" rel="nofollow">geodesics</a>, which are sampled and clipped during projection. For example, the map below shows the route of Charles Darwin’s voyage on the HMS <em>Beagle</em>; note that the line is cut when it crosses the antimeridian in the Pacific ocean. (Also note the use of the <em>stroke</em> channel to vary color.)</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-geo" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/beagle.png" width="640" alt="A map of the route of the HMS Beagle, 1831–1836; color indicates direction, with the ship initially departing London and heading southwest before circumnavigating the globe"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  projection: &#34;equal-earth&#34;,
  marks: [
    Plot.geo(land, {fill: &#34;currentColor&#34;}),
    Plot.graticule(),
    Plot.line(beagle, {stroke: (d, i) =&gt; i, z: null, strokeWidth: 2}),
    Plot.sphere()
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>projection</span>: <span>&#34;equal-earth&#34;</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>land</span><span>,</span> <span>{</span><span>fill</span>: <span>&#34;currentColor&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>graticule</span><span>(</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>line</span><span>(</span><span>beagle</span><span>,</span> <span>{</span><span>stroke</span>: <span>(</span><span>d</span><span>,</span> <span>i</span><span>)</span> <span>=&gt;</span> <span>i</span><span>,</span> <span>z</span>: <span>null</span><span>,</span> <span>strokeWidth</span>: <span>2</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>sphere</span><span>(</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Plot’s new geo mark and projection system work with Plot’s other core features, including scales, legends, faceting, and transforms. For example, here is a faceted dot map showing openings of Walmart stores over five decades.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-mapping" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/faceted-map.png" width="930" alt="A dot map of Walmart store openings faceted by decade"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  width: 975,
  projection: &#34;albers&#34;,
  fx: {tickFormat: (d) =&gt; `${d}’s`},
  facet: {data: walmarts, x: (d) =&gt; Math.floor(d.date.getUTCFullYear() / 10) * 10},
  marks: [
    Plot.geo(statemesh, {strokeOpacity: 0.1}),
    Plot.dot(walmarts, {x: &#34;longitude&#34;, y: &#34;latitude&#34;, r: 1, fill: &#34;currentColor&#34;}),
    Plot.geo(nation)
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>width</span>: <span>975</span><span>,</span>
  <span>projection</span>: <span>&#34;albers&#34;</span><span>,</span>
  <span>fx</span>: <span>{</span><span>tickFormat</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>`<span><span>${</span><span>d</span><span>}</span></span>’s`</span><span>}</span><span>,</span>
  <span>facet</span>: <span>{</span><span>data</span>: <span>walmarts</span><span>,</span> <span>x</span>: <span>(</span><span>d</span><span>)</span> <span>=&gt;</span> <span>Math</span><span>.</span><span>floor</span><span>(</span><span>d</span><span>.</span><span>date</span><span>.</span><span>getUTCFullYear</span><span>(</span><span>)</span> <span>/</span> <span>10</span><span>)</span> <span>*</span> <span>10</span><span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>statemesh</span><span>,</span> <span>{</span><span>strokeOpacity</span>: <span>0.1</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>walmarts</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;longitude&#34;</span><span>,</span> <span>y</span>: <span>&#34;latitude&#34;</span><span>,</span> <span>r</span>: <span>1</span><span>,</span> <span>fill</span>: <span>&#34;currentColor&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>nation</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">As another example using the same dataset, the map below uses the hexbin transform to aggregate Walmart store opening into local hexagons.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-mapping" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/hexbin-map.png" width="640" alt="A bivariate hexbin map of Walmart store openings; within each hexagonal area, size indicates the number of Walmart store openings, and color indicates the year of the first opening"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  projection: &#34;albers&#34;,
  color: {
    legend: true,
    label: &#34;First year opened&#34;,
    scheme: &#34;spectral&#34;
  },
  marks: [
    Plot.geo(statemesh, {strokeOpacity: 0.25}),
    Plot.geo(nation),
    Plot.dot(walmarts, Plot.hexbin({r: &#34;count&#34;, fill: &#34;min&#34;}, {x: &#34;longitude&#34;, y: &#34;latitude&#34;, fill: &#34;date&#34;}))
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>projection</span>: <span>&#34;albers&#34;</span><span>,</span>
  <span>color</span>: <span>{</span>
    <span>legend</span>: <span>true</span><span>,</span>
    <span>label</span>: <span>&#34;First year opened&#34;</span><span>,</span>
    <span>scheme</span>: <span>&#34;spectral&#34;</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>statemesh</span><span>,</span> <span>{</span><span>strokeOpacity</span>: <span>0.25</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>nation</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>walmarts</span><span>,</span> <span>Plot</span><span>.</span><span>hexbin</span><span>(</span><span>{</span><span>r</span>: <span>&#34;count&#34;</span><span>,</span> <span>fill</span>: <span>&#34;min&#34;</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;longitude&#34;</span><span>,</span> <span>y</span>: <span>&#34;latitude&#34;</span><span>,</span> <span>fill</span>: <span>&#34;date&#34;</span><span>}</span><span>)</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">In addition to the included basic projections, Plot’s projection system can be extended using any projection implementation compatible with D3’s <a href="https://github.com/d3/d3-geo/blob/main/README.md#streams">projection stream interface</a>. This includes all the projections provided by the <a href="https://github.com/d3/d3-geo-projection">d3-geo-projection</a> and <a href="https://github.com/d3/d3-geo-polygon">d3-geo-polygon</a> libraries! For example, here is a world map using Goode’s interrupted homolosine projection.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-extended-projections" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/goode.png" width="640" alt="A world map using Goode’s interrupted homolosine projection"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  width: 975,
  height: 424,
  inset: 1,
  projection: {
    type: d3.geoInterruptedHomolosine,
    domain: {type: &#34;Sphere&#34;}
  },
  marks: [
    Plot.geo(land, {clip: &#34;sphere&#34;, fill: &#34;currentColor&#34;}),
    Plot.graticule({clip: &#34;sphere&#34;}),
    Plot.sphere()
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>width</span>: <span>975</span><span>,</span>
  <span>height</span>: <span>424</span><span>,</span>
  <span>inset</span>: <span>1</span><span>,</span>
  <span>projection</span>: <span>{</span>
    <span>type</span>: <span>d3</span><span>.</span><span>geoInterruptedHomolosine</span><span>,</span>
    <span>domain</span>: <span>{</span><span>type</span>: <span>&#34;Sphere&#34;</span><span>}</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>geo</span><span>(</span><span>land</span><span>,</span> <span>{</span><span>clip</span>: <span>&#34;sphere&#34;</span><span>,</span> <span>fill</span>: <span>&#34;currentColor&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>graticule</span><span>(</span><span>{</span><span>clip</span>: <span>&#34;sphere&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>sphere</span><span>(</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Plot now supports <a href="https://github.com/observablehq/plot/blob/main/README.md#facet-options">mark-level faceting</a> via the new <em>mark</em>.<strong>fx</strong> and <em>mark</em>.<strong>fy</strong> options. Mark-level faceting makes it easier to control which marks are faceted (versus repeated across facets), especially when combining multiple datasets or specifying faceted annotations.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-facets" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/anscombe.png" width="640" alt="A faceted scatterplot of Anscombe’s quartet"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  grid: true,
  height: 180,
  marks: [Plot.frame(), Plot.dot(anscombe, {x: &#34;x&#34;, y: &#34;y&#34;, fx: &#34;series&#34;})]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>grid</span>: <span>true</span><span>,</span>
  <span>height</span>: <span>180</span><span>,</span>
  <span>marks</span>: <span>[</span><span>Plot</span><span>.</span><span>frame</span><span>(</span><span>)</span><span>,</span> <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>anscombe</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;x&#34;</span><span>,</span> <span>y</span>: <span>&#34;y&#34;</span><span>,</span> <span>fx</span>: <span>&#34;series&#34;</span><span>}</span><span>)</span><span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">When mark-level faceting is used, the mark will be faceted if either the <em>mark</em>.<strong>fx</strong> or <em>mark</em>.<strong>fy</strong> channel option (or both) is specified. As before, you can set the <em>mark</em>.<strong>facet</strong> option to null or false option will disable faceting, or to <em>exclude</em> to draw the subset of the mark’s data not in the current facet.</p>
<p dir="auto">In addition to the above new features, this release also includes a variety of bug fixes. The <em>fx</em> and <em>fy</em> scales now support the <em>scale</em>.<strong>transform</strong> and <em>scale</em>.<strong>percent</strong> options. The <em>quantize</em> scale now respects the <em>scale</em>.<strong>unknown</strong> option. Initializers (including dodge and hexbin) no longer unintentionally drop the <em>mark</em>.<strong>sort</strong> option when being used to sort a scale’s domain. The error message when an invalid color scheme is specified has been improved. Plot no longer warns about empty strings appearing to be numbers. The <em>mean</em> and <em>median</em> reducers now return dates if the data is temporal. The default <strong>height</strong> now adjusts automatically to preserve the inner size of the plot when margins are specified. Fix the position of the frame anchor when either the <em>x</em> or <em>y</em> scale is ordinal (band or point). Dots with a negative constant radius <em>r</em> are no longer rendered rather than generating invalid SVG.</p>
<h2 dir="auto"><a id="user-content-060" aria-hidden="true" href="#060"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.6.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.6.0">Released September 7, 2022.</a></p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-window" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/window-strict.png" width="640" alt="A smoothed line chart of Apple’s stock price"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  marks: [
    Plot.lineY(aapl, {x: &#34;Date&#34;, y: &#34;Close&#34;, stroke: &#34;#ccc&#34;, strokeWidth: 1}),
    Plot.lineY(aapl, Plot.windowY({k: 20, strict: false}, {x: &#34;Date&#34;, y: &#34;Close&#34;, stroke: &#34;red&#34;})),
    Plot.lineY(aapl, Plot.windowY({k: 20, strict: true}, {x: &#34;Date&#34;, y: &#34;Close&#34;}))
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>aapl</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Close&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;#ccc&#34;</span><span>,</span> <span>strokeWidth</span>: <span>1</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>aapl</span><span>,</span> <span>Plot</span><span>.</span><span>windowY</span><span>(</span><span>{</span><span>k</span>: <span>20</span><span>,</span> <span>strict</span>: <span>false</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Close&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;red&#34;</span><span>}</span><span>)</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>aapl</span><span>,</span> <span>Plot</span><span>.</span><span>windowY</span><span>(</span><span>{</span><span>k</span>: <span>20</span><span>,</span> <span>strict</span>: <span>true</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Close&#34;</span><span>}</span><span>)</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">[breaking] <a href="https://github.com/observablehq/plot/blob/main/README.md#plotwindowk">Plot.window</a>, <a href="https://github.com/observablehq/plot/blob/main/README.md#plotwindowxk-options">Plot.windowX</a> and <a href="https://github.com/observablehq/plot/blob/main/README.md#plotwindowyk-options">Plot.windowY</a> now return an aggregate value even when the window contains undefined values, for example at the beginning or end of a series. Set the new <strong>strict</strong> option to true to instead return undefined if the window contains any undefined values.</p>
<p dir="auto">Parts of the README have been incorporated throughout the codebase as JSDoc comments. This allows IDEs to display the documentation as tooltips.</p>
<h2 dir="auto"><a id="user-content-052" aria-hidden="true" href="#052"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.5.2</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.5.2">Released July 4, 2022.</a></p>
<p dir="auto">Swatches legends are now rendered in SVG, supporting patterns and gradients. Swatches legends now require an <em>ordinal</em>, <em>categorical</em>, or <em>threshold</em> color scale and will throw an error if you attempt to use them with an unsupported color scale type (such as a <em>linear</em> or <em>diverging</em> scale).</p>
<p dir="auto">The new top-level <strong>document</strong> option specifies the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document" rel="nofollow">document</a> used to create plot elements. It defaults to window.document, but can be changed to another document, say when using a virtual DOM library for server-side rendering in Node.</p>
<p dir="auto">Plot now uses D3 7.6.1, using <a href="https://observablehq.com/@d3/d3-blur" rel="nofollow">d3.blur2</a> for a faster blur operator supporting fractional bandwidths when computing density contours. Plot now uses a duck test to detect marks (rather than strict instanceof), allowing marks from different versions of Plot to be combined into a single plot. Plot is now partially written in TypeScript. In the future, Plot will be written entirely in TypeScript and will export TypeScript type definition files to assist Plot development.</p>
<h2 dir="auto"><a id="user-content-051" aria-hidden="true" href="#051"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.5.1</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.5.1">Released June 27, 2022.</a></p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#density">density mark</a> creates contours representing the <a href="https://en.wikipedia.org/wiki/Multivariate_kernel_density_estimation" rel="nofollow">estimated density</a> of two-dimensional point clouds. The <strong>bandwidth</strong> and number of <strong>thresholds</strong> are configurable.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-density" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/density-contours.png" width="640" alt="A scatterplot showing the relationship between the idle duration and eruption duration for Old Faithful"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  inset: 20,
  marks: [
    Plot.density(faithful, {x: &#34;waiting&#34;, y: &#34;eruptions&#34;, stroke: &#34;steelblue&#34;, strokeWidth: 0.25}),
    Plot.density(faithful, {x: &#34;waiting&#34;, y: &#34;eruptions&#34;, stroke: &#34;steelblue&#34;, thresholds: 4}),
    Plot.dot(faithful, {x: &#34;waiting&#34;, y: &#34;eruptions&#34;, fill: &#34;currentColor&#34;, r: 1.5})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>inset</span>: <span>20</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>density</span><span>(</span><span>faithful</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;waiting&#34;</span><span>,</span> <span>y</span>: <span>&#34;eruptions&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;steelblue&#34;</span><span>,</span> <span>strokeWidth</span>: <span>0.25</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>density</span><span>(</span><span>faithful</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;waiting&#34;</span><span>,</span> <span>y</span>: <span>&#34;eruptions&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;steelblue&#34;</span><span>,</span> <span>thresholds</span>: <span>4</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>faithful</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;waiting&#34;</span><span>,</span> <span>y</span>: <span>&#34;eruptions&#34;</span><span>,</span> <span>fill</span>: <span>&#34;currentColor&#34;</span><span>,</span> <span>r</span>: <span>1.5</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">By default, as shown above, the density is represented by contour lines. By setting the <strong>fill</strong> option to <em>density</em>, you can draw filled regions with a sequential color encoding instead.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-density" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/density-fill.png" width="640" alt="A contour plot showing the relationship between diamond price and weight"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.density(diamonds, {x: &#34;carat&#34;, y: &#34;price&#34;, fill: &#34;density&#34;}).plot({
  height: 500,
  grid: true,
  x: {type: &#34;log&#34;},
  y: {type: &#34;log&#34;},
  color: {scheme: &#34;ylgnbu&#34;}
})"><pre><span>Plot</span><span>.</span><span>density</span><span>(</span><span>diamonds</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;carat&#34;</span><span>,</span> <span>y</span>: <span>&#34;price&#34;</span><span>,</span> <span>fill</span>: <span>&#34;density&#34;</span><span>}</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>500</span><span>,</span>
  <span>grid</span>: <span>true</span><span>,</span>
  <span>x</span>: <span>{</span><span>type</span>: <span>&#34;log&#34;</span><span>}</span><span>,</span>
  <span>y</span>: <span>{</span><span>type</span>: <span>&#34;log&#34;</span><span>}</span><span>,</span>
  <span>color</span>: <span>{</span><span>scheme</span>: <span>&#34;ylgnbu&#34;</span><span>}</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#linear-regression">linear regression marks</a> produce <a href="https://en.wikipedia.org/wiki/Linear_regression" rel="nofollow">linear regressions</a> with <a href="https://en.wikipedia.org/wiki/Confidence_interval" rel="nofollow">confidence interval</a> bands, representing the estimated relation of a dependent variable (typically <em>y</em>) on an independent variable (typically <em>x</em>).</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-linear-regression" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/linear-regression.png" width="640" alt="a scatterplot of penguin culmens, showing the length and depth of several species, with linear regression models by species and for the whole population, illustrating Simpson’s paradox"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  grid: true,
  marks: [
    Plot.dot(penguins, {x: &#34;culmen_length_mm&#34;, y: &#34;culmen_depth_mm&#34;, fill: &#34;species&#34;}),
    Plot.linearRegressionY(penguins, {x: &#34;culmen_length_mm&#34;, y: &#34;culmen_depth_mm&#34;, stroke: &#34;species&#34;}),
    Plot.linearRegressionY(penguins, {x: &#34;culmen_length_mm&#34;, y: &#34;culmen_depth_mm&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>grid</span>: <span>true</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span> <span>y</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span> <span>fill</span>: <span>&#34;species&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>linearRegressionY</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span> <span>y</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;species&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>linearRegressionY</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span> <span>y</span>: <span>&#34;culmen_depth_mm&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#delaunay">Delaunay and Voronoi marks</a> produce Delaunay triangulations and Voronoi tesselations: <a href="https://github.com/observablehq/plot/blob/main/README.md#plotdelaunaylinkdata-options">Plot.delaunayLink</a> draws links for each edge of the Delaunay triangulation of the given points, <a href="https://github.com/observablehq/plot/blob/main/README.md#plotdelaunaymeshdata-options">Plot.delaunayMesh</a> draws a mesh of the Delaunay triangulation  of the given points, <a href="https://github.com/observablehq/plot/blob/main/README.md#plothulldata-options">Plot.hull</a> draws a convex hull around the given points, <a href="https://github.com/observablehq/plot/blob/main/README.md#plotvoronoidata-options">Plot.voronoi</a> draws polygons for each cell of the Voronoi tesselation of the given points, and <a href="https://github.com/observablehq/plot/blob/main/README.md#plotvoronoimeshdata-options">Plot.voronoiMesh</a> draws a mesh for the cell boundaries of the Voronoi tesselation of the given points.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-delaunay" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/voronoi.png" width="640" alt="a Voronoi diagram of penguin culmens, showing the length and depth of several species"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  marks: [
    Plot.voronoi(penguins, {x: &#34;culmen_depth_mm&#34;, y: &#34;culmen_length_mm&#34;, fill: &#34;species&#34;, fillOpacity: 0.2, stroke: &#34;white&#34;}),
    Plot.dot(penguins, {x: &#34;culmen_depth_mm&#34;, y: &#34;culmen_length_mm&#34;, fill: &#34;species&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>voronoi</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span> <span>y</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span> <span>fill</span>: <span>&#34;species&#34;</span><span>,</span> <span>fillOpacity</span>: <span>0.2</span><span>,</span> <span>stroke</span>: <span>&#34;white&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span> <span>y</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span> <span>fill</span>: <span>&#34;species&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">For data at regular intervals, such as integer values or daily samples, the new <a href="https://github.com/observablehq/plot/blob/main/README.md#scale-options"><em>scale</em>.<strong>interval</strong> option</a> can be used to enforce uniformity. The specified <em>interval</em>—such as d3.utcMonth—sets the default <em>scale</em>.transform to the given interval’s <em>interval</em>.floor function. In addition, for ordinal scales the default <em>scale</em>.<strong>domain</strong> is an array of uniformly-spaced values spanning the extent of the values associated with the scale.</p>
<p dir="auto">All marks now support the <strong>pointerEvents</strong> option to set the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events" rel="nofollow">pointer-events attribute</a>. The frame decoration mark now supports the <strong>rx</strong> and <strong>ry</strong> options. The cell mark now respects the <strong>dx</strong> and <strong>dy</strong> options.</p>
<p dir="auto">Fix a bug where arrow heads would not render correctly when the <strong>strokeWidth</strong> was exactly one. Fix the <em>scale</em>.<strong>zero</strong> option when the domain is negative. Fix the <strong>clip</strong> mark option when <em>x</em> or <em>y</em> is a <em>band</em> scale. Fix the fill color of text marks using the <strong>href</strong> option. Fix a crash in the bar and tick mark when the associated band scale is not present, as when these marks are used (erroneously) with the dodge transform. Use <em>element</em>.appendChild instead of <em>element</em>.append for the benefit of DOM implementations that do not support the full DOM standard.</p>
<p dir="auto">Improve the error message when the <strong>facet</strong> option is used without <strong>data</strong>. Throw an error if initializers attempt to create position scales. Throw an error if an implicit ordinal position domain has more than 10,000 values.</p>
<p dir="auto">[breaking] Plot now requires <a href="https://github.com/d3/d3/releases/tag/v7.5.0">D3 ^7.5.0</a>.</p>
<h2 dir="auto"><a id="user-content-050" aria-hidden="true" href="#050"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.5.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.5.0">Released June 7, 2022.</a></p>
<p dir="auto">Plot now supports <a href="https://github.com/observablehq/plot/blob/main/README.md#initializers">mark initializers</a> via the <strong>initializer</strong> option. Initializers can transform data, channels, and indexes. Unlike <a href="https://github.com/observablehq/plot/blob/main/README.md#transforms">data transforms</a> which operate in abstract data space, initializers can operate in screen space such as pixel coordinates and colors. For example, initializers can modify a marks’ positions to avoid occlusion. The new hexbin and dodge transforms are implemented as mark initializers.</p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#hexbin">hexbin transform</a> functions similarly to the bin transform, except it aggregates both <em>x</em> and <em>y</em> into hexagonal bins before reducing. The size of the hexagons can be specified with the <strong>binWidth</strong> option, which controls the width of the (pointy-topped) hexagons.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-hexbin" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/hexbin.png" width="640" alt="a chart showing the inverse relationship of fuel economy to engine displacement, and the positive correlation of engine displacement and weight; hexagonal bins of varying size represent the number of cars at each location, while color encodes the mean weight of nearby cars"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  color: {
    legend: true
  },
  marks: [
    Plot.hexagon(
      cars,
      Plot.hexbin(
        {r: &#34;count&#34;, fill: &#34;mean&#34;},
        {x:  &#34;displacement (cc)&#34;, y: &#34;economy (mpg)&#34;, fill: &#34;weight (lb)&#34;}
      )
    )
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>color</span>: <span>{</span>
    <span>legend</span>: <span>true</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>hexagon</span><span>(</span>
      <span>cars</span><span>,</span>
      <span>Plot</span><span>.</span><span>hexbin</span><span>(</span>
        <span>{</span><span>r</span>: <span>&#34;count&#34;</span><span>,</span> <span>fill</span>: <span>&#34;mean&#34;</span><span>}</span><span>,</span>
        <span>{</span><span>x</span>:  <span>&#34;displacement (cc)&#34;</span><span>,</span> <span>y</span>: <span>&#34;economy (mpg)&#34;</span><span>,</span> <span>fill</span>: <span>&#34;weight (lb)&#34;</span><span>}</span>
      <span>)</span>
    <span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#dodge">dodge transform</a> can be used to produce beeswarm plots. Given an <em>x</em> channel representing the desired horizontal position of circles, the dodgeY transform derives a new <em>y</em> (vertical position) channel such that the circles do not overlap; the dodgeX transform similarly derives a new <em>x</em> channel given a <em>y</em> channel.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-dodge" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/dodge-random.png" width="640" alt="a beeswarm chart showing a random normal distribution; each of 800 samples is represented by a dot positioned along the x-axis, stacked on top of the y-axis like grains of sand"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  height: 320,
  x: {
    domain: [-3, 3]
  },
  marks: [
    Plot.dotX(Array.from({length: 800}, d3.randomNormal()), Plot.dodgeY())
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>320</span><span>,</span>
  <span>x</span>: <span>{</span>
    <span>domain</span>: <span>[</span><span>-</span><span>3</span><span>,</span> <span>3</span><span>]</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>dotX</span><span>(</span><span>Array</span><span>.</span><span>from</span><span>(</span><span>{</span><span>length</span>: <span>800</span><span>}</span><span>,</span> <span>d3</span><span>.</span><span>randomNormal</span><span>(</span><span>)</span><span>)</span><span>,</span> <span>Plot</span><span>.</span><span>dodgeY</span><span>(</span><span>)</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">If an <em>r</em> channel is specified, the circles may have varying radius. By default, the dodge transform sorts the input data by descending radius, such that the largest circles are placed first. The order of placement greatly affects the resulting layout; to change the placement order, use the standard mark <strong>sort</strong> option.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-dodge" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/dodge.png" width="640" alt="a chart showing the monthly percent change in travel by U.S. county in March 2020 after the coronavirus outbreak; each county is represented as a circle with area proportional to its population, positioned according to the change in travel; most counties, and especially those with stay-at-home orders, show a significant reduction in travel"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  height: 400,
  x: {
    domain: [-100, -20],
    percent: true,
    label: &#34;← Reduction in travel (%)&#34;
  },
  r: {
    range: [0, 20]
  },
  color: {
    legend: true,
    tickFormat: d =&gt; d ? &#34;lockdown&#34; : &#34;no lockdown&#34;
  },
  marks: [
    Plot.dot(lockdown, Plot.dodgeY(&#34;middle&#34;, {x: &#34;pct_change&#34;, r: &#34;pop&#34;, fill: &#34;in_lockdown&#34;}))
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>400</span><span>,</span>
  <span>x</span>: <span>{</span>
    <span>domain</span>: <span>[</span><span>-</span><span>100</span><span>,</span> <span>-</span><span>20</span><span>]</span><span>,</span>
    <span>percent</span>: <span>true</span><span>,</span>
    <span>label</span>: <span>&#34;← Reduction in travel (%)&#34;</span>
  <span>}</span><span>,</span>
  <span>r</span>: <span>{</span>
    <span>range</span>: <span>[</span><span>0</span><span>,</span> <span>20</span><span>]</span>
  <span>}</span><span>,</span>
  <span>color</span>: <span>{</span>
    <span>legend</span>: <span>true</span><span>,</span>
    <span>tickFormat</span>: <span>d</span> <span>=&gt;</span> <span>d</span> ? <span>&#34;lockdown&#34;</span> : <span>&#34;no lockdown&#34;</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>lockdown</span><span>,</span> <span>Plot</span><span>.</span><span>dodgeY</span><span>(</span><span>&#34;middle&#34;</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;pct_change&#34;</span><span>,</span> <span>r</span>: <span>&#34;pop&#34;</span><span>,</span> <span>fill</span>: <span>&#34;in_lockdown&#34;</span><span>}</span><span>)</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">When using the dodgeY transform, you should set the height of your plot explicitly; otherwise dots may be drawn outside the canvas. You can also adjust the <strong>range</strong> of the <em>r</em> scale to produce denser beeswarms.</p>
<p dir="auto">[breaking] Color scales with diverging color schemes now default to the <em>diverging</em> scale type instead of the <em>linear</em> scale type. This includes the <em>brbg</em>, <em>prgn</em>, <em>piyg</em>, <em>puor</em>, <em>rdbu</em>, <em>rdgy</em>, <em>rdylbu</em>, <em>rdylgn</em>, <em>spectral</em>, <em>burd</em>, and <em>buylrd</em> schemes. If you want to use a diverging color scheme with a linear color scale, set the scale <strong>type</strong> option to <em>linear</em>. Color scales will also default to diverging if the scale <strong>pivot</strong> option is set. (For diverging scales, the pivot defaults to zero.)</p>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#plotsortorder-options">sort transform</a> now supports sorting on an existing channel, avoiding the need to duplicate the channel definition. For example, to sort dots by ascending radius:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.dot(earthquakes, {x: &#34;longitude&#34;, y: &#34;latitude&#34;, r: &#34;intensity&#34;, sort: {channel: &#34;r&#34;}})"><pre><span>Plot</span><span>.</span><span>dot</span><span>(</span><span>earthquakes</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;longitude&#34;</span><span>,</span> <span>y</span>: <span>&#34;latitude&#34;</span><span>,</span> <span>r</span>: <span>&#34;intensity&#34;</span><span>,</span> <span>sort</span>: <span>{</span><span>channel</span>: <span>&#34;r&#34;</span><span>}</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#dot">dot mark</a> now sorts by descending radius by default to reduce occlusion. The dot mark now supports the <em>hexagon</em> symbol type for pointy-topped hexagons. The new <a href="https://github.com/observablehq/plot/blob/main/README.md#plotcircledata-options">circle</a> and <a href="https://github.com/observablehq/plot/blob/main/README.md#plothexagondata-options">hexagon</a> marks are convenience shorthand for dot marks with the <em>circle</em> and <em>hexagon</em> symbol, respectively. The dotX, dotY, textX, and textY marks now support the <strong>interval</strong> option. The rule mark now correctly respects the <strong>dx</strong> and <strong>dy</strong> options. The new <a href="https://github.com/observablehq/plot/blob/main/README.md#hexgrid">hexgrid decoration mark</a> draws a hexagonal grid; it is intended to be used with the hexbin transform as an alternative to the default horizontal and vertical axis grid.</p>
<p dir="auto">The <strong>zero</strong> scale option (like the <strong>nice</strong> and <strong>clamp</strong> scale options) may now be specified as a top-level option, applying to all quantitative scales.</p>
<p dir="auto">Marks can now define a channel hint to set the default range of the <em>r</em> scale. This is used by the hexbin transform when producing an <em>r</em> output channel.</p>
<p dir="auto">Improve the performance of internal array operations, including type coercion. Thanks, @yurivish!</p>
<p dir="auto">Fix a crash when using the <a href="https://github.com/observablehq/plot/blob/main/README.md#area">area mark</a> shorthand.</p>
<p dir="auto">[breaking] The return signature of the internal <em>mark</em>.initialize method has changed. It now returns a {data, facets, channels} object instead of {index, channels}, and <em>channels</em> is now represented as an object with named properties representing channels rather than an iterable of [<em>name</em>, <em>channel</em>].</p>
<h2 dir="auto"><a id="user-content-043" aria-hidden="true" href="#043"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.4.3</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.4.3">Released April 12, 2022.</a></p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#tree">tree mark and transforms</a> can generate hierarchical node-link diagrams using D3’s <a href="https://observablehq.com/@d3/tree" rel="nofollow">“tidy” tree</a> or <a href="https://observablehq.com/@d3/cluster" rel="nofollow">cluster (dendrogram)</a> layout. The tree transform uses <a href="https://observablehq.com/@d3/d3-stratify" rel="nofollow">d3.stratify</a> to convert tabular data into a hierarchy by parsing a slash-separated <strong>path</strong> for each row.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/tree.png"><img src="https://github.com/observablehq/plot/raw/main/img/tree.png" width="640" alt="a node-link tree diagram representing a software hierarchy"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  axis: null,
  inset: 10,
  insetRight: 120,
  height: 500,
  marks: Plot.tree(plotsrc, {markerEnd: &#34;arrow&#34;})
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>axis</span>: <span>null</span><span>,</span>
  <span>inset</span>: <span>10</span><span>,</span>
  <span>insetRight</span>: <span>120</span><span>,</span>
  <span>height</span>: <span>500</span><span>,</span>
  <span>marks</span>: <span>Plot</span><span>.</span><span>tree</span><span>(</span><span>plotsrc</span><span>,</span> <span>{</span><span>markerEnd</span>: <span>&#34;arrow&#34;</span><span>}</span><span>)</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#line">line</a> and <a href="https://github.com/observablehq/plot/blob/main/README.md#area">area</a> marks (specifically lineX, lineY, areaX, and areaY) now support an implicit <a href="https://github.com/observablehq/plot/blob/main/README.md#bin">bin transform</a> with the <strong>interval</strong> option. This can be used to “regularize” time series data, say to show gaps or default to zero when data is missing, rather than interpolating across missing data. This is also useful for stacking time series data that is sampled at irregular intervals or with missing samples.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/sparse-series.png"><img src="https://github.com/observablehq/plot/raw/main/img/sparse-series.png" width="640" alt="a time-series area chart showing downloads per day with gaps for missing data"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  marks: [
    Plot.lineY(downloads, {x: &#34;date&#34;, y: &#34;downloads&#34;, interval: d3.utcDay, curve: &#34;step&#34;}),
    Plot.areaY(downloads, {x: &#34;date&#34;, y: &#34;downloads&#34;, interval: d3.utcDay, fill: &#34;#eee&#34;, curve: &#34;step&#34;}),
    Plot.ruleY([0])
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>downloads</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;downloads&#34;</span><span>,</span> <span>interval</span>: <span>d3</span><span>.</span><span>utcDay</span><span>,</span> <span>curve</span>: <span>&#34;step&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>areaY</span><span>(</span><span>downloads</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;downloads&#34;</span><span>,</span> <span>interval</span>: <span>d3</span><span>.</span><span>utcDay</span><span>,</span> <span>fill</span>: <span>&#34;#eee&#34;</span><span>,</span> <span>curve</span>: <span>&#34;step&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The default <strong>reduce</strong> is <em>first</em>, picking the first value in each interval. If there is no data for a given interval, the value is undefined, resulting in a visible gap in the line or area. By using <em>sum</em> instead, you can default to zero when data is missing (and sum values if the data contains more than one observation per time interval).</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/dense-series.png"><img src="https://github.com/observablehq/plot/raw/main/img/dense-series.png" width="640" alt="a time-series area chart showing downloads per day with zeroes for missing data"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  marks: [
    Plot.lineY(downloads, {x: &#34;date&#34;, y: &#34;downloads&#34;, interval: d3.utcDay, reduce: &#34;sum&#34;, curve: &#34;step&#34;}),
    Plot.areaY(downloads, {x: &#34;date&#34;, y: &#34;downloads&#34;, interval: d3.utcDay, reduce: &#34;sum&#34;, fill: &#34;#eee&#34;, curve: &#34;step&#34;}),
    Plot.ruleY([0])
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>downloads</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;downloads&#34;</span><span>,</span> <span>interval</span>: <span>d3</span><span>.</span><span>utcDay</span><span>,</span> <span>reduce</span>: <span>&#34;sum&#34;</span><span>,</span> <span>curve</span>: <span>&#34;step&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>areaY</span><span>(</span><span>downloads</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;downloads&#34;</span><span>,</span> <span>interval</span>: <span>d3</span><span>.</span><span>utcDay</span><span>,</span> <span>reduce</span>: <span>&#34;sum&#34;</span><span>,</span> <span>fill</span>: <span>&#34;#eee&#34;</span><span>,</span> <span>curve</span>: <span>&#34;step&#34;</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#stack">stack transform</a> now allows the <strong>offset</strong> option to be specified as a function. For example, this can be used to visualize Likert survey results with a neutral category as a <a href="https://observablehq.com/@observablehq/plot-diverging-stacked-bar" rel="nofollow">diverging stacked bar chart</a>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/likert.png"><img src="https://github.com/observablehq/plot/raw/main/img/likert.png" width="640" alt="a diverging bar chart of responses to a Likert survey question"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="function Likert(
  responses = [
    [&#34;Strongly Disagree&#34;, -1],
    [&#34;Disagree&#34;, -1],
    [&#34;Neutral&#34;, 0],
    [&#34;Agree&#34;, 1],
    [&#34;Strongly Agree&#34;, 1]
  ]
) {
  const map = new Map(responses);
  return {
    order: Array.from(map.keys()),
    offset(facetstacks, X1, X2, Z) {
      for (const stacks of facetstacks) {
        for (const stack of stacks) {
          const k = d3.sum(stack, i =&gt; (X2[i] - X1[i]) * (1 - map.get(Z[i]))) / 2;
          for (const i of stack) {
            X1[i] -= k;
            X2[i] -= k;
          }
        }
      }
    }
  };
}"><pre><span>function</span> <span>Likert</span><span>(</span>
  <span>responses</span> <span>=</span> <span>[</span>
    <span>[</span><span>&#34;Strongly Disagree&#34;</span><span>,</span> <span>-</span><span>1</span><span>]</span><span>,</span>
    <span>[</span><span>&#34;Disagree&#34;</span><span>,</span> <span>-</span><span>1</span><span>]</span><span>,</span>
    <span>[</span><span>&#34;Neutral&#34;</span><span>,</span> <span>0</span><span>]</span><span>,</span>
    <span>[</span><span>&#34;Agree&#34;</span><span>,</span> <span>1</span><span>]</span><span>,</span>
    <span>[</span><span>&#34;Strongly Agree&#34;</span><span>,</span> <span>1</span><span>]</span>
  <span>]</span>
<span>)</span> <span>{</span>
  <span>const</span> <span>map</span> <span>=</span> <span>new</span> <span>Map</span><span>(</span><span>responses</span><span>)</span><span>;</span>
  <span>return</span> <span>{</span>
    <span>order</span>: <span>Array</span><span>.</span><span>from</span><span>(</span><span>map</span><span>.</span><span>keys</span><span>(</span><span>)</span><span>)</span><span>,</span>
    <span>offset</span><span>(</span><span>facetstacks</span><span>,</span> <span>X1</span><span>,</span> <span>X2</span><span>,</span> <span>Z</span><span>)</span> <span>{</span>
      <span>for</span> <span>(</span><span>const</span> <span>stacks</span> <span>of</span> <span>facetstacks</span><span>)</span> <span>{</span>
        <span>for</span> <span>(</span><span>const</span> <span>stack</span> <span>of</span> <span>stacks</span><span>)</span> <span>{</span>
          <span>const</span> <span>k</span> <span>=</span> <span>d3</span><span>.</span><span>sum</span><span>(</span><span>stack</span><span>,</span> <span>i</span> <span>=&gt;</span> <span>(</span><span>X2</span><span>[</span><span>i</span><span>]</span> <span>-</span> <span>X1</span><span>[</span><span>i</span><span>]</span><span>)</span> <span>*</span> <span>(</span><span>1</span> <span>-</span> <span>map</span><span>.</span><span>get</span><span>(</span><span>Z</span><span>[</span><span>i</span><span>]</span><span>)</span><span>)</span><span>)</span> <span>/</span> <span>2</span><span>;</span>
          <span>for</span> <span>(</span><span>const</span> <span>i</span> <span>of</span> <span>stack</span><span>)</span> <span>{</span>
            <span>X1</span><span>[</span><span>i</span><span>]</span> <span>-=</span> <span>k</span><span>;</span>
            <span>X2</span><span>[</span><span>i</span><span>]</span> <span>-=</span> <span>k</span><span>;</span>
          <span>}</span>
        <span>}</span>
      <span>}</span>
    <span>}</span>
  <span>}</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#color-options"><em>quantize</em> scale type</a> transforms a continuous domain into discrete, evenly-spaced thresholds. The <em>threshold</em> scale type now supports domains in descending order (in addition to ascending order), such as [20, 10, 5, 0] instead of [0, 5, 10, 20].</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/quantize.png"><img src="https://github.com/observablehq/plot/raw/main/img/quantize.png" width="640" alt="a scatterplot of Simpsons episodes showing the correlation between number of U.S. viewers and IMDb rating; the decline of the Simspons over time is shown with a quantized color encoding by season"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  grid: true,
  color: {
    type: &#34;quantize&#34;,
    legend: true
  },
  marks: [
    Plot.ruleY([0]),
    Plot.dot(simpsons, {x: &#34;imdb_rating&#34;, y: &#34;us_viewers_in_millions&#34;, fill: &#34;season&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>grid</span>: <span>true</span><span>,</span>
  <span>color</span>: <span>{</span>
    <span>type</span>: <span>&#34;quantize&#34;</span><span>,</span>
    <span>legend</span>: <span>true</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>simpsons</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;imdb_rating&#34;</span><span>,</span> <span>y</span>: <span>&#34;us_viewers_in_millions&#34;</span><span>,</span> <span>fill</span>: <span>&#34;season&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#bin">bin transform</a> now coerces the input channel (the quantity being binned) to numbers as necessary. In addition, the bin transform now correctly handles typed array input channels representing temporal data. The <a href="https://github.com/observablehq/plot/blob/main/README.md#rect">rect mark</a> now promotes the <em>x</em> channel to <em>x1</em> and <em>x2</em> if the latter two are not specified, and likewise the <em>y</em> channel to <em>y1</em> and <em>y2</em>.</p>
<p dir="auto">Fix a crash when <strong>text</strong> or <strong>title</strong> channels contain heterogenous types; each value is now independently formatted in a type-appropriate default formatter. Fix a rendering bug with one-dimensional rects whose opposite dimension is a band scale. Fix a rendering bug with swoopy arrows. Improve error messages to give more context.</p>
<p dir="auto">New helpers make it easier to implement custom transforms. <a href="https://github.com/observablehq/plot/blob/main/README.md#plotcolumnsource">Plot.column</a> constructs lazily-evaluated columns for derived channels, and <a href="https://github.com/observablehq/plot/blob/main/README.md#plottransformoptions-transform">Plot.transform</a> composes a <a href="https://github.com/observablehq/plot/blob/main/README.md#custom-transforms">custom data transform</a> with any of Plot’s built-in <a href="https://github.com/observablehq/plot/blob/main/README.md#transforms">basic transforms</a>.</p>
<h2 dir="auto"><a id="user-content-042" aria-hidden="true" href="#042"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.4.2</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.4.2">Released February 26, 2022.</a></p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#box">box mark</a> generates a horizontal or vertical boxplot suitable for visualizing one-dimensional distributions. It is a convenience mark that composites a rule, bar, tick, and dot.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/box.png"><img src="https://github.com/observablehq/plot/raw/main/img/box.png" width="640" alt="a boxplot of Michelson’s 1879 measurements of the speed of light"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.boxX(morley, {x: &#34;Speed&#34;, y: &#34;Expt&#34;}).plot({x: {grid: true, inset: 6}})"><pre><span>Plot</span><span>.</span><span>boxX</span><span>(</span><span>morley</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Speed&#34;</span><span>,</span> <span>y</span>: <span>&#34;Expt&#34;</span><span>}</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>{</span><span>x</span>: <span>{</span><span>grid</span>: <span>true</span><span>,</span> <span>inset</span>: <span>6</span><span>}</span><span>}</span><span>)</span></pre></div>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-shorthand" rel="nofollow">Plot’s shorthand syntax</a> has been expanded. The <a href="https://github.com/observablehq/plot/blob/main/README.md#bar">bar mark</a> now supports one-dimensional shorthand: if no <em>options</em> are specified, then Plot.barX and Plot.barY can be used to visualize an array of numbers. This shorthand also now applies to the <a href="https://github.com/observablehq/plot/blob/main/README.md#rect">rect mark</a> and the <a href="https://github.com/observablehq/plot/blob/main/README.md#vector">vector mark</a>. The <a href="https://github.com/observablehq/plot/blob/main/README.md#area">area mark</a> now supports two-dimensional shorthand: if no <em>options</em> are specified, then Plot.area can be used to visualize an array of <em>xy</em>-tuples, similar to Plot.line.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/bar-shorthand.png"><img src="https://github.com/observablehq/plot/raw/main/img/bar-shorthand.png" width="640" alt="a bar chart of twenty random values"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(d3.range(20).map(Math.random)).plot()"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>d3</span><span>.</span><span>range</span><span>(</span><span>20</span><span>)</span><span>.</span><span>map</span><span>(</span><span>Math</span><span>.</span><span>random</span><span>)</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">The mark <a href="https://github.com/observablehq/plot/blob/main/README.md#sort-options">sort options</a> now support implicit “width” and “height” channels, defined as |<em>x2</em> - <em>x1</em>| and |<em>y2</em> - <em>y1</em>| respectively. These channels are useful for sorting rects and bars by length. The <em>reverse</em> option defaults to true when sorting by these channels. When sorting by <em>y</em> and no <em>y</em> channel is available, sorting will now fallback to <em>y2</em> if available; the same fallback logic applies to <em>x</em> and <em>x2</em>. (This behavior was previously supported on marks that support implicit stacking but now applies universally to all marks.)</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/sort-length.png"><img src="https://github.com/observablehq/plot/raw/main/img/sort-length.png" width="640" alt="a bar chart of energy production by source from 1949 to present, with categorical colors assigned in order of the tallest bar"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.rectY(energy, {x: &#34;Year&#34;, interval: 1, y: &#34;Value&#34;, fill: &#34;Description&#34;, sort: {color: &#34;height&#34;}})"><pre><span>Plot</span><span>.</span><span>rectY</span><span>(</span><span>energy</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Year&#34;</span><span>,</span> <span>interval</span>: <span>1</span><span>,</span> <span>y</span>: <span>&#34;Value&#34;</span><span>,</span> <span>fill</span>: <span>&#34;Description&#34;</span><span>,</span> <span>sort</span>: <span>{</span><span>color</span>: <span>&#34;height&#34;</span><span>}</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#bin">bin transform</a> now supports <em>x</em> and <em>y</em> reducers which represent the midpoint of the bin: (<em>x1</em> + <em>x2</em>) / 2 and (<em>y1</em> + <em>y2</em>) / 2 respectively. The <a href="https://github.com/observablehq/plot/blob/main/README.md#bin">bin</a>, <a href="https://github.com/observablehq/plot/blob/main/README.md#group">group</a>, and <a href="https://github.com/observablehq/plot/blob/main/README.md#window">window</a> transforms now support percentile reducers of the form <em>pXX</em> where <em>XX</em> is a number in [00, 99]; for example <em>p25</em> represents the first quartile and <em>p75</em> represents the third quartile.</p>
<p dir="auto">The error message when attempting to create a standalone legend without a valid scale definition has been improved. The high cardinality warning for the implicit <em>z</em> channel has been relaxed; it is now only triggered if more than half of the values are distinct. When the axis <em>ticks</em> option is specified as null, no ticks are generated. When the axis <em>tickFormat</em> option is specified as null, no tick labels are generated.</p>
<h2 dir="auto"><a id="user-content-041" aria-hidden="true" href="#041"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.4.1</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.4.1">Released February 17, 2022.</a></p>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#area">area</a> and <a href="https://github.com/observablehq/plot/blob/main/README.md#line">line marks</a> now support varying fill, stroke, title, and other channels within series. For example, this chart of unemployment rates by metro area highlights increases in red and decreases in blue using a window transform with the <em>difference</em> reducer.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/line-slope.png"><img src="https://github.com/observablehq/plot/raw/main/img/line-slope.png" width="640" alt="a line chart of unemployment rates by metro area; increases are shown in red, and decreases in blue"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.line(bls, Plot.map({stroke: Plot.window({k: 2, reduce: &#34;difference&#34;})}, {x: &#34;date&#34;, y: &#34;unemployment&#34;, z: &#34;division&#34;, stroke: &#34;unemployment&#34;}))"><pre><span>Plot</span><span>.</span><span>line</span><span>(</span><span>bls</span><span>,</span> <span>Plot</span><span>.</span><span>map</span><span>(</span><span>{</span><span>stroke</span>: <span>Plot</span><span>.</span><span>window</span><span>(</span><span>{</span><span>k</span>: <span>2</span><span>,</span> <span>reduce</span>: <span>&#34;difference&#34;</span><span>}</span><span>)</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;unemployment&#34;</span><span>,</span> <span>z</span>: <span>&#34;division&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;unemployment&#34;</span><span>}</span><span>)</span><span>)</span></pre></div>
<p dir="auto">The new <em>clip</em> mark option enables clipping to the plot frame. For example, this can be used to clip overlapping areas and produce a horizon chart of hourly traffic patterns.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/horizon.png"><img src="https://github.com/observablehq/plot/raw/main/img/horizon.png" width="640" alt="a horizon chart of traffic volume over time"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="d3.ticks(0, max, bands).map(t =&gt; Plot.areaY(traffic, {x: &#34;date&#34;, y: d =&gt; d.value - t, fill: t, clip: true}))"><pre><span>d3</span><span>.</span><span>ticks</span><span>(</span><span>0</span><span>,</span> <span>max</span><span>,</span> <span>bands</span><span>)</span><span>.</span><span>map</span><span>(</span><span>t</span> <span>=&gt;</span> <span>Plot</span><span>.</span><span>areaY</span><span>(</span><span>traffic</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>d</span> <span>=&gt;</span> <span>d</span><span>.</span><span>value</span> <span>-</span> <span>t</span><span>,</span> <span>fill</span>: <span>t</span><span>,</span> <span>clip</span>: <span>true</span><span>}</span><span>)</span><span>)</span></pre></div>
<p dir="auto">Plot can now generate helpful warnings for common mistakes. Warnings <g-emoji alias="warning" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png">⚠️</g-emoji> are indicated in the top-right corner of the plot; open your browser’s developer console to read the warnings. For example, if you use data with date strings resulting in an <em>ordinal</em> scale rather than the desired <em>utc</em> scale, Plot will advise you to parse strings to dates.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/warning.png"><img src="https://github.com/observablehq/plot/raw/main/img/warning.png" width="640" alt="a line chart with an unreadable ordinal x-axis due to incorrect data typing"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.line(aapl, {x: &#34;Date&#34;, y: &#34;Close&#34;}) // 🌶 Oops, Date is a string!"><pre><span>Plot</span><span>.</span><span>line</span><span>(</span><span>aapl</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Close&#34;</span><span>}</span><span>)</span> <span>// 🌶 Oops, Date is a string!</span></pre></div>
<blockquote>
<p dir="auto">Warning: some data associated with the x scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a &#34;utc&#34; or &#34;time&#34; scale rather than a &#34;point&#34; scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the x scale to &#34;point&#34;.</p>
</blockquote>
<p dir="auto">We will add <a href="https://github.com/observablehq/plot/issues/755" data-hovercard-type="issue" data-hovercard-url="/observablehq/plot/issues/755/hovercard">more warnings</a> in the future. If Plot did something you didn’t expect, please <a href="https://github.com/observablehq/plot/discussions">let us know</a>; perhaps it will inspire a new warning that will help other users.</p>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#text">text mark</a> now supports automatic wrapping for easier annotation. The new <strong>lineWidth</strong> option specifies the desired length of a line in ems. The line breaking, wrapping, and text metrics implementations are all rudimentary, but they should be acceptable for text that is mostly ASCII. (For more control, you can hard-wrap text manually.) The <strong>monospace</strong> option now provides convenient defaults for monospaced text.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/wrap.png"><img src="https://github.com/observablehq/plot/raw/main/img/wrap.png" width="640" alt="a snippet of Moby Dick demonstrating line wrapping"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.text([mobydick], {dx: 6, dy: 6, fontSize: 12, lineWidth: 80, lineHeight: 1.2, frameAnchor: &#34;top-left&#34;, monospace: true})"><pre><span>Plot</span><span>.</span><span>text</span><span>(</span><span>[</span><span>mobydick</span><span>]</span><span>,</span> <span>{</span><span>dx</span>: <span>6</span><span>,</span> <span>dy</span>: <span>6</span><span>,</span> <span>fontSize</span>: <span>12</span><span>,</span> <span>lineWidth</span>: <span>80</span><span>,</span> <span>lineHeight</span>: <span>1.2</span><span>,</span> <span>frameAnchor</span>: <span>&#34;top-left&#34;</span><span>,</span> <span>monospace</span>: <span>true</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The line and link marks now support <a href="https://github.com/observablehq/plot/blob/main/README.md#markers">marker options</a> for drawing a shape such as a dot or arrowhead on each vertex. Circle and arrow markers are provided, or you can implement a custom marker function that returns an SVG marker element. Markers automatically inherit the stroke color of the associated mark.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/marker.png"><img src="https://github.com/observablehq/plot/raw/main/img/marker.png" width="640" alt="a line chart with circle markers overlaid on each data point"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.lineY(crimea, {x: &#34;date&#34;, y: &#34;deaths&#34;, stroke: &#34;cause&#34;, marker: &#34;circle&#34;})"><pre><span>Plot</span><span>.</span><span>lineY</span><span>(</span><span>crimea</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;date&#34;</span><span>,</span> <span>y</span>: <span>&#34;deaths&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;cause&#34;</span><span>,</span> <span>marker</span>: <span>&#34;circle&#34;</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>fill</em> and <em>stroke</em> mark options can now be expressed as patterns or gradients using funciri color definitions, <em>e.g.</em> “url(#pattern)”. Colors can now also be expressed as CSS variables, <em>e.g.</em>, “var(--blue)”. All marks now support the <em>strokeDashoffset</em> option (for use with <em>strokeDasharray</em>).</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/gradient.png"><img src="https://github.com/observablehq/plot/raw/main/img/gradient.png" width="640" alt="a bar chart with bars that fade from blue to purple"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(alphabet, {x: &#34;letter&#34;, y: &#34;frequency&#34;, fill: &#34;url(#gradient)&#34;})"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>alphabet</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>y</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>fill</span>: <span>&#34;url(#gradient)&#34;</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The bin transform now supports the <em>interval</em> option, allowing numeric intervals such as integer binning with a nice default domain that aligns with interval boundaries. (The bin transform already supported time intervals as the <em>thresholds</em> option; time intervals can now also be specified as the <em>interval</em> option.) For example, if you want to bin by hour of the day, use an <em>interval</em> of 1:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/observablehq/plot/blob/main/img/bin-interval.png"><img src="https://github.com/observablehq/plot/raw/main/img/bin-interval.png" width="640" alt="a histogram of average traffic per hour of day"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.rectY(traffic, Plot.binX({y: &#34;mean&#34;}, {x: d =&gt; d.date.getUTCHours(), interval: 1, y: &#34;value&#34;}))"><pre><span>Plot</span><span>.</span><span>rectY</span><span>(</span><span>traffic</span><span>,</span> <span>Plot</span><span>.</span><span>binX</span><span>(</span><span>{</span><span>y</span>: <span>&#34;mean&#34;</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>d</span> <span>=&gt;</span> <span>d</span><span>.</span><span>date</span><span>.</span><span>getUTCHours</span><span>(</span><span>)</span><span>,</span> <span>interval</span>: <span>1</span><span>,</span> <span>y</span>: <span>&#34;value&#34;</span><span>}</span><span>)</span><span>)</span></pre></div>
<p dir="auto">Plot now supports ARIA attributes for improved accessibility: aria-label, aria-description, aria-hidden. The top-level <strong>ariaLabel</strong> and <strong>ariaDescription</strong> options apply to the root SVG element. The new <strong>ariaLabel</strong> and <strong>ariaDescription</strong> scale options apply to axes; the label defaults to <em>e.g.</em> “y-axis” and the description defaults to the scale’s label (<em>e.g.</em>, “↑ temperature”). Marks define a group-level aria-label (<em>e.g.</em>, “dot”). There is also an optional <strong>ariaLabel</strong> channel for labeling data (<em>e.g.</em>, “E 12.7%”), and a group-level <strong>ariaDescription</strong> option for a human-readable description. The <strong>ariaHidden</strong> mark option allows the hiding of decorative elements from the accessibility tree.</p>
<p dir="auto">The new <strong>paintOrder</strong> mark option controls the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/paint-order" rel="nofollow">paint order</a>. The text mark’s paint order now defaults to <em>stroke</em>, with a stroke width of 3px and a stroke linejoin of <em>round</em>, making it easier to create a halo for separating labels from a busy background, improving legibility.</p>
<p dir="auto">Fix a crash in default tuple accessors for <em>x</em> and <em>y</em> when data is undefined. Fix a bug where “none” with surrounding whitespace or capital letters would not be recognized as a valid color. When a channel is specified as a boolean value (<em>e.g.</em>, <code>fill: true</code>), it is now considered a constant value rather than undefined. Fix a bug where an identity color legend would be rendered as the text “undefined” instead of showing nothing. If scale options are declared, but the scale has no defined type, domain, or data, a scale is no longer constructed rather than a default linear scale. The vector mark now respects the <em>frameAnchor</em> option. The default boolean color schemes have been adjusted slightly so that the false value is slightly darker, improving contrast against a white background. The returned scale object now exposes <em>bandwidth</em> and <em>step</em> values for <em>band</em> and <em>point</em> scales.</p>
<h2 dir="auto"><a id="user-content-040" aria-hidden="true" href="#040"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.4.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.4.0">Released January 20, 2022.</a></p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#arrow">arrow mark</a> draws arrows between pairs of points. It is similar to the <a href="https://github.com/observablehq/plot/blob/main/README.md#link">link mark</a>, except it is suitable for directed edges (say for representing change over time) and supports a configurable arrowhead. It also supports “swoopy” arrows with the <em>bend</em> option, and insets for arrows to shorten the arrow’s start or end.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-arrow" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/arrow.png" width="660" alt="a scatterplot with arrows"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.arrow(data, {
  x1: &#34;POP_1980&#34;,
  y1: &#34;R90_10_1980&#34;,
  x2: &#34;POP_2015&#34;,
  y2: &#34;R90_10_2015&#34;,
  bend: true,
  stroke: d =&gt; d.R90_10_2015 - d.R90_10_1980
})"><pre><span>Plot</span><span>.</span><span>arrow</span><span>(</span><span>data</span><span>,</span> <span>{</span>
  <span>x1</span>: <span>&#34;POP_1980&#34;</span><span>,</span>
  <span>y1</span>: <span>&#34;R90_10_1980&#34;</span><span>,</span>
  <span>x2</span>: <span>&#34;POP_2015&#34;</span><span>,</span>
  <span>y2</span>: <span>&#34;R90_10_2015&#34;</span><span>,</span>
  <span>bend</span>: <span>true</span><span>,</span>
  <span>stroke</span>: <span>d</span> <span>=&gt;</span> <span>d</span><span>.</span><span>R90_10_2015</span> <span>-</span> <span>d</span><span>.</span><span>R90_10_1980</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#vector">vector mark</a> similarly draws arrows at the given position (<em>x</em> and <em>y</em>) with the given magnitude (<em>length</em>) and direction (<em>rotate</em>). It is intended to visualize vector fields, such as a map of wind speed and direction.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-vector" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/vector.png" width="660" alt="a vector field"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.vector((T =&gt; d3.cross(T, T))(d3.ticks(0, 2 * Math.PI, 20)), {
  length: ([x, y]) =&gt; (x + y) * 2 + 2,
  rotate: ([x, y]) =&gt; (Math.sin(x) - Math.sin(y)) * 60
})"><pre><span>Plot</span><span>.</span><span>vector</span><span>(</span><span>(</span><span>T</span> <span>=&gt;</span> <span>d3</span><span>.</span><span>cross</span><span>(</span><span>T</span><span>,</span> <span>T</span><span>)</span><span>)</span><span>(</span><span>d3</span><span>.</span><span>ticks</span><span>(</span><span>0</span><span>,</span> <span>2</span> <span>*</span> <span>Math</span><span>.</span><span>PI</span><span>,</span> <span>20</span><span>)</span><span>)</span><span>,</span> <span>{</span>
  <span>length</span>: <span>(</span><span>[</span><span>x</span><span>,</span> <span>y</span><span>]</span><span>)</span> <span>=&gt;</span> <span>(</span><span>x</span> <span>+</span> <span>y</span><span>)</span> <span>*</span> <span>2</span> <span>+</span> <span>2</span><span>,</span>
  <span>rotate</span>: <span>(</span><span>[</span><span>x</span><span>,</span> <span>y</span><span>]</span><span>)</span> <span>=&gt;</span> <span>(</span><span>Math</span><span>.</span><span>sin</span><span>(</span><span>x</span><span>)</span> <span>-</span> <span>Math</span><span>.</span><span>sin</span><span>(</span><span>y</span><span>)</span><span>)</span> <span>*</span> <span>60</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#dot">dot mark</a> now supports a <em>symbol</em> option to control the displayed shape, which defaults to <em>circle</em>. The <em>symbol</em> channel (and associated <em>symbol</em> scale) can also be used as an categorical encoding. The default symbol set is based on whether symbols are stroked or filled, improving differentiability and giving uniform weight. Plot supports all of D3’s built-in symbol types: <em>circle</em>, <em>cross</em>, <em>diamond</em>, <em>square</em>, <em>star</em>, <em>triangle</em>, and <em>wye</em> (for fill) and <em>circle</em>, <em>plus</em>, <em>times</em>, <em>triangle2</em>, <em>asterisk</em>, <em>square2</em>, and <em>diamond2</em> (for stroke, based on <a href="https://www.tandfonline.com/doi/abs/10.1080/10618600.2019.1637746" rel="nofollow">Heman Robinson’s research</a>); you can also implement a <a href="https://github.com/d3/d3-shape/blob/main/README.md#custom-symbol-types">custom symbol type</a>.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-dot" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/symbol.png" width="660" alt="a scatterplot of penguins by mass and flipper length"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.dot(penguins, {x: &#34;body_mass_g&#34;, y: &#34;flipper_length_mm&#34;, stroke: &#34;species&#34;, symbol: &#34;species&#34;})"><pre><span>Plot</span><span>.</span><span>dot</span><span>(</span><span>penguins</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;body_mass_g&#34;</span><span>,</span> <span>y</span>: <span>&#34;flipper_length_mm&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;species&#34;</span><span>,</span> <span>symbol</span>: <span>&#34;species&#34;</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#text">text mark</a> now supports multiline text! When a text value contains <code>\r</code>, <code>\r\n</code>, or <code>\n</code>, it will be split into multiple lines using tspan elements. The new <em>lineAnchor</em> and <em>lineHeight</em> options control how the lines are positioned relative to the given <em>xy</em> position. The text, dot, and image marks now also support a <em>frameAnchor</em> option for positioning relative to the frame rather than according to data. This is particularly useful for annotations.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-text" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/poem.png" width="660" alt="This Is Just To Say, by William Carlos Williams"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  height: 200,
  marks: [
    Plot.frame(),
    Plot.text([`This Is Just To Say\nWilliam Carlos Williams, …`], {frameAnchor: &#34;middle&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>200</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>frame</span><span>(</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>text</span><span>(</span><span>[</span><span>`This Is Just To Say\nWilliam Carlos Williams, …`</span><span>]</span><span>,</span> <span>{</span><span>frameAnchor</span>: <span>&#34;middle&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">When a text mark’s <em>text</em> channel, or the <em>title</em> channel on any mark, is specified as numbers or dates, the values are now automatically formatted (in the U.S. English locale) to improve readability. For the <em>text</em> channel, the default <em>fontVariant</em> option additionally changes to tabular-nums. The text mark now also allows <em>fontSize</em> to be specified as a CSS length (<em>e.g.</em>, “12pt”), keyword (<em>e.g.</em>, “x-large”), or percentage.</p>
<p dir="auto">All marks now support the new standard <em>href</em> channel and <em>target</em> option, turning the mark into a clickable link.</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(alphabet, {x: &#34;letter&#34;, y: &#34;frequency&#34;, href: d =&gt; `https://en.wikipedia.org/wiki/${d.letter}`})"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>alphabet</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>y</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>href</span>: <span>d</span> <span>=&gt;</span> <span>`https://en.wikipedia.org/wiki/<span><span>${</span><span>d</span><span>.</span><span>letter</span><span>}</span></span>`</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#bin">bin</a> and <a href="https://github.com/observablehq/plot/blob/main/README.md#group">group</a> transforms now propagate the <em>title</em> and <em>href</em> channels, if present, by default. The default reducer for the <em>title</em> channel automatically selects the top five distinct title values by count, making it easier to inspect the contents of a given bin or group.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-bin" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/bin-title.png" width="656" alt="a histogram of penguins by species"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.rectY(data, Plot.binX({y: &#34;count&#34;}, {x: &#34;body_mass_g&#34;, fill: &#34;species&#34;, title: d =&gt; `${d.species} ${d.sex}`}))"><pre><span>Plot</span><span>.</span><span>rectY</span><span>(</span><span>data</span><span>,</span> <span>Plot</span><span>.</span><span>binX</span><span>(</span><span>{</span><span>y</span>: <span>&#34;count&#34;</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;body_mass_g&#34;</span><span>,</span> <span>fill</span>: <span>&#34;species&#34;</span><span>,</span> <span>title</span>: <span>d</span> <span>=&gt;</span> <span>`<span><span>${</span><span>d</span><span>.</span><span>species</span><span>}</span></span> <span><span>${</span><span>d</span><span>.</span><span>sex</span><span>}</span></span>`</span><span>}</span><span>)</span><span>)</span></pre></div>
<p dir="auto">The bin transform now supports shorthand reducers for the bin extent: <em>x1</em>, <em>x2</em>, <em>y1</em>, and <em>y2</em>. The window transform now supports the <em>first</em> and <em>last</em> reducers to select the first or last element of the window, respectively.</p>
<p dir="auto">The new generalized <a href="https://github.com/observablehq/plot/blob/main/README.md#select">select transform</a> can now call a custom selector function, or the shorthand <em>min</em> and <em>max</em>, to select the points to display. The selector function is passed two arguments: the index of the current group (<em>e.g.</em>, [0, 1, 2, …]) and the given channel’s values. For example, to select the dot with the greatest <em>fill</em> value:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.dotX(data, Plot.select({fill: &#34;max&#34;}, {x: &#34;letter&#34;, fill: &#34;frequency&#34;, stroke: &#34;black&#34;})"><pre><span>Plot</span><span>.</span><span>dotX</span><span>(</span><span>data</span><span>,</span> <span>Plot</span><span>.</span><span>select</span><span>(</span><span>{</span><span>fill</span>: <span>&#34;max&#34;</span><span>}</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>fill</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;black&#34;</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>color</em> scale now defaults to an <em>identity</em> scale if all associated defined values are valid CSS colors, rather than defaulting to the tableau10 categorical color scheme. The new <em>symbol</em> scale similarly defaults to <em>identity</em> if all associated defined values are valid symbol names (or symbol type objects).</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-bar" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/identity-color.png" width="640" alt="a chart with red and black bars"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(alphabet, {x: &#34;letter&#34;, y: &#34;frequency&#34;, fill: d =&gt; /[AEIOU]/.test(d.letter) ? &#34;red&#34; : &#34;black&#34;})"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>alphabet</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>y</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>fill</span>: <span>d</span> <span>=&gt;</span> <span><span>/</span><span>[</span>AEIOU<span>]</span><span>/</span></span><span>.</span><span>test</span><span>(</span><span>d</span><span>.</span><span>letter</span><span>)</span> ? <span>&#34;red&#34;</span> : <span>&#34;black&#34;</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>color</em> scale now has a special default range for boolean data, encoding false as light gray and true as dark gray. If you’d prefer more color, specify a sequential scheme such as <em>reds</em> or <em>blues</em>. (You can opt-out of the special boolean range by setting the scale type to <em>categorical</em> or by specifying an explicit <em>range</em>.)</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-bar" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/boolean-color.png" width="640" alt="a chart with grey and black bars"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(alphabet, {x: &#34;letter&#34;, y: &#34;frequency&#34;, fill: d =&gt; /[AEIOU]/.test(d.letter)})"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>alphabet</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>y</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>fill</span>: <span>d</span> <span>=&gt;</span> <span><span>/</span><span>[</span>AEIOU<span>]</span><span>/</span></span><span>.</span><span>test</span><span>(</span><span>d</span><span>.</span><span>letter</span><span>)</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#scale-options">Plot.scale</a> method allows you to construct a standalone scale for use independent of any chart, or across charts. The returned object has the same form as <em>plot</em>.scale(<em>name</em>), allowing you to inspect the scale options and invoke the scale programmatically with <em>scale</em>.apply (and <em>scale</em>.invert, where applicable).</p>
<div dir="auto" data-snippet-clipboard-copy-content="const scale = Plot.scale({color: {type: &#34;linear&#34;}});
console.log(scale.domain); // [0, 1]
console.log(scale.apply(0.5)); // &#34;rgb(149, 251, 81)&#34;"><pre><span>const</span> <span>scale</span> <span>=</span> <span>Plot</span><span>.</span><span>scale</span><span>(</span><span>{</span><span>color</span>: <span>{</span><span>type</span>: <span>&#34;linear&#34;</span><span>}</span><span>}</span><span>)</span><span>;</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>scale</span><span>.</span><span>domain</span><span>)</span><span>;</span> <span>// [0, 1]</span>
<span>console</span><span>.</span><span>log</span><span>(</span><span>scale</span><span>.</span><span>apply</span><span>(</span><span>0.5</span><span>)</span><span>)</span><span>;</span> <span>// &#34;rgb(149, 251, 81)&#34;</span></pre></div>
<p dir="auto">This release includes various minor new features and bug fixes. The new top-level <em>clamp</em> option applies to all scales. When margins or insets would result in a scale’s range being inverted, Plot now collapses the range instead of producing confusing output. When the <em>buylrd</em> color scheme is applied to a (discrete) ordinal scale, it now has the expected colors (not <em>rdgy</em>). Plot now ignores non-finite values when inferring the default domain for quantitative scales. The <em>swatches</em> legend now wraps correctly in narrow windows. When the <em>tickFormat</em> option is null, ticks will now be unlabeled (rather than using the default format). Plot no longer crashes when you try to display a legend on an identity color scale.</p>
<p dir="auto">To improve compatibility with popular bundlers such as webpack and Rollup, Plot no longer uses circular ES module imports and thereby avoids the dreaded temporal dead zone. <g-emoji alias="scream" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f631.png">😱</g-emoji> Plot now uses <a href="https://vitejs.dev" rel="nofollow">vite</a> for local development instead of <a href="https://snowpack.dev" rel="nofollow">Snowpack</a>.</p>
<p dir="auto">[breaking] For consistency with other marks, the text mark now requires the <em>dx</em> and <em>dy</em> to be specified as numbers in pixels rather than typographic units such as ems; in addition, the <em>dx</em> and <em>dy</em> translation now happens prior to rotation (if any). To affect the typographic layout, use the new <em>lineAnchor</em> and <em>lineHeight</em> options.</p>
<p dir="auto">[breaking] Plot now requires <a href="https://github.com/d3/d3/releases/tag/v7.3.0">D3 ^7.3.0</a>.</p>
<h2 dir="auto"><a id="user-content-032" aria-hidden="true" href="#032"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.2</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.3.2">Released December 10, 2021.</a></p>
<p dir="auto">The font-variant now only defaults to <em>tabular-nums</em> for axis and legend tick labels on non-ordinal scales; on ordinal scales it defaults to <em>normal</em>.</p>
<p dir="auto">If a scale has an implicit label (such as inferred from a channel), the legend will now inherit the label.</p>
<h2 dir="auto"><a id="user-content-031" aria-hidden="true" href="#031"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.1</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.3.1">Released December 10, 2021.</a></p>
<p dir="auto">The normalize transform now also supports the <em>min</em>, <em>max</em>, and <em>deviation</em> basis methods.</p>
<p dir="auto">The generated figure element now resets the max-width style to initial.</p>
<p dir="auto">Update D3 to 7.2.1.</p>
<h2 dir="auto"><a id="user-content-030" aria-hidden="true" href="#030"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.3.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.3.0">Released December 4, 2021.</a></p>
<p dir="auto">Plot can now produce <a href="https://github.com/observablehq/plot/blob/main/README.md#legends">legends for <em>color</em> and <em>opacity</em> scales</a>!</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-legends" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/legend.png" width="660" alt="a scatterplot with a color legend"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  color: {
    legend: true
  },
  marks: [
    Plot.dot(athletes, {x: &#34;weight&#34;, y: &#34;height&#34;, stroke: &#34;sex&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>color</span>: <span>{</span>
    <span>legend</span>: <span>true</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>athletes</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;weight&#34;</span><span>,</span> <span>y</span>: <span>&#34;height&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;sex&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The top-level plot <em>scale</em>.<strong>legend</strong> option generates an inline legend for the given <em>scale</em> (<em>color</em> or <em>opacity</em>). Alternatively, the new <em>plot</em>.legend(<em>name</em>) function returns a legend for the scale with the given <em>name</em>. The new standalone Plot.<strong>legend</strong>(<em>options</em>) function also allows you to create a legend independently of a chart. Two forms of color legend are provided: <em>swatches</em> for ordinal or discrete scales (<em>e.g.</em>, threshold color scales), and <em>ramp</em> for continuous scales.</p>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#image">Plot.image</a> mark centers an image on the given <em>xy</em> position.</p>
<p dir="auto"><a href="https://observablehq.com/@observablehq/plot-image" rel="nofollow"><img src="https://github.com/observablehq/plot/raw/main/img/image.png" width="640" alt="a scatterplot of U.S. presidents"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  x: {
    label: &#34;Date of first inauguration →&#34;
  },
  y: {
    grid: true,
    label: `↑ Net favorability (%)`,
    percent: true,
    tickFormat: &#34;+f&#34;
  },
  marks: [
    Plot.ruleY([0]),
    Plot.image(favorability, {x: &#34;First Inauguration Date&#34;, y: &#34;Net favorability&#34;, src: &#34;Portrait URL&#34;})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>x</span>: <span>{</span>
    <span>label</span>: <span>&#34;Date of first inauguration →&#34;</span>
  <span>}</span><span>,</span>
  <span>y</span>: <span>{</span>
    <span>grid</span>: <span>true</span><span>,</span>
    <span>label</span>: <span>`↑ Net favorability (%)`</span><span>,</span>
    <span>percent</span>: <span>true</span><span>,</span>
    <span>tickFormat</span>: <span>&#34;+f&#34;</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>image</span><span>(</span><span>favorability</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;First Inauguration Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Net favorability&#34;</span><span>,</span> <span>src</span>: <span>&#34;Portrait URL&#34;</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">All marks now support a new <em>opacity</em> option, either as a constant or a channel bound to the <em>opacity</em> scale, which sets the mark’s object opacity. The <em>strokeOpacity</em> or <em>fillOpacity</em> options should be preferred for performance, but the <em>opacity</em> option is needed for some cases (such as images).</p>
<p dir="auto">All quantitative scales now have a default domain (typically [0, 1]). Ordinal scales now allow a <em>range</em> option to be specified in conjunction with a continuous <em>scheme</em>; in this case, the <em>range</em> should be a subset of the unit interval [0, 1], and the scheme’s interpolator will be truncated accordingly. The <em>plot</em>.<strong>scale</strong> method now correctly represents the symmetric transform for diverging scales. The scale definition returned by <em>plot</em>.<strong>scale</strong>(<em>name</em>) now includes a <em>scale</em>.apply function, allowing you to apply the scale’s encoding directly on the given data value. When applicable, a <em>scale</em>.invert function is also returned, which can be useful for interaction.</p>
<p dir="auto">Plot’s stylesheet is now inlined in the generated SVG element rather than injected into the document head. To avoid namespace collisions, we use a randomly-generated class name; use the top-level <strong>className</strong> option to specify a custom class name. The default style now uses font-variant: tabular-nums for a better alignment of numbers.</p>
<p dir="auto">A new top-level <em>margin</em> option allows to set all of marginLeft, marginRight, marginTop, and marginBottom at once. This shorthand notation is also available as a facet option.</p>
<p dir="auto">Update D3 to 7.2.0.</p>
<h2 dir="auto"><a id="user-content-029" aria-hidden="true" href="#029"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.9</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.9">Released October 12, 2021.</a></p>
<p dir="auto">Update D3 to 7.1.1.</p>
<h2 dir="auto"><a id="user-content-028" aria-hidden="true" href="#028"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.8</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.8">Released October 1, 2021.</a></p>
<p dir="auto">The map transform now supports <em>rank</em> and <em>quantile</em> map methods. These compute the 0-based ordinal rank or the <em>p</em>-quantile of the data, respectively.</p>
<p dir="auto">The bin transform now allows bin options (<em>domain</em>, <em>cumulative</em>, and <em>thresholds</em>) to be specified on the <em>outputs</em> object; this avoids ambiguity when composing multiple bin transforms. To facilitate transform composition, the bin and group transforms now consume the <em>x1</em> and <em>x2</em> channels when <em>x</em> is an output, and the <em>y1</em> and <em>y2</em> channels when <em>y</em> is an output. Also, the bin, group, and stack transforms now consume their respective transform options rather than propagating them in the returned options. The bin and group transform no longer use the channel name as the default label for the <em>count</em> reducer. The bin transform now automatically coerces values to dates when the <em>thresholds</em> are specified as a time interval or an array of dates.</p>
<p dir="auto">The new shuffle transform randomizes the order of data. It takes an optional <em>seed</em> for deterministic order.</p>
<p dir="auto">Position scales (<em>x</em>, <em>y</em>, <em>fx</em>, and <em>fy</em>) now support asymmetric insets via the <em>scale</em>.<strong>insetLeft</strong>, <em>scale</em>.<strong>insetRight</strong>, <em>scale</em>.<strong>insetTop</strong>, and <em>scale</em>.<strong>insetBottom</strong> options. Threshold and quantile scales can now be used as position scales without requiring an explicit range.</p>
<p dir="auto">The radius scale (<em>r</em>) now limits the maximum default radius to 30 pixels.</p>
<p dir="auto">Text marks now default strokeLinejoin to “round” to reduce the effect of miter joins.</p>
<h2 dir="auto"><a id="user-content-027" aria-hidden="true" href="#027"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.7</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.7">Released September 27, 2021.</a></p>
<p dir="auto">Implement symmetric diverging scales by extending the domain instead of slicing the interpolator.</p>
<h2 dir="auto"><a id="user-content-026" aria-hidden="true" href="#026"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.6</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.6">Released September 26, 2021.</a></p>
<p dir="auto">Fix the symmetric transform for reversed diverging scales.</p>
<h2 dir="auto"><a id="user-content-025" aria-hidden="true" href="#025"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.5</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.5">Released September 26, 2021.</a></p>
<p dir="auto">The new <em>plot</em>.<strong>scale</strong>(<em>name</em>) method exposes scales used by a particular plot. This method on returned plots takes the <em>name</em> of a scale and returns an object specifying the options that fully describe the scale’s behavior. The returned object represents the actual options in-use, including <em>scale</em>.domain, <em>scale</em>.range, <em>scale</em>.interpolate, <em>etc.</em> The <em>scale</em>.label, if any, is also returned; however, note that other axis options are not. The scale object is undefined if the associated plot has no scale with the given <em>name</em>, and throws an error if the <em>name</em> is invalid (<em>i.e.</em>, not one of the known scale names: <em>x</em>, <em>y</em>, <em>fx</em>, <em>fy</em>, <em>r</em>, <em>color</em>, or <em>opacity</em>). For example, given a plot:</p>
<div dir="auto" data-snippet-clipboard-copy-content="myplot = Plot.dot(gistemp, {x: &#34;Date&#34;, y: &#34;Anomaly&#34;, stroke: &#34;Anomaly&#34;}).plot()"><pre><span>myplot</span> <span>=</span> <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>gistemp</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Anomaly&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;Anomaly&#34;</span><span>}</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">You can retrieve the color scale like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mycolor = myplot.scale(&#34;color&#34;)"><pre><span>mycolor</span> <span>=</span> <span>myplot</span><span>.</span><span>scale</span><span>(</span><span>&#34;color&#34;</span><span>)</span></pre></div>
<p dir="auto">The resulting object is:</p>
<div dir="auto" data-snippet-clipboard-copy-content="({
  type: &#34;linear&#34;,
  domain: [-0.78, 1.35],
  range: [0, 1],
  interpolate: d3.interpolateTurbo,
  clamp: false,
  label: &#34;Anomaly&#34;
})"><pre><span>(</span><span>{</span>
  <span>type</span>: <span>&#34;linear&#34;</span><span>,</span>
  <span>domain</span>: <span>[</span><span>-</span><span>0.78</span><span>,</span> <span>1.35</span><span>]</span><span>,</span>
  <span>range</span>: <span>[</span><span>0</span><span>,</span> <span>1</span><span>]</span><span>,</span>
  <span>interpolate</span>: <span>d3</span><span>.</span><span>interpolateTurbo</span><span>,</span>
  <span>clamp</span>: <span>false</span><span>,</span>
  <span>label</span>: <span>&#34;Anomaly&#34;</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Inspecting materialized scales is useful for debugging and for generating color legends. (For now, we recommend using the <a href="https://observablehq.com/@d3/color-legend" rel="nofollow">D3 color legend</a>; in the near future Plot will have built-in support for color legends.) Scales can also now be shared between plots, ensuring consistent encoding. To reuse a scale, pass the scale from one plot into the specification for another:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({…, color: myplot.scale(&#34;color&#34;)})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>…<span>,</span> <span>color</span>: <span>myplot</span><span>.</span><span>scale</span><span>(</span><span>&#34;color&#34;</span><span>)</span><span>}</span><span>)</span></pre></div>
<p dir="auto">The new <em>scale</em>.<strong>unknown</strong> option provides more control over how unexpected, undefined, or invalid values are displayed. For quantitative and temporal scales, the unknown value is returned whenever the input value is undefined, null, or NaN. For ordinal or categorical scales, the unknown value is returned for any input value outside the domain. For band or point scales, the unknown option has no effect; it is always equal to undefined. If the unknown option is set to undefined (the default), or null or NaN, then affected input values will be considered undefined and filtered from the output. Hence, by setting <em>scale</em>.unknown to a defined value, you can ensure that these values are plotted.</p>
<p dir="auto">Plot now supports piecewise (a.k.a. “polylinear”) scales. If a single-argument <em>interpolate</em> function is specified (such as d3.interpolateWarm, or equivalently if you specify a color <em>scheme</em> such as <em>warm</em>), and the <em>range</em> is undefined, and the <em>domain</em> has more than two elements, the range [0, 1] will be partitioned into <em>domain</em>.length - 1 equal-size segments. The default scale range for <em>x</em> and <em>y</em> now supports piecewise scales, as does the default axis tick count. Additionally, ordinal color schemes now return the correct number of colors when the natural scheme size is not equal to the desired scheme size; and the <em>rainbow</em> and <em>sinebow</em> cyclical color schemes, when used with an ordinal color scale, no longer duplicate the first color as the last color.</p>
<p dir="auto">Plot now automatically detects “reversed” quantitative or temporal scales with descending domains or ranges. Reversed scales are detected by comparing the natural order of the domain and range. This improves the default axis label arrow orientation and the behavior of the <em>zero</em> option.</p>
<p dir="auto">The <em>interval</em> option for rect and bar now works with the default identity accessor. Also, the <em>interval</em> option is now ignored if the necessary value channel (<em>e.g.</em>, <em>x</em>) is not defined, rather than throwing an error. For example, you no longer have to define <em>x</em> as the identity function here:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barX(d3.utcDays(start, end), {interval: d3.utcDay, fill: d =&gt; d})"><pre><span>Plot</span><span>.</span><span>barX</span><span>(</span><span>d3</span><span>.</span><span>utcDays</span><span>(</span><span>start</span><span>,</span> <span>end</span><span>)</span><span>,</span> <span>{</span><span>interval</span>: <span>d3</span><span>.</span><span>utcDay</span><span>,</span> <span>fill</span>: <span>d</span> <span>=&gt;</span> <span>d</span><span>}</span><span>)</span></pre></div>
<p dir="auto">Plot’s default rounding behavior for band and point scales is now slightly smarter. Previously, automatic rounding could introduce substantial empty space on tall or wide plots; now Plot disables default rounding if it would introduce more than 30px of empty space.</p>
<p dir="auto">The <em>percent</em> and <em>transform</em> options are now supported on all scales, including diverging scales.</p>
<p dir="auto">The <em>center</em> and <em>wiggle</em> stack offsets now center across facets, facilitating comparison.</p>
<p dir="auto">Internal string coercion now uses <em>object</em>.toString instead of <em>object</em>.valueOf.</p>
<h2 dir="auto"><a id="user-content-024" aria-hidden="true" href="#024"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.4</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.4">Released September 24, 2021.</a></p>
<p dir="auto">Update <a href="https://github.com/observablehq/htl">Observable Hypertext Literal</a> to <a href="https://github.com/observablehq/htl/releases/tag/v0.3.1">0.3.1</a>.</p>
<h2 dir="auto"><a id="user-content-023" aria-hidden="true" href="#023"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.3</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.3">Released September 24, 2021.</a></p>
<p dir="auto">Rect, bar, and rule marks now accept an <em>interval</em> option that allows you to derive <em>x1</em> and <em>x2</em> from <em>x</em>, or <em>y1</em> and <em>y2</em> from <em>y</em>, where appropriate. For example, using d3.utcDay as the interval creates rects that span from UTC midnight to UTC midnight, bounding the associated time instant. The interval is typically specifed as a <a href="https://github.com/d3/d3-time/blob/main/README.md">D3 time interval</a>, but may be any compatible object which implements <em>interval</em>.floor and <em>interval</em>.offset: <em>interval</em>.floor(<em>x</em>) returns the start of the interval <em>x1</em> for the given <em>x</em>, while <em>interval</em>.offset(<em>x</em>) returns the end of the interval <em>x2</em> for the given interval start <em>x</em>. If the interval is specified as a number <em>n</em>, <em>x1</em> and <em>x2</em> are the two consecutive multiples of <em>n</em> that bracket <em>x</em>.</p>
<p dir="auto">The new Plot.normalize and Plot.window methods return map methods for use in conjunction with Plot.map. This allows greater flexibility; for example, you can apply separate window methods to <em>y1</em> and <em>y2</em> to produce Bollinger bands.</p>
<p dir="auto">Update <a href="https://github.com/d3/d3">D3</a> to <a href="https://github.com/d3/d3/releases/tag/v7.0.4">7.0.4</a>.</p>
<h2 dir="auto"><a id="user-content-022" aria-hidden="true" href="#022"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.2</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.2">Released September 19, 2021.</a></p>
<p dir="auto">Fix a crash with the scale.tickRotate option when there are no ticks to rotate.</p>
<h2 dir="auto"><a id="user-content-021" aria-hidden="true" href="#021"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.1</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.1">Released September 19, 2021.</a></p>
<p dir="auto">The constant <em>dx</em> and <em>dy</em> options have been extended to all marks, allowing to shift the mark by <em>dx</em> pixels horizontally and <em>dy</em> pixels vertically. Since only text elements accept the dx and dy properties, in all the other marks these are rendered as a transform (2D transformation) property of the mark’s parent, possibly including a 0.5px offset on low-density screens.</p>
<p dir="auto">Quantitative scales, as well as identity position scales, now coerce channel values to numbers; both null and undefined are coerced to NaN. Similarly, time scales coerce channel values to dates; numbers are assumed to be milliseconds since UNIX epoch, while strings are assumed to be in <a href="https://github.com/mbostock/isoformat/blob/main/README.md#parsedate-fallback">ISO 8601 format</a>.</p>
<p dir="auto">Bin transform reducers now receive the extent of the current bin as an argument after the data. For example, it allows to create meaningful titles:</p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.rect(
  athletes,
  Plot.bin(
    {
      fill: &#34;count&#34;,
      title: (bin, {x1, x2, y1, y2}) =&gt; `${bin.length} athletes weighing between ${x1} and ${x2} and with a height between ${y1} and ${y2}`
    },
    {
      x: &#34;weight&#34;,
      y: &#34;height&#34;,
      inset: 0
    }
  )
).plot()"><pre><span>Plot</span><span>.</span><span>rect</span><span>(</span>
  <span>athletes</span><span>,</span>
  <span>Plot</span><span>.</span><span>bin</span><span>(</span>
    <span>{</span>
      <span>fill</span>: <span>&#34;count&#34;</span><span>,</span>
      <span>title</span>: <span>(</span><span>bin</span><span>,</span> <span>{</span>x1<span>,</span> x2<span>,</span> y1<span>,</span> y2<span>}</span><span>)</span> <span>=&gt;</span> <span>`<span><span>${</span><span>bin</span><span>.</span><span>length</span><span>}</span></span> athletes weighing between <span><span>${</span><span>x1</span><span>}</span></span> and <span><span>${</span><span>x2</span><span>}</span></span> and with a height between <span><span>${</span><span>y1</span><span>}</span></span> and <span><span>${</span><span>y2</span><span>}</span></span>`</span>
    <span>}</span><span>,</span>
    <span>{</span>
      <span>x</span>: <span>&#34;weight&#34;</span><span>,</span>
      <span>y</span>: <span>&#34;height&#34;</span><span>,</span>
      <span>inset</span>: <span>0</span>
    <span>}</span>
  <span>)</span>
<span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">The <em>x1</em> and <em>x2</em> outputs now default to undefined if <em>x</em> is explicitly defined; similary, the <em>y1</em> and <em>y2</em> outputs now default to undefined if <em>y</em> is explicitly defined.</p>
<h2 dir="auto"><a id="user-content-020" aria-hidden="true" href="#020"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.2.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.2.0">Released August 20, 2021.</a></p>
<p dir="auto">[breaking] Plot is now published as an ES module and requires Node 12 or higher. For more, please read <a href="https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c">Sindre Sorhus’s FAQ</a>.</p>
<p dir="auto">[breaking] Plot now depends on <a href="https://github.com/d3/d3/releases/tag/v7.0.0">D3 7.0</a> or higher.</p>
<h3 dir="auto"><a id="user-content-marks" aria-hidden="true" href="#marks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Marks</h3>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#mark-options"><em>marks</em> option</a> now accepts render functions, null, and undefined as shorthand mark definitions. Nullish marks produce no output and are useful for conditional display (equivalent to the empty array). Render functions are invoked when plotting and may return an SVG element to insert into the plot, such as a legend or annotation.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130157120-8cbf8052-aa31-44ed-a650-d081c4a21d69.png"><img width="636" alt="a line chart of Apple, Inc.’s daily closing stock price from 2013 to 2018, with a red ‘hello world’ label" src="https://user-images.githubusercontent.com/230541/130157120-8cbf8052-aa31-44ed-a650-d081c4a21d69.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.marks(
  Plot.line(aapl, {x: &#34;Date&#34;, y: &#34;Close&#34;}),
  () =&gt; svg`&lt;text x=20% y=20% fill=red&gt;Hello, world!&lt;/text&gt;`
).plot()"><pre><span>Plot</span><span>.</span><span>marks</span><span>(</span>
  <span>Plot</span><span>.</span><span>line</span><span>(</span><span>aapl</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Close&#34;</span><span>}</span><span>)</span><span>,</span>
  <span>(</span><span>)</span> <span>=&gt;</span> <span>svg</span><span>`&lt;text x=20% y=20% fill=red&gt;Hello, world!&lt;/text&gt;`</span>
<span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">The <a href="https://github.com/observablehq/plot/blob/main/README.md#plotmarksmarks">Plot.marks(...<em>marks</em>)</a> function provides <a href="https://github.com/observablehq/plot/blob/main/README.md#plotplotoptions"><em>mark</em>.plot</a> shorthand for array marks. This is useful for composite marks, such as <a href="https://github.com/observablehq/plot/blob/8fef4fa52a4cca4135f5f964e3c328ef8f18f672/test/plots/morley-boxplot.js#L18-L23">boxes</a>.</p>
<p dir="auto">All marks now support the <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/shape-rendering" rel="nofollow">shapeRendering</a>  option. (This is a constant; it may not vary across marks.) All marks now allow strokeWidth to be specified as a channel. (The strokeWidth channel is unscaled; values are specified in literal pixels.) Text marks now also allow stroke and strokeOpacity to be specified as channels. If its fill is not <em>none</em>, a line’s default stroke is now <em>none</em> rather than <em>currentColor</em>, making it consistent with dot and other marks. When a fill or fillOpacity channel is used with a link, or when a stroke or strokeOpacity channel is used with a rule, undefined values will now be filtered. The text mark now uses attributes instead of styles for font rendering properties, improving compatibility with Firefox.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/7001/130228992-eb2452f1-8822-4239-87b7-07f79e5a2ccb.png"><img width="640" alt="a series of dots with an increasing stroke width" src="https://user-images.githubusercontent.com/7001/130228992-eb2452f1-8822-4239-87b7-07f79e5a2ccb.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.dotX(d3.range(41), {strokeWidth: d =&gt; (1 + d) / 15}).plot()"><pre><span>Plot</span><span>.</span><span>dotX</span><span>(</span><span>d3</span><span>.</span><span>range</span><span>(</span><span>41</span><span>)</span><span>,</span> <span>{</span><span>strokeWidth</span>: <span>d</span> <span>=&gt;</span> <span>(</span><span>1</span> <span>+</span> <span>d</span><span>)</span> <span>/</span> <span>15</span><span>}</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">Marks that represent continuous intervals (rect, bar, and rule) now handle collapsed domains during rendering. A domain is considered collapsed when it contains only a single value. A collapsed domain can occur when all input values to the bin transform are equal (<em>e.g.</em>, [1, 1, 1, …] produces a domain of [1, 1]). Previously a collapsed domain would result in an invisible zero-width mark; now the mark spans the full extent of the chart.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130156841-d888e397-0040-4aef-bbb5-9ff19e1e3389.png"><img width="640" alt="a histogram with a collapsed domain showing a single bar that represents the value 1 with frequency 3" src="https://user-images.githubusercontent.com/230541/130156841-d888e397-0040-4aef-bbb5-9ff19e1e3389.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.rectY([1, 1, 1], Plot.binX()).plot()"><pre><span>Plot</span><span>.</span><span>rectY</span><span>(</span><span>[</span><span>1</span><span>,</span> <span>1</span><span>,</span> <span>1</span><span>]</span><span>,</span> <span>Plot</span><span>.</span><span>binX</span><span>(</span><span>)</span><span>)</span><span>.</span><span>plot</span><span>(</span><span>)</span></pre></div>
<p dir="auto">The link mark now supports <em>x</em> or <em>y</em> shorthand for one-dimensional links, equivalent to rule. The rect mark now supports one-dimensional (and zero-dimensional) rects: the <em>x1</em>, <em>x2</em>, <em>y1</em> and <em>y2</em> channels are now optional.</p>
<h3 dir="auto"><a id="user-content-scales" aria-hidden="true" href="#scales"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Scales</h3>
<p dir="auto">The new <a href="https://github.com/observablehq/plot/blob/main/README.md#sort-options"><em>sort</em> options</a> allow convenient control over the order of ordinal domains, including the <em>fx</em> and <em>fy</em> facet domains. The aggregation method can be controlled via the <em>reduce</em> option, which defaults to <em>max</em>. The <em>reverse</em> and <em>limit</em> options are also supported. For example, a bar chart can be sorted by descending value like so:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130157414-be9cbc86-8a0c-40e7-8cfb-999881482691.png"><img width="640" alt="a bar chart showing the frequency of letters in the English language in order of descending frequency, starting with E at 13% and ending with Z at almost 0%" src="https://user-images.githubusercontent.com/230541/130157414-be9cbc86-8a0c-40e7-8cfb-999881482691.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.barY(alphabet, {x: &#34;letter&#34;, y: &#34;frequency&#34;, sort: {x: &#34;y&#34;, reverse: true}})"><pre><span>Plot</span><span>.</span><span>barY</span><span>(</span><span>alphabet</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;letter&#34;</span><span>,</span> <span>y</span>: <span>&#34;frequency&#34;</span><span>,</span> <span>sort</span>: <span>{</span><span>x</span>: <span>&#34;y&#34;</span><span>,</span> <span>reverse</span>: <span>true</span><span>}</span><span>}</span><span>)</span></pre></div>
<p dir="auto">Color scales now support the <em>threshold</em> scale type, allowing you to specify a set of <em>n</em> - 1 discrete (typically numeric) thresholds to produce <em>n</em> discrete colors. The new <em>quantile</em> color scale type will automatically compute <em>n</em> - 1 thresholds for <em>n</em> quantiles based on the data.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130157825-0624447b-f39d-4a2a-9363-e18129d6f20e.png"><img width="640" alt="a histogram showing the forecast probabilities of Democratic electoral votes in the 2016 U.S. presidential election, with outcomes of 270 votes highlighted in blue" src="https://user-images.githubusercontent.com/230541/130157825-0624447b-f39d-4a2a-9363-e18129d6f20e.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  y: {
    percent: true
  },
  color: {
    type: &#34;threshold&#34;,
    domain: [270]
  },
  marks: [
    Plot.ruleX(data, {x: &#34;dem_electoral_votes&#34;, y: &#34;probability&#34;, stroke: &#34;dem_electoral_votes&#34;, strokeWidth: 1.5}),
    Plot.ruleX([270])
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>y</span>: <span>{</span>
    <span>percent</span>: <span>true</span>
  <span>}</span><span>,</span>
  <span>color</span>: <span>{</span>
    <span>type</span>: <span>&#34;threshold&#34;</span><span>,</span>
    <span>domain</span>: <span>[</span><span>270</span><span>]</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>ruleX</span><span>(</span><span>data</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;dem_electoral_votes&#34;</span><span>,</span> <span>y</span>: <span>&#34;probability&#34;</span><span>,</span> <span>stroke</span>: <span>&#34;dem_electoral_votes&#34;</span><span>,</span> <span>strokeWidth</span>: <span>1.5</span><span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>ruleX</span><span>(</span><span>[</span><span>270</span><span>]</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Diverging scales now support a <em>symmetric</em> option, which defaults to true, to ensure that differences above and below the pivot are equally apparent. For example, the choropleth below gives equal visual weight to West Virginia’s population decline of −3% and Alaska’s gain of +3%. If <em>symmetric</em> is false, as before, then −3% is mapped to the darkest purple. (Diverging scales should always use balanced interpolators where the negative and positive extremes have equal weight; this is true of Plot’s built-in diverging color schemes from ColorBrewer.)</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/129834634-2617a895-5040-4135-b015-0aa4b812c262.png"><img width="641" alt="a choropleth with symmetric diverging scale, showing the change in population of the fifty U.S. states between 2010 and 2019; the change in negative values is commensurate with the change in positive values" src="https://user-images.githubusercontent.com/230541/129834634-2617a895-5040-4135-b015-0aa4b812c262.png"/></a></p>
<p dir="auto">Diverging color scales now also support transformations via four new scale types: <em>diverging-sqrt</em>, <em>diverging-pow</em>, <em>diverging-log</em>, and <em>diverging-symlog</em>, corresponding to the <em>sqrt</em>, <em>pow</em>, <em>log</em>, and <em>symlog</em> quantitative scale types respectively. (The above choropleth uses a <em>diverging-log</em> scale to show relative change.)</p>
<p dir="auto">The new axis <em>line</em> option, which defaults to false, can be used to show a continuous line along the <em>x</em> or <em>y</em> axis to denote the extent. This is most useful when the opposite axis is ordinal and thus a rule cannot annotate a meaningful value such as zero; if the opposite axis is quantitative, a rule is generally preferred. If set at the top level, applies to both <em>x</em> and <em>y</em>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130247773-d868d261-9744-4d57-855a-61a2a870655b.png"><img width="640" alt="an empty plot showing a vertical line along the quantitative y-axis; the opposite x-axis is categorical" src="https://user-images.githubusercontent.com/230541/130247773-d868d261-9744-4d57-855a-61a2a870655b.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  grid: true,
  inset: 6,
  x: {
    domain: &#34;ABCDEFGH&#34;
  },
  y: {
    line: true,
    domain: [0, 1]
  }
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>grid</span>: <span>true</span><span>,</span>
  <span>inset</span>: <span>6</span><span>,</span>
  <span>x</span>: <span>{</span>
    <span>domain</span>: <span>&#34;ABCDEFGH&#34;</span>
  <span>}</span><span>,</span>
  <span>y</span>: <span>{</span>
    <span>line</span>: <span>true</span><span>,</span>
    <span>domain</span>: <span>[</span><span>0</span><span>,</span> <span>1</span><span>]</span>
  <span>}</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>axis</em> and <em>label</em> options (along with <em>grid</em>) can now be set as a top-level option, or a facet-level option, and inherited by <em>x</em> and <em>y</em> or <em>fx</em> and <em>fy</em>. This is most often useful for turning off all default axes or labels by setting the respective option to null.</p>
<h3 dir="auto"><a id="user-content-facets" aria-hidden="true" href="#facets"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Facets</h3>
<p dir="auto">The mark <em>facet</em> option can be used to control whether or not a mark is faceted. The supported values are <em>auto</em>, <em>include</em>, <em>exclude</em>, and null. True is an alias for <em>include</em> and false is an alias for null. The default is <em>auto</em>, which facets a mark if and only if its data is strictly equal to the facet data. The <em>include</em> facet mode allows a mark with different data to be faceted; however, it requires that the mark’s data be parallel with the facet data (<em>i.e.</em>, have the same length and order). The <em>exclude</em> facet mode shows all data that are not present in the current facet; this can provide shared context across facets without overdrawing. The null mode disables faceting, replicating the mark across all facets.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/7001/130275538-ec33aaa4-73e2-4fb3-862a-8fdd47a788d6.png"><img width="640" alt="a faceted scatterplot showing the correlation between culmen depth and length across sex and species; each facet shows the current sex and species with black dots and all other penguins as pale gray dots" src="https://user-images.githubusercontent.com/7001/130275538-ec33aaa4-73e2-4fb3-862a-8fdd47a788d6.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  facet: {
    data: penguins,
    x: &#34;sex&#34;,
    y: &#34;species&#34;,
    marginRight: 80
  },
  marks: [
    Plot.frame(),
    Plot.dot(penguins, {
      facet: &#34;exclude&#34;,
      x: &#34;culmen_depth_mm&#34;,
      y: &#34;culmen_length_mm&#34;,
      r: 2,
      fill: &#34;#ddd&#34;
    }),
    Plot.dot(penguins, {
      x: &#34;culmen_depth_mm&#34;,
      y: &#34;culmen_length_mm&#34;
    })
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>facet</span>: <span>{</span>
    <span>data</span>: <span>penguins</span><span>,</span>
    <span>x</span>: <span>&#34;sex&#34;</span><span>,</span>
    <span>y</span>: <span>&#34;species&#34;</span><span>,</span>
    <span>marginRight</span>: <span>80</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>frame</span><span>(</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>penguins</span><span>,</span> <span>{</span>
      <span>facet</span>: <span>&#34;exclude&#34;</span><span>,</span>
      <span>x</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span>
      <span>y</span>: <span>&#34;culmen_length_mm&#34;</span><span>,</span>
      <span>r</span>: <span>2</span><span>,</span>
      <span>fill</span>: <span>&#34;#ddd&#34;</span>
    <span>}</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>dot</span><span>(</span><span>penguins</span><span>,</span> <span>{</span>
      <span>x</span>: <span>&#34;culmen_depth_mm&#34;</span><span>,</span>
      <span>y</span>: <span>&#34;culmen_length_mm&#34;</span>
    <span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Empty facets, which can occur when faceting in both <em>x</em> and <em>y</em>, or when the specified <em>fx</em> or <em>fy</em> domain includes values not present in the data, are no longer rendered. When the facet <em>data</em> is null, a better error message is thrown.</p>
<h3 dir="auto"><a id="user-content-transforms" aria-hidden="true" href="#transforms"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Transforms</h3>
<p dir="auto">The bin and group transforms now support new <em>filter</em>, <em>sort</em> and <em>reverse</em> options on the <em>outputs</em> object. By setting the <em>filter</em> to null, the bin transform will now return all bins, even if empty; this is useful with marks such as lines and areas that require zeroes to be present, rather than interpolating across the missing bins. (The <em>z</em>, <em>fill</em> or <em>stroke</em> channels, when used for grouping, are propagated to empty bins.)</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130282717-01fb2979-0c8b-415b-8a67-bef169b9c6b5.png"><img width="641" alt="a stacked area chart showing the count of covid cases resulting in deaths over time for San Francisco, broken down by transmission category; if empty bins were not present, this chart would render incorrectly" src="https://user-images.githubusercontent.com/230541/130282717-01fb2979-0c8b-415b-8a67-bef169b9c6b5.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  marks: [
    Plot.areaY(cases, Plot.binX({y: &#34;sum&#34;, filter: null}, {
      x: &#34;specimen_collection_date&#34;,
      y: &#34;case_count&#34;,
      filter: d =&gt; d.case_disposition === &#34;Death&#34;,
      fill: &#34;transmission_category&#34;,
      curve: &#34;step&#34;,
      thresholds: d3.utcWeek
    })),
    Plot.ruleY([0])
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>areaY</span><span>(</span><span>cases</span><span>,</span> <span>Plot</span><span>.</span><span>binX</span><span>(</span><span>{</span><span>y</span>: <span>&#34;sum&#34;</span><span>,</span> <span>filter</span>: <span>null</span><span>}</span><span>,</span> <span>{</span>
      <span>x</span>: <span>&#34;specimen_collection_date&#34;</span><span>,</span>
      <span>y</span>: <span>&#34;case_count&#34;</span><span>,</span>
      <span>filter</span>: <span>d</span> <span>=&gt;</span> <span>d</span><span>.</span><span>case_disposition</span> <span>===</span> <span>&#34;Death&#34;</span><span>,</span>
      <span>fill</span>: <span>&#34;transmission_category&#34;</span><span>,</span>
      <span>curve</span>: <span>&#34;step&#34;</span><span>,</span>
      <span>thresholds</span>: <span>d3</span><span>.</span><span>utcWeek</span>
    <span>}</span><span>)</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>outputs</em> argument to the bin and group transforms is now optional; it defaults to the <em>count</em> reducer for <em>y</em>, <em>x</em> and <em>fill</em> for Plot.binX, Plot.binY, and Plot.bin respectively, and the same for the group transforms.</p>
<p dir="auto">The bin and group transforms now support new <em>distinct</em>, <em>mode</em>, <em>min-index</em>, and <em>max-index</em> reducers. The <em>distinct</em> reducer counts the number of distinct values in each group, while the <em>mode</em> reducer returns the most frequent value in each group. The <em>min-index</em> and <em>max-index</em> reducers are similar to <em>min</em> and <em>max</em>, except they return the zero-based index of the minimum and maximum value, respectively; for example, this is useful to sort time series by the date of each series’ peak.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130283717-71d42637-89e4-4794-82e6-9a8570bb527d.png"><img width="640" alt="a small-multiples area chart of Google search trends for the year 2020; trends are ordered chronologically by their peak, starting with Australian bushfires and ending with COVID-19 vaccine" src="https://user-images.githubusercontent.com/230541/130283717-71d42637-89e4-4794-82e6-9a8570bb527d.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  height: 900,
  label: null,
  x: {axis: &#34;top&#34;},
  y: {axis: null},
  facet: {
    data: trends,
    y: &#34;search&#34;,
    marginLeft: 160
  },
  marks: [
    Plot.areaY(trends, {x: &#34;week&#34;, y: &#34;interest&#34;, sort: {fy: &#34;y&#34;, reduce: &#34;max-index&#34;}})
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>height</span>: <span>900</span><span>,</span>
  <span>label</span>: <span>null</span><span>,</span>
  <span>x</span>: <span>{</span><span>axis</span>: <span>&#34;top&#34;</span><span>}</span><span>,</span>
  <span>y</span>: <span>{</span><span>axis</span>: <span>null</span><span>}</span><span>,</span>
  <span>facet</span>: <span>{</span>
    <span>data</span>: <span>trends</span><span>,</span>
    <span>y</span>: <span>&#34;search&#34;</span><span>,</span>
    <span>marginLeft</span>: <span>160</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>areaY</span><span>(</span><span>trends</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;week&#34;</span><span>,</span> <span>y</span>: <span>&#34;interest&#34;</span><span>,</span> <span>sort</span>: <span>{</span><span>fy</span>: <span>&#34;y&#34;</span><span>,</span> <span>reduce</span>: <span>&#34;max-index&#34;</span><span>}</span><span>}</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The default <em>thresholds</em> option for the bin transforms is now <em>auto</em> instead of <em>scott</em>. The <em>auto</em> option applies a maximum limit of 200 bins to Scott’s rule. This reduces the risk of producing vanishing rects when they are too numerous and thin to be visible. (Note, however, that it is still possible to produce invisible rects if the insets are larger than the width.)</p>
<p dir="auto">The normalize, window, and stack transforms can now accept a transform <em>options</em> argument in addition to an <em>inputs</em> argument that specifies the input channels. This allows makes these transforms more consistent with the other transforms, reduces ambiguity, and allows for additional shorthand. For example, you can pass <em>k</em> as the first argument to the window transform, here for a 24-month moving average:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/230541/130284148-04622afe-c8a9-4a1e-a459-ada8f1744a3e.png"><img width="640" alt="a smoothed line chart showing the rise of the average global surface temperature anomaly from 1880 to the present" src="https://user-images.githubusercontent.com/230541/130284148-04622afe-c8a9-4a1e-a459-ada8f1744a3e.png"/></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="Plot.plot({
  y: {
    label: &#34;↑ Temperature anomaly (°C)&#34;,
    tickFormat: &#34;+f&#34;,
    grid: true
  },
  marks: [
    Plot.ruleY([0]),
    Plot.line(gistemp, Plot.windowY(24, {x: &#34;Date&#34;, y: &#34;Anomaly&#34;}))
  ]
})"><pre><span>Plot</span><span>.</span><span>plot</span><span>(</span><span>{</span>
  <span>y</span>: <span>{</span>
    <span>label</span>: <span>&#34;↑ Temperature anomaly (°C)&#34;</span><span>,</span>
    <span>tickFormat</span>: <span>&#34;+f&#34;</span><span>,</span>
    <span>grid</span>: <span>true</span>
  <span>}</span><span>,</span>
  <span>marks</span>: <span>[</span>
    <span>Plot</span><span>.</span><span>ruleY</span><span>(</span><span>[</span><span>0</span><span>]</span><span>)</span><span>,</span>
    <span>Plot</span><span>.</span><span>line</span><span>(</span><span>gistemp</span><span>,</span> <span>Plot</span><span>.</span><span>windowY</span><span>(</span><span>24</span><span>,</span> <span>{</span><span>x</span>: <span>&#34;Date&#34;</span><span>,</span> <span>y</span>: <span>&#34;Anomaly&#34;</span><span>}</span><span>)</span><span>)</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">The <em>offset</em> stack options have been renamed: <em>offset</em> = <em>expand</em> is now <em>offset</em> = <em>normalize</em>, and <em>offset</em> = <em>silhouette</em> is <em>offset</em> = <em>center</em>. The <em>shift</em> window option has been replaced with the <em>anchor</em> option: <em>shift</em> = <em>centered</em> is now <em>anchor</em> = <em>middle</em>, <em>shift</em> = <em>leading</em> is <em>anchor</em> = <em>start</em>, and <em>shift</em> = <em>trailing</em> is <em>anchor</em> = <em>end</em>. The old names are supported for backwards compatibility.</p>
<p dir="auto">The basic transforms are now available as explicit option transforms: Plot.filter, Plot.sort, and Plot.reverse. These are useful when you wish to control the order of these transforms with respect to other transforms such as Plot.bin and Plot.stack.</p>
<p dir="auto">The select transforms now throw better error messages when required input channels are missing. When mark <em>transform</em> option is null, it is considered equivalent to undefined and no transform is applied instead of throwing an error.</p>
<h2 dir="auto"><a id="user-content-010" aria-hidden="true" href="#010"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>0.1.0</h2>
<p dir="auto"><a href="https://github.com/observablehq/plot/releases/tag/v0.1.0">Released May 3, 2021.</a></p>
</article>
  </div>

    </div>

  </div></div>
  </body>
</html>
