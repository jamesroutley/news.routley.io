<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/xcaeser/zli">Original</a>
    <h1>Show HN: Zli â€“ A Batteries-Included CLI Framework for Zig</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A <strong>blazing-fast</strong>, zero-cost CLI framework for Zig. The last one you will ever use.</p>
<p dir="auto">Build modular, ergonomic, and high-performance CLIs with ease.
All batteries included.</p>
<p dir="auto"><a href="https://github.com/xcaeser/zli/blob/main/README.md"><img src="https://camo.githubusercontent.com/39f4b8b9c89f21d5d3abeff18d7b03dccce883e3481030ca6c3ac68470d396ff/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5a69675f56657273696f6e2d302e31342e312d6f72616e67652e7376673f6c6f676f3d7a6967" alt="Zig Version" data-canonical-src="https://img.shields.io/badge/Zig_Version-0.14.1-orange.svg?logo=zig"/></a>
<a href="https://github.com/xcaeser/zli/blob/main/LICENSE"><img src="https://camo.githubusercontent.com/5de08c80e5b6eb57cc91b69359ac8aad5086565b4d66c933b1a9e3e640a11b9e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d6c69676874677265792e7376673f6c6f676f3d636163686574" alt="License: MIT" data-canonical-src="https://img.shields.io/badge/License-MIT-lightgrey.svg?logo=cachet"/></a>
<a href="https://github.com/xcaeser"><img src="https://camo.githubusercontent.com/5401b6b0a22ad1038cfd6bee0d6634f697a53714b57cf50e92183d0a1560caba/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4275696c7425323062792d40786361657365722d626c7565" alt="Built by xcaeser" data-canonical-src="https://img.shields.io/badge/Built%20by-@xcaeser-blue"/></a>
<a href="https://github.com/xcaeser/zli/releases"><img src="https://camo.githubusercontent.com/7cba0f5b1ded442423532d523116f5a2c8430c7c6540e3b2aba225b41fa9ccc7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5a4c492d76332e352e322d677265656e" alt="Version" data-canonical-src="https://img.shields.io/badge/ZLI-v3.5.2-green"/></a></p>
<blockquote>
<p dir="auto">ðŸ§± Each command is modular and self-contained.
inspired by Cobra (Go) and clap (Rust).</p>
</blockquote>

<p dir="auto">See <a href="https://github.com/xcaeser/zli/blob/main/docs.md">docs.md</a> for full usage, examples, and internals.</p>

<ul dir="auto">
<li>Modular commands &amp; subcommands</li>
<li>Fast flag parsing (<code>--flag</code>, <code>--flag=value</code>, shorthand <code>-abc</code>)</li>
<li>Type-safe support for <code>bool</code>, <code>int</code>, <code>string</code></li>
<li>Named positional arguments with <code>required</code>, <code>optional</code>, <code>variadic</code></li>
<li>Auto help/version/deprecation handling</li>
<li>Pretty help output with aligned flags &amp; args</li>
<li>Cobra-like usage hints, context-aware</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="zig fetch --save=zli https://github.com/xcaeser/zli/archive/v3.5.2.tar.gz"><pre>zig fetch --save=zli https://github.com/xcaeser/zli/archive/v3.5.2.tar.gz</pre></div>
<p dir="auto">Add to your <code>build.zig</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const zli_dep = b.dependency(&#34;zli&#34;, .{ .target = target });
exe.root_module.addImport(&#34;zli&#34;, zli_dep.module(&#34;zli&#34;));"><pre><span>const</span> <span>zli_dep</span> <span>=</span> <span>b</span>.<span>dependency</span>(<span>&#34;zli&#34;</span>, .{ .<span>target</span> <span>=</span> <span>target</span> });
<span>exe</span>.<span>root_module</span>.<span>addImport</span>(<span>&#34;zli&#34;</span>, <span>zli_dep</span>.<span>module</span>(<span>&#34;zli&#34;</span>));</pre></div>

<div data-snippet-clipboard-copy-content="your-app/
â”œâ”€â”€ build.zig
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.zig
â”‚   â””â”€â”€ cli/
â”‚       â”œâ”€â”€ root.zig
â”‚       â”œâ”€â”€ run.zig
â”‚       â””â”€â”€ version.zig"><pre><code>your-app/
â”œâ”€â”€ build.zig
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.zig
â”‚   â””â”€â”€ cli/
â”‚       â”œâ”€â”€ root.zig
â”‚       â”œâ”€â”€ run.zig
â”‚       â””â”€â”€ version.zig
</code></pre></div>
<ul dir="auto">
<li>Each command is in its own file</li>
<li>You explicitly register subcommands</li>
<li><code>root.zig</code> is the entry point</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="// src/main.zig
const std = @import(&#34;std&#34;);
const cli = @import(&#34;cli/root.zig&#34;);

pub fn main() !void {
    const allocator = std.heap.smp_allocator;
    var root = try cli.build(allocator);
    defer root.deinit();

    try root.execute(.{}); // Or pass data with: try root.execute(.{ .data = &amp;my_data });
}"><pre><span>// src/main.zig</span>
<span>const</span> <span>std</span> <span>=</span> <span>@import</span>(<span>&#34;std&#34;</span>);
<span>const</span> <span>cli</span> <span>=</span> <span>@import</span>(<span>&#34;cli/root.zig&#34;</span>);

<span>pub</span> <span>fn</span> <span>main</span>() <span>!</span><span>void</span> {
    <span>const</span> <span>allocator</span> <span>=</span> <span>std</span>.<span>heap</span>.<span>smp_allocator</span>;
    <span>var</span> <span>root</span> <span>=</span> <span>try</span> <span>cli</span>.<span>build</span>(<span>allocator</span>);
    <span>defer</span> <span>root</span>.<span>deinit</span>();

    <span>try</span> <span>root</span>.<span>execute</span>(.{}); <span>// Or pass data with: try root.execute(.{ .data = &amp;my_data });</span>
}</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="// src/cli/root.zig
const std = @import(&#34;std&#34;);
const zli = @import(&#34;zli&#34;);

const run = @import(&#34;run.zig&#34;);
const version = @import(&#34;version.zig&#34;);

pub fn build(allocator: std.mem.Allocator) !*zli.Command {
    const root = try zli.Command.init(allocator, .{
        .name = &#34;blitz&#34;,
        .description = &#34;Your dev toolkit CLI&#34;,
    }, showHelp);

    try root.addCommands(&amp;.{
        try run.register(allocator),
        try version.register(allocator),
    });

    return root;
}

fn showHelp(ctx: zli.CommandContext) !void {
    try ctx.command.printHelp(true);
}"><pre><span>// src/cli/root.zig</span>
<span>const</span> <span>std</span> <span>=</span> <span>@import</span>(<span>&#34;std&#34;</span>);
<span>const</span> <span>zli</span> <span>=</span> <span>@import</span>(<span>&#34;zli&#34;</span>);

<span>const</span> <span>run</span> <span>=</span> <span>@import</span>(<span>&#34;run.zig&#34;</span>);
<span>const</span> <span>version</span> <span>=</span> <span>@import</span>(<span>&#34;version.zig&#34;</span>);

<span>pub</span> <span>fn</span> <span>build</span>(<span>allocator</span>: <span>std.mem.Allocator</span>) <span>!</span><span>*</span><span>zli.Command</span> {
    <span>const</span> <span>root</span> <span>=</span> <span>try</span> <span>zli</span>.<span>Command</span>.<span>init</span>(<span>allocator</span>, .{
        .<span>name</span> <span>=</span> <span>&#34;blitz&#34;</span>,
        .<span>description</span> <span>=</span> <span>&#34;Your dev toolkit CLI&#34;</span>,
    }, <span>showHelp</span>);

    <span>try</span> <span>root</span>.<span>addCommands</span>(&amp;.{
        <span>try</span> <span>run</span>.<span>register</span>(<span>allocator</span>),
        <span>try</span> <span>version</span>.<span>register</span>(<span>allocator</span>),
    });

    <span>return</span> <span>root</span>;
}

<span>fn</span> <span>showHelp</span>(<span>ctx</span>: <span>zli.CommandContext</span>) <span>!</span><span>void</span> {
    <span>try</span> <span>ctx</span>.<span>command</span>.<span>printHelp</span>(<span>true</span>);
}</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="// src/cli/run.zig
const std = @import(&#34;std&#34;);
const zli = @import(&#34;zli&#34;);

const now_flag = zli.Flag{
    .name = &#34;now&#34;,
    .shortcut = &#34;n&#34;,
    .description = &#34;Run immediately&#34;,
    .type = .Bool,
    .default_value = .{ .Bool = false },
};

pub fn register(allocator: std.mem.Allocator) !*zli.Command {
    const cmd = try zli.Command.init(allocator, .{
        .name = &#34;run&#34;,
        .description = &#34;Run your workflow&#34;,
    }, run);

    try cmd.addFlag(now_flag);
    try cmd.addPositionalArg(.{
        .name = &#34;script&#34;,
        .description = &#34;Script to execute&#34;,
        .required = true,
    });
    try cmd.addPositionalArg(.{
        .name = &#34;env&#34;,
        .description = &#34;Environment name&#34;,
        .required = false,
    });

    return cmd;
}

fn run(ctx: zli.CommandContext) !void {
    const now = ctx.flag(&#34;now&#34;, bool); // type-safe flag access

    const script = ctx.getArg(&#34;script&#34;) orelse {
        try ctx.command.stderr.print(&#34;Missing script arg\n&#34;, .{});
        return;
    };
    const env = ctx.getArg(&#34;env&#34;) orelse &#34;default&#34;;

    std.debug.print(&#34;Running {s} in {s} (now = {})\n&#34;, .{ script, env, now });
}"><pre><span>// src/cli/run.zig</span>
<span>const</span> <span>std</span> <span>=</span> <span>@import</span>(<span>&#34;std&#34;</span>);
<span>const</span> <span>zli</span> <span>=</span> <span>@import</span>(<span>&#34;zli&#34;</span>);

<span>const</span> <span>now_flag</span> <span>=</span> <span>zli.Flag</span>{
    .<span>name</span> <span>=</span> <span>&#34;now&#34;</span>,
    .<span>shortcut</span> <span>=</span> <span>&#34;n&#34;</span>,
    .<span>description</span> <span>=</span> <span>&#34;Run immediately&#34;</span>,
    .<span>type</span> <span>=</span> <span>.Bool</span>,
    .<span>default_value</span> <span>=</span> .{ .<span>Bool</span> <span>=</span> <span>false</span> },
};

<span>pub</span> <span>fn</span> <span>register</span>(<span>allocator</span>: <span>std.mem.Allocator</span>) <span>!</span><span>*</span><span>zli.Command</span> {
    <span>const</span> <span>cmd</span> <span>=</span> <span>try</span> <span>zli</span>.<span>Command</span>.<span>init</span>(<span>allocator</span>, .{
        .<span>name</span> <span>=</span> <span>&#34;run&#34;</span>,
        .<span>description</span> <span>=</span> <span>&#34;Run your workflow&#34;</span>,
    }, <span>run</span>);

    <span>try</span> <span>cmd</span>.<span>addFlag</span>(<span>now_flag</span>);
    <span>try</span> <span>cmd</span>.<span>addPositionalArg</span>(.{
        .<span>name</span> <span>=</span> <span>&#34;script&#34;</span>,
        .<span>description</span> <span>=</span> <span>&#34;Script to execute&#34;</span>,
        .<span>required</span> <span>=</span> <span>true</span>,
    });
    <span>try</span> <span>cmd</span>.<span>addPositionalArg</span>(.{
        .<span>name</span> <span>=</span> <span>&#34;env&#34;</span>,
        .<span>description</span> <span>=</span> <span>&#34;Environment name&#34;</span>,
        .<span>required</span> <span>=</span> <span>false</span>,
    });

    <span>return</span> <span>cmd</span>;
}

<span>fn</span> <span>run</span>(<span>ctx</span>: <span>zli.CommandContext</span>) <span>!</span><span>void</span> {
    <span>const</span> <span>now</span> <span>=</span> <span>ctx</span>.<span>flag</span>(<span>&#34;now&#34;</span>, <span>bool</span>); <span>// type-safe flag access</span>

    <span>const</span> <span>script</span> <span>=</span> <span>ctx</span>.<span>getArg</span>(<span>&#34;script&#34;</span>) <span>orelse</span> {
        <span>try</span> <span>ctx</span>.<span>command</span>.<span>stderr</span>.<span>print</span>(<span>&#34;Missing script arg<span>\n</span>&#34;</span>, .{});
        <span>return</span>;
    };
    <span>const</span> <span>env</span> <span>=</span> <span>ctx</span>.<span>getArg</span>(<span>&#34;env&#34;</span>) <span>orelse</span> <span>&#34;default&#34;</span>;

    <span>std</span>.<span>debug</span>.<span>print</span>(<span>&#34;Running {s} in {s} (now = {})<span>\n</span>&#34;</span>, .{ <span>script</span>, <span>env</span>, <span>now</span> });
}</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="// src/cli/version.zig
const std = @import(&#34;std&#34;);
const zli = @import(&#34;zli&#34;);

pub fn register(allocator: std.mem.Allocator) !*zli.Command {
    return zli.Command.init(allocator, .{
        .name = &#34;version&#34;,
        .shortcut = &#34;v&#34;,
        .description = &#34;Show CLI version&#34;,
    }, show);
}

fn show(ctx: zli.CommandContext) !void {
    std.debug.print(&#34;{}\n&#34;, .{ctx.root.options.version});
}"><pre><span>// src/cli/version.zig</span>
<span>const</span> <span>std</span> <span>=</span> <span>@import</span>(<span>&#34;std&#34;</span>);
<span>const</span> <span>zli</span> <span>=</span> <span>@import</span>(<span>&#34;zli&#34;</span>);

<span>pub</span> <span>fn</span> <span>register</span>(<span>allocator</span>: <span>std.mem.Allocator</span>) <span>!</span><span>*</span><span>zli.Command</span> {
    <span>return</span> <span>zli</span>.<span>Command</span>.<span>init</span>(<span>allocator</span>, .{
        .<span>name</span> <span>=</span> <span>&#34;version&#34;</span>,
        .<span>shortcut</span> <span>=</span> <span>&#34;v&#34;</span>,
        .<span>description</span> <span>=</span> <span>&#34;Show CLI version&#34;</span>,
    }, <span>show</span>);
}

<span>fn</span> <span>show</span>(<span>ctx</span>: <span>zli.CommandContext</span>) <span>!</span><span>void</span> {
    <span>std</span>.<span>debug</span>.<span>print</span>(<span>&#34;{}<span>\n</span>&#34;</span>, .{<span>ctx</span>.<span>root</span>.<span>options</span>.<span>version</span>});
}</pre></div>

<ul>
<li> Commands &amp; subcommands</li>
<li> Flags &amp; shorthands</li>
<li> Type-safe flag values</li>
<li> Help/version auto handling</li>
<li> Deprecation notices</li>
<li> Positional args (required, optional, variadic)</li>
<li> Pretty-aligned help for flags &amp; args</li>
<li> Named access: <code>ctx.getArg(&#34;name&#34;)</code></li>
<li> Clean usage output like Cobra</li>
<li> Command aliases</li>
<li> Persistent flags</li>
</ul>

<p dir="auto">MIT. See <a href="https://github.com/xcaeser/zli/blob/main/LICENSE">LICENSE</a>. Contributions welcome.</p>
</article></div></div>
  </body>
</html>
