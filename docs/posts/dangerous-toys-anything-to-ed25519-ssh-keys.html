<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://0xcc.re/2022/02/01/dangerous-toys-anything-to-ed25519-ssh-keys.html">Original</a>
    <h1>Dangerous toys: Anything to ed25519 (SSH Keys)</h1>
    
    <div id="readability-page-1" class="page"><div>
      
        <header>
          
          


        </header>
      

      <section itemprop="text">
        <p>
          <i>2022-02-01 14:00:00 +0100 - Written by Mikal Villa</i>
        </p>
        
        <p><strong>Disclaimer:</strong> I‚Äôm not a professional cryptographer or anything like that, I‚Äôve found it interesting to dig deep into ECC and alike crypto, use at own risk and such :)</p>

<p><strong>BIG NOTE:</strong> After much discussion in communities it seems like a general misunderstanding from many people where they think this is a ‚Äúpassword to key‚Äù tool.
It is not, if you use it for that purpose you‚Äôre stupid. This is for allowing you to generate more pleasant seeds for your private key, like a 64char HEX string. Rather than having to fight the keyboard typing in a base64 key when you‚Äôre already super stressed because your infrastructure is down and you‚Äôre in the middle of a disaster recovery. (Ref bellow) Wouldn‚Äôt you love enter those A‚Äôs and beg you counted right?</p>

<div><div><pre><code>‚Äî‚ÄìBEGIN OPENSSH PRIVATE KEY‚Äî‚Äì b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz
</code></pre></div></div>

<p><strong>Extra note:</strong> Some awesome users at <a href="https://lobste.rs/s/aiysqb/dangerous_toys_anything_ed25519_ssh_keys">lobste.rs</a> discovered some newbie mistakes I did way back when I coded the initial code and was in the beginning of crypto learning and I‚Äôve afterwards patched the code and been carefully read over hunting any potential issues. Special thanks to lobsters‚Äôs user <a href="https://lobste.rs/u/zeebo">zeebo</a>!</p>

<p>A couple of years back I wrote a Golang binary which took whatever it got from <code>stdin</code> and generated a ready to use openssh keypair (a <code>id_ed25519</code> and a <code>id_ed25519.pub</code> with standard names). I then forgot about it, didn‚Äôt even put it into git. However back in August last year we had a case at work where
such would be perfect, so I managed to dig it back up and release it onto github for anyone to use.</p>

<p>This tool/toy (whatever you wanna name it) can be very practical but also extremly dangerous if used lightly without thinking about the security. It might just open your production environment to the wrong people if you don‚Äôt use good enough seeds. And just so you know, the human brain isn‚Äôt really equiped with good entropy so my adivce is to never use a key with something you just figured out of your own. Use a random strong key - the primary usage, at least from my side
is backup keys that can be written down on a paper and stored offline somewhere safe.</p>

<p>However, I can‚Äôt stress enough how crazy bad of a idea it is to use weak keys, like the ed25519 key you get from <code>echo hello | anything2ed25519</code> cause everyone can easily guess that kind of weak key. Use a dictionary and you have plenty of weak keys to test out if you‚Äôre the bad guy. So be sure to use a lot stronger seeds.</p>

<p>If any key from this tool should end up in anyone‚Äôs production environment, you should strictly follow the cryptocurrency guidelines about mnemonics keys. Nothing less than 24 random words, or some cryptographic strong random data of 32 bytes or more.</p>

<p>The trick is that the seed is put into a SHA256 hash, which results in a valid twisted edwards 255^19 key. So in theory you can even generate your keys from
a binary file like a <code>jpg</code> or <code>dll</code> even I wouldn‚Äôt recommend it as bigger files are hard to keep exactly the same bits over time, specially if you‚Äôre maybe
passing those files over different filesystems and operting systems and other scary stuff that might change something outside of your control and you won‚Äôt be able to recover your key.</p>

<p><img src="https://0xcc.re/assets/images/ed25519.png" alt="Ed25519"/></p>

<h2 id="recommendations">Recommendations</h2>

<p>If cryptography and security isn‚Äôt your strong side, you should probably skip using this tool. It will probably do more harm than good..</p>

<h2 id="demo-time">Demo time</h2>

<p>In my ‚Äúdemo‚Äù I use just a random seed, but the way this tool works is that it would produce the exact same private and public key, given the
input is exactly the same both times.</p>

<div><div><pre><code>anything2ed25519 on ÓÇ† main [?] via üêπ v1.17.2
‚ùØ openssl rand -base64 64 | tr -d &#39;\n&#39; | ./anything2ed25519-darwin-amd64.macho
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz
c2gtZWQyNTUxOQAAACB2LyhtKUdHZGdnpktmRSsBf2zW1/zorATpx2yPdqdSUQAA
AIiaywRCmssEQgAAAAtzc2gtZWQyNTUxOQAAACB2LyhtKUdHZGdnpktmRSsBf2zW
1/zorATpx2yPdqdSUQAAAEA0YjU5ODZiZTk4MTY2MzA4Y2NiZGMwMzU1NTVkYjc3
ZHYvKG0pR0dkZ2emS2ZFKwF/bNbX/OisBOnHbI92p1JRAAAAAAECAwQF
-----END OPENSSH PRIVATE KEY-----

ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIteEylauQyG0WXHPv18+u7B+yBURUMVUf9+F3ogil86


anything2ed25519 on ÓÇ† main [?] via üêπ v1.17.2
‚ùØ ls id_ed25519*
id_ed25519     id_ed25519.pub

</code></pre></div></div>

<h2 id="sources">Sources</h2>

<p>The repo is found at <a href="https://github.com/mikalv/anything2ed25519">https://github.com/mikalv/anything2ed25519</a></p>

        
      </section>

      

      

      
  

    </div></div>
  </body>
</html>
