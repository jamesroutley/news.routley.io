<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simonwillison.net/2025/Nov/2/new-prompt-injection-papers/">Original</a>
    <h1>New prompt injection papers: Agents rule of two and the attacker moves second</h1>
    
    <div id="readability-page-1" class="page"><div>


<div data-permalink-context="/2025/Nov/2/new-prompt-injection-papers/">

<p>2nd November 2025</p>



<p>Two interesting new papers regarding LLM security and prompt injection came to my attention this weekend.</p>
<h4 id="agents-rule-of-two-a-practical-approach-to-ai-agent-security">Agents Rule of Two: A Practical Approach to AI Agent Security</h4>
<p>The first is <a href="https://ai.meta.com/blog/practical-ai-agent-security/">Agents Rule of Two: A Practical Approach to AI Agent Security</a>, published on October 31st on the Meta AI blog. It doesn’t list authors but it was <a href="https://x.com/MickAyzenberg/status/1984355145917088235">shared on Twitter</a> by Meta AI security researcher Mick Ayzenberg.</p>
<p>It proposes a “Rule of Two” that’s inspired by both my own <a href="https://simonwillison.net/2025/Jun/16/the-lethal-trifecta/">lethal trifecta</a> concept and the Google Chrome team’s <a href="https://chromium.googlesource.com/chromium/src/+/main/docs/security/rule-of-2.md">Rule Of 2</a> for writing code that works with untrustworthy inputs:</p>
<blockquote>
<p>At a high level, the Agents Rule of Two states that until robustness research allows us to reliably detect and refuse prompt injection, agents <strong>must satisfy no more than two</strong> of the following three properties within a session to avoid the highest impact consequences of prompt injection.</p>
<p><strong>[A]</strong> An agent can process untrustworthy inputs</p>
<p><strong>[B]</strong> An agent can have access to sensitive systems or private data</p>
<p><strong>[C]</strong> An agent can change state or communicate externally</p>
<p>It’s still possible that all three properties are necessary to carry out a request. If an agent requires all three without starting a new session (i.e., with a fresh context window), then the agent should not be permitted to operate autonomously and at a minimum requires supervision --- via human-in-the-loop approval or another reliable means of validation.</p>
</blockquote>
<p>It’s accompanied by this handy diagram:</p>
<p><img src="https://static.simonwillison.net/static/2025/agents-rule-of-two.jpg" alt="Venn diagram titled &#34;Choose Two&#34; showing three overlapping circles labeled A, B, and C. Circle A (top): &#34;Process untrustworthy inputs&#34; with description &#34;Externally authored data may contain prompt injection attacks that turn an agent malicious.&#34; Circle B (bottom left): &#34;Access to sensitive systems or private data&#34; with description &#34;This includes private user data, company secrets, production settings and configs, source code, and other sensitive data.&#34; Circle C (bottom right): &#34;Change state or communicate externally&#34; with description &#34;Overwrite or change state through write actions, or transmitting data to a threat actor through web requests or tool calls.&#34; The two-way overlaps between circles are labeled &#34;Safe&#34; while the center where all three circles overlap is labeled &#34;Danger&#34;."/></p>
<p>I like this <em>a lot</em>.</p>
<p>I’ve spent several years now trying to find clear ways to explain the risks of prompt injection attacks to developers who are building on top of LLMs. It’s frustratingly difficult.</p>
<p>I’ve had the most success with the lethal trifecta, which boils one particular class of prompt injection attack down to a simple-enough model: if your system has access to private data, exposure to untrusted content and a way to communicate externally then it’s vulnerable to private data being stolen.</p>
<p>The one problem with the lethal trifecta is that it only covers the risk of data exfiltration: there are plenty of other, even nastier risks that arise from prompt injection attacks against LLM-powered agents with access to tools which the lethal trifecta doesn’t cover.</p>
<p>The Agents Rule of Two neatly solves this, through the addition of “changing state” as a property to consider. This brings other forms of tool usage into the picture: anything that can change state triggered by untrustworthy inputs is something to be very cautious about.</p>
<p>It’s also refreshing to see another major research lab concluding that prompt injection remains an unsolved problem, and attempts to block or filter them have not proven reliable enough to depend on. The current solution is to design systems with this in mind, and the Rule of Two is a solid way to think about that.</p>
<p id="exception"><strong>Update</strong>: On thinking about this further there’s one aspect of the Rule of Two model that doesn’t work for me: the Venn diagram above marks the combination of untrustworthy inputs and the ability to change state as “safe”, but that’s not right. Even without access to private systems or sensitive data that pairing can still produce harmful results. Unfortunately adding an exception for that pair undermines the simplicity of the “Rule of Two” framing!</p> 
<p>Which brings me to the second paper...</p>
<h4 id="the-attacker-moves-second-stronger-adaptive-attacks-bypass-defenses-against-llm-jailbreaks-and-prompt-injections">The Attacker Moves Second: Stronger Adaptive Attacks Bypass Defenses Against LLM Jailbreaks and Prompt Injections</h4>
<p>This paper is dated 10th October 2025 <a href="https://arxiv.org/abs/2510.09023">on Arxiv</a> and comes from a heavy-hitting team of 14 authors—Milad Nasr, Nicholas Carlini, Chawin Sitawarin, Sander V. Schulhoff, Jamie Hayes, Michael Ilie, Juliette Pluto, Shuang Song, Harsh Chaudhari, Ilia Shumailov, Abhradeep Thakurta, Kai Yuanqing Xiao, Andreas Terzis, Florian Tramèr—including representatives from OpenAI, Anthropic, and Google DeepMind.</p>
<p>The paper looks at 12 published defenses against prompt injection and jailbreaking and subjects them to a range of “adaptive attacks”—attacks that are allowed to expend considerable effort iterating multiple times to try and find a way through.</p>
<p>The defenses did not fare well:</p>
<blockquote>
<p>By systematically tuning and scaling general optimization techniques—gradient descent, reinforcement learning, random search, and human-guided exploration—we bypass 12 recent defenses (based on a diverse set of techniques) with attack success rate above 90% for most; importantly, the majority of defenses originally reported near-zero attack success rates.</p>
</blockquote>
<p>Notably the “Human red-teaming setting” scored 100%, defeating all defenses. That red-team consisted of 500 participants in an online competition they ran with a $20,000 prize fund.</p>
<p>The key point of the paper is that static example attacks—single string prompts designed to bypass systems—are an almost useless way to evaluate these defenses. Adaptive attacks are far more powerful, as shown by this chart:</p>
<p><img src="https://static.simonwillison.net/static/2025/attack-success-rate.jpg" alt="Bar chart showing Attack Success Rate (%) for various security systems across four categories: Prompting, Training, Filtering Model, and Secret Knowledge. The chart compares three attack types shown in the legend: Static / weak attack (green hatched bars), Automated attack (ours) (orange bars), and Human red-teaming (ours) (purple dotted bars). Systems and their success rates are: Spotlighting (28% static, 99% automated), Prompt Sandwich (21% static, 95% automated), RPO (0% static, 99% automated), Circuit Breaker (8% static, 100% automated), StruQ (62% static, 100% automated), SeqAlign (5% static, 96% automated), ProtectAI (15% static, 90% automated), PromptGuard (26% static, 94% automated), PIGuard (0% static, 71% automated), Model Armor (0% static, 90% automated), Data Sentinel (0% static, 80% automated), MELON (0% static, 89% automated), and Human red-teaming setting (0% static, 100% human red-teaming)."/></p>
<p>The three automated adaptive attack techniques used by the paper are:</p>
<ul>
<li>
<strong>Gradient-based methods</strong>—these were the least effective, using the technique described in the legendary <a href="https://arxiv.org/abs/2307.15043">Universal and Transferable Adversarial Attacks on Aligned Language Models</a> paper <a href="https://simonwillison.net/2023/Jul/27/universal-and-transferable-attacks-on-aligned-language-models/">from 2023</a>.</li>
<li>
<strong>Reinforcement learning methods</strong>—particularly effective against black-box models: “we allowed the attacker model to interact directly with the defended system and observe its outputs”, using 32 sessions of 5 rounds each.</li>
<li>
<strong>Search-based methods</strong>—generate candidates with an LLM, then evaluate and further modify them using LLM-as-judge and other classifiers.</li>
</ul>
<p>The paper concludes somewhat optimistically:</p>
<blockquote>
<p>[...] Adaptive evaluations are therefore more challenging to perform,
making it all the more important that they are performed. We again urge defense authors to release simple, easy-to-prompt defenses that are amenable to human analysis. [...] Finally, we hope that our analysis here will increase the standard for defense evaluations, and in so doing, increase the likelihood that reliable jailbreak and prompt injection defenses will be developed.</p>
</blockquote>
<p>Given how totally the defenses were defeated, I do not share their optimism that reliable defenses will be developed any time soon.</p>
<p>As a review of how far we still have to go this paper packs a powerful punch. I think it makes a strong case for Meta’s Agents Rule of Two as the best practical advice for building secure LLM-powered agent systems today in the absence of prompt injection defenses we can rely on.</p>


</div>



</div></div>
  </body>
</html>
