<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/hugohadfield/kalmangrad">Original</a>
    <h1>Show HN: Automated smooth Nth order derivatives of noisy data</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><div dir="auto"><a id="user-content-kalmangrad" aria-label="Permalink: Kalmangrad" href="#kalmangrad"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>kalmangrad</code> is a python package that calculates automated smooth N&#39;th order derivatives of non-uniformly sampled time series data. The approach leverages Bayesian filtering techniques to compute derivatives up to any specified order, offering a robust alternative to traditional numerical differentiation methods that are sensitive to noise. This package is built on top of the underlying <a href="https://github.com/hugohadfield/bayesfilter/">bayesfilter</a> package.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://elijer.github.io/hugohadfield/kalmangrad/blob/main/Figure_1.jpeg"><img src="https://elijer.github.io/hugohadfield/kalmangrad/raw/main/Figure_1.jpeg" alt="Results"/></a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Table of Contents</h2><a id="user-content-table-of-contents" aria-label="Permalink: Table of Contents" href="#table-of-contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#functions-overview">Functions Overview</a></li>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#license">License</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Introduction</h2><a id="user-content-introduction" aria-label="Permalink: Introduction" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Estimating derivatives from noisy data is a common challenge in fields like signal processing, control systems, and data analysis. Traditional numerical differentiation amplifies noise, leading to inaccurate results. Anyone who has naiivly attempted to differentiate sensor data has run into this problem. This repository implements a bayesian filtering based method to estimate derivatives of any order, providing smoother and more accurate estimates even in the presence of noise and non-uniform sampling.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><strong>Higher-Order Derivative Estimation</strong>: Compute derivatives up to any specified order.</li>
<li><strong>Robust to Noise</strong>: Uses Bayesian filtering to mitigate the effects of noise in the data.</li>
<li><strong>Flexible Time Steps</strong>: Handles non-uniformly sampled data with automatic time step adjustment.</li>
<li><strong>Easy Integration</strong>: Its simple API allows for easy integration into existing projects.</li>
<li><strong>Few Dependencies</strong>: Requires only NumPy and the BayesFilter package (which is turn just needs NumPy).</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ol dir="auto">
<li>
<p dir="auto"><strong>Install from PyPI</strong>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="pip install kalmangrad"><pre>pip install kalmangrad</pre></div>
</li>
<li>
<p dir="auto"><strong>Install from Source</strong>:</p>
<ul dir="auto">
<li>
<p dir="auto">Clone the repository:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone"><pre>git clone</pre></div>
</li>
<li>
<p dir="auto">Install the package:</p>
</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="pip install ."><pre>pip install <span>.</span></pre></div>
</li>
</ol>
<div dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The main function provided is <code>grad</code>, which estimates the derivatives of the input data <code>y</code> sampled at times <code>t</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="def grad(
    y: np.ndarray, 
    t: np.ndarray, 
    n: int = 1,
    delta_t = None,
    obs_noise_std = 1e-2
) -&gt; Tuple[List[Gaussian], np.ndarray]:
    &#34;&#34;&#34;
    Estimates the derivatives of the input data y up to order n.

    Parameters:
    - y (np.ndarray): Observed data array.
    - t (np.ndarray): Time points corresponding to y.
    - n (int): Maximum order of derivative to estimate (default is 1).
    - delta_t (float, optional): Time step for the Kalman filter. If None, it&#39;s automatically determined.
    - obs_noise_std (float): Standard deviation of the observation noise (default is 1e-2).

    Returns:
    - smoother_states (List[Gaussian]): List of Gaussian states containing mean and covariance estimates.
    - filter_times (np.ndarray): Time points corresponding to the estimates.
    &#34;&#34;&#34;"><pre><span>def</span> <span>grad</span>(
    <span>y</span>: <span>np</span>.<span>ndarray</span>, 
    <span>t</span>: <span>np</span>.<span>ndarray</span>, 
    <span>n</span>: <span>int</span> <span>=</span> <span>1</span>,
    <span>delta_t</span> <span>=</span> <span>None</span>,
    <span>obs_noise_std</span> <span>=</span> <span>1e-2</span>
) <span>-&gt;</span> <span>Tuple</span>[<span>List</span>[<span>Gaussian</span>], <span>np</span>.<span>ndarray</span>]:
    <span>&#34;&#34;&#34;</span>
<span>    Estimates the derivatives of the input data y up to order n.</span>
<span></span>
<span>    Parameters:</span>
<span>    - y (np.ndarray): Observed data array.</span>
<span>    - t (np.ndarray): Time points corresponding to y.</span>
<span>    - n (int): Maximum order of derivative to estimate (default is 1).</span>
<span>    - delta_t (float, optional): Time step for the Kalman filter. If None, it&#39;s automatically determined.</span>
<span>    - obs_noise_std (float): Standard deviation of the observation noise (default is 1e-2).</span>
<span></span>
<span>    Returns:</span>
<span>    - smoother_states (List[Gaussian]): List of Gaussian states containing mean and covariance estimates.</span>
<span>    - filter_times (np.ndarray): Time points corresponding to the estimates.</span>
<span>    &#34;&#34;&#34;</span></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Example</h2><a id="user-content-example" aria-label="Permalink: Example" href="#example"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Below is an example demonstrating how to estimate the first and second derivatives of noisy sinusoidal data.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import numpy as np
import matplotlib.pyplot as plt

# Import the grad function
from kalmangrad import grad  # Replace with the actual module name

# Generate noisy sinusoidal data with random time points
np.random.seed(0)
t = sorted(np.random.uniform(0.0, 10.0, 100))
noise_std = 0.01
y = np.sin(t) + noise_std * np.random.randn(len(t))
true_first_derivative = np.cos(t)
true_second_derivative = -np.sin(t)

# Estimate derivatives using the Kalman filter
N = 2  # Order of the highest derivative to estimate
smoother_states, filter_times = grad(y, t, n=N)

# Extract estimated derivatives
estimated_position = [state.mean()[0] for state in smoother_states]
estimated_first_derivative = [state.mean()[1] for state in smoother_states]
estimated_second_derivative = [state.mean()[2] for state in smoother_states]

# Plot the results
plt.figure(figsize=(12, 9))

# Position
plt.subplot(3, 1, 1)
plt.plot(t, y, &#39;k.&#39;, label=&#39;Noisy Observations&#39;)
plt.plot(filter_times, estimated_position, &#39;b-&#39;, label=&#39;Estimated Position&#39;)
plt.plot(t, np.sin(t), &#39;r--&#39;, label=&#39;True Position&#39;)
plt.legend(loc=&#39;upper right&#39;)
plt.ylim(-1.5, 1.5)
plt.title(&#39;Position&#39;)

# First Derivative
plt.subplot(3, 1, 2)
plt.plot(filter_times, estimated_first_derivative, &#39;b-&#39;, label=&#39;Estimated First Derivative&#39;)
plt.plot(t, true_first_derivative, &#39;r--&#39;, label=&#39;True First Derivative&#39;)
plt.plot(
    t,
    np.gradient(y, t),
    &#39;k-&#39;,
    label=&#39;np.gradient calculated derivative&#39;
)
plt.legend(loc=&#39;upper right&#39;)
plt.ylim(-1.5, 1.5)
plt.title(&#39;First Derivative&#39;)

# Second Derivative
plt.subplot(3, 1, 3)
plt.plot(filter_times, estimated_second_derivative, &#39;b-&#39;, label=&#39;Estimated Second Derivative&#39;)
plt.plot(t, true_second_derivative, &#39;r--&#39;, label=&#39;True Second Derivative&#39;)
plt.legend(loc=&#39;upper right&#39;)
plt.ylim(-1.5, 1.5)
plt.title(&#39;Second Derivative&#39;)

plt.tight_layout()
plt.show()"><pre><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
<span>import</span> <span>matplotlib</span>.<span>pyplot</span> <span>as</span> <span>plt</span>

<span># Import the grad function</span>
<span>from</span> <span>kalmangrad</span> <span>import</span> <span>grad</span>  <span># Replace with the actual module name</span>

<span># Generate noisy sinusoidal data with random time points</span>
<span>np</span>.<span>random</span>.<span>seed</span>(<span>0</span>)
<span>t</span> <span>=</span> <span>sorted</span>(<span>np</span>.<span>random</span>.<span>uniform</span>(<span>0.0</span>, <span>10.0</span>, <span>100</span>))
<span>noise_std</span> <span>=</span> <span>0.01</span>
<span>y</span> <span>=</span> <span>np</span>.<span>sin</span>(<span>t</span>) <span>+</span> <span>noise_std</span> <span>*</span> <span>np</span>.<span>random</span>.<span>randn</span>(<span>len</span>(<span>t</span>))
<span>true_first_derivative</span> <span>=</span> <span>np</span>.<span>cos</span>(<span>t</span>)
<span>true_second_derivative</span> <span>=</span> <span>-</span><span>np</span>.<span>sin</span>(<span>t</span>)

<span># Estimate derivatives using the Kalman filter</span>
<span>N</span> <span>=</span> <span>2</span>  <span># Order of the highest derivative to estimate</span>
<span>smoother_states</span>, <span>filter_times</span> <span>=</span> <span>grad</span>(<span>y</span>, <span>t</span>, <span>n</span><span>=</span><span>N</span>)

<span># Extract estimated derivatives</span>
<span>estimated_position</span> <span>=</span> [<span>state</span>.<span>mean</span>()[<span>0</span>] <span>for</span> <span>state</span> <span>in</span> <span>smoother_states</span>]
<span>estimated_first_derivative</span> <span>=</span> [<span>state</span>.<span>mean</span>()[<span>1</span>] <span>for</span> <span>state</span> <span>in</span> <span>smoother_states</span>]
<span>estimated_second_derivative</span> <span>=</span> [<span>state</span>.<span>mean</span>()[<span>2</span>] <span>for</span> <span>state</span> <span>in</span> <span>smoother_states</span>]

<span># Plot the results</span>
<span>plt</span>.<span>figure</span>(<span>figsize</span><span>=</span>(<span>12</span>, <span>9</span>))

<span># Position</span>
<span>plt</span>.<span>subplot</span>(<span>3</span>, <span>1</span>, <span>1</span>)
<span>plt</span>.<span>plot</span>(<span>t</span>, <span>y</span>, <span>&#39;k.&#39;</span>, <span>label</span><span>=</span><span>&#39;Noisy Observations&#39;</span>)
<span>plt</span>.<span>plot</span>(<span>filter_times</span>, <span>estimated_position</span>, <span>&#39;b-&#39;</span>, <span>label</span><span>=</span><span>&#39;Estimated Position&#39;</span>)
<span>plt</span>.<span>plot</span>(<span>t</span>, <span>np</span>.<span>sin</span>(<span>t</span>), <span>&#39;r--&#39;</span>, <span>label</span><span>=</span><span>&#39;True Position&#39;</span>)
<span>plt</span>.<span>legend</span>(<span>loc</span><span>=</span><span>&#39;upper right&#39;</span>)
<span>plt</span>.<span>ylim</span>(<span>-</span><span>1.5</span>, <span>1.5</span>)
<span>plt</span>.<span>title</span>(<span>&#39;Position&#39;</span>)

<span># First Derivative</span>
<span>plt</span>.<span>subplot</span>(<span>3</span>, <span>1</span>, <span>2</span>)
<span>plt</span>.<span>plot</span>(<span>filter_times</span>, <span>estimated_first_derivative</span>, <span>&#39;b-&#39;</span>, <span>label</span><span>=</span><span>&#39;Estimated First Derivative&#39;</span>)
<span>plt</span>.<span>plot</span>(<span>t</span>, <span>true_first_derivative</span>, <span>&#39;r--&#39;</span>, <span>label</span><span>=</span><span>&#39;True First Derivative&#39;</span>)
<span>plt</span>.<span>plot</span>(
    <span>t</span>,
    <span>np</span>.<span>gradient</span>(<span>y</span>, <span>t</span>),
    <span>&#39;k-&#39;</span>,
    <span>label</span><span>=</span><span>&#39;np.gradient calculated derivative&#39;</span>
)
<span>plt</span>.<span>legend</span>(<span>loc</span><span>=</span><span>&#39;upper right&#39;</span>)
<span>plt</span>.<span>ylim</span>(<span>-</span><span>1.5</span>, <span>1.5</span>)
<span>plt</span>.<span>title</span>(<span>&#39;First Derivative&#39;</span>)

<span># Second Derivative</span>
<span>plt</span>.<span>subplot</span>(<span>3</span>, <span>1</span>, <span>3</span>)
<span>plt</span>.<span>plot</span>(<span>filter_times</span>, <span>estimated_second_derivative</span>, <span>&#39;b-&#39;</span>, <span>label</span><span>=</span><span>&#39;Estimated Second Derivative&#39;</span>)
<span>plt</span>.<span>plot</span>(<span>t</span>, <span>true_second_derivative</span>, <span>&#39;r--&#39;</span>, <span>label</span><span>=</span><span>&#39;True Second Derivative&#39;</span>)
<span>plt</span>.<span>legend</span>(<span>loc</span><span>=</span><span>&#39;upper right&#39;</span>)
<span>plt</span>.<span>ylim</span>(<span>-</span><span>1.5</span>, <span>1.5</span>)
<span>plt</span>.<span>title</span>(<span>&#39;Second Derivative&#39;</span>)

<span>plt</span>.<span>tight_layout</span>()
<span>plt</span>.<span>show</span>()</pre></div>
<p dir="auto"><strong>Explanation:</strong></p>
<ul dir="auto">
<li><strong>Data Generation</strong>: We generate noisy observations of a sine wave.</li>
<li><strong>Derivative Estimation</strong>: The <code>grad</code> function is called with <code>n=2</code> to estimate up to the second derivative.</li>
<li><strong>Result Extraction</strong>: The mean estimates for position and derivatives are extracted from the Gaussian states.</li>
<li><strong>Visualization</strong>: The true functions and the estimates are plotted for comparison.</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Functions Overview</h2><a id="user-content-functions-overview" aria-label="Permalink: Functions Overview" href="#functions-overview"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>transition_func(y, delta_t, n)</code></h3><a id="user-content-transition_funcy-delta_t-n" aria-label="Permalink: transition_func(y, delta_t, n)" href="#transition_funcy-delta_t-n"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Computes the new state vector at time <code>t + delta_t</code> given the current state vector <code>y</code> at time <code>t</code>, for a Kalman filter of order <code>n</code>.</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Parameters</strong>:</p>
<ul dir="auto">
<li><code>y (np.ndarray)</code>: Current state vector <code>[y, y&#39;, y&#39;&#39;, ..., y^(n)]^T</code>.</li>
<li><code>delta_t (float)</code>: Time step.</li>
<li><code>n (int)</code>: Order of the derivative.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Returns</strong>:</p>
<ul dir="auto">
<li><code>new_y (np.ndarray)</code>: Updated state vector at time <code>t + delta_t</code>.</li>
</ul>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>transition_matrix(delta_t, n)</code></h3><a id="user-content-transition_matrixdelta_t-n" aria-label="Permalink: transition_matrix(delta_t, n)" href="#transition_matrixdelta_t-n"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Returns the state transition matrix <code>A</code> for a Kalman filter of order <code>n</code>.</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Parameters</strong>:</p>
<ul dir="auto">
<li><code>delta_t (float)</code>: Time step.</li>
<li><code>n (int)</code>: Order of the derivative.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Returns</strong>:</p>
<ul dir="auto">
<li><code>A (np.ndarray)</code>: Transition matrix of size <code>(n+1, n+1)</code>.</li>
</ul>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>observation_func(state)</code></h3><a id="user-content-observation_funcstate" aria-label="Permalink: observation_func(state)" href="#observation_funcstate"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Extracts the observation from the state vector. Currently, it observes only the first element (position).</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Parameters</strong>:</p>
<ul dir="auto">
<li><code>state (np.ndarray)</code>: State vector.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Returns</strong>:</p>
<ul dir="auto">
<li><code>np.ndarray</code>: Observation vector.</li>
</ul>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>jac_observation_func(state)</code></h3><a id="user-content-jac_observation_funcstate" aria-label="Permalink: jac_observation_func(state)" href="#jac_observation_funcstate"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Computes the Jacobian of the observation function with respect to the state vector.</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Parameters</strong>:</p>
<ul dir="auto">
<li><code>state (np.ndarray)</code>: State vector.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Returns</strong>:</p>
<ul dir="auto">
<li><code>np.ndarray</code>: Jacobian matrix of size <code>(1, n+1)</code>.</li>
</ul>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto"><code>grad(y, t, n=1, delta_t=None, obs_noise_std=1e-2)</code></h3><a id="user-content-grady-t-n1-delta_tnone-obs_noise_std1e-2" aria-label="Permalink: grad(y, t, n=1, delta_t=None, obs_noise_std=1e-2)" href="#grady-t-n1-delta_tnone-obs_noise_std1e-2"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Main function to estimate the derivatives of the input data <code>y</code> up to order <code>n</code>.</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Parameters</strong>:</p>
<ul dir="auto">
<li><code>y (np.ndarray)</code>: Observed data array.</li>
<li><code>t (np.ndarray)</code>: Time points corresponding to <code>y</code>.</li>
<li><code>n (int)</code>: Maximum order of derivative to estimate (default is <code>1</code>).</li>
<li><code>delta_t (float, optional)</code>: Time step for the Kalman filter. If <code>None</code>, it is automatically determined.</li>
<li><code>obs_noise_std (float)</code>: Standard deviation of the observation noise.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Returns</strong>:</p>
<ul dir="auto">
<li><code>smoother_states (List[Gaussian])</code>: List of Gaussian states containing mean and covariance estimates for each time step.</li>
<li><code>filter_times (np.ndarray)</code>: Time points corresponding to the estimates.</li>
</ul>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Dependencies</h2><a id="user-content-dependencies" aria-label="Permalink: Dependencies" href="#dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><strong>Python 3.x</strong></p>
</li>
<li>
<p dir="auto"><strong>NumPy</strong>: For numerical computations.</p>
</li>
<li>
<p dir="auto"><strong>Matplotlib</strong>: For plotting results.</p>
</li>
<li>
<p dir="auto"><strong>BayesFilter</strong>: For Bayesian filtering and smoothing.</p>
<p dir="auto">Install via:</p>
<div dir="auto" data-snippet-clipboard-copy-content="pip install numpy matplotlib bayesfilter"><pre>pip install numpy matplotlib bayesfilter</pre></div>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This project is licensed under the MIT License - see the <a href="https://elijer.github.io/hugohadfield/kalmangrad/blob/main/license.txt">LICENSE</a> file for details.</p>
<hr/>
<p dir="auto"><strong>Disclaimer</strong>: This code is provided as-is without any guarantees. Please test and validate the code in your specific context.</p>
</article></div></div>
  </body>
</html>
