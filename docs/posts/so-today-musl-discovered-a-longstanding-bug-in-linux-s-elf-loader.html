<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/RichFelker/status/1588592850715172865">Original</a>
    <h1>So today musl discovered a longstanding bug in Linux&#39;s ELF loader</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-14492" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588592850715172865" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:03:44.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:03:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__aaiyxwrcf3r id__4ag66h9fr0w id__01obukk8g4nv id__4dbubv6himw id__u6b5sbbkh2 id__rym68f95ok id__37lgan3m4xt id__c5bj9jxqbk id__1sx9ph97f7z id__cxfdxrtreif id__bmsgwpikrip id__9bnm7hfi4w id__jwhyomax12m id__5eyvezba6wp id__83gigheeixu id__qataczbpgds id__80kyob3engs id__mtu3nd8wgx id__royhtuqrjyf" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>So today </span><span><a dir="ltr" href="https://twitter.com/hashtag/musl?src=hashtag_click" role="link">#musl</a></span><span> discovered a longstanding </span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span> bug in Linux&#39;s ELF loader...</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593238537277442" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:05:17.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:05:17.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__gv38aoh9hgr id__hir415b8p6m id__s1az1uau5o id__r4xwo3k1rn id__23atbi1hu44 id__s2snnxpt4rf id__0qfxapczt8nb id__l2cyjt2ckg8 id__geslwlp0pae id__9szx8y50ji7 id__hs2ylesu249 id__8so8g1d63sb id__ew5sqi2x8a id__4n0ftnznzrn id__sgve4bxazfs id__ak42jzkieht id__lu1x8tfekb8 id__723ylxi6mhl id__do86bav6nn" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For whatever reason, Linux has two copies of the ELF loading code in binfmt_elf.c, one for the main program and the other for the &#34;program interpreter&#34; (dynamic linker). The former handles BSS right but the latter doesn&#39;t.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593792491585537" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:07:29.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:07:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="isPartOf"/><div><article aria-labelledby="id__p44l3gycad id__es74rsylgei id__y8yjxl66bsg id__6bnxsi90vwl id__2un9irde4ic id__jeseo1w1ecf id__s94mxdm9k3c id__hr4uytg8ij id__qjwzizzm16 id__9m59ao7g9dd id__y4tir0xcn9l id__xb7n1ujgr8 id__do6jamrpmi id__6jmgkk26ct7 id__mg77mdd95s id__q5ql9dobjo id__4bg59wrvvhz id__ubazveoqae8 id__u8cfzaie4yf" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>ELF program LOAD segments can have p_memsz&gt;p_filesz, representing a mapping larger in memory than in the image on disk, with the remainder zero-filled (mapping zero paged if needed).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594154468442112" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:08:55.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:08:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="isPartOf"/><div><article aria-labelledby="id__91jp5gdj6s8 id__vwj6ko8xbzj id__9p2uqii1ama id__9tf2d6appqo id__3tlx44z5008 id__cuq1hdj58ys id__ftvk7u7xirw id__nthxjwlerk id__uz5zocokupr id__hzt3w5i5qm id__g4ablgnos9a id__0rqantidvv5b id__wnelexp37hl id__cc6mkapr2re id__kgma1edng7l id__qigsj0nt5te id__hid5c9gfffl id__7lqfwvf7dcn id__ox9vhv0mjde" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For the main program, Linux handles this fine. But for the interpreter, it only maps p_filesz, not p_memsz. Then, at the very end, it goes back and performs one additional mapping for the remaining &#34;bss&#34; if needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594423964655616" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:09:59.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:09:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="isPartOf"/><div><article aria-labelledby="id__kq397itv4c id__u4xygc9wm18 id__11ktd545hnme id__0iocdcz1t4jb id__fn0zs5bxuyd id__7vu3bbyolxt id__nf59gx3m02 id__zelnnzp5qm id__ixljcx629ak id__t8ys24blf3 id__98wgs1j9u7k id__jo74qaxxt4b id__lclq00uaprg id__1kq0c4psldg id__j1ybzirp0z id__7yb2yirdzwt id__2lqqkguopx id__8dm94c3j0yg id__mevoni84a9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This happens to work if there&#39;s only one data segment mapping that utilizes p_memsz&gt;p_filesz, or if where the page boundaries fall make it so that no additional mapping is needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594802077364224" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:11:30.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:11:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="isPartOf"/><div><article aria-labelledby="id__533m7lnp6o id__p9hnr9aauwd id__5elorgsqucd id__6cwxcta76ps id__thkok4j9t6o id__s3hqyahrtg id__t4gp80njjx id__gpwz1kn9scd id__pghz74rcy4o id__k992696asg id__cxsgy943kaq id__740j1jp1lac id__0llmelgbu48 id__rivj3o0wqyr id__x42xwswayne id__8r46m1y6m6y id__eq58cxtqe7 id__r8jn2nipds id__j96macfi7g" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Unfortunately, lld wants to make multiple LOAD segments with data, one for the GOT and related machinery, and the other for actual program data. In this case, the kernel just doesn&#39;t map enough memory for the GOT, and process crashes (in ldso) on entry. </span><span>ðŸ¤¦</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595274255314944" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:13:22.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:13:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="isPartOf"/><div><article aria-labelledby="id__y23yspq1ljq id__dqpsiu5uog7 id__64by6b0tojr id__qzvit13kv8 id__qn5402mian id__6w2jcluk3qs id__4sbf1ok7wie id__s5evcyu3sip id__kz6whrfknmj id__ac4oq1sbrfo id__cav7jc5qdal id__h9c4blp2cq id__0x8em4sawpy id__sj4g2hgbru id__925421p2wt id__dz3mg11hgj8 id__l85zv0i20f id__95q7qcwpxbj id__xijfcowkoln" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I think Linux may also be failing to do the right zero-fill (leaving junk mapped from disk present) even when it&#39;s not crossing a page boundary. Depending on what the linker did (e.g. if it put data segment before GOT seg rather than after), this could cause severe malfunctions.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595644414849025" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:14:50.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:14:50.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595644414849025" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="isPartOf"/><div><article aria-labelledby="id__ej50yga8by8 id__y8h4wtbd7gf id__37bazlh8wgr id__4kjuaaa2wty id__to774rq4c5 id__vxnju8j0ce id__hy4jmuaatnn id__wu6bko7gez7 id__m1gxqendqug id__r2orzucgv4s id__1ta00rzydre id__93spgmrpeod id__5oznv1c8547 id__j3wxspi2a5s id__oxj4rt8li9m id__8un3fcupmp6 id__tllxxnfyxc id__hz4860tsvoc id__kr7fv3p33z7" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel has apparently always had this brokenness, and kernels in the wild will have it for decades to come. So does lld need to stop generating such output? Or should ldso do some workaround on itself in case it was linked this way?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588621141375356929" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T19:56:09.000Z" itemprop="dateCreated"/><meta content="2022-11-04T19:56:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__21urpgyt6ld id__l2rneebbkvs id__rziy8g68898 id__jra0an6bnxb id__pogcp4wv0dl id__g833m53umij id__3pmlr43i0ox id__tfcmo9ni02r id__eyvg3n2wgzu id__n0484krnw9 id__ntexik4cif id__yg2ildhrli id__6o041ej4i1w id__ix8zoxsptx9 id__g0jme1mgiva id__bbtdi0gwzbh id__73898gwlyd4 id__80bx0uu9k5u id__jja1pi3ai7" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-DrLukeKA"><div><div><div><div><a href="https://twitter.com/DrLukeKA" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1484261468019253253/5yLpzuZu_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Time for the rust rewrite</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588662667614380032" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T22:41:10.000Z" itemprop="dateCreated"/><meta content="2022-11-04T22:41:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Midar3/status/1588662667614380032" itemprop="url"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="isPartOf"/><div><article aria-labelledby="id__x3ly400z0aq id__epncdavjho id__m5ff0cg17w8 id__204auo4bklo id__4gepaisedvc id__78x2mjnp33 id__1j1nax835u9 id__t3menr6oyuf id__74v573mg82n id__9v6ojf4568 id__cs9r17sbqp id__c2bkodwwqcb id__dsp5hy0o4p id__wixrn0lzjw id__hj5erws3u45 id__1w2a2ttu6up id__919cpri479q id__8wfjpo2t01i id__6dmhjd0l8z" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Midar3"><div><div><div><div><a href="https://twitter.com/Midar3" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1034913376835719177/MZpQsU8T_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To have even more logic bugs (which is what this is)? Rewriting software for no reason that has been used for decades usually doesn&#39;t make it less buggy, you know?</span></p></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
