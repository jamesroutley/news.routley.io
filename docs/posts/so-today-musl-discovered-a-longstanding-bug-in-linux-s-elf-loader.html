<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/RichFelker/status/1588592850715172865">Original</a>
    <h1>So today musl discovered a longstanding bug in Linux&#39;s ELF loader</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-37548" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588592850715172865" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:03:44.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:03:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__iilocjnw05a id__13tgvmsvtlps id__b5x44l5ew9c id__ne250bxyu6 id__7mm313vghvy id__odwczzoj28k id__1ih5p6yf3k7 id__z4dvrvdulw id__ghw7rfqna6v id__lw2m68b11g id__p3fsar9u7nd id__uwiieo7og6 id__i907scnbjr id__hhcoqh1trp id__h7bd4mq8a6r id__5gar9o5hpap id__rkop5exqjxm id__2vxwy6od3an id__z4y1s1kizg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>So today </span><span><a dir="ltr" href="https://twitter.com/hashtag/musl?src=hashtag_click" role="link">#musl</a></span><span> discovered a longstanding </span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span> bug in Linux&#39;s ELF loader...</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593238537277442" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:05:17.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:05:17.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__mj6pbrjcok id__un3dkemcs8n id__2wwlsy60i23 id__jlump0qjp0e id__ikohd9stqnr id__ct76fnyiel id__5l967xcerg id__1ltafdewyeh id__0nsl75jxfy0d id__3pzfxd60nih id__3gifc3nbnmg id__t2dc23hzxs8 id__7zzlcvkwzrn id__w2clja1en1 id__wnufdw1l5li id__2dme6hzxxvs id__0e5ijybzxmd6 id__lfotpseqeyh id__1w5wtumyt4wi" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For whatever reason, Linux has two copies of the ELF loading code in binfmt_elf.c, one for the main program and the other for the &#34;program interpreter&#34; (dynamic linker). The former handles BSS right but the latter doesn&#39;t.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593792491585537" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:07:29.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:07:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="isPartOf"/><div><article aria-labelledby="id__xgcx57mae6 id__pf1gm10bat id__an2c3rcjusw id__6eaoliux5mf id__pse3c07k237 id__jq5iw4cbzy8 id__1em74po2if3 id__ivsamczzl3l id__dwh8gu5he0t id__rk4fqh9heds id__dise8un64sh id__0imcfc9b91aq id__8e8a8l29ycu id__1xlt0gv1pdd id__lscbgudi4ho id__uzneme6e75k id__2g6fwt8jtuk id__kc7ypqcnkqb id__joey7nypktr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>ELF program LOAD segments can have p_memsz&gt;p_filesz, representing a mapping larger in memory than in the image on disk, with the remainder zero-filled (mapping zero paged if needed).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594154468442112" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:08:55.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:08:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="isPartOf"/><div><article aria-labelledby="id__f8tpytuwd46 id__42ur8hhdunj id__4w9rc1myfxf id__v7cycyeltq id__rlpuf0ii7a id__sfwa0qfrn1 id__l8i7gr9c9vk id__uaw3uwo0gw id__ajulea9ct8o id__0zmxl11cmww id__bav63045ybj id__ogxpcviq0ki id__agsnfp2xyo5 id__mlco51urhda id__khqcs228wz id__14w5ovaegy8 id__pnohy1mc2q id__ep15rrqnqxe id__zldroj2xk1s" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For the main program, Linux handles this fine. But for the interpreter, it only maps p_filesz, not p_memsz. Then, at the very end, it goes back and performs one additional mapping for the remaining &#34;bss&#34; if needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594423964655616" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:09:59.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:09:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="isPartOf"/><div><article aria-labelledby="id__14dj5uq411l id__gjfldu2t6a id__81l5h1uyv9a id__sc5ls5q1o0c id__2t2eva04kv5 id__dr1u1uuj7f id__7gi4tl8bzgo id__qdg10h1quk id__1noxhkjgkx3 id__bt6fbkxz9e7 id__lt13y77bfo id__fodfciozn9b id__fmwra17sf6f id__23igovu8qko id__b8sx7fnbz6h id__j7bh5xgc8u id__pyj4hmytwrb id__td4jqu65cf id__knxv0izfr0q" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This happens to work if there&#39;s only one data segment mapping that utilizes p_memsz&gt;p_filesz, or if where the page boundaries fall make it so that no additional mapping is needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594802077364224" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:11:30.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:11:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="isPartOf"/><div><article aria-labelledby="id__tz8elfdp9ym id__7mjfsy5wbh id__sy9kz7uspvq id__eabcd25y7ql id__keu6eodnyg id__sn8oqeofkys id__css761ccesl id__gyxbqnqy9lb id__x7b2fxwrmr id__xes2qyj2at id__psiycut3g8 id__duv629d6qr9 id__c5s10vbo7ta id__f4gu99j0nsr id__n19h5tzw43b id__kvr0gea9nvs id__benxpl9w0i8 id__j9s667qz2pm id__qhnr87e7w2l" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Unfortunately, lld wants to make multiple LOAD segments with data, one for the GOT and related machinery, and the other for actual program data. In this case, the kernel just doesn&#39;t map enough memory for the GOT, and process crashes (in ldso) on entry. </span><span>ðŸ¤¦</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595274255314944" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:13:22.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:13:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="isPartOf"/><div><article aria-labelledby="id__0p0g2s3l4d4 id__us3v46b3yw id__h0x3q9jwmw8 id__vkm176q6yz id__rywt48ex8w id__ndardq7w3na id__ijgdri1682 id__vax3iwh0k6i id__1amianeuqfmh id__oseb4n371b id__dril5lf7gh id__28y0zw4weil id__pyqnatajpw id__vngunk8ef4c id__y1lvl6opzho id__65m650mtz1f id__u7wcu1p17h id__memw6x8wjlp id__f9kyjzm9jfw" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I think Linux may also be failing to do the right zero-fill (leaving junk mapped from disk present) even when it&#39;s not crossing a page boundary. Depending on what the linker did (e.g. if it put data segment before GOT seg rather than after), this could cause severe malfunctions.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595644414849025" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:14:50.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:14:50.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595644414849025" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="isPartOf"/><div><article aria-labelledby="id__a3nvm7oibw id__j7sugl32nka id__p38q6qc00lo id__dgz6qh97gkc id__taowysvhcom id__cublnebttsd id__m57lenp8em8 id__y1w9bd4dc3g id__5ey8o6wwmqd id__la74fwwy8br id__d0hx02eo2pc id__vzxldrmd43c id__xhq2movlglj id__5m74d5oaro id__oaw8ay218n id__87dz5wo2pyi id__m0yst11sbm9 id__l8qn2b82e8l id__9bj4zgo9qup" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel has apparently always had this brokenness, and kernels in the wild will have it for decades to come. So does lld need to stop generating such output? Or should ldso do some workaround on itself in case it was linked this way?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588621141375356929" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T19:56:09.000Z" itemprop="dateCreated"/><meta content="2022-11-04T19:56:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__lcn24mqxocd id__4euri899067 id__ynyjbg3p04 id__lexf4g7k71 id__nq9fkh1riqp id__f0qnhpghoor id__1s4mw0c0e4w id__e33in2d07at id__70v0lrws41r id__n2rbku5t2ke id__m2finq3h85 id__1ycbp0xgc28j id__2h6p3kngvzq id__62obflr8q9 id__59lnjg4ycua id__zlye7aiacg id__6qwrjqc80hx id__gq8fzwzmgi9 id__4l2hr7819io" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-DrLukeKA"><div><div><div><div><a href="https://twitter.com/DrLukeKA" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1484261468019253253/5yLpzuZu_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Time for the rust rewrite</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588662667614380032" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T22:41:10.000Z" itemprop="dateCreated"/><meta content="2022-11-04T22:41:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Midar3/status/1588662667614380032" itemprop="url"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="isPartOf"/><div><article aria-labelledby="id__djh3l81s867 id__eb33ecmwnu9 id__i0j7sxvleo8 id__7x0b3r55a7 id__q2wnxk34dfq id__n5xyo4fbqti id__25mtx80gy4mh id__cn8qqs25cp5 id__1fjgvkrvq2z id__mqjhtao92v id__vuslr0k4zki id__fqibe8uetrr id__whqn2i97i3m id__3l2adt68c7b id__utsoo8ohf9 id__7a56uws2b4w id__8a5tbuicxua id__58uumyyy45i id__vx9hgntmndc" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Midar3"><div><div><div><div><a href="https://twitter.com/Midar3" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1034913376835719177/MZpQsU8T_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To have even more logic bugs (which is what this is)? Rewriting software for no reason that has been used for decades usually doesn&#39;t make it less buggy, you know?</span></p></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
