<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/RichFelker/status/1588592850715172865">Original</a>
    <h1>So today musl discovered a longstanding bug in Linux&#39;s ELF loader</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-8947" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588592850715172865" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:03:44.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:03:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__5in8c8h7eze id__g0frubcf9tw id__4eho3duyyhn id__17280q7bvrki id__w3m1he8ljd id__965ti3ngle6 id__hg8u6xmnhlo id__3if92brk1d7 id__rxhn9tii6x id__uw6gtc70ga id__9zb1en9x8r7 id__f79tf371asc id__panz5zlhf8n id__p04hxaln9cr id__qsq56hml59h id__xgelcqir89n id__927dkby12oc id__ktf7dfsdxh id__pc0im438hv" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>So today </span><span><a dir="ltr" href="https://twitter.com/hashtag/musl?src=hashtag_click" role="link">#musl</a></span><span> discovered a longstanding </span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span> bug in Linux&#39;s ELF loader...</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593238537277442" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:05:17.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:05:17.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__infah8823hh id__56t5agivhgj id__elj5cylxlzp id__p6s8cfc7pdc id__tt3tzcumgv id__7jfbhma9ne id__lidcgv5v9jq id__u56mxs382ep id__le5fmgf6cxr id__s17ivbjval id__2o6ni3zj88q id__i4yl4rgoeym id__5s5fm9icffp id__tqc8oxljpws id__tqwcudjh9ni id__qt258r6920e id__f3bg1yx059u id__7f9jb525zdk id__0sz1qsugclr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For whatever reason, Linux has two copies of the ELF loading code in binfmt_elf.c, one for the main program and the other for the &#34;program interpreter&#34; (dynamic linker). The former handles BSS right but the latter doesn&#39;t.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593792491585537" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:07:29.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:07:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="isPartOf"/><div><article aria-labelledby="id__tg8fesddxa id__62fefea43nn id__g8ig709hxhs id__tqyg1e7441 id__7vz6lvldbzc id__0gkvcr1d9myg id__gy1ngwfv99f id__fnahut3sseq id__1bfyp1jcg2ri id__yuwnxzy6b6f id__v40qqn92hgg id__90kftoqt4l id__tahlsb4ma6h id__onh446b0pg id__0wy24nbuq1jj id__sqfds94etc id__jkwwbrw67fb id__qzbyuaingjn id__53xofr2u61h" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>ELF program LOAD segments can have p_memsz&gt;p_filesz, representing a mapping larger in memory than in the image on disk, with the remainder zero-filled (mapping zero paged if needed).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594154468442112" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:08:55.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:08:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="isPartOf"/><div><article aria-labelledby="id__4frmwq3pl9x id__da1huj8qbn id__bfhm713iwf id__un5vl05r48 id__w1jf77l7z1r id__n4y5i61537s id__scifbd4by1o id__av3hne4ef78 id__uc47qr9lr6 id__ujk56d4y8lc id__a5ajbw2g9bm id__5w3io73g3ih id__agn2wnycjg7 id__e208pb7zj59 id__ygqpl0jtxzo id__3xhxqdqk2yh id__h3gnredazi7 id__wxg1hw42q9q id__9xo1btdeytg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For the main program, Linux handles this fine. But for the interpreter, it only maps p_filesz, not p_memsz. Then, at the very end, it goes back and performs one additional mapping for the remaining &#34;bss&#34; if needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594423964655616" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:09:59.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:09:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="isPartOf"/><div><article aria-labelledby="id__ihu7kvzg6ja id__jmy3tulqfbl id__jnb21vfyozh id__b46j662h5v9 id__xuvx5y71izj id__z8qdzy86pmc id__k5tmeeoiubq id__rr1782l5ymi id__mzen4hgbk6l id__7eyo9we744 id__05jtjl5s2wbd id__coc9rhaysgv id__etav3y9bcc id__j3ji50smryf id__kqamlsbnou id__2xtvs8ow1fv id__qvb3mp4be3 id__d2qy5vdbqmd id__7elac3rsk8b" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This happens to work if there&#39;s only one data segment mapping that utilizes p_memsz&gt;p_filesz, or if where the page boundaries fall make it so that no additional mapping is needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594802077364224" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:11:30.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:11:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="isPartOf"/><div><article aria-labelledby="id__g1jtck842qn id__fj9aurj3rif id__q7kpafb0dl id__z3i9i65dv9 id__xyd19i1zu0e id__s9xyivm8iz id__y9z6idgqkv id__4j491ad5anb id__npcjtrx71wk id__fsfb61jykvq id__ufsnorfu36 id__rywk78t1awl id__jcniu47s4tb id__1xm9ct7jiub id__7n9rvgcwahy id__i7umhdl3kya id__96yqrpix21h id__356o2y2lkjn id__h16hqxwl8ae" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Unfortunately, lld wants to make multiple LOAD segments with data, one for the GOT and related machinery, and the other for actual program data. In this case, the kernel just doesn&#39;t map enough memory for the GOT, and process crashes (in ldso) on entry. </span><span>ðŸ¤¦</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595274255314944" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:13:22.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:13:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="isPartOf"/><div><article aria-labelledby="id__lyy43e3qmqh id__em8hiy1uqc id__thtvm26zqyo id__9khett67zau id__26at9baiom3 id__y36e9xtpaw id__ni4n1tw17n id__j6bwlrwqbjl id__27j38l9awujj id__e7ql5abzxqk id__epssi0zajns id__f5k3hlhla1f id__b7585d9bdau id__mdptitflme id__1rngajeafb1 id__oj107uvfx5p id__n5nd9t35g8 id__90ooyugqwkd id__tjvotkse3g" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I think Linux may also be failing to do the right zero-fill (leaving junk mapped from disk present) even when it&#39;s not crossing a page boundary. Depending on what the linker did (e.g. if it put data segment before GOT seg rather than after), this could cause severe malfunctions.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595644414849025" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:14:50.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:14:50.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595644414849025" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="isPartOf"/><div><article aria-labelledby="id__11r7lbb2z8i id__bb8zz1w4c8p id__xxrx5u911db id__jkuxweo94ae id__tra7fho869 id__xv18i42og1 id__28nyhgadiwb id__2wpt5wpldet id__jo7234okt4b id__fu6025k6o08 id__w74a0h04jto id__8dnox3o8z1u id__2xywjf7x8vv id__bve448jc65u id__vqrl2fcwshe id__cptqkkhkogj id__aoahoavxb9t id__7zivsjqyphn id__06asnmxnipke" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel has apparently always had this brokenness, and kernels in the wild will have it for decades to come. So does lld need to stop generating such output? Or should ldso do some workaround on itself in case it was linked this way?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588621141375356929" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T19:56:09.000Z" itemprop="dateCreated"/><meta content="2022-11-04T19:56:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__mucodcqotd id__xntbpqw4t0f id__940cqh7e3im id__elgfrp0mthe id__jeeoj2u5enn id__i2nfnd9gexb id__mltk88xqxlo id__9qxza1xibtf id__iczbp3i49kl id__vogzztxpw49 id__cvavruu7wgc id__l4yar3gwbm id__zryzgau2i8q id__od4km00oyfq id__1ily06iq6hd id__30w5jba5u54 id__meg1v9nni7 id__nm8nmcsbglp id__b09x2146qqp" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-DrLukeKA"><div><div><div><div><a href="https://twitter.com/DrLukeKA" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1484261468019253253/5yLpzuZu_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Time for the rust rewrite</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588662667614380032" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T22:41:10.000Z" itemprop="dateCreated"/><meta content="2022-11-04T22:41:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Midar3/status/1588662667614380032" itemprop="url"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="isPartOf"/><div><article aria-labelledby="id__nwtqbo2boo id__3h980taoqsp id__2uwtmyr6tur id__f0z7lhx32e id__q28jgluy3sj id__1x8wi122wzd id__sgpjzwrvzw9 id__s5m2v1x964g id__3bue1izxk18 id__zcimbyoou9e id__k8qarx0ewh id__3wch6859qun id__8ph0jmbm06q id__ubbzzvg5sti id__kk86visono id__dt8fki6iavr id__2m56yztcz0b id__l75bh9mx5bo id__ttqvik0icp" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Midar3"><div><div><div><div><a href="https://twitter.com/Midar3" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1034913376835719177/MZpQsU8T_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To have even more logic bugs (which is what this is)? Rewriting software for no reason that has been used for decades usually doesn&#39;t make it less buggy, you know?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588871831897124864" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-05T12:32:19.000Z" itemprop="dateCreated"/><meta content="2022-11-05T12:32:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/defendtheworld/status/1588871831897124864" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__khy557f46c id__2rxzc3hvt6m id__nck42hify8s id__ik880n7y55 id__kboraco64n id__g50b3b4ex15 id__0y6ciw6jsma id__30l1d03nyh4 id__jsfqfqehzif id__y7idtm1y4m id__n7qopimemuj id__qe8ia6jbab id__b8jb24gwdwh id__oa92hqsgj3 id__q2dzlya34k id__d2zg7e9yol id__tvovq8t9npo id__h0cb5v1pc6v id__f1sovy4ekp" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-defendtheworld"><div><div><div><div><a href="https://twitter.com/defendtheworld" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1182779768346800128/YK8PgHI0_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
