<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/RichFelker/status/1588592850715172865">Original</a>
    <h1>So today musl discovered a longstanding bug in Linux&#39;s ELF loader</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-3922" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588592850715172865" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:03:44.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:03:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__pa6ojyxelrc id__1tmi74sqs6q id__90723s1zmtj id__ui3dpnxfxyh id__qugm0dz9l5l id__hjhze1crzrb id__g3og4digzd9 id__uchnpc9atb id__rxkgnx3d2v id__yrktx9wmqk id__x16dfge4egd id__vxlg39nf8cd id__tm00194w43 id__l41xl8dpqw id__9uvzgobozvw id__9oye57lnysu id__62p2aod9bck id__v4j4x8m2af id__ank58th6vhq" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>So today </span><span><a dir="ltr" href="https://twitter.com/hashtag/musl?src=hashtag_click" role="link">#musl</a></span><span> discovered a longstanding </span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span> bug in Linux&#39;s ELF loader...</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593238537277442" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:05:17.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:05:17.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__bbz493hdy7s id__s26ay32ach id__k7oq6uw6mi id__4elxx1cna4n id__iein9b7jkcc id__1enod50k6wz id__zgmx61ffimi id__xj0lxlv3bvn id__yp0ppllv3i id__85ipdrsh0oi id__y34dmvp3x2 id__6l17jstha9c id__h0in1fidr17 id__9vwds1ufvyk id__k6tsogtyd8s id__beqznue83x id__19sp5w9oo9m id__z803ps4qmx id__3l4wf1rfgh2" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For whatever reason, Linux has two copies of the ELF loading code in binfmt_elf.c, one for the main program and the other for the &#34;program interpreter&#34; (dynamic linker). The former handles BSS right but the latter doesn&#39;t.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593792491585537" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:07:29.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:07:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="isPartOf"/><div><article aria-labelledby="id__v3rwiujgrbj id__vunw9fh70c id__5skcl1em6mv id__esq808syqh id__5m308hlckld id__341xteqxgv2 id__7srtjfr4f8j id__usodegsw6k9 id__qw3y9hjyla id__0d3he3lqcfra id__nb7gx6g23q id__zsflpi8ijz id__wr0ztpfcj4o id__lbqvgcsi63 id__k9081mxf1q id__5ud1r33amgl id__nqlcun81qt id__poa8la75m2p id__wwhvpvt53fd" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>ELF program LOAD segments can have p_memsz&gt;p_filesz, representing a mapping larger in memory than in the image on disk, with the remainder zero-filled (mapping zero paged if needed).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594154468442112" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:08:55.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:08:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="isPartOf"/><div><article aria-labelledby="id__k4fljtd28w8 id__6xkbhkjkdya id__e4xc4q42gc id__1jwpv4p4wbf id__xgeiu3os8me id__aluvv6fca2q id__7r137fgmnz3 id__r9dp01np6i id__zrlyfndxv7 id__psixgjusr3o id__99lq6e5a9y9 id__s8k9afkn46h id__18tjtsl14an id__mnxj9diqfx id__fj6baon1qof id__h7cjz2lap66 id__7pccsi5ndni id__eioljw4dxzg id__jb1tdgirxzm" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For the main program, Linux handles this fine. But for the interpreter, it only maps p_filesz, not p_memsz. Then, at the very end, it goes back and performs one additional mapping for the remaining &#34;bss&#34; if needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594423964655616" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:09:59.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:09:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="isPartOf"/><div><article aria-labelledby="id__hfgt7ndv7am id__3llkr7qasiv id__3cxsi81s6pi id__g3l337150p7 id__ng4vhx4jtfk id__b0u9swfyo4c id__gfc7jllyhaa id__vrq2i84cmul id__g09xun0azs id__imclndlfwoa id__waajklw7tbf id__yuj9b1rvzf id__ihrvszpou98 id__x6p5j46pd3d id__sou9dbgscc id__tojcypzwstj id__zecfdx0v59d id__ofj9js6k2of id__iyui4s7gkk8" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This happens to work if there&#39;s only one data segment mapping that utilizes p_memsz&gt;p_filesz, or if where the page boundaries fall make it so that no additional mapping is needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594802077364224" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:11:30.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:11:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="isPartOf"/><div><article aria-labelledby="id__yuj6ov1vg6c id__pg31w5zfcg id__srak2jtpsg id__175ebnekp3o id__z5s6q6v0d6 id__fwon7pvr8nk id__ji2f4e0ngtl id__3g1fylbbdee id__y23960sa2om id__m1w1trp0nya id__6drefqi1jlf id__duonh16owb7 id__tvhe27f5tz id__9jcfvcqeoo id__uqin3fs8sx id__1jps0nfbgdq id__h3wxxr4bls id__29xxa953na5 id__5lu3xqfa7xr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Unfortunately, lld wants to make multiple LOAD segments with data, one for the GOT and related machinery, and the other for actual program data. In this case, the kernel just doesn&#39;t map enough memory for the GOT, and process crashes (in ldso) on entry. </span><span>ðŸ¤¦</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595274255314944" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:13:22.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:13:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="isPartOf"/><div><article aria-labelledby="id__jpya0wnaog9 id__pghhw2p0m0a id__dlbb11hk8lr id__xo4hid8m8bd id__uxj62c6cdb id__iaa9fsjgw69 id__tzrzcpdbzf id__dome2xu2p4 id__8tt6pudlx5o id__jktglbdhzr id__jrt9e86vyse id__lmqaf5ee7l id__yej6r983zt id__d0bdzodgep9 id__7okma62taar id__w58x4m25g98 id__23nox29221t id__1nnf9pd109x id__6kcwmq96onu" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I think Linux may also be failing to do the right zero-fill (leaving junk mapped from disk present) even when it&#39;s not crossing a page boundary. Depending on what the linker did (e.g. if it put data segment before GOT seg rather than after), this could cause severe malfunctions.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595644414849025" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:14:50.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:14:50.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595644414849025" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="isPartOf"/><div><article aria-labelledby="id__h0dnl4a1nzb id__nqqn7ksib1r id__05lkbpgrtr4k id__99x1p4pja4r id__qb9fiywcq69 id__n8n2jq3c8c id__thad0r57lem id__vkfypmoev7g id__d13ftrm1hqd id__2nz51k0qwl7 id__2j5q8zyzjoi id__r12036dqfi id__bsoacaq7tco id__2sqv2d7qoxi id__inqntidjanc id__0q2an5w3m4wb id__2a3cekukstd id__zmv2hafqhpj id__qkkczr6rhlc" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel has apparently always had this brokenness, and kernels in the wild will have it for decades to come. So does lld need to stop generating such output? Or should ldso do some workaround on itself in case it was linked this way?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588621141375356929" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T19:56:09.000Z" itemprop="dateCreated"/><meta content="2022-11-04T19:56:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__014pq0x3z4jio id__b9bmmiqjvp5 id__g0ejxzs4e9s id__t3iie3f9vzb id__k2ijmwx540o id__digpfidyp7d id__kczkhre8c2 id__zvzp89euxj id__arsa0z29uxd id__y1dpp88b0ig id__92pvx9vh24 id__kvjzz5yvxgi id__702tdvhm55 id__7b6jmxf83tj id__bi63f2hjzhu id__jwgo4fcxrcf id__xbesifcmbqi id__sudxdjugfen id__y36nxj4ebkg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-DrLukeKA"><div><div><div><div><a href="https://twitter.com/DrLukeKA" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1484261468019253253/5yLpzuZu_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Time for the rust rewrite</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588662667614380032" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T22:41:10.000Z" itemprop="dateCreated"/><meta content="2022-11-04T22:41:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Midar3/status/1588662667614380032" itemprop="url"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="isPartOf"/><div><article aria-labelledby="id__32noiorbb5v id__u93n8nclpmk id__kevbk000bc id__7xabhcm056n id__1scjl3bb5fxh id__09owwucs1gbg id__ad0xk21mqbm id__zgp30bip0s id__tw76wgpcy7m id__xzf6jt9y0u id__uv9nuyxemjr id__luuy6fhp9k id__ksrv1nhgg9 id__ekzcox8pin id__s40hq77x67 id__w364i696d3q id__y5zfuk4r7ec id__chywq77q0yv id__aboqnpophiu" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Midar3"><div><div><div><div><a href="https://twitter.com/Midar3" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1034913376835719177/MZpQsU8T_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To have even more logic bugs (which is what this is)? Rewriting software for no reason that has been used for decades usually doesn&#39;t make it less buggy, you know?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588871831897124864" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-05T12:32:19.000Z" itemprop="dateCreated"/><meta content="2022-11-05T12:32:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/defendtheworld/status/1588871831897124864" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__1blmtw18cj7 id__s54lfzepgdp id__jw8ubnegqk id__x0pdfa7527s id__4i26j79kqxd id__qwl2x27uw id__9jndu3mb0l8 id__n58n5mzl26i id__j98wg965qti id__5m6px71h3un id__n0gvr62mlv id__dkrfpzx4jp8 id__ig8s11rgxos id__ngob8u9xsz id__5bcp47lam9v id__cr9ttpjyw6m id__wmf530hpdf id__5sb20rpts87 id__nhtsc36ovkj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-defendtheworld"><div><div><div><div><a href="https://twitter.com/defendtheworld" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1182779768346800128/YK8PgHI0_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
