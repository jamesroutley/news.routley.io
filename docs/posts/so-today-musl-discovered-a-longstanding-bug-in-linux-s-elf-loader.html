<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/RichFelker/status/1588592850715172865">Original</a>
    <h1>So today musl discovered a longstanding bug in Linux&#39;s ELF loader</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-48901" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588592850715172865" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:03:44.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:03:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__rhderrc6d2 id__xs4hn2l64vs id__4na36in00d7 id__wcyf1nfy57o id__0z1ezntbuc0i id__9uv3hym0xnv id__z9fkk64588 id__w3cwhxcrcvg id__4y97w48yjs8 id__9j1w4ye2xhr id__dqj6n5bzmuk id__s7nwxyo6al id__d9ifs1anspv id__s1z7h6p28t id__pok84cojd6 id__4lsqbzf18so id__7s07eexyzew id__ws4ur76smuj id__zboxb8tiuel" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>So today </span><span><a dir="ltr" href="https://twitter.com/hashtag/musl?src=hashtag_click" role="link">#musl</a></span><span> discovered a longstanding </span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span>ðŸ¤¦</span><span> bug in Linux&#39;s ELF loader...</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593238537277442" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:05:17.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:05:17.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__z037xb2qe id__jro7ys9ki9h id__sdild4iako id__jdq6mm9wopn id__hlnrbxbbzsu id__bik2722lzwp id__wwskxbm74v id__ueq4an14ffi id__fpxr4hk61at id__7mr4gsstkv6 id__twg3qj6m7in id__1qex3uo35up id__1qg2mel2tk1 id__4eey348d91y id__p8hog35szz id__vpjtpd9i6y id__gecp0aghlvj id__vrnbka19ya8 id__gwnnp1zcmok" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For whatever reason, Linux has two copies of the ELF loading code in binfmt_elf.c, one for the main program and the other for the &#34;program interpreter&#34; (dynamic linker). The former handles BSS right but the latter doesn&#39;t.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588593792491585537" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:07:29.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:07:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593238537277442" itemprop="isPartOf"/><div><article aria-labelledby="id__9z1p14k0zb id__63lwjzbdvwm id__5cn4iduubxd id__vovn7ocz1k id__gswnfn9vgwq id__06hmoftatnfy id__1i6pqtxeayc id__g43megbgpc id__urg7hipk5c id__bm1uxdqksd id__thmp2lx4eyb id__thwdzm1rsse id__h5ldr60se5f id__i4kahn8t9v id__4e2ym9ldzth id__dsrb3175wpb id__qqq0j7ri7i id__l1r2cccvzsg id__rv6gg8umoad" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>ELF program LOAD segments can have p_memsz&gt;p_filesz, representing a mapping larger in memory than in the image on disk, with the remainder zero-filled (mapping zero paged if needed).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594154468442112" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:08:55.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:08:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588593792491585537" itemprop="isPartOf"/><div><article aria-labelledby="id__w09zdfm4ws id__ar1znwrf0q id__u52wdud5y1o id__1crjnz0hhvi id__lkqanfc2hfk id__bkxqcj8iwq id__9jxywsz19sb id__kipn2cldd4l id__87q8yc7psbd id__ab5upw0m9kc id__t6z24dugs1 id__u8p3g95897m id__obfl6elghjh id__wryvjzdn4ha id__yrhf33li49 id__p253wmu8fv id__xwg1oawj92 id__hfx7xgb60a8 id__6seqxjln7y7" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For the main program, Linux handles this fine. But for the interpreter, it only maps p_filesz, not p_memsz. Then, at the very end, it goes back and performs one additional mapping for the remaining &#34;bss&#34; if needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594423964655616" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:09:59.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:09:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594154468442112" itemprop="isPartOf"/><div><article aria-labelledby="id__hmh5zpggclb id__3bpryhh5zk4 id__4zm8gan91yc id__91lovlp7pd4 id__yqgl50xvvk8 id__tcycmupnut id__isqfun8xfx8 id__lfo0sdn85 id__b4vdkyh3o96 id__d9860mcadb id__rb5tjxrmn8 id__qumsczjme3 id__p7xuk322px id__ed0z71tpzua id__oxgq1fzectp id__yjfszwm90f id__g6xbj5pcq2 id__15lkdprpdsf id__wkm06dfjg2o" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This happens to work if there&#39;s only one data segment mapping that utilizes p_memsz&gt;p_filesz, or if where the page boundaries fall make it so that no additional mapping is needed.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588594802077364224" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:11:30.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:11:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594423964655616" itemprop="isPartOf"/><div><article aria-labelledby="id__lf3qr12pqj id__2pw0lr95sia id__rw799kdlxs id__hql07yz3wuo id__w4bjwwhne4a id__g83vcfoxis6 id__g82thdor50n id__izj5ulqq3nn id__2qh74imvdgx id__taerxl4rcq id__gv6cs9r77kw id__49u3smif0xq id__9iklg4j4x1m id__wgmgp4bmdv id__7dfclii2drn id__yvvatov4l id__b7js9y3myc5 id__jzwgz1mf4y id__j9lfcjnlptr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Unfortunately, lld wants to make multiple LOAD segments with data, one for the GOT and related machinery, and the other for actual program data. In this case, the kernel just doesn&#39;t map enough memory for the GOT, and process crashes (in ldso) on entry. </span><span>ðŸ¤¦</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595274255314944" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:13:22.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:13:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588594802077364224" itemprop="isPartOf"/><div><article aria-labelledby="id__fhjtoyhsusm id__44y1v03ng3d id__2uoh09y97uk id__b1r7ymzjfed id__zxpxgl3qau id__q8y3yyxhu4 id__lwp2oq2cieb id__miwrc0qvo2i id__5zg7067eld5 id__n5gkv0o38k id__wysqvz0zfbf id__ru52ojxzoxi id__60zfvxx8xz9 id__zygr4eczi2f id__yuxbdr7v7fq id__kq5x3ye6mg id__7x0j38py1cg id__6bq5i3qy9il id__w1fyjkdh0f" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I think Linux may also be failing to do the right zero-fill (leaving junk mapped from disk present) even when it&#39;s not crossing a page boundary. Depending on what the linker did (e.g. if it put data segment before GOT seg rather than after), this could cause severe malfunctions.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588595644414849025" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T18:14:50.000Z" itemprop="dateCreated"/><meta content="2022-11-04T18:14:50.000Z" itemprop="datePublished"/><meta content="https://twitter.com/RichFelker/status/1588595644414849025" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588595274255314944" itemprop="isPartOf"/><div><article aria-labelledby="id__gfbzcf8t15s id__m6ztjqqteq id__ehtudti7ea id__n1m5q9moy4d id__mvbu7vyeok id__q52tiefk69o id__n6y0jg968i id__hupyvqn67c id__f7gg9u87nz id__5g029hklg3 id__4re2sdqr1ru id__rrnchrwa3xh id__sqr6f931iig id__qef3nxrhkog id__y7djrwd32u id__o5cwb6g59kc id__t9ux4vyg19 id__boeyr6lmw5l id__24534cloaw4" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-RichFelker"><div><div><div><div><a href="https://twitter.com/RichFelker" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1498884591473598466/_WT-zvRh_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel has apparently always had this brokenness, and kernels in the wild will have it for decades to come. So does lld need to stop generating such output? Or should ldso do some workaround on itself in case it was linked this way?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588621141375356929" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T19:56:09.000Z" itemprop="dateCreated"/><meta content="2022-11-04T19:56:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__8htdvuiiqwg id__ryfeitlhwgj id__4vc0jm4gnq6 id__edmncshljx9 id__p0j4vf0hfk id__jjjfx1ynlxr id__tzwfyjnzpe id__xgdje9yxula id__6dkdjo21ph9 id__eyc10ewkkkd id__60ipv6892bn id__0os80wgmlo5 id__k9sf7952gw9 id__9j3wfw0jm8 id__kmz9fa91ux8 id__ucsuspbez6h id__xeq0c7gz40e id__f0udpovmr7v id__1eqmx6f8k6u" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-DrLukeKA"><div><div><div><div><a href="https://twitter.com/DrLukeKA" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1484261468019253253/5yLpzuZu_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Time for the rust rewrite</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588662667614380032" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-04T22:41:10.000Z" itemprop="dateCreated"/><meta content="2022-11-04T22:41:10.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Midar3/status/1588662667614380032" itemprop="url"/><meta content="https://twitter.com/DrLukeKA/status/1588621141375356929" itemprop="isPartOf"/><div><article aria-labelledby="id__zo6mavugkxf id__zlut7upzurn id__3ceuaw44c9q id__4qcgzvuoz4l id__wehhan08f2c id__02x8bu7pw1ix id__xk4mmoc5ejh id__4wsp2kcbopo id__pk65yta0fai id__q0bz7hty31r id__7phlwlt0nj3 id__gtacagb8p5e id__dw4ros37tzl id__odxra0c1xe id__ql4jnxefz id__0sruruwxue1d id__do5acvb2wvs id__bz27jr77i49 id__qla98g1qkuh" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Midar3"><div><div><div><div><a href="https://twitter.com/Midar3" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1034913376835719177/MZpQsU8T_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To have even more logic bugs (which is what this is)? Rewriting software for no reason that has been used for decades usually doesn&#39;t make it less buggy, you know?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1588871831897124864" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-11-05T12:32:19.000Z" itemprop="dateCreated"/><meta content="2022-11-05T12:32:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/defendtheworld/status/1588871831897124864" itemprop="url"/><meta content="https://twitter.com/RichFelker/status/1588592850715172865" itemprop="isPartOf"/><div><article aria-labelledby="id__vjrz3qn08m id__z0b3pxuf7y id__rajynaf4vcg id__0pt1r9abqhr id__coi3dwa8kgs id__u3i6h48ah4g id__g9j29lgkdue id__f5m197pfmn id__7leuepf7jxi id__5h1292y636t id__s2xenullc6h id__fcbzy847s9 id__28mjm8jo2y1h id__4qxpulu0a7q id__lob6wbluclm id__oeov70o7zoq id__1qor4ck846r id__0qopyh3nozed id__o2tmbh7xau" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-defendtheworld"><div><div><div><div><a href="https://twitter.com/defendtheworld" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1182779768346800128/YK8PgHI0_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
