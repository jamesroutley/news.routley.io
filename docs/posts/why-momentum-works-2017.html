<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://distill.pub/2017/momentum/">Original</a>
    <h1>Why Momentum Works (2017)</h1>
    
    <div id="readability-page-1" class="page"><div>
  

  <figure>
    
    <p id="sliderAlpha">
      <text>Step-size α = 0.02</text>
    </p>
    <p id="sliderBeta">
      <text>Momentum β = 0.99</text>
    </p>
    <figcaption id="Bananacaption">
      We often think of Momentum as a means of dampening oscillations and speeding up the iterations, leading to faster convergence. But it has other interesting behavior. It allows a larger range of step-sizes to be used, and creates its own oscillations. What is going on?
    </figcaption>
  </figure>

  <dt-byline>




</dt-byline>

  
  
  
  <p>
  Here’s a popular story about momentum <dt-cite key="sutskever2013importance,polyak1964some,rutishauser1959theory"><span id="citation-0" data-hover-ref="dt-cite-hover-box-0"><span>[1, 2, 3]</span></span></dt-cite>: gradient descent is a man walking down a hill. He follows the steepest path downwards; his progress is slow, but steady. Momentum is a heavy ball rolling down the same hill. The added inertia acts both as a smoother and an accelerator, dampening oscillations and causing us to barrel through narrow valleys, small humps and local minima.
  </p>
  <p>
  This standard story isn’t wrong, but it fails to explain many important behaviors of momentum. In fact, momentum can be understood far more precisely if we study it on the right model.
  </p>
  <p>
  One nice model is the convex quadratic. This model is rich enough to reproduce momentum’s local dynamics in real problems, and yet simple enough to be understood in closed form. This balance gives us powerful traction for understanding this algorithm.
  </p>
  <hr/>
  <p>
  We begin with gradient descent. The algorithm has many virtues, but speed is not one of them. It is simple — when optimizing a smooth function <dt-math>

<span><span><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span></span></span></span></dt-math>, we make a small step in the gradient

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>w</mi><mi>k</mi></msup><mo>−</mo><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mi>k</mi></msup><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">w^{k+1} = w^k-\alpha\nabla f(w^k).</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>.</span></span></span></span></span></dt-math>

  For a step-size small enough, gradient descent makes a monotonic improvement at every iteration. It always converges, albeit to a local minimum. And under a few weak curvature conditions it can even get there at an exponential rate.
  </p>

  <p>
  But the exponential decrease, though appealing in theory, can often be infuriatingly small. Things often begin quite well — with an impressive, almost immediate decrease in the loss. But as the iterations progress, things start to slow down. You start to get a nagging feeling you’re not making as much progress as you should be. What has gone wrong?
  </p>

  <p>
  The problem could be the optimizer’s old nemesis, pathological curvature. Pathological curvature is, simply put, regions of <dt-math>

<span><span><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span></span></span></span></dt-math> which aren’t scaled properly. The landscapes are often described as valleys, trenches, canals and ravines. The iterates either jump between valleys, or approach the optimum in small, timid steps. Progress along certain directions grind to a halt. In these unfortunate regions, gradient descent fumbles.</p>
  <p>
  Momentum proposes the following tweak to gradient descent. We give gradient descent a short-term memory:

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>β</mi><msup><mi>z</mi><mrow><mi>k</mi></mrow></msup><mo>+</mo><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>α</mi><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  z^{k+1}&amp;=\beta z^{k}+\nabla f(w^{k})\\[0.4em]
  w^{k+1}&amp;=w^{k}-\alpha z^{k+1}
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span>β</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  The change is innocent, and costs almost nothing. When <dt-math>

<span><span><math><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta = 0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span><span>=</span><span>0</span></span></span></span></dt-math> , we recover gradient descent. But for <dt-math>

<span><span><math><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>9</mn></mrow><annotation encoding="application/x-tex">\beta = 0.99</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span><span>=</span><span>0</span><span>.</span><span>9</span><span>9</span></span></span></span></dt-math> (sometimes <dt-math>

<span><span><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>9</mn><mn>9</mn></mrow><annotation encoding="application/x-tex">0.999</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>0</span><span>.</span><span>9</span><span>9</span><span>9</span></span></span></span></dt-math>, if things are really bad), this appears to be the boost we need. Our iterations regain that speed and boldness it lost, speeding to the optimum with a renewed energy.

  </p>
  <p>
  Optimizers call this minor miracle “acceleration”.
  </p>

  <p>
  The new algorithm may seem at first glance like a cheap hack. A simple trick to get around gradient descent’s more aberrant behavior — a smoother for oscillations between steep canyons. But the truth, if anything, is the other way round. It is gradient descent which is the hack. First, momentum gives up to a quadratic speedup on many functions. <dt-fn><sup><span id="fn-1" data-hover-ref="dt-fn-hover-box-0">1</span></sup></dt-fn> This is no small matter — this is similar to the speedup you get from the Fast Fourier Transform, Quicksort, and Grover’s Algorithm. When the universe gives you quadratic speedups, you should start to pay attention.
  </p>

  <p>
  But there’s more. A lower bound, courtesy of Nesterov <dt-cite key="nesterov2013introductory"><span id="citation-2" data-hover-ref="dt-cite-hover-box-2"><span>[5]</span></span></dt-cite>, states that momentum is, in a certain very narrow and technical sense, optimal. Now, this doesn’t mean it is the best algorithm for all functions in all circumstances. But it does satisfy some curiously beautiful mathematical properties which scratch a very human itch for perfection and closure. But more on that later. Let’s say this for now — momentum is an algorithm for the book.
  </p>

<hr/>
  <h2>First Steps: Gradient Descent</h2>
  <p>
  We begin by studying gradient descent on the simplest model possible which isn’t trivial — the convex quadratic,

  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mi>w</mi><mi>T</mi></msup><mi>A</mi><mi>w</mi><mo>−</mo><msup><mi>b</mi><mi>T</mi></msup><mi>w</mi><mo separator="true">,</mo><mspace width="2em"></mspace><mi>w</mi><mo>∈</mo><msup><mrow><mi mathvariant="bold">R</mi></mrow><mi>n</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
    f(w) = \tfrac{1}{2}w^TAw - b^Tw, \qquad w \in \mathbf{R}^n.
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span><span>(</span><span>w</span><span>)</span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>A</span><span>w</span><span>−</span><span><span>b</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>w</span><span>,</span><span><span></span><span>w</span></span><span>∈</span><span><span><span>R</span></span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span></span></span></dt-math>

  Assume <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math> is symmetric and invertible, then the optimal solution <dt-math>

<span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mo>⋆</mo></mrow></msup></mrow><annotation encoding="application/x-tex">w^{\star}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> occurs at

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mo>⋆</mo></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex"> w^{\star} = A^{-1}b.</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>A</span><span><span><span><span><span>​</span></span><span><span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>b</span><span>.</span></span></span></span></span></dt-math>

  Simple as this model may be, it is rich enough to approximate many functions (think of <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math> as your favorite model of curvature — the Hessian, Fisher Information Matrix <dt-cite key="amari1998natural"><span id="citation-3" data-hover-ref="dt-cite-hover-box-3"><span>[6]</span></span></dt-cite>, etc) and captures all the key features of pathological curvature. And more importantly, we can write an exact closed formula for gradient descent on this function.
  </p>

  <p>
  This is how it goes. Since <dt-math>

<span><span><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>=</mo><mi>A</mi><mi>w</mi><mo>−</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\nabla f(w)=Aw - b</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∇</span><span>f</span><span>(</span><span>w</span><span>)</span><span>=</span><span>A</span><span>w</span><span>−</span><span>b</span></span></span></span></dt-math>, the iterates are

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>α</mi><mo>(</mo><mi>A</mi><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>b</mi><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  w^{k+1}=w^{k}- \alpha (Aw^{k} - b).
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span>(</span><span>A</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>b</span><span>)</span><span>.</span></span></span></span></span></dt-math>

  Here’s the trick. There is a very natural space to view gradient descent where all the dimensions act independently — the eigenvectors of <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math>.
  </p>
  <figure id="change_of_variables">
  
  
  
  </figure>
  
<p>
  Every symmetric matrix <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math> has an eigenvalue decomposition

  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><mtext> </mtext><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mtext><mo>(</mo><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub><mo>)</mo><mtext> </mtext><msup><mi>Q</mi><mrow><mi>T</mi></mrow></msup><mo separator="true">,</mo><mspace width="2em"></mspace><mi>Q</mi><mo>=</mo><mo>[</mo><msub><mi>q</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>q</mi><mi>n</mi></msub><mo>]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
  A=Q\ \text{diag}(\lambda_{1},\ldots,\lambda_{n})\ Q^{T},\qquad Q = [q_1,\ldots,q_n],
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span><span>=</span><span>Q</span><span><span> </span><span>diag</span></span><span>(</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span>…</span><span>,</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span> </span><span>Q</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span><span></span><span>Q</span></span><span>=</span><span>[</span><span><span>q</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span>…</span><span>,</span><span><span>q</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>]</span><span>,</span></span></span></span></span></dt-math>

  and, as per convention, we will assume that the <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>’s are sorted, from smallest <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> to biggest <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. If we perform a change of basis, <dt-math>

<span><span><math><semantics><mrow><msup><mi>x</mi><mrow><mi>k</mi></mrow></msup><mo>=</mo><msup><mi>Q</mi><mi>T</mi></msup><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">x^{k} = Q^T(w^{k} - w^\star)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>Q</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math>, the iterations break apart, becoming:

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><mo>)</mo><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><msup><mo>)</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><msubsup><mi>x</mi><mi>i</mi><mn>0</mn></msubsup></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  x_{i}^{k+1} &amp; =x_{i}^{k}-\alpha \lambda_ix_{i}^{k} \\[0.4em]
   &amp;= (1-\alpha\lambda_i)x^k_i=(1-\alpha \lambda_i)^{k+1}x^0_i
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  Moving back to our original space <dt-math>

<span><span><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>w</span></span></span></span></dt-math>, we can see that

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mi>k</mi></msup><mo>−</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>=</mo><mi>Q</mi><msup><mi>x</mi><mi>k</mi></msup><mo>=</mo><msubsup><mo>∑</mo><mi>i</mi><mi>n</mi></msubsup><msubsup><mi>x</mi><mi>i</mi><mn>0</mn></msubsup><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><msup><mo>)</mo><mi>k</mi></msup><msub><mi>q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
  w^k - w^\star = Qx^k=\sum_i^n x^0_i(1-\alpha\lambda_i)^k q_i
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>Q</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>q</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>

  and there we have it — gradient descent in closed form.
  </p>
  
  <h3>Decomposing the Error</h3>
  <p>
  The above equation admits a simple interpretation. Each element of <dt-math>

<span><span><math><semantics><mrow><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">x^0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> is the component of the error in the initial guess in the <dt-math>

<span><span><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>Q</span></span></span></span></dt-math>-basis. There are <dt-math>

<span><span><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span></span></span></span></dt-math> such errors, and each of these errors follows its own, solitary path to the minimum, decreasing exponentially with a compounding rate of <dt-math>

<span><span><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1-\alpha\lambda_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. The closer that number is to <dt-math>

<span><span><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span></span></span></span></dt-math>, the slower it converges.
  </p>
  <p>
  For most step-sizes, the eigenvectors with largest eigenvalues converge the fastest. This triggers an explosion of progress in the first few iterations, before things slow down as the smaller eigenvectors’ struggles are revealed. By writing the contributions of each eigenspace’s error to the loss
  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mo>⋆</mo></mrow></msup><mo>)</mo><mo>=</mo><mo>∑</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><msup><mo>)</mo><mrow><mn>2</mn><mi>k</mi></mrow></msup><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo>[</mo><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup><msup><mo>]</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
  f(w^{k})-f(w^{\star})=\sum(1-\alpha\lambda_{i})^{2k}\lambda_{i}[x_{i}^{0}]^2
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>−</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>=</span><span>∑</span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>[</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>]</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  we can visualize the contributions of each error component to the loss.
  </p>
  <figure id="milestones_gd">
  <figcaption>Optimization can be seen as combination of several component problems, shown here as <svg style="position:relative; top:2px; width:3px; height:14px; background:#fde0dd"></svg> 1 <svg style="position:relative; top:2px; width:3px; height:14px; background:#fa9fb5"></svg> 2 <svg style="position:relative; top:2px; width:3px; height:14px; background:#c51b8a"></svg> 3 with eigenvalues <svg style="position:relative; top:2px; width:3px; height:14px; background:#fde0dd"></svg> <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_1=0.01</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span><span>.</span><span>0</span><span>1</span></span></span></span></dt-math>, <svg style="position:relative; top:2px; width:3px; height:14px; background:#fa9fb5"></svg> <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_2=0.1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span><span>.</span><span>1</span></span></span></span></dt-math>, and <svg style="position:relative; top:2px; width:3px; height:14px; background:#c51b8a"></svg> <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_3=1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>3</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>1</span></span></span></span></dt-math> respectively. </figcaption>

<!-- ["#fde0dd", "#fa9fb5", "#c51b8a"]
 -->
  <div id="sliderStep">

    <p>
         Step-size
    </p>

    <p>
      Optimal Step-size
    </p>

    <svg style="position:absolute; font-size:10px; left:224px; top:34px">
<line marker-end="url(#arrowhead)" style="stroke: black; stroke-width: 1.5; visibility: visible;" x2="5" y2="10" x1="5" y1="0"></line>
    </svg>

  </div>
  
  </figure>
  
  
  <h3>Choosing A Step-size</h3>
  <p>
  The above analysis gives us immediate guidance as to how to set a step-size <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math>. In order to converge, each <dt-math>

<span><span><math><semantics><mrow><mi mathvariant="normal">∣</mi><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|1-\alpha \lambda_i|</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∣</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span></span></span></span></dt-math> must be strictly less than 1. All workable step-sizes, therefore, fall in the interval

  <dt-math block="">

<span><span><span><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub><mo>&lt;</mo><mn>2</mn><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">0&lt;\alpha\lambda_i&lt;2.</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>0</span><span>&lt;</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>&lt;</span><span>2</span><span>.</span></span></span></span></span></dt-math>

  The overall convergence rate is determined by the slowest error component, which must be either <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> or <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>:
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mtext><mo>(</mo><mi>α</mi><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mtext> </mtext><mo>=</mo><mtext> </mtext><msub><mi>max</mi><mrow><mi>i</mi></mrow></msub><mrow><mo fence="true">∣</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mtext> </mtext><mo>=</mo><mtext> </mtext><mi>max</mi><mrow><mo fence="true">{</mo><mi mathvariant="normal">∣</mi><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">∣</mi><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub><mi mathvariant="normal">∣</mi><mo fence="true">}</mo></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}\text{rate}(\alpha) &amp; ~=~ \max_{i}\left|1-\alpha\lambda_{i}\right|\\[0.9em] &amp; ~=~ \max\left\{|1-\alpha\lambda_{1}|,~ |1-\alpha\lambda_{n}|\right\} \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>rate</span></span><span>(</span><span>α</span><span>)</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span><span> </span><span>=</span></span><span><span> </span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span>max</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>∣</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span></span></span></span><span><span><span>​</span></span><span><span></span><span><span> </span><span>=</span></span><span><span> </span>max</span><span><span>{</span><span>∣</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>,</span><span><span> </span><span>∣</span></span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
  </p>
  <p>
  This overall rate is minimized when the rates for <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> are the same — this mirrors our informal observation in the previous section that the optimal step-size causes the first and last eigenvectors to converge at the same rate. If we work this through we get:

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext> </mtext></mtext><mi>α</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><mrow><msub><mo><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mtext></mo><mi>α</mi></msub></mrow><mtext> </mtext><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mtext><mo>(</mo><mi>α</mi><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mtext> </mtext><mo>=</mo><mtext> </mtext><mfrac><mrow><mn>2</mn></mrow><mrow><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext> </mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mrow><msub><mi>min</mi><mi>α</mi></msub></mrow><mtext> </mtext><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mtext><mo>(</mo><mi>α</mi><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mtext> </mtext><mo>=</mo><mtext> </mtext><mfrac><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mo>−</mo><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  \text{optimal }\alpha ~=~{\mathop{\text{argmin}}\limits_\alpha} ~\text{rate}(\alpha) &amp; ~=~\frac{2}{\lambda_{1}+\lambda_{n}}\\[1.4em]
  \text{optimal rate} ~=~{\min_\alpha} ~\text{rate}(\alpha) &amp; ~=~\frac{\lambda_{n}/\lambda_{1}-1}{\lambda_{n}/\lambda_{1}+1}
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>optimal </span></span><span>α</span><span><span> </span><span>=</span></span><span><span> </span><span><span><span><span><span>​</span></span><span><span>α</span></span></span><span><span><span>​</span></span><span><span><span><span>argmin</span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>rate</span></span><span>(</span><span>α</span><span>)</span></span></span><span><span><span>​</span></span><span><span><span>optimal rate</span></span><span><span> </span><span>=</span></span><span><span> </span><span><span><span><span><span>​</span></span><span><span>α</span></span></span><span><span><span>​</span></span><span><span>min</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>rate</span></span><span>(</span><span>α</span><span>)</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span><span> </span><span>=</span></span><span><span> </span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span><span><span><span>​</span></span><span><span></span><span><span> </span><span>=</span></span><span><span> </span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>/</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>/</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
  </p>
  <p>
  Notice the ratio <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>n</mi></msub><mi mathvariant="normal">/</mi><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_n/\lambda_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>/</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> determines the convergence rate of the problem. In fact, this ratio appears often enough that we give it a name, and a symbol — the condition number.
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mtext> </mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mtext><mo>:</mo><mo>=</mo><mi>κ</mi><mo>:</mo><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
  \text{condition number} := \kappa :=\frac{\lambda_n}{\lambda_1}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>condition number</span></span><span>:</span><span>=</span><span>κ</span><span>:</span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></dt-math>
  The condition number means many things. It is a measure of how close to singular a matrix is. It is a measure of how robust <dt-math>

<span><span><math><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">A^{-1}b</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>A</span><span><span><span><span><span>​</span></span><span><span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>b</span></span></span></span></dt-math> is to perturbations in <dt-math>

<span><span><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>b</span></span></span></span></dt-math>. And, in this context, the condition number gives us a measure of how poorly gradient descent will perform. A ratio of <dt-math>

<span><span><math><semantics><mrow><mi>κ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa = 1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>κ</span><span>=</span><span>1</span></span></span></span></dt-math> is ideal, giving convergence in one step (of course, the function is trivial). Unfortunately the larger the ratio, the slower gradient descent will be. The condition number is therefore a direct measure of pathological curvature.
  </p>

<hr/>

  <h2>Example: Polynomial Regression</h2>
  <p>
  The above analysis reveals an insight: all errors are not made equal. Indeed, there are different kinds of errors, <dt-math>

<span><span><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span></span></span></span></dt-math> to be exact, one for each of the eigenvectors of <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math>. And gradient descent is better at correcting some kinds of errors than others. But what do the eigenvectors of <dt-math>

<span><span><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>A</span></span></span></span></dt-math> mean? Surprisingly, in many applications they admit a very concrete interpretation.
  </p>

  <p>
  Lets see how this plays out in polynomial regression. Given 1D data, <dt-math>

<span><span><math><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\xi_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, our problem is to fit the model

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mtext><mo>(</mo><mi>ξ</mi><mo>)</mo><mo>=</mo><msub><mi>w</mi><mrow><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>ξ</mi><mo>)</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub><msub><mi>p</mi><mrow><mi>n</mi></mrow></msub><mo>(</mo><mi>ξ</mi><mo>)</mo><mspace width="2em"></mspace><msub><mi>p</mi><mrow><mi>i</mi></mrow></msub><mo>=</mo><mi>ξ</mi><mo>↦</mo><msup><mi>ξ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
\text{model}(\xi)=w_{1}p_{1}(\xi)+\cdots+w_{n}p_{n}(\xi)\qquad p_{i}=\xi\mapsto\xi^{i-1}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>model</span></span><span>(</span><span>ξ</span><span>)</span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>p</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>ξ</span><span>)</span><span>+</span><span>⋯</span><span>+</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>p</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>ξ</span><span>)</span><span><span></span><span>p</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>ξ</span><span>↦</span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>

  to our observations, <dt-math>

<span><span><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>d</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. This model, though nonlinear in the input <dt-math>

<span><span><math><semantics><mrow><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\xi</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>ξ</span></span></span></span></dt-math>, is linear in the weights, and therefore we can write the model as a linear combination of monomials, like:
  </p>
  <figure id="poly0f">
    
  </figure>
  
  
  <p>

  Because of the linearity, we can fit this model to our data <dt-math>

<span><span><math><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\xi_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> using linear regression on the model mismatch

  <dt-math block="">

<span><span><span><math><semantics><mrow><msub><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mtext><mi>w</mi></msub><mspace width="2em"></mspace><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msub><mo>∑</mo><mi>i</mi></msub><mo>(</mo><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mtext><mo>(</mo><msub><mi>ξ</mi><mrow><mi>i</mi></mrow></msub><mo>)</mo><mo>−</mo><msub><mi>d</mi><mrow><mi>i</mi></mrow></msub><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mi mathvariant="normal">∥</mi><mi>Z</mi><mi>w</mi><mo>−</mo><mi>d</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
  \text{minimize}_w \qquad\tfrac{1}{2}\sum_i (\text{model}(\xi_{i})-d_{i})^{2} ~~=~~ \tfrac{1}{2}\|Zw - d\|^2
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span>minimize</span></span><span><span><span><span><span>​</span></span><span><span>w</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span>​</span></span></span><span>(</span><span><span>model</span></span><span>(</span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>−</span><span><span>d</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span> </span><span>=</span></span><span><span> </span><span> </span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>∥</span><span>Z</span><span>w</span><span>−</span><span>d</span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  where
  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>Z</mi><mo>=</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>ξ</mi><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>ξ</mi><mrow><mn>2</mn></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mn>2</mn></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mn>2</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">⋮</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">⋮</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">⋮</mi></mrow></mtd><mtd><mrow><mo>⋱</mo></mrow></mtd><mtd><mrow><mi mathvariant="normal">⋮</mi></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><msub><mi>ξ</mi><mrow><mi>m</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><msubsup><mi>ξ</mi><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  Z=\left(\begin{array}{ccccc}
  1 &amp; \xi_{1} &amp; \xi_{1}^{2} &amp; \ldots &amp; \xi_{1}^{n-1}\\
  1 &amp; \xi_{2} &amp; \xi_{2}^{2} &amp; \ldots &amp; \xi_{2}^{n-1}\\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
  1 &amp; \xi_{m} &amp; \xi_{m}^{2} &amp; \ldots &amp; \xi_{m}^{n-1}
  \end{array}\right).
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>Z</span><span>=</span><span><span><span><span><span><span><span>​</span></span><span><span>⎝</span></span></span><span><span><span>​</span></span><span><span>⎜</span></span></span><span><span><span>​</span></span><span><span>⎜</span></span></span><span><span><span>​</span></span><span><span>⎛</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>⋮</span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>⋮</span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>m</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>⋮</span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>m</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>⋱</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>⋮</span></span></span><span><span><span>​</span></span><span><span><span>ξ</span><span><span><span><span><span>​</span></span><span><span><span>m</span></span></span></span><span><span><span>​</span></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span><span><span><span><span>​</span></span><span><span>⎠</span></span></span><span><span><span>​</span></span><span><span>⎟</span></span></span><span><span><span>​</span></span><span><span>⎟</span></span></span><span><span><span>​</span></span><span><span>⎞</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span><span>.</span></span></span></span></span></dt-math>
  </p>

  <p>
  The path of convergence, as we know, is elucidated when we view the iterates in the space of <dt-math>

<span><span><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>Q</span></span></span></span></dt-math> (the eigenvectors of <dt-math>

<span><span><math><semantics><mrow><msup><mi>Z</mi><mi>T</mi></msup><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z^T Z</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>Z</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>Z</span></span></span></span></dt-math>). So let’s recast our regression problem in the basis of <dt-math>

<span><span><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>Q</span></span></span></span></dt-math>. First, we do a change of basis, by rotating <dt-math>

<span><span><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>w</span></span></span></span></dt-math> into <dt-math>

<span><span><math><semantics><mrow><mi>Q</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">Qw</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>Q</span><span>w</span></span></span></span></dt-math>, and counter-rotating our feature maps <dt-math>

<span><span><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>p</span></span></span></span></dt-math> into eigenspace, <dt-math>

<span><span><math><semantics><mrow><mover accent="true"><mrow><mi>p</mi></mrow><mo>¯</mo></mover></mrow><annotation encoding="application/x-tex">\bar{p}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span>​</span></span><span><span>p</span></span></span><span><span><span>​</span></span><span><span>¯</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></dt-math>. We can now conceptualize the same regression as one over a different polynomial basis, with the model

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mtext><mo>(</mo><mi>ξ</mi><mo>)</mo><mtext> </mtext><mo>=</mo><mtext> </mtext><msub><mi>x</mi><mrow><mn>1</mn></mrow></msub><msub><mover accent="true"><mrow><mi>p</mi></mrow><mo>¯</mo></mover><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>ξ</mi><mo>)</mo><mtext> </mtext><mo>+</mo><mtext> </mtext><mo>⋯</mo><mtext> </mtext><mo>+</mo><mtext> </mtext><msub><mi>x</mi><mrow><mi>n</mi></mrow></msub><msub><mover accent="true"><mrow><mi>p</mi></mrow><mo>¯</mo></mover><mrow><mi>n</mi></mrow></msub><mo>(</mo><mi>ξ</mi><mo>)</mo><mspace width="2em"></mspace><msub><mover accent="true"><mrow><mi>p</mi></mrow><mo>¯</mo></mover><mrow><mi>i</mi></mrow></msub><mo>=</mo><mo>∑</mo><msub><mi>q</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>p</mi><mi>j</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  \text{model}(\xi)~=~x_{1}\bar{p}_{1}(\xi)~+~\cdots~+~x_{n}\bar{p}_{n}(\xi)\qquad \bar{p}_{i}=\sum q_{ij}p_j.
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>model</span></span><span>(</span><span>ξ</span><span>)</span><span><span> </span><span>=</span></span><span><span> </span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span><span>​</span></span><span><span>p</span></span></span><span><span><span>​</span></span><span><span>¯</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>ξ</span><span>)</span><span><span> </span><span>+</span></span><span><span> </span><span>⋯</span></span><span><span> </span><span>+</span></span><span><span> </span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span><span>​</span></span><span><span>p</span></span></span><span><span><span>​</span></span><span><span>¯</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>ξ</span><span>)</span><span><span></span><span><span><span><span><span>​</span></span><span><span>p</span></span></span><span><span><span>​</span></span><span><span>¯</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>∑</span><span><span>q</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>j</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>p</span><span><span><span><span><span>​</span></span><span><span>j</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span></span></span></dt-math>

  This model is identical to the old one. But these new features <dt-math>

<span><span><math><semantics><mrow><mover accent="true"><mrow><mi>p</mi></mrow><mo>¯</mo></mover></mrow><annotation encoding="application/x-tex">\bar{p}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span>​</span></span><span><span>p</span></span></span><span><span><span>​</span></span><span><span>¯</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></dt-math> (which I call “eigenfeatures”) and weights have the pleasing property that each coordinate acts independently of the others. Now our optimization problem breaks down, really, into <dt-math>

<span><span><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span></span></span></span></dt-math> small 1D optimization problems. And each coordinate can be optimized greedily and independently, one at a time in any order, to produce the final, global, optimum. The eigenfeatures are also much more informative:
  </p>


  <figure id="poly1"></figure>

  
  <p>
  The observations in the above diagram can be justified mathematically. From a statistical point of view, we would like a model which is, in some sense, robust to noise. Our model cannot possibly be meaningful if the slightest perturbation to the observations changes the entire model dramatically. And the eigenfeatures, the principal components of the data, give us exactly the decomposition we need to sort the features by its sensitivity to perturbations in <dt-math>

<span><span><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>d</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>’s. The most robust components appear in the front (with the largest eigenvalues), and the most sensitive components in the back (with the smallest eigenvalues).
  </p>

  <p>
  This measure of robustness, by a rather convenient coincidence, is also a measure of how easily an eigenspace converges. And thus, the “pathological directions” — the eigenspaces which converge the slowest — are also those which are most sensitive to noise! So starting at a simple initial point like <dt-math>

<span><span><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>0</span></span></span></span></dt-math> (by a gross abuse of language, let’s think of this as a prior), we track the iterates till a desired level of complexity is reached. Let’s see how this plays out in gradient descent.
  </p>

  <figure id="poly2"></figure>

  
  <p>
  This effect is harnessed with the heuristic of early stopping : by stopping the optimization early, you can often get better generalizing results. Indeed, the effect of early stopping is very similar to that of more conventional methods of regularization, such as Tikhonov Regression. Both methods try to suppress the components of the smallest eigenvalues directly, though they employ different methods of spectral decay.<dt-fn><sup><span id="fn-2" data-hover-ref="dt-fn-hover-box-1">2</span></sup></dt-fn> But early stopping has a distinct advantage. Once the step-size is chosen, there are no regularization parameters to fiddle with. Indeed, in the course of a single optimization, we have the entire family of models, from underfitted to overfitted, at our disposal. This gift, it seems, doesn’t come at a price. A beautiful free lunch <dt-cite key="hintonNIPS"><span id="citation-4" data-hover-ref="dt-cite-hover-box-4"><span>[7]</span></span></dt-cite> indeed.
  </p>

<hr/>
  <h2>The Dynamics of Momentum</h2>

  <p>
  Let’s turn our attention back to momentum. Recall that the momentum update is

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>β</mi><msup><mi>z</mi><mrow><mi>k</mi></mrow></msup><mo>+</mo><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>α</mi><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  z^{k+1}&amp;=\beta z^{k}+\nabla f(w^{k})\\[0.4em]
  w^{k+1}&amp;=w^{k}-\alpha z^{k+1}.
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span>β</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  Since <dt-math>

<span><span><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mi>k</mi></msup><mo>)</mo><mo>=</mo><mi>A</mi><msup><mi>w</mi><mi>k</mi></msup><mo>−</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\nabla f(w^k) = Aw^k - b</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>=</span><span>A</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>b</span></span></span></span></dt-math>, the update on the quadratic is

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>β</mi><msup><mi>z</mi><mrow><mi>k</mi></mrow></msup><mo>+</mo><mo>(</mo><mi>A</mi><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>b</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>α</mi><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  z^{k+1}&amp;=\beta z^{k}+ (Aw^{k}-b)\\[0.4em]
  w^{k+1}&amp;=w^{k}-\alpha z^{k+1}.
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span>β</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>(</span><span>A</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>b</span><span>)</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  Following <dt-cite key="o2015adaptive"><span id="citation-5" data-hover-ref="dt-cite-hover-box-5"><span>[8]</span></span></dt-cite>, we go through the same motions, with the change of basis <dt-math>

<span><span><math><semantics><mrow><msup><mi>x</mi><mrow><mi>k</mi></mrow></msup><mo>=</mo><mi>Q</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">
  x^{k} = Q(w^{k} - w^\star)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>Q</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msup><mi>y</mi><mrow><mi>k</mi></mrow></msup><mo>=</mo><mi>Q</mi><msup><mi>z</mi><mrow><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex"> y^{k} = Qz^{k}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>Q</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, to yield the update rule

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>β</mi><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>+</mo><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>−</mo><mi>α</mi><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  y_{i}^{k+1}&amp;=\beta y_{i}^{k}+\lambda_{i}x_{i}^{k}\\[0.4em]
  x_{i}^{k+1}&amp;=x_{i}^{k}-\alpha y_{i}^{k+1}.
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span>β</span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  in which each component acts independently of the other components (though <dt-math>

<span><span><math><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">x^k_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">y^k_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> are coupled). This lets us rewrite our iterates as

  <dt-fn><sup><span id="fn-3" data-hover-ref="dt-fn-hover-box-2">3</span></sup></dt-fn>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mo>=</mo><msup><mi>R</mi><mi>k</mi></msup><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mspace width="2em"></mspace><mi>R</mi><mo>=</mo><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi><mi>β</mi></mrow></mtd><mtd><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  \left(\!\!\begin{array}{c}
  y_{i}^{k}\\
  x_{i}^{k}
  \end{array}\!\!\right)=R^k\left(\!\!\begin{array}{c}
  y_{i}^{0}\\
  x_{i}^{0}
  \end{array}\!\!\right)
  \qquad
  R = \left(\!\!\begin{array}{cc}
  \beta &amp; \lambda_{i}\\
  -\alpha\beta &amp; 1-\alpha\lambda_{i}
  \end{array}\!\!\right).
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span>=</span><span><span>R</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span></span><span>R</span></span><span>=</span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span><span>β</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span>.</span></span></span></span></span></dt-math>
  There are many ways of taking a matrix to the <dt-math>

<span><span><math><semantics><mrow><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">k^{th}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>k</span><span><span><span><span><span>​</span></span><span><span><span>t</span><span>h</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> power. But for the <dt-math>

<span><span><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>2</span><span>×</span><span>2</span></span></span></span></dt-math> case there is an elegant and little known formula <dt-cite key="williamsnthpower"><span id="citation-6" data-hover-ref="dt-cite-hover-box-6"><span>[9]</span></span></dt-cite> in terms of the eigenvalues of <dt-math>

<span><span><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>R</span></span></span></span></dt-math>, <dt-math>

<span><span><math><semantics><mrow><msub><mi>σ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msub><mi>σ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_2</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>.

  <dt-math block="">

<span><span><span><math><semantics><mrow><mstyle mathcolor="#AAA"><mstyle mathcolor="black"><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup></mstyle><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mstyle mathcolor="black"><msubsup><mi>σ</mi><mrow><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup></mstyle><msub><mi>R</mi><mrow><mn>1</mn></mrow></msub><mo>−</mo><mstyle mathcolor="black"><msubsup><mi>σ</mi><mrow><mn>2</mn></mrow><mrow><mi>k</mi></mrow></msubsup></mstyle><msub><mi>R</mi><mrow><mn>2</mn></mrow></msub></mrow></mtd><mtd><mrow><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mo>≠</mo><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>σ</mi><mrow><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><mo>(</mo><mi>k</mi><mi>R</mi><mi mathvariant="normal">/</mi><msub><mi>σ</mi><mn>1</mn></msub><mo>−</mo><mo>(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo>)</mo><mi>I</mi><mo>)</mo></mrow></mtd><mtd><mrow><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr></mtable></mrow><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>R</mi><mrow><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>R</mi><mo>−</mo><msub><mi>σ</mi><mrow><mi>j</mi></mrow></msub><mi>I</mi></mrow><mrow><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">
\color{#AAA}{\color{black}{R^{k}}=\begin{cases}
\color{black}{\sigma_{1}^{k}}R_{1}-\color{black}{\sigma_{2}^{k}}R_{2} &amp; \sigma_{1}\neq\sigma_{2}\\
\sigma_{1}^{k}(kR/\sigma_1-(k-1)I) &amp; \sigma_{1}=\sigma_{2}
\end{cases},\qquad R_{j}=\frac{R-\sigma_{j}I}{\sigma_{1}-\sigma_{2}}}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span><span><span>{</span></span></span><span><span><span><span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>k</span><span>R</span><span>/</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span><span>I</span><span>)</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>≠</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span><span></span></span><span>,</span><span><span></span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>j</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>R</span><span>−</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>j</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>I</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></dt-math>

  This formula is rather complicated, but the takeaway here is that it plays the exact same role the individual convergence rates, <dt-math>

<span><span><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1-\alpha\lambda_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> do in gradient descent. But instead of one geometric series, we have two coupled series, which may have real or complex values. The convergence rate is therefore the slowest of the two rates, <dt-math>

<span><span><math><semantics><mrow><mi>max</mi><mo>{</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\max\{|\sigma_{1}|,|\sigma_{2}|\}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>max</span><span>{</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>,</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span></span></span></span></dt-math>
  <dt-fn><sup><span id="fn-4" data-hover-ref="dt-fn-hover-box-3">4</span></sup></dt-fn>. By plotting this out, we see there are distinct regions of the parameter space which reveal a rich taxonomy of convergence behavior <dt-cite key="flammarion2015averaging"><span id="citation-7" data-hover-ref="dt-cite-hover-box-7"><span>[10]</span></span></dt-cite>:
  </p>

  <figure id="momentum2D">
    <div>
      
      
      <p>
        Convergence Rate

      </p>

      <figcaption>
      A plot of <dt-math>

<span><span><math><semantics><mrow><mi>max</mi><mo>{</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\max\{|\sigma_1|, |\sigma_2|\}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>max</span><span>{</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>,</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span></span></span></span></dt-math> reveals distinct regions, each with its own style of convergence.
      </figcaption>

    </div>
    
    <svg id="momentumOverlay" style="position:absolute; width:984px; height:540px; z-index:4; pointer-events:none"></svg>
  </figure>
  
  
  <p>

  For what values of <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math> does momentum converge? Since we need both <dt-math>

<span><span><math><semantics><mrow><msub><mi>σ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msub><mi>σ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_2</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> to converge, our convergence criterion is now <dt-math>

<span><span><math><semantics><mrow><mi>max</mi><mo>{</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo>}</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\max\{|\sigma_{1}|,|\sigma_{2}|\} &lt; 1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>max</span><span>{</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>,</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span><span>&lt;</span><span>1</span></span></span></span></dt-math>. The range of available step-sizes work out <dt-fn><sup><span id="fn-5" data-hover-ref="dt-fn-hover-box-4">5</span></sup></dt-fn> to be

  <dt-math block="">

<span><span><span><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo>&lt;</mo><mn>2</mn><mo>+</mo><mn>2</mn><mi>β</mi><mspace width="2em"></mspace><mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mtext><mspace width="2em"></mspace><mn>0</mn><mo>≤</mo><mi>β</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0&lt;\alpha\lambda_{i}&lt;2+2\beta \qquad \text{for} \qquad 0 \leq \beta &lt; 1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>0</span><span>&lt;</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>&lt;</span><span>2</span><span>+</span><span>2</span><span>β</span><span><span></span><span>for</span></span><span><span></span><span>0</span></span><span>≤</span><span>β</span><span>&lt;</span><span>1</span></span></span></span></span></dt-math>

  We recover the previous result for gradient descent when <dt-math>

<span><span><math><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta = 0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span><span>=</span><span>0</span></span></span></span></dt-math>. But notice an immediate boon we get. Momentum allows us to crank up the step-size up by a factor of 2 before diverging.
  </p>
  <hr/>
  <h3>The Critical Damping Coefficient</h3>

  <p>
  The true magic happens, however, when we find the sweet spot of <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math>. Let us try to first optimize over <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math>.
  </p>

  <p>
  Momentum admits an interesting physical interpretation when <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> is <dt-cite key="qian1999momentum"><span id="citation-8" data-hover-ref="dt-cite-hover-box-8"><span>[11]</span></span></dt-cite> small: it is a discretization of a damped harmonic oscillator. Consider a physical simulation operating in discrete time (like a video game).
  </p>

  <figure id="momentum_annotations">

  <div>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">y_{i}^{k+1}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>=</span></span></span></span></span></dt-math>
  </span>


  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\lambda_{i}x_{i}^{k}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  and perturbed by an external force field
  </figcaption>

  <figcaption>
  We can think of <dt-math>

<span><span><math><semantics><mrow><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">-y_i^k</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>−</span><span><span>y</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> as <b>velocity</b>
  </figcaption>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>β</mi><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\beta y_{i}^{k}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  which is dampened at each step
  </figcaption>


  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">x_i^{k+1}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>=</span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup><mo>−</mo><mi>α</mi><msubsup><mi>y</mi><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">x_i^k - \alpha y_i^{k+1}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>y</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  And <dt-math>

<span><span><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>x</span></span></span></span></dt-math> is our particle’s <b>position</b>
  </figcaption>

  <figcaption>
  which is moved at each step by a small amount in the direction of the velocity <dt-math>

<span><span><math><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">y^{k+1}_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>.
  </figcaption>


  </div>
  </figure>

  
  <p>
  We can break this equation apart to see how each component affects the dynamics of the system. Here we plot, for <dt-math>

<span><span><math><semantics><mrow><mn>1</mn><mn>5</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">150</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span><span>5</span><span>0</span></span></span></span></dt-math> iterates, the particle’s velocity (the horizontal axis) against its position (the vertical axis), in a phase diagram.
  </p>

  
  <figure id="phasediagram0">
  
  </figure>
  
  <p>
  This system is best imagined as a weight suspended on a spring. We pull the weight down by one unit, and we study the path it follows as it returns to equilibrium. In the analogy, the spring is the source of our external force <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">\lambda_ix^k_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, and equilibrium is the state when both the position <dt-math>

<span><span><math><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">x^k_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and the speed <dt-math>

<span><span><math><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">y^k_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> are 0. The choice of <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math> crucially affects the rate of return to equilibrium.
  </p>
  <figure id="phasediagram1"></figure>
  
  
  
  
  <p>
  The critical value of <dt-math>

<span><span><math><semantics><mrow><mi>β</mi><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><msqrt><mrow><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub></mrow></msqrt><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\beta = (1 - \sqrt{\alpha \lambda_i})^2</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span><span>=</span><span>(</span><span>1</span><span>−</span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> gives us a convergence rate (in eigenspace <dt-math>

<span><span><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>i</span></span></span></span></dt-math>) of <dt-math>

<span><span><math><semantics><mrow><mn>1</mn><mo>−</mo><msqrt><mrow><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub></mrow></msqrt><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">1 - \sqrt{\alpha\lambda_i}.</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span><span>−</span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>.</span></span></span></span></dt-math> A square root improvement over gradient descent, <dt-math>

<span><span><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1-\alpha\lambda_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>! Alas, this only applies to the error in the <dt-math>

<span><span><math><semantics><mrow><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>i</span><span><span><span><span><span>​</span></span><span><span><span>t</span><span>h</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> eigenspace, with <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> fixed.
  </p>

  <h3>Optimal parameters</h3>
  <p>
  To get a global convergence rate, we must optimize over both <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math>. This is a more complicated affair,<dt-fn><sup><span id="fn-6" data-hover-ref="dt-fn-hover-box-5">6</span></sup></dt-fn> but they work out to be
  <dt-math block="">

<span><span><span><math><semantics><mrow><mi>α</mi><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mn>2</mn></mrow><mrow><msqrt><mrow><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub></mrow></msqrt><mo>+</mo><msqrt><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></msqrt></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mspace width="1em"></mspace><mi>β</mi><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><msqrt><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></msqrt><mo>−</mo><msqrt><mrow><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><msqrt><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></msqrt><mo>+</mo><msqrt><mrow><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub></mrow></msqrt></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
  \alpha = \left(\frac{2}{\sqrt{\lambda_{1}}+\sqrt{\lambda_{n}}}\right)^{2}  \quad \beta = \left(\frac{\sqrt{\lambda_{n}}-\sqrt{\lambda_{1}}}{\sqrt{\lambda_{n}}+\sqrt{\lambda_{1}}}\right)^{2}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span><span>=</span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span></span><span>β</span></span><span>=</span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>−</span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  Plug this into the convergence rate, and you get
  </p>
  <figure id="conv_rate_comparisons">
  <div>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>−</mo><mn>1</mn></mrow><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\sqrt{\kappa}-1}{\sqrt{\kappa}+1}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  Convergence rate, <b>Momentum</b>
  </figcaption>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mi>κ</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>κ</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{\kappa-1}{\kappa+1}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>κ</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>κ</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  Convergence rate, <b>Gradient Descent</b>
  </figcaption>
  </div>
  </figure>
  
  <p>
  With barely a modicum of extra effort, we have essentially square rooted the condition number! These gains, in principle, require explicit knowledge of <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> and <dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. But the formulas reveal a simple guideline. When the problem’s conditioning is poor, the optimal <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> is approximately twice that of gradient descent, and the momentum term is close to <dt-math>

<span><span><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span></span></span></span></dt-math>. So set <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math> as close to <dt-math>

<span><span><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span></span></span></span></dt-math> as you can, and then find the highest <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math> which still converges. Being at the knife’s edge of divergence, like in gradient descent, is a good place to be.
  </p>

  <figure id="milestonesMomentumFig">
  <figcaption>We can do the same decomposition here with momentum, with eigenvalues
    <span><dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_1=0.01</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span><span>.</span><span>0</span><span>1</span></span></span></span></dt-math></span>,
    <span><dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_2=0.1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span><span>.</span><span>1</span></span></span></span></dt-math></span>, and
    <span><dt-math>

<span><span><math><semantics><mrow><msub><mi>λ</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_3=1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>3</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>1</span></span></span></span></dt-math></span>. Though the decrease is no longer monotonic, but significantly faster. </figcaption>
  <figcaption> <dt-math>

<span><span><math><semantics><mrow><mi>f</mi><mo>(</mo><msup><mi>w</mi><mi>k</mi></msup><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">f(w^k) - f(w^\star)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>−</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math></figcaption>
  <figcaption> Note that the optimal parameters do not necessarily imply the fastest convergence, though, only the fastest asymptotic convergence rate. </figcaption>

  <p>Step-size α = </p>
  <p>Momentum β = </p>

  
  
  </figure>
  
  <p>
  While the loss function of gradient descent had a graceful, monotonic curve, optimization with momentum displays clear oscillations. These ripples are not restricted to quadratics, and occur in all kinds of functions in practice. They are not cause for alarm, but are an indication that extra tuning of the hyperparameters is required.
  </p>
  <hr/>
  <h2>Example: The Colorization Problem</h2>

  <p>
  Let’s look at how momentum accelerates convergence with a concrete example. On a grid of pixels let <dt-math>

<span><span><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>G</span></span></span></span></dt-math> be the graph with vertices as pixels, <dt-math>

<span><span><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>E</span></span></span></span></dt-math> be the set of edges connecting each pixel to its four neighboring pixels, and <dt-math>

<span><span><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>D</span></span></span></span></dt-math> be a small set of a few distinguished vertices. Consider the problem of minimizing
  </p>
  <figure id="colorizer_equation">
  <div>
  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mtext></mrow><annotation encoding="application/x-tex">\text{minimize} </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>minimize</span></span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mspace width="2em"></mspace><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>D</mi></mrow></msub><mo>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\qquad  \frac{1}{2} \sum_{i\in D} (w_i - 1)^2 </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>∈</span><span>D</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span>​</span></span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>1</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  The <b>colorizer</b> pulls distinguished pixels towards 1
  </figcaption>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msub><mo>∑</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>∈</mo><mi>E</mi></mrow></msub><mo>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{1}{2} \sum_{i,j\in E} (w_i - w_j)^2.</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>,</span><span>j</span><span>∈</span><span>E</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span>​</span></span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>j</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span>2</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  The <b>smoother</b> spreads out the color
  </figcaption>
  </div>
  </figure>
  
  <p>
  The optimal solution to this problem is a vector of all <dt-math>

<span><span><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span></span></span></span></dt-math>’s <dt-fn><sup><span id="fn-7" data-hover-ref="dt-fn-hover-box-6">7</span></sup></dt-fn>. An inspection of the gradient iteration reveals why we take a long time to get there. The gradient step, for each component, is some form of weighted average of the current value and its neighbors:

  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>−</mo><mi>α</mi><msub><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mi>N</mi></mrow></msub><mo>(</mo><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>−</mo><msubsup><mi>w</mi><mrow><mi>j</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>)</mo><mo>−</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>α</mi><mo>(</mo><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo>−</mo><mn>1</mn><mo>)</mo></mrow></mtd><mtd><mrow><mi>i</mi><mo>∈</mo><mi>D</mi></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mi>i</mi><mo>∉</mo><mi>D</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
w_{i}^{k+1}=w_{i}^{k}-\alpha\sum_{j\in N}(w_{i}^{k}-w_{j}^{k})-\begin{cases}
\alpha(w_{i}^{k}-1) &amp; i\in D\\
0 &amp; i\notin D
\end{cases}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span><span><span><span>​</span></span><span><span><span>j</span><span>∈</span><span>N</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span>​</span></span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>j</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>−</span><span><span><span>{</span></span><span><span><span><span><span><span><span>​</span></span><span><span>α</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>1</span><span>)</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span><span><span><span><span>​</span></span><span><span>i</span><span>∈</span><span>D</span></span></span><span><span><span>​</span></span><span><span>i</span><span>∉</span><span>D</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span><span></span></span></span></span></span></span></dt-math>

  This kind of local averaging is effective at smoothing out local variations in the pixels, but poor at taking advantage of global structure. The updates are akin to a drop of ink, diffusing through water. Movement towards equilibrium is made only through local corrections and so, left undisturbed, its march towards the solution is slow and laborious. Fortunately, momentum speeds things up significantly.
  </p>
  <figure id="flow">

  <figcaption>
      The eigenvectors of the colorization problem form a generalized Fourier basis for <dt-math>

<span><span><math><semantics><mrow><msup><mi>R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">R^n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>R</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. The smallest eigenvalues have low frequencies, hence gradient descent corrects high frequency errors well but not low frequency ones.
  </figcaption>

  </figure>
  
  
  <p>
  In vectorized form, the colorization problem is
  </p>

  <figure>

  <div>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mtext></mrow><annotation encoding="application/x-tex">\text{minimize}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>minimize</span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  The <b>smoother</b>’s quadratic form is the <b>Graph Laplacian</b>
  </figcaption>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>D</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi>x</mi><mrow><mi>T</mi></mrow></msup><msub><mi>e</mi><mrow><mi>i</mi></mrow></msub><msubsup><mi>e</mi><mrow><mi>i</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mi>x</mi><mo>−</mo><msubsup><mi>e</mi><mrow><mi>i</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mi>x</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{2}\sum_{i\in D}\left(x^{T}e_{i}e_{i}^{T}x-e_{i}^{T}x\right)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>∈</span><span>D</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span>(</span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>x</span><span>−</span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>x</span><span><span>)</span></span></span></span></span></span></span></dt-math>
  </span>


  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mi>x</mi><mrow><mi>T</mi></mrow></msup><msub><mi>L</mi><mrow><mi>G</mi></mrow></msub><mi>x</mi></mrow><annotation encoding="application/x-tex">\frac{1}{2}x^{T}L_{G}x</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>L</span><span><span><span><span><span>​</span></span><span><span><span>G</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>x</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  And the colorizer is a small low rank correction with a linear term. <dt-math>

<span><span><math><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">e_i</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>e</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> is the <dt-math>

<span><span><math><semantics><mrow><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>i</span><span><span><span><span><span>​</span></span><span><span><span>t</span><span>h</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> unit vector.
  </figcaption>
  </div>
  </figure>
  <p>
  The Laplacian matrix, <dt-math>

<span><span><math><semantics><mrow><msub><mi>L</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">L_G</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>L</span><span><span><span><span><span>​</span></span><span><span>G</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>
  <dt-fn><sup><span id="fn-8" data-hover-ref="dt-fn-hover-box-7">8</span></sup></dt-fn>, which dominates the behavior of the optimization problem, is a valuable bridge between linear algebra and graph theory. This is a rich field of study, but one fact is pertinent to our discussion here. The conditioning of <dt-math>

<span><span><math><semantics><mrow><msub><mi>L</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">L_G</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>L</span><span><span><span><span><span>​</span></span><span><span>G</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, here defined as the ratio of the second eigenvector to the last (the first eigenvalue is always 0, with eigenvector equal to the matrix of all 1′s), is directly connected to the connectivity of the graph.
  </p>
  <figure id="laplacianConditioning">
  <svg width="900" height="300" id="graph"></svg>
  <figcaption id="expander">Small world graphs, like expanders and dense graphs, have excellent conditioning</figcaption>

  <figcaption id="expander">The conditioning of grids improves with its dimensionality.</figcaption>

  <figcaption id="expander">And long, wiry graphs, like paths, condition poorly. </figcaption>

  </figure>
  
  
  <p>

  These observations carry through to the colorization problem, and the intuition behind it should be clear. Well connected graphs allow rapid diffusion of information through the edges, while graphs with poor connectivity do not. And this principle, taken to the extreme, furnishes a class of functions so hard to optimize they reveal the limits of first order optimization.
  </p>
<hr/>
  <h2>
  The Limits of Descent
  </h2>
  <p>
  Let’s take a step back. We have, with a clever trick, improved the convergence of gradient descent by a quadratic factor with the introduction of a single auxiliary sequence. But is this the best we can do? Could we improve convergence even more with two sequences? Could one perhaps choose the <dt-math>

<span><span><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span></span></span></span></dt-math>’s and <dt-math>

<span><span><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>β</span></span></span></span></dt-math>’s intelligently and adaptively? It is tempting to ride this wave of optimism - to the cube root and beyond!
  </p>
  <p>
  Unfortunately, while improvements to the momentum algorithm do exist, they all run into a certain, critical, almost inescapable lower bound.
  </p>
  <h3>Adventures in Algorithmic Space</h3>
  <p>
  To understand the limits of what we can do, we must first formally define the algorithmic space in which we are searching. Here’s one possible definition. The observation we will make is that both gradient descent and momentum can be “unrolled”. Indeed, since
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>w</mi><mrow><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><mo>=</mo></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mn>2</mn></mrow></msup></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><mo>=</mo></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><msup><mi>w</mi><mrow><mn>1</mn></mrow></msup><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><mo>=</mo></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mo>)</mo><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mn>1</mn></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mtext> </mtext><mspace width="-0.16667em"></mspace><mi mathvariant="normal">⋮</mi></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><mo>=</mo></mrow></mtd><mtd><mrow><mspace width="-0.16667em"></mspace><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mo>)</mo><mtext> </mtext><mo>−</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo>⋯</mo><mo>⋯</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>)</mo></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{array}{lll}
    w^{1} &amp; \!= &amp; \!w^{0} ~-~ \alpha\nabla f(w^{0})\\[0.35em]
    w^{2} &amp; \!= &amp; \!w^{1} ~-~ \alpha\nabla f(w^{1})\\[0.35em]
          &amp; \!= &amp; \!w^{0} ~-~ \alpha\nabla f(w^{0}) ~-~ \alpha\nabla f(w^{1})\\[0.35em]
     &amp; ~ \!\vdots \\

   w^{k+1} &amp; \!= &amp; \!w^{0} ~-~ \alpha\nabla f(w^{0}) ~-~~~~ \cdots\cdots ~~~~-~ \alpha\nabla f(w^{k})
  \end{array}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span></span><span>=</span></span></span></span><span><span><span>​</span></span><span><span><span></span><span>=</span></span></span></span><span><span><span>​</span></span><span><span><span></span><span>=</span></span></span></span><span><span><span>​</span></span><span><span><span> </span><span></span><span>⋮</span></span></span></span><span><span><span>​</span></span><span><span><span></span><span>=</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span></span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span><span></span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span><span></span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span><span></span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span> </span><span>−</span></span><span><span> </span><span> </span><span> </span><span> </span><span>⋯</span></span><span>⋯</span><span><span> </span><span> </span><span> </span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></span></dt-math>
  we can write gradient descent as

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>α</mi><msubsup><mo>∑</mo><mi>i</mi><mi>k</mi></msubsup><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>i</mi></mrow></msup><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  w^{k+1} ~~=~~ w^{0} ~-~ \alpha\sum_i^k\nabla f(w^{i}).
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span> </span><span>=</span></span><span><span> </span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>−</span></span><span><span> </span><span>α</span></span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>.</span></span></span></span></span></dt-math>

  A similar trick can be done with momentum:

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><mi>α</mi><msubsup><mo>∑</mo><mi>i</mi><mi>k</mi></msubsup><mfrac><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msup><mi>β</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi></mrow></msup><mo>)</mo></mrow><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow></mfrac><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mi>i</mi></msup><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  w^{k+1} ~~=~~ w^{0} ~+~ \alpha\sum_i^k\frac{(1-\beta^{k+1-i})}{1-\beta}\nabla f(w^i).
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span> </span><span>=</span></span><span><span> </span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>+</span></span><span><span> </span><span>α</span></span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>1</span><span>−</span><span>β</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>(</span><span>1</span><span>−</span><span><span>β</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span><span>−</span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span>.</span></span></span></span></span></dt-math>

  In fact, all manner of first order algorithms, including the Conjugate Gradient algorithm, AdaMax, Averaged Gradient and more, can be written (though not quite so neatly) in this unrolled form. Therefore the class of algorithms for which

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><msubsup><mo>∑</mo><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><msubsup><mi>γ</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>i</mi></mrow></msup><mo>)</mo><mspace width="2em"></mspace><mtext><mtext> </mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mtext> </mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mtext> </mtext></mtext><msubsup><mi>γ</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">
  w^{k+1} ~~=~~ w^{0} ~+~ \sum_{i}^{k}\gamma_{i}^{k}\nabla f(w^{i}) \qquad \text{ for some } \gamma_{i}^{k}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span> </span><span>=</span></span><span><span> </span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>+</span></span><span><span> </span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>γ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span></span><span> for some </span></span><span><span>γ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>

  contains momentum, gradient descent and a whole bunch of other algorithms you might dream up. This is what is assumed in Assumption 2.1.4 <dt-cite key="nesterov2013introductory"><span id="citation-9" data-hover-ref="dt-cite-hover-box-9"><span>[5]</span></span></dt-cite> of Nesterov. But let’s push this even further, and expand this class to allow different step-sizes for different directions.

  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><msubsup><mo>∑</mo><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><msubsup><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msup><mi>w</mi><mrow><mi>i</mi></mrow></msup><mo>)</mo><mspace width="1em"></mspace><mtext><mtext> </mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mtext> </mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mtext> </mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext> </mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mtext> </mtext></mtext><msubsup><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  w^{k+1} ~~=~~ w^{0} ~+~ \sum_{i}^{k}\Gamma_{i}^{k}\nabla f(w^{i}) \quad \text{ for some diagonal matrix } \Gamma_{i}^{k} .
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span> </span><span>=</span></span><span><span> </span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span> </span><span>+</span></span><span><span> </span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>Γ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∇</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span></span><span> for some diagonal matrix </span></span><span><span>Γ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span></span></span></dt-math>

  This class of methods covers most of the popular algorithms for training neural networks, including ADAM and AdaGrad. We shall refer to this class of methods as “Linear First Order Methods”, and we will show a single function all these methods ultimately fail on.

  </p>
  <h3>The Resisting Oracle</h3>
  <p>
  Earlier, when we talked about the colorizer problem, we observed that wiry graphs cause bad conditioning in our optimization problem. Taking this to its extreme, we can look at a graph consisting of a single path — a function so badly conditioned that Nesterov called a variant of it “the worst function in the world”. The function follows the same structure as the colorizer problem, and we shall call this the Convex Rosenbrock,
  </p>
  <figure>

  <div>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>f</mi><mi>n</mi></msup><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f^n(w)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>f</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>w</span><span>)</span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>=</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  with a colorizer of one node
  </figcaption>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mrow><mo fence="true">(</mo><msub><mi>w</mi><mrow><mn>1</mn></mrow></msub><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\frac{1}{2}\left(w_{1}-1\right)^{2}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>1</span><span>)</span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>

  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mo>(</mo><msub><mi>w</mi><mrow><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\frac{1}{2}\sum_{i=1}^{n}(w_{i}-w_{i+1})^{2}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  strong couplings of adjacent nodes in the path,
  </figcaption>

  <p><span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>
  <span>
    <dt-math block="">

<span><span><span><math><semantics><mrow><mfrac><mrow><mn>2</mn></mrow><mrow><mi>κ</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi mathvariant="normal">∥</mi><mi>w</mi><msup><mi mathvariant="normal">∥</mi><mrow><mn>2</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{2}{\kappa-1}\|w\|^{2}.</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>κ</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>∥</span><span>w</span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  and a small regularization term.
  </figcaption>

  </div>
  </figure>
  <p>
  The optimal solution of this problem is

  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mo>⋆</mo></mrow></msubsup><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>−</mo><mn>1</mn></mrow><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>+</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mi>i</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
  w_{i}^{\star}=\left(\frac{\sqrt{\kappa}-1}{\sqrt{\kappa}+1}\right)^{i}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></dt-math>

  and the condition number of the problem <dt-math>

<span><span><math><semantics><mrow><msup><mi>f</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">f^n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>f</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> approaches <dt-math>

<span><span><math><semantics><mrow><mi>κ</mi></mrow><annotation encoding="application/x-tex">\kappa</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>κ</span></span></span></span></dt-math> as <dt-math>

<span><span><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span></span></span></span></dt-math> goes to infinity. Now observe the behavior of the momentum algorithm on this function, starting from <dt-math>

<span><span><math><semantics><mrow><msup><mi>w</mi><mn>0</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w^0 = 0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span></span></span></span></dt-math>.
  </p>

  <figure id="rosenViz">
    
    <p>Step-size α = </p>
    <p>Momentum β = </p>

    <figcaption>Here we see the first 50 iterates of momentum on the Convex Rosenbrock for <dt-math>

<span><span><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mn>5</mn></mrow><annotation encoding="application/x-tex">n=25</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span><span>=</span><span>2</span><span>5</span></span></span></span></dt-math>. The behavior here is similar to that of any Linear First Order Algorithm. </figcaption>

    <div>
    <figcaption>This triangle is a “dead zone” of our iterates. The iterates are always 0, no matter what the parameters. </figcaption>
    <figcaption>The remaining expanding space is the “light cone” of our iterate’s influence. Momentum does very well here with the optimal parameters. </figcaption>
    
    <p>Error</p>
    
    <p>Weights</p>
    
    </div>
  </figure>
  
  <p>
  The observations made in the above diagram are true for any Linear First Order algorithm. Let us prove this. First observe that each component of the gradient depends only on the values directly before and after it:

  <dt-math block="">

<span><span><span><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><mi>x</mi><msub><mo>)</mo><mrow><mi>i</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>w</mi><mrow><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mfrac><mrow><mn>4</mn></mrow><mrow><mi>κ</mi><mo>−</mo><mn>1</mn></mrow></mfrac><msub><mi>w</mi><mrow><mi>i</mi></mrow></msub><mo separator="true">,</mo><mspace width="2em"></mspace><mi>i</mi><mo>≠</mo><mn>1</mn><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\nabla f(x)_{i}=2w_{i}-w_{i-1}-w_{i+1} +\frac{4}{\kappa-1} w_{i}, \qquad i \neq 1.
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∇</span><span>f</span><span>(</span><span>x</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>2</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>κ</span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>4</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span><span></span><span>i</span></span><span>≠</span><span>1</span><span>.</span></span></span></span></span></dt-math>

  Therefore the fact we start at 0 guarantees that that component must remain stoically there till an element either before or after it turns nonzero. And therefore, by induction, for any linear first order algorithm,
  </p>
  <p>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>[</mo><mtext> </mtext><mtext> </mtext><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mtext> </mtext><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>[</mo><mtext> </mtext><msubsup><mi>w</mi><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mtext> </mtext><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mn>2</mn></mrow></msup></mrow></mtd><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>[</mo><mtext> </mtext><msubsup><mi>w</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><msubsup><mi>w</mi><mrow><mn>2</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mtext> </mtext><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mtext> </mtext><mi mathvariant="normal">⋮</mi></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup></mrow></mtd><mtd><mrow><mo>=</mo></mrow></mtd><mtd><mrow><mo>[</mo><mtext> </mtext><msubsup><mi>w</mi><mrow><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><msubsup><mi>w</mi><mrow><mn>2</mn></mrow><mrow><mi>k</mi></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><msubsup><mi>w</mi><mrow><mn>3</mn></mrow><mrow><mi>k</mi></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><msubsup><mi>w</mi><mrow><mi>k</mi></mrow><mrow><mi>k</mi></mrow></msubsup><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mo>…</mo></mrow></mtd><mtd><mrow><mn>0</mn><mtext> </mtext><mo>]</mo><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{array}{lllllllll}
    w^{0} &amp; = &amp; [~~0, &amp; 0, &amp; 0, &amp; \ldots &amp; 0, &amp; 0, &amp; \ldots &amp; 0~]\\[0.35em]
    w^{1} &amp; = &amp; [~w_{1}^{1}, &amp; 0, &amp; 0, &amp; \ldots &amp; 0, &amp; 0, &amp; \ldots &amp; 0~]\\[0.35em]
    w^{2} &amp; = &amp; [~w_{1}^{2}, &amp; w_{2}^{2}, &amp; 0, &amp; \ldots &amp; 0, &amp; 0, &amp; \ldots &amp; 0~]\\[0.35em]
     &amp; ~ \vdots \\
   w^{k} &amp; = &amp; [~w_{1}^{k}, &amp; w_{2}^{k}, &amp; w_{3}^{k}, &amp; \ldots &amp;  w_{k}^{k}, &amp; 0, &amp; \ldots &amp; 0~].\\
  \end{array}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>=</span></span></span><span><span><span>​</span></span><span><span>=</span></span></span><span><span><span>​</span></span><span><span>=</span></span></span><span><span><span>​</span></span><span><span><span> </span><span>⋮</span></span></span></span><span><span><span>​</span></span><span><span>=</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>[</span><span><span> </span><span> </span><span>0</span></span><span>,</span></span></span><span><span><span>​</span></span><span><span>[</span><span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span><span><span>[</span><span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span><span><span>[</span><span><span> </span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>3</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span><span><span>0</span><span>,</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span><span><span>…</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span><span><span> </span><span>]</span></span></span></span><span><span><span>​</span></span><span><span>0</span><span><span> </span><span>]</span></span></span></span><span><span><span>​</span></span><span><span>0</span><span><span> </span><span>]</span></span></span></span><span><span><span>​</span></span><span><span>0</span><span><span> </span><span>]</span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span></span></span></span></span></dt-math>
  </p>
  <p>
  Think of this restriction as a “speed of light” of information transfer. Error signals will take at least <dt-math>

<span><span><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>k</span></span></span></span></dt-math> steps to move from <dt-math>

<span><span><math><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> to <dt-math>

<span><span><math><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">w_k</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. We can therefore sum up the errors which cannot have changed yet<dt-fn><sup><span id="fn-9" data-hover-ref="dt-fn-hover-box-8">9</span></sup></dt-fn>:

  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><mi mathvariant="normal">∥</mi><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><msup><mi>w</mi><mrow><mo>⋆</mo></mrow></msup><msub><mi mathvariant="normal">∥</mi><mrow><mi mathvariant="normal">∞</mi></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>≥</mo><msub><mi>max</mi><mrow><mi>i</mi><mo>≥</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>{</mo><mi mathvariant="normal">∣</mi><msubsup><mi>w</mi><mrow><mi>i</mi></mrow><mrow><mo>⋆</mo></mrow></msubsup><mi mathvariant="normal">∣</mi><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>−</mo><mn>1</mn></mrow><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>+</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>−</mo><mn>1</mn></mrow><mrow><msqrt><mrow><mi>κ</mi></mrow></msqrt><mo>+</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mi>k</mi></mrow></msup><mi mathvariant="normal">∥</mi><msup><mi>w</mi><mrow><mn>0</mn></mrow></msup><mo>−</mo><msup><mi>w</mi><mrow><mo>⋆</mo></mrow></msup><msub><mi mathvariant="normal">∥</mi><mrow><mi mathvariant="normal">∞</mi></mrow></msub><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
\|w^{k}-w^{\star}\|_{\infty}&amp;\geq\max_{i\geq k+1}\{|w_{i}^{\star}|\}\\[0.9em]&amp;=\left(\frac{\sqrt{\kappa}-1}{\sqrt{\kappa}+1}\right)^{k+1}\\[0.9em]&amp;=\left(\frac{\sqrt{\kappa}-1}{\sqrt{\kappa}+1}\right)^{k}\|w^{0}-w^{\star}\|_{\infty}.
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span>∥</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span><span>∞</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>≥</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>≥</span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>max</span></span></span><span><span><span>​</span></span>​</span></span></span><span>{</span><span>∣</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span><span><span>√</span></span><span><span><span><span>​</span></span><span><span>κ</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∥</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>⋆</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span><span>∞</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>

  As <dt-math>

<span><span><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>n</span></span></span></span></dt-math> gets large, the condition number of <dt-math>

<span><span><math><semantics><mrow><msup><mi>f</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">f^n</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>f</span><span><span><span><span><span>​</span></span><span><span>n</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math> approaches <dt-math>

<span><span><math><semantics><mrow><mi>κ</mi></mrow><annotation encoding="application/x-tex">\kappa</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>κ</span></span></span></span></dt-math>. And the gap therefore closes; the convergence rate that momentum promises matches the best any linear first order algorithm can do. And we arrive at the disappointing conclusion that on this problem, we cannot do better.
  </p>
  <p>
  Like many such lower bounds, this result must not be taken literally, but spiritually. It, perhaps, gives a sense of closure and finality to our investigation. But this is not the final word on first order optimization. This lower bound does not preclude the possibility, for example, of reformulating the problem to change the condition number itself! There is still much room for speedups, if you understand the right places to look.
  </p>
  <h2>Momentum with Stochastic Gradients</h2>

  <p>
  There is a final point worth addressing. All the discussion above assumes access to the true gradient — a luxury seldom afforded in modern machine learning. Computing the exact gradient requires a full pass over all the data, the cost of which can be prohibitively expensive. Instead, randomized approximations of the gradient, like minibatch sampling, are often used as a plug-in replacement of <dt-math>

<span><span><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\nabla f(w)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∇</span><span>f</span><span>(</span><span>w</span><span>)</span></span></span></span></dt-math>. We can write the approximation in two parts,
  </p>
  <figure id="truegradientpluserror">

  <div>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\nabla f(w)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∇</span><span>f</span><span>(</span><span>w</span><span>)</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  the true gradient
  </figcaption>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mtext><mo>(</mo><mi>w</mi><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\text{error}(w).</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>error</span></span><span>(</span><span>w</span><span>)</span><span>.</span></span></span></span></span></dt-math>
  </span></p><figcaption>
  and an approximation error. </figcaption>
  </div>
  </figure>
  

  <p>
  It is helpful to think of our approximate gradient as the injection of a special kind of noise into our iteration. And using the machinery developed in the previous sections, we can deal with this extra term directly. On a quadratic, the error term cleaves cleanly into a separate term, where <dt-fn><sup><span id="fn-10" data-hover-ref="dt-fn-hover-box-9">10</span></sup></dt-fn>
  </p>

  <figure id="iteratespluserror">

  <div>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">    \left(\begin{array}{c}
  y_{i}^{k}\\
  x_{i}^{k}
  \end{array}\right)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  the noisy iterates are a sum of
  </figcaption>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>=</span></span></span></span></span></dt-math>
  </span>

  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">R^{k}\left(\begin{array}{c}
  y_{i}^{0}\\
  x_{i}^{0}
  \end{array}\right)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  the noiseless, deterministic iterates and
  </figcaption>

  <p><span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>+</span></span></span></span></span></dt-math>
  </span>


  <span>
  <dt-math block="">

<span><span><span><math><semantics><mrow><msubsup><mi>ϵ</mi><mi>i</mi><mi>k</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi><mo>−</mo><mi>j</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon^k_i \sum_{j=1}^{k}R^{k-j}\left(\begin{array}{c}
1\\
-\alpha
\end{array}\right)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span>​</span></span><span><span><span>j</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>−</span><span>j</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span></span></span></span></span></dt-math>
  </span></p><figcaption>
  a decaying sum of the errors, where <dt-math>

<span><span><math><semantics><mrow><msup><mi>ϵ</mi><mi>k</mi></msup><mo>=</mo><mi>Q</mi><mo>⋅</mo><mtext><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mtext><mo>(</mo><msup><mi>w</mi><mi>k</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\epsilon^k = Q \cdot \text{error}(w^k)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>Q</span><span>⋅</span><span><span>error</span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math>.
  </figcaption>

  </div>
  </figure>
  
  <p>
  The error term, <dt-math>

<span><span><math><semantics><mrow><msup><mi>ϵ</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\epsilon^k</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, with its dependence on the <dt-math>

<span><span><math><semantics><mrow><msup><mi>w</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">w^k</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, is a fairly hairy object. Following <dt-cite key="flammarion2015averaging"><span id="citation-10" data-hover-ref="dt-cite-hover-box-10"><span>[10]</span></span></dt-cite>, we model this as independent 0-mean Gaussian noise. In this simplified model, the objective also breaks into two separable components, a sum of a deterministic error and a stochastic error
     <dt-fn><sup><span id="fn-11" data-hover-ref="dt-fn-hover-box-10">11</span></sup></dt-fn>, visualized here.
  </p>
  
  <figure id="stochastic">
  <figcaption>We decompose the expected value of the objective value <dt-math>

<span><span><math><semantics><mrow><mrow><mi mathvariant="bold">E</mi></mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathbf{E} f(w) - f(w^\star)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>E</span></span><span>f</span><span>(</span><span>w</span><span>)</span><span>−</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math> into a deterministic part <svg style="position:relative; top:2px; width:3px; height:14px; background:#e0ecf4"></svg> and a stochastic part <svg style="position:relative; top:2px; width:3px; height:14px; background:#9ebcda"></svg>. </figcaption>
  <figcaption> <span><dt-math>

<span><span><math><semantics><mrow><mrow><mi mathvariant="bold">E</mi></mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>f</mi><mo>(</mo><msup><mi>w</mi><mo>⋆</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathbf{E} f(w) - f(w^\star) </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>E</span></span><span>f</span><span>(</span><span>w</span><span>)</span><span>−</span><span>f</span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>⋆</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span></span></dt-math></span></figcaption>
  <figcaption> The small black dots are a single run of stochastic gradient</figcaption>

  <p>Step-size α = </p>
  <p>Momentum β = </p>

  <figcaption>As <dt-cite key="sutskever2013importance"><span id="citation-11" data-hover-ref="dt-cite-hover-box-11"><span>[1]</span></span></dt-cite> observes, the optimization has two phases. In the initial transient phase the magnitude of the noise is smaller than the magnitude of the gradient, and Momentum still makes good progress. In the second, stochastic phase, the noise overwhelms the gradient, and momentum is less effective.</figcaption>

  
  
  </figure>

  
  <p>
  Note that there are a set of unfortunate tradeoffs which seem to pit the two components of error against each other. Lowering the step-size, for example, decreases the stochastic error, but also slows down the rate of convergence. And increasing momentum, contrary to popular belief, causes the errors to compound. Despite these undesirable properties, stochastic gradient descent with momentum has still been shown to have competitive performance on neural networks. As <dt-cite key="sutskever2013importance"><span id="citation-12" data-hover-ref="dt-cite-hover-box-12"><span>[1]</span></span></dt-cite> has observed, the transient phase seems to matter more than the fine-tuning phase in machine learning. And in fact, it has been recently suggested <dt-cite key="zhang2016understanding"><span id="citation-13" data-hover-ref="dt-cite-hover-box-13"><span>[12]</span></span></dt-cite> that this noise is a good thing — it acts as a implicit regularizer, which, like early stopping, prevents overfitting in the fine-tuning phase of optimization.
  </p>
  <hr/>
  <h2>Onwards and Downwards</h2>
  <p>
  The study of acceleration is seeing a small revival within the optimization community. If the ideas in this article excite you, you may wish to read <dt-cite key="su2014differential"><span id="citation-14" data-hover-ref="dt-cite-hover-box-14"><span>[13]</span></span></dt-cite>, which fully explores the idea of momentum as the discretization of a certain differential equation. But other, less physical, interpretations exist. There is an algebraic interpretation of momentum in terms of approximating polynomials <dt-cite key="rutishauser1959theory,hardtzen"><span id="citation-15" data-hover-ref="dt-cite-hover-box-15"><span>[3, 14]</span></span></dt-cite>. Geometric interpretations are emerging <dt-cite key="bubeck2015geometric,drusvyatskiy2016optimal"><span id="citation-16" data-hover-ref="dt-cite-hover-box-16"><span>[15, 16]</span></span></dt-cite>, connecting momentum to older methods, like the Ellipsoid method. And finally, there are interpretations relating momentum to duality <dt-cite key="allen2014linear"><span id="citation-17" data-hover-ref="dt-cite-hover-box-17"><span>[17]</span></span></dt-cite>, perhaps providing a clue as how to accelerate second order methods and Quasi Newton (for a first step, see <dt-cite key="nesterov2008accelerating"><span id="citation-18" data-hover-ref="dt-cite-hover-box-18"><span>[18]</span></span></dt-cite>). But like the proverbial blind men feeling an elephant, momentum seems like something bigger than the sum of its parts. One day, hopefully soon, the many perspectives will converge into a satisfying whole.
  </p>
</div><div>


<div>


  <h3>Acknowledgments</h3>

  <p>
  I am deeply indebted to the editorial contributions of Shan Carter and Chris Olah, without which this article would be greatly impoverished. Shan Carter provided complete redesigns of many of my original interactive widgets, a visual coherence for all the figures, and valuable optimizations to the page’s performance. Chris Olah provided impeccable editorial feedback at all levels of detail and abstraction - from the structure of the content, to the alignment of equations.
  </p>
  <p>
  I am also grateful to Michael Nielsen for providing the title of this article, which really tied the article together. Marcos Ginestra provided editorial input for the earliest drafts of this article, and spiritual encouragement when I needed it the most. And my gratitude extends to my reviewers, Matt Hoffman and Anonymous Reviewer B for their astute observations and criticism. I would like to thank Reviewer B, in particular, for pointing out two non-trivial errors in the original manuscript (discussion <a href="https://github.com/distillpub/post--momentum/issues/34">here</a>). The contour plotting library for the hero visualization is the joint work of Ben Frederickson, Jeff Heer and Mike Bostock.
  </p>

  <p>
  Many thanks to the numerous pull requests and issues filed on github. Thanks in particular, to Osemwaro Pedro for spotting an off by one error in one of the equations. And also to Dan Schmidt who did an editing pass over the whole project, correcting numerous typographical and grammatical errors.
  </p>

  <h4>Discussion and Review</h4>
  <p>
  <a href="https://github.com/distillpub/post--momentum/issues/29">Reviewer A - Matt Hoffman</a></p>

<h3>Footnotes</h3><dt-fn-list><ol><li> It is possible, however, to construct very specific counterexamples where momentum does not converge, even on convex functions. See <dt-cite key="lessard2016analysis"><span id="citation-1" data-hover-ref="dt-cite-hover-box-1"><span>[4]</span></span></dt-cite> for a counterexample. </li><li>In Tikhonov Regression we add a quadratic penalty to the regression, minimizing
<dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mtext><mspace width="2em"></mspace><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mi mathvariant="normal">∥</mi><mi>Z</mi><mi>w</mi><mo>−</mo><mi>d</mi><msup><mi mathvariant="normal">∥</mi><mrow><mn>2</mn></mrow></msup><mo>+</mo><mfrac><mrow><mi>η</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mi mathvariant="normal">∥</mi><mi>w</mi><msup><mi mathvariant="normal">∥</mi><mrow><mn>2</mn></mrow></msup><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mi>w</mi><mrow><mi>T</mi></mrow></msup><mo>(</mo><msup><mi>Z</mi><mrow><mi>T</mi></mrow></msup><mi>Z</mi><mo>+</mo><mi>η</mi><mi>I</mi><mo>)</mo><mi>w</mi><mo>−</mo><mo>(</mo><mi>Z</mi><mi>d</mi><msup><mo>)</mo><mrow><mi>T</mi></mrow></msup><mi>w</mi></mrow><annotation encoding="application/x-tex">
\text{minimize}\qquad\tfrac{1}{2}\|Zw-d\|^{2}+\frac{\eta}{2}\|w\|^{2}=\tfrac{1}{2}w^{T}(Z^{T}Z+\eta I)w-(Zd)^{T}w
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>minimize</span></span><span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>∥</span><span>Z</span><span>w</span><span>−</span><span>d</span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>η</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>∥</span><span>w</span><span><span>∥</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span><span>Z</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>Z</span><span>+</span><span>η</span><span>I</span><span>)</span><span>w</span><span>−</span><span>(</span><span>Z</span><span>d</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>w</span></span></span></span></span></dt-math>
Recall that <dt-math>

<span><span><math><semantics><mrow><msup><mi>Z</mi><mrow><mi>T</mi></mrow></msup><mi>Z</mi><mo>=</mo><mi>Q</mi><mtext> </mtext><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mtext><mo>(</mo><msub><mi mathvariant="normal">Λ</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Λ</mi><mrow><mi>n</mi></mrow></msub><mo>)</mo><mtext> </mtext><msup><mi>Q</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">Z^{T}Z=Q\ \text{diag}(\Lambda_{1},\ldots,\Lambda_{n})\ Q^T</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>Z</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>Z</span><span>=</span><span>Q</span><span><span> </span><span>diag</span></span><span>(</span><span><span>Λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span>…</span><span>,</span><span><span>Λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span><span><span> </span><span>Q</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>. The solution to Tikhonov Regression is therefore
<dt-math block="">

<span><span><span><math><semantics><mrow><mo>(</mo><msup><mi>Z</mi><mrow><mi>T</mi></mrow></msup><mi>Z</mi><mo>+</mo><mi>η</mi><mi>I</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>(</mo><mi>Z</mi><mi>d</mi><mo>)</mo><mo>=</mo><mi>Q</mi><mtext> </mtext><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mrow><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi></mrow></mfrac><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub><mo>+</mo><mi>η</mi></mrow></mfrac><mo fence="true">)</mo></mrow><msup><mi>Q</mi><mi>T</mi></msup><mo>(</mo><mi>Z</mi><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">
(Z^{T}Z+\eta I)^{-1}(Zd)=Q\ \text{diag}\left(\frac{1}{\lambda_{1}+\eta},\cdots,\frac{1}{\lambda_{n}+\eta}\right)Q^T(Zd)
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>(</span><span><span>Z</span><span><span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>Z</span><span>+</span><span>η</span><span>I</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>Z</span><span>d</span><span>)</span><span>=</span><span>Q</span><span><span> </span><span>diag</span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>η</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>,</span><span>⋯</span><span>,</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>η</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>)</span></span></span><span><span>Q</span><span><span><span><span><span>​</span></span><span><span>T</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>(</span><span>Z</span><span>d</span><span>)</span></span></span></span></span></dt-math>
We can think of regularization as a function which decays the largest eigenvalues, as follows:
<dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mi mathvariant="normal">T</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">k</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mtext> </mtext><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mtext> </mtext></mtext><msub><mi>λ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo>+</mo><mi>η</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>η</mi><mo fence="true">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\text{Tikhonov Regularized } \lambda_i = \frac{1}{\lambda_{i}+\eta}=\frac{1}{\lambda_{i}}\left(1-\left(1+\lambda_{i}/\eta\right)^{-1}\right).
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>Tikhonov Regularized </span></span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>η</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span>(</span></span><span>1</span><span>−</span><span><span><span>(</span><span>1</span><span>+</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>/</span><span>η</span><span>)</span></span><span><span><span><span><span>​</span></span><span><span><span>−</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span></span></span><span>.</span></span></span></span></span></dt-math>
Gradient descent can be seen as employing a similar decay, but with the decay rate
<dt-math block="">

<span><span><span><math><semantics><mrow><mtext><mtext> </mtext><mi mathvariant="normal">G</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mtext> </mtext><mi mathvariant="normal">D</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mtext> </mtext><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mtext> </mtext></mtext><msub><mi>λ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mrow><mi>k</mi></mrow></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \text{ Gradient Descent Regularized } \lambda_i = \frac{1}{\lambda_i} \left( 1-\left(1-\alpha\lambda_{i}\right)^{k} \right)</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span> Gradient Descent Regularized </span></span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span>(</span></span><span>1</span><span>−</span><span><span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span></span></span></span></span></span></span></dt-math>
instead. Note that this decay is dependent on the step-size.
</li><li>
  This is true as we can write updates in matrix form as
  <dt-math block="">

<span><span><span><math><semantics><mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mi>α</mi></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mo fence="false">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="false">)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  \left(\!\!\begin{array}{cc}
  1 &amp; 0\\
  \alpha &amp; 1
  \end{array}\!\!\right)\Bigg(\!\!\begin{array}{c}
  y_{i}^{k+1}\\
  x_{i}^{k+1}
  \end{array}\!\!\Bigg)=\left(\!\!\begin{array}{cc}
  \beta &amp; \lambda_{i}\\
  0 &amp; 1
  \end{array}\!\!\right)\left(\!\!\begin{array}{c}
  y_{i}^{k}\\
  x_{i}^{k}
  \end{array}\!\!\right)
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span></span><span></span><span>)</span></span><span>=</span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span></span></span></span></span></dt-math>

  which implies, by inverting the matrix on the left,
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo fence="false">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="false">)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi><mi>β</mi></mrow></mtd><mtd><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mo>=</mo><msup><mi>R</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mn>0</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  \Bigg(\!\!\begin{array}{c}
  y_{i}^{k+1}\\
  x_{i}^{k+1}
  \end{array}\!\!\Bigg)=\left(\!\!\begin{array}{cc}
  \beta &amp; \lambda_{i}\\
  -\alpha\beta &amp; 1-\alpha\lambda_{i}
  \end{array}\!\!\right)\left(\!\!\begin{array}{c}
  y_{i}^{k}\\
  x_{i}^{k}
  \end{array}\!\!\right)=R^{k+1}\left(\!\!\begin{array}{c}
  x_{i}^{0}\\
  y_{i}^{0}
  \end{array}\!\!\right)
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span></span><span></span><span>)</span></span><span>=</span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span><span>β</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span>=</span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span></span></span></span></span></dt-math>

  </li><li>
We can write out the convergence rates explicitly. The eigenvalues are
<dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>+</mo><msqrt><mrow><mo>(</mo><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>4</mn><mi>β</mi></mrow></msqrt><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>−</mo><msqrt><mrow><mo>(</mo><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>4</mn><mi>β</mi></mrow></msqrt><mo fence="true">)</mo></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
\sigma_{1} &amp; =\frac{1}{2}\left(1-\alpha\lambda+\beta+\sqrt{(-\alpha\lambda+\beta+1)^{2}-4\beta}\right)\\[0.6em]
\sigma_{2} &amp; =\frac{1}{2}\left(1-\alpha\lambda+\beta-\sqrt{(-\alpha\lambda+\beta+1)^{2}-4\beta}\right)
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span>(</span></span><span>1</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>+</span><span><span><span><span>√</span></span></span><span><span><span><span>​</span></span><span><span>(</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>+</span><span>1</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>4</span><span>β</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>)</span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span><span>(</span></span><span>1</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>−</span><span><span><span><span>√</span></span></span><span><span><span><span>​</span></span><span><span>(</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>+</span><span>1</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>4</span><span>β</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>)</span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
When the <dt-math>

<span><span><math><semantics><mrow><mo>(</mo><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>4</mn><mi>β</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(-\alpha\lambda+\beta+1)^{2}-4\beta&lt;0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>(</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>+</span><span>1</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>4</span><span>β</span><span>&lt;</span><span>0</span></span></span></span></dt-math> is less than zero,
then the roots are complex and the convergence rate is
<dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">∣</mi><mo>(</mo><mo>−</mo><mi>α</mi><mi>λ</mi><mo>+</mo><mi>β</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>4</mn><mi>β</mi><mi mathvariant="normal">∣</mi></mrow></msqrt><mo>=</mo><mn>2</mn><msqrt><mrow><mi>β</mi></mrow></msqrt></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
|\sigma_{1}|=|\sigma_{2}| &amp; =\sqrt{(1-\alpha\lambda+\beta)^{2}+|(-\alpha\lambda+\beta+1)^{2}-4\beta|}=2\sqrt{\beta}
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>=</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span><span><span><span>√</span></span></span><span><span><span><span>​</span></span><span><span>(</span><span>1</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>∣</span><span>(</span><span>−</span><span>α</span><span>λ</span><span>+</span><span>β</span><span>+</span><span>1</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>4</span><span>β</span><span>∣</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>=</span><span>2</span><span><span><span><span>√</span></span></span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
Which is, surprisingly, independent of the step-size or the eigenvalue <dt-math>

<span><span><math><semantics><mrow><mi>α</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">\alpha\lambda</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>α</span><span>λ</span></span></span></span></dt-math>. When the roots are real, the convergence rate is
<dt-math block="">

<span><span><span><math><semantics><mrow><mi>max</mi><mo>{</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub><mi mathvariant="normal">∣</mi><mo>}</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mi>max</mi><mrow><mo fence="true">{</mo><mi mathvariant="normal">∣</mi><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo>+</mo><mi>β</mi><mo>±</mo><msqrt><mrow><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub><mo>+</mo><mi>β</mi><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>4</mn><mi>β</mi></mrow></msqrt><mi mathvariant="normal">∣</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">
\max\{|\sigma_{1}|,|\sigma_{2}|\}=\tfrac{1}{2}\max\left\{ |1-\alpha\lambda_{i}+\beta\pm\sqrt{(1-\alpha\lambda_{i}+\beta)^{2}-4\beta}|\right\}
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>max</span><span>{</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>,</span><span>∣</span><span><span>σ</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>∣</span><span>}</span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>max</span><span><span><span>{</span></span><span>∣</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>β</span><span>±</span><span><span><span><span>√</span></span></span><span><span><span><span>​</span></span><span><span>(</span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>β</span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>4</span><span>β</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span>∣</span><span><span>}</span></span></span></span></span></span></span></dt-math>

 </li><li>This can be derived by reducing the inequalities for all 4 + 1 cases in the explicit form of the convergence rate above.</li><li> We must optimize over
  <dt-math block="">

<span><span><span><math><semantics><mrow><msub><mi>min</mi><mrow><mi>α</mi><mo separator="true">,</mo><mi>β</mi></mrow></msub><mi>max</mi><mrow><mo fence="true">{</mo><mo fence="false">∥</mo><mspace width="-0.16667em"></mspace><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi><mi>β</mi></mrow></mtd><mtd><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mspace width="-0.16667em"></mspace><mo fence="false">∥</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo fence="false">∥</mo><mspace width="-0.16667em"></mspace><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi><mi>β</mi></mrow></mtd><mtd><mrow><mn>1</mn><mo>−</mo><mi>α</mi><msub><mi>λ</mi><mrow><mi>n</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mspace width="-0.16667em"></mspace><mo fence="false">∥</mo><mo fence="true">}</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  \min_{\alpha,\beta}\max\left\{ \bigg\| \! \left(\begin{array}{cc}
  \beta &amp; \lambda_{i}\\
  -\alpha\beta &amp; 1-\alpha\lambda_{i}
  \end{array}\right) \! \bigg\|,\ldots,\bigg\| \! \left(\begin{array}{cc}
  \beta &amp; \lambda_{n}\\
  -\alpha\beta &amp; 1-\alpha\lambda_{n}
  \end{array}\right)\! \bigg\|\right\}.
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span>​</span></span><span><span><span>α</span><span>,</span><span>β</span></span></span></span><span><span><span>​</span></span><span><span>min</span></span></span><span><span><span>​</span></span>​</span></span></span><span>max</span><span><span><span>{</span></span><span><span><span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span></span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span><span>β</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span>…</span><span>,</span><span><span><span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span></span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span><span>β</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span><span>−</span><span>α</span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>n</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span><span><span>∥</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>}</span></span></span><span>.</span></span></span></span></span></dt-math>
  (<dt-math>

<span><span><math><semantics><mrow><mi mathvariant="normal">∥</mi><mo>⋅</mo><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">\|\cdot \|</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>∥</span><span>⋅</span><span>∥</span></span></span></span></dt-math> here denotes the magnitude of the maximum eigenvalue), and occurs when the roots of the characteristic polynomial are repeated for the matrices corresponding to the extremal eigenvalues. </li><li>The above optimization problem is bounded from below by <dt-math>

<span><span><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>0</span></span></span></span></dt-math>, and vector of all <dt-math>

<span><span><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>1</span></span></span></span></dt-math>’s achieve this. </li><li>This can be written explicitly as
  <dt-math block="">

<span><span><span><math><semantics><mrow><mo>[</mo><msub><mi>L</mi><mrow><mi>G</mi></mrow></msub><msub><mo>]</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mtext> </mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext> </mtext><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mtext> </mtext></mtext><mi>i</mi></mrow></mtd><mtd><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mn>1</mn></mrow></mtd><mtd><mrow><mi>i</mi><mo>≠</mo><mi>j</mi><mo separator="true">,</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mtext><mtext> </mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mtext> </mtext></mtext><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo>)</mo><mo>∈</mo><mi>E</mi></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi></mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
  [L_{G}]_{ij}=\begin{cases} \text{degree of vertex }i &amp; i=j\\ -1 &amp; i\neq j,(i,j)\text{ or }(j,i)\in E\\ 0 &amp; \text{otherwise} \end{cases}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>[</span><span><span>L</span><span><span><span><span><span>​</span></span><span><span><span>G</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>]</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>j</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span><span><span><span><span><span>​</span></span><span><span>⎩</span></span></span><span><span><span>​</span></span><span><span>⎪</span></span></span><span><span><span>​</span></span><span><span>⎨</span></span></span><span><span><span>​</span></span><span><span>⎪</span></span></span><span><span><span>​</span></span><span><span>⎧</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span><span><span>​</span></span><span><span><span>degree of vertex </span></span><span>i</span></span></span><span><span><span>​</span></span><span><span>−</span><span>1</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span><span><span><span><span>​</span></span><span><span>i</span><span>=</span><span>j</span></span></span><span><span><span>​</span></span><span><span>i</span><span>≠</span><span>j</span><span>,</span><span>(</span><span>i</span><span>,</span><span>j</span><span>)</span><span><span> or </span></span><span>(</span><span>j</span><span>,</span><span>i</span><span>)</span><span>∈</span><span>E</span></span></span><span><span><span>​</span></span><span><span><span>otherwise</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span><span></span></span></span></span></span></span></dt-math>
  </li><li>We use the infinity norm to measure our error, similar results can be derived for the 1 and 2 norms.</li><li>
  The momentum iterations are
  <dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>β</mi><msup><mi>z</mi><mrow><mi>k</mi></mrow></msup><mo>+</mo><mi>A</mi><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>+</mo><mtext><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mtext><mo>(</mo><msup><mi>w</mi><mi>k</mi></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mrow><mi>k</mi></mrow></msup><mo>−</mo><mi>α</mi><msup><mi>z</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
  \begin{aligned}
  z^{k+1}&amp;=\beta z^{k}+ A w^{k}  + \text{error}(w^k) \\[0.4em]
  w^{k+1}&amp;=w^{k}-\alpha z^{k+1}.
  \end{aligned}
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span>β</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span>A</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>+</span><span><span>error</span></span><span>(</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span>w</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>−</span><span>α</span><span><span>z</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>.</span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
  which, after a change of variables, become
  <dt-math block="">

<span><span><span><math><semantics><mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mi>α</mi></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mo fence="false">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="false">)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><mi>β</mi></mrow></mtd><mtd><mrow><msub><mi>λ</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>y</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>x</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mtable><mtr><mtd><mrow><msubsup><mi>ϵ</mi><mrow><mi>i</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mspace width="-0.16667em"></mspace><mspace width="-0.16667em"></mspace><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\left(\!\!\begin{array}{cc}
1 &amp; 0\\
\alpha &amp; 1
\end{array}\!\!\right)\Bigg(\!\!\begin{array}{c}
y_{i}^{k+1}\\
x_{i}^{k+1}
\end{array}\!\!\Bigg)=\left(\!\!\begin{array}{cc}
\beta &amp; \lambda_{i}\\
0 &amp; 1
\end{array}\!\!\right)\left(\!\!\begin{array}{c}
y_{i}^{k}\\
x_{i}^{k}
\end{array}\!\!\right)+\left(\!\!\begin{array}{c}
\epsilon_{i}^{k}\\
0
\end{array}\!\!\right)
  </annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span><span>+</span><span>1</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span></span><span></span><span>)</span></span><span>=</span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span>β</span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span><span></span><span><span><span><span><span>​</span></span><span><span><span>λ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span><span>+</span><span><span><span>(</span></span><span><span></span><span></span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span>0</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span></span><span></span><span><span>)</span></span></span></span></span></span></span></dt-math>
  Inverting the <dt-math>

<span><span><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>2</span><span>×</span><span>2</span></span></span></span></dt-math> matrix on the left, and applying the formula recursively yields the final solution.
  </li><li>On the 1D function <dt-math>

<span><span><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mi>x</mi><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">f(x)=\frac{\lambda}{2}x^{2}</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span>f</span><span>(</span><span>x</span><span>)</span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></dt-math>, the objective value is
<dt-math block="">

<span><span><span><math><semantics><mrow><mtable><mtr><mtd><mrow><mrow><mi mathvariant="bold">E</mi></mrow><mi>f</mi><mo>(</mo><msup><mi>x</mi><mrow><mi>k</mi></mrow></msup><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mi mathvariant="bold">E</mi></mrow><mo>[</mo><mo>(</mo><msup><mi>x</mi><mrow><mi>k</mi></mrow></msup><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mi mathvariant="bold">E</mi></mrow><msup><mrow><mo fence="true">(</mo><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mi>y</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>x</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>ϵ</mi><mrow><mi>k</mi></mrow></msup><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi><mo>−</mo><mi>i</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mi>y</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>x</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mi mathvariant="bold">E</mi></mrow><msup><mrow><mo fence="true">(</mo><msup><mi>ϵ</mi><mrow><mi>k</mi></mrow></msup><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi><mo>−</mo><mi>i</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mi>y</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>x</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mrow><mi mathvariant="bold">E</mi></mrow><mo>[</mo><msup><mi>ϵ</mi><mrow><mi>k</mi></mrow></msup><mo>]</mo><mspace width="0.16667em"></mspace><mo>⋅</mo><mspace width="0.16667em"></mspace><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><msup><mrow><mo fence="true">(</mo><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi><mo>−</mo><mi>i</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi></mrow><mrow><mn>2</mn></mrow></mfrac><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mi>y</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>x</mi><mrow><mn>0</mn></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mi>λ</mi><mrow><mi mathvariant="bold">E</mi></mrow><mo>[</mo><msup><mi>ϵ</mi><mrow><mi>k</mi></mrow></msup></mrow><mrow><mn>2</mn></mrow></mfrac><mo>⋅</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><msubsup><mi>γ</mi><mrow><mi>i</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>e</mi><mrow><mn>2</mn></mrow><mrow><mi>T</mi></mrow></msubsup><msup><mi>R</mi><mrow><mi>k</mi><mo>−</mo><mi>i</mi></mrow></msup><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>α</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
\mathbf{E}f(x^{k})&amp;=\frac{\lambda}{2}\mathbf{E}[(x^{k})^{2}]\\&amp;=\frac{\lambda}{2}\mathbf{E}\left(e_{2}^{T}R^{k}\left(\begin{array}{c}
y^{0}\\
x^{0}
\end{array}\right)+\epsilon^{k}e_{2}^{T}\sum_{i=1}^{k}R^{k-i}\left(\begin{array}{c}
1\\
-\alpha
\end{array}\right)\right)^{2}\\&amp;=\frac{\lambda}{2}e_{2}^{T}R^{k}\left(\begin{array}{c}
y^{0}\\
x^{0}
\end{array}\right)+\frac{\lambda}{2}\mathbf{E}\left(\epsilon^{k}e_{2}^{T}\sum_{i=1}^{k}R^{k-i}\left(\begin{array}{c}
1\\
-\alpha
\end{array}\right)\right)^{2}\\&amp;=\frac{\lambda}{2}e_{2}^{T}R^{k}\left(\begin{array}{c}
y^{0}\\
x^{0}
\end{array}\right)+\frac{\lambda}{2}\mathbf{E}[\epsilon^{k}]\,\cdot\,\sum_{i=1}^{k}\left(e_{2}^{T}R^{k-i}\left(\begin{array}{c}
1\\
-\alpha
\end{array}\right)\right)^{2}\\&amp;=\frac{\lambda}{2}e_{2}^{T}R^{k}\left(\begin{array}{c}
y^{0}\\
x^{0}
\end{array}\right)+\frac{\lambda\mathbf{E}[\epsilon^{k}}{2}\cdot\sum_{i=1}^{k}\gamma_{i}^{2}, \qquad \gamma_i = e_{2}^{T}R^{k-i}\left(\begin{array}{c}
1\\
-\alpha
\end{array}\right)
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span><span><span><span><span><span>​</span></span><span><span><span>E</span></span><span>f</span><span>(</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>)</span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>E</span></span><span>[</span><span>(</span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>)</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>]</span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>E</span></span><span><span><span><span>(</span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span>+</span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>−</span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span>+</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>E</span></span><span><span><span><span>(</span></span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>−</span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span>+</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>E</span></span><span>[</span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>]</span><span><span></span><span>⋅</span></span><span><span></span><span><span><span><span>​</span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span><span><span>(</span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>−</span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span><span>)</span></span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span></span><span>=</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>y</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span><span><span><span>x</span><span><span><span><span><span>​</span></span><span><span><span>0</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span><span>+</span><span><span></span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span></span></span><span><span><span>​</span></span><span><span><span>λ</span><span><span>E</span></span><span>[</span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span><span>⋅</span><span><span><span><span><span>​</span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span><span>​</span></span><span><span>∑</span></span></span><span><span><span>​</span></span><span><span><span>k</span></span></span></span><span><span><span>​</span></span>​</span></span></span><span><span>γ</span><span><span><span><span><span>​</span></span><span><span><span>i</span></span></span></span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>,</span><span><span></span><span>γ</span><span><span><span><span><span>​</span></span><span><span>i</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span><span>e</span><span><span><span><span><span>​</span></span><span><span><span>2</span></span></span></span><span><span><span>​</span></span><span><span><span>T</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span>R</span><span><span><span><span><span>​</span></span><span><span><span>k</span><span>−</span><span>i</span></span></span></span><span><span><span>​</span></span>​</span></span></span></span><span><span><span>(</span></span><span><span><span></span><span><span><span><span><span>​</span></span><span><span>1</span></span></span><span><span><span>​</span></span><span><span>−</span><span>α</span></span></span><span><span><span>​</span></span>​</span></span></span><span></span></span></span><span><span>)</span></span></span></span></span><span><span><span>​</span></span>​</span></span></span></span></span></span></span></span></span></dt-math>
The third inequality uses the fact that <dt-math>

<span><span><math><semantics><mrow><mrow><mi mathvariant="bold">E</mi></mrow><msup><mi>ϵ</mi><mi>k</mi></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbf{E} \epsilon^k = 0</annotation></semantics></math></span><span aria-hidden="true"><span></span><span></span><span><span><span>E</span></span><span><span>ϵ</span><span><span><span><span><span>​</span></span><span><span>k</span></span></span><span><span><span>​</span></span>​</span></span></span></span><span>=</span><span>0</span></span></span></span></dt-math> and the fourth uses the fact they are uncorrelated.
</li></ol></dt-fn-list><h3>References</h3><dt-bibliography><ol><li><b>On the importance of initialization and momentum in deep learning.</b>   <a href="http://www.jmlr.org/proceedings/papers/v28/sutskever13.pdf">[PDF]</a></li><li><b>Some methods of speeding up the convergence of iteration methods</b>   <a href="https://www.researchgate.net/profile/Boris_Polyak2/publication/243648538_Some_methods_of_speeding_up_the_convergence_of_iteration_methods/links/5666fa3808ae34c89a01fda1.pdf">[PDF]</a></li><li><b>Theory of gradient methods</b> </li><li><b>Analysis and design of optimization algorithms via integral quadratic constraints</b>   <a href="http://arxiv.org/pdf/1408.3595.pdf">[PDF]</a></li><li><b>Introductory lectures on convex optimization: A basic course</b> </li><li><b>Natural gradient works efficiently in learning</b>   <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.452.7280&amp;rep=rep1&amp;type=pdf">[link]</a></li><li><b>Deep Learning, NIPS′2015 Tutorial</b>   <a href="http://www.iro.umontreal.ca/~bengioy/talks/DL-Tutorial-NIPS2015.pdf">[PDF]</a></li><li><b>Adaptive restart for accelerated gradient schemes</b>   <a href="http://arxiv.org/pdf/1204.3982.pdf">[PDF]</a></li><li><b>The Nth Power of a 2x2 Matrix.</b>   <a href="http://people.math.carleton.ca/~williams/papers/pdf/175.pdf">[PDF]</a></li><li><b>From Averaging to Acceleration, There is Only a Step-size.</b>   <a href="http://arxiv.org/pdf/1504.01577.pdf">[PDF]</a></li><li><b>On the momentum term in gradient descent learning algorithms</b>   <a href="https://pdfs.semanticscholar.org/735d/4220d5579cc6afe956d9f6ea501a96ae99e2.pdf">[PDF]</a></li><li><b>Understanding deep learning requires rethinking generalization</b>   <a href="http://arxiv.org/pdf/1611.03530.pdf">[PDF]</a></li><li><b>A differential equation for modeling Nesterov’s accelerated gradient method: Theory and insights</b>   <a href="http://arxiv.org/pdf/1503.01243.pdf">[PDF]</a></li><li><b>The Zen of Gradient Descent</b>   <a href="http://blog.mrtz.org/2013/09/07/the-zen-of-gradient-descent.html">[HTML]</a></li><li><b>A geometric alternative to Nesterov’s accelerated gradient descent</b>   <a href="https://arxiv.org/pdf/1506.08187.pdf">[PDF]</a></li><li><b>An optimal first order method based on optimal quadratic averaging</b>   <a href="https://arxiv.org/pdf/1604.06543.pdf">[PDF]</a></li><li><b>Linear coupling: An ultimate unification of gradient and mirror descent</b>   <a href="https://arxiv.org/pdf/1407.1537.pdf">[PDF]</a></li><li><b>Accelerating the cubic regularization of Newton’s method on convex problems</b>   <a href="http://folk.uib.no/ssu029/Pdf_file/Nesterov08.pdf">[PDF]</a></li></ol></dt-bibliography><h3>Updates and Corrections</h3>
    <p><a href="https://github.com/distillpub/post--momentum/compare/95506b079372cee3aa7fbc9bd29ee078aaff12e7...691048b9d00b4b49b830c602b970755781df332c">View all changes</a> to this article since it was first published. If you see a mistake or want to suggest a change, please <a href="https://github.com/distillpub/post--momentum/issues/new">create an issue on GitHub</a>.</p><h3 id="citation">Citations and Reuse</h3>
    <p>Diagrams and text are licensed under Creative Commons Attribution <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY 2.0</a>, unless noted otherwise, with the <a href="https://github.com/distillpub/post--momentum">source available on GitHub</a>. The figures that have been reused from other sources don&#39;t fall under this license and can be recognized by a note in their caption: “Figure from …”.</p>

    <p>For attribution in academic contexts, please cite this work as</p>
    <pre>Goh, &#34;Why Momentum Really Works&#34;, Distill, 2017. http://doi.org/10.23915/distill.00006</pre>

    <p>BibTeX citation</p>
<pre>@article{goh2017why,
  author = {Goh, Gabriel},
  title = {Why Momentum Really Works},
  journal = {Distill},
  year = {2017},
  url = {http://distill.pub/2017/momentum},
  doi = {10.23915/distill.00006}
}</pre></div>
</div></div>
  </body>
</html>
