<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://humanprogramming.substack.com/p/building-the-digital-abacus-pt-2">Original</a>
    <h1>Building the Digital Abacus pt. 2: Frontend Architecture</h1>
    
    <div id="readability-page-1" class="page"><div><div dir="auto"><p><em>This post is part of a series about the theory and engineering behind the Digital Abacus Tool, an online playground for modeling mathematical systems.</em></p><p><em>Table of Contents</em></p><ol><li><p><em><a href="https://humanprogramming.substack.com/p/building-the-digital-abacus-an-open" rel="nofollow ugc noopener">The Automatic Constraint Solver</a></em></p></li><li><p><em><strong>Frontend Architecture ← you are here</strong></em></p></li><li><p>…</p></li></ol><p><span>In </span><a href="https://humanprogramming.substack.com/p/building-the-digital-abacus-an-open" rel="nofollow ugc noopener">part one of the series</a><span> I described the </span><em>theory</em><span> underlying the Digital Abacus Tool, focusing on our data model: the constraint graph.</span></p><p><span>Now in part two I’ll discuss a more </span><em>practical</em><span> aspect of the project: the tool’s frontend architecture and our approach to state management and persistence.</span></p><p>I’ll begin chronologically with the project requirements, jumping back in time to the beginning of my involvement.</p><p><span>When I joined the project, the team had already produced a few prototypes using </span><a href="https://p5js.org/" rel="nofollow ugc noopener">p5</a><span>, and was looking to combine them into a single web app with shared state.</span></p><p>One prototype was a flowchart UI for defining mathematical constructions:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png" width="288" height="280.2684563758389" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/86a61907-7317-448b-8732-6c9b3ee41828_596x580.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:580,&#34;width&#34;:596,&#34;resizeWidth&#34;:288,&#34;bytes&#34;:198297,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:&#34;&#34;,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F86a61907-7317-448b-8732-6c9b3ee41828_596x580.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>A p5 prototype of the Digital Abacus Tool’s “Circuits” View</figcaption></figure></div><p>The other was a 2-D plot UI for exploring complex values:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png" width="294" height="348.6768292682927" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/b52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:778,&#34;width&#34;:656,&#34;resizeWidth&#34;:294,&#34;bytes&#34;:345414,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:&#34;&#34;,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb52baf26-2854-425b-ae7b-ac4b37ff3233_656x778.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>The team was looking to create a unified web application that combined both UIs and bound them to a shared state, so that users could build and explore their constructions across both interfaces simultaneously.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png" width="504" height="347.1923076923077" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1003,&#34;width&#34;:1456,&#34;resizeWidth&#34;:504,&#34;bytes&#34;:353383,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F632a4297-9a8e-467d-8cef-64cad257f03a_1582x1090.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>In terms of requirements, the Flowchart UI, Plot UI and Solver would all need to read from and write to the constraint graph simultaneously. We also needed to find a way to save and load entire constraint graphs, including their internal numeric values. All of this would be deployed together as a fast and beautiful web app.</p><p><span>To optimize for stability and maintainability, we chose the current most </span><a href="https://boringtechnology.club/" rel="nofollow ugc noopener">boring</a><span> and popular web-framework combo for interactive apps: React + NextJS. Switching to React also allowed us to use the </span><a href="https://reactflow.dev/" rel="nofollow ugc noopener">React Flow</a><span> library, an excellent library for creating interactive flowcharts. React Flow is a mature library (used by the likes of </span><a href="https://www.typeform.com/" rel="nofollow ugc noopener">Typeform</a><span>) that has good performance and enables many intuitive user interactions that would be a massive time cost to implement otherwise. It’s also the library I chose for InstructionKit’s flowchart editor, so I had experience with its API.</span></p><p>Once we knew we were using React and rewriting the Flowchart UI with React Flow, we had to decide how to integrate the Plot UI into the app. We considered rewriting that UI in React as well, but I did some research and found a library for embedding p5 into React which would allow us to reuse the existing Plot UI and therefore iterate more quickly.</p><p><span>However, getting the p5 code to </span><em>share state </em><span>with the rest of the application was a challenge, since p5 uses global variables to store state. My solution was to make the existing global state variable a </span><a href="https://github.com/pmndrs/valtio" rel="nofollow ugc noopener">Valtio</a><span> proxy, allowing the React parts of the application to subscribe to changes in that global variable (</span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/store.ts#L43" rel="nofollow ugc noopener">see code</a><span>).</span></p><p><span>In the process I migrated all of the constraint-solver class systems and the Plot UI to use ES6 module imports and typescript. </span><a href="https://github.com/dnsosebee/digital-abacus/commit/9b10219303bcd1fec5f684db34d2a5c85e838185" rel="nofollow ugc noopener">It was a big commit</a><span> but AI code-completion made the migration relatively painless.</span></p><div><p><strong>Note: A Pitfall of Nested Proxy State</strong></p><p>When you add a new object to a Valtio proxy object, Valtio copies your object in order to store it as a proxy. This means the object you added is no longer identical to the object when accessed through its parent in the proxy store. You might mutate your original object, assuming that you are mutating the object stored in state, when in fact you are not.</p><p><a href="https://github.com/dnsosebee/digital-abacus/blob/3e2682de142f0ca1267d946232ba96a848ffcf62/src/model/coords/coordGraph.ts#L132C45-L132C45" rel="nofollow ugc noopener">Here’s a line of code we needed to write to address that problem.</a><span> Be warned! Proxies are weird and hidden and can break your mental model of how Javascript works!</span></p></div><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png" width="384" height="153.16030534351145" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/f38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:418,&#34;width&#34;:1048,&#34;resizeWidth&#34;:384,&#34;bytes&#34;:132923,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff38fabf3-7d0d-460d-b78f-2ad30f1ff909_1048x418.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>The Save and Load buttons in the Digital Abacus Tool</figcaption></figure></div><p><span>We evaluated a few possibilities for persisting constructions. One option was to set up a backend and a database, but that would be more work than setting up a </span><a href="https://www.inkandswitch.com/local-first/" rel="nofollow ugc noopener">local-first</a><span> storage option. We discussed three storage options:</span></p><ul><li><p>Using browser localstorage API</p></li><li><p>Using URL encoding</p></li><li><p>Saving and loading from user’s filesystem</p></li></ul><p><span>At first I set up </span><a href="https://www.scottantipa.com/store-app-state-in-urls" rel="nofollow ugc noopener">URL encoding</a><span>, which is great for allowing people to quickly share the entire state of their application with each other by just pasting their current URL. However, we started running into problems with browser compatibility and URL length, so I switched to enabling save-to/load-from the user’s filesystem.</span></p><p>Saving to the user’s filesystem is great because the user’s filesystem becomes an extension of your product UI; the user can save files, make folders and backups and versions, send them over email, etc., all of which are affordances that I can skip over as a developer (which is not true of the browser-localstorage approach).</p><p><span>I was able to set this up quickly since I built </span><a href="https://github.com/dnsosebee/methodable/blob/35f07bbe66ffe8618ea9e6943deeef9e44a8da51/client/components/GraphProvider.tsx#L186" rel="nofollow ugc noopener">something similar</a><span> for my open-source human-programming tool </span><a href="https://a.methodable.com/" rel="nofollow ugc noopener">Methodable</a><span>.</span></p><p>I did need to do some extra work however, since persisting constructions required me to set up serialization for our class-based application state.</p><h3>Serializing JavaScript classes</h3><p><span>I generally recommend using plain JavaScript objects for application state rather than classes. There are a few reasons I prefer that pattern, one of which is that serializing and deserializing plain JavaScript objects is as easy as </span><code>JSON.stringify()</code><span> and </span><code>JSON.parse()</code><span>. However, I joined this project when the class-based model system was already pretty mature, so instead I set up serializers and deserializers for all of the classes.</span></p><p><span>I created </span><a href="https://zod.dev/" rel="nofollow ugc noopener">Zod</a><span> schemas for each class, such that deserialized graphs could be parsed and validated before being loaded into the application state (</span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/graph/vertex.ts#L19" rel="nofollow ugc noopener">example of a schema</a><span>). Then, I wrote a serialize method for each class, such that the entire graph could be serialized (</span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/graph/vertex.ts#L38" rel="nofollow ugc noopener">example of a serialize method</a><span>).</span></p><blockquote><div><p><span>Note: We serialize everything, including the </span><strong>values within each Vertex</strong><span>, because the state of values are </span><a href="https://en.wikipedia.org/wiki/Nonholonomic_system" rel="nofollow ugc noopener">path-dependent</a><span>. Consider the following:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png" data-component-name="Image2ToDOM" rel="nofollow ugc noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png" width="180" height="278.03076923076924" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/f29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png&#34;,&#34;srcNoWatermark&#34;:null,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1004,&#34;width&#34;:650,&#34;resizeWidth&#34;:180,&#34;bytes&#34;:189532,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;topImage&#34;:false,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff29e4e7d-7128-4406-bf8f-1dd2c82f0a63_650x1004.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a><figcaption>A system solving `x^2 = 4` in the Digital Abacus Tool</figcaption></figure></div><p>We’ve created a system that solves `x^2 = 4`, and has reached the equilibrium where x = -2. We can actually reach the other equilibrium where x = 2 by winding our free variable (the product) around the origin of the complex plane and returning it to its current value, 4. So, the value of bound variables is dependent not only on the current values of free variables, but also on the path those free variables took to arrive at their current value. For this reason, we serialize everything!</p></div></blockquote><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><div><div><p>Thanks for reading Human Programming! Subscribe for free to receive new posts and support my work.</p></div></div><h3>To-do: clean up the deserialization/instantiation flow</h3><p><span>Due to the nuances and unevenness of the way state is stored in the graph’s class hierarchies, deserialization is currently done in </span><a href="https://github.com/dnsosebee/digital-abacus/blob/a461da8a3443657dbfb1a8e280201510a1465adf/src/model/deserializeGraph.ts#L11" rel="nofollow ugc noopener">one gigantic function</a><span>. In the future, I would standardize all class constructors to take in a serialized state as their single argument. With that refactor in place, we could gradually deserialize a graph using each class’s constructor, rather than having to do it all in a single messy function.</span></p><p>I hope you enjoyed learning about the tooling and technical architecture of the Digital Abacus Tool. Feel free to subscribe for more on the Digital Abacus, and other updates from Human-Programming land.</p><p>Best,</p><p>Daniel Sosebee</p></div></div></div>
  </body>
</html>
