<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/elfshaker/elfshaker">Original</a>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<h2 dir="auto"><a id="user-content-400-gib---100-mib-with-1s-access-time-when-applied-to-clang-builds" aria-hidden="true" href="#400-gib---100-mib-with-1s-access-time-when-applied-to-clang-builds"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>400 GiB -&gt; 100 MiB, with 1s access time†; <a href="https://github.com/elfshaker/manyclangs">when applied to clang builds</a>.</h2>
<p dir="auto">elfshaker is a low-footprint, high-performance version control system fine-tuned for binaries.</p>
<ul dir="auto">
<li>
<p dir="auto">elfshaker is a CLI tool written in the <a href="https://www.rust-lang.org/" rel="nofollow">Rust programming language</a>.</p>
</li>
<li>
<p dir="auto">It stores snapshots of directories into highly-compressed pack files and provides fast on-demand access to the stored files. It is particularly good for storing lots of similar files, for example object files from an incremental build.</p>
</li>
<li>
<p dir="auto">It allows few-second access to any commit of clang with the <a href="https://github.com/elfshaker/manyclangs">manyclangs project</a>. For example, this accelerates bisection of <a href="https://llvm.org/" rel="nofollow">LLVM</a> by a factor of 60x! This is done by extracting builds of LLVM on-demand from locally stored elfshaker packs, each of which contains ~1,800 builds and is about 100 MiB in size, even though the full originals would take TiBs to store! Extracting a single build takes 2-4s on modern hardware.</p>
</li>
</ul>
<h2 dir="auto"><a id="user-content-applicability" aria-hidden="true" href="#applicability"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>†Applicability</h2>
<p dir="auto">Or, &#34;how on earth do you get such a phenomenal result?&#34;.</p>
<p dir="auto">It works particularly well for our <a href="https://github.com/elfshaker/manyclangs">presented use case</a> because storing pre-link object files has these properties:</p>
<ul dir="auto">
<li>There are many files,</li>
<li>Most of them don&#39;t change very often so there are a lot of duplicate files,</li>
<li>When they do change, the deltas of the binaries are not huge.</li>
</ul>
<p dir="auto">We achieve this in manyclangs by compiling object code with the <code>-ffunction-sections</code> and <code>-fdata-sections</code> compiler flags. This has the effect that if you &#39;insert&#39; a function into a translation unit, the insertion does not cause all of the addresses to change across the whole object file.</p>
<p dir="auto">If you looked at the binary delta on the linked executable from such a change, it will be large, because all of the absolute addresses after the insertion will change, and references to those addresses will change. These address changes are not handled well by compression algorithms, resulting in a poor compression ratio. The effect of this is large: if you compress many revisions of clang executables together, you will see a compression ratio of something like 20%. This is pretty good! But elfshaker achieves a ratio of something closer to 0.01% (or 10,000x), amortized across many builds.</p>
<h2 dir="auto"><a id="user-content-installation-guide" aria-hidden="true" href="#installation-guide"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a href="https://github.com/elfshaker/elfshaker/blob/main/docs/users/installing.md">Installation guide</a></h2>
<h2 dir="auto"><a id="user-content-usage-guide" aria-hidden="true" href="#usage-guide"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a href="https://github.com/elfshaker/elfshaker/blob/main/docs/users/usage.md">Usage guide</a></h2>
<h2 dir="auto"><a id="user-content-quickstart" aria-hidden="true" href="#quickstart"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quickstart</h2>
<ol dir="auto">
<li>Consult our <a href="https://github.com/elfshaker/elfshaker/blob/main/docs/users/installing.md">installation</a> and <a href="https://github.com/elfshaker/elfshaker/blob/main/docs/users/usage.md">usage guide</a>, make sure you know what you&#39;re doing.</li>
<li><code>elfshaker store &lt;snapshot&gt;</code> -- capture the state of the current working directory into a named snapshot <code>&lt;snapshot&gt;</code>.</li>
<li><code>elfshaker pack &lt;pack name&gt;</code> -- capture all &#39;loose&#39; snapshots into a single pack file (this is what gets you the compression win).</li>
<li><code>elfshaker extract &lt;snapshot&gt;</code> -- restore the state of a previous snapshot into the current working directory.</li>
</ol>
<p dir="auto">For more detail, take a look at our <a href="https://github.com/elfshaker/elfshaker/blob/main/docs/users/usage.md#workflow">workflow documentation</a>.</p>
<h2 dir="auto"><a id="user-content-system-compatibility" aria-hidden="true" href="#system-compatibility"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>System Compatibility</h2>
<p dir="auto">The following platforms are used for our CI tests:</p>
<ul dir="auto">
<li>Ubuntu 20.04 LTS</li>
</ul>
<p dir="auto">But we aim to support all popular Linux platforms, macOS and Windows in production.</p>
<p dir="auto">We officially support the following architectures:</p>
<ul dir="auto">
<li>AArch64</li>
<li>x86-64</li>
</ul>
<h2 dir="auto"><a id="user-content-current-status" aria-hidden="true" href="#current-status"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Current Status</h2>
<p dir="auto">The file format and directory structure is stable. We intend that pack files created with the current elfshaker version will remain compatible with future versions. Please kick the tyres and do your own validation, and file bugs if you find any. We have done a fair amount of validation for our use cases but there may be things we haven&#39;t needed yet, so please start a discussion and file issues/patches.</p>
<h2 dir="auto"><a id="user-content-contributing" aria-hidden="true" href="#contributing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Contributing</h2>
<p dir="auto"><em>Contributions are highly appreciated.</em>
Refer to our <a href="https://github.com/elfshaker/elfshaker/blob/main/docs/contributors/contributing.md">Contributing guide</a>.</p>

<h2 dir="auto"><a id="user-content-contact" aria-hidden="true" href="#contact"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Contact</h2>
<p dir="auto">The best way to reach us to join the <a href="https://gitter.im/elfshaker/community" rel="nofollow">elfshaker/community</a> on Gitter.
The original authors of elfshaker are Peter Waller (<a href="https://github.com/peterwaller-arm">@peterwaller-arm</a>) &lt;<a href="mailto:peter.waller@arm.com">peter.waller@arm.com</a>&gt; and Veselin Karaganev (<a href="https://github.com/veselink1">@veselink1</a>) &lt;<a href="mailto:veselin.karaganev@arm.com">veselin.karaganev@arm.com</a>&gt; and you may also contact us via email.</p>
<h2 dir="auto"><a id="user-content-security" aria-hidden="true" href="#security"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Security</h2>
<p dir="auto">Refer to our <a href="https://github.com/elfshaker/elfshaker/blob/main/SECURITY.md">Security policy</a>.</p>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">elfshaker is licensed under the <a href="https://github.com/elfshaker/elfshaker/blob/main/LICENSE">Apache License 2.0</a>.</p>
</article>
        </div></div>
  </body>
</html>
