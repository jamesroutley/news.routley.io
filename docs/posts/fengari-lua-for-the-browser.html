<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://fengari.io/">Original</a>
    <h1>Fengari – Lua for the Browser</h1>
    
    <div id="readability-page-1" class="page"><div>

    

    <section>
        <div>
            <h2>What is it?</h2>

            <p>
                Fengari (<i>Moon</i> in greek) is the Lua VM written in JavaScript.
                It uses JavaScript&#39;s garbage collector so that interoperability with the DOM is non-leaky.
            </p>

            <p>
                It comes with a <a href="https://github.com/fengari-lua/fengari-interop">simple module</a>,
                that renders any interaction with JavaScript and the DOM transparent:
            </p>

            <div>

                <div>
                    <div>
                        <p><code>
<pre><span>local</span> js = <span>require</span> <span>&#34;js&#34;</span>
<span>local</span> window = js.global

window:alert(<span>&#34;Hello from Fengari!&#34;</span>)</pre>
                        </code></p>
                        <div><p>
                            Try it:
                            </p><div data-action="run"><p>
                                ▶
                                </p><p>
                                    local js = require &#34;js&#34;
                                    local window = js.global

                                    window:alert(&#34;Hello from Fengari!&#34;)
                                </p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <p><code>
<pre><span>local</span> js = <span>require</span> <span>&#34;js&#34;</span>
<span>local</span> window = js.global
<span>local</span> document = window.document

<span>print</span>(<span>&#34;Document&#39;s title: &#34;</span> .. document.title)</pre>
                        </code></p>
                        <div><p>
                            Try it:
                            </p><div data-action="run"><p>
                                ▶
                                </p><p>
                                    local js = require &#34;js&#34;
                                    local window = js.global
                                    local document = window.document

                                    print(&#34;Document&#39;s title: &#34; .. document.title)
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <p>
                Lua in the browser means you can use coroutines to write beautiful asynchronous code:
            </p>

            <div>
                <div>
                    <p><code>
                        <pre><span>local</span> js = <span>require</span> <span>&#34;js&#34;</span>
<span>local</span> window = js.global

<span>local</span> <span><span>function</span> <span>sleep</span><span>(delay)</span></span>
    <span>local</span> co = <span>assert</span>(<span>coroutine</span>.running(), <span>&#34;Should be run in a coroutine&#34;</span>)

    window:setTimeout(<span><span>function</span><span>()</span></span>
        <span>assert</span>(<span>coroutine</span>.resume(co))
    <span>end</span>, delay*1000)

    <span>coroutine</span>.yield()
<span>end</span>

<span>coroutine</span>.wrap(<span><span>function</span><span>()</span></span>
    <span>print</span> <span>&#34;Going to sleep now...&#34;</span>

    sleep(<span>3</span>)

    <span>print</span> <span>&#34;Sleep well?&#34;</span>
<span>end</span>)()</pre>
                        </code></p>
                    <div><p>
                        Try it:
                        </p><div data-action="run"><p>
                            ▶
                            </p><p>
                                local js = require &#34;js&#34;
                                local window = js.global

                                local function sleep(delay)
                                    local co = assert(coroutine.running(), &#34;Should be run in a coroutine&#34;)

                                    window:setTimeout(function()
                                        assert(coroutine.resume(co))
                                    end, delay*1000)

                                    coroutine.yield()
                                end

                                local print = _G.print

                                coroutine.wrap(function()
                                    print &#34;Going to sleep now...&#34;

                                    sleep(3)

                                    print &#34;Sleep well?&#34;
                                end)()
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section>
        <div>
            <h2>Test it out!</h2>
            <p>

            This REPL is itself <a href="https://github.com/fengari-lua/fengari.io/blob/master/static/lua/web-cli.lua">written in Lua</a>.
        </p></div>
    </section>

    <section>
        <div>
            <h2>Getting started</h2>
            <p>
                The easiest way to get started with Fengari in the browser is to use <a href="https://github.com/fengari-lua/fengari-web">fengari-web</a>.
                This module will watch the DOM for any <span>&lt;script type=&#34;application/lua&#34; src=&#34;...&#34;&gt;</span> and run them with Fengari.
            </p>
            <ol>
                <li>
                    <p>Download fengari-web:</p>
                    <p><code>
                            <pre>$ curl -L -O https://github.com/fengari-lua/fengari-web/releases/download/v0.1.4/fengari-web.js</pre>
                        </code>
                    </p>
                </li>

                <li>
                    <p>Include it in your webpage:</p>
                    <p><code>
                            <pre><span>&lt;<span>script</span> <span>src</span>=<span>&#34;fengari-web.js&#34;</span> <span>type</span>=<span>&#34;text/javascript&#34;</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></pre>
                        </code>
                    </p>
                </li>

                <li>
                    <p>Now any script of type <span>application/lua</span> will be run by fengari:</p>
                    <p><code>
                            <pre><span>&lt;<span>script</span> <span>type</span>=<span>&#34;application/lua&#34;</span>&gt;</span><span>
print(<span>&#34;hello world!&#34;</span>)
</span><span>&lt;/<span>script</span>&gt;</span>

<span>&lt;<span>script</span> <span>src</span>=<span>&#34;/my-script.lua&#34;</span> <span>type</span>=<span>&#34;application/lua&#34;</span> <span>async</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></pre>
                        </code>
                    </p>
                </li>
            </ol>
        </div>
    </section>

    <section>
        <div>
            <h2>Structure</h2>
            <p>Fengari is spread across several repositories:</p>
            <ul>
                <li><a href="https://github.com/fengari-lua/fengari">fengari</a>: the core, largely a port of the PUC-Rio C implementation of Lua</li>
                <li><a href="https://github.com/fengari-lua/fengari-web">fengari-web</a>: to use Fengari in the browser as easily as you might use JavaScript</li>
                <li><a href="https://github.com/fengari-lua/fengari-interop">fengari-interop</a>: a lua library that makes interoperating with JavaScript objects simple, it is already included in fengari-web</li>
                <li><a href="https://github.com/fengari-lua/fengari-node-cli">fengari-node-cli</a>: Lua CLI but running on top of Node.js</li>
                <li><a href="https://github.com/fengari-lua/fengari-loader">fengari-loader</a>: to bundle lua code as part of a <a href="https://webpack.js.org/">webpack</a> build process</li>
            </ul>
        </div>
    </section>

    

</div></div>
  </body>
</html>
