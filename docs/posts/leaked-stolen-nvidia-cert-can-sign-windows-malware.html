<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.theregister.com/2022/03/05/nvidia_stolen_certificate/">Original</a>
    <h1>Leaked stolen Nvidia cert can sign Windows malware</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
<p>An Nvidia code-signing certificate was among the mountain of files stolen and leaked online by criminals who ransacked the GPU giant&#39;s internal systems.</p>
<p>At least two binaries not developed by Nvidia, but signed this week with its stolen cert, making them appear to be Nvidia programs, have appeared in malware sample database VirusTotal.</p>
<p>This leak means sysadmins should take steps, or review their security policies and defenses, to ensure code recently signed by the rogue cert is detected and blocked as it is most likely going to be malicious. This can be done through Windows configuration, network filtering rules, or whatever you use to police your organization.</p>

    

<p>Zoom security bod Bill Demirkapi tweeted a warning about the certificate potentially being able to be used to sign Windows kernel-level driver files:</p>
<blockquote>
<p lang="en" dir="ltr">As part of the <a href="https://twitter.com/hashtag/NvidiaLeaks?src=hash&amp;ref_src=twsrc%5Etfw">#NvidiaLeaks</a>, two code signing certificates have been compromised. Although they have expired, Windows still allows them to be used for driver signing purposes. See the talk I gave at BH/DC for more context on leaked certificates: <a href="https://t.co/UWu3AzHc66">https://t.co/UWu3AzHc66</a> <a href="https://t.co/gCrol0BxHd">pic.twitter.com/gCrol0BxHd</a></p>
— Bill Demirkapi (@BillDemirkapi) <a href="https://twitter.com/BillDemirkapi/status/1499437244830175236?ref_src=twsrc%5Etfw">March 3, 2022</a></blockquote>
<p>In later tweets he added that Windows will accept drivers signed with certificates issued prior to July 29, 2015 without a timestamp. Microsoft&#39;s Windows <a target="_blank" rel="nofollow" href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/kernel-mode-code-signing-policy--windows-vista-and-later-">driver signing policy</a> corroborates this, stating the operating system will run drivers &#34;signed with an end-entity certificate issued prior to July 29th 2015 that chains to a supported cross-signed CA&#34;.</p>
<p>The leaked Nvidia certificate is just such a creature, having expired in 2014. Code signed with this cert will, <a target="_blank" rel="nofollow" href="https://twitter.com/BillDemirkapi/status/1499735326406938625">in the right conditions</a>, be accepted by Windows even though the certificate has expired. Another Nvidia cert was leaked though expired after the cut-off date.</p>

        


        

<p>We asked Microsoft what steps would it be willing to take to ensure Windows blocks all code signed by the 2014 cert since its leak. A spokesperson told us: &#34;We are looking into these new claims and we will do what is necessary to keep our customers protected.&#34;</p>
<p>Infosec bod Kevin Beaumont spotted some folks have been signing their own driver code with Nvidia&#39;s private 2014 cert and uploading it to VirusTotal to check if antivirus scanners accepted it. He posted on Twitter:</p>
<blockquote>
<p lang="en" dir="ltr">VirusTotal search if you want &#39;em
</p>
— Kevin Beaumont (@GossiTheDog) <a href="https://twitter.com/GossiTheDog/status/1499781976835993600?ref_src=twsrc%5Etfw">March 4, 2022</a></blockquote>
<p>The move to allow such drivers was a backwards compatibility effort (per an MSDN <a target="_blank" rel="nofollow" href="https://techcommunity.microsoft.com/t5/windows-hardware-certification/driver-signing-changes-in-windows-10-version-1607/ba-p/364894">post from 2015</a>, introducing Windows 10 build 1607) to prevent a then-new Windows 10 feature from causing problems with previously unsigned drivers.</p>
<p>We note that a good number of antivirus scanners, tested by VirusTotal on uploaded samples, are now seemingly catching code signed by the rogue Nvidia certificate, so it may be that your AV engine will automatically block it.</p>
<ul>

<li><a href="https://www.theregister.com/2022/02/26/nvidia_security_breach/">Data stolen from Nvidia, blueprints leak threatened</a></li>

<li><a href="https://www.theregister.com/2022/03/03/nvidia_apple_intel_ucie/">Nvidia, Apple noticeably absent from Intel-led chiplet interconnect collaboration</a></li>

<li><a href="https://www.theregister.com/2022/02/28/conti_ransomware_gang_chats_leaked/">Conti ransomware gang leak: 60,000 messages online</a></li>

<li><a href="https://www.theregister.com/2022/03/01/aon_cyber_incident/">Insurance giant Aon confirms it has suffered &#39;cyber incident&#39;</a></li>
</ul>
<p>The crooks who <a target="_blank" href="https://www.theregister.com/2022/02/26/nvidia_security_breach/">compromised</a> Nvidia&#39;s internal systems to steal and leak the certificate – among many other files, including credentials, secret source code, and documentation – call themselves Lapsus$, and are seemingly trying to blackmail Nvidia into removing cryptomining limit from its GPU firmware. Last year, for its RTX 30-series graphics cards, Nvidia <a target="_blank" href="https://www.theregister.com/2021/05/18/nvidia_ethereum_rtx_gpus/">introduced</a> a technology into their drivers called Lite Hash Rate, or LHR for short.</p>
<p>LHR cripples cryptocurrency mining. By nerfing the cards&#39; cryptomining performance, Nvidia hoped to make its graphical processing units less attractive to miners, leaving more hardware available to gamers, in theory, and others who actually want graphics performance rather than pure hash rates.</p>

        

<p>Lapsus$, <a target="_blank" rel="nofollow" href="https://t.me/minsaudebr/144">according</a> to the group&#39;s Telegram page, are threatening Nvidia with the public release of more internal materials and details of chip blueprints unless the company promises to remove LHR. It seems wholly implausible that Nvidia would give in to such blackmail. The gang also wants Nvidia to open-source its drivers for Macs, Linux, and Windows PCs.</p>
<p>According to <a target="_blank" rel="nofollow" href="https://haveibeenpwned.com/PwnedWebsites#NVIDIA">Have I Been Pwned</a>, within the leaked data are &#34;over 70,000 employee email addresses and NTLM password hashes, many of which were subsequently cracked and circulated within the hacking community.&#34;</p>
<p>In a statement Nvidia previously said: &#34;We are aware that the threat actor took employee passwords and some Nvidia proprietary information from our systems and has begun leaking it online. Our team is working to analyze that information.&#34; It is maintaining an incident response page <a target="_blank" rel="nofollow" href="https://nvidia.custhelp.com/app/answers/detail/a_id/5333">here</a>. ®</p>                            
                </div></div>
  </body>
</html>
