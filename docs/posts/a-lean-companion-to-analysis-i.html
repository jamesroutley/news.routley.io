<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://terrytao.wordpress.com/2025/05/31/a-lean-companion-to-analysis-i/">Original</a>
    <h1>A Lean companion to Analysis I</h1>
    
    <div id="readability-page-1" class="page"><div>
		

<p>
 Almost 20 years ago, I wrote a textbook in real analysis called “<a href="https://terrytao.wordpress.com/books/analysis-i/">Analysis I</a>“. It was intended to complement the many good available analysis textbooks out there by focusing more on foundational issues, such as the construction of the natural numbers, integers, rational numbers, and reals, as well as providing enough set theory and logic to allow students to develop proofs at high levels of rigor.
</p><p>
While some proof assistants such as Coq or Agda were well established when the book was written, formal verification was not on my radar at the time. However, now that I have had some experience with this subject, I realize that the content of this book is in fact very compatible with such proof assistants; in particular, the ‘naive type theory’ that I was implicitly using to do things like construct the standard number systems, dovetails well with the dependent type theory of Lean (which, among other things, has excellent support for quotient types).
</p><p>
I have therefore decided to launch a <a href="https://github.com/teorth/estimate_tools/blob/master/EstimateTools/analysis/README.md">Lean companion to “Analysis I”</a>, which is a “translation” of many of the definitions, theorems, and exercises of the text into Lean. In particular, this gives an alternate way to perform the exercises in the book, by instead filling in the corresponding “sorries” in the Lean code. (I do not however plan on hosting “official” solutions to the exercises in this companion; instead, feel free to create forks of the repository in which these sorries are filled in.)
</p><p>
Currently, the following sections of the text have been translated into Lean: 

</p><ul> <li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_2_1.html">Section 2.1: The natural numbers</a> </li><li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_2_2.html">Section 2.2: Addition</a> </li><li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_2_3.html">Section 2.3: Multiplication</a> </li><li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_2_epilogue.html">Chapter 2 epilogue: Isomorphism with the Mathlib natural numbers</a> </li><li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_3_1.html">Section 3.1: Basic set theory</a> </li><li> <a href="https://teorth.github.io/estimate_tools/docs/EstimateTools/analysis/Section_4_1.html">Section 4.1: The integers</a> 
</li></ul>


<p>
The formalization has been deliberately designed to be separate from the standard Lean math library <a href="https://leanprover-community.github.io/mathlib4_docs/">Mathlib</a> at some places, but reliant on it at others. For instance, Mathlib already has a standard notion of the natural numbers <img src="https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="{{\bf N}}"/>. In the Lean formalization, I first develop “by hand” an alternate construction <code>Chapter2.Nat</code> of the natural numbers (or just <code>Nat</code>, if one is working in the <code>Chapter2</code> namespace), setting up many of the basic results about these alternate natural numbers which parallel similar lemmas about <img src="https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%7B%7B%5Cbf+N%7D%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="{{\bf N}}"/> that are already in Mathlib (but with many of these lemmas set as exercises to the reader, with the proofs currently replaced with “sorries”). Then, in an epilogue section, isomorphisms between these alternate natural numbers and the Mathlib natural numbers are established (or more precisely, set as exercises). From that point on, the Chapter 2 natural numbers are deprecated, and the Mathlib natural numbers are used instead. I intend to continue this general pattern throughout the book, so that as one advances into later chapters, one increasingly relies on Mathlib’s definitions and functions, rather than directly referring to any counterparts from earlier chapters. As such, this companion could also be used as an introduction to Lean and Mathlib as well as to real analysis (somewhat in the spirit of the “<a href="https://adam.math.hhu.de/">Natural number game</a>“, which in fact has significant thematic overlap with Chapter 2 of my text).
</p><p>
(One technical note: for my own convenience, I have placed this companion as a subdirectory of another one of my repositories, which was aimed at formalizing the theory of orders of magnitude discussed in <a href="https://terrytao.wordpress.com/2025/05/04/orders-of-infinity/">this previous blog post</a>. I may eventually split off this companion into its own repository, but at this stage I think it is workable to host two largely independent projects in the same repository.)
</p><p>
The code in this repository compiles in Lean, but I have not tested whether all of the (numerous) “sorries” in the code can actually be filled (i.e., if all the exercises can actually be solved in Lean). I would be interested in having volunteers “playtest” the companion to see if this can actually be done (and if the helper lemmas or “API” provided in the Lean files are sufficient to fill in the sorries in a conceptually straightforward manner without having to rely on more esoteric Lean programming techniques). Any other feedback will of course also be welcome.
</p>	</div></div>
  </body>
</html>
