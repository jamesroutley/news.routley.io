<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/babashka/obb">Original</a>
    <h1>Ad-hoc ClojureScript scripting of Mac applications</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto"><a href="https://app.slack.com/client/T03RZGPFR/C02S1220XRV" rel="nofollow"><img src="https://camo.githubusercontent.com/85c34375d7f47f7a59b8161cbc6a4498e59b709a52449a01d29935193dc379b9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f736c61636b2d6a6f696e5f636861742d627269676874677265656e2e737667" alt="project chat" data-canonical-src="https://img.shields.io/badge/slack-join_chat-brightgreen.svg"/></a>
<a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/3eac9a2316f2f7dc770e5df52520942baac7e7eb8a08de0e999bf21fc76f6457/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73746162696c6974792d6578706572696d656e74616c2d6f72616e67652e737667"><img src="https://camo.githubusercontent.com/3eac9a2316f2f7dc770e5df52520942baac7e7eb8a08de0e999bf21fc76f6457/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73746162696c6974792d6578706572696d656e74616c2d6f72616e67652e737667" alt="Stability: Experimental" data-canonical-src="https://img.shields.io/badge/stability-experimental-orange.svg"/></a></p>
<p dir="auto">Ad-hoc <a href="https://clojurescript.org/" rel="nofollow">ClojureScript</a> scripting of Mac applications via Apple&#39;s <a href="https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/" rel="nofollow">Open Scripting Architecture</a>.</p>
<h2 dir="auto"><a id="user-content-status" aria-hidden="true" href="#status"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Status</h2>
<p dir="auto">Experimental.</p>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<h3 dir="auto"><a id="user-content-homebrew" aria-hidden="true" href="#homebrew"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Homebrew</h3>
<div data-snippet-clipboard-copy-content="$ brew install babashka/brew/obb"><pre>$ brew install babashka/brew/obb</pre></div>
<h3 dir="auto"><a id="user-content-manual" aria-hidden="true" href="#manual"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Manual</h3>
<p dir="auto">Download from <a href="https://github.com/babashka/obb/releases">Github releases</a>.</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<p dir="auto">Evaluate an expression:</p>
<div data-snippet-clipboard-copy-content="$ obb -e &#39;(-&gt; (js/Application &#34;Safari&#34;) (.-documents) (aget 0) (.url))&#39;
https://clojure.org/"><pre>$ obb -e <span><span>&#39;</span>(-&gt; (js/Application &#34;Safari&#34;) (.-documents) (aget 0) (.url))<span>&#39;</span></span>
https://clojure.org/</pre></div>
<div data-snippet-clipboard-copy-content="$ obb -e &#39;(-&gt; (js/Application &#34;Google Chrome&#34;) (.-windows) (aget 0) (.activeTab) (.title))&#39;
Slack | obb | clojurians"><pre>$ obb -e <span><span>&#39;</span>(-&gt; (js/Application &#34;Google Chrome&#34;) (.-windows) (aget 0) (.activeTab) (.title))<span>&#39;</span></span>
Slack <span>|</span> obb <span>|</span> clojurians</pre></div>
<p dir="auto">Or evaluate a file:</p>
<div data-snippet-clipboard-copy-content="$ obb examples/choice.cljs"><pre>$ obb examples/choice.cljs</pre></div>
<p dir="auto">Or make an executable script by using <code>obb</code> in a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" rel="nofollow">shebang</a>:</p>
<div data-snippet-clipboard-copy-content="$ cat quit.cljs
#!/usr/bin/env obb
(-&gt; (js/Application &#34;Safari&#34;)
    (.quit))
$ chmod u+x quit.cljs
$ ./quit.cljs
true"><pre>$ cat quit.cljs
<span><span>#!</span>/usr/bin/env obb</span>
(-<span>&gt;</span> (js/Application <span><span>&#34;</span>Safari<span>&#34;</span></span>)
    (.quit))
$ chmod u+x quit.cljs
$ ./quit.cljs
<span>true</span></pre></div>
<h2 dir="auto"><a id="user-content-how-does-this-tool-work" aria-hidden="true" href="#how-does-this-tool-work"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How does this tool work?</h2>
<p dir="auto">ClojureScript code is evaluated through <a href="https://github.com/borkdude/sci">SCI</a>, the same interpreter that powers <a href="https://babashka.org/" rel="nofollow">babashka</a>. SCI is compiled to JavaScript which is then by executed by <code>osascript</code>.</p>
<h2 dir="auto"><a id="user-content-macros" aria-hidden="true" href="#macros"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Macros</h2>
<p dir="auto">SCI supports macros as first class citizens so you can write a few macros to deal with interop boilerplate:</p>
<div data-snippet-clipboard-copy-content="(defmacro -&gt;clj [obj &amp; interops]
  (let [names (map #(clojure.string/replace (str %) #&#34;[.-]&#34; &#34;&#34;) interops)
        ks (mapv keyword names)
        exprs (mapv #(list % obj) interops)]
    `(zipmap ~ks [~@exprs])))

(-&gt; (js/Application &#34;Spotify&#34;) (.-currentTrack) (-&gt;clj .artist .album .name))
;;=&gt;
{:artist &#34;The Gathering&#34;, :album &#34;How to Measure a Planet? (Deluxe Edition)&#34;, :name &#34;Travel&#34;}"><pre>(<span>defmacro</span> <span>-&gt;clj</span> [obj &amp; interops]
  (<span>let</span> [names (<span>map</span> #(<span>clojure.string/replace</span> (<span>str</span> %) <span>#&#34;[.-]&#34;</span> <span><span>&#34;</span><span>&#34;</span></span>) interops)
        ks (<span>mapv</span> keyword names)
        exprs (<span>mapv</span> #(<span>list</span> % obj) interops)]
    `(zipmap ~ks [~@exprs])))

(<span>-&gt;</span> (<span>js/Application</span> <span><span>&#34;</span>Spotify<span>&#34;</span></span>) (<span>.-currentTrack</span>) (<span>-&gt;clj</span> .artist .album .name))
<span><span>;</span>;=&gt;</span>
{<span>:artist</span> <span><span>&#34;</span>The Gathering<span>&#34;</span></span>, <span>:album</span> <span><span>&#34;</span>How to Measure a Planet? (Deluxe Edition)<span>&#34;</span></span>, <span>:name</span> <span><span>&#34;</span>Travel<span>&#34;</span></span>}</pre></div>
<h2 dir="auto"><a id="user-content-references" aria-hidden="true" href="#references"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>References</h2>
<ul dir="auto">
<li><a href="https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/GettoKnowScriptEditor.html#//apple_ref/doc/uid/TP40016239-CH5-SW1" rel="nofollow">Mac Automation Scripting Guide</a></li>
<li><a href="https://github.com/JXA-Cookbook/JXA-Cookbook/wiki">JXA Cookbook</a></li>
</ul>
<h2 dir="auto"><a id="user-content-tips-and-tricks" aria-hidden="true" href="#tips-and-tricks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tips and tricks</h2>
<h3 dir="auto"><a id="user-content-explore-app-specific-apis" aria-hidden="true" href="#explore-app-specific-apis"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Explore app specific APIs</h3>
<p dir="auto">Open <code>Script Editor.app</code>, go to <code>File</code> &gt; <code>Open Dictionary</code> and select the
application you would like to explore, e.g. <code>Spotify.app</code>.  After selection,
select <code>JavaScript</code> instead of <code>AppleScript</code>.</p>
<h2 dir="auto"><a id="user-content-sister-projects" aria-hidden="true" href="#sister-projects"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sister projects</h2>
<ul dir="auto">
<li><a href="https://github.com/babashka/babashka">babashka</a>: Native, fast starting Clojure interpreter for scripting.</li>
<li><a href="https://github.com/babashka/nbb">nbb</a>: Ad-hoc CLJS scripting on Node.js using SCI.</li>
<li><a href="https://github.com/babashka/scittle">scittle</a>: The Small Clojure Interpreter exposed for usage in browser script tags.</li>
</ul>
<h2 dir="auto"><a id="user-content-build" aria-hidden="true" href="#build"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Build</h2>
<p dir="auto"><a href="https://github.com/babashka/babashka/#installation">Install Babashka</a>. Then build with:</p>

<p dir="auto">Then place <code>out/obb</code> anywhere on your path.</p>
</article>
        </div></div>
  </body>
</html>
