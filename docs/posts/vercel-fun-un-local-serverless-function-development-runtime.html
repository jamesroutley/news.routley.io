<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/vercel/fun">Original</a>
    <h1>Vercel/fun: ƒun – Local serverless function λ development runtime</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://github.com/vercel/fun/actions?workflow=Node+CI"><img src="https://github.com/vercel/fun/workflows/Node%20CI/badge.svg" alt="Build Status"/></a></p>
<p dir="auto">Local serverless function λ development runtime.</p>

<p dir="auto">Given a Lambda function like this one:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// example/index.js
exports.handler = function(event, context, callback) {
	callback(null, { hello: &#39;world&#39; });
};"><pre><span>// example/index.js</span>
<span>exports</span><span>.</span><span>handler</span> <span>=</span> <span>function</span><span>(</span><span>event</span><span>,</span> <span>context</span><span>,</span> <span>callback</span><span>)</span> <span>{</span>
	<span>callback</span><span>(</span><span>null</span><span>,</span> <span>{</span> <span>hello</span>: <span>&#39;world&#39;</span> <span>}</span><span>)</span><span>;</span>
<span>}</span><span>;</span></pre></div>
<p dir="auto">You can invoke this function locally using the code below:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import { createFunction } from &#39;@vercel/fun&#39;;

async function main() {
	// Starts up the necessary server to be able to invoke the function
	const fn = await createFunction({
		Code: {
			// `ZipFile` works, or an already unzipped directory may be specified
			Directory: __dirname + &#39;/example&#39;
		},
		Handler: &#39;index.handler&#39;,
		Runtime: &#39;nodejs8.10&#39;,
		Environment: {
			Variables: {
				HELLO: &#39;world&#39;
			}
		},
		MemorySize: 512
	});

	// Invoke the function with a custom payload. A new instance of the function
	// will be initialized if there is not an available one ready to process.
	const res = await fn({ hello: &#39;world&#39; });

	console.log(res);
	// Prints: { hello: &#39;world&#39; }

	// Once we are done with the function, destroy it so that the processes are
	// cleaned up, and the API server is shut down (useful for hot-reloading).
	await fn.destroy();
}

main().catch(console.error);"><pre><span>import</span> <span>{</span> <span>createFunction</span> <span>}</span> <span>from</span> <span>&#39;@vercel/fun&#39;</span><span>;</span>

<span>async</span> <span>function</span> <span>main</span><span>(</span><span>)</span> <span>{</span>
	<span>// Starts up the necessary server to be able to invoke the function</span>
	<span>const</span> <span>fn</span> <span>=</span> <span>await</span> <span>createFunction</span><span>(</span><span>{</span>
		<span>Code</span>: <span>{</span>
			<span>// `ZipFile` works, or an already unzipped directory may be specified</span>
			<span>Directory</span>: <span>__dirname</span> <span>+</span> <span>&#39;/example&#39;</span>
		<span>}</span><span>,</span>
		<span>Handler</span>: <span>&#39;index.handler&#39;</span><span>,</span>
		<span>Runtime</span>: <span>&#39;nodejs8.10&#39;</span><span>,</span>
		<span>Environment</span>: <span>{</span>
			<span>Variables</span>: <span>{</span>
				<span>HELLO</span>: <span>&#39;world&#39;</span>
			<span>}</span>
		<span>}</span><span>,</span>
		<span>MemorySize</span>: <span>512</span>
	<span>}</span><span>)</span><span>;</span>

	<span>// Invoke the function with a custom payload. A new instance of the function</span>
	<span>// will be initialized if there is not an available one ready to process.</span>
	<span>const</span> <span>res</span> <span>=</span> <span>await</span> <span>fn</span><span>(</span><span>{</span> <span>hello</span>: <span>&#39;world&#39;</span> <span>}</span><span>)</span><span>;</span>

	<span>console</span><span>.</span><span>log</span><span>(</span><span>res</span><span>)</span><span>;</span>
	<span>// Prints: { hello: &#39;world&#39; }</span>

	<span>// Once we are done with the function, destroy it so that the processes are</span>
	<span>// cleaned up, and the API server is shut down (useful for hot-reloading).</span>
	<span>await</span> <span>fn</span><span>.</span><span>destroy</span><span>(</span><span>)</span><span>;</span>
<span>}</span>

<span>main</span><span>(</span><span>)</span><span>.</span><span>catch</span><span>(</span><span>console</span><span>.</span><span>error</span><span>)</span><span>;</span></pre></div>

<p dir="auto">ƒun provides an execution environment that closely resembles the
real Lambda environment, with some key differences that are documented here:</p>
<ul dir="auto">
<li>Lambdas processes are ran as your own user, not the <code>sbx_user1051</code> user.</li>
<li>Processes are <em>not</em> sandboxed nor chrooted, so do not rely on hard-coded
locations like <code>/var/task</code>, <code>/var/runtime</code>, <code>/opt</code>, etc. Instead, your
function code should use the environment variables that represent these
locations (namely <code>LAMBDA_TASK_ROOT</code> and <code>LAMBDA_RUNTIME_DIR</code>).</li>
<li>Processes are frozen by sending the <code>SIGSTOP</code> signal to the lambda process,
and unfrozen by sending the <code>SIGCONT</code> signal, not using the <a href="https://www.kernel.org/doc/Documentation/cgroup-v1/freezer-subsystem.txt" rel="nofollow">cgroup freezer</a>.</li>
<li>Lambdas that compile to native executables (i.e. Go) will need to be compiled
for your operating system. So if you are on macOS, then the binary needs to be
executable on macOS.</li>
</ul>

<p dir="auto">ƒun aims to support all runtimes that AWS Lambda provides. Currently
implemented are:</p>
<ul dir="auto">
<li><code>nodejs</code> for Node.js Lambda functions using the system <code>node</code> binary</li>
<li><code>nodejs6.10</code> for Node.js Lambda functions using a downloaded Node v6.10.0 binary</li>
<li><code>nodejs8.10</code> for Node.js Lambda functions using a downloaded Node v8.10.0 binary</li>
<li><code>nodejs10.x</code> for Node.js Lambda functions using a downloaded Node v10.15.3 binary</li>
<li><code>nodejs12.x</code> for Node.js Lambda functions using a downloaded Node v12.22.7 binary</li>
<li><code>nodejs14.x</code> for Node.js Lambda functions using a downloaded Node v14.18.1 binary</li>
<li><code>python</code> for Python Lambda functions using the system <code>python</code> binary</li>
<li><code>python2.7</code> for Python Lambda functions using a downloaded Python v2.7.12 binary</li>
<li><code>python3</code> for Python Lambda functions using the system <code>python3</code> binary</li>
<li><code>python3.6</code> for Python Lambda functions using a downloaded Python v3.6.8 binary</li>
<li><code>python3.7</code> for Python Lambda functions using a downloaded Python v3.7.2 binary</li>
<li><code>go1.x</code> for Lambda functions written in Go - binary must be compiled for your platform</li>
<li><code>provided</code> for <a href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html" rel="nofollow">custom runtimes</a></li>
</ul>
</article></div></div>
  </body>
</html>
