<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/">Original</a>
    <h1>An IRC-Enabled Lawn Mower</h1>
    
    <div id="readability-page-1" class="page"><div>
            <svg width="0" height="0">
                <filter id="blur">
                    <feGaussianBlur stdDeviation="3"></feGaussianBlur>
                    <feColorMatrix type="matrix" values="1 0 0 0 0, 0 1 0 0 0, 0 0 1 0 0, 0 0 0 9 0"></feColorMatrix>
                    <feComposite in2="SourceGraphic" operator="in"></feComposite>
                </filter>
            </svg>
            <section>
                <h2>What is IRC?</h2>
                <p>
                    IRC stands for <a href="https://en.wikipedia.org/wiki/Internet_Relay_Chat">Internet
                    Relay Chat</a>. Invented in the late 1980s, it&#39;s one of the
                    oldest and most popular realtime chat protocols. Despite
                    being over 30 years old, it&#39;s still actively developed, and
                    hundreds of thousands of people still use it to chat every
                    day.
                </p>
                <p>
                    Due to the simple, text-based protocol, it&#39;s incredibly
                    easy to develop software to work with IRC. When I started
                    learning how to code as a kid, <i>all</i> of my programming
                    projects were IRC-related. Bots, clients, servers, games,
                    <i>everything!</i>
                    One of my games even became quite popular. If you&#39;re an IRC
                    user, you&#39;ve probably heard of the <a href="https://idlerpg.net">Idle RPG</a>.
                </p>
                <p>
                    These days, there are hundreds of IRC networks, and I&#39;m on
                    several of them. But when I was a kid growing up in the
                    90s, the only network I used was <a href="https://undernet.org/">Undernet</a>.
                </p>
                <p>
                    Now, I grew up in a rural area of the southern US, and I
                    had never been out of the South, but on Undernet, I met
                    people in other states, other countries, even other
                    continents! I made friends all over the world and learned a
                    great deal about other cultures and ideas.  And for the
                    first time, I met other people who were into my new
                    favorite hobby — programming — and that set me
                    on the path to becoming a software engineer. So much of who
                    I am can be traced back to the people I met on Undernet.
                </p>
                <p>
                    After 25 years, I still love Undernet, and I still chat
                    there every day. Most of the friends I made back in the 90s
                    aren&#39;t around anymore, but I still get to meet new and
                    interesting people all the time, and I love the group of
                    amazing friends I have there today. And it was one of them
                    who suggested this project...
                </p>
            </section>
            <section>
                <h2>Genesis</h2>
                <p>
                    It all started with a broken lawnmower.
                </p>
                <blockquote>
                    <p>Undernet, September 4, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>jotun</td>
                            <td>i&#39;m gonna go take my lawnmower engine apart and try to clean out the carburetor</td>
                        </tr>
                        <tr>
                            <td>Telac</td>
                            <td>jotun: it wont start? </td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>Telac: it starts but doesn&#39;t run well, i think it&#39;s a clogged carb jet. might also just need a new spark plug</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>i&#39;ve taken it apart to clean the carb before, and it worked after, so hoping that fixes it again</td>
                        </tr>
                        <tr>
                            <td>Telac</td>
                            <td>If it dies when you throttle it, it sounds like it</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>need to oil the air filter as well</td>
                        </tr>
                        <tr>
                            <td>Ratler</td>
                            <td>
                                jotun: maybe time to change the fuel filter (or put one in)
                            </td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>ye ratler, it has one, i&#39;ll make sure it&#39;s clean</td>
                        </tr>
                    </tbody></table>
                </blockquote>
                <p>Later...</p>
                <blockquote>
                    <p>Undernet, September 8, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>*</td>
                            <td><span>jotun</span> stinks like carb cleaner and gasoline</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>hehe</td>
                        </tr>
                        <tr>
                            <td>Shesle</td>
                            <td>jotun: what happened?</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>trying again to get the lawnmower running</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>took it apart again, cleaned all the jets with a wire, soaking it in carb cleaner now</td>
                        </tr>
                    </tbody></table>
                </blockquote>
                <p>Later...</p>
                <blockquote>
                    <p>Undernet, September 9, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>jotun</td>
                            <td>fixed my lawnmower 😎</td>
                        </tr>
                        <tr>
                            <td>[k]</td>
                            <td>jotun: congrats!</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>yeah [k] i was so happy when it started!</td>
                        </tr>
                        <tr>
                            <td>Shesle</td>
                            <td>Oh bravo jotun, you are a real man!</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>share in my joy <a href="https://imgur.com/a/1zdF5pb">https://imgur.com/a/1zdF5pb</a></td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: ^5!</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>there is nothing quite like the feeling of being master of your domain</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    Hoorah! After replacing the spark plug and using a thin
                    piece of wire to clean out all the carburetor jets, it
                    started and ran again. I&#39;m not a very mechanical person, so
                    this was a big deal for me 😎. However, by this time,
                    &#34;old man jotun&#34; working on his lawnmower had reached meme
                    status.
                </p>


                <blockquote>
                    <p>Undernet, September 14, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>Shesle</td>
                            <td>Empus: let&#39;s link a server together to EFnet</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>i have pretty stable cable internet here, never offline for more than 3 days at a time. can i link to efnet pls</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: you should link your lawnmower there</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>that would be the best fucking server</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>slap a Pi on it, and link that thing!</td>
                        </tr>
                        <tr>
                            <td>[k]</td>
                            <td>jotun: your connection seems pretty unstable on efnet</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>omg</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>[efnet] You were killed by [k] (connection reset by peer)</td>
                        </tr>
                        <tr>
                            <td>[k]</td>
                            <td>connection too unstable to link sorry jotun </td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>just wait til i get my lawnmower linked [k], you will taste the blades</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: haha strapping a Pi to a lawnmower and linking it would literally be the best server on the internet.  You would win alllls of the prizes</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>please do it</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: I&#39;m serious... this would be fucking sensational</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    Empus is a nut, so obviously I think this is all a big
                    joke. But later that day...
                </p>

                <blockquote>
                    <p>Undernet, September 14, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>Empus</td>
                            <td>Ragnar: have you heard that we&#39;re going to link an IRC server from jotun&#39;s lawnmower? :&gt;</td>
                        </tr>
                        <tr>
                            <td>Ragnar</td>
                            <td>Empus: haha no</td>
                        </tr>
                        <tr>
                            <td>Ragnar</td>
                            <td>Empus: but I will happily provide a c/n for that</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>We owe it to ourselves, to build a server on a lawnmower.</td>
                        </tr>
                        <tr>
                            <td>Ragnar</td>
                            <td>jotun: lets make this happen</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: Ragnar is just as excited about this as I am.  It&#39;s on!</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    Hard to believe this joke is still going the next day. This
                    is a joke, right?
                </p>

                <blockquote>
                    <p>Undernet, September 15, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>Ragnar</td>
                            <td>jotun: how is lawnmower.undernet.org coming together?</td>
                        </tr>
                        <tr>
                            <td>Ragnar</td>
                            <td>jotun: we are rooting for you!</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    OK, but they are just trolling, <i>right?</i> If I just
                    ignore this, they will forget about it, <i>RIGHT??</i>
                </p>

                <blockquote>
                    <p>Undernet, September 20, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>Empus</td>
                            <td>jotun: how is our lawnmower coming along btw? :&gt;</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    This is five days later! Five days! That&#39;s like, a
                    <i>year</i> in IRC time.
                </p>

                <blockquote>
                    <p>Undernet, September 21, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>Empus</td>
                            <td>jotun: how is our lawnmower server coming along?</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>Empus: i kinda determined that a) area is too hot and humid to leave a computer outside, and b) mounting cheap lipos to my gasoline engine probably not a great idea</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: make this shit happen mate.  Stop being a naysayer!  We can do this!</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>if it gets hot and fails, we adapt</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: engineering is iterative, we&#39;ll work it out together :&gt;</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    Well, I guess this isn&#39;t going away. Time to get to work.
                </p>
            </section>
            <section>
                <h2>Build</h2>
                <p>
                    I&#39;m a software engineer, but I haven&#39;t worked on a
                    hardware project since I was in college 20 years ago.
                    After lots of badgering by Ragnar and Empus, and several
                    days of research into what might actually work, I broke
                    down and started ordering parts.
                </p>
                <p>
                    On December 2, I ordered a RPi 4b+ 2GB and a small OLED
                    display. It arrived a few days later.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3857.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3857.jpg" alt="Pi with OLED HAT running demo code." title="Pi with OLED HAT running demo code."/>
                        
                    </a>
                    <figcaption>
                        Raspberry Pi with a <a href="https://www.waveshare.com/wiki/2.23inch_OLED_HAT">Waveshare 2.23&#34; OLED HAT</a>
                        running Waveshare demo code.
                    </figcaption>
                </figure>
                <p>
                    The display came with a Python driver and some example
                    code and was quite easy to set up out of the box. The
                    demo software showed how to load a font and draw some
                    basic system info to the screen. Perfect, since that&#39;s
                    what I was planning to do with it! Let&#39;s get some more
                    data on this thing, though.
                </p>
                <p>
                    I know that I want to be able to do a WiFi survey of my
                    yard, because if I don&#39;t have good WiFi coverage to the
                    corners, I won&#39;t be able to stay online while mowing.  So I
                    need a WiFi signal meter. I also know that – while
                    I&#39;m mowing the lawn – I&#39;ll have to be running on
                    battery power, because it&#39;s not practical to drag an
                    extension cable around the yard. So I&#39;ll need a battery
                    meter, too.  What else can we display...?
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3859.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3859.jpg" alt="Pi running my monitoring code." title="Pi running my monitoring code."/>
                        
                    </a>
                    <figcaption>
                        Pi running the first pass of my monitoring code.
                    </figcaption>
                </figure>
                <p>
                    Might as well round out the top line with the current
                    time. Uptime is good to have – good nerd stat. The
                    IRC server software I wanted to use, <a href="https://github.com/UndernetIRC/ircu2">ircu</a>, built
                    without needing any modifications, which was nice, so I got
                    that up and running. I wrote a bot to track the IRC user
                    count and put that on the screen. CPU, memory, and some
                    network stats all fit, too. Looking really nice now!
                </p>
                <p>
                    Look at that CPU usage, though. That 4% is 4% of all
                    available CPU time. The Pi has 4 cores, and looking at
                    <code>top</code> shows that the core running our
                    monitoring software is the only one using any significant
                    CPU time, so we&#39;re using 16% of one core just to update
                    the screen once per second – way too much.
                </p>
                <p>
                    Profiling the monitoring code shows that we&#39;re spending
                    most of our time calling programs like
                    <code>mpstat</code>, <code>free</code>, and
                    <code>iwconfig</code> to query CPU usage, memory usage, and
                    WiFi signal status. It was pretty easy to get this
                    information from <code>/proc</code> rather than calling
                    external programs and parsing their output. That got CPU
                    usage down to about 6% of one core. Much better!
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3868.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3868.jpg" alt="Display showing over 3500 connected users." title="Over 3500 connected users."/>
                        
                    </a>
                    <figcaption>
                        Load testing the Pi running <a href="https://github.com/UndernetIRC/ircu2">ircu</a>.
                    </figcaption>
                </figure>
                <p>
                    I figured I should load test the Pi running ircu to see how
                    many users it could handle. I wrote a small program to load
                    fake users onto IRC and have them join and part channels,
                    send messages, etc. I reached ~3500 fake users generating
                    2-3mbps of traffic before my testing VM ran out of FDs. You
                    can see that CPU usage was around 20% (well, 80% of one
                    core) while memory usage never climbed above 18%. This is
                    orders of magnitude more traffic than a production IRC
                    server should expect, so I&#39;m quite pleased with the result!
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3882.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3882.jpg" alt="Pi with UPS attached." title="Pi with UPS attached."/>
                        
                    </a>
                    <figcaption>
                        Pi with <a href="https://raspberrypiwiki.com/X728">Geekworm X728 UPS HAT</a>.
                    </figcaption>
                </figure>
                <p>
                    The UPS arrived, but the batteries haven&#39;t arrived yet.
                    Notice how the GPIO pins on the UPS board are offset
                    beyond the boundaries of the Pi? I didn&#39;t notice that in
                    the pics when buying! The Pi won&#39;t be able to wear its
                    little OLED HAT, or the mounting holes won&#39;t line up with
                    the risers 🙁. I attached the display with jumper wires
                    instead.
                </p>
                <p>
                    Also, notice the CPU usage. It&#39;s still Too Damn High!
                    Profiling the code again showed that we were now spending
                    most of our time in the OLED display driver, turning the
                    bits in the backing store into bytes that could be pushed
                    to the screen. The backing store is a 1-bit bitmap where
                    each byte represents 8 horizontal pixels. However, reading
                    the driver code revealed that the display expected each
                    byte to represent 8 <i>vertical</i> pixels, and the driver
                    was generating these bytes by masking off one bit at a time
                    from the bytes of the backing store. Very inefficient!
                </p>
                <p>
                    To fix this, I used the Python Pillow library to copy and
                    rotate the backing store 270°. Now one horizontal
                    byte represents 8 vertical pixels, and I can read raw
                    bytes from the bitmap and push those bytes directly to
                    the display. Perfect!
                </p>
                <p>
                    After a few other small tweaks, CPU usage of the
                    monitoring software is under 1% of one core. Good enough
                    for me.
                </p>
                <p>
                    I&#39;d been working on all of this in secret at this point.
                    It was time to reveal it to Empus.
                </p>

                <blockquote>
                    <p>Undernet, December 11, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>jotun</td>
                            <td>Empus! i have something cool for you</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: oh yeah?  awesome!</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>i got this lil guy in the mail last weekend :) <a href="https://i.imgur.com/2jAsPeo.jpg">https://i.imgur.com/2jAsPeo.jpg</a></td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>jotun: shit yes! it&#39;s happening</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>i didn&#39;t have batteries for it yet, but i wanted to do a wifi survey of my yard to make sure i got good coverage at all the corners</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>so i hooked up two 25m extension cords</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>and i didn&#39;t wanna touch the board with my bare hands, so i put on a rubber glove</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>so picture me walking slowly around my yard at dusk dragging a 50m extension cord and waving a tiny glowing computer around with one rubber gloved hand</td>
                        </tr>
                        <tr>
                            <td>[k]</td>
                            <td>i wish you had that on camera</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>people are walking by walking their dogs and i just smile and nod</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>hahaha</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>omg</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>dude.</td>
                        </tr>
                        <tr>
                            <td>Telac</td>
                            <td>jotun: you are one of those &#34;creepy odd neighbours&#34;</td>
                        </tr>
                    </tbody></table>
                </blockquote>

                <p>
                    A good reception! Work continues...
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3889.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3889.jpg" alt="Pi with camera attached." title="Pi with camera attached."/>
                        
                    </a>
                    <figcaption>
                        Pi with a small 1080P camera attached.
                    </figcaption>
                </figure>
                <p>
                    On a whim, I ordered a small 1080P camera. I had ideas of
                    running live streams of me mowing the lawn, but due to
                    vibrations, they haven&#39;t panned out <i>yet</i>.
                </p>
                <p>
                    By the way, you see all this hardware? Your cellphone has
                    all the same stuff, but is <i>way</i> more powerful and
                    takes up maybe 15% of the space. Really makes you
                    appreciate what those mobile hardware engineers can do!
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3905.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3905.jpg" alt="Plastic electrical project box." title="Plastic electrical project box."/>
                        
                    </a>
                    <figcaption>
                        Makeshift case! An LMioEtool electrical project box.
                    </figcaption>
                </figure>
                <p>
                    Up to now, I&#39;ve still just been playing with the idea,
                    but it&#39;s finally time to start thinking about how to
                    actually mount this to my lawnmower. I was out of town at
                    this point for the Christmas holidays, and I&#39;d left all
                    the hardware for lawnmower.* at home, but I was thinking
                    about cases while looking at Amazon one night, and this
                    little beauty popped up. After doing some measurements in
                    my head, I decided it would probably fit, and went ahead
                    and ordered it. Doesn&#39;t it look eager to have an IRC
                    server inside of it??
                </p>
                <p>
                    That black thing to the left is an adjustable VESA LCD
                    pole mount bracket. You can see where this is going.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3907.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3907.jpg" alt="Project box with standoffs inserted." title="Project box with standoffs inserted."/>
                        
                    </a>
                    <figcaption>
                        Project box with standoffs installed and mounting holes drilled.
                    </figcaption>
                </figure>
                <p>
                    My father gifted me a cordless drill and a drillbit kit
                    for Christmas, which was <i>perfect</i>, because I didn&#39;t
                    even think about how much I&#39;d need one for this project.
                    I drilled holes for mounting this to the VESA mount and
                    installed the standoffs for the Pi.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3908.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3908.jpg" alt="Pi installed into project box." title="Pi installed into project box."/>
                        
                    </a>
                    <figcaption>
                        Pi installed into project box - great fit!
                    </figcaption>
                </figure>
                <p>
                    Look how nicely this fits! There&#39;s so much room for
                    activities!
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3909.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3909.jpg" alt="Drill clamped into vice." title="Drill clamped into vice."/>
                        
                    </a>
                    <figcaption>
                        Makeshift drill press; drilled clamped in vice with CO-Z unibit attached.
                    </figcaption>
                </figure>
                <p>
                    I don&#39;t have a drill press, and I didn&#39;t trust my hands to
                    stay steady when drilling the holes for the fans, so I
                    clamped my drill in a vice and stacked a bunch of books in
                    front of it at just the right height. Then I set the case
                    on the books, put a rubber band on the drill&#39;s trigger, and
                    pushed the case against the bit.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3913.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3913.jpg" alt="Case with holes drilled." title="Case with holes drilled."/>
                        
                    </a>
                    <figcaption>
                        Case with holes drilled for fans, button, and sensor wires.
                    </figcaption>
                </figure>
                <p>
                    Came out pretty nice! Only... I suffered an injury. Like an
                    idiot, I was working on this without protective eyewear.
                    After drilling these holes, I blew into the bottom of the
                    case to dislodge all the plastic dust, and a piece of it
                    flew into my eye. Went to three doctors including an
                    ophthalmologist who were all no help. Luckily it seems to
                    have come out on its own about 6 weeks later with no
                    permanent damage.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3914.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3914.jpg" alt="Case with holes drilled, top open, power cable hole cut." title="Case with holes drilled, top open, power cable hole cut."/>
                        
                    </a>
                    <figcaption>
                        Another angle of the case, now with the USB-C power cable hole cut in back.
                    </figcaption>
                </figure>
                <p>
                    Cutting a rectangular hole in the rear of the case for the
                    USB-C power cable was a real challenge. I didn&#39;t even own a
                    proper file – I told you I&#39;m not very mechanical! I
                    ended up drilling a couple of pilot holes and then using a
                    fingernail file to make it rectangular. Yes, really.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3918.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3918.jpg" alt="Case with fans and button installed." title="Case with fans and button installed."/>
                        
                    </a>
                    <figcaption>
                        Case with input fan, exhaust fan, and button installed.
                    </figcaption>
                </figure>
                <p>
                    The case fans are 5V, and the Pi only has one 5V rail. I
                    didn&#39;t want to add on a breadboard, because it&#39;d be ugly,
                    and I&#39;m not really sure how I&#39;d have made it fit. Luckily the
                    UPS has a 5V power rail for a cooling fan at the opposite
                    end as the Pi&#39;s 5V power pin, so I can easily put fans at
                    both ends of the case. Man, everything is coming up
                    Millhouse.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3923.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3923.jpg" alt="Pi installed into case and powered on." title="Pi installed into case and powered on."/>
                        
                    </a>
                    <figcaption>
                        Lawnmower.* installed into its case! Well, except for the camera ribbon...
                    </figcaption>
                </figure>
                <p>
                    Look how well everything fits! There&#39;s just enough room for
                    me to move my tools around and for it to get a little
                    airflow. It&#39;s like this case was made for this!
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3925.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3925.jpg" alt="Pi installed into case and powered on." title="Pi installed into case and powered on."/>
                        
                    </a>
                    <figcaption>
                        Another angle.
                    </figcaption>
                </figure>
                <p>
                    Sexy.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3933.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3933.jpg" alt="Pi sitting in an Instant Pot." title="Pi sitting in an Instant Pot."/>
                        
                    </a>
                    <figcaption>
                        Makeshift fireproof container??
                    </figcaption>
                </figure>
                <p>
                    My first attempt at getting real battery charge numbers
                    from the UPS showed it charged to... <i>101%??</i> Am I
                    building a bomb? It was late, and I didn&#39;t really have a
                    better option for a fireproof container, so I put it in my
                    Instant Pot over night... <i>just in case.</i>
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3935.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3935.jpg" alt="Pi screen showing network statistics." title="Pi screen showing network statistics."/>
                        
                    </a>
                    <figcaption>
                        New screen mode showing network transfer rates and ping times.
                    </figcaption>
                </figure>
                <p>
                    I really wanted to be able to put lawnmower.* on the
                    internet and allow other people connect to it (why else
                    would it have an IRC server?), but I didn&#39;t want to leak my
                    home IP address. I don&#39;t know much about networking, so I
                    spent a long time thinking of how to fix this and testing
                    out different solutions.
                </p>
                <p>
                    First, I tried an SSH tunnel, which worked, but it gave all
                    users on IRC my tunnel endpoint&#39;s IP address. That&#39;s not
                    gonna work.
                </p>
                <p>
                    Then I considered using either haproxy with a WebIRC filter
                    or webircgateway, both of which would allow me to pass the
                    client&#39;s real IP along to the server,  but these seemed...
                    I don&#39;t know... <i>unideal</i>. Certainly this is a problem
                    that other people have solved?!
                </p>
                <p>
                    I talked with several people about this on IRC, and I got a
                    lot of helpful advice, and then Ragnar on Undernet
                    mentioned a <a href="https://en.wikipedia.org/wiki/Generic_Routing_Encapsulation">GRE
                    tunnel</a>. I didn&#39;t know what that was, but I started
                    looking into it, and it&#39;s a tunneling tech that allows you
                    to, among other things, tunnel IP over IP – that&#39;s
                    exactly what I want! After scouring the internet for guides
                    on how to implement this, and some late night hair-pulling,
                    I got it to work. Clients could now connect to a VPS in the
                    cloud and be tunneled directly to my lawnmower.
                </p>
                <p>
                    Finally putting that big, red button on the side to good
                    use, I added a second &#34;screen mode&#34; – network
                    information. This shows current data throughput, last ping
                    time to our GRE tunnel endpoint, the average of the last 100
                    pings, and how many of the last 100 pings have been
                    dropped. The little graph at the bottom right shows a dot
                    for a ping, a caret for a ping over 100ms (3x the average),
                    and an exclamation point for pings that get dropped.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3934.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3934.jpg" alt="Pi screen showing mowing statistics." title="Pi screen showing mowing statistics."/>
                        
                    </a>
                    <figcaption>
                        New screen mode showing distance pushed and area mown.
                    </figcaption>
                </figure>
                <p>
                    Was debating one day whether to add distance/area tracking,
                    which seemed like a cool idea, but wasn&#39;t something I was
                    sure I knew how to do, so I mentioned it to Empus.
                </p>
                <blockquote>
                    <p>Undernet, December 30, 2020</p>
                    <table>
                        <tbody><tr>
                            <td>jotun</td>
                            <td>debating if i wanna spend the money to add distance tracking to lawnmower.*</td>
                        </tr>
                        <tr>
                            <td>jotun</td>
                            <td>so i can see how far i&#39;ve mown</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>oh god</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>where do I donate for that</td>
                        </tr>
                        <tr>
                            <td>Empus</td>
                            <td>is that a trick question?</td>
                        </tr>
                    </tbody></table>
                </blockquote>
                <p>
                    I haven&#39;t done any soldering since I was in college, but I
                    guess we&#39;re doing it!
                </p>
                <p>
                    I made an Amazon wishlist for the necessary hardware, and
                    Empus promptly bought everything on the list.
                </p>
                <p>
                    Only one problem remained. The Pi has a 40-pin header of
                    which two pins are 3V3 power. It has 25 GPIO pins, some of
                    which are dedicated, and some of which your own programs
                    can use for hardware I/O. If I want to attach a Reed switch
                    to measure wheel rotations of the lawnmower, I need to
                    connect it between a 3V3 power pin and a GPIO pin, then
                    configure the GPIO pin to listen for events.
                </p>
                <p>
                    However, between the display and the screen mode button,
                    I&#39;m already using both of the 3V3 pins. What to do?
                </p>
                <p>
                    It finally came to me – the pins are GPI<b><u>O</u></b>
                    pins! O as in output! I&#39;ll just set one of the free GPIO
                    pins to be an output pin and pull it high, then I&#39;ll set
                    another pin as input and connect the Reed switch between
                    the two pins.
                </p>
                <p>
                    This is probably really obvious if you&#39;ve done projects
                    like this before, but as I said, I haven&#39;t worked on a
                    hardware project like this in 20 years 😄. I did some
                    simple math to translate wheel revolutions / ticks into
                    distance pushed / area mown, and added a screen mode for
                    it.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3936.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3936.jpg" alt="Inside of mower wheel." title="Inside of mower wheel."/>
                        
                    </a>
                    <figcaption>
                        Inside view of my lawnmower&#39;s wheel - need to mount a magnet for the Reed switch.
                    </figcaption>
                </figure>
                <p>
                    Time to mount the magnet for the Reed switch to the inside
                    of the lawnmower wheel. A quick YouTube video showed me how
                    to take the wheel off.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3940.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3940.jpg" alt="Magnet mounted onto wheel with foam to secure it." title="Magnet mounted onto wheel with foam to secure it."/>
                        
                    </a>
                    <figcaption>
                        DIYMAG neodymium magnet mounted onto the inner part of the wheel. Foam rubber to absorb vibration.
                    </figcaption>
                </figure>
                <p>
                    These neodymium magnets I found on Amazon conveniently have
                    a screwhole in the center. I packed some foam rubber behind
                    it to take up the gap and absorb vibrations.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3942.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3942.jpg" alt="Dirty lawnmower body." title="Dirty lawnmower body."/>
                        
                    </a>
                    <figcaption>
                        Lawnmower.* looking like the dirty girl she is.
                    </figcaption>
                </figure>
                <p>
                    Time to clean up my lawnmower and get her ready for
                    pictures!
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3944.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3944.jpg" alt="Cleaned lawnmower body." title="Cleaned lawnmower body."/>
                        
                    </a>
                    <figcaption>
                        She cleans up nice, though.
                    </figcaption>
                </figure>
                <p>
                    She&#39;s no Spring chicken, but she&#39;s still gorgeous to me!
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3952.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3952.jpg" alt="Pi in case mounted to lawnmower arm." title="Pi in case mounted to lawnmower arm."/>
                        
                    </a>
                    <figcaption>
                        Lawnmower.* mounted to my lawnmower using a Loutytuo VESA monitor mount.
                    </figcaption>
                </figure>
                <p>
                    This VESA mount made for attaching an LCD panel to a pole
                    was another Amazon find.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3954.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3954.jpg" alt="Reed switch mounted next to wheel." title="Reed switch mounted next to wheel."/>
                        
                    </a>
                    <figcaption>
                        Reed switch mounted next to the magnet inside the wheel.
                    </figcaption>
                </figure>
                <p>
                    The end of the Reed switch mounted to the lawnmower frame
                    with some Gorilla Tape. The large rare earth magnet is
                    strong enough to trigger the switch from an inch away.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3962.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3962.jpg" alt="Top view of Pi in case mounted to lawnmower arm." title="Top view of Pi in case mounted to lawnmower arm."/>
                        
                    </a>
                    <figcaption>
                        Mower stats after doing a WiFi survey pushing the lawnmower around the perimeter of my yard.
                    </figcaption>
                </figure>
                <p>
                    I did another WiFi survey pushing the lawnmower around the
                    perimeter of the yard. WiFi coverage was good even at the
                    corners! Good router <i>*pat pat*</i>. I used <a href="https://gmap-pedometer.com">gmap-pedometer.com</a> to
                    verify the numbers I was generating matched the real bounds
                    of my yard.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3963.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3963.jpg" alt="Lawnmower with laptop in garage." title="Lawnmower with laptop in garage."/>
                        
                    </a>
                    <figcaption>
                        Debugging in my garage.
                    </figcaption>
                </figure>
                <p>
                    I can do a lot of development remotely, but for some
                    things, you just wanna have your hands on the hardware.
                </p>
                <p>
                    In this session, I&#39;m working on broadcasting status updates
                    to IRC, so I want to be able to spin the wheel to simulate
                    me pushing the mower around the yard. Here&#39;s what the IRC
                    status updates look like:
                </p>
                <blockquote>
                    <p>Undernet, February 2, 2021</p>
                    <table>
                        <tbody><tr>
                            <td>mowerbot</td>
                            <td>🚜 Mower started at 5:19PM! Weather: Weather: Sunny ☀️, 52F (11C), humidity 46%, cloud cover 11%.</td>
                        </tr>
                        <tr>
                            <td>mowerbot</td>
                            <td>🚜 Mower stopped! Elapsed: 24 mins. Pushed today: 3,751 ft (1,143 m) at 1.8 mph (2.9 kph). Mown today: 0.2 acres (610 m²). Pushed lifetime: 2.7 mi (4.4 km). Mown lifetime: 0.6 acres (0.2 hectares).</td>
                        </tr>
                    </tbody></table>
                </blockquote>
                <p>
                    Those are rookie numbers. I gotta pump those numbers up!
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3975.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3975.jpg" alt="View of screen showing half acre mown." title="View of screen showing half acre mown."/>
                        
                    </a>
                    <figcaption>
                        Looking at mower stats after mowing the lawn for the first time! Lots of dust inside the case...
                    </figcaption>
                </figure>
                <p>
                    This is the screen after the first test mow. There&#39;s no
                    filter over the intake fan, so the inside of the case got
                    really dusty. The Pi will probably work fine with a little
                    dust, because it has no moving parts, but the fans aren&#39;t
                    going to like it. I need to make a filter.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3983.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3983.jpg" alt="Computer air filter with section cut out." title="Computer air filter with section cut out."/>
                        
                    </a>
                    <figcaption>
                        Making an air filter for lawnmower.* by cannibalizing from my desktop&#39;s air filter.
                    </figcaption>
                </figure>
                <p>
                    I spent a lot of time on Amazon (et al.) studying mesh
                    sizes and trying to determine what would be a good mesh
                    size to trap dirt but still allow airflow with a 30mm 5V
                    fan. In the end, I realized I already have the perfect
                    material, and I cut a piece out of my desktop&#39;s air filter.
                    It&#39;ll be fiiiiiiiiiiiine.
                </p>
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_3990.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_3990.jpg" alt="Homemade air filter attached to input case fan." title="Homemade air filter attached to input case fan."/>
                        
                    </a>
                    <figcaption>
                        Homemade air filter installed over case fan, and sensor cabling sealed with foam rubber plug.
                    </figcaption>
                </figure>
                <p>
                    I installed the homemade filter and plugged the other case
                    holes with foam rubber. Next mow had much less dirt and
                    dust in the case. Great success!
                </p>

                <figure>
                    <video src="hallucinations.mp4" playsinline="" controls="">
                        <p>
                            Your browser doesn&#39;t support HTML5 video, but you can
                            <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/hallucinations.mp4">download it</a>.
                        </p>
                    </video>
                    <figcaption>
                        A video taken from the attached camera.
                    </figcaption>
                </figure>
                <p>
                    Here&#39;s a short sample from the first test mow with the
                    attached camera, which was livestreamed to <a href="https://twitch.tv">twitch.tv</a>. The vibration of
                    the mower engine combined with the rolling shutter of the
                    camera gives this &#34;jell-o&#34; effect. We need some kind of
                    hardware camera stabilizer. I don&#39;t have a good solution
                    for this yet, but I&#39;d love to fix this in the future.
                </p>
                <blockquote>
                    <p>Undernet, January 19, 2021</p>
                    <table>
                        <tbody><tr>
                            <td>Shesle</td>
                            <td>jotun: I watched some of your lawnmower streaming last night before bed and hallucinated the whole night :/</td>
                        </tr>
                    </tbody></table>
                </blockquote>
                <p>
                    Sorry, Shesle. 😐
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_4046.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_4046.jpg" alt="Lawnmower with Pi attached outside." title="Lawnmower with Pi attached outside."/>
                        
                    </a>
                    <figcaption>
                        Lawnmower.* glinting in the sunlight after her maiden voyage.
                    </figcaption>
                </figure>
                <p>
                    Picture taken after the first mow of the season. My
                    neighbors have to wonder what the hell is on my lawnmower.
                </p>

                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_4050.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_4050.jpg" alt="First-person view of lawnmower with Pi attached." title="First-person view of lawnmower with Pi attached."/>
                        
                    </a>
                    <figcaption>
                        My view of lawnmower.* when mowing.
                    </figcaption>
                </figure>
                <p>
                    POV shot. The screen doesn&#39;t show well on the camera here,
                    and it was hard to see in the sunlight as well. I turned up
                    the brightness of the display before the next mow.
                </p>
                <figure>
                    <video src="screen-demo-480p.mp4" playsinline="" controls="">
                        <p>
                            Your browser doesn&#39;t support HTML5 video, but you can
                            <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/screen-demo-480p.mp4">download it</a>.
                        </p>
                    </video>
                    <figcaption>
                        A video walkthrough of the different screen modes.
                    </figcaption>
                </figure>
                <p>
                    Here&#39;s a video walkthrough of the different screen modes,
                    which I can switch between by pressing the red button on
                    the right side of the case.
                    </p><ul>
                        <li>
                            <b>System</b>: Pi uptime, CPU usage, memory usage,
                            disk free bytes, monthly network transfer totals.
                        </li>
                        <li>
                            <b>IRC</b>: Server uptime, link time with our
                            upstream hub, number of local clients (lusers),
                            number of channel users in #lawnmower, and
                            sent/recv bytes to our hub.
                        </li>
                        <li>
                            <b>Network</b>: Current up/down transfer rates,
                            last ping time to our GRE tunnel endpoint, average
                            ping time of the last 100 pings, number of dropped
                            pings, and the ping graph.
                        </li>
                        <li>
                            <b>Mower</b>: Distance pushed in feet and miles,
                            area mown in square feet and acres, and the total
                            number of wheel revolutions/ticks.
                        </li>
                    </ul>
                
                <figure>
                    <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/pics/large/IMG_5000.jpg">
                        <img src="https://jotunheimr.idlerpg.net/users/jotun/lawnmower/placeholder.jpg" data-src="pics/embed/IMG_5000.jpg" alt="Jackson the kitten." title="Jackson the kitten."/>
                        
                    </a>
                    <figcaption>
                        Kitten tax. Say hi to Jackson!
                    </figcaption>
                </figure>
                <p>
                    In the middle of this project, while I was outside one day,
                    I heard a tiny mewing sound from the woods. This little guy
                    emerged and begged to be fed.
                </p>
                <p>
                    I&#39;m much more of a dog person than a cat person, but this
                    was the cutest and most outgoing and playful kitten I&#39;ve
                    ever met. I&#39;m allergic to cats, so I talked my sister into
                    adopting him. He loves his new home and is very happy now!
                    😀
                </p>
                <p>
                    If you made it this far, thanks for reading, and I hope you
                    join us on IRC!
                </p>
            </section>
            <section id="join">
                <h2>Join us!</h2>
                <p>
                    If you&#39;re new to IRC, simply <a href="https://chat.undernet.org/?nick=mowerfan%3F%3F#lawnmower">click here</a> to join us in your browser!
                </p>
                <p>
                    If you&#39;re already familiar with IRC, you can connect to
                    <code>lawnmower.undernet.org</code> and join <a href="irc://lawnmower.undernet.org:6667/#lawnmower">#lawnmower</a>.
                </p>
            </section>
            <section>
                <h2>Nerd stuff</h2>
                <p>
                    Total code written (so far!) is about 3,500 lines across
                    223 commits in 12 repos between December 7, 2020 and March
                    5, 2021. Click clack click clack!
                </p>
                <p>
                    See <a href="https://jotunheimr.idlerpg.net/users/jotun/lawnmower-stats/">status and statistics</a> about lawnmower.*.
                </p>
            </section>
        </div></div>
  </body>
</html>
