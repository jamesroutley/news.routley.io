<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/joexbayer/c-web-modules">Original</a>
    <h1>Hobby Project: A dynamic C (Hot reloading) module-based Web Framework</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<blockquote>
<p dir="auto"><strong>Note:</strong></p>
</blockquote>
<p dir="auto">Welcome to <strong>c-web-modules</strong>, a modular and efficient approach to web development in C. Inspired by kernel modules and AWS Lambda, this project allows you to upload C code directly to the server, which compiles and deploys it at runtime. No precompilation is necessary, and the server can easily be upgraded to include more features or external libraries.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Addressing the Challenges of C for Web Development</h2><a id="user-content-addressing-the-challenges-of-c-for-web-development" aria-label="Permalink: Addressing the Challenges of C for Web Development" href="#addressing-the-challenges-of-c-for-web-development"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">C isn’t typically the go-to for web development, and there are valid reasons why. Here’s how <strong>c-web-modules</strong> tackles some of the common concerns:</p>
<ol dir="auto">
<li>
<p dir="auto"><strong>Slow Build Cycles</strong>:</p>
</li>
<li>
<p dir="auto"><strong>Speed vs. Practicality</strong>:</p>
</li>
<li>
<p dir="auto"><strong>Manpower and Time-to-Market</strong>:</p>
</li>
<li>
<p dir="auto"><strong>Memory Management and Crashes</strong>:</p>
</li>
<li>
<p dir="auto"><strong>Pre-Made Solutions</strong>:</p>
</li>
</ol>
<p dir="auto">This isn’t a silver bullet—it’s a proof of concept. But <strong>c-web-modules</strong> aims to bring C’s raw power into the web world in a more developer-friendly way.</p>
<hr/>

<p dir="auto">Here’s a simple example of a module that keeps track of a counter and returns its value every time you visit <code>/counter</code>.
See more examples in the <code>example/</code> folder.</p>
<p dir="auto"><a href="https://bjorg.bjornroche.com/joexbayer/c-web-modules/blob/main/example/websocket.c">Websocket</a></p>
<p dir="auto"><a href="https://bjorg.bjornroche.com/joexbayer/c-web-modules/blob/main/example/chat.c">Chat application</a></p>
<p dir="auto"><a href="https://bjorg.bjornroche.com/joexbayer/c-web-modules/blob/main/example/json.c">JSON</a></p>
<p dir="auto"><a href="https://bjorg.bjornroche.com/joexbayer/c-web-modules/blob/main/example/todo.c">TODO App</a></p>
<p dir="auto">SQLite3 App (TODO)</p>

<div dir="auto" data-snippet-clipboard-copy-content="#include &lt;stdio.h&gt;
#include &lt;cweb.h&gt;

static int counter = 0;
static const char* template = 
    &#34;&lt;html&gt;\n&#34;
    &#34;  &lt;body&gt;\n&#34;
    &#34;    &lt;h1&gt;Counter: %d&lt;/h1&gt;\n&#34;
    &#34;  &lt;/body&gt;\n&#34;
    &#34;&lt;/html&gt;\n&#34;;

/* Route: /counter - Method GET */
static int index_route(struct http_request *req, struct http_response *res) {
    snprintf(res-&gt;body, HTTP_RESPONSE_SIZE, template, counter++);
    res-&gt;status = HTTP_200_OK;
    return 0;
}

/* Define the routes for the module */
export module_t config = {
    .name = &#34;counter&#34;,
    .author = &#34;cweb&#34;,
    .routes = {
        {&#34;/counter&#34;, &#34;GET&#34;, index_route, NONE},
    },
    .size = 1,
};"><pre><span>#include</span> <span>&lt;stdio.h&gt;</span>
<span>#include</span> <span>&lt;cweb.h&gt;</span>

<span>static</span> <span>int</span> <span>counter</span> <span>=</span> <span>0</span>;
<span>static</span> <span>const</span> <span>char</span><span>*</span> <span>template</span> <span>=</span> 
    <span>&#34;&lt;html&gt;\n&#34;</span>
    <span>&#34;  &lt;body&gt;\n&#34;</span>
    <span>&#34;    &lt;h1&gt;Counter: %d&lt;/h1&gt;\n&#34;</span>
    <span>&#34;  &lt;/body&gt;\n&#34;</span>
    <span>&#34;&lt;/html&gt;\n&#34;</span>;

<span>/* Route: /counter - Method GET */</span>
<span>static</span> <span>int</span> <span>index_route</span>(<span>struct</span> <span>http_request</span> <span>*</span><span>req</span>, <span>struct</span> <span>http_response</span> <span>*</span><span>res</span>) {
    <span>snprintf</span>(<span>res</span><span>-&gt;</span><span>body</span>, <span>HTTP_RESPONSE_SIZE</span>, <span>template</span>, <span>counter</span><span>++</span>);
    <span>res</span><span>-&gt;</span><span>status</span> <span>=</span> <span>HTTP_200_OK</span>;
    <span>return</span> <span>0</span>;
}

<span>/* Define the routes for the module */</span>
<span>export</span> <span>module_t</span> <span>config</span> <span>=</span> {
    .<span>name</span> <span>=</span> <span>&#34;counter&#34;</span>,
    .<span>author</span> <span>=</span> <span>&#34;cweb&#34;</span>,
    .<span>routes</span> <span>=</span> {
        {<span>&#34;/counter&#34;</span>, <span>&#34;GET&#34;</span>, <span>index_route</span>, <span>NONE</span>},
    },
    .<span>size</span> <span>=</span> <span>1</span>,
};</pre></div>
<hr/>

<ol dir="auto">
<li><strong>Code Deployment</strong>: Upload raw C code to the server for on-the-fly compilation and deployment.</li>
<li><strong>No Precompilation</strong>: Simplify your workflow—focus on writing code, and let the server handle compilation.</li>
<li><strong>Dynamic Updates</strong>: Add or replace functionality without downtime or recompiling the entire server.</li>
<li><strong>Performance</strong>: Written in C, the server offers unmatched speed and efficiency.</li>
<li><strong>WebSocket Support</strong>: Even when modules are updated, existing WebSocket connections remain alive.</li>
<li><strong>Built-In Features</strong>: Includes a cross-module cache and scheduler for deferred tasks.</li>
</ol>
<p dir="auto">Currently supported external libraries:</p>
<ul dir="auto">
<li><strong>OpenSSL</strong>: Currently only for hashing, but later for secure communication.</li>
<li><strong>SQLite3</strong>: Shared by all modules for lightweight database needs.</li>
<li><strong>Jansson</strong>: For easy JSON parsing and manipulation.</li>
</ul>
<hr/>

<p dir="auto">Deploying code to the server is simple and can be done in multiple ways, depending on your workflow.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">1. Basic Deployment with <code>curl</code></h3><a id="user-content-1-basic-deployment-with-curl" aria-label="Permalink: 1. Basic Deployment with curl" href="#1-basic-deployment-with-curl"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">At its core, deploying code to the server involves sending a POST request with the C file attached. Here’s an example using <code>curl</code>:</p>
<p dir="auto"><code>curl -X POST -F &#34;code=@path/to/yourcode.c&#34; http://localhost:8080/mgnt</code></p>
<div dir="auto"><h3 tabindex="-1" dir="auto">2. Using the cweb script and .ini config</h3><a id="user-content-2-using-the-cweb-script-and-ini-config" aria-label="Permalink: 2. Using the cweb script and .ini config" href="#2-using-the-cweb-script-and-ini-config"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The script handles:</p>
<ul dir="auto">
<li>Sending the file to the server using <code>curl</code>.</li>
<li>Parsing responses for success or failure.</li>
<li>Providing helpful logs and error messages.</li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Deploying Multiple Files with a Config File</h4><a id="user-content-deploying-multiple-files-with-a-config-file" aria-label="Permalink: Deploying Multiple Files with a Config File" href="#deploying-multiple-files-with-a-config-file"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>./cweb deploy path/to/yourcode.c</code></p>
<p dir="auto">You can deploy multiple modules in one go using a configuration file. By default, the script looks for a file named <code>routes.ini</code>.</p>
<p dir="auto">Example <code>routes.ini</code> file:</p>
<div dir="auto" data-snippet-clipboard-copy-content="server_url=http://localhost:8080/mgnt

[modules]
example1.c
example2.c"><pre><span>server_url</span>=http://localhost:8080/mgnt

<span>[modules]</span>
example1.c
example2.c</pre></div>
<p dir="auto">When using the .ini files you run: <code>./cweb deploy</code></p>

<p dir="auto">Error messages are forwarded back to you over http.</p>
<hr/>

<blockquote>
<p dir="auto"><strong>Note:</strong></p>
</blockquote>
<p dir="auto">The project depends on:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Linux
sudo apt-get install libssl-dev
sudo apt-get install libsqlite3-dev
sudo apt-get install libjansson-dev

# MacOS
brew install openssl@3
brew install sqlite
brew install jansson"><pre><span><span>#</span> Linux</span>
sudo apt-get install libssl-dev
sudo apt-get install libsqlite3-dev
sudo apt-get install libjansson-dev

<span><span>#</span> MacOS</span>
brew install openssl@3
brew install sqlite
brew install jansson</pre></div>
<p dir="auto">Run make to compile and make run to start the server.</p>


<div dir="auto" data-snippet-clipboard-copy-content="docker-compose up --build"><pre>docker-compose up --build</pre></div>

<p dir="auto">Unlike Apache modules and ISAPI extensions, which are tightly integrated into the server and require configuration changes followed by a server restart or reload, <strong>c-web-modules</strong> offers runtime flexibility.</p>
<p dir="auto"><strong>Key Differences:</strong></p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Dynamic Deployment</strong>:</p>
</li>
<li>
<p dir="auto"><strong>Module Isolation</strong>:</p>
</li>
<li>
<p dir="auto"><strong>WebSocket Updates</strong>:</p>
</li>
</ul>
<p dir="auto">This makes <strong>c-web-modules</strong> suitable for rapid experimentation and modular design, especially in scenarios requiring frequent updates without disrupting service.</p>
</article></div></div>
  </body>
</html>
