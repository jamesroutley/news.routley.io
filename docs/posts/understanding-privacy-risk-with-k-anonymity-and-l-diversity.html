<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://marcusolsson.dev/k-anonymity-and-l-diversity/">Original</a>
    <h1>Understanding privacy risk with k-anonymity and l-diversity</h1>
    
    <div id="readability-page-1" class="page"><div id="main"><article><section><figure><img src="https://marcusolsson.dev/k-anonymity-and-l-diversity/images/cover.webp" srcset="/k-anonymity-and-l-diversity/images/cover_hu513f902be063371c982306fa43af05bc_36022_1200x0_resize_q90_h2_lanczos_2.webp 1200w, /k-anonymity-and-l-diversity/images/cover_hu513f902be063371c982306fa43af05bc_36022_1024x0_resize_q90_h2_lanczos_2.webp 1024w, /k-anonymity-and-l-diversity/images/cover_hu513f902be063371c982306fa43af05bc_36022_720x0_resize_q90_h2_lanczos_2.webp 720w, /k-anonymity-and-l-diversity/images/cover_hu513f902be063371c982306fa43af05bc_36022_640x0_resize_q90_h2_lanczos_2.webp 640w, /k-anonymity-and-l-diversity/images/cover_hu513f902be063371c982306fa43af05bc_36022_320x0_resize_q90_h2_lanczos_2.webp 320w" sizes="(min-width: 38em) 38em, 100vw" width="1200" height="630" loading="eager"/></figure></section><section><p>Imagine you’re a data analyst at a global company who’s been asked to provide employee statistics for a survey on remote working and distributed teams. You’ve extracted the relevant employee data, but sharing it as-is could violate privacy laws. How can you anonymize this data while ensuring it’s still useful? In this article, you’ll learn about <em>k-anonymity</em> and <em>l-diversity</em>—two valuable techniques in privacy engineering to help you reduce the privacy risk in datasets.</p><div><p>Before you continue reading</p><p>Data anonymization is a complex topic that’s difficult to accomplish in practice. This article aims to give you a basic understanding of two commonly used data anonymization techniques. Using these techniques, however, <strong>does not guarantee compliance</strong> with regulations such as GDPR.</p></div><p>First, let’s look at the data you’ve extracted from your internal HR system:</p><div><table><thead><tr><th>full_name</th><th>email</th><th>country</th><th>tenure_years</th><th>department</th></tr></thead><tbody><tr><td>John Smith</td><td>jsmith@…</td><td>USA</td><td>5</td><td>Sales</td></tr><tr><td>Maria Garcia</td><td>mgarcia@…</td><td>USA</td><td>3</td><td>Marketing</td></tr><tr><td>Yuki Tanaka</td><td>ytanaka@…</td><td>Japan</td><td>7</td><td>Engineering</td></tr><tr><td>Hans Mueller</td><td>hmueller@…</td><td>Germany</td><td>2</td><td>Finance</td></tr><tr><td>Sarah Johnson</td><td>sjohnson@…</td><td>UK</td><td>5</td><td>HR</td></tr><tr><td>Pierre Dubois</td><td>pdubois@…</td><td>UK</td><td>3</td><td>Sales</td></tr><tr><td>Li Wei</td><td>lwei@…</td><td>China</td><td>7</td><td>Engineering</td></tr><tr><td>Anna Kowalski</td><td>akowalski@…</td><td>USA</td><td>2</td><td>Marketing</td></tr><tr><td>Eva Schmidt</td><td>eschmidt@…</td><td>Germany</td><td>5</td><td>Finance</td></tr><tr><td>Priya Patel</td><td>ppatel@…</td><td>UK</td><td>3</td><td>HR</td></tr></tbody></table></div><p>The data identifies individual employees by name and email, so sharing it with a third party may violate privacy laws.</p><h2 id="a-first-attempt-at-anonymization">A first attempt at anonymization</h2><p>Fortunately, the survey partner doesn’t need this level of specificity. Let’s start by removing all fields that directly identify individual employees, such as <code>full_name</code> and <code>email</code>.</p><p>Next, we’ll attempt to further de-identify the individuals by aggregating individual rows into groups.</p><div><table><thead><tr><th>country</th><th>tenure_years</th><th>departments</th><th>count</th></tr></thead><tbody><tr><td>USA</td><td>0-5</td><td>Sales, Marketing</td><td>3</td></tr><tr><td>Japan</td><td>6-10</td><td>Engineering</td><td>1</td></tr><tr><td>Germany</td><td>0-5</td><td>Finance</td><td>2</td></tr><tr><td>UK</td><td>0-5</td><td>HR, Sales</td><td>3</td></tr><tr><td>China</td><td>6-10</td><td>Engineering</td><td>1</td></tr></tbody></table></div><p>There, we’ve removed the names and emails, but is new dataset truly anonymous? Assume that an attacker knows that Yuki Tanaka lives in Japan. With this dataset, they could infer that Yuki works in Engineering <em>and</em> roughly how long he’s been with the company. Even though a dataset doesn’t directly identify an individual, some may still be <em>identifiable</em>.</p><div><p>Quasi-identifiers</p><p>Attributes that don’t uniquely identify an individual on their own but may, when combined with other attributes, are called <em>quasi-identifiers</em>. In our example, attributes like country, tenure, and department are quasi-identifiers. They don’t directly identify a person, but when combined, they might narrow down the possibilities enough to uniquely identify someone.</p></div><p>It’s clear that our first attempt isn’t enough to reasonably protect the privacy of the employees. Next, we’ll see how we can further reduce the privacy risk with <em>k-anonymity</em>.</p><h2 id="k-anonymity">K-anonymity</h2><p>K-anonymity is a data anonymization technique ensuring that for each combination of quasi-identifying attributes (such as country and tenure), there are at least <em>k</em> rows that share those exact values.</p><p>The <em>k</em> is a number we choose. For example, if <em>k=2</em>, the data is considered to be <em>2-anonymous</em>. A higher <em>k</em> value provides more privacy.</p><h3 id="example-with-k2">Example with k=2</h3><p>By setting <em>k=2</em>, we’re saying that each combination of quasi-identifiers must appear at least twice in the dataset.</p><p>Here’s how our data looks after applying <em>k=2</em> anonymity:</p><div><table><thead><tr><th>country</th><th>tenure_years</th><th>department</th><th>count</th></tr></thead><tbody><tr><td>USA</td><td>0-5</td><td>Sales, Marketing</td><td>3</td></tr><tr><td>UK</td><td>0-5</td><td>HR, Sales</td><td>3</td></tr><tr><td>Germany</td><td>0-5</td><td>Finance</td><td>2</td></tr><tr><td>Other</td><td>6-10</td><td>Engineering</td><td>2</td></tr></tbody></table></div><figure><img src="https://marcusolsson.dev/k-anonymity-and-l-diversity/images/k2.png" alt="For k = 2, each group contains at least two employees."/><figcaption><p>For k = 2, each group contains at least two employees.</p></figcaption></figure><p>Notice how Japan and China are now grouped as “Other”. Since both of them only have one employee, we had to combine them for all combinations to have a count of 2 or more.</p><h3 id="example-with-k5">Example with k=5</h3><p>If a higher <em>k</em> means improved privacy, why don’t we just set it to a really big number? Let’s see what happens when we increase <em>k</em> to 5—each combination of quasi-identifiers appearing at least five times:</p><div><table><thead><tr><th>continent</th><th>tenure_years</th><th>department</th><th>count</th></tr></thead><tbody><tr><td>Europe</td><td>0-5</td><td>HR, Sales, Finance</td><td>5</td></tr><tr><td>Other</td><td>0-10</td><td>Engineering, Sales, Marketing</td><td>5</td></tr></tbody></table></div><figure><img src="https://marcusolsson.dev/k-anonymity-and-l-diversity/images/k5.png" alt="For k = 5, only two groups remain."/><figcaption><p>For k = 5, only two groups remain.</p></figcaption></figure><p>It’s now much harder to identify individual employees in the dataset. But as a result, we had to remove so much information that it lost its usefulness. Any employee outside of Europe is grouped under “Other”, and the range of tenure becomes so big that it’s no longer useful.</p><p>Lower <em>k</em> values increase specificity, while higher <em>k</em> values offer better privacy protection. The best value for <em>k</em> depends on your dataset and how sensitive your data is.</p><h2 id="l-diversity">L-diversity</h2><p>Let’s assume we choose <em>k=2</em> so that all combinations occur at least twice. Unfortunately, it still fails to protect employees in Germany, Japan, and China.</p><p>Since all the employees in Asia work in Engineering, we’ve done little to protect Yuki’s privacy. You may also have realized that it doesn’t actually matter how many employees are in the Other group if all of them are in Engineering. The problem isn’t the size of the group, but the lack of <em>diversity</em> in the <code>departments</code> column.</p><p>This is where l-diversity comes in. L-diversity builds on k-anonymity to provide even more privacy by ensuring a given level of diversity in sensitive attributes within each group.</p><figure><img src="https://marcusolsson.dev/k-anonymity-and-l-diversity/images/l1.png" alt="The Germany and Other groups aren&amp;rsquo;t diverse enough for l = 1."/><figcaption><p>The Germany and Other groups aren’t diverse enough for <em>l = 1</em>.</p></figcaption></figure><p>L-diversity ensures that there’s sufficient diversity within each combination of quasi-identifiers. For example, <em>l=5</em> means that within each group, there are at least 5 well-represented values for the sensitive attribute (in this case, department).</p><div><p>What is a well-represented value?</p><p>Note that l-diversity doesn’t necessarily mean <em>l</em> <em>unique</em> values in each group. For example, if the UK had 9 employees in Sales and only one in HR, an external actor could guess with 90% confidence that an employee works in Sales.</p></div><p>In our example, one way to achieve <em>l=2</em> is to move all employees in Germany into the Other group. Note that, as a result, the dataset is now 3-anonymous.</p><div><table><thead><tr><th>country</th><th>tenure_years</th><th>department</th><th>count</th></tr></thead><tbody><tr><td>USA</td><td>0-5</td><td>Sales, Marketing</td><td>3</td></tr><tr><td>UK</td><td>0-5</td><td>HR, Sales</td><td>3</td></tr><tr><td>Other</td><td>0-10</td><td>Finance, Engineering</td><td>4</td></tr></tbody></table></div><figure><img src="https://marcusolsson.dev/k-anonymity-and-l-diversity/images/l2.png" alt="k = 3 and l = 2"/><figcaption><p>k = 3 and l = 2</p></figcaption></figure><p>Now, each group has at least two different department values, satisfying l-diversity with <em>l=2</em>. Even if someone knew Yuki was based in Japan, it’s no longer trivial to deduce that he’s in Engineering. Unfortunately—just like for <em>k=5</em>—the tenure range (0-10) is likely too wide to be useful.</p><p>As you can see, setting the values or <em>k</em> and <em>l</em> involves balancing data utility against privacy protection. It also illustrates an important point: <em>using k-anonymity and l-diversity doesn’t guarantee the absence of privacy risk</em>.</p><h2 id="limitations-and-considerations">Limitations and considerations</h2><p>K-anonymity and l-diversity allow us to communicate privacy risk in a dataset. However, as we saw throughout the article, these techniques have limitations:</p><ul><li><strong>Homogeneity attacks:</strong> An attacker can still infer sensitive information if all sensitive values within a k-anonymous group are the same.</li><li><strong>Background knowledge attacks:</strong> Additional information might allow attackers to narrow down possibilities.</li><li><strong>Skewness attacks:</strong> Even with l-diversity, if one value is much more frequent, high-probability inferences are possible.</li><li><strong>Similarity attacks:</strong> If the sensitive values in a group are semantically similar, it may still allow harmful inferences.</li><li><strong>Data utility trade-off:</strong> As we increase privacy protections, we often lose some of the data’s usefulness or specificity.</li></ul><p>In practice, it may be impossible to completely eliminate the risk of re-identification without rendering the data useless in the process. The best way to remove privacy risk is to avoid collecting or sharing the information in the first place.</p><h2 id="learn-more">Learn more</h2><p>To learn more, I recommend the
<a href="https://utrechtuniversity.github.io/dataprivacyhandbook/k-l-t-anonymity.html?ref=marcusolsson.dev">Data Privacy Handbook by Utrect University</a>. In addition to k-anonymity and l-diversity, it also covers <em>t-closeness</em>—another technique to further reduce privacy risk—along with videos on each technique.</p><p>Also, if you’re using Google Cloud Platform, check out their
<a href="https://cloud.google.com/security/products/sensitive-data-protection?ref=marcusolsson.dev">Sensitive Data Protection</a> which lets you compute
<a href="https://cloud.google.com/sensitive-data-protection/docs/compute-k-anonymity?ref=marcusolsson.dev">k-anonymity</a> and
<a href="https://cloud.google.com/sensitive-data-protection/docs/compute-l-diversity?ref=marcusolsson.dev">l-diversity</a> on your datasets.</p><h2 id="conclusion">Conclusion</h2><p>As data professionals, we need to balance privacy risks and data utility when sharing sensitive data. K-anonymity and l-diversity are two data anonymization techniques that can help you reason and make conscious decisions about the privacy risks for a dataset.</p><p>Unfortunately, it may be close to impossible to guarantee that an attacker won’t be able to re-identify individuals in a dataset. Data anonymization techniques should only be used as one part of a larger, comprehensive privacy program.</p></section></article></div></div>
  </body>
</html>
