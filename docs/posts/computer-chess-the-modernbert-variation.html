<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://interwebalchemy.com/posts/modern-bert-variation">Original</a>
    <h1>Computer Chess: The ModernBERT Variation</h1>
    
    <div id="readability-page-1" class="page"><div><p>I&#39;m not a Machine Learning (ML) expert, but I have a hypothesis: <strong>Language models are mostly bad at chess because we don&#39;t tokenize chess moves well.</strong></p>
<p>Just look at how the tokenizers for popular model architectures break a PGN string down into tokens:</p>
<div><div><p><strong>Tokens:</strong></p><!-- --><p>0</p></div></div>
<p>So, I decided to learn how tokenizers work and build a new one that understands chess.</p>
<p>Here&#39;s where I ended up:</p>
<div><div><p><strong>Tokens:</strong></p><!-- --><p>0</p></div></div>
<p>If you want to play around with the tokenizer, <a href="https://github.com/DVDAGames/pgn-tokenizer">all of the code is open-source</a>. The Python library is published to PyPI as <a href="https://pypi.org/project/pgn-tokenizer/"><code>pgn-tokenizer</code></a>. A beta version of the TypeScript library is published to npm as <a href="https://www.npmjs.com/package/@dvdagames/pgn-tokenizer">`@dvdagames/pgn-tokenizer</a>.</p>
<h2 id="the-dataset-defense"><a aria-hidden="true" tabindex="-1" href="#the-dataset-defense"><span></span></a>The Dataset Defense</h2>
<p>I knew the first thing I needed was data. <a href="https://www.educatingsilicon.com/2024/05/09/how-much-llm-training-data-is-there-in-the-limit/">Lots</a> and <a href="https://towardsdatascience.com/how-to-build-an-llm-from-scratch-8c477768f1f9/">lots</a> of data. Luckily, the world has no shortage of <a href="https://huggingface.co/datasets/Lichess/standard-chess-games">chess data</a>&gt;). Unluckily, there seem to be two classes of chess datasets:</p>
<ol>
<li>Massive datasets that take up terabytes (TB) of space</li>
<li>Smaller datasets that don&#39;t include a PGN string or use non-standard formatting</li>
</ol>
<p>It also seemed like I could need a lot of time and money to process all the data and train a model, neither of which I was eager to give up just to tinker for fun. So, I&#39;d need to build something that could run on my recently purchased MacBook M4 Pro using a dataset that could reasonably fit on my hard drive.</p>
<h2 id="the-kaggle-gambit"><a aria-hidden="true" tabindex="-1" href="#the-kaggle-gambit"><span></span></a>The Kaggle Gambit</h2>
<p>I discovered a (now unpublished) dataset on Kaggle, adapted from <a href="https://chess-research-project.readthedocs.io/en/latest/">the chess research project</a> that included ~3 million games from ChessDB dating back to 1783, which felt like a pretty neat representative sample of the game. Unfortunately, the data stopped about 9 years ago, so there&#39;s a lot more data that could be included now that chess has experienced its <a href="https://www.theguardian.com/sport/2020/nov/29/chess-world-hails-queens-gambit-fuelled-boom">renaissance post <em>the Queen&#39;s Gambit</em>.</a> - I&#39;m one of those folks who discovered chess during the pandemic after watching Beth Harmon stick it to the chess patriarchy.</p>
<p>This dataset didn&#39;t fall into either category that I mentioned earlier, despite the underlying source using <a href="https://chess-research-project.readthedocs.io/en/latest/#description-of-the-simplified-format">some truly bizarre formatting</a>. Maybe it was less bizarre almost a decade ago when the research was originally published? I&#39;m sure the labeling served some research goals, but it means the dataset isn&#39;t as valuable for general purposes.</p>
<p>Here&#39;s an example of the data:</p>
<pre tabindex="0"><code><span><span>1.t 2.date 3.result 4.welo 5.belo 6.len 7.date_c 8.resu_c 9.welo_c 10.belo_c 11.edate_c 12.setup 13.fen 14.resu2_c 15.oyrange 16.bad_len 17.game...</span></span>
<span><span>1 2000.03.14 1-0 2851 None 67 date_false result_false welo_false belo_true edate_true setup_false fen_false result2_false oyrange_false blen_false ### W1.d4 B1.d5 W2.c4 B2.e6 W3.Nc3 B3.Nf6 W4.cxd5 B4.exd5 W5.Bg5 B5.Be7 W6.e3 B6.Ne4 W7.Bxe7 B7.Nxc3 W8.Bxd8 B8.Nxd1 W9.Bxc7 B9.Nxb2 W10.Rb1 B10.Nc4 W11.Bxc4 B11.dxc4 W12.Ne2 B12.O-O W13.Nc3 B13.b6 W14.d5 B14.Na6 W15.Bd6 B15.Rd8 W16.Ba3 B16.Bb7 W17.e4 B17.f6 W18.Ke2 B18.Nc7 W19.Rhd1 B19.Ba6 W20.Ke3 B20.Kf7 W21.g4 B21.g5 W22.h4 B22.h6 W23.Rh1 B23.Re8 W24.f3 B24.Bb7 W25.hxg5 B25.fxg5 W26.d6 B26.Nd5+ W27.Nxd5 B27.Bxd5 W28.Rxh6 B28.c3 W29.d7 B29.Re6 W30.Rh7+ B30.Kg8 W31.Rbh1 B31.Bc6 W32.Rh8+ B32.Kf7 W33.Rxa8 B33.Bxd7 W34.Rh7+</span></span>
<span><span>2 2000.03.14 1-0 2851 None 53 date_false result_false welo_false belo_true edate_true setup_false fen_false result2_false oyrange_false blen_false ### W1.e4 B1.d5 W2.exd5 B2.Qxd5 W3.Nc3 B3.Qa5 W4.d4 B4.Nf6 W5.Nf3 B5.c6 W6.Ne5 B6.Bf5 W7.g4 B7.Be4 W8.f3 B8.Bd5 W9.a3 B9.Nbd7 W10.Be3 B10.Nxe5 W11.dxe5 B11.Nxg4 W12.Bd4 B12.e6 W13.b4 B13.Qd8 W14.Nxd5 B14.Qxd5 W15.c4 B15.Ne3 W16.cxd5 B16.Nxd1 W17.dxc6 B17.bxc6 W18.Rxd1 B18.Be7 W19.Ba6 B19.O-O W20.Ke2 B20.Rab8 W21.Rc1 B21.Rfd8 W22.Rhd1 B22.c5 W23.Bxc5 B23.Rxd1 W24.Rxd1 B24.Bxc5 W25.bxc5 B25.g6 W26.c6 B26.Rb2+ W27.Rd2</span></span>
<span><span>3 1999.11.20 1-0 2851 None 57 date_false result_false welo_false belo_true edate_false setup_false fen_false result2_false oyrange_false blen_false ### W1.e4 B1.e5 W2.Nf3 B2.Nc6 W3.Bc4 B3.Bc5 W4.c3 B4.Nf6 W5.d3 B5.d6 W6.Bb3 B6.O-O W7.Nbd2 B7.Be6 W8.O-O B8.Qd7 W9.Re1 B9.Rfe8 W10.Nf1 B10.Ne7 W11.Ng3 B11.Bg4 W12.h3 B12.Be6 W13.Bg5 B13.Kh8 W14.Bxf6 B14.gxf6 W15.d4 B15.exd4 W16.cxd4 B16.Bb4 W17.Re3 B17.Rg8 W18.d5 B18.Bxh3 W19.Qd4 B19.Rg6 W20.Qxb4 B20.c5 W21.Qc3 B21.Bg4 W22.Bc2 B22.Rh6 W23.Nh2 B23.b5 W24.b4 B24.Rc8 W25.Bd3 B25.c4 W26.Bc2 B26.Bh5 W27.Nxh5 B27.Rxh5 W28.Qxf6+ B28.Kg8 W29.Bd1</span></span></code></pre>
<p>This Kaggle user had already done most of the hard work of cleaning the Chess Research Project&#39;s dataset:</p>
<div><h4>Sample of the Kaggle PGN Dataset</h4><div><table><thead><tr><th></th><th>Date</th><th>Result</th><th>WhiteElo</th><th>BlackElo</th><th>PGN</th></tr></thead><tbody><tr><td>1</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 e6 3.Nc3 Nf6 4.cxd5 exd5 5.Bg5 Be7 6.e3 Ne4 7.Bxe7 Nxc3 8.Bxd8 Nxd1 9.Bxc7 Nxb2 10.Rb1 Nc4 11.Bxc4 dxc4 12.Ne2 O-O 13.Nc3 b6 14.d5 Na6 15.Bd6 Rd8 16.Ba3 Bb7 17.e4 f6 18.Ke2 Nc7 19.Rhd1 Ba6 20.Ke3 Kf7 21.g4 g5 22.h4 h6 23.Rh1 Re8 24.f3 Bb7 25.hxg5 fxg5 26.d6 Nd5+ 27.Nxd5 Bxd5 28.Rxh6 c3 29.d7 Re6 30.Rh7+ Kg8 31.Rbh1 Bc6 32.Rh8+ Kf7 33.Rxa8 Bxd7 34.Rh7+</p></td></tr><tr><td>2</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 d5 2.exd5 Qxd5 3.Nc3 Qa5 4.d4 Nf6 5.Nf3 c6 6.Ne5 Bf5 7.g4 Be4 8.f3 Bd5 9.a3 Nbd7 10.Be3 Nxe5 11.dxe5 Nxg4 12.Bd4 e6 13.b4 Qd8 14.Nxd5 Qxd5 15.c4 Ne3 16.cxd5 Nxd1 17.dxc6 bxc6 18.Rxd1 Be7 19.Ba6 O-O 20.Ke2 Rab8 21.Rc1 Rfd8 22.Rhd1 c5 23.Bxc5 Rxd1 24.Rxd1 Bxc5 25.bxc5 g6 26.c6 Rb2+ 27.Rd2</p></td></tr><tr><td>3</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Bc5 4.c3 Nf6 5.d3 d6 6.Bb3 O-O 7.Nbd2 Be6 8.O-O Qd7 9.Re1 Rfe8 10.Nf1 Ne7 11.Ng3 Bg4 12.h3 Be6 13.Bg5 Kh8 14.Bxf6 gxf6 15.d4 exd4 16.cxd4 Bb4 17.Re3 Rg8 18.d5 Bxh3 19.Qd4 Rg6 20.Qxb4 c5 21.Qc3 Bg4 22.Bc2 Rh6 23.Nh2 b5 24.b4 Rc8 25.Bd3 c4 26.Bc2 Bh5 27.Nxh5 Rxh5 28.Qxf6+ Kg8 29.Bd1</p></td></tr><tr><td>4</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 d5 2.exd5 Qxd5 3.Nc3 Qa5 4.d4 e6 5.Nf3 c6 6.Bd3 Nf6 7.O-O Be7 8.Re1 Nbd7 9.Ne5 O-O 10.Bg5 Qd8 11.Qf3 Re8 12.Rad1 Nf8 13.Ne4 Ng6 14.h4 Nxe5 15.dxe5 Nxe4 16.Bxe4 Qc7 17.Bxe7 Qxe7 18.h5 Bd7 19.h6 gxh6 20.Qf4 h5 21.Qh6 f5 22.exf6 Qf7 23.Re3 Kh8 24.Rg3 Rg8 25.Rg7</p></td></tr><tr><td>5</td><td><p>2000.02.20</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2633</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bb5 a6 4.Ba4 Nf6 5.O-O Be7 6.Re1 b5 7.Bb3 d6 8.c3 O-O 9.h3 Na5 10.Bc2 c5 11.d4 Qc7 12.Nbd2 Bd7 13.Nf1 cxd4 14.cxd4 Rac8 15.Ne3 Nc6 16.d5 Nb4 17.Bb1 a5 18.a3 Na6 19.b4 Ra8 20.Bd2 Rfc8 21.Bd3 Qb7 22.g4 g6 23.Nf1 axb4 24.axb4 Bd8 25.Ng3 Nc7 26.Qe2 Rxa1 27.Rxa1 Ra8 28.Qe1 Nfe8 29.Qc1 Ng7 30.Rxa8 Qxa8 31.Bh6 Nce8 32.Qb2 Qa4 33.Kg2 Bb6 34.Bc2 Qa7 35.Bd3 Qa4 36.Ne2 Nc7 37.Nxe5 dxe5 38.Qxe5 Nce8 39.Bxg7 Qd1 40.Bh6 Qxd3 41.Qe7 Ng7 42.Ng3 Qc2 43.Qf6 Nf5 44.Qxb6 Nh4+ 45.Kh2 Nf3+ 46.Kg2 Nh4+ 47.Kh2 Nf3+ 48.Kg2 Nh4+ 49.Kh2</p></td></tr><tr><td>6</td><td><p>2000.05.24</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2748</p></td><td><p>1.d4 e6 2.Nf3 Nf6 3.c4 d5 4.Nc3 dxc4 5.e4 Bb4 6.Bg5 c5 7.Bxc4 cxd4 8.Nxd4 Qa5 9.Bd2 O-O 10.Nc2 Bxc3 11.Bxc3 Qg5 12.Qe2 Qxg2 13.O-O-O Qxe4 14.Rhg1 g6 15.Ne3 e5 16.f4 Be6 17.Bd3 Qxf4 18.Rgf1 Qh4 19.Be1 Qa4 20.Rxf6 Nc6 21.Rxe6 Nd4 22.Qg4 Qxa2 23.Bxg6 hxg6 24.Rxg6+ fxg6 25.Qxg6+ Kh8 26.Qh5+ Kg8</p></td></tr><tr><td>7</td><td><p>2000.06.19</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2191</p></td><td><p>1.e4 c5 2.Nf3 Nc6 3.Bb5 g6 4.Bxc6 dxc6 5.d3 Bg7 6.h3 Nf6 7.Nc3 O-O 8.Be3 Qa5 9.Qd2 Rd8 10.O-O Bd7 11.Bh6 Qc7 12.Bxg7 Kxg7 13.Qe3 b6 14.Nh2 Rf8 15.f4 Rad8 16.Rae1 Bc8 17.f5 e5 18.Rf2 Qd6 19.Ref1 h6 20.b3 Qd4 21.Qe1 b5 22.Ne2 Qd6 23.Ng3 c4 24.dxc4 bxc4 25.Qa5 cxb3 26.axb3 Rd7 27.Nf3 c5 28.Qc3 Re7 29.Ra1 Rfe8 30.Ra5 Rc7 31.Qe3 Qb6 32.Ra4 Bb7 33.Qc3 Nd7 34.Ra1 c4 35.b4 f6 36.fxg6 Kxg6 37.Nh4+ Kh7 38.Qf3 Qe6 39.Rxa7 Rg8 40.Nhf5</p></td></tr><tr><td>8</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 Nf6 2.c4 g6 3.g3 Bg7 4.Bg2 O-O 5.Nc3 d6 6.Nf3 Nbd7 7.O-O e5 8.e4 exd4 9.Nxd4 Ne5 10.h3 Re8 11.Re1 Nfd7 12.Be3 Nf8 13.b3 Bd7 14.Qc2 Nc6 15.Qd2 a6 16.Rad1 Rc8 17.Bg5 Bf6 18.Bxf6 Qxf6 19.Nde2 Ne5 20.Nd5 Qg7 21.Nef4 Ne6 22.Nxe6 Bxe6 23.f4 Nc6 24.Ne3 Rcd8 25.Qf2 Bc8 26.Nd5 f5 27.exf5 Bxf5 28.g4 Bc8 29.Rxe8+ Rxe8 30.g5 Kh8 31.Nf6 Re6 32.c5 Ne7 33.cxd6 cxd6 34.Qb6 Ng8 35.Qd8 Rxf6 36.gxf6</p></td></tr><tr><td>9</td><td><p>2000.06.19</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2175</p></td><td><p>1.c4 e6 2.g3 d5 3.Bg2 Nf6 4.Nf3 Be7 5.b3 O-O 6.O-O c5 7.Bb2 Nc6 8.e3 b6 9.Nc3 Bb7 10.cxd5 Nxd5 11.Nxd5 Qxd5 12.d4 Rad8 13.Ne5 Qd6 14.dxc5 Qxc5 15.Qe2 Nxe5 16.Bxb7 Qc7 17.Bg2 Bc5 18.Rfd1 a5 19.Rxd8 Rxd8 20.Rd1 Rxd1+ 21.Qxd1 Qd7 22.Qxd7 Nxd7 23.Bc6 Nf6 24.Kg2 Kf8 25.Kf3 Ke7 26.g4 h6 27.h4 g6 28.Bb5 h5 29.g5 Nd5 30.Ke2 Nc7 31.Bd3 Nd5 32.Bc4 Kd6 33.a3 Ne7 34.e4 Nc6 35.f4 Nd4+ 36.Bxd4 Bxd4</p></td></tr><tr><td>10</td><td><p>2000.01.18</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2646</p></td><td><p>1.e4 c5 2.Nf3 d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 a6 6.Be3 e6 7.f3 b5 8.g4 h6 9.Qd2 Nbd7 10.O-O-O Bb7 11.h4 b4 12.Na4 d5 13.Bh3 g5 14.Bg2 gxh4 15.Rxh4 dxe4 16.g5 Nd5 17.Rxe4 hxg5 18.Bxg5 Qa5 19.f4 Rh2 20.Nxe6 fxe6 21.Rxe6+ Kf7 22.Qd3 Bg7 23.Qf5+ Kg8 24.Rxd5 Qxa4 25.Re7</p></td></tr><tr><td>11</td><td><p>2000.01.28</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2725</p></td><td><p>1.e4 c5 2.Nf3 Nc6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 e5 6.Ndb5 d6 7.Bg5 a6 8.Na3 b5 9.Bxf6 gxf6 10.Nd5 f5 11.c3 Bg7 12.exf5 Bxf5 13.Nc2 Be6 14.a4 O-O 15.axb5 axb5 16.Rxa8 Qxa8 17.Nce3 Qb7 18.g4 Ne7 19.Bg2 Nxd5 20.Bxd5 Qe7 21.h4 Rc8 22.g5 Rc5 23.Be4 d5 24.Nxd5 Bxd5 25.Bxd5 e4 26.Ke2 Qe5 27.Bb3 Qc7 28.Qg1 b4 29.g6 hxg6 30.Qxg6 Kf8 31.Qg3 Qxg3 32.fxg3 bxc3 33.bxc3 Rxc3 34.Bd5 Rxg3</p></td></tr><tr><td>12</td><td><p>2000.02.12</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2555</p></td><td><p>1.d4 d5 2.c4 e6 3.Nc3 Nf6 4.cxd5 exd5 5.Bg5 c6 6.Qc2 Be7 7.e3 Nbd7 8.Bd3 O-O 9.Nge2 Re8 10.O-O Nf8 11.f3 Ng6 12.Rad1 h6 13.Bxf6 Bxf6 14.Bxg6 fxg6 15.e4 g5 16.e5 Be7 17.f4 gxf4 18.Nxf4 Rf8 19.Ng6 Rxf1+ 20.Rxf1 Be6 21.Ne2 Qd7 22.h4 Re8 23.Ng3 Bf7 24.Nxe7+ Rxe7 25.Nf5 Re6 26.Nd6 Bg6 27.Qc3 Rxd6 28.exd6 Qxd6 29.Qa3 Qb8 30.Qe7 Qg3 31.Rf3 Qg4 32.Qf8+ Kh7 33.Qf4 Qd7 34.Rg3 Be4 35.Qe5 Qf7 36.h5 Qd7 37.b4 a6 38.a4 Kg8 39.a5 Kh7 40.Kf2 Kg8 41.Qb8+ Kh7 42.Qf8 Bc2 43.Qf4 Be4 44.Qe5 Kg8 45.Ke3 Kh7 46.Ke2 Kg8 47.Qb8+ Kh7 48.Qf8 Bc2 49.Kd2 Be4 50.Kc1 Qc7 51.Rg4 Qd7 52.Rf4 Bxg2 53.Qf5+ Qxf5 54.Rxf5 Kg8 55.Kd2 Bh3 56.Rf4 Be6 57.Ke3 Bf7 58.Rf5 Kf8 59.Re5 Be8 60.Kf4 Bf7 61.Kg4 Be8 62.Kg3 Bf7 63.Kf4 Be8 64.Kf5 Bxh5 65.Ke6 Bg6 66.Re3 Bc2 67.Rf3+ Kg8 68.b5 cxb5 69.Kxd5 b4 70.Kc4 b3 71.Kc3 g5 72.d5 g4 73.Rf4 h5 74.d6</p></td></tr><tr><td>13</td><td><p>2000.06.29</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.b3 c5 2.Bb2 Nc6 3.g3 d6 4.Bg2 Nf6 5.c4 a6 6.Nc3 e5 7.d3 Nd4 8.e3 Bg4 9.Qd2 Nf5 10.Nge2 Bxe2 11.Qxe2 g6 12.Bxb7 Rb8 13.Bc6+ Nd7 14.O-O Bg7 15.Bg2 O-O 16.Nd5 Nb6 17.Nxb6 Rxb6 18.Bh3 Qf6 19.f4 Rb4 20.fxe5 dxe5 21.e4 Qe7 22.exf5 Kh8 23.Rae1 Rbb8 24.f6 Bxf6 25.Rxf6 Qxf6 26.Bxe5 Qxe5 27.Qxe5+ Kg8 28.Bg2 Rbe8 29.Qxe8 Rxe8 30.Rxe8+ Kg7 31.Bd5 h5 32.b4 cxb4 33.c5 b3 34.Bxb3 f5 35.c6 f4 36.c7 fxg3 37.c8=Q gxh2+ 38.Kxh2 h4 39.Qe6 Kh6 40.Rg8 Kg5 41.Rxg6+ Kh5 42.Qg4#</p></td></tr><tr><td>14</td><td><p>2000.06.29</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.b3 e5 2.Bb2 Nc6 3.c4 Bc5 4.e3 d6 5.a3 Bf5 6.Nc3 Be6 7.Nf3 h6 8.Be2 Nf6 9.O-O d5 10.cxd5 Bxd5 11.b4 e4 12.Nxd5 Nxd5 13.bxc5 exf3 14.Bxf3 O-O 15.Qb3 Nde7 16.d4 Na5 17.Qc3 c6 18.d5 f6 19.d6 Ng6 20.Be4 Ne5 21.f4 Nec4 22.Rfe1 Nxb2 23.Qxb2 Nc4 24.Qc3 Na5 25.Bb1 b6 26.e4 bxc5 27.e5 c4 28.e6 Qb6+ 29.Kh1 c5 30.e7 Rfb8 31.Bg6</p></td></tr><tr><td>15</td><td><p>2000.06.23</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2748</p></td><td><p>1.d4 e6 2.c4 b6 3.a3 Bb7 4.Nc3 f5 5.d5 Nf6 6.g3 Na6 7.Bg2 Nc5 8.Nh3 Bd6 9.O-O Be5 10.Qc2 O-O 11.Rd1 Qe7 12.Be3 Rab8 13.Rac1 Nce4 14.Nxe4 Nxe4 15.Nf4 c5 16.dxc6 Bxc6 17.Nd3 Bf6 18.f3 Nc5 19.b4 Nxd3 20.Rxd3 d5 21.f4 dxc4 22.Qxc4 Bxg2 23.Kxg2 Rf7 24.b5 Re8 25.Rcd1 e5 26.Rd7 Qe6 27.Qxe6 Rxe6 28.Kf3 exf4 29.gxf4 Rxd7 30.Rxd7 Re7 31.Rxe7 Bxe7 32.a4 Kf7 33.Bd4 Bd6 34.e4 g6 35.h3 Ke6 36.Bc3 Bc7 37.Bb4 Bd8 38.e5</p></td></tr><tr><td>16</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Nf6 4.d3 Bc5 5.c3 d6 6.Bb3 Be6 7.Bc2 O-O 8.O-O Qd7 9.d4 exd4 10.cxd4 Bxd4 11.Nxd4 Nxd4 12.Qxd4 c5 13.Qd3 b5 14.Rd1 Rfd8 15.Nc3 Bc4 16.Qg3 Qg4 17.Bf4 Qe6 18.b3 Be2 19.Nxe2 d5 20.Bg5 dxe4 21.Nf4 Qe5 22.Bxf6 Qxf6 23.Bxe4 Re8 24.Bxa8 Rxa8 25.Nd5 Qe6 26.Nc7 Qc8 27.Nxa8</p></td></tr><tr><td>17</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 c6 2.d4 d5 3.exd5 cxd5 4.Bd3 Nc6 5.c3 Nf6 6.Bf4 Bg4 7.Qb3 Qd7 8.Nd2 e6 9.Ngf3 Bd6 10.Ne5 Bxe5 11.dxe5 Nh5 12.Be3 a6 13.h3 Nxe5 14.Bf1 Bf5 15.g4 Nd3+ 16.Bxd3 Bxd3 17.gxh5 Rc8 18.Rg1 f6 19.h6 g6 20.O-O-O d4 21.Bxd4 Ke7 22.Nf3 e5 23.Rxd3 exd4 24.Re1+ Kf8 25.Rxd4 Qc6 26.Qb4+</p></td></tr><tr><td>18</td><td><p>2000.06.19</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 c5 2.Nf3 d6 3.c3 Nf6 4.Be2 Nc6 5.d4 cxd4 6.cxd4 e6 7.Nc3 Be7 8.O-O O-O 9.Bd3 a6 10.a3 b5 11.e5 dxe5 12.dxe5 Nd7 13.Qc2 g6 14.Bh6 Re8 15.Rad1 Bb7 16.Rfe1 Rc8 17.Qe2 Qc7 18.Bb1 Red8 19.h4 Nc5 20.h5 Rxd1 21.Rxd1 Rd8 22.Rxd8+ Qxd8 23.Be3 Qc7 24.Bf4 Nb3 25.Qd1 Nc5 26.Ne4 Nxe4 27.Bxe4 Na5 28.Bxb7 Nxb7 29.h6 Nc5 30.Bg5 Ne4 31.Bxe7 Qxe7 32.Qc2 Nc5 33.b4 Nd7 34.Qc7 Qe8 35.Ng5 Nf8 36.Ne4 Nd7 37.Qxd7</p></td></tr><tr><td>19</td><td><p>2000.06.24</p></td><td><p>0-1</p></td><td><p>2851</p></td><td><p>2725</p></td><td><p>1.d4 Nf6 2.Nf3 g6 3.c4 Bg7 4.Nc3 d5 5.Qb3 dxc4 6.Qxc4 O-O 7.e4 a6 8.Qb3 c5 9.dxc5 Qa5 10.Qb6 Qxb6 11.cxb6 Nbd7 12.Be2 Nxb6 13.Be3 Nbd7 14.Nd4 Nc5 15.f3 e5 16.Nc6 bxc6 17.Bxc5 Rd8 18.Kf2 Be6 19.Rhd1 Nd7 20.Be3 Bf8 21.Rd2 f5 22.Rad1 Be7 23.g3 Kf7 24.b3 a5 25.Rc2 Nf6 26.Rxd8 Rxd8 27.exf5 gxf5 28.Na4 Bd5 29.Bb6 Ra8 30.Bc5 Nd7 31.Bxe7 Kxe7 32.Ke3 Kd6 33.Bd3 f4+ 34.gxf4 exf4+ 35.Kxf4 Rf8+ 36.Kg5 Ne5 37.Bxh7 Nxf3+ 38.Kh6 Rf4 39.Re2 Rh4+ 40.Kg7 Nxh2 41.Nc3 Nf3 42.Ne4+ Kc7 43.Nf6 Nd4 44.Nxd5+ cxd5 45.Rd2 Kd6 46.Bd3 Ne6+ 47.Kf6 Rf4+</p></td></tr><tr><td>20</td><td><p>2000.01.30</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2658</p></td><td><p>1.e4 c5 2.Nf3 d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 a6 6.Be3 Ng4 7.Bg5 h6 8.Bh4 g5 9.Bg3 Bg7 10.h3 Nf6 11.Bc4 Qb6 12.O-O O-O 13.Nde2 Qxb2 14.Bb3 Qa3 15.f4 Nc6 16.Kh1 Be6 17.Qd3 Rac8 18.fxg5 hxg5 19.Nd5 Rfe8 20.Rad1 Nb4 21.Qf3 Nbxd5 22.exd5 Bd7 23.c3 a5 24.Qd3 a4 25.Bc2 Qc5 26.Rxf6 exf6 27.Qh7+ Kf8 28.Nd4 Re5 29.Bxe5 fxe5 30.Ne6+ Bxe6 31.dxe6 Rc7 32.Bxa4 d5 33.Qf5 Qc4 34.Bd7 Qf4 35.Qb1 fxe6 36.Bxe6 Ke7 37.Bxd5 Rd7 38.c4 Qe3 39.Qh7 Kd8 40.Rb1 Qf4 41.Be6 Re7 42.Bg4 Rf7 43.Qd3+ Qd4 44.Qg6</p></td></tr><tr><td>21</td><td><p>1999.09.05</p></td><td><p>0-1</p></td><td><p>2851</p></td><td><p>2650</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Nf6 4.d3 Bc5 5.c3 d6 6.Bb3 O-O 7.Bg5 Be6 8.Nbd2 a6 9.h3 Ba7 10.Bh4 Kh8 11.g4 Ne7 12.Bxf6 gxf6 13.Nh4 Ng6 14.Ng2 c6 15.Qf3 d5 16.Nf1 a5 17.Ng3 Bc5 18.a4 Be7 19.Ba2 Ra6 20.Nh5 Rb6 21.Qe2 Qd6 22.O-O Rd8 23.Rfd1 d4 24.Rd2 Qc5 25.Rc2 Qd6 26.Ne1 Rg8 27.Nf3 Qd7 28.Kh1 c5 29.Bxe6 fxe6 30.Nd2 Ra6 31.Nc4 Bd8 32.Rcc1 Rf8 33.f3 Bc7 34.Ra3 Raa8 35.Rb3 Qxa4 36.Rxb7 Qc6 37.Rb3 f5 38.Nd2 Rf7 39.c4 a4 40.Rb5 Ba5 41.Nf1 Bb4 42.Nfg3 fxg4 43.fxg4 Raf8 44.Rf1 Qe8 45.Rxf7 Qxf7 46.g5 Nf4 47.Qf3 Nxh5 48.Qxh5 Qf2 49.Ne2 Qf3+ 50.Qxf3 Rxf3 51.Kg2 Rxd3 52.Ng3 Kg7 53.Rb6 Be1 54.Nf1 Kf7 55.Nh2 Rd2+ 56.Kh1 Re2 57.Ng4 Rxe4 58.Nf6 Re2 59.Nxh7</p></td></tr><tr><td>22</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Bc5 4.c3 Nf6 5.d3 d6 6.Bb3 O-O 7.Nbd2 Re8 8.h3 Be6 9.O-O d5 10.Ng5 h6 11.Nxe6 Rxe6 12.exd5 Nxd5 13.Ne4 Bf8 14.Qf3 Re8 15.Bxd5 Qd7 16.Bxh6 Re7 17.Be3 Rd8 18.Bb3 Qxd3 19.Rad1 Qa6 20.Ng5 Rdd7 21.Qh5</p></td></tr><tr><td>23</td><td><p>2000.04.02</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2769</p></td><td><p>1.e4 e6 2.d4 d5 3.Nc3 dxe4 4.Nxe4 Nd7 5.Nf3 Ngf6 6.Bd3 Nxe4 7.Bxe4 Nf6 8.Bg5 Qd6 9.Bd3 Qb4+ 10.Bd2 Qxb2 11.O-O Qa3 12.Ne5 Qd6 13.Be3 Be7 14.c4 c5 15.Bc2 O-O 16.Qd3 g6 17.Rad1 Qc7 18.Qc3 b6 19.dxc5 bxc5 20.Bh6 Rd8 21.Rxd8+ Bxd8 22.Rd1 Bb7 23.Ng4 Ne8 24.Ba4 Bc6 25.Bxc6 Qxc6 26.h3 Be7 27.Ne5 Qe4 28.Re1 Qb7 29.Ng4 Rd8 30.Bf4 Bf8 31.Bh6 Rd4 32.Be3 Rd8 33.Nh6+ Bxh6 34.Bxh6 Qb4 35.Qc1 Nf6 36.Rd1 Rxd1+ 37.Qxd1</p></td></tr><tr><td>24</td><td><p>2000.06.19</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Bc5 4.c3 Nf6 5.d3 d6 6.Bb3 h6 7.Nbd2 Bd7 8.h3 Qe7 9.Nf1 Bb6 10.Ne3 a6 11.a4 g5 12.Ba2 Nd8 13.Nf5 Bxf5 14.exf5 Qd7 15.g4 Nc6 16.b4 e4 17.Nd2 exd3 18.Nc4 Ne5 19.O-O O-O-O 20.Nxb6+ cxb6 21.b5 a5 22.f3 Rhe8 23.Bb1 Qc7</p></td></tr><tr><td>25</td><td><p>2000.06.19</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 c5 2.Nf3 d6 3.c3 Nf6 4.Be2 Nc6 5.d4 Qa5 6.d5 Nb8 7.Nbd2 b5 8.a4 a6 9.O-O Bg4 10.b4 cxb4 11.cxb4 Qxb4 12.axb5 Bxf3 13.Nxf3 Qxe4 14.bxa6 Qxd5 15.Qa4+ Nbd7 16.Bg5 Ne4 17.Bb5 Nc5 18.Bxd7+ Nxd7 19.Rfb1 f6 20.Be3 e5 21.Rb7 Qe6 22.Qc6</p></td></tr><tr><td>26</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 dxc4 3.e3 Nf6 4.Bxc4 Bf5 5.Nc3 e6 6.Nf3 Nc6 7.O-O Bd6 8.Qe2 O-O 9.e4 Bg4 10.Rd1 Bb4 11.e5 Nd7 12.Be3 Ne7 13.h3 Bh5 14.Ne4 Nf5 15.Bg5 Be7 16.g4 Bg6 17.gxf5 Bxf5 18.Bxe7 Qxe7 19.Kh2 Bxe4 20.Qxe4 c6 21.Rg1 g6 22.Rg3 Rad8 23.h4 h5 24.Rxg6+ fxg6 25.Qxg6+ Kh8 26.Bd3 Rg8 27.Qxh5+ Qh7 28.Qxh7#</p></td></tr><tr><td>27</td><td><p>2000.06.19</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 d5 2.exd5 Qxd5 3.Nc3 Qa5 4.d4 c6 5.Bd2 Nf6 6.Bd3 Qc7 7.Nge2 Bg4 8.h3 Bxe2 9.Qxe2 e6 10.f4 Bb4 11.f5 Qg3+ 12.Kd1 O-O 13.fxe6 fxe6 14.Ne4 Nxe4 15.Qxe4 Bxd2 16.Qxh7+ Kf7 17.Kxd2 Qg5+ 18.Kc3 Nd7 19.Rhf1+ Nf6 20.b3 c5 21.Qe4 cxd4+ 22.Kb2 Qd5 23.Qg6+ Kg8 24.g4 Qc5 25.Rae1 e5 26.g5 Qc3+ 27.Kb1 e4 28.Bc4+ Kh8 29.gxf6 Rxf6 30.Qxe4 Rh6 31.Bd3 Qc6 32.Qxd4 Rxh3 33.Rg1 Qc7 34.Rh1 Rh2 35.Rxh2+ Qxh2 36.Qe4</p></td></tr><tr><td>28</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 f5 2.Bg5 g6 3.Nd2 Bg7 4.e4 fxe4 5.Nxe4 Nf6 6.Nxf6+ exf6 7.Be3 O-O 8.h4 h6 9.Qd2 Kh7 10.Bd3 f5 11.Nf3 Nc6 12.O-O-O d5 13.c3 Be6 14.h5 g5 15.Rde1 Bg8 16.g4 Ne7 17.Nxg5+ hxg5 18.Bxg5 Bf6 19.Bxf6 Rxf6 20.g5 Re6 21.Rxe6 Bxe6 22.g6+ Kg7 23.Re1 Qd6 24.Qe3 Kf6 25.f4 Ng8 26.c4 c6 27.c5 Qd7 28.Qe5+ Ke7 29.Qg7+ Kd8 30.Qf8+ Kc7 31.Qxa8</p></td></tr><tr><td>29</td><td><p>2000.04.01</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2659</p></td><td><p>1.e4 e6 2.d4 d5 3.Nc3 Nf6 4.Bg5 Bb4 5.e5 h6 6.Be3 Ne4 7.Qg4 Kf8 8.a3 Bxc3+ 9.bxc3 c5 10.Bd3 h5 11.Qf4 Qa5 12.Ne2 Nxc3 13.O-O Nxe2+ 14.Bxe2 Nc6 15.c4 cxd4 16.Bxd4 Nxd4 17.Qxd4 Bd7 18.cxd5 exd5 19.Bf3 Bc6</p></td></tr><tr><td>30</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Nf6 4.d3 Be7 5.O-O O-O 6.Re1 d6 7.a4 Be6 8.Nbd2 Qd7 9.a5 b6 10.a6 Bxc4 11.dxc4 Nb4 12.Nf1 Qc8 13.Ng3 Nxa6 14.Nf5 Bd8 15.N3h4 Nc5 16.Ra3 Ncxe4 17.Rxe4 Nxe4 18.Qg4 g6 19.Qxe4 Kh8 20.Rh3 a5 21.Ne3 f5 22.Qf3 Bxh4 23.Rxh4 c6 24.Qg3 Qe6 25.f4 Rfe8 26.Bd2 a4 27.Nf1 Kg8 28.Qc3 Qe7 29.Rh3 Qc7 30.Rd3 e4 31.Rd4 Re6</p></td></tr><tr><td>31</td><td><p>2000.06.19</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 c6 2.c4 d5 3.Nf3 Nf6 4.e3 e6 5.Nbd2 Nbd7 6.Bd3 Be7 7.O-O b6 8.e4 dxe4 9.Nxe4 Nxe4 10.Bxe4 Bb7 11.Qe2 Nf6 12.Bc2 O-O 13.b3 Qc7 14.Bb2 Rfd8 15.Rfe1 Rac8 16.Rad1 Nd7 17.Bb1 Bf6 18.h4 c5 19.Ng5 Nf8 20.dxc5 Rxd1 21.Rxd1 Bxb2 22.Qxb2 bxc5 23.Qd2 Qe5 24.Qe3 Qxe3 25.fxe3 f6 26.Ne4 Bxe4 27.Bxe4 Kf7 28.Rd6 Ke7 29.Ra6</p></td></tr><tr><td>32</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 Nf6 2.Bg5 Ne4 3.Bf4 c5 4.f3 Nf6 5.dxc5 Qa5+ 6.Nc3 Qxc5 7.e4 Nc6 8.Qd2 d6 9.O-O-O Qb6 10.Be3 Qd8 11.g4 g6 12.h4 Bg7 13.h5 O-O 14.Bh6 Ne5 15.Be2 Qa5 16.Kb1 Bd7 17.Nd5 Qxd2 18.Nxe7+ Kh8 19.Bxd2 Rfe8 20.h6 Bf8 21.Nd5 Nxd5 22.exd5 f5 23.g5 Rac8 24.b3 Be7 25.f4 Nf7 26.Bd3 Bd8 27.Nf3 Bb6 28.Rhe1 a6 29.c4 Ba7 30.a4 Rb8 31.Rxe8+ Rxe8 32.Re1 Rxe1+ 33.Nxe1 Kg8 34.Nc2 Kf8 35.Be3 Bc5 36.a5 Ke8 37.b4 Bxe3 38.Nxe3 Kd8 39.Kb2 Kc7 40.Kc3 Bc8 41.Kd4 Bd7 42.c5 Be8 43.c6 b5 44.Nd1 Nd8 45.Nc3 Bxc6 46.dxc6 Nxc6+ 47.Ke3 Ne7 48.Bc2 Kc6 49.Bb3 Kd7 50.Nd5 Nc6 51.Nf6+ Ke7 52.Nxh7 Nxb4 53.Nf6 Kf8 54.Nd7+ Ke7 55.h7 Kxd7 56.h8=Q Kc6 57.Qc8#</p></td></tr><tr><td>33</td><td><p>2000.06.19</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2332</p></td><td><p>1.c4 g6 2.g3 Bg7 3.Bg2 c5 4.Nc3 Nc6 5.a3 e5 6.b4 d6 7.Rb1 Nge7 8.d3 O-O 9.e3 f5 10.Nge2 g5 11.b5 Nb8 12.f4 gxf4 13.exf4 Nd7 14.O-O Nf6 15.Kh1 Kh8 16.Be3 Qc7 17.a4 Rb8 18.a5 b6 19.a6 Be6 20.Qc2 Rbd8 21.Rbe1 Qd7 22.Bc1 e4 23.dxe4 Bxc4 24.Bb2 d5 25.exd5 Nexd5 26.Nxd5 Bxd5 27.Nc3 Bxg2+ 28.Qxg2 Rfe8 29.h3 Qd3 30.Rxe8+ Rxe8 31.Rd1 Qc4 32.Kh2 Kg8 33.Rd2 h5 34.Qf3 Re1 35.Rg2 Ne4 36.Nxe4 Qxe4 37.Qxe4 fxe4 38.Bxg7 Kxg7 39.g4 h4 40.Rc2 Rf1 41.f5 Kf6 42.Kg2 Rf3 43.Rd2 Rg3+ 44.Kf1 Rd3 45.Rxd3 exd3</p></td></tr><tr><td>34</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d6 2.Nf3 Nf6 3.g3 Nbd7 4.Bg2 e5 5.c4 Be7 6.Nc3 O-O 7.O-O c6 8.e4 Re8 9.Re1 a5 10.b3 Bf8 11.Rb1 g6 12.d5 Nc5 13.Qc2 cxd5 14.cxd5 Bd7 15.a4 Rc8 16.Qd1 h6 17.Ba3 Rc7 18.Rc1 Qc8 19.Bf1 h5 20.Nb5 Bxb5 21.Bxb5 Rd8 22.Rc4 Nfd7 23.Bc1 Nb6 24.Rc3 Qg4 25.Kg2 Be7 26.h3 Qc8 27.Nd2 Na6 28.Rxc7 Qxc7 29.Nc4 Nc5 30.Nxb6 Qxb6 31.Be3 Qc7 32.Qc2 Rc8 33.Rc1 Qd8 34.h4 Kg7 35.Qc4 Bxh4 36.gxh4 Qxh4 37.f3 f5 38.exf5 Qf6 39.Bd7 Rc7 40.Bb5 gxf5 41.Kf1 f4 42.Bf2 Qf5 43.Ke2 Na6 44.Qxc7+ Nxc7 45.Rxc7+ Kg6 46.Bd3 e4 47.Bxe4</p></td></tr><tr><td>35</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 e6 3.Nc3 Bb4 4.e3 Nf6 5.a3 Bxc3+ 6.bxc3 Ne4 7.Qc2 Nd7 8.Bd3 Nef6 9.cxd5 exd5 10.Ne2 c5 11.Qb1 O-O 12.O-O Re8 13.f3 Qb6 14.Qa2 c4 15.Bc2 Qe6 16.Ng3 Nf8 17.e4 Ng6 18.e5 Nd7 19.f4 Qc6 20.f5 Ngf8 21.Bf4 Nb6 22.Rae1 h6 23.Nh5 Bd7 24.Re3 g5 25.fxg6 fxg6 26.Nf6+ Kg7 27.Rg3 Re6 28.Qb1 Be8 29.Nh5+ Kh7 30.Qc1 Nc8 31.Bxh6 Nd7 32.Qg5 Ne7 33.Nf6+ Nxf6 34.exf6 Re2 35.f7 Bd7 36.Qh4 Nf5 37.Bxf5</p></td></tr><tr><td>36</td><td><p>2000.03.07</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2656</p></td><td><p>1.e4 e6 2.d4 d5 3.Nc3 Bb4 4.e5 c5 5.a3 Ba5 6.Bd2 Nc6 7.Qg4 Kf8 8.dxc5 Nxe5 9.Qg3 Ng6 10.O-O-O Nf6 11.f3 Bd7 12.Nge2 Bc7 13.Qf2 b6 14.Be3 Ne7 15.g4 bxc5 16.Bxc5 Bb6 17.h4 Bxc5 18.Qxc5 Qb6 19.Qxb6 axb6 20.Bh3 Ne8 21.f4 h5 22.g5 g6 23.Nd4 Kg7 24.Nf3 Nc7 25.Ne5 Rhd8 26.Ne2 Nc6 27.Nd4 Nxd4 28.Rxd4 Be8 29.Rhd1 Rdc8 30.Bf1 Kf8 31.Rb4 b5 32.Rbd4 Na6 33.Bd3 Nc5 34.Kd2 Nb7 35.Ra1 Ra7 36.Re1 Nd6 37.c3 Nc4+ 38.Kc1 Na5 39.Bc2 Nc6 40.Nxc6 Bxc6 41.Kd2 Bd7 42.Rb4 Rca8 43.Bd3 Ra5 44.Re3 Bc6 45.Rd4 Bd7 46.Rb4 Bc6 47.Bc2 Bd7 48.Bb3 Bc6 49.Rd4 R5a7 50.Bc2 Bd7 51.Bd1 Bc6 52.Bf3 Ra4 53.Bd1 R4a7 54.Bb3 Ra5 55.Re5 Rd8</p></td></tr><tr><td>37</td><td><p>2000.04.01</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2544</p></td><td><p>1.e4 c5 2.Nf3 Nc6 3.Bb5 d6 4.c3 Nf6 5.Qe2 e5 6.d4 exd4 7.cxd4 a6 8.e5 Nd5 9.exd6+ Be6 10.Bxc6+ bxc6 11.dxc5 Qa5+ 12.Bd2 Qxc5 13.O-O Kd7 14.Na3 Bxd6 15.Rab1 Bf5 16.Rbc1 Rhe8 17.Qd1 Qa7 18.Nc4 Bc7 19.Bc3 f6 20.Nd4 Be6 21.Nxc6 Kxc6 22.Bd4 Qb8 23.Qa4+</p></td></tr><tr><td>38</td><td><p>2000.03.04</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>2725</p></td><td><p>1.d4 Nf6 2.Nf3 g6 3.c4 Bg7 4.Nc3 d5 5.Qb3 dxc4 6.Qxc4 O-O 7.e4 a6 8.Be2 b5 9.Qb3 c5 10.dxc5 Bb7 11.O-O Nxe4 12.Nxe4 Bxe4 13.Bg5 Nc6 14.Qe3 Qd5 15.Rad1 Qe6 16.Bh6 Bf5 17.Bxg7 Qxe3 18.fxe3 Kxg7 19.a3 Rfd8 20.b4 Bc2 21.Rxd8 Rxd8 22.Rc1 Be4 23.Kf2 Kf6 24.g4 h6 25.h4 Ke6 26.Rd1 Bxf3 27.Rxd8 Bxe2 28.Rc8 Kd7 29.Rxc6 Kxc6 30.Kxe2 f6 31.Kd3 e6 32.Kd4 g5 33.h5 Kd7 34.e4 Kc6 35.e5 f5 36.gxf5 exf5 37.e6 f4 38.Ke4 Kc7</p></td></tr><tr><td>39</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 dxc4 3.Nf3 Nf6 4.Nc3 Bg4 5.Ne5 Bh5 6.f3 e6 7.e4 c6 8.Nxc4 Bb4 9.Be2 Bxc3+ 10.bxc3 O-O 11.O-O Re8 12.Bf4 Qe7 13.Bd6 Qd7 14.Ba3 Qc7 15.Qd2 Nbd7 16.e5 Nd5 17.Nd6 Red8 18.c4 N5b6 19.h4 Nc8 20.g4 Bg6 21.h5 Bxh5 22.gxh5 Nxd6 23.Bxd6 Qc8 24.Qg5 Nb6 25.h6 g6 26.Qf6 Rxd6 27.Qg7#</p></td></tr><tr><td>40</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 c5 2.Nf3 Nc6 3.Bb5 g6 4.Bxc6 dxc6 5.d3 Bg7 6.h3 Nf6 7.Nc3 O-O 8.Be3 b6 9.Qd2 e5 10.Bh6 Qd6 11.g4 Be6 12.O-O-O Rad8 13.Bxg7 Kxg7 14.Kb1 Rfe8 15.Qg5 Qc7 16.Rdg1 Qe7 17.Qe3 Qd6 18.Ne2 c4 19.dxc4 Bxc4 20.Ng3 Ba6 21.Nh4 Bc8 22.g5 Ng8 23.Ng2 Qd2 24.h4 Qxe3 25.Nxe3 Be6 26.h5 Ne7 27.Ne2 Nc8 28.Kc1 Nd6 29.f3 Nc4 30.Nxc4 Bxc4 31.Nc3 Rd7 32.b3 Ba6 33.Rh2 Red8 34.Nd1 f6 35.gxf6+ Kxf6 36.hxg6 hxg6 37.Ne3 Bb7 38.Rhg2 Rg7 39.Ng4+ Ke6 40.Nf2 Ba6 41.Rxg6+ Rxg6 42.Rxg6+ Kd7 43.Ng4 Re8</p></td></tr><tr><td>41</td><td><p>2000.02.28</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2751</p></td><td><p>1.e4 e5 2.Nf3 Nf6 3.Nxe5 d6 4.Nf3 Nxe4 5.d4 d5 6.Bd3 Bd6 7.O-O O-O 8.c4 c6 9.cxd5 cxd5 10.Nc3 Nxc3 11.bxc3 Bg4 12.Rb1 Nd7 13.h3 Bh5 14.Rb5 Nb6 15.c4 Bxf3 16.Qxf3 dxc4 17.Bc2 Qd7 18.a4 g6 19.Bd2 c3 20.Bxc3 Rac8 21.Be4 Rc4 22.Rbb1 Rxa4 23.Bxb7 Ra3 24.Rfc1 Qc7 25.Ra1 Rb8 26.Be4 Rb3 27.Bd2 Bh2+ 28.Kh1 Rxf3 29.Rxc7 Rxf2 30.Kxh2 Rxd2 31.Raxa7 Nc8 32.Rab7 Rxb7 33.Rxc8+ Kg7 34.Bxb7 Rxd4 35.g4 h5 36.g5 h4 37.Rc7 Rf4 38.Bc8 Rf2+ 39.Kg1 Rf4 40.Kg2 Kf8 41.Bg4 Kg7 42.Rc5 Kf8 43.Bf3 Kg7 44.Kf2 Ra4 45.Ke3 Ra3+ 46.Kf4 Ra4+ 47.Ke5 Ra3 48.Bd5 Re3+ 49.Kf4 Rd3 50.Bc4 Rd7 51.Rc6 Re7 52.Rf6</p></td></tr><tr><td>42</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 Nf6 2.Bg5 g6 3.Bxf6 exf6 4.e3 Bg7 5.h4 d6 6.h5 f5 7.Ne2 O-O 8.Nd2 Nd7 9.Nf4 Nf6 10.g3 Re8 11.Bg2 Ne4 12.c3 Nxd2 13.Qxd2 c5 14.Kf1 Rb8 15.Bd5 Be6 16.hxg6 hxg6 17.Rd1 Bxd5 18.Nxd5 Rc8 19.dxc5 dxc5 20.c4 Re4 21.b3 Qg5 22.Kg2 Bf6 23.f4 Bc3 24.Qxc3</p></td></tr><tr><td>43</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 e6 3.Nc3 Nf6 4.cxd5 Nxd5 5.e4 Nf6 6.Nf3 h6 7.Bd3 Nc6 8.O-O Bd7 9.Re1 Bb4 10.a3 Ba5 11.Bc2 O-O 12.e5 Nd5 13.Nxd5 exd5 14.b4 Bb6 15.Qd3 g6 16.Bxh6 Re8 17.Bg5 Bf5 18.Qd2 Qd7 19.Bf6 Kh7 20.Qg5 Bg4 21.Qh4+ Bh5 22.Qxh5+</p></td></tr><tr><td>44</td><td><p>2000.01.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2748</p></td><td><p>1.d4 d5 2.c4 c6 3.Nc3 Nf6 4.Nf3 dxc4 5.a4 Bf5 6.Ne5 Nbd7 7.Nxc4 Qc7 8.g3 e5 9.dxe5 Nxe5 10.Bf4 Nfd7 11.Bg2 g5 12.Ne3 gxf4 13.Nxf5 O-O-O 14.Qc2 Ng4 15.a5 fxg3 16.hxg3 a6 17.Ra4 Ndf6 18.Ne4 Nxe4 19.Bxe4 h5 20.Kf1 Kb8 21.Kg2 Be7 22.Nxe7 Qxe7 23.Bf3 Ne5 24.Bxh5 Qe6 25.Qc3 f6 26.Rah4 Qf5 27.Bf3 Rxh4 28.Rxh4 Qb1 29.Rh1 Rd1 30.Rxd1 Qxd1 31.b4 Kc7 32.Qc5 Qd6 33.Qxd6+ Kxd6 34.Be4 Nc4 35.Bd3 Nb2 36.f4 Nd1 37.g4 Ne3+ 38.Kf3 Nd5 39.Ke4 Nxb4 40.Bc4 c5 41.g5 fxg5 42.fxg5 Ke7 43.Kf5 Nc2 44.Ke5 Ne3 45.Be6 c4</p></td></tr><tr><td>45</td><td><p>2000.03.14</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 d5 2.exd5 Qxd5 3.Nc3 Qa5 4.d4 c6 5.Bd2 Qc7 6.Bd3 Nf6 7.Nge2 Bg4 8.h3 Bh5 9.f4 e6 10.g4 Bg6 11.f5 exf5 12.gxf5 Bh5 13.Bg5 Nbd7 14.Qd2 O-O-O 15.O-O-O Re8 16.Rdf1 Bxe2 17.Nxe2 Bd6 18.Nc3 Qb6 19.Qf2 h6 20.Bd2 Qc7 21.Rhg1 Rhg8 22.a3 Nb6 23.Qf3 Nbd5 24.Nd1 Bh2 25.Rg2 Bd6 26.c4 Ne7 27.c5 Bxc5 28.dxc5</p></td></tr><tr><td>46</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 Nf6 2.Bg5 Ne4 3.Bf4 e6 4.f3 Nf6 5.e4 d5 6.e5 Nfd7 7.Be3 c5 8.c3 Nc6 9.f4 Qb6 10.Qd2 Be7 11.Nf3 O-O 12.Be2 cxd4 13.cxd4 Na5 14.b3 Nb8 15.Nc3 Bd7 16.O-O Na6 17.f5 Rac8 18.f6 Bb4 19.Rac1 Qc7 20.Bf2 h6 21.Qf4 Qd8 22.Qg3 g6 23.Qf4 Re8 24.Qxh6 Bf8 25.Qh4 Bg7 26.Ng5</p></td></tr><tr><td>47</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2066</p></td><td><p>1.d4 d5 2.c4 c6 3.Nc3 Nf6 4.cxd5 cxd5 5.Bf4 Nc6 6.e3 a6 7.Nf3 Bg4 8.h3 Bh5 9.g4 Bg6 10.Ne5 e6 11.h4 h6 12.Nxg6 fxg6 13.Bd3 Ne7 14.Qf3 Rc8 15.Be5 Qb6 16.Rb1 Nd7 17.Bg3 h5 18.gxh5 gxh5 19.O-O Nf6 20.Na4 Qa7 21.Nc5 Rc6 22.b4 b5 23.a4 Qb6 24.axb5 axb5 25.Ra1 Kf7 26.Ra5 Rc8 27.Rxb5 Qd8 28.e4 dxe4 29.Nxe4 Rh6 30.Bc4 Rh8 31.Ng5+</p></td></tr><tr><td>48</td><td><p>2000.03.14</p></td><td><p>1/2-1/2</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Bc5 4.c3 Nf6 5.d3 d6 6.Bb3 Bb6 7.Nbd2 a6 8.h3 Ne7 9.Nf1 Ng6 10.Ng3 c6 11.d4 exd4 12.cxd4 O-O 13.O-O d5 14.e5 Ne4 15.Bc2 Nxg3 16.fxg3 c5 17.Be3 cxd4 18.Bxd4 Be6 19.Kh2 Rc8 20.Bb3 Ne7 21.Qd2 Bxd4 22.Nxd4 Nc6 23.Rae1 Qb6 24.Rf4 Rfe8 25.Nf3 Rc7 26.Rh4 Ne7 27.Bc2 Bf5 28.Bb3 Be6 29.Bc2 Bf5 30.Bb3 Be6 31.Bc2 Bf5</p></td></tr><tr><td>49</td><td><p>1999.11.20</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>None</p></td><td><p>1.d4 d5 2.c4 c6 3.Nc3 Nf6 4.e3 g6 5.Nf3 Nbd7 6.Be2 Bg7 7.O-O O-O 8.b4 a6 9.a4 e6 10.Ba3 Re8 11.Qb3 Rb8 12.b5 Bf8 13.Bxf8 Rxf8 14.cxd5 Nxd5 15.Rfc1 Nxc3 16.Qxc3 axb5 17.axb5 cxb5 18.Bxb5 Qe7 19.Qc7 Qd8 20.Qf4 Qf6 21.Qd6 Qd8 22.h4 Re8 23.Rxc8 Rxc8 24.Qxd7 Qb6 25.Ne5 Rf8 26.Bf1 Rb8 27.Qe7 Qb2 28.Ra5 Rbe8 29.Qf6 Rd8 30.h5 Qc3 31.h6</p></td></tr><tr><td>50</td><td><p>2000.05.21</p></td><td><p>1-0</p></td><td><p>2851</p></td><td><p>2637</p></td><td><p>1.e4 e5 2.Nf3 Nf6 3.Nxe5 d6 4.Nf3 Nxe4 5.d4 d5 6.Bd3 Be7 7.O-O Nc6 8.c4 Nb4 9.Be2 O-O 10.Nc3 Bf5 11.a3 Nxc3 12.bxc3 Nc6 13.Re1 Bf6 14.Bf4 Ne7 15.Qb3 b6 16.cxd5 Nxd5 17.Be5 Bg4 18.Rad1 Be7 19.h3 Bh5 20.g4 Bg6 21.Bg3 Nf6 22.Ne5 Ne4 23.Bf3 Nxg3 24.Nc6 Qd6 25.Nxe7+ Kh8 26.Bxa8</p></td></tr></tbody></table></div></div>
<p>After scripting out downloading and some more cleaning to remove games without moves or games with unexpected formatting, I had nice, simple PGN strings to work with. The next day, the original dataset I was building on top of vanished from Kaggle. Luckily, I still had it cached locally and could publish my cleaned <a href="https://huggingface.co/datasets/InterwebAlchemy/pgn-dataset">PGN dataset</a> to Hugging Face.</p>
<p>Here&#39;s a sample of the dataset:</p>
<div><h4>Sample of My Cleaned PGN Dataset</h4><div><table><thead><tr><th></th><th>PGN</th></tr></thead><tbody><tr><td>1</td><td><p>1.d4 Nf6 2.c4 e6 3.Nf3 b6 4.g3 Ba6 5.b3 Bb4+ 6.Bd2 Be7 7.Bg2 c6 8.Bc3 d5 9.Nbd2</p></td></tr><tr><td>2</td><td><p>1.e4 c6 2.d4 d5 3.e5 Qb6 4.Nf3 Bg4 5.Be2 Bxf3 6.Bxf3 e6</p></td></tr><tr><td>3</td><td><p>1.d4 d5 2.Nf3 e6 3.c4 c6 4.Nc3 f5 5.g3</p></td></tr><tr><td>4</td><td><p>1.d4 e6 2.c4 f5 3.Nf3 Nf6 4.Nc3 Bb4 5.g3 b6 6.Bd2 Bb7 7.Bg2 O-O 8.d5 Bxc3 9.Bxc3 exd5</p></td></tr><tr><td>5</td><td><p>1.e4 c5 2.c3 d5 3.exd5 Qxd5 4.d4 e5 5.Nf3 Nc6 6.Nxe5 Nxe5 7.dxe5 Qxe5+ 8.Qe2 Qxe2+ 9.Bxe2</p></td></tr><tr><td>6</td><td><p>1.e4 e6 2.d4 d5 3.Nc3 Bb4 4.e5 Ne7 5.a3 Bxc3+ 6.bxc3 c5 7.h4 Nbc6 8.h5 h6</p></td></tr><tr><td>7</td><td><p>1.f4 d5 2.Nf3 c6 3.e3 Bg4 4.Be2 Nd7 5.b3 Ngf6 6.Bb2 g6 7.O-O Bg7 8.Ne5 Bxe2 9.Qxe2 O-O 10.d3</p></td></tr><tr><td>8</td><td><p>1.e4 c5 2.Nf3 d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 a6 6.Bg5 e6 7.f4 Nbd7 8.Qf3 Qc7 9.O-O-O b5 10.Bd3 Bb7</p></td></tr><tr><td>9</td><td><p>1.e4 e6 2.Qe2 c5 3.Nf3 Nc6 4.g3 g6 5.h4 h6 6.Bg2 Bg7 7.d3 d6 8.Nbd2</p></td></tr><tr><td>10</td><td><p>1.e4 c6 2.d4 d5 3.Nc3 dxe4 4.Nxe4 Nd7 5.Bf4</p></td></tr><tr><td>11</td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Be7 4.O-O Nf6 5.Re1 O-O</p></td></tr><tr><td>12</td><td><p>1.d4 Nf6 2.Nf3 g6 3.g3 Bg7 4.Bg2 O-O 5.c4 d6 6.O-O c6 7.Nc3 Qa5 8.h3 Qa6 9.b3 b5</p></td></tr><tr><td>13</td><td><p>1.e4 e5 2.Nf3 Nc6 3.Bc4 Nf6 4.Ng5 d5 5.exd5 Nxd5 6.Nxf7 Kxf7 7.Qf3+ Ke8 8.Bxd5 Nb4 9.Qf7#</p></td></tr><tr><td>14</td><td><p>1.e4 e6 2.d4 d5 3.exd5 exd5 4.Bd3 Nc6 5.c3 Bd6 6.Qe2+ Qe7 7.Bg5 Qxe2+ 8.Nxe2 Nge7</p></td></tr><tr><td>15</td><td><p>1.e4 e5 2.Nf3 Nf6 3.Nc3 Nc6 4.Bb5 Bb4 5.d3 d6 6.O-O O-O 7.Bg5 Bxc3 8.bxc3</p></td></tr><tr><td>16</td><td><p>1.d4 d5 2.c4 c6 3.Nf3 Nf6 4.cxd5 cxd5 5.Nc3 Nc6 6.e3 e6 7.Bd2 Be7 8.Be2 O-O 9.O-O a6 10.a3 Bd7</p></td></tr><tr><td>17</td><td><p>1.c4 c6 2.d4 d5 3.Nf3 Nf6 4.Nc3 e6 5.e3 Nbd7 6.Bd3 Bd6 7.O-O O-O 8.b3 Qe7 9.Bb2</p></td></tr><tr><td>18</td><td><p>1.e4 e6 2.d4 d5 3.Nc3 Bb4 4.exd5 exd5 5.Qf3 Ne7 6.a3</p></td></tr><tr><td>19</td><td><p>1.d4 d5 2.Nf3 Nf6 3.e3 c6 4.Be2 e6 5.Nbd2 Bd6 6.O-O Nbd7 7.c4 O-O 8.Re1 e5 9.dxe5 Nxe5 10.a3 Bf5</p></td></tr><tr><td>20</td><td><p>1.e4 c5 2.Nf3 d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 a6 6.Bc4 e6 7.Bb3 b5 8.O-O Be7</p></td></tr><tr><td>21</td><td><p>1.d4 Nf6 2.Nf3 g6 3.g3 Bg7 4.Bg2 O-O 5.O-O d6 6.c4 Nc6 7.Nc3 Bf5 8.d5 Na5 9.Nd4 Bd7 10.b3 c5</p></td></tr><tr><td>22</td><td><p>1.e4 c5 2.Nc3 d6 3.Nf3 e5 4.Bc4 Be7 5.d3 Nc6 6.Nd5 Nf6 7.c3 O-O 8.O-O</p></td></tr><tr><td>23</td><td><p>1.Nf3 Nf6 2.b3 g6 3.Bb2 Bg7 4.c4 O-O 5.e3 d6</p></td></tr><tr><td>24</td><td><p>1.d4 d5 2.c4 c6 3.Nf3 Nf6 4.Nc3 g6 5.e3 Bg7 6.Qb3 O-O 7.Bd2 e6 8.Be2 Nbd7 9.O-O Ne4</p></td></tr><tr><td>25</td><td><p>1.d4 d5 2.c4 c6 3.Nc3 Nf6 4.e3 a6 5.Nf3</p></td></tr><tr><td>26</td><td><p>1.c4 Nf6 2.Nc3 g6 3.Nf3 Bg7 4.g3 O-O 5.Bg2 d6 6.O-O Nc6 7.Rb1 e5 8.d3 Re8 9.b4</p></td></tr><tr><td>27</td><td><p>1.e4 c5 2.Nf3 Nc6 3.Nc3 Nf6 4.d3 d6 5.h3 h6 6.g3 g6 7.Bg2 Bg7 8.O-O O-O 9.Kh2 Kh7 10.Be3 e5 11.Nd2</p></td></tr><tr><td>28</td><td><p>1.e4 e5 2.f4 d5 3.exd5 c6 4.Nc3 exf4 5.Nf3 Nf6 6.d4 Bd6 7.Bc4 cxd5 8.Bxd5 O-O 9.O-O Nc6 10.Bb3 Bg4</p></td></tr><tr><td>29</td><td><p>1.e4 c5 2.Nf3 Nc6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 a6 6.Be2 Qb6 7.Nb3 e6 8.Be3 Qa5 9.Nxa5</p></td></tr><tr><td>30</td><td><p>1.e4 e6 2.d4 d5 3.Nd2 dxe4 4.Nxe4 Be7 5.Nf3 Nf6 6.Nxf6+ Bxf6 7.Bd3 Nd7 8.O-O O-O 9.c3</p></td></tr><tr><td>31</td><td><p>1.d4 Nf6 2.c4 d6 3.Nc3 g6 4.e4 Bg7 5.Be2 e5 6.d5 Na6 7.Be3</p></td></tr><tr><td>32</td><td><p>1.d4 d5 2.Bg5 Nf6 3.Bxf6 gxf6 4.e3 c5 5.c3 e5 6.g3 Nc6 7.Bg2 Qb6 8.Qb3 cxd4 9.exd4 Be6</p></td></tr><tr><td>33</td><td><p>1.c4 Nf6 2.Nc3 c6 3.Nf3 d5 4.cxd5 cxd5 5.d4 Nc6 6.Bf4 e6 7.e3 Bd6 8.Bxd6 Qxd6 9.Bd3 O-O 10.O-O Bd7</p></td></tr><tr><td>34</td><td><p>1.g4 d5 2.Bg2 Bxg4 3.c4 c6 4.cxd5 Nf6 5.Nc3 g6 6.Qb3 Qc8 7.d4 Bg7 8.dxc6 bxc6</p></td></tr><tr><td>35</td><td><p>1.e4 e6 2.d4 d5 3.exd5 exd5 4.Bd3 Nf6 5.Nf3 Bd6 6.O-O O-O 7.c3 c6</p></td></tr><tr><td>36</td><td><p>1.e4 e5 2.Nf3 Nf6 3.Nxe5 d6 4.d4 d5 5.Bd3 Nc6 6.O-O Be7</p></td></tr><tr><td>37</td><td><p>1.d4 e6 2.c4 Nf6 3.Nc3 Bb4 4.e3 O-O 5.Bd3 d5 6.Nf3 c5 7.O-O Nc6 8.a3 Bxc3 9.bxc3 dxc4 10.Bxc4</p></td></tr><tr><td>38</td><td><p>1.e4 e6 2.d3 d5 3.Nd2 Nf6 4.Ngf3 Nc6 5.g3 dxe4 6.dxe4 Bc5 7.Bg2 e5 8.O-O</p></td></tr><tr><td>39</td><td><p>1.Nf3 f5 2.g3 Nf6 3.Bg2 g6 4.O-O Bg7 5.d4 O-O 6.b3 d6 7.Bb2 c6 8.Nbd2 Nbd7 9.c4 Qe8 10.Qc2</p></td></tr><tr><td>40</td><td><p>1.c4 e5 2.Nc3 Nf6 3.Nf3 Nc6 4.e3 Bb4 5.Qc2 Bxc3 6.Qxc3 Qe7 7.a3 d5</p></td></tr><tr><td>41</td><td><p>1.c4 e6 2.Nc3 d5 3.d4 Nf6 4.Bg5 Be7 5.e3 O-O 6.Nf3 h6 7.Bh4 b6 8.cxd5 Nxd5 9.Bxe7 Qxe7 10.Bd3</p></td></tr><tr><td>42</td><td><p>1.d4 d5 2.c4 c6 3.cxd5 cxd5 4.Nc3 Nf6 5.Nf3 Nc6 6.Bf4 a6 7.e3 Bf5 8.Bd3 Bxd3 9.Qxd3 e6</p></td></tr><tr><td>43</td><td><p>1.Nf3 Nf6 2.d4 g6 3.e3 Bg7 4.Be2 O-O 5.O-O d5 6.b3 c5 7.Bb2 cxd4 8.exd4 Nc6 9.Nbd2 Bf5</p></td></tr><tr><td>44</td><td><p>1.e4 c5 2.Nf3 e6 3.Nc3 d6 4.g3 Nf6 5.d3 Nc6 6.Bg2 Be7</p></td></tr><tr><td>45</td><td><p>1.e4 g6 2.d4 Bg7 3.Nc3 c6 4.Nf3 d5 5.h3 Nf6 6.Bd3 dxe4</p></td></tr><tr><td>46</td><td><p>1.d4 Nf6 2.Nf3 e6 3.c4 Bb4+ 4.Bd2 Qe7 5.e3 O-O 6.Bxb4 Qxb4+ 7.Qd2 Qxd2+ 8.Nbxd2 d6 9.Be2 Nbd7 10.O-O</p></td></tr><tr><td>47</td><td><p>1.e4 c5 2.Nf3 a6 3.c3 Nc6 4.d4 cxd4 5.cxd4 d6 6.Nc3 g6 7.Be3 Bg7 8.h3 e6 9.Qd2 Nge7 10.Be2 h6 11.d5</p></td></tr><tr><td>48</td><td><p>1.g3 g6 2.Bg2 Bg7 3.Nf3 c5 4.O-O Nc6 5.c4 d6</p></td></tr><tr><td>49</td><td><p>1.Nf3 Nf6 2.d4 d5 3.b4 Bf5 4.e3 e6 5.c3 Bd6 6.a4 c6 7.Be2 h6 8.Qb3 Nbd7 9.Ba3 O-O 10.b5 c5</p></td></tr><tr><td>50</td><td><p>1.d4 g6 2.Nf3 Bg7 3.c3 Nf6 4.Bg5 d6 5.Nbd2 Nbd7 6.e3 e5 7.dxe5 dxe5 8.e4 O-O 9.Be2 c6 10.O-O</p></td></tr></tbody></table></div></div>
<p>Just some boring PGN strings without any weird formatting or metadata.</p>
<p>And, here are some statistics about this dataset:</p>
<p><strong>Average Elo:</strong> <span>2240</span></p>
<div><div><p><strong>Total:</strong></p><!-- --><p>3,561,364</p><!-- --><p> games</p></div><div><p>Year Range: </p><!-- --><p>1783</p><!-- --><p> -</p><!-- --> <!-- --><p>2007</p></div></div>
<h2 id="middlegame"><a aria-hidden="true" tabindex="-1" href="#middlegame"><span></span></a>Middlegame</h2>
<p>Much has been written about <a href="https://interwebalchemy.com/posts/building-a-chess-tutor/#generative-chess">which Large Language Models (LLMs) are good at chess</a>, but I wasn&#39;t interested in making the best chess opponent. While <a href="https://en.wikipedia.org/wiki/Solving_chess">chess isn&#39;t solved</a> yet, <a href="https://stockfishchess.org/">Stockfish</a> has basically won as far as computers playing chess goes, and there are more passionate, and more qualified people out there who will make better contributions to the field than I could.</p>
<p>I just wanted to see if a language model could reliably work with PGN strings, learn some new things, and try to understand more about how these tools work under the hood.</p>
<p>As I tested various models, I thought something prevents the models from attaching appropriate semantic meaning to individual moves PGN strings.</p>
<p>Looking at how the tokenizers for popular model architectures break a PGN string down into tokens illustrates how that could be an issue:</p>
<div><div><p><strong>Tokens:</strong></p><!-- --><p>0</p></div></div>
<p>I could be wrong, but it seems like <code>e4</code> is probably a lot more valuable to making decisions about chess than <code>e</code> and <code>4</code> are separatley. I decided to put on my pretend researcher hat and see what would happen if I could tokenize these more semantically.</p>
<p>So, I took all that data that I cleaned, put on <a href="https://karpathy.ai/">Andrej Karpathy</a>&#39;s fantastic <a href="https://youtu.be/zduSFxRajkE">Let&#39;s build the GPT Tokenizer</a> video, and started hacking away at the problem.</p>

<p>It didn&#39;t take long to synthesize the crash course in ML that Karpathy was giving, and after testing the tokenizer on a few samples of the larger dataset, I was ready to train it on the entire corpus of just under 3 million games.</p>
<h2 id="blunders"><a aria-hidden="true" tabindex="-1" href="#blunders"><span></span></a>Blunders</h2>
<p>Emboldened by the tokenizer&#39;s success, I decided it was time to push things a bit further and train a language model.</p>
<p>I started by pulling up another Karpathy video: <a href="https://youtu.be/kCc8FmEb1nY">Let&#39;s build GPT: from scratch, in code, spelled out.</a></p>
<p>Unfortunately, I made many blunders in this part of the process:</p>
<ol>
<li>Hubris because tokenizing is a much simpler process than training a model</li>
<li>Not knowing which model architecture to use - I started with a GPT-2 model based on the Karpathy video, but it was not cooperating with the training process or environment that I was using</li>
<li>Not fully understanding the semantic differences between language and structured data like PGN strings</li>
<li>Jumping straight to training a model without going through the rest of Karpathy&#39;s <a href="https://youtube.com/playlist?list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ&amp;si=tmlJlwStYeFvKZCR">Neural Networks: Zero to Hero</a> series.</li>
<li>Trying to use Large Language Models (LLMs) to jumpstart my understanding of training a model and getting stuck in debugging loops with code that I didn&#39;t fully understand</li>
</ol>
<p>There are probably many more, but these were the big ones that stand out in hindsight.</p>
<p>I hit a wall pretty quickly and ended up setting this project aside to fully immerse myself in my RC batch.</p>
<h2 id="endgame"><a aria-hidden="true" tabindex="-1" href="#endgame"><span></span></a>Endgame</h2>
<p>I recently picked up the model training again, and I&#39;m excited to say that there has been a lot of progress on training a language model that only understands PGN strings.</p>
<p>I&#39;ve switched to the <a href="https://github.com/AnswerDotAI/ModernBERT">ModernBERT</a> architecture as the base and have been carefully integrating help from my Generative AI-powered copilot (Claude 3.7 Sonnet in Cursor) to help me craft small sections of the training code.</p>
<p>It would be simple to have it spit out PGN-like tokens - and that&#39;s what my first iteration did, but I&#39;m trying to see if there&#39;s a way to encode an understanding of the game by only using the tokens. This involves weighting the tokens based on their position in the PGN string and reducing the weight of tokens like the turn number because they are more prevalent in the training data but only valid in specific token positions.</p>
<div></div>
<p>It&#39;s also important to consider the context of the entire game when making each move, so we aren&#39;t just training on a subset of PGN tokens at a time but a progressively longer string of tokens as context for each move in each game of the training set.</p>
<p>In Chess, every previous move influences the future state of the game.</p>
<p>The basic training implementation seeks to:</p>
<ol>
<li>Start with a baseline sample of short games as a warmup with a lower learning rate increasing gradually</li>
<li>Then use a set of medium-length games with a standard learning rate</li>
<li>Then use a set of commonly played openings with a higher learning rate to improve performance at the start of the game - where I assume users of the Chess Tutor will benefit the most</li>
<li>Finish with a set of longer games with a standard learning rate</li>
</ol>
<p>After this pre-training process has been refined, the goal will be to use a chess engine, like <a href="https://stockfishchess.org/">Stockfish</a>, to evaluate the quality of the model&#39;s moves and provide some reinforcement learning to improve the model&#39;s performance.</p>
<h2 id="stalemate"><a aria-hidden="true" tabindex="-1" href="#stalemate"><span></span></a>Stalemate</h2>
<p>I&#39;m still navigating the training process and working out the challenges of disparate environments. Training code that runs on my Macbook M4 Pro doesn&#39;t necessarily work when I&#39;m loading it up on a cloud provider with a small GPU like a T4 - and the various PyTorch or CUDA error messages are only debuggable in the cloud environment, which makes the debugging cycle and resolution time stretch out much longer than it should</p>
<p>This is a work in progress, but I can&#39;t wait to share the model and the results of testing my hypothesis with you soon.</p>
<p>I have another hypothesis that trying to get LLMs to play chess isn&#39;t a valuable use of time or compute, but that&#39;s another post for another day.</p></div></div>
  </body>
</html>
