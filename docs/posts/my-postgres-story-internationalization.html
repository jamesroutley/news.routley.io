<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://obartunov.livejournal.com/211100.html">Original</a>
    <h1>My Postgres Story: Internationalization</h1>
    
    <div id="readability-page-1" class="page"><div> <p>I used Postgres since 1995 ( [PG95] mailing list has less than 400 subscribers !) for my scientific projects and operating with numbers and english strings was smooth, but in 1996 I signed up to make a searchable database of electronic archive of &#34;Uchitelskaya gazeta&#34; ( the popular newspaper for teachers community). It was my moonlight work to help me grow kids. The whole project was sponsored by West foundation, if I recall properly, our office was located in Vetoshny Lane,  near the Read Square, I had a lot of fun working there with smart people. I claimed to be an expert in Postgres and didn&#39;t see any problem with loading the archive and writing several SQL queries :)   First, I quickly found that cyrillic letters transformed to something unreadable.  The problem was that Postgres operated with ASCII  only,  which isn&#39;t surprising given  his roots in English world, so practically it was impossible to use any national encodings  like russians koi8-r, cp-1251, cp-866, etc. That time I already participated in internationalization of perl and search engine glimpse, so I knew that  basically I need to replace  &#39;char&#39;  definiton  to &#39;unsigned char&#39;, add call setlocale(LC_ALL,&#34;&#34;) and use functions from locale api. The reality is getting a bit more complicated than I anticipated, so it took a month to get a working Postgres on Slackware. The second problem I found is that postgres works very slow with text,  it was not only because of locale stuff — strcoll is 10 times slower that strcmp, but since Postgres used full scan — read every row of a table and performs slow text operation.  This problem was addressed by me and Teodor in 2000, when we developed OpenFTS, contrib/intarray (see this <a href="http://www.sai.msu.su/~megera/postgres/fts/doc/fts-history.html" target="_blank" rel="nofollow">historical document</a> for details), which was eventually transforms to built-in full-text search (FTS), which we presented at the PostgreSQL Anniversary Meeting in Toronto, 2006.  </p>
<figure data-figure-type="image" data-image-type="standart">
            <div>
              
                <p><img src="https://ic.pics.livejournal.com/obartunov/24248903/68341/68341_800.png" srcset="https://ic.pics.livejournal.com/obartunov/24248903/68341/68341_800.png 800w, https://ic.pics.livejournal.com/obartunov/24248903/68341/68341_original.png 1348w" sizes="800px" alt="My fist commit  to Postgres, thanks Marc !" title="My fist commit  to Postgres, thanks Marc !" loading="lazy"/></p><figcaption>My fist commit  to Postgres, thanks Marc !</figcaption>
            </div>
          </figure>
<p>For years I didn’t realize the importance of this first patch, only recently I understood that it made  Postgres an <strong>international</strong> open source database. Many developers continue this work, Tatsuo Ishii introduced support of multi-byte encondings, Peter Eisentraut made a lot of improvements to internationalization of Postgres.</p>

<p>I choose to use Postgres over Oracle in 2000, when we developed the Rambler portal (the biggest portal in Russia,  the millions of users) , since I believed that we could do everything having sources and nice support from mailing list. I handle the pressure of Rambler  investor and top management, who wanted Oracle to pass an audit by PWC. Just for reference, we started with Postgres 6.5.2 (no WAL!)  gradually adding GiST framework, contrib/intarray, OpenFTS, tsearch v1. Thanks to Rambler, all these work became eventually part of Postgres !</p>
<figure data-figure-type="image" data-image-type="standart">
            <div>
              
                <p><img src="https://ic.pics.livejournal.com/obartunov/24248903/68453/68453_800.jpg" srcset="https://ic.pics.livejournal.com/obartunov/24248903/68453/68453_800.jpg 800w, https://ic.pics.livejournal.com/obartunov/24248903/68453/68453_2000.jpg 2000w" sizes="800px" alt="Teodor Sigaev and me in the room 38, SAI MSU discussing GiST framework, 2000." title="Teodor Sigaev and me in the room 38, SAI MSU discussing GiST framework, 2000." data-inherit-privacy="true" loading="lazy"/></p><figcaption>Teodor Sigaev and me in the room 38, SAI MSU discussing GiST framework, 2000.</figcaption>
            </div>
          </figure>
</div></div>
  </body>
</html>
