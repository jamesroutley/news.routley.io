<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.koi.security/blog/postmark-mcp-npm-malicious-backdoor-email-theft">Original</a>
    <h1>A Postmark backdoor that’s downloading emails</h1>
    
    <div id="readability-page-1" class="page"><div><div><div id="blog-rich-text"><p>You know MCP servers, right? Those handy tools that let your AI assistant send emails, run database queries, basically handle all the tedious stuff we don&#39;t want to do manually anymore. Well, here&#39;s the thing not enough people talk about: we&#39;re giving these tools god-mode permissions. Tools built by people we&#39;ve never met. People we have zero way to vet. And our AI assistants? We just... trust them. Completely.</p><p>Which brings me to why I&#39;m writing this. <code>postmark-mcp</code> - downloaded <strong>1,500 times every single week</strong>, integrated into hundreds of developer workflows. Since version <code>1.0.16</code>, it&#39;s been quietly copying every email to the developer&#39;s personal server. I&#39;m talking password resets, invoices, internal memos, confidential documents - everything.</p><p>This is the<strong> world’s first sighting of a real world malicious MCP server</strong>. The attack surface for endpoint supply chain attacks is slowly becoming the enterprise’s biggest attack surface.</p><h2>So… What Did Our Risk Engine Detect?</h2><p>Here&#39;s how this whole thing started. Our risk engine at Koi flagged <code>postmark-mcp</code> when version <code>1.0.16</code> introduced some suspicious behavior changes. When our researchers dug into it, like we do to any malware our risk engine flags, what we found was very disturbing.</p><p>On paper, this package looked perfect. The developer? Software engineer from Paris, using his real name, GitHub profile packed with legitimate projects. This wasn&#39;t some shady anonymous account with an anime avatar. This was a real person with a real reputation, someone you&#39;d probably grab coffee with at a conference.</p><p>For 15 versions - FIFTEEN - the tool worked flawlessly. Developers were recommending it to their teams. &#34;Hey, check out this great MCP server for Postmark integration.&#34; It became part of developer’s daily workflows, as trusted as their morning coffee.</p><p>Then version 1.0.16 dropped. Buried on line 231, our risk engine found this gem:</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/68d2dbea5498f5d66a60eaea_carbon%20(11)%20(1).png" loading="lazy" alt=""/></p><figcaption>A simple line that steals thousands of emails</figcaption></figure><p>One single line. And boom - every email now has an unwanted passenger.</p><p>Here&#39;s the thing - there&#39;s a completely legitimate GitHub repo with the same name, officially maintained by Postmark (ActiveCampaign). The attacker took the legitimate code from their repo, added his malicious BCC line, and published it to npm under the same name. Classic impersonation.</p><p>Look, I get it. Life happens. Maybe the developer hit financial troubles. Maybe someone slid into his DMs with an offer he couldn&#39;t refuse. Hell, maybe he just woke up one day and thought &#34;I wonder if I could get away with this.&#34; We&#39;ll never really know what flips that switch in someone&#39;s head - what makes a legitimate developer suddenly decide to backstab 1,500 users who trusted them.</p><p>But that&#39;s exactly the point. We CAN&#39;T know. We can&#39;t predict it. And when it happens? Most of us won&#39;t even notice until it&#39;s way too late. For modern enterprises the problem is even more severe. As security teams focus on traditional threats and compliance frameworks, developers are independently adopting AI tools that operate completely outside established security perimeters. These MCP servers run with the same privileges as the AI assistants themselves - full email access, database connections, API permissions - yet they don&#39;t appear in any asset inventory, skip vendor risk assessments, and bypass every security control from DLP to email gateways. By the time someone realizes their AI assistant has been quietly BCCing emails to an external server for months, the damage is already catastrophic.</p><h2>Lets Talk About the Impact</h2><p>Okay, bear with me while I break down what we&#39;re actually looking at here.</p><p>You install an MCP server because you want your AI to handle emails, right? Seems reasonable. Saves time. Increases productivity. All that good stuff. But what you&#39;re actually doing is handing complete control of your entire email flow to someone you&#39;ve never met. </p><p>We can only guestimate the impact:</p><ul role="list"><li>1,500 downloads every single week</li><li>Being conservative, maybe 20% are actively in use</li><li>That&#39;s about 300 organizations</li><li>Each one probably sending what, 10-50 emails daily?</li><li>We&#39;re talking about 3,000 to 15,000 emails EVERY DAY flowing straight to giftshop.club</li></ul><p>And the truly messed up part? The developer didn&#39;t hack anything. Didn&#39;t exploit a zero-day. Didn&#39;t use some sophisticated attack vector. We literally handed him the keys, said &#34;here, run this code with full permissions,&#34; and let our AI assistants use it hundreds of times a day. We did this to ourselves.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/68d2e7796d400a7fb93e983c_Screenshot%202025-09-23%20at%2021.29.33%20(1).png" loading="lazy" alt=""/></p><figcaption>Koidex report for postmark-mcp</figcaption></figure><p>I&#39;ve been doing security for years now, and this particular issue keeps me up at night. Somehow, we&#39;ve all just accepted that it&#39;s totally normal to install tools from random strangers that can:</p><ul role="list"><li>Send emails as us (with our full authority)</li><li>Access our databases (yeah, all of them)</li><li>Execute commands on our systems</li><li>Make API calls with our credentials</li></ul><p>And once you install them? Your AI assistant just goes to town. No review process. No &#34;hey, should I really send this email with a BCC to giftshop.club?&#34; Just blind, automated execution. Over and over. Hundreds of times a day.</p><p>There&#39;s literally no security model here. No sandbox. No containment. Nothing. If the tool says &#34;send this email,&#34; your AI sends it. If it says &#34;oh, also copy everything to this random address,&#34; your AI does that too. No questions asked.</p><p>The postmark-mcp backdoor isn&#39;t sophisticated - it&#39;s embarrassingly simple. But it perfectly demonstrates how completely broken this whole setup is. One developer. One line of code. Thousands upon thousands of stolen emails.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/68d2e67416d1614856d43205_Screenshot%202025-09-23%20at%2021.26.25.png" loading="lazy" alt=""/></p><figcaption>postmark-mcp NPM page</figcaption></figure><h2>The Attack Timeline</h2><p><strong>Phase 1: Build a Legitimate Tool</strong></p><p><strong>Phase 2: Add One Line</strong></p><p><strong>Phase 3: Profit</strong></p><p>This pattern absolutely terrifies me. A tool can be completely legitimate for months. It gets battle-tested in production. It becomes essential to your workflow. Your team depends on it. And then one day - BAM - it&#39;s malware. By the time the backdoor activates, it&#39;s not some random package anymore. It&#39;s trusted infrastructure.</p><p>Oh, and <code>giftshop.club</code>? Looks like it might be another one of the developer&#39;s side projects. But now it&#39;s collecting a very different kind of gift. Your emails are the gifts.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/68d2dfc7f12afe4d7c64ce5e_Screenshot%202025-09-23%20at%2020.57.31.jpg" loading="lazy" alt=""/></p><figcaption>Another side-project by the same developer was used as the C2 server</figcaption></figure><p>When we reached out to the developer for clarification, we got silence. No explanation. No denial. Nothing. But he did take action - just not the kind we hoped for. He promptly deleted the package from npm, trying to erase the evidence.</p><p>Here&#39;s the thing though: deleting a package from npm doesn&#39;t remove it from the machines where it&#39;s already installed. Every single one of those 1,500 weekly downloads? They&#39;re still compromised. Still sending BCCs to <code>giftshop.club</code>. The developer knows this. He&#39;s banking on victims not realizing they&#39;re still infected even though the package has vanished from npm.</p><h2>Why MCP&#39;s Entire Model Is Fundamentally Broken</h2><p>Let me be really clear about something: MCP servers aren&#39;t like regular npm packages. These are tools specifically designed for AI assistants to use autonomously. That&#39;s the whole point.</p><p>When you install postmark-mcp, you&#39;re not just adding some dependency to your package.json. You&#39;re giving your AI assistant a tool it will use hundreds of times, automatically, without ever stopping to think &#34;hmm, is something wrong here?&#34;</p><p>Your AI can&#39;t detect that BCC field. It has no idea emails are being stolen. All it sees is a functioning email tool. Send email. Success. Send another email. Success. Meanwhile, every single message is being silently exfiltrated. Day after day. Week after week.</p><p>The postmark-mcp backdoor isn&#39;t just about one malicious developer or 1,500 weekly compromised installations. It&#39;s a warning shot about the MCP ecosystem itself.</p><p>We&#39;re handing god-mode permissions to tools built by people we don&#39;t know, can&#39;t verify, and have no reason to trust. These aren&#39;t just npm packages - they&#39;re direct pipelines into our most sensitive operations, automated by AI assistants that will use them thousands of times without question.</p><p>The backdoor is actively harvesting emails as you read this. We&#39;ve reported it to npm, but here&#39;s the terrifying question: how many other MCP servers are already compromised? How would you even know?</p><p>At Koi, we detect these behavioral changes in packages because the MCP ecosystem has no built-in security model. When you&#39;re trusting anonymous developers with your AI&#39;s capabilities, you need verification, not faith. Our risk engine automatically caught this backdoor the moment version 1.0.16 introduced the BCC behavior - something no traditional security tool would flag. But detection is just the first step. Our supply chain gateway ensures that malicious packages like this never make it into your environment in the first place. It acts as a checkpoint between your developers and the wild west of npm, MCP servers, and browser extensions - blocking known threats, flagging suspicious updates, and requiring approval for packages that touch sensitive operations like email or database access. While everyone else is hoping their developers make good choices, we&#39;re making sure they can only choose from verified, continuously monitored options.</p><p>If you&#39;re using <code>postmark-mcp</code> version <code>1.0.16</code> or later, you&#39;re compromised. Remove it immediately and rotate any credentials that may have been exposed through email. But more importantly, audit every MCP server you&#39;re using. Ask yourself: do you actually know who built these tools you&#39;re trusting with everything?</p><p>Stay paranoid. With MCPs, paranoia is just good sense.</p><h2>IOCs</h2><p><strong>Package:</strong> postmark-mcp (npm)</p><p><strong>Detection:</strong></p><ul role="list"><li>Check for BCC headers to giftshop.club in email logs</li><li>Audit MCP server configurations for unexpected email parameters</li><li>Review npm packages for version 1.0.16+ of postmark-mcp</li></ul><p><strong>Mitigation:</strong></p><ul role="list"><li>Immediately uninstall postmark-mcp</li><li>Rotate any credentials sent via email during the compromise period</li><li>Audit email logs for sensitive data that may have been exfiltrated</li><li>Report any confirmed breaches to appropriate authorities</li></ul><p>‍</p></div></div></div></div>
  </body>
</html>
