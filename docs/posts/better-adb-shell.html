<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/matan-h/adb-shell">Original</a>
    <h1>Better Adb-Shell</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">This repo uses the options of <a href="https://manpages.ubuntu.com/manpages/xenial/man1/mksh.1.html" rel="nofollow">mksh</a> (the android default shell) to get a better shell.</p>


<ul dir="auto">
<li>Colored prompt with path and color difference between successes and fail statuses:</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/matan-h/adb-shell/blob/main/screenshots/prompt.png"><img src="https://github.com/matan-h/adb-shell/raw/main/screenshots/prompt.png" alt="screenshot-of-prompt"/></a></p>
<ul dir="auto">
<li>Keyboard shortcuts, such as <code>ctrl+l</code> to clear the screen (in normal <code>adb shell</code> it&#39;s a shortcut for &#39;enter&#39; for some reason).</li>
<li><code>CDPATH</code>: you can <code>cd</code> to any directory in <code>/sdcard</code>, <code>Android/data</code> or <code>/</code> without typing the full path
(for example <code>cd com.android.chrome</code> even when you are in <code>/</code> directory)</li>
</ul>

<ul dir="auto">
<li><code>ls</code> with color by default.</li>
<li>shortcuts like <code>ll</code> and <code>la</code>.</li>
<li>one alias to fix the typo <code>sl</code> =&gt; <code>ls</code>.</li>
</ul>

<ul dir="auto">
<li>basic commands: <code>rd</code> (<code>rmdir</code>) and <code>md</code> (<code>mkdir</code>).</li>
<li><code>cls</code>(clear the screen)</li>
<li><code>rmtree</code> (remove folder)</li>
<li><code>..</code> and <code>cd..</code> =&gt; <code>cd ..</code></li>
<li><code>untar</code> (=&gt; <code>tar xvf</code>)</li>
</ul>

<p dir="auto">clone this repo:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/matan-h/adb-shell"><pre>git clone https://github.com/matan-h/adb-shell</pre></div>

<p dir="auto"><code>chmod +x</code> and run the <code>adb-shell.sh</code> file
(it&#39;s a short file, highly recommend you go and read <a href="https://github.com/matan-h/adb-shell/blob/main/adb-shell.sh">it</a> [and possibly also the <code>startup.sh</code> file] before executing)</p>
<div dir="auto" data-snippet-clipboard-copy-content="chmod +x adb-shell.sh
./adb-shell.sh"><pre>chmod +x adb-shell.sh
./adb-shell.sh</pre></div>
<p dir="auto">This will create the startup file for the <code>mksh</code> shell if it doesn&#39;t exist, and start the better <code>adb shell</code>.</p>
<p dir="auto">To make this <code>adb-shell</code> globally accessible ether add this to your <code>$PATH</code> or add an <code>alias</code> to this file:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# add this to your .rc file
alias adb-shell=&#34;&lt;PATH TO THIS REPO&gt;/adb-shell.sh&#34;"><pre><span><span>#</span> add this to your .rc file</span>
<span>alias</span> adb-shell=<span><span>&#34;</span>&lt;PATH TO THIS REPO&gt;/adb-shell.sh<span>&#34;</span></span></pre></div>

<p dir="auto">Run the <code>adb-shell.ps1</code> script (it&#39;s a short file, highly recommend you go and read <a href="https://github.com/matan-h/adb-shell/blob/main/adb-shell.ps1">it</a> [and possibly also the <code>startup.sh</code> file] before executing)</p>
<div dir="auto" data-snippet-clipboard-copy-content="powershell -executionpolicy bypass -File .\adb-shell.ps1"><pre>powershell <span>-</span>executionpolicy bypass <span>-</span>File .\adb<span>-</span>shell.ps1</pre></div>
<p dir="auto">To make this <code>adb-shell</code> globally accessible ether add this to your <code>$PATH</code> or add an <code>alias</code> to this file:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# add this to your powershell $PROFILE file (most likely $HOME\Documents\PowerShell\Microsoft.PowerShell_profile.ps1)
set-alias &#34;adb-shell&#34; &#34;&lt;PATH TO THIS REPO&gt;\adb-shell.ps1&#34;"><pre><span><span>#</span> add this to your powershell $PROFILE file (most likely $HOME\Documents\PowerShell\Microsoft.PowerShell_profile.ps1)</span>
<span>set-alias</span> <span><span>&#34;</span>adb-shell<span>&#34;</span></span> <span><span>&#34;</span>&lt;PATH TO THIS REPO&gt;\adb-shell.ps1<span>&#34;</span></span></pre></div>

<div dir="auto"><h2 tabindex="-1" dir="auto">History experimental feature</h2><a id="user-content-history-experimental-feature" aria-label="Permalink: History experimental feature" href="#history-experimental-feature"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://android.stackexchange.com/a/152093" rel="nofollow">history is disabled by default in the android shell build options</a>.</p>
<p dir="auto">However, It&#39;s possible to emulate that using the shell functions (e.g. write the last command to a history file after every command.)
The history is currently in testing state. If you want to enable it, go to <code>startup.sh</code> and change <code>ENABLE_EXPERIMENTAL_HISTORY</code> to <code>true</code>. (then <code>adb push startup.sh /sdcard/.adb/startup.sh</code>) Please open a GitHub issue for any bug/problem/suggestion.</p>

<p dir="auto">The <code>adb-shell.sh/.ps1</code> just pushes <code>startup.sh</code> and starts <code>adb shell</code> with the config file.
That means, you can skip this automated script, and configure it manually, using:</p>
<div dir="auto" data-snippet-clipboard-copy-content="STARTUP=/sdcard/.adb/startup.sh
alias adb-shell=&#34;adb shell -t \&#34;HOME=&#39;/sdcard&#39; ENV=&#39;$STARTUP&#39; sh -i\&#34;&#34;"><pre>STARTUP=/sdcard/.adb/startup.sh
<span>alias</span> adb-shell=<span><span>&#34;</span>adb shell -t <span>\&#34;</span>HOME=&#39;/sdcard&#39; ENV=&#39;<span>$STARTUP</span>&#39; sh -i<span>\&#34;</span><span>&#34;</span></span></pre></div>
<p dir="auto">The <code>startup.sh</code> is actually <code>.mksh</code> file for android, so if you want to <a href="http://www.mirbsd.org/mksh-faq.htm" rel="nofollow">config</a> <a href="https://github.com/MirBSD/mksh/blob/master/dot.mkshrc">it</a> <a href="http://www.mirbsd.org/htman/i386/man1/mksh.htm" rel="nofollow">manually</a>, you can.</p>
<p dir="auto">When you want to apply changes, run the following command:
<code>adb push startup.sh $STARTUP</code></p>

<p dir="auto">On all errors, problems or suggestions please open a <a href="https://github.com/matan-h/adb-shell/issues">GitHub issue</a></p>
<p dir="auto">If you found this script useful, it would be great if you could buy me a coffee:</p>
<p dir="auto"><a href="https://www.buymeacoffee.com/matanh" rel="nofollow"><img src="https://camo.githubusercontent.com/0b3d4a8ed29472d7356574cf88712d740d9785221a5f57ff679adb55c7e6babd/68747470733a2f2f63646e2e6275796d6561636f666665652e636f6d2f627574746f6e732f64656661756c742d626c75652e706e67" alt="Buy Me A Coffee" height="47" width="200" data-canonical-src="https://cdn.buymeacoffee.com/buttons/default-blue.png"/></a></p>
</article></div></div>
  </body>
</html>
