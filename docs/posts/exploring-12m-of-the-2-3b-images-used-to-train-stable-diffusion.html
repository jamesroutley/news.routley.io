<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://waxy.org/2022/08/exploring-12-million-of-the-images-used-to-train-stable-diffusions-image-generator/">Original</a>
    <h1>Exploring 12M of the 2.3B images used to train Stable Diffusion</h1>
    
    <div id="readability-page-1" class="page"><article id="post-44618">

<div>
<p>One of the biggest frustrations of text-to-image generation AI models is that they feel like a black box. We know they were trained on images pulled from the web, but which ones? As an artist or photographer, an obvious question is whether your work was used to train the AI model, but this is surprisingly hard to answer.</p>
<p>Sometimes, the data isn’t available at all: OpenAI has said it’s trained DALL-E 2 on hundreds of millions of captioned images, but hasn’t <a href="https://github.com/openai/dalle-2-preview/blob/main/system-card.md#model">released the proprietary data</a>. By contrast, the team behind <a href="https://stability.ai/blog/stable-diffusion-public-release">Stable Diffusion</a> have been very transparent about how their model is trained. Since it was released publicly last week, Stable Diffusion has exploded in popularity, in large part because of its free and permissive licensing, already incorporated into the new <a href="https://twitter.com/EMostaque/status/1561917541743841280">Midjourney beta</a>, <a href="https://creator.nightcafe.studio/stable-diffusion-image-generator">NightCafe</a>, and Stability AI’s own <a href="https://beta.dreamstudio.ai/dream">DreamStudio</a> app, as well as for use on your own computer. </p>
<p>But Stable Diffusion’s training datasets are impossible for most people to download, let alone search, with metadata for millions (or billions!) of images stored in obscure file formats in large multipart archives.</p>
<p>So, with the help of my friend <a href="https://simonwillison.net/">Simon Willison</a>, we grabbed the data for over 12 million images used to train Stable Diffusion, and used his Datasette project to make <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images">a data browser</a> for you to explore and search it yourself. Note that <strong>this is only a small subset of the total training data</strong>: about 2% of the 600 million images used to train the most recent three checkpoints, and only 0.5% of the 2.3 billion images that it was first trained on.</p>
<figure><a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images"><img width="1024" height="622" src="https://waxy.org/wp-content/uploads/2022/08/image-23-1024x622.png" alt="Screenshot of the LAION-Aesthetic data browser, showing results from a search for Swedish artist Simon Stålenhag with thumbnail images" srcset="https://waxy.org/wp-content/uploads/2022/08/image-23-1024x622.png 1024w, https://waxy.org/wp-content/uploads/2022/08/image-23-300x182.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-23-768x467.png 768w, https://waxy.org/wp-content/uploads/2022/08/image-23-800x486.png 800w, https://waxy.org/wp-content/uploads/2022/08/image-23.png 1213w" sizes="(max-width: 1024px) 100vw, 1024px"/></a><figcaption>Screenshot of the <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images">LAION-Aesthetic data browser</a> in Datasette</figcaption></figure>
<p>Go try it right now at <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images">laion-aesthetic.datasette.io</a>!</p>
<p>Read on to learn about how this dataset was collected, the websites it most frequently pulled images from, and the artists, famous faces, and fictional characters most frequently found in the data.</p>
<h2>Data Source</h2>
<p>Stable Diffusion was <a href="https://github.com/CompVis/stable-diffusion/blob/main/Stable_Diffusion_v1_Model_Card.md#training">trained</a> off three massive datasets collected by <a href="https://laion.ai/">LAION</a>, a nonprofit whose compute time was largely funded by Stable Diffusion’s owner, <a href="https://stability.ai/">Stability AI</a>.</p>
<p>All of LAION’s image datasets are built off of <a href="https://commoncrawl.org/">Common Crawl</a>, a nonprofit that scrapes billions of webpages monthly and <a href="https://commoncrawl.org/the-data/get-started/">releases them</a> as massive datasets. LAION collected all HTML image tags that had alt-text attributes, classified the resulting 5 billion image-pairs based on their language, and then filtered the results into separate datasets using their resolution, a predicted likelihood of having a watermark, and their predicted “aesthetic” score (i.e. subjective visual quality).</p>
<figure><img loading="lazy" width="1024" height="437" src="https://waxy.org/wp-content/uploads/2022/08/image-24-1024x437.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-24-1024x437.png 1024w, https://waxy.org/wp-content/uploads/2022/08/image-24-300x128.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-24-768x328.png 768w, https://waxy.org/wp-content/uploads/2022/08/image-24-1536x655.png 1536w, https://waxy.org/wp-content/uploads/2022/08/image-24-800x341.png 800w, https://waxy.org/wp-content/uploads/2022/08/image-24.png 1594w" sizes="(max-width: 1024px) 100vw, 1024px"/><figcaption>Collage of some of the images with the <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_sort_desc=aesthetic">highest “aesthetic” score</a>, largely watercolor landscapes and portraits of women</figcaption></figure>
<p>Stable Diffusion’s initial training was on low-resolution 256×256 images from <a href="https://huggingface.co/datasets/laion/laion2B-en">LAION-2B-EN</a>, a set of 2.3 billion English-captioned images from <a href="https://laion.ai/blog/laion-5b/">LAION-5B</a>‘s full collection of 5.85 billion image-text pairs, as well as <a href="https://huggingface.co/datasets/laion/laion-high-resolution">LAION-High-Resolution</a>, another subset of LAION-5B with 170 million images greater than 1024×1024 resolution (downsampled to 512×512).</p>
<p>Its last three checkpoints were on <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_5plus">LAION-Aesthetics v2 5+</a>, a 600 million image subset of LAION-2B-EN with a predicted <a href="https://laion.ai/blog/laion-aesthetics/">aesthetics score</a> of 5 or higher, with low-resolution and likely watermarked images filtered out.</p>
<p>For our data explorer, we originally wanted to show the full dataset, but it’s a challenge to host a 600 million record database in an affordable, performant way. So we decided to use the smaller <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_6plus">LAION-Aesthetics v2 6+</a>, which includes 12 million image-text pairs with a predicted aesthetic score of 6 or higher, instead of the 600 million rated 5 or higher used in Stable Diffusion’s training.</p>
<p>This should be a representative sample of images used to train Stable Diffusion’s last three checkpoints, but skewing towards more aesthetically-attractive images. Note that LAION provides a <a href="https://rom1504.github.io/clip-retrieval/">useful frontend</a> to search the CLIP embeddings computed from their 400M and 5 billion image datasets, but it doesn’t allow you to search the original captions.</p>
<h2>Source Domains</h2>
<p>We know the captioned images used for Stable Diffusion were scraped from the web, but from where? We indexed the <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/domain?_sort_desc=image_counts">12 million images in our sample by domain</a> to find out.</p>
<p>Nearly half of the images, about 47%, were sourced from only 100 domains, with the largest number of images coming from Pinterest. Over a million images, or 8.5% of the total dataset, are scraped from Pinterest’s pinimg.com CDN.</p>
<p>User-generated content platforms were a huge source for the image data. WordPress-hosted blogs on wp.com and wordpress.com represented 819k images together, or 6.8% of all images. Other photo, art, and blogging sites included 232k images from Smugmug, 146k from Blogspot, 121k images were from Flickr, 67k images from DeviantArt, 74k from Wikimedia, 48k from 500px, and 28k from Tumblr.</p>
<p>Shopping sites were well-represented. The second-biggest domain was Fine Art America, which sells art prints and posters, with 698k images (5.8%) in the dataset. 244k images came from Shopify, 189k each from Wix and Squarespace, 90k from Redbubble, and just over 47k from Etsy.</p>
<p>Unsurprisingly, a large number came from stock image sites. 123RF was the biggest with 497k, 171k images came from Adobe Stock’s CDN at ftcdn.net, 117k from PhotoShelter, 35k images from Dreamstime, 23k from iStockPhoto, 22k from Depositphotos, 22k from Unsplash, 15k from Getty Images, 10k from VectorStock, and 10k from Shutterstock, among many others.</p>
<p>It’s worth noting, however, that domains alone may not represent the actual sources of these images. For instance, there are only 6,292 images sourced from Artstation.com’s domain, but another 2,740 images with <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=artstation&amp;_sort=rowid">“artstation” in the caption text</a> hosted by <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=artstation&amp;_sort=rowid&amp;_facet=domain_id">sites like Pinterest</a>.</p>
<h2>Artists</h2>
<p>We wanted to understand how artists were represented in the dataset, so used the list of over 1,800 artists in <a href="https://docs.google.com/spreadsheets/d/1_jgQ9SyvUaBNP1mHHEzZ6HhL_Es1KwBKQtnpnmWW82I/edit?usp=sharing">MisterRuffian’s Latent Artist &amp; Modifier Encyclopedia</a> to search the dataset and count the number of images that reference each artist’s name. You can browse and search those <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/artists?_sort_desc=image_counts">artist counts here</a>, or try searching for any artist in the <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=%22frida+kahlo%22&amp;_sort=rowid">images table</a>. (Searching with quoted strings is recommended.)</p>
<p>Of the top 25 artists in the dataset, only three are still living: Phil Koch, Erin Hanson, and Steve Henderson. The most frequent artist in the dataset? The Painter of Light™ himself, Thomas Kinkade, with <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=%22Thomas+Kinkade%22&amp;_sort=rowid">9,268 images</a>.</p>
<div>
<figure><a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/artists?_sort_desc=image_counts"><img loading="lazy" width="435" height="327" src="https://waxy.org/wp-content/uploads/2022/08/image-25.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-25.png 435w, https://waxy.org/wp-content/uploads/2022/08/image-25-300x226.png 300w" sizes="(max-width: 435px) 100vw, 435px"/></a><figcaption>From a list of 1,800 popular artists, the top 10 found most frequently in the captioned images</figcaption></figure></div>
<p>Using the “type” field in the database, you can see the most frequently-found artists in each category: for example, looking only at <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/artists?Type__exact=Comic+Book+Artist&amp;_sort_desc=image_counts">comic book artists</a>, Stan Lee’s name is found most often in the image captions.</p>
<p>Some of the most-cited recommended artists used in AI image prompting aren’t as pervasive in the dataset as you’d expect. There are only <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=%22Greg+Rutkowski%22&amp;_sort=rowid">15 images</a> that mention fantasy artist Greg Rutkowski, whose name is <a href="https://lexica.art/?q=%22Greg+Rutkowski%22">frequently used</a> as a prompt modifier, and only <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=%22James+Gurney%22&amp;_sort=rowid">73</a> from James Gurney.</p>
<p>(It’s worth saying again that these images are just a subset of one of three datasets used to train the AI, so an artist’s work may have been used elsewhere in the data even if they’re not found in these 12M images.)</p>
<h2>Famous People</h2>
<p>Unlike DALL-E 2, Stable Diffusion doesn’t have any limitations on generating images of people named in the dataset. To get a sense of how well-represented well-known people are in the dataset, we took <a href="https://www.popsugar.com/celebrities">two</a> <a href="https://celebanswers.com/celebrity-list/">lists</a> of celebrities and other famous names and merged it into a list of nearly 2,000 names. You can see the results of those <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/celebrities">celebrity counts here</a>, or search for any name in the images table. (Obviously, some of the top searches like “Pink” and “Prince” include results that don’t refer to that person.)</p>
<p><a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=%22Donald+Trump%22&amp;_sort=rowid">Donald Trump</a> is one of the most cited names in the image dataset, with nearly 11,000 photos referencing his name. <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/images?_search=charlize+theron&amp;_sort=rowid">Charlize Theron</a> is a close runner-up with 9,576 images.</p>
<figure>
<figure><img loading="lazy" width="1536" height="1536" data-id="44663" src="https://waxy.org/wp-content/uploads/2022/08/image-26.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-26.png 1536w, https://waxy.org/wp-content/uploads/2022/08/image-26-300x300.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-26-1024x1024.png 1024w, https://waxy.org/wp-content/uploads/2022/08/image-26-150x150.png 150w, https://waxy.org/wp-content/uploads/2022/08/image-26-768x768.png 768w, https://waxy.org/wp-content/uploads/2022/08/image-26-800x800.png 800w" sizes="(max-width: 1536px) 100vw, 1536px"/></figure>
<figure><img loading="lazy" width="1154" height="1155" data-id="44665" src="https://waxy.org/wp-content/uploads/2022/08/image-27.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-27.png 1154w, https://waxy.org/wp-content/uploads/2022/08/image-27-300x300.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-27-1024x1024.png 1024w, https://waxy.org/wp-content/uploads/2022/08/image-27-150x150.png 150w, https://waxy.org/wp-content/uploads/2022/08/image-27-768x769.png 768w, https://waxy.org/wp-content/uploads/2022/08/image-27-800x801.png 800w" sizes="(max-width: 1154px) 100vw, 1154px"/></figure>
<figcaption>Collage of generated portraits of <a href="https://lexica.art/prompt/a33bba8a-d0fd-4900-9d75-7b15cea94b52">Donald Trump</a> and <a href="https://lexica.art/prompt/5171926f-06a4-4c30-b493-4f30ee1253b0">Charlize Theron</a> from Stable Diffusion</figcaption></figure>
<p>A full gender breakdown would take more time, but at a glance, it seems like many of the <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/celebrities?_sort_desc=image_counts">most popular names</a> in the dataset are women.</p>
<p>Strangely, enormously popular internet personalities like David Dobrik, Addison Rae, Charli D’Amelio, Dixie D’Amelio, and MrBeast <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/celebrities?_sort=image_counts">don’t appear</a> in the captions from the dataset at all. My hunch was that the CommonCrawl data was too old to include these more recent celebrities, but based on the URLs, there are tens of thousands of images from last year in the data. (If you can solve this mystery, get in touch or leave a comment!)</p>
<h2>Fictional Characters</h2>
<p>Finally, we took a look at how popular fictional characters are represented in the dataset, since this is subject matter that’s enormously popular using Stable Diffusion and Craiyon, but often impossible with DALL-E 2, as you can see in this Mickey Mouse example from my previous post.</p>
<figure>
<figure><img loading="lazy" width="1024" height="1024" data-id="44579" src="https://waxy.org/wp-content/uploads/2022/08/image-12.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-12.png 1024w, https://waxy.org/wp-content/uploads/2022/08/image-12-300x300.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-12-150x150.png 150w, https://waxy.org/wp-content/uploads/2022/08/image-12-768x768.png 768w, https://waxy.org/wp-content/uploads/2022/08/image-12-800x800.png 800w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>
<figure><img loading="lazy" width="512" height="512" data-id="44582" src="https://waxy.org/wp-content/uploads/2022/08/image-15.png" alt="" srcset="https://waxy.org/wp-content/uploads/2022/08/image-15.png 512w, https://waxy.org/wp-content/uploads/2022/08/image-15-300x300.png 300w, https://waxy.org/wp-content/uploads/2022/08/image-15-150x150.png 150w" sizes="(max-width: 512px) 100vw, 512px"/></figure>
<figcaption>“realistic 3d rendering of mickey mouse working on a vintage computer doing his taxes” on DALL·E 2 (left) vs. Stable Diffusion (right)<br/></figcaption></figure>
<p>For this set of searches, we used <a href="https://github.com/croquet/worldcore/blob/main/examples/popsmash/src/Characters.js">this list</a> of 600 fictional characters from pop culture to search the image dataset. You can <a href="https://laion-aesthetic.datasette.io/laion-aesthetic-6pls/characters?_sort_desc=image_counts">browse the results</a> here, or search for any other character in the images table. (Again, be aware that one-word character names like “Link,” “Data,” and “Mario” are likely to have many more results unrelated to that character.)</p>
<p>Characters from the MCU like Captain Marvel (4,993 images), Black Panther (4,395), and Captain America (3,155) are some of the best represented in the dataset. Batman (2,950) and Superman (2,739) are neck and neck. Luke Skywalker (2,240) has more images than Darth Vader (1.717) and Han Solo (1,013). Mickey Mouse barely breaks the top 100 with 520 images.</p>
<h2>NSFW Content</h2>
<p>Finally, let’s take a brief look at the representation of adult material, another huge difference between Stable Diffusion and any other model. OpenAI rigorously removed sexual/violent content from its training data and blocked potentially NSFW keywords from prompts.</p>
<p>The Stable Diffusion team built a predictor for adult material and assigned every image a NSFW probability score, which you can see in the “punsafe” field in the images table, ranging from 0 to 1. (<strong>Warning:</strong> Obviously, sorting by that field will show the most NSFW images in the dataset.)</p>
<p>In their announcements of the <a href="https://laion.ai/blog/laion-5b/">full LAION-5B dataset</a>, LAION team member Romain Beaumont estimated that about 2.9% of the English-language images were “unsafe,” but in browsing this dataset, it’s not clear how their predictors defined that. </p>
<p>There’s definitely NSFW material in the image dataset, but surprisingly little of it. Only 222 images got a “1” unsafe probability score, indicating 100% confidence that it’s unsafe, about 0.002% of the total images — and those are definitely porn. But nudity seems to be unusual outside of that confidence level: even images with a 0.9999 punsafe score (99.99% confidence) rarely have nudity in them.</p>
<p>It’s plausible that filtering on aesthetic ratings is removing huge amounts of NSFW content from the image dataset, and the full dataset contains much more. Or maybe their definitions of what is “unsafe” are very broad.</p>
<h2>More Info</h2>
<p>Again, huge thanks to <a href="https://simonwillison.net/">Simon Willison</a> for working with me on this: he did all the heavy lifting of hosting the data. His <a href="https://datasette.io/">Datasette project</a> is open-source, extremely flexible, and worth checking out. If you’re interested in playing with this data yourself, you can <a href="https://github.com/simonw/laion-aesthetic-datasette">use the scripts in his GitHub repo</a> to download and import it into a SQLite database.</p>
<p>If you find anything interesting in the data, or have any questions, feel free to drop them in the comments.</p>
</div>
</article></div>
  </body>
</html>
