<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gpanders.com/blog/whats-new-in-neovim-0.10/">Original</a>
    <h1>What&#39;s New in Neovim 0.10</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p>Neovim 0.10 was the longest release cycle since the heady days of the 0.5
release. There are a ton of new features in this release (as well as some
breaking changes), so be sure to check the full <a href="https://neovim.io/doc/user/news-0.10.html">release notes</a>. You can
view the release notes directly in Nvim with <code>:h news</code>. The news file includes
information on new features, deprecations, and breaking changes. I especially
urge plugin authors to read this file carefully.</p>
<p>Like <a href="https://gpanders.com/blog/whats-new-in-neovim-0-7/">last time</a>, in this post I’ll cover a subset of the new features.
As I said, it’s a big release, and I won’t write about everything, but these
are some of the highlights.</p>
<h2 id="table-of-contents">
  <a href="#table-of-contents">Table of Contents</a>
</h2>
<ul>
<li><a href="#defaults">Defaults</a></li>
<li><a href="#builtin-commenting">Builtin commenting</a></li>
<li><a href="#terminal-ui-enhancements">Terminal UI enhancements</a></li>
<li><a href="#lsp-inlay-hints">LSP inlay hints</a></li>
<li><a href="#tree-sitter-query-editor">Tree-sitter query editor</a></li>
<li><a href="#miscellaneous">Miscellaneous</a></li>
<li><a href="#roadmap">Roadmap</a></li>
</ul>
<h2 id="defaults">
  <a href="#defaults">Defaults</a>
</h2>
<h3 id="colorscheme">
  <a href="#colorscheme">Colorscheme</a>
</h3>
<p>Nvim has been in need of a new default colorscheme for a long time. While the
default colors have some charm and nostalgia, there are serious accessibility
and aesthetic issues, particular when using Nvim is a diff viewer. The
screenshot below shows the default colorscheme before Nvim 0.10:</p>
<figure><img src="https://gpanders.com/img/nvim-colorscheme-old.png" alt="Neovim&#39;s default colorscheme before 0.10"/>
</figure>

<p>Nvim 0.10 now ships with a new default colorscheme, which you can see below:</p>
<figure><img src="https://gpanders.com/img/nvim-colorscheme-new.png" alt="Neovim&#39;s new default colorscheme"/>
</figure>

<p>The new default colorscheme was heroically contributed by <a href="https://github.com/echasnovski">Evgeni
Chasnovski</a>, who endured seemingly endless bikeshedding and
successfully navigated the treacherous waters of such a subjective change.
There were many constraints imposed on the design of the colorscheme, which
you can read in the <a href="https://github.com/neovim/neovim/pull/26334">PR</a> (and the many follow up PRs and issues linked
therein). It is quite literally impossible to please <em>everyone</em> with a single
colorscheme, and there is no expectation that we have achieved that, but the
new colorscheme does, hopefully, improve the default experience for many
people.</p>
<h3 id="lsp-and-diagnostics-mappings">
  <a href="#lsp-and-diagnostics-mappings">LSP and Diagnostics Mappings</a>
</h3>
<p>Nvim 0.10 adds a new <a href="https://github.com/neovim/neovim/pull/24331">default mapping</a>: <code>K</code> in Normal mode maps to
<code>vim.lsp.buf.hover()</code> whenever a buffer attaches to an LSP client, unless
<code>&#39;keywordprg&#39;</code> is already set to a non-default value. Use this to view
information about the function or variable under the cursor. This in addition
to the existing defaults mentioned in <code>:h lsp-defaults</code> which were added in
the previous release.</p>
<p>In addition, there are new <a href="https://github.com/neovim/neovim/pull/16230">default mappings</a> for navigating
diagnostics:</p>
<ul>
<li><code>[d</code> and <code>]d</code> in Normal mode map to <code>vim.diagnostic.goto_prev()</code> and
<code>vim.diagnostic.goto_next()</code>, respectively. Use these to navigate between
diagnostics in the current buffer.</li>
<li><code>&lt;C-W&gt;d</code> (and <code>&lt;C-W&gt;&lt;C-D&gt;</code>) in Normal mode map to
<code>vim.diagnostic.open_float()</code>. Use this to view information about any
diagnostics under the cursor in a floating window.</li>
</ul>
<p>The diagnostics mappings override builtin mappings. These builtin mappings are
not often used, but if you <em>do</em> use them you can delete the new default
mappings with <code>vim.keymap.del()</code> or <code>:unmap</code>.</p>
<p>The intention behind providing more default mappings is to make it easier to
get started with LSP in Neovim. The hope is that most users should be able to
get up and running with useful LSP features with little to no configuration
and without needing to write a bunch of Lua code. We have plans to add more
defaults in future releases, though as you might imagine this is a fraught
exercise. It is quite difficult to change default behavior in a tool as
extensible and customizable as Nvim without breaking users&#39;
<a href="https://xkcd.com/1172/">workflows</a>.</p>
<p>Two features which many users rely on for their LSP experience are snippets
support and autocompletion. Both of these features are on the roadmap to be
included in Nvim core (see <a href="https://github.com/neovim/neovim/pull/27339">#27339</a>, <a href="https://github.com/neovim/neovim/issues/25696">#25696</a>, and <a href="https://github.com/neovim/neovim/issues/25670">#25670</a>) which
will, hopefully, make the experience of using LSP in Neovim even smoother in
the future.</p>

<p>Longtime Vim users are likely familiar with the venerable <a href="https://github.com/tpope/vim-commentary">vim-commentary</a>
plugin, which creates mappings and operators for commenting and uncommenting
text. Thanks to <a href="https://github.com/echasnovski">Evgeni Chasnovski</a>, Nvim 0.10 now <a href="https://github.com/neovim/neovim/pull/28176">bundles this
functionality</a> by default, using a from-scratch implementation in
Lua. Unlike vim-commentary, Nvim’s builtin implementation provides a text
object and supports Tree-sitter, which is useful when working in injected
languages (example: if you comment text inside a <code>&lt;script&gt;</code> tag in an HTML
buffer, it will correctly use the Javascript <code>//</code> comment string rather than
HTML’s <code>&lt;!-- --&gt;</code> comment string).</p>
<p>See <code>:h commenting</code> for more details.</p>
<h2 id="terminal-ui-enhancements">
  <a href="#terminal-ui-enhancements">Terminal UI enhancements</a>
</h2>
<p>Nvim 0.10 adds support for many new terminal based capabilities.</p>
<h3 id="synchronized-output">
  <a href="#synchronized-output">Synchronized Output</a>
</h3>
<p>Many modern terminal emulators support <a href="https://gist.github.com/christianparpart/d8a62cc1ab659194337d73e399004036">synchronized output</a> which allows
terminal applications (like Nvim) to “batch” all of their UI updates in the
terminal emulator and display them all at once. This can reduce “flickering”
and “tearing” when a terminal UI (TUI) is being drawn very rapidly. This can
sometimes happen in Nvim when using plugins that perform rapid UI updates
(e.g. spinners, LSP status windows, etc.). Nvim 0.10 introduces a new
<code>&#39;termsync&#39;</code> option (enabled by default) which enables this feature if it is
supported by the terminal emulator.</p>
<h3 id="system-clipboard-synchronization">
  <a href="#system-clipboard-synchronization">System clipboard synchronization</a>
</h3>
<p>Nvim 0.10 can now use the OSC 52 escape sequence to write to (or read from)
the system clipboard. OSC 52 is only used automatically when (1) it is able to
determine that the terminal emulator supports it (via XTGETTCAP), (2) it is
running in an SSH session, and (3) when the <code>&#39;clipboard&#39;</code> option is unset.
Note that some terminal emulators do not support reading from the system
clipboard with OSC 52, or only allow it after prompting the user for
confirmation. It is recommended to use the traditional “paste” key binding
(e.g. <code>Cmd+V</code> on macOS or <code>Ctrl+Shift+V</code> on Linux) to paste into Nvim from the
system clipboard and use <code>&#34;+</code> to copy to the clipboard inside Nvim (see <code>:h quoteplus</code>).</p>
<h3 id="hyperlinks">
  <a href="#hyperlinks">Hyperlinks</a>
</h3>
<p>Nvim 0.10 introduces experimental support for hyperlinks using the OSC 8
sequence. By default, this is used in Markdown for links of the form
<code>[example](https://example.com)</code>. If your terminal emulator supports the OSC 8
escape sequence, then the text <code>example</code> in the Nvim buffer will contain a
hyperlink that can be clicked and will open <code>https://example.com</code> in your web
browser.</p>
<p>This means that users can view Markdown files with <code>:set conceallevel=2</code> and
get an experience much closer to the rendered output:</p>
<figure><img src="https://gpanders.com/img/nvim-readme.png" alt="Screenshot of the Neovim README opened in Nvim"/>
</figure>

<p>In the screenshot above, the underlined words are clickable link text, just as
you would find in a web browser.</p>
<h3 id="automatic-truecolor-detection">
  <a href="#automatic-truecolor-detection">Automatic truecolor detection</a>
</h3>
<p>Nvim 0.10 will now automatically determine if the terminal emulator supports
24 bit color (“truecolor”) and enable the <code>&#39;termguicolors&#39;</code> option if it does.
It does this through a combination of heuristics (<code>$COLORTERM</code>, terminfo) and
terminal queries (DECRQSS, XTGETTCAP). This detection works even over SSH
connections and when inside a terminal multiplexer such as <code>tmux</code>.</p>
<h2 id="lsp-inlay-hints">
  <a href="#lsp-inlay-hints">LSP inlay hints</a>
</h2>
<p>Nvim 0.10 now supports <a href="https://github.com/neovim/neovim/pull/23984">LSP inlay hints</a> thanks to <a href="https://github.com/p00f">Chinmay
Dalal</a>. A picture here will do more than my words can:</p>
<figure><img src="https://gpanders.com/img/nvim-inlay-hints.png" alt="Screenshot of Nvim showing inlay hints"/>
</figure>

<p>The dark colored texts which display type annotations for variable declarations
are inlay hints. This text is not part of the actual source file in the
buffer, but is “virtual” text inserted by Nvim and provided by the language
server. These hints can be enabled or disabled dynamically using
<code>vim.lsp.inlay_hint.enable()</code>.</p>
<p>Many other new LSP features were added in Nvim 0.10 as well. Refer to the
“LSP” section in <code>:h news</code> for a full list.</p>
<h2 id="tree-sitter-query-editor">
  <a href="#tree-sitter-query-editor">Tree-sitter query editor</a>
</h2>
<p>Nvim 0.10 adds even more tools for working with Tree-sitter queries. If you
didn’t know already, Nvim bundles an “inspector” which allows you to view the
abstract syntax tree of any source file with the <code>:InspectTree</code> command (so
long as a Tree-sitter parser for the file’s language is installed). Example:</p>
<figure><img src="https://gpanders.com/img/nvim-inspect-tree.png" alt="Screenshot of the :InspectTree command in Nvim"/>
</figure>

<p>Thanks to <a href="https://github.com/MariaSolOs">Maria José Solano</a>, Nvim 0.10 adds a powerful
capability to the Tree-sitter inspector: <a href="https://github.com/neovim/neovim/pull/24703">a query editor</a>. The query
editor allows you to write queries and see the matches in a source buffer in
real time. Being able to create and modify queries interactively makes writing
new queries a breeze. Example:</p>
<figure><img src="https://gpanders.com/img/nvim-query-editor.png" alt="Screenshot of the :EditQuery command in Nvim"/>
</figure>

<p>In the screenshot above, the query editor is open in the top-right window, the
tree inspector is in the bottom-right window, and the source buffer is in the
left window. Notice that the text that is matched by the query in the query
editor is highlighted in the source buffer and that the text <strong>initializer</strong>
(the capture group used in the query) is floating on the line next to the
match. As the query is updated in the editor, the corresponding highlights in
the source buffer change in real time.</p>
<p>The query editor can be opened by pressing <code>o</code> in the <code>:InspectTree</code> window,
with the <code>:EditQuery</code> command, or by calling <code>vim.treesitter.query.edit()</code>
directly.</p>
<p>With <code>:InspectTree</code> and <code>:EditQuery</code>, Neovim is one of the best tools (if not
<em>the</em> best tool) for working with Tree-sitter, even if you don’t actually use
Neovim.</p>
<h2 id="miscellaneous">
  <a href="#miscellaneous">Miscellaneous</a>
</h2>
<p>As I mentioned at the top of this post, there are <em>a lot</em> of new features in
this release, and I am not going to cover all of them. Here I’ll list a few
more that I personally think are worth mentioning:</p>
<ul>
<li>
<p>The <code>:terminal</code> command now accepts modifiers, so you can use e.g. <code>:botright terminal</code> (or <code>:bo te</code>) to open a new terminal window in a split at the
bottom of your screen. In addition, <code>:terminal</code> buffers that are started
with no arguments (and thus open a shell) will close automatically when the
shell exits without an error.</p>
</li>
<li>
<p><code>gx</code> in Normal mode calls <code>vim.ui.open()</code> on whatever is under the cursor,
which shells out to your operating system’s “open” capability (e.g. <code>open</code>
on macOS or <code>xdg-open</code> on Linux). For instance, pressing <code>gx</code> on a URL will
open that URL in your browser.</p>
</li>
<li>
<p>Tree-sitter based syntax highlighting is enabled by default for Lua, Vimdoc
(<code>:help</code>), and Tree-sitter queries (to revert to traditional regex
based syntax highlighting, create a <code>FileType</code> autocommand or <code>ftplugin</code>
with <code>vim.treesitter.stop()</code> for the respective filetype).</p>
</li>
<li>
<p><code>Q</code> and <code>@</code> in Visual mode will execute the last recorded/executed macro for
all visually selected lines.</p>
</li>
<li>
<p>Users using a terminal emulator that supports the Kitty keyboard protocol
can create mappings using the “super” and “meta” modifiers with the <code>&lt;D-</code>
and <code>&lt;T-</code> prefixes, respectively (e.g. <code>&lt;D-S&gt;</code> is <code>Cmd+S</code> on macOS).</p>
</li>
</ul>
<h2 id="roadmap">
  <a href="#roadmap">Roadmap</a>
</h2>
<p>The Neovim project is loosely organized and structured. We follow a “fun
driven development” paradigm: for the most part, contributors and maintainers
work on things that are personally interesting to them. Because of this, it
can be difficult to predict what will happen in future releases. If there is a
feature you want to see implemented, the best way to do it is to take a crack
at it yourself: many of the features mentioned in this very blog post were
contributed by users that are not part of the “core” maintenance team!</p>
<p>There is active chatter about further improving the LSP and Tree-sitter
experience (as mentioned above, builtin snippet and completion support are a
work-in-progress). One of the biggest challenges with Tree-sitter is parser
distribution: currently, parsers are shared object files which must be
compiled on every user’s machine or distributed with a system package manager.
We are already working on implementing the new <a href="https://github.com/neovim/neovim/pull/28415">Tree-sitter WASM
capabilities</a> which will enable distributing Tree-sitter parsers as
portable WASM blobs. This solves the distribution problem and may enable
Neovim to ship more Tree-sitter parsers out of the box.</p>
<p>We would also like to integrate some of the functionality from
<a href="https://github.com/neovim/nvim-lspconfig">nvim-lspconfig</a> so that, ideally, nvim-lspconfig is just a “bag of configs”
without any smarts or core logic. How best to do this is still hotly debated,
but it is something that is being discussed.</p>
<h2 id="getting-involved">
  <a href="#getting-involved">Getting Involved</a>
</h2>
<p>There is nothing quite as fun as hacking on your own tools. If you are a
Neovim user, I encourage you to get involved, whether that is through
contributing directly to the Neovim project or a plugin, or simply
participating in community spaces such as the <a href="https://matrix.to/#/#neovim:matrix.org">Neovim Matrix room</a>. If you
have pain points or frustrations when using Neovim, please let us know. Many
of us on the core maintenance team have been using Vim/Nvim for so long that
we’ve forgotten what it’s like to be a beginner and, speaking for myself at
least, this can leave blind spots on how things can be improved.</p>
<p>Thanks for reading and for using Neovim! Hopefully the next update will come a
little sooner.</p>

<p>The Neovim project now has a merch <a href="https://store.neovim.io/">store</a>! If you
didn’t know that you needed a Neovim branded hoodie or mug, now you do. All
proceeds raised from the store are used to fund project needs and sponsor
full-time development work.</p>

  </div></div>
  </body>
</html>
