<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://peps.python.org/pep-0594/">Original</a>
    <h1>PEP 594 “Removing dead batteries from the standard library” accepted</h1>
    
    <div id="readability-page-1" class="page"><section id="pep-content">

<dl>
<dt>PEP</dt>
<dd>594</dd>
<dt>Title</dt>
<dd>Removing dead batteries from the standard library</dd>
<dt>Author</dt>
<dd>Christian Heimes &lt;christian at python.org&gt;,
Brett Cannon &lt;brett at python.org&gt;</dd>
<dt>Discussions-To</dt>
<dd><a href="https://discuss.python.org/t/13508">https://discuss.python.org/t/13508</a></dd>
<dt>Status</dt>
<dd>Accepted</dd>
<dt>Type</dt>
<dd>Standards Track</dd>
<dt>Created</dt>
<dd>20-May-2019</dd>
<dt>Python-Version</dt>
<dd>3.11</dd>
<dt>Post-History</dt>
<dd>21-May-2019, 04-Feb-2022</dd>
<dt>Resolution</dt>
<dd><a href="https://discuss.python.org/t/13508/22">https://discuss.python.org/t/13508/22</a></dd>
</dl>
<hr/>
<section id="contents">
<details><summary>Contents</summary><ul>
<li><a href="#abstract">Abstract</a></li>
<li><a href="#rationale">Rationale</a></li>
<li><a href="#deprecation-schedule">Deprecation schedule</a><ul>
<li><a href="#id2">3.11</a></li>
<li><a href="#id3">3.12</a></li>
<li><a href="#id4">3.13</a></li>
</ul>
</li>
<li><a href="#deprecated-modules">Deprecated modules</a><ul>
<li><a href="#data-encoding-modules">Data encoding modules</a><ul>
<li><a href="#uu-and-the-uu-encoding">uu and the uu encoding</a></li>
<li><a href="#xdrlib">xdrlib</a></li>
</ul>
</li>
<li><a href="#multimedia-modules">Multimedia modules</a><ul>
<li><a href="#aifc">aifc</a></li>
<li><a href="#audioop">audioop</a></li>
<li><a href="#chunk">chunk</a></li>
<li><a href="#imghdr">imghdr</a></li>
<li><a href="#ossaudiodev">ossaudiodev</a></li>
<li><a href="#sndhdr">sndhdr</a></li>
<li><a href="#sunau">sunau</a></li>
</ul>
</li>
<li><a href="#networking-modules">Networking modules</a><ul>
<li><a href="#asynchat">asynchat</a></li>
<li><a href="#asyncore">asyncore</a></li>
<li><a href="#cgi">cgi</a></li>
<li><a href="#cgitb">cgitb</a></li>
<li><a href="#smtpd">smtpd</a></li>
<li><a href="#nntplib">nntplib</a></li>
<li><a href="#telnetlib">telnetlib</a></li>
</ul>
</li>
<li><a href="#operating-system-interface">Operating system interface</a><ul>
<li><a href="#crypt">crypt</a></li>
<li><a href="#nis">nis</a></li>
<li><a href="#spwd">spwd</a></li>
</ul>
</li>
<li><a href="#misc-modules">Misc modules</a><ul>
<li><a href="#msilib">msilib</a></li>
<li><a href="#pipes">pipes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#modules-to-keep">Modules to keep</a><ul>
<li><a href="#colorsys">colorsys</a></li>
<li><a href="#fileinput">fileinput</a></li>
<li><a href="#getopt">getopt</a></li>
<li><a href="#optparse">optparse</a></li>
<li><a href="#wave">wave</a></li>
</ul>
</li>
<li><a href="#discussions">Discussions</a></li>
<li><a href="#rejected-ideas">Rejected ideas</a><ul>
<li><a href="#creating-maintaining-a-separate-repo-for-the-deprecated-modules">Creating/maintaining a separate repo for the deprecated modules</a></li>
</ul>
</li>
<li><a href="#update-history">Update history</a><ul>
<li><a href="#update-1">Update 1</a></li>
<li><a href="#update-2">Update 2</a></li>
<li><a href="#update-3">Update 3</a></li>
<li><a href="#update-4">Update 4</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
<li><a href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a href="#abstract">Abstract</a></h2>
<p>This PEP proposed a list of standard library modules to be removed from the
standard library. The modules are mostly historic data formats (e.g. Commodore
and SUN file formats), APIs and operating systems that have been superseded a
long time ago (e.g. Mac OS 9), or modules that have security implications and
better alternatives (e.g. password and login).</p>
<p>The PEP follows in the footsteps of other PEPS like <a href="https://peps.python.org/pep-3108" title="PEP 3108 – Standard Library Reorganization">PEP 3108</a>. The
<em>Standard Library Reorganization</em> proposal removed a bunch of modules from
Python 3.0. In 2007, the PEP referred to maintenance burden as:</p>
<blockquote>
<p>“Over the years, certain modules have become a heavy burden upon python-dev
to maintain. In situations like this, it is better for the module to be
given to the community to maintain to free python-dev to focus more on
language support and other modules in the standard library that do not take
up an undue amount of time and effort.”</p></blockquote>
<p>The withdrawn <a href="https://peps.python.org/pep-0206" title="PEP 206 – Python Advanced Library">PEP 206</a> from 2000 expresses issues with the Python standard
library in an unvarnished and forthright manner:</p>
<blockquote>
<p>“[…] the standard library modules aren’t always the best choices for a
job. Some library modules were quick hacks (e.g. <code><span>calendar</span></code>,
<code><span>commands</span></code>), some were designed poorly and are now near-impossible to
fix (<code><span>cgi</span></code>), and some have been rendered obsolete by other, more complete
modules […].”</p></blockquote>
</section>
<section id="rationale">
<h2><a href="#rationale">Rationale</a></h2>
<p>Back in the early days of Python, the interpreter came with a large set of
useful modules. This was often referred to as “batteries included”
philosophy and was one of the cornerstones to Python’s success story.
Users didn’t have to figure out how to download and install separate
packages in order to write a simple web server or parse email.</p>
<p>Times have changed. The introduction of PyPI (née Cheeseshop), setuptools,
and later pip, it became simple and straightforward to download and install
packages. Nowadays Python has a rich and vibrant ecosystem of third-party
packages. It’s pretty much standard to either install packages from PyPI or
use one of the many Python or Linux distributions.</p>
<p>On the other hand, Python’s standard library is piling up with cruft, unnecessary
duplication of functionality, and dispensable features. This is undesirable
for several reasons.</p>
<ul>
<li>Any additional module increases the maintenance cost for the Python core
development team. The team has limited resources, reduced maintenance cost
frees development time for other improvements.</li>
<li>Modules in the standard library are generally favored and seen as the
de facto solution for a problem. A majority of users only pick third-party
modules to replace a stdlib module, when they have a compelling reason, e.g.
<code><span>lxml</span></code> instead of <code><span>xml</span></code>. The removal of an unmaintained stdlib module
increases the chances of a community-contributed module to become widely
used.</li>
<li>A lean and mean standard library benefits platforms with limited resources
like devices with just a few hundred kilobyte of storage (e.g. BBC
Micro:bit). Python on mobile platforms like BeeWare or WebAssembly
(e.g. pyodide) also benefit from reduced download size.</li>
</ul>
<p>The modules in this PEP have been selected for deprecation because their
removal is either least controversial or most beneficial. For example,
least controversial are 30-year-old multimedia formats like the <code><span>sunau</span></code>
audio format, which was used on SPARC and NeXT workstations in the late
1980s. The <code><span>crypt</span></code> module has fundamental flaws that are better solved
outside the standard library.</p>
<p>This PEP also designates some modules as not scheduled for removal. Some
modules have been deprecated for several releases or seem unnecessary at
first glance. However it is beneficial to keep the modules in the standard
library, mostly for environments where installing a package from PyPI is not
an option. This can be corporate environments or classrooms where external
code is not permitted without legal approval.</p>
<ul>
<li>The usage of FTP is declining, but some files are still provided over
the FTP protocol or hosters offer FTP to upload content. Therefore,
<code><span>ftplib</span></code> is going to stay.</li>
<li>The <code><span>optparse</span></code> and <code><span>getopt</span></code> modules are widely used. They are mature
modules with very low maintenance overhead.</li>
<li>According to David Beazley <a href="#id40" id="id1">[5]</a> the <code><span>wave</span></code> module is easy to teach to
kids and can make crazy sounds. Making a computer generate sounds is a
powerful and highly motivating exercise for a nine-year-old aspiring developer.
It’s a fun battery to keep.</li>
</ul>
</section>
<section id="deprecation-schedule">
<h2><a href="#deprecation-schedule">Deprecation schedule</a></h2>
<section id="id2">
<h3><a href="#id2">3.11</a></h3>
<p>Starting with Python 3.11, deprecated modules will start issuing
<code><span>DeprecationWarning</span></code>. The estimated EOL of Python 3.10, the last
version without the warning, is October 2026.</p>
</section>
<section id="id3">
<h3><a href="#id3">3.12</a></h3>
<p>There should be no specific change compared to Python 3.11.
This is the last version of Python with the deprecated modules,
with an estimated EOL of October 2028.</p>
</section>
<section id="id4">
<h3><a href="#id4">3.13</a></h3>
<p>All modules deprecated by this PEP are removed from the <code><span>main</span></code> branch
of the CPython repository and are no longer distributed as part of Python.</p>
</section>
</section>
<section id="deprecated-modules">
<h2><a href="#deprecated-modules">Deprecated modules</a></h2>
<p>The modules are grouped as data encoding, multimedia, network, OS interface,
and misc modules. The majority of modules are for old data formats or
old APIs. Some others are rarely useful and have better replacements on
PyPI, e.g. Pillow for image processing or NumPy-based projects to deal with
audio processing.</p>
<table id="id42">
<caption><span>Table 1: Proposed modules deprecations</span></caption>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr><th>Module</th>
<th>Deprecated in</th>
<th>To be removed</th>
<th>Added in</th>
<th>Has maintainer?</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr><td>aifc</td>
<td>3.11 (3.0*)</td>
<td>3.13</td>
<td>1993</td>
<td><strong>yes (inactive)</strong></td>
<td>-</td>
</tr>
<tr><td>asynchat</td>
<td><strong>3.6</strong> (3.0*)</td>
<td>3.12</td>
<td>1999</td>
<td><strong>yes</strong></td>
<td><a href="https://docs.python.org/3/library/hashlib.html">asyncio</a></td>
</tr>
<tr><td>asyncore</td>
<td><strong>3.6</strong> (3.0*)</td>
<td>3.12</td>
<td>1999</td>
<td><strong>yes</strong></td>
<td><a href="https://docs.python.org/3/library/hashlib.html">asyncio</a></td>
</tr>
<tr><td>audioop</td>
<td>3.11 (3.0*)</td>
<td>3.13</td>
<td>1992</td>
<td><strong>yes</strong></td>
<td>-</td>
</tr>
<tr><td>cgi</td>
<td>3.11 (2.0**)</td>
<td>3.13</td>
<td>1995</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>cgitb</td>
<td>3.11 (2.0**)</td>
<td>3.13</td>
<td>1995</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>chunk</td>
<td>3.11</td>
<td>3.13</td>
<td>1999</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>crypt</td>
<td>3.11</td>
<td>3.13</td>
<td>1994</td>
<td><strong>yes (inactive)</strong></td>
<td><a href="https://pypi.org/project/legacycrypt/">legacycrypt</a>, <a href="https://pypi.org/project/bcrypt/">bcrypt</a>, <a href="https://pypi.org/project/argon2-cffi/">argon2-cffi</a>, <a href="https://docs.python.org/3/library/hashlib.html">hashlib</a>, <a href="https://pypi.org/project/passlib/">passlib</a></td>
</tr>
<tr><td>imghdr</td>
<td>3.11</td>
<td>3.13</td>
<td>1992</td>
<td>no</td>
<td><a href="https://pypi.org/project/filetype/">filetype</a>, <a href="https://pypi.org/project/puremagic/">puremagic</a>, <a href="https://pypi.org/project/python-magic/">python-magic</a></td>
</tr>
<tr><td>msilib</td>
<td>3.11</td>
<td>3.13</td>
<td>2006</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>nntplib</td>
<td>3.11</td>
<td>3.13</td>
<td>1992</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>nis</td>
<td>3.8 (3.0*)</td>
<td>3.13</td>
<td>1992</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>ossaudiodev</td>
<td>3.11</td>
<td>3.13</td>
<td>2002</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>pipes</td>
<td>3.11</td>
<td>3.13</td>
<td>1992</td>
<td>no</td>
<td><a href="https://docs.python.org/3/library/subprocess.html">subprocess</a></td>
</tr>
<tr><td>smtpd</td>
<td><strong>3.4.7</strong>, <strong>3.5.4</strong></td>
<td>3.12</td>
<td>2001</td>
<td><strong>yes</strong></td>
<td><a href="https://pypi.org/project/aiosmtpd/">aiosmtpd</a></td>
</tr>
<tr><td>sndhdr</td>
<td>3.11</td>
<td>3.13</td>
<td>1994</td>
<td>no</td>
<td><a href="https://pypi.org/project/filetype/">filetype</a>, <a href="https://pypi.org/project/puremagic/">puremagic</a>, <a href="https://pypi.org/project/python-magic/">python-magic</a></td>
</tr>
<tr><td>spwd</td>
<td>3.11</td>
<td>3.13</td>
<td>2005</td>
<td>no</td>
<td><a href="https://pypi.org/project/python-pam/">python-pam</a></td>
</tr>
<tr><td>sunau</td>
<td>3.11 (3.0*)</td>
<td>3.13</td>
<td>1993</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>telnetlib</td>
<td>3.11 (3.0*)</td>
<td>3.13</td>
<td>1997</td>
<td>no</td>
<td><a href="https://pypi.org/project/telnetlib3/">telnetlib3</a>, <a href="https://pypi.org/project/Exscript/">Exscript</a></td>
</tr>
<tr><td>uu</td>
<td>3.11</td>
<td>3.13</td>
<td>1994</td>
<td>no</td>
<td>-</td>
</tr>
<tr><td>xdrlib</td>
<td>3.11</td>
<td>3.13</td>
<td>1992/1996</td>
<td>no</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>Some module deprecations proposed by <a href="https://peps.python.org/pep-3108" title="PEP 3108 – Standard Library Reorganization">PEP 3108</a> for 3.0 and <a href="https://peps.python.org/pep-0206" title="PEP 206 – Python Advanced Library">PEP 206</a> for
2.0. The <em>added in</em> column illustrates, when a module was originally designed
and added to the standard library. The <em>has maintainer</em> column refers to the
<a href="https://devguide.python.org/experts/">expert index</a>, a list of domain
experts and maintainers in the DevGuide.</p>
<section id="data-encoding-modules">
<h3><a href="#data-encoding-modules">Data encoding modules</a></h3>
<section id="uu-and-the-uu-encoding">
<h4><a href="#uu-and-the-uu-encoding">uu and the uu encoding</a></h4>
<p>The <a href="https://docs.python.org/3/library/uu.html">uu</a> module provides
uuencode format, an old binary encoding format for email from 1980. The uu
format has been replaced by MIME. The uu codec is provided by the <code><span>binascii</span></code>
module.  There’s also <code><span>encodings/uu_codec.py</span></code> which is a codec for the
same encoding; it should also be deprecated.</p>
</section>
<section id="xdrlib">
<h4><a href="#xdrlib">xdrlib</a></h4>
<p>The <a href="https://docs.python.org/3/library/xdrlib.html">xdrlib</a> module supports
the Sun External Data Representation Standard. XDR is an old binary
serialization format from 1987. These days it’s rarely used outside
specialized domains like NFS.</p>
</section>
</section>
<section id="multimedia-modules">
<h3><a href="#multimedia-modules">Multimedia modules</a></h3>
<section id="aifc">
<h4><a href="#aifc">aifc</a></h4>
<p>The <a href="https://docs.python.org/3/library/aifc.html">aifc</a> module provides
support for reading and writing AIFF and AIFF-C files. The Audio Interchange
File Format is an old audio format from 1988 based on Amiga IFF. It was most
commonly used on the Apple Macintosh. These days only few specialized
application use AIFF.</p>
<p>A user disclosed <a href="#id41" id="id7">[6]</a> that the post production film industry makes heavy
use of the AIFC file format. The usage of the <code><span>aifc</span></code> module in closed source
and internal software was unknown prior to the first posting of this PEP. This
may be a compelling argument to keep the <code><span>aifc</span></code> module in the standard
library. The file format is stable and the module does not require much
maintenance. The strategic benefits for Python may outmatch the burden.</p>
</section>
<section id="audioop">
<h4><a href="#audioop">audioop</a></h4>
<p>The <a href="https://docs.python.org/3/library/audioop.html">audioop</a> module
contains helper functions to manipulate raw audio data and adaptive
differential pulse-code modulated audio data. The module is implemented in
C without any additional dependencies. The <a href="https://docs.python.org/3/library/aifc.html">aifc</a>, <a href="https://docs.python.org/3/library/sunau.html">sunau</a>, and <a href="https://docs.python.org/3/library/wave.html">wave</a>
modules depend on <a href="https://docs.python.org/3/library/audioop.html">audioop</a> for some operations.</p>
<p>The byteswap operation in the <code><span>wave</span></code> module can be substituted with little
extra work. In case <code><span>aifc</span></code> is not deprecated as well, a reduced version of
the <code><span>audioop</span></code> module is converted into a private implementation detail,
e.g. <code><span>_audioop</span></code> with <code><span>byteswap</span></code>, <code><span>alaw2lin</span></code>, <code><span>ulaw2lin</span></code>, <code><span>lin2alaw</span></code>,
<code><span>lin2ulaw</span></code>, and <code><span>lin2adpcm</span></code>.</p>
</section>
<section id="chunk">
<h4><a href="#chunk">chunk</a></h4>
<p>The <a href="https://docs.python.org/3/library/chunk.html">chunk</a> module provides
support for reading and writing Electronic Arts’ Interchange File Format.
IFF is an old audio file format originally introduced for Commodore and
Amiga. The format is no longer relevant.</p>
</section>
<section id="imghdr">
<h4><a href="#imghdr">imghdr</a></h4>
<p>The <a href="https://docs.python.org/3/library/imghdr.html">imghdr</a> module is a
simple tool to guess the image file format from the first 32 bytes
of a file or buffer. It supports only a limited number of formats and
neither returns resolution nor color depth.</p>
</section>
<section id="ossaudiodev">
<h4><a href="#ossaudiodev">ossaudiodev</a></h4>
<p>The <a href="https://docs.python.org/3/library/ossaudiodev.html">ossaudiodev</a>
module provides support for Open Sound System, an interface to sound
playback and capture devices. OSS was initially free software, but later
support for newer sound devices and improvements were proprietary. Linux
community abandoned OSS in favor of ALSA <a href="#id36" id="id12">[1]</a>. Some operating systems like
OpenBSD and NetBSD provide an incomplete <a href="#id37" id="id13">[2]</a> emulation of OSS.</p>
<p>To best of my knowledge, FreeBSD is the only widespread operating system
that uses Open Sound System as of today. The <code><span>ossaudiodev</span></code> hasn’t seen any
improvements or new features since 2003. All commits since 2003 are
project-wide code cleanups and a couple of bug fixes. It would be beneficial
for both FreeBSD community and core development, if the module would be
maintained and distributed by people that care for it and use it.</p>
<p>The standard library used to have more audio-related modules. The other
audio device interfaces (<code><span>audiodev</span></code>, <code><span>linuxaudiodev</span></code>, <code><span>sunaudiodev</span></code>)
were removed in 2007 as part of the <a href="https://peps.python.org/pep-3108" title="PEP 3108 – Standard Library Reorganization">PEP 3108</a> stdlib re-organization.</p>
</section>
<section id="sndhdr">
<h4><a href="#sndhdr">sndhdr</a></h4>
<p>The <a href="https://docs.python.org/3/library/sndhdr.html">sndhdr</a> module is
similar to the <a href="https://docs.python.org/3/library/imghdr.html">imghdr</a> module but for audio formats. It guesses file
format, channels, frame rate, and sample widths from the first 512 bytes of
a file or buffer. The module only supports AU, AIFF, HCOM, VOC, WAV, and
other ancient formats.</p>
</section>
<section id="sunau">
<h4><a href="#sunau">sunau</a></h4>
<p>The <a href="https://docs.python.org/3/library/sunau.html">sunau</a> module provides
support for Sun AU sound format. It’s yet another old, obsolete file format.</p>
</section>
</section>
<section id="networking-modules">
<h3><a href="#networking-modules">Networking modules</a></h3>
<section id="asynchat">
<h4><a href="#asynchat">asynchat</a></h4>
<p>The <a href="https://docs.python.org/3/library/asynchat.html">asynchat</a> module
is built on top of <a href="https://docs.python.org/3/library/asyncore.html">asyncore</a> and has been deprecated since Python 3.6.</p>
</section>
<section id="asyncore">
<h4><a href="#asyncore">asyncore</a></h4>
<p>The <a href="https://docs.python.org/3/library/asyncore.html">asyncore</a> module was
the first module for asynchronous socket service clients and servers. It
has been replaced by asyncio and is deprecated since Python 3.6.</p>
<p>The <code><span>asyncore</span></code> module is also used in stdlib tests. The tests for
<code><span>ftplib</span></code>, <code><span>logging</span></code>, <code><span>smptd</span></code>, <code><span>smtplib</span></code>, and <code><span>ssl</span></code> are partly
based on <code><span>asyncore</span></code>. These tests must be updated to use asyncio or
threading.</p>
</section>
<section id="cgi">
<h4><a href="#cgi">cgi</a></h4>
<p>The <a href="https://docs.python.org/3/library/cgi.html">cgi</a> module is a support
module for Common Gateway Interface (CGI) scripts. CGI is deemed as
inefficient because every incoming request is handled in a new process.
<a href="https://peps.python.org/pep-0206" title="PEP 206 – Python Advanced Library">PEP 206</a> considers the module as:</p>
<blockquote>
<p>“[…] designed poorly and are now near-impossible to fix (<code><span>cgi</span></code>) […]”</p></blockquote>
<p>Replacements for the various parts of <code><span>cgi</span></code> which are not directly
related to executing code are:</p>
<ul>
<li><code><span>parse</span></code> with <code><span>urllib.parse.parse_qs</span></code> (<code><span>parse</span></code> is just a wrapper)</li>
<li><code><span>parse_header</span></code> with <code><span>email.message.Message</span></code> (see example below)</li>
<li><code><span>parse_multipart</span></code> with <code><span>email.message.Message</span></code> (same MIME RFCs)</li>
<li><code><span>FieldStorage</span></code>/<code><span>MiniFieldStorage</span></code> has no direct replacement, but can
typically be replaced by using <a href="https://pypi.org/project/multipart/">multipart</a> (for <code><span>POST</span></code> and <code><span>PUT</span></code>
requests) or <code><span>urllib.parse.parse_qsl</span></code> (for <code><span>GET</span></code> and <code><span>HEAD</span></code>
requests)</li>
<li><code><span>valid_boundary</span></code> (undocumented) with <code><span>re.compile(&#34;^[</span> <span>-~]{0,200}[!-~]$&#34;)</span></code></li>
</ul>
<p>As an explicit example of how close <code><span>parse_header</span></code> and
<code><span>email.message.Message</span></code> are:</p>
<div><div><pre><span></span><span>&gt;&gt;&gt; </span><span>from</span> <span>cgi</span> <span>import</span> <span>parse_header</span>
<span>&gt;&gt;&gt; </span><span>from</span> <span>email.message</span> <span>import</span> <span>Message</span>
<span>&gt;&gt;&gt; </span><span>parse_header</span><span>(</span><span>h</span><span>)</span>
<span>(&#39;application/json&#39;, {&#39;charset&#39;: &#39;utf8&#39;})</span>
<span>&gt;&gt;&gt; </span><span>m</span> <span>=</span> <span>Message</span><span>()</span>
<span>&gt;&gt;&gt; </span><span>m</span><span>[</span><span>&#39;content-type&#39;</span><span>]</span> <span>=</span> <span>h</span>
<span>&gt;&gt;&gt; </span><span>m</span><span>.</span><span>get_params</span><span>()</span>
<span>[(&#39;application/json&#39;, &#39;&#39;), (&#39;charset&#39;, &#39;utf8&#39;)]</span>
<span>&gt;&gt;&gt; </span><span>m</span><span>.</span><span>get_param</span><span>(</span><span>&#39;charset&#39;</span><span>)</span>
<span>&#39;utf8&#39;</span>
</pre></div>
</div>
</section>
<section id="cgitb">
<h4><a href="#cgitb">cgitb</a></h4>
<p>The <a href="https://docs.python.org/3/library/cgitb.html">cgitb</a> module is a
helper for the <code><span>cgi</span></code> module for configurable tracebacks.</p>
<p>The <code><span>cgitb</span></code> module is not used by any major Python web framework (Django,
Pyramid, Plone, Flask, CherryPy, or Bottle). Only Paste uses it in an
optional debugging middleware.</p>
</section>
<section id="smtpd">
<h4><a href="#smtpd">smtpd</a></h4>
<p>The <a href="https://docs.python.org/3/library/smtpd.html">smtpd</a> module provides
a simple implementation of a SMTP mail server. The module documentation
marks the module as deprecated and recommends <code><span>aiosmtpd</span></code> instead. The
deprecation message was added in releases 3.4.7, 3.5.4, and 3.6.1.</p>
</section>
<section id="nntplib">
<h4><a href="#nntplib">nntplib</a></h4>
<p>The <a href="https://docs.python.org/3/library/nntplib.html">nntplib</a> module
implements the client side of the Network News Transfer Protocol (nntp). News
groups used to be a dominant platform for online discussions. Over the last
two decades, news has been slowly but steadily replaced with mailing lists
and web-based discussion platforms. Twisted is also
<a href="https://twistedmatrix.com/trac/ticket/9405">planning</a> to deprecate NNTP
support and <a href="https://github.com/greenbender/pynntp">pynntp</a> hasn’t seen any
activity since 2014. This is a good indicator that the public interest in
NNTP support is declining.</p>
<p>The <code><span>nntplib</span></code> tests have been the cause of additional work in the recent
past. Python only contains the client side of NNTP, so the tests connect to
external news servers. The servers are sometimes unavailable, too slow, or do
not work correctly over IPv6. The situation causes flaky test runs on
buildbots.</p>
</section>
<section id="telnetlib">
<h4><a href="#telnetlib">telnetlib</a></h4>
<p>The <a href="https://docs.python.org/3/library/telnetlib.html">telnetlib</a> module
provides a Telnet class that implements the Telnet protocol.</p>
</section>
</section>
<section id="operating-system-interface">
<h3><a href="#operating-system-interface">Operating system interface</a></h3>
<section id="crypt">
<h4><a href="#crypt">crypt</a></h4>
<p>The <a href="https://docs.python.org/3/library/crypt.html">crypt</a> module implements
password hashing based on the <code><span>crypt(3)</span></code> function from <code><span>libcrypt</span></code> or
<code><span>libxcrypt</span></code> on Unix-like platforms. The algorithms are mostly old, of poor
quality and insecure. Users are discouraged from using them.</p>
<ul>
<li>The module is not available on Windows. Cross-platform applications need
an alternative implementation anyway.</li>
<li>Only DES encryption is guaranteed to be available. DES has an extremely
limited key space of 2**56.</li>
<li>MD5, salted SHA256, salted SHA512, and Blowfish are optional extensions.
SSHA256 and SSHA512 are glibc extensions. Blowfish (bcrypt) is the only
algorithm that is still secure. However it’s in glibc and therefore not
commonly available on Linux.</li>
<li>Depending on the platform, the <code><span>crypt</span></code> module is not thread safe. Only
implementations with <code><span>crypt_r(3)</span></code> are thread safe.</li>
<li>The module was never useful to interact with system user and password
databases. On BSD, macOS, and Linux, all user authentication and
password modification operations must go through PAM (pluggable
authentication module); see the <a href="https://docs.python.org/3/library/spwd.html">spwd</a> deprecation.</li>
</ul>
</section>
<section id="nis">
<h4><a href="#nis">nis</a></h4>
<p>The <a href="https://docs.python.org/3/library/nis.html">nis</a> module provides
NIS/YP support. Network Information Service / Yellow Pages is an old and
deprecated directory service protocol developed by Sun Microsystems. Its
designed successor NIS+ from 1992 never took off. For a long time, libc’s
Name Service Switch, LDAP, and Kerberos/GSSAPI have been considered a more powerful
and more secure replacement for NIS.</p>
</section>
<section id="spwd">
<h4><a href="#spwd">spwd</a></h4>
<p>The <a href="https://docs.python.org/3/library/spwd.html">spwd</a> module provides
direct access to Unix shadow password database using non-standard APIs.</p>
<p>In general, it’s a bad idea to use <code><span>spwd</span></code>. It circumvents system
security policies, does not use the PAM stack, and is only compatible
with local user accounts, because it ignores NSS. The use of the <code><span>spwd</span></code>
module for access control must be considered a <em>security bug</em>, as it bypasses
PAM’s access control.</p>
<p>Furthermore, the <code><span>spwd</span></code> module uses the
<a href="http://man7.org/linux/man-pages/man3/shadow.3.html">shadow(3)</a> APIs.
Functions like <code><span>getspnam(3)</span></code> access the <code><span>/etc/shadow</span></code> file directly. This
is dangerous and even forbidden for confined services on systems with a
security engine like SELinux or AppArmor.</p>
</section>
</section>
<section id="misc-modules">
<h3><a href="#misc-modules">Misc modules</a></h3>
<section id="msilib">
<h4><a href="#msilib">msilib</a></h4>
<p>The <a href="https://docs.python.org/3/library/msilib.html">msilib</a> package is a
Windows-only package. It supports the creation of Microsoft Installers (MSI).
The package also exposes additional APIs to create cabinet files (CAB). The
module is used to facilitate distutils to create MSI installers with the
<code><span>bdist_msi</span></code> command. In the past it was used to create CPython’s official
Windows installer, too.</p>
<p>Microsoft is slowly moving away from MSI in favor of Windows 10 Apps (AppX)
as a new deployment model <a href="#id38" id="id27">[3]</a>.</p>
</section>
<section id="pipes">
<h4><a href="#pipes">pipes</a></h4>
<p>The <a href="https://docs.python.org/3/library/pipes.html">pipes</a> module provides
helpers to pipe the input of one command into the output of another command.
The module is built on top of <code><span>os.popen</span></code>. Users are encouraged to use
the <code><span>subprocess</span></code> module instead.</p>
</section>
</section>
</section>
<section id="modules-to-keep">
<h2><a href="#modules-to-keep">Modules to keep</a></h2>
<p>Some modules were originally proposed for deprecation but are no longer
listed as such in this PEP.</p>
<table id="id43">
<caption><span>Table 2: Withdrawn deprecations</span></caption>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr><th>Module</th>
<th>Deprecated in</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr><td>colorsys</td>
<td>-</td>
<td>colormath, colour, colorspacious, Pillow</td>
</tr>
<tr><td>fileinput</td>
<td>-</td>
<td>argparse</td>
</tr>
<tr><td>getopt</td>
<td>-</td>
<td>argparse, optparse</td>
</tr>
<tr><td>optparse</td>
<td><strong>3.2</strong></td>
<td>argparse</td>
</tr>
<tr><td>wave</td>
<td>-</td>
<td></td>
</tr>
</tbody>
</table>
<section id="colorsys">
<h3><a href="#colorsys">colorsys</a></h3>
<p>The <a href="https://docs.python.org/3/library/colorsys.html">colorsys</a> module
defines color conversion functions between RGB, YIQ, HSL, and HSV coordinate
systems.</p>
<p>Walter Dörwald, Petr Viktorin, and others requested to keep <code><span>colorsys</span></code>. The
module is useful to convert CSS colors between coordinate systems. The
implementation is simple, mature, and does not impose maintenance overhead
on core development.</p>
<p>The PyPI packages <code><span>colormath</span></code>, <code><span>colour</span></code>, and <code><span>colorspacious</span></code> provide more and
advanced features. The Pillow library is better suited to transform images
between color systems.</p>
</section>
<section id="fileinput">
<h3><a href="#fileinput">fileinput</a></h3>
<p>The <a href="https://docs.python.org/3/library/fileinput.html">fileinput</a> module
implements helpers to iterate over a list of files from <code><span>sys.argv</span></code>. The
module predates the <code><span>optparse</span></code> and <code><span>argparse</span></code> modules. The same functionality
can be implemented with the <code><span>argparse</span></code> module.</p>
<p>Several core developers expressed their interest to keep the module in the
standard library, as it is handy for quick scripts.</p>
</section>
<section id="getopt">
<h3><a href="#getopt">getopt</a></h3>
<p>The <a href="https://docs.python.org/3/library/getopt.html">getopt</a> module mimics
C’s <code><span>getopt()</span></code> option parser.</p>
<p>Although users are encouraged to use <code><span>argparse</span></code> instead, the <code><span>getopt</span></code> module is
still widely used. The module is small, simple, and handy for C developers
to write simple Python scripts.</p>
</section>
<section id="optparse">
<h3><a href="#optparse">optparse</a></h3>
<p>The <a href="https://docs.python.org/3/library/optparse.html">optparse</a> module is
the predecessor of the <code><span>argparse</span></code> module.</p>
<p>Although it has been deprecated for many years, it’s still too widely used
to remove it.</p>
</section>
<section id="wave">
<h3><a href="#wave">wave</a></h3>
<p>The <a href="https://docs.python.org/3/library/wave.html">wave</a> module provides
support for the WAV sound format.</p>
<p>The module is not deprecated, because the WAV format is still relevant these
days. The <code><span>wave</span></code> module is also used in education, e.g. to show kids how
to make noise with a computer.</p>
<p>The module uses one simple function from the <a href="https://docs.python.org/3/library/audioop.html">audioop</a> module to perform
byte swapping between little and big endian formats. Before 24 bit WAV
support was added, byte swap used to be implemented with the <code><span>array</span></code>
module. To remove <code><span>wave</span></code>’s dependency on <code><span>audioop</span></code>, the byte swap
function could be either be moved to another module (e.g. <code><span>operator</span></code>) or
the <code><span>array</span></code> module could gain support for 24-bit (3-byte) arrays.</p>
</section>
</section>
<section id="discussions">
<h2><a href="#discussions">Discussions</a></h2>
<ul>
<li>Elana Hashman and Nick Coghlan suggested to keep the <code><span>getopt</span></code> module.</li>
<li>Berker Peksag proposed to deprecate and remove <code><span>msilib</span></code>.</li>
<li>Brett Cannon recommended to delay active deprecation warnings and removal
of modules like <code><span>imp</span></code> until Python 3.10. Version 3.8 will be released
shortly before Python 2 reaches end-of-life. A delay reduced churn for
users that migrate from Python 2 to 3.8.</li>
<li>At one point, distutils was mentioned in the same sentence as this PEP.
To avoid lengthy discussion and delay of the PEP, I decided against dealing
with distutils. Deprecation of the distutils package will be handled by
another PEP.</li>
<li>Multiple people (Gregory P. Smith, David Beazley, Nick Coghlan, …)
convinced me to keep the <a href="https://docs.python.org/3/library/wave.html">wave</a> module. <a href="#id39" id="id34">[4]</a></li>
<li>Gregory P. Smith proposed to deprecate <a href="https://docs.python.org/3/library/nntplib.html">nntplib</a>. <a href="#id39" id="id35">[4]</a></li>
<li>Andrew Svetlov mentioned the <code><span>socketserver</span></code> module is questionable.
However it’s used to implement <code><span>http.server</span></code> and <code><span>xmlrpc.server</span></code>. The
stdlib doesn’t have a replacement for the servers, yet.</li>
</ul>
</section>
<section id="rejected-ideas">
<h2><a href="#rejected-ideas">Rejected ideas</a></h2>
<section id="creating-maintaining-a-separate-repo-for-the-deprecated-modules">
<h3><a href="#creating-maintaining-a-separate-repo-for-the-deprecated-modules">Creating/maintaining a separate repo for the deprecated modules</a></h3>
<p>It was previously proposed to create a separate repository containing the
deprecated modules packaged for installation. One of the PEP authors went so far
as to create a <a href="https://github.com/tiran/legacylib">demo repository</a> . In the
end, though, it was decided that the added workload to create and maintain such
a repo officially wasn’t justified, as the source code will continue to be
available in the CPython repository for people to vendor as necessary. Similar
work has also not been done when previous modules were deprecated and removed,
and it seemingly wasn’t an undue burden on the community.</p>
</section>
</section>
<section id="update-history">
<h2><a href="#update-history">Update history</a></h2>
<section id="update-1">
<h3><a href="#update-1">Update 1</a></h3>
<ul>
<li>Deprecate <code><span>parser</span></code> module</li>
<li>Keep <a href="https://docs.python.org/3/library/fileinput.html">fileinput</a> module</li>
<li>Elaborate why <code><span>crypt</span></code> and <code><span>spwd</span></code> are dangerous and bad</li>
<li>Improve sections for <a href="https://docs.python.org/3/library/cgitb.html">cgitb</a>, <a href="https://docs.python.org/3/library/colorsys.html">colorsys</a>, <a href="https://docs.python.org/3/library/nntplib.html">nntplib</a>, and <a href="https://docs.python.org/3/library/smtpd.html">smtpd</a> modules</li>
<li>The <a href="https://docs.python.org/3/library/colorsys.html">colorsys</a>, <code><span>crypt</span></code>, <a href="https://docs.python.org/3/library/imghdr.html">imghdr</a>, <a href="https://docs.python.org/3/library/sndhdr.html">sndhdr</a>, and <code><span>spwd</span></code> sections now
list suitable substitutions</li>
<li>Mention that <code><span>socketserver</span></code> is going to stay for <code><span>http.server</span></code> and
<code><span>xmlrpc.server</span></code></li>
<li>The future maintenance section now states that the deprecated modules
may be adopted by Python community members</li>
</ul>
</section>
<section id="update-2">
<h3><a href="#update-2">Update 2</a></h3>
<ul>
<li>Keep <code><span>colorsys</span></code> module</li>
<li>Add experts</li>
<li>Redirect discussions to discuss.python.org</li>
<li>Deprecate <a href="https://docs.python.org/3/library/telnetlib.html">telnetlib</a></li>
<li>Deprecate compat32 policy of <code><span>email</span></code> package</li>
<li>Add creation year to overview table</li>
<li>Mention <a href="https://peps.python.org/pep-0206" title="PEP 206 – Python Advanced Library">PEP 206</a> and <a href="https://peps.python.org/pep-3108" title="PEP 3108 – Standard Library Reorganization">PEP 3108</a></li>
<li>Update sections for <code><span>aifc</span></code>, <code><span>audioop</span></code>, <code><span>cgi</span></code>, and <code><span>wave</span></code>.</li>
</ul>
</section>
<section id="update-3">
<h3><a href="#update-3">Update 3</a></h3>
<ul>
<li>Keep the legacy email API modules.  Internal deprecations will be
handled separately.</li>
</ul>
</section>
<section id="update-4">
<h3><a href="#update-4">Update 4</a></h3>
<ul>
<li>Add Brett as a co-author.</li>
<li>Retarget the PEP for Python 3.11.</li>
<li>Examples of how to replace the relevant parts of <code><span>cgi</span></code>
(thanks Martijn Pieters).</li>
</ul>
</section>
</section>
<section id="references">
<h2><a href="#references">References</a></h2>

</section>
<section id="copyright">
<h2><a href="#copyright">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section></div>
  </body>
</html>
