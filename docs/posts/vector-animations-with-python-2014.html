<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://zulko.github.io/blog/2014/09/20/vector-animations-with-python/">Original</a>
    <h1>Vector Animations with Python (2014)</h1>
    
    <div id="readability-page-1" class="page"><div><!-- more -->

<p>I am a big fan of <a href="https://dribbble.com/beesandbombs">Dave Whyte</a>’s vector animations, like this one:</p>

<p><img src="https://d13yacurqjgara.cloudfront.net/users/583436/screenshots/1692659/spiral.gif" width="400"/></p>

<p>It was generated using a special animation language called <a href="http://www.processing.org/">Processing</a> (here is <a href="https://dribbble.com/shots/1692659-Shell-Spiral/attachments/268926">Dave’s code</a>). While it seems powerful, Processing it is not very elegant in my opinion ; this post shows how to do similar animations using two Python libraries, <a href="https://github.com/Zulko/gizeh">Gizeh</a> (for the graphics) and <a href="http://zulko.github.io/moviepy">MoviePy</a> (for the animations).</p>

<h2 id="gizeh-and-moviepy">Gizeh and Moviepy</h2>

<p>Gizeh is a Python library I wrote on top of <code>cairocffi</code> ( a binding of the popular Cairo library) to make it more intuitive. To make a picture with Gizeh you create a <em>surface</em>, draw on it, and export it:</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
</pre></td><td><pre><code><span><span>import</span> <span>gizeh</span>
</span><span><span>surface</span> <span>=</span> <span>gizeh</span><span>.</span><span>Surface</span><span>(</span><span>width</span><span>=</span><span>320</span><span>,</span> <span>height</span><span>=</span><span>260</span><span>)</span> <span># dimensions in pixel</span>
</span><span><span>circle</span> <span>=</span> <span>gizeh</span><span>.</span><span>circle</span> <span>(</span><span>r</span><span>=</span><span>40</span><span>,</span> <span># radius, in pixels</span>
</span><span>                       <span>xy</span><span>=</span> <span>[</span><span>156</span><span>,</span> <span>200</span><span>],</span> <span># coordinates of the center</span>
</span><span>                       <span>fill</span><span>=</span> <span>(</span><span>1</span><span>,</span><span>0</span><span>,</span><span>0</span><span>))</span> <span># &#39;red&#39; in RGB coordinates</span>
</span><span><span>circle</span><span>.</span><span>draw</span><span>(</span> <span>surface</span> <span>)</span> <span># draw the circle on the surface</span>
</span><span><span>surface</span><span>.</span><span>get_npimage</span><span>()</span> <span># export as a numpy array (we will use that)</span>
</span><span><span>surface</span><span>.</span><span>write_to_png</span><span>(</span><span>&#34;my_drawing.png&#34;</span><span>)</span> <span># export as a PNG</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<p>We obtain this magnificent Japanese flag:
<img src="http://zulko.github.io/images/vector_animations/my_drawing.png"/></p>

<p>To make an animation with MoviePy, you write a function <code>make_frame</code> which, given some time <code>t</code>, returns the video frame at time <code>t</code>:</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
</pre></td><td><pre><code><span><span>from</span> <span>moviepy.editor</span> <span>import</span> <span>VideoClip</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>&#34;&#34;&#34; returns a numpy array of the frame at time t &#34;&#34;&#34;</span>
</span><span>    <span># ... here make a frame_for_time_t</span>
</span><span>    <span>return</span> <span>frame_for_time_t</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>3</span><span>)</span> <span># 3-second clip</span>
</span><span><span>clip</span><span>.</span><span>write_videofile</span><span>(</span><span>&#34;my_animation.mp4&#34;</span><span>,</span> <span>fps</span><span>=</span><span>24</span><span>)</span> <span># export as video</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;my_animation.gif&#34;</span><span>,</span> <span>fps</span><span>=</span><span>24</span><span>)</span> <span># export as GIF</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-1">Example 1</h2>

<p><img src="http://i.imgur.com/HRDUHf9.gif"/></p>

<p>We start with an easy one. In <code>make_frame</code> we just draw a red circle, whose radius depends on the time <code>t</code>:</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
</pre></td><td><pre><code><span><span>import</span> <span>gizeh</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>128</span><span>,</span><span>128</span> <span># width, height, in pixels</span>
</span><span><span>duration</span> <span>=</span> <span>2</span> <span># duration of the clip, in seconds</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gizeh</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>radius</span> <span>=</span> <span>W</span><span>*</span><span>(</span><span>1</span><span>+</span> <span>(</span><span>t</span><span>*</span><span>(</span><span>duration</span><span>-</span><span>t</span><span>))</span><span>**</span><span>2</span> <span>)</span><span>/</span><span>6</span>
</span><span>    <span>circle</span> <span>=</span> <span>gizeh</span><span>.</span><span>circle</span><span>(</span><span>radius</span><span>,</span> <span>xy</span> <span>=</span> <span>(</span><span>W</span><span>/</span><span>2</span><span>,</span><span>H</span><span>/</span><span>2</span><span>),</span> <span>fill</span><span>=</span><span>(</span><span>1</span><span>,</span><span>0</span><span>,</span><span>0</span><span>))</span>
</span><span>    <span>circle</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>duration</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;circle.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>,</span> <span>fuzz</span><span>=</span><span>10</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-2">Example 2</h2>

<p><img src="http://i.imgur.com/rlrOFg4.gif"/></p>

<p>Now there are more circles, and we start to see the interest of making animations programmatically using <code>for</code> loops. The useful function <code>polar2cart</code> transforms polar coordinates (radius, angle) into cartesian coordinates (x,y).</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>128</span><span>,</span><span>128</span>
</span><span><span>duration</span> <span>=</span> <span>2</span>
</span><span><span>ncircles</span> <span>=</span> <span>20</span> <span># Number of circles</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>
</span><span>    <span>surface</span> <span>=</span> <span>gizeh</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>
</span><span>    <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>ncircles</span><span>):</span>
</span><span>        <span>angle</span> <span>=</span> <span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>(</span><span>1.0</span><span>*</span><span>i</span><span>/</span><span>ncircles</span><span>+</span><span>t</span><span>/</span><span>duration</span><span>)</span>
</span><span>        <span>center</span> <span>=</span> <span>W</span><span>*</span><span>(</span> <span>0.5</span><span>+</span> <span>gizeh</span><span>.</span><span>polar2cart</span><span>(</span><span>0.1</span><span>,</span><span>angle</span><span>))</span>
</span><span>        <span>circle</span> <span>=</span> <span>gizeh</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=</span> <span>W</span><span>*</span><span>(</span><span>1.0</span><span>-</span><span>1.0</span><span>*</span><span>i</span><span>/</span><span>ncircles</span><span>),</span>
</span><span>                              <span>xy</span><span>=</span> <span>center</span><span>,</span> <span>fill</span><span>=</span> <span>(</span><span>i</span><span>%</span><span>2</span><span>,</span><span>i</span><span>%</span><span>2</span><span>,</span><span>i</span><span>%</span><span>2</span><span>))</span>
</span><span>        <span>circle</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>duration</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;circles.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>,</span> <span>fuzz</span><span>=</span><span>10</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-3">Example 3</h2>

<p><img src="http://i.imgur.com/E1vjoRq.gif"/></p>

<p>Here we fill the circles with a slightly excentred radial gradient to give and impression of volume. The colors, initial positions and centers of rotations of the circles are chosen randomly at the beginning.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
</pre></td><td><pre><code><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span> <span>=</span> <span>H</span> <span>=</span> <span>150</span>
</span><span><span>D</span> <span>=</span> <span>2</span> <span># duration</span>
</span><span><span>nballs</span><span>=</span><span>60</span>
</span><span>
</span><span><span># generate random values of radius, color, center</span>
</span><span><span>radii</span> <span>=</span> <span>np</span><span>.</span><span>random</span><span>.</span><span>randint</span><span>(</span><span>.</span><span>1</span><span>*</span><span>W</span><span>,</span><span>.</span><span>2</span><span>*</span><span>W</span><span>,</span> <span>nballs</span><span>)</span>
</span><span><span>colors</span> <span>=</span> <span>np</span><span>.</span><span>random</span><span>.</span><span>rand</span><span>(</span><span>nballs</span><span>,</span><span>3</span><span>)</span>
</span><span><span>centers</span> <span>=</span> <span>np</span><span>.</span><span>random</span><span>.</span><span>randint</span><span>(</span><span>0</span><span>,</span><span>W</span><span>,</span> <span>(</span><span>nballs</span><span>,</span><span>2</span><span>))</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>for</span> <span>r</span><span>,</span><span>color</span><span>,</span> <span>center</span> <span>in</span> <span>zip</span><span>(</span><span>radii</span><span>,</span> <span>colors</span><span>,</span> <span>centers</span><span>):</span>
</span><span>        <span>angle</span> <span>=</span> <span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>(</span><span>t</span><span>/</span><span>D</span><span>*</span><span>np</span><span>.</span><span>sign</span><span>(</span><span>color</span><span>[</span><span>0</span><span>]</span><span>-.</span><span>5</span><span>)</span><span>+</span><span>color</span><span>[</span><span>1</span><span>])</span>
</span><span>        <span>xy</span> <span>=</span> <span>center</span><span>+</span><span>gz</span><span>.</span><span>polar2cart</span><span>(</span><span>W</span><span>/</span><span>5</span><span>,</span><span>angle</span><span>)</span> <span># center of the ball</span>
</span><span>        <span>gradient</span> <span>=</span> <span>gz</span><span>.</span><span>ColorGradient</span><span>(</span><span>type</span><span>=</span><span>&#34;radial&#34;</span><span>,</span>
</span><span>                     <span>stops_colors</span> <span>=</span> <span>[(</span><span>0</span><span>,</span><span>color</span><span>),(</span><span>1</span><span>,</span><span>color</span><span>/</span><span>10</span><span>)],</span>
</span><span>                     <span>xy1</span><span>=</span><span>[</span><span>0.3</span><span>,</span><span>-</span><span>0.3</span><span>],</span> <span>xy2</span><span>=</span><span>[</span><span>0</span><span>,</span><span>0</span><span>],</span> <span>xy3</span> <span>=</span> <span>[</span><span>0</span><span>,</span><span>1.4</span><span>])</span>
</span><span>        <span>ball</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=</span><span>1</span><span>,</span> <span>fill</span><span>=</span><span>gradient</span><span>)</span><span>.</span><span>scale</span><span>(</span><span>r</span><span>)</span><span>.</span><span>translate</span><span>(</span><span>xy</span><span>)</span>
</span><span>        <span>ball</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>D</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;balls.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span><span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-4">Example 4</h2>

<p><img src="http://i.imgur.com/sM5Oftz.gif"/></p>

<p>The shadow is done using a circle with radial fading black gradient whose intensity diminishes when the ball is higher, for more realism (?). The shadow is then squeezed vertically using <code>scale(r,r/2)</code>, so that its width is twice its height.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
<span>31</span>
<span>32</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>200</span><span>,</span><span>75</span>
</span><span><span>D</span> <span>=</span> <span>3</span>
</span><span><span>r</span> <span>=</span> <span>10</span> <span># radius of the ball</span>
</span><span><span>DJ</span><span>,</span> <span>HJ</span> <span>=</span> <span>50</span><span>,</span> <span>35</span> <span># distance and height of the jumps</span>
</span><span><span>ground</span> <span>=</span> <span>0.75</span><span>*</span><span>H</span> <span># y-coordinate of the ground</span>
</span><span>
</span><span>
</span><span><span>gradient</span> <span>=</span> <span>gz</span><span>.</span><span>ColorGradient</span><span>(</span><span>type</span><span>=</span><span>&#34;radial&#34;</span><span>,</span>
</span><span>                <span>stops_colors</span> <span>=</span> <span>[(</span><span>0</span><span>,(</span><span>1</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)),(</span><span>1</span><span>,(</span><span>0.1</span><span>,</span><span>0</span><span>,</span><span>0</span><span>))],</span>
</span><span>                <span>xy1</span><span>=</span><span>[</span><span>0.3</span><span>,</span><span>-</span><span>0.3</span><span>],</span> <span>xy2</span><span>=</span><span>[</span><span>0</span><span>,</span><span>0</span><span>],</span> <span>xy3</span> <span>=</span> <span>[</span><span>0</span><span>,</span><span>1.4</span><span>])</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>,</span> <span>bg_color</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))</span>
</span><span>    <span>x</span> <span>=</span> <span>(</span><span>-</span><span>W</span><span>/</span><span>3</span><span>)</span><span>+</span><span>(</span><span>5</span><span>*</span><span>W</span><span>/</span><span>3</span><span>)</span><span>*</span><span>(</span><span>t</span><span>/</span><span>D</span><span>)</span>
</span><span>    <span>y</span> <span>=</span> <span>ground</span> <span>-</span> <span>HJ</span><span>*</span><span>4</span><span>*</span><span>(</span><span>x</span> <span>%</span> <span>DJ</span><span>)</span><span>*</span><span>(</span><span>DJ</span><span>-</span><span>(</span><span>x</span> <span>%</span> <span>DJ</span><span>))</span><span>/</span><span>DJ</span><span>**</span><span>2</span>
</span><span>    <span>coef</span> <span>=</span> <span>(</span><span>HJ</span><span>-</span><span>y</span><span>)</span><span>/</span><span>HJ</span>
</span><span>    <span>shadow_gradient</span> <span>=</span> <span>gz</span><span>.</span><span>ColorGradient</span><span>(</span><span>type</span><span>=</span><span>&#34;radial&#34;</span><span>,</span>
</span><span>                <span>stops_colors</span> <span>=</span> <span>[(</span><span>0</span><span>,(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>.</span><span>2</span><span>-</span><span>coef</span><span>/</span><span>5</span><span>)),(</span><span>1</span><span>,(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>))],</span>
</span><span>                <span>xy1</span><span>=</span><span>[</span><span>0</span><span>,</span><span>0</span><span>],</span> <span>xy2</span><span>=</span><span>[</span><span>0</span><span>,</span><span>0</span><span>],</span> <span>xy3</span> <span>=</span> <span>[</span><span>0</span><span>,</span><span>1.4</span><span>])</span>
</span><span>    <span>shadow</span> <span>=</span> <span>(</span><span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=</span><span>(</span><span>1</span><span>-</span><span>coef</span><span>/</span><span>4</span><span>),</span> <span>fill</span><span>=</span><span>shadow_gradient</span><span>)</span>
</span><span>               <span>.</span><span>scale</span><span>(</span><span>r</span><span>,</span><span>r</span><span>/</span><span>2</span><span>)</span><span>.</span><span>translate</span><span>((</span><span>x</span><span>,</span><span>ground</span><span>+</span><span>r</span><span>/</span><span>2</span><span>)))</span>
</span><span>    <span>shadow</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>ball</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=</span><span>1</span><span>,</span> <span>fill</span><span>=</span><span>gradient</span><span>)</span><span>.</span><span>scale</span><span>(</span><span>r</span><span>)</span><span>.</span><span>translate</span><span>((</span><span>x</span><span>,</span><span>y</span><span>))</span>
</span><span>    <span>ball</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>D</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;bouncingball.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>25</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-5">Example 5</h2>

<p><img src="http://i.imgur.com/6rx7SUz.gif"/></p>

<p>This is a derivative of the Dave Whyte animation shown in the introduction. It is made of stacked circles moving towards the picture’s border, with carefully chosen sizes, starting times, and colors (I say <em>carefully chosen</em> because it took me a few dozens random tries). The black around the picture is simply a big circle with no fill and a very very thick black border.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
<span>31</span>
<span>32</span>
<span>33</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>256</span><span>,</span> <span>256</span>
</span><span><span>DURATION</span> <span>=</span> <span>2.0</span>
</span><span><span>NDISKS_PER_CYCLE</span> <span>=</span> <span>8</span>
</span><span><span>SPEED</span> <span>=</span> <span>.</span><span>05</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>
</span><span>    <span>dt</span> <span>=</span> <span>1.0</span><span>*</span><span>DURATION</span><span>/</span><span>2</span><span>/</span><span>NDISKS_PER_CYCLE</span> <span># delay between disks</span>
</span><span>    <span>N</span> <span>=</span> <span>int</span><span>(</span><span>NDISKS_PER_CYCLE</span><span>/</span><span>SPEED</span><span>)</span> <span># total number of disks</span>
</span><span>    <span>t0</span> <span>=</span> <span>1.0</span><span>/</span><span>SPEED</span> <span># indicates at which avancement to start</span>
</span><span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span><span>N</span><span>):</span>
</span><span>        <span>a</span> <span>=</span> <span>(</span><span>np</span><span>.</span><span>pi</span><span>/</span><span>NDISKS_PER_CYCLE</span><span>)</span><span>*</span><span>(</span><span>N</span><span>-</span><span>i</span><span>-</span><span>1</span><span>)</span>
</span><span>        <span>r</span> <span>=</span> <span>np</span><span>.</span><span>maximum</span><span>(</span><span>0</span><span>,</span> <span>.</span><span>05</span><span>*</span><span>(</span><span>t</span><span>+</span><span>t0</span><span>-</span><span>dt</span><span>*</span><span>(</span><span>N</span><span>-</span><span>i</span><span>-</span><span>1</span><span>)))</span>
</span><span>        <span>center</span> <span>=</span> <span>W</span><span>*</span><span>(</span><span>0.5</span><span>+</span> <span>gz</span><span>.</span><span>polar2cart</span><span>(</span><span>r</span><span>,</span><span>a</span><span>))</span>
</span><span>        <span>color</span> <span>=</span> <span>3</span><span>*</span><span>((</span><span>1.0</span><span>*</span><span>i</span><span>/</span><span>NDISKS_PER_CYCLE</span><span>)</span> <span>%</span> <span>1.0</span><span>,)</span>
</span><span>        <span>circle</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=</span><span>0.3</span><span>*</span><span>W</span><span>,</span> <span>xy</span> <span>=</span> <span>center</span><span>,</span><span>fill</span> <span>=</span> <span>color</span><span>,</span>
</span><span>                              <span>stroke_width</span><span>=</span><span>0.01</span><span>*</span><span>W</span><span>)</span>
</span><span>        <span>circle</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>contour1</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=.</span><span>65</span><span>*</span><span>W</span><span>,</span><span>xy</span><span>=</span><span>[</span><span>W</span><span>/</span><span>2</span><span>,</span><span>W</span><span>/</span><span>2</span><span>],</span> <span>stroke_width</span><span>=.</span><span>5</span><span>*</span><span>W</span><span>)</span>
</span><span>    <span>contour2</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>r</span><span>=.</span><span>42</span><span>*</span><span>W</span><span>,</span><span>xy</span><span>=</span><span>[</span><span>W</span><span>/</span><span>2</span><span>,</span><span>W</span><span>/</span><span>2</span><span>],</span> <span>stroke_width</span><span>=.</span><span>02</span><span>*</span><span>W</span><span>,</span>
</span><span>                            <span>stroke</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))</span>
</span><span>    <span>contour1</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>contour2</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>DURATION</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;shutter.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>20</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>,</span> <span>fuzz</span><span>=</span><span>10</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-6">Example 6</h2>

<p><img src="http://i.imgur.com/JAJvFdT.gif"/></p>

<p>You can draw more than circles ! And you can group different elements so that they will move together (here, a letter and a pentagon).</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>300</span><span>,</span> <span>75</span>
</span><span><span>D</span> <span>=</span> <span>2</span> <span># duration in seconds</span>
</span><span><span>r</span> <span>=</span> <span>22</span> <span># size of the letters / pentagons</span>
</span><span>
</span><span><span>gradient</span><span>=</span> <span>gz</span><span>.</span><span>ColorGradient</span><span>(</span><span>&#34;linear&#34;</span><span>,((</span><span>0</span><span>,(</span><span>0</span><span>,</span><span>.</span><span>5</span><span>,</span><span>1</span><span>)),(</span><span>1</span><span>,(</span><span>0</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))),</span>
</span><span>                           <span>xy1</span><span>=</span><span>(</span><span>0</span><span>,</span><span>-</span><span>r</span><span>),</span> <span>xy2</span><span>=</span><span>(</span><span>0</span><span>,</span><span>r</span><span>))</span>
</span><span><span>polygon</span> <span>=</span> <span>gz</span><span>.</span><span>regular_polygon</span><span>(</span><span>r</span><span>,</span> <span>5</span><span>,</span> <span>stroke_width</span><span>=</span><span>3</span><span>,</span> <span>fill</span><span>=</span><span>gradient</span><span>)</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>,</span> <span>bg_color</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))</span>
</span><span>    <span>for</span> <span>i</span><span>,</span> <span>letter</span> <span>in</span> <span>enumerate</span><span>(</span><span>&#34;GIZEH&#34;</span><span>):</span>
</span><span>        <span>angle</span> <span>=</span> <span>max</span><span>(</span><span>0</span><span>,</span><span>min</span><span>(</span><span>1</span><span>,</span><span>2</span><span>*</span><span>t</span><span>/</span><span>D</span><span>-</span><span>1.0</span><span>*</span><span>i</span><span>/</span><span>5</span><span>))</span><span>*</span><span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span>
</span><span>        <span>txt</span> <span>=</span> <span>gz</span><span>.</span><span>text</span><span>(</span><span>letter</span><span>,</span> <span>&#34;Amiri&#34;</span><span>,</span> <span>3</span><span>*</span><span>r</span><span>/</span><span>2</span><span>,</span> <span>fontweight</span><span>=</span><span>&#39;bold&#39;</span><span>)</span>
</span><span>        <span>group</span> <span>=</span> <span>(</span><span>gz</span><span>.</span><span>Group</span><span>([</span><span>polygon</span><span>,</span> <span>txt</span><span>])</span>
</span><span>                 <span>.</span><span>rotate</span><span>(</span><span>angle</span><span>)</span>
</span><span>                 <span>.</span><span>translate</span><span>((</span><span>W</span><span>*</span><span>(</span><span>i</span><span>+</span><span>1</span><span>)</span><span>/</span><span>6</span><span>,</span><span>H</span><span>/</span><span>2</span><span>)))</span>
</span><span>        <span>group</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>D</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;gizeh.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>20</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-7">Example 7</h2>

<p><img src="http://i.imgur.com/dfJ2Skz.gif"/></p>

<p>We start with just a triangle. By rotating this triangle three time we obtain four triangles which fit nicely into a square. Then we copy this square following a checkerboard pattern. Finally we do the same with another color to fill the missing tiles. Now, if the original triangle is rotated, all the triangles on the picture will also be rotated.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
<span>31</span>
<span>32</span>
<span>33</span>
<span>34</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>200</span><span>,</span><span>200</span>
</span><span><span>WSQ</span> <span>=</span> <span>W</span><span>/</span><span>4</span> <span># width of one &#39;square&#39;</span>
</span><span><span>D</span> <span>=</span> <span>2</span> <span># duration</span>
</span><span><span>a</span> <span>=</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>8</span> <span># small angle in one triangle</span>
</span><span><span>points</span> <span>=</span> <span>[(</span><span>0</span><span>,</span><span>0</span><span>),(</span><span>1</span><span>,</span><span>0</span><span>),(</span><span>1</span><span>-</span><span>np</span><span>.</span><span>cos</span><span>(</span><span>a</span><span>)</span><span>**</span><span>2</span><span>,</span><span>np</span><span>.</span><span>sin</span><span>(</span><span>2</span><span>*</span><span>a</span><span>)</span><span>/</span><span>2</span><span>),(</span><span>0</span><span>,</span><span>0</span><span>)]</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>for</span> <span>k</span><span>,</span> <span>(</span><span>c1</span><span>,</span><span>c2</span><span>)</span> <span>in</span> <span>enumerate</span><span>([[(</span><span>.</span><span>7</span><span>,</span><span>0.05</span><span>,</span><span>0.05</span><span>),(</span><span>1</span><span>,</span><span>0.5</span><span>,</span><span>0.5</span><span>)],</span>
</span><span>                                <span>[(</span><span>0.05</span><span>,</span><span>0.05</span><span>,</span><span>.</span><span>7</span><span>),(</span><span>0.5</span><span>,</span><span>0.5</span><span>,</span><span>1</span><span>)]]):</span>
</span><span>
</span><span>        <span>grad</span> <span>=</span> <span>gz</span><span>.</span><span>ColorGradient</span><span>(</span><span>&#34;linear&#34;</span><span>,</span><span>xy1</span><span>=</span><span>(</span><span>0</span><span>,</span><span>0</span><span>),</span> <span>xy2</span> <span>=</span> <span>(</span><span>1</span><span>,</span><span>0</span><span>),</span>
</span><span>                               <span>stops_colors</span><span>=</span> <span>[(</span><span>0</span><span>,</span><span>c1</span><span>),(</span><span>1</span><span>,</span><span>c2</span><span>)])</span>
</span><span>        <span>r</span> <span>=</span> <span>min</span><span>(</span><span>np</span><span>.</span><span>pi</span><span>/</span><span>2</span><span>,</span><span>max</span><span>(</span><span>0</span><span>,</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>(</span><span>t</span><span>-</span><span>D</span><span>/</span><span>3</span><span>)</span><span>/</span><span>D</span><span>))</span>
</span><span>        <span>triangle</span> <span>=</span> <span>gz</span><span>.</span><span>polyline</span><span>(</span><span>points</span><span>,</span><span>xy</span><span>=</span><span>(</span><span>-</span><span>0.5</span><span>,</span><span>0.5</span><span>),</span> <span>fill</span><span>=</span><span>grad</span><span>,</span>
</span><span>                        <span>angle</span><span>=</span><span>r</span><span>,</span> <span>stroke</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>),</span> <span>stroke_width</span><span>=.</span><span>02</span><span>)</span>
</span><span>        <span>square</span> <span>=</span> <span>gz</span><span>.</span><span>Group</span><span>([</span><span>triangle</span><span>.</span><span>rotate</span><span>(</span><span>i</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>/</span><span>2</span><span>)</span>
</span><span>                              <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>4</span><span>)])</span>
</span><span>        <span>squares</span> <span>=</span> <span>(</span><span>gz</span><span>.</span><span>Group</span><span>([</span><span>square</span><span>.</span><span>translate</span><span>((</span><span>2</span><span>*</span><span>i</span><span>+</span><span>j</span><span>+</span><span>k</span><span>,</span><span>j</span><span>))</span>
</span><span>                            <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>-</span><span>3</span><span>,</span><span>4</span><span>)</span>
</span><span>                            <span>for</span> <span>j</span> <span>in</span> <span>range</span><span>(</span><span>-</span><span>3</span><span>,</span><span>4</span><span>)])</span>
</span><span>                   <span>.</span><span>scale</span><span>(</span><span>WSQ</span><span>)</span>
</span><span>                   <span>.</span><span>translate</span><span>((</span><span>W</span><span>/</span><span>2</span><span>-</span><span>WSQ</span><span>*</span><span>t</span><span>/</span><span>D</span><span>,</span><span>H</span><span>/</span><span>2</span><span>)))</span>
</span><span>
</span><span>        <span>squares</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>=</span><span>make_frame</span><span>)</span><span>.</span><span>set_duration</span><span>(</span><span>D</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;blueradsquares.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>fuzz</span><span>=</span><span>30</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-8">Example 8</h2>

<p><img src="http://i.imgur.com/79tTac9.gif"/></p>

<p>A nice thing to do with vector graphics is fractals. We first build a ying-yang, then we use this ying-yang as the dots of a bigger ying-yang, and we use the bigger ying-yang as the dots of an even bigger ying yang etc. In the end we go one level deep into the imbricated ying-yangs, and we start zooming.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
<span>31</span>
<span>32</span>
<span>33</span>
<span>34</span>
<span>35</span>
<span>36</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>256</span><span>,</span><span>256</span>
</span><span><span>R</span><span>=</span><span>1.0</span><span>*</span><span>W</span><span>/</span><span>3</span>
</span><span><span>D</span> <span>=</span> <span>4</span>
</span><span><span>yingyang</span> <span>=</span> <span>gz</span><span>.</span><span>Group</span><span>(</span> <span>[</span>
</span><span>      <span>gz</span><span>.</span><span>arc</span><span>(</span><span>R</span><span>,</span><span>0</span><span>,</span><span>np</span><span>.</span><span>pi</span><span>,</span> <span>fill</span><span>=</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)),</span>
</span><span>      <span>gz</span><span>.</span><span>arc</span><span>(</span><span>R</span><span>,</span><span>-</span><span>np</span><span>.</span><span>pi</span><span>,</span><span>0</span><span>,</span> <span>fill</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)),</span>
</span><span>      <span>gz</span><span>.</span><span>circle</span><span>(</span><span>R</span><span>/</span><span>2</span><span>,</span><span>xy</span><span>=</span><span>(</span><span>-</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>),</span> <span>fill</span><span>=</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)),</span>
</span><span>      <span>gz</span><span>.</span><span>circle</span><span>(</span><span>R</span><span>/</span><span>2</span><span>,</span><span>xy</span><span>=</span><span>(</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>),</span> <span>fill</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))])</span>
</span><span>
</span><span><span>fractal</span> <span>=</span> <span>yingyang</span>
</span><span><span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>5</span><span>):</span>
</span><span>    <span>fractal</span> <span>=</span> <span>gz</span><span>.</span><span>Group</span><span>([</span><span>yingyang</span><span>,</span>
</span><span>                <span>fractal</span><span>.</span><span>rotate</span><span>(</span><span>np</span><span>.</span><span>pi</span><span>)</span><span>.</span><span>scale</span><span>(</span><span>0.25</span><span>)</span><span>.</span><span>translate</span><span>([</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>]),</span>
</span><span>                <span>fractal</span><span>.</span><span>scale</span><span>(</span><span>0.25</span><span>)</span><span>.</span><span>translate</span><span>([</span><span>-</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>]),</span>
</span><span>                <span>gz</span><span>.</span><span>circle</span><span>(</span><span>0.26</span><span>*</span><span>R</span><span>,</span> <span>xy</span><span>=</span><span>(</span><span>-</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>),</span>
</span><span>                    <span>stroke</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>),</span> <span>stroke_width</span><span>=</span><span>1</span><span>),</span>
</span><span>                <span>gz</span><span>.</span><span>circle</span><span>(</span><span>0.26</span><span>*</span><span>R</span><span>,</span> <span>xy</span><span>=</span><span>(</span><span>R</span><span>/</span><span>2</span><span>,</span><span>0</span><span>),</span>
</span><span>                    <span>stroke</span><span>=</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>),</span> <span>stroke_width</span><span>=</span><span>1</span><span>)])</span>
</span><span>
</span><span><span># Go one level deep into the fractal</span>
</span><span><span>fractal</span> <span>=</span> <span>fractal</span><span>.</span><span>translate</span><span>([(</span><span>R</span><span>/</span><span>2</span><span>),</span><span>0</span><span>])</span><span>.</span><span>scale</span><span>(</span><span>4</span><span>)</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>G</span> <span>=</span> <span>2</span><span>**</span><span>(</span><span>2</span><span>*</span><span>(</span><span>t</span><span>/</span><span>D</span><span>))</span> <span># zoom coefficient</span>
</span><span>    <span>(</span><span>fractal</span><span>.</span><span>translate</span><span>([</span><span>R</span><span>*</span><span>2</span><span>*</span><span>(</span><span>1</span><span>-</span><span>1.0</span><span>/</span><span>G</span><span>)</span><span>/</span><span>3</span><span>,</span><span>0</span><span>])</span><span>.</span><span>scale</span><span>(</span><span>G</span><span>)</span> <span># zoom</span>
</span><span>     <span>.</span><span>translate</span><span>(</span><span>W</span><span>/</span><span>2</span><span>+</span><span>gz</span><span>.</span><span>polar2cart</span><span>(</span><span>W</span><span>/</span><span>12</span><span>,</span><span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>t</span><span>/</span><span>D</span><span>))</span> <span># spiral effect</span>
</span><span>     <span>.</span><span>draw</span><span>(</span><span>surface</span><span>))</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>D</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;yingyang.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>fuzz</span><span>=</span><span>30</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-9">Example 9</h2>

<p><img src="http://i.imgur.com/JanwSIf.gif"/></p>

<p>That one is inspired by this <a href="http://33.media.tumblr.com/ff988433be4970277349b0b57ae0abc6/tumblr_nb1fzsolQd1r2geqjo1_500.gif">Dave Whyte animation</a>. We draw white-filled circles, each of these being almost completely transparent so that they only add 1 to the value of the pixels that they cover. Pixels with an even value, which are the pixels covered by an even number of circles, are then painted white, while the others will be black. To complexify and have a nicely-looping animation, we draw two circles in each direction, one being a time-shifted version of the other.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>400</span><span>,</span><span>400</span>
</span><span><span>D</span> <span>=</span> <span>5</span> <span># duration, in seconds</span>
</span><span><span>ncircles</span> <span>=</span> <span>10</span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>for</span> <span>angle</span> <span>in</span> <span>np</span><span>.</span><span>linspace</span><span>(</span><span>0</span><span>,</span><span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>,</span><span>ncircles</span><span>+</span><span>1</span><span>)[:</span><span>-</span><span>1</span><span>]:</span>
</span><span>        <span>center</span> <span>=</span> <span>np</span><span>.</span><span>array</span><span>([</span><span>W</span><span>/</span><span>2</span><span>,</span><span>H</span><span>/</span><span>2</span><span>])</span> <span>+</span> <span>gz</span><span>.</span><span>polar2cart</span><span>(</span><span>.</span><span>2</span><span>*</span><span>W</span><span>,</span><span>angle</span><span>)</span>
</span><span>        <span>for</span> <span>i</span> <span>in</span> <span>[</span><span>0</span><span>,</span><span>1</span><span>]:</span> <span># two circles belongin to two groups</span>
</span><span>            <span>circle</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>W</span><span>*.</span><span>45</span><span>*</span><span>(</span><span>i</span><span>+</span><span>t</span><span>/</span><span>D</span><span>),</span><span>xy</span><span>=</span><span>center</span><span>,</span>
</span><span>                                  <span>fill</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1.0</span><span>/</span><span>255</span><span>))</span>
</span><span>            <span>circle</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>255</span><span>*</span><span>((</span><span>surface</span><span>.</span><span>get_npimage</span><span>()</span><span>+</span><span>1</span><span>)</span> <span>%</span> <span>2</span><span>)</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>D</span><span>)</span><span>.</span><span>resize</span><span>(</span><span>.</span><span>5</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;rose.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>fuzz</span><span>=</span><span>30</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="example-10">Example 10</h2>

<p><img src="http://i.imgur.com/2YdW9yf.gif"/></p>

<p>A pentagon made of rotating squares ! Interestingly, making the squares rotate the other direction creates a very different-looking <a href="http://i.imgur.com/C8IKy28.gif">animation</a>. The squares are placed according to <a href="http://math.stackexchange.com/a/41954/43338">this polar equation</a>.</p>

<p>The difficulty in this animation is that the last square drawn will necessarily be on top of all the others, and not, as it should be, below the first square ! The solution is to draw each frame twice. The first time, we draw the squares starting from the right, so that the faulty square will also be on the right, and we only keep the left part of that picture. The second time we start drawing the squares from the left, so that the faulty square is on the left, and we keep the right part. By assembling the two valid parts we reconstitute a valid picture.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
</pre></td><td><pre><code><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span><span>import</span> <span>colorsys</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span>
</span><span><span>W</span><span>,</span><span>H</span> <span>=</span> <span>256</span><span>,</span><span>256</span>
</span><span><span>NFACES</span><span>,</span> <span>R</span><span>,</span> <span>NSQUARES</span><span>,</span> <span>DURATION</span> <span>=</span> <span>5</span><span>,</span> <span>0.3</span><span>,</span>  <span>100</span><span>,</span> <span>2</span>
</span><span>
</span><span><span>def</span> <span>half</span><span>(</span><span>t</span><span>,</span> <span>side</span><span>=</span><span>&#34;left&#34;</span><span>):</span>
</span><span>    <span>points</span> <span>=</span> <span>gz</span><span>.</span><span>geometry</span><span>.</span><span>polar_polygon</span><span>(</span><span>NFACES</span><span>,</span> <span>R</span><span>,</span> <span>NSQUARES</span><span>)</span>
</span><span>    <span>ipoint</span> <span>=</span> <span>0</span> <span>if</span> <span>side</span><span>==</span><span>&#34;left&#34;</span> <span>else</span> <span>NSQUARES</span><span>/</span><span>2</span>
</span><span>    <span>points</span> <span>=</span> <span>(</span><span>points</span><span>[</span><span>ipoint</span><span>:]</span><span>+</span><span>points</span><span>[:</span><span>ipoint</span><span>])[::</span><span>-</span><span>1</span><span>]</span>
</span><span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>W</span><span>,</span><span>H</span><span>)</span>
</span><span>    <span>for</span> <span>(</span><span>r</span><span>,</span> <span>th</span><span>,</span> <span>d</span><span>)</span> <span>in</span> <span>points</span><span>:</span>
</span><span>        <span>center</span> <span>=</span> <span>W</span><span>*</span><span>(</span><span>0.5</span><span>+</span><span>gz</span><span>.</span><span>polar2cart</span><span>(</span><span>r</span><span>,</span><span>th</span><span>))</span>
</span><span>        <span>angle</span> <span>=</span> <span>-</span><span>(</span><span>6</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>d</span> <span>+</span> <span>t</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>/</span><span>DURATION</span><span>)</span>
</span><span>        <span>color</span><span>=</span> <span>colorsys</span><span>.</span><span>hls_to_rgb</span><span>((</span><span>2</span><span>*</span><span>d</span><span>+</span><span>t</span><span>/</span><span>DURATION</span><span>)</span><span>%</span><span>1</span><span>,</span><span>.</span><span>5</span><span>,</span><span>.</span><span>5</span><span>)</span>
</span><span>        <span>square</span> <span>=</span> <span>gz</span><span>.</span><span>square</span><span>(</span><span>l</span><span>=</span><span>0.17</span><span>*</span><span>W</span><span>,</span> <span>xy</span><span>=</span> <span>center</span><span>,</span> <span>angle</span><span>=</span><span>angle</span><span>,</span>
</span><span>                   <span>fill</span><span>=</span><span>color</span><span>,</span> <span>stroke_width</span><span>=</span> <span>0.005</span><span>*</span><span>W</span><span>,</span> <span>stroke</span><span>=</span><span>(</span><span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>))</span>
</span><span>        <span>square</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>im</span> <span>=</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>    <span>return</span> <span>(</span><span>im</span><span>[:,:</span><span>W</span><span>/</span><span>2</span><span>]</span> <span>if</span> <span>(</span><span>side</span><span>==</span><span>&#34;left&#34;</span><span>)</span> <span>else</span> <span>im</span><span>[:,</span><span>W</span><span>/</span><span>2</span><span>:])</span>
</span><span>
</span><span>
</span><span><span>def</span> <span>make_frame</span><span>(</span><span>t</span><span>):</span>
</span><span>    <span>return</span> <span>np</span><span>.</span><span>hstack</span><span>([</span><span>half</span><span>(</span><span>t</span><span>,</span><span>&#34;left&#34;</span><span>),</span><span>half</span><span>(</span><span>t</span><span>,</span><span>&#34;right&#34;</span><span>)])</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoClip</span><span>(</span><span>make_frame</span><span>,</span> <span>duration</span><span>=</span><span>DURATION</span><span>)</span>
</span><span><span>clip</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;pentagon.gif&#34;</span><span>,</span><span>fps</span><span>=</span><span>15</span><span>,</span> <span>opt</span><span>=</span><span>&#34;OptimizePlus&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<h2 id="mixing-videos-and-vector-graphics">Mixing videos and vector graphics</h2>

<p>A nice advantage of combining Gizeh with MoviePy is that you can read actual video files (or gifs) and use the frames to fill shapes drawn with Gizeh.</p>

<p>We will use this <a href="https://www.youtube.com/watch?v=t4gjl-uwUHc">video</a> from the Blender Foundation (it’s under a Creative Common licence). Since you have read until there I’ll show you a little unrelated trick: at <em>4:32</em> the rabbit is jumping rope, so there is a potential for a well-looping GIF. We open the video around <em>4:32</em>, and let MoviePy automatically decide where to cut to have the best-looping GIF possible:</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
</pre></td><td><pre><code><span><span>from</span> <span>moviepy.editor</span> <span>import</span> <span>VideoFileClip</span>
</span><span><span>import</span> <span>moviepy.video.tools.cuts</span> <span>as</span> <span>cuts</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoFileClip</span><span>(</span><span>&#34;bunny.mp4&#34;</span><span>)</span><span>.</span><span>resize</span><span>(</span><span>0.2</span><span>)</span><span>.</span><span>subclip</span><span>((</span><span>4</span><span>,</span><span>32</span><span>),(</span><span>4</span><span>,</span><span>33</span><span>))</span>
</span><span><span>t_loop</span> <span>=</span> <span>cuts</span><span>.</span><span>find_video_period</span><span>(</span><span>clip</span><span>)</span> <span># gives t=0.56</span>
</span><span><span>clip</span><span>.</span><span>subclip</span><span>(</span><span>0</span><span>,</span><span>t_loop</span><span>)</span><span>.</span><span>write_gif</span><span>(</span><span>&#39;jumping_bunny.gif&#39;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<p><img src="http://i.imgur.com/MVp4TSx.gif"/></p>

<p>Now we can feed the frames of this GIF to Gizeh, using MoviePy’s <code>clip.fl(some_filter)</code>, which means <em>“I want a new clip made by transforming the frames of the current clip with some_filter”</em>.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
</pre></td><td><pre><code><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoFileClip</span><span>(</span><span>&#34;jumping_bunny.gif&#34;</span><span>)</span>
</span><span><span>(</span><span>w</span><span>,</span> <span>h</span><span>),</span> <span>d</span> <span>=</span> <span>clip</span><span>.</span><span>size</span><span>,</span> <span>clip</span><span>.</span><span>duration</span>
</span><span><span>center</span><span>=</span>  <span>np</span><span>.</span><span>array</span><span>([</span><span>w</span><span>/</span><span>2</span><span>,</span> <span>h</span><span>/</span><span>2</span><span>])</span>
</span><span>
</span><span><span>def</span> <span>my_filter</span><span>(</span><span>get_frame</span><span>,</span> <span>t</span><span>):</span>
</span><span>    <span>&#34;&#34;&#34; Transforms a frame (given by get_frame(t)) into a different</span>
</span><span><span>    frame, using vector graphics.&#34;&#34;&#34;</span>
</span><span>
</span><span>    <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>(</span><span>w</span><span>,</span><span>h</span><span>)</span>
</span><span>    <span>fill</span> <span>=</span> <span>(</span><span>gz</span><span>.</span><span>ImagePattern</span><span>(</span><span>get_frame</span><span>(</span><span>t</span><span>),</span> <span>pixel_zero</span><span>=</span><span>center</span><span>)</span>
</span><span>            <span>.</span><span>scale</span><span>(</span><span>1.5</span><span>,</span> <span>center</span><span>=</span><span>center</span><span>))</span>
</span><span>    <span>for</span> <span>(</span><span>nfaces</span><span>,</span><span>angle</span><span>,</span><span>f</span><span>)</span> <span>in</span> <span>([</span><span>3</span><span>,</span> <span>0</span><span>,</span> <span>1.0</span><span>/</span><span>6</span><span>],</span>
</span><span>                              <span>[</span><span>5</span><span>,</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>3</span><span>,</span> <span>3.0</span><span>/</span><span>6</span><span>],</span>
</span><span>                              <span>[</span><span>7</span><span>,</span> <span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>/</span><span>3</span><span>,</span> <span>5.0</span><span>/</span><span>6</span><span>]):</span>
</span><span>        <span>xy</span> <span>=</span> <span>(</span><span>f</span><span>*</span><span>w</span><span>,</span> <span>h</span><span>*</span><span>(</span><span>.</span><span>5</span><span>+</span> <span>.</span><span>05</span><span>*</span><span>np</span><span>.</span><span>sin</span><span>(</span><span>2</span><span>*</span><span>np</span><span>.</span><span>pi</span><span>*</span><span>(</span><span>t</span><span>/</span><span>d</span><span>+</span><span>f</span><span>))))</span>
</span><span>        <span>shape</span> <span>=</span> <span>gz</span><span>.</span><span>regular_polygon</span><span>(</span><span>w</span><span>/</span><span>6</span><span>,</span><span>nfaces</span><span>,</span> <span>xy</span> <span>=</span> <span>xy</span><span>,</span>
</span><span>                <span>fill</span><span>=</span><span>fill</span><span>.</span><span>rotate</span><span>(</span><span>angle</span><span>,</span> <span>center</span><span>))</span>
</span><span>        <span>shape</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>    <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span><span>clip</span><span>.</span><span>fl</span><span>(</span><span>my_filter</span><span>)</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;jumping_bunny_shapes.gif&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<p><img src="http://i.imgur.com/ltArnnc.gif"/></p>

<p>Finally, this function adds a zoom on some part of the video.</p>

<div><notextile><figure> <div><table><tbody><tr><td><pre><span>1</span>
<span>2</span>
<span>3</span>
<span>4</span>
<span>5</span>
<span>6</span>
<span>7</span>
<span>8</span>
<span>9</span>
<span>10</span>
<span>11</span>
<span>12</span>
<span>13</span>
<span>14</span>
<span>15</span>
<span>16</span>
<span>17</span>
<span>18</span>
<span>19</span>
<span>20</span>
<span>21</span>
<span>22</span>
<span>23</span>
<span>24</span>
<span>25</span>
<span>26</span>
<span>27</span>
<span>28</span>
<span>29</span>
<span>30</span>
<span>31</span>
<span>32</span>
</pre></td><td><pre><code><span><span>import</span> <span>gizeh</span> <span>as</span> <span>gz</span>
</span><span><span>import</span> <span>moviepy.editor</span> <span>as</span> <span>mpy</span>
</span><span><span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
</span><span>
</span><span><span>def</span> <span>add_zoom</span><span>(</span><span>clip</span><span>,</span> <span>target_center</span><span>,</span> <span>zoom_center</span><span>,</span> <span>zoom_radius</span><span>,</span> <span>zoomx</span><span>):</span>
</span><span>
</span><span>    <span>w</span><span>,</span> <span>h</span> <span>=</span> <span>clip</span><span>.</span><span>size</span>
</span><span>
</span><span>    <span>def</span> <span>fl</span><span>(</span><span>im</span><span>):</span>
</span><span>        <span>&#34;&#34;&#34; transforms the image by adding a zoom &#34;&#34;&#34;</span>
</span><span>
</span><span>        <span>surface</span> <span>=</span> <span>gz</span><span>.</span><span>Surface</span><span>.</span><span>from_image</span><span>(</span><span>im</span><span>)</span>
</span><span>        <span>fill</span> <span>=</span> <span>gz</span><span>.</span><span>ImagePattern</span><span>(</span><span>im</span><span>,</span> <span>pixel_zero</span><span>=</span><span>target_center</span><span>,</span>
</span><span>                               <span>filter</span><span>=</span><span>&#39;best&#39;</span><span>)</span>
</span><span>        <span>line</span> <span>=</span> <span>gz</span><span>.</span><span>polyline</span><span>([</span><span>target_center</span><span>,</span> <span>zoom_center</span><span>],</span>
</span><span>                           <span>stroke_width</span><span>=</span><span>3</span><span>)</span>
</span><span>        <span>circle_target</span><span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>zoom_radius</span><span>,</span> <span>xy</span><span>=</span><span>target_center</span><span>,</span>
</span><span>                                 <span>fill</span><span>=</span><span>fill</span><span>,</span> <span>stroke_width</span><span>=</span><span>2</span><span>)</span>
</span><span>        <span>circle_zoom</span> <span>=</span> <span>gz</span><span>.</span><span>circle</span><span>(</span><span>zoom_radius</span><span>,</span> <span>xy</span><span>=</span><span>zoom_center</span><span>,</span> <span>fill</span><span>=</span><span>fill</span><span>,</span>
</span><span>                       <span>stroke_width</span><span>=</span><span>2</span><span>)</span><span>.</span><span>scale</span><span>(</span><span>zoomx</span><span>,</span> <span>center</span><span>=</span><span>zoom_center</span><span>)</span>
</span><span>        <span>for</span> <span>e</span> <span>in</span> <span>line</span><span>,</span> <span>circle_zoom</span><span>,</span> <span>circle_target</span><span>:</span>
</span><span>            <span>e</span><span>.</span><span>draw</span><span>(</span><span>surface</span><span>)</span>
</span><span>        <span>return</span> <span>surface</span><span>.</span><span>get_npimage</span><span>()</span>
</span><span>
</span><span>    <span>return</span> <span>clip</span><span>.</span><span>fl_image</span><span>(</span><span>fl</span><span>)</span>
</span><span>
</span><span>
</span><span><span>clip</span> <span>=</span> <span>mpy</span><span>.</span><span>VideoFileClip</span><span>(</span><span>&#34;jumping_bunny.gif&#34;</span><span>)</span>
</span><span><span>w</span><span>,</span> <span>h</span> <span>=</span> <span>clip</span><span>.</span><span>size</span>
</span><span><span>clip_with_zoom</span> <span>=</span> <span>clip</span><span>.</span><span>fx</span><span>(</span><span>add_zoom</span><span>,</span> <span>target_center</span> <span>=</span> <span>[</span><span>w</span><span>/</span><span>2</span><span>,</span> <span>h</span><span>/</span><span>3</span><span>],</span> <span>zoomx</span><span>=</span><span>3</span><span>,</span>
</span><span>                   <span>zoom_center</span> <span>=</span> <span>[</span><span>5</span><span>*</span><span>w</span><span>/</span><span>6</span><span>,</span> <span>h</span><span>/</span><span>4</span><span>],</span> <span>zoom_radius</span><span>=</span><span>15</span><span>)</span>
</span><span><span>clip_with_zoom</span><span>.</span><span>write_gif</span><span>(</span><span>&#34;jumping_bunnyt_zoom.gif&#34;</span><span>)</span>
</span></code></pre></td></tr></tbody></table></div></figure></notextile></div>

<p><img src="http://i.imgur.com/VAvDKRN.gif"/></p>

<h2 id="your-turn-now-">Your turn now !</h2>

<p>I hope I have convinced you that Python is a nice language for making vector animations. If you give it a try, let me know of any difficulty you may meet installing or using MoviePy and Gizeh. And any feedback, improvement ideas, commits, etc. are also very appreciated.</p>
</div></div>
  </body>
</html>
