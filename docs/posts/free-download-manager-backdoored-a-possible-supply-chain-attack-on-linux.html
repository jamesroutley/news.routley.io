<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://securelist.com/backdoored-free-download-manager-linux-malware/110465/">Original</a>
    <h1>Free Download Manager backdoored – a possible supply chain attack on Linux</h1>
    
    <div id="readability-page-1" class="page"><div>
												<div>
													<p>Over the last few years, Linux machines have become a more and more prominent target for all sorts of threat actors. According to our telemetry, 260,000 unique Linux samples appeared in the first half of 2023. As we will demonstrate in this article, campaigns targeting Linux can operate for years without being noticed by the cybersecurity community.</p>
<p>We discovered one such long-lasting attack when we decided to investigate a set of suspicious domains, among them:</p>
<ul>
<li>2c9bf1811ff428ef9ec999cc7544b43950947b0f.u.fdmpkg[.]org</li>
<li>c6d76b1748b67fbc21ab493281dd1c7a558e3047.u.fdmpkg[.]org</li>
<li>0727bedf5c1f85f58337798a63812aa986448473.u.fdmpkg[.]org</li>
<li>c3a05f0dac05669765800471abc1fdaba15e3360.u.fdmpkg[.]org</li>
</ul>
<p>To a security researcher’s eye, these domains look alarming, as they can be a sight of malware using domain-generation algorithms for C2 communications. We thus decided to take a close look at the <span>fdmpkg[.]org</span> domain.</p>
<h2 id="a-malicious-debian-repository">A malicious Debian repository</h2>
<p>We identified that the domain in question has a <span>deb.fdmpkg[.]org</span> subdomain. Going there in the browser shows the following web page:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143412/FDM_story_01.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143412/FDM_story_01.png" alt="" width="654" height="153" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143412/FDM_story_01.png 654w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143412/FDM_story_01-300x70.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143412/FDM_story_01-370x87.png 370w" sizes="(max-width: 654px) 100vw, 654px"/></a></p>
<p>As suggested by the page, this subdomain claims to host a Debian repository of a piece of software called ‘Free Download Manager’. We further discovered a Debian package of this software available for download from the <span>https://deb.fdmpkg[.]org/freedownloadmanager.deb</span> URL. This package turned out to contain an infected <span>postinst</span> script that is executed upon installation. This script drops two ELF files to the paths <span>/var/tmp/crond</span> and <span>/var/tmp/bs</span>. It then establishes persistence by creating a cron task (stored in the file <span>/etc/cron.d/collect</span>) that launches the /var/tmp/crond file every 10 minutes.</p>
<p>The version of Free Download Manager installed by the infected package was released on January 24, 2020. Meanwhile, the postinst script contains comments in Russian and Ukrainian, including information about improvements made to the malware, as well as activist statements. They mention the dates 20200126 (January 26, 2020) and 20200127 (January 27, 2020).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/06153905/FDM-malware-story-02.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/06153905/FDM-malware-story-02.png" alt="" width="860" height="122"/></a></p>
<h2 id="a-dns-based-backdoor">A DNS-based backdoor</h2>
<p>Once the malicious package is installed, the executable <span>/var/tmp/crond</span> gets launched on every startup through cron. This executable is a backdoor, and it does not import any functions from external libraries. To access the Linux API, it invokes syscalls with the help of the statically linked <a href="https://en.wikipedia.org/wiki/Dietlibc" target="_blank" rel="noopener">dietlibc</a> library.</p>
<p>Upon startup, this backdoor makes a type A DNS request for the <span>&lt;hex-encoded 20-byte string&gt;.u.fdmpkg[.]org</span> domain. In response to this request, the backdoor receives two IP addresses that encode the address and port of a secondary C2 server. The following addresses were returned at the time of our research:</p>
<ul>
<li>172.111.48[.]101</li>
<li>172.1.0[.]80</li>
</ul>
<p>The first IP address in the list above is the address of the secondary C2 server, while the second address contains the connection port (encoded in the third and fourth octets) and the connection type (encoded in the second octet).</p>
<p>After parsing the response of the DNS request, the backdoor launches a reverse shell, using the secondary C2 server for communications. The communication protocol is, depending on the connection type, either SSL or TCP. In the case of SSL, the crond backdoor launches the <span>/var/tmp/bs</span> executable and delegates all further communications to it. Otherwise, the reverse shell is created by the <span>crond backdoor</span> itself.</p>
<h2 id="a-bash-stealer">A Bash stealer</h2>
<p>Having found out that the crond backdoor creates a reverse shell, we decided to check how this shell is used by attackers. To do that, we installed the infected Free Download Manager package in a malware analysis sandbox. Having analyzed the traffic generated by crond, we determined that the attackers deployed a Bash stealer to the sandbox. This stealer collects data such as system information, browsing history, saved passwords, cryptocurrency wallet files, as well as credentials for cloud services (AWS, Google Cloud, Oracle Cloud Infrastructure, Azure).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-1024x490.png" alt="" width="1024" height="490" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-1024x490.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-300x144.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-768x368.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-366x175.png 366w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-370x177.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-585x280.png 585w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03-800x383.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143535/FDM_story_03.png 1241w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<p>After collecting information from the infected machine, the stealer downloads an uploader binary from the C2 server, saving it to <span>/var/tmp/atd</span>. It then uses this binary to upload stealer execution results to the attackers’ infrastructure.</p>
<p>We did not observe any other activity performed via the reverse shell, and thus the whole infection chain can be described with the graph below:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/05134135/FDM-malware-scheme-01.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/05134135/FDM-malware-scheme-01.png" alt="" width="1024" height="576"/></a></p>
<h2 id="mystery-of-the-infection-vector">Mystery of the infection vector</h2>
<p>After analyzing all components in the chain, we wanted to find out how the infected Debian package was distributed to victims. We checked the official website of Free Download Manager (<span>freedownloadmanager[.]org</span>). Packages available for download from this website turned out to be hosted on the <span>files2.freedownloadmanager[.]org</span> domain, and they were not backdoored.</p>
<p>We then decided to conduct an open-source check on the <span>fdmpkg[.]org</span> domain. This check revealed a dozen posts on websites such as StackOverflow and Reddit, where users have been discussing problems caused by the infected Free Download Manager distribution, not realizing they actually became victims of malware. These posts were made over the course of three years – from 2020 to 2022.</p>
<p>In <a href="https://unix.stackexchange.com/questions/590510/kubuntu-20-04-shutdown-reboot-hangs-at-waiting-for-process-crond" target="_blank" rel="noopener">one such post</a> on Unix Stack Exchange, the author complains about the message ‘Waiting for process: crond’ that prevents the computer from shutting down:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05.png" alt="" width="986" height="568" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05.png 986w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-300x173.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-768x442.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-304x175.png 304w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-370x213.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-486x280.png 486w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143834/FDM_story_05-800x461.png 800w" sizes="(max-width: 986px) 100vw, 986px"/></a></p>
<p>The responses to this post, which came from users dealing with the same problem, suggest that this issue is caused by the Free Download Manager software. They advise to remove the files <span>/etc/cron.d/collect, /var/tmp/crond</span> and <span>/var/tmp/bs</span>. However, none mention that these three files are malicious.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06.png" alt="" width="866" height="552" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06.png 866w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-300x191.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-768x490.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-275x175.png 275w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-370x236.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-439x280.png 439w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31143905/FDM_story_06-800x510.png 800w" sizes="(max-width: 866px) 100vw, 866px"/></a></p>
<p>In <a href="https://www.reddit.com/r/SolusProject/comments/hqxuxo/free_download_manager_installation_help/" target="_blank" rel="noopener">another post</a> created in 2020, a Reddit user asked whether it is OK to install Free Download Manager without running the postinst script, which, unbeknownst to the user, contained malware.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/11085422/FDM-malware-story-071.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/09/11085422/FDM-malware-story-071.png" alt="" width="1024" height="973"/></a></p>
<p>Moreover, the post author pasted the contents of the script, and another Reddit user pointed out in the comments that it may be malicious. However, these users did not identify the website distributing the infected package or find out what this script does.</p>
<p>We additionally found a <a href="https://www.reddit.com/r/Malware/comments/2zmqzz/free_download_manager_serving_up_malware/" target="_blank" rel="noopener">post</a> on Reddit mentioning that the official website of this software was distributing malware in 2015. However, the malware described in this post turned out to be unrelated to the campaign that we discovered.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-1024x544.png" alt="" width="1024" height="544" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-1024x544.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-300x159.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-768x408.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-329x175.png 329w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-370x197.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-527x280.png 527w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08-800x425.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144003/FDM_story_08.png 1026w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<p>All these posts on social networks made us think that the malicious Debian package could have been distributed via a supply chain attack, through the <span>freedownloadmanager[.]org</span> website. So, we decided to look for further facts that could prove or disprove this claim.</p>
<h3 id="an-unexpected-redirection">An unexpected redirection</h3>
<p>While checking videos on Free Download Manager that are hosted on YouTube, we identified <a href="https://www.youtube.com/watch?v=BtJPC8dscy4" target="_blank" rel="noopener">several tutorials</a> demonstrating <a href="https://www.youtube.com/watch?v=yVZdxYfn95s" target="_blank" rel="noopener">how to install</a> this software on Linux machines. We observed the following actions that happen in all these videos:</p>
<ul>
<li>The video makers opened the <strong>legitimate</strong> website of Free Download Manager (<span>freedownloadmanager[.]org</span>) in the browser;</li>
<li>They afterwards clicked on the Download button for the Linux version of the software;</li>
<li>They were redirected to the <strong>malicious</strong> <span>https://deb.fdmpkg[.]org/freedownloadmanager.deb</span> URL that hosts the infected version of Free Download Manager.</li>
</ul>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-1024x856.png" alt="" width="1024" height="856" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-1024x856.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-300x251.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-768x642.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-209x175.png 209w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-370x309.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-335x280.png 335w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09-800x669.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144036/FDM_story_09.png 1097w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<p>We also noted that the redirection to the malicious <span>deb.fdmpkg[.]org</span> domain was not occuring in all cases. In <a href="https://www.youtube.com/watch?v=BqW6cNZY9DA" target="_blank" rel="noopener">another video</a> posted within the same timeframe, , a user clicked on the ‘Download’ button hosted on the software website and ended up downloading Free Download Manager from the legitimate website.</p>
<p>Thus, it is possible that the malware developers scripted the malicious redirection to appear with some degree of probability or based on digital fingerprint of the potential victim.</p>
<p>We further inspected the legitimate Free Download Manager website, wanting to find out if the software developers were aware their website was potentially compromised. In one of the comments made on the software’s <a href="https://www.freedownloadmanager.org/blog/?p=131#comment-311040" target="_blank" rel="noopener">blog</a> in 2021, a user complains about observing access to the <span>5d6167ef729c91662badef0950f795bf362cbb99.u.fdmpkg[.]org</span> domain. A reply to this comment from the user ‘blogadmin’ says that Free Download Manager is not related to this domain and advises to make use only of official versions of the software:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10.png"><img decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-1024x388.png" alt="" width="1024" height="388" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-1024x388.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-300x114.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-768x291.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-1536x582.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-462x175.png 462w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-370x140.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-739x280.png 739w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10-800x303.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144106/FDM_story_10.png 1678w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<p>However, nobody bothered to discover how this user ended up installing this suspicious version of Free Download Manager. As such, the official website of this software continued distributing the malicious Debian package until at least 2022.</p>
<h2 id="origins-of-the-backdoor">Origins of the backdoor</h2>
<p>Having established how the infected Free Download Manager package was distributed, we decided to check whether the implants discovered over the course of our research have code overlaps with other malware samples. It turned out that the crond backdoor represents a modified version of a backdoor called Bew. <a href="https://www.kaspersky.com/small-to-medium-business-security/endpoint-protection" target="_blank" rel="noopener">Kaspersky security solutions</a> for Linux have been detecting its variants since 2013.</p>
<div id="attachment_110477"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11.png"><img aria-describedby="caption-attachment-110477" decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-1024x296.png" alt="Code of the 2013 version of Bew (left, MD5: 96d8d47a579717223786498113fbb913) and the crond backdoor (right, MD5: 96d8d47a579717223786498113fbb913)" width="1024" height="296" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-1024x296.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-300x87.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-768x222.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-1536x444.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-606x175.png 606w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-370x107.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-969x280.png 969w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11-800x231.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144138/FDM_story_11.png 1814w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-110477">Code of the 2013 version of Bew (left, MD5: 96d8d47a579717223786498113fbb913) and the crond backdoor (right, MD5: 6ced2df96e1ef6b35f25ea0f208e5440)</p></div>
<p>The Bew backdoor has been analyzed multiple times, and one of its first descriptions was <a href="https://web.archive.org/web/20201022003947/https:/www.malekal.com/backdoor-linux-bew-a-et-client-bitcoin/" target="_blank" rel="noopener">published</a> in 2014. Additionally, in 2017, CERN <a href="https://web.archive.org/web/20200920171751/https:/security.web.cern.ch/advisories/busywinman/BusyWinman.shtml/" target="_blank" rel="noopener">posted</a> information about the BusyWinman campaign that involved usage of Bew. According to CERN, Bew infections were carried out through drive-by downloads.</p>
<p>As for the stealer, its early version was <a href="https://yoroi.company/research/the-return-of-the-wizard-vulnerability-crooks-start-hitting/" target="_blank" rel="noopener">described</a> by Yoroi in 2019. It was used after exploitation of a vulnerability in the Exim mail server.</p>
<div id="attachment_110478"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12.png"><img aria-describedby="caption-attachment-110478" decoding="async" loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12.png" alt="The Bash stealer described in 2019 (left, MD5: 8C7EFB0493B6FB805B2C2F0593DE0AB1) and the stealer used in the FDM campaign in 2022 (right, MD5: AD7F99D44931489B2C38DF7A5A166C4D)" width="777" height="343" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12.png 777w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12-300x132.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12-768x339.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12-396x175.png 396w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12-370x163.png 370w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/08/31144212/FDM_story_12-634x280.png 634w" sizes="(max-width: 777px) 100vw, 777px"/></a></p><p id="caption-attachment-110478">The Bash stealer described in 2019 (left, MD5: 8C7EFB0493B6FB805B2C2F0593DE0AB1) and the stealer used in the FDM campaign in 2022 (right, MD5: AD7F99D44931489B2C38DF7A5A166C4D)</p></div>
<h2 id="why-wasnt-the-malicious-package-discovered-earlier">Why wasn’t the malicious package discovered earlier?</h2>
<p>The malware observed in this campaign has been known since 2013. In addition, the implants turned out to be quite noisy, as demonstrated by multiple posts on social networks. According to our telemetry, victims of this campaign are located all over the world, including Brazil, China, Saudi Arabia and Russia. Given these facts, it may seem paradoxical that the malicious Free Download Manager package remained undetected for more than three years.</p>
<p>We assess that this is due to the following factors:</p>
<ul>
<li>As opposed to Windows, Linux malware is much more rarely observed;</li>
<li>Infections with the malicious Debian package occurred with a degree of probability: some users received the infected package, while others ended up downloading the benign one;</li>
<li>Social network users discussing Free Download Manager issues did not suspect that they were caused by malware.</li>
</ul>
<p>While the campaign is currently inactive, this case of Free Download Manager demonstrates that it can be quite difficult to detect ongoing cyberattacks on Linux machines with the naked eye. Thus, it is essential that Linux machines, both desktop and server, are equipped with reliable and efficient security solutions.</p>
<p><em>We additionally contacted the developers of Free Download Manager and notified them about this campaign. At the time of publishing this article, we had not received a response from them.</em></p>
<h2 id="indicators-of-compromise">Indicators of Compromise</h2>
<p><strong><em>File checksums</em></strong></p>
<p><strong><em>File paths</em></strong></p>
<p><strong><em>Network indicators</em></strong></p>
												</div>
											</div></div>
  </body>
</html>
