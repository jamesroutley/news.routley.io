<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://win-vector.com/2024/05/09/solving-recurrence-relations/">Original</a>
    <h1>Solving Recurrence Relations</h1>
    
    <div id="readability-page-1" class="page"><article id="post-15376">
	
		<p>
By  on <a href="https://win-vector.com/2024/05/09/solving-recurrence-relations/" title="8:14 am" rel="bookmark"><time datetime="2024-05-09T08:14:02-07:00">May 9, 2024</time></a>	• 
	</p>
	<section>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h2 id="Introduction">Introduction<a href="#Introduction"> </a></h2>
<p>A neat bit of “engineering mathematics” is solving <a href="https://en.wikipedia.org/wiki/Recurrence_relation">recurrence relations</a>. The solution method falls out of the notation itself, and harkens back to a time where formal sums were often used in place of vector subscript notation.</p>
<p>Unfortunately the variety of such solutions is small enough to allow teaching by memorization. In this note I try to avoid memorization, and motivate the methodology. I feel this is facilitated by separating a number of often smeared together representations (formulas, sequences, vectors, linear checks, characteristic polynomial, and polynomial check families) into distinct realizations. We are also going to emphasize calculating and confirming claims in Python.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>


<div data-mime-type="text/markdown">
<h2 id="The-problem">The problem<a href="#The-problem"> </a></h2>
<p>A simple form of the recurrence problem is to write down a general solution for a subscripted family of linear equations such as the following</p>
<p>Such a relation or equation can arise in number of situations or applications:</p>
<ul>
<li><a href="https://win-vector.com/2023/05/25/some-of-the-perils-of-time-series-forecasting/">Time series analysis</a>.</li>
<li>Estimating run times of algorithms.</li>
<li>Combinatorics.</li>
</ul>
<p>The above example is in fact <a href="https://en.wikipedia.org/wiki/Fibonacci_sequence">the Fibonacci sequence</a>.</p>
<p>The question is: if we are given initial conditions <code>F<sub>1</sub> = 1</code> and <code>F<sub>2</sub> = 1</code>, what is <code>F<sub>n</sub></code> (for general non-negative integer <code>n</code>)?</p>
<p>In this case the <a href="https://en.wikipedia.org/wiki/Fibonacci_sequence">Wikipedia solution</a> is <code>F<sub>n</sub> = (r<sub>1</sub><sup>n</sup> - r<sub>2</sub><sup>n</sup>)/sqrt(5)</code> where:</p>
<ul>
<li><code>r<sub>1</sub> = (1 + sqrt(5))/2</code></li>
<li><code>r<sub>2</sub> = (1 - sqrt(5))/2</code></li>
</ul>
<p>Natural questions include:</p>
<ul>
<li>Why is the solution in this form?</li>
<li>How do you find <code>r<sub>1</sub></code> and <code>r<sub>2</sub></code>?</li>
</ul>
<p>We will set up some notation and then solve a few examples.
</p></div>
</div>
</div>
</div>

<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h3 id="Vector-space-notation">Vector space notation<a href="#Vector-space-notation"> </a></h3>
<p>Let’s formalize our notation a bit.</p>
<p>First let’s settle on working over the <a href="https://en.wikipedia.org/wiki/Vector_space">vector space</a> of all infinite sequences of real numbers with non-negative subscripts. This is just saying we consider the infinite sequence <code>F = (F<sub>1</sub>, F<sub>2</sub>, F<sub>3</sub>, ...)</code> we are solving for as one of many possible sequences. We can use “<code>R[Z+]</code>” as the <a href="https://en.wikipedia.org/wiki/Group_ring">group-ring</a> style naming of this vector space.  Now consider any such vector <code>v</code> that obeys the recurrence equations:</p>
<ul>
<li>The all zeroes vector is in <code>S</code>. So <code>S</code> is non-empty.</li>
<li>If <code>v</code> obeys all of the above constraints then so does <code>c v</code> for any constant c.</li>
<li>If <code>u</code> and <code>v</code> obey all of the above constraints then so does <code>u + v</code>.</li>
<li>By induction, all <code>v<sub>n</sub></code> are completely determined by the values <code>v<sub>1</sub></code> and <code>v<sub>2</sub></code>.</li>
</ul>
<p>The first three observations tell us <code>S</code> is a vector subspace of <code>R[Z+]</code>. The fourth observation tells us this vector subspace is 2 dimensional, so any solution can be written as the linear combination of two basis solutions.</p>
<p>For notational convenience we will associate functions with vectors in <code>R[Z+]</code>. For a function <code>f()</code> let <code>[f(n) | n = 1, 2, ...]</code> denote the graph or vector <code>(f(1), f(2), f(3), ...)</code>. In particular we are interested in the vectors <code>[r<sub>1</sub><sup>n</sup> | n = 1, 2, ...] = (r<sub>1</sub>, r<sub>1</sub><sup>2</sup>, r<sub>1</sub><sup>3</sup>, ...)</code> and <code>[r<sub>2</sub><sup>n</sup> | n = 1, 2, ...] = (r<sub>2</sub>, r<sub>2</sub><sup>2</sup>, r<sub>2</sub><sup>3</sup>, ...)</code> (for the previously defined <code>r<sub>1</sub></code> and <code>r<sub>2</sub></code>). We claim <code>[r<sub>1</sub><sup>n</sup> | n = 1, 2, ...]</code> and <code>[r<sub>2</sub><sup>n</sup> | n = 1, 2, ...]</code> both obey the above linear check conditions.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h3 id="Inspecting-the-claimed-Fibonacci-solution">Inspecting the claimed Fibonacci solution<a href="#Inspecting-the-claimed-Fibonacci-solution"> </a></h3>
<p>Let’s confirm both <code>[r<sub>1</sub><sup>n</sup> | n = 1, 2, ...]</code> and <code>[r<sub>2</sub><sup>n</sup> | n = 1, 2, ...]</code> both obey the linear check conditions. In my opinion one doesn’t truly learn the math without working at least a few concrete examples.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[1]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># define [r1**n | n = 1, 2, ...] = f_r_1</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>

<span>r_1</span> <span>=</span> <span>(</span><span>1</span> <span>+</span> <span>np</span><span>.</span><span>sqrt</span><span>(</span><span>5</span><span>))</span><span>/</span><span>2</span>

<span>f_r_1</span> <span>=</span> <span>np</span><span>.</span><span>asarray</span><span>([</span><span>r_1</span><span>**</span><span>n</span> <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>11</span><span>)])</span>

<span>f_r_1</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[1]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([  1.61803399,   2.61803399,   4.23606798,   6.85410197,
        11.09016994,  17.94427191,  29.03444185,  46.97871376,
        76.01315562, 122.99186938])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[2]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># check f_r_1 obeys specified  Fibonacci relations</span>
<span>assert</span> <span>np</span><span>.</span><span>all</span><span>([</span>
    <span>np</span><span>.</span><span>abs</span><span>(</span><span>f_r_1</span><span>[</span><span>n</span><span>+</span><span>2</span><span>]</span> <span>-</span> <span>(</span><span>f_r_1</span><span>[</span><span>n</span><span>+</span><span>1</span><span>]</span> <span>+</span> <span>f_r_1</span><span>[</span><span>n</span><span>]))</span> <span>&lt;</span> <span>1e-8</span>
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>2</span><span>,</span> <span>len</span><span>(</span><span>f_r_1</span><span>)</span> <span>-</span> <span>2</span><span>)</span>
<span>])</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[3]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># define [r2**n | n = 1, 2, ...] = f_r_2</span>

<span>r_2</span> <span>=</span> <span>(</span><span>1</span> <span>-</span> <span>np</span><span>.</span><span>sqrt</span><span>(</span><span>5</span><span>))</span><span>/</span><span>2</span>

<span>f_r_2</span> <span>=</span> <span>np</span><span>.</span><span>asarray</span><span>([</span><span>r_2</span><span>**</span><span>n</span> <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>11</span><span>)])</span>

<span>f_r_2</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[3]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([-0.61803399,  0.38196601, -0.23606798,  0.14589803, -0.09016994,
        0.05572809, -0.03444185,  0.02128624, -0.01315562,  0.00813062])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[4]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># check f_r_2 obeys specified  Fibonacci relations</span>
<span>assert</span> <span>np</span><span>.</span><span>all</span><span>([</span>
    <span>np</span><span>.</span><span>abs</span><span>(</span><span>f_r_2</span><span>[</span><span>n</span><span>+</span><span>2</span><span>]</span> <span>-</span> <span>(</span><span>f_r_2</span><span>[</span><span>n</span><span>+</span><span>1</span><span>]</span> <span>+</span> <span>f_r_2</span><span>[</span><span>n</span><span>]))</span> <span>&lt;</span> <span>1e-8</span>
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>2</span><span>,</span> <span>len</span><span>(</span><span>f_r_2</span><span>)</span> <span>-</span> <span>2</span><span>)</span>
<span>])</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[5]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># generate a bit of the Fibonacci sequence using </span>
<span># the definitional recurrence F[n+2] = F[n+1] + F[n]</span>
<span>f</span> <span>=</span> <span>[</span><span>1</span><span>,</span> <span>1</span><span>]</span>
<span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>8</span><span>):</span>
    <span>n</span> <span>=</span> <span>len</span><span>(</span><span>f</span><span>)</span> <span>-</span> <span>2</span>
    <span>f</span><span>.</span><span>append</span><span>(</span><span>f</span><span>[</span><span>n</span> <span>+</span> <span>1</span><span>]</span> <span>+</span> <span>f</span><span>[</span><span>n</span><span>])</span>

<span>f</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[5]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>[1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[6]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># Wikipedia claimed solution</span>
<span>prediction</span> <span>=</span> <span>(</span><span>f_r_1</span> <span>-</span> <span>f_r_2</span><span>)</span> <span>/</span> <span>np</span><span>.</span><span>sqrt</span><span>(</span><span>5</span><span>)</span>

<span>prediction</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[6]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([ 1.,  1.,  2.,  3.,  5.,  8., 13., 21., 34., 55.])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[7]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># confirm claimed combination matches Fibonacci sequence</span>
<span>assert</span> <span>np</span><span>.</span><span>max</span><span>(</span><span>np</span><span>.</span><span>abs</span><span>(</span>
        <span>np</span><span>.</span><span>asarray</span><span>(</span><span>f</span><span>)</span> <span>-</span> <span>prediction</span>
    <span>))</span> <span>&lt;</span> <span>1e-8</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[8]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># we can also solve for the mixture coefficients by</span>
<span># treating our sequences as column vectors and asking</span>
<span># a solver how to write the vector f as a linear</span>
<span># combination of the vectors f_r_1 and f_r_2.</span>
<span>#</span>
<span># As a linear system in the first 2 terms this looks like:</span>
<span>#</span>
<span># f[0] = soln[0] * f_r_1[0]  +  soln[1] * f_r_1[0]</span>
<span># f[1] = soln[0] * f_r_1[1]  +  soln[1] * f_r_1[1]</span>
<span>#</span>
<span># And such a linear system is translated into </span>
<span># matrix notation as follows:</span>
<span>soln</span> <span>=</span> <span>np</span><span>.</span><span>linalg</span><span>.</span><span>solve</span><span>(</span>
    <span>np</span><span>.</span><span>asarray</span><span>([</span>
        <span>[</span><span>f_r_1</span><span>[</span><span>0</span><span>],</span> <span>f_r_2</span><span>[</span><span>0</span><span>]],</span>
        <span>[</span><span>f_r_1</span><span>[</span><span>1</span><span>],</span> <span>f_r_2</span><span>[</span><span>1</span><span>]],</span>
    <span>]),</span>
    <span>[</span>
        <span>f</span><span>[</span><span>0</span><span>],</span>
        <span>f</span><span>[</span><span>1</span><span>],</span>
    <span>]</span>
<span>)</span>

<span>soln</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[8]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([ 0.4472136, -0.4472136])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[9]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># our (identical) derived solution</span>
<span>prediction2</span> <span>=</span> <span>(</span>
    <span>soln</span><span>[</span><span>0</span><span>]</span> <span>*</span> <span>f_r_1</span> 
    <span>+</span> <span>soln</span><span>[</span><span>1</span><span>]</span> <span>*</span> <span>f_r_2</span>
<span>)</span>

<span>prediction2</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[9]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([ 1.,  1.,  2.,  3.,  5.,  8., 13., 21., 34., 55.])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[10]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># confirm claimed combination matches Fibonacci sequence</span>
<span>assert</span> <span>np</span><span>.</span><span>max</span><span>(</span><span>np</span><span>.</span><span>abs</span><span>(</span>
        <span>np</span><span>.</span><span>asarray</span><span>(</span><span>f</span><span>)</span> <span>-</span> <span>prediction2</span>
    <span>))</span> <span>&lt;</span> <span>1e-8</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h3 id="The-neat-trick">The neat trick<a href="#The-neat-trick"> </a></h3>
<p>The core of the solution follows from a neat trick: replace the subscripts with superscripts. This is <em>very</em> powerful trick. Let’s see that in action.</p>
<p>We gamble and hope some of the solutions are of the following simple form: <code>[r<sup>n</sup> | n = 1, 2, ...] = (r, r<sup>2</sup>, r<sup>3</sup>, ...)</code>, where <code>r</code> is a to be determined (possibly <a href="https://en.wikipedia.org/wiki/Complex_number">complex</a>) number.</p>
<p>Our claim is: <em>if</em> the number <code>r</code> is a solution to the polynomial equation (in <code>x</code>)</p>
<p>The “trick” to this is: if <code>x = r</code> is a root of, or satisfies, <code>x<sup>2</sup> = x + 1</code>, then it also satisfies <code>x<sup>n+2</sup> = x<sup>n+1</sup> + x<sup>n</sup></code> (which is equivalent to <code>x<sup>n</sup> x<sup>2</sup> = x<sup>n</sup> x + x<sup>n</sup> 1</code>) for <em>all</em> <code>n ≥ 0 </code>. So <code>r<sup>n+2</sup> = r<sup>n+1</sup> + r<sup>n</sup></code> for <em>all</em> <code>n ≥ 0 </code> which is exactly the claim <code>v = [r<sup>n</sup> | n = 1, 2, ...]</code> is a solution to all of the subscripted <code>v</code>-checks. It pays to think of the characteristic polynomial <code>p(x)</code> as shorthand for the family of “check polynomials” <code>x<sup>n</sup> p(x) for n = 0, 1, 2, ...</code>. However, for some problems we will need to appeal directly to the family of check polynomials.</p>
<p>In our case, the roots, or solutions, to this polynomial equation are the roots <code>x<sup>2</sup> - x - 1 = 0</code>. By the <a href="https://en.wikipedia.org/wiki/Quadratic_formula">quadratic formula</a>:</p>
<ul>
<li><code>r<sub>1</sub> = (1 + sqrt(5))/2</code></li>
<li><code>r<sub>2</sub> = (1 - sqrt(5))/2</code></li>
</ul>
<p>This gives us two linearly independent solutions to the recurrence check equations: <code>[r<sub>1</sub><sup>n</sup> | n = 1, 2, ...]</code> and <code>[r<sub>2</sub><sup>n</sup> | n = 1, 2, ...]</code>. These solutions are enough to form a basis for the solution space <code>S</code>, so we know <code>F</code> is some linear combination of <code>[r<sub>1</sub><sup>n</sup> | n = 1, 2, ...]</code> and <code>[r<sub>2</sub><sup>n</sup> | n = 1, 2, ...]</code>. And we have already showed how to find the linear combination by setting up linear equations to match the first two entries of the vector.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h2 id="A-harder-example">A harder example<a href="#A-harder-example"> </a></h2>
<p>Suppose we want to solve the recurrence:</p>
<p>We will try the earlier solution strategy. We are then interested in roots of the corresponding characteristic polynomial:</p>
<p>The space of solutions is again 2 dimensional. So to parameterize over all the possible solutions, we need a second linear independent solution. The question then is: how do we find a second linear independent solution?
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h3 id="Dealing-with-repeated-roots">Dealing with repeated roots<a href="#Dealing-with-repeated-roots"> </a></h3>
<p>When our characteristic polynomial <code>p(x)</code> has repeated roots, the characteristic polynomial is not expressive enough to represent some solutions. However, <em>the corresponding family of check polynomials</em> <code>x<sup>n</sup> p(x) for n = 0, 1, ...</code> <em>are</em> rich enough to find the extra solutions. We will use that when a polynomial <code>p(x)</code> has a repeated root (that is: for some number <code>r</code>, the fact that <code>(x-r)<sup>2</sup></code> divides into <code>p(x)</code> with no remainder), then <code>p(x)</code> shares that root with <code>p&#39;(x)</code> (where <code>p&#39;(x)</code> is the derivative of <code>p(x)</code> with respect to <code>x</code>).</p>
<p>Take the earlier “<code>W</code> check” polynomials <code>p(x) = x<sup>n+2</sup> - 6 x<sup>n+1</sup> + 9 x<sup>n</sup></code>. Define the polynomial <code>y(x) = x p&#39;(x) = (n+2) x<sup>n+2</sup> - 6 (n+1) x<sup>n+1</sup> + 9 n x<sup>n</sup></code>. <code>y(x)</code> itself is (by inspection) the check polynomials corresponding to the following (new) linear recurrence checks:</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h4 id="Confirming-the-last-claim">Confirming the last claim<a href="#Confirming-the-last-claim"> </a></h4>
<p>Frankly, this sort of argument doesn’t fully sink in until one confirms some examples and calculations. The derivation is a bit of “proof by change of notation”, which is <em>never</em> very satisfying.</p>
<p>So: let’s confirm some calculations claimed in the example to try to build some familiarity with the items discussed.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[11]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># show down p(x) zeros out at x=3</span>
<span>r</span> <span>=</span> <span>3</span>
<span>evals_p</span> <span>=</span> <span>[</span>
    <span>r</span><span>**</span><span>(</span><span>n</span><span>+</span><span>2</span><span>)</span> <span>-</span> <span>6</span> <span>*</span> <span>r</span><span>**</span><span>(</span><span>n</span><span>+</span><span>1</span><span>)</span> <span>+</span> <span>9</span> <span>*</span> <span>r</span><span>**</span><span>n</span> 
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>10</span><span>)]</span>

<span>evals_p</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[11]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[12]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span>assert</span> <span>np</span><span>.</span><span>all</span><span>(</span><span>np</span><span>.</span><span>abs</span><span>(</span><span>evals_p</span><span>))</span> <span>&lt;</span> <span>1e-8</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[13]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># show down y(x) = x p&#39;(x) zeros out at x=3</span>
<span>r</span> <span>=</span> <span>3</span>
<span>evals_y</span> <span>=</span> <span>[</span>
    <span>r</span> <span>*</span> <span>((</span><span>n</span><span>+</span><span>2</span><span>)</span> <span>*</span> <span>r</span><span>**</span><span>(</span><span>n</span><span>+</span><span>1</span><span>)</span> <span>-</span> <span>6</span> <span>*</span> <span>(</span><span>n</span><span>+</span><span>1</span><span>)</span> <span>*</span> <span>r</span><span>**</span><span>(</span><span>n</span><span>)</span> <span>+</span> <span>9</span> <span>*</span> <span>n</span> <span>*</span> <span>r</span><span>**</span><span>(</span><span>n</span><span>-</span><span>1</span><span>))</span> 
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>10</span><span>)]</span>

<span>evals_y</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[13]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[14]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span>assert</span> <span>np</span><span>.</span><span>all</span><span>(</span><span>np</span><span>.</span><span>abs</span><span>(</span><span>evals_y</span><span>))</span> <span>&lt;</span> <span>1e-8</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[15]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># write down the first p = [3**n | n = 1, 2, ...] solution</span>
<span>p</span> <span>=</span> <span>np</span><span>.</span><span>asarray</span><span>([</span>
    <span>r</span><span>**</span><span>n</span> <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>11</span><span>)</span>
    <span>])</span>

<span>p</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div>

<div>
<div>
<p>Out[15]:</p>
<div data-mime-type="text/plain" tabindex="0">
<pre>array([    3,     9,    27,    81,   243,   729,  2187,  6561, 19683,
       59049])</pre>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[16]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># confirm W checks on p&#39;</span>
<span>assert</span> <span>np</span><span>.</span><span>all</span><span>([</span>
    <span>p</span><span>[</span><span>n</span><span>+</span><span>2</span><span>]</span> <span>-</span> <span>6</span> <span>*</span> <span>p</span><span>[</span><span>n</span><span>+</span><span>1</span><span>]</span> <span>+</span> <span>9</span> <span>*</span> <span>p</span><span>[</span><span>n</span><span>]</span> <span>==</span> <span>0</span> 
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>len</span><span>(</span><span>p</span><span>)</span> <span>-</span> <span>2</span><span>)])</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>
<p>In[17]:</p>
<div data-type="inline">
<div>
<div>
<pre><span></span><span># confirm Y checks on p</span>
<span># this works as W is the &#34;Y&#34; checks for p&#39;</span>
<span>assert</span> <span>np</span><span>.</span><span>all</span><span>([</span>
    <span>(</span><span>n</span><span>+</span><span>2</span><span>)</span> <span>*</span> <span>p</span><span>[</span><span>n</span><span>+</span><span>2</span><span>]</span> <span>-</span> <span>6</span> <span>*</span> <span>(</span><span>n</span><span>+</span><span>1</span><span>)</span> <span>*</span> <span>p</span><span>[</span><span>n</span><span>+</span><span>1</span><span>]</span> <span>+</span> <span>9</span> <span>*</span> <span>n</span> <span>*</span> <span>p</span><span>[</span><span>n</span><span>]</span> <span>==</span> <span>0</span> 
    <span>for</span> <span>n</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>len</span><span>(</span><span>p</span><span>)</span> <span>-</span> <span>2</span><span>)])</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h3 id="Back-to-the-example">Back to the example<a href="#Back-to-the-example"> </a></h3>
<p>As we now have the required number of linearly independent solutions (2 solutions: <code>[3<sup>n</sup> | n = 1, 2, ...]</code> and <code>[n 3<sup>n</sup> | n = 1, 2, ...]</code>), we can solve for any specified initial conditions (as demonstrated earlier).</p>
<p>Believe it or not, we are done.
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h2 id="In-general">In general<a href="#In-general"> </a></h2>
<p>The general solution strategy is as follows.</p>
<p>For a general homogeneous linear recurrence of the form:</p>
<p>We call all of the above the “swap subscripts (general and powerful) to powers (specific and weak)” strategy (though there are obviously a few more steps and details to the method).
</p></div>
</div>
</div>
</div>
<div>
<div tabindex="0">

<div>

<div data-mime-type="text/markdown">
<h2 id="Conclusion">Conclusion<a href="#Conclusion"> </a></h2>
<p>Our solution strategy was exchanging powerful subscripts (which can implement any integer keyed lookup table) with less powerful superscripts (that can only express powers). We can lift any solution found in the weaker world (power series) to the more general one (subscripted sequences). We don’t always find enough power series solutions, and in that case we transform the problem to find more solutions to modified polynomials. The trick is to track the details of how the transforms operate on both our vector solutions and check polynomials.</p>
<p>The above system is general, it can solve a lot of problems. We concentrated on calculating over vector values. Related methods include <a href="https://en.wikipedia.org/wiki/Umbral_calculus">the umbral calculus</a>, the study of <a href="https://en.wikipedia.org/wiki/Shift_operator">shift operators</a>, and the <a href="https://en.wikipedia.org/wiki/Laplace_transform">Laplace transform</a>.</p>
<p>(The source code for this worksheet can be found <a href="https://github.com/WinVector/Examples/blob/main/recurrence_relations/solving_recurrence_relations.ipynb">here</a>)
</p></div>
</div>
</div>
</div>
		<p>Categories: <a href="https://win-vector.com/category/tutorials/" rel="category tag">Tutorials</a>		</p>
<p>Tagged as: <a href="https://win-vector.com/tag/engineering-mathematics/" rel="tag">engineering mathematics</a> <a href="https://win-vector.com/tag/python/" rel="tag">python</a> <a href="https://win-vector.com/tag/recurrence-relations/" rel="tag">recurrence relations</a></p>	<div>
		<p><img alt="" src="https://secure.gravatar.com/avatar/a4b2fbd7b2c8df820b3ee6832ce2152b?s=100&amp;d=identicon&amp;r=g" srcset="https://secure.gravatar.com/avatar/a4b2fbd7b2c8df820b3ee6832ce2152b?s=200&amp;d=identicon&amp;r=g 2x" height="100" width="100" decoding="async"/></p><h3>John Mount</h3>
			</div>
	</section>
</article></div>
  </body>
</html>
