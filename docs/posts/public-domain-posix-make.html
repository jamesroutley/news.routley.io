<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://frippery.org/make/">Original</a>
    <h1>Public domain POSIX make</h1>
    
    <div id="readability-page-1" class="page">

<p>
This is a public domain implementation of make which follows the
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html">POSIX standard</a>.
</p><p>
If you&#39;ve got here I assume you know what make is and why you might
want to use it.  If not, Chris Wellons has a nice
<a href="https://nullprogram.com/blog/2017/08/20/">
Tutorial on Portable Makefiles</a>.
</p><p>
Many Linux systems have the POSIX make specification available as a
man page.  It can be read with:
</p><pre>   man 1p make
</pre>
(On Debian-based systems you may need to install the <code>manpages-posix</code>
package.)
<p>
The code is based on Neil Russell&#39;s public domain make, as submitted
to the Usenet newsgroups net.sources and mod.sources in 1986.  The basic
data structures and algorithms remain but everything else has changed.
This version is also dedicated to the public domain.
</p><p>
The problem with make is that it&#39;s a tool for developers, and developers
like to tinker with their tools.  There are therefore many slightly
different versions of make around.  POSIX attempts to standardise their
common behaviour but leaves a lot of the details unspecified or implementation
dependent.  It&#39;s also rather lax, in that it allows extensions to exist
provided they don&#39;t interfere with the specified functionality.
</p><p>
This version tries to stick to the POSIX standard.  Although the default
build from source includes a number of extensions a key feature of the
program is that all of these can be turned off at runtime.
</p><p>
This can be achieved in several ways:
</p><ul>
<li>The POSIX approach is to provide the special target
<code>.POSIX</code> as the first non-comment line of the first makefile
to be processed.
</li><li>The non-standard <code>--posix</code> command line option.
This must be the first given on the command line.
</li><li>The non-standard <code>PDPMAKE_POSIXLY_CORRECT</code>
environment variable.  If this is set to any value (even an empty string)
extensions are disabled.
</li></ul>
<p>
Extensions from a future POSIX standard have been added.  Note that these
are subject to change until the standard is finally published.
</p><ul>
<li>The <code>-j maxjobs</code> command line option is
accepted but doesn&#39;t cause jobs to be run in parallel, as is permitted
by the proposed standard.
</li><li>Prerequisites of the <code>.PHONY</code> special target
are always treated as being out-of-date.
</li><li>Missing include files can be ignored with the
<code>-include</code> variant of <code>include</code>.  This can be handy
when using the automatic dependency tracking feature of compilers.
</li><li>Missing or out-of-date include files are rebuilt if an
appropriate rule can be found.  This is done using the &#34;immediate
remaking&#34; method from SunPro <code>make</code> rather than the &#34;delayed
remaking&#34; used by GNU <code>make</code>.
</li><li>The <code>$^</code> internal macro evaluates to all prerequisites
of the current target (not just out-of-date ones, as with <code>$?</code>.
</li><li>If no <code>MAKE</code> environment variable is provided the
<code>MAKE</code> macro is initialised from <code>argv[0]</code>, with a
relative path converted to absolute.
</li><li>The macro assignments <code>::=</code>, <code>:::=</code>,
<code>+=</code> and <code>?=</code> are permitted.
</li><li>Pattern macros extend the standard suffix substitution in
macro expansion to allow changes to prefixes as well.  For example:
<pre>   SRC = src/util.c src/main.c
   OBJ = $(SRC:src/%.c=obj/%.o)
</pre>
</li></ul>
<p>
Some additional extensions are also provided.  These are all compatible
with GNU <code>make</code>, though some are supported by other
implementations.
</p><ul>
<li>The <code>-C directory</code> command line option changes
the current working directory.
</li><li>Double colon rules are allowed.  POSIX excludes them on the
grounds that they&#39;re a BSD extension.  I&#39;m not sure that&#39;s correct, but
whatever.
</li><li>A limited set of conditional statements is allowed:
<ul>
<li><code>ifdef</code>
</li><li><code>ifndef</code>
</li><li><code>else</code>
</li><li><code>endif</code>
</li></ul>
</li><li>Archive members can be specified using the form
<code>lib.a(mem1.o mem2.o...)</code>.
</li><li>The macro assignments <code>:=</code>
and <code>!=</code> are permitted.
</li><li>Nested macro expansion can be used to build the name of
a macro from the contents of other macros.  This is crucial for such tricks
as implementing the <a href="https://nullprogram.com/blog/2016/04/30/">
Game of Life</a> in a makefile.
</li><li>Chained inference rules can be used when searching for the
prerequisites of a target.  Thus, if there are inference rules
<code>.p.q</code> and <code>.q.r</code> and the file <code>thing.p</code>
exists, make is able to deduce how to create <code>thing.r</code>.
</li><li>The wildcards <code>*</code>, <code>?</code> and
<code>[]</code> can be used in the targets and prerequisites of target
rules.
</li></ul>
<p>
Future POSIX and non-POSIX extensions can be enabled separately by
setting the build flags <code>ENABLE_FEATURE_MAKE_EXTENSIONS</code> and
<code>ENABLE_FEATURE_MAKE_POSIX_202X</code> to <code>1</code>.
</p><p>
The most recent source tarball is
<a href="https://frippery.org/make/pdpmake-1.3.0.tgz"> pdpmake-1.3.0.tgz</a>.  The
<a href="https://frippery.org/make/release-notes/current.html">release notes</a> describe
recent changes.
</p><p>
Source is also available in a Git repository mirrored on
<a href="https://github.com/rmyorston/pdpmake">GitHub</a>,
<a href="https://gitlab.com/rmyorston/pdpmake">Gitlab</a>
and with (IPv6 only):
</p><pre>   git clone git://git.frippery.org/pdpmake
</pre>
<p>
Bug reports can be submitted via
<a href="https://github.com/rmyorston/pdpmake/issues">GitHub</a>,
<a href="https://gitlab.com/rmyorston/pdpmake/issues">GitLab</a>
or by email to the address below.
</p><p>
Remember, though, this is just a bunch of zeroes and ones you happened
to find on the internet.  If it does anything useful that&#39;s an unexpected
bonus.
</p><hr/>
<address>
<a href="mailto:rmy@pobox.com">Ron Yorston</a></address>


</div>
  </body>
</html>
