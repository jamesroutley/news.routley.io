<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ai.facebook.com/blog/using-ai-to-bring-childrens-drawings-to-life/">Original</a>
    <h1>Using AI to bring children’s drawings to life (2021)</h1>
    
    <div id="readability-page-1" class="page"><div><p>Children draw fascinatingly unique and inventive characters that push our imaginations and require us to think a little differently to recognize the people and things in their pictures. While it can be fairly simple for a parent or teacher to see what a child’s drawing is meant to show, AI struggles with this task. Kids’ drawings are often constructed in abstract, fanciful ways, so if a figure’s feet are placed precariously or if both arms are on the same side of its body, it confuses even state-of-the-art AI systems that excel at spotting objects in photorealistic images and drawings.</p><p>Meta AI researchers are working to overcome this challenge so that AI systems will be better able to recognize drawings of human figures in the wildly varied ways that children create them. </p><p>We’re excited to announce a first-of-its-kind method for automatically animating children’s hand-drawn figures of people and humanlike characters (i.e., a character with two arms, two legs, a head, etc.) that <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fsketch.metademolab.com%2F&amp;h=AT31LUsBo1kjVIotIRG50Eyyv5xUcj5obKgXRz79nX9o9-wSiX7CAbwfsgjuDTrNT87sHGUVV9GWri-WpfzYpJW4JrWJA2LXLkCIT85bDzgMWD8dPKZT6vhLtK4TZZm-9SHMp314-S0hxtIc" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span> bring these drawings to life</span></a> in a matter of minutes using AI. By uploading them to our prototype system, parents and children can experience the excitement of watching their drawings become moving characters that dance, skip, and jump. And they can even download their animated drawings to share with friends and family. If parents choose, they can also submit those drawings to help improve the AI model.</p><p>By teaching AI to work effectively with this quintessential human form of creativity, we hope this project will move us closer to building AI that can understand the world from a human point of view. We also hope this work will spur more research on using AI to enhance people’s creativity and inspire imaginative new uses for this technology.</p><h2>Why automatic AI animation tools don’t work on children’s drawings</h2><p>Our goal was to build an AI system that can identify and automatically animate the humanlike figures in children’s drawings with a high success rate and without any human guidance. While many AI tools and techniques are designed to handle realistic images of humans, children’s drawings add a level of variety and unpredictability that makes identifying what’s being portrayed much more complex. “Humans” in children’s drawings come in many different forms, colors, sizes, and scales, with little similarity when it comes to body symmetry, morphology, and point of view. We approached this AI challenge through a four-step process, fine-tuning our approach at each stage to adapt to the enormous variety present in children’s drawings. </p><div id="u_0_2z_1B"><div id="u_0_30_OX"><div tabindex="0" id="u_0_31_dP"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_32_DN"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_35_3K"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div><h2>Identifying humanlike figures through object detection</h2><p>The first step in animating children’s drawings of people is distinguishing the human figures from the background and from other types of characters in the picture. Object detection using existing techniques works quite well on children’s drawings, but the segmentation masks aren’t accurate enough to be used for animation. To address this, we instead use the bounding boxes obtained from the object detector and apply a series of morphological operations and image processing steps to obtain masks.</p><p>When extracting the humanlike characters within a child’s drawing for processing, we use Meta AI’s convolutional neural network–based object detection model, Mask R-CNN, as implemented in <a href="https://ai.facebook.com/blog/-detectron2-a-pytorch-based-modular-object-detection-library-/" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}"><span>Detectron2</span></a>. Mask R-CNN is pretrained on one of the largest publicly available segmentation data sets, but it’s made up of photos of real-world objects, not drawings. To work on drawings, the model needed to be fine-tuned, which we did with ResNet-50+FPN to predict a single class, “human figure.” We invited our colleagues at Meta to share and animate their kids’ artwork using our system, and we obtained approximately 1,000 drawings that helped us train the AI. </p><p>After the fine-tuning process, the network did a good job of detecting human figures within the test data set. The failure cases we observed fell into four different categories: not including the entire figure, not separating the figure from the background, not separating several figures drawn close together, and incorrectly identifying nonhuman figures (such as trees). We believe these types of failures stem from the wide variety in human figures in the training set and the model will continue to improve as it gets more drawings to learn from.</p><div id="u_0_3a_kd"><div id="u_0_3b_bP"><div tabindex="0" id="u_0_3c_A7"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_3d_ZB"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_3g_my"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div><h2>Lifting the humanlike figure from the scene using character masking</h2><p>After identifying and extracting a human figure from a drawing, the next step in preparing for animation is to separate it from other parts of the scene and the background in a process called masking. The mask must closely mirror the contours of the figure because it will be used to create a mesh, which will then be deformed to produce the animation. When properly done, a mask will include all parts of the character and nothing from the background. </p><p>Even though Mask R-CNN can output masks, we found they weren’t suitable for animation. The predicted masks often failed to capture the entire figure whenever the body parts varied greatly in appearance, such as in the figure below, which shows a large yellow triangle for a body and a single pencil stroke for the arm. The predicted masks also often failed by leaving out the middle of “hollow” characters, or characters drawn as outlines and not colored in. </p><p>Instead, we developed a classical image processing–based approach that is more robust to these variations. With this method, we crop the image using its predicted bounding box for each detected character. We then apply adaptive thresholding and morphological closing/dialating operations, flood fill from the edges of the box, and assume the mask is the largest polygon not touched by the flood fill. While this method is straightforward and effective for extracting accurate masks suitable for animation, it can fail when the background is cluttered, characters are drawn close together, or the paper has wrinkles, tears, or shadows on the page. </p><p><img src="https://scontent-iad3-2.xx.fbcdn.net/v/t39.2365-6/267736234_3067496556854519_8243451664106131168_n.png?_nc_cat=104&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=gA_1ouFbSK8AX8mLZw4&amp;_nc_ht=scontent-iad3-2.xx&amp;oh=00_AT8SLVlHNf-SfqzRjxdBUpZd0XD6BT8pAuJq4ZmcQf3E8Q&amp;oe=621E56CB" alt=""/></p><div><p>Segmentation masks from Mask R-CNN sometimes failed to closely follow the form of the character (middle, top) or to include all parts of the character, such as stick arms (middle, bottom). In many situations, using an image processing pipeline on Mask R-CNN’s predicted bounding box results in masks more suitable for animation (right).</p></div><h2>Prepping for animation via rigging</h2><p>Children draw figures with a huge variety of body shapes, far beyond the conventional human shape with a head, arms, legs, and a torso. Many children start out depicting humans as what are often called “tadpole people,” with no torso and with arms and legs attached directly to the head. Some children progress to “transitional” figures, which have legs extending from the head and arms extending from the upper legs. We needed a method of rigging that could handle this type of morphological variation. </p><p><img src="https://scontent-iad3-2.xx.fbcdn.net/v/t39.2365-6/267084317_425999812498390_3388533820925804128_n.jpg?_nc_cat=108&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=hjThtYao2BMAX9uBLSk&amp;_nc_ht=scontent-iad3-2.xx&amp;oh=00_AT-SA3T9eKVhnFke5Evo83sYUlnKPWdbWSfyzKbg_eZPkw&amp;oe=621D5926" alt=""/></p><p>We use AlphaPose, a model trained for human pose detection, to identify key points on the human figures that can serve as hips, shoulders, elbows, knees, wrists, and ankles. AlphaPose was trained on images of real people, so before we could adapt it to detecting poses in children’s drawings, we had to retrain it to handle the types of variation present in children’s drawings. We did this by internally collecting and annotating a small data set of children’s drawings of human figures. Then, using the pose detector trained on this initial data set, we created an internal tool that allows parents to upload and animate their children’s drawings and allows us to use the uploaded drawings for additional training. As more data came in, we iteratively retrained the model until we reached high levels of accuracy. </p><h2>Animating 2D figures using 3D motion capture</h2><p>Once we have mask and joint predictions, we have everything we need to produce the animation. We begin by using the extracted mask to generate a mesh, texturing it with the original drawing. Using the predicted joint locations, we create a skeleton for the character. By rotating the bones and using the new joint locations to deform the mesh, we can move the character into various poses. By moving the character into a series of consecutive poses, we can create an animation. We can select different motions to apply depending upon how confident the joint predictions are: In cases where both arms and legs have been predicted correctly, the animation can happen seamlessly. But if a limb is not present in the drawing, its joint confidence values would be low, and we would have to forgo animations that require that limb, ask the user to correct the prediction, or declare the animation a failure. </p><p> To animate the 2D figures using 3D motion capture, we take advantage of the fact that many children draw using what we refer to as a twisted perspective. It’s common for many children to initially draw body parts from their most identifiable point of view, which may be different from the way they would appear on actual humans. For instance, they tend to draw legs and feet from a side view and heads and torsos from a front view.</p><p>We take advantage of this perspective in our motion retargeting step. Independently for the lower and upper body, we automatically determine whether the motion is more recognizable from a front view or a side view. Using the selected views, we project the motion onto a single 2D plane and use it to drive the character. We validate the results of such a motion retargeting approach using perceptual user studies run via Mechanical Turk.</p><p><img src="https://scontent-iad3-2.xx.fbcdn.net/v/t39.2365-6/266785441_1595147910829577_5871587137964044236_n.png?_nc_cat=101&amp;ccb=1-5&amp;_nc_sid=ad8a9d&amp;_nc_ohc=D6eZiI_Ws8wAX9-cSJg&amp;_nc_ht=scontent-iad3-2.xx&amp;oh=00_AT8f46vBMLlS1HoJTNkFfmLLayD7CIr8SxpVIYJs11gC6Q&amp;oe=621DDB87" alt=""/></p><div><p>Left: Prior to animating, we create a rigged character from the drawing. Right: We repose the character by projecting a frame of motion capture data onto a 2D plane and rotating the character’s limbs to match those of the project. We can project the motion capture data from the front (top row), from the side (middle row), and from a twisted perspective (bottom).</p></div><p>Taking the twisted perspective into account is helpful because many types of motion do not cleanly fall onto a single plane of projection. For example, with jumping rope, the arms and wrists tend to move primarily in the frontal plane, while the bending legs tend to move in the sagittal plane. Because of this, we do not determine a single plane of motion for the motion capture pose but determine projection planes for the upper and lower body separately.</p><h2>Using AI to power more complex animations</h2><p>AI has become a powerful tool for creativity, <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Ftwitter.com%2Ffacebookai%2Fstatus%2F1432717210372411407&amp;h=AT02o9b10IMfY0ZhPZD84tqBQsURP8daaUXGiUU6cPsd8yOqZu4hk0oo3Y26D3jel9J3vqnOXynOQ6fu2ye97O0vMtab7pz2me-7StN7pkMuRTwMiMKOCJDwyO6zJgDjnOEEMT5zonytnm0l" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>empowering artists</span></a>; inspiring <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Ftech.fb.com%2Fcreativity-for-all-facebooks-spark-ar-now-lets-anyone-build-and-share-effects-on-instagram%2F&amp;h=AT2OEkOAeib42OsGCsQQfXvNDTHm8BidZUzKN6iEtm_N9VFw2MTrgqpiW01sBvgzkdUtgUnAqO_1050i8ktReyOjF4hmd5vCUPhwmBUeFGfog5jQhRKk9XJ_rL66yjd_JUNQf81Z5G-5s8qm" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>new forms of self-expression, like AR effects</span></a>; <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Ftech.fb.com%2Fbuilding-ai-with-a-helpful-eye-for-fashion%2F&amp;h=AT2mnLx60Jq3ehkvyj0yjFtlDmoJpa2XS-3aFfKfaeEk0KeYq8OlRvGRAiNqceFTd2bNWaA_P5g4qklVzi4DElFG2kTBhYf0S5V7RbgQ0BF4JTg8hkjMqKGnCwCFwm5_-6wHkYTliW6TkWnj" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>offering fashion advice</span></a>; and even <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Ftech.fb.com%2Fai-like-the-way-you-move-how-facebook-researchers-built-an-inspirational-dancing-machine%2F&amp;h=AT14Zd41uAIsqdlXhbhRCWRV9VSMUVmPh-sms3nEBnBc8dkCMKrGVhnegT2uiLkuZn9f5hKvA-bIb62wqaPIVCf-6zIc1a5UmQTsFTzn9psOg-4wHc56R_NHEbFWNiR9r9HeBuXhj9NJJ_AL" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span>generating new dance routines</span></a>. We hope our animation tool will inspire people to experiment with their drawings and take them in uncharted directions.</p><p>By sharing our work, we also hope to encourage more computer vision work in the domain of amateur drawings. Future research for this project could focus on identifying and applying more tailored motions to subcategories of figures, such as superheroes, princesses, monsters, and ninjas. A more fine-grained analysis of the parts of a character would also be useful for identifying antennae, tails, and capes, for example, and applying secondary motion elements in order to increase the animation’s appeal. Someday, perhaps, an AI system could take a complex drawing and then instantly create a detailed animated cartoon using multiple fantastical characters interacting with one another and elements from the background. With AR glasses, those stories could even seem to come to life in the real world, dancing or talking with the child who drew it just moments earlier. The possibilities are as limitless as the human imagination. </p><p>We invite you to test out the systems’ animation capabilities by uploading your children’s drawings to our <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fsketch.metademolab.com%2F&amp;h=AT1m07iJ7OQchSfVhV-CKziBwTjDP9glRFq37Bb2_-aN3wAbB6vy2rJMxD_i2Ncr1AVq3YJnnXfZAOv6SJn7lxM1L_T3pHMXDGH7ZSdRiaxCPQuvYpoclF3hPyrmuXgB1krazZJ98rGBYddQ" rel="nofollow" target="_blank" data-ms="{&#34;creative&#34;:&#34;link&#34;,&#34;creative_detail&#34;:&#34;link&#34;,&#34;create_type&#34;:&#34;link&#34;,&#34;create_type_detail&#34;:&#34;link&#34;}" data-lynx-mode="hover"><span> prototype</span></a>. In the coming year, we also hope to release the data set and share more details on our research.</p></div></div>
  </body>
</html>
