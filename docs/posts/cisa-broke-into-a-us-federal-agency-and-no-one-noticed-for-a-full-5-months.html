<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.theregister.com/2024/07/12/cisa_broke_into_fed_agency/">Original</a>
    <h1>CISA broke into a US federal agency, and no one noticed for a full 5 months</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
<p>The US Cybersecurity and Infrastructure Security Agency (CISA) says a red team exercise at a certain unnamed federal agency in 2023 revealed a string of security failings that exposed its most critical assets.</p>
<p>CISA calls these SILENTSHIELD assessments. The agency&#39;s dedicated red team picks a federal civilian executive branch (FCEB) agency to probe and does so without prior notice – all the while trying to simulate the maneuvers of a long term hostile nation-state threat group.</p>
<p>According to the agency&#39;s account of the exercise, the red team was able to gain initial access by exploiting an unpatched vulnerability (<a target="_blank" href="https://www.theregister.com/2024/02/27/manufacturing_sector_malware/">CVE-2022-21587</a> - 9.8) in the target agency&#39;s Oracle Solaris enclave, leading to what it said was a full compromise.</p>

    

<p>It&#39;s worth noting that CVE-2022-21587, an unauthenticated remote code execution (RCE) bug carrying a near-maximum 9.8 CVSS rating, was added to CISA&#39;s known exploited vulnerability (KEV) catalog in February 2023. The initial intrusion by CISA&#39;s red team was made on January 25, 2023.</p>

        


        

<p>&#34;After gaining access, the team promptly informed the organization&#39;s trusted agents of the unpatched device, but the organization took over two weeks to apply the available patch,&#34; CISA&#39;s report reads. &#34;Additionally, the organization did not perform a thorough investigation of the affected servers, which would have turned up IOCs and should have led to a full incident response. </p>
<p>&#34;About two weeks after the team obtained access, exploit code was released publicly into a popular open source exploitation framework. CISA identified that the vulnerability was exploited by an unknown third party. CISA added this CVE to its Known Exploited Vulnerabilities Catalog on February 2, 2023.&#34;</p>

        

<p>Vulnerabilities added to the KEV catalog mean a few things. First, they are serious, known to be exploited by cybercriminals, and can lead to serious consequences. Second, when bugs are added to the catalog, they also come with deadlines by which FCEB agencies have to patch them.</p>
<p>Since introducing the KEV catalog, CISA has always been cagey about the degree to which federal agencies meet these deadlines, but this case shows they aren&#39;t always being met.</p>
<p><em>The Register</em> fielded a question about deadline compliance to CISA&#39;s director Jen Easterly at the <a href="https://www.theregister.com/2024/07/01/cisa_big_tech_security/">Oxford Cyber Forum</a> last month who said, without referring to specific figures she didn&#39;t have access to at the time, that &#34;compliance is very high.&#34; Plus, a recent survey showed the catalog is <a href="https://www.theregister.com/2024/05/07/cisas_vulnerability_deadlines/">helping the private sector too</a>.</p>

        

<p>After gaining access to the Solaris enclave, the red team discovered they couldn&#39;t pivot into the Windows part of the network because missing credentials blocked their path, despite enjoying months of access to sensitive web apps and databases.</p>
<p>Undeterred, CISA managed to make its way into the Windows network after carrying out <a href="https://www.theregister.com/2024/05/23/google_phishing_tests/">phishing attacks</a> on unidentified members of the target agency, one of which was successful.</p>
<p>It said real adversaries may have instead used prolonged password-praying attacks rather than phishing at this stage, given that several service accounts were identified as having <a href="https://www.theregister.com/2024/04/29/uk_lays_password_legislation/">weak passwords</a>.</p>
<p>After gaining that access, the red team injected a persistent RAT and later discovered unsecured admin credentials, which essentially meant it was game over for the agency being assessed. </p>
<p>&#34;None of the accessed servers had any noticeable additional protections or network access restrictions despite their sensitivity and critical functions in the network,&#34; CISA said.</p>
<p>CISA described this as a &#34;full domain compromise&#34; that gave the attackers access to tier zero assets – the most highly privileged systems.</p>
<p>&#34;The team found a password file left from a previous employee on an open, administrative IT share, which contained plaintext usernames and passwords for several privileged service accounts,&#34; the report reads. &#34;With the harvested Lightweight Directory Access Protocol (LDAP) information, the team identified one of the accounts had system center operations manager (SCOM) administrator privileges and domain administrator privileges for the parent domain. </p>
<p>&#34;They identified another account that also had administrative permissions for most servers in the domain. The passwords for both accounts had not been updated in over eight years and were not enrolled in the organization&#39;s identity management (IDM).&#34;</p>
<p>From here, the red team realized the victim organization had trust relationships with multiple external FCEB organizations, which CISA&#39;s team then pivoted into using the access they already had.</p>
<p>The team &#34;kerberoasted&#34; one partner organization. Kerberoasting is an attack on the Kerberos authentication protocol typically used in Windows networks to authenticate users and devices. However, it wasn&#39;t able to move laterally with the account due to low privileges, so it instead used those credentials to exploit a second trusted partner organization. Kerberoasting yielded a more privileged account at the second external org, the password for which was crackable.</p>
<p>CISA said that due to network ownership, legal agreements, and/or vendor opacity, these kinds of cross-organizational attacks are rarely tested during assessments.</p>
<p>However, SILENTSHIELD assessments are able to be carried out following new-ish powers afforded to CISA by the FY21 National Defense Authorization Act (NDAA), the same powers that also allow CISA&#39;s Federal Attack Surface Testing (FAST) pentesting program to operate.</p>
<p>It&#39;s crucial that these avenues are able to be explored in such exercises because they&#39;re routes into systems adversaries will have no reservations about exploring in a real-world scenario.</p>
<h3>Disclosure time</h3>
<p>For the first five months of the assessment, the target FCEB agency failed to detect or remediate any of the SILENTSHIELD activity, raising concerns over its ability to spot genuine malicious activity.</p>
<p>Detection issues were suspected earlier in the proceedings. The RAT, which was injected in the Solaris phase of the exercise, caused 8GB of network traffic to flow through its C2 seemingly without alerting anyone at the agency, for example.</p>
<p>After CISA eventually put the agency out of its misery, weekly meetings were held with its security team and sysadmins which led to &#34;measurable improvements in response times for known techniques and behavior-based detections that uncovered previously unknown tradecraft.&#34;</p>
<p>One of the main issues discussed in the post mortem was the agency&#39;s log collection, which was deemed to be &#34;ineffective and inefficient.&#34; Various issues impeded the agency&#39;s ability to collect logs, which you can read about in the <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-193a" rel="nofollow">full writeup</a>, but CISA&#39;s compromise of Solaris and Windows hosts had a big impact as packet capturing happened here, and so CISA was able to disrupt the process.</p>
<ul>

<li><a href="https://www.theregister.com/2024/07/02/supreme_court_chevron/">Brace for new complications in big tech takedowns after Supreme Court upended regulatory rules</a></li>

<li><a href="https://www.theregister.com/2024/06/28/cisa_open_source/">CISA looked at C/C++ projects and found a lot of C/C++ code. Wanna redo any of it in Rust?</a></li>

<li><a href="https://www.theregister.com/2024/06/27/congress_china_drones/">US lawmakers wave red flags over Chinese drone dominance</a></li>

<li><a href="https://www.theregister.com/2024/07/11/fcc_warns_yet_again_of/">FCC: US telcos a long way off, several billions short of removing Chinese kit</a></li>
</ul>
<p>The assessed agency also placed too great a reliance on known indicators of compromise (IoCs) for detecting intrusions, plus various system misconfigurations and procedural issues hindered the analysis of network activity. </p>
<p>CISA said the exercise demonstrated the need for FCEB agencies to apply defense-in-depth principles – multiple layers of detection and analysis measures for maximum effectiveness. Network segmentation was recommended and the red team wanted to stress the danger of over-relying on known IOCS.</p>
<p>It also wouldn&#39;t be a CISA communiqué without a plug for its <a href="https://www.theregister.com/2024/05/09/68_tech_firms_sign_cisas/">secure-by-design</a> push. It said that insecure software contributes to the issues faced by the target agency and re-upped its call to stamp out default passwords, provide free logging to customers, and for vendors to work with SIEM and SOAR providers to make better use of those logs. ®</p>                                
                    </div></div>
  </body>
</html>
