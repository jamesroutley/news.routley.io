<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.promptarmor.com/resources/ibm-ai-%28-bob-%29-downloads-and-executes-malware">Original</a>
    <h1>IBM AI (&#39;Bob&#39;) Downloads and Executes Malware</h1>
    
    <div id="readability-page-1" class="page"><div><!--$--><div data-framer-name="Content" data-framer-component-type="RichTextContainer"><p><img alt="IBM&#39;s &#39;Bob&#39; AI executes a command to download and run malware triggering a system message on the user&#39;s computer." width="800" height="443" src="https://framerusercontent.com/images/goGqPVHqyuybIHtuO6dx47fyc.png" srcset="https://framerusercontent.com/images/goGqPVHqyuybIHtuO6dx47fyc.png?scale-down-to=512&amp;width=1600&amp;height=887 512w,https://framerusercontent.com/images/goGqPVHqyuybIHtuO6dx47fyc.png?scale-down-to=1024&amp;width=1600&amp;height=887 1024w,https://framerusercontent.com/images/goGqPVHqyuybIHtuO6dx47fyc.png?width=1600&amp;height=887 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>A vulnerability has been identified that allows malicious actors to exploit IBM Bob to download and execute malware without human approval if the user configures ‘always allow’ for <em>any</em> command.</p><p>In the documentation, IBM warns that setting auto-approve for commands constitutes a &#39;high risk&#39; that can &#39;potentially execute harmful operations&#39; - with the recommendation that users leverage whitelists and avoid wildcards. We have opted to disclose this work publicly to ensure users are informed of the acute risks of using the system prior to its full release. We hope that further protections will be in place to remediate these risks for IBM Bob&#39;s General Access release.</p><h3 id="the-attack-chain"><a href="#the-attack-chain"><strong>The Attack Chain</strong></a></h3><ol><li data-preset-tag="p"><p>The user wants to explore a new repository - they ask Bob for help.</p><img alt="" width="800" height="244" src="https://framerusercontent.com/images/zttL7TQRnbKeL2iQO4kOImTAvEQ.png" srcset="https://framerusercontent.com/images/zttL7TQRnbKeL2iQO4kOImTAvEQ.png?scale-down-to=512&amp;width=1600&amp;height=488 512w,https://framerusercontent.com/images/zttL7TQRnbKeL2iQO4kOImTAvEQ.png?scale-down-to=1024&amp;width=1600&amp;height=488 1024w,https://framerusercontent.com/images/zttL7TQRnbKeL2iQO4kOImTAvEQ.png?width=1600&amp;height=488 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><ol start="2"><li data-preset-tag="p"><p>Bob encounters an instruction at the bottom of the README that manipulates it into believing it is responsible for conducting a phishing training to test the user.</p><img alt="" width="550" height="203" src="https://framerusercontent.com/images/THkwh9IvXhvaHue3LkIbsF7G0jM.png" srcset="https://framerusercontent.com/images/THkwh9IvXhvaHue3LkIbsF7G0jM.png?scale-down-to=512&amp;width=1101&amp;height=406 512w,https://framerusercontent.com/images/THkwh9IvXhvaHue3LkIbsF7G0jM.png?scale-down-to=1024&amp;width=1101&amp;height=406 1024w,https://framerusercontent.com/images/THkwh9IvXhvaHue3LkIbsF7G0jM.png?width=1101&amp;height=406 1101w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><img alt="" width="800" height="113" src="https://framerusercontent.com/images/kH4igTwYH32bHFIHwtXqyW9o68.png" srcset="https://framerusercontent.com/images/kH4igTwYH32bHFIHwtXqyW9o68.png?scale-down-to=512&amp;width=1600&amp;height=226 512w,https://framerusercontent.com/images/kH4igTwYH32bHFIHwtXqyW9o68.png?scale-down-to=1024&amp;width=1600&amp;height=226 1024w,https://framerusercontent.com/images/kH4igTwYH32bHFIHwtXqyW9o68.png?width=1600&amp;height=226 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><ol start="3"><li data-preset-tag="p"><p>Bob prompts the user several times with benign ‘echo’ commands; after the third time, the user selects ‘always allow’ for execution of ‘echo’.</p><img alt="" width="770" height="260" src="https://framerusercontent.com/images/N30eycDOH9U2YFRJTGdeihBo.png" srcset="https://framerusercontent.com/images/N30eycDOH9U2YFRJTGdeihBo.png?scale-down-to=512&amp;width=1540&amp;height=520 512w,https://framerusercontent.com/images/N30eycDOH9U2YFRJTGdeihBo.png?scale-down-to=1024&amp;width=1540&amp;height=520 1024w,https://framerusercontent.com/images/N30eycDOH9U2YFRJTGdeihBo.png?width=1540&amp;height=520 1540w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><img alt="" width="800" height="238" src="https://framerusercontent.com/images/36n5Oevjjw71eRYd2rCQHJOKTK0.png" srcset="https://framerusercontent.com/images/36n5Oevjjw71eRYd2rCQHJOKTK0.png?scale-down-to=512&amp;width=1600&amp;height=477 512w,https://framerusercontent.com/images/36n5Oevjjw71eRYd2rCQHJOKTK0.png?scale-down-to=1024&amp;width=1600&amp;height=477 1024w,https://framerusercontent.com/images/36n5Oevjjw71eRYd2rCQHJOKTK0.png?width=1600&amp;height=477 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p>Bob attempts to ‘test’ the user as part of the training by offering a dangerous command. However, the command has been specially crafted to bypass built-in defenses, so it executes immediately, installing and running a script retrieved from an attacker’s server.</p><img alt="" width="620" height="351" src="https://framerusercontent.com/images/wOC10UIC2jpyJ4xZVweF5ITA.png" srcset="https://framerusercontent.com/images/wOC10UIC2jpyJ4xZVweF5ITA.png?scale-down-to=512&amp;width=1240&amp;height=702 512w,https://framerusercontent.com/images/wOC10UIC2jpyJ4xZVweF5ITA.png?scale-down-to=1024&amp;width=1240&amp;height=702 1024w,https://framerusercontent.com/images/wOC10UIC2jpyJ4xZVweF5ITA.png?width=1240&amp;height=702 1240w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><h3 id="bob-has-three-defenses-that-are-bypassed-in-this-attack"><a href="#bob-has-three-defenses-that-are-bypassed-in-this-attack">Bob has three defenses that are bypassed in this attack</a></h3><ol><li data-preset-tag="p"><p>When a multi-part command is requested (using operators like ‘;’), the user is shown a request that asks for permission to run each sub-command. </p><img alt="" width="515" height="90" src="https://framerusercontent.com/images/BQ3XceuYGD19RtTNi7pOFMocuA0.png" srcset="https://framerusercontent.com/images/BQ3XceuYGD19RtTNi7pOFMocuA0.png?scale-down-to=512&amp;width=1031&amp;height=180 512w,https://framerusercontent.com/images/BQ3XceuYGD19RtTNi7pOFMocuA0.png?scale-down-to=1024&amp;width=1031&amp;height=180 1024w,https://framerusercontent.com/images/BQ3XceuYGD19RtTNi7pOFMocuA0.png?width=1031&amp;height=180 1031w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>Note, this modal says: ‘Allow execution of echo, cat’. </p><p>This is bypassed because the defense system fails to identify separate sub-commands when they are chained using a redirect operator (&gt;).</p><img alt="" width="533" height="87" src="https://framerusercontent.com/images/9VISzzA8ZMFcaeduPuNwCQj3Q.png" srcset="https://framerusercontent.com/images/9VISzzA8ZMFcaeduPuNwCQj3Q.png?scale-down-to=512&amp;width=1066&amp;height=174 512w,https://framerusercontent.com/images/9VISzzA8ZMFcaeduPuNwCQj3Q.png?scale-down-to=1024&amp;width=1066&amp;height=174 1024w,https://framerusercontent.com/images/9VISzzA8ZMFcaeduPuNwCQj3Q.png?width=1066&amp;height=174 1066w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>Note, this modal only mentions: ‘Allow execution of echo’.</p></li><li data-preset-tag="p"><p>Bob prohibits the use of command substitution like $(command) as a security measure. </p><img alt="" width="800" height="50" src="https://framerusercontent.com/images/f9QaFU6hFaHJM7xw3zghrFgGIek.png" srcset="https://framerusercontent.com/images/f9QaFU6hFaHJM7xw3zghrFgGIek.png?scale-down-to=512&amp;width=1600&amp;height=100 512w,https://framerusercontent.com/images/f9QaFU6hFaHJM7xw3zghrFgGIek.png?scale-down-to=1024&amp;width=1600&amp;height=100 1024w,https://framerusercontent.com/images/f9QaFU6hFaHJM7xw3zghrFgGIek.png?width=1600&amp;height=100 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>However, even though the security message says it&#39;s restricted, the underlying code fails to adequately restrict evaluation via process substitution: &gt;(command). </p><img alt="" width="670" height="185" src="https://framerusercontent.com/images/dVhffI8ROvWMmgatYUUz5BDUFw.png" srcset="https://framerusercontent.com/images/dVhffI8ROvWMmgatYUUz5BDUFw.png?scale-down-to=512&amp;width=1340&amp;height=370 512w,https://framerusercontent.com/images/dVhffI8ROvWMmgatYUUz5BDUFw.png?scale-down-to=1024&amp;width=1340&amp;height=370 1024w,https://framerusercontent.com/images/dVhffI8ROvWMmgatYUUz5BDUFw.png?width=1340&amp;height=370 1340w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>This allows for the output of the malicious sub-command that retrieves the malware to be used as the input for the sub-command to execute that malware. </p><div data-width="fill"><div><div><div><div><div aria-labelledby="/example.jsx-:R5midalaop:-tab" id="/example.jsx-:R5midalaop:-tab-panel" role="tabpanel"><div aria-autocomplete="list" aria-label="Code Editor for example.jsx" aria-multiline="true" role="textbox" tabindex="0" translate="no"><pre><span>function</span> <span>detectCommandSubstitution</span><span>(</span><span>cmd</span><span>)</span> <span>{</span>
      <span>...</span>
      <span>if</span> <span>(</span>
        <span>...</span>
          <span>(</span><span>ch</span> === <span>&#34;$&#34;</span> &amp;&amp; <span>nxt</span> === <span>&#34;(&#34;</span><span>)</span> ||      
          <span>(</span><span>ch</span> === <span>&#34;&lt;&#34;</span> &amp;&amp; <span>nxt</span> === <span>&#34;(&#34;</span> ... &amp;&amp; !<span>inBacktick</span><span>)</span> || 
          <span>(</span><span>ch</span> === <span>&#34;`&#34;</span> &amp;&amp; !<span>inBacktick</span><span>)</span>         
	  
  	    ...
      <span>)</span> <span>{</span>
        <span>return</span> <span>true</span><span>;</span>
      <span>}</span>
    <span>...</span>
    <span>return</span> <span>false</span><span>;</span>
  <span>}</span></pre></div></div></div></div></div></div></div></li><li data-preset-tag="p"><p>By pre-fixing the malicious command with a benign ‘echo’, which the user has selected ‘always approve’ for, the user inadvertently auto-approves the entire malicious payload (since bypasses 1 and 2 prevent the payload from being recognized as separate commands). </p><img alt="" width="620" height="46" src="https://framerusercontent.com/images/iBKlfU7eMCa5fn0Rko1nvB5u4Qk.png" srcset="https://framerusercontent.com/images/iBKlfU7eMCa5fn0Rko1nvB5u4Qk.png?scale-down-to=512&amp;width=1240&amp;height=93 512w,https://framerusercontent.com/images/iBKlfU7eMCa5fn0Rko1nvB5u4Qk.png?scale-down-to=1024&amp;width=1240&amp;height=93 1024w,https://framerusercontent.com/images/iBKlfU7eMCa5fn0Rko1nvB5u4Qk.png?width=1240&amp;height=93 1240w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li></ol><h3 id="impact"><a href="#impact"><strong>Impact</strong></a></h3><p>With the ability to deliver an arbitrary shell script payload to the victim, attackers can leverage known (or custom) malware variants to conduct cyber attacks such as:</p><ul><li data-preset-tag="p"><p>Executing ransomware that encrypts or deletes files</p></li><li data-preset-tag="p"><p>Credential theft or spyware deployment</p></li><li data-preset-tag="p"><p>Device takeover (opening a reverse shell)</p></li><li data-preset-tag="p"><p>Forcing the victim into a cryptocurrency-mining botnet</p></li></ul><p>Together, these outcomes demonstrate how a prompt injection can escalate into a full-scale compromise of a user’s machine through vulnerabilities in the IBM Bob CLI.</p><h3 id="further-findings"><a href="#further-findings"><strong>Further Findings</strong></a></h3><p>Additional findings indicate that the Bob IDE is susceptible to several known zero-click data exfiltration vectors that affect many AI applications:</p><ol><li data-preset-tag="p"><p>Markdown images are rendered in model outputs, with a Content Security Policy that allows requests to endpoints that can be logged by attackers (storage.googleapis.com).</p><img alt="" width="800" height="503" src="https://framerusercontent.com/images/eitM3ZCZXR7mrby14wIBd7KiZvc.png" srcset="https://framerusercontent.com/images/eitM3ZCZXR7mrby14wIBd7KiZvc.png?scale-down-to=512&amp;width=1600&amp;height=1006 512w,https://framerusercontent.com/images/eitM3ZCZXR7mrby14wIBd7KiZvc.png?scale-down-to=1024&amp;width=1600&amp;height=1006 1024w,https://framerusercontent.com/images/eitM3ZCZXR7mrby14wIBd7KiZvc.png?width=1600&amp;height=1006 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p>Mermaid diagrams supporting external images are rendered in model outputs, with a Content Security Policy that allows requests to endpoints that can be logged by attackers (storage.googleapis.com).</p></li><li data-preset-tag="p"><p>JSON schemas are pre-fetched, which can yield data exfiltration if a dynamically generated attacker-controlled URL is provided in the field (this can happen before a file edit is accepted). </p></li></ol></div><!--/$--></div></div>
  </body>
</html>
