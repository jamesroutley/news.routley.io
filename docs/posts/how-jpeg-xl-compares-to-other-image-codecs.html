<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cloudinary.com/blog/how_jpeg_xl_compares_to_other_image_codecs">Original</a>
    <h1>How JPEG XL compares to other image codecs</h1>
    
    <div id="readability-page-1" class="page"><div>
        <div><p>A year ago, <a href="https://www.youtube.com/watch?v=RYJf7kelYQQ">I talked about JPEG XL at ImageCon 2019</a>. It’s time for an update.</p>


<p><a href="https://jpeg.org/jpegxl/">JPEG XL</a> is a next-generation image codec currently being standardized by the <a href="https://jpeg.org/index.html">JPEG Committee</a>. Based on <a href="https://github.com/google/pik">Google’s PIK</a> codec and <a href="https://github.com/cloudinary/fuif">Cloudinary’s Free Universal Image Format (FUIF)</a> codec, JPEG XL has created a sum that’s greater than the parts by leveraging the best elements of Google PIK and FUIF:</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_400,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/jpegxl-cld-pik.png" alt="JPEG XL evolution" loading="lazy" width="400" height="101.5"/></p>
<ul>
<li>From PIK, JPEG XL has reaped the focus on strong <a href="https://opensource.google/projects/butteraugli">psychovisual modeling</a> and preservation of detail and texture, as well as <a href="http://dx.doi.org/10.1117/12.2556264">decode speed</a>, in particular enabling parallelization and efficient cropped decoding of huge (gigapixel or more) images.</li>
<li>From FUIF, JPEG XL has brought in the cornerstone on being <a href="https://cloudinary.com/blog/introducing_fuif_responsive_images_by_design">responsive by design and universal</a>.</li>
<li>From PIK and FUIF, JPEG XL has learned to put a tremendous emphasis on being <a href="https://cloudinary.com/blog/fuif_new_legacy_friendly_image_file_format">legacy friendly</a>, delivering a smooth transition from existing file formats (notably <a href="https://github.com/google/brunsli">JPEG</a>, but also PNG, GIF, and TIFF) to JPEG XL.</li>
</ul>
<p>The key features of JPEG XL are described in a <a href="http://ds.jpeg.org/whitepapers/jpeg-xl-whitepaper.pdf">recent white paper</a> published by the JPEG Committee.</p>


<p>This section highlights the important features that distinguish JPEG XL from other state-of-the-art image codecs like HEIC and AVIF.</p>


<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_400,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/Main-Image-Troll.jpg" alt="Troll" loading="lazy" width="400" height="200"/>
<em><a href="https://bitmovin.com/caveat-troglodytarum-trolls-beware/">Image attribution: Bitmovin</a></em></p>
<p>Although they can never make guarantees (patent trolls can always suddenly wake up), the contributors who created JPEG XL have agreed to license the reference implementation under the Apache 2.0 license. That means that, besides being Free and Open Source Software (FOSS), JPEG XL also comes with a royalty-free patent grant.</p>
<p>That’s not at all the case for the High Efficiency Image File Format (HEIC), which is based on the HEIF container, on which <a href="https://github.com/nokiatech/heif/blob/master/LICENSE.TXT">Nokia claims patents</a>; and the High Efficiency Video Coding (HEVC) codec, which is a <a href="https://www.streamingmedia.com/Articles/Editorial/Featured-Articles/The-Future-of-HEVC-Licensing-Is-Bleak-Declares-MPEG-Chairman-122983.aspx">complete patent mess</a>. For the AV1 Image File Format (AVIF), the patent situation looks better since it’s based on AV1, and <a href="http://aomedia.org/the-alliance-for-open-media-statement/">being royalty free was a major goal</a> of the Alliance for Open Media, which created AV1. It is <a href="https://www.sisvel.com/licensing-programs/audio-and-video-coding-decoding/video-coding-platform/license-terms/av1-license-terms">not clear</a>, though, to what extent AV1 is actually royalty free. Moreover,  AVIF is based on the HEIF container so Nokia patents might apply as well.</p>


<p>You can transcode existing JPEG files effectively and reversibly to JPEG XL without any additional loss. Not so for previous attempts at creating “next-generation” image formats, such as JPEG 2000, JPEG XR, WebP, and now HEIC and AVIF. Transcoding to one of those other formats requires decoding the JPEG image to pixels and then re-encoding those pixels with the other format—an irreversible process that leads to <a href="https://cloudinary.com/blog/why_jpeg_is_like_a_photocopier"><strong>generation loss</strong></a>.</p>
<p>To me, legacy friendliness is an important feature that facilitates a smooth transition from JPEG to a successor format <strong>without</strong> requiring a transition period in which two versions of every image—the old JPEG file and the new “successor-format” file—must be stored to satisfy the long tail of users who haven’t upgraded yet. Such a requirement completely defeats the purpose of improved image compression.</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_700,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/Encoder_diagram.png" alt="Encoder diagram" loading="lazy" width="1400" height="1244"/></p>


<p>Especially for web delivery, it would be desirable to <a href="https://cloudinary.com/blog/introducing_fuif_responsive_images_by_design">avoid having to store and serve multiple variants of the same image</a> according to the viewer’s viewport width. Equally desirable is an option to <a href="https://cloudinary.com/blog/progressive_jpegs_and_green_martians">progressively</a> decode images, showing a <a href="https://www.guypo.com/introducing-lqip-low-quality-image-placeholders">low-quality image placeholder</a> when only a few hundred bytes have arrived and adding more detail as the rest of the data shows up. JPEG XL ably supports both nice-to-haves.</p>
<p>As a rule, image formats that are based on video codecs do not support those two worthwhile features because the concept doesn’t make much sense for a single video frame. <a href="https://cloudinary.com/tools/compress-webp">WebP</a> (based on VP8), HEIC (based on HEVC), and AVIF (based on AV1) only offer sequential decoding, i.e., the image loads at full detail from top to bottom, and you must wait until it has almost been completely transferred before getting an inkling of the image content.</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_700,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/sequantial_decode_truncated.jpg" alt="Slow loading" loading="lazy" width="1400" height="870"/></p>


<p>JPEG XL is particularly effective with image compression at perceptual qualities that range from visually nearly lossless (in a side-by-side comparison), over visually completely lossless (in a flicker test, which is stricter than a side-by-side evaluation), to mathematically lossless. A lot of effort has been mounted to preserve subtle texture and other fine image details. Even though you can take advantage of the codec at lower bitrates, where the degradation becomes obvious, it really shines at the relatively higher bitrates.</p>
<p>In contrast, image formats based on video codecs tend to excel at the very low bitrates: they can produce a nice image in just a few bytes. The image looks good at first but, on closer inspection, often seems weirdly “plasticy,” e.g., skin complexion becomes very smooth as if the compression applied a huge amount of foundation cream, or “distilled” like an oil painting. That’s acceptable for video codecs: you need a low bitrate to keep the file size or bandwidth reasonably low and, since frames are typically only shown for less than 40 milliseconds, the audience usually doesn’t notice such artifacts. For still images, however, a higher quality is often desired.</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/Web_Assets/blog/low-bitrate_HEIC.gif" alt="low-bitrate HEIC" loading="lazy" width="400" height="512"/>
<em>Illustration: low-bitrate HEIC can smooth out a lot of fine image details</em></p>


<p>The JPEG XL reference encoder (cjpegxl) produces, by default, a well-compressed image that is indistinguishable from (or, in some cases, identical to) the original. In contrast, other image formats typically have an encoder with which you can select a quality setting, where <em>quality</em> is not really defined perceptually. Consequently, one image might look fine as a quality-60 JPEG while another might still contain annoying artifacts as a quality-90 JPEG.</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/f_jpg,q_97/Web_Assets/blog/high_fidelity.png" alt="high fidelity PNG" loading="lazy" width="400" height="400"/>
<em>Original PNG image (2.6 MB)</em></p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/Web_Assets/blog/high_fidelity.png.jxl.png" alt="high fidelity JPEG XL" loading="lazy" width="400" height="400"/>
<em>JPEG XL (default settings, 53 KB): indistinguishable from the original</em></p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/Web_Assets/blog/high_fidelity_webp.png" alt="high fidelity WebP" loading="lazy" width="400" height="400"/>
<em>WebP (53 KB): some mild but noticeable color banding along with blurry text</em></p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/Web_Assets/blog/jpeg_high_fidelity.jpg" alt="high fidelity JPEG" loading="lazy" width="400" height="400"/>
<em>JPEG (53 KB): strong color banding, halos around the text, small text hard to read</em></p>
<p>Zooming in a bit, you can see how JPEG XL preserves the text even better than a five-times- larger quality-95 JPEG, which still emits some subtle discrete cosine transform (<a href="https://cloudinary.com/glossary/dct-compression">DCT</a>) noise around the letters. At a similar compression rate, HEIC, WebP, and JPEG look significantly worse than JPEG XL for this image.</p>

<p>Internally, JPEG XL leverages a novel, perceptually-motivated color space called XYB. Most other codecs still use the YCbCr color space, usually with chroma subsampling. YCbCr, which is rooted in analog color television, is a relatively crude and somewhat dated attempt at modeling human color perception. Part of YCbCr’s problem is lack of precision, especially in the dark colors and in the blues and reds. That’s why <a href="https://www.youtube.com/watch?v=h9j89L8eQQk">dark video scenes are often a terrible blocky mess</a>.</p>
<p>Thanks to its more accurate color handling, JPEG XL is better at avoiding color-banding issues—even in those difficult darks.</p>
<table>
    <tbody>
      <tr>
         <td>Original PNG (1.3 MB)</td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/v1590006353/Web_Assets/blog/gradient.png" width="512" height="80"/></td>
      </tr>
      <tr>
         <td>Original </td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/e_brightness:50/Web_Assets/blog/gradient.png" width="512" height="80"/></td>
      </tr><tr>
         <td>JPEG XL </td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/e_brightness:50/Web_Assets/blog/gradient.jxl.png" width="512" height="80"/></td>
      </tr>
      <tr>
         <td>HEIC </td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/e_brightness:50/Web_Assets/blog/gradient_heic.png" width="512" height="80"/></td>
      </tr>
      <tr>
         <td>WebP </td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/e_brightness:50/Web_Assets/blog/gradient.webp.png" width="512" height="80"/></td>
      </tr>
      <tr>
         <td>JPEG </td>
         <td><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/e_brightness:50/Web_Assets/blog/gradient_jpd.png" width="512" height="80"/></td>
      </tr>
   </tbody>
</table>


<p>JPEG XL handles numerous image types, including regular photographs; illustrations; cartoons; computer-generated images; logos; user-interface elements; screenshots; maps; medical imagery; images for printing, e.g., Cyan Magenta Yellow Black (CMYK) with additional spot colors; scientific images; satellite images; game graphics; huge images (gigapixel or even terapixel); tiny icons; images with alpha transparency, selection masks or depth information; layered images; and so on.</p>
<p>Apropos of workflows, you can leverage JPEG XL not only as a web-delivery format, but also as a local storage and an exchange format for authoring workflows, for which fast and effective lossless compression and high <a href="https://cloudinary.com/glossary/bit-depth">bit depth</a> are important. In terms of functionality and compression, JPEG XL fully supersedes JPEG, PNG, GIF, WebP, and TIFF.</p>
<p>In contrast, video codec-based formats tend to have limitations that do not matter for video but that might impact still images in terms of dimensions, bit depth, number of channels, and types of image content.</p>
<table>
   <thead>
      <tr>
         <th>Format</th>
         <th>Maximum Image Dimensions </th>
         <th>Maximum Bit Depth, </th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td>JPEG
         </td><td>4,294 megapixels (65,535 x 65,535)</td>
         <td>8-bit, three channels (or four for CMYK)</td>
      </tr>
         <tr><td>PNG</td>
         <td>Theoretically 4 exapixels </td>
         <td>16-bit, four channels (RGBA)</td>
      </tr>
         <tr><td>WebP</td>
         <td>268 megapixels </td>
         <td>8-bit, four channels (RGBA)</td>
      </tr>
         <tr><td>HEIC</td>
         <td>35 megapixels <sup id="fnref-1"><a href="#fn-1">1</a></sup>  </td>
         <td>16-bit, three channels </td>
      </tr>
         <tr><td>AVIF</td>
         <td>9 megapixels <sup id="fnref-1"><a href="#fn-1">1</a></sup>  </td>
         <td>12-bit, three channels </td>
      </tr>
         <tr><td>JPEGXL</td>
         <td>1,152,921,502,459 megapixels </td>
         <td>24-bit (integer) or 32-bit (float), </td>
      </tr>
   </tbody>
</table>
<hr/>
<ol>
<li id="fn-1">HEIC and AVIF can handle larger images but not directly in a single code stream. You must decompose the image into a grid of independently encoded tiles, which could cause discontinuities at the grid boundaries. <i>Illustration: grid boundary discontinuities in a HEIC-compressed image. _HEIC and AVIF can handle larger images but not directly in a single code stream. You must decompose the image into a grid of independently encoded tiles, which could cause discontinuities at the grid boundaries. </i>Illustration: grid boundary discontinuities in a HEIC-compressed image._
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/Web_Assets/blog/grid_boundary.gif" alt="Grid boundry" loading="lazy" width="1280" height="512"/></p>
<hr/>


<p>You can encode or decode modern video codecs like AV1 and HEVC in software, but the computational cost is high, especially for well-optimized encoding. Dedicated hardware is desirable or even required to efficiently implement such codecs. In contrast, you can easily encode or decode JPEG XL in software on current hardware. The speed results in the table below are based on four CPU cores.</p>
<table>
   <thead>
      <tr>
         <th>Codec</th>
         <th>Encoding Speed (MP/s)</th>
         <th>Decoding Speed (MP/s)</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td>JPEG (libjpeg-turbo)
         </td><td>49</td>
         <td>108</td>
      </tr>
         <tr><td>HEVC (HM)</td>
         <td>0.014</td>
         <td>5.3</td>
      </tr>
         <tr><td>HEVC (x265)</td>
         <td>3.7</td>
         <td>14</td>
      </tr>
         <tr><td>JPEG XL</td>
         <td>50</td>
         <td>132</td>
      </tr>
   </tbody>
</table>


<p>You might conclude from the above that AVIF and HEIC are pointless. That’s not true; they have three important strengths.</p>


<p>Both AVIF and HEIC can reach very low bitrates yet still produce presentable images. For all that, obviously, a lot of the image information has vanished, the compression artifacts are much less bothersome than those of JPEG.</p>
<p>For applications for which bandwidth, storage reduction, or both of those factors are the main concern, i.e., they are more important than image fidelity, AVIF and HEIC might come in handy. On the other hand, if bandwidth is the major issue, then you might also desire progressive or responsive decoding, which AVIF and HEIC do not support.</p>


<p>Even though you can create animation in JPEG XL, it offers no advanced video-codec features, such as <a href="https://cloudinary.com/glossary/motion-estimation">motion estimation</a>. JPEG XL compresses better than GIF, APNG, and animated WebP but cannot compete with actual video codecs for production of “natural” video. Even for a three-second looping video or <a href="https://cloudinary.com/glossary/cinemagraphs">cinemagraph</a>, where most of the image is static, actual video codecs like AV1 and HEVC can compress much better than still-image codecs.</p>


<p>HEIC already works well far and wide in the Apple ecosystem. No matter that HEIC doesn’t yet function in the Safari browser as a web image format, it does already support HEVC as a video codec.</p>
<p>AV1 shines as a video codec in the Google Chrome and Firefox ecosystems, and AVIF could follow suit. With the influential Alliance for Open Media as its sponsor, AV1 counts among its many proponents giant enterprises. Furthermore, hardware devices for AV1 are already available.</p>
<p>HEIC and AVIF are now on tap. JPEG XL is still in the final stages of standardization, however, and does not yet work in browsers.</p>


<p>The JPEG Committee is a working group of the International Standards Organization (ISO) and the International Electrotechnical Commission (IEC). The standardization process takes time, involving multiple stages of balloting, in which the draft specification is scrutinized by various national-standards bodies, including the American National Standards Institute (ANSI) in the U.S., Deutsches Institut für Normung e.V. (DIN) in Germany, the Japanese Industrial Standards Committee (JISC) in Japan, etc.</p>
<p>The main stages of the standardization process are New Project (NP), Working Draft (WD), Committee Draft (CD), Draft International Standard (DIS), Final DIS (FDIS), and International Standard (IS).</p>
<p><img decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_700,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/iso_process.png" alt="ISO Process" loading="lazy" width="1400" height="312"/></p>
<p>The JPEG XL standard will consist of four parts:</p>
<ul>
<li>
<strong>Part 1 (the main part)</strong>, which describes the codestream (the actual image codec), is currently in the DIS stage.</li>
<li>
<strong>Part 2</strong>, which describes the file format (the container that wraps the codestream and additional metadata or extensions), has just proceeded to the CD stage.</li>
<li>
<strong>Part 3</strong>, which describes the procedure for testing conformance of JPEG XL decoders, is in the WD stage.</li>
<li>
<strong>Part 4</strong>, which is the <a href="https://gitlab.com/wg1/jpeg-xl">reference implementation</a>, is also in the WD stage.</li>
</ul>
<p>If everything goes as planned, an International Standard for part 1 will be available at the beginning of 2021; for the other parts, at the end of 2021.</p>
<p>In practice, once the process reaches the FDIS stage, the spec is “frozen” and you can use JPEG XL for real. Nonetheless, it’ll still take time and effort to garner software support for JPEG XL in applications and on platforms. Dethroning the old JPEG will not be a trivial task, as evidenced by several failed attempts in the past. We are hopeful that we’ll succeed this time around and that we’ve created a worthy successor to a 30-year-old image format that’s as old as the World Wide Web, that’s older than Google, that’s twice as old as Facebook and Twitter, and that’s three times as old as WhatsApp, Instagram, and Cloudinary.</p>
<p>Here’s hoping that, once it becomes a standard, JPEG XL will last for 30 years, too!</p>
<p>For a deep dive into the topics on the current visual web, see the Cloudinary 2020 <a href="https://cloudinary.com/state-of-visual-media-report">State of the Visual Media Report</a>, or download the full report below.</p>
<div>

<p><a href="https://res.cloudinary.com/cloudinary-marketing/image/upload/state_of_visual_media/2020/downloadable-report/2020-sovm-report.pdf" target="_blank"><span><em><img loading="lazy" decoding="async" src="https://res.cloudinary.com/cloudinary-marketing/image/upload/w_201,c_fill,f_auto,q_auto,dpr_2.0/Web_Assets/blog/Cloudinary-SocialCards-General_BlogBanner.png" alt="State of Visual Media report” width=" 201"="" height="260"/></em></span></a></p>
</div>
</li></ol></div>
      </div></div>
  </body>
</html>
