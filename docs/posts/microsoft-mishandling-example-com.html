<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tinyapps.org/blog/microsoft-mishandling-example-com.html">Original</a>
    <h1>Microsoft mishandling example.com</h1>
    
    <div id="readability-page-1" class="page"><article>


<p><b>TL;DR:</b> Since at least February 2020, Microsoft&#39;s <a href="https://learn.microsoft.com/en-us/exchange/architecture/client-access/autodiscover">Autodiscover</a> service has incorrectly routed the IANA-reserved <code>example.com</code> to Sumitomo Electric Industries&#39; mail servers at sei.co.jp, potentially sending test credentials there.</p>

<h2>Problem</h2>

<p>While setting up <code>email@example.com</code> as a dummy account in Outlook (on both Windows and macOS), Outlook consistently auto-configured it to use <code>imapgms.jnet.sei.co.jp</code> (IMAP) and <code>smtpgms.jnet.sei.co.jp</code> (SMTP) despite <code>example.com</code> being an <a href="https://www.iana.org/help/example-domains">IANA-reserved domain</a> that should not resolve to real services.</p>

<p>The same behavior appeared on different machines, profiles, networks, and DNS resolvers, including a newly provisioned <a href="https://www.microsoft.com/en-us/windows-365">Windows 365 Cloud PC</a>:</p>

<p><video controls="" preload="metadata" poster="https://tinyapps.org/screenshots/outlook-sei.png" width="640" height="502" playsinline="">
<source src="https://tinyapps.org/screenshots/outlook-sei.mp4" type="video/mp4"/>
Your web browser doesn&#39;t support embedded video.
</video></p>

<h2>Confirmation</h2>

<h3>DNS verification</h3>

<p>Confirm that <code>example.com</code> has no DNS records pointing to <code>sei.co.jp</code>:</p>

<pre><samp>%</samp><code> dig MX example.com +short</code>
<samp>0 .

%</samp><code> dig CNAME autodiscover.example.com +short</code>
<samp>(no response)

%</samp><code> dig SRV _autodiscover._tcp.example.com +short</code>
<samp>(no response)</samp></pre>

<p>The domain has a null MX record (indicating it doesn&#39;t accept email) and no Autodiscover DNS entries, confirming the misconfiguration exists entirely within Microsoft&#39;s database.</p>

<h3>Microsoft autodiscover API response</h3>

<p>Microsoft&#39;s Autodiscover service misconfiguration can be confirmed via <code>curl -v -u &#34;email@example.com:password&#34; &#34;https://prod.autodetect.outlook.cloud.microsoft/autodetect/detect?app=outlookdesktopBasic&#34;</code>:</p>

<details>
<summary>View full output</summary>
<pre><samp>
* Host prod.autodetect.outlook.cloud.microsoft:443 was resolved.
* IPv6: (none)
* IPv4: 172.169.69.94
*   Trying 172.169.69.94:443...
* Connected to prod.autodetect.outlook.cloud.microsoft (172.169.69.94) port 443
* ALPN: curl offers h2,http/1.1
* (304) (OUT), TLS handshake, Client hello (1):
*  CAfile: /etc/ssl/cert.pem
*  CApath: none
* (304) (IN), TLS handshake, Server hello (2):
* (304) (IN), TLS handshake, Unknown (8):
* (304) (IN), TLS handshake, Certificate (11):
* (304) (IN), TLS handshake, CERT verify (15):
* (304) (IN), TLS handshake, Finished (20):
* (304) (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / AEAD-AES256-GCM-SHA384 / [blank] / UNDEF
* ALPN: server accepted h2
* Server certificate:
*  subject: C=US; ST=WA; L=Redmond; O=Microsoft Corporation; CN=autodetect.outlookmobile.com
*  start date: Nov  1 12:31:46 2025 GMT
*  expire date: Jan 30 12:31:46 2026 GMT
*  subjectAltName: host &#34;prod.autodetect.outlook.cloud.microsoft&#34; matched cert&#39;s &#34;*.autodetect.outlook.cloud.microsoft&#34;
*  issuer: C=US; O=Microsoft Corporation; CN=Microsoft Azure RSA TLS Issuing CA 03
*  SSL certificate verify ok.
* using HTTP/2
* Server auth using Basic with user &#39;email@example.com&#39;
* [HTTP/2] [1] OPENED stream for https://prod.autodetect.outlook.cloud.microsoft/autodetect/detect?app=outlookdesktopBasic
* [HTTP/2] [1] [:method: GET]
* [HTTP/2] [1] [:scheme: https]
* [HTTP/2] [1] [:authority: prod.autodetect.outlook.cloud.microsoft]
* [HTTP/2] [1] [:path: /autodetect/detect?app=outlookdesktopBasic]
* [HTTP/2] [1] [authorization: Basic ZW1haWxAZXhhbXBsZS5jb206cGFzc3dvcmQ=]
* [HTTP/2] [1] [user-agent: curl/8.7.1]
* [HTTP/2] [1] [accept: */*]
&gt; GET /autodetect/detect?app=outlookdesktopBasic HTTP/2
&gt; Host: prod.autodetect.outlook.cloud.microsoft
&gt; Authorization: Basic ZW1haWxAZXhhbXBsZS5jb206cGFzc3dvcmQ=
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/2 200 
&lt; content-type: application/json; charset=utf-8
&lt; date: Mon, 08 Dec 2025 21:32:58 GMT
&lt; server: Kestrel
&lt; strict-transport-security: max-age=2592000
&lt; x-olm-source-endpoint: /detect
&lt; x-provider-id: seeatest
&lt; x-debug-support: eyJkZWNpc2lvbiI6ImF1dG9EdjIgPiBhdXRvRHYxID4gZml4ZWQgZGIgcHJvdmlkZXIgPiBmaXhlZCBkYiBkb21haW4gcHJvdG9jb2xzID4gZGIgcHJvdmlkZXIgPiBkYiBkb21haW4gcHJvdG9jb2xzIiwiYXV0b0QiOnsidjIiOm51bGwsInYxIjpudWxsfSwiZGIiOnsicHJvdmlkZXIiOnsiRG9tYWluSWQiOm51bGwsIklkIjoic2VlYXRlc3QiLCJTZXJ2aWNlIjpudWxsLCJQcm90b2NvbHMiOlt7InByb3RvY29sIjoic210cCIsIkRvbWFpbiI6bnVsbCwiSG9zdG5hbWUiOiJzbXRwZ21zLmpuZXQuc2VpLmNvLmpwIiwiUG9ydCI6NDY1LCJFbmNyeXB0aW9uIjoiU3NsIiwiSXNDcm93ZHNvdXJjZWQiOm51bGwsIkZlZWRiYWNrcyI6bnVsbCwiSW5zZWN1cmUiOm51bGwsIlNlY3VyZSI6IlRydWUiLCJVc2VybmFtZSI6IntlbWFpbH0iLCJWYWxpZGF0ZWQiOmZhbHNlLCJBdXRvZGlzY292ZXIiOm51bGwsIkFhZCI6bnVsbH0seyJwcm90b2NvbCI6ImltYXAiLCJEb21haW4iOm51bGwsIkhvc3RuYW1lIjoiaW1hcGdtcy5qbmV0LnNlaS5jby5qcCIsIlBvcnQiOjk5MywiRW5jcnlwdGlvbiI6IlNzbCIsIklzQ3Jvd2Rzb3VyY2VkIjpudWxsLCJGZWVkYmFja3MiOm51bGwsIkluc2VjdXJlIjpudWxsLCJTZWN1cmUiOiJUcnVlIiwiVXNlcm5hbWUiOiJ7ZW1haWx9IiwiVmFsaWRhdGVkIjpmYWxzZSwiQXV0b2Rpc2NvdmVyIjpudWxsLCJBYWQiOm51bGx9XSwiQ3JlYXRlZEF0IjoiMjAyMC0wMi0wM1QwNTozMToyMy4yOTgwMjQ4IiwiVXBkYXRlZEF0IjoiMjAyMC0wMi0wM1QwOToxMjo1OS4wMjQ1ODciLCJQcmVkaWNhdGVzIjpudWxsLCJBdXRvRHYyRW5kcG9pbnQiOm51bGwsIkNvbW1lbnQiOm51bGwsIkZlZWRiYWNrcyI6bnVsbCwiSXNDcm93ZHNvdXJjZWQiOmZhbHNlfSwiZG9tYWluIjp7ImZpeGVkIjpmYWxzZSwiYXV0b0R2MkVuZHBvaW50IjpudWxsLCJwcm92aWRlcklkIjoic2VlYXRlc3QiLCJwcm90b2NvbHMiOm51bGx9fX0=
&lt; x-autodv2-error: ENOTFOUND
&lt; x-feedback-token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJEIjoiZXhhbXBsZS5jb20iLCJQSSI6InNlZWF0ZXN0IiwiUyI6W10sIlAiOlsiaW1hcHM6Ly9pbWFwZ21zLmpuZXQuc2VpLmNvLmpwOjk5MyIsInNtdHBzOi8vc210cGdtcy5qbmV0LnNlaS5jby5qcDo0NjUiXSwiUFQiOiJpbWFwIHNtdHAiLCJleHAiOjE3NjUyMzMxNzgsImlhdCI6MTc2NTIyOTU3OH0.-ohD7c9hytRZK_b4EJ0M5Tke7hl8u1wjsMYRV71GZik
&lt; x-dns-prefetch-control: off
&lt; x-frame-options: SAMEORIGIN
&lt; x-download-options: noopen
&lt; x-content-type-options: nosniff
&lt; x-xss-protection: 1; mode=block
&lt; x-instance-id: autodetect-deployment-76fffc487d-wfs4b
&lt; x-response-time: 3472 ms
&lt; x-request-id: f1b6525f-6d11-4add-a0e4-0b677d89f9eb
&lt; x-autodetect-cv: f1b6525f-6d11-4add-a0e4-0b677d89f9eb
&lt; 
* Connection #0 to host prod.autodetect.outlook.cloud.microsoft left intact
{&#34;email&#34;:&#34;email@example.com&#34;,&#34;services&#34;:[],&#34;protocols&#34;:[{&#34;protocol&#34;:&#34;imap&#34;,&#34;hostname&#34;:&#34;imapgms.jnet.sei.co.jp&#34;,&#34;port&#34;:993,&#34;encryption&#34;:&#34;ssl&#34;,&#34;username&#34;:&#34;email@example.com&#34;,&#34;validated&#34;:false},{&#34;protocol&#34;:&#34;smtp&#34;,&#34;hostname&#34;:&#34;smtpgms.jnet.sei.co.jp&#34;,&#34;port&#34;:465,&#34;encryption&#34;:&#34;ssl&#34;,&#34;username&#34;:&#34;email@example.com&#34;,&#34;validated&#34;:false}]}%</samp></pre>
</details>

<p>The JSON response:</p>

<pre><samp>{
  &#34;email&#34;: &#34;email@example.com&#34;,
  &#34;services&#34;: [],
  &#34;protocols&#34;: [
    {
      &#34;protocol&#34;: &#34;imap&#34;,
      &#34;hostname&#34;: &#34;imapgms.jnet.sei.co.jp&#34;,
      &#34;port&#34;: 993,
      &#34;encryption&#34;: &#34;ssl&#34;,
      &#34;username&#34;: &#34;email@example.com&#34;,
      &#34;validated&#34;: false
    },
    {
      &#34;protocol&#34;: &#34;smtp&#34;,
      &#34;hostname&#34;: &#34;smtpgms.jnet.sei.co.jp&#34;,
      &#34;port&#34;: 465,
      &#34;encryption&#34;: &#34;ssl&#34;,
      &#34;username&#34;: &#34;email@example.com&#34;,
      &#34;validated&#34;: false
    }
  ]
}</samp></pre>

<h3>Decoded debug header</h3>

<p>The <code>x-debug-support</code> header (Base64-decoded) reveals additional details:</p>

<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Provider ID</td>
<td><code>seeatest</code></td>
</tr>
<tr>
<td>Created</td>
<td>2020-02-03 05:31:23 UTC</td>
</tr>
<tr>
<td>Updated</td>
<td>2020-02-03 09:12:59 UTC</td>
</tr>
<tr>
<td>IsCrowdsourced</td>
<td><code>false</code></td>
</tr>
</tbody>
</table>

<p>This misconfiguration has existed for nearly six years and was not crowdsourced. It appears to have been manually added to Microsoft&#39;s database.</p>

<h2>Related</h2>

<ul>
<li><p><a href="https://www.akamai.com/blog/security/autodiscovering-the-great-leak">Autodiscovering the Great Leak</a></p></li>
<li><p><a href="https://news.sophos.com/en-us/2021/09/23/how-outlook-autodiscover-could-leak-your-passwords-and-how-to-stop-it/">How Outlook “autodiscover” could leak your passwords – and how to stop it</a></p></li>
<li><p><a href="https://c7solutions.com/2021/05/outlook-autodetect-and-broken-autodiscover">Outlook AutoDetect And Broken AutoDiscover</a></p></li>
</ul>
<p>❧ 2026-01-01</p>
</article></div>
  </body>
</html>
