<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://docs.gitlab.com/ee/user/project/push_options.html">Original</a>
    <h1>Push Options: Control Gitlab CI/CD and Merges with Git Push</h1>
    
    <div id="readability-page-1" class="page"><div>
<div>
<div>

<div role="main" itemscope="" itemprop="mainContentOfPage">
<ul id="markdown-toc">
<li><a href="#push-options-for-gitlab-cicd" id="markdown-toc-push-options-for-gitlab-cicd">Push options for GitLab CI/CD</a>
</li><li><a href="#push-options-for-merge-requests" id="markdown-toc-push-options-for-merge-requests">Push options for merge requests</a>
</li><li>
<a href="#useful-git-aliases" id="markdown-toc-useful-git-aliases">Useful Git aliases</a> <ul>
<li><a href="#merge-when-pipeline-succeeds-alias" id="markdown-toc-merge-when-pipeline-succeeds-alias">Merge when pipeline succeeds alias</a>
</li></ul>
</li><li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a>
</li><li><a href="#push-options-for-merge-request-assignment-ignored" id="markdown-toc-push-options-for-merge-request-assignment-ignored">Push options for merge request assignment ignored</a>
</li></ul>

<p>GitLab supports using client-side <a href="https://git-scm.com/docs/git-push#Documentation/git-push.txt--oltoptiongt">Git push options</a>
to perform various actions at the same time as pushing changes. Additionally, <a href="https://docs.gitlab.com/ee/user/project/repository/push_rules.html">Push Rules</a> offer server-side control and enforcement options.
</p><p>Currently, there are push options available for:
</p><ul>
<li><a href="#push-options-for-gitlab-cicd">Skipping CI jobs</a>
</li><li><a href="#push-options-for-merge-requests">Merge requests</a>
</li></ul>
<div><div><div>
<svg role="img" aria-label="note"><use href="/assets/images/icons.svg#information-o"></use><title>note</title></svg><div role="alert"><p>Git push options are only available with Git 2.10 or newer.</p></div>
</div></div></div>
<p>For Git versions 2.10 to 2.17 use <code>--push-option</code>:
</p><div><div><pre><code>git push <span>--push-option</span><span>=</span>&lt;push_option&gt;
</code></pre></div></div>
<p>For version 2.18 and later, you can use the above format, or the shorter <code>-o</code>:
</p><div><div><pre><code>git push <span>-o</span> &lt;push_option&gt;
</code></pre></div></div>
<h2 id="push-options-for-gitlab-cicd">Push options for GitLab CI/CD<a href="#push-options-for-gitlab-cicd" title="Permalink"></a>
</h2>
<p>You can use push options to skip a CI/CD pipeline, or pass CI/CD variables.
</p><table>
<thead>
<tr>
<th>Push option
</th><th>Description
</th><th>Introduced in version
</th></tr></thead><tbody>
<tr>
<td><code>ci.skip</code>
</td><td>Do not create a CI pipeline for the latest push. Only skips branch pipelines and not <a href="https://docs.gitlab.com/ee/ci/pipelines/merge_request_pipelines.html">merge request pipelines</a>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/15643">11.7</a>
</td></tr><tr>
<td><code>ci.variable=&#34;&lt;name&gt;=&lt;value&gt;&#34;</code>
</td><td>Provide <a href="https://docs.gitlab.com/ee/ci/variables/index.html">CI/CD variables</a> to be used in a CI pipeline, if one is created due to the push.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/27983">12.6</a>
</td></tr></tbody></table>
<p>An example of using <code>ci.skip</code>:
</p>
<p>An example of passing some CI/CD variables for a pipeline:
</p><div><div><pre><code>git push <span>-o</span> ci.variable<span>=</span><span>&#34;MAX_RETRIES=10&#34;</span> <span>-o</span> ci.variable<span>=</span><span>&#34;MAX_TIME=600&#34;</span>
</code></pre></div></div>
<h2 id="push-options-for-merge-requests">Push options for merge requests<a href="#push-options-for-merge-requests" title="Permalink"></a>
</h2>
<p>You can use Git push options to perform certain actions for merge requests at the same
time as pushing changes:
</p><table>
<thead>
<tr>
<th>Push option
</th><th>Description
</th><th>Introduced in version
</th></tr></thead><tbody>
<tr>
<td><code>merge_request.create</code>
</td><td>Create a new merge request for the pushed branch.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/26752">11.10</a>
</td></tr><tr>
<td><code>merge_request.target=&lt;branch_name&gt;</code>
</td><td>Set the target of the merge request to a particular branch or upstream project, such as: <code>git push -o merge_request.target=project_path/branch</code>
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/26752">11.10</a>
</td></tr><tr>
<td><code>merge_request.merge_when_pipeline_succeeds</code>
</td><td>Set the merge request to <a href="https://docs.gitlab.com/ee/user/project/merge_requests/merge_when_pipeline_succeeds.html">merge when its pipeline succeeds</a>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/26752">11.10</a>
</td></tr><tr>
<td><code>merge_request.remove_source_branch</code>
</td><td>Set the merge request to remove the source branch when it’s merged.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/issues/64320">12.2</a>
</td></tr><tr>
<td><code>merge_request.title=&#34;&lt;title&gt;&#34;</code>
</td><td>Set the title of the merge request. Ex: <code>git push -o merge_request.title=&#34;The title I want&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/issues/64320">12.2</a>
</td></tr><tr>
<td><code>merge_request.description=&#34;&lt;description&gt;&#34;</code>
</td><td>Set the description of the merge request. Ex: <code>git push -o merge_request.description=&#34;The description I want&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/issues/64320">12.2</a>
</td></tr><tr>
<td><code>merge_request.milestone=&#34;&lt;milestone&gt;&#34;</code>
</td><td>Set the milestone of the merge request. Ex: <code>git push -o merge_request.milestone=&#34;3.0&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/63960">14.1</a>
</td></tr><tr>
<td><code>merge_request.label=&#34;&lt;label&gt;&#34;</code>
</td><td>Add labels to the merge request. If the label does not exist, it is created. For example, for two labels: <code>git push -o merge_request.label=&#34;label1&#34; -o merge_request.label=&#34;label2&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/31831">12.3</a>
</td></tr><tr>
<td><code>merge_request.unlabel=&#34;&lt;label&gt;&#34;</code>
</td><td>Remove labels from the merge request. For example, for two labels: <code>git push -o merge_request.unlabel=&#34;label1&#34; -o merge_request.unlabel=&#34;label2&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab-foss/-/merge_requests/31831">12.3</a>
</td></tr><tr>
<td><code>merge_request.assign=&#34;&lt;user&gt;&#34;</code>
</td><td>Assign users to the merge request. Accepts username or user ID. For example, for two users: <code>git push -o merge_request.assign=&#34;user1&#34; -o merge_request.assign=&#34;user2&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/25904">13.10</a>
</td></tr><tr>
<td><code>merge_request.unassign=&#34;&lt;user&gt;&#34;</code>
</td><td>Remove assigned users from the merge request. Accepts username or user ID.For example, for two users: <code>git push -o merge_request.unassign=&#34;user1&#34; -o merge_request.unassign=&#34;user2&#34;</code>.
</td><td><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/25904">13.10</a>
</td></tr></tbody></table>
<p>If you use a push option that requires text with spaces in it, you need to enclose it
in quotes (<code>&#34;</code>). You can omit the quotes if there are no spaces. Some examples:
</p><div><div><pre><code>git push <span>-o</span> merge_request.label<span>=</span><span>&#34;Label with spaces&#34;</span>
git push <span>-o</span> merge_request.label<span>=</span>Label-with-no-spaces
</code></pre></div></div>
<p>You can combine push options to accomplish multiple tasks at once, by using
multiple <code>-o</code> (or <code>--push-option</code>) flags. For example, if you want to create a new
merge request, and target a branch named <code>my-target-branch</code>:
</p><div><div><pre><code>git push <span>-o</span> merge_request.create <span>-o</span> merge_request.target<span>=</span>my-target-branch
</code></pre></div></div>
<p>Additionally if you want the merge request to merge as soon as the pipeline succeeds you can do:
</p><div><div><pre><code>git push <span>-o</span> merge_request.create <span>-o</span> merge_request.target<span>=</span>my-target-branch <span>-o</span> merge_request.merge_when_pipeline_succeeds
</code></pre></div></div>
<h2 id="useful-git-aliases">Useful Git aliases<a href="#useful-git-aliases" title="Permalink"></a>
</h2>
<p>As shown above, Git push options can cause Git commands to grow very long. If
you use the same push options frequently, it’s useful to create <a href="https://git-scm.com/book/en/v2/Git-Basics-Git-Aliases">Git
aliases</a>. Git aliases
are command line shortcuts for Git which can significantly simplify the use of
long Git commands.
</p><h3 id="merge-when-pipeline-succeeds-alias">Merge when pipeline succeeds alias<a href="#merge-when-pipeline-succeeds-alias" title="Permalink"></a>
</h3>
<p>To set up a Git alias for the <a href="#push-options-for-merge-requests">merge when pipeline succeeds Git push
option</a>:
</p><div><div><pre><code>git config <span>--global</span> alias.mwps <span>&#34;push -o merge_request.create -o merge_request.target=master -o merge_request.merge_when_pipeline_succeeds&#34;</span>
</code></pre></div></div>
<p>Then to quickly push a local branch that targets the default branch and merges when the
pipeline succeeds:
</p><div><div><pre><code>git mwps origin &lt;local-branch-name&gt;
</code></pre></div></div>
<h2 id="troubleshooting">Troubleshooting<a href="#troubleshooting" title="Permalink"></a>
</h2>
<h2 id="push-options-for-merge-request-assignment-ignored">Push options for merge request assignment ignored<a href="#push-options-for-merge-request-assignment-ignored" title="Permalink"></a>
</h2>
<p>When you push a branch to GitLab, you can use push options to assign to (<code>merge_request.assign=&#34;&lt;USERNAME&gt;&#34;</code>)
or unassign from (<code>merge_request.unassign=&#34;&lt;USERNAME&gt;&#34;</code>) a user. If GitLab creates
the merge request successfully, but fails to assign or unassign the merge request
correctly, you can use the user ID instead. For more information, read the issue
<a href="https://gitlab.com/gitlab-org/gitlab/-/issues/325169">Push option <code>merge_request.(un)assign</code> seems to be ignored</a>.
</p></div>
</div>
</div>
</div></div>
  </body>
</html>
