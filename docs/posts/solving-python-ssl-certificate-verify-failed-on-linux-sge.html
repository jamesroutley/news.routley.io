<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://chanind.github.io/python/2023/08/30/python-ssl-certificate-verify-failed.html">Original</a>
    <h1>Solving Python SSL certificate verify failed on Linux / SGE</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>On a system I’ve been working on I’ve been plagued by SSL errors whenever Python would try to download something from the internet. I know it’s possible to edit the requests to not verify SSL certs, but this is code in a third-party library (e.g. <code>nltk.download</code>) which I cannot edit easily. And even if I could, it’s unsettling to disable SSL verification since that opens you up to potentiall man-in-the-middle attacks. The errors would look something like below:</p>

<div><div><pre><code>urlopen error [SSL: CERTIFICATE_VERIFY_FAILED]
certificate verify failed:
unable to get local issuer certificate (_ssl.c:1002)
</code></pre></div></div>

<p>I didn’t have any luck following most of what I found on Stack Overflow to solve this issue, but eventually stumbled on a solution combining ideas from <a href="https://access.redhat.com/articles/2039753">Redhat’s guide to Python cert errors</a>, and <a href="https://stackoverflow.com/a/31915123/245362">a Stack Overlow answer</a>. Specifically, I needed to install certifi certs via <code>pip install certifi</code>, but this was not enough. I then needed to set an ENV var called <code>SSL_CERT_FILE</code> to the location of the certs installed via certifi. I don’t know why Python wasn’t using these certs automatically as it should have been, but this solved the issue for me.</p>

<p>The full steps I took are as follows:</p>



<p>Next, in Python, find the certifi install location by running</p>

<div><div><pre><code><span>from</span> <span>requests.utils</span> <span>import</span> <span>DEFAULT_CA_BUNDLE_PATH</span>
<span>print</span><span>(</span><span>DEFAULT_CA_BUNDLE_PATH</span><span>)</span>
<span># /path/to/python/site-packages/certifi/cacert.pem
</span></code></pre></div></div>

<p>Note the output of the above <code>cacert.pem</code> file, and add the following to <code>.bashrc</code> (or <code>.bash_profile</code> or <code>.zshrc</code>, etc… depending on your system).</p>

<div><div><pre><code><span>export </span><span>SSL_CERT_FILE</span><span>=</span>/path/to/python/site-packages/certifi/cacert.pem
</code></pre></div></div>

<p>Of course, in the above make sure you use that actual path to cacert.pem on your system.</p>

<p>Next, restart the terminal and hopefully everything should work!</p>

  </div>
  
  
</article>

      </div>
    </div></div>
  </body>
</html>
