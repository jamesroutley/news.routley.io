<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Bananymous/banan-os">Original</a>
    <h1>Show HN: Banan-OS, an Unix-like operating system written from scratch</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a href="https://git.bananymous.com/Bananymous/banan-os" rel="nofollow"><img src="https://camo.githubusercontent.com/138af8e93904d20476c6f4d19e8dc6c1853136292bf7edb4c1891becb40f989c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f64796e616d69632f6a736f6e3f75726c3d687474707325334125324625324662616e616e796d6f75732e636f6d25324662616e616e2d6f73253246746f6b65692e6a736f6e2671756572793d2532342e6c696e6573266c6162656c3d746f74616c2532306c696e6573" alt="" data-canonical-src="https://img.shields.io/badge/dynamic/json?url=https%3A%2F%2Fbananymous.com%2Fbanan-os%2Ftokei.json&amp;query=%24.lines&amp;label=total%20lines"/></a>
<a href="https://git.bananymous.com/Bananymous/banan-os" rel="nofollow"><img src="https://camo.githubusercontent.com/0ef8861bdf681dce6369983306d9016d2266097865fec0e84154b0b1b761de2c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6d6d69742d61637469766974792f6d2f42616e616e796d6f75732f62616e616e2d6f73" alt="" data-canonical-src="https://img.shields.io/github/commit-activity/m/Bananymous/banan-os"/></a>
<a href="https://git.bananymous.com/Bananymous/banan-os/src/branch/main/LICENSE" rel="nofollow"><img src="https://camo.githubusercontent.com/97044798f55906a525e307077719e27834cdce087477e7ea135f608aae965cc4/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f62616e616e796d6f75732f62616e616e2d6f73" alt="" data-canonical-src="https://img.shields.io/github/license/bananymous/banan-os"/></a>
<a href="https://discord.gg/ehjGySwYdK" rel="nofollow"><img src="https://camo.githubusercontent.com/aa668f05a2cb56d9412d0a73a8da516ce2e840af413a0f74647636afc7dd5acb/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f313234323136353137363033323239373034303f6c6f676f3d646973636f7264266c6162656c3d646973636f7264" alt="" data-canonical-src="https://img.shields.io/discord/1242165176032297040?logo=discord&amp;label=discord"/></a></p>

<p dir="auto">This is my hobby operating system written in C++. Currently supports x86_64 and i686 architectures.</p>
<p dir="auto">You can find a live demo <a href="https://bananymous.com/banan-os" rel="nofollow">here</a></p>


<ul>
<li> Ring3 userspace</li>
<li> SMP (multiprocessing)</li>
<li> Linear framebuffer (VESA and GOP)</li>
<li> Network stack</li>
<li> ELF executable loading</li>
<li> AML interpreter (partial)</li>
<li> Basic graphical environment
<ul>
<li> Terminal emulator</li>
<li> Status bar</li>
<li> Program launcher</li>
<li> Some nice apps</li>
</ul>
</li>
<li> ELF dynamic linking</li>
<li> copy-on-write memory
<ul>
<li> file mappings</li>
<li> anonymous mappings</li>
</ul>
</li>
</ul>

<ul>
<li> NVMe disks</li>
<li> ATA (IDE, SATA) disks</li>
<li> E1000 and E1000E NICs</li>
<li> RTL8111/8168/8211/8411 NICs</li>
<li> PS2 keyboard (all scancode sets)</li>
<li> PS2 mouse</li>
<li> USB
<ul>
<li> Keyboard</li>
<li> Mouse</li>
<li> Mass storage</li>
<li> Hubs</li>
<li> ...</li>
</ul>
</li>
<li> virtio devices (network, storage)</li>
</ul>

<ul>
<li> ARP</li>
<li> ICMP</li>
<li> IPv4</li>
<li> UDP</li>
<li> TCP (partial and buggy)</li>
<li> Unix domain sockets</li>
<li> SSL</li>
</ul>

<ul>
<li> Virtual filesystem</li>
<li> Ext2</li>
<li> FAT12/16/32</li>
<li> Dev</li>
<li> Ram</li>
<li> Proc</li>
<li> Sys</li>
<li> 9P</li>
</ul>

<ul>
<li> GRUB</li>
<li> Custom BIOS bootloader</li>
<li> Custom UEFI bootloader</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Bananymous/banan-os/blob/main/assets/banan-os.png"><img src="https://github.com/Bananymous/banan-os/raw/main/assets/banan-os.png" alt="screenshot from qemu running banan-os"/></a></p>

<p dir="auto">Each major component and library has its own subdirectory (kernel, userspace, libc, ...). Each directory contains directory <em>include</em>, which has <strong>all</strong> of the header files of the component. Every header is included by its absolute path.</p>


<div dir="auto"><h4 tabindex="-1" dir="auto">apt (tested on ubuntu 22.04)</h4><a id="user-content-apt-tested-on-ubuntu-2204" aria-label="Permalink: apt (tested on ubuntu 22.04)" href="#apt-tested-on-ubuntu-2204"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code># apt install build-essential git ninja-build texinfo bison flex libgmp-dev libmpfr-dev libmpc-dev parted qemu-system-x86 cpu-checker</code></p>

<p dir="auto"><code># pacman -S --needed base-devel git wget cmake ninja parted qemu-system-x86</code></p>

<p dir="auto">To build the toolchain for this os. You can run the following command.</p>
<blockquote>
<p dir="auto"><em><strong>NOTE:</strong></em> The following step has to be done only once. This might take a long time since we are compiling binutils and gcc.</p>
</blockquote>

<p dir="auto">To build the os itself you can run one of the following commands. You will need root access for disk image creation/modification.</p>
<div dir="auto" data-snippet-clipboard-copy-content="./bos qemu
./bos qemu-nographic
./bos qemu-debug
./bos bochs"><pre>./bos qemu
./bos qemu-nographic
./bos qemu-debug
./bos bochs</pre></div>
<p dir="auto">You can also build the kernel or disk image without running it:</p>

<p dir="auto">To build for other architectures set environment variable BANAN_ARCH=<em>arch</em> (e.g. BANAN_ARCH=i686).</p>
<p dir="auto">To change the bootloader you can set environment variable BANAN_BOOTLOADER; supported values are BANAN (my custom bootloader) and GRUB.</p>
<p dir="auto">To run with UEFI set environment variable BANAN_UEFI_BOOT=1. You will also have to set OVMF_PATH to the correct OVMF (default <em>/usr/share/ovmf/x64/OVMF.fd</em>).</p>
<p dir="auto">If you have corrupted your disk image or want to create new one, you can either manually delete <em>build/banan-os.img</em> and build system will automatically create you a new one or you can run the following command.</p>

<p dir="auto">I have also created shell completion script for zsh. You can either copy the file in <em>script/shell-completion/zsh/_bos</em> to <em>/usr/share/zsh/site-functions/</em> or add the <em>script/shell-completion/zsh</em> to your fpath in <em>.zshrc</em>.</p>

<p dir="auto">As the upstream is hosted on my server <a href="https://git.bananymous.com/Bananymous/banan-os" rel="nofollow">https://git.bananymous.com/Bananymous/banan-os</a>, merging contributions is not as trivial as it would be on GitHub. You can still send PRs in GitHub in which case I should be able to download the diff and apply it manually. If you want, I can also provide you an account to my git server. In this case please contact me (<a href="mailto:oskari.alaranta@bananymous.com">email</a>, <a href="https://discord.gg/ehjGySwYdK" rel="nofollow">discord</a>).</p>
<p dir="auto">As this is mostly a learning experience for me, I would appreciate if you first contacted me about adding new features (email, discord, issue, ...). If you send a PR about something I was planning on doing myself and you didn&#39;t ask me, I will probably just close it. Bug fixes are always welcome!</p>
<p dir="auto">Commit message should be formatted followingly</p>
<ol dir="auto">
<li>First line is of the form &#34;<em>Subject: Description</em>&#34;, where <em>Subject</em> tells the area touched (Kernel, Shell, BuildSystem, ...) and <em>Description</em> is brief description of the change done. First line should fit fully in 72 characters.</li>
<li>Body of the message should further describe the change and reasoning behind the change.</li>
</ol>
<p dir="auto">All commits should pass the pre-commit hook defined in <em>.pre-commit-config.yaml</em>. For instructions on how to setup pre-commit, please see <a href="https://pre-commit.com/#install" rel="nofollow">https://pre-commit.com/#install</a>.</p>
</article></div></div>
  </body>
</html>
