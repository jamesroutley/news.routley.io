<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/zesterer/tao">Original</a>
    <h1>Tao: A statically-typed functional language</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">A statically-typed functional language with polymorphism, typeclasses, sum types, pattern-matching, first-class
functions, currying, good diagnostics, and much more!</p>
<a href="https://www.github.com/zesterer/tao">
    <img src="https://raw.githubusercontent.com/zesterer/tao/master/misc/example.png" alt="Demo of Tao&#39;s features"/>
</a>
<p dir="auto">For more example programs, see...</p>
<ul dir="auto">
<li><code>examples/hello.tao</code>: Hello world in Tao</li>
<li><code>examples/adventure.tao</code>: A text adventure game written in Tao</li>
<li><code>examples/brainfuck.tao</code>: A brainfuck interpreter written in Tao</li>
</ul>
<h2 dir="auto"><a id="user-content-goals" aria-hidden="true" href="#goals"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Goals</h2>
<p dir="auto">Right now, Tao is a hobby project and I have no plans to turn it into a production-worthy language. This may change as
the project evolves, but I&#39;d rather spend as much time experimenting with new language features for now. That said, I do
have a few goals for the language itself:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Totality</strong></p>
<ul dir="auto">
<li>All programs <em>must</em> explicitly handle all inputs. There are no mechanisms for panicking, exceptions, etc. The goal
is to build a type system that&#39;s expressive enough to prove the totality of a wide range of programs.</li>
<li>In time, I&#39;d like to see the language develop support for <em>termination analysis</em> techniques like
<a href="https://en.wikipedia.org/wiki/Walther_recursion" rel="nofollow">Walther recursion</a>.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Extreme optimisation</strong></p>
<ul dir="auto">
<li>A rather dogged and obnoxious opinion of mine is that the &#39;optimisation ceiling&#39; for statically-typed, total
functional programming languages is significantly higher than traditional imperative languages with comparably
weak type systems. I want Tao to be a practical example of this that I can point to rather than deploying nebulous
talking points about invariants.</li>
<li>I&#39;ve deliberately made sure that the core MIR of Tao has a very small surface area, making it amenable to a
variety of optimisations and static analyses.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Learning</strong></p>
<ul dir="auto">
<li>I have only a high-school knowledge of mathematics. I want to use Tao as a test bench to help me learn more about
mathematics, proofs, type systems, logic, and computation.</li>
<li>In addition, I hope that Tao can serve as a useful tool for others looking to get into language design, compiler
development, or simply functional programming in general.</li>
</ul>
</li>
</ul>
<h2 dir="auto"><a id="user-content-features" aria-hidden="true" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h2>
<ul>
<li> Hindley-Milner type inference</li>
<li> Useful error messages</li>
<li> Algebraic data types
<ul>
<li> Sum types</li>
<li> Record types</li>
<li> Generic data types</li>
<li> Nominal aliases (i.e: <code>data Metres = Real</code>)</li>
</ul>
</li>
<li> Type aliases</li>
<li> Type polymorphism via generics
<ul>
<li> Class constraints</li>
<li> Associated type equality constraints</li>
<li> Arbitrary <code>where</code> clauses (including associated type equality)</li>
<li> Lazy associated item inference (<code>Foo.Bar.Baz.Biz</code> lazily infers the class at each step!)</li>
<li> Type checker is Turing-complete (is this a feature? Probably not...)</li>
</ul>
</li>
<li> Pattern matching
<ul>
<li> Destructuring and binding</li>
<li> ADT patterns</li>
<li> List patterns (<code>[a, b, c]</code>, <code>[a, b .. c]</code>, etc.)</li>
<li> Arithmetic patterns (i.e: <code>n + k</code>)</li>
<li> Inhabitance checks (i.e: <code>None</code> exhaustively covers <code>Maybe Never</code>)</li>
<li> Recursive exhaustivity checks</li>
<li> <code>let</code> does pattern matching</li>
</ul>
</li>
<li> First-class functions
<ul>
<li> Functions support pattern-matching</li>
<li> Currying</li>
</ul>
</li>
<li> Typeclasses
<ul>
<li> Type parameters</li>
<li> Associated types</li>
<li> Operators are implemented as typeclasses</li>
</ul>
</li>
<li> Monadic IO (due for removal in favour of effect-based IO)
<ul>
<li> <code>do</code> notation</li>
</ul>
</li>
<li> Algebraic effects
<ul>
<li> Effect objects (independent of functions, unlike some languages)</li>
<li> Basin and propagation syntax (equivalent to Haskell&#39;s <code>do</code> notation, or Rust&#39;s <code>async</code> blocks)</li>
<li> Generic effects</li>
<li> Effect sets (i.e: can express values that have multiple side effects)</li>
<li> Effect aliases</li>
<li> Effect handlers (including stateful handlers, allowing expressing effect-driven IO in terms of monadic IO)</li>
</ul>
</li>
<li> Built-in lists
<ul>
<li> Dedicated list construction syntax (<code>[a, b, c]</code>, <code>[a, b .. c, d]</code>, etc.)</li>
</ul>
</li>
<li> Explicit tail call optimisation</li>
<li> MIR optimiser
<ul>
<li> Monomorphisation of generic code</li>
<li> Inlining</li>
<li> Const folding</li>
<li> Symbolic execution</li>
<li> Dead code removal</li>
<li> Exhaustive pattern flattening</li>
<li> Unused function pruning</li>
</ul>
</li>
<li> Bytecode compiler</li>
<li> Bytecode virtual machine</li>
</ul>
<h2 dir="auto"><a id="user-content-current-working-on" aria-hidden="true" href="#current-working-on"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Current working on</h2>
<ul>
<li> Pattern exhaustivity checking (sound, but unnecessarily conservative)</li>
<li> Arithmetic patterns (only nat addition is currently implemented)</li>
<li> Typeclasses
<ul>
<li> Coherence checker</li>
</ul>
</li>
<li> MIR optimiser
<ul>
<li> Unboxing</li>
<li> Automatic repr changes for recursive types
<ul>
<li> Transform <code>data Nat = Succ Nat | Zero</code> into a runtime integer</li>
<li> Transform <code>data List A = Cons (A, List A) | Nil</code> into a vector</li>
</ul>
</li>
</ul>
</li>
<li> Algebraic effects
<ul>
<li> Higher-ranked effects (needed for async, etc.)</li>
<li> Arbitrary resuming/suspending of effect objects</li>
<li> Full monomorphisation of effect objects</li>
</ul>
</li>
</ul>
<h2 dir="auto"><a id="user-content-planned-features" aria-hidden="true" href="#planned-features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Planned features</h2>
<ul>
<li> Better syntax</li>
<li> Module system (instead of <code>import</code> copy/paste)</li>
<li> LLVM/Cranelift backend</li>
</ul>
<h2 dir="auto"><a id="user-content-interesting-features" aria-hidden="true" href="#interesting-features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Interesting features</h2>
<p dir="auto">Here follows a selection of features that are either unique to Tao or are uncommon among other languages.</p>
<h3 dir="auto"><a id="user-content-arithmetic-patterns" aria-hidden="true" href="#arithmetic-patterns"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Arithmetic patterns</h3>
<p dir="auto">Tao&#39;s type system is intended to be completely sound (i.e: impossible to trigger runtime errors beyond &#39;implementation&#39;
factors such as OOM, stack overflow, etc.). For this reason, subtraction of natural numbers yields a signed integer, not
a natural number. However, many algorithms still require that numbers be counted down to zero!</p>
<p dir="auto">To solve this problem, Tao has support for performing arithmetic operations within patterns, binding the result. Because
the compiler intuitively understands these operations, it&#39;s possible to statically determine the soundness of such
operations and guarantee that no runtime errors or overflows can ever occur. Check out this 100% sound factorial
program!</p>
<div data-snippet-clipboard-copy-content="fn factorial =
    | 0 =&gt; 1
    \ y ~ x + 1 =&gt; y * factorial(x)"><pre><span>fn</span> <span>factorial</span> <span>=</span>
    <span>|</span> <span>0</span> <span>=</span><span>&gt;</span> <span>1</span>
    \ <span>y</span> <span>~</span> <span>x</span> <span>+</span> <span>1</span> <span>=</span><span>&gt;</span> <span>y</span> <span>*</span> <span>factorial</span>(<span>x</span>)</pre></div>
<h3 dir="auto"><a id="user-content-all-functions-are-lambdas-and-permit-pattern-matching" aria-hidden="true" href="#all-functions-are-lambdas-and-permit-pattern-matching"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>All functions are lambdas and permit pattern matching</h3>
<p dir="auto">Excluding syntax sugar (like type aliases), Tao has only two high-level constructs: values and types. Every &#39;function&#39;
is actually just a value that corresponds to an line lambda, and the inline lambda syntax naturally generalises to
allow pattern matching. Multiple pattern arguments are permitted, each corresponding to a parameter of the function.</p>
<div data-snippet-clipboard-copy-content="def five =
    let identity = fn x =&gt; x in
    identity(5)"><pre><span>def</span> <span>five</span> <span>=</span>
    <span>let</span> <span>identity</span> <span>=</span> <span>fn</span> <span>x</span> <span>=</span><span>&gt;</span> <span>x</span> <span>in</span>
    <span>identity</span>(<span>5</span>)</pre></div>
<h3 dir="auto"><a id="user-content-exhaustive-pattern-matching" aria-hidden="true" href="#exhaustive-pattern-matching"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exhaustive pattern matching</h3>
<p dir="auto">Tao requires that pattern matching is exhaustive and will produce errors if patterns are not handled.</p>
<h3 dir="auto"><a id="user-content-very-few-delimiters-but-whitespace-isnt-semantic" aria-hidden="true" href="#very-few-delimiters-but-whitespace-isnt-semantic"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Very few delimiters, but whitespace <em>isn&#39;t</em> semantic</h3>
<p dir="auto">In Tao, every value is an expression. Even <code>let</code>, usually a statement in most languages, is an expression. Tao requires
no semicolons and no code blocks because of this fact.</p>
<h3 dir="auto"><a id="user-content-currying-and-prefix-calling" aria-hidden="true" href="#currying-and-prefix-calling"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Currying and prefix calling</h3>
<p dir="auto">In Tao, <code>arg:f</code> is shorthand for <code>f(arg)</code> (function application). Additionally, this prefix syntax can be chained,
resulting in very natural, first-class pipeline syntax.</p>
<div data-snippet-clipboard-copy-content="my_list
    -&gt; filter(fn x =&gt; x % 2 == 0) # Include only even elements
    -&gt; map(fn x =&gt; x * x)         # Square elements
    -&gt; sum                        # Sum elements"><pre><span>my_list</span>
    <span>-</span><span>&gt;</span> <span>filter</span>(<span>fn</span> <span>x</span> <span>=</span><span>&gt;</span> <span>x</span> <span>%</span> <span>2</span> <span>==</span> <span>0</span>) <span># Include only even elements</span>
    <span>-</span><span>&gt;</span> <span>map</span>(<span>fn</span> <span>x</span> <span>=</span><span>&gt;</span> <span>x</span> <span>*</span> <span>x</span>)         <span># Square elements</span>
    <span>-</span><span>&gt;</span> <span>sum</span>                        <span># Sum elements</span></pre></div>
<h3 dir="auto"><a id="user-content-useful-user-friendly-error-diagnostics" aria-hidden="true" href="#useful-user-friendly-error-diagnostics"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Useful, user-friendly error diagnostics</h3>
<p dir="auto">This one is better demonstrated with an image.</p>
<a href="https://www.github.com/zesterer/tao">
    <img src="https://raw.githubusercontent.com/zesterer/tao/master/misc/error.png" alt="Example Tao error"/>
</a>
<p dir="auto">Tao preserves useful information about the input code such as the span of each element, allowing for rich error messages
that guide users towards solutions to their programs. Diagnostic rendering itself is done by my crate
<a href="https://www.github.com/zesterer/ariadne">Ariadne</a>.</p>
<h2 dir="auto"><a id="user-content-commands" aria-hidden="true" href="#commands"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Commands</h2>
<p dir="auto">Compile/run a <code>.tao</code> file</p>

<p dir="auto">Run compiler tests</p>

<p dir="auto">Compile/run the standard library</p>

<h2 dir="auto"><a id="user-content-compiler-arguments" aria-hidden="true" href="#compiler-arguments"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compiler arguments</h2>
<ul dir="auto">
<li>
<p dir="auto"><code>--opt</code>: Specify an optimisation mode (<code>none</code>, <code>fast</code>, <code>size</code>)</p>
</li>
<li>
<p dir="auto"><code>--debug</code>: Enable debugging output for a compilation stage (<code>tokens</code>, <code>ast</code>, <code>hir</code>, <code>mir</code>, <code>bytecode</code>)</p>
</li>
</ul>
</article>
          </div></div>
  </body>
</html>
