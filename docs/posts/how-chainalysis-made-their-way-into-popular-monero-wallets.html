<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.digilol.net/blog/chainanalysis-malicious-xmr.html">Original</a>
    <h1>How Chainalysis Made Their Way into Popular Monero Wallets</h1>
    
    <div id="readability-page-1" class="page"><div data-v-e6f2a212=""><div data-v-e6f2a212=""><div><p><img src="https://www.digilol.net/assets/monerocom-wallet.CuOlZ5hS.webp" alt=""/></p><p><strong>Written by:</strong> İrem Kuyucu, Laurynas Četyrkinas</p><p>A now-deleted and actively censored training video from <a href="https://www.chainalysis.com" target="_blank" rel="noreferrer">Chainalysis</a> — a blockchain analysis company — revealed <a href="https://www.getmonero.org" target="_blank" rel="noreferrer">Monero</a> RPC logs, seemingly from a popular public Monero &#34;node&#34; called <code>node.moneroworld.com</code>. Many wallets like <a href="https://cakewallet.com" target="_blank" rel="noreferrer">Cake Wallet</a> and <a href="https://www.monerujo.io" target="_blank" rel="noreferrer">Monerujo</a> include it in their list of default public nodes. In this post we will explain how Chainalysis&#39;s malicious nodes were given to users choosing the public node <code>node.moneroworld.com</code> and the dangers of <a href="https://danielcremin.substack.com/i/142048479/what-is-a-dangling-dns-record" target="_blank" rel="noreferrer">dangling DNS records</a> of decomissioned Monero nodes.</p><h2 id="what-is-node-moneroworld-com" tabindex="-1">What is <code>node.moneroworld.com</code>? <a href="#what-is-node-moneroworld-com" aria-label="Permalink to &#34;What is `node.moneroworld.com`?&#34;">​</a></h2><p><code>node.moneroworld.com</code> is not an actual Monero node. Instead, the domain has numerous A records pointing to other Monero node IPs. The domain is controlled by the trusted community member <a href="https://github.com/Gingeropolous" target="_blank" rel="noreferrer">Gingeropolous</a> who decides which nodes to add or remove from the <a href="https://en.wikipedia.org/wiki/Round-robin_DNS" target="_blank" rel="noreferrer">Round-robin DNS</a>.</p><blockquote><p><code>node.moneroworld.com</code> at port 18089 - I point this one to whatever I think is best at the time being. Currently, its a small cohort of trusted monero community members.</p></blockquote><p>Source: <a href="https://web.archive.org/web/20240822030528/https://moneroworld.com/#nodes" target="_blank" rel="noreferrer">https://web.archive.org/web/20240822030528/https://moneroworld.com/#nodes</a></p><h2 id="the-monero-rpc-logs-shown-in-the-chainalysis-video" tabindex="-1">The Monero RPC logs shown in the Chainalysis video <a href="#the-monero-rpc-logs-shown-in-the-chainalysis-video" aria-label="Permalink to &#34;The Monero RPC logs shown in the Chainalysis video&#34;">​</a></h2><p>To avoid DMCA claims from Chainalysis, we will redraw the tables from the video but keep the same data. There are two transactions shown in the video which have Monero RPC logs associated with them.</p><h3 id="transaction-1-video-timestamp-29-02" tabindex="-1">Transaction 1 (video timestamp: 29:02) <a href="#transaction-1-video-timestamp-29-02" aria-label="Permalink to &#34;Transaction 1 (video timestamp: 29:02)&#34;">​</a></h3><p><strong>RPC Request:</strong></p><table tabindex="0"><thead><tr><th>Date</th><th>IP Address</th><th>Source</th><th>Request</th><th>Headers</th><th>Body</th></tr></thead><tbody><tr><td>2020-10-20, 10:19:21.190</td><td>185.220.100.252</td><td>003</td><td>POST /sendrawtransaction</td><td>node.moneroworld.com, application/json; charset=utf-8, CL</td><td>client, tx_as_hex</td></tr></tbody></table><h3 id="transaction-2-video-timestamp-35-40" tabindex="-1">Transaction 2 (video timestamp: 35:40) <a href="#transaction-2-video-timestamp-35-40" aria-label="Permalink to &#34;Transaction 2 (video timestamp: 35:40)&#34;">​</a></h3><p><strong>RPC Request:</strong></p><table tabindex="0"><thead><tr><th>Date</th><th>IP Address</th><th>Source</th><th>Request</th><th>Headers</th><th>Body</th></tr></thead><tbody><tr><td>2020-10-02, 12:15:55.669</td><td>85.248.227.164</td><td>140</td><td>POST /sendrawtransaction</td><td>node.moneroworld.com, application/json; charset=utf-8, CL</td><td>client, tx_as_hex</td></tr></tbody></table><p>Unfortunately the tables don&#39;t directly disclose the IP/host information of the malicious nodes run by Chainalysis. But by inspecting the <code>Headers</code> column, we can see that this request was made to <code>node.moneroworld.com</code>, which resolved to a malicious node. Chainalysis&#39;s application UI omits header names and only displays the values, but we can see that:</p><div><pre tabindex="0"><code><span><span>Host: node.moneroworld.com</span></span>
<span><span>Content-Type: application/json; charset=utf-8</span></span>
<span><span>...</span></span></code></pre></div><p>Based on the <code>Source</code> column, we can assume that <code>node.moneroworld.com</code> had A records pointing to at least two Chainalysis nodes (#003, #140) around 2020.</p><p>Luckily, the old DNS records have been cached in services like Virustotal. There is a total of 200 A records dating all the way back to 2017-05-14 in <a href="https://www.virustotal.com/gui/domain/node.moneroworld.com/relations" target="_blank" rel="noreferrer">Virustotal</a>.</p><p><img src="https://www.digilol.net/assets/virustotal-historic-dns.Ca_tlpuK.webp" alt=""/></p><h2 id="the-curious-case-of-dallas-xmrnode-com" tabindex="-1">The curious case of <code>dallas.xmrnode.com</code> <a href="#the-curious-case-of-dallas-xmrnode-com" aria-label="Permalink to &#34;The curious case of `dallas.xmrnode.com`&#34;">​</a></h2><p>On 2024-09-05, Reddit user <a href="https://www.reddit.com/user/__lt__/" target="_blank" rel="noreferrer">u/__lt__</a> made a <a href="https://web.archive.org/web/20240907213249/https://old.reddit.com/r/Monero/comments/1f9h7rw/xmrnodecom_is_very_sus/" target="_blank" rel="noreferrer">post</a> about the strange behavior they observed from one of the affiliated hosts after investigating <code>node.moneroworld.com</code>. The host in question is <code>dallas.xmrnode.com</code> (104.223.103.222). A port scan of it reveals that it has Monero node ports open alongside other services:</p><p><img src="https://www.digilol.net/assets/dallasxmr-shodan.rPl9EqWs.webp" alt=""/></p><p>Nginx on port 443/tcp serves a self-signed certificate for <code>fn.likauction.com</code>. Searching for this hostname on <a href="https://www.shodan.io" target="_blank" rel="noreferrer">Shodan</a> leads to 6 different servers that have the exact same ports open.</p><p><img src="https://www.digilol.net/assets/fnlikauction-shodan.DboQ6gnN.webp" alt=""/></p><p>However as of writing, probing the Monero node ports on these servers reveals that these ports don&#39;t belong to nodes or Monero RPC servers. It could be that the malicious node operators have pulled the plug.</p><p><img src="https://www.digilol.net/assets/probingrpcports.BMID1Exo.webp" alt=""/></p><p>On 2024-09-08 the Reddit post by <a href="https://www.reddit.com/user/__lt__/" target="_blank" rel="noreferrer">u/__lt__</a> was mass reported and removed. It was restored after notifying the moderators on Monero Matrix room. I consider this an example of the <a href="https://en.wikipedia.org/wiki/Streisand_effect" target="_blank" rel="noreferrer">Streisand effect</a>.</p><h2 id="chainalysis-may-be-abusing-dangling-dns-records-of-decomissioned-monero-nodes" tabindex="-1">Chainalysis may be abusing dangling DNS records of decomissioned Monero nodes <a href="#chainalysis-may-be-abusing-dangling-dns-records-of-decomissioned-monero-nodes" aria-label="Permalink to &#34;Chainalysis may be abusing dangling DNS records of decomissioned Monero nodes&#34;">​</a></h2><p>I found this comment on Reddit while dorking for <code>&#34;xmrnode.com&#34;</code>.</p><p><img src="https://www.digilol.net/assets/xmrnodereddit.i-gtOWBQ.webp" alt=""/></p><p>Since we know that there were at least two different malicious nodes and one of them may have been <code>dallas.xmrmode.com</code>, I decided resolve the subdomains in the Reddit comment and search the IPs in the DNS record history of <code>node.moneroworld.com</code>.</p><div><pre tabindex="0"><code><span><span>2017-08-29 - 169.239.128.104 (africa.xmrnode.com)</span></span>
<span><span>2017-09-08 - 96.43.143.242 (kc6.xmrnode.com)</span></span>
<span><span>2017-09-20 - 104.223.103.222 (dallas.xmrmode.com)</span></span>
<span><span>2017-09-22 - 204.27.62.98 (kc3.xmrnode.com)</span></span>
<span><span>2017-10-09 - 213.197.187.236 (europe.xmrnode.com)</span></span>
<span><span>2017-10-09 - 96.43.143.250 (kc7.xmrnode.com)</span></span>
<span><span>2018-04-28 - 103.208.86.41 (nz.xmrnode.com)</span></span>
<span><span>2018-05-03 - 96.43.139.226 (xmrnode.com)</span></span>
<span><span>2018-05-03 - 96.43.139.226 (kc.xmrnode.com)</span></span></code></pre></div><p>Turns out <code>node.moneroworld.com</code> was pointing to many <code>*.xmrnode.com</code> nodes.</p><p>I contacted rupeee in the #Monero Matrix room to ask about the strange behavior of the nodes and to my surprise this was their answer:</p><p><img src="https://www.digilol.net/assets/xmrnodeadminmatrix.h7OZNbIf.webp" alt=""/></p><p>Apparently the nodes haven&#39;t been running since 2018. You can find rest of the conversation <a href="https://web.archive.org/web/20240908231900/https://libera.monerologs.net/monero/20240908" target="_blank" rel="noreferrer">here</a>.</p><p><img src="https://www.digilol.net/assets/xmrnodeadminmatrix1.D0Ysna8M.webp" alt=""/></p><p>Assuming that rupee is not a bad actor, this means that someone other than rupee has been running the nodes (most likely by going to the same hosting provider and asking to get assigned the same IPs). And up to 2020 these nodes were pointed at by <code>node.moneroworld.com</code>, hence the Chainalysis table data from those dates.</p><p>Chainalysis may have abused the leftover DNS records of rupee&#39;s nodes and the A records of <code>node.moneroworld.com</code> which were not removed after rupee stopped hosting the nodes. There is nothing stopping Chainalysis from submitting new public nodes to listings such as monero.fail, but <code>node.moneroworld.com</code> is a more desirable target because of the reputation of the person running it and the fact that it is one of the defaults for popular mobile wallets.</p><h2 id="lessons-learned" tabindex="-1">Lessons learned <a href="#lessons-learned" aria-label="Permalink to &#34;Lessons learned&#34;">​</a></h2><p>Apart from the obvious <strong>RUN YOUR OWN NODE</strong>, if you must use a public node use Tor/i2p and do not use node addresses that aggrate or point to random nodes via DNS records. Because there might be Chainalysis somewhere along the way.</p><p><img src="https://www.digilol.net/assets/xmrtwdnschain.CPsd3Eif.webp" alt=""/></p><h2 id="extra-reverse-proxy-investigation" tabindex="-1">Extra: Reverse proxy investigation <a href="#extra-reverse-proxy-investigation" aria-label="Permalink to &#34;Extra: Reverse proxy investigation&#34;">​</a></h2><p>We speculated that it wouldn’t make much financial sense for malicious actors to operate their own dedicated nodes, given the high resource requirements.</p><p>Instead, we considered that these so-called &#34;fake nodes&#34; might not be real nodes at all but rather Nginx servers acting as reverse proxies, forwarding traffic to legitimate nodes while capturing a copy of the underlying data.</p><p>To investigate this, we quickly developed a tool to gather all public Monero nodes listed by <a href="https://monero.fail" target="_blank" rel="noreferrer">monero.fail</a> and <a href="https://xmr.ditatompel.com/remote-nodes" target="_blank" rel="noreferrer">xmr.ditatompel.com</a>. The tool analyzes them by attempting to identify unique data they generate across various Monero RPC endpoints.</p><div><p><span>go</span></p><pre tabindex="0"><code><span><span>// Copyright 2024 Laurynas Četyrkinas</span></span>
<span><span>//</span></span>
<span><span>// Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</span></span>
<span><span>// you may not use this file except in compliance with the License.</span></span>
<span><span>// You may obtain a copy of the License at</span></span>
<span><span>//</span></span>
<span><span>//     http://www.apache.org/licenses/LICENSE-2.0</span></span>
<span><span>//</span></span>
<span><span>// Unless required by applicable law or agreed to in writing, software</span></span>
<span><span>// distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</span></span>
<span><span>// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span>
<span><span>// See the License for the specific language governing permissions and</span></span>
<span><span>// limitations under the License.</span></span>
<span></span>
<span><span>package</span><span> main</span></span>
<span></span>
<span><span>import</span><span> (</span></span>
<span><span>	&#34;</span><span>context</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>crypto/tls</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>encoding/json</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>fmt</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>log</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>net</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>net/http</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>net/url</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>strings</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>sync</span><span>&#34;</span></span>
<span><span>	&#34;</span><span>time</span><span>&#34;</span></span>
<span><span>)</span></span>
<span></span>
<span><span>type</span><span> MoneroFailNodes</span><span> struct</span><span> {</span></span>
<span><span>	Monero </span><span>struct</span><span> {</span></span>
<span><span>		Clear         []</span><span>string</span><span> `json:&#34;clear&#34;`</span></span>
<span><span>		WebCompatible []</span><span>string</span><span> `json:&#34;web_compatible&#34;`</span></span>
<span><span>	} </span><span>`json:&#34;monero&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> XmrDitatompelNodes</span><span> struct</span><span> {</span></span>
<span><span>	Data </span><span>struct</span><span> {</span></span>
<span><span>		Items []</span><span>struct</span><span> {</span></span>
<span><span>			Hostname    </span><span>string</span><span> `json:&#34;hostname&#34;`</span></span>
<span><span>			Port        </span><span>int</span><span>    `json:&#34;port&#34;`</span></span>
<span><span>			Protocol    </span><span>string</span><span> `json:&#34;protocol&#34;`</span></span>
<span><span>			IsTor       </span><span>bool</span><span>   `json:&#34;is_tor&#34;`</span></span>
<span><span>			IsAvailable </span><span>bool</span><span>   `json:&#34;is_available&#34;`</span></span>
<span><span>			NetType     </span><span>string</span><span> `json:&#34;nettype&#34;`</span></span>
<span><span>		} </span><span>`json:&#34;items&#34;`</span></span>
<span><span>	} </span><span>`json:&#34;data&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> MoneroNode</span><span> struct</span><span> {</span></span>
<span><span>	IP </span><span>map</span><span>[</span><span>string</span><span>]</span><span>NodeIdentifyInfo</span><span> `json:&#34;ip&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> NodeIdentifyInfo</span><span> struct</span><span> {</span></span>
<span><span>	NodeGetInfoResponse            </span><span>NodeGetInfoResponse</span><span>            `json:&#34;get_info&#34;`</span></span>
<span><span>	NodeGetLimitResponse           </span><span>NodeGetLimitResponse</span><span>           `json:&#34;get_limit&#34;`</span></span>
<span><span>	NodeGetAltBlocksHashesResponse </span><span>NodeGetAltBlocksHashesResponse</span><span> `json:&#34;get_alt_blocks_hashes&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> NodeGetInfoResponse</span><span> struct</span><span> {</span></span>
<span><span>	AdjustedTime              </span><span>int64</span><span>  `json:&#34;adjusted_time&#34;`</span></span>
<span><span>	AltBlocksCount            </span><span>int64</span><span>  `json:&#34;alt_blocks_count&#34;`</span></span>
<span><span>	BlockSizeLimit            </span><span>int64</span><span>  `json:&#34;block_size_limit&#34;`</span></span>
<span><span>	BlockSizeMedian           </span><span>int64</span><span>  `json:&#34;block_size_median&#34;`</span></span>
<span><span>	BlockWeightLimit          </span><span>int64</span><span>  `json:&#34;block_weight_limit&#34;`</span></span>
<span><span>	BlockWeightMedian         </span><span>int64</span><span>  `json:&#34;block_weight_median&#34;`</span></span>
<span><span>	BootstrapDaemonAddress    </span><span>string</span><span> `json:&#34;bootstrap_daemon_address&#34;`</span></span>
<span><span>	BusySyncing               </span><span>bool</span><span>   `json:&#34;busy_syncing&#34;`</span></span>
<span><span>	Credits                   </span><span>int64</span><span>  `json:&#34;credits&#34;`</span></span>
<span><span>	CumulativeDifficulty      </span><span>int64</span><span>  `json:&#34;cumulative_difficulty&#34;`</span></span>
<span><span>	CumulativeDifficultyTop64 </span><span>int64</span><span>  `json:&#34;cumulative_difficulty_top64&#34;`</span></span>
<span><span>	DatabaseSize              </span><span>int64</span><span>  `json:&#34;database_size&#34;`</span></span>
<span><span>	Difficulty                </span><span>int64</span><span>  `json:&#34;difficulty&#34;`</span></span>
<span><span>	DifficultyTop64           </span><span>int64</span><span>  `json:&#34;difficulty_top64&#34;`</span></span>
<span><span>	FreeSpace                 </span><span>uint64</span><span> `json:&#34;free_space&#34;`</span></span>
<span><span>	GreyPeerlistSize          </span><span>int64</span><span>  `json:&#34;grey_peerlist_size&#34;`</span></span>
<span><span>	Height                    </span><span>int64</span><span>  `json:&#34;height&#34;`</span></span>
<span><span>	HeightWithoutBootstrap    </span><span>int64</span><span>  `json:&#34;height_without_bootstrap&#34;`</span></span>
<span><span>	IncomingConnectionsCount  </span><span>int64</span><span>  `json:&#34;incoming_connections_count&#34;`</span></span>
<span><span>	Mainnet                   </span><span>bool</span><span>   `json:&#34;mainnet&#34;`</span></span>
<span><span>	Nettype                   </span><span>string</span><span> `json:&#34;nettype&#34;`</span></span>
<span><span>	Offline                   </span><span>bool</span><span>   `json:&#34;offline&#34;`</span></span>
<span><span>	OutgoingConnectionsCount  </span><span>int64</span><span>  `json:&#34;outgoing_connections_count&#34;`</span></span>
<span><span>	Restricted                </span><span>bool</span><span>   `json:&#34;restricted&#34;`</span></span>
<span><span>	RPCConnectionsCount       </span><span>int64</span><span>  `json:&#34;rpc_connections_count&#34;`</span></span>
<span><span>	Stagenet                  </span><span>bool</span><span>   `json:&#34;stagenet&#34;`</span></span>
<span><span>	StartTime                 </span><span>int64</span><span>  `json:&#34;start_time&#34;`</span></span>
<span><span>	Status                    </span><span>string</span><span> `json:&#34;status&#34;`</span></span>
<span><span>	Synchronized              </span><span>bool</span><span>   `json:&#34;synchronized&#34;`</span></span>
<span><span>	Target                    </span><span>int64</span><span>  `json:&#34;target&#34;`</span></span>
<span><span>	TargetHeight              </span><span>int64</span><span>  `json:&#34;target_height&#34;`</span></span>
<span><span>	Testnet                   </span><span>bool</span><span>   `json:&#34;testnet&#34;`</span></span>
<span><span>	TopBlockHash              </span><span>string</span><span> `json:&#34;top_block_hash&#34;`</span></span>
<span><span>	TopHash                   </span><span>string</span><span> `json:&#34;top_hash&#34;`</span></span>
<span><span>	TxCount                   </span><span>int64</span><span>  `json:&#34;tx_count&#34;`</span></span>
<span><span>	TxPoolSize                </span><span>int64</span><span>  `json:&#34;tx_pool_size&#34;`</span></span>
<span><span>	Untrusted                 </span><span>bool</span><span>   `json:&#34;untrusted&#34;`</span></span>
<span><span>	UpdateAvailable           </span><span>bool</span><span>   `json:&#34;update_available&#34;`</span></span>
<span><span>	Version                   </span><span>string</span><span> `json:&#34;version&#34;`</span></span>
<span><span>	WasBootstrapEverUsed      </span><span>bool</span><span>   `json:&#34;was_bootstrap_ever_used&#34;`</span></span>
<span><span>	WhitePeerlistSize         </span><span>int64</span><span>  `json:&#34;white_peerlist_size&#34;`</span></span>
<span><span>	WideCumulativeDifficulty  </span><span>string</span><span> `json:&#34;wide_cumulative_difficulty&#34;`</span></span>
<span><span>	WideDifficulty            </span><span>string</span><span> `json:&#34;wide_difficulty&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> NodeGetLimitResponse</span><span> struct</span><span> {</span></span>
<span><span>	LimitDown </span><span>int64</span><span>  `json:&#34;limit_down&#34;`</span></span>
<span><span>	LimitUp   </span><span>int64</span><span>  `json:&#34;limit_up&#34;`</span></span>
<span><span>	Status    </span><span>string</span><span> `json:&#34;status&#34;`</span></span>
<span><span>	Untrusted </span><span>bool</span><span>   `json:&#34;untrusted&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>type</span><span> NodeGetAltBlocksHashesResponse</span><span> struct</span><span> {</span></span>
<span><span>	BlksHashes []</span><span>string</span><span> `json:&#34;blks_hashes&#34;`</span></span>
<span><span>	Credits    </span><span>int</span><span>      `json:&#34;credits&#34;`</span></span>
<span><span>	Status     </span><span>string</span><span>   `json:&#34;status&#34;`</span></span>
<span><span>	TopHash    </span><span>string</span><span>   `json:&#34;top_hash&#34;`</span></span>
<span><span>	Untrusted  </span><span>bool</span><span>     `json:&#34;untrusted&#34;`</span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> main</span><span>() {</span></span>
<span><span>	var</span><span> nodes []</span><span>string</span></span>
<span><span>	err </span><span>:=</span><span> fetchMoneroFailNodes</span><span>(</span><span>&amp;</span><span>nodes)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		log.</span><span>Println</span><span>(</span><span>&#34;Error fetching nodes:&#34;</span><span>, err)</span></span>
<span><span>		return</span></span>
<span><span>	}</span></span>
<span><span>	err </span><span>=</span><span> fetchXmrDitatompelNodes</span><span>(</span><span>&amp;</span><span>nodes)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		log.</span><span>Println</span><span>(</span><span>&#34;Error fetching nodes:&#34;</span><span>, err)</span></span>
<span><span>		return</span></span>
<span><span>	}</span></span>
<span><span>	moneroNodes </span><span>:=</span><span> make</span><span>(</span><span>map</span><span>[</span><span>string</span><span>]</span><span>MoneroNode</span><span>)</span></span>
<span><span>	var</span><span> wg1, wg2 </span><span>sync</span><span>.</span><span>WaitGroup</span></span>
<span><span>	var</span><span> mu </span><span>sync</span><span>.</span><span>Mutex</span></span>
<span><span>	for</span><span> _, host </span><span>:=</span><span> range</span><span> nodes {</span></span>
<span><span>		wg1.</span><span>Add</span><span>(</span><span>1</span><span>)</span></span>
<span><span>		go</span><span> func</span><span>(</span><span>host</span><span> string</span><span>) {</span></span>
<span><span>			defer</span><span> wg1.</span><span>Done</span><span>()</span></span>
<span><span>			var</span><span> node </span><span>MoneroNode</span></span>
<span><span>			node.IP </span><span>=</span><span> make</span><span>(</span><span>map</span><span>[</span><span>string</span><span>]</span><span>NodeIdentifyInfo</span><span>)</span></span>
<span><span>			pUrl, err </span><span>:=</span><span> url.</span><span>Parse</span><span>(host)</span></span>
<span><span>			if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>				return</span></span>
<span><span>			}</span></span>
<span><span>			ipAddresses, err </span><span>:=</span><span> net.</span><span>LookupIP</span><span>(pUrl.</span><span>Hostname</span><span>())</span></span>
<span><span>			if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>				return</span></span>
<span><span>			}</span></span>
<span><span>			for</span><span> _, ip </span><span>:=</span><span> range</span><span> ipAddresses {</span></span>
<span><span>				ipStr </span><span>:=</span><span> ip.</span><span>String</span><span>()</span></span>
<span><span>				wg2.</span><span>Add</span><span>(</span><span>1</span><span>)</span></span>
<span><span>				go</span><span> func</span><span>(</span><span>ip</span><span>, </span><span>host</span><span> string</span><span>) {</span></span>
<span><span>					defer</span><span> wg2.</span><span>Done</span><span>()</span></span>
<span><span>					nodeInfo, err </span><span>:=</span><span> identifyMoneroNode</span><span>(ip, host)</span></span>
<span><span>					if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>						log.</span><span>Println</span><span>(</span><span>&#34;Failed to getMoneroNodeInfo for:&#34;</span><span>, host, ip, err)</span></span>
<span><span>						return</span></span>
<span><span>					}</span></span>
<span><span>					mu.</span><span>Lock</span><span>()</span></span>
<span><span>					node.IP[ip] </span><span>=</span><span> nodeInfo</span></span>
<span><span>					moneroNodes[host] </span><span>=</span><span> node</span></span>
<span><span>					mu.</span><span>Unlock</span><span>()</span></span>
<span></span>
<span><span>				}(ipStr, host)</span></span>
<span><span>			}</span></span>
<span><span>			wg2.</span><span>Wait</span><span>()</span></span>
<span><span>		}(host)</span></span>
<span><span>	}</span></span>
<span><span>	wg1.</span><span>Wait</span><span>()</span></span>
<span></span>
<span><span>	uniqueNodes </span><span>:=</span><span> make</span><span>(</span><span>map</span><span>[</span><span>string</span><span>][]</span><span>string</span><span>)</span></span>
<span><span>	for</span><span> host, node </span><span>:=</span><span> range</span><span> moneroNodes {</span></span>
<span><span>		for</span><span> ip, info </span><span>:=</span><span> range</span><span> node.IP {</span></span>
<span><span>			rdns </span><span>:=</span><span> &#34;nil&#34;</span></span>
<span><span>			rdnsa, err </span><span>:=</span><span> net.</span><span>LookupAddr</span><span>(ip)</span></span>
<span><span>			if</span><span> err </span><span>==</span><span> nil</span><span> {</span></span>
<span><span>				rdns </span><span>=</span><span> rdnsa[</span><span>0</span><span>]</span></span>
<span><span>			}</span></span>
<span><span>			outJSON, err </span><span>:=</span><span> json.</span><span>Marshal</span><span>(info)</span></span>
<span><span>			strJSON </span><span>:=</span><span> string</span><span>(outJSON)</span></span>
<span><span>			uniqueNodes[strJSON] </span><span>=</span><span> append</span><span>(uniqueNodes[strJSON], ip</span><span>+</span><span>&#34; &#34;</span><span>+</span><span>rdns</span><span>+</span><span>&#34; &#34;</span><span>+</span><span>host)</span></span>
<span><span>		}</span></span>
<span><span>	}</span></span>
<span></span>
<span><span>	group </span><span>:=</span><span> 1</span></span>
<span><span>	for</span><span> _, ips </span><span>:=</span><span> range</span><span> uniqueNodes {</span></span>
<span><span>		fmt.</span><span>Println</span><span>(</span><span>&#34;Host group&#34;</span><span>, group)</span></span>
<span><span>		for</span><span> _, ip </span><span>:=</span><span> range</span><span> ips {</span></span>
<span><span>			fmt.</span><span>Println</span><span>(ip)</span></span>
<span><span>		}</span></span>
<span><span>		group</span><span>++</span></span>
<span><span>		fmt.</span><span>Println</span><span>()</span></span>
<span><span>	}</span></span>
<span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> fetchMoneroFailNodes</span><span>(</span><span>nodes</span><span> *</span><span>[]</span><span>string</span><span>) </span><span>error</span><span> {</span></span>
<span><span>	resp, err </span><span>:=</span><span> http.</span><span>Get</span><span>(</span><span>&#34;https://monero.fail/nodes.json&#34;</span><span>)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> err</span></span>
<span><span>	}</span></span>
<span><span>	defer</span><span> resp.Body.</span><span>Close</span><span>()</span></span>
<span><span>	var</span><span> resNodes </span><span>MoneroFailNodes</span></span>
<span><span>	err </span><span>=</span><span> json.</span><span>NewDecoder</span><span>(resp.Body).</span><span>Decode</span><span>(</span><span>&amp;</span><span>resNodes)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> err</span></span>
<span><span>	}</span></span>
<span><span>	for</span><span> _, host </span><span>:=</span><span> range</span><span> resNodes.Monero.Clear {</span></span>
<span><span>		url, err </span><span>:=</span><span> normalizeURL</span><span>(host)</span></span>
<span><span>		if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>			continue</span></span>
<span><span>		}</span></span>
<span><span>		// Get rid of i2p</span></span>
<span><span>		if</span><span> strings.</span><span>Contains</span><span>(url, </span><span>&#34;.i2p&#34;</span><span>) {</span></span>
<span><span>			continue</span></span>
<span><span>		}</span></span>
<span><span>		addUnique</span><span>(nodes, url)</span></span>
<span><span>	}</span></span>
<span><span>	return</span><span> err</span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> fetchXmrDitatompelNodes</span><span>(</span><span>nodes</span><span> *</span><span>[]</span><span>string</span><span>) </span><span>error</span><span> {</span></span>
<span><span>	resp, err </span><span>:=</span><span> http.</span><span>Get</span><span>(</span><span>&#34;https://xmr.ditatompel.com/api/v1/nodes?page=1&amp;limit=1000&#34;</span><span>)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> err</span></span>
<span><span>	}</span></span>
<span><span>	defer</span><span> resp.Body.</span><span>Close</span><span>()</span></span>
<span><span>	var</span><span> resNodes </span><span>XmrDitatompelNodes</span></span>
<span><span>	err </span><span>=</span><span> json.</span><span>NewDecoder</span><span>(resp.Body).</span><span>Decode</span><span>(</span><span>&amp;</span><span>resNodes)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> err</span></span>
<span><span>	}</span></span>
<span><span>	for</span><span> _, item </span><span>:=</span><span> range</span><span> resNodes.Data.Items {</span></span>
<span><span>		if</span><span> !</span><span>item.IsAvailable </span><span>||</span><span> item.IsTor </span><span>||</span><span> item.NetType </span><span>!=</span><span> &#34;mainnet&#34;</span><span> {</span></span>
<span><span>			continue</span></span>
<span><span>		}</span></span>
<span><span>		u1 </span><span>:=</span><span> url</span><span>.</span><span>URL</span><span>{</span></span>
<span><span>			Scheme: item.Protocol,</span></span>
<span><span>			Host:   fmt.</span><span>Sprintf</span><span>(</span><span>&#34;</span><span>%s</span><span>:</span><span>%s</span><span>&#34;</span><span>, item.Hostname, item.Port),</span></span>
<span><span>		}</span></span>
<span><span>		u, err </span><span>:=</span><span> normalizeURL</span><span>(u1.</span><span>String</span><span>())</span></span>
<span><span>		if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>			continue</span></span>
<span><span>		}</span></span>
<span><span>		addUnique</span><span>(nodes, u)</span></span>
<span><span>	}</span></span>
<span><span>	return</span><span> err</span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> normalizeURL</span><span>(</span><span>rawURL</span><span> string</span><span>) (</span><span>string</span><span>, </span><span>error</span><span>) {</span></span>
<span><span>	parsedURL, err </span><span>:=</span><span> url.</span><span>Parse</span><span>(rawURL)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> &#34;&#34;</span><span>, err</span></span>
<span><span>	}</span></span>
<span><span>	if</span><span> parsedURL.Scheme </span><span>==</span><span> &#34;http&#34;</span><span> &amp;&amp;</span><span> parsedURL.</span><span>Port</span><span>() </span><span>==</span><span> &#34;80&#34;</span><span> {</span></span>
<span><span>		parsedURL.Host </span><span>=</span><span> strings.</span><span>TrimSuffix</span><span>(parsedURL.Host, </span><span>&#34;:80&#34;</span><span>)</span></span>
<span><span>	}</span></span>
<span><span>	if</span><span> parsedURL.Scheme </span><span>==</span><span> &#34;https&#34;</span><span> &amp;&amp;</span><span> parsedURL.</span><span>Port</span><span>() </span><span>==</span><span> &#34;443&#34;</span><span> {</span></span>
<span><span>		parsedURL.Host </span><span>=</span><span> strings.</span><span>TrimSuffix</span><span>(parsedURL.Host, </span><span>&#34;:443&#34;</span><span>)</span></span>
<span><span>	}</span></span>
<span><span>	return</span><span> parsedURL.</span><span>String</span><span>(), </span><span>nil</span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> addUnique</span><span>(</span><span>slice</span><span> *</span><span>[]</span><span>string</span><span>, </span><span>item</span><span> string</span><span>) {</span></span>
<span><span>	uniqueMap </span><span>:=</span><span> make</span><span>(</span><span>map</span><span>[</span><span>string</span><span>]</span><span>struct</span><span>{})</span></span>
<span><span>	for</span><span> _, v </span><span>:=</span><span> range</span><span> *</span><span>slice {</span></span>
<span><span>		uniqueMap[v] </span><span>=</span><span> struct</span><span>{}{}</span></span>
<span><span>	}</span></span>
<span><span>	if</span><span> _, exists </span><span>:=</span><span> uniqueMap[item]; </span><span>!</span><span>exists {</span></span>
<span><span>		*</span><span>slice </span><span>=</span><span> append</span><span>(</span><span>*</span><span>slice, item)</span></span>
<span><span>	}</span></span>
<span><span>}</span></span>
<span></span>
<span><span>func</span><span> identifyMoneroNode</span><span>(</span><span>ip</span><span>, </span><span>host</span><span> string</span><span>) (</span><span>NodeIdentifyInfo</span><span>, </span><span>error</span><span>) {</span></span>
<span><span>	client </span><span>:=</span><span> &amp;</span><span>http</span><span>.</span><span>Client</span><span>{</span></span>
<span><span>		Transport: </span><span>&amp;</span><span>http</span><span>.</span><span>Transport</span><span>{</span></span>
<span><span>			DialContext: </span><span>func</span><span>(</span><span>c</span><span> context</span><span>.</span><span>Context</span><span>, </span><span>n</span><span>, </span><span>a</span><span> string</span><span>) (</span><span>net</span><span>.</span><span>Conn</span><span>, </span><span>error</span><span>) {</span></span>
<span><span>				_, port, err </span><span>:=</span><span> net.</span><span>SplitHostPort</span><span>(a)</span></span>
<span><span>				if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>					return</span><span> nil</span><span>, err</span></span>
<span><span>				}</span></span>
<span><span>				return</span><span> net.</span><span>Dial</span><span>(n, net.</span><span>JoinHostPort</span><span>(ip, port))</span></span>
<span><span>			},</span></span>
<span><span>			TLSClientConfig: </span><span>&amp;</span><span>tls</span><span>.</span><span>Config</span><span>{</span></span>
<span><span>				InsecureSkipVerify: </span><span>true</span><span>,</span></span>
<span><span>			},</span></span>
<span><span>		},</span></span>
<span><span>		Timeout: </span><span>5</span><span> *</span><span> time.Second,</span></span>
<span><span>	}</span></span>
<span><span>	req, err </span><span>:=</span><span> http.</span><span>NewRequest</span><span>(</span><span>&#34;GET&#34;</span><span>, host</span><span>+</span><span>&#34;/get_info&#34;</span><span>, </span><span>nil</span><span>)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	req.Host </span><span>=</span><span> host</span></span>
<span><span>	resp, err </span><span>:=</span><span> client.</span><span>Do</span><span>(req)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	defer</span><span> resp.Body.</span><span>Close</span><span>()</span></span>
<span><span>	if</span><span> resp.StatusCode </span><span>!=</span><span> http.StatusOK {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, fmt.</span><span>Errorf</span><span>(</span><span>&#34;Non-OK HTTP status:&#34;</span><span>, resp.Status)</span></span>
<span><span>	}</span></span>
<span><span>	var</span><span> getInfo </span><span>NodeGetInfoResponse</span></span>
<span><span>	err </span><span>=</span><span> json.</span><span>NewDecoder</span><span>(resp.Body).</span><span>Decode</span><span>(</span><span>&amp;</span><span>getInfo)</span></span>
<span></span>
<span><span>	req, err </span><span>=</span><span> http.</span><span>NewRequest</span><span>(</span><span>&#34;GET&#34;</span><span>, host</span><span>+</span><span>&#34;/get_limit&#34;</span><span>, </span><span>nil</span><span>)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	req.Host </span><span>=</span><span> host</span></span>
<span><span>	resp, err </span><span>=</span><span> client.</span><span>Do</span><span>(req)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	defer</span><span> resp.Body.</span><span>Close</span><span>()</span></span>
<span><span>	if</span><span> resp.StatusCode </span><span>!=</span><span> http.StatusOK {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, fmt.</span><span>Errorf</span><span>(</span><span>&#34;Non-OK HTTP status:&#34;</span><span>, resp.Status)</span></span>
<span><span>	}</span></span>
<span><span>	var</span><span> getLimit </span><span>NodeGetLimitResponse</span></span>
<span><span>	err </span><span>=</span><span> json.</span><span>NewDecoder</span><span>(resp.Body).</span><span>Decode</span><span>(</span><span>&amp;</span><span>getLimit)</span></span>
<span></span>
<span><span>	req, err </span><span>=</span><span> http.</span><span>NewRequest</span><span>(</span><span>&#34;GET&#34;</span><span>, host</span><span>+</span><span>&#34;/get_alt_blocks_hashes&#34;</span><span>, </span><span>nil</span><span>)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	req.Host </span><span>=</span><span> host</span></span>
<span><span>	resp, err </span><span>=</span><span> client.</span><span>Do</span><span>(req)</span></span>
<span><span>	if</span><span> err </span><span>!=</span><span> nil</span><span> {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, err</span></span>
<span><span>	}</span></span>
<span><span>	defer</span><span> resp.Body.</span><span>Close</span><span>()</span></span>
<span><span>	if</span><span> resp.StatusCode </span><span>!=</span><span> http.StatusOK {</span></span>
<span><span>		return</span><span> NodeIdentifyInfo</span><span>{}, fmt.</span><span>Errorf</span><span>(</span><span>&#34;Non-OK HTTP status:&#34;</span><span>, resp.Status)</span></span>
<span><span>	}</span></span>
<span><span>	var</span><span> getAltBlocksHashes </span><span>NodeGetAltBlocksHashesResponse</span></span>
<span><span>	err </span><span>=</span><span> json.</span><span>NewDecoder</span><span>(resp.Body).</span><span>Decode</span><span>(</span><span>&amp;</span><span>getAltBlocksHashes)</span></span>
<span></span>
<span><span>	identifyInfo </span><span>:=</span><span> NodeIdentifyInfo</span><span>{</span></span>
<span><span>		NodeGetInfoResponse:            getInfo,</span></span>
<span><span>		NodeGetLimitResponse:           getLimit,</span></span>
<span><span>		NodeGetAltBlocksHashesResponse: getAltBlocksHashes,</span></span>
<span><span>	}</span></span>
<span><span>	return</span><span> identifyInfo, err</span></span>
<span><span>}</span></span></code></pre></div><p>And we got such output out of it <code>{ip} {reverse_dns} {node_url}</code>:</p><div><pre tabindex="0"><code><span><span>Host group 1</span></span>
<span><span>81.163.200.3 pppoe-dynamic-a-3.interblock.pl. http://81.163.200.3:18089</span></span>
<span><span></span></span>
<span><span>Host group 2</span></span>
<span><span>172.232.19.26 172-232-19-26.ip.linodeusercontent.com. http://xmr-node.agates.io:18089</span></span>
<span><span>2600:3c06:1::ace8:131a nil http://xmr-node.agates.io:18089</span></span>
<span><span></span></span>
<span><span>Host group 3</span></span>
<span><span>84.23.142.12 012.ftthmackmyra1.gavlenet.com. http://opennode.xmr-tw.org:18089</span></span>
<span><span>84.23.142.12 012.ftthmackmyra1.gavlenet.com. https://opennode.xmr-tw.org:18089</span></span>
<span><span>84.23.142.12 012.ftthmackmyra1.gavlenet.com. http://xmr.monopolymoney.eu:18089</span></span>
<span><span></span></span>
<span><span>Host group 4</span></span>
<span><span>147.45.79.135 nil http://monerodice.pro:18089</span></span>
<span><span></span></span>
<span><span>Host group 5</span></span>
<span><span>65.109.30.253 iv.datura.network. https://datura.network:18081</span></span>
<span><span>65.109.30.253 iv.datura.network. http://datura.network:18081</span></span>
<span><span></span></span>
<span><span>Host group 6</span></span>
<span><span>82.153.138.209 nil http://82.153.138.209:18089</span></span>
<span><span></span></span>
<span><span>Host group 7</span></span>
<span><span>37.27.70.253 crypto.cruncher.com. https://crypto.cruncher.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 8</span></span>
<span><span>88.99.195.15 static.15.195.99.88.clients.your-server.de. http://node3.monerodevs.org:18089</span></span>
<span><span></span></span>
<span><span>Host group 9</span></span>
<span><span>2a01:4f8:231:76a::2 cheems.de.box.skhron.com.ua. https://monero-rpc.cheems.de.box.skhron.com.ua:18089</span></span>
<span><span>195.201.247.11 cheems.de.box.skhron.com.ua. https://monero-rpc.cheems.de.box.skhron.com.ua:18089</span></span>
<span><span></span></span>
<span><span>Host group 10</span></span>
<span><span>172.105.13.82 xmr.grub.net. http://xmr.grub.net:18089</span></span>
<span><span>172.105.13.82 xmr.grub.net. https://xmr.grub.net:18089</span></span>
<span><span></span></span>
<span><span>Host group 11</span></span>
<span><span>167.114.172.211 xmr.robmanfred.fail. http://xmr.robmanfred.fail:18081</span></span>
<span><span></span></span>
<span><span>Host group 12</span></span>
<span><span>65.21.185.116 static.116.185.21.65.clients.your-server.de. http://node.yeetin.me:18089</span></span>
<span><span></span></span>
<span><span>Host group 13</span></span>
<span><span>87.197.115.178 static-dsl-178.87-197-115.telecom.sk. https://xmr.why.tf:18081</span></span>
<span><span></span></span>
<span><span>Host group 14</span></span>
<span><span>2a0b:f4c2:2::63 tor-exit-63.for-privacy.net. http://xmr-de.boldsuck.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 15</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18889</span></span>
<span><span></span></span>
<span><span>Host group 16</span></span>
<span><span>175.38.15.166 n175-38-15-166.meb2.vic.optusnet.com.au. http://175.38.15.166:18081</span></span>
<span><span></span></span>
<span><span>Host group 17</span></span>
<span><span>51.68.212.53 vps-4a3dd5a8.vps.ovh.net. http://xmr-full.p2pool.uk:18089</span></span>
<span><span></span></span>
<span><span>Host group 18</span></span>
<span><span>185.240.242.36 nodes.hashvault.pro. https://nodes.hashvault.pro:18081</span></span>
<span><span>185.240.242.36 nodes.hashvault.pro. http://nodes.hashvault.pro:18081</span></span>
<span><span></span></span>
<span><span>Host group 19</span></span>
<span><span>92.131.11.157 alille-657-1-66-157.w92-131.abo.wanadoo.fr. https://xmr.mailia.be:18088</span></span>
<span><span>2a01:cb10:249:7300::6 nil https://xmr.mailia.be:18088</span></span>
<span><span></span></span>
<span><span>Host group 20</span></span>
<span><span>135.125.206.110 vps-6fef879a.vps.ovh.net. http://monero.earth:18081</span></span>
<span><span>135.125.206.110 vps-6fef879a.vps.ovh.net. http://vps-6fef879a.vps.ovh.net:18081</span></span>
<span><span></span></span>
<span><span>Host group 21</span></span>
<span><span>176.114.248.225 176-114-248-225.rychlydrat.cz. http://server.cnet.cz:18081</span></span>
<span><span></span></span>
<span><span>Host group 22</span></span>
<span><span>213.165.76.129 ip213-165-76-129.pbiaas.com. http://node.xmr.rocks:18089</span></span>
<span><span></span></span>
<span><span>Host group 23</span></span>
<span><span>79.205.108.252 p4fcd6cfc.dip0.t-ipconnect.de. http://nexper-xmr-node.tplinkdns.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 24</span></span>
<span><span>65.21.100.162 eu.node.monero.net. https://node.monero.net:18081</span></span>
<span><span></span></span>
<span><span>Host group 25</span></span>
<span><span>95.216.15.156 moneronode1.relaycrun.ch. http://moneronode1.relaycrun.ch:18081</span></span>
<span><span></span></span>
<span><span>Host group 26</span></span>
<span><span>167.235.112.134 static.134.112.235.167.clients.your-server.de. http://167.235.112.134:18081</span></span>
<span><span></span></span>
<span><span>Host group 27</span></span>
<span><span>92.131.11.157 alille-657-1-66-157.w92-131.abo.wanadoo.fr. https://node.mailia.be:18085</span></span>
<span><span>2a01:cb10:249:7300:b:c:b:c nil https://node.mailia.be:18085</span></span>
<span><span></span></span>
<span><span>Host group 28</span></span>
<span><span>103.176.58.34 druckt.mavibettv74.com. http://thereisnospoon.pm:18089</span></span>
<span><span></span></span>
<span><span>Host group 29</span></span>
<span><span>144.91.121.7 vmd62396.contaboserver.net. http://144.91.121.7:18089</span></span>
<span><span>144.91.121.7 vmd62396.contaboserver.net. http://econanon.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 30</span></span>
<span><span>37.120.165.105 v22019017574680478.happysrv.de. http://node.cryptocano.de:18089</span></span>
<span><span></span></span>
<span><span>Host group 31</span></span>
<span><span>162.210.173.15 monero.forked.net. http://monero.forked.net:18089</span></span>
<span><span></span></span>
<span><span>Host group 32</span></span>
<span><span>23.128.248.240 nil http://xmr.stormycloud.org:18089</span></span>
<span><span>2602:fc05::240 nil http://xmr.stormycloud.org:18089</span></span>
<span><span></span></span>
<span><span>Host group 33</span></span>
<span><span>71.229.155.41 c-71-229-155-41.hsd1.co.comcast.net. http://xmrbandwagon.hopto.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 34</span></span>
<span><span>202.61.250.91 next.fackler.cloud. http://monero-g2.hexhex.online:18081</span></span>
<span><span></span></span>
<span><span>Host group 35</span></span>
<span><span>2a0b:f4c2:2:1::223 nil http://xmr-de-2.boldsuck.org:18081</span></span>
<span><span>185.220.101.223 tor-exit-223.for-privacy.net. http://xmr-de-2.boldsuck.org:18081</span></span>
<span><span>185.220.101.223 tor-exit-223.for-privacy.net. http://tor-exit-223.for-privacy.net:18081</span></span>
<span><span>2a0b:f4c2:2:1::223 nil http://tor-exit-223.for-privacy.net:18081</span></span>
<span><span></span></span>
<span><span>Host group 36</span></span>
<span><span>207.66.71.46 nil http://monero.sphinxlogic.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 37</span></span>
<span><span>185.112.144.198 vps-185-112-144-198.1984.is. http://185.112.144.198:18089</span></span>
<span><span></span></span>
<span><span>Host group 38</span></span>
<span><span>151.48.191.155 adsl-ull-155-191.48-151.wind.it. http://edge7.servebeer.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 39</span></span>
<span><span>15.204.197.8 monero.stackwallet.com. https://monero.stackwallet.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 40</span></span>
<span><span>190.115.19.98 mail.miningcompany.ltd. http://node.majesticbank.at:18089</span></span>
<span><span>190.115.19.98 mail.miningcompany.ltd. http://node.majesticbank.is:18089</span></span>
<span><span></span></span>
<span><span>Host group 41</span></span>
<span><span>14.224.137.18 static.vnpt.vn. http://monero.hexalink.xyz:18081</span></span>
<span><span></span></span>
<span><span>Host group 42</span></span>
<span><span>85.160.78.94 85-160-78-94.reb.o2.cz. http://85.160.78.94:18089</span></span>
<span><span></span></span>
<span><span>Host group 43</span></span>
<span><span>194.163.176.218 hantaan.fullm00n.de. http://194.163.176.218:18089</span></span>
<span><span>194.163.176.218 hantaan.fullm00n.de. http://hantaan.fullm00n.de:18089</span></span>
<span><span></span></span>
<span><span>Host group 44</span></span>
<span><span>193.200.227.16 dc1-nat.filmweb.pl. http://monero.filmweb.pl:18081</span></span>
<span><span>193.200.227.16 dc1-nat.filmweb.pl. http://193.200.227.16:18081</span></span>
<span><span></span></span>
<span><span>Host group 45</span></span>
<span><span>37.187.74.171 ns3365046.ip-37-187-74.eu. http://node.moneroworld.com:18089</span></span>
<span><span>37.187.74.171 ns3365046.ip-37-187-74.eu. https://node.moneroworld.com:18089</span></span>
<span><span>37.187.74.171 ns3365046.ip-37-187-74.eu. http://node2.monerodevs.org:18089</span></span>
<span><span></span></span>
<span><span>Host group 46</span></span>
<span><span>23.154.81.12 mail.yuuta.moe. https://xmr.winslow.cloud:18081</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18989</span></span>
<span><span></span></span>
<span><span>Host group 47</span></span>
<span><span>65.100.46.162 65-100-46-162.dia.static.qwest.net. http://moneronode.xyz:18089</span></span>
<span><span>2602:41:642e:a610::251 nil http://moneronode.xyz:18089</span></span>
<span><span></span></span>
<span><span>Host group 48</span></span>
<span><span>188.245.34.63 static.63.34.245.188.clients.your-server.de. http://static.63.34.245.188.clients.your-server.de:18089</span></span>
<span><span></span></span>
<span><span>Host group 49</span></span>
<span><span>23.137.57.100 nil http://node.sethforprivacy.com:18089</span></span>
<span><span>68.118.241.70 syn-068-118-241-070.res.spectrum.com. http://68.118.241.70:18089</span></span>
<span><span>23.137.57.100 nil https://node.sethforprivacy.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 50</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. http://node.moneroworld.com:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. https://node.moneroworld.com:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. https://uwillrunanodesoon.moneroworld.com:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. http://opennode.xmr-tw.org:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. http://uwillrunanodesoon.moneroworld.com:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. https://opennode.xmr-tw.org:18089</span></span>
<span><span>192.99.8.110 ns508306.ip-192-99-8.net. http://node.monerodevs.org:18089</span></span>
<span><span></span></span>
<span><span>Host group 51</span></span>
<span><span>38.105.209.54 vmi732985.contaboserver.net. http://38.105.209.54:18089</span></span>
<span><span></span></span>
<span><span>Host group 52</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18189</span></span>
<span><span></span></span>
<span><span>Host group 53</span></span>
<span><span>70.77.245.214 S010694a67ee915ac.cg.shawcable.net. http://compking.ddns.net:18089</span></span>
<span><span></span></span>
<span><span>Host group 54</span></span>
<span><span>194.163.172.26 btc.heelsn.eu. https://xmr.heelsn.eu:18089</span></span>
<span><span></span></span>
<span><span>Host group 55</span></span>
<span><span>23.137.254.9 nil http://23.137.254.9:18081</span></span>
<span><span></span></span>
<span><span>Host group 56</span></span>
<span><span>135.181.202.85 static.85.202.181.135.clients.your-server.de. http://static.85.202.181.135.clients.your-server.de:18089</span></span>
<span><span></span></span>
<span><span>Host group 57</span></span>
<span><span>83.135.90.98 i53875A62.versanet.de. http://monero.firewall-gateway.de:18081</span></span>
<span><span></span></span>
<span><span>Host group 58</span></span>
<span><span>77.237.238.26 vmi1839646.contaboserver.net. http://77.237.238.26:18081</span></span>
<span><span>77.237.238.26 vmi1839646.contaboserver.net. http://xmr.perkele.digital:18081</span></span>
<span><span></span></span>
<span><span>Host group 59</span></span>
<span><span>64.74.162.85 nil http://xmr.vectorlink.io:18089</span></span>
<span><span></span></span>
<span><span>Host group 60</span></span>
<span><span>184.107.109.143 nil http://xmr.vectorlink.io:18089</span></span>
<span><span></span></span>
<span><span>Host group 61</span></span>
<span><span>68.251.60.69 68-251-60-69.lightspeed.sntcca.sbcglobal.net. http://68.251.60.69:18089</span></span>
<span><span></span></span>
<span><span>Host group 62</span></span>
<span><span>179.43.158.213 hostedby.privatelayer.com. https://xmr.yemekyedim.com:18089</span></span>
<span><span>179.43.158.213 hostedby.privatelayer.com. http://xmr.yemekyedim.com:18081</span></span>
<span><span>179.43.158.213 hostedby.privatelayer.com. http://179.43.158.213:18089</span></span>
<span><span>179.43.158.213 hostedby.privatelayer.com. https://xmr.yemekyedim.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 63</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18689</span></span>
<span><span></span></span>
<span><span>Host group 64</span></span>
<span><span>69.85.89.42 nil http://xmr.tcpcat.net:18089</span></span>
<span><span></span></span>
<span><span>Host group 65</span></span>
<span><span>188.40.85.196 static.196.85.40.188.clients.your-server.de. http://monero.homelinux.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 66</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18489</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18789</span></span>
<span><span>179.36.224.11 179-36-224-11.speedy.com.ar. http://monero.10z.com.ar:18089</span></span>
<span><span></span></span>
<span><span>Host group 67</span></span>
<span><span>51.195.219.36 anstee.dev. https://anstee.dev:18081</span></span>
<span><span>2001:41d0:801:2000::5811 anstee.dev. https://anstee.dev:18081</span></span>
<span><span></span></span>
<span><span>Host group 68</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18389</span></span>
<span><span></span></span>
<span><span>Host group 69</span></span>
<span><span>93.95.228.74 vps-93-95-228-74.1984.is. http://93.95.228.74:18089</span></span>
<span><span></span></span>
<span><span>Host group 70</span></span>
<span><span>146.185.21.170 nil http://p2pool.uk:18089</span></span>
<span><span>146.185.21.170 nil http://xmr-pruned.p2pool.uk:18089</span></span>
<span><span></span></span>
<span><span>Host group 71</span></span>
<span><span>185.66.143.190 nil http://xmr.litepay.ch:18081</span></span>
<span><span></span></span>
<span><span>Host group 72</span></span>
<span><span>65.109.50.106 static.106.50.109.65.clients.your-server.de. http://65.109.50.106:18081</span></span>
<span><span></span></span>
<span><span>Host group 73</span></span>
<span><span>190.211.255.227 public.deepdns.net. https://xmr.cryptostorm.is:18081</span></span>
<span><span></span></span>
<span><span>Host group 74</span></span>
<span><span>154.201.90.46 nil http://node.c3pool.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 75</span></span>
<span><span>45.88.200.82 nil http://xm.rip:18081</span></span>
<span><span></span></span>
<span><span>Host group 76</span></span>
<span><span>46.32.46.171 2E202EAB.rev.sefiber.dk. http://46.32.46.171:18081</span></span>
<span><span>46.32.46.171 2E202EAB.rev.sefiber.dk. https://storj.myqnapcloud.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 77</span></span>
<span><span>87.202.12.6 athedsl-03054.home.otenet.gr. http://monero.homeqloud.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 78</span></span>
<span><span>194.5.183.35 nil http://xmr.nodes.masberthet.fr:18081</span></span>
<span><span></span></span>
<span><span>Host group 79</span></span>
<span><span>152.89.105.105 moneronode.org. http://moneronode.org:18081</span></span>
<span><span>152.89.105.105 moneronode.org. https://moneronode.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 80</span></span>
<span><span>104.168.82.96 104-168-82-96-host.colocrossing.com. http://xmr.support:18081</span></span>
<span><span></span></span>
<span><span>Host group 81</span></span>
<span><span>125.168.80.60 60.80.168.125.sta.wbroadband.net.au. http://moneropay.techthis.online:18089</span></span>
<span><span></span></span>
<span><span>Host group 82</span></span>
<span><span>104.153.209.162 nil http://104.153.209.162:18081</span></span>
<span><span></span></span>
<span><span>Host group 83</span></span>
<span><span>185.162.249.141 owl.lc. http://owl.lc:18089</span></span>
<span><span></span></span>
<span><span>Host group 84</span></span>
<span><span>95.217.143.178 static.178.143.217.95.clients.your-server.de. http://rucknium.me:18081</span></span>
<span><span></span></span>
<span><span>Host group 85</span></span>
<span><span>2a01:4f8:a0:3800::7 nil https://xmr2.julias.zone:18089</span></span>
<span><span>88.198.38.83 dedi2.julias.zone. https://xmr2.julias.zone:18089</span></span>
<span><span></span></span>
<span><span>Host group 86</span></span>
<span><span>159.69.153.93 xmrvsbeast.com. http://p2pmd.xmrvsbeast.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 87</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18089</span></span>
<span><span></span></span>
<span><span>Host group 88</span></span>
<span><span>193.168.143.9 nil http://monero.anycolo.net:18081</span></span>
<span><span></span></span>
<span><span>Host group 89</span></span>
<span><span>190.115.29.70 ddos-guard.net. http://node.majesticbank.at:18089</span></span>
<span><span>190.115.29.70 ddos-guard.net. http://node.majesticbank.is:18089</span></span>
<span><span></span></span>
<span><span>Host group 90</span></span>
<span><span>89.147.109.91 vps-89.147.109.91.1984.is. http://89.147.109.91:18089</span></span>
<span><span></span></span>
<span><span>Host group 91</span></span>
<span><span>88.212.32.151 ip-88-212-32-151.antik.sk. http://xmr.ppke.sk:18081</span></span>
<span><span></span></span>
<span><span>Host group 92</span></span>
<span><span>2a01:cb10:249:7300:b:c:b:c nil https://node.mailia.be:18089</span></span>
<span><span>92.131.11.157 alille-657-1-66-157.w92-131.abo.wanadoo.fr. https://node.mailia.be:18089</span></span>
<span><span></span></span>
<span><span>Host group 93</span></span>
<span><span>204.8.45.35 r2.ckwp.dyni.net. http://monero.dyni.net:18081</span></span>
<span><span></span></span>
<span><span>Host group 94</span></span>
<span><span>147.45.79.135 nil https://monerodice.pro:18089</span></span>
<span><span></span></span>
<span><span>Host group 95</span></span>
<span><span>51.195.200.94 vps-a6d1909f.vps.ovh.net. http://node.community.rino.io:18081</span></span>
<span><span></span></span>
<span><span>Host group 96</span></span>
<span><span>135.148.45.230 richfowler.net. http://opennode.xmr-tw.org:18089</span></span>
<span><span>135.148.45.230 richfowler.net. https://opennode.xmr-tw.org:18089</span></span>
<span><span>135.148.45.230 richfowler.net. http://node.richfowler.net:18089</span></span>
<span><span></span></span>
<span><span>Host group 97</span></span>
<span><span>125.229.105.12 125-229-105-12.hinet-ip.hinet.net. http://node1.xmr-tw.org:18081</span></span>
<span><span></span></span>
<span><span>Host group 98</span></span>
<span><span>186.190.208.100 nil http://node3-us.monero.love:18081</span></span>
<span><span></span></span>
<span><span>Host group 99</span></span>
<span><span>141.98.153.205 vmi1917710.contaboserver.net. http://141.98.153.205:18089</span></span>
<span><span></span></span>
<span><span>Host group 100</span></span>
<span><span>50.86.7.28 nil http://xmr.cruxexperts.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 101</span></span>
<span><span>37.187.74.171 ns3365046.ip-37-187-74.eu. https://uwillrunanodesoon.moneroworld.com:18089</span></span>
<span><span>37.187.74.171 ns3365046.ip-37-187-74.eu. http://uwillrunanodesoon.moneroworld.com:18089</span></span>
<span><span></span></span>
<span><span>Host group 102</span></span>
<span><span>184.75.221.107 mojeooffers.net. http://monero.us.to:18193</span></span>
<span><span></span></span>
<span><span>Host group 103</span></span>
<span><span>185.25.108.186 185025108186.net-el.pl. http://185.25.108.186:18081</span></span>
<span><span></span></span>
<span><span>Host group 104</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18289</span></span>
<span><span></span></span>
<span><span>Host group 105</span></span>
<span><span>95.217.178.183 static.183.178.217.95.clients.your-server.de. http://95.217.178.183:18089</span></span>
<span><span>37.27.89.118 static.118.89.27.37.clients.your-server.de. http://37.27.89.118:18089</span></span>
<span><span></span></span>
<span><span>Host group 106</span></span>
<span><span>167.172.30.17 nil http://xmr.bikini.cafe:18081</span></span>
<span><span></span></span>
<span><span>Host group 107</span></span>
<span><span>172.104.202.210 172-104-202-210.ip.linodeusercontent.com. http://xmr-node.cakewallet.com:18081</span></span>
<span><span>172.104.202.210 172-104-202-210.ip.linodeusercontent.com. http://xmr-node-uk.cakewallet.com:18081</span></span>
<span><span>172.104.202.210 172-104-202-210.ip.linodeusercontent.com. http://xmr-node-eu.cakewallet.com:18081</span></span>
<span><span></span></span>
<span><span>Host group 108</span></span>
<span><span>77.51.51.199 nil http://l4nk0r.dev:18089</span></span>
<span><span></span></span>
<span><span>Host group 109</span></span>
<span><span>89.147.109.123 vps-89.147.109.123.1984.is. http://89.147.109.123:18089</span></span>
<span><span></span></span>
<span><span>Host group 110</span></span>
<span><span>185.218.124.120 vmi2088507.contaboserver.net. http://185.218.124.120:18589</span></span></code></pre></div><p>Each host group in this output (regardless of protocol or IP) represents the same underlying Monero node.</p><p>Based on these results we concluded that there is less of such attack happening than we initially thought. However we found a few such hosts:</p><ul><li><strong>Host group 49</strong>: <code>http://68.118.241.70:18089</code> is a proxy for <code>http://node.sethforprivacy.com:18089</code>.</li><li><strong>Host group 66</strong>: <code>http://185.218.124.120:18489</code> is a proxy for <code>http://monero.10z.com.ar:18089</code> or the other way around.</li><li><strong>Host group 105</strong>: <code>http://95.217.178.183:18089</code> is a proxy for <code>http://37.27.89.118:18089</code> or the other way around.</li></ul><p>Another bad thing we noticed is that <strong>Host group 50</strong> has 4 different domain names pointing to the same underlying Monero node server:</p><ol><li><code>node.moneroworld.com</code></li><li><code>uwillrunanodesoon.moneroworld.com</code></li><li><code>opennode.xmr-tw.org</code></li><li><code>node.monerodevs.org</code> (actual domain name of this node)</li></ol><p>This increases the chances that this node will be selected over others even while picking randomly.</p><h2 id="what-can-digilol-do-for-you" tabindex="-1">What can Digilol do for you? <a href="#what-can-digilol-do-for-you" aria-label="Permalink to &#34;What can Digilol do for you?&#34;">​</a></h2><p>Digilol offers full-stack development, managed hosting, consulting and penetration testing services. We accept Monero and help others do too.</p></div></div></div></div>
  </body>
</html>
