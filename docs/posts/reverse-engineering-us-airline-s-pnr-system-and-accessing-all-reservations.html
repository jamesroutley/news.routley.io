<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://alexschapiro.com/security/vulnerability/2025/11/20/avelo-airline-reservation-api-vulnerability">Original</a>
    <h1>Reverse Engineering US Airline&#39;s PNR System and Accessing All Reservations</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p><em>Timeline &amp; Responsible Disclosure</em></p>

<p><em><strong>Initial Contact:</strong> Upon discovering this vulnerability on <strong>October 15, 2025</strong>, I immediately reached out to security contacts at Avelo Airlines via email.</em></p>

<p><em><strong>October 16, 2025:</strong> The Avelo cybersecurity team responded quickly and professionally. We had productive email exchanges where I detailed the vulnerability, including the lack of last name verification and rate limiting on reservation endpoints.</em></p>

<p><em><strong>November 13, 2025:</strong> Avelo pushed a fix to production and notified me that the vulnerabilities were patched. I independently verified the fixes were in place before publication, and informed the Avelo team of my intention to write a technical blog post about this vulnerability, highlighting their cooperative and responsive approach to security disclosure.</em></p>

<p><em><strong>Publication:</strong> November 20, 2025.</em></p>

<p><em>The Avelo team was responsive, professional, and took the findings seriously throughout the disclosure process. They acknowledged the severity, worked quickly to remediate the issues, and maintained clear communication. This is a model example of how organizations should handle security disclosures.</em></p>

<hr/>

<p>After my <a href="https://coursetable.com/catalog?selectSeasons=202503&amp;searchText=akkad&amp;course-modal=202503-13154">9 AM Akkadian class</a>, I sat down to change my flight out of New Haven with Avelo Airlines, and noticed that my computer was making some unusual requests. After digging a little further, I stepped into a landmine of customer information exposure. In the wrong hands, this critical vulnerability could allow an attacker to access full reservation details, including PII, government ID numbers, and partial payment info, for every Avelo passenger, past and present.</p>

<p>Before I walk you through my work on that Tuesday morning, let’s establish how airlines generally manage their reservations.</p>

<h2 id="how-airline-logins-should-work">How Airline Logins <em>Should</em> Work</h2>

<p>Normally, to access a flight reservation (which often contains sensitive information like passport numbers, Known Traveler Numbers, and partial credit card data), you need at least two pieces of information: a <strong>confirmation code</strong> and the <strong>passenger’s last name</strong>.</p>

<p>This two-factor system is generally secure. The space of all 6-character alphanumeric confirmation codes combined with all possible last names is astronomically large, making it impossible to “guess” a valid pair.</p>

<p>But what if the last name check was missing?</p>

<p>Suddenly, the problem becomes much simpler. The <em>entire</em> keyspace an attacker needs to guess is just the confirmation code. In Avelo’s case, their codes are 6-character alphanumeric strings (<code>[A-Z0-9]</code>).</p>

<p>Let’s do the math:</p>

<ul>
  <li><strong>Keyspace:</strong> 36 characters (26 letters + 10 digits)</li>
  <li><strong>Length:</strong> 6</li>
  <li><strong>Total Combinations:</strong> 36^6 = <strong>2,176,782,336</strong> (~2.18 billion)</li>
</ul>

<p>That’s a big number, but it’s not “astronomically large.” It’s well within the reach of a modern brute-force attack.</p>

<h3 id="the-attack-timeline">The Attack Timeline</h3>

<p>How long would it take to try all 2.18 billion combinations? The time is just <code>2.18 billion / (requests per second)</code>.</p>

<ul>
  <li>At <strong>1,000 req/s</strong> (a modest script): 2.18 million seconds, or <strong>~25 days</strong>.</li>
  <li>At <strong>10,000 req/s</strong> (a decent server): 218,000 seconds, or <strong>~2.5 days</strong>.</li>
  <li>At <strong>100,000 req/s</strong> (a small cluster of servers, costing $400-$700)<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup>: 21,800 seconds, or <strong>~6 hours</strong>.</li>
</ul>

<p><strong>Bottom line:</strong> If Avelo’s flight system has no rate limiting and doesn’t require a last name, an adversary could extract all passenger data in about 6 hours for less than a thousand dollars.</p>

<h3 id="even-faster-than-6-hours">Even Faster Than 6 Hours</h3>

<p>Even worse, they don’t need to run for 6 hours. With an estimated 8 million tickets sold, the “hit rate” is roughly <strong>1 in every 270 guesses</strong> (2.18B / 8M). An attacker would start getting valid PII back in <em>seconds</em>.</p>

<h2 id="back-to-the-story-finding-the-flaw">Back to the Story: Finding the Flaw</h2>

<p>This was all just theory until I looked at my network traffic. As I was changing my reservation, I saw a GET request to an API endpoint:</p>

<div><div><pre><code>https://www.aveloair.com/payment/services/reservation/{code}
</code></pre></div></div>

<p><img src="https://alexschapiro.com/assets/images/avelo-security/endpoint.png" alt="Screenshot of the reservation API endpoint"/></p>

<p>The parameter at the end didn’t seem like a reservation code, but the response contained all relevant reservation data, so I decided to probe further. On a hunch, I swapped that token for my <em>actual</em> 6-character code and re-sent the request.</p>

<p><strong>Voila.</strong> The server responded with a massive JSON object containing my entire reservation.</p>

<p>This endpoint wasn’t asking for my last name. The only other security was a standard authentication cookie… but was that cookie tied to <em>my</em> reservation?</p>

<p>I quickly texted a friend for their old Avelo confirmation code. I plugged it into the URL, kept <em>my own cookie</em>, and hit send. But there was no way it could poss-</p>

<p><strong>It worked.</strong></p>

<p>I was looking at their full reservation. <strong>Any</strong> valid authentication cookie could be used to query <strong>any</strong> reservation, using only the 6-character code. The theoretical flaw was real.</p>

<h2 id="executing-the-attack-no-rate-limiting">Executing the Attack: No Rate Limiting</h2>

<p>The only remaining (partial) defense was rate-limiting. I wrote a quick multi-threaded Python script to generate random 6-character codes and hit the endpoint.</p>

<p>The requests flew. There was no WAF, no IP blocking, no CAPTCHA.</p>

<p><img src="https://alexschapiro.com/assets/images/avelo-security/validcodes.png" alt="Valid reservation codes being discovered"/>
<em>The script quickly finding valid reservation codes</em></p>

<p>Within minutes, my script was logging hundreds of valid reservations. Troves of data were being returned, including from passengers flying on government business with <code>@dot.gov</code> and <code>@faa.gov</code> email addresses.</p>

<p>A successful hit returned the <em>entire</em> reservation object. This was a complete data breach for each passenger – including myself!</p>

<p>(Note: During further testing, I discovered a similar vulnerability on a different reservation endpoint. I promptly notified the Avelo team, and they patched that endpoint as well before publication.)</p>

<h2 id="what-data-was-leaked">What Data Was Leaked?</h2>

<p>For every valid code, the API returned:</p>

<ul>
  <li><strong>Full Passenger PII:</strong> <code>FullName</code>, <code>DateOfBirth</code>, <code>Gender</code></li>
  <li><strong>Government IDs:</strong> <code>IDDocuments.IDNumber</code> (this field contained Known Traveler Numbers (KNTs) and, in other cases, Passport Numbers)</li>
  <li><strong>Contact Info:</strong> phone numbers, email addresses</li>
  <li><strong>Full Itinerary:</strong> Flight numbers, dates, times, and <code>SeatLocation</code></li>
  <li><strong>Payment Details:</strong> <code>CardNumber</code> (masked: <code>************8</code>), <code>DateTimeExpiration</code>, and billing <code>Address.PostalCode</code></li>
  <li><strong>Vouchers:</strong> <code>PaymentInternals.AccountNumber</code> and <code>Amount.Value</code></li>
  <li><strong>PCI Data:</strong> <code>PaymentCards.TrackData</code> — This field seemed to contain partial magnetic-stripe data</li>
</ul>

<div>
  <div>
    <p><img src="https://alexschapiro.com/assets/images/avelo-security/payment.png" alt="Payment card data in API response"/></p><p>Example of exposed payment card data returned by the API</p>
  </div>
  <div>
    <p><img src="https://alexschapiro.com/assets/images/avelo-security/ktn.png" alt="Known Traveler Number in API response"/></p><p>Example of exposed Known Traveler Number (KNT) and other PII in API response</p>
  </div>
</div>

<h2 id="the-fallout">The Fallout</h2>

<p>This flaw was critical. An attacker could:</p>

<ol>
  <li>Run the 6-hour brute-force attack to enumerate millions of valid passenger reservation codes (PNRs) — or simply run the script for a few minutes and start harvesting valid passenger data immediately</li>
  <li>Extract comprehensive PII including full names, dates of birth, contact information, flight itineraries, and government ID numbers (Known Traveler Numbers and passport numbers) for identity theft and fraud</li>
  <li>Access partial payment card data including last 4 digits, expiration dates, and billing zip codes</li>
  <li>View complete travel history and passenger boarding status</li>
  <li>Modify or cancel all Avelo passengers’ reservations, causing widespread travel disruption</li>
</ol>

<p>I immediately disclosed this to the Avelo team. They were responsive, professional, and took the findings seriously, patching the issues promptly.</p>

<h2 id="key-takeaways">Key Takeaways</h2>

<p>This incident is a stark reminder of how critical simple security checks are. A single missing <code>lastName</code> check and an absent rate-limit configuration exposed millions of sensitive passenger records to trivial enumeration.</p>

<p><strong>For developers:</strong></p>
<ul>
  <li>Always require multiple factors for accessing sensitive data (e.g., confirmation code + last name)</li>
  <li>Implement rate limiting on all enumerable endpoints</li>
  <li>Ensure authentication cookies are properly scoped to user sessions</li>
</ul>

<p>I’m glad we could get this fixed, and I hope this write-up helps other developers avoid similar pitfalls.</p>



  </div>
</article>

      </div>
    </div></div>
  </body>
</html>
