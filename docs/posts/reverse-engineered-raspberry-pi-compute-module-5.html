<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/schlae/cm5-reveng">Original</a>
    <h1>Reverse Engineered Raspberry Pi Compute Module 5</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/schlae/cm5-reveng/blob/main/CM5.JPG"><img src="https://github.com/schlae/cm5-reveng/raw/main/CM5.JPG" alt="Board layout with all the layers turned on"/></a></p>
<p dir="auto">This is the reverse engineered schematic and layout for a Raspberry Pi
Compute Module 5. It&#39;s not meant to be fabricated--critical signal integrity
parameters aren&#39;t correct, it&#39;s not 100% faithful to the original, the
footprints aren&#39;t a perfect match, and the bill of materials is not
reverse engineered. You also won&#39;t be able to obtain most of the chips
since they are custom for this design or only available to large customers,
not through a distributor.</p>
<p dir="auto">I&#39;m sure folks will want the schematic of the regular Pi 5, but I don&#39;t
have plans to reverse engineer that.</p>
<p dir="auto"><a href="https://github.com/schlae/cm5-reveng/blob/main/CM5RevEng.pdf">Schematic PDF</a></p>
<p dir="auto"><a href="https://github.com/schlae/cm5-reveng/blob/main/rpi-rm0/rpi-rm0.pdf">Bonus schematic of the RM0 WiFi/Bluetooth module</a></p>

<p dir="auto">I needed to solve some design issues with a project that uses one of these
modules, but the schematic was not available. Fortunately, with a little
reverse engineering work, I was able to back out the schematic and solve my
design issues.</p>
<p dir="auto">It&#39;s useful mainly for educational purposes or advanced hacking. For example,
now that the PMIC pinout is known, the I2C register map could be explored.
It&#39;s a great little part--if you accidentally blow up a CM5, you might be able
to remove everything except for the PMIC, program it over I2C, and use it
to power another project.</p>

<p dir="auto">I removed all the parts from the board, measured them with an LCR meter (and
VNA, in the case of the ferrite beads), and then sanded down the board one
layer at a time, imaging each with a flatbed scanner at 9600 DPI. KiCad layout
lets you embed images which is great for tracing.</p>

<p dir="auto">The resistors in the upper right corner that select the memory and eMMC
configuration are not zero-ohm devices. Each possible position has a specific
resistor value, forming a resistor divider with a 10K resistor, so that
the RP1 can measure the voltage with two ADC inputs and determine the
configuration.</p>
<p dir="auto">The board has 10 layers. It is what&#39;s known as a 2+6+2 configuration since
it has four layers of microvias: layer 1-2, 2-3, 8-9, and 9-10. There are
buried mechanical vias from layers 2-9, and standard through-board vias
from layers 1-10.</p>
<p dir="auto">The PMIC has a hot-swap function to limit the inrush current to the
&gt;350uF of capacitance on the 5V rail. External capacitance on the carrier
board is probably unnecessary.</p>
<p dir="auto">The WiFi and Bluetooth functions can be disabled (through GPIO) from the
BCM2712 as well as the connector pins. You can detect this externally
by monitoring the voltages on the BT_nDISABLE and WL_nDISABLE pins.</p>
<p dir="auto">The CM5 with onboard eMMC will not conflict with an external SD card (wired
to the pins on the connector). This is because the SD pins are unconnected on
this version of the module.</p>
<p dir="auto">The original board has no designators, so the ones in this design are
made up, with the exception of the test points, which are documented
in the official RPi datasheet.</p>
<p dir="auto">The 5V input goes through a hot-swap circuit with a series pass MOSFET. Since
there is a test point on either side of the MOSFET and the part number is
known (DMG7430LFG), you could monitor the voltage across and compute the
supply current based on the MOSFET RDSON.</p>

<p dir="auto">By very carefully sanding through the board one layer at a time, I figured
out the approximate stackup using digital calipers.</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Layer</th>
<th></th>
<th>Approximate Thickness (mm)</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Cu</td>
<td>0.0522</td>
<td>Top layer</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.0450</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>Cu</td>
<td>0.0522</td>
<td>Ground, PMIC LX, some signals. Reference layer for 1 and 3.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.0600</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>Cu</td>
<td>0.0348</td>
<td>Signal and power.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.1400</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>Cu</td>
<td>0.0348</td>
<td>Ground.</td>
</tr>
<tr>
<td></td>
<td>Core</td>
<td>0.0600</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>Cu</td>
<td>0.0522</td>
<td>Power, limited signal.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.1176</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>Cu</td>
<td>0.0522</td>
<td>Power.</td>
</tr>
<tr>
<td></td>
<td>Core</td>
<td>0.0600</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>Cu</td>
<td>0.0348</td>
<td>Ground.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.1400</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>Cu</td>
<td>0.0348</td>
<td>Signal and power.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.0348</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>Cu</td>
<td>0.0522</td>
<td>Ground. Reference layer for 8 and 10.</td>
</tr>
<tr>
<td></td>
<td>PP</td>
<td>0.0450</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>Cu</td>
<td>0.0522</td>
<td>Bottom layer</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">The Raspberry Pi Compute Module 5 datasheet has a table of test points, but
most of them are listed as &#34;reserved.&#34; Here&#39;s a complete table. The coordinates
are relative to the lower left corner of the board (if the board had
a rectangular corner instead of being rounded off), increasing to the right
and upwards. Note that, in the KiCad layout, the lower left corner
is at 100mm x 100mm, and the Y axis is flipped, decreasing as you move
up. To change a coordinate from this table to KiCad, add 100 to the X
coordinate, and subtract the Y coordinate from 100.</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Reference</th>
<th>X</th>
<th>Y</th>
<th>NAME</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>MH4</td>
<td>51.5</td>
<td>36.5</td>
<td>Mounting Hole</td>
<td></td>
</tr>
<tr>
<td>MH3</td>
<td>3.5</td>
<td>36.5</td>
<td>Mounting Hole</td>
<td></td>
</tr>
<tr>
<td>MH2</td>
<td>51.5</td>
<td>3.5</td>
<td>Mounting Hole</td>
<td></td>
</tr>
<tr>
<td>MH1</td>
<td>3.5</td>
<td>3.5</td>
<td>Mounting Hole</td>
<td></td>
</tr>
<tr>
<td>TP1</td>
<td>14.34</td>
<td>17.54</td>
<td>+5V</td>
<td>Raw 5V power to board.</td>
</tr>
<tr>
<td>TP2</td>
<td>8.8</td>
<td>1.3</td>
<td>RUN</td>
<td>Unknown PMIC status output, possibly power good.</td>
</tr>
<tr>
<td>TP3</td>
<td>51.2</td>
<td>32.6</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP4</td>
<td>4.8</td>
<td>13</td>
<td>PMIC INT</td>
<td>PMIC interrupt output (likely).</td>
</tr>
<tr>
<td>TP7</td>
<td>24.2</td>
<td>7.5</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP8</td>
<td>1.65</td>
<td>15.05</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP9</td>
<td>1.5</td>
<td>10.05</td>
<td>VREF_3V3</td>
<td>Analog 3.3V to RP1 for ADCs.</td>
</tr>
<tr>
<td>TP10</td>
<td>48.4</td>
<td>15.1</td>
<td>VREG</td>
<td>Unknown regulated voltage to RP1.</td>
</tr>
<tr>
<td>TP13</td>
<td>42.6</td>
<td>7.3</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP15</td>
<td>14.7</td>
<td>6.6</td>
<td>VDD_0V8_LDO</td>
<td>0.8V LDO regulator to BCM2712.</td>
</tr>
<tr>
<td>TP16</td>
<td>9.3</td>
<td>34.9</td>
<td>nRPIBOOT</td>
<td>Hold low for boot mode.</td>
</tr>
<tr>
<td>TP17</td>
<td>37.4</td>
<td>8.1</td>
<td>VDD_3V3_2</td>
<td>Secondary 3.3V rail for NOR flash and eMMC.</td>
</tr>
<tr>
<td>TP21</td>
<td>24.5125</td>
<td>14.025</td>
<td>nRESET_OUT</td>
<td>BCM2712 reset output (status).</td>
</tr>
<tr>
<td>TP22</td>
<td>13.0875</td>
<td>11.225</td>
<td>PMIC_SIG</td>
<td>Unknown PMIC signal. Could be for PMIC OTP programming.</td>
</tr>
<tr>
<td>TP26</td>
<td>17.7</td>
<td>20.2</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP27</td>
<td>43.6</td>
<td>22.3</td>
<td>VDD_1V1_RP1</td>
<td>RP1 1.1V core voltage supply.</td>
</tr>
<tr>
<td>TP28</td>
<td>15.4</td>
<td>16</td>
<td>VDD_BCM_CORE</td>
<td>BCM2712 core voltage rail. Nominally 0.8V.</td>
</tr>
<tr>
<td>TP29</td>
<td>23.65</td>
<td>21.55</td>
<td>VDD_0V8_BCM</td>
<td>BCM2712 auxiliary 0.8V rail.</td>
</tr>
<tr>
<td>TP30</td>
<td>37.2</td>
<td>34.9</td>
<td>VDD_0V6</td>
<td>LPDDR4 VDDQ supply.</td>
</tr>
<tr>
<td>TP31</td>
<td>9.1</td>
<td>3.2</td>
<td>VDD_1V1</td>
<td>LPDDR4 VDD2 supply.</td>
</tr>
<tr>
<td>TP32</td>
<td>1.5</td>
<td>13</td>
<td>VDD_3V7_WIFI</td>
<td>3.7V rail for WiFi radio.</td>
</tr>
<tr>
<td>TP33</td>
<td>47</td>
<td>36</td>
<td>CM5_3V3</td>
<td>Main 3.3V supply rail.</td>
</tr>
<tr>
<td>TP34</td>
<td>50.5</td>
<td>15.5</td>
<td>CM5_1V8</td>
<td>Main 1.8V supply rail.</td>
</tr>
<tr>
<td>TP35</td>
<td>11</td>
<td>37.8</td>
<td>DEBUG_UART_TX</td>
<td>Debugging UART transmit output.</td>
</tr>
<tr>
<td>TP36</td>
<td>8.5</td>
<td>37.1</td>
<td>DEBUG_UART_RX</td>
<td>Debugging UART receive input.</td>
</tr>
<tr>
<td>TP39</td>
<td>22.1</td>
<td>6.1</td>
<td>EN_LOAD_SWITCH</td>
<td>Enables VDD_3V3_2 and VDD_1V8_2 when asserted.</td>
</tr>
<tr>
<td>TP40</td>
<td>6.7</td>
<td>15.2</td>
<td>PMIC_SCL</td>
<td>PMIC I2C bus clock.</td>
</tr>
<tr>
<td>TP41</td>
<td>8.7</td>
<td>15.3</td>
<td>PMIC_SDA</td>
<td>PMIC I2C bus data.</td>
</tr>
<tr>
<td>TP42</td>
<td>11.4</td>
<td>34.9</td>
<td>PWR_BUT</td>
<td>Power button signal to PMIC.</td>
</tr>
<tr>
<td>TP44</td>
<td>51.7</td>
<td>30.2</td>
<td>VDD_2V5_RP1</td>
<td>RP1 internal voltage regulator: 2.5V supply.</td>
</tr>
<tr>
<td>TP45</td>
<td>53.1</td>
<td>28.7</td>
<td>VDD_1V1_RP1</td>
<td>RP1 internal voltage regulator: 1.1V supply.</td>
</tr>
<tr>
<td>TP46</td>
<td>7</td>
<td>34.7</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP48</td>
<td>21.6</td>
<td>15.4</td>
<td>SOC_TRST_N</td>
<td>BCM2712 JTAG test reset input.</td>
</tr>
<tr>
<td>TP49</td>
<td>21.6</td>
<td>13.3</td>
<td>SOC_TDI</td>
<td>BCM2712 JTAG test data input.</td>
</tr>
<tr>
<td>TP50</td>
<td>20.4</td>
<td>17.2</td>
<td>SOC_TDO</td>
<td>BCM2712 JTAG test data output.</td>
</tr>
<tr>
<td>TP51</td>
<td>20.3</td>
<td>8.8</td>
<td>SOC_TMS</td>
<td>BCM2712 JTAG test mode select.</td>
</tr>
<tr>
<td>TP52</td>
<td>19.9</td>
<td>11.9</td>
<td>SOC_TCK</td>
<td>BCM2712 JTAG test clock.</td>
</tr>
<tr>
<td>TP57</td>
<td>53.2</td>
<td>32</td>
<td>RP1_TP</td>
<td>Unknown RP1 signal.</td>
</tr>
<tr>
<td>TP60</td>
<td>48</td>
<td>38.7</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP61</td>
<td>6.575</td>
<td>1.225</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP62</td>
<td>22.2</td>
<td>31.6</td>
<td>GND</td>
<td></td>
</tr>
<tr>
<td>TP63</td>
<td>8.7</td>
<td>18.2</td>
<td>5V_SENSE</td>
<td>Main board 5V rail, after hot-swap/inrush limiting MOSFET.</td>
</tr>
<tr>
<td>TP64</td>
<td>47.3</td>
<td>5.4</td>
<td>VDD_1V0_PHY</td>
<td>BCM54210 internal voltage regulator: 1.0V supply.</td>
</tr>
<tr>
<td>TP65</td>
<td>28.2</td>
<td>7.5</td>
<td>USBC_D_N</td>
<td>BCM2712 USB 2.0.</td>
</tr>
<tr>
<td>TP66</td>
<td>26.1</td>
<td>7.5</td>
<td>USBC_D_P</td>
<td>BCM2712 USB 2.0.</td>
</tr>
<tr>
<td>TP67</td>
<td>7</td>
<td>38.6</td>
<td>LED_nPWR</td>
<td>Power LED, driven by RP1.</td>
</tr>
<tr>
<td>TP68</td>
<td>13</td>
<td>37.5</td>
<td>LED_nACT</td>
<td>Activity LED, driven by BCM2712.</td>
</tr>
<tr>
<td>TP69</td>
<td>38.8</td>
<td>25.9</td>
<td>ETH0_P</td>
<td></td>
</tr>
<tr>
<td>TP70</td>
<td>39.6</td>
<td>24.2</td>
<td>ETH0_N</td>
<td></td>
</tr>
<tr>
<td>TP71</td>
<td>43.8</td>
<td>14.1</td>
<td>ETH1_N</td>
<td></td>
</tr>
<tr>
<td>TP72</td>
<td>45.6</td>
<td>13.1</td>
<td>ETH1_P</td>
<td></td>
</tr>
<tr>
<td>TP73</td>
<td>42.4</td>
<td>31.7</td>
<td>ETH2_P</td>
<td></td>
</tr>
<tr>
<td>TP74</td>
<td>42.6</td>
<td>33.7</td>
<td>ETH2_N</td>
<td></td>
</tr>
<tr>
<td>TP75</td>
<td>41.6</td>
<td>37.8</td>
<td>ETH3_P</td>
<td></td>
</tr>
<tr>
<td>TP76</td>
<td>42.9</td>
<td>36.1</td>
<td>ETH3_N</td>
<td></td>
</tr>
<tr>
<td>TP77</td>
<td>14.37</td>
<td>19.52</td>
<td>+5V</td>
<td>Raw 5V power to board.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">There are some pins that have not been identified because they&#39;re not connected
on the CM5:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Pin</th>
<th>Guess</th>
</tr>
</thead>
<tbody>
<tr>
<td>A2</td>
<td></td>
</tr>
<tr>
<td>B3</td>
<td></td>
</tr>
<tr>
<td>C2</td>
<td></td>
</tr>
<tr>
<td>C3</td>
<td></td>
</tr>
<tr>
<td>C4</td>
<td></td>
</tr>
<tr>
<td>D1</td>
<td></td>
</tr>
<tr>
<td>E3</td>
<td></td>
</tr>
<tr>
<td>E10</td>
<td></td>
</tr>
<tr>
<td>E15</td>
<td></td>
</tr>
<tr>
<td>F1</td>
<td></td>
</tr>
<tr>
<td>F2</td>
<td></td>
</tr>
<tr>
<td>F3</td>
<td></td>
</tr>
<tr>
<td>F7</td>
<td></td>
</tr>
<tr>
<td>G1</td>
<td></td>
</tr>
<tr>
<td>G2</td>
<td></td>
</tr>
<tr>
<td>H1</td>
<td></td>
</tr>
<tr>
<td>H3</td>
<td></td>
</tr>
<tr>
<td>H7</td>
<td></td>
</tr>
<tr>
<td>H17</td>
<td>USB 2.0?</td>
</tr>
<tr>
<td>H18</td>
<td>USB 2.0?</td>
</tr>
<tr>
<td>J15</td>
<td></td>
</tr>
<tr>
<td>J17</td>
<td></td>
</tr>
<tr>
<td>L13</td>
<td></td>
</tr>
<tr>
<td>L15</td>
<td></td>
</tr>
<tr>
<td>M17</td>
<td>USB 2.0?</td>
</tr>
<tr>
<td>M18</td>
<td>USB 2.0?</td>
</tr>
<tr>
<td>R4</td>
<td></td>
</tr>
<tr>
<td>T3</td>
<td></td>
</tr>
<tr>
<td>T4</td>
<td></td>
</tr>
<tr>
<td>T13</td>
<td></td>
</tr>
<tr>
<td>T14</td>
<td></td>
</tr>
<tr>
<td>V2</td>
<td></td>
</tr>
<tr>
<td>V3</td>
<td></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<ul dir="auto">
<li>PCIe (BCM2712 to RP1) net identification</li>
<li>RP1 to BCM2712 net identification</li>
<li>PMIC I2C register map</li>
</ul>

<p dir="auto"><a href="https://creativecommons.org/licenses/by-sa/4.0" rel="nofollow">CC BY-SA 4.0</a></p>
</article></div></div>
  </body>
</html>
