<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://taptrap.click/">Original</a>
    <h1>TapTrap: Animation‑Driven Tapjacking on Android</h1>
    
    <div id="readability-page-1" class="page"><div>
    <section id="overview">
      <h2>Overview</h2>

      <div>


        <p>
          <span>TapTrap</span> is a new type of attack targeting Android devices. It
          allows an <span>app without any permissions</span> to
          misuse screen animations. This app can secretly open another screen, such as a permission prompt, and make it
          invisible. The attack can then be used to trick you into <span>performing
            sensitive actions</span>, such as granting camera permissions or even erasing your device, without your
          consent.
        </p>

        <p>
          The idea is simple: imagine you’re using an app. While you use it, it opens another screen, such as a system
          prompt or simply another app. Normally, Android shows an animation when the screen changes, such as the new
          screen sliding or fading in. However, the app can tell the system that a custom animation should be used
          instead that is long-running and makes the new screen fully transparent, keeping it hidden from you. Any taps
          you make during this animation go to the hidden screen, not the visible app. The app can then use this to lure
          you into tapping on specific areas of the screen that correspond to sensitive actions on the hidden screen,
          allowing it to perform actions without your knowledge.
        </p>

        <p>
          The video below shows TapTrap in action. In the example, the user plays a game that secretly opens the browser
          and tricks them into granting camera permissions to a malicious website. The hidden screen is
          semi-transparent for demonstration purposes.
        </p>


        <div>
          <p>
            <iframe src="https://www.youtube-nocookie.com/embed/-xMA6DX7CB8?si=wk80h_zndE11-BFm" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>
          </p>
        </div>


      </div>

      <p>
        TapTrap works even on the latest Android version, Android 16. We reported this issue to Google and major
        browser vendors in 2024. Browsers have fixed the issue as of July 2025, but Android itself remains vulnerable
        (see the <a href="#news">disclosure timeline</a> for details).
      </p>
      
    </section>



    <!-- IMPACT -->
    <section id="impact">
      <h2>Impact</h2>
      <div>
        <div>
          <h3>Unauthorized access to your camera, location, or
            notifications</h3>
          <p>Android usually asks for permission before apps can access sensitive resources like your camera or
            location.
            TapTrap circumvents this by tricking you into approving these prompts, thereby granting access to
            your camera, microphone, location, notifications, and more.</p>
          
        </div>

        <div>
          <h3>Unauthorized erasure of your phone</h3>
          <p>TapTrap can trick you into enabling the &#34;Device Administrator&#34; permission, which allows an app to remotely
            wipe your entire device.
          </p>
        </div>
        <div>
          <h3>Attacks on apps</h3>
          <p>Even apps you’ve installed yourself can be targeted.
            TapTrap can open these apps and trigger sensitive actions in them on your behalf.
            In our analysis of nearly 100,000 Play Store apps, 76% are vulnerable to TapTrap.</p>
        </div>
        <div>
          <h3>Attacks on websites</h3>
          <p>TapTrap extends beyond apps to websites.
            It can hijack taps on websites to trigger actions, such as liking posts, or granting location or camera
            permissions to a site.</p>
        </div>

        <div>
          <h3>Hard to detect</h3>
          <p>In a user study among 20 people, we evaluated how easy it is to spot TapTrap. None of the participants
            noticed at least one variant of the attack. Do you want to see what the participants saw? Watch the <a href="#" data-video-src="assets/taptrap_user_study.mp4">video of our
              user study app</a>. </p>
        </div>
        <div>
          <h3>Affects the newest Android version</h3>
          <p>As of June 2025, even the latest Android version is affected by TapTrap. Major browsers like Chrome, Edge,
            Brave, and Firefox have issued fixes, but Android itself has not yet addressed the core issue.
          </p>
        </div>
      </div>


      
    </section>


    <!-- DEEP-DIVE -->
    <section id="deep-dive">
      <h2>Technical Deep-Dive</h2>

      <div>
        <details>
          <summary>
            <h3>Threat Model</h3>
            <span>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
              </svg>
            </span>
          </summary>
          <p>We assume that a malicious app is installed on the user’s device, for example, via an app market. The app
              does not require any permissions, making it appear harmless and unintrusive to the user. Notably, we do
              not assume the <code>SYSTEM_ALERT_WINDOW</code>
              permission, which prior work often relied on. However, we
              assume that animations are enabled on the device. By default, animations are enabled unless explicitly
              disabled through developer options or accessibility settings.</p>
        </details>

        <details>
          <summary>
            <h3>Attack Mechanism</h3>
            <span>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
              </svg>
            </span>
          </summary>
          <div><p>
            A TapTrap attack consists of the following steps:

            </p><h3>1. Launch a Target Activity</h3>

            <p>The attack begins when a malicious app launches a new activity using <code>startActivity()</code> or a
              related method. This new activity (let’s call it Activity B) can be part of another app or a system
              component (e.g., a permission dialog). The malicious app (with Activity A) specifies a custom animation
              using <code>overridePendingTransition()</code> or <code>ActivityOptions.makeCustomAnimation()</code> that
              controls how this transition appears to the user.
              Note that custom transitions can only be applied to activity transition that happen within the same task.
              If the target activity is in a different task, Android will use a system-defined slide animation instead
              and TapTrap will not work.
            </p>

            <h3>2. Crafting the Animation</h3>

            <p>The key to TapTrap is using an animation that renders the target activity nearly invisible. This can be
              achieved by defining a custom animation with both the starting and ending opacity (alpha) set to a low
              value, such as 0.01. Optionally, a scale animation can be applied to zoom into a specific UI element
              (e.g., a permission button), making it occupy the full screen and increasing the chance the user will tap
              it.
            </p>

            <h3>3. Tricking the User</h3>

            <p>While Activity A remains visible, Android places Activity B on top of the activity stack. Despite being
              transparent, Activity B receives all touch events, not Activity A. The malicious app places decoy
              UI elements (like a “Next” button) that align precisely with real interactive elements (like an “Allow” or
              “Activate” button) in Activity B. When the user taps what they think is a harmless button, they are
              actually interacting with the sensitive UI of Activity B.</p>

            <h3>4. Re-launching the Malicious Activity</h3>

            <p>Before the animation completes and Activity B becomes fully visible, the malicious app quickly relaunches
              itself (Activity A) to regain visibility and push B to the background. This prevents the user from seeing
              that anything abnormal occurred.
            </p>
          </div>
        </details>

        <details>
          <summary>
            <h3>App Vulnerability</h3>
            <span>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
              </svg>
            </span>
          </summary>
          <div>
            <p>We analyzed 99,705 Android apps from the Play Store to understand how many are vulnerable to TapTrap. For
              an app to be vulnerable, it must include a screen (called an &#34;activity&#34;) that:<br/>
            </p><ul>
              <li>can be launched by another app,</li>
              <li>runs in the same task as the calling app,</li>
              <li>does not override the transition animation, and</li>
              <li>does not wait for the animation to finish before reacting to user input.</li>
            </ul>
            </div>
        </details>

        <details>
          <summary>
            <h3>TapTrap in the Wild</h3>
            <span>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
              </svg>
            </span>
          </summary>
          <div>
            <p>We developed an automated analysis pipeline to investigate whether TapTrap is actively exploited in
              Android apps. Using a dataset of 99,705 Play Store apps, we extracted all animations that an app can use
              for
              TapTrap from these apps and then ran the animations in a controlled environment via Robolectric, which
              allowed us
              to analyze their behavior over time. We assigned each animation an opacity and a scale score ranging from
              0 to 100
              to identify those with characteristics exploitable by TapTrap, where 0 means it&#39;s unlikely that it can be
              exploited for TapTrap and 100 means it is very likely to be exploitable.
              </p>

            <p>The following figure illustrates the analysis pipeline:</p>

            <p><img src="https://taptrap.click/assets/mal_meth.drawio.svg" alt="TapTrap Analysis Pipeline"/></p><p>
              Our analysis revealed 28 apps with a score of at least 50, but manual inspection confirmed none of them
              used
              these animations maliciously. We also discovered an off-by-one bug in Android’s animation system, allowing
              animations to run up to 6 seconds instead of the intended 3, effectively doubling the TapTrap attack
              window.

              </p>
          </div>
        </details>

        <details>
          <summary>
            <h3>User Awareness</h3>
            <span>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
              </svg>
            </span>
          </summary>
          <div>
            <p>
              We conducted a user study with 20 participants to evaluate whether users can detect TapTrap during typical
              app interactions. Participants played KillTheBugs, a game we developed that embedded three TapTrap attack
              scenarios, each targeting a different permission: location, camera, and device admin. They played the game
              twice, once without any prior knowledge of the attack, and again after informing participants that an
              attack might occur.

              </p>

            <p>
              <video src="assets/taptrap_user_study.mp4" controls="" playsinline="" muted="">
                Your browser does not support the video tag.
              </video>
            </p>



        </div></details>



      </div>
    </section>

    <!-- FAQ SECTION -->
    <section id="faq">
      <h2>Frequently Asked Questions</h2>

      <!-- Responsive masonry-style grid: one column on small screens, two from md-up -->
      <!-- Responsive masonry-style grid: one column on small screens, two from md-up -->
      <div>
        <!-- Card 1 -->
        <article>
          <h3>
            What is TapTrap in simple words?
          </h3>
          <p>
            It’s an attack on Android where a malicious app uses an animation to lure you into tapping on the screen and
            performing unwanted actions without your consent.
          </p>
        </article>

        <!-- Card 2 -->
        <article>
          <h3>
            Am I affected?
          </h3>
          <p>
            If you use an Android phone and haven’t disabled system animations, then yes, you’re likely affected. iPhone
            users are not affected.

          </p>
        </article>

        <!-- Card 3 -->
        <article>
          <h3>
            What can a malicious app do with this?
          </h3>
          <p>
            It can silently get permission to use your camera, microphone or location, read your notifications, and even
            erase your phone. It can also attack other apps you have installed and websites in the browser.
          </p>
        </article>

        <!-- Card 4 -->
        <article>
          <h3>
            Would I notice if it happened to me?
          </h3>
          <p>
            Probably not. In a lab test, all 20 participants missed at least one attack, even after being told that
            there may be an attack happening. Do you want to see what the participants saw? Watch the <a href="#" data-video-src="assets/taptrap_user_study.mp4">video of our user
              study app</a>.
          </p>
        </article>

        <!-- Card 5 -->
        <article>
          <h3>
            Is any real malware using this right now?
          </h3>
          <p>
            We analyzed nearly 100,000 Play Store apps and found no signs of TapTrap being used in the wild.
          </p>
        </article>

        <!-- Card 6 -->
        <article>
          <h3>
            What can I do to protect myself?
          </h3>
          <p>
            Until Android fixes the underlying issue, you can disable system animations in your device’s accessibility
            settings.
            This prevents the attack but also disables animations on your device.
          </p>
        </article>

        <article>
          <h3>
            How is TapTrap different from older tapjacking or overlay attacks?
          </h3>
          <p>
            It is based on transition animations instead of overlays, so it doesn’t need special permissions and isn’t
            blocked by Android’s overlay protections.
          </p>
        </article>

        <article>
          <h3>
            Is Android aware of the issue?
          </h3>
          <p>
            We have responsibly disclosed TapTrap to the Android Security Team and major browser vendors on October 31, 2024 and
            another issue that extends TapTrap&#39;s attack window on November 27, 2024. 
            While browser vendors have since fixed the issue, Android has not yet addressed it.
            We note that we were recently made aware that the underlying issue was also independently and confidentially reported by <a href="https://x.com/MGAldys4/">@MG193_7</a> (ByteDance IES RedTeam) to the Android Security Team in early 2023, and the report has not been publicly disclosed.
          </p>
        </article>

      </div>
    </section>

    <section id="paper">
      <h2>Paper &amp; Artifacts</h2>
      <div>
        <div>
          <h3>Paper</h3>
          <p>The paper is going to be published at the 34th USENIX Security Symposium 2025.</p>
          <a href="https://taptrap.click/usenix25_taptrap_paper.pdf" target="_blank"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7h1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V5a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h11.5M7 14h6m-6 3h6m0-10h.5m-.5 3h.5M7 7h3v3H7V7Z"></path>
            </svg>
            Read the paper</a>

          <!--
            <a href="https://doi.org/10.1145/XXXXXXX" target="_blank" class="btn btn-primary"><svg
              class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linejoin="round" stroke-width="2"
                d="M10 3v4a1 1 0 0 1-1 1H5m14-4v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1ZM9 12h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1Zm5.697 2.395v-.733l1.269-1.219v2.984l-1.268-1.032Z" />
            </svg>
            View the slides</a>
            <a href="#" class="btn btn-primary open-video-modal" data-video-src="assets/taptrap_presentation.mp4"><svg
              class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z" />
            </svg>

            View the poster</a>
          <a href="#" class="btn btn-primary open-video-modal" data-video-src="assets/taptrap_presentation.mp4"><svg
              class="w-6 h-6 text-white-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M14 6H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1Zm7 11-6-2V9l6-2v10Z" />
            </svg>
            Watch the presentation</a>-->

        </div>


        
      </div>

      <h3>BibTeX</h3>
      <p>
        Please use the following BibTeX entry to cite our work:
      </p>
      <div>
        <pre>@inproceedings{taptrap_beer,
  author    = {Philipp Beer and Marco Squarcina and Sebastian Roth and Martina Lindorfer},
  title     = {{TapTrap: Animation-Driven Tapjacking on Android}},
  booktitle = {34th USENIX Security Symposium (USENIX Security 25)},
  year      = {2025},
  address   = {Seattle, WA},
  publisher = {USENIX Association},
  month     = aug
}</pre>

        </div>
    </section>

    <section id="news">
      <h2>Timeline and News</h2>
      <div>

        <div>

          

          <p>July 8, 2025</p>

          <p>
            <strong>Android 16</strong> remains vulnerable to TapTrap
            <span>
              Not fixed
            </span>
          </p>
        </div>

        <div>
          
          <p>July 7, 2025</p>
          <p><strong>GrapheneOS</strong> patches TapTrap (<a href="https://grapheneos.org/releases#2025070700:~:text=only%20permit%20third%20party%20apps%20to%20use%20custom%20activity%20animations%20for%20transitions%20between%20their%20own%20activities%20to%20prevent%20a%20recently%20disclosed%20Android%20tapjacking%20vulnerability%20branded%20as%20TapTrap" target="_blank">Release Notes</a>)</p>
          <p>GrapheneOS is a private and secure mobile operating system with Android app compatibility</p>
        </div>

        

        

        <div>
          
          <p>Nov 27, 2024</p>
          <p>We responsibly disclosed the <strong>extended animation-duration issue</strong> to
            the Android Security Team</p>
        </div>

        <div>
          
          <p>Oct 31, 2024</p>
          <p>We responsibly disclosed <strong>TapTrap</strong> to the Android Security team
            and major browser vendors</p>
        </div>

      </div>
    </section>

    <section id="team">
      <h2>Research Team</h2>
      <p>
          We are a group of researchers of the <a href="https://secpriv.wien/" target="_blank">Security and Privacy Group at TU Wien</a> and the <a href="https://www.uni-bayreuth.de/" target="_blank">University of
            Bayreuth</a>, focusing on mobile and Web security.
          Our work on TapTrap is part of a broader effort to understand security risks in the mobile–Web ecosystem,
          funded by the <a href="https://www.wwtf.at/funding/programmes/ict/ICT22-060/" target="_blank">WWTF</a>.
        </p>
      <div>
        <div><p><img src="https://taptrap.click/assets/philipp_lower.jpg" alt="Philipp"/></p><p>Philipp Beer</p>
          <p>TU Wien</p>
          <!-- Social Icons -->
          
        </div>
        <div><p><img src="https://taptrap.click/assets/marco.png" alt="Marco"/></p><p>Marco Squarcina</p>
          <p>TU Wien</p>
          <!-- Social Icons -->
          
        </div>

        <div><p><img src="https://taptrap.click/assets/sebastian.png" alt="Marco"/></p><p>Sebastian Roth</p>
          <p>University of Bayreuth</p>
          <!-- Social Icons -->
          
        </div>
        <div><p><img src="https://taptrap.click/assets/martina.png" alt="Philipp"/></p><p>Martina Lindorfer</p>
          <p>TU Wien</p>
          <!-- Social Icons -->
          
        </div>
    </div></section>

  </div></div>
  </body>
</html>
