<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cadence.moe/blog/2022-09-01-discontinuing-bibliogram">Original</a>
    <h1>Bibliogram, Open-source front-end for Instagram, is being discontinued</h1>
    
    <div id="readability-page-1" class="page"><article><p>Before we start: If Bibliogram has been helpful to you, please consider <a href="https://cadence.moe/donate">making a donation!</a> Donations help me pay for servers on my current and future projects, not to mention the time I put into writing code.</p><p><a href="https://craigbarnes.bandcamp.com/track/final-floor-the-mayors-lament">BGM: The Mayor&#39;s Lament</a></p><div><h2>the short version</h2><p>Instagram is really annoying, and I&#39;ve given enough, and I don&#39;t want to deal with it anymore. Bibliogram will remain mostly broken unless somebody steps up to fix it. The main instance, bibliogram.art, will shut down, unless somebody wants to take it over. If you want to try fixing Bibliogram, you should read through the rest of this post for helpful tips about the current situation.</p></div><h2>The origin</h2><p>I started Bibliogram in early 2020 because Instagram was pissing me off. This may sound surprising, but I have never really used Instagram before starting Bibliogram, and I have never had an account, so I didn&#39;t personally care much about looking at Instagram posts. The story is that I encountered Instagram links sent by friends too frequently for my taste and wanted to make a workaround.</p><p>It was annoying to see a login wall in the browser when the server didn&#39;t try to stop you from accessing the data at all. So Bibliogram accessed the server and put the posts into a friendlier page layout and that was it.</p><p>A much-requested feature I added early on was RSS feeds. <a href="https://cadence.moe/blog/2020-04-24-bibliogram-stats-ii">This ended up getting quickly turned off for the main instance,</a> because RSS usage was dwarfing interactive usage. Many of these feeds had been added to people&#39;s readers and forgotten about. Even today I still receive a decent number of forgotten requests for feeds — these forgotten feeds haven&#39;t returned useful data for more than two years. Feed requests aren&#39;t free. Bibliogram needs to make an outgoing web request, wait for it, and convert the response data. This also uses up a piece of Bibliogram&#39;s rate limit to Instagram, even if nobody&#39;s there to see the feed that Bibliogram generates.</p><h2>The rate limit</h2><p>Bibliogram rate-limits access to its servers to stop people from doing the exact thing I&#39;m doing. I&#39;ll try to document here the phases that I went through, but I might have forgotten some of those phases.</p><p>Don&#39;t panic: I am not documenting any of the currently working workarounds, only the past ones which are useless except for historical interest.</p><p>I&#39;ll be using <code>rkrkrk</code> as a sample username.</p><h3>Before my time: rhx_gis</h3><p>There&#39;s a parameter in profile pages called rhx_gis and your application needed to remember this parameter so that it can use it in subsequent requests. If you use the wrong rhx_gis, you&#39;re locked out. Instagram used this in the past, but didn&#39;t require it when I started working on Bibliogram in January 2020.</p><h3>January 2020: main profile page</h3><p>After 100 or so requests to profile pages like <code>instagram.com/rkrkrk</code> they&#39;ll stop returning a useful response until you cool down. Timeline continuations weren&#39;t limited, but you could only access the timeline if you knew the internal user ID, and you could only get that ID from the profile page. So if you&#39;d accessed a profile page in the past, you could store the ID and you only needed to access the timeline continuation from then on, which wasn&#39;t limited. Problem solved.</p><p>(Currently, the limit on requests to profile pages is <em>way</em> less than 100. It&#39;s more like 3. I don&#39;t remember when they lowered it.)</p><h3>June 2020: profile page blocked for servers</h3><p>You can now only access a profile page if you&#39;re in somebody&#39;s house in real life — so not if you&#39;re a server on the internet. <a href="https://git.sr.ht/~cadence/bibliogram-docs/tree/master/item/docs/Instagram%20rate%20limits.md">This era was documented here,</a> and it was the first time people saw the notice that an instance was blocked. This limitation means Bibliogram could only load profiles it already knew the user IDs of. I developed a few ways of working around this:</p><p>For finding user IDs, the <em>assistants</em> feature was added. Trusted people could run the assistant program at home, which would collect user IDs (and nothing else) on behalf of Bibliogram, and Bibliogram instances could share between each other all the user IDs they already knew about.</p><p>Similarly, there was <a href="https://git.sr.ht/~cadence/bibliogram/tree/master/item/scripts/import_users.js">the import script</a>, which copied all user ID mappings from one instance to another. It would output numbers like <code>Imported 492381 entries (37161 new, 138 overwritten, 455082 skipped)</code> which means that 37,161 previously unknown users can now be looked up on that instance thanks to sharing IDs.</p><p>Finally, there was a browser userscript people could install to let them access a specific user ID.</p><p>These bypass methods are all part of Bibliogram&#39;s code still, but they&#39;re not used any more because they&#39;re totally useless.</p><h3>July 2020: /feed/ bypass</h3><p><a href="https://git.sr.ht/~cadence/bibliogram/commit/82ee6e6d6462dc16caa44dd58ae94d77d0435661">I&#39;m Cool.</a> I was messing around with google search and entered the query <code>site:instagram.com</code> just to see what would come up. Curiously, I found a URL like <code>instagram.com/rkrkrk/feed/</code> which is just like a regular profile URL but with <code>/feed/</code> on the end. I clicked it, but the page didn&#39;t load properly. I checked out the page source, and all the data needed for Bibliogram to work is in there. And then I decided to check it out on my server, and it wasn&#39;t blocked at all. In conclusion, Instagram&#39;s internal code is absolutely dogshit. You&#39;ll see more instances of their dogshit code as we continue.</p><p>I put /feed/ into the Bibliogram code and all is well. Total bypass.</p><h3>December 2020: /feed/ blocked for some servers</h3><p><a href="https://lists.sr.ht/~cadence/bibliogram-announce/%3C20201218014302.855fa8a816be2f19da2f56e3%40disroot.org%3E">Here&#39;s the update post for this one.</a> This is INSTAGRAM_BLOCK_TYPE_DECEMBER in the code. /feed/ requests are now blocked for some servers - but not all. I moved Bibliogram to Iperweb, the first suggestion I got, and it works again. (Iperweb has poor value for money servers though, I wouldn&#39;t recommend you use that particular company.) Requests now work most of the time. My memory is a bit fuzzy on this one.</p><h3>Late January 2021: graphql mostly blocked</h3><p>Each graphql request has a different set of rules based on the matrix of whether you&#39;re at home or a cloud server or accessing via Tor, and which query_hash you&#39;re accessing. There&#39;s about 4 different behaviours that are fixed for a particular location-endpoint combination, but are seemingly assigned randomly. Why? Probably because its code is dogshit. Anyway, I route through Tor <a href="https://git.sr.ht/~cadence/bibliogram/tree/d576b3ef7655a42128eafb0224be2d2219e5338f/item/src/lib/constants.js#L31">but only for the ones that work through Tor.</a></p><p>After fixing this, I guess nothing really happened for a while? Bibliogram was in a state of mostly-working. It worked the best I could make it work while always scraping from logged-out resources. If you&#39;re logged into an account, it&#39;s another matter entirely. A whole world of endpoints opens up to you, especially ones used by the official app. However, if you make a wrong move, Instagram will not hesitate to shut down the account for supposedly suspicious activity, and creating an account also means agreeing to the Instagram terms of service, which I do not wish to do.</p><h3>July 2022: overhaul</h3><p>Instagram radically changed the way it internally arranges the data in its pages, requiring new ways to make requests and new ways to parse through it.</p><p>For the profile page, there are 4 different ways that the data might be provided, and your extractor has to handle all 4. It seems to switch which format is being used every few hours. If it&#39;s not the right time, then the exractor you&#39;re using will fail. Here are the formats:</p><ul><li>iweb, pass in the username, get user object json. rate limit maybe 50 or 100 per hour?</li><li><code>instagram.com/rkrkrk/?__a=1</code> ajax after original page load, tiny tiny tiny rate limit.</li><li><code>https://www.instagram.com/rkrkrk</code> and extract _sharedData, similarly tiny tiny tiny rate limit. You can try the /feed/ workaround, which used to give more requests, but this appears to finally be patched now. /feed/ might only work from specific classes of IP addresses.</li><li><code>instagram.com/rkrkrk</code> or /feed/ and extract PolarisQueryPreloaderCache.</li></ul><p>While it is still possible to write code to handle these methods and switch between them, some of them are rate limited too heavily to make Bibliogram viable at those times. Tor seems to be restricted further, though not completely.</p><h2>Bots accessing Bibliogram</h2><p>From as soon as mid-2020 I began to deal with a serious problem of poorly coded bots accessing Bibliogram and using up its rate limit. These bots were created without regard for whether their requests succeed and they don&#39;t acknowledge my requests to slow down. They were designed specifically to scrape data from Bibliogram, and the owners were apparently too lazy to run their own instance of Bibliogram, or to contact me asking for help setting one up. The bots are a problem because they appear to be unmonitored, and they&#39;re using up the rate limit that would be better if it were helping real people. In August 2020 I blocked various proxy networks from accessing my site, then dealt with the really bad offenders on a case-by-case basis. <a href="https://meta.bibliogram.art/quota-list/">Here&#39;s the list that&#39;s currently being used.</a></p><p>Later on, I&#39;d create a system where Bibliogram dynamically applies its own rate-limiting system to anyone accessing it.</p><p>I think a mistake I made here was the faceless approach to blocking people who are being a problem. They treat being blocked as a <em>puzzle</em> to overcome, and Bibliogram as just another faceless website, rather than something being run by real people who want to help. In the future I&#39;d approach this differently by giving bots a custom error message that appeals to the operators&#39; humanity and asks them to contact me rather than just trying to work around the block. <a href="https://youtu.be/Ae5yV4p7uh8?t=35">Kind of like the anti-piracy screen in Just Shapes And Beats.</a></p><h2>Why is Bibliogram discontinued?</h2><p>The simultaneous crackdown on /feed/ and Tor and with needing to write new code to scrape the page is too much for me to bother with, especially when I am working on it in my spare time and have no personal interest or incentive.</p><h2>What does discontinued mean?</h2><p>You can&#39;t look at profiles. You can still look at individual posts, but if this breaks in the future, I probably won&#39;t fix it.</p><p>The main instance, bibliogram.art, will shut down unless somebody offers to take over running it.</p><h2>Can it be revived?</h2><p>Bibliogram is open source, and it is still excellent code to build on top of, since it has the interface design, the post models, and the structures set up to perform several workarounds.</p><p>All that is needed to make it work is a function in collectors.js or body.js to access the data in the new format.</p><p>More Instagram workarounds are definitely possible due to its code still being dogshit, but I don&#39;t have the energy to look for more workarounds myself.</p><p>Yes, Bibliogram can be revived. But I won&#39;t be the one to make it happen.</p><p>If you decide to take up the task, I have three simple but important requests.</p><ol><li>Get in touch. <a href="https://cadence.moe/contact">Reach out to me</a> via email or Matrix or something. Maybe even join the existing chatroom. Let me know that my efforts weren&#39;t in vain. I might even be able to help you work with my code. I&#39;m a generous person and I would really love to see Bibliogram revived!</li><li><em>Please</em> immediately edit the homepage and the readme to not mention me or my repos. I don&#39;t want people to assume that I&#39;m still in charge of the project.</li><li>I would suggest changing the name. If you&#39;re stuck for names, &#34;Bibliograph&#34; has been bouncing around in my head for a while, try that as a name. I&#39;m okay with you keeping the name the same if you don&#39;t want to change it.</li></ol><h2>Shoutouts</h2><p>Huge huge massive thanks to the volunteers that translated Bibliogram&#39;s interface to their language, and I&#39;m sorry that I let down your hard work a bit by discontinuing Bibliogram. I&#39;ve credited you all again here to show just how important you are!</p><ul><li>Esmail, for the Arabic (العربية) translation</li><li>Plamen, for the Bulgarian (Български) translation</li><li>Philipp Beckers, for the German (Deutsch) translation</li><li>tagomago, for the Spanish (Español) translation</li><li>Mostafa, for the Persian (فارسي) translation and their patience helping me understand bidirectional text</li><li>bopol, for the French (français) translation</li><li>XoseM, for the Galician (Galego) translation</li><li>Musthafa, for the Indonesian (Bahasa Indonesia) translation</li><li>Saverio Morelli, for the Italian (Italiano) translation</li><li>learnpastsole, for the Malay (Bahasa Melayu) translation</li><li>sech1p, for the Polish (Polski) translation</li><li>tmpod, for the Portuguese (Português) translation</li><li>TotalCaesar, for the Russian (Русский) translation</li><li>Ahmet, for the Turkish (Türkçe) translation</li><li>Суспільне, for the Ukrainian (Українська) translation</li></ul><p>Thanks to the Bibliogram chatroom for keeping me company and coming along on the ride with me.</p><p>Thanks for Austin Huang for creating a real alternative to the Instagram app. May Barinsta rest in peace.</p><p>For the people in #87806986 on /g/, you are fucking <em>hilarious.</em> Maybe the best way to cheer somebody up really is by showing them a clown.</p><h2>What&#39;s next?</h2><p>Something very exciting is coming next. Stay tuned for my next blog post: <strong>Announcing BreezeWiki.</strong></p><p>See ya!</p><p>— Cadence</p></article></div>
  </body>
</html>
