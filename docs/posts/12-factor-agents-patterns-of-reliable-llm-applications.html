<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/humanlayer/12-factor-agents">Original</a>
    <h1>12-factor Agents: Patterns of reliable LLM applications</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"> 

<p dir="auto"><em>In the spirit of <a href="https://12factor.net/" rel="nofollow">12 Factor Apps</a></em>.  <em>The source for this project is public at <a href="https://github.com/humanlayer/12-factor-agents">https://github.com/humanlayer/12-factor-agents</a>, and I welcome your feedback and contributions. Let&#39;s figure this out together!</em></p>
<p dir="auto"><a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="nofollow"><img src="https://camo.githubusercontent.com/8893a5ee2d7f73909733da3e88ef024aab2bb1fce0ada8155499b8db59b4d148/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d434325323042592d2d5341253230342e302d6c69676874677265792e737667" alt="License: CC BY-SA 4.0" data-canonical-src="https://img.shields.io/badge/License-CC%20BY--SA%204.0-lightgrey.svg"/></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/e4e601033a4d3f263eeda230e92e56ee468dd4848c09401284266612b51bd6b3/68747470733a2f2f7374617469632e73636172662e73682f612e706e673f782d707869643d32616361643939612d633264392d343864662d383666352d396361383036316237626639"><img src="https://camo.githubusercontent.com/e4e601033a4d3f263eeda230e92e56ee468dd4848c09401284266612b51bd6b3/68747470733a2f2f7374617469632e73636172662e73682f612e706e673f782d707869643d32616361643939612d633264392d343864662d383666352d396361383036316237626639" data-canonical-src="https://static.scarf.sh/a.png?x-pxid=2acad99a-c2d9-48df-86f5-9ca8061b7bf9"/></a></p>
<p dir="auto"><a href="#visual-nav"><img width="907" alt="Screenshot 2025-04-03 at 2 49 07â€¯PM" src="https://private-user-images.githubusercontent.com/3730605/430151074-23286ad8-7bef-4902-b371-88ff6a22e998.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDQ4ODg4MDgsIm5iZiI6MTc0NDg4ODUwOCwicGF0aCI6Ii8zNzMwNjA1LzQzMDE1MTA3NC0yMzI4NmFkOC03YmVmLTQ5MDItYjM3MS04OGZmNmEyMmU5OTgucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDQxNyUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTA0MTdUMTExNTA4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9Nzg0NDY0YjU4MTg1MDhmMDVkMzg2N2VlZDRhNTczODUwMGIxOTFhMDU2YjljZmY2NzQ5ZTQ1MzBkNGU5NmQ1ZCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.Ce8gKZ4JiNysHljuSdDQDRDuJG2X64PGtKYoR5SBYi0" secured-asset-link=""/></a></p>
<p dir="auto">Hi, I&#39;m Dex. I&#39;ve been <a href="https://youtu.be/8bIHcttkOTE" rel="nofollow">hacking</a> on <a href="https://theouterloop.substack.com" rel="nofollow">AI agents</a> for <a href="https://humanlayer.dev" rel="nofollow">a while</a>.</p>
<p dir="auto"><strong>I&#39;ve tried every agent framework out there</strong>, from the plug-and-play crew/langchains to the &#34;minimalist&#34; smolagents of the world to the &#34;production grade&#34; langraph, griptape, etc.</p>
<p dir="auto"><strong>I&#39;ve talked to a lot of really strong founders</strong>, in and out of YC, who are all building really impressive things with AI. Most of them are rolling the stack themselves. I don&#39;t see a lot of frameworks in production customer-facing agents.</p>
<p dir="auto"><strong>I&#39;ve been surprised to find</strong> that most of the products out there billing themselves as &#34;AI Agents&#34; are not all that agentic. A lot of them are mostly deterministic code, with LLM steps sprinkled in at just the right points to make the experience truly magical.</p>
<p dir="auto">Agents, at least the good ones, don&#39;t follow the <a href="https://www.anthropic.com/engineering/building-effective-agents#agents" rel="nofollow">&#34;here&#39;s your prompt, here&#39;s a bag of tools, loop until you hit the goal&#34;</a> pattern. Rather, they are comprised of mostly just software.</p>
<p dir="auto">So, I set out to answer:</p>
<blockquote>
<div dir="auto"><h3 tabindex="-1" dir="auto"><strong>What are the principles we can use to build LLM-powered software that is actually good enough to put in the hands of production customers?</strong></h3><a id="user-content-what-are-the-principles-we-can-use-to-build-llm-powered-software-that-is-actually-good-enough-to-put-in-the-hands-of-production-customers" aria-label="Permalink: What are the principles we can use to build LLM-powered software that is actually good enough to put in the hands of production customers?" href="#what-are-the-principles-we-can-use-to-build-llm-powered-software-that-is-actually-good-enough-to-put-in-the-hands-of-production-customers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
</blockquote>
<p dir="auto">Welcome to 12-factor agents. As every Chicago mayor since Daley has consistently plastered all over the city&#39;s major airports, we&#39;re glad you&#39;re here.</p>
<p dir="auto"><em>Special thanks to <a href="https://github.com/iantbutler01">@iantbutler01</a>, <a href="https://github.com/tnm">@tnm</a>, <a href="https://www.github.com/hellovai">@hellovai</a>, <a href="https://www.github.com/stantonk">@stantonk</a>, <a href="https://www.github.com/balanceiskey">@balanceiskey</a>, <a href="https://www.github.com/AdjectiveAllison">@AdjectiveAllison</a>, <a href="https://www.github.com/pfbyjy">@pfbyjy</a>, <a href="https://www.github.com/a-churchill">@a-churchill</a>, and the SF MLOps community for early feedback on this guide.</em></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">The Short Version: The 12 Factors</h2><a id="user-content-the-short-version-the-12-factors" aria-label="Permalink: The Short Version: The 12 Factors" href="#the-short-version-the-12-factors"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Even if LLMs <a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-10-small-focused-agents.md#what-if-llms-get-smarter">continue to get exponentially more powerful</a>, there will be core engineering techniques that make LLM-powered software more reliable, more scalable, and easier to maintain.</p>
<ul dir="auto">
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/brief-history-of-software.md">How We Got Here: A Brief History of Software</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-1-natural-language-to-tool-calls.md">Factor 1: Natural Language to Tool Calls</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-2-own-your-prompts.md">Factor 2: Own your prompts</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-3-own-your-context-window.md">Factor 3: Own your context window</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-4-tools-are-structured-outputs.md">Factor 4: Tools are just structured outputs</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-5-unify-execution-state.md">Factor 5: Unify execution state and business state</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-6-launch-pause-resume.md">Factor 6: Launch/Pause/Resume with simple APIs</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-7-contact-humans-with-tools.md">Factor 7: Contact humans with tool calls</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-8-own-your-control-flow.md">Factor 8: Own your control flow</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-9-compact-errors.md">Factor 9: Compact Errors into Context Window</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-10-small-focused-agents.md">Factor 10: Small, Focused Agents</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-11-trigger-from-anywhere.md">Factor 11: Trigger from anywhere, meet users where they are</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-12-stateless-reducer.md">Factor 12: Make your agent a stateless reducer</a></li>
</ul>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-1-natural-language-to-tool-calls.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/110-natural-language-tool-calls.png" alt="factor 1"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-2-own-your-prompts.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/120-own-your-prompts.png" alt="factor 2"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-3-own-your-context-window.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/130-own-your-context-building.png" alt="factor 3"/></a></td>
</tr>
<tr>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-4-tools-are-structured-outputs.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/140-tools-are-just-structured-outputs.png" alt="factor 4"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-5-unify-execution-state.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/150-unify-state.png" alt="factor 5"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-6-launch-pause-resume.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/160-pause-resume-with-simple-apis.png" alt="factor 6"/></a></td>
</tr>
<tr>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-7-contact-humans-with-tools.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/170-contact-humans-with-tools.png" alt="factor 7"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-8-own-your-control-flow.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/180-control-flow.png" alt="factor 8"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-9-compact-errors.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/190-factor-9-errors-static.png" alt="factor 9"/></a></td>
</tr>
<tr>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-10-small-focused-agents.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/1a0-small-focused-agents.png" alt="factor 10"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-11-trigger-from-anywhere.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/1b0-trigger-from-anywhere.png" alt="factor 11"/></a></td>
<td><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-12-stateless-reducer.md"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/1c0-stateless-reducer.png" alt="factor 12"/></a></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">For a deeper dive on my agent journey and what led us here, check out <a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/brief-history-of-software.md">A Brief History of Software</a> - a quick summary here:</p>

<p dir="auto">We&#39;re gonna talk a lot about Directed Graphs (DGs) and their Acyclic friends, DAGs. I&#39;ll start by pointing out that...well...software is a directed graph. There&#39;s a reason we used to represent programs as flow charts.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/humanlayer/12-factor-agents/blob/main/img/010-software-dag.png"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/010-software-dag.png" alt="010-software-dag"/></a></p>

<p dir="auto">Around 20 years ago, we started to see DAG orchestrators become popular. We&#39;re talking classics like <a href="https://airflow.apache.org/" rel="nofollow">Airflow</a>, <a href="https://www.prefect.io/" rel="nofollow">Prefect</a>, some predecessors, and some newer ones like (<a href="https://dagster.io/" rel="nofollow">dagster</a>, <a href="https://www.inngest.dev/" rel="nofollow">inggest</a>, <a href="https://www.windmill.dev/" rel="nofollow">windmill</a>). These followed the same graph pattern, with the added benefit of observability, modularity, retries, administration, etc.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/humanlayer/12-factor-agents/blob/main/img/015-dag-orchestrators.png"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/015-dag-orchestrators.png" alt="015-dag-orchestrators"/></a></p>

<p dir="auto">I&#39;m not the first <a href="https://youtu.be/Dc99-zTMyMg?si=bcT0hIwWij2mR-40&amp;t=73" rel="nofollow">person to say this</a>, but my biggest takeaway when I started learning about agents, was that you get to throw the DAG away. Instead of software engineers coding each step and edge case, you can give the agent a goal and a set of transitions:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/humanlayer/12-factor-agents/blob/main/img/025-agent-dag.png"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/025-agent-dag.png" alt="025-agent-dag"/></a></p>
<p dir="auto">And let the LLM make decisions in real time to figure out the path</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/humanlayer/12-factor-agents/blob/main/img/026-agent-dag-lines.png"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/026-agent-dag-lines.png" alt="026-agent-dag-lines"/></a></p>
<p dir="auto">The promise here is that you write less software, you just give the LLM the &#34;edges&#34; of the graph and let it figure out the nodes. You can recover from errors, you can write less code, and you may find that LLMs find novel solutions to problems.</p>

<p dir="auto">As we&#39;ll see later, it turns out this doesn&#39;t quite work.</p>
<p dir="auto">Let&#39;s dive one step deeper - with agents you&#39;ve got this loop consisting of 3 steps:</p>
<ol dir="auto">
<li>LLM determines the next step in the workflow, outputting structured json (&#34;tool calling&#34;)</li>
<li>Deterministic code executes the tool call</li>
<li>The result is appended to the context window</li>
<li>repeat until the next step is determined to be &#34;done&#34;</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="initial_event = {&#34;message&#34;: &#34;...&#34;}
context = [initial_event]
while True:
  next_step = await llm.determine_next_step(context)
  context.append(next_step)

  if (next_step.intent === &#34;done&#34;):
    return next_step.final_answer

  result = await execute_step(next_step)
  context.append(result)"><pre><span>initial_event</span> <span>=</span> {<span>&#34;message&#34;</span>: <span>&#34;...&#34;</span>}
<span>context</span> <span>=</span> [<span>initial_event</span>]
<span>while</span> <span>True</span>:
  <span>next_step</span> <span>=</span> <span>await</span> <span>llm</span>.<span>determine_next_step</span>(<span>context</span>)
  <span>context</span>.<span>append</span>(<span>next_step</span>)

  <span>if</span> (<span>next_step</span>.<span>intent</span> <span>==</span><span>=</span> <span>&#34;done&#34;</span>):
    <span>return</span> <span>next_step</span>.<span>final_answer</span>

  <span>result</span> <span>=</span> <span>await</span> <span>execute_step</span>(<span>next_step</span>)
  <span>context</span>.<span>append</span>(<span>result</span>)</pre></div>
<p dir="auto">Our initial context is just the starting event (maybe a user message, maybe a cron fired, maybe a webhook, etc), and we ask the llm to choose the next step (tool) or to determine that we&#39;re done.</p>
<p dir="auto">Here&#39;s a multi-step example:</p>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description 027-agent-loop-animation.mp4">027-agent-loop-animation.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/3730605/428690858-3beb0966-fdb1-4c12-a47f-ed4e8240f8fd.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDQ4ODg4MDgsIm5iZiI6MTc0NDg4ODUwOCwicGF0aCI6Ii8zNzMwNjA1LzQyODY5MDg1OC0zYmViMDk2Ni1mZGIxLTRjMTItYTQ3Zi1lZDRlODI0MGY4ZmQubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDQxNyUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTA0MTdUMTExNTA4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjM5ZjdjMWFkYmU0MzFmZWE3MGM1OGU3YjhjNDc3NjBhMDAzOGFiNTZjYzcyMzBhODhhYjBjOGFiMzFjMjk4NyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.LFqd6F4Y1O-OOSP-exaHl7GXrUkbuIo2tgPBNuSgoKg" data-canonical-src="https://private-user-images.githubusercontent.com/3730605/428690858-3beb0966-fdb1-4c12-a47f-ed4e8240f8fd.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDQ4ODg4MDgsIm5iZiI6MTc0NDg4ODUwOCwicGF0aCI6Ii8zNzMwNjA1LzQyODY5MDg1OC0zYmViMDk2Ni1mZGIxLTRjMTItYTQ3Zi1lZDRlODI0MGY4ZmQubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDQxNyUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTA0MTdUMTExNTA4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjM5ZjdjMWFkYmU0MzFmZWE3MGM1OGU3YjhjNDc3NjBhMDAzOGFiNTZjYzcyMzBhODhhYjBjOGFiMzFjMjk4NyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.LFqd6F4Y1O-OOSP-exaHl7GXrUkbuIo2tgPBNuSgoKg" controls="controls" muted="muted">

  </video>
</details>

<details>
<summary><a href="https://github.com/humanlayer/12-factor-agents/blob/main/img/027-agent-loop-animation.gif">GIF Version</a></summary>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/humanlayer/12-factor-agents/blob/main/img/027-agent-loop-animation.gif"><img src="https://github.com/humanlayer/12-factor-agents/raw/main/img/027-agent-loop-animation.gif" alt="027-agent-loop-animation" data-animated-image=""/></a>]</p>
</details>

<p dir="auto">At the end of the day, this approach just doesn&#39;t work as well as we want it to.</p>
<p dir="auto">In building HumanLayer, I&#39;ve talked to at least 100 SaaS builders (mostly technical founders) looking to make their existing product more agentic. The journey usually goes something like:</p>
<ol dir="auto">
<li>Decide you want to build an agent</li>
<li>Product design, UX mapping, what problems to solve</li>
<li>Want to move fast, so grab $FRAMEWORK and <em>get to building</em></li>
<li>Get to 70-80% quality bar
5a. Realize that 80% isn&#39;t good enough for most customer-facing features
5b. Realize that getting past 80% requires reverse-engineering the framework, prompts, flow, etc</li>
<li>Start over from scratch</li>
</ol>
<details>
<summary>Random Disclaimers</summary>
<p dir="auto"><strong>DISCLAIMER</strong>: I&#39;m not sure the exact right place to say this, but here seems as good as any: <strong>this in BY NO MEANS meant to be a dig on either the many frameworks out there, or the pretty dang smart people who work on them</strong>. They enable incredible things and have accelerated the AI ecosystem.</p>
<p dir="auto">I hope that one outcome of this post is that agent framework builders can learn from the journeys of myself and others, and make frameworks even better.</p>
<p dir="auto">Especially for builders who want to move fast but need deep control.</p>
<p dir="auto"><strong>DISCLAIMER 2</strong>: I&#39;m not going to talk about MCP. I&#39;m sure you can see where it fits in.</p>
<p dir="auto"><strong>DISCLAIMER 3</strong>: I&#39;m using mostly typescript, for <a href="https://www.linkedin.com/posts/dexterihorthy_llms-typescript-aiagents-activity-7290858296679313408-Lh9e?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAA4oHTkByAiD-wZjnGsMBUL_JT6nyyhOh30" rel="nofollow">reasons</a> but all this stuff works in python or any other language you prefer.</p>
<p dir="auto">Anyways back to the thing...</p>
</details>
<div dir="auto"><h3 tabindex="-1" dir="auto">Design Patterns for great LLM applications</h3><a id="user-content-design-patterns-for-great-llm-applications" aria-label="Permalink: Design Patterns for great LLM applications" href="#design-patterns-for-great-llm-applications"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">After digging through hundreds of AI libriaries and working with dozens of founders, my instinct is this:</p>
<ol dir="auto">
<li>There are some core things that make agents great</li>
<li>Going all in on a framework and building what is essentially a greenfield rewrite may be counter-productive</li>
<li>There are some core principles that make agents great, and you will get most/all of them if you pull in a framework</li>
<li>BUT, the fastest way I&#39;ve seen for builders to get high-quality AI software in the hands of customers is to take small, modular concepts from agent building, and incorporate them into their existing product</li>
<li>These modular concepts from agents can be defined and applied by most skilled software engineers, even if they don&#39;t have an AI background</li>
</ol>
<blockquote>
<div dir="auto"><h4 tabindex="-1" dir="auto">The fastest way I&#39;ve seen for builders to get good AI software in the hands of customers is to take small, modular concepts from agent building, and incorporate them into their existing product</h4><a id="user-content-the-fastest-way-ive-seen-for-builders-to-get-good-ai-software-in-the-hands-of-customers-is-to-take-small-modular-concepts-from-agent-building-and-incorporate-them-into-their-existing-product" aria-label="Permalink: The fastest way I&#39;ve seen for builders to get good AI software in the hands of customers is to take small, modular concepts from agent building, and incorporate them into their existing product" href="#the-fastest-way-ive-seen-for-builders-to-get-good-ai-software-in-the-hands-of-customers-is-to-take-small-modular-concepts-from-agent-building-and-incorporate-them-into-their-existing-product"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
</blockquote>

<ul dir="auto">
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/brief-history-of-software.md">How We Got Here: A Brief History of Software</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-1-natural-language-to-tool-calls.md">Factor 1: Natural Language to Tool Calls</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-2-own-your-prompts.md">Factor 2: Own your prompts</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-3-own-your-context-window.md">Factor 3: Own your context window</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-4-tools-are-structured-outputs.md">Factor 4: Tools are just structured outputs</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-5-unify-execution-state.md">Factor 5: Unify execution state and business state</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-6-launch-pause-resume.md">Factor 6: Launch/Pause/Resume with simple APIs</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-7-contact-humans-with-tools.md">Factor 7: Contact humans with tool calls</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-8-own-your-control-flow.md">Factor 8: Own your control flow</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-9-compact-errors.md">Factor 9: Compact Errors into Context Window</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-10-small-focused-agents.md">Factor 10: Small, Focused Agents</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-11-trigger-from-anywhere.md">Factor 11: Trigger from anywhere, meet users where they are</a></li>
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-12-stateless-reducer.md">Factor 12: Make your agent a stateless reducer</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Honorable Mentions / other advice</h2><a id="user-content-honorable-mentions--other-advice" aria-label="Permalink: Honorable Mentions / other advice" href="#honorable-mentions--other-advice"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://github.com/humanlayer/12-factor-agents/blob/main/content/appendix-13-pre-fetch.md">Factor 13: Pre-fetch all the context you might need</a></li>
</ul>

<ul dir="auto">
<li>Contribute to this guide <a href="https://github.com/humanlayer/12-factor-agents">here</a></li>
<li><a href="https://youtu.be/8bIHcttkOTE" rel="nofollow">I talked about a lot of this on an episode of the Tool Use podcast</a> in March 2025</li>
<li>I write about some of this stuff at <a href="https://theouterloop.substack.com" rel="nofollow">The Outer Loop</a></li>
<li>I do <a href="https://github.com/hellovai/ai-that-works/tree/main">webinars about Maximizing LLM Performance</a> with <a href="https://github.com/hellovai">@hellovai</a></li>
<li>We build OSS agents with this methodology under <a href="https://github.com/got-agents/agents">got-agents/agents</a></li>
<li>We ignored all our own advice and built a <a href="https://github.com/humanlayer/kubechain">framework for running distributed agents in kubernetes</a></li>
<li>Other links from this guide:
<ul dir="auto">
<li><a href="https://www.anthropic.com/engineering/building-effective-agents#agents" rel="nofollow">Building Effective Agents (Anthropic)</a></li>
<li><a href="https://thedataexchange.media/baml-revolution-in-ai-engineering/" rel="nofollow">Prompts are Functions</a></li>
<li><a href="https://github.com/dexhorthy/mailcrew">Mailcrew Agent</a></li>
<li><a href="https://www.youtube.com/watch?v=f_cKnoPC_Oo" rel="nofollow">Mailcrew Demo Video</a></li>
<li><a href="https://x.com/chainlit_io/status/1858613325921480922" rel="nofollow">Chainlit Demo</a></li>
<li><a href="https://www.linkedin.com/posts/dexterihorthy_llms-typescript-aiagents-activity-7290858296679313408-Lh9e" rel="nofollow">TypeScript for LLMs</a></li>
<li><a href="https://www.boundaryml.com/blog/schema-aligned-parsing" rel="nofollow">Schema Aligned Parsing</a></li>
<li><a href="https://www.vellum.ai/blog/when-should-i-use-function-calling-structured-outputs-or-json-mode" rel="nofollow">Function Calling vs Structured Outputs vs JSON Mode</a></li>
<li><a href="https://github.com/boundaryml/baml">BAML on GitHub</a></li>
<li><a href="https://docs.llamaindex.ai/en/stable/examples/llm/openai_json_vs_function_calling/" rel="nofollow">OpenAI JSON vs Function Calling</a></li>
<li><a href="https://theouterloop.substack.com/p/openais-realtime-api-is-a-step-towards" rel="nofollow">Outer Loop Agents</a></li>
<li><a href="https://airflow.apache.org/" rel="nofollow">Airflow</a></li>
<li><a href="https://www.prefect.io/" rel="nofollow">Prefect</a></li>
<li><a href="https://dagster.io/" rel="nofollow">Dagster</a></li>
<li><a href="https://www.inngest.dev/" rel="nofollow">Inngest</a></li>
<li><a href="https://www.windmill.dev/" rel="nofollow">Windmill</a></li>
<li><a href="https://aiagentindex.mit.edu/" rel="nofollow">The AI Agent Index (MIT)</a></li>
<li><a href="https://open.substack.com/pub/swyx/p/notebooklm?selection=08e1187c-cfee-4c63-93c9-71216640a5f8" rel="nofollow">NotebookLM on Finding Model Capability Boundaries</a></li>
</ul>
</li>
</ul>
</article></div></div>
  </body>
</html>
