<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kau.sh/blog/hacking-your-keyboard/">Original</a>
    <h1>Hacking Your Keyboard with Karabiner</h1>
    
    <div id="readability-page-1" class="page"><div id="site-content">
<section>

<article>
<p>tl;dr:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>brew install yqrashawn/goku/goku
</span></span><span><span>mkdir -p ~/.config <span>&amp;&amp;</span> cd ~/.config
</span></span><span><span>touch karabiner/karabiner.json
</span></span><span><span>touch karabiner.edn
</span></span><span><span><span># update your edn file with a sample from here https://github.com/yqrashawn/GokuRakuJoudo/blob/master/tutorial.md</span>
</span></span><span><span><span># or mine: https://gist.github.com/kaushikgopal/ff7a92bbc887e59699c804b59074a126</span>
</span></span><span><span>goku
</span></span></code></pre></div>
<p>I‚Äôve been messing with mechanical keyboards recently.<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> There was one in particular which is a 60% layout that I fell in love with.</p>
<p>The trouble with 60% keyboards though is that they can be pretty constraining for some basic operations (like navigation). Notice there aren‚Äôt dedicated keys for the up/left/down/arrows.</p>
<figure>

</figure>
<p>Given these constraints, you have to get a little creative with how you use a keyboard. I added a bunch of mods for the keyboard using the mechanical keyboard‚Äôs included software configurator. I liked these mods so much that I wanted to find a way to use these mods with <em>any</em> keyboard I use.</p>
<p>The easiest way I‚Äôve found on the Mac to do this is using <a href="https://karabiner-elements.pqrs.org/">Karabiner</a>. Karabiner intercepts every keystroke and allows you to send alternative signals.</p>
<p>For example, a common mod that a lot of programmers like to do is remap their Caps Lock key -&gt; Escape. So if I tap the Caps Lock key, it instead emulates hitting the Escape key. You can do this pretty easily with Karabiner but it barely scratches the surface of Karabiner‚Äôs true power.</p>
<h2 id="complex-modifications">Complex modifications:</h2>
<p>Where Karabiner will truly shine is when you want to do slightly more complex things: for example, take the case of navigation with 60% keyboards. While they don‚Äôt come with dedicated arrow keys you can emulate navigation in a pretty slick way (especiallly for us vim users).</p>
<p>Instead of moving my fingers all the way to the bottom right of my keyboard and aiming for the arrow keys what if I could just keep my fingers on my home row and navigate like so:</p>
<div><pre tabindex="0"><code data-lang="txt"><span><span>tap caps lock once         -&gt; Escape key
</span></span><span><span>hold caps lock             -&gt; left_control
</span></span><span><span>hold caps lock and press h -&gt; left arrow
</span></span><span><span>hold caps lock and press j -&gt; down arrow
</span></span><span><span>hold caps lock and press k -&gt; up arrow
</span></span><span><span>hold caps lock and press l -&gt; right arrow
</span></span></code></pre></div><p>You can of course choose to map any key combo (for example right shift key + W/A/S/D). I chose H/J/K/L cause I‚Äôm a vim user and I love just using h/j/k/l to navigate anywhere on my Mac!</p>
<h2 id="more-complex-modifications">More Complex modifications:</h2>
<p>Even that, just scratches the surface of what you can do with Karabiner. Another quick hack I use and love (as a programmer):</p>
<div><pre tabindex="0"><code data-lang="txt"><span><span>tap  [ once                -&gt; type &#34;[&#34;
</span></span><span><span>hold [ and tap ] key once -&gt; type &#34;{&#34;
</span></span><span><span>tap  ] once                -&gt; type &#34;]&#34;
</span></span><span><span>hold ] and tap [ key once -&gt; type &#34;}&#34;
</span></span></code></pre></div><p>If you‚Äôre a programmer this makes it easier to type curly braces without contorting your fingers and flaring up that RSI. For typing paranthesis there‚Äôs an even better one:</p>
<div><pre tabindex="0"><code data-lang="txt"><span><span>left_shift once     -&gt; type &#34;(&#34;
</span></span><span><span>hold left_shift     -&gt; use as a regular shift key modifier
</span></span><span><span>right_shift once    -&gt; type &#34;)&#34;
</span></span><span><span>hold right_shift    -&gt; used as a regular shift key modifier
</span></span></code></pre></div><h2 id="but-theres-more">But there‚Äôs more!</h2>
<p>Apart from just modifying your key strokes, you can do advanced stuff like launching programs too. For example I typically switch between 3 applications pretty often: <a href="https://iterm2.com/">iTerm</a>, <a href="https://www.mozilla.org/en-US/firefox/">Firefox</a>, <a href="https://culturedcode.com/things/">Things</a>. With Karabiner, I use the same technique but switch programs pretty quickly:</p>
<div><pre tabindex="0"><code data-lang="txt"><span><span>hold o (for &#34;open&#34;) + tap i -&gt; launch &#34;iTerm&#34;
</span></span><span><span>hold o              + tap f -&gt; launch &#34;Firefox&#34;
</span></span><span><span>hold o              + tap t -&gt; launch &#34;Things&#34;
</span></span><span><span>tap o once                  -&gt; type &#34;o&#34;
</span></span></code></pre></div><p>This makes switching between apps almost instant. I don‚Äôt have to carefully Cmd + Tab, visually recognize each icon (adding one extra cognitive step üòÅ) and then launch it. This might seem frivolous at first but once you start using this quick open mode like functionality, it‚Äôs hard to go back to Cmd Tabbing.</p>
<h3 id="turbocharge-mode-karabiner--keyboard-maestro">Turbocharge mode (Karabiner + Keyboard Maestro)</h3>
<p>I swear by <a href="http://www.stairways.com/action/kmdiscount?REF6JZA">Keyboard Maestro</a> and use a lot of my macros pretty often. With Karabiner, I can map certain keyboard strokes to instead launch macros. For example, if I want to quickly Google something, I hold ‚Äúo‚Äù then tap ‚Äúg‚Äù -&gt; this shows an input dialog to take in my text, then launches a new tab in firefox with a url to google prepoulated with my query.</p>
<div><pre tabindex="0"><code data-lang="txt"><span><span>hold &#34;s&#34; + tap g    -&gt; google for something on the web
</span></span></code></pre></div><p>This kind of usage in conjunction with Keyboard Maestro basically unleashes the power of your Mac.</p>

<p>Before you head to the races and start using Karabiner though there‚Äôs one caveat:</p>
<blockquote>
<p>Use <a href="https://github.com/yqrashawn/GokuRakuJoudo#intro">Goku</a> to organize your Karabiner</p>
</blockquote>
<p>See the problem with Karabiner is that if you want to start doing the tricks I mention above, you pretty much have to start meddling directly with this file called <code>karabiner.json</code>. Let‚Äôs just say json is not the most maintainable format for this kind of stuff.</p>
<p>After meddling with Karabiner for a few days, it was clearly getting unwieldy to maintain the json file. So on an exaseperated whim, I went searching for a way to make it easier to deal with Karabiner and found the wonderful <a href="https://github.com/yqrashawn/GokuRakuJoudo">Goku</a>.</p>
<h2 id="enter-gokuhttpsgithubcomyqrashawngokurakujoudointro">Enter <a href="https://github.com/yqrashawn/GokuRakuJoudo#intro">Goku</a></h2>
<p>Goku basically is a DSL where you can write a nice and condensed form of the same code you would otherwise wrangle up in your karabiner.json. You write the code in this special format called <a href="https://github.com/edn-format/edn">‚Äúextensible data notation‚Äù (edn)</a>. Goku then reads that edn format and generates the karabiner.json file for you.</p>
<p>For context:</p>
<ul>
<li>my <a href="https://gist.github.com/kaushikgopal/c802ca81044066f7d93a50c5269cc812"><code>karabiner.json</code></a> file currently has about 920 lines</li>
<li>my <a href="https://gist.github.com/kaushikgopal/ff7a92bbc887e59699c804b59074a126"><code>karabiner.edn</code></a> file on the other hand has 140 lines (and most of it is liberal commenting and whitespace to combat <code>edn</code>‚Äôs terseness)</li>
</ul>
<pre tabindex="0"><code>{:des &#34;o-mode: quick open&#34;
 :rules [:o-mode
            [:f [:open &#34;/Applications/Firefox.app&#34;] ]
            [:g [:km &#34;0) Search Google&#34;] ]
            [:i [:open &#34;/Applications/iTerm.app&#34;] ]
            [:q [:km &#34;open: Quip&#34;] ]
            [:t [:open &#34;/Applications/Things3.app&#34;] ]
]}

{:des &#34;right cmd -&gt; right ctrl&#34;
 :rules [
   [:##right_command :right_control [:apl-usb-int :apl-bt :ap2] ]
 ]}

{:des &#34;left shift once -&gt; (&#34;
 :rules [
   [:##left_shift :left_shift nil {:alone :!S9} ]
 ]}

{:des &#34;right shift once -&gt; )&#34;
 :rules [
   [:##right_shift :right_shift nil {:alone :!S0} ]
 ]}
</code></pre><p>Speaking as a programmer the edn format is quite possibly the most terse, terrible format I‚Äôve encountered. I gave a quick look at <a href="https://github.com/yqrashawn/GokuRakuJoudo/blob/master/examples.org">some of the examples</a> and almost abandoned my Goku effort half way.</p>
<p>But after spending an 11 hour flight back home fiddling and learning how to use Goku, I‚Äôve gotten a decent hang of the format and I admit it‚Äôs <em>super</em> mantainable.</p>
<h2 id="how-to-read-and-use-goku">How to read and use Goku</h2>
<p>I‚Äôm not going to explain how to use Goku, but I‚Äôll tell you what helped me pick it up:</p>
<ol>
<li>Read this <a href="https://medium.com/@nikitavoloboev/karabiner-god-mode-7407a5ddc8f6">fantastic blog post by Nikita Voloboev</a> once</li>
<li>Follow along then with the <a href="https://github.com/yqrashawn/GokuRakuJoudo/blob/master/tutorial.md">official tutorial</a> as they explain the basics</li>
<li>Read the blog post from step 1 again, given you‚Äôre a little more familiar with the format</li>
<li>Read my <a href="https://gist.github.com/kaushikgopal/ff7a92bbc887e59699c804b59074a126"><code>karabiner.edn</code></a> file</li>
</ol>
<p>I spent a lot of time commenting <a href="https://gist.github.com/kaushikgopal/ff7a92bbc887e59699c804b59074a126">my edn file</a> with the hope of making it more readable, so hope that helps. I plan on making a youtube video at some point demoing all this but until that happens, hope this blog post is helpful.</p>
<p>Hit me up on <a href="https://twitter.com/kaushikgopal">Twitter</a> for queries or comments. Super curious to see other creative hacks people can come up with this technique.</p>
<h3 id="example-edns">Example edns</h3>
<ul>
<li><a href="https://github.com/yqrashawn/GokuRakuJoudo/blob/master/in-the-wild.md">goku repo example‚Äôs in the
wild</a></li>
<li><a href="https://github.com/kchen0x/k-goku/blob/master/karabiner.edn">k-goku</a></li>
<li><a href="https://github.com/nikitavoloboev/dotfiles/blob/178ed88fadaeb889e8a5431e9790f0791dd75b05/karabiner/karabiner.edn#L718">nikitavoloboev</a></li>
<li><a href="https://github.com/yqrashawn/GokuRakuJoudo/blob/master/examples.org">examples.org</a></li>
</ul>

</article></section>
</div></div>
  </body>
</html>
