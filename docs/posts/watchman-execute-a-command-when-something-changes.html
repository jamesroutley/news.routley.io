<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/crodjer/watchman">Original</a>
    <h1>Watchman: Execute a command when something changes</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<h2 dir="auto"><a id="user-content-name" aria-hidden="true" href="#name"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NAME</h2>
<p dir="auto">watchman - execute a command when something changes</p>
<h2 dir="auto"><a id="user-content-synopsis" aria-hidden="true" href="#synopsis"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SYNOPSIS</h2>
<div data-snippet-clipboard-copy-content="watchman [OPTIONS] &lt;FILE PATTERNS&gt; -- &lt;COMMAND&gt;
watchman [OPTIONS] &lt;FILE NAME&gt; &lt;COMMAND&gt;"><pre><code>watchman [OPTIONS] &lt;FILE PATTERNS&gt; -- &lt;COMMAND&gt;
watchman [OPTIONS] &lt;FILE NAME&gt; &lt;COMMAND&gt;
</code></pre></div>
<h2 dir="auto"><a id="user-content-description" aria-hidden="true" href="#description"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DESCRIPTION</h2>
<p dir="auto"><strong>Execute a command as things change in file(s)/directory(s).</strong></p>
<p dir="auto">I have always wanted a <code>watch</code> tool which instead of being based on time (the
watch command) will be based on space (files). That is what watch <code>watchman</code> is.</p>
<p dir="auto">It uses <a href="https://github.com/rvoicilas/inotify-tools">inotify tools</a> to provide
that functionality. Watchman just listens to what <code>inotifywait</code> (from
intoify-tools package of your distribution) says and executes commands.</p>
<p dir="auto">This basically provides a continuous execution system, while not having to set
up a elaborate project configuration (say, when what you are working on is just
a tiny script).</p>
<p dir="auto">In case of bigger projects, you could also have a test suit which needs to be
run when you edit a project file.</p>
<p dir="auto">Watchman also takes special care of not cluttering the <code>STDOUT</code>. Only your
actual command can write to <code>STDOUT</code>.</p>
<h2 dir="auto"><a id="user-content-options" aria-hidden="true" href="#options"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>OPTIONS</h2>
<div data-snippet-clipboard-copy-content=" -h          Show detailed help
 -v          Verbose output
 -x PATTERN  Exclude files matching PATTERN (POSIX extended regular expression)
 -r          Watch files recursively
 -b          Beep when command execution fails"><pre><code> -h          Show detailed help
 -v          Verbose output
 -x PATTERN  Exclude files matching PATTERN (POSIX extended regular expression)
 -r          Watch files recursively
 -b          Beep when command execution fails
</code></pre></div>
<h2 dir="auto"><a id="user-content-file-patterns" aria-hidden="true" href="#file-patterns"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>FILE PATTERNS</h2>
<p dir="auto">Space separated file names/patterns which are to be watched by &#39;watchman&#39;. This
can also be a directory, in which case, all the files will be watched for
changes.</p>
<h2 dir="auto"><a id="user-content-command" aria-hidden="true" href="#command"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>COMMAND</h2>
<p dir="auto">The command which is to be executed when a change is triggered. Since, watchman
can watch multiple files, there are a few file placeholders available which will
be filled in appropriately at execution time. To use a placeholder just write it
in braces in your command.  Eg: {dir_name}/{base_prefix}.out</p>
<h2 dir="auto"><a id="user-content-placeholders" aria-hidden="true" href="#placeholders"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>PLACEHOLDERS</h2>
<p dir="auto">The following placeholders are available to be used in a command.</p>
<p dir="auto"><strong>file</strong></p>
<p dir="auto"><strong>base_name</strong></p>
<p dir="auto"><strong>dir_name</strong></p>
<p dir="auto"><strong>base_prefix</strong></p>
<h2 dir="auto"><a id="user-content-watching-single-files" aria-hidden="true" href="#watching-single-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>WATCHING SINGLE FILES</h2>
<p dir="auto">In case you only have a single file as watch target, the delimter &#39;--&#39; can be
skipped.</p>
<h2 dir="auto"><a id="user-content-install" aria-hidden="true" href="#install"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>INSTALL</h2>
<ul dir="auto">
<li>
<p dir="auto">Checkout <code>cd</code> to the the source code.</p>
</li>
<li>
<p dir="auto">To install, run <code>make install</code>.</p>
</li>
<li>
<p dir="auto">To uninstall, run <code>make uninstall</code>.</p>
</li>
<li>
<p dir="auto">If you are modifying watchman and want those changes to reflect automatically
on next execution, then run: <code>make develop</code>. This just symlinks the script to
the project directory.</p>
</li>
<li>
<p dir="auto">Available parameters:</p>
<ul dir="auto">
<li><strong>PREFIX</strong>: Location of installation. (default: <code>/usr/local/bin</code>)</li>
<li><strong>EXECUTABLE</strong>: Name of the executable file. (default: <code>watchman</code>)</li>
</ul>
</li>
</ul>
<h2 dir="auto"><a id="user-content-examples" aria-hidden="true" href="#examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>EXAMPLES</h2>
<ul dir="auto">
<li>
<p dir="auto">Watch a shell script and execute it on change.</p>
<div data-snippet-clipboard-copy-content=" watchman sample.sh ./sample.sh"><pre><code> watchman sample.sh ./sample.sh
</code></pre></div>
</li>
<li>
<p dir="auto">Watch on the Haskell project under the current directory recursively and run
<code>Main.hs</code> when anything is changed in it.</p>
<div data-snippet-clipboard-copy-content=" watchman -r . -- runhaskell Main.hs"><pre><code> watchman -r . -- runhaskell Main.hs
</code></pre></div>
</li>
<li>
<p dir="auto">Watch on a few Python scripts and execute a script which it changes. This
uses the placeholder {file} to fill in the correct name. Give more verbose
output since multiple files are being watched.</p>
<div data-snippet-clipboard-copy-content=" watchman -v scripts/**/*.py -- python {file}"><pre><code> watchman -v scripts/**/*.py -- python {file}
</code></pre></div>
</li>
<li>
<p dir="auto">Automatically build and execute a C file on change. This demonstrates the use
of <code>dir_name</code> and <code>base_prefix</code> placeholders.</p>
<div data-snippet-clipboard-copy-content=" watchman -vrb -x &#39;.*.out&#39; . -- &#39;gcc {file} -o {dir_name}/{base_prefix}.out &amp;&amp; {dir_name}/{base_prefix}.out&#39;"><pre><code> watchman -vrb -x &#39;.*.out&#39; . -- &#39;gcc {file} -o {dir_name}/{base_prefix}.out &amp;&amp; {dir_name}/{base_prefix}.out&#39;
</code></pre></div>
</li>
</ul>
<h2 dir="auto"><a id="user-content-why-this-project" aria-hidden="true" href="#why-this-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>WHY THIS PROJECT?</h2>
<ul dir="auto">
<li>I badly needed a utility like this.</li>
<li>I wanted to get my hands dirty with a proper bash based project and
Makefiles.</li>
</ul>
<h2 dir="auto"><a id="user-content-todo" aria-hidden="true" href="#todo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TODO</h2>
<ul dir="auto">
<li>Support for long running processes. Eg. Reboot a web server. This will be
useful in cases where corresponding server tool does not provide an option to
auto-reload.</li>
<li>Cycle through output colors in subsequent runs.</li>
<li>Real MAN pages, instead of MAN like README doc.</li>
</ul>
</article>
          </div></div>
  </body>
</html>
