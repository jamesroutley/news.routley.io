<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.tryparity.com/blog/how-meta-uses-llms-to-improve-incident-response">Original</a>
    <h1>Meta Uses LLMs to Improve Incident Response</h1>
    
    <div id="readability-page-1" class="page"><div data-framer-name="Content" data-framer-component-type="RichTextContainer"><p>In June, Meta released an article titled <!--$--><a href="https://engineering.fb.com/2024/06/24/data-infrastructure/leveraging-ai-for-efficient-incident-response/" rel="noopener">Leveraging AI for efficient incident response</a><!--/$--> on their engineering blog. In this article, engineers outline how they leveraged large language models to improve Meta&#39;s incident response capabilities. The headline metric from this report: <strong>Meta was able to use LLMs to successfully root cause incidents with 42% accuracy</strong> in their web monorepo. This means that nearly half the time, the <strong>mean time to resolution (MTTR) can potentially be reduced from hours to seconds</strong>. Seeing one of the largest and most complex engineering organizations in the world use generative AI for incident response so successfully gives us hope that we can bring the same benefit to all engineering teams with <!--$--><a href="https://tryparity.com/" rel="noopener">Parity</a><!--/$-->. Let&#39;s dive into how Meta accomplished these results and what we can learn from it.</p><h2>Meta&#39;s Incident Management at Scale</h2><p>It can be hard to appreciate the scale and velocity of code changes at a company the size of Meta. They are shipping thousands of changes per day almost entirely within a <!--$--><a href="https://blog.3d-logic.com/2024/09/02/what-it-is-like-to-work-in-metas-facebooks-monorepo/" rel="noopener">single monorepo</a><!--/$-->. Meta literally <!--$--><a href="https://graphite.dev/blog/why-facebook-doesnt-use-git" rel="noopener">re-engineered Mercurial</a><!--/$--> to keep up with the speed at which their codebase was growing (really fun read and nugget of open source history). At this scale, investigating outages becomes a massive undertaking. &#34;Hey did anyone ship anything recently&#34; in #engineering probably doesn&#39;t cut it as a response process.</p><p>Meta has invested in sophisticated incident response tools to make the life of on-call engineers easier. All of that tooling is built to solve the same problem any engineer at any organization aims to solve: <strong>what&#39;s going wrong, why is it going wrong, and how do we fix it</strong>. Generative AI has clear potential to improve MTTR and incident management processes across the board, and Meta charts one of the potential paths to doing so.</p><h2>Meta&#39;s Approach to LLMs for Incident Response</h2><p>Meta&#39;s approach to LLMs for incident response enhances the speed and accuracy of RCA by surfacing likely root causes to engineers at the start of their investigation. To handle the complexity of investigating issues within their massive monolithic codebase, they first use heuristic-based retrieval methods to select a subset of code changes and then use LLM-based ranking to narrow in. The retrieval phase reduces the overwhelming number of potential changes by using heuristics like code ownership, directory structures, and runtime code graphs. Once the search space is narrowed down, only the most relevant changes are passed along for deeper analysis by LLMs.</p><p><img alt="How Meta scopes down code changes with heuristics and LLMs" data-framer-asset="data:framer/asset-reference,NZp9ysyAbkYwFzYyzMEyCwlCmc.png" data-framer-height="682" data-framer-width="1536" height="341" src="https://framerusercontent.com/images/NZp9ysyAbkYwFzYyzMEyCwlCmc.png" srcset="https://framerusercontent.com/images/NZp9ysyAbkYwFzYyzMEyCwlCmc.png?scale-down-to=512 512w,https://framerusercontent.com/images/NZp9ysyAbkYwFzYyzMEyCwlCmc.png?scale-down-to=1024 1024w,https://framerusercontent.com/images/NZp9ysyAbkYwFzYyzMEyCwlCmc.png 1536w" width="768" data-framer-original-sizes="" sizes="(min-width: 1200px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p><em>How Meta scopes down code changes with heuristics and LLMs</em></p><p>The tool fits right into Metaâ€™s existing incident management processes. Engineers investigate issues just as they normally would, but now, the AI results are surfaced at the start of an investigation, automatically pulling in and ranking the most likely causes of the issue in real time. This means they can quickly focus on the most relevant code changes without spending time digging through thousands of possibilities. Instead of replacing the engineers&#39; expertise, the AI acts as a helpful assistant, focusing them in on the most likely causes of the issue sooner.</p><h2>Fine Tuning Llama 2 7B to Identify Culprit Code Changes</h2><p>One of the particularly interesting innovations behind Meta&#39;s AI incident response is the use of a fine-tuned Llama 2 7B model. The model was tuned specifically for root cause analysis by training it on historical incident investigations, which allowed it to learn from past scenarios where the underlying cause was already known. They used a two-phase approach for fine-tuning: starting with continued pre-training (CPT) and followed by a supervised fine-tuning (SFT) phase. During CPT, the model was exposed to internal Meta artifacts such as wikis, code repositories, and Q&amp;A documents, giving it a contextual foundation. In the SFT phase, Meta mixed the original training data of Llama 2 with its own root cause analysis dataset, which focused on instruction-tuning examples, enabling the model to follow RCA-related prompts effectively.</p><p><img alt="The fine-tuning process used for Llama 2 7B" data-framer-asset="data:framer/asset-reference,PXBwLHWp7U7VsAwRG3rVAdjcwOQ.png" data-framer-height="407" data-framer-width="896" height="203" src="https://framerusercontent.com/images/PXBwLHWp7U7VsAwRG3rVAdjcwOQ.png" srcset="https://framerusercontent.com/images/PXBwLHWp7U7VsAwRG3rVAdjcwOQ.png?scale-down-to=512 512w,https://framerusercontent.com/images/PXBwLHWp7U7VsAwRG3rVAdjcwOQ.png 896w" width="448" data-framer-original-sizes="" sizes="(min-width: 1200px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p><em>The fine-tuning process used for Llama 2 7B</em></p><p>The fine-tuning dataset was constructed with the constraints of a real-world investigation in mind. Each example involved 2 to 20 potential code changes, with minimal information known at the time of investigation initiation. By training the model this way, Meta equipped it to handle scenarios where data is scarce, making it more applicable to actual investigations. The fine-tuning process enabled the model to generate ranked lists of potential causes, ordered by relevance. The ranking system is built around log probabilities, where the model evaluates how likely each change is to be the root cause based on historical patterns. This fine-tuning process, combined with the aggregation of new datasets, allows Meta&#39;s LLM to significantly improve the accuracy of its root cause predictions, achieving a 42% success rate in identifying the culprit code changes during investigations.</p><h2>LLM Agents for Incident Response Are Next (Probably)</h2><p>Meta&#39;s use of additional pre-training and fine-tuning on internal documentation and RCA datasets point to another avenue worth exploring: LLM agents for incident response. Agents can actively gather additional relevant context from a larger number of data sources to improve their results. They can also begin to handle more of the incident response process and workflow (find and follow runbooks, measure impact, take mitigation steps, create code changes, write initial post-mortems). Agents are a natural next step, and I&#39;d be surprised if the team isn&#39;t already exploring it.</p><h2>42% Accuracy: Good or Bad?</h2><p>The biggest question I had when I read the Meta article was how should I interpret the 42% accuracy result? On the surface, this feels like a disappointing result. While there&#39;s no great benchmark for human performance, it still seems quite far from what an engineer could achieve. But when you consider that nearly half the time that an investigation began, an engineer had the root cause handed directly to them, it&#39;s an incredible result. As long as the engineer has the context and information to quickly rule out incorrect results, this would likely lead to massive improvements in MTTR. It&#39;s also an impressive result for the scale of changes that are being shipped at Meta. At a smaller organization, it&#39;s likely that finding culprit commits is a much easier task.</p><h2>Making AI Accessible to All Engineering Teams</h2><p>The way Meta has integrated AI into their incident response process offers a blueprint for other organizations. By using LLMs to prioritize probable root causes, teams can drastically cut down on investigation time, allowing engineers to jump straight into remediation. AI can help by parsing through logs, tracking recent code changes, and correlating potential issues across different environments. Starting with the investigation</p><h2>How Parity Can Bring AI to Your Team&#39;s Incident Response</h2><p>Meta is one of the best-resourced engineering teams in the world, and most teams simply don&#39;t have armies of researchers with the resources to fine-tune models and experiment with AI technologies. So how does the average team benefit from these insights from Meta? Surely if LLMs can help root cause incidents in one of the most complex infra stacks in the world nearly half the time, they should be helpful for every other engineering organization, right?</p><p>That&#39;s exactly our goal at Parity. We&#39;ve built the world&#39;s first AI SRE for incident response to bring these benefits to teams everywhere. We use LLM agents to investigate and root cause issues the same way an engineer would. When an alert from PagerDuty or DataDog triggers, Parity&#39;s agent begins to investigate the issue, gather context, and presents its findings to the engineer. This means before an on-call engineer has even opened their laptop, Parity has already done an investigation and engineers can move to remediation faster. We&#39;re personally pretty excited about Parity&#39;s performance, and the fact that Meta is built a similar tool gives us a lot of confidence that other teams can benefit from these solutions!</p><h2>The Future of Incident Response and AI</h2><p>The exploration of AI&#39;s role in incident response is just getting started, and the potential is clear. Humans aren&#39;t great at incident response, and we all hate waking up at 2am to resolve an issue. It&#39;s not hard to imagine we&#39;ll soon be at super-human performance in this problem space. Underlying improvements in model reasoning ability seem well suited to improving performance in the incident response space (we&#39;re particularly excited by the potential of <!--$--><a href="https://openai.com/index/introducing-openai-o1-preview/" rel="noopener">OpenAI&#39;s o1</a><!--/$-->). And we believe agents will play an important role in moving accuracy even higher. A world where engineers no longer have to deal with alerts and can get back to building isn&#39;t too far away.</p><p>There is also massive potential in adjacent areas like cybersecurity incidents. It&#39;s not too hard to imagine that LLMs will be used to respond to cyber threats or by security analysts to explore new attack vectors and prevent potential threats (check out our friends from YC over at <!--$--><a href="https://asterisk.so/" rel="noopener">Asterisk</a><!--/$--> who are working in this space!)</p><p><em>Note: I would like to acknowledge the great work by the team at Meta that worked on this, and I highly recommend reading the original article from Meta Engineering!</em></p></div></div>
  </body>
</html>
