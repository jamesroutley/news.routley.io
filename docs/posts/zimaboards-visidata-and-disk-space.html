<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://george.mand.is/2024/02/zimaboards-visidata-and-disk-space/">Original</a>
    <h1>ZimaBoards, VisiData and disk space</h1>
    
    <div id="readability-page-1" class="page"><div><article><section><header><p><time datetime="2024-02-25">February 25th, 2024</time> • ~600 words • 2 minute read</p></header><p>A few months ago I bought a <a href="https://www.zimaboard.com/">ZimaBoard</a> to tinker around with. I&#39;d down-sized greatly moving to New York last year and pretty much none of my tiny computers made the cut. I was in the market for a headless little something or another to stick under my bed, shell into once in a while, host tiny projects on and run some opinionated backup scripts.</p><p>My internal jury is still out on <a href="https://casaos.io/">CasaOS</a>, but I don&#39;t think it&#39;s bad for someone that isn&#39;t particularly hard-core about his homelab setup. It&#39;s basically just a Docker image and moderate system-management tool from a web-based GUI. There&#39;s an easily-accessible &#34;app store&#34; for quickly installing images/apps you might want.</p><ul><li><p>If you have a link to the image on Docker Hub, it&#39;s pretty trivial to just fill out a form, specify the folders and ports you want things to map too and it&#39;ll automatically start any time you reboot the machine. I got <a href="https://etherpad.org/">Etherpad</a> up and running quickly and it&#39;s not specifically listed or supported in their store.</p></li><li><p>It&#39;s running Debian Linux under the hood on an x86 architecture with built-in SSD and decent-enough RM (8GB RAM on my model) all of which made it interesting to me. It was also about the same (maybe cheaper?) than a comparable Raspberry Pi.</p></li></ul><p>Somewhere along the way I lost a lot of disk space despite not installing that much. It came with 32GB of internal storage which struck me as <em>plenty</em> for someone who does not hoard a lot of media content. After a couple weeks though of installing and uninstalling numerous apps from their app store, I fill-up 29GB and could not figure out the who was hogging up the space. I removed all the apps and <em>still</em> didn&#39;t see it budge.</p><h2>Piping stuff into VisiData is fun</h2><p>So I decided to finally get to the bottom of things tonight. I logged into my machine remotely—thank you <a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/get-started/">Cloudflare</a>!—from the <a href="https://recurse.com">Recurse Center</a> and used one of my favorite techniques: just piping random stuff into <a href="https://www.visidata.org/">VisiData</a>.</p><p>I logged into the machine, changed to the root (<code>/</code>) folder and ran:</p><pre><code>du | vd
</code></pre><p><code>du</code> measures disk space used by folder/files recursively from the place you call it. The default output is just two columns:</p><ol><li>The space the object is occupying</li><li>The relative path to it from your current folder.</li></ol><p>Visidata is very smart and will interpret all kinds of columnar and tabular data. Seriously, read the docs and check out the <a href="https://www.visidata.org/docs/formats/">supported formats</a>.</p><p>Then press <code>Shift+#</code> to tell VisiData the first column contains <code>int</code> values and then <code>]</code> to sort things in descending order.</p><p>Ta-da! Now I can clearly see the culprits float to the top.</p><p>I&#39;m sure/know there&#39;s a way to do all of those in a single command with <code>du</code> piping it in to <code>sort</code> and other command-line chicanery, but I like this way better.</p><p>For those wondering about what was actually eating up all the disk space, it turns out these were the primarily culprit</p><ul><li><code>var/log</code></li><li><code>var/cache</code></li></ul><p>I gave them a cursory glance to decide if I cared about anything in there, and after deciding I didn&#39;t I nuked them which cleaned-up about 10GB (!!) of files very quickly. I&#39;m still not 100% certain how or why those got filled up so quickly, so I&#39;m going to keep my eye on them in the future.</p></section></article></div></div>
  </body>
</html>
