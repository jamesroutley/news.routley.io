<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://uwdata.github.io/arquero/">Original</a>
    <h1>Arquero ‚Äì data tables wrangling in JavaScript</h1>
    
    <div id="readability-page-1" class="page"><div>
      
      
      

      

<p><strong>Arquero</strong> is a JavaScript library for query processing and transformation of array-backed data tables. Following the <a href="https://en.wikipedia.org/wiki/Relational_algebra">relational algebra</a> and inspired by the design of <a href="https://dplyr.tidyverse.org/">dplyr</a>, Arquero provides a fluent API for manipulating column-oriented data frames. Arquero supports a range of data transformation tasks, including filter, sample, aggregation, window, join, and reshaping operations.</p>

<ul>
  <li>Fast: process data tables with million+ rows.</li>
  <li>Flexible: query over arrays, typed arrays, array-like objects, or <a href="https://arrow.apache.org/">Apache Arrow</a> columns.</li>
  <li>Full-Featured: perform a variety of wrangling and analysis tasks.</li>
  <li>Extensible: add new column types or functions, including aggregate &amp; window operations.</li>
  <li>Lightweight: small size, minimal dependencies.</li>
</ul>

<p>To get up and running, start with the <a href="https://observablehq.com/@uwdata/introducing-arquero">Introducing Arquero</a> tutorial, part of the <a href="https://observablehq.com/collection/@uwdata/arquero">Arquero notebook collection</a>.</p>

<p>Arquero is Spanish for ‚Äúarcher‚Äù: if datasets are <a href="https://arrow.apache.org/">arrows</a>, Arquero helps their aim stay true. üèπ Arquero also refers to a goalkeeper: safeguard your data from analytic ‚Äúown goals‚Äù! ü•Ö ‚úã ‚öΩ</p>

<h2 id="api-documentation">API Documentation</h2>

<ul>
  <li><a href="https://uwdata.github.io/arquero/api">Top-Level API</a> - All methods in the top-level Arquero namespace.</li>
  <li><a href="https://uwdata.github.io/arquero/api/table">Table</a> - Table access and output methods.</li>
  <li><a href="https://uwdata.github.io/arquero/api/verbs">Verbs</a> - Table transformation verbs.</li>
  <li><a href="https://uwdata.github.io/arquero/api/op">Op Functions</a> - All functions, including aggregate and window functions.</li>
  <li><a href="https://uwdata.github.io/arquero/api/expressions">Expressions</a> - Parsing and generation of table expressions.</li>
  <li><a href="https://uwdata.github.io/arquero/api/extensibility">Extensibility</a> - Extend Arquero with new expression functions or table verbs.</li>
</ul>

<h2 id="example">Example</h2>

<p>The core abstractions in Arquero are <em>data tables</em>, which model each column as an array of values, and <em>verbs</em> that transform data and return new tables. Verbs are table methods, allowing method chaining for multi-step transformations. Though each table is unique, many verbs reuse the underlying columns to limit duplication.</p>

<div><div><pre><code><span>import</span> <span>{</span> <span>all</span><span>,</span> <span>desc</span><span>,</span> <span>op</span><span>,</span> <span>table</span> <span>}</span> <span>from</span> <span>&#39;</span><span>arquero</span><span>&#39;</span><span>;</span>

<span>// Average hours of sunshine per month, from https://usclimatedata.com/.</span>
<span>const</span> <span>dt</span> <span>=</span> <span>table</span><span>({</span>
  <span>&#39;</span><span>Seattle</span><span>&#39;</span><span>:</span> <span>[</span><span>69</span><span>,</span> <span>108</span><span>,</span> <span>178</span><span>,</span> <span>207</span><span>,</span> <span>253</span><span>,</span> <span>268</span><span>,</span> <span>312</span><span>,</span> <span>281</span><span>,</span> <span>221</span><span>,</span> <span>142</span><span>,</span> <span>72</span><span>,</span> <span>52</span><span>],</span>
  <span>&#39;</span><span>Chicago</span><span>&#39;</span><span>:</span> <span>[</span><span>135</span><span>,</span> <span>136</span><span>,</span> <span>187</span><span>,</span> <span>215</span><span>,</span> <span>281</span><span>,</span> <span>311</span><span>,</span> <span>318</span><span>,</span> <span>283</span><span>,</span> <span>226</span><span>,</span> <span>193</span><span>,</span> <span>113</span><span>,</span> <span>106</span><span>],</span>
  <span>&#39;</span><span>San Francisco</span><span>&#39;</span><span>:</span> <span>[</span><span>165</span><span>,</span> <span>182</span><span>,</span> <span>251</span><span>,</span> <span>281</span><span>,</span> <span>314</span><span>,</span> <span>330</span><span>,</span> <span>300</span><span>,</span> <span>272</span><span>,</span> <span>267</span><span>,</span> <span>243</span><span>,</span> <span>189</span><span>,</span> <span>156</span><span>]</span>
<span>});</span>

<span>// Sorted differences between Seattle and Chicago.</span>
<span>// Table expressions use arrow function syntax.</span>
<span>dt</span><span>.</span><span>derive</span><span>({</span>
    <span>month</span><span>:</span> <span>d</span> <span>=&gt;</span> <span>op</span><span>.</span><span>row_number</span><span>(),</span>
    <span>diff</span><span>:</span>  <span>d</span> <span>=&gt;</span> <span>d</span><span>.</span><span>Seattle</span> <span>-</span> <span>d</span><span>.</span><span>Chicago</span>
  <span>})</span>
  <span>.</span><span>select</span><span>(</span><span>&#39;</span><span>month</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>diff</span><span>&#39;</span><span>)</span>
  <span>.</span><span>orderby</span><span>(</span><span>desc</span><span>(</span><span>&#39;</span><span>diff</span><span>&#39;</span><span>))</span>
  <span>.</span><span>print</span><span>();</span>

<span>// Is Seattle more correlated with San Francisco or Chicago?</span>
<span>// Operations accept column name strings outside a function context.</span>
<span>dt</span><span>.</span><span>rollup</span><span>({</span>
    <span>corr_sf</span><span>:</span>  <span>op</span><span>.</span><span>corr</span><span>(</span><span>&#39;</span><span>Seattle</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>San Francisco</span><span>&#39;</span><span>),</span>
    <span>corr_chi</span><span>:</span> <span>op</span><span>.</span><span>corr</span><span>(</span><span>&#39;</span><span>Seattle</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>Chicago</span><span>&#39;</span><span>)</span>
  <span>})</span>
  <span>.</span><span>print</span><span>();</span>

<span>// Aggregate statistics per city, as output objects.</span>
<span>// Reshape (fold) the data to a two column layout: city, sun.</span>
<span>dt</span><span>.</span><span>fold</span><span>(</span><span>all</span><span>(),</span> <span>{</span> <span>as</span><span>:</span> <span>[</span><span>&#39;</span><span>city</span><span>&#39;</span><span>,</span> <span>&#39;</span><span>sun</span><span>&#39;</span><span>]</span> <span>})</span>
  <span>.</span><span>groupby</span><span>(</span><span>&#39;</span><span>city</span><span>&#39;</span><span>)</span>
  <span>.</span><span>rollup</span><span>({</span>
    <span>min</span><span>:</span>  <span>d</span> <span>=&gt;</span> <span>op</span><span>.</span><span>min</span><span>(</span><span>d</span><span>.</span><span>sun</span><span>),</span> <span>// functional form of op.min(&#39;sun&#39;)</span>
    <span>max</span><span>:</span>  <span>d</span> <span>=&gt;</span> <span>op</span><span>.</span><span>max</span><span>(</span><span>d</span><span>.</span><span>sun</span><span>),</span>
    <span>avg</span><span>:</span>  <span>d</span> <span>=&gt;</span> <span>op</span><span>.</span><span>average</span><span>(</span><span>d</span><span>.</span><span>sun</span><span>),</span>
    <span>med</span><span>:</span>  <span>d</span> <span>=&gt;</span> <span>op</span><span>.</span><span>median</span><span>(</span><span>d</span><span>.</span><span>sun</span><span>),</span>
    <span>// functional forms permit flexible table expressions</span>
    <span>skew</span><span>:</span> <span>({</span><span>sun</span><span>:</span> <span>s</span><span>})</span> <span>=&gt;</span> <span>(</span><span>op</span><span>.</span><span>mean</span><span>(</span><span>s</span><span>)</span> <span>-</span> <span>op</span><span>.</span><span>median</span><span>(</span><span>s</span><span>))</span> <span>/</span> <span>op</span><span>.</span><span>stdev</span><span>(</span><span>s</span><span>)</span> <span>||</span> <span>0</span>
  <span>})</span>
  <span>.</span><span>objects</span><span>()</span>
</code></pre></div></div>

<h2 id="usage">Usage</h2>

<h3 id="in-browser">In Browser</h3>

<p>To use in the browser, you can load Arquero from a content delivery network:</p>

<div><div><pre><code><span>&lt;script </span><span>src=</span><span>&#34;https://cdn.jsdelivr.net/npm/arquero@latest&#34;</span><span>&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>Arquero will be imported into the <code>aq</code> global object. The default browser bundle does not include the <a href="https://arrow.apache.org/">Apache Arrow</a> library. To perform Arrow encoding using <a href="https://uwdata.github.io/arquero/api/#toArrow">toArrow()</a> or binary file loading using <a href="https://uwdata.github.io/arquero/api/#loadArrow">loadArrow()</a>, import Apache Arrow first:</p>

<div><div><pre><code><span>&lt;script </span><span>src=</span><span>&#34;https://cdn.jsdelivr.net/npm/apache-arrow@latest&#34;</span><span>&gt;&lt;/script&gt;</span>
<span>&lt;script </span><span>src=</span><span>&#34;https://cdn.jsdelivr.net/npm/arquero@latest&#34;</span><span>&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>Alternatively, you can build and import <code>arquero.min.js</code> from the <code>dist</code> directory, or build your own application bundle. When building custom application bundles for the browser, the module bundler should draw from the <code>browser</code> property of Arquero‚Äôs <code>package.json</code> file. For example, if using <a href="https://rollupjs.org/">rollup</a>, pass the <code>browser: true</code> option to the <a href="https://github.com/rollup/plugins/tree/master/packages/node-resolve">node-resolve</a> plugin.</p>

<p>Arquero uses modern JavaScript features, and so will not work with some outdated browsers. To use Arquero with older browsers including Internet Explorer, set up your project with a transpiler such as <a href="https://babeljs.io/">Babel</a>.</p>

<h3 id="in-nodejs-or-application-bundles">In Node.js or Application Bundles</h3>

<p>First install <code>arquero</code> as a dependency, via <code>npm install arquero --save</code> or <code>yarn add arquero</code>. Arquero assumes Node version 12 or higher.</p>

<p>Import using CommonJS module syntax:</p>

<div><div><pre><code><span>const</span> <span>aq</span> <span>=</span> <span>require</span><span>(</span><span>&#39;</span><span>arquero</span><span>&#39;</span><span>);</span>
</code></pre></div></div>

<p>Import using ES module syntax, import all exports into a single object:</p>

<div><div><pre><code><span>import</span> <span>*</span> <span>as</span> <span>aq</span> <span>from</span> <span>&#39;</span><span>arquero</span><span>&#39;</span><span>;</span>
</code></pre></div></div>

<p>Import using ES module syntax, with targeted imports:</p>

<div><div><pre><code><span>import</span> <span>{</span> <span>op</span><span>,</span> <span>table</span> <span>}</span> <span>from</span> <span>&#39;</span><span>arquero</span><span>&#39;</span><span>;</span>
</code></pre></div></div>

<h2 id="build-instructions">Build Instructions</h2>

<p>To build and develop Arquero locally:</p>

<ul>
  <li>Clone <a href="https://github.com/uwdata/arquero">https://github.com/uwdata/arquero</a>.</li>
  <li>Run <code>yarn</code> to install dependencies for all packages. If you don‚Äôt have yarn installed, see <a href="https://yarnpkg.com/en/docs/install">https://yarnpkg.com/en/docs/install</a>.</li>
  <li>Run <code>yarn test</code> to run test cases, <code>yarn perf</code> to run performance benchmarks, and <code>yarn build</code> to build output files.</li>
</ul>


      
      
      
    </div></div>
  </body>
</html>
