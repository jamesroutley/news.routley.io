<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://magazine.sebastianraschka.com/p/understanding-large-language-models">Original</a>
    <h1>Understanding large language models: A cross-section of the relevant literature</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><div class=""><div><div dir="auto"><p><strong>Note:</strong><span> Next to the monthly Ahead of AI series that discusses the latest research and trends, I plan to post some additional articles related to machine learning and AI once in a while. I am curious to hear what you think — do you like this idea, or should I stick to the main newsletter series? Please let me know in the comments!</span></p><p>Large language models have taken the public attention by storm – no pun intended. In just half a decade large language models – transformers – have almost completely changed the field of natural language processing. Moreover, they have also begun to revolutionize fields such as computer vision and computational biology.</p><p><span>Since transformers have such a big impact on everyone’s research agenda, I wanted to flesh out a short reading list (an extended version of </span><a href="https://www.linkedin.com/feed/update/urn:li:activity:7028449312300834816?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7028449312300834816%2C7028519126105030656%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287028519126105030656%2Curn%3Ali%3Aactivity%3A7028449312300834816%29" rel="">my comment yesterday</a><span>) for machine learning researchers and practitioners getting started.</span></p><p>The following list below is meant to be read mostly chronologically, and I am entirely focusing on academic research papers. Of course, there are many additional resources out there that are useful. For example,</p><ul><li><p><span>the </span><a href="http://jalammar.github.io/illustrated-transformer/" rel="">Illustrated Transformer</a><span> by Jay Alammar;</span></p></li><li><p><span>a </span><a href="https://lilianweng.github.io/posts/2020-04-07-the-transformer-family/" rel="">more technical blog article</a><span> by Lilian Weng;</span></p></li><li><p><a href="https://amatriain.net/blog/transformer-models-an-introduction-and-catalog-2d1e9039f376/" rel="">a catalog and family tree</a><span> of all major transformers to date by Xavier Amatriain;</span></p></li><li><p><a href="https://github.com/karpathy/nanoGPT" rel="">a minimal code implementation</a><span> of a generative language model for educational purposes by Andrej Karpathy;</span></p></li><li><p><a href="https://sebastianraschka.com/blog/2021/dl-course.html#l19-self-attention-and-transformer-networks" rel="">a lecture series</a><span> and </span><a href="https://github.com/rasbt/machine-learning-book/tree/main/ch16" rel="">book chapter</a><span> by yours truly.</span></p></li></ul><p>If you are new to transformers / large language models, it makes the most sense to start at the beginning.</p><p><strong>(1)</strong><span> </span><em>Neural Machine Translation by Jointly Learning to Align and Translate</em><span> (2014) by Bahdanau, Cho, and Bengio, </span><a href="https://arxiv.org/abs/1409.0473" rel="">https://arxiv.org/abs/1409.0473</a></p><p>I recommend beginning with the above paper if you have a few minutes to spare. It introduces an attention mechanism for recurrent neural networks (RNN) to improve long-range sequence modeling capabilities. This allows RNNs to translate longer sentences more accurately – the motivation behind developing the original transformer architecture later.</p><p><strong>(2)</strong><span> </span><em>Attention Is All You Need</em><span> (2017) by Vaswani, Shazeer, Parmar, Uszkoreit, Jones, Gomez, Kaiser, and Polosukhin, </span><a href="https://arxiv.org/abs/1706.03762" rel="">https://arxiv.org/abs/1706.03762</a></p><p>The paper above introduces the original transformer architecture consisting of an encoder- and decoder part that will become relevant as separate modules later. Moreover, this paper introduces concepts such as the scaled dot product attention mechanism, multi-head attention blocks, and positional input encoding that remain the foundation of modern transformers.</p><p><strong>(3)</strong><span> </span><em>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</em><span> (2018) by Devlin, Chang, Lee, and Toutanova, </span><a href="https://arxiv.org/abs/1810.04805" rel="">https://arxiv.org/abs/1810.04805</a></p><p>Following the original transformer architecture, large language model research started to bifurcate in two directions: encoder-style transformers for predictive modeling tasks such as text classification and decoder-style transformers for generative modeling tasks such as translation, summarization, and other forms of text creation.</p><p><span>The BERT paper above introduces the original concept of masked-language modeling, and next-sentence prediction remains an influential decoder-style architecture. If you are interested in this research branch, I recommend following up with </span><a href="https://arxiv.org/abs/1907.11692" rel="">RoBERTa</a><span>, which simplified the pretraining objectives by removing the next-sentence prediction tasks.</span></p><p><strong>(4)</strong><span> </span><em>Improving Language Understanding by Generative Pre-Training</em><span> (2018) by Radford and Narasimhan, </span><a href="https://www.semanticscholar.org/paper/Improving-Language-Understanding-by-Generative-Radford-Narasimhan/cd18800a0fe0b668a1cc19f2ec95b5003d0a5035" rel="">https://www.semanticscholar.org/paper/Improving-Language-Understanding-by-Generative-Radford-Narasimhan/cd18800a0fe0b668a1cc19f2ec95b5003d0a5035</a></p><p>The original GPT paper introduced the popular decoder-style architecture and pretraining via next-word prediction. Where BERT can be considered a bidirectional transformer due to its masked language model pretraining objective, GPT is a unidirectional, autoregressive model. While GPT embeddings can also be used for classification, the GPT approach is at the core of today’s most influential LLMs, such as chatGPT.</p><p><span>If you are interested in this research branch, I recommend following up with the </span><a href="https://www.semanticscholar.org/paper/Language-Models-are-Unsupervised-Multitask-Learners-Radford-Wu/9405cc0d6169988371b2755e573cc28650d14dfe" rel="">GPT-2</a><span> and </span><a href="https://arxiv.org/abs/2005.14165" rel="">GPT-3</a><span>papers. These two papers illustrate that LLMs are capable of zero- and few-shot learning and highlight the emergent abilities of LLMs. GPT-3 is also still a popular baseline and base model for training current-generation LLMs such as ChatGPT – we will cover the InstructGPT approach that lead to ChatGPT later as a separate entry.</span></p><p><strong>(5)</strong><span> </span><em>BART: Denoising Sequence-to-Sequence Pre-training for Natural Language Generation, Translation, and Comprehension</em><span> (2019), by Lewis, Liu, Goyal, Ghazvininejad, Mohamed, Levy, Stoyanov, and Zettlemoyer, </span><a href="https://arxiv.org/abs/1910.13461" rel="">https://arxiv.org/abs/1910.13461</a><span>.</span></p><p>As mentioned earlier, BERT-type encoder-style LLMs are usually preferred for predictive modeling tasks, whereas GPT-type decoder-style LLMs are better at generating texts. To get the best of both worlds, the BART paper above combines both the encoder and decoder parts (not unlike the original transformer – the second paper in this list).</p><p><span>If you want to learn more about the various techniques to improve the efficiency of transformers, I recommend the </span><a href="https://arxiv.org/abs/2009.06732" rel="">2020 </a><em><a href="https://arxiv.org/abs/2009.06732" rel="">Efficient Transformers: A Survey</a></em><span> paper followed by the </span><a href="https://arxiv.org/abs/2302.01107" rel="">2023 </a><em><a href="https://arxiv.org/abs/2302.01107" rel="">A Survey on Efficient Training of Transformers</a></em><span> paper.</span></p><p>In addition, below are papers that I found particularly interesting and worth reading.</p><p><strong>(6)</strong><span> </span><em>FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness</em><span> (2022), by Dao, Fu, Ermon, Rudra, and Ré, </span><a href="https://arxiv.org/abs/2205.14135" rel="">https://arxiv.org/abs/2205.14135</a><span>.</span></p><p>While most transformer papers don’t bother about replacing the original scaled dot product mechanism for implementing self-attention, FlashAttention is one mechanism I have seen most often referenced lately.</p><p><strong>(7)</strong><span> </span><em>Cramming: Training a Language Model on a Single GPU in One Day (2022) by Geiping and Goldstein</em><span>, </span><a href="https://arxiv.org/abs/2212.14034" rel="">https://arxiv.org/abs/2212.14034</a><span>.</span></p><p>In this paper, the researchers trained a masked language model / encoder-style LLM (here: BERT) for 24h on a single GPU. For comparison, the original 2018 BERT paper trained it on 16 TPUs for four days. An interesting insight is that while smaller models have higher throughput, smaller models also learn less efficiently. Thus, larger models do not require more training time to reach a specific predictive performance threshold.</p><p><strong>(8)</strong><span> </span><em>Scaling Down to Scale Up: A Guide to Parameter-Efficient Fine-Tuning (2022)</em><span> by Lialin, Desphande, and Rumshisky, </span><a href="https://arxiv.org/abs/2303.15647" rel="">https://arxiv.org/abs/2303.15647</a><span>.</span></p><p>Modern large language models that are pretrained on large datasets show emergent abilities and perform well on various tasks, including language translation, summarization, coding, and Q&amp;A. However, if we want to improve the ability of transformers on domain-specific data and specialized tasks, it’s worthwhile to finetune transformers. This survey reviews more than 40 papers on parameter-efficient finetuning methods (including popular techniques such as prefix tuning, adapters, and low-rank adaptation) to make finetuning (very) computationally efficient.</p><p><strong>(9)</strong><span> </span><em>Training Compute-Optimal Large Language Models</em><span> (2022) by Hoffmann, Borgeaud, Mensch, Buchatskaya, Cai, Rutherford, de Las Casas, Hendricks, Welbl, Clark, Hennigan, Noland, Millican, van den Driessche, Damoc, Guy, Osindero, Simonyan, Elsen, Rae, Vinyals, and Sifre, </span><a href="https://arxiv.org/abs/2203.15556" rel="">https://arxiv.org/abs/2203.15556</a><span>.</span></p><p>This paper introduces the 70-billion parameter Chinchilla model that outperforms the popular 175-billion parameter GPT-3 model on generative modeling tasks. However, its main punchline is that contemporary large language models are “significantly undertrained.”</p><p>The paper defines the linear scaling law for large language model training. For example, while Chinchilla is only half the size of GPT-3, it outperformed GPT-3 because it was trained on 1.4 trillion (instead of just 300 billion) tokens. In other words, the number of training tokens is as vital as the model size.</p><p>In recent years, we have seen many relatively capable large language models that can generate realistic texts (for example, GPT-3 and Chinchilla, among others). It seems that we have reached a ceiling in terms of what we can achieve with the commonly used pretraining paradigms.</p><p>To make language models more helpful and reduce misinformation and harmful language, researchers designed additional training paradigms to fine-tune the pretrained base models.</p><p><strong>(10)</strong><span> </span><em>Training Language Models to Follow Instructions with Human Feedback</em><span> (2022) by Ouyang, Wu, Jiang, Almeida, Wainwright, Mishkin, Zhang, Agarwal, Slama, Ray, Schulman, Hilton, Kelton, Miller, Simens, Askell, Welinder, Christiano, Leike, and Lowe, </span><a href="https://arxiv.org/abs/2203.02155" rel="">https://arxiv.org/abs/2203.02155</a><span>.</span></p><p>In this so-called InstructGPT paper, the researchers use a reinforcement learning mechanism with humans in the loop (RLHF). They start with a pretrained GPT-3 base model and fine-tune it further using supervised learning on prompt-response pairs generated by humans (Step 1). Next, they ask humans to rank model outputs to train a reward model (step 2). Finally, they use the reward model to update the pretrained and fine-tuned GPT-3 model using reinforcement learning via proximal policy optimization (step 3).</p><p>As a sidenote, this paper is also known as the paper describing the idea behind ChatGPT – according to the recent rumors, ChatGPT is a scaled-up version of InstructGPT that has been fine-tuned on a larger dataset.</p><p><strong>(11)</strong><span> </span><em>Constitutional AI: Harmlessness from AI Feedback</em><span> (2022) by Yuntao, Saurav, Sandipan, Amanda, Jackson, Jones, Chen, Anna, Mirhoseini, McKinnon, Chen, Olsson, Olah, Hernandez, Drain, Ganguli, Li, Tran-Johnson, Perez, Kerr, Mueller, Ladish, Landau, Ndousse, Lukosuite, Lovitt, Sellitto, Elhage, Schiefer, Mercado, DasSarma, Lasenby, Larson, Ringer, Johnston, Kravec, El Showk, Fort, Lanham, Telleen-Lawton, Conerly, Henighan, Hume, Bowman, Hatfield-Dodds, Mann, Amodei, Joseph, McCandlish, Brown, Kaplan, </span><a href="https://arxiv.org/abs/2212.08073" rel="">https://arxiv.org/abs/2212.08073</a><span>.</span></p><p>In this paper, the researchers are taking the alignment idea one step further, proposing a training mechanism for creating a “harmless” AI system. Instead of direct human supervision, the researchers propose a self-training mechanism that is based on a list of rules (which are provided by a human). Similar to the InstructGPT paper mentioned above, the proposed method uses a reinforcement learning approach.</p><p>While RLHF (reinforcement learning with human feedback) may not completely solve the current issues with LLMs, it is currently considered the best option available, especially when compared to previous-generation LLMs. It is likely that we will see more creative ways to apply RLHF to LLMs other domains.</p><p>The two papers above, InstructGPT and Consitutinal AI, make use of RLHF, and since it is going to be an influential method in the near future, this section includes additional resources if you want to learn about RLHF. (To be technicallty correct, the Constitutional AI paper uses AI instead of human feedback, but it follows a similar concept using RL.)</p><p><strong>(12)</strong><span> </span><em>Asynchronous Methods for Deep Reinforcement Learning</em><span> (2016) by Mnih, Badia, Mirza, Graves, Lillicrap, Harley, Silver, and Kavukcuoglu (</span><a href="https://arxiv.org/abs/1602.01783" rel="">https://arxiv.org/abs/1602.01783</a><span>) introduces policy gradient methods as an alternative to Q-learning in deep learning-based RL.</span></p><p><strong>(13)</strong><span> </span><em>Proximal Policy Optimization Algorithms</em><span> (2017) by Schulman, Wolski, Dhariwal, Radford, Klimov (</span><a href="https://arxiv.org/abs/1707.06347" rel="">https://arxiv.org/abs/1707.06347</a><span>) presents a modified proximal policy-based reinforcement learning procedure that is more data-efficient and scalable than the vanilla policy optimization algorithm above.</span></p><p><strong>(14)</strong><span> </span><em>Fine-Tuning Language Models from Human Preferences</em><span> (2020) by Ziegler, Stiennon, Wu, Brown, Radford, Amodei, Christiano, Irving (</span><a href="https://arxiv.org/abs/1909.08593" rel="">https://arxiv.org/abs/1909.08593</a><span>) illustrates the concept of PPO and reward learning to pretrained language models including KL regularization to prevent the policy from diverging too far from natural language.</span></p><p><strong>(15)</strong><span> </span><em>Learning to Summarize from Human Feedback</em><span> (2022) by Stiennon, Ouyang, Wu, Ziegler, Lowe, Voss, Radford, Amodei, Christiano </span><a href="https://arxiv.org/abs/2009.01325" rel="">https://arxiv.org/abs/2009.01325</a><span> introduces the popular RLHF three-step procedure:</span></p><ol><li><p>pretraining GPT-3</p></li><li><p>fine-tuning it in a supervised fashion, and</p></li><li><p>training a reward model also in a supervised fashion. The fine-tuned model is then trained using this reward model with proximal policy optimization.</p></li></ol><p>This paper also shows that reinforcement learning with proximal policy optimization results in better models than just using regular supervised learning.</p><p><strong>(16)</strong><span> </span><em>Training Language Models to Follow Instructions with Human Feedback</em><span> (2022) by Ouyang, Wu, Jiang, Almeida, Wainwright, Mishkin, Zhang, Agarwal, Slama, Ray, Schulman, Hilton, Kelton, Miller, Simens, Askell, Welinder, Christiano, Leike, and Lowe (</span><a href="https://arxiv.org/abs/2203.02155" rel="">https://arxiv.org/abs/2203.02155</a><span>), also known as </span><em>InstructGPT paper</em><span>)uses a similar three-step procedure for RLHF as above, but instead of summarizing text, it focuses on generating text based on human instructions. Also, it uses a labeler to rank the outputs from best to worst (instead of just a binary comparison between human- and AI-generated texts).</span></p><p>I tried to keep the list above nice and concise, focusing on the top-10 papers (plus 3 bonus papers on RLHF) to understand the design, constraints, and evolution behind contemporary large language models.</p><p>For further reading, I suggest following the references in the papers mentioned above. Or, to give you some additional pointers, here are some additional resources:</p><p><strong>Open-source alternatives to GPT</strong></p><ul><li><p><em>BLOOM: A 176B-Parameter Open-Access Multilingual Language Model</em><span> (2022), </span><a href="https://arxiv.org/abs/2211.05100" rel="">https://arxiv.org/abs/2211.05100</a></p></li><li><p><em>OPT: Open Pre-trained Transformer Language Models</em><span> (2022), </span><a href="https://arxiv.org/abs/2205.01068" rel="">https://arxiv.org/abs/2205.01068</a></p></li></ul><p><strong>ChatGPT alternatives</strong></p><ul><li><p><em>LaMDA: Language Models for Dialog Applications</em><span> (2022), </span><a href="https://arxiv.org/abs/2201.08239" rel="">https://arxiv.org/abs/2201.08239</a></p></li><li><p><span>(Sparrow) </span><em>Improving Alignment of Dialogue Agents via Targeted Human Judgements</em><span> (2022), </span><a href="https://arxiv.org/abs/2209.14375" rel="">https://arxiv.org/abs/2209.14375</a></p></li><li><p><em>BlenderBot 3: A Deployed Conversational Agent that Continually Learns to Responsibly Rngage</em><span>, </span><a href="https://arxiv.org/abs/2208.03188" rel="">https://arxiv.org/abs/2208.03188</a></p></li></ul><p><strong>Large language models in computational biology</strong></p><ul><li><p><em>ProtTrans: Towards Cracking the Language of Life’s Code Through Self-Supervised Deep Learning and High Performance Computing</em><span> (2021), </span><a href="https://arxiv.org/abs/2007.06225" rel="">https://arxiv.org/abs/2007.06225</a></p></li><li><p><em>Highly Accurate Protein Structure Prediction with AlphaFold</em><span> (2021), </span><a href="https://www.nature.com/articles/s41586-021-03819-2" rel="">https://www.nature.com/articles/s41586-021-03819-2</a></p></li><li><p><em>Large Language Models Generate Functional Protein Sequences Across Diverse Families</em><span> (2023), </span><a href="https://www.nature.com/articles/s41587-022-01618-2" rel="">https://www.nature.com/articles/s41587-022-01618-2</a></p></li></ul><p><span>Are you interested in more AI-related news, musings, and educational material but don&#39;t want to wait until the next newsletter issue? You can follow my </span><a href="https://substack.com/profile/27393275-sebastian-raschka" rel="">Substack Notes</a><span> or check out </span><a href="https://sebastianraschka.com/books/" rel="">my books</a><span>.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png" width="245" height="162.93880837359097" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/d5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:826,&#34;width&#34;:1242,&#34;resizeWidth&#34;:245,&#34;bytes&#34;:982316,&#34;alt&#34;:&#34;&#34;,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5b3254c-9b09-43a9-a975-68d41e3f12ae_1242x826.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p><span>Thank you to those who have reached out asking how they can support Ahead of AI. While this newsletter is free and unabbreviated, there is a </span><a href="https://magazine.sebastianraschka.com/subscribe?utm_medium=web&amp;utm_source=magaziney-home-page" rel="">paid subscription option</a><span> on Substack for those who would like to support it.</span></p></div></div></div></article></div></div></div>
  </body>
</html>
