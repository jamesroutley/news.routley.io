<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/fish-shell/fish-shell/releases/tag/3.4.0">Original</a>
    <h1>Fish 3.4.0 Released</h1>
    
    <div id="readability-page-1" class="page"><div data-pjax="true" data-test-selector="body-content" data-view-component="true"><h3>Notable improvements and fixes</h3>
<ul>
<li>fish’s command substitution syntax has been extended: <code>$(cmd)</code> now has the same meaning as <code>(cmd)</code> but it can be used inside double quotes, to prevent line splitting of the results (<a href="https://github.com/fish-shell/fish-shell/issues/159" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/159/hovercard">#159</a>):</li>
</ul>
<div data-snippet-clipboard-copy-content="foo (bar | string collect)
# can now be written as
foo &#34;$(bar)&#34;

# and

foo (bar)
# can now be written as
foo $(bar)
# this will still split on newlines only."><pre>foo (bar <span>|</span> string collect)
<span><span>#</span> can now be written as</span>
foo <span><span>&#34;</span>$(bar)<span>&#34;</span></span>

<span><span>#</span> and</span>

foo (bar)
<span><span>#</span> can now be written as</span>
foo $(bar)
<span><span>#</span> this will still split on newlines only.</span></pre></div>
<ul>
<li>Complementing the <code>prompt</code> command in 3.3.0, <code>fish_config</code> gained a <code>theme</code> subcommand to show and pick from the sample themes (meaning color schemes) directly in the terminal, instead of having to open a Web browser. For example <code>fish_config theme choose Nord</code> loads the Nord theme in the current session (<a href="https://github.com/fish-shell/fish-shell/issues/8132" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8132/hovercard">#8132</a>). The current theme can be saved with <code>fish_config theme dump</code>, and custom themes can be added by saving them in <code>~/.config/fish/themes/</code>.</li>
<li><code>set</code> and <code>read</code> learned a new option, <code>--function</code>, to set a variable in the function’s top scope. This should be a more familiar way of scoping variables and avoids issues with <code>--local</code>, which is actually block-scoped (<a href="https://github.com/fish-shell/fish-shell/issues/565" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/565/hovercard">#565</a>, <a href="https://github.com/fish-shell/fish-shell/issues/8145" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8145/hovercard">#8145</a>):</li>
</ul>
<div data-snippet-clipboard-copy-content="function demonstration
    if true
        set --function foo bar
        set --local baz banana
    end
    echo $foo # prints &#34;bar&#34; because $foo is still valid
    echo $baz # prints nothing because $baz went out of scope
end"><pre><span>function</span> demonstration
    <span>if</span> <span>true</span>
        <span>set</span> <span>--function</span> foo bar
        <span>set</span> <span>--local</span> baz banana
    <span>end</span>
    <span>echo</span> <span>$foo</span> <span><span>#</span> prints &#34;bar&#34; because $foo is still valid</span>
    <span>echo</span> <span>$baz</span> <span><span>#</span> prints nothing because $baz went out of scope</span>
<span>end</span></pre></div>
<ul>
<li><code>string pad</code> now excludes escape sequences like colors that fish knows about, and a new <code>--visible</code> flag to <code>string length</code> makes it use that kind of visible width. This is useful to get the number of terminal cells an already colored string would occupy, like in a prompt. (<a href="https://github.com/fish-shell/fish-shell/issues/8182" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8182/hovercard">#8182</a>, <a href="https://github.com/fish-shell/fish-shell/issues/7784" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/7784/hovercard">#7784</a>, <a href="https://github.com/fish-shell/fish-shell/issues/4012" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/4012/hovercard">#4012</a>):</li>
</ul>
<div data-snippet-clipboard-copy-content="&gt; string length --visible (set_color red)foo
3"><pre><span>&gt;</span> string length <span>--visible</span> (set_color red)foo
3</pre></div>
<ul>
<li>Performance improvements to globbing, especially on systems using glibc. In some cases (large directories with files with many numbers in the names) this almost halves the time taken to expand the glob.</li>
<li>Autosuggestions can now be turned off by setting <code>$fish_autosuggestion_enabled</code> to 0, and (almost) all highlighting can be turned off by choosing the new “None” theme. The exception is necessary colors, like those which distinguish autosuggestions from the actual command line. (<a href="https://github.com/fish-shell/fish-shell/issues/8376" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8376/hovercard">#8376</a>)</li>
<li>The <code>fish_git_prompt</code> function, which is included in the default prompts, now overrides <code>git</code> to avoid running  commands set by per-repository configuration. This avoids a potential security issue in some circumstances, and has been assigned CVE-2022-20001 (<a href="https://github.com/fish-shell/fish-shell/issues/8589" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8589/hovercard">#8589</a>).</li>
</ul>
<h3>Deprecations and removed features</h3>
<ul>
<li>A new feature flag, <code>ampersand-nobg-in-token</code> makes <code>&amp;</code> only act as background operator if followed by a separator. In combination with <code>qmark-noglob</code>, this allows entering most URLs at the command line without quoting or escaping (<a href="https://github.com/fish-shell/fish-shell/issues/7991" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/7991/hovercard">#7991</a>). For example:</li>
</ul>
<div data-snippet-clipboard-copy-content="&gt; echo foo&amp;bar # will print &#34;foo&amp;bar&#34;, instead of running &#34;echo foo&#34; in the background and executing &#34;bar&#34;
&gt; echo foo &amp; bar # will still run &#34;echo foo&#34; in the background and then run &#34;bar&#34;
# with both ampersand-nobg-in-token and qmark-noglob, this argument has no special characters anymore
&gt; open https://www.youtube.com/watch?v=dQw4w9WgXcQ&amp;feature=youtu.be"><pre><span>&gt;</span> <span>echo</span> foo<span>&amp;</span>bar <span><span>#</span> will print &#34;foo&amp;bar&#34;, instead of running &#34;echo foo&#34; in the background and executing &#34;bar&#34;</span>
<span>&gt;</span> <span>echo</span> foo <span>&amp;</span> bar <span><span>#</span> will still run &#34;echo foo&#34; in the background and then run &#34;bar&#34;</span>
<span><span>#</span> with both ampersand-nobg-in-token and qmark-noglob, this argument has no special characters anymore</span>
<span>&gt;</span> <span>open</span> https://www.youtube.com/watch<span>?</span>v=dQw4w9WgXcQ<span>&amp;</span>feature=youtu.be</pre></div>
<p>As a reminder, feature flags can be set on startup with <code>fish --features ampersand-nobg-in-token,qmark-noglob</code> or with a universal variable called <code>fish_features</code>:</p>
<div data-snippet-clipboard-copy-content="&gt; set -Ua fish_features ampersand-nobg-in-token"><pre><span>&gt;</span> <span>set</span> <span>-Ua</span> fish_features ampersand-nobg-<span>in</span>-token</pre></div>
<ul>
<li><code>$status</code> is now forbidden as a command, to prevent a surprisingly common error among new users: Running <code>if $status</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8171" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8171/hovercard">#8171</a>). This applies <em>only</em> to <code>$status</code>, other variables are still allowed.</li>
<li><code>set --query</code> now returns an exit status of 255 if given no variable names. This means <code>if set -q $foo</code> will not enter the if-block if <code>$foo</code> is empty or unset. To restore the previous behavior, use <code>if not set -q foo; or set -q $foo</code> - but this is unlikely to be desireable (<a href="https://github.com/fish-shell/fish-shell/issues/8214" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8214/hovercard">#8214</a>).</li>
<li><code>_</code> is now a reserved keyword (<a href="https://github.com/fish-shell/fish-shell/issues/8342" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8342/hovercard">#8342</a>).</li>
<li>The special input functions <code>delete-or-exit</code>, <code>nextd-or-forward-word</code> and <code>prevd-or-backward-word</code> replace fish functions of the same names (<a href="https://github.com/fish-shell/fish-shell/issues/8538" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8538/hovercard">#8538</a>).</li>
<li>Mac OS X 10.9 is no longer supported. The minimum Mac version is now 10.10 “Yosemite.”</li>
</ul>
<h3>Scripting improvements</h3>
<ul>
<li><code>string collect</code> supports a new <code>--allow-empty</code> option, which will output one empty argument in a command substitution that has no output (<a href="https://github.com/fish-shell/fish-shell/issues/8054" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8054/hovercard">#8054</a>). This allows commands like <code>test -n (echo -n | string collect --allow-empty)</code> to work more reliably. Note this can also be written as <code>test -n &#34;$(echo -n)&#34;</code> (see above).</li>
<li><code>string match</code> gained a <code>--groups-only</code> option, which makes it only output capturing groups, excluding the full match. This allows <code>string match</code> to do simple transformations (<a href="https://github.com/fish-shell/fish-shell/issues/6056" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/6056/hovercard">#6056</a>):</li>
</ul>
<div data-snippet-clipboard-copy-content="&gt; string match -r --groups-only &#39;(.*)fish&#39; &#39;catfish&#39; &#39;twofish&#39; &#39;blue fish&#39; | string escape
cat
two
&#39;blue &#39;"><pre><span>&gt;</span> string match <span>-r</span> <span>--groups-only</span> <span><span>&#39;</span>(.*)fish<span>&#39;</span></span> <span><span>&#39;</span>catfish<span>&#39;</span></span> <span><span>&#39;</span>twofish<span>&#39;</span></span> <span><span>&#39;</span>blue fish<span>&#39;</span></span> <span>|</span> string escape
<span>cat</span>
two
<span><span>&#39;</span>blue <span>&#39;</span></span></pre></div>
<ul>
<li><code>$fish_user_paths</code> is now automatically deduplicated to fix a common user error of appending to it in config.fish when it is universal (<a href="https://github.com/fish-shell/fish-shell/issues/8117" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8117/hovercard">#8117</a>). <a href="https://github.com/fish-shell/fish-shell/blob/3.4.0/cmds/fish_add_path.md#cmd-fish-add-path">fish_add_path</a> remains the recommended way to add to $PATH.</li>
<li><code>return</code> can now be used outside functions. In scripts, it does the same thing as <code>exit</code>. In interactive mode,it sets <code>$status</code> without exiting (<a href="https://github.com/fish-shell/fish-shell/issues/8148" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8148/hovercard">#8148</a>).</li>
<li>An oversight prevented all syntax checks from running on commands given to <code>fish -c</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8171" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8171/hovercard">#8171</a>). This includes checks such as <code>exec</code> not being allowed in a pipeline, and <code>$$</code> not being a valid variable. Generally, another error was generated anyway.</li>
<li><code>fish_indent</code> now correctly reformats tokens that end with a backslash followed by a newline (<a href="https://github.com/fish-shell/fish-shell/issues/8197" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8197/hovercard">#8197</a>).</li>
<li><code>commandline</code> gained an <code>--is-valid</code> option to check if the command line is syntactically valid and complete. This allows basic implementation of transient prompts (<a href="https://github.com/fish-shell/fish-shell/issues/8142" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8142/hovercard">#8142</a>).</li>
<li><code>commandline</code> gained a <code>--paging-full-mode</code> option to check if the pager is showing all the possible lines (no “7 more rows” message) (<a href="https://github.com/fish-shell/fish-shell/issues/8485" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8485/hovercard">#8485</a>).</li>
<li>List expansion correctly reports an error when used with all zero indexes (<a href="https://github.com/fish-shell/fish-shell/issues/8213" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8213/hovercard">#8213</a>).</li>
<li>Running <code>fish</code> with a directory instead of a script as argument (eg <code>fish .</code>) no longer leads to an infinite loop. Instead it errors out immediately (<a href="https://github.com/fish-shell/fish-shell/issues/8258" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8258/hovercard">#8258</a>)</li>
<li>Some error messages occuring after fork, like “text file busy” have been replaced by bespoke error messages for fish (like “File is currently open for writing”). This also restores error messages with current glibc versions that removed sys_errlist (<a href="https://github.com/fish-shell/fish-shell/issues/8234" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8234/hovercard">#8234</a>, <a href="https://github.com/fish-shell/fish-shell/issues/4183" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/4183/hovercard">#4183</a>).</li>
<li>The <code>realpath</code> builtin now also squashes leading slashes with the <code>--no-symlinks</code> option (<a href="https://github.com/fish-shell/fish-shell/issues/8281" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8281/hovercard">#8281</a>).</li>
<li>When trying to <code>cd</code> to a dangling (broken) symbolic link, fish will print an error noting that the target is a broken link (<a href="https://github.com/fish-shell/fish-shell/issues/8264" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8264/hovercard">#8264</a>).</li>
<li>On MacOS terminals that are not granted permissions to access a folder, <code>cd</code> would print a spurious “rotten symlink” error, which has been corrected to “permission denied” (<a href="https://github.com/fish-shell/fish-shell/issues/8264" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8264/hovercard">#8264</a>).</li>
<li>Since fish 3.0, <code>for</code> loops would trigger a variable handler function before the loop was entered. As the variable had not actually changed or been set, this was a spurious event and has been removed (<a href="https://github.com/fish-shell/fish-shell/issues/8384" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8384/hovercard">#8384</a>).</li>
<li><code>math</code> now correctly prints negative values and values larger than <code>2\*\*31</code> when in hex or octal bases (<a href="https://github.com/fish-shell/fish-shell/issues/8417" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8417/hovercard">#8417</a>).</li>
<li><code>dirs</code> always produces an exit status of 0, instead of sometimes returning 1 (<a href="https://github.com/fish-shell/fish-shell/issues/8211" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8211/hovercard">#8211</a>).</li>
<li><code>cd &#34;&#34;</code> no longer crashes fish (<a href="https://github.com/fish-shell/fish-shell/issues/8147" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8147/hovercard">#8147</a>).</li>
<li><code>set --query</code> can now query whether a variable is a path variable via <code>--path</code> or <code>--unpath</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8494" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8494/hovercard">#8494</a>).</li>
<li>Tilde characters (<code>~</code>) produced by custom completions are no longer escaped when applied to the command line, making it easier to use the output of a recursive <code>complete -C</code> in completion scripts (<a href="https://github.com/fish-shell/fish-shell/issues/4570" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/4570/hovercard">#4570</a>).</li>
<li><code>set --show</code> reports when a variable is read-only (<a href="https://github.com/fish-shell/fish-shell/issues/8179" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8179/hovercard">#8179</a>).</li>
<li>Erasing <code>$fish_emoji_width</code> will reset fish to the default guessed emoji width (<a href="https://github.com/fish-shell/fish-shell/issues/8274" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8274/hovercard">#8274</a>).</li>
<li>The <code>la</code> function no longer lists entries for “.” and “..”, matching other systems defaults (<a href="https://github.com/fish-shell/fish-shell/issues/8519" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8519/hovercard">#8519</a>).</li>
<li><code>abbr -q</code> returns the correct exit status when given multiple abbreviation names as arguments (<a href="https://github.com/fish-shell/fish-shell/issues/8431" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8431/hovercard">#8431</a>).</li>
<li><code>command -v</code> returns an exit status of 127 instead of 1 if no command was found (<a href="https://github.com/fish-shell/fish-shell/issues/8547" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8547/hovercard">#8547</a>).</li>
<li><code>argparse</code> with <code>--ignore-unknown</code> no longer breaks with multiple unknown options in a short option group (<a href="https://github.com/fish-shell/fish-shell/issues/8637" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8637/hovercard">#8637</a>).</li>
<li>Comments inside command substitutions or brackets now correctly ignore parentheses, quotes, and brackets (<a href="https://github.com/fish-shell/fish-shell/issues/7866" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/7866/hovercard">#7866</a>, <a href="https://github.com/fish-shell/fish-shell/issues/8022" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8022/hovercard">#8022</a>, <a href="https://github.com/fish-shell/fish-shell/issues/8695" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8695/hovercard">#8695</a>).</li>
<li><code>complete -C</code> supports a new <code>--escape</code> option, which turns on escaping in returned completion strings (<a href="https://github.com/fish-shell/fish-shell/issues/3469" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/3469/hovercard">#3469</a>).</li>
<li>Invalid byte or unicode escapes like <code>\\Utest</code> or <code>\\xNotHex</code> are now a tokenizer error instead of causing the token to be truncated (<a href="https://github.com/fish-shell/fish-shell/issues/8545" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8545/hovercard">#8545</a>).</li>
</ul>
<h3>Interactive improvements</h3>
<ul>
<li>Vi mode cursors are now set properly after <code>Control-C</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8125" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8125/hovercard">#8125</a>).</li>
<li><code>funced</code> will try to edit the whole file containing a function definition, if there is one (<a href="https://github.com/fish-shell/fish-shell/issues/391" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/391/hovercard">#391</a>).</li>
<li>Running a command line consisting of just spaces now deletes an ephemeral (starting with space) history item again (<a href="https://github.com/fish-shell/fish-shell/issues/8232" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8232/hovercard">#8232</a>).</li>
<li>Command substitutions no longer respect job control, instead running inside fish’s own process group (<a href="https://github.com/fish-shell/fish-shell/issues/8172" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8172/hovercard">#8172</a>). This more closely matches other shells, and improves <code>Control-C</code> reliability inside a command substitution.</li>
<li><code>history</code> and <code>__fish_print_help</code> now properly support <code>less</code> before version 530, including the version that ships with macOS. (<a href="https://github.com/fish-shell/fish-shell/issues/8157" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8157/hovercard">#8157</a>).</li>
<li><code>help</code> now knows which section is in which document again (<a href="https://github.com/fish-shell/fish-shell/issues/8245" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8245/hovercard">#8245</a>).</li>
<li>fish’s highlighter will now color options (starting with <code>-</code> or <code>--</code>) with the color given in the new $fish_color_option, up to the first <code>--</code>. It falls back on $fish_color_param, so nothing changes for existing setups (<a href="https://github.com/fish-shell/fish-shell/issues/8292" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8292/hovercard">#8292</a>).</li>
<li>When executing a command, abbreviations are no longer expanded when the cursor is separated from the command by spaces, making it easier to suppress abbreviation expansion of commands without arguments. (<a href="https://github.com/fish-shell/fish-shell/issues/8423" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8423/hovercard">#8423</a>).</li>
<li><code>fish_key_reader</code>’s output was simplified. By default, it now only prints a bind statement. The previous per-character timing information can be seen with a new <code>--verbose</code> switch (<a href="https://github.com/fish-shell/fish-shell/issues/8467" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8467/hovercard">#8467</a>).</li>
<li>Custom completions are now also loaded for commands that contain tildes or variables like <code>~/bin/fish</code> or <code>$PWD/fish</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8442" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8442/hovercard">#8442</a>).</li>
<li>Command lines spanning multiple lines will not be overwritten by the completion pager when it fills the entire terminal (<a href="https://github.com/fish-shell/fish-shell/issues/8509" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8509/hovercard">#8509</a>, <a href="https://github.com/fish-shell/fish-shell/issues/8405" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8405/hovercard">#8405</a>).</li>
<li>When redrawing a multiline prompt, the old prompt is now properly cleared (<a href="https://github.com/fish-shell/fish-shell/issues/8163" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8163/hovercard">#8163</a>).</li>
<li>Interactive completion would occasionally ignore the last word on the command line due to a race condition. This has been fixed (<a href="https://github.com/fish-shell/fish-shell/issues/8175" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8175/hovercard">#8175</a>).</li>
<li>Propagation of universal variables from a fish process that is closing is faster (<a href="https://github.com/fish-shell/fish-shell/issues/8209" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8209/hovercard">#8209</a>).</li>
<li>The command line is drawn in the correct place if the prompt ends with a newline (<a href="https://github.com/fish-shell/fish-shell/issues/8298" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8298/hovercard">#8298</a>).</li>
<li><code>history</code> learned a new subcommand <code>clear-session</code> to erase all history from the current session (<a href="https://github.com/fish-shell/fish-shell/issues/5791" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/5791/hovercard">#5791</a>).</li>
<li>Pressing <code>Control-C</code> in <code>fish_key_reader</code> will no longer print the incorrect “Press [ctrl-C] again to exit” message (<a href="https://github.com/fish-shell/fish-shell/issues/8510" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8510/hovercard">#8510</a>).</li>
<li>The default command-not-found handler for Fedora/PackageKit now passes the whole command line, allowing for functionality such as running the suggested command directly (<a href="https://github.com/fish-shell/fish-shell/issues/8579" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8579/hovercard">#8579</a>).</li>
<li>When looking for locale information, the Debian configuration is now used when available (<a href="https://github.com/fish-shell/fish-shell/issues/8557" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8557/hovercard">#8557</a>).</li>
<li>Pasting text containing quotes from the clipboard trims spaces more appropriately (<a href="https://github.com/fish-shell/fish-shell/issues/8550" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8550/hovercard">#8550</a>).</li>
<li>The clipboard bindings ignore X-based clipboard programs if the <code>DISPLAY</code> environment variable is not set, which helps prefer the Windows clipboard when it is available (such as on WSL).</li>
<li><code>funcsave</code> will remove a saved copy of a function that has been erased with <code>functions --erase</code>.</li>
<li>The Web-based configuration tool gained a number of improvements, including the ability to set pager colors.</li>
<li>The default <code>fish_title</code> prints a shorter title with shortened $PWD and no more redundant “fish” (<a href="https://github.com/fish-shell/fish-shell/issues/8641" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8641/hovercard">#8641</a>).</li>
<li>Holding down an arrow key won’t freeze the terminal with long periods of flashing (<a href="https://github.com/fish-shell/fish-shell/issues/8610" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8610/hovercard">#8610</a>).</li>
<li>Multi-char bindings are no longer interrupted if a signal handler enqueues an event. (<a href="https://github.com/fish-shell/fish-shell/issues/8628" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8628/hovercard">#8628</a>).</li>
</ul>
<h4>New or improved bindings</h4>
<ul>
<li><code>Escape</code> can now bound without breaking arrow key bindings (<a href="https://github.com/fish-shell/fish-shell/issues/8428" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8428/hovercard">#8428</a>).</li>
<li>The <code>Alt-H</code> binding (to open a command’s manual page) now also ignores <code>command</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8447" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8447/hovercard">#8447</a>).</li>
</ul>
<h4>Improved prompts</h4>
<ul>
<li>The <code>fish_status_to_signal</code> helper function returns the correct signal names for the current platform, rather than Linux (<a href="https://github.com/fish-shell/fish-shell/issues/8530" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8530/hovercard">#8530</a>).</li>
<li>The <code>prompt_pwd</code> helper function learned a <code>--full-length-dirs N</code> option to keep the last N directory components unshortened. In addition the number of characters to shorten each component should be shortened to can now be given as <code>-d N</code> or <code>--dir-length N</code>. (<a href="https://github.com/fish-shell/fish-shell/issues/8208" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8208/hovercard">#8208</a>):</li>
</ul>
<div data-snippet-clipboard-copy-content="&gt; prompt_pwd --full-length-dirs 2 -d 1 ~/dev/fish-shell/share/tools/web_config
~/d/f/s/tools/web_config"><pre><span>&gt;</span> <span>prompt_pwd</span> <span>--full-length-dirs</span> 2 <span>-d</span> 1 ~/dev/fish-shell/share/tools/web_config
~/d/f/s/tools/web_config</pre></div>
<h4>Completions</h4>
<ul>
<li>Added completions for:
<ul>
<li>Apple’s <code>shortcuts</code></li>
<li><code>argparse</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8434" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8434/hovercard">#8434</a>)</li>
<li><code>asd</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8759" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8759/hovercard">#8759</a>)</li>
<li><code>az</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8141" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8141/hovercard">#8141</a>)</li>
<li><code>black</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8123" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8123/hovercard">#8123</a>)</li>
<li><code>clasp</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8373" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8373/hovercard">#8373</a>)</li>
<li><code>cpupower</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8302" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8302/hovercard">#8302</a>)</li>
<li><code>dart</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8315" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8315/hovercard">#8315</a>)</li>
<li><code>dscacheutil</code></li>
<li><code>elvish</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8416" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8416/hovercard">#8416</a>)</li>
<li><code>ethtool</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8283" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8283/hovercard">#8283</a>)</li>
<li><code>exif</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8246" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8246/hovercard">#8246</a>)</li>
<li><code>findstr</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8481" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8481/hovercard">#8481</a>)</li>
<li><code>git-sizer</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8156" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8156/hovercard">#8156</a>)</li>
<li><code>gnome-extensions</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8732" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8732/hovercard">#8732</a>)</li>
<li><code>gping</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8181" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8181/hovercard">#8181</a>)</li>
<li><code>isatty</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8609" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8609/hovercard">#8609</a>)</li>
<li><code>istioctl</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8343" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8343/hovercard">#8343</a>)</li>
<li><code>kmutil</code></li>
<li><code>kubectl</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8734" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8734/hovercard">#8734</a>)</li>
<li><code>matlab</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8505" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8505/hovercard">#8505</a>)</li>
<li><code>mono</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8415" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8415/hovercard">#8415</a>) and related tools <code>csharp</code>, <code>gacutil</code>, <code>gendarme</code>, <code>ikdasm</code>, <code>ilasm</code>, <code>mkbundle</code>, <code>monodis</code>, <code>monop</code>, <code>sqlsharp</code> and <code>xsp</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8452" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8452/hovercard">#8452</a>)</li>
<li>Angular’s <code>ng</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8111" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8111/hovercard">#8111</a>)</li>
<li><code>nodeenv</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8533" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8533/hovercard">#8533</a>)</li>
<li><code>octave</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8505" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8505/hovercard">#8505</a>)</li>
<li><code>pabcnet_clear</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8421" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8421/hovercard">#8421</a>)</li>
<li><code>qmk</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8180" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8180/hovercard">#8180</a>)</li>
<li><code>rakudo</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8113" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8113/hovercard">#8113</a>)</li>
<li><code>rc-status</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8757" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8757/hovercard">#8757</a>)</li>
<li><code>roswell</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8330" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8330/hovercard">#8330</a>)</li>
<li><code>sbcl</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8330" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8330/hovercard">#8330</a>)</li>
<li><code>starship</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8520" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8520/hovercard">#8520</a>)</li>
<li><code>topgrade</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8651" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8651/hovercard">#8651</a>)</li>
<li><code>wine</code>, <code>wineboot</code> and <code>winemaker</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8411" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8411/hovercard">#8411</a>)</li>
<li>Windows Subsystem for Linux (WSL)’s <code>wslpath</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8364" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8364/hovercard">#8364</a>)</li>
<li>Windows’ <code>color</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8483" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8483/hovercard">#8483</a>), <code>attrib</code>, <code>attributes</code>, <code>choice</code>, <code>clean</code>, <code>cleanmgr</code>, <code>cmd</code>, <code>cmdkey</code>, <code>comp</code>, <code>forfiles</code>, <code>powershell</code>, <code>reg</code>, <code>schtasks</code>, <code>setx</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8486" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8486/hovercard">#8486</a>)</li>
<li><code>zef</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8114" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8114/hovercard">#8114</a>)</li>
</ul>
</li>
<li>Improvements to many completions, especially for <code>git</code> aliases (<a href="https://github.com/fish-shell/fish-shell/issues/8129" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8129/hovercard">#8129</a>), subcommands (<a href="https://github.com/fish-shell/fish-shell/issues/8134" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8134/hovercard">#8134</a>) and submodules (<a href="https://github.com/fish-shell/fish-shell/issues/8716" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8716/hovercard">#8716</a>).</li>
<li>Many adjustments to complete correct options for system utilities on BSD and macOS.</li>
<li>When evaluating custom completions, the command line state no longer includes variable overrides (<code>var=val</code>). This unbreaks completions that read <code>commandline -op</code>.</li>
</ul>
<h4>Improved terminal support</h4>
<ul>
<li>Dynamic terminal titles are enabled on WezTerm (<a href="https://github.com/fish-shell/fish-shell/issues/8121" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8121/hovercard">#8121</a>).</li>
<li>Directory history navigation works out of the box with Apple Terminal’s default key settings (<a href="https://github.com/fish-shell/fish-shell/issues/2330" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/2330/hovercard">#2330</a>).</li>
<li>fish now assumes Unicode 9+ widths for emoji under iTerm 2 (<a href="https://github.com/fish-shell/fish-shell/issues/8200" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8200/hovercard">#8200</a>).</li>
<li>Skin-tone emoji modifiers (U+1F3FB through U+1F3FF) are now measured as width 0 (<a href="https://github.com/fish-shell/fish-shell/issues/8275" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8275/hovercard">#8275</a>).</li>
<li>fish’s escape sequence removal now also knows Tmux’s wrapped escapes.</li>
<li>Vi mode cursors are enabled in Apple Terminal.app (<a href="https://github.com/fish-shell/fish-shell/issues/8167" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8167/hovercard">#8167</a>).</li>
<li>Vi cursor shaping and $PWD reporting is now also enabled on foot (<a href="https://github.com/fish-shell/fish-shell/issues/8422" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8422/hovercard">#8422</a>).</li>
<li><code>ls</code> will use colors also on newer versions of Apple Terminal.app (<a href="https://github.com/fish-shell/fish-shell/issues/8309" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8309/hovercard">#8309</a>).</li>
<li>The <code>Delete</code> and <code>Shift-Tab</code> keys work more reliably under <code>st</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8352" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8352/hovercard">#8352</a>, <a href="https://github.com/fish-shell/fish-shell/issues/8354" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8354/hovercard">#8354</a>).</li>
</ul>
<h3>Other improvements</h3>
<ul>
<li>Fish’s test suite now uses <code>ctest</code>, and has become much faster to run. It is now also possible to run only specific tests with targets named <code>test_$filename</code> - <code>make test_set.fish</code> only runs the set.fish test. (<a href="https://github.com/fish-shell/fish-shell/issues/7851" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/7851/hovercard">#7851</a>)</li>
<li>The HTML version of the documentation now includes copy buttons for code examples (<a href="https://github.com/fish-shell/fish-shell/issues/8218" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8218/hovercard">#8218</a>).</li>
<li>The HTML version of the documentation and the web-based configuration tool now pick more modern system fonts instead of falling back to Arial and something like Courier New most of the time (<a href="https://github.com/fish-shell/fish-shell/issues/8632" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8632/hovercard">#8632</a>).</li>
<li>The Debian &amp; Ubuntu package linked from fishshell.com is now a single package, rather than split into <code>fish</code> and <code>fish-common</code> (<a href="https://github.com/fish-shell/fish-shell/issues/7845" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/7845/hovercard">#7845</a>).</li>
<li>The macOS installer does not assert that Rosetta is required to install fish on machines with Apple Silicon (<a href="https://github.com/fish-shell/fish-shell/issues/8566" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8566/hovercard">#8566</a>).</li>
<li>The macOS installer now cleans up previous .pkg installations when upgrading. (<a href="https://github.com/fish-shell/fish-shell/issues/2963" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/2963/hovercard">#2963</a>).</li>
</ul>
<h3>For distributors</h3>
<ul>
<li>The minimum version of CMake required to build fish is now 3.5.0.</li>
<li>The CMake installation supports absolute paths for <code>CMAKE_INSTALL_DATADIR</code> (<a href="https://github.com/fish-shell/fish-shell/issues/8150" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8150/hovercard">#8150</a>).</li>
<li>Building using NetBSD curses works on any platform (<a href="https://github.com/fish-shell/fish-shell/issues/8087" data-hovercard-type="issue" data-hovercard-url="/fish-shell/fish-shell/issues/8087/hovercard">#8087</a>).</li>
<li>The build system now uses the default linker instead of forcing use of the gold or lld linker (<a href="https://github.com/fish-shell/fish-shell/issues/8152" data-hovercard-type="pull_request" data-hovercard-url="/fish-shell/fish-shell/pull/8152/hovercard">#8152</a>).</li>
</ul>
<hr/>
<p><em>Download links: To download the source code for fish, use the file named &#34;fish-3.4.0.tar.xz&#34;. The file downloaded from &#34;Source code (tar.gz)&#34; has extra build requirements. The SHA-256 sum of this file is <code>b5b48ab8486b19ef716a32f7f46b88b9ea5356155f0e967ee99f4093645413c5</code>. A GPG signature from David Adam (key ID <code>0x7A67D962D88A709A</code>) is available as &#34;fish-3.4.0.tar.xz.asc&#34;.</em></p></div></div>
  </body>
</html>
