<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://devblogs.microsoft.com/oldnewthing/20240408-00/?p=109627">Original</a>
    <h1>How does the classic Win32 ListView handle incremental searching?</h1>
    
    <div id="readability-page-1" class="page"><div id="featured">

	<div>
                         <p>
            April 8th, 2024</p><!-- .entry-meta -->
        <p>The classic Win32 ListView supports incremental search: You can start typing the name of an item to search for it. But it’s a bit more complicated than that.</p>
<p>You see, there’s more than one way that people expect type-to-search to work. In one pattern, you type the first letter of the thing you want, and the system finds the first item that starts with that letter. If that’s not the one you want, you press that same letter again, and the system finds the second item that starts with that letter. Keep pressing that same letter until you get to the item you want. This is how list box searching worked in Windows 1.0.</p>
<p>Another pattern is to type the first letter of the thing you want, and the system finds the first item that starts with that letter. If that’s not the one you want, then type the second letter of the thing you want, and the system finds the first item whose first two letters match the letters you typed. Keep typing more and more letters until you get to the item you want.</p>
<p>Which pattern should the classic Win32 ListView control use?</p>
<p><a title="Why Not Both? meme explanation" href="https://knowyourmeme.com/memes/why-not-both-why-dont-we-have-both"> Why not both</a>?</p>
<p>If you type the same letter over and over again, then the classic Win32 ListView assumes that you are using the first pattern, and each time you press the same letter again, it selects the next item that starts with that letter. But if you type different letters, then the classic Win32 ListView assumes that you are typing a prefix, and it selects the first item that starts with that prefix.</p>
<p>For example, suppose that you have a ListView with the following items:</p>
<ul>
<li>Cougar</li>
<li>Leopard</li>
<li>Lemur</li>
<li>Lion</li>
<li>Llama</li>
<li>Tiger</li>
</ul>
<p>You type L, and this selects <i>Leopard</i>, the first animal on the list that begins with L.</p>
<p>You type another L. Since this is now two L’s, the Win32 ListView is in “repeated letter” mode, and it selects the second L-animal, which is <i>Lemur</i>.</p>
<p>Now you type A. This is no longer a repeat of the same letter, so the Win32 ListView switches to “prefix” mode, and it selects the first item which begins with “LLA”, which is <i>Llama</i>.</p>

        

        
		
        
	</div><!-- .entry-content -->

</div></div>
  </body>
</html>
