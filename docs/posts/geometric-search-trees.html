<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://g-trees.github.io/g_trees/">Original</a>
    <h1>Geometric Search Trees</h1>
    
    <div id="readability-page-1" class="page"><div id="wrapContent"><section data-hsection="title"><ol><li data-hsection="introduction" data-hlevel="1"><a data-hsection-level="1" data-ref="introduction" data-hl="true" href="#introduction">Introduction</a><ol></ol></li><li data-hsection="related_work" data-hlevel="1"><a data-hsection-level="1" data-ref="related_work" data-hl="true" href="#related_work">Related Work</a><ol></ol></li><li data-hsection="preliminaries" data-hlevel="1"><a data-hsection-level="1" data-ref="preliminaries" data-hl="true" href="#preliminaries">Preliminaries</a><ol><li data-hsection="prelims_data_structures" data-hlevel="2"><a data-hsection-level="2" data-ref="prelims_data_structures" data-hl="true" href="#prelims_data_structures">Data Structures</a><ol></ol></li><li data-hsection="prelim_geometric_distribution" data-hlevel="2"><a data-hsection-level="2" data-ref="prelim_geometric_distribution" data-hl="true" href="#prelim_geometric_distribution">Pseudorandom Geometric Distributions</a><ol></ol></li><li data-hsection="prelims_zip_trees" data-hlevel="2"><a data-hsection-level="2" data-ref="prelims_zip_trees" data-hl="true" href="#prelims_zip_trees">Zip-Trees</a><ol></ol></li></ol></li><li data-hsection="sec_gtrees" data-hlevel="1"><a data-hsection-level="1" data-ref="sec_gtrees" data-hl="true" href="#sec_gtrees">G-Trees</a><ol><li data-hsection="analysis" data-hlevel="2"><a data-hsection-level="2" data-ref="analysis" data-hl="true" href="#analysis">Analysis</a><ol><li data-hsection="gtree_height" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_height" data-hl="true" href="#gtree_height">G-Tree Height</a><ol></ol></li><li data-hsection="gtree_node_size" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_node_size" data-hl="true" href="#gtree_node_size">G-Node Size</a><ol></ol></li><li data-hsection="gtree_size" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_size" data-hl="true" href="#gtree_size">G-Tree Size</a><ol></ol></li></ol></li><li data-hsection="old_gtrees" data-hlevel="2"><a data-hsection-level="2" data-ref="old_gtrees" data-hl="true" href="#old_gtrees">Well-Known G-Trees</a><ol><li data-hsection="gtree_zip_trees" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_zip_trees" data-hl="true" href="#gtree_zip_trees">Zip-Trees as G-Trees</a><ol></ol></li><li data-hsection="gtree_zipzip_trees" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_zipzip_trees" data-hl="true" href="#gtree_zipzip_trees">Zip-Zip-Trees and Beyond</a><ol></ol></li><li data-hsection="gtree_treaps" data-hlevel="3"><a data-hsection-level="3" data-ref="gtree_treaps" data-hl="true" href="#gtree_treaps">Treaps as G-Trees</a><ol></ol></li></ol></li><li data-hsection="new_gtrees" data-hlevel="2"><a data-hsection-level="2" data-ref="new_gtrees" data-hl="true" href="#new_gtrees">Novel G-Trees</a><ol></ol></li></ol></li><li data-hsection="implementation" data-hlevel="1"><a data-hsection-level="1" data-ref="implementation" data-hl="true" href="#implementation">Algorithms</a><ol></ol></li><li data-hsection="conclusion" data-hlevel="1"><a data-hsection-level="1" data-ref="conclusion" data-hl="true" href="#conclusion">Conclusion</a><ol></ol></li><li data-hsection="bibliography" data-hlevel="1"><a data-hsection-level="1" data-ref="bibliography" data-hl="true" href="#bibliography">References</a><ol></ol></li><li data-hsection="experiments" data-hlevel="1"><a data-hsection-level="1" data-ref="experiments" data-hl="true" href="#experiments">Appendix A: Code</a><ol></ol></li><li data-hsection="variants" data-hlevel="1"><a data-hsection-level="1" data-ref="variants" data-hl="true" href="#variants">Appendix B: G-Tree Variants</a><ol></ol></li><li data-hsection="explicit_implementations" data-hlevel="1"><a data-hsection-level="1" data-ref="explicit_implementations" data-hl="true" href="#explicit_implementations">Appendix C: Explicit Insertion and Deletion</a><ol></ol></li></ol><div><section><p>We describe G-trees, a family of randomized, history-independent search tree data structures. The G-trees encompass several independently-discovered data structures such as zip-trees, zip-zip-trees, and dense skip-trees. The family further contains novel trees of arity greater than two, which are significantly more efficient in the presence of cache hierarchies or block storage than zip-trees. Traditionally, such randomized trees have been significantly more complex than their binary counterparts, whereas our <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-ary G-trees have no additional conceptual overhead at all. We generalize the zip and unzip operations of zip-trees to provide a uniform, simple, and efficient implementation technique for all members of our family of data structures.</p></section></div><h2 id="introduction"><a data-ref="introduction" data-hl="true" data-hsection-level="1" href="#introduction">1 Introduction</a></h2><section data-hsection="introduction"><p>Randomized set data structures eschew self-balancing logic for simpler, probabilistic item organization. When deriving the necessary randomness via pseudorandom functions of the stored items themselves, the resulting graphs depend on the stored set only, but not the order of insertions and deletions. This <dfn id="history_independent"><a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independence</a></dfn> ensures that no information about previously deleted items can be reconstructed<a data-ref="naor2001anti" data-preview-anchor="previews/naor2001anti.html?def§naor2001anti" href="https://g-trees.github.io/g_trees/g_trees/assets/references/naor2001anti.pdf"><span></span> <span>(<span>Naor</span> &amp; <span>Teague</span>, 2001)</span></a>, and it enables <a data-ref="pugh1989incremental" data-preview-anchor="previews/pugh1989incremental.html?def§pugh1989incremental" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1989incremental.pdf"><span>efficient set fingerprinting</span> <span>(<span>Pugh</span> &amp; <span>Teitelbaum</span>, 1989)</span></a> when using the data structure as a <a data-ref="merkle1989certified" data-preview-anchor="previews/merkle1989certified.html?def§merkle1989certified" href="https://g-trees.github.io/g_trees/g_trees/assets/references/merkle1989certified.pdf"><span>merkle-tree</span> <span>(<span>Merkle</span>, 1989)</span></a>.</p><p>For these reasons, randomized search trees and related data structures have been studied for decades. The most prominent such data structures are <dfn id="treap"><a data-ref="treap" data-preview-anchor="previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a></dfn><a data-ref="seidel1996randomized" data-preview-anchor="previews/seidel1996randomized.html?def§seidel1996randomized" href="https://g-trees.github.io/g_trees/g_trees/assets/references/seidel1996randomized.pdf"><span></span> <span>(<span>Seidel</span> &amp; <span>Aragon</span>, 1996)</span></a>, <dfn id="skip_list"><a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a></dfn><a data-ref="pugh1990skip" data-preview-anchor="previews/pugh1990skip.html?def§pugh1990skip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1990skip.pdf"><span></span> <span>(<span>Pugh</span>, 1990)</span></a>, and, more recently, <dfn id="zip_informal"><a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a></dfn><a data-ref="tarjan2021zip" data-preview-anchor="previews/tarjan2021zip.html?def§tarjan2021zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/tarjan2021zip.pdf"><span></span> <span>(<span><span>Tarjan</span> <span>et al.</span></span>, 2021)</span></a>. All three are different takes on approximating the distribution of items in perfectly balanced binary search trees.</p><p>While <em>binary</em> trees are highly efficient in theory, they are less efficient on actual hardware than trees that store more than one item per vertex. Unfortunately, generalizing binary randomized data structures to higher-arity counterparts has proven more difficult than in the case of deterministically self-balancing trees. Providing a simple such generalization is the impetus for our work. <a data-ref="fig_search_performance" data-preview-anchor="previews/fig_search_performance.html?def§fig_search_performance" href="#fig_search_performance">Figure 1</a> plots lookup performance of a <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-tree</a> versus a 32-ary tree of ours; our tree is roughly twice as fast (note the logarithmic y-axis). On secondary storage, we can expect the performance difference to be even more pronounced.</p><figure id="fig_search_performance"><img alt="A plot showing search performance of a zip-tree versus a 32-zip-tree; the latter is roughly twice as fast." src="https://g-trees.github.io/g_trees/assets/graphics/performance.svg"/><figcaption><p><a data-ref="fig_search_performance" data-preview-anchor="/g_trees/previews/fig_search_performance.html?def§fig_search_performance" href="#fig_search_performance">Figure 1</a>: Lookup Performance</p><p>Benchmarking search times for 100 randomly chosen items in randomly generated <a data-ref="zip_informal" data-preview-anchor="/g_trees/previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> (red, top line) and 32-zip-trees (green, lower line). The latter is a novel variant of <a data-ref="zip_informal" data-preview-anchor="/g_trees/previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> that arises naturally from our generalization of <a data-ref="zip_informal" data-preview-anchor="/g_trees/previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> to <a data-ref="gtree_informal" data-preview-anchor="/g_trees/previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a>.</p></figcaption></figure><p>We present the <dfn id="gtree_informal"><a data-ref="gtree_informal" data-preview-anchor="/g_trees/previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">geometric search trees</a></dfn> (<dfn id="gtree_informal"><a data-ref="gtree_informal" data-preview-anchor="/g_trees/previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a></dfn>), a family of randomized search trees that provides a unified perspective on several independently researched data structures, including <a data-ref="zip_informal" data-preview-anchor="/g_trees/previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a>, <dfn id="zipzip"><a data-ref="zipzip" data-preview-anchor="/g_trees/previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a></dfn><a data-ref="gila2023zip" data-preview-anchor="/g_trees/previews/gila2023zip.html?def§gila2023zip" href="https://g-trees.github.io/g_trees/assets/references/gila2023zip.pdf"><span></span> <span>(<span><span>Gila</span> <span>et al.</span></span>, 2023)</span></a>, <dfn id="skip_tree"><a data-ref="skip_tree" data-preview-anchor="/g_trees/previews/skip_tree.html?def§skip_tree" data-hl="true" href="#skip_tree">skip-trees</a></dfn><a data-ref="messeguer1997skip" data-preview-anchor="/g_trees/previews/messeguer1997skip.html?def§messeguer1997skip" href="https://g-trees.github.io/g_trees/assets/references/messeguer1997skip.pdf"><span></span> <span>(<span>Messeguer</span>, 1997)</span></a>, <dfn id="dense_skip_tree"><a data-ref="dense_skip_tree" data-preview-anchor="/g_trees/previews/dense_skip_tree.html?def§dense_skip_tree" data-hl="true" href="#dense_skip_tree">dense skip-trees</a></dfn><a data-ref="spiegel2009dense" data-preview-anchor="/g_trees/previews/spiegel2009dense.html?def§spiegel2009dense" href="https://g-trees.github.io/g_trees/assets/references/spiegel2009dense.pdf"><span></span> <span>(<span>Spiegel</span> &amp; <span>Reynolds Jr</span>, 2009)</span></a>, <dfn id="mst"><a data-ref="mst" data-preview-anchor="/g_trees/previews/mst.html?def§mst" data-hl="true" href="#mst">merkle-search-trees</a></dfn><a data-ref="auvolat2019merkle" data-preview-anchor="/g_trees/previews/auvolat2019merkle.html?def§auvolat2019merkle" href="https://g-trees.github.io/g_trees/assets/references/auvolat2019merkle.pdf"><span></span> <span>(<span>Auvolat</span> &amp; <span>Taïani</span>, 2019)</span></a>, and <dfn id="prolly_tree"><a data-ref="prolly_tree" data-preview-anchor="/g_trees/previews/prolly_tree.html?def§prolly_tree" data-hl="true" href="#prolly_tree">prolly-trees</a></dfn><a data-ref="boodman2016prolly" data-preview-anchor="/g_trees/previews/boodman2016prolly.html?def§boodman2016prolly" href="https://github.com/attic-labs/noms/blob/master/doc/intro.md#prolly-trees-probabilistic-b-trees"><span></span> <span>(<span><span>Boodman</span> <span>et al.</span></span>, 2016)</span></a>. Our framework allows us to trivially define efficient trees that store a bounded number of items per vertex. These trees are arguably the first such randomized search trees whose conceptual complexity is just as low as that of their binary counterparts.</p><p>Our key insight is to take a byproduct of the usual definition of <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a>, turn it into a defining property of its own, and to then generalize it. <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">Zip-trees</a> assign geometrically chosen <a data-ref="rank_informal" data-preview-anchor="previews/rank_informal.html?def§rank_informal" data-hl="true" href="#rank_informal">ranks</a> to their items, and use these <a data-ref="rank_informal" data-preview-anchor="previews/rank_informal.html?def§rank_informal" data-hl="true" href="#rank_informal">ranks</a> for probabilistic balancing. A consequence of their balancing mechanism is that certain sequences of items with colliding <a data-ref="rank_informal" data-preview-anchor="previews/rank_informal.html?def§rank_informal" data-hl="true" href="#rank_informal">ranks</a> form sorted linked lists. It turns out we can view and even <em>define</em> <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> as collections of such linked lists.</p><p>From this definition, which is based on arranging <em>sorted linked lists</em> in a certain fashion, it is only a small step to arranging <em>arbitrary set data structures</em> in the same fashion. This yields our <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a>, a family of trees that is parameterized over a secondary search data structure. Using simple linked lists as the underlying data structure yields the <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a>. Recursively instantiating the <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a> with other <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a> yields a natural (and efficient) generalization of the <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a>. And finally, using linked lists of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> items per vertex yields a generalization of the <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> where each node can store up to <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> items.</p><p>The <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a> not only define a unique tree shape for any set of items with associated ranks, they also offer a unified means of implementation. We provide generalizations of the zipping and unzipping algorithms of the original <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a>, and use them to implement insertion and deletion. These general algorithms can be applied to all <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a> whose underlying set data structure supports splitting at arbitrary keys and joining two non-overlapping sets. The algorithms perform a number of splits or joins proportional to the number of distinct ranks in the tree, which is logarithmic in the total number of items with high probability.</p><p>We give an overview of related work in <a data-hsection-level="1" data-ref="related_work" data-hl="true" href="#related_work">Section 2</a>, before introducing preliminary definitions and notation in <a data-hsection-level="1" data-ref="preliminaries" data-hl="true" href="#preliminaries">Section 3</a>. We present the <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">geometric trees</a> in <a data-hsection-level="1" data-ref="sec_gtrees" data-hl="true" href="#sec_gtrees">Section 4</a>, including a thorough <a data-hsection-level="2" data-ref="analysis" data-hl="true" href="#analysis">analysis</a> and a an overview of <a data-hsection-level="2" data-ref="old_gtrees" data-hl="true" href="#old_gtrees">old</a> and <a data-hsection-level="2" data-ref="new_gtrees" data-hl="true" href="#new_gtrees">novel</a> <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a>. <a data-hsection-level="1" data-ref="implementation" data-hl="true" href="#implementation">Section 5</a> describes efficient algorithms for mutating <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a>.</p></section><section data-hsection="related_work"><p><span>The practically-minded reader can safely skip ahead to <a data-hsection-level="1" data-ref="preliminaries" data-hl="true" href="#preliminaries">Section 3</a>, whereas the more academically inclined may wish to stick around for <a data-hsection-level="1" data-ref="related_work" data-hl="true" href="#related_work">Section 2</a>, where we outline the current state of the art and contextualize our contributions.</span>Data structures whose exact shape is determined solely by their contents and not by the order of insertion and deletion operations have been studied for decades. This property has been given several names, such as <a data-ref="snyder1977uniquely" data-preview-anchor="previews/snyder1977uniquely.html?def§snyder1977uniquely" href="https://ieeexplore.ieee.org/document/4567936"><span>unique representation</span> <span>(<span>Snyder</span>, 1977)</span></a>, <a data-ref="auvolat2019merkle" data-preview-anchor="previews/auvolat2019merkle.html?def§auvolat2019merkle" href="https://g-trees.github.io/g_trees/g_trees/assets/references/auvolat2019merkle.pdf"><span>structural unicity</span> <span>(<span>Auvolat</span> &amp; <span>Taïani</span>, 2019)</span></a>, <a data-ref="driscoll1994fully" data-preview-anchor="previews/driscoll1994fully.html?def§driscoll1994fully" href="https://g-trees.github.io/g_trees/g_trees/assets/references/driscoll1994fully.pdf"><span>confluent persistence</span> <span>(<span><span>Driscoll</span> <span>et al.</span></span>, 1994)</span></a>, and <a data-ref="naor2001anti" data-preview-anchor="previews/naor2001anti.html?def§naor2001anti" href="https://g-trees.github.io/g_trees/g_trees/assets/references/naor2001anti.pdf"><span>anti-persistence or history-independence</span> <span>(<span>Naor</span> &amp; <span>Teague</span>, 2001)</span></a>. Deterministically self-balancing <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> set data structures necessarily take super-logarithmic time to update under arbitrary insertions and deletions<a data-ref="snyder1977uniquely" data-preview-anchor="previews/snyder1977uniquely.html?def§snyder1977uniquely" href="https://ieeexplore.ieee.org/document/4567936"><span></span> <span>(<span>Snyder</span>, 1977)</span></a>. Hence, several <em>probabilistic</em> <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> data structures have been devised which support membership queries and update operations in logarithmic time with high probability.</p><p>Well-known such (pseuso-) randomized set data structures include <dfn id="hash_trie"><a data-ref="hash_trie" data-preview-anchor="previews/hash_trie.html?def§hash_trie" data-hl="true" href="#hash_trie">hash tries</a></dfn> (as presented, for example, by Pugh and Teitelbaum<a data-ref="pugh1989incremental" data-preview-anchor="previews/pugh1989incremental.html?def§pugh1989incremental" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1989incremental.pdf"><span></span> <span>(<span>Pugh</span> &amp; <span>Teitelbaum</span>, 1989)</span></a>), <a data-ref="treap" data-preview-anchor="previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a><a data-ref="seidel1996randomized" data-preview-anchor="previews/seidel1996randomized.html?def§seidel1996randomized" href="https://g-trees.github.io/g_trees/g_trees/assets/references/seidel1996randomized.pdf"><span></span> <span>(<span>Seidel</span> &amp; <span>Aragon</span>, 1996)</span></a>, and <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a><a data-ref="pugh1990skip" data-preview-anchor="previews/pugh1990skip.html?def§pugh1990skip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1990skip.pdf"><span></span> <span>(<span>Pugh</span>, 1990)</span></a>. More recently, <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a> <a data-ref="tarjan2021zip" data-preview-anchor="previews/tarjan2021zip.html?def§tarjan2021zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/tarjan2021zip.pdf"><span></span> <span>(<span><span>Tarjan</span> <span>et al.</span></span>, 2021)</span></a> and <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a> <a data-ref="gila2023zip" data-preview-anchor="previews/gila2023zip.html?def§gila2023zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/gila2023zip.pdf"><span></span> <span>(<span><span>Gila</span> <span>et al.</span></span>, 2023)</span></a> have been proposed as more efficient variants of <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a>.</p><p>All these data structures approximate the vertex distribution of <em>binary</em> balanced search trees. While binary search trees are theoretically efficient, CPU caches or block-sized reads from secondary storage make it so that trees that store more than a single item per vertex outperform binary trees in practice. Theoretical models to capture this behavior in the analysis of algorithms and data structures include <a data-ref="aggarwal1988input" data-preview-anchor="previews/aggarwal1988input.html?def§aggarwal1988input" href="https://g-trees.github.io/g_trees/g_trees/assets/references/aggarwal1988input.pdf"><span>external memory models</span> <span>(<span>Aggarwal</span> &amp; <span>Vitter</span>, 1988)</span></a> and <a data-ref="frigo1999cache" data-preview-anchor="previews/frigo1999cache.html?def§frigo1999cache" href="https://g-trees.github.io/g_trees/g_trees/assets/references/frigo1999cache.pdf"><span>cache-oblivious models</span> <span>(<span><span>Frigo</span> <span>et al.</span></span>, 1999)</span></a>.</p><p>Several attempts have been made to find randomized data structures that perform well in an external memory model. Golovin<a data-ref="golovin2009b" data-preview-anchor="/g_trees/previews/golovin2009b.html?def§golovin2009b" href="https://g-trees.github.io/g_trees/assets/references/golovin2009b.pdf"><span></span> <span>(<span>Golovin</span>, 2009)</span></a> has proposed <dfn id="b_treap"><a data-ref="b_treap" data-preview-anchor="/g_trees/previews/b_treap.html?def§b_treap" data-hl="true" href="#b_treap">bushy treaps</a></dfn> (<dfn id="b_treap"><a data-ref="b_treap" data-preview-anchor="/g_trees/previews/b_treap.html?def§b_treap" data-hl="true" href="#b_treap">B-treaps</a></dfn>) to approximate the behavior of B-trees via treaps. Unfortunately, <a data-ref="b_treap" data-preview-anchor="/g_trees/previews/b_treap.html?def§b_treap" data-hl="true" href="#b_treap">B-treaps</a> are complicated enough that even their author recommends using simpler alternatives such as the <dfn id="b_skip_list"><a data-ref="b_skip_list" data-preview-anchor="/g_trees/previews/b_skip_list.html?def§b_skip_list" data-hl="true" href="#b_skip_list">B-skip-list</a></dfn><a data-ref="golovin2010b" data-preview-anchor="/g_trees/previews/golovin2010b.html?def§golovin2010b" href="https://g-trees.github.io/g_trees/assets/references/golovin2010b.pdf"><span></span> <span>(<span>Golovin</span>, 2010)</span></a>. The <a data-ref="b_skip_list" data-preview-anchor="/g_trees/previews/b_skip_list.html?def§b_skip_list" data-hl="true" href="#b_skip_list">B-skip-list</a> still involves a tuning parameter beyond the probability distribution for assigning node levels, a nontrivial invariant, and virtual memory management via hash tables rather than simple usage of pointers. In short, the conceptual complexity goes far beyond that of binary <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> or <a data-ref="treap" data-preview-anchor="/g_trees/previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a>.</p><p>Safavi and Seybold<a data-ref="safavi2023b" data-preview-anchor="/g_trees/previews/safavi2023b.html?def§safavi2023b" href="https://g-trees.github.io/g_trees/assets/references/safavi2023b.pdf"><span></span> <span>(<span>Safavi</span> &amp; <span>Seybold</span>, 2023)</span></a> propose <dfn id="rbst"><a data-ref="rbst" data-preview-anchor="/g_trees/previews/rbst.html?def§rbst" data-hl="true" href="#rbst">randomized-block-search-trees</a></dfn> (<dfn id="rbst"><a data-ref="rbst" data-preview-anchor="/g_trees/previews/rbst.html?def§rbst" data-hl="true" href="#rbst">RBSTs</a></dfn>) as another generalization of binary <a data-ref="treap" data-preview-anchor="/g_trees/previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a> that performs well in an external-memory model. The construction involves multiple tuning parameters, two distinct layers of data structure internals, and a highly nontrivial complexity analysis.</p><p>Bender et al<a data-ref="bender2016anti" data-preview-anchor="/g_trees/previews/bender2016anti.html?def§bender2016anti" href="https://g-trees.github.io/g_trees/assets/references/bender2016anti.pdf"><span></span> <span>(<span><span>Bender</span> <span>et al.</span></span>, 2016)</span></a> first specify a history-independent <dfn id="pma"><a data-ref="pma" data-preview-anchor="/g_trees/previews/pma.html?def§pma" data-hl="true" href="#pma">packed-memory array</a></dfn> (<dfn id="pma"><a data-ref="pma" data-preview-anchor="/g_trees/previews/pma.html?def§pma" data-hl="true" href="#pma">PMA</a></dfn>), and then build a <a data-ref="history_independent" data-preview-anchor="/g_trees/previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> B-tree analogon and an external-memory skip-list on top of the <a data-ref="pma" data-preview-anchor="/g_trees/previews/pma.html?def§pma" data-hl="true" href="#pma">PMA</a>. So there is again a two-layered aproach; the <a data-ref="pma" data-preview-anchor="/g_trees/previews/pma.html?def§pma" data-hl="true" href="#pma">PMA</a> introduces a significant chunk of conceptual complexity that is not part of regular <a data-ref="treap" data-preview-anchor="/g_trees/previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a> or <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a>.</p><p>Some proponents of randomized data structures claim that a significant advantage over self-balancing data structures is their greater simplicity<a data-ref="pugh1990skipseidel1996randomized" data-preview-anchor="previews/pugh1990skipseidel1996randomized.html?def§pugh1990skipseidel1996randomized" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1990skip.pdf"><span></span> <span>(<span>Pugh</span>, 1990; <span>Seidel</span> &amp; <span>Aragon</span>, 1996)</span></a>. It seems safe to say that none of the external-memory constructions we have just listed retain this advantage.</p><p>All prior work that <em>does</em> achieve sufficient simplicity buys it at the price of vertices that must store a dynamic, unbounded number of items. The <a data-ref="skip_tree" data-preview-anchor="previews/skip_tree.html?def§skip_tree" data-hl="true" href="#skip_tree">skip-trees</a><a data-ref="messeguer1997skip" data-preview-anchor="previews/messeguer1997skip.html?def§messeguer1997skip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/messeguer1997skip.pdf"><span></span> <span>(<span>Messeguer</span>, 1997)</span></a> are the first such data structure, effectively converting a <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a> into a tree: each vertex stores sequences of items that are being skipped-over together in the corresponding <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a>. The relatively unknown <a data-ref="dense_skip_tree" data-preview-anchor="previews/dense_skip_tree.html?def§dense_skip_tree" data-hl="true" href="#dense_skip_tree">dense skip-trees</a><a data-ref="spiegel2009dense" data-preview-anchor="previews/spiegel2009dense.html?def§spiegel2009dense" href="https://g-trees.github.io/g_trees/g_trees/assets/references/spiegel2009dense.pdf"><span></span> <span>(<span>Spiegel</span> &amp; <span>Reynolds Jr</span>, 2009)</span></a> provide two optimizations: expected node size can be increased by flipping coins of success probabilities <span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span><span>,</span></span></span></span></span></span> and empty vertices are eliminated from the tree. The <a data-ref="mst" data-preview-anchor="previews/mst.html?def§mst" data-hl="true" href="#mst">merkle-search-trees</a> (<a data-ref="mst" data-preview-anchor="previews/mst.html?def§mst" data-hl="true" href="#mst">MSTs</a>)<a data-ref="auvolat2019merkle" data-preview-anchor="previews/auvolat2019merkle.html?def§auvolat2019merkle" href="https://g-trees.github.io/g_trees/g_trees/assets/references/auvolat2019merkle.pdf"><span></span> <span>(<span>Auvolat</span> &amp; <span>Taïani</span>, 2019)</span></a> independently reinvent <a data-ref="skip_tree" data-preview-anchor="previews/skip_tree.html?def§skip_tree" data-hl="true" href="#skip_tree">skip-trees</a> with flexible probabilities similar to <a data-ref="dense_skip_tree" data-preview-anchor="previews/dense_skip_tree.html?def§dense_skip_tree" data-hl="true" href="#dense_skip_tree">dense skip-trees</a>, but without the compression of empty vertices. Additionally, <a data-ref="prolly_tree" data-preview-anchor="previews/prolly_tree.html?def§prolly_tree" data-hl="true" href="#prolly_tree">prolly-trees</a> <a data-ref="boodman2016prolly" data-preview-anchor="previews/boodman2016prolly.html?def§boodman2016prolly" href="https://github.com/attic-labs/noms/blob/master/doc/intro.md#prolly-trees-probabilistic-b-trees"><span></span> <span>(<span><span>Boodman</span> <span>et al.</span></span>, 2016)</span></a> provide a slightly different take, where a rolling hash function over the keys/values is used to determine the set of items in each node, rather than via explicit split and join operations.</p><p>None of these data structures can provide a non-probabilistic upper bound on the number of items per vertex. This hampers efficient implementation; and adversarial data suppliers can trivially produce <span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span> items in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>n</span><span>)</span></span></span></span> expected time that must all be stored in the same vertex.</p></section><h2 id="preliminaries"><a data-ref="preliminaries" data-hl="true" data-hsection-level="1" href="#preliminaries">3 Preliminaries</a></h2><section data-hsection="preliminaries"><p>Here, we define fundamental terminology, and provide proper definitions and background for <a data-ref="zip_informal" data-preview-anchor="previews/zip_informal.html?def§zip_informal" data-hl="true" href="#zip_informal">zip-trees</a>.</p><h3 id="prelims_data_structures"><a data-ref="prelims_data_structures" data-hl="true" data-hsection-level="2" href="#prelims_data_structures">3.1 Data Structures</a></h3><section data-hsection="prelims_data_structures"><p>A <dfn id="tree"><a data-ref="tree" data-preview-anchor="/g_trees/previews/tree.html?def§tree" data-hl="true" href="#tree">tree</a></dfn> data structure for items from some universe <span><span aria-hidden="true"><span><span></span><span id="tree_u"><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span></span> is either the <dfn id="tree_empty"><a data-ref="tree_empty" data-preview-anchor="/g_trees/previews/tree_empty.html?def§tree_empty" data-hl="true" href="#tree_empty">empty tree</a></dfn>, or a <dfn id="vertex"><a data-ref="vertex" data-preview-anchor="/g_trees/previews/vertex.html?def§vertex" data-hl="true" href="#vertex">vertex</a></dfn> consisting of a sequence of <span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span> <dfn id="item"><a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a></dfn> from <span><span aria-hidden="true"><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span> and a sequence of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="tree" data-preview-anchor="/g_trees/previews/tree.html?def§tree" data-hl="true" href="#tree">trees</a> called its <dfn id="child"><a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a></dfn>.</p><p>We write <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span> for the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>,</span> and <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span><span>[</span><span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span><span>]</span></span> for the <span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>-th <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> of <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>.</span> We write <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>children</span> for the <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a> of <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>,</span> and <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>children</span><span>[</span><span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span><span>]</span></span> for the <span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>-th <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">child</a> of <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>.</span> Indexing always starts at zero.</p><p>Let <span><span aria-hidden="true"><span><span></span><span id="tree_t"><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span></span> be a <a data-ref="tree" data-preview-anchor="/g_trees/previews/tree.html?def§tree" data-hl="true" href="#tree">tree</a>. The set of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>, its <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a>, <em>their</em> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a>, and so on, is called the set of <dfn id="subtree"><a data-ref="subtree" data-preview-anchor="/g_trees/previews/subtree.html?def§subtree" data-hl="true" href="#subtree">subtrees</a></dfn> of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>. We say <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> is of <dfn id="tree_arity"><a data-ref="tree_arity" data-preview-anchor="/g_trees/previews/tree_arity.html?def§tree_arity" data-hl="true" href="#tree_arity">arity</a></dfn> <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> if all <a data-ref="subtree" data-preview-anchor="/g_trees/previews/subtree.html?def§subtree" data-hl="true" href="#subtree">subtrees</a> of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> have at most <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a>.</p><p>If <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> is a binary tree, we refer to its first child as its <dfn id="left"><a data-ref="left" data-preview-anchor="/g_trees/previews/left.html?def§left" data-hl="true" href="#left">left</a></dfn> child, and to its second child as its <dfn id="right"><a data-ref="right" data-preview-anchor="/g_trees/previews/right.html?def§right" data-hl="true" href="#right">right</a></dfn> child.</p><p>Let <span><span aria-hidden="true"><span><span></span><span id="item_lte"><span data-ref="item_lte" data-preview-anchor="/g_trees/previews/item_lte.html?def§item_lte" data-hl="true"><a href="#item_lte"><span>⪯</span></a></span></span></span></span></span> be a <a href="https://en.wikipedia.org/wiki/Total_order">total order</a> on <span><span aria-hidden="true"><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span>, and let <span><span aria-hidden="true"><span><span></span><span id="tree_c"><span data-ref="tree_c" data-preview-anchor="/g_trees/previews/tree_c.html?def§tree_c" data-hl="true"><a href="#tree_c"><span>c</span></a></span></span></span></span></span> be the number of <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a> of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span>. Then <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> is a <dfn id="search_tree"><a data-ref="search_tree" data-preview-anchor="/g_trees/previews/search_tree.html?def§search_tree" data-hl="true" href="#search_tree">search tree</a></dfn> <span>In a <a data-ref="search_tree" data-preview-anchor="/g_trees/previews/search_tree.html?def§search_tree" data-hl="true" href="#search_tree">search tree</a>, intuitively speaking, the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> are sorted from left to right. That is, an <a href="https://en.wikipedia.org/wiki/Tree_traversal#In-order,_LNR">in-order traversal</a> yields a sorted sequence.</span> (with respect to <span><span aria-hidden="true"><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span>) if it is the <a data-ref="tree_empty" data-preview-anchor="/g_trees/previews/tree_empty.html?def§tree_empty" data-hl="true" href="#tree_empty">empty tree</a>, or if</p><ul><li><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span> is sorted with respect to <span><span aria-hidden="true"><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span>,</li><li>all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>children</span><span>[</span><span><span aria-hidden="true"><span><span></span><span>0</span></span></span></span><span>]</span></span> are less than <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span><span>[</span><span><span aria-hidden="true"><span><span></span><span>0</span></span></span></span><span>]</span></span>,</li><li>for all <span><span aria-hidden="true"><span><span></span><span>0</span><span></span><span>&lt;</span><span></span></span><span><span></span><span id="searchtree_i"><span data-ref="searchtree_i" data-preview-anchor="/g_trees/previews/searchtree_i.html?def§searchtree_i" data-hl="true"><a href="#searchtree_i"><span>i</span><span></span></a></span></span><span>&lt;</span><span></span></span><span><span></span><span data-ref="tree_c" data-preview-anchor="/g_trees/previews/tree_c.html?def§tree_c" data-hl="true"><a href="#tree_c"><span>c</span><span></span></a></span><span>−</span><span></span></span><span><span></span><span>1</span><span><span><span>,</span></span></span></span></span></span> all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>children</span><span>[</span><span><span aria-hidden="true"><span><span></span><span data-ref="searchtree_i" data-preview-anchor="/g_trees/previews/searchtree_i.html?def§searchtree_i" data-hl="true"><a href="#searchtree_i"><span>i</span></a></span></span></span></span><span>]</span></span> are less than <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span><span>[</span><span><span aria-hidden="true"><span><span></span><span data-ref="searchtree_i" data-preview-anchor="/g_trees/previews/searchtree_i.html?def§searchtree_i" data-hl="true"><a href="#searchtree_i"><span>i</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span><span>]</span></span> and greater than <span><span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span><span>[</span><span><span aria-hidden="true"><span><span></span><span data-ref="searchtree_i" data-preview-anchor="/g_trees/previews/searchtree_i.html?def§searchtree_i" data-hl="true"><a href="#searchtree_i"><span>i</span><span></span></a></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span><span>]</span></span>,</span> and</li><li>all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>children</span><span>[</span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_c" data-preview-anchor="/g_trees/previews/tree_c.html?def§tree_c" data-hl="true"><a href="#tree_c"><span>c</span><span></span></a></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span><span>]</span></span> are greater than <span><span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span><span>[</span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_c" data-preview-anchor="/g_trees/previews/tree_c.html?def§tree_c" data-hl="true"><a href="#tree_c"><span>c</span><span></span></a></span><span>−</span><span></span></span><span><span></span><span>2</span></span></span></span><span>]</span></span>.</li></ul><p>We call <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> a <dfn id="heap"><a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heap</a></dfn><span>In a <a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heap</a>, intuitively speaking, no <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> is a descendant of a lesser item.</span> if it is the <a data-ref="tree_empty" data-preview-anchor="/g_trees/previews/tree_empty.html?def§tree_empty" data-hl="true" href="#tree_empty">empty tree</a>, or if</p><ul><li>the greatest <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> in all strict <a data-ref="subtree" data-preview-anchor="/g_trees/previews/subtree.html?def§subtree" data-hl="true" href="#subtree">subtrees</a> of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> is less than or equal to the least <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> amongst <span><span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span><span>.</span>items</span>, and</li><li>all <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a> of <span><span aria-hidden="true"><span><span></span><span data-ref="tree_t" data-preview-anchor="/g_trees/previews/tree_t.html?def§tree_t" data-hl="true"><a href="#tree_t"><span>t</span></a></span></span></span></span> are themselves <a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heaps</a>.</li></ul></section><h3 id="prelim_geometric_distribution"><a data-ref="prelim_geometric_distribution" data-hl="true" data-hsection-level="2" href="#prelim_geometric_distribution">3.2 Pseudorandom Geometric Distributions</a></h3><section data-hsection="prelim_geometric_distribution"><p>Let <span><span aria-hidden="true"><span><span></span><span id="geo_p"><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span></span> be a probability.<span>In plain language: take a coin that shows heads with probability <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span>. Flip until it shows heads. Count the total number of flips.</span> A <dfn id="geometric_distribution"><a data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a></dfn> <span><span aria-hidden="true"><span><span></span><span data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true"><a href="#geometric_distribution"><span>G</span></a></span><span>(</span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span><span>)</span></span></span></span> is a discrete probability distribution where the random variable <span><span aria-hidden="true"><span><span></span><span id="geo_x"><span data-ref="geo_x" data-preview-anchor="/g_trees/previews/geo_x.html?def§geo_x" data-hl="true"><a href="#geo_x"><span>X</span></a></span></span></span></span></span> takes on value <span><span aria-hidden="true"><span><span></span><span id="geo_k"><span data-ref="geo_k" data-preview-anchor="/g_trees/previews/geo_k.html?def§geo_k" data-hl="true"><a href="#geo_k"><span>k</span><span></span></a></span></span><span>∈</span><span></span></span><span><span></span><span><span>N</span><span><span><span><span><span><span></span><span><span><span>+</span></span></span></span></span></span></span></span></span></span></span></span> with probability <span><span aria-hidden="true"><span><span></span><span>P</span><span>(</span><span data-ref="geo_x" data-preview-anchor="/g_trees/previews/geo_x.html?def§geo_x" data-hl="true"><a href="#geo_x"><span>X</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span data-ref="geo_k" data-preview-anchor="/g_trees/previews/geo_k.html?def§geo_k" data-hl="true"><a href="#geo_k"><span>k</span></a></span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span><span></span></a></span><span>⋅</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span data-ref="geo_k" data-preview-anchor="/g_trees/previews/geo_k.html?def§geo_k" data-hl="true"><a href="#geo_k"><span>k</span></a></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span>. We can interpret <span><span aria-hidden="true"><span><span></span><span data-ref="geo_k" data-preview-anchor="/g_trees/previews/geo_k.html?def§geo_k" data-hl="true"><a href="#geo_k"><span>k</span></a></span></span></span></span> as the outcome of a series of Bernoulli trials with success probability <span><span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span>,</span> where the rank <span><span aria-hidden="true"><span><span></span><span data-ref="geo_k" data-preview-anchor="/g_trees/previews/geo_k.html?def§geo_k" data-hl="true"><a href="#geo_k"><span>k</span></a></span></span></span></span> represents the total number of trials until (and including) a first success. As is customary, we often write <span><span aria-hidden="true"><span><span></span><span id="geo_q"><span data-ref="geo_q" data-preview-anchor="/g_trees/previews/geo_q.html?def§geo_q" data-hl="true"><a href="#geo_q"><span>q</span><span></span></a></span></span><span>:=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span> for the failure probability of the Bernoulli trial.</p><p>The expected value of <span><span aria-hidden="true"><span><span></span><span data-ref="geo_x" data-preview-anchor="/g_trees/previews/geo_x.html?def§geo_x" data-hl="true"><a href="#geo_x"><span>X</span></a></span></span></span></span> is <span><span aria-hidden="true"><span><span></span><span id="geo_expected"><span data-ref="geo_expected" data-preview-anchor="/g_trees/previews/geo_expected.html?def§geo_expected" data-hl="true"><a href="#geo_expected"><span>E</span></a></span></span><span>[</span><span data-ref="geo_x" data-preview-anchor="/g_trees/previews/geo_x.html?def§geo_x" data-hl="true"><a href="#geo_x"><span>X</span></a></span><span>]</span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>1</span><span>−</span><span data-ref="geo_q" data-preview-anchor="/g_trees/previews/geo_q.html?def§geo_q" data-hl="true"><a href="#geo_q"><span>q</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span><span><a data-ref="forbes2011statistical" data-preview-anchor="/g_trees/previews/forbes2011statistical.html?def§forbes2011statistical" href="https://link.springer.com/book/10.1007/1-84628-168-7"><span></span> <span>(<span><span>Forbes</span> <span>et al.</span></span>, 2011)</span></a><span>1</span></span><span><span>1</span>Most people would actually look this up <a href="https://en.wikipedia.org/wiki/Geometric_distribution#Moments_and_cumulants">on Wikipedia</a> rather than in a textbook.</span>.</p><p>We often wish to pseudorandomly map items from some universe <span><span aria-hidden="true"><span><span></span><span id="geo_u"><span data-ref="geo_u" data-preview-anchor="/g_trees/previews/geo_u.html?def§geo_u" data-hl="true"><a href="#geo_u"><span>U</span></a></span></span></span></span></span> to geometrically distributed <dfn id="rank"><a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a></dfn>. To this end, we require a rank function <span><span aria-hidden="true"><span><span></span><span><span id="fn_rank"><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span></span><span><span><span><span><span><span></span><span><span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>:</span><span></span></span><span><span></span><span data-ref="geo_u" data-preview-anchor="/g_trees/previews/geo_u.html?def§geo_u" data-hl="true"><a href="#geo_u"><span>U</span><span></span></a></span><span>→</span><span></span></span><span><span></span><span>N</span></span></span></span>, such that <span><span aria-hidden="true"><span><span></span><span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="geo_arg_u" data-preview-anchor="/g_trees/previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span></a></span><span>)</span></span></span></span> for any <span><span aria-hidden="true"><span><span></span><span id="geo_arg_u"><span data-ref="geo_arg_u" data-preview-anchor="/g_trees/previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span><span></span></a></span></span><span>∈</span><span></span></span><span><span></span><span data-ref="geo_u" data-preview-anchor="/g_trees/previews/geo_u.html?def§geo_u" data-hl="true"><a href="#geo_u"><span>U</span></a></span></span></span></span> is drawn independently from a random geometric distribution <span><span aria-hidden="true"><span><span></span><span data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true"><a href="#geometric_distribution"><span>G</span></a></span><span>(</span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span><span>)</span></span></span></span>. We simply write <span><span aria-hidden="true"><span><span></span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span data-ref="geo_arg_u" data-preview-anchor="/g_trees/previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span></a></span><span>)</span></span></span></span> when <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span> is unimportant or clear from context.</p><p>In practice, <span><span aria-hidden="true"><span><span></span><span><span data-ref="fn_rank" data-preview-anchor="previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span><span><span><span><span><span></span><span><span><span>(</span><span>1/2</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="geo_arg_u" data-preview-anchor="previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span></a></span><span>)</span></span></span></span> can be implemented by hashing <span><span aria-hidden="true"><span><span></span><span data-ref="geo_arg_u" data-preview-anchor="previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span></a></span></span></span></span> with a secure hash function and counting the number of trailing zeros in the binary representation of the digest. This can also be interpreted as the largest power of two that divides the digest of <span><span aria-hidden="true"><span><span></span><span data-ref="geo_arg_u" data-preview-anchor="previews/geo_arg_u.html?def§geo_arg_u" data-hl="true"><a href="#geo_arg_u"><span>u</span></a></span></span></span></span>, as used by Pugh and Teitelbaum<a data-ref="pugh1989incremental" data-preview-anchor="previews/pugh1989incremental.html?def§pugh1989incremental" href="https://g-trees.github.io/g_trees/g_trees/assets/references/pugh1989incremental.pdf"><span></span> <span>(<span>Pugh</span> &amp; <span>Teitelbaum</span>, 1989)</span></a>. Auvolat and Taïani<a data-ref="auvolat2019merkle" data-preview-anchor="previews/auvolat2019merkle.html?def§auvolat2019merkle" href="https://g-trees.github.io/g_trees/g_trees/assets/references/auvolat2019merkle.pdf"><span></span> <span>(<span>Auvolat</span> &amp; <span>Taïani</span>, 2019)</span></a> generalize this construction to distributions <span><span aria-hidden="true"><span><span></span><span data-ref="geometric_distribution" data-preview-anchor="previews/geometric_distribution.html?def§geometric_distribution" data-hl="true"><a href="#geometric_distribution"><span>G</span></a></span><span>(</span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>2</span><span><span><span><span><span><span></span><span><span>k</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span> by counting trailing or leading zeroes in the base-<span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> representation of uniformly distributed pseudorandom integers. This is equivalent to counting all-zero groupings of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> successive digits in a binary representation.</p></section><h3 id="prelims_zip_trees"><a data-ref="prelims_zip_trees" data-hl="true" data-hsection-level="2" href="#prelims_zip_trees">3.3 Zip-Trees</a></h3><section data-hsection="prelims_zip_trees"><p>We can now give a formal definition of <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a><a data-ref="tarjan2021zip" data-preview-anchor="/g_trees/previews/tarjan2021zip.html?def§tarjan2021zip" href="https://g-trees.github.io/g_trees/assets/references/tarjan2021zip.pdf"><span></span> <span>(<span><span>Tarjan</span> <span>et al.</span></span>, 2021)</span></a>. Let <span><span aria-hidden="true"><span><span></span><span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span><span><span><span><span><span></span><span><span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> be a rank function. The <dfn id="zip_tree"><a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a></dfn> of some set <span><span aria-hidden="true"><span><span></span><span id="zip_s"><span data-ref="zip_s" data-preview-anchor="/g_trees/previews/zip_s.html?def§zip_s" data-hl="true"><a href="#zip_s"><span>S</span></a></span></span></span></span></span> is the unique <a data-ref="search_tree" data-preview-anchor="/g_trees/previews/search_tree.html?def§search_tree" data-hl="true" href="#search_tree">search tree</a> whose set of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> is <span><span aria-hidden="true"><span><span></span><span data-ref="zip_s" data-preview-anchor="/g_trees/previews/zip_s.html?def§zip_s" data-hl="true"><a href="#zip_s"><span>S</span></a></span></span></span></span>, and which is a <a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heap</a> when ordering by <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> first, <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> second. Equivalently, it must be a <a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heap</a> with respect to <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> such that <a data-ref="left" data-preview-anchor="/g_trees/previews/left.html?def§left" data-hl="true" href="#left">left</a> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a> always have strictly lesser <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> than their parents. <a data-ref="fig_ziptree_basic" data-preview-anchor="/g_trees/previews/fig_ziptree_basic.html?def§fig_ziptree_basic" href="#fig_ziptree_basic">Figure 2</a> gives an example.<span>The example tree is taken from a <a href="https://stackoverflow.com/questions/61944198/what-is-a-zip-tree-and-how-does-it-work">stackoverflow answer</a>, the interested reader can find there a detailed description of the isomorphism to <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> for that same example tree.</span></p><figure id="fig_ziptree_basic"><img alt="A rendering of a zip tree." src="https://g-trees.github.io/g_trees/assets/graphics/ziptreeBasic.svg"/><figcaption><p><a data-ref="fig_ziptree_basic" data-preview-anchor="/g_trees/previews/fig_ziptree_basic.html?def§fig_ziptree_basic" href="#fig_ziptree_basic">Figure 2</a>: A Zip-Tree</p><p><a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">Items</a> are the numbers in the vertices, <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> are the gray numbers above the vertices. <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">Items</a> are increasing from left to right (the tree is a <a data-ref="search_tree" data-preview-anchor="/g_trees/previews/search_tree.html?def§search_tree" data-hl="true" href="#search_tree">search tree</a> with respect to <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>), <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> are decreasing from top to bottom (the tree is a <a data-ref="heap" data-preview-anchor="/g_trees/previews/heap.html?def§heap" data-hl="true" href="#heap">heap</a> with respect to <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a>), and no <a data-ref="vertex" data-preview-anchor="/g_trees/previews/vertex.html?def§vertex" data-hl="true" href="#vertex">vertex</a> has a <a data-ref="left" data-preview-anchor="/g_trees/previews/left.html?def§left" data-hl="true" href="#left">left</a> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">child</a> of equal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> (yielding a unique tree shape).</p></figcaption></figure></section></section><h2 id="sec_gtrees"><a data-ref="sec_gtrees" data-hl="true" data-hsection-level="1" href="#sec_gtrees">4 G-Trees</a></h2><section data-hsection="sec_gtrees"><p>We derive our <a data-ref="gtree_informal" data-preview-anchor="previews/gtree_informal.html?def§gtree_informal" data-hl="true" href="#gtree_informal">G-trees</a> by generalizing <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>. To do so, we start with a non-standard definition of <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>:</p><figure id="zip_tree_recursive"><p>Define the <dfn id="partition"><a data-ref="partition" data-preview-anchor="/g_trees/previews/partition.html?def§partition" data-hl="true" href="#partition">partition item</a></dfn> of a set <span><span aria-hidden="true"><span><span></span><span id="partition_s"><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span><span></span></a></span></span><span>⊆</span><span></span></span><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span> as the least element of <span><span aria-hidden="true"><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span></a></span></span></span></span> among those of maximal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>. The <dfn id="zip_tree_rec"><a data-ref="zip_tree_rec" data-preview-anchor="/g_trees/previews/zip_tree_rec.html?def§zip_tree_rec" data-hl="true" href="#zip_tree_rec">zip-tree</a></dfn> of any set <span><span aria-hidden="true"><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span></a></span></span></span></span> with <a data-ref="partition" data-preview-anchor="/g_trees/previews/partition.html?def§partition" data-hl="true" href="#partition">partition item</a> <span><span aria-hidden="true"><span><span></span><span id="partition_p"><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span></span></span></span></span> is the binary <a data-ref="tree" data-preview-anchor="/g_trees/previews/tree.html?def§tree" data-hl="true" href="#tree">tree</a> whose <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> is <span><span aria-hidden="true"><span><span></span><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span></span></span></span>, whose <a data-ref="left" data-preview-anchor="/g_trees/previews/left.html?def§left" data-hl="true" href="#left">left</a> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">child</a> is the <a data-ref="zip_tree_rec" data-preview-anchor="/g_trees/previews/zip_tree_rec.html?def§zip_tree_rec" data-hl="true" href="#zip_tree_rec">zip-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span>s</span><span></span><span>≺</span><span></span></span><span><span></span><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span><span>}</span></span></span></span> (i.e., all items in <span><span aria-hidden="true"><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span></a></span></span></span></span> which precede <span><span aria-hidden="true"><span><span></span><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span></span></span></span>), and whose <a data-ref="right" data-preview-anchor="/g_trees/previews/right.html?def§right" data-hl="true" href="#right">right</a> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">child</a> is the <a data-ref="zip_tree_rec" data-preview-anchor="/g_trees/previews/zip_tree_rec.html?def§zip_tree_rec" data-hl="true" href="#zip_tree_rec">zip-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span>s</span><span></span><span>≻</span><span></span></span><span><span></span><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span><span>}</span></span></span></span> (i.e., all items in <span><span aria-hidden="true"><span><span></span><span data-ref="partition_s" data-preview-anchor="/g_trees/previews/partition_s.html?def§partition_s" data-hl="true"><a href="#partition_s"><span>S</span></a></span></span></span></span> which succeed <span><span aria-hidden="true"><span><span></span><span data-ref="partition_p" data-preview-anchor="/g_trees/previews/partition_p.html?def§partition_p" data-hl="true"><a href="#partition_p"><span>ρ</span></a></span></span></span></span>).</p><figcaption><p><a data-ref="zip_tree_recursive" data-preview-anchor="/g_trees/previews/zip_tree_recursive.html?def§zip_tree_recursive" href="#zip_tree_recursive">Definition 1</a>: Zip-Tree, Recursively</p></figcaption></figure><p>This recursive definition reveals an interesting property of zip trees: <dfn id="colliding"><a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a></dfn> ranks. From this definition, it is easy to see that the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of maximal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> form a linked list of <a data-ref="right" data-preview-anchor="/g_trees/previews/right.html?def§right" data-hl="true" href="#right">right</a> <a data-ref="child" data-preview-anchor="/g_trees/previews/child.html?def§child" data-hl="true" href="#child">children</a> at the root of the <a data-ref="zip_tree_rec" data-preview-anchor="/g_trees/previews/zip_tree_rec.html?def§zip_tree_rec" data-hl="true" href="#zip_tree_rec">zip-tree</a>. The same holds recursively in all <a data-ref="subtree" data-preview-anchor="/g_trees/previews/subtree.html?def§subtree" data-hl="true" href="#subtree">subtrees</a> as well. We can characterize these linked lists of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of equal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> as a sequence <span><span aria-hidden="true"><span><span></span><span id="colliding_q"><span data-ref="colliding_q" data-preview-anchor="/g_trees/previews/colliding_q.html?def§colliding_q" data-hl="true"><a href="#colliding_q"><span>Q</span><span></span></a></span></span><span>=</span><span></span></span><span><span></span><span id="colliding_q0"><span data-ref="colliding_q0" data-preview-anchor="/g_trees/previews/colliding_q0.html?def§colliding_q0" data-hl="true"><a href="#colliding_q0"><span><span>q</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span></a></span></span><span>≺</span><span></span></span><span><span></span><span id="colliding_q1"><span data-ref="colliding_q1" data-preview-anchor="/g_trees/previews/colliding_q1.html?def§colliding_q1" data-hl="true"><a href="#colliding_q1"><span><span>q</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span></a></span></span><span>≺</span><span></span></span><span><span></span><span>…</span><span></span><span id="colliding_qk"><span data-ref="colliding_qk" data-preview-anchor="/g_trees/previews/colliding_qk.html?def§colliding_qk" data-hl="true"><a href="#colliding_qk"><span><span>q</span><span><span><span><span><span><span></span><span><span>k</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span></span></span></span></span> of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> <a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> in a superset <span><span aria-hidden="true"><span><span></span><span id="colliding_s"><span data-ref="colliding_s" data-preview-anchor="/g_trees/previews/colliding_s.html?def§colliding_s" data-hl="true"><a href="#colliding_s"><span>S</span><span></span></a></span></span><span>⊇</span><span></span></span><span><span></span><span data-ref="colliding_q" data-preview-anchor="/g_trees/previews/colliding_q.html?def§colliding_q" data-hl="true"><a href="#colliding_q"><span>Q</span></a></span></span></span></span> if all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="colliding_q" data-preview-anchor="/g_trees/previews/colliding_q.html?def§colliding_q" data-hl="true"><a href="#colliding_q"><span>Q</span></a></span></span></span></span> have equal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>, and there is no <span><span aria-hidden="true"><span><span></span><span id="colliding_nope"><span data-ref="colliding_nope" data-preview-anchor="/g_trees/previews/colliding_nope.html?def§colliding_nope" data-hl="true"><a href="#colliding_nope"><span>s</span><span></span></a></span></span><span>∈</span><span></span></span><span><span></span><span data-ref="colliding_s" data-preview-anchor="/g_trees/previews/colliding_s.html?def§colliding_s" data-hl="true"><a href="#colliding_s"><span>S</span></a></span></span></span></span> of greater <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> such that <span><span aria-hidden="true"><span><span></span><span data-ref="colliding_q0" data-preview-anchor="/g_trees/previews/colliding_q0.html?def§colliding_q0" data-hl="true"><a href="#colliding_q0"><span><span>q</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span></a></span><span>≺</span><span></span></span><span><span></span><span data-ref="colliding_nope" data-preview-anchor="/g_trees/previews/colliding_nope.html?def§colliding_nope" data-hl="true"><a href="#colliding_nope"><span>s</span><span></span></a></span><span>≺</span><span></span></span><span><span></span><span data-ref="colliding_qk" data-preview-anchor="/g_trees/previews/colliding_qk.html?def§colliding_qk" data-hl="true"><a href="#colliding_qk"><span><span>q</span><span><span><span><span><span><span></span><span><span>k</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span><span><span><span>.</span></span></span></span></span></span> <a data-ref="fig_ziptree_colliding" data-preview-anchor="/g_trees/previews/fig_ziptree_colliding.html?def§fig_ziptree_colliding" href="#fig_ziptree_colliding">Figure 3</a> visualizes the linked lists formed by maximal sets of <a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in a <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a>.</p><figure id="fig_ziptree_colliding"><img alt="A rendering of a zip tree, highlighting maximal colliding sequences in different colors." src="https://g-trees.github.io/g_trees/assets/graphics/ziptreeColliding.svg"/><figcaption><p><a data-ref="fig_ziptree_colliding" data-preview-anchor="/g_trees/previews/fig_ziptree_colliding.html?def§fig_ziptree_colliding" href="#fig_ziptree_colliding">Figure 3</a>: Colliding Sequences</p><p>The same <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a> as in <a data-ref="fig_ziptree_basic" data-preview-anchor="/g_trees/previews/fig_ziptree_basic.html?def§fig_ziptree_basic" href="#fig_ziptree_basic">Figure 2</a>, highlighting linked lists of <a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> <span>three</span>, <span>two</span>, <span>two</span>, and <span>one</span>. All other <a data-ref="vertex" data-preview-anchor="/g_trees/previews/vertex.html?def§vertex" data-hl="true" href="#vertex">vertices</a> form <a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> sequences of length one.</p></figcaption></figure><p>We can even <em>define</em> <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> in terms of maximal <a data-ref="colliding" data-preview-anchor="previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> sequences, by using all <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> of maximal <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> as <a data-ref="partition" data-preview-anchor="previews/partition.html?def§partition" data-hl="true" href="#partition">partition items</a> in a single construction step:</p><figure id="zip_tree_colliding"><p>Let <span><span aria-hidden="true"><span><span></span><span id="zip_colliding_s"><span data-ref="zip_colliding_s" data-preview-anchor="/g_trees/previews/zip_colliding_s.html?def§zip_colliding_s" data-hl="true"><a href="#zip_colliding_s"><span>S</span><span></span></a></span></span><span>⊆</span><span></span></span><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span> be a set, and let <span><span aria-hidden="true"><span><span></span><span id="zip_colliding_m"><span data-ref="zip_colliding_m" data-preview-anchor="/g_trees/previews/zip_colliding_m.html?def§zip_colliding_m" data-hl="true"><a href="#zip_colliding_m"><span>M</span><span></span></a></span></span><span>=</span><span></span></span><span><span></span><span>(</span><span><span>m</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>∣</span><span data-ref="zip_colliding_m" data-preview-anchor="/g_trees/previews/zip_colliding_m.html?def§zip_colliding_m" data-hl="true"><a href="#zip_colliding_m"><span>M</span></a></span><span>∣</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> be the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of maximal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="zip_colliding_s" data-preview-anchor="/g_trees/previews/zip_colliding_s.html?def§zip_colliding_s" data-hl="true"><a href="#zip_colliding_s"><span>S</span></a></span></span></span></span>. The <dfn id="zip_tree_col"><a data-ref="zip_tree_col" data-preview-anchor="/g_trees/previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">zip-tree</a></dfn> of <span><span aria-hidden="true"><span><span></span><span data-ref="zip_colliding_s" data-preview-anchor="/g_trees/previews/zip_colliding_s.html?def§zip_colliding_s" data-hl="true"><a href="#zip_colliding_s"><span>S</span></a></span></span></span></span> is a pair, containing:</p><ul><li><span>To emphasize: the linked list is not a list of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> only, but a list of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a>-<a data-ref="zip_colliding_left_subtree" data-preview-anchor="/g_trees/previews/zip_colliding_left_subtree.html?def§zip_colliding_left_subtree" data-hl="true" href="#zip_colliding_left_subtree">subtree</a>-pairs.</span>a linked list of the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="zip_colliding_m" data-preview-anchor="/g_trees/previews/zip_colliding_m.html?def§zip_colliding_m" data-hl="true"><a href="#zip_colliding_m"><span>M</span></a></span></span></span></span> in ascending order, paired with their <a data-ref="zip_colliding_left_subtree" data-preview-anchor="/g_trees/previews/zip_colliding_left_subtree.html?def§zip_colliding_left_subtree" data-hl="true" href="#zip_colliding_left_subtree">left subtrees</a>, where the <dfn id="zip_colliding_left_subtree"><a data-ref="zip_colliding_left_subtree" data-preview-anchor="/g_trees/previews/zip_colliding_left_subtree.html?def§zip_colliding_left_subtree" data-hl="true" href="#zip_colliding_left_subtree">left subtree</a></dfn> of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> <span><span aria-hidden="true"><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the <a data-ref="zip_tree_col" data-preview-anchor="/g_trees/previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">zip-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="zip_colliding_s" data-preview-anchor="/g_trees/previews/zip_colliding_s.html?def§zip_colliding_s" data-hl="true"><a href="#zip_colliding_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>≻</span><span></span></span><span><span></span><span>s</span><span></span><span>≻</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>}</span></span></span></span>, and</li><li>a single <dfn id="zip_colliding_right_subtree"><a data-ref="zip_colliding_right_subtree" data-preview-anchor="/g_trees/previews/zip_colliding_right_subtree.html?def§zip_colliding_right_subtree" data-hl="true" href="#zip_colliding_right_subtree">right subtree</a></dfn>, which is the <a data-ref="zip_tree_col" data-preview-anchor="/g_trees/previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">zip-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="zip_colliding_s" data-preview-anchor="/g_trees/previews/zip_colliding_s.html?def§zip_colliding_s" data-hl="true"><a href="#zip_colliding_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>∣</span><span data-ref="zip_colliding_m" data-preview-anchor="/g_trees/previews/zip_colliding_m.html?def§zip_colliding_m" data-hl="true"><a href="#zip_colliding_m"><span>M</span></a></span><span>∣</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>≺</span><span></span></span><span><span></span><span>s</span><span>}</span></span></span></span>.</li></ul><figcaption><p><a data-ref="zip_tree_colliding" data-preview-anchor="/g_trees/previews/zip_tree_colliding.html?def§zip_tree_colliding" href="#zip_tree_colliding">Definition 2</a>: Zip-Tree, Via Colliding Sequences</p></figcaption></figure><p><a data-ref="fig_ziptree_lists" data-preview-anchor="previews/fig_ziptree_lists.html?def§fig_ziptree_lists" href="#fig_ziptree_lists">Figure 4</a> vizualizes this perspective on <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>. Note how the linked-list pointers are exactly the pointers between <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> of equal <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>, whereas both <a data-ref="zip_colliding_left_subtree" data-preview-anchor="previews/zip_colliding_left_subtree.html?def§zip_colliding_left_subtree" data-hl="true" href="#zip_colliding_left_subtree">left</a> and <a data-ref="zip_colliding_right_subtree" data-preview-anchor="previews/zip_colliding_right_subtree.html?def§zip_colliding_right_subtree" data-hl="true" href="#zip_colliding_right_subtree">right child</a> pointers always involve a strict decrease in <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>. In that sense, the <a data-ref="zip_tree_col" data-preview-anchor="previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">list-based definition</a> fixes an asymmetry of the <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">original definition</a>, which only requires strictly decreasing <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> for <a data-ref="left" data-preview-anchor="previews/left.html?def§left" data-hl="true" href="#left">left</a> <a data-ref="child" data-preview-anchor="previews/child.html?def§child" data-hl="true" href="#child">children</a>.</p><figure id="fig_ziptree_lists"><img alt="A rendering of a zip tree as a collection of maximal colliding lists." src="https://g-trees.github.io/g_trees/assets/graphics/ziptreeOfLists.svg"/><figcaption><p><a data-ref="fig_ziptree_lists" data-preview-anchor="/g_trees/previews/fig_ziptree_lists.html?def§fig_ziptree_lists" href="#fig_ziptree_lists">Figure 4</a>: Zip-Trees as Lists</p><p>A <a data-ref="zip_tree_col" data-preview-anchor="/g_trees/previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">zip-tree</a>, interpreted as a collection of sorted linked lists. Linked list pointers are <span>dashed</span>, child pointers are solid. The colorless vertices are linked lists of length one. The three layers of the layout correspond to the three different <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a>. Note that the graph is isomorphic to that of <a data-ref="fig_ziptree_colliding" data-preview-anchor="/g_trees/previews/fig_ziptree_colliding.html?def§fig_ziptree_colliding" href="#fig_ziptree_colliding">Figure 3</a>, we simply interpret its structure in a different way.</p></figcaption></figure><p>From this non-standard characterization of <a data-ref="zip_tree_col" data-preview-anchor="previews/zip_tree_col.html?def§zip_tree_col" data-hl="true" href="#zip_tree_col">zip-trees</a>, there is a natural generalization: rather than representing maximal sequences of <a data-ref="colliding" data-preview-anchor="previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> (and the <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a>’ <a data-ref="zip_colliding_left_subtree" data-preview-anchor="previews/zip_colliding_left_subtree.html?def§zip_colliding_left_subtree" data-hl="true" href="#zip_colliding_left_subtree">left subtrees</a>) with sorted linked lists, we can represent them with arbitrary set data structures:</p><figure id="def_gtree"><p>Let <span><span aria-hidden="true"><span><span></span><span id="gtree_s"><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span><span></span></a></span></span><span>⊆</span><span></span></span><span><span></span><span data-ref="tree_u" data-preview-anchor="/g_trees/previews/tree_u.html?def§tree_u" data-hl="true"><a href="#tree_u"><span>U</span></a></span></span></span></span> be a set, and let <span><span aria-hidden="true"><span><span></span><span id="gtree_m"><span data-ref="gtree_m" data-preview-anchor="/g_trees/previews/gtree_m.html?def§gtree_m" data-hl="true"><a href="#gtree_m"><span>M</span><span></span></a></span></span><span>=</span><span></span></span><span><span></span><span>(</span><span><span>m</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>∣</span><span data-ref="gtree_m" data-preview-anchor="/g_trees/previews/gtree_m.html?def§gtree_m" data-hl="true"><a href="#gtree_m"><span>M</span></a></span><span>∣</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span> be the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of maximal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span></a></span></span></span></span>, and let <span><span aria-hidden="true"><span><span></span><span id="gtree_g"><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span></span> be a data structure for representing sets. The <dfn id="gtree"><a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">geometric search tree</a></dfn> (<dfn id="gtree"><a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a></dfn>) of <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span></a></span></span></span></span> using <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> is a pair, containing:</p><ul><li><span>To emphasize: <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> does not store <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> only, but <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a>-<a data-ref="gtree_left_subtree" data-preview-anchor="/g_trees/previews/gtree_left_subtree.html?def§gtree_left_subtree" data-hl="true" href="#gtree_left_subtree">subtree</a>-pairs.</span>an instance of <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> storing the <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_m" data-preview-anchor="/g_trees/previews/gtree_m.html?def§gtree_m" data-hl="true"><a href="#gtree_m"><span>M</span></a></span></span></span></span> in ascending order, paired with their <a data-ref="gtree_left_subtree" data-preview-anchor="/g_trees/previews/gtree_left_subtree.html?def§gtree_left_subtree" data-hl="true" href="#gtree_left_subtree">left subtrees</a>, where the <dfn id="gtree_left_subtree"><a data-ref="gtree_left_subtree" data-preview-anchor="/g_trees/previews/gtree_left_subtree.html?def§gtree_left_subtree" data-hl="true" href="#gtree_left_subtree">left subtree</a></dfn> of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> <span><span aria-hidden="true"><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>≻</span><span></span></span><span><span></span><span>s</span><span></span><span>≻</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>}</span></span></span></span>, and</li><li>a single <dfn id="gtree_right_subtree"><a data-ref="gtree_right_subtree" data-preview-anchor="/g_trees/previews/gtree_right_subtree.html?def§gtree_right_subtree" data-hl="true" href="#gtree_right_subtree">right subtree</a></dfn>, which is the <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> of <span><span aria-hidden="true"><span><span></span><span>{</span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span><span></span></a></span><span>:</span><span></span></span><span><span></span><span><span>m</span><span><span><span><span><span><span></span><span><span><span>∣</span><span data-ref="gtree_m" data-preview-anchor="/g_trees/previews/gtree_m.html?def§gtree_m" data-hl="true"><a href="#gtree_m"><span>M</span></a></span><span>∣</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>≺</span><span></span></span><span><span></span><span>s</span><span>}</span></span></span></span>.</li></ul><figcaption><p><a data-ref="def_gtree" data-preview-anchor="/g_trees/previews/def_gtree.html?def§def_gtree" href="#def_gtree">Definition 3</a>: Geometric Search Tree</p></figcaption></figure><p>This generalization turns out to be remarkably powerful. We can express several well-known data structures as <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> (<a data-hsection-level="2" data-ref="old_gtrees" data-hl="true" href="#old_gtrees">Section 4.2</a>), we find novel, cache-efficient data structures amongst the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> (<a data-hsection-level="2" data-ref="new_gtrees" data-hl="true" href="#new_gtrees">Section 4.3</a>), and we can derive efficient implementation techniques for all of them (<a data-hsection-level="1" data-ref="implementation" data-hl="true" href="#implementation">Section 5</a>).</p><p>We can regard any <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> from two perspectives. First, as a high-level tree of maximal <a data-ref="colliding" data-preview-anchor="/g_trees/previews/colliding.html?def§colliding" data-hl="true" href="#colliding">colliding</a> sequences. We refer to the nodes of this conceptual tree as <dfn id="gnode"><a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a></dfn>. The height of this tree is equal to the number of distinct ranks of the underlying set, which is in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span>(</span><span>n</span><span>))</span></span></span></span> with high probability (we give an analysis in <a data-hsection-level="2" data-ref="analysis" data-hl="true" href="#analysis">Section 4.1</a>). <a data-ref="fig_gnodes" data-preview-anchor="/g_trees/previews/fig_gnodes.html?def§fig_gnodes" href="#fig_gnodes">Figure 5</a> visualizes our running example from this perspective.</p><p>And second, given a specific set data structure <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span>, we can study the resulting in-memory graphs with pointers as edges. If <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> is the type of sorted linked lists, for example, these concrete graphs are isomorphic to the <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> (compare <a data-ref="fig_ziptree_lists" data-preview-anchor="/g_trees/previews/fig_ziptree_lists.html?def§fig_ziptree_lists" href="#fig_ziptree_lists">Figure 4</a>, which we can interpret as depicting a <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> using sorted linked lists).</p><figure id="fig_gnodes"><img alt="A rendering of a G-tree, collapsing each G-node into a single vertex." src="https://g-trees.github.io/g_trees/assets/graphics/gtree.svg"/><figcaption><p><a data-ref="fig_gnodes" data-preview-anchor="/g_trees/previews/fig_gnodes.html?def§fig_gnodes" href="#fig_gnodes">Figure 5</a>: High-Level View — G-Nodes</p><p>A <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> from a high-level view: we disregard the internal structure of its <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>, rendering them as single vertices. We neither know nor care about the choice of <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="/g_trees/previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span>. The set of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> is identical to that of <a data-ref="fig_ziptree_lists" data-preview-anchor="/g_trees/previews/fig_ziptree_lists.html?def§fig_ziptree_lists" href="#fig_ziptree_lists">Figure 4</a>.</p></figcaption></figure><p>When we select the <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of each <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> as a pseudorandom function of the <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> itself, a tree of <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> is uniquely determined by the set of its <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a>. Hence, if <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> is <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a>, so is the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a>.</p><p>When interpreted as trees of <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>, the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> are exactly the <a data-ref="dense_skip_tree" data-preview-anchor="previews/dense_skip_tree.html?def§dense_skip_tree" data-hl="true" href="#dense_skip_tree">dense skip-trees</a> of Spiegel and Reynolds Jr<a data-ref="spiegel2009dense" data-preview-anchor="previews/spiegel2009dense.html?def§spiegel2009dense" href="https://g-trees.github.io/g_trees/g_trees/assets/references/spiegel2009dense.pdf"><span></span> <span>(<span>Spiegel</span> &amp; <span>Reynolds Jr</span>, 2009)</span></a>. Spiegel and Reynolds Jr never consider the internal structure of the <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>, however, thus missing the instantiations that we discuss later.</p><h3 id="analysis"><a data-ref="analysis" data-hl="true" data-hsection-level="2" href="#analysis">4.1 Analysis</a></h3><section data-hsection="analysis"><p><span>The math-averse reader can safely skip ahead to <a data-hsection-level="2" data-ref="old_gtrees" data-hl="true" href="#old_gtrees">Section 4.2</a>, as long as they believe us when we say that <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> form trees of logarithmic height with high probability, and that each <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> contains <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>1</span><span>)</span></span></span></span> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> with high probability.</span>We now give a formal analysis of the performance-related properties of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>. Roughly speaking, we show that <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with a <a data-ref="geometric_distribution" data-preview-anchor="previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> of some probability <span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> are similar to perfectly balanced <span><span aria-hidden="true"><span><span></span><span>k</span><span><span><span>-ary</span></span></span></span></span></span> trees with high probability: the height (in terms of <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>) stays within a constant factor of <span><span aria-hidden="true"><span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span>k</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span>n</span><span>)</span></span></span></span>, and the maximal number of <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> per <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> stays within a constant factor of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>.</p><p>Throughout our analyses, we let <span><span aria-hidden="true"><span><span></span><span id="ana_k"><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span> be a natural number greater than or equal to two; <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span> is the intended average number of children per <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> (leaving us with an intended average of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span><span></span></a></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> per <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a>). We let <span><span aria-hidden="true"><span><span></span><span id="ana_T"><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span></span></span></span></span> be a <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> of <span><span aria-hidden="true"><span><span></span><span id="ana_n"><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span></span> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>. We then consider <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> for the <a data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> <span><span aria-hidden="true"><span><span></span><span data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true"><a href="#geometric_distribution"><span>G</span></a></span><span>(</span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span><span>)</span></span></span></span> with <span><span aria-hidden="true"><span><span></span><span id="ana_p"><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span><span></span></a></span></span><span>:=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span>, and set <span><span aria-hidden="true"><span><span></span><span id="ana_q"><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span><span></span></a></span></span><span>:=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span><span>,</span></span></span></span></span></span> as this will yield the intended average <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> size.</p><h4 id="gtree_height"><a data-ref="gtree_height" data-hl="true" data-hsection-level="3" href="#gtree_height">4.1.1 G-Tree Height</a></h4><section data-hsection="gtree_height"><p>The <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of any <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> is a geometric random variable with parameter <span><span aria-hidden="true"><span><span></span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span>. The height of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span></span></span></span> is upper-bounded by the <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of its root node, since each child has a strictly lesser <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> than its parent.</p><p>The root rank, <span><span aria-hidden="true"><span><span></span><span id="ana_Mn"><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span></span></span></span></span> is the maximum of the <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> of all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in <span><span aria-hidden="true"><span><span></span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span></span></span></span>, i.e., it is the maximum of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> independent samples of the <a data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> <span><span aria-hidden="true"><span><span></span><span data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true"><a href="#geometric_distribution"><span>G</span></a></span><span>(</span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span><span>)</span></span></span></span>. While it is known that the expected value of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span></span></span></span> is roughly <span><span aria-hidden="true"><span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span><span></span><span>+</span><span></span></span><span><span></span><span>O</span><span>(</span><span>1</span><span>)</span></span></span></span>, there is no simple closed form expression <a data-ref="szpankowski1990yeteisenberg2008expectation" data-preview-anchor="/g_trees/previews/szpankowski1990yeteisenberg2008expectation.html?def§szpankowski1990yeteisenberg2008expectation" href="https://g-trees.github.io/g_trees/assets/references/szpankowski1990yet.pdf"><span></span> <span>(<span>Eisenberg</span>, 2008; <span>Szpankowski</span> &amp; <span>Rego</span>, 1990)</span></a>.</p><p>To explicitly bound <span><span aria-hidden="true"><span><span></span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span></span></span></span>, fix any <span><span aria-hidden="true"><span><span></span><span id="ana_r"><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span></span><span>≤</span><span></span></span><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span><span><span>.</span></span></span></span></span></span> Then, the probability that the <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of a <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> <span><span aria-hidden="true"><span><span></span><span id="ana_g"><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span></span></span></span></span> is at least <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is at most <span><span aria-hidden="true"><span><span></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span>, i.e., <span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>)</span><span></span><span>≥</span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span><span><span>.</span></span></span></span></span></span> By the union bound, the probability that there exists <em>some</em> <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> such that <span><span aria-hidden="true"><span><span></span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>)</span><span></span><span>≥</span><span></span></span><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is <span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span>∃</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>,</span><span></span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>)</span><span></span><span>≥</span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span><span><span>,</span></span></span></span></span></span> and so for some positive constant <span><span aria-hidden="true"><span><span></span><span>c</span></span></span></span>, <span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span></a></span><span>≥</span><span></span><span>(</span><span>c</span><span></span><span>+</span><span></span><span>1</span><span>)</span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span><span><span><span><span></span><span><span><span>−</span><span>c</span></span></span></span></span></span></span></span></span></span></span></span><a data-ref="golovin2010b" data-preview-anchor="/g_trees/previews/golovin2010b.html?def§golovin2010b" href="https://g-trees.github.io/g_trees/assets/references/golovin2010b.pdf"><span></span> <span>(<span>Golovin</span>, 2010)</span></a>.</p><p>Even for <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>&gt;</span><span></span></span><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span></span></span></span>, the tail probability contribution is relatively small; we can estimate it by simplifying the geometric series:<span><span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>=</span><span>⌈</span><span><span><span>l</span><span>o</span><span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span>+</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span><span><span><span><span><span><span></span><span><span><span>⌈</span><span><span><span>l</span><span>o</span><span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span></span></span></span></span></span></span></span></span><span></span><span>≤</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span><span><span><span><span><span><span></span><span><span><span><span><span>l</span><span>o</span><span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span data-ref="ana_p" data-preview-anchor="/g_trees/previews/ana_p.html?def§ana_p" data-hl="true"><a href="#ana_p"><span>p</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span><span>.</span></span></span></span></span>Hence, <span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span><span>)</span></span><span></span><span>≈</span><span></span></span><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span><span><span>,</span></span></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span><span>)</span></span></span></span></span> is at most <span><span aria-hidden="true"><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span></span><span>+</span><span></span></span><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>, with high probability.</p><p>By construction, the <span><span aria-hidden="true"><span><span></span><span id="height_fn"><span data-ref="height_fn" data-preview-anchor="/g_trees/previews/height_fn.html?def§height_fn" data-hl="true"><a href="#height_fn"><span><span>height</span></span></a></span></span><span>(</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>)</span></span></span></span> of a geometric tree is less than or equal to its maximum rank <span><span aria-hidden="true"><span><span></span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span></span></span></span>. Like zip trees, geometric trees <em>compress</em> their depth where <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> are missing or skipped;<span>While we don&#39;t bother with tight bounds on this compressed height, <a data-ref="archibald2006number" data-preview-anchor="/g_trees/previews/archibald2006number.html?def§archibald2006number" href="https://g-trees.github.io/g_trees/assets/references/archibald2006number.pdf"><span></span> <span>(<span><span>Archibald</span> <span>et al.</span></span>, 2006)</span></a> provides an expectation on the number of <em>distinct</em> <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> in a geometrically distributed random sample, which could provide slightly tighter bounds.</span> as such, <span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span data-ref="height_fn" data-preview-anchor="/g_trees/previews/height_fn.html?def§height_fn" data-hl="true"><a href="#height_fn"><span><span>height</span></span></a></span><span>(</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>)</span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span>E</span><span></span><span><span>(</span><span data-ref="ana_Mn" data-preview-anchor="/g_trees/previews/ana_Mn.html?def§ana_Mn" data-hl="true"><a href="#ana_Mn"><span><span>M</span><span><span><span><span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span></span><span>+</span><span></span></span><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. Thus we have that the height of a geometric tree is in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span></span></span></span> with high probability. <a data-ref="fig_stats_gheight" data-preview-anchor="/g_trees/previews/fig_stats_gheight.html?def§fig_stats_gheight" href="#fig_stats_gheight">Figure 6</a> confirms our analysis with experimental data.</p><figure id="fig_stats_gheight"><h6>Maximum Rank</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>2</span></span></span></span></th><td>8.0 (3.48)</td><td>11.3 (4.00)</td><td>14.7 (3.88)</td><td>17.9 (3.27)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>4</span></span></span></span></th><td>4.2 (0.90)</td><td>5.9 (0.98)</td><td>7.5 (0.86)</td><td>9.2 (0.92)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>16</span></span></span></span></th><td>2.4 (0.30)</td><td>3.2 (0.21)</td><td>4.1 (0.25)</td><td>4.9 (0.29)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>64</span></span></span></span></th><td>1.8 (0.19)</td><td>2.2 (0.19)</td><td>3.0 (0.12)</td><td>3.35 (0.24)</td></tr></tbody></table><h6>Height</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>2</span></span></span></span></th><td>6.7 (0.75)</td><td>9.9 (0.75)</td><td>13.2 (0.72)</td><td>16.7 (0.73)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>4</span></span></span></span></th><td>4.0 (0.51)</td><td>5.6 (0.51)</td><td>7.3 (0.44)</td><td>9.0 (0.47)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>16</span></span></span></span></th><td>2.3 (0.24)</td><td>3.2 (0.18)</td><td>4.1 (0.25)</td><td>4.9 (0.24)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>64</span></span></span></span></th><td>1.8 (0.18)</td><td>2.2 (0.17)</td><td>3.0 (0.11)</td><td>3.3 (0.23)</td></tr></tbody></table><figcaption><p><a data-ref="fig_stats_gheight" data-preview-anchor="/g_trees/previews/fig_stats_gheight.html?def§fig_stats_gheight" href="#fig_stats_gheight">Figure 6</a>: G-Tree Maximum Ranks</p><p>Average maximal ranks and heights (in <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>) of 200 randomly generated <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, for various combinations of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. The numbers in parentheses give the <a href="https://en.wikipedia.org/wiki/Variance">variance</a>.</p></figcaption></figure></section><h4 id="gtree_node_size"><a data-ref="gtree_node_size" data-hl="true" data-hsection-level="3" href="#gtree_node_size">4.1.2 G-Node Size</a></h4><section data-hsection="gtree_node_size"><p>Given the geometric distribution of (independent) <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> over input values <span><span aria-hidden="true"><span><span></span><span>s</span><span></span><span>∈</span><span></span></span><span><span></span><span data-ref="gtree_s" data-preview-anchor="/g_trees/previews/gtree_s.html?def§gtree_s" data-hl="true"><a href="#gtree_s"><span>S</span></a></span></span></span></span>, the expected number of values with <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is about <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span> times the expected number of values with <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>, i.e., <span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span>s</span><span>)</span><span></span><span>&gt;</span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>∣</span><span data-ref="fn_rank" data-preview-anchor="/g_trees/previews/fn_rank.html?def§fn_rank" data-hl="true"><a href="#fn_rank"><span><span>rank</span></span></a></span><span>(</span><span>s</span><span>)</span><span></span><span>≥</span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span>. Recall that each <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> in a geometric tree contains a set of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> with the same <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>, and that the <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of the <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> is the maximum <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of its <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>. Thus, we can think of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> within <span><span aria-hidden="true"><span><span></span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span></span></span></span> as disjoint subsets formed by splitting the (sorted) items of <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> at values of <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>. In other words, the number of nodes with a given <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is a direct function of the number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> with <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>.</p><p>The above node layout implies that the size <span><span aria-hidden="true"><span><span></span><span>∣</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>∣</span></span></span></span> of a <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> is itself a random variable drawn from a geometric distribution, this time with <em>success</em> probability <span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> and support <span><span aria-hidden="true"><span><span></span><span>[</span><span>n</span><span>]</span><span></span><span>=</span><span></span></span><span><span></span><span>{</span><span>1</span><span>,</span><span></span><span>…</span><span></span><span>,</span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>}</span></span></span></span>. The expected value is roughly <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>, and the observed size is at most <span><span aria-hidden="true"><span><span></span><span>c</span></span></span></span> times the expected value with probability at least <span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>c</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span></span></span></span></span></span></span></span>. In other words, <span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>∣</span><span></span><span>≥</span><span></span><span>c</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>c</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span></span></span></span></span></span></span></span>. Setting <span><span aria-hidden="true"><span><span></span><span>c</span><span></span><span>=</span><span></span></span><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span></span></span></span>, and using <span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>≤</span><span></span></span><span><span></span><span>exp</span><span></span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span></span></span></span>, we have that<span><span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span>P</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_g" data-preview-anchor="/g_trees/previews/ana_g.html?def§ana_g" data-hl="true"><a href="#ana_g"><span>g</span></a></span><span>∣</span><span></span><span>≥</span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span><span>)</span></span></span></span><span><span></span><span><span> </span></span></span><span><span></span><span><span> </span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>≤</span><span></span><span><span><span><span>(</span></span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span><span></span><span><span><span>⌈</span><span><span><span>l</span><span>o</span><span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span></span><span></span><span>≤</span><span></span><span>exp</span><span></span><span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span><span></span><span><span><span>⌈</span><span><span><span>l</span><span>o</span><span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>exp</span><span></span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span><span><span>)</span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span>which for large <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span>, where <span><span aria-hidden="true"><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)⌉</span><span></span><span>≈</span><span></span></span><span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span></span></span></span>, we get<span><span><span aria-hidden="true"><span><span></span><span>exp</span><span></span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span><span><span>)</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>exp</span><span></span><span><span>(</span><span>−</span><span></span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span></span>This bound demonstrates that the probability that the size of any <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> deviates from <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span> decreases exponentially with <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span>.</p><p><a data-ref="fig_stats_gnode_size" data-preview-anchor="previews/fig_stats_gnode_size.html?def§fig_stats_gnode_size" href="#fig_stats_gnode_size">Figure 7</a> shows experimental measurements of average <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> sizes. For low <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span>, nodes contain slightly too few items: items are spread-out, and there are not enough items to “fill up” all nodes. The variances are small; average <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> sizes are indeed as stable as our analysis suggests.</p><figure id="fig_stats_gnode_size"><h6>Average G-Node Size</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>2</span></span></span></span></th><td>1.9095 (0.0000334)</td><td>1.9940 (0.0000162)</td><td>1.9983 (0.0000006)</td><td>1.9998 (0.0000000)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>4</span></span></span></span></th><td>3.6374 (0.0000063)</td><td>3.9516 (0.0000036)</td><td>3.9942 (0.0000012)</td><td>4.0002 (0.0000008)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>16</span></span></span></span></th><td>12.1596 (0.0257947)</td><td>15.2423 (0.0011409)</td><td>15.9084 (0.0001009)</td><td>15.9850 (0.0000016)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>64</span></span></span></span></th><td>30.6534 (0.0817688)</td><td>56.3768 (0.0023357)</td><td>62.6815 (0.0219051)</td><td>63.7859 (0.0235732)</td></tr></tbody></table><figcaption><p><a data-ref="fig_stats_gnode_size" data-preview-anchor="/g_trees/previews/fig_stats_gnode_size.html?def§fig_stats_gnode_size" href="#fig_stats_gnode_size">Figure 7</a>: G-Node Average Sizes</p><p>Average <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> sizes of 200 randomly generated <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, for various combinations of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. The numbers in parentheses give the <a href="https://en.wikipedia.org/wiki/Variance">variance</a>.</p></figcaption></figure></section><h4 id="gtree_size"><a data-ref="gtree_size" data-hl="true" data-hsection-level="3" href="#gtree_size">4.1.3 G-Tree Size</a></h4><section data-hsection="gtree_size"><p>The total expected number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> in a <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> is intuitively <span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>∣</span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>. Given that <span><span aria-hidden="true"><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> this can also be expressed as <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>. While this expectation is intuitive, it can be estimated more directly as the sum of the expected number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> at every possible <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> (plus a root node). Since the number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> at <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is equal to the number of <em><a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a></em> having <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>, and since the <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> assignments for <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> are independent, the number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> with <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> in a <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> can be modeled as a binomial random variable <dfn id="ana_Xr"><a data-ref="ana_Xr" data-preview-anchor="/g_trees/previews/ana_Xr.html?def§ana_Xr" data-hl="true" href="#ana_Xr"><span><span aria-hidden="true"><span><span></span><span><span>X</span><span><span><span><span><span><span></span><span><span>r</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></a></dfn>, with parameters <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> (the number of trials, i.e., the number of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>) and <span><span aria-hidden="true"><span><span></span><span>p</span><span></span><span>=</span><span></span></span><span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span></span></span></span></span></span></span></span></span> (the probability of success, i.e., the probability that a <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> has <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>).<span>To see why, consider that a binomial random variable describes the number of successes in a fixed number of independent trials, where each trial has the same probability of success. Here each <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> is an independent trial, the “success” is the event that a <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> has <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span>, and the probability of success is <span><span aria-hidden="true"><span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span></span></span></span></span></span></span></span></span>.</span> Thus, the expected number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> at <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span> is <span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span data-ref="ana_Xr" data-preview-anchor="/g_trees/previews/ana_Xr.html?def§ana_Xr" data-hl="true"><a href="#ana_Xr"><span><span>X</span><span><span><span><span><span><span></span><span><span>r</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></a></span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span></span></span></span></span></span></span></span></span>, and by the linearity of expectation, the total expected number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> in a <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> is a geometric series with sum<span><span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>∣</span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span>n</span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>1</span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_r" data-preview-anchor="/g_trees/previews/ana_r.html?def§ana_r" data-hl="true"><a href="#ana_r"><span>r</span></a></span></span></span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span></span>and recognizing that for <span><span aria-hidden="true"><span><span></span><span>∣</span><span>q</span><span>∣</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>1</span></span></span></span> the rightmost infinite sum simplifies to <span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>1</span><span>−</span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span>, we get<span><span><span aria-hidden="true"><span><span></span><span>E</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>∣</span><span>)</span></span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>(</span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>1</span><span></span><span>=</span><span></span></span><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span><span></span></a></span><span>+</span><span></span></span><span><span></span><span>1</span><span><span><span>.</span></span></span></span></span></span></span>To provide bounds, we can use the usual multiplicative form of a Chernoff bound for the sum of independent (but not identically distributed) Bernoulli random variables<span><a data-ref="dubhashiChernoff2009" data-preview-anchor="/g_trees/previews/dubhashiChernoff2009.html?def§dubhashiChernoff2009" href="https://doi.org/10.1017/CBO9780511581274"><span></span> <span>(<span>Dubhashi</span> &amp; <span>Panconesi</span>, 2009)</span></a><span>2</span></span><span><span>2</span>Again, you&#39;ll probably want to look this up <a href="https://en.wikipedia.org/wiki/Chernoff_bound#Multiplicative_form_(relative_error)">on Wikipedia</a> rather than in a textbook.</span>. Then, for any <span><span aria-hidden="true"><span><span></span><span>c</span><span></span><span>&gt;</span><span></span></span><span><span></span><span>0</span></span></span></span><span><span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span>(</span><span>∣</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>∣</span><span></span><span>≥</span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span><span>c</span><span>)</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span><span>)</span></span><span></span><span>≤</span><span></span></span><span><span></span><span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>(</span><span>1</span><span></span><span>+</span><span></span><span>c</span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>1</span><span>+</span><span>c</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>c</span></span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span>or perhaps more conveniently, for <span><span aria-hidden="true"><span><span></span><span>0</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>c</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>1</span></span></span></span> and recalling that <span><span aria-hidden="true"><span><span></span><span data-ref="ana_q" data-preview-anchor="/g_trees/previews/ana_q.html?def§ana_q" data-hl="true"><a href="#ana_q"><span>q</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span>,<span><span><span aria-hidden="true"><span><span></span><span>P</span><span></span><span><span><span>(</span></span><span>∣</span><span data-ref="ana_T" data-preview-anchor="/g_trees/previews/ana_T.html?def§ana_T" data-hl="true"><a href="#ana_T"><span>T</span></a></span><span>∣</span><span></span><span>&gt;</span><span></span><span>(</span><span>1</span><span></span><span>+</span><span></span><span>c</span><span>)</span><span><span></span><span><span><span><span><span><span></span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>≤</span><span></span></span><span><span></span><span>exp</span><span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>3</span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span><span><span></span><span></span></span><span><span></span><span><span>−</span><span><span>c</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span><span><span>.</span></span></span></span></span></span></span>This provides an exponentially small probability that the total number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> in a geometric tree is much more than <span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>, and thus the <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> size is in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span><span>)</span></span></span></span>. <a data-ref="fig_stats_gnode_count" data-preview-anchor="/g_trees/previews/fig_stats_gnode_count.html?def§fig_stats_gnode_count" href="#fig_stats_gnode_count">Figure 8</a> gives experimental measurements that confirm the analysis.</p><figure id="fig_stats_gnode_count"><h6>Average Number of G-Nodes</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>2</span></span></span></span></th><td>52.21 (25.081)</td><td>502.5 (257.2)</td><td>5002 (2394.5)</td><td>50001 (26339)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>4</span></span></span></span></th><td>27.51 (19.086)</td><td>252.9 (191.70)</td><td>2504 (1826.1)</td><td>25004 (18939)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>16</span></span></span></span></th><td>8.33 (6.716)</td><td>65.46 (57.22)</td><td>628.2 (572.4)</td><td>6255.3 (6113.3)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>64</span></span></span></span></th><td>3.29 (2.213)</td><td>17.75 (15.25)</td><td>159.16 (160.2)</td><td>1564 (1486.8)</td></tr></tbody></table><figcaption><p><a data-ref="fig_stats_gnode_count" data-preview-anchor="/g_trees/previews/fig_stats_gnode_count.html?def§fig_stats_gnode_count" href="#fig_stats_gnode_count">Figure 8</a>: G-Node Counts</p><p>Average number of <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> in 200 randomly generated <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, for various combinations of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. The numbers in parentheses give the <a href="https://en.wikipedia.org/wiki/Variance">variance</a>.</p></figcaption></figure><p>This analysis provides some intuition for the practical efficiency and scalability of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>: the expected number of <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> is linear in the number of <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a>, and is very close to a balanced tree structure. By understanding the total number of nodes and their size distribution, we can optimize and parameterize <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> to minimize disk accesses, align nodes with disk block sizes, and design effective caching and buffer management strategies. This ensures that the tree operations are performed with high I/O efficiency, reducing latency and increasing throughput. Moreover, it helps in predicting performance, identifying bottlenecks, and managing storage costs by ensuring efficient space allocation and utilization. Combined with the fixed size of the <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> (see <a data-hsection-level="2" data-ref="new_gtrees" data-hl="true" href="#new_gtrees">Section 4.3</a>) this makes <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> potentially well-suited for external memory models while retaining much of their simplicity in practice.</p></section></section><h3 id="old_gtrees"><a data-ref="old_gtrees" data-hl="true" data-hsection-level="2" href="#old_gtrees">4.2 Well-Known G-Trees</a></h3><section data-hsection="old_gtrees"><p>We now discuss how several well-known probabilistic data structures can be expressed as <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>.</p><h4 id="gtree_zip_trees"><a data-ref="gtree_zip_trees" data-hl="true" data-hsection-level="3" href="#gtree_zip_trees">4.2.1 Zip-Trees as G-Trees</a></h4><section data-hsection="gtree_zip_trees"><p>As we described in our derivation of the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, instantiating <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with sorted linked lists yields the <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>. Aside from mentioning <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> here for the sake of completeness, we want to point out an interesting implementation detail: whereas <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> store the <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> of every <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> in its <a data-ref="vertex" data-preview-anchor="previews/vertex.html?def§vertex" data-hl="true" href="#vertex">vertex</a>, a sorted linked list <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> only needs to store one <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> per linked list that it contains, i.e., one <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> per <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a>.</p></section><h4 id="gtree_zipzip_trees"><a data-ref="gtree_zipzip_trees" data-hl="true" data-hsection-level="3" href="#gtree_zipzip_trees">4.2.2 Zip-Zip-Trees and Beyond</a></h4><section data-hsection="gtree_zipzip_trees"><p>Instantiation of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> requires a set data structure. <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> <em>are</em> set data structures themselves. How about some recursion?</p><p>Instantiating <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>, i.e., with <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> instantiated with sorted linked lists, yields exactly the <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a>. <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">Zip-zip-trees</a><a data-ref="gila2023zip" data-preview-anchor="previews/gila2023zip.html?def§gila2023zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/gila2023zip.pdf"><span></span> <span>(<span><span>Gila</span> <span>et al.</span></span>, 2023)</span></a> were initially introduced as a modification of the tie-breaking algorithm of <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>. This modification is essentially an ad-hoc variation, whereas our description of <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a> highlights them as a (highly relevant) member of a family of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> obtained from recursive self-instantiation. In particular, once <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> and sorted linked lists have been implemented, the difference between implementing <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> and <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a> consists of a single type-level operation, whereas the algorithmic definition of <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a> requires manual adjustment of all tree manipulation algorithms.</p><p>More generally, we can instantiate <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> that are themselves recursively instantiated, to an arbitrary depth and choice of recursion anchor. Using sorted linked lists as recursion anchors yields a family of <dfn id="zipk_tree"><a data-ref="zipk_tree" data-preview-anchor="/g_trees/previews/zipk_tree.html?def§zipk_tree" data-hl="true" href="#zipk_tree"><span><span aria-hidden="true"><span><span></span><span><span><span>zip</span></span><span><span><span><span><span><span></span><span><span>k</span></span></span></span></span></span></span></span></span></span></span>-trees</a></dfn> whose first two members are the <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> and the <a data-ref="zipzip" data-preview-anchor="/g_trees/previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a>.</p></section><h4 id="gtree_treaps"><a data-ref="gtree_treaps" data-hl="true" data-hsection-level="3" href="#gtree_treaps">4.2.3 Treaps as G-Trees</a></h4><section data-hsection="gtree_treaps"><p>We end this section with a fun observation: if we restrict each nested tree structure in the <a data-ref="zipk_tree" data-preview-anchor="previews/zipk_tree.html?def§zipk_tree" data-hl="true" href="#zipk_tree"><span><span aria-hidden="true"><span><span></span><span><span><span>zip</span></span><span><span><span><span><span><span></span><span><span>k</span></span></span></span></span></span></span></span></span></span></span>-trees</a> to store ranks in a single bit (i.e., we cap the <a data-ref="geometric_distribution" data-preview-anchor="previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> at two), we obtain exactly the <a data-ref="treap" data-preview-anchor="previews/treap.html?def§treap" data-hl="true" href="#treap">treaps</a> with k-bit <a data-ref="priority" data-preview-anchor="previews/priority.html?def§priority" data-hl="true" href="#priority">priorities</a>. We doubt that this has any practical applications, but it shows that the family of recursively instantiated <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> is interesting beyond just the <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a>.</p></section></section><h3 id="new_gtrees"><a data-ref="new_gtrees" data-hl="true" data-hsection-level="2" href="#new_gtrees">4.3 Novel G-Trees</a></h3><section data-hsection="new_gtrees"><p>Having shown that the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> encompass several useful and well-known data structures, we now give some members of the family that have <em>not</em> been independently described before. In particular, we tackle the problem of finding <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> data structures that are efficient on secondary storage (or in terms of cpu caches) by storing up to <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> items in a single vertex. Previous solutions<a data-ref="golovin2009bgolovin2010bbender2016antisafavi2023b" data-preview-anchor="previews/golovin2009bgolovin2010bbender2016antisafavi2023b.html?def§golovin2009bgolovin2010bbender2016antisafavi2023b" href="https://g-trees.github.io/g_trees/g_trees/assets/references/golovin2009b.pdf"><span></span> <span>(<span><span>Bender</span> <span>et al.</span></span>, 2016; <span>Golovin</span>, 2009, 2010; <span>Safavi</span> &amp; <span>Seybold</span>, 2023)</span></a> all incur a significant overhead in terms of conceptual complexity compared to their binary counterparts. With <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, we merely need to change the underlying set datastructure <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> to one that stores <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> in blocks of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>.</p><p>A key intuition behind classic <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> is that of choosing <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> from a <a data-ref="geometric_distribution" data-preview-anchor="previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> with <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> because this is the distribution of the height of a randomly chosen vertex in a perfectly balanced binary <a data-ref="tree" data-preview-anchor="previews/tree.html?def§tree" data-hl="true" href="#tree">tree</a>. For <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-ary trees, the same intuition instructs us to draw <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> from a <a data-ref="geometric_distribution" data-preview-anchor="previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> with <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span><span>,</span></span></span></span></span></span> as this is the distribution of heights in a perfectly balanced <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-ary <a data-ref="tree" data-preview-anchor="previews/tree.html?def§tree" data-hl="true" href="#tree">tree</a>. Our <a data-hsection-level="2" data-ref="analysis" data-hl="true" href="#analysis">analysis</a> confirmes that — with high probability — the resulting trees are of logarithmic height and their <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> store <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>k</span><span>)</span></span></span></span> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a>.</p><p>The second key insight toward an efficient <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-ary data structure is, paradoxically, that there is no need to be clever about it. Sorted linked lists are naïve, inefficient data structures, yet <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> are efficient. We can be similarly naïve for our <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-ary construction.</p><p>We use a sorted linked list in which every node stores up to <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>. We require all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> to be stored as early in the list as possible; this is the simplemost way of achieving <a data-ref="history_independent" data-preview-anchor="/g_trees/previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independence</a>. In other words, the only node to store fewer than <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> is the final node. We call such a list a <dfn id="k_list"><a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-list</a></dfn> (see <a data-ref="fig_klist" data-preview-anchor="/g_trees/previews/fig_klist.html?def§fig_klist" href="#fig_klist">Figure 9</a>).</p><figure id="fig_klist"><img alt="A rendering of a 3-list." src="https://g-trees.github.io/g_trees/assets/graphics/klist.svg"/><figcaption><p><a data-ref="fig_klist" data-preview-anchor="/g_trees/previews/fig_klist.html?def§fig_klist" href="#fig_klist">Figure 9</a>: A 3-List</p><p>The sorted <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>3</span></span></span></span>-list</a> containing <span><span aria-hidden="true"><span><span></span><span>1</span><span>,</span><span></span><span>4</span><span>,</span><span></span><span>5</span><span>,</span><span></span><span>8</span><span>,</span><span></span><span>23</span><span>,</span><span></span><span>26</span><span>,</span><span></span><span>32</span><span>,</span><span></span><span>35</span></span></span></span>. Sometimes, things are just that simple.</p></figcaption></figure><p>Instantiating <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with the <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> and a <a data-ref="geometric_distribution" data-preview-anchor="/g_trees/previews/geometric_distribution.html?def§geometric_distribution" data-hl="true" href="#geometric_distribution">geometric distribution</a> of <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="/g_trees/previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span><span></span></a></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>1</span><span>+</span><span>k</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> yields a family of data structures we call the <dfn id="kzip_tree"><a data-ref="kzip_tree" data-preview-anchor="/g_trees/previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-trees</a></dfn>. <a data-ref="fig_2ziptree" data-preview-anchor="/g_trees/previews/fig_2ziptree.html?def§fig_2ziptree" href="#fig_2ziptree">Figure 10</a> depicts the <a data-ref="kzip_tree" data-preview-anchor="/g_trees/previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>2</span></span></span></span>-zip-tree</a> for our running example set.</p><figure id="fig_2ziptree"><img alt="A rendering of a 2-zip-tree." src="https://g-trees.github.io/g_trees/assets/graphics/kziptree.svg"/><figcaption><p><a data-ref="fig_2ziptree" data-preview-anchor="/g_trees/previews/fig_2ziptree.html?def§fig_2ziptree" href="#fig_2ziptree">Figure 10</a>: 2-Zip-Tree</p><p>A <a data-ref="kzip_tree" data-preview-anchor="/g_trees/previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>2</span></span></span></span>-zip-tree</a>. Linked list pointers are <span>dashed</span>, child pointers are solid. The three layers of the layout correspond to the three different <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a>. Observe how contracting the linked lists effectively yields <a data-ref="fig_gnodes" data-preview-anchor="/g_trees/previews/fig_gnodes.html?def§fig_gnodes" href="#fig_gnodes">Figure 5</a>.</p></figcaption></figure><p>The <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> are inefficient data structures — inserting or deleting the first item requires <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>n</span><span>)</span></span></span></span> time in a <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-list</a> of <span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span> items. The <a data-ref="kzip_tree" data-preview-anchor="previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-trees</a> are nevertheless efficient, because the expected size of the <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>, and hence, the expected length of the <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a>, is constant for any <span><span aria-hidden="true"><span><span></span><span data-ref="geo_p" data-preview-anchor="previews/geo_p.html?def§geo_p" data-hl="true"><a href="#geo_p"><span>p</span></a></span></span></span></span>. More efficient alternatives to <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> exist, such as <a data-ref="shao1994unrolling" data-preview-anchor="previews/shao1994unrolling.html?def§shao1994unrolling" href="https://g-trees.github.io/g_trees/g_trees/assets/references/shao1994unrolling.pdf"><span>unrolled linked lists</span> <span>(<span><span>Shao</span> <span>et al.</span></span>, 1994)</span></a>. These are not <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a>, however.</p><p>What is the expected height of a <a data-ref="kzip_tree" data-preview-anchor="previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-tree</a>? Asymptotically, we know it to be in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span></span><span>n</span><span>)</span></span></span></span>, since we have <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> of <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span></span><span>n</span><span>)</span></span></span></span> different <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a>, each a list of <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>k</span><span>)</span></span></span></span> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> (which has a length in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>k</span><span>)</span></span></span></span>). <a data-ref="fig_kzip_height" data-preview-anchor="previews/fig_kzip_height.html?def§fig_kzip_height" href="#fig_kzip_height">Figure 11</a> gives experimental measures for some specific <span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>. The <dfn>height amplification</dfn> we report is the height of each tree divided by the height of a perfectly-balanced <span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>-ary tree on <span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span> vertices.</p><figure id="fig_kzip_height"><h6>Tree Height</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></th><td>15.29 (5.61)</td><td>26.59 (8.89)</td><td>38.20 (9.47)</td><td>50.58 (11.86)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>3</span></span></span></span></th><td>8.61 (2.40)</td><td>14.92 (3.38)</td><td>21.97 (4.41)</td><td>29.13 (4.93)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>15</span></span></span></span></th><td>4.28 (0.98)</td><td>8.06 (2.04)</td><td>12.36 (2.43)</td><td>16.66 (2.45)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>63</span></span></span></span></th><td>2.37 (0.24)</td><td>5.05 (1.43)</td><td>8.43 (1.69)</td><td>12.08 (2.52)</td></tr></tbody></table><h6>Height Amplification</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></th><td>2.18 (0.11)</td><td>2.66 (0.09)</td><td>2.73 (0.05)</td><td>2.98 (0.04)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>3</span></span></span></span></th><td>2.15 (0.15)</td><td>2.98 (0.14)</td><td>3.14 (0.09)</td><td>3.24 (0.06)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>15</span></span></span></span></th><td>2.14 (0.24)</td><td>2.69 (0.23)</td><td>3.09 (0.15)</td><td>3.33 (0.10)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>63</span></span></span></span></th><td>1.18 (0.06)</td><td>2.53 (0.36)</td><td>2.81 (0.19)</td><td>4.03 (0.28)</td></tr></tbody></table><figcaption><p><a data-ref="fig_kzip_height" data-preview-anchor="/g_trees/previews/fig_kzip_height.html?def§fig_kzip_height" href="#fig_kzip_height">Figure 11</a>: K-Zip-Tree Height</p><p>The heights of 200 randomly generated <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, i.e., the maximal number of pointers to traverse from the root to a leaf; for various combinations of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. The numbers in parentheses give the <a href="https://en.wikipedia.org/wiki/Variance">variance</a>.</p><p>The second table normalizes the heights by the heights of perfectly-balanced <span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span>-ary trees on <span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span> vertices.</p></figcaption></figure><p>Another concern of interest is space amplification: in the worst case, every <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> would be in its own <a data-ref="k_list" data-preview-anchor="previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-list</a>, resulting in a space amplification factor of <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>. Intuitively, this occurs only rarely, however: the expected size of each <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> is <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>, and the probability for a <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> to have size <span><span aria-hidden="true"><span><span></span><span>s</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>k</span></span></span></span> decreases exponentially in <span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>−</span><span></span></span><span><span></span><span>s</span></span></span></span>. Any overfull <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a> consists of one or more full linked-list vertices, plus exactly one underfull linked-list vertex. Hence, the overfull <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> contribute an amplification factor of at most two. Roughly half of the nodes will be overful, so we can expect a space amplification around <span><span aria-hidden="true"><span><span></span><span>1.5</span></span></span></span>. <a data-ref="fig_space_amplification" data-preview-anchor="previews/fig_space_amplification.html?def§fig_space_amplification" href="#fig_space_amplification">Figure 12</a> backs up this intuition with experimental data.</p><figure id="fig_space_amplification"><h6>Space Amplification</h6><table><thead><tr><th></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span><span>,</span><span></span><span>000</span></span></span></span></th><th><span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>100</span><span>,</span><span></span><span>000</span></span></span></span></th></tr></thead><tbody><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></th><td>1 (0)</td><td>1 (0)</td><td>1 (0)</td><td>1 (0)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>3</span></span></span></span></th><td>1.338 (0.0055)</td><td>1.302 (0.0006)</td><td>1.298 (0.0000)</td><td>1.297 (0.0000)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>15</span></span></span></span></th><td>1.743 (0.0786)</td><td>1.544 (0.0061)</td><td>1.515 (0.0006)</td><td>1.512 (0.0000)</td></tr><tr><th><span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>63</span></span></span></span></th><td>2.431 (0.612)</td><td>1.669 (0.0316)</td><td>1.578 (0.0032)</td><td>1.565 (0.0003)</td></tr></tbody></table><figcaption><p><a data-ref="fig_space_amplification" data-preview-anchor="/g_trees/previews/fig_space_amplification.html?def§fig_space_amplification" href="#fig_space_amplification">Figure 12</a>: Space Amplification</p><p>Total number of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> slots divided by total number of <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> in 200 randomly generated <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, for various combinations of <span><span aria-hidden="true"><span><span></span><span data-ref="ana_n" data-preview-anchor="/g_trees/previews/ana_n.html?def§ana_n" data-hl="true"><a href="#ana_n"><span>n</span></a></span></span></span></span> and <span><span aria-hidden="true"><span><span></span><span data-ref="ana_k" data-preview-anchor="/g_trees/previews/ana_k.html?def§ana_k" data-hl="true"><a href="#ana_k"><span>k</span></a></span></span></span></span>. The numbers in parentheses give the <a href="https://en.wikipedia.org/wiki/Variance">variance</a>.</p></figcaption></figure><p>Recursive instantiation of <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with other <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> leads to the family of <a data-ref="zipk_tree" data-preview-anchor="/g_trees/previews/zipk_tree.html?def§zipk_tree" data-hl="true" href="#zipk_tree"><span><span aria-hidden="true"><span><span></span><span><span><span>zip</span></span><span><span><span><span><span><span></span><span><span>k</span></span></span></span></span></span></span></span></span></span></span>-trees</a> when using linked lists (i.e., <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>1</span></span></span></span>-lists</a>) as the recursion anchor. We can similarly use arbitrary <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> as the recursion anchor to obtain the <a data-ref="kzip_tree" data-preview-anchor="/g_trees/previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-trees</a>, the <dfn id="kzipzip_tree"><a data-ref="kzipzip_tree" data-preview-anchor="/g_trees/previews/kzipzip_tree.html?def§kzipzip_tree" data-hl="true" href="#kzipzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-zip-trees</a></dfn>, and so on.</p><p>Through some small adjustments, the definition of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> can be adapted to yield generalizations of <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> and <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> analogons of <a data-ref="comer1979ubiquitous" data-preview-anchor="previews/comer1979ubiquitous.html?def§comer1979ubiquitous" href="https://g-trees.github.io/g_trees/g_trees/assets/references/comer1979ubiquitous.pdf"><span>B<sup>+</sup>-trees</span> <span>(<span>Comer</span>, 1979)</span></a>. We sketch these extensions in <a data-hsection-level="1" data-ref="variants" data-hl="true" href="#variants">Appendix B</a>.</p></section></section><h2 id="implementation"><a data-ref="implementation" data-hl="true" data-hsection-level="1" href="#implementation">5 Algorithms</a></h2><section data-hsection="implementation"><p>We now present asymptotically efficient algorithms for working with <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>. To optimize for clarity of presentation, we describe purely functional algorithms: all functions return new values rather than mutating their inputs.</p><p>We explicitly distinguish between non-empty and possibly-empty <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> and internal set data structures, to clarify which cases can arise in our algorithms. To reinforce those distinctions, our pseudocode comes with pseudotypes. The typing also aids in keeping straight the multiple levels of parametric polymorphism (“generics”). Finally, pseudotypes allow us to explicitly define the functions that must be available on <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span> for our algorithms to work. </p><code id="interface_set"></code><p>The functions we require of a <a data-ref="c_neset" data-preview-anchor="previews/c_neset.html?def§c_neset" data-hl="true" href="#c_neset">NonemptySet</a> are standard functions that are easily implemented in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span>(</span><span>n</span><span>))</span></span></span></span> time with typical set data <span>structures<span>3</span></span><span><span>3</span>Not that we needed an efficient implementation: since <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> have constant expected size, even <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>n</span><span>)</span></span></span></span> implementations do not hurt the asymptotic efficiency of our algorithms.</span>. The only choice worth commenting on is that of using a specialized <a data-ref="c_neset_insert_min" data-preview-anchor="previews/c_neset_insert_min.html?def§c_neset_insert_min" data-hl="true" href="#c_neset_insert_min">insert_min</a> function instead of a generic <code>insert</code> function. This choice is to allow for more efficient, specialized implementations, as well as to highlight that our algorithms interact with the internal set data structures in a surprisingly constrained manner.</p><p>Before giving our main algorithms, we define some helper functions:</p><code id="code_helpers"></code><p>While it is possible to derive insertion and deletion algorithms by generalizing the original <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a> algorithms (see <a data-hsection-level="1" data-ref="explicit_implementations" data-hl="true" href="#explicit_implementations">Appendix C</a> for examples), we opt for a fully self-contained presentation here. Zipping and unzipping are similar to the join and split functions of <a data-ref="blelloch2016just" data-preview-anchor="previews/blelloch2016just.html?def§blelloch2016just" href="https://g-trees.github.io/g_trees/g_trees/assets/references/blelloch2016just.pdf"><span>join-based tree algorithms</span> <span>(<span><span>Blelloch</span> <span>et al.</span></span>, 2016)</span></a>. We consistently use zip and unzip terminology when operating on <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>, and join and split terminology when operating on the underlying set datastructure <span><span aria-hidden="true"><span><span></span><span data-ref="gtree_g" data-preview-anchor="previews/gtree_g.html?def§gtree_g" data-hl="true"><a href="#gtree_g"><span>S</span></a></span></span></span></span>.</p><p>We build our insertion and deletion algorithms from algorithms for unzipping and zipping <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>. Unzipping takes a key and splits a <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> into the tree of all <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> less than the key and the tree of all <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> greater than the key<span>The key itself occurs in neither returned tree, even if it is part of the input tree.</span>. Zipping takes two trees, the first containing only <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> strictly lesser than any <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> of the second, and joins them together into a single tree. We call this version of zipping <code>zip2</code>, because it takes <em>two</em> arguments. We also use a <code>zip3</code> function, which additionally incorporates a single <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> into the tree that is strictly greater than all <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> of the first tree, and strictly less than all <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> of the second tree. Insertion and deletion can then be implemented as composition of unzipping and zipping (<code>zip3</code> and <code>zip2</code>, respectively) — see <a data-ref="fig_insert_and_delete" data-preview-anchor="previews/fig_insert_and_delete.html?def§fig_insert_and_delete" href="#fig_insert_and_delete">Figure 13</a>.</p><figure id="fig_insert_and_delete"><img alt="A G-tree, before and after inserting an item, with the unzipped tree as an intermediate step." src="https://g-trees.github.io/g_trees/assets/graphics/gtreeInsertDelete.svg"/><figcaption><p><a data-ref="fig_insert_and_delete" data-preview-anchor="/g_trees/previews/fig_insert_and_delete.html?def§fig_insert_and_delete" href="#fig_insert_and_delete">Figure 13</a>: Insertion and Deletion</p><p>Example of inserting or deleting <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> <span><span aria-hidden="true"><span><span></span><span>18</span></span></span></span> of <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> <span><span aria-hidden="true"><span><span></span><span>3</span></span></span></span> via unzipping followed by zipping.</p></figcaption></figure><p>To unzip a <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a>, <a data-ref="c_neset_split" data-preview-anchor="previews/c_neset_split.html?def§c_neset_split" data-hl="true" href="#c_neset_split">split</a> the inner <a data-ref="c_gtree_node_set" data-preview-anchor="previews/c_gtree_node_set.html?def§c_gtree_node_set" data-hl="true" href="#c_gtree_node_set">set</a> of the root <a data-ref="c_gtree_node" data-preview-anchor="previews/c_gtree_node.html?def§c_gtree_node" data-hl="true" href="#c_gtree_node">GTreeNode</a>, and then performs a case distinction<span>We give a more thorough description in the form of code comments.</span> to determine whether it is necessary to recurse:</p><code id="code_unzip"></code><p>Since the expected size of <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> is constant with high probability, we can treat all functions of the <a data-ref="c_neset" data-preview-anchor="previews/c_neset.html?def§c_neset" data-hl="true" href="#c_neset">NonemptySet</a> interface as running in constant time. Each recursive call of the <a data-ref="c_unzip" data-preview-anchor="previews/c_unzip.html?def§c_unzip" data-hl="true" href="#c_unzip">unzip</a> function is to a <a data-ref="c_gtree_node" data-preview-anchor="previews/c_gtree_node.html?def§c_gtree_node" data-hl="true" href="#c_gtree_node">GTreeNode</a> of strictly decreasing <a data-ref="c_gtree_node_rank" data-preview-anchor="previews/c_gtree_node_rank.html?def§c_gtree_node_rank" data-hl="true" href="#c_gtree_node_rank">rank</a>, so the recursion depth is bounded by the height of the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a>, which is logarithmic with high probability. Hence, the overall running time is in <span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>lo<span>g</span></span><span>(</span><span>n</span><span>))</span></span></span></span> with high probability.</p><p>We can similarly give a recursive algorithm<span>Again, the main description takes the form of code comments.</span> for zipping together two <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with the same complexity properties:</p><code id="code_zip2"></code><p>To implement zipping of two <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> with an additional <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> in between them, we can simply convert that <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">item</a> into a singleton <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a>, and then call <a data-ref="c_zip2" data-preview-anchor="previews/c_zip2.html?def§c_zip2" data-hl="true" href="#c_zip2">zip2</a> twice:</p><code id="code_zip3"></code><p>With <a data-ref="c_unzip" data-preview-anchor="previews/c_unzip.html?def§c_unzip" data-hl="true" href="#c_unzip">unzip</a>, <a data-ref="c_zip2" data-preview-anchor="previews/c_zip2.html?def§c_zip2" data-hl="true" href="#c_zip2">zip2</a>, and <a data-ref="c_zip3" data-preview-anchor="previews/c_zip3.html?def§c_zip3" data-hl="true" href="#c_zip3">zip3</a> in place, insertion and deletion in expected logarithmic time become trivial:</p><code id="code_insert_delete"></code><p>We want to emphasize that our choice of algorithms optimizes for elegance, not for (non-asymptotic) efficiency. Implementations based on in-place mutations will outperform our immutable algorithms. A direct implementation of <a data-ref="c_zip3" data-preview-anchor="previews/c_zip3.html?def§c_zip3" data-hl="true" href="#c_zip3">zip3</a> will outperform the reduction to two applications of <a data-ref="c_zip2" data-preview-anchor="previews/c_zip2.html?def§c_zip2" data-hl="true" href="#c_zip2">zip2</a>. Iterative implementations might outperform recursive implementations. And finally, direct implementations of insertion and deletion should outperform those based off unzipping and zipping the full trees. The <a data-ref="tarjan2021zip" data-preview-anchor="previews/tarjan2021zip.html?def§tarjan2021zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/tarjan2021zip.pdf"><span>original zip-tree paper</span> <span>(<span><span>Tarjan</span> <span>et al.</span></span>, 2021)</span></a> contains examples of direct algorithms that zip and unzip only parts of a tree; our algorithms can be adapted to work analogously, and we provide variants for <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> in <a data-hsection-level="1" data-ref="explicit_implementations" data-hl="true" href="#explicit_implementations">Appendix C</a>.</p></section><h2 id="conclusion"><a data-ref="conclusion" data-hl="true" data-hsection-level="1" href="#conclusion">6 Conclusion</a></h2><section data-hsection="conclusion"><p>We have generalized the <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a> to the rich family of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>. <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> must be instantiated with a concrete set data structure; using a linked list yields the <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>, and direct recursive self-instantiation yields the <a data-ref="zipzip" data-preview-anchor="previews/zipzip.html?def§zipzip" data-hl="true" href="#zipzip">zip-zip-trees</a>. All <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> are <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> if the underlying set data structure is <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a>, and admit the same <a data-hsection-level="1" data-ref="implementation" data-hl="true" href="#implementation">efficient algorithms</a> for mutating them. We have <a data-hsection-level="2" data-ref="analysis" data-hl="true" href="#analysis">proven</a> the <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> to be similar to perfectly balanced search trees with high probability, a property that makes them asymptotically and practically efficient.</p><p>Beyond merely generalizing existing data structures, we have defined the <a data-ref="kzip_tree" data-preview-anchor="previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-trees</a>, a conceptually simple family of <a data-ref="history_independent" data-preview-anchor="previews/history_independent.html?def§history_independent" data-hl="true" href="#history_independent">history-independent</a> data structures that store up to <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> in a single vertex. Such data structures make more efficient use of hardware caches than binary trees, allowing the <a data-ref="kzip_tree" data-preview-anchor="previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-zip-trees</a> to <a data-ref="fig_search_performance" data-preview-anchor="previews/fig_search_performance.html?def§fig_search_performance" href="#fig_search_performance">outperform</a> the binary <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip trees</a>.</p></section><h2 id="bibliography"><a data-ref="bibliography" data-hl="true" data-hsection-level="1" href="#bibliography">References</a></h2><section data-hsection="bibliography"></section><h2 id="experiments"><a data-ref="experiments" data-hl="true" data-hsection-level="1" href="#experiments">Appendix A: Code</a></h2><section data-hsection="experiments"><p>We have published the code powering our experiments <a href="https://github.com/g-trees/gtree_experiments">on github</a> (under the MIT license). The implementation written is in <a href="https://www.rust-lang.org/">rust</a>, and can be built with the <a href="https://doc.rust-lang.org/cargo/">cargo package manager</a>. Run <code>cargo run --bin stats</code> to replicate the experiments for <a data-ref="fig_stats_gheight" data-preview-anchor="previews/fig_stats_gheight.html?def§fig_stats_gheight" href="#fig_stats_gheight">Figure 6</a>, <a data-ref="fig_stats_gnode_size" data-preview-anchor="previews/fig_stats_gnode_size.html?def§fig_stats_gnode_size" href="#fig_stats_gnode_size">Figure 7</a>, <a data-ref="fig_stats_gnode_count" data-preview-anchor="previews/fig_stats_gnode_count.html?def§fig_stats_gnode_count" href="#fig_stats_gnode_count">Figure 8</a>, <a data-ref="fig_kzip_height" data-preview-anchor="previews/fig_kzip_height.html?def§fig_kzip_height" href="#fig_kzip_height">Figure 11</a>, and <a data-ref="fig_space_amplification" data-preview-anchor="previews/fig_space_amplification.html?def§fig_space_amplification" href="#fig_space_amplification">Figure 12</a>. Run <code>cargo bench</code> to recreate the benchmark for <a data-ref="fig_search_performance" data-preview-anchor="previews/fig_search_performance.html?def§fig_search_performance" href="#fig_search_performance">Figure 1</a>.</p></section><h2 id="variants"><a data-ref="variants" data-hl="true" data-hsection-level="1" href="#variants">Appendix B: G-Tree Variants</a></h2><section data-hsection="variants"><p>We now sketch several variants of <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> that might be useful in practice. Highlights include a <a data-ref="gtree" data-preview-anchor="previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a>-analogon of the <a data-ref="comer1979ubiquitous" data-preview-anchor="previews/comer1979ubiquitous.html?def§comer1979ubiquitous" href="https://g-trees.github.io/g_trees/g_trees/assets/references/comer1979ubiquitous.pdf"><span>B<sup>+</sup>-tree</span> <span>(<span>Comer</span>, 1979)</span></a>, and a cache-efficient generalization of the <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a>.</p><p>When search trees store not only keys but key-value pairs, some usecases benefit from storing all key-value pairs in leaves of the tree. To support efficient lookup of the leaves, the inner vertices of the tree store duplicates of certain keys. We can easily adapt <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> to this behavior by placing <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> not only in the tree layer corresponding to their <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> but also on all lower layers. <a data-ref="fig_leafy_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_gtree.html?def§fig_leafy_gtree" href="#fig_leafy_gtree">Figure 14</a> depicts such a <dfn id="naive_leafy_gtree"><a data-ref="naive_leafy_gtree" data-preview-anchor="/g_trees/previews/naive_leafy_gtree.html?def§naive_leafy_gtree" data-hl="true" href="#naive_leafy_gtree">naïve leafy G-tree</a></dfn>, and <a data-ref="fig_leafy_1zip" data-preview-anchor="/g_trees/previews/fig_leafy_1zip.html?def§fig_leafy_1zip" href="#fig_leafy_1zip">Figure 15</a> and <a data-ref="fig_leafy_2zip" data-preview-anchor="/g_trees/previews/fig_leafy_2zip.html?def§fig_leafy_2zip" href="#fig_leafy_2zip">Figure 16</a> show concrete instantiations with a <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list">1-list</a> (a <dfn id="naive_leafy_zip_tree"><a data-ref="naive_leafy_zip_tree" data-preview-anchor="/g_trees/previews/naive_leafy_zip_tree.html?def§naive_leafy_zip_tree" data-hl="true" href="#naive_leafy_zip_tree">naïve leafy zip-tree</a></dfn>) and a <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list">2-list</a> (a <dfn id="naive_leafy_2zip_tree"><a data-ref="naive_leafy_2zip_tree" data-preview-anchor="/g_trees/previews/naive_leafy_2zip_tree.html?def§naive_leafy_2zip_tree" data-hl="true" href="#naive_leafy_2zip_tree">naïve leafy 2-zip-tree</a></dfn>) respectively. We <span>arbitrarily<span>4</span></span><span><span>4</span>Spoiler: the ordering is arbitrary <em>in principle</em>, but our choice will surface a deep connection to <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> in a few paragraphs.</span> choose to sort <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> of lower <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> to the right of their copies of higher <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>.</p><figure id="fig_leafy_gtree"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafGtree.svg"/><figcaption><p><a data-ref="fig_leafy_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_gtree.html?def§fig_leafy_gtree" href="#fig_leafy_gtree">Figure 14</a>: Naïve Leafy G-Tree</p><p>An example <a data-ref="naive_leafy_gtree" data-preview-anchor="/g_trees/previews/naive_leafy_gtree.html?def§naive_leafy_gtree" data-hl="true" href="#naive_leafy_gtree">naïve leafy G-tree</a> that stores the same <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> as the <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-tree</a> in <a data-ref="fig_gnodes" data-preview-anchor="/g_trees/previews/fig_gnodes.html?def§fig_gnodes" href="#fig_gnodes">Figure 5</a>.</p></figcaption></figure><figure id="fig_leafy_1zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafGtreeOfLists.svg"/><figcaption><p><a data-ref="fig_leafy_1zip" data-preview-anchor="/g_trees/previews/fig_leafy_1zip.html?def§fig_leafy_1zip" href="#fig_leafy_1zip">Figure 15</a>: Naïve Leafy Zip-Tree</p><p>An example <a data-ref="naive_leafy_zip_tree" data-preview-anchor="/g_trees/previews/naive_leafy_zip_tree.html?def§naive_leafy_zip_tree" data-hl="true" href="#naive_leafy_zip_tree">naïve leafy zip-tree</a>, a concrete instantiation of the <a data-ref="naive_leafy_gtree" data-preview-anchor="/g_trees/previews/naive_leafy_gtree.html?def§naive_leafy_gtree" data-hl="true" href="#naive_leafy_gtree">naïve leafy G-tree</a> in <a data-ref="fig_leafy_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_gtree.html?def§fig_leafy_gtree" href="#fig_leafy_gtree">Figure 14</a>. Compare also with <a data-ref="fig_ziptree_lists" data-preview-anchor="/g_trees/previews/fig_ziptree_lists.html?def§fig_ziptree_lists" href="#fig_ziptree_lists">Figure 4</a>, which depicts the <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a> for the same <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>.</p></figcaption></figure><figure id="fig_leafy_2zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafGtree2Lists.svg"/><figcaption><p><a data-ref="fig_leafy_2zip" data-preview-anchor="/g_trees/previews/fig_leafy_2zip.html?def§fig_leafy_2zip" href="#fig_leafy_2zip">Figure 16</a>: Naïve Leafy 2-Zip-Tree</p><p>An example <a data-ref="naive_leafy_2zip_tree" data-preview-anchor="/g_trees/previews/naive_leafy_2zip_tree.html?def§naive_leafy_2zip_tree" data-hl="true" href="#naive_leafy_2zip_tree">naïve leafy 2-zip-tree</a>, a concrete instantiation of the <a data-ref="naive_leafy_gtree" data-preview-anchor="/g_trees/previews/naive_leafy_gtree.html?def§naive_leafy_gtree" data-hl="true" href="#naive_leafy_gtree">naïve leafy G-tree</a> in <a data-ref="fig_leafy_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_gtree.html?def§fig_leafy_gtree" href="#fig_leafy_gtree">Figure 14</a>. Compare also with <a data-ref="fig_2ziptree" data-preview-anchor="/g_trees/previews/fig_2ziptree.html?def§fig_2ziptree" href="#fig_2ziptree">Figure 10</a>, which depicts the <a data-ref="kzip_tree" data-preview-anchor="/g_trees/previews/kzip_tree.html?def§kzip_tree" data-hl="true" href="#kzip_tree">2-zip-tree</a> for the same <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a>.</p></figcaption></figure><p>The figures clearly show a deficiency of this naïve approach: almost all <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> have a single pointer to the layer below, except for the first <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">item</a> of each <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>, which needs two pointers. We can restore uniformity by adding a dummy element <span><span aria-hidden="true"><span><span></span><span>⊥</span></span></span></span> at the start of each layer. <a data-ref="fig_leafy_bot_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_bot_gtree.html?def§fig_leafy_bot_gtree" href="#fig_leafy_bot_gtree">Figure 17</a> gives an example of the resulting (proper) <dfn id="leafy_gtree"><a data-ref="leafy_gtree" data-preview-anchor="/g_trees/previews/leafy_gtree.html?def§leafy_gtree" data-hl="true" href="#leafy_gtree">leafy G-tree</a></dfn>; <a data-ref="fig_leafy_bot_1zip" data-preview-anchor="/g_trees/previews/fig_leafy_bot_1zip.html?def§fig_leafy_bot_1zip" href="#fig_leafy_bot_1zip">Figure 18</a> shows a <dfn id="leafy_zip_tree"><a data-ref="leafy_zip_tree" data-preview-anchor="/g_trees/previews/leafy_zip_tree.html?def§leafy_zip_tree" data-hl="true" href="#leafy_zip_tree">leafy zip-tree</a></dfn>, and <a data-ref="fig_leafy_bot_2zip" data-preview-anchor="/g_trees/previews/fig_leafy_bot_2zip.html?def§fig_leafy_bot_2zip" href="#fig_leafy_bot_2zip">Figure 19</a> shows a <dfn id="leafy_2zip_tree"><a data-ref="leafy_2zip_tree" data-preview-anchor="/g_trees/previews/leafy_2zip_tree.html?def§leafy_2zip_tree" data-hl="true" href="#leafy_2zip_tree">leafy 2-zip-tree</a></dfn>.</p><figure id="fig_leafy_bot_gtree"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafBotGtree.svg"/><figcaption><p><a data-ref="fig_leafy_bot_gtree" data-preview-anchor="/g_trees/previews/fig_leafy_bot_gtree.html?def§fig_leafy_bot_gtree" href="#fig_leafy_bot_gtree">Figure 17</a>: Leafy G-Tree</p></figcaption></figure><figure id="fig_leafy_bot_1zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafBot1zip.svg"/><figcaption><p><a data-ref="fig_leafy_bot_1zip" data-preview-anchor="/g_trees/previews/fig_leafy_bot_1zip.html?def§fig_leafy_bot_1zip" href="#fig_leafy_bot_1zip">Figure 18</a>: Leafy Zip-Tree</p></figcaption></figure><figure id="fig_leafy_bot_2zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/leafBot2zip.svg"/><figcaption><p><a data-ref="fig_leafy_bot_2zip" data-preview-anchor="/g_trees/previews/fig_leafy_bot_2zip.html?def§fig_leafy_bot_2zip" href="#fig_leafy_bot_2zip">Figure 19</a>: Leafy 2-Zip-Tree</p></figcaption></figure><p>The reader familiar with <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> should immediately see that <a data-ref="fig_leafy_bot_1zip" data-preview-anchor="previews/fig_leafy_bot_1zip.html?def§fig_leafy_bot_1zip" href="#fig_leafy_bot_1zip">Figure 18</a> — the rendering of a <a data-ref="leafy_zip_tree" data-preview-anchor="previews/leafy_zip_tree.html?def§leafy_zip_tree" data-hl="true" href="#leafy_zip_tree">leafy zip-tree</a> — essentially shows a <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a>, except that some of the edges within the same layer are missing. <a data-ref="fig_linked_leafy_bot_1zip" data-preview-anchor="previews/fig_linked_leafy_bot_1zip.html?def§fig_linked_leafy_bot_1zip" href="#fig_linked_leafy_bot_1zip">Figure 21</a> shows a proper <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a> with the same <a data-ref="item" data-preview-anchor="previews/item.html?def§item" data-hl="true" href="#item">items</a> and <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">ranks</a> for comparison. Characterizing the “missing” edges from the perspective of <a data-ref="leafy_gtree" data-preview-anchor="previews/leafy_gtree.html?def§leafy_gtree" data-hl="true" href="#leafy_gtree">leafy G-trees</a> is trivial: there are no edges between vertices of equal <a data-ref="rank" data-preview-anchor="previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a> that belong to different <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a>.</p><p>Characterizing the missing edges from the perspective of <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> is quite instructive. Consider the algorithm for searching in a <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a>: start in the topmost layer, follow pointers within a layer until overshooting the search target, drop down a layer when you would overshoot. The “missing” edges are exactly the edges that are always guaranteed to overshoot — if they did not overshoot, the search would never have descended into this part of the <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a> in the first place. Search in a <a data-ref="leafy_zip_tree" data-preview-anchor="previews/leafy_zip_tree.html?def§leafy_zip_tree" data-hl="true" href="#leafy_zip_tree">leafy zip-tree</a> encounters a null pointer at the end of each <a data-ref="gnode" data-preview-anchor="previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-node</a>, whereas search in a <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a> blindly dereferences a pointer and performs a comparison whose result is already predetermined.</p><p>As far as we are aware, this observation of two classes of next-pointers in <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> — those that always overshoot in a search, and those which might not overshoot in some searches — is novel. The fact that <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> get to conflate the two classes and algorithmically handle them in a uniform way might well be the underlying reason why <a data-ref="skip_list" data-preview-anchor="previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> are so appealing compared to binary search trees.</p><p>We can easily augment the <a data-ref="leafy_gtree" data-preview-anchor="/g_trees/previews/leafy_gtree.html?def§leafy_gtree" data-hl="true" href="#leafy_gtree">leafy G-trees</a> to generalize the <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> by adding pointers between successive <a data-ref="gnode" data-preview-anchor="/g_trees/previews/gnode.html?def§gnode" data-hl="true" href="#gnode">G-nodes</a> of equal <a data-ref="rank" data-preview-anchor="/g_trees/previews/rank.html?def§rank" data-hl="true" href="#rank">rank</a>. <a data-ref="fig_linked_leafy_bot_gtree" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_gtree.html?def§fig_linked_leafy_bot_gtree" href="#fig_linked_leafy_bot_gtree">Figure 20</a> shows the resulting <dfn id="linked_leafy_gtree"><a data-ref="linked_leafy_gtree" data-preview-anchor="/g_trees/previews/linked_leafy_gtree.html?def§linked_leafy_gtree" data-hl="true" href="#linked_leafy_gtree">linked leafy G-tree</a></dfn> for our running example. <a data-ref="fig_linked_leafy_bot_1zip" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_1zip.html?def§fig_linked_leafy_bot_1zip" href="#fig_linked_leafy_bot_1zip">Figure 21</a> instantiates with a linked list, obtaining a <dfn id="linked_leafy_zip_tree"><a data-ref="linked_leafy_zip_tree" data-preview-anchor="/g_trees/previews/linked_leafy_zip_tree.html?def§linked_leafy_zip_tree" data-hl="true" href="#linked_leafy_zip_tree">linked leafy zip-tree</a></dfn>, i.e., a <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-list</a>. <a data-ref="fig_linked_leafy_bot_2zip" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_2zip.html?def§fig_linked_leafy_bot_2zip" href="#fig_linked_leafy_bot_2zip">Figure 22</a> shows the instantiation with a <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list">2-list</a>, yielding a <dfn id="linked_leafy_2zip_tree"><a data-ref="linked_leafy_2zip_tree" data-preview-anchor="/g_trees/previews/linked_leafy_2zip_tree.html?def§linked_leafy_2zip_tree" data-hl="true" href="#linked_leafy_2zip_tree">linked leafy 2-zip-tree</a></dfn>. Instantiating the <a data-ref="linked_leafy_zip_tree" data-preview-anchor="/g_trees/previews/linked_leafy_zip_tree.html?def§linked_leafy_zip_tree" data-hl="true" href="#linked_leafy_zip_tree">linked leafy zip-trees</a> with <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list"><span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span>-lists</a> gives a family of generalizations of <a data-ref="skip_list" data-preview-anchor="/g_trees/previews/skip_list.html?def§skip_list" data-hl="true" href="#skip_list">skip-lists</a> that store <span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> <a data-ref="item" data-preview-anchor="/g_trees/previews/item.html?def§item" data-hl="true" href="#item">items</a> per vertex. Finding such a family could easily be reason for a dedicated publication, were it not for the fact that the powerful framework of geometric trees gives us this family essentially for free.</p><figure id="fig_linked_leafy_bot_gtree"><img src="https://g-trees.github.io/g_trees/assets/graphics/linkedLeafBotGtree.svg"/><figcaption><p><a data-ref="fig_linked_leafy_bot_gtree" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_gtree.html?def§fig_linked_leafy_bot_gtree" href="#fig_linked_leafy_bot_gtree">Figure 20</a>: Linked Leafy G-Tree</p></figcaption></figure><figure id="fig_linked_leafy_bot_1zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/linkedLeafBot1zip.svg"/><figcaption><p><a data-ref="fig_linked_leafy_bot_1zip" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_1zip.html?def§fig_linked_leafy_bot_1zip" href="#fig_linked_leafy_bot_1zip">Figure 21</a>: Linked Leafy Zip-Tree aka Skip-List</p></figcaption></figure><figure id="fig_linked_leafy_bot_2zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/linkedLeafBot2zip.svg"/><figcaption><p><a data-ref="fig_linked_leafy_bot_2zip" data-preview-anchor="/g_trees/previews/fig_linked_leafy_bot_2zip.html?def§fig_linked_leafy_bot_2zip" href="#fig_linked_leafy_bot_2zip">Figure 22</a>: Linked Leafy 2-Zip-Tree aka 2-Skip-List</p></figcaption></figure><p>To conclude, we point out that linking only the <em>leaves</em> of a <a data-ref="leafy_gtree" data-preview-anchor="/g_trees/previews/leafy_gtree.html?def§leafy_gtree" data-hl="true" href="#leafy_gtree">leafy G-tree</a> yields a family analogous to the <a data-ref="comer1979ubiquitous" data-preview-anchor="/g_trees/previews/comer1979ubiquitous.html?def§comer1979ubiquitous" href="https://g-trees.github.io/g_trees/assets/references/comer1979ubiquitous.pdf"><span>B<sup>+</sup>-trees</span> <span>(<span>Comer</span>, 1979)</span></a>. <a data-ref="fig_gplus_gtree" data-preview-anchor="/g_trees/previews/fig_gplus_gtree.html?def§fig_gplus_gtree" href="#fig_gplus_gtree">Figure 23</a> shows such a <dfn id="gplus_tree"><a data-ref="gplus_tree" data-preview-anchor="/g_trees/previews/gplus_tree.html?def§gplus_tree" data-hl="true" href="#gplus_tree">G<sup>+</sup>-tree</a></dfn>; <a data-ref="fig_gplus_1zip" data-preview-anchor="/g_trees/previews/fig_gplus_1zip.html?def§fig_gplus_1zip" href="#fig_gplus_1zip">Figure 24</a> shows an instantiation with a linked list (a <dfn id="zipplus_tree"><a data-ref="zipplus_tree" data-preview-anchor="/g_trees/previews/zipplus_tree.html?def§zipplus_tree" data-hl="true" href="#zipplus_tree">zip<sup>+</sup>-tree</a></dfn>), and <a data-ref="fig_gplus_2zip" data-preview-anchor="/g_trees/previews/fig_gplus_2zip.html?def§fig_gplus_2zip" href="#fig_gplus_2zip">Figure 25</a> shows an instantiation with a <a data-ref="k_list" data-preview-anchor="/g_trees/previews/k_list.html?def§k_list" data-hl="true" href="#k_list">2-list</a> (a <dfn id="zip2plus_tree"><a data-ref="zip2plus_tree" data-preview-anchor="/g_trees/previews/zip2plus_tree.html?def§zip2plus_tree" data-hl="true" href="#zip2plus_tree">2-zip<sup>+</sup>-tree</a></dfn>).</p><figure id="fig_gplus_gtree"><img src="https://g-trees.github.io/g_trees/assets/graphics/gPlusGtree.svg"/><figcaption><p><a data-ref="fig_gplus_gtree" data-preview-anchor="/g_trees/previews/fig_gplus_gtree.html?def§fig_gplus_gtree" href="#fig_gplus_gtree">Figure 23</a>: G<sup>+</sup>-Tree</p></figcaption></figure><figure id="fig_gplus_1zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/gPlus1zip.svg"/><figcaption><p><a data-ref="fig_gplus_1zip" data-preview-anchor="/g_trees/previews/fig_gplus_1zip.html?def§fig_gplus_1zip" href="#fig_gplus_1zip">Figure 24</a>: Zip<sup>+</sup>-Tree</p></figcaption></figure><figure id="fig_gplus_2zip"><img src="https://g-trees.github.io/g_trees/assets/graphics/gPlus2zip.svg"/><figcaption><p><a data-ref="fig_gplus_2zip" data-preview-anchor="/g_trees/previews/fig_gplus_2zip.html?def§fig_gplus_2zip" href="#fig_gplus_2zip">Figure 25</a>: 2-Zip<sup>+</sup>-Tree</p></figcaption></figure></section><h2 id="explicit_implementations"><a data-ref="explicit_implementations" data-hl="true" data-hsection-level="1" href="#explicit_implementations">Appendix C: Explicit Insertion and Deletion</a></h2><section data-hsection="explicit_implementations"><p>As alluded to in <a data-hsection-level="1" data-ref="implementation" data-hl="true" href="#implementation">Section 5</a>, it is possible to derive direct insertion and deletion functions for <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a> that are analgous to Algorithm 1 from the original <a data-ref="zip_tree" data-preview-anchor="/g_trees/previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a> paper. For completeness, we provide pseudocode for purely functional variants of these functions for <a data-ref="gtree" data-preview-anchor="/g_trees/previews/gtree.html?def§gtree" data-hl="true" href="#gtree">G-trees</a>. The functions leverage the previously defined <a data-ref="c_zip2" data-preview-anchor="/g_trees/previews/c_zip2.html?def§c_zip2" data-hl="true" href="#c_zip2">zip2</a> and various helper functions.</p><p>We also define an additional helper function which joins a possibly empty <a data-ref="c_set" data-preview-anchor="previews/c_set.html?def§c_set" data-hl="true" href="#c_set">Set</a> with a greater <a data-ref="c_neset" data-preview-anchor="previews/c_neset.html?def§c_neset" data-hl="true" href="#c_neset">NonemptySet</a>.:</p><code id="code_explicit_helpers"></code><p>The following explicit <a data-ref="x_delete" data-preview-anchor="previews/x_delete.html?def§x_delete" data-hl="true" href="#x_delete">delete</a> pseudocode follows a very similar structure to Algorithm 1 from <a data-ref="tarjan2021zip" data-preview-anchor="previews/tarjan2021zip.html?def§tarjan2021zip" href="https://g-trees.github.io/g_trees/g_trees/assets/references/tarjan2021zip.pdf"><span></span> <span>(<span><span>Tarjan</span> <span>et al.</span></span>, 2021)</span></a>, though we use pattern matching here for consistency.</p><code id="code_explicit_delete"></code><p>While the explicit insert function requires a bit more code, it also follows the same <em>general structure</em> of its original <a data-ref="zip_tree" data-preview-anchor="previews/zip_tree.html?def§zip_tree" data-hl="true" href="#zip_tree">zip tree</a> counterpart. The bulk of the additional code is devoted to operations on the inner set, whereas the matched patterns remain mostly equivalent.</p><code id="code_explicit_insert"></code></section></section></div></div>
  </body>
</html>
