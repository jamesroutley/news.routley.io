<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lapcatsoftware.com/articles/2024/5/3.html">Original</a>
    <h1>Updating from macOS Ventura to Sonoma Silently Enables iCloud Keychain</h1>
    
    <div id="readability-page-1" class="page">
<nav>
Previous: <a href="https://lapcatsoftware.com/articles/2024/5/2.html">Apple started cheating me out of App Store bundle purchases</a>
</nav>
<header><a href="https://lapcatsoftware.com">Jeff Johnson</a> (<a href="https://underpassapp.com">My apps</a>, <a href="https://www.paypal.me/JeffJohnsonWI">PayPal.Me</a>, <a href="https://mastodon.social/@lapcatsoftware" title="@lapcatsoftware@mastodon.social">Mastodon</a>)</header>
<p><a href="https://lapcatsoftware.com/FeedbackAssistantBoycott/">Feedback Assistant Boycott</a></p>

<h3>May 19 2024</h3>

<p>This is not a new issue. It was discovered last year, and it also affects updating from iOS 16 to iOS 17. As far as I&#39;m aware, I&#39;m the first to have <a href="https://appdot.net/@lapcatsoftware/110776034855270972">noted the issue publicly</a>:</p>
<blockquote>
<p>The latest iPadOS beta seems to have silently enabled iCloud Keychain.</p>
<p>(Although I don’t actually have any passwords on the iPad.)</p>
<p>Jul 25, 2023</p>
</blockquote>
<p>Later, after iOS 17 and macOS 14 were released, the issue was publicized by the security researcher <a href="https://defcon.social/@mysk/111167154833155521">Mysk</a>:</p>
<blockquote>
<p>If you&#39;ve never enabled iCloud Keychain and recently upgraded to iOS 17, chances are good that your passwords are now stored on #Apple servers. As confirmed by many users, #iOS17 secretly turns iCloud Keychain on. This video shows the entire process step by step: <a href="https://files.defcon.social/dcsocial-s3/media_attachments/files/111/167/132/387/029/032/original/28f955ffe69a37e9.mp4">Video</a></p>
<p>Oct 2, 2023</p>
</blockquote>
<p>More context from Mysk: <a href="https://defcon.social/@mysk/111136887406571032">Sep 27, 2023</a> <a href="https://defcon.social/@mysk/111205561282447705">Oct 09, 2023</a> <a href="https://defcon.social/@mysk/111210571231247338">Oct 10, 2023</a></p>
<p>I&#39;ve discovered today that unfortunately this issue—this bug, I would call it, though who knows whether Apple considers it a bug or &#34;expected behavior&#34;—still exists with the latest versions of macOS Ventura and Sonoma, 13.6.7 and 14.5 respectively.</p>
<p>My main development machine, a 2021 M1 MacBook Pro, is still on Ventura, but I plan to update it soon to Sonoma in preparation for Apple&#39;s Worldwide Developer Conference (WWDC) in June, because the new WWDC beta version of Xcode will undoubtedly require the latest version of macOS, as usual. Nowadays, Xcode is the only thing that drags me kicking and screaming to the latest and worst version of macOS. However, I remembered the iCloud Keychain bug and was wary of it, so I decided to do a trial run on an external hard drive to see whether the bug was still there, and sadly it was. The external drive had a macOS Ventura 13.6.7 boot volume with iCloud enabled but iCloud Keychain disabled. After updating the volume to macOS Sonoma 14.5, iCloud Keychain was enabled. (I then disabled iCloud Keychain, which actually caused System Settings to hang and eventually crash, but afterward iCloud Keychain did seem to be disabled.)</p>
<p>I generally try to avoid &#34;cloud&#34; services, because they&#39;ve proven untrustworthy in terms of both reliability and privacy. I avoided iCloud entirely for many years. Ultimately, though, I caved in and enabled iCloud in order to add iCloud sync to my browser extension <a href="https://underpassapp.com/StopTheMadness/">StopTheMadness</a>, because my customers kept requesting it. Money talks. Nonetheless, I still don&#39;t use iCloud for any of my personal data, only for development purposes, so I have most iCloud settings disabled, including iCloud Keychain. While I do trust the inherent security of iCloud Keychain to keep my passwords encrypted, I don&#39;t trust iCloud Keychain to sync reliably. Moreover, the user interface of iCloud Keychain is totally opaque, which I find totally unacceptable. And the recent issue with <a href="https://9to5mac.com/2024/05/17/ios-17-5-deleted-photos-app-bug/">deleted photos reappearing</a> certainly doesn&#39;t inspire confidence in iCloud.</p>
<p>What I&#39;d like to do is update from Ventura to Sonoma without an internet connection, giving Sonoma no chance to upload my passwords or other data to iCloud before I can disable iCloud Keychain. However, I haven&#39;t found a way to do that. Even though I ran <nobr><code>softwareupdate --download</code></nobr> first in Terminal, and even though I disabled System Integrity Protection (SIP) to allow any version of macOS to boot my Mac, <nobr><code>softwareupdate --install</code></nobr> still refused to install with my WiFi disabled. I may have to perform some more trial runs, perhaps disconnecting my WiFi router after macOS reboots into the updater. Hopefully that won&#39;t brick my Mac! We used to be able to update macOS and Mac OS X without an internet connection, so it&#39;s frustrating, not to mention a violation of privacy, that Apple now requires Macs to phone home to Cupertino.</p>
<p>You might wonder why I don&#39;t sign out of iCloud <em>before</em> I update from Ventura to Sonoma. It turns out that there&#39;s no point in that, due to <em>another</em> bug, &#34;Signing out of iCloud and signing back in again forgets all of your previous iCloud settings&#34; (FB12168173), which I also discovered last year. Apple&#39;s &#34;resolution&#34; of this bug was &#34;Investigation complete - Unable to diagnose with current information&#34;. Incidentally, Apple silently resolved this issue without asking me for more information. They don&#39;t seem to care.</p>

<h3>Addendum: Success!</h3>
<p>On my second trial run, I managed to find a way to update from Ventura to Sonoma without an internet connection. My &#34;mistake&#34; in the first trial run was to use <code>softwareupdate --install --restart</code>, which automatically restarts if required to complete the installation. In the second trial, I omitted the <code>--restart</code> argument. When <code>softwareupdate</code> is ready/done it just sits there in Terminal without prompting you, so you&#39;ll need to take the initiative. After successfully running <code>softwareupdate --install</code>, I disabled WiFi, opened System Settings, and deleted my WiFi password from Network settings. You can confirm that the password is gone by checking keychain and also by calling <code>nvram -p | grep preferred-networks</code> in Terminal to make sure the WiFi password is not available to the recovery volume. After that, I simply rebooted, and the Mac automatically goes into install mode.</p>
<p>When the update was done, macOS Sonoma automatically enabled both WiFi and Bluetooth, but it wasn&#39;t connected to WiFi, because it didn&#39;t have the password. (<a href="https://lapcatsoftware.com/articles/bluetooth.html">macOS and iOS automatically re-enable Bluetooth after every software update.</a>) Curiously, iCloud Keychain was not enabled, so I&#39;m guessing that perhaps it tries to enable iCloud Keychain and falls back to disabled if it fails. Thankfully, iCloud Keychain remained disabled after I connected to WiFi again, and even after I rebooted, so this seems like a permanent solution!</p>
<p>Now I need to go back and reinstall Ventura on my Mac mini (where I ran the second trial), because I still need a Ventura test volume. Sigh.</p>

<p><a href="https://lapcatsoftware.com/FeedbackAssistantBoycott/">Feedback Assistant Boycott</a></p>

<header><a href="https://lapcatsoftware.com">Jeff Johnson</a> (<a href="https://underpassapp.com">My apps</a>, <a href="https://www.paypal.me/JeffJohnsonWI">PayPal.Me</a>, <a href="https://mastodon.social/@lapcatsoftware" title="@lapcatsoftware@mastodon.social">Mastodon</a>)</header>
<nav><a href="https://lapcatsoftware.com/articles/index.html" title="The Desolation of Blog">Articles index</a></nav>


</div>
  </body>
</html>
