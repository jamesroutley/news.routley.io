<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/nickm980/smallville">Original</a>
    <h1>Show HN: Smallville â€“ Create generative agents for simulations and games</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">Create your own generative agent simulations for RPG games or research</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-are-generative-agents" aria-hidden="true" href="#what-are-generative-agents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What are Generative Agents?</h2>
<p dir="auto">Generative agents are virtual characters that can learn and adapt to their environment. Using LLM models such as ChatGPT or StableLM, agents are able to observe their surroundings, store memories, and react to state changes in the world</p>
<p dir="auto">Generative Agents save time programming interactions by hand and make NPC&#39;s more realistic / dynamic</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-to-use-generative-agents-server" aria-hidden="true" href="#how-to-use-generative-agents-server"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to Use Generative Agents Server</h2>
<ol dir="auto">
<li>Download and install the Java server.</li>
<li>Use the JavaScript SDK to create your own generative agent.</li>
<li>Connect your generative agent to the server.</li>
<li>Start the server and let your generative agent run in your game.</li>
</ol>
<h2 tabindex="-1" dir="auto"><a id="user-content-getting-started" aria-hidden="true" href="#getting-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Getting Started</h2>
<p dir="auto">Visit the package on npm <a href="https://www.npmjs.com/package/smallville" rel="nofollow">https://www.npmjs.com/package/smallville</a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-install-the-necessary-files" aria-hidden="true" href="#install-the-necessary-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Install the necessary files</h3>
<p dir="auto">Start a new javascript project</p>


<p dir="auto">Download the compiled jar from releases</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-start-writing-code" aria-hidden="true" href="#start-writing-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Start writing code</h3>
<p dir="auto">Create new agents (as seen in the example project) <a href="https://github.com/nickm980/smallville/blob/main/example/javascript/smallville.js">example project</a></p>
<div dir="auto" data-snippet-clipboard-copy-content="const sim = new Smallville({
        host: &#34;http://localhost:8080&#34;, // host of the server
        stateHandler: function(state) {
                //in here you would update the location of the agent using your own pathfinding algorithm
                const currentLocation = state.agents[0].getCurrentLocation()
                const newLocation = state.agents[0].getNextLocation()
                const emoji = state.agents[0].getEmoji()
                const activity = state.agents[0].getCurrentActivity()
                
                const updatedLocations = state.locations;
                
                const conversations = state.conversations;
                
                console.log(&#39;[State Change]: The simulation has been updated&#39;)
    },
});
"><pre><span>const</span> <span>sim</span> <span>=</span> <span>new</span> <span>Smallville</span><span>(</span><span>{</span>
        <span>host</span>: <span>&#34;http://localhost:8080&#34;</span><span>,</span> <span>// host of the server</span>
        <span>stateHandler</span>: <span>function</span><span>(</span><span>state</span><span>)</span> <span>{</span>
                <span>//in here you would update the location of the agent using your own pathfinding algorithm</span>
                <span>const</span> <span>currentLocation</span> <span>=</span> <span>state</span><span>.</span><span>agents</span><span>[</span><span>0</span><span>]</span><span>.</span><span>getCurrentLocation</span><span>(</span><span>)</span>
                <span>const</span> <span>newLocation</span> <span>=</span> <span>state</span><span>.</span><span>agents</span><span>[</span><span>0</span><span>]</span><span>.</span><span>getNextLocation</span><span>(</span><span>)</span>
                <span>const</span> <span>emoji</span> <span>=</span> <span>state</span><span>.</span><span>agents</span><span>[</span><span>0</span><span>]</span><span>.</span><span>getEmoji</span><span>(</span><span>)</span>
                <span>const</span> <span>activity</span> <span>=</span> <span>state</span><span>.</span><span>agents</span><span>[</span><span>0</span><span>]</span><span>.</span><span>getCurrentActivity</span><span>(</span><span>)</span>
                
                <span>const</span> <span>updatedLocations</span> <span>=</span> <span>state</span><span>.</span><span>locations</span><span>;</span>
                
                <span>const</span> <span>conversations</span> <span>=</span> <span>state</span><span>.</span><span>conversations</span><span>;</span>
                
                <span>console</span><span>.</span><span>log</span><span>(</span><span>&#39;[State Change]: The simulation has been updated&#39;</span><span>)</span>
    <span>}</span><span>,</span>
<span>}</span><span>)</span><span>;</span></pre></div>
<p dir="auto">Create new location trees</p>
<div dir="auto" data-snippet-clipboard-copy-content="sim.createLocation({
   name: &#39;Barn&#39;,
   description: &#39;An empty barn&#39;
})

sim.createLocation({
   name: &#39;Hay Pile&#39;,
   parent: &#39;Barn&#39;,
   description: &#39;A hay pile&#39;,
   state: &#39;Full&#39;  
})"><pre><span>sim</span><span>.</span><span>createLocation</span><span>(</span><span>{</span>
   <span>name</span>: <span>&#39;Barn&#39;</span><span>,</span>
   <span>description</span>: <span>&#39;An empty barn&#39;</span>
<span>}</span><span>)</span>

<span>sim</span><span>.</span><span>createLocation</span><span>(</span><span>{</span>
   <span>name</span>: <span>&#39;Hay Pile&#39;</span><span>,</span>
   <span>parent</span>: <span>&#39;Barn&#39;</span><span>,</span>
   <span>description</span>: <span>&#39;A hay pile&#39;</span><span>,</span>
   <span>state</span>: <span>&#39;Full&#39;</span>  
<span>}</span><span>)</span></pre></div>
<p dir="auto">Add new agents and initialize their memory stream with starting memories</p>
<div dir="auto" data-snippet-clipboard-copy-content="sim.createAgent({
  name: &#39;John&#39;,
  location: &#39;Barn: Hay Pile&#39;,
  memories: [
    &#34;John is a farmer at the Barn&#34;,
    &#34;John is a nice and outgoing person&#34;
  ]
})"><pre><span>sim</span><span>.</span><span>createAgent</span><span>(</span><span>{</span>
  <span>name</span>: <span>&#39;John&#39;</span><span>,</span>
  <span>location</span>: <span>&#39;Barn: Hay Pile&#39;</span><span>,</span>
  <span>memories</span>: <span>[</span>
    <span>&#34;John is a farmer at the Barn&#34;</span><span>,</span>
    <span>&#34;John is a nice and outgoing person&#34;</span>
  <span>]</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">Increment the time clock. The simulation will get the current time and update the agents state</p>

<p dir="auto">Keep calling sim.next whenever you want to update the simulation step</p>
<p dir="auto">To add new observations to the agent which they will prompt a reaction to use the following method</p>
<div dir="auto" data-snippet-clipboard-copy-content="sim.addObservation({name: &#34;Full Agent Name&#34;, observation: &#34;memory description&#34;, reactable: true})"><pre><span>sim</span><span>.</span><span>addObservation</span><span>(</span><span>{</span><span>name</span>: <span>&#34;Full Agent Name&#34;</span><span>,</span> <span>observation</span>: <span>&#34;memory description&#34;</span><span>,</span> <span>reactable</span>: <span>true</span><span>}</span><span>)</span></pre></div>
<p dir="auto">Such observations such as encountering another agent or discovering a location should make use of this</p>
<p dir="auto">For observatonal purposes, you can also ask an agent a question which will use their relevant memories to answer the question</p>
<div data-snippet-clipboard-copy-content="sim.askQuestion(&#34;John&#34;, &#34;What do you do in your free time&#34;)"><pre><code>sim.askQuestion(&#34;John&#34;, &#34;What do you do in your free time&#34;)
</code></pre></div>
<p dir="auto">This will not store the question in the agents memory unless you call <code>sim.addObservation()</code></p>
<p dir="auto">Furthermore, locations should be given as a full tree. ex)</p>
<div dir="auto" data-snippet-clipboard-copy-content="location: &#34;Island: Red House: desk&#34;"><pre>location: <span>&#34;Island: Red House: desk&#34;</span></pre></div>
<p dir="auto">And the leaf node (in this example desk), should have a state, although it is not necessary. Adding states to leaf locations enables the agents to interact with the world. To get the leaf location and move the agent to the location you can use our utility function <code>getLeafLocation(location)</code> or make your own method.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-running-the-server" aria-hidden="true" href="#running-the-server"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Running the server</h2>
<p dir="auto">Running the Server
The Smallville World Simulator comes with a Java 17 server that you can use to store the simulation data.</p>
<p dir="auto">Run the following command in the same directory as your jar file downloaded from releases</p>
<div data-snippet-clipboard-copy-content="java -jar smallville-server.jar --api-key &lt;OPEN_AI_KEY&gt; --port 8080"><pre><code>java -jar smallville-server.jar --api-key &lt;OPEN_AI_KEY&gt; --port 8080
</code></pre></div>
<p dir="auto">The server will start on the default port 8080 unless specified otherwise</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-example" aria-hidden="true" href="#example"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/81270095/233894690-97aedf01-7b20-4c8d-a48c-e234fdc0f4bf.png"><img src="https://user-images.githubusercontent.com/81270095/233894690-97aedf01-7b20-4c8d-a48c-e234fdc0f4bf.png" alt="image"/></a></p>
<p dir="auto">The example is under the example directory. Start a node server on that port and run the java server to start the simulation. This example isn&#39;t finished yet but is a basic example of how to get started.
<a href="https://github.com/nickm980/smallville/blob/main/example">example javascript project</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-todo" aria-hidden="true" href="#todo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>TODO:</h2>
<ul dir="auto">
<li>Reflections</li>
<li>Improve conversations</li>
<li>Finish example game</li>
<li>Improve memory retrieval</li>
<li>Improve token embeddings</li>
<li>Add option to use StableLM</li>
<li>Bug fixes on location state updates</li>
<li>Work on a way around possible timeouts from long request wait times</li>
<li>Improve test coverage</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-info" aria-hidden="true" href="#info"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Info</h2>
<p dir="auto">Code based on Generative Agents: Interactive Simulacra of Human Behavior <a href="https://arxiv.org/pdf/2304.03442.pdf" rel="nofollow">https://arxiv.org/pdf/2304.03442.pdf</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-getting-help" aria-hidden="true" href="#getting-help"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Getting Help</h2>
<p dir="auto">If you need help getting started with smallville you can join our community discord <a href="https://discord.gg/ktXPsgbFp5" rel="nofollow">https://discord.gg/ktXPsgbFp5</a></p>
</article>
          </div></div>
  </body>
</html>
