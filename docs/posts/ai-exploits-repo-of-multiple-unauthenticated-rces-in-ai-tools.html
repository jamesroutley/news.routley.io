<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/protectai/ai-exploits">Original</a>
    <h1>AI-Exploits: Repo of multiple unauthenticated RCEs in AI tools</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><div dir="auto">

  <p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/5151193/283524220-aef11c4a-d758-45fe-aab8-c9df714cdbe5.png"><img width="250" src="https://user-images.githubusercontent.com/5151193/283524220-aef11c4a-d758-45fe-aab8-c9df714cdbe5.png" alt="AI Exploits Logo"/></a>
</p></div>
<p dir="auto">The AI world has a security problem and it&#39;s not just in the inputs given to LLMs such as ChatGPT. Based
on research done by <a href="https://protectai.com" rel="nofollow">Protect AI</a> and independent security experts on the <a href="https://huntr.com" rel="nofollow">Huntr</a> Bug Bounty Platform, there are far more impactful and practical attacks
against the tools, libraries and frameworks used to build, train, and deploy machine learning models. Many of these
attacks lead to complete system takeovers and/or loss of sensitive data, models, or credentials most often without the need
for authentication.</p>
<p dir="auto">With the release of this repository, <a href="https://protectai.com" rel="nofollow">Protect AI</a> hopes to demystify to the Information Security community what practical attacks against AI/Machine Learning infrastructure look like in the real world and raise awareness to the amount of vulnerable components that currently exist in the AI/ML ecosystem. More vulnerabilities can be found here: <a href="https://protectai.com/threat-research/november-vulnerability-report" rel="nofollow">November Vulnerability Report</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-overview" aria-hidden="true" tabindex="-1" href="#overview"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Overview</h2>
<p dir="auto">This repository, <strong>ai-exploits</strong>, is a collection of exploits and scanning templates for responsibly disclosed vulnerabilities affecting machine learning tools.</p>
<p dir="auto">Each vulnerable tool has a number of subfolders containing three types of utilities: <a href="https://github.com/rapid7/metasploit-framework">Metasploit</a> modules, <a href="https://github.com/projectdiscovery/nuclei">Nuclei</a> templates
and CSRF templates. Metasploit modules are for security professionals looking to exploit the vulnerabilies and Nuclei templates are for scanning a large number of remote servers to determine if they&#39;re vulnerable.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-demo" aria-hidden="true" tabindex="-1" href="#demo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Demo</h2>
<p dir="auto">Video demonstrating running one of the Metasploit modules against Ray:</p>
<p dir="auto"><a href="https://youtu.be/5aSwPQKKhi4" rel="nofollow"><img src="https://camo.githubusercontent.com/d2c9b4ca37d34b0d5f8e06f798dc80041a7f5f4354ddccec2307e529ae3b3ed5/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f3561537750514b4b6869342f302e6a7067" alt="Exploit Demo" data-canonical-src="https://img.youtube.com/vi/5aSwPQKKhi4/0.jpg"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-setup--usage" aria-hidden="true" tabindex="-1" href="#setup--usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Setup &amp; Usage</h2>
<p dir="auto">The easiest way to use the modules and scanning templates is to build and run the Docker image provided by the <code>Dockerfile</code> in this repository. The Docker image will have Metasploit and Nuclei already installed along with all the necessary configuration.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-docker" aria-hidden="true" tabindex="-1" href="#docker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Docker</h3>
<ol dir="auto">
<li>
<p dir="auto">Build the image:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker build -t protectai/ai-exploits https://github.com/protectai/AI-exploits"><pre>docker build -t protectai/ai-exploits https://github.com/protectai/AI-exploits</pre></div>
</li>
<li>
<p dir="auto">Run the docker image:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -it --rm protectai/ai-exploits /bin/bash"><pre>docker run -it --rm protectai/ai-exploits /bin/bash</pre></div>
</li>
</ol>
<p dir="auto">The latter command will drop you into a <code>bash</code> session in the container with <code>msfconsole</code> and <code>nuclei</code> ready to go.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-the-metasploit-modules" aria-hidden="true" tabindex="-1" href="#using-the-metasploit-modules"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using the Metasploit Modules</h3>
<h4 tabindex="-1" dir="auto"><a id="user-content-with-docker" aria-hidden="true" tabindex="-1" href="#with-docker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>With Docker</h4>
<p dir="auto">Start the Metasploit console (the new modules will be available under the <code>exploits/protectai</code> category), load a module, set the options, and run the exploit.</p>
<div dir="auto" data-snippet-clipboard-copy-content="msfconsole
msf6 &gt; use exploit/protectai/ray_job_rce
msf6 exploit(protectai/ray_job_rce) &gt; set RHOSTS &lt;target IP&gt;
msf6 exploit(protectai/ray_job_rce) &gt; run"><pre>msfconsole
msf6 <span>&gt;</span> use exploit/protectai/ray_job_rce
msf6 exploit(protectai/ray_job_rce) <span>&gt;</span> <span>set</span> RHOSTS <span>&lt;</span>target IP<span>&gt;</span>
msf6 exploit(protectai/ray_job_rce) <span>&gt;</span> run</pre></div>
<h4 tabindex="-1" dir="auto"><a id="user-content-with-metasploit-installed-locally" aria-hidden="true" tabindex="-1" href="#with-metasploit-installed-locally"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>With Metasploit Installed Locally</h4>
<p dir="auto">Create a folder <code>~/.msf4/modules/exploits/protectai</code> and copy the exploit modules into it.</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir -p ~/.msf4/modules/exploits/protectai
cp ai-exploits/ray/msfmodules/* ~/.msf4/modules/exploits/protectai
msfconsole
msf6 &gt; use exploit/protectai/&lt;exploit_name.py&gt;"><pre>mkdir -p <span>~</span>/.msf4/modules/exploits/protectai
cp ai-exploits/ray/msfmodules/<span>*</span> <span>~</span>/.msf4/modules/exploits/protectai
msfconsole
msf6 <span>&gt;</span> use exploit/protectai/<span>&lt;</span>exploit_name.py<span>&gt;</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-nuclei-templates" aria-hidden="true" tabindex="-1" href="#using-nuclei-templates"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using Nuclei Templates</h3>
<p dir="auto">Nuclei is a vulnerability scanning engine which can be used to scan large numbers of servers for known vulnerabilities in web applications and networks.</p>
<p dir="auto">Navigate to nuclei templates folder such as <code>ai-exploits/mlflow/nuclei-templates</code>. In the Docker container these are stored in the <code>/root/nuclei-templates</code> folder. Then simply point to the template file and the target server.</p>
<div data-snippet-clipboard-copy-content="cd ai-exploits/mlflow/nuclei-templates
nuclei -t mlflow-lfi.yaml -u http://&lt;target&gt;:&lt;port&gt;`"><pre><code>cd ai-exploits/mlflow/nuclei-templates
nuclei -t mlflow-lfi.yaml -u http://&lt;target&gt;:&lt;port&gt;`
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-using-csrf-templates" aria-hidden="true" tabindex="-1" href="#using-csrf-templates"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using CSRF Templates</h3>
<p dir="auto">Cross-Site Request Forgery (CSRF) vulnerabilities enable attackers to stand up a web server hosting a malicious HTML page
that will execute a request to the target server on behalf of the victim. This is a common attack vector for exploiting
vulnerabilities in web applications, including web applications which are only exposed on the localhost interface and
not to the broader network. Below is a simple demo example of how to use a CSRF template to exploit a vulnerability in a
web application.</p>
<p dir="auto">Start a web server in the csrf-templates folder. Python allows one to stand up a simple web server in any
directory. Navigate to the template folder and start the server.</p>
<div dir="auto" data-snippet-clipboard-copy-content="cd ai-exploits/ray/csrf-templates
python3 -m http.server 9999"><pre><span>cd</span> ai-exploits/ray/csrf-templates
python3 -m http.server 9999</pre></div>
<p dir="auto">Now visit the web server address you just stood up (<a href="http://127.0.0.1:9999" rel="nofollow">http://127.0.0.1:9999</a>) and hit F12 to open
the developer tools, then click the Network tab. Click the link to ray-cmd-injection-csrf.html. You should see that
the browser sent a request to the vulnerable server on your behalf.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-contribution-guidelines" aria-hidden="true" tabindex="-1" href="#contribution-guidelines"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contribution Guidelines</h2>
<p dir="auto">We welcome contributions to this repository. Please read our <a href="https://github.com/protectai/ai-exploits/blob/main/CONTRIBUTING.md">Contribution Guidelines</a> for more information on how to contribute.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-license" aria-hidden="true" tabindex="-1" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>License</h2>
<p dir="auto">This project is licensed under the <a href="https://github.com/protectai/ai-exploits/blob/main/LICENSE">Apache 2.0 License</a>.</p>
</article>
          </div></div>
  </body>
</html>
