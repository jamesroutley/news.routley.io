<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/eashanhatti/peridot">Original</a>
    <h1>Peridot: A functional language based on two-level type theory</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/eashanhatti/peridot/blob/master/logo.png"><img src="https://github.com/eashanhatti/peridot/raw/master/logo.png" alt="Peridot logo"/></a></p>
<p dir="auto">An experimental language for exploring the practical applications of two level type theory.</p>
<p dir="auto">Discussion takes place on the <a href="https://discord.gg/jFZ8JyUNtn" rel="nofollow">r/ProgrammingLanguages Discord server</a> in the #peridot channel.</p>
<h3 dir="auto"><a id="user-content-references-and-inspiration" aria-hidden="true" href="#references-and-inspiration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>References and Inspiration</h3>
<ul dir="auto">
<li><a href="https://github.com/eashanhatti/peridot/blob/master/REFERENCES.md">REFERENCES.md</a>: A list of prior art that have influenced Peridot&#39;s design and implementation in major ways</li>
</ul>
<h3 dir="auto"><a id="user-content-information" aria-hidden="true" href="#information"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Information</h3>
<ul dir="auto">
<li><a href="https://github.com/eashanhatti/peridot/blob/master/notes/RATIONALE.md">RATIONALE.md</a>: An in-depth explanation of Peridot&#39;s design rationale</li>
<li><a href="https://github.com/eashanhatti/peridot/blob/master/notes/OLD_VS_NEW.md">OLD_VS_NEW.md</a>: A comparison of Peridot and <a href="https://github.com/eashanhatti/konna">Konna</a>, a previous project of mine also based on 2LTT</li>
</ul>
<h3 dir="auto"><a id="user-content-introduction" aria-hidden="true" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction</h3>
<p dir="auto">Peridot is a functional/logic language based on 2LTT (two level type theory). It uses a logic language for the meta level, which allows for domain specific, declarative optimizers to be written entirely in userspace - writers of optimizers can focus on purely on the optimizations themselves. Meanwhile, the object language is high-level, dependently typed, and functional. Here&#39;s a very simple example of optimizing arithmetic:</p>
<div data-snippet-clipboard-copy-content="-- optimize `x * 2` to `x &lt;&lt; 1`
optimize {~x * 2} {~y &lt;&lt; 1} :- optimize x y.

-- optimize `x * y / y` to `x`
optimize {(~x * ~y) / ~y} {~z} :- optimize x z.

-- optimize both sides of a division
optimize {~x / ~y} {~z / ~w} :-
  optimize x z,
  optimize y w.

optimize {~x} {~x} :- int_literal x.

main =
    -- c = {3}, c = {(3 &lt;&lt; 1) / 2}
    let optimize {(3 * 2) / 2} c
    -- 3
    in print ~(select smallest c)"><pre><span><span>--</span> optimize `x * 2` to `x &lt;&lt; 1`</span>
optimize {<span>~</span>x <span>*</span> <span>2</span>} {<span>~</span>y <span>&lt;&lt;</span> <span>1</span>} <span>:-</span> optimize x y<span>.</span>

<span><span>--</span> optimize `x * y / y` to `x`</span>
optimize {(<span>~</span>x <span>*</span> <span>~</span>y) <span>/</span> <span>~</span>y} {<span>~</span>z} <span>:-</span> optimize x z<span>.</span>

<span><span>--</span> optimize both sides of a division</span>
optimize {<span>~</span>x <span>/</span> <span>~</span>y} {<span>~</span>z <span>/</span> <span>~</span>w} <span>:-</span>
  optimize x z,
  optimize y w<span>.</span>

optimize {<span>~</span>x} {<span>~</span>x} <span>:-</span> int_literal x<span>.</span>

main <span>=</span>
    <span><span>--</span> c = {3}, c = {(3 &lt;&lt; 1) / 2}</span>
    <span>let</span> optimize {(<span>3</span> <span>*</span> <span>2</span>) <span>/</span> <span>2</span>} c
    <span><span>--</span> 3</span>
    <span>in</span> <span>print</span> <span>~</span>(select smallest c)</pre></div>
</article>
          </div></div>
  </body>
</html>
