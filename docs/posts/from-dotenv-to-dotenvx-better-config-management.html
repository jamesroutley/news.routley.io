<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dotenvx.com/blog/2024/06/24/dotenvx-next-generation-config-management.html">Original</a>
    <h1>Show HN: From dotenv to dotenvx ‚Äì better config management</h1>
    
    <div id="readability-page-1" class="page"><div>
      <p>The day after July 4th üá∫üá∏, I wrote <a href="https://github.com/motdotla/dotenv/commit/71dabbf27b699fcb7a04714709cecfc6e78892b9">dotenv‚Äôs first commit</a> and released <a href="https://www.npmjs.com/package/dotenv/v/0.0.1">version 0.0.1 on npm</a>. It looked like this.</p>

<p><img src="https://github.com/dotenvx/dotenvx/assets/3848/632a3bf4-50f4-4614-a0c2-12b2f6e64ccc" loading="lazy"/></p>

<p>In the 11 years since, it‚Äôs become one of the <a href="https://gist.github.com/anvaka/8e8fa57c7ee1350e3491#top-1000-most-depended-upon-packages">most depended-upon packages</a> worldwide üåé ‚Äì adjacent ubiquitous software like TypeScript and ESLint.</p>

<p><img src="https://github.com/dotenvx/dotenvx/assets/3848/3b93fa70-8204-4563-b5b5-a3a2dcfb3de3" loading="lazy"/></p>

<p>It‚Äôs an example of ‚Äúbig things have small beginnings‚Äù. The <a href="https://github.com/motdotla/dotenv/commit/71dabbf27b699fcb7a04714709cecfc6e78892b9#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5">README</a> was short and the <a href="https://github.com/motdotla/dotenv/commit/71dabbf27b699fcb7a04714709cecfc6e78892b9#diff-7934bf411fea192ad8cd69e0a12911648a2842cb0f2409a8fb67b41b7069d757">code was humble</a>, but today it‚Äôs beloved by millions of developers.</p>

<p>It‚Äôs one of the few security tools that improve your security posture with minimal fuss.</p>

<ul>
  <li>a single line of code - <code>require(&#39;dotenv&#39;).config()</code>
</li>
  <li>a single file - <code>.env</code>
</li>
  <li>a single gitignore append - <code>echo &#39;.env&#39; &gt; .gitignore</code>
</li>
</ul>

<p>It‚Äôs aesthetic, it‚Äôs effective, it‚Äôs elegant.</p>

<p><strong>But it‚Äôs not without its problems!</strong> And that‚Äôs what I want to talk about.</p>

<h2 id="the-problems-with-dotenv">The problems with <code>dotenv</code>
</h2>

<p>In order of importance, there are three big problems with <code>dotenv</code>:</p>

<ol>
  <li><em>leaking your .env file</em></li>
  <li><em>juggling multiple environments</em></li>
  <li><em>inconsistency across platforms</em></li>
</ol>

<p>All three pose risks to security, and the first does SIGNIFICANTLY.</p>

<p><strong>But I think we have a solution to all three today - with <a href="https://github.com/dotenvx/dotenvx">dotenvx</a></strong>. In reverse problem order:</p>

<ul>
  <li>
<a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#run-anywhere">Run Anywhere</a> -&gt; <em>inconsistency across platforms</em>
</li>
  <li>
<a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#multiple-environments">Multiple Environments</a> -&gt; <em>juggling multiple environments</em>
</li>
  <li>
<a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#encryption">Encryption</a> -&gt; <em>leaking your .env file</em>
</li>
</ul>

<p>Let‚Äôs dig into each. I‚Äôll do my best to show rather than tell.</p>

<h2 id="run-anywhere">Run Anywhere</h2>

<p><a href="https://github.com/dotenvx/dotenvx">dotenvx</a> works the same across every language, framework, and platform ‚Äì inject your env at runtime with <code>dotenvx run -- your-cmd</code>.</p>

<pre><code>$ echo &#34;HELLO=World&#34; &gt; .env
$ echo &#34;console.log(&#39;Hello &#39; + process.env.HELLO)&#34; &gt; index.js

$ node index.js
Hello undefined # without dotenvx

$ dotenvx run -- node index.js
Hello World # with dotenvx
&gt; :-D
</code></pre>

<p>The <a href="https://github.com/dotenvx/dotenvx/blob/6f5a91370437716c93ead3e4400d1ee46e2b77ef/src/lib/helpers/parseDecryptEvalExpand.js#L6">.env parsing engine</a>, <a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#run-anywhere">variable expansion</a>, <a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#run-anywhere">command substitution</a>, and more work exactly the same. Install dotenvx via <a href="https://dotenvx.com/docs/install#npm">npm</a>, <a href="https://dotenvx.com/docs/install#brew">brew</a>, <a href="https://dotenvx.com/docs/install#shell">curl</a>, <a href="https://dotenvx.com/docs/install#docker">docker</a>, <a href="https://docs/install#windows">windows</a>, and <a href="https://dotenvx.com/docs/install">more</a>.</p>

<p>This solves the problem of <em>inconsistency across platforms</em>. ‚úÖ You‚Äôll get the exact same behavior for your <a href="https://dotenvx.com/docs/guides#python">python apps</a> as your <a href="https://dotenvx.com/docs/guides#node-js">node apps</a> as your <a href="https://dotenvx.com/docs/guides#go">rust apps</a>.</p>

<p><a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#run-anywhere"><img src="https://github.com/dotenvx/dotenvx/assets/3848/6a43eb52-4b1d-48c2-8c7a-b62cb35b526b" loading="lazy"/></a></p>

<h2 id="multiple-environments">Multiple Environments</h2>

<p>Create a <code>.env.production</code> file and use <code>-f</code> to load it. It‚Äôs straightforward, yet flexible.</p>

<pre><code>$ echo &#34;HELLO=production&#34; &gt; .env.production
$ echo &#34;console.log(&#39;Hello &#39; + process.env.HELLO)&#34; &gt; index.js

$ dotenvx run -f .env.production -- node index.js
[dotenvx][info] loading env (1) from .env.production
Hello production
&gt; ^^
</code></pre>

<p>While everything in <a href="https://github.com/dotenvx/dotenvx">dotenvx</a> is inspired by community suggestions, this multi-environment feature particularly is. There were suggestions many times for something similar before I came to understand its usefulness. I‚Äôm convinvced now it cleanly solves the problem of <em>juggling multiple environments</em> when built into the command line. ‚úÖ</p>

<p>You can even compose multiple environments together with multiple <code>-f</code> flags.</p>

<pre><code>$ echo &#34;HELLO=local&#34; &gt; .env.local
$ echo &#34;HELLO=World&#34; &gt; .env
$ echo &#34;console.log(&#39;Hello &#39; + process.env.HELLO)&#34; &gt; index.js

$ dotenvx run -f .env.local -f .env -- node index.js
[dotenvx] injecting env (1) from .env.local, .env
Hello local
</code></pre>

<p><a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#multiple-environments"><img src="https://github.com/dotenvx/dotenvx/assets/3848/8983a359-32f9-459a-861c-66bfdf4e87a1" loading="lazy"/></a></p>

<p>Handy! But it‚Äôs the next feature, <strong>encryption</strong>, that is the real game changer (and I think merits dotenvx as the <em>next generation of configuration management</em>).</p>

<h2 id="encryption">Encryption</h2>

<p>Add encryption to your .env files with a single command. Run <code>dotenvx encrypt</code>.</p>

<pre><code>$ dotenvx encrypt
‚úî encrypted (.env)
</code></pre>

<pre><code>#/-------------------[DOTENV_PUBLIC_KEY]--------------------/
#/            public-key encryption for .env files          /
#/       [how it works](https://dotenvx.com/encryption)     /
#/----------------------------------------------------------/
DOTENV_PUBLIC_KEY=&#34;03f8b376234c4f2f0445f392a12e80f3a84b4b0d1e0c3df85c494e45812653c22a&#34;

# Database configuration
DB_HOST=&#34;encrypted:BNr24F4vW9CQ37LOXeRgOL6QlwtJfAoAVXtSdSfpicPDHtqo/Q2HekeCjAWrhxHy+VHAB3QTg4fk9VdIoncLIlu1NssFO6XQXN5fnIjXRmp5pAuw7xwqVXe/1lVukATjG0kXR4SHe45s4Tb6fEjs&#34;
DB_PORT=&#34;encrypted:BOCHQLIOzrq42WE5zf431xIlLk4iRDn1/hjYBg5kkYLQnL9wV2zEsSyHKBfH3mQdv8w4+EhXiF4unXZi1nYqdjVp4/BbAr777ORjMzyE+3QN1ik1F2+W5DZHBF9Uwj69F4D7f8A=&#34;
DB_USER=&#34;encrypted:BP6jIRlnYo5LM6/n8GnOAeg4RJlPD6ZN/HkdMdWfgfbQBuZlo44idYzKApdy0znU3TSoF5rcppXIMkxFFuB6pS0U4HMG/jl46lPCswl3vLTQ7Gx5EMT6YwE6pfA88AM77/ebQZ6y0L5t&#34;
DB_PASSWORD=&#34;encrypted:BMycwcycXFFJQHjbt1i1IBS7C31Fo73wFzPolFWwkla09SWGy3QU1rBvK0YwdQmbuJuztp9JhcNLuc0wUdlLZVHC4/E6q/K7oPULNPxC5K1LwW4YuX80Ngl6Oy13Twero864f2DXXTNb&#34;
DB_NAME=&#34;encrypted:BGtVHZBbvHmX6J+J+xm+73SnUFpqd2AWOL6/mHe1SCqPgMAXqk8dbLgqmHiZSbw4D6VquaYtF9safGyucClAvGGMzgD7gdnXGB1YGGaPN7nTpJ4vE1nx8hi1bNtNCr5gEm7z+pdLq1IsH4vPSH4O7XBx&#34;

# API Keys
API_KEY=&#34;encrypted:BD9paBaun2284WcqdFQZUlDKapPiuE/ruoLY7rINtQPXKWcfqI08vFAlCCmwBoJIvd2Nv3ACiSCA672wsKeJlFJTcRB6IRRJ+fPBuz2kvYlOiec7EzHTT8EVzSDydFun5R5ODfmN&#34;
STRIPE_API_KEY=&#34;encrypted:BM6udWmFsPaBzlND0dFBv7R55JiaA+cZnbun8DaVNrEvO+8/k+lsXbZQ0bCPks8kUsdD2qrSp/tii0P8gVJ/gp+pdDuhdcJj91hxJ7nzSFf6h0ofRb38/2WHFhxg77XExxzui1s3w42Z&#34;

# Logging
LOG_LEVEL=&#34;encrypted:BKmgv5E7/l1FnSaGWYWBPxxagdgN+KSEaB+va3PePjwEp7CqW6PlysrweZq49YTB5Fbc3UN/akLVn1RZ2AO4PyTVqgYYGBwerjpJiou9R2KluNV3T4j0bhsAkBochg3YpHcw3RX/&#34;
</code></pre>

<p>A <code>DOTENV_PUBLIC_KEY</code> (encryption key) and a <code>DOTENV_PRIVATE_KEY</code> (decryption key) are generated using the same public-key cryptography as <a href="https://en.bitcoin.it/wiki/Secp256k1">Bitcoin</a>.</p>

<p>Now, even if you leak your .env file, it‚Äôs ok. An attacker needs the <code>DOTENV_PRIVATE_KEY</code> to make sense of things. This effectively solves the problem of <em>leaking your .env file</em> ‚úÖ.</p>

<p><a href="https://github.com/dotenvx/dotenvx?tab=readme-ov-file#encryption"><img src="https://github.com/dotenvx/dotenvx/assets/3848/42aef834-50d9-4187-93e4-b5230ae1253a" loading="lazy"/></a></p>

<p><strong>Bonus:</strong> This approach additionally makes it possible for contributors to add config while simultaneously being unable to decrypt config. I anticipate this will be useful for open source projects where you want to allow for contribution of secrets without decryption of prior secrets.</p>

<h2 id="100-release">1.0.0 Release</h2>

<p>With that, we‚Äôre pleased to announce the release of <a href="https://www.npmjs.com/package/@dotenvx/dotenvx">dotenvx version 1.0.0</a> üéâ.</p>

<p>It is the <em>next generation of configuration management</em>, and I‚Äôm looking forward to what you do with it. The next decade (like the last) is bright for dotenv! üåü</p>

<hr/>

<p>If you enjoyed this post, please <a href="https://github.com/dotenvx/dotenvx">share dotenvx with friends</a> or <a href="https://github.com/dotenvx/dotenvx">star it on GitHub</a> to help spread the word.</p>

    </div></div>
  </body>
</html>
