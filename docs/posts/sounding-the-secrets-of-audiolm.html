<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.shaped.ai/blog/sounding-the-secrets-of-audiolm">Original</a>
    <h1>Sounding the Secrets of AudioLM</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><div><div><p><span>Among all the recent hype regarding OpenAI’s ChatGPT, a few prominent industry players in AI are getting ready to release their new fantastic generative models. If ChatGPT is well suited for tackling text, the team at Google AI decided to go further and create a model capable of generating sound, in the new paper titled AudioLM: a Language Modeling Approach to Audio Generation, presents a new framework for generating high-quality sound, ranging from different kinds of human speech to musical instruments from sound alone. Unlike previous approaches, the team found a way to not use text transcription or </span><a href="https://magenta.tensorflow.org/music-transformer" target="_blank"><span>MIDI representations for the piano</span></a><span>.</span></p><p><span>Generating realistic audio is a complex task that involves modeling information at different scales. Just as music combines individual notes to create complex melodies, speech uses phonemes and syllables to form words and sentences. Music is challenging as well, as not only the appropriate notes are required, but to generate new pieces, the model would need to keep the pace and style intact. Both of these tasks increase in complexity if we want to generate something natural and of high quality.</span></p><p><span>Sound in fact is sometimes considered a more challenging task compared to text and we will see why soon. This, however, didn’t stop the team at Google from achieving a new milestone with their </span><a href="https://google-research.github.io/seanet/audiolm/examples/" target="_blank"><span>AudioLM</span></a><span> model. In this post, we will dive into key ideas that power AudioLM, explain why and how they are important, and divine the potential impact of this new innovation for the future of AI.</span></p><h2><span>Why is creating sound hard?</span></h2><p><span>Sound at its core is one of the essential ways for us to experience the world. From the myriad of languages, we use to communicate to music to figure out what is wrong with your old car’s engine. The physical properties of sound as a wave are a double-edged sword, on one hand, our knowledge of signal processing is what allows us to model it but the complexities of working with signals are also what makes it so challenging. </span></p><p><span>Audio signals are complex, multi-layered entities that can consist of speech, music, or environmental sounds. Analyzing audio signals requires an understanding of multiple scales of abstractions. For example, speech can be analyzed at a local level, such as acoustic or phonetic analysis, as well as at a higher level, including prosody, syntax, grammar, and semantics. Similarly, music has a long-term structure but is composed of non-stationary acoustic signals that can be challenging to synthesize.</span></p><p><span>In the field of audio synthesis, achieving high audio quality while maintaining high-level consistency remains a significant challenge, especially in the absence of strong supervision. Recent audio synthesis models have made remarkable progress by using techniques such as </span><a href="https://proceedings.mlr.press/v80/kalchbrenner18a.html" target="_blank"><span>autoregressive waveform modeling</span></a><span>, adversarial training, and diffusion, resulting in nearly veridical signal quality. However, these models often require strong conditioning, such as linguistic features or a MIDI sequence, to generate structured audio. Without such conditioning, even powerful models like </span><a href="https://www.deepmind.com/blog/wavenet-a-generative-model-for-raw-audio" target="_blank"><span>WaveNet</span></a><span> can generate incoherent and messy audio.</span></p><h2><span>The secret recipe of AudioLM</span></h2><p><span>AudioLM solves this by using audio-only information. To achieve this they used 2 following innovations:</span></p><ul role="list"><li><span>Smart Tokenization</span></li><li><span>Mixed architecture </span></li></ul><h3><span>Smart Tokenization</span></h3><p><span>All language models that utilize transformers rely on tokenization, which is a method of encoding text and speech into tokens are usually words or subwords that are separated by spaces or other punctuation marks. The purpose of tokenization is to transform the text into a format that can be easily processed by machine learning algorithms.</span></p><p><span>It is crucial to have quality tokenization as this allows the model to gain an accurate representation and understanding of complex audio waves. To reach the goal of learning from audio alone Google AI team sent the sample audio to two tokenizers. SoundStream (also developed by Google AI) performed acoustic tokenization, in Figure 1 to get the tokens, they extracted latent vectors from the compressed embedding space, these tokens carry the information about the acoustic properties of our chosen audio sample, like pitch, intonation, etc.</span></p><figure class="w-richtext-align-fullwidth"><p><img src="https://uploads-ssl.webflow.com/6217ffc5d2a3bb848ea33545/63f85da8c5921e1f19fa69a5_Untitled.png" alt="Figure 1: Overview of the tokenizers used in AudioLM. The acoustic tokens are produced by "/></p><figcaption>Figure 1: Overview of the tokenizers used in AudioLM. The acoustic tokens are produced by <a href="https://ai.googleblog.com/2021/08/soundstream-end-to-end-neural-audio.html" target="_blank">SoundStream</a> and enable high-quality audio synthesis. The semantic tokens are derived from representations produced by an intermediate layer of the <a href="https://anwarvic.github.io/speech-recognition/w2v-BERT" target="_blank">w2v-BERT</a> model and enable long-term structural coherence.</figcaption></figure><p><span>But as they discovered, straight acoustic information without any meaning behind it doesn&#39;t work well for generating new audio. Here are a few examples of reconstructed sound using acoustic tokens only:</span></p><h4><span><strong>Reconstruction</strong></span></h4><p><span>So if the meaning of audio or semantic information is required how do we get it? To do this we need to utilize a model that can parse audio into words. For this task researchers used a pretrained w2v-BERT model, specifically they were interested in the encoding of the audio data that carry semantic information.</span></p><blockquote><span>💡 <strong>Key Idea 1:</strong> </span></blockquote><figure class="w-richtext-align-fullwidth"><p><img src="https://uploads-ssl.webflow.com/6217ffc5d2a3bb848ea33545/63f85da9c5921e985afa69e3_Untitled.png" alt="Figure 2: w2v-BERT architecture. Two important components are conformer blocks and an MLM block, from which intermediate representation is computed. K-Means is then used to cluster the embeddings and centroids are used as tokens."/></p><figcaption>Figure 2: w2v-BERT architecture. Two important components are conformer blocks and an MLM block, from which intermediate representation is computed. K-Means is then used to cluster the embeddings and centroids are used as tokens.</figcaption></figure><p><span>Your next question, however, might be: okay, speech is fine and well but how do you capture the semantic information of a piano piece? And the answer is: in the same way. Since we don&#39;t need the actual text, we can use the power of w2v-BERT to add additional structural information about our sound sample.</span></p><h3><span>Mixed architecture </span></h3><p><span>AudioLM’s architecture is the following:</span></p><ol role="list"><li><span>A tokenizer model, which maps x into a sequence of discrete tokens from a finite</span></li><li><span>A decoder-only Transformer language model that operates</span></li><li><span>A detokenizer model, which maps the sequence of</span></li></ol><p><span>The most interesting component is the Transformer model, which contains 3 stages that increase audio quality, researchers found that using a single tokenization scheme doesn&#39;t achieve good results, therefore AudioLM does audio modeling using 3 stages illustrated in Figure 3.</span></p><blockquote><span>💡 <strong>Key Idea 2:</strong> </span></blockquote><figure class="w-richtext-align-fullwidth"><p><img src="https://uploads-ssl.webflow.com/6217ffc5d2a3bb848ea33545/63f85da8c5921e6279fa69b2_Untitled.png" alt="Figure 3: 3 levels of tokenization. 1) Semantic tokens from w2v-BERT; 2) A combination of semantic tokens and coarse acoustic representation extracted early in the layers of SoundStream; 3) Addition of fine acoustic tokens"/></p><figcaption>Figure 3: 3 levels of tokenization. 1) Semantic tokens from w2v-BERT; 2) A combination of semantic tokens and coarse acoustic representation extracted early in the layers of SoundStream; 3) Addition of fine acoustic tokens</figcaption></figure><h2><span>AudioLM’s results</span></h2><p><span>To make sure that the tokenization process produces good quality representations of an audio sample, the researchers used three metrics: ABX, sWUGGY, and sBLIMP.</span></p><figure class="w-richtext-align-fullwidth"><p><img src="https://uploads-ssl.webflow.com/6217ffc5d2a3bb848ea33545/63f85da8c5921e3b89fa69b1_Untitled.png" alt="Left: ABX (↓) scores achieved by the (unquantized) embeddings
extracted from different layers of the MLM module of w2v-BERT. Right:
Scores on the development sets of sWUGGY (↑) and sBLIMP (↑) obtained
with different numbers of k-means cluster centers for layer 7"/></p><figcaption>Left: ABX (↓) scores achieved by the (unquantized) embeddings</figcaption></figure><ul role="list"><li><span>ABX evaluation is used to evaluate the performance of different models in tasks such as speech recognition, text-to-speech synthesis, and machine translation.</span></li><li><span>sWUGGY (short for &#34;smoothed Word-Usage Goodness GOF&#34;) measures the similarity between the word usage in the generated text and the word usage in a reference corpus. This metric is designed to penalize the use of uncommon or inappropriate words in the generated text.</span></li><li><span>sBLIMP (short for &#34;smoothed Bilingual Evaluation Understudy with Punctuation&#34;) is a metric that compares the generated text to a reference text using a machine translation approach. It measures the quality of the generated text in terms of fluency, grammar, and meaning preservation, while also taking into account punctuation and word order.</span></li></ul><p><span>This allowed researchers to select layer 7 as the most promising layer for extracting embeddings and k=1024 clusters for an amount of tokenization.</span></p><p><span>And now let’s hear some results!</span></p><h3><span>Speech continuation</span></h3><h4> <span>Original</span></h4><h4> <span>Prompt</span></h4><h4> <span>Continuation (AudioLM)</span></h4><h4> <span>Continuation (AudioLM)</span></h4><h3><span>Piano continuation</span></h3><h4> <span>Original</span></h4><h4> <span>Prompt</span></h4><h4> <span>Continuation (Acoustic-only model)</span></h4><h4><strong> </strong><span><strong>Continuation (AudioLM)</strong></span></h4><h2><span>Looking into the future</span></h2><p><span>AudioLM’s results are undoubtedly impressive, this milestone is a promising step in a direction of future potential research like multilingual speech generation, the generation of music using different instruments all at once, and producing quality informative audio content. </span></p><p><span>But the authors of the paper also acknowledge that this result doesn&#39;t come without risks. AudiLM by the nature of its architecture also inherits all the problems of LLMs, there is no guarantee that the model will replicate dialects and accents well from the groups underrepresented in the training dataset. There can be societal biases coming from the generated audio content, and not to forget that short and coherent audio modulation gives rise to a risk of breaching the biometric identification, with that in mind researchers closed a paper with their tool to identify audio that was generated by AudiLM.</span></p><h4><span>Reference</span></h4><p><span>‍</span>Borsos, Zalán, et al. &#34;Audiolm: a language modeling approach to audio generation.&#34; <em>arXiv preprint arXiv:2209.03143</em> (2022)</p></div></div></div></div></div></div>
  </body>
</html>
