<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.promptarmor.com/resources/notion-ai-unpatched-data-exfiltration">Original</a>
    <h1>Notion AI: Unpatched data exfiltration</h1>
    
    <div id="readability-page-1" class="page"><div data-framer-name="main" id="main-1"><article data-framer-name="container"><section data-framer-name="section"><p>Threat Intelligence</p><section data-framer-name="section"><p>Notion AI is susceptible to data exfiltration via indirect prompt injection due to a vulnerability in which AI document edits are saved before user approval.</p></section></section><!--$--><div data-framer-name="Content" data-framer-component-type="RichTextContainer"><p><img alt="Notion AI is susceptible to data exfiltration via indirect prompt injection due to a vulnerability in which AI document edits are saved before user approval." width="812" height="406" src="https://framerusercontent.com/images/GQzaNvCuHKpcijG92UqasrsNyrU.png" srcset="https://framerusercontent.com/images/GQzaNvCuHKpcijG92UqasrsNyrU.png?scale-down-to=512&amp;width=1625&amp;height=812 512w,https://framerusercontent.com/images/GQzaNvCuHKpcijG92UqasrsNyrU.png?scale-down-to=1024&amp;width=1625&amp;height=812 1024w,https://framerusercontent.com/images/GQzaNvCuHKpcijG92UqasrsNyrU.png?width=1625&amp;height=812 1625w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></p><p>Notion AI allows users to interact with their documents using natural language… but what happens when AI edits are made prior to user approval?</p><p>We responsibly disclosed this vulnerability to Notion via HackerOne. Unfortunately, they said “we&#39;re closing this finding as `Not Applicable`”.</p><h3 id="stealing-hiring-tracker-data-with-a-poisoned-resume"><a href="#stealing-hiring-tracker-data-with-a-poisoned-resume"><strong>Stealing Hiring Tracker Data with a Poisoned Resume</strong></a></h3><ol><li data-preset-tag="p"><p><strong>The user uploads a resume (untrusted data) to their chat session.<br/></strong>Here, the untrusted data source is a resume PDF, but a prompt injection could be stored in a web page, connected data source, or a Notion page.</p><img alt="A prompt injection is concealed within a resume in whitespace between the candidate&#39;s title and their contact information." width="479" height="610" src="https://framerusercontent.com/images/YeSOEvsIzdfMfwu479aYZjyDsc.png" srcset="https://framerusercontent.com/images/YeSOEvsIzdfMfwu479aYZjyDsc.png?scale-down-to=1024&amp;width=958&amp;height=1221 803w,https://framerusercontent.com/images/YeSOEvsIzdfMfwu479aYZjyDsc.png?width=958&amp;height=1221 958w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>This document contains a prompt injection hidden in 1 point font white on white text with a square white image covering the text for good measure. The LLM can read it with no issues, but the document appears benign to the human eye.</p></li><li data-preset-tag="p"><p><strong>The user asks Notion AI for help updating a hiring tracker based on the resume.</strong></p><img alt="Notion interface with a hiring tracker document open on the left and Notion AI chat on the right. The user has attached a resume document to the chat and is asking &#39;Hey - please help me update the notes for the candidate&#39;." width="800" height="515" src="https://framerusercontent.com/images/HmAjDG5rpWla7G3vDr11P8KOd6g.png" srcset="https://framerusercontent.com/images/HmAjDG5rpWla7G3vDr11P8KOd6g.png?scale-down-to=512&amp;width=1600&amp;height=1030 512w,https://framerusercontent.com/images/HmAjDG5rpWla7G3vDr11P8KOd6g.png?scale-down-to=1024&amp;width=1600&amp;height=1030 1024w,https://framerusercontent.com/images/HmAjDG5rpWla7G3vDr11P8KOd6g.png?width=1600&amp;height=1030 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/></li><li data-preset-tag="p"><p><strong>Notion AI is manipulated by the prompt injection to insert a malicious image into the hiring tracker. <br/></strong>The prompt injection manipulates Notion AI to (1) construct a URL by collecting all of the text in the document and appending the data to an attacker-controlled domain, and (2) insert an ‘image’ into the Notion Page using the constructed URL as the image source. </p><img alt="Notion AI displays a warning to the user, asking if they trust an external site. The URL shown contains data from the user&#39;s hiring tracker." width="277" height="416" src="https://framerusercontent.com/images/A72dIXwCCrCsdCbE0E7C5emYRI0.png" srcset="https://framerusercontent.com/images/A72dIXwCCrCsdCbE0E7C5emYRI0.png?width=554&amp;height=832 554w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>Here, it appears as though the user is prompted for approval. However, unbeknownst to the user, the edit has <em>already occurred before the user is prompted for approval</em>. When the edit occurred, the user’s browser made a request to the attacker’s server, attempting to retrieve the image. This request exfiltrates the document contents contained in the URL constructed by Notion AI.</p></li><li data-preset-tag="p"><p><strong>The attacker reads the sensitive hiring tracker data from their server logs.<br/></strong>Once the user’s browser has made a request for the malicious image, the attacker can read the sensitive data contained in the URL from their request logs.</p><img alt="The attacker&#39;s server logs hold data from the hiring tracker including salary expectations, candidate notes, and other internal data." width="800" height="157" src="https://framerusercontent.com/images/Zl1R4LJjBvhsNJHFDUvGC598.png" srcset="https://framerusercontent.com/images/Zl1R4LJjBvhsNJHFDUvGC598.png?scale-down-to=512&amp;width=1600&amp;height=315 512w,https://framerusercontent.com/images/Zl1R4LJjBvhsNJHFDUvGC598.png?scale-down-to=1024&amp;width=1600&amp;height=315 1024w,https://framerusercontent.com/images/Zl1R4LJjBvhsNJHFDUvGC598.png?width=1600&amp;height=315 1600w" data-framer-original-sizes="" sizes="(min-width: 1080px) 100vw, (min-width: 810px) and (max-width: 1079.98px) 100vw, (max-width: 809.98px) 100vw"/><p>In this attack, exfiltrated data included salary expectations, candidate feedback, internal role details, and other sensitive information such as diversity hiring goals.</p></li></ol><h3 id="additional-attack-surface"><a href="#additional-attack-surface"><strong>Additional Attack Surface</strong></a></h3><p>The Notion Mail AI drafting assistant is susceptible to rendering insecure Markdown images within email drafts, resulting in data exfiltration. If a user mentions an untrusted resource while drafting, content from the user’s query or other mentioned resources can be exfiltrated.  E.g., “Hey, draft me an email based on @untrusted_notion_page and @trusted_notion_page”.</p><h3 id="recommended-remediations-for-organizations"><a href="#recommended-remediations-for-organizations"><strong>Recommended Remediations for Organizations:</strong></a></h3><ol><li data-preset-tag="p"><p>Institute a vetting process for connected data sources. Restrict use of connectors that can access highly sensitive or highly untrusted data from: Settings &gt; Notion AI &gt; Connectors.</p></li><li data-preset-tag="p"><p>To reduce the risk of untrusted data being processed in the workspace, admins can configure: Settings &gt; Notion AI &gt; AI Web Search &gt; Enable web search for workspace &gt; Off.</p></li><li data-preset-tag="p"><p>Individual users should avoid including sensitive personal data that could be leveraged in a spearphishing attack when configuring personalization for Notion AI via: Settings &gt; Notion AI &gt; Personalization.</p></li><li data-preset-tag="p"><p>Individual users can configure: Settings &gt; Notion AI &gt; AI Web Search &gt; Require confirmation for web requests &gt; On.</p></li></ol><p><em>Note: Implementing these remediations will reduce the risk surface, but will not nullify the core vulnerability.</em></p><h3 id="recommended-remediations-for-notion"><a href="#recommended-remediations-for-notion"><strong>Recommended Remediations for Notion:</strong></a></h3><ol><li data-preset-tag="p"><p>Programmatically prohibit automatic rendering of Markdown images from external sites in Notion AI page creation or update outputs without explicit user approval.</p></li><li data-preset-tag="p"><p>Programmatically prohibit automatic rendering of Markdown images from external sites in Notion AI mail drafts.</p></li><li data-preset-tag="p"><p>Implement a strong Content Security Policy. This will prevent network requests from being made to unapproved external domains.</p></li><li data-preset-tag="p"><p>Ensure the CDN used to retrieve images for display in Notion and image previews for display in Notion Mail cannot be used as an open redirect to bypass the CSP policy that is set.</p></li></ol><h3 id="responsible-disclosure-timeline"><a href="#responsible-disclosure-timeline"><strong>Responsible Disclosure Timeline</strong></a></h3><p>12/24/2025	Initial report made via HackerOne</p></div><!--/$--></article></div></div>
  </body>
</html>
