<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bitfieldconsulting.com/posts/iota">Original</a>
    <h1>The Smallest Thing in Go</h1>
    
    <div id="readability-page-1" class="page"><div data-block-type="23" id="block-yui_3_17_2_1_1712772474770_14612"><div><p>What is the smallest thing in Go? Well, I’m glad you asked!</p>
<h2 id="iota-and-enums"><code>iota</code> and enums</h2>
<p>We often define constants in Go to enumerate a list of possible
values that something could take (sometimes called an “enum” for short).
For example, suppose we’re writing an astronomy program, and we want to
be able to distinguish between different kinds of night-sky objects:</p>
<div id="cb1"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span>const</span> <span>(</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    Planet <span>=</span> <span>0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    Star   <span>=</span> <span>1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    Comet  <span>=</span> <span>2</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    Galaxy <span>=</span> <span>3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span>// ...and so on</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span>)</span></span></code></pre></div>
<p>The specific numbers 0, 1, 2… aren’t important here. They’re just
arbitrary values we can compare things against:</p>
<div id="cb2"><pre><code><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span>if</span> object<span>.</span>Kind <span>==</span> Planet <span>{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span>// it&#39;s a planet!</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span>}</span></span></code></pre></div>
<h2 id="using-iota-with-const">Using <code>iota</code> with
<code>const</code></h2>
<p>It’s hard to maintain a long list of numbers like this by hand,
though. That’s where <code>iota</code> comes in. It’s a kind of magical,
ever-increasing value we can use to assign arbitrary numbers to
constants:</p>
<div id="cb3"><pre><code><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span>const</span> <span>(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    Planet <span>=</span> <span>iota</span> <span>// 0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    Star          <span>// 1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    Comet         <span>// 2</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    Galaxy        <span>// 3</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span>// ...</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span>)</span></span></code></pre></div>
<p>We’re effectively assigning <code>iota</code> to every constant in
the list, but Go lets us omit all but the first “<code>= iota</code>”.
Very handy!</p>
<h2 id="starting-iota-at-1">Starting <code>iota</code> at 1</h2>
<p>And we can use <code>iota</code> in more complicated expressions,
too. For example, if we want the successive values to start at 1 instead
of 0:</p>
<div id="cb4"><pre><code><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span>const</span> <span>(</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    January <span>=</span> <span>iota</span><span>+</span><span>1</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    February</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    March</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span>// ...</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span>)</span></span></code></pre></div>
<p>Here, the value of <code>January</code> will be 1,
<code>February</code> will be 2, and so on.</p>

<p>By the way, you can put comments or blank lines in your constant
block, and it won’t affect the values of <code>iota</code>:</p>
<div id="cb5"><pre><code><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span>const</span> <span>(</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span>// fermions</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    Electron <span>=</span> <span>iota</span> <span>// 0</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    Neutron         <span>// 1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    Proton          <span>// 2</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span>// bosons</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    Photon          <span>// 3</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    Gluon           <span>// 4</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span>)</span></span></code></pre></div>
<h2 id="iota-flags-and-bitmasks"><code>iota</code>, flags, and
bitmasks</h2>
<p>Another common use for <code>iota</code> is creating values for
<em>bitmasks</em>. A bitmask is something you can compare against a
binary number to see if a particular bit in that number is 1 or 0. When
particular bit values are used in this way, they’re sometimes called
<em>flags</em>, and the number containing them is called a
<em>bitfield</em> (well, well).</p>
<p>For example:</p>
<div id="cb6"><pre><code><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span>const</span> <span>(</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    Bit0 <span>=</span> <span>1</span> <span>&lt;&lt;</span> <span>iota</span> <span>// 1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    Bit1             <span>// 2</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    Bit2             <span>// 4</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span>// ...</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span>)</span></span></code></pre></div>
<p>The <code>&lt;&lt;</code> operator shifts the bits of a number to the
left by the given number of places. Since <code>iota</code> increases by
one for each successive constant, that means the shift factor increases
by one too, so the values assigned to the constants keep on
doubling.</p>
<p>Now we can do a <em>bitwise</em> comparison of these mask values
against some number we’re interested in:</p>
<div id="cb7"><pre><code><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>v <span>:=</span> <span>0b00000010</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span>if</span> v<span>&amp;</span>Bit1 <span>!=</span> <span>0</span> <span>{</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    fmt<span>.</span>Println<span>(</span><span>&#34;Looks like bit 1 is set!&#34;</span><span>)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span>}</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span>// Output:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span>// Looks like bit 1 is set!</span></span></code></pre></div>
<p>Now you know all about <code>iota</code> in Go! Have fun with it.</p>
</div></div></div>
  </body>
</html>
