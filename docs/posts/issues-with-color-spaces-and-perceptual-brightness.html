<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://johnaustin.io/articles/2025/issues-with-cielab-and-perceptual-brightness">Original</a>
    <h1>Issues with Color Spaces and Perceptual Brightness</h1>
    
    <div id="readability-page-1" class="page"><div data-nc-base="header" data-controller="AncillaryLayout">
      

            

      

      <div>
        




        

          <!-- Layout for blog item -->
          <div>
            

            <main>
              
                <section data-content-field="main-content">
                  <article id="post-6785e53e87fad21239890f26" data-item-id="6785e53e87fad21239890f26">

    
      
    

    <div data-layout-label="Post Body" data-type="item" data-updated-on="1736828221920" id="item-6785e53e87fad21239890f26"><div><div><div data-block-type="2" id="block-3740d9de0eef22b96189"><div>

<div>
  <p>Unlike RGB, the <a href="https://en.wikipedia.org/wiki/CIELAB_color_space" target="_blank">CIELab</a> color space<a href="#margin" target="_blank">And the more modern variants like CIECAM02 and Oklab.</a> is designed to be perceptually uniform. This is a broad goal, which roughly means that we would like changes in the numbers to match same changes that we observe when performing various studies of human perception. </p><p>It’s a bit less &#39;math’ and more ‘modeling’. We try to fit equations to the observed data with the lowest error possible, across many different axis. It’s helpful to imagine adding the word ‘predicted’ in front of all of the CIELAB terminology (ie. Predicted Perceptual Lightness), because it’s just trying to predict human test results! </p><p>This process means that there is some error. For example, ideally, a color with L=50 looks twice as bright as a color with L=25.  Except, with very strongly saturated colors like red, this isn’t actually the case in any of these color spaces.</p><p>This is what’s called the <a href="https://en.wikipedia.org/wiki/Helmholtz%E2%80%93Kohlrausch_effect">Helmholtz-Kohlrausch effect</a>. Take a look at the below panel of colors. Most humans agree that the red is quite a bit brighter than the others in the row, and yet they all have the exact same lightness value when calculated with something like CIELAB!</p>
</div>




















  
  



</div></div><div data-aspect-ratio="41.590909090909086" data-block-type="5" id="block-yui_3_17_2_1_1736829225871_2131"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" data-image-dimensions="440x181" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" width="440" height="181" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>A set of colors demonstrating the Helmholtz-Kohlrausch effect. The red appears more vivid to the human eye.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1736829225871_2454"><div>

<div>
  <p>There is some recent <a href="https://onlinelibrary.wiley.com/doi/10.1002/col.22839" target="_blank">research</a> I found that models this effect and applies an additional transform to account for it, building off of work from <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/col.5080160608" target="_blank">Fairchild MD, Pirrotta E</a> in the 90’s. The end result is labeled as the “Predicted Equivalent Achromatic Lightness”, or in other words “The lightness of the gray that most closely matches the perceived lightness”. </p><p>This is actually quite a useful value, because it’s precisely the value we want when desaturating an image! Most desaturation operations spit out a [0..1] value which is then (later) rendered as an RGB gray color. Using the L_EAL value instead jumps us right to the end, giving the exact perceptual gray color to place in the resulting desaturated image.</p><p>How much of an issue is this? Well, I noticed. I’ve been writing a tool to desaturate game screenshots, to help us evaluate relative brightnesses between art assets, and improve overall game readability. All of the red assets appeared.. strangely dark in the desaturated images, even when using CIELAB!</p>
</div>




















  
  



</div></div><div><div><div data-block-type="5" id="block-yui_3_17_2_1_1736829225871_28689"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" data-image-dimensions="1624x1458" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" width="1624" height="1458" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>Before desaturating.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div><div><div data-aspect-ratio="89.3854748603352" data-block-type="5" id="block-yui_3_17_2_1_1736829225871_29861"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" data-image-dimensions="1374x1468" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" width="1374" height="1468" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>After desaturating.</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1736829225871_29010"><div>

<div>
  <p>The reds are a bit darker here, but I think we can agree that they’re not that dark! This is because CIELAB does not account for the Helmholtz-Kohlrausch effect and so it undervalues the amount that red’s saturation contributes to the final lightness. And if we had used this tool to spot check, it might have caused us to make all of our red assets too bright to balance it out. Weird.</p>
</div>




















  
  



</div></div></div></div></div>

    

    

    

  </article>





  
                </section>
              
            </main>
          </div>

          
        
      </div>

    </div></div>
  </body>
</html>
