<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://skia-canvas.org/">Original</a>
    <h1>Skia Canvas: Browser-Less Implementation of the HTML Canvas Drawing API for Node</h1>
    
    <div id="readability-page-1" class="page"><p>Skia Canvas is a browser-less implementation of the HTML Canvas drawing API for Node.js. It is based on Google’s <a href="https://skia.org" target="_blank" rel="noopener noreferrer">Skia</a> graphics engine and, accordingly, produces very similar results to Chrome’s <code>&lt;canvas&gt;</code> element. The library is well suited for use on desktop machines where you can render hardware-accelerated graphics to a window and on the server where it can output a variety of image formats.</p><p>While the primary goal of this project is to provide a reliable emulation of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API" target="_blank" rel="noopener noreferrer">standard API</a> according to the <a href="https://html.spec.whatwg.org/multipage/canvas.html" target="_blank" rel="noopener noreferrer">spec</a>, it also extends it in a number of areas to take greater advantage of Skia&#39;s advanced graphical features and provide a more expressive coding environment.</p><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span>Canvas</span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;skia-canvas&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>let</span><span> canvas </span><span>=</span><span> </span><span>new</span><span> </span><span>Canvas</span><span>(</span><span>400</span><span>,</span><span> </span><span>400</span><span>)</span><span>,</span><span></span><br/></span><span><span>    ctx </span><span>=</span><span> canvas</span><span>.</span><span>getContext</span><span>(</span><span>&#34;2d&#34;</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>{</span><span>width</span><span>,</span><span> height</span><span>}</span><span> </span><span>=</span><span> canvas</span><span>;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>let</span><span> sweep </span><span>=</span><span> ctx</span><span>.</span><span>createConicGradient</span><span>(</span><span>Math</span><span>.</span><span>PI</span><span> </span><span>*</span><span> </span><span>1.2</span><span>,</span><span> width</span><span>/</span><span>2</span><span>,</span><span> height</span><span>/</span><span>2</span><span>)</span><span></span><br/></span><span><span>sweep</span><span>.</span><span>addColorStop</span><span>(</span><span>0</span><span>,</span><span> </span><span>&#34;red&#34;</span><span>)</span><span></span><br/></span><span><span>sweep</span><span>.</span><span>addColorStop</span><span>(</span><span>0.25</span><span>,</span><span> </span><span>&#34;orange&#34;</span><span>)</span><span></span><br/></span><span><span>sweep</span><span>.</span><span>addColorStop</span><span>(</span><span>0.5</span><span>,</span><span> </span><span>&#34;yellow&#34;</span><span>)</span><span></span><br/></span><span><span>sweep</span><span>.</span><span>addColorStop</span><span>(</span><span>0.75</span><span>,</span><span> </span><span>&#34;green&#34;</span><span>)</span><span></span><br/></span><span><span>sweep</span><span>.</span><span>addColorStop</span><span>(</span><span>1</span><span>,</span><span> </span><span>&#34;red&#34;</span><span>)</span><span></span><br/></span><span><span>ctx</span><span>.</span><span>strokeStyle</span><span> </span><span>=</span><span> sweep</span><br/></span><span><span>ctx</span><span>.</span><span>lineWidth</span><span> </span><span>=</span><span> </span><span>100</span><span></span><br/></span><span><span>ctx</span><span>.</span><span>strokeRect</span><span>(</span><span>100</span><span>,</span><span>100</span><span>,</span><span> </span><span>200</span><span>,</span><span>200</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span></span><br/></span><span><span></span><span>async</span><span> </span><span>function</span><span> </span><span>render</span><span>(</span><span>)</span><span>{</span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>await</span><span> canvas</span><span>.</span><span>saveAs</span><span>(</span><span>&#34;rainbox.png&#34;</span><span>,</span><span> </span><span>{</span><span>density</span><span>:</span><span>2</span><span>}</span><span>)</span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>let</span><span> pngData </span><span>=</span><span> </span><span>await</span><span> canvas</span><span>.</span><span>png</span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>let</span><span> pngEmbed </span><span>=</span><span> </span><span>`</span><span>&lt;img src=&#34;</span><span>${</span><span>await</span><span> canvas</span><span>.</span><span>toDataURL</span><span>(</span><span>&#34;png&#34;</span><span>)</span><span>}</span><span>&#34;&gt;</span><span>`</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><span>render</span><span>(</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span></span><br/></span><span><span>canvas</span><span>.</span><span>saveAsSync</span><span>(</span><span>&#34;rainbox.pdf&#34;</span><span>)</span><br/></span></code></pre></div></div><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span>Canvas</span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;skia-canvas&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>let</span><span> canvas </span><span>=</span><span> </span><span>new</span><span> </span><span>Canvas</span><span>(</span><span>400</span><span>,</span><span> </span><span>400</span><span>)</span><span>,</span><span></span><br/></span><span><span>    ctx </span><span>=</span><span> canvas</span><span>.</span><span>getContext</span><span>(</span><span>&#34;2d&#34;</span><span>)</span><span>,</span><span></span><br/></span><span><span>    </span><span>{</span><span>width</span><span>,</span><span> height</span><span>}</span><span> </span><span>=</span><span> canvas</span><br/></span><span><span></span><br/></span><span><span></span><span>for</span><span> </span><span>(</span><span>const</span><span> color </span><span>of</span><span> </span><span>[</span><span>&#39;orange&#39;</span><span>,</span><span> </span><span>&#39;yellow&#39;</span><span>,</span><span> </span><span>&#39;green&#39;</span><span>,</span><span> </span><span>&#39;skyblue&#39;</span><span>,</span><span> </span><span>&#39;purple&#39;</span><span>]</span><span>)</span><span>{</span><span></span><br/></span><span><span>  ctx </span><span>=</span><span> canvas</span><span>.</span><span>newPage</span><span>(</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>fillStyle</span><span> </span><span>=</span><span> color</span><br/></span><span><span>  ctx</span><span>.</span><span>fillRect</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span> width</span><span>,</span><span> height</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>fillStyle</span><span> </span><span>=</span><span> </span><span>&#39;white&#39;</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>arc</span><span>(</span><span>width</span><span>/</span><span>2</span><span>,</span><span> height</span><span>/</span><span>2</span><span>,</span><span> </span><span>40</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>2</span><span> </span><span>*</span><span> </span><span>Math</span><span>.</span><span>PI</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>fill</span><span>(</span><span>)</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>async</span><span> </span><span>function</span><span> </span><span>render</span><span>(</span><span>)</span><span>{</span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>await</span><span> canvas</span><span>.</span><span>saveAs</span><span>(</span><span>&#34;all-pages.pdf&#34;</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span>  </span><span></span><br/></span><span><span>  </span><span>await</span><span> canvas</span><span>.</span><span>saveAs</span><span>(</span><span>&#34;page-{2}.png&#34;</span><span>)</span><span></span><br/></span><span><span></span><span>}</span><span></span><br/></span><span><span></span><span>render</span><span>(</span><span>)</span><br/></span></code></pre></div></div><div><div><pre tabindex="0"><code><span><span>import</span><span> </span><span>{</span><span>Window</span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;skia-canvas&#39;</span><span></span><br/></span><span><span></span><br/></span><span><span></span><span>let</span><span> win </span><span>=</span><span> </span><span>new</span><span> </span><span>Window</span><span>(</span><span>300</span><span>,</span><span> </span><span>300</span><span>)</span><span></span><br/></span><span><span>win</span><span>.</span><span>title</span><span> </span><span>=</span><span> </span><span>&#34;Canvas Window&#34;</span><span></span><br/></span><span><span>win</span><span>.</span><span>on</span><span>(</span><span>&#34;draw&#34;</span><span>,</span><span> </span><span>e</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span><br/></span><span><span>  </span><span>let</span><span> ctx </span><span>=</span><span> e</span><span>.</span><span>target</span><span>.</span><span>canvas</span><span>.</span><span>getContext</span><span>(</span><span>&#34;2d&#34;</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>lineWidth</span><span> </span><span>=</span><span> </span><span>25</span><span> </span><span>+</span><span> </span><span>25</span><span> </span><span>*</span><span> </span><span>Math</span><span>.</span><span>cos</span><span>(</span><span>e</span><span>.</span><span>frame</span><span> </span><span>/</span><span> </span><span>10</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>beginPath</span><span>(</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>arc</span><span>(</span><span>150</span><span>,</span><span> </span><span>150</span><span>,</span><span> </span><span>50</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>2</span><span> </span><span>*</span><span> </span><span>Math</span><span>.</span><span>PI</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>stroke</span><span>(</span><span>)</span><span></span><br/></span><span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>beginPath</span><span>(</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>arc</span><span>(</span><span>150</span><span>,</span><span> </span><span>150</span><span>,</span><span> </span><span>10</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>2</span><span> </span><span>*</span><span> </span><span>Math</span><span>.</span><span>PI</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>stroke</span><span>(</span><span>)</span><span></span><br/></span><span><span>  ctx</span><span>.</span><span>fill</span><span>(</span><span>)</span><span></span><br/></span><span><span></span><span>}</span><span>)</span><br/></span></code></pre></div></div></div>
  </body>
</html>
