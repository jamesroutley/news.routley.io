<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hamy.xyz/blog/2025-11_post-mortem-hamy-xyz-404s">Original</a>
    <h1>Post-Mortem: hamy.xyz returning 404s (2025.11)</h1>
    
    <div id="readability-page-1" class="page"><p>DISCLOSURE: If you buy through affiliate links, I may earn a small commission. <a href="https://hamy.xyz/blog/disclosures">(disclosures)</a></p><div><p>On 2025.11.22 hamy.xyz went down, returning 404s to users. <a href="https://hamy.xyz/notes/post-mortem">Post Mortems</a> are a useful tool for reflecting on incidents to better understand what happened and prevent them from recurring.</p>
<p>hamy.xyz is the public face of my brand so it&#39;s not great if it&#39;s down. Here we&#39;ll do a light post-mortem.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Ab26hcYHMv4?si=f60Pu8rWdpQfYh8X" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>
<h2 id="overview">Overview</h2>
<p>On 2025.11.22t~1100 ET a new note was created with a slug that collided with that of an existing blog post. This broke the server&#39;s slug to post mapping but the revision was still pushed through CI.</p>
<p>hamy.xyz went down, returning 404s to users.</p>
<p>It was detected at 11.23t0600 ET (18h later) and resolved by 11.23t0700 (19h).</p>
<h2 id="impact">Impact</h2>
<p>Users: No users could reach the site for 19h - they just saw 404s.</p>
<p>Company: This drops web traffic by ~1/30 for the month. It blocked many forward links to various money-making projects. It may have an unknown long-term impact on SEO / AIEO.</p>
<h2 id="root-cause">Root Cause</h2>
<p><a href="https://hamy.xyz/notes">Notes</a> are a new part of the website that were added after <a href="https://hamy.xyz/blog/2025-11_why-im-moving-blog-fsharp-to-csharp">my migration from F# to C#</a> as a way to build the site into more of a <a href="https://hamy.xyz/notes/digital-garden">digital garden</a>.</p>
<p>For simplicity, I had separated the folders that the markdown files went into:</p>
<ul>
<li>AllPosts - Existing folder with all my blog posts</li>
<li>AllNotes - New folder for notes</li>
</ul>
<p>In order to achieve bidirectional links (when one post links to another, a backlink is created), I build a map of slugs to the posts they link to and then reverse it. There&#39;s a guard in there for duplicate slugs that breaks the build as that would lead to overwritten data.</p>
<p>In this case I was trying to create a note for my website, which I call <code>iamhamy</code>. So I wanted a note with slug <code>iamhamy</code>.</p>
<ul>
<li>New note - <code>iamhamy</code></li>
<li>Existing post - <code>iamhamy</code> (<a href="https://hamy.xyz/blog/iamhamy">post</a>)</li>
</ul>
<p>So when I published that new note by moving it into the <code>AllNotes</code> folder it broke my site&#39;s post mapping and thus failed to spin up.</p>
<h2 id="detection">Detection</h2>
<p>This issue was not detected for 18h. It was detected by me checking my website to review a different note and seeing an unexpected 404.</p>
<p>Failures in detection:</p>
<ul>
<li>No local testing was performed -&gt; So pushed to GH</li>
<li>No CI test / build gate existed -&gt; so image was built and pushed to image repo</li>
<li>No pre-deploy healthcheck existed -&gt; so new image was promoted to prod</li>
<li>No ongoing statuscheck was implemented -&gt; so no auto alerts</li>
<li>I rarely go on social media -&gt; so I didn&#39;t see the comments telling me my site was down</li>
</ul>
<p>Followups:</p>
<ul>
<li>Prefer local test before push (though this slows down my writing so not worth 100% enforcement)</li>
<li>Add healthcheck gates for image publish and deploy promotion to detect bad revisions early</li>
<li>Add ongoing status checks to notify when things go down</li>
</ul>
<h2 id="escalation">Escalation</h2>
<p>Escalated immediately (after all I&#39;m a one-man show).</p>
<h2 id="mitigation">Mitigation</h2>
<p>Mitigation took ~20 minutes from when I got to my computer to when I&#39;d found root cause and fixed it.</p>
<p>This is pretty good but could&#39;ve been improved with better detection coverage (could&#39;ve root caused automatically by looking at failing logs) and maybe runbooks for debugging my apps.</p>
<p>Followups:</p>
<ul>
<li>Add detection gates</li>
<li>Add runbooks for debugging my deploy stack - builds, deploys, run logs</li>
</ul>
<h2 id="prevention">Prevention</h2>
<p>The bad commit was pushed and made its way through the full CI pipeline.</p>
<p>Followups:</p>
<ul>
<li>Change how posts are stored in my repo to get file-level uniqueness guarantees (aka hold them in the same folder)</li>
<li>Add healthcheck gates at GH build and deploy time so bad revisions don&#39;t make it to prod</li>
</ul>

<p>Nothing really to remediate. For SEO / AIEO, best I can do is keep the site up more so it doesn&#39;t get flagged as unreliable.</p>
<h2 id="next">Next</h2>
<p>I&#39;ll take on a few of these to improve my robustness to these kinds of issues in the future.</p>
<p>Short-term followups:</p>
<ul>
<li>Prevention: Move all posts to live in same directory so file system enforces uniqueness</li>
<li>Detection: Add ongoing healthchecks and alerts to all sites</li>
</ul>
<p>Long-term followups:</p>
<ul>
<li>Prevention: Add healthchecks before build publish</li>
<li>Prevention: Add healthchecks before deploy</li>
<li>Prevention: Consider moving off of <a href="https://hamy.xyz/blog/2025-08_coolify-to-ansible">raw ansible</a> to something with better blue/green deploys built in - maybe k8s, nomad, or smth else</li>
</ul>
<p>If you liked this post you might also like:</p>
<ul>
<li><a href="https://hamy.xyz/blog/2024-02_meta-postmortem">How Meta runs blameless Post-mortems at scale - Efficient incident reviews w/o the Politics for a Product org of 30,000</a></li>
<li><a href="https://hamy.xyz/blog/2025-11_why-im-moving-blog-fsharp-to-csharp">Why I&#39;m Moving my Blog from F# to C#</a></li>
<li><a href="https://hamy.xyz/blog/2025-12_software-engineers-ai">If AI can code, what will Software Engineers do?</a></li>
</ul>
</div></div>
  </body>
</html>
