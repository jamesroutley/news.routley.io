<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lemire.me/blog/2024/01/18/how-much-memory-bandwidth-do-large-amazon-instances-offer/">Original</a>
    <h1>How much memory bandwidth do large Amazon instances offer?</h1>
    
    <div id="readability-page-1" class="page"><article id="post-21092">

<div>
<p>In my <a href="https://lemire.me/blog/2024/01/13/estimating-your-memory-bandwidth/">previous post</a>, I described how you can write a C++ program to estimate your read memory bandwidth. It is not very difficult: you allocate a large memory region and you read it as fast as you can. To see how much bandwidth you may have if you use multithreaded applications, you can use multiple threads, where each thread reads a section of the large memory region.</p>
<p>The server I used for the blog post, a two-CPU Intel Ice Lake server has a maximal bandwidth of about 130 GB/s. You can double this amount of bandwidth with <a href="https://en.wikipedia.org/wiki/Non-uniform_memory_access">NUMA</a>-aware code, but it will require further engineering.</p>
<p>But you do not have access to my server. What about a big Amazon server? So I spun out an <a href="https://aws.amazon.com/fr/ec2/instance-types/r6i/">r6i.metal</a> instance from Amazon. These servers can support 128 physical threads, they have 1 terabyte of RAM (1024 GB) and 6.25 GB/s of network bandwidth.</p>
<p>Running my benchmark program on this Amazon server revealed that they have about 115 GB/s of read memory bandwidth. That is not counting NUMA and other sophisticated tricks. Plotting the bandwidth versus the number of threads used reveals that, once again, you need about 20 threads to maximized memory bandwidth although you get most of it with only 15 threads.</p>
<p><a href="https://lemire.me/blog/wp-content/uploads/2024/01/bandwidthicelakeaws.png"><img decoding="async" src="https://lemire.me/blog/wp-content/uploads/2024/01/bandwidthicelakeaws.png" alt="" width="70%" srcset="https://lemire.me/blog/wp-content/uploads/2024/01/bandwidthicelakeaws.png 800w, https://lemire.me/blog/wp-content/uploads/2024/01/bandwidthicelakeaws-300x225.png 300w, https://lemire.me/blog/wp-content/uploads/2024/01/bandwidthicelakeaws-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"/></a></p>
<p><a href="https://github.com/lemire/Code-used-on-Daniel-Lemire-s-blog/blob/master/2024/01/13/bandwidth.cpp">My source code is available</a>.</p>
</div>
<div>

<p><img alt="" src="https://secure.gravatar.com/avatar/2ca999bef9535950f5b84281a4dab006?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ca999bef9535950f5b84281a4dab006?s=112&amp;d=mm&amp;r=g 2x" height="56" width="56" decoding="async"/> </p>

</div>

</article></div>
  </body>
</html>
