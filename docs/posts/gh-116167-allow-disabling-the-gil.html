<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/python/cpython/pull/116338">Original</a>
    <h1>gh-116167: Allow disabling the GIL</h1>
    
    <div id="readability-page-1" class="page"><div>
        <div>
  
  <task-lists disabled="" sortable="">
    <div>
      <p dir="auto">In free-threaded builds, running with <code>PYTHON_GIL=0</code> or <code>-X gil=0</code> will now disable the GIL. <a data-error-text="Failed to load title" data-id="2167582143" data-permission-text="Title is private" data-url="https://github.com/python/cpython/issues/116322" data-hovercard-type="issue" data-hovercard-url="/python/cpython/issues/116322/hovercard" href="https://github.com/python/cpython/issues/116322">#116322</a> and <a data-error-text="Failed to load title" data-id="2167798644" data-permission-text="Title is private" data-url="https://github.com/python/cpython/issues/116329" data-hovercard-type="issue" data-hovercard-url="/python/cpython/issues/116329/hovercard" href="https://github.com/python/cpython/issues/116329">#116329</a> track follow-up work to re-enable the GIL when loading an incompatible extension, and to disable the GIL by default, respectively.</p>
<p dir="auto">In order to support re-enabling the GIL at runtime, all GIL-related data structures are initialized as usual, and disabling the GIL simply sets a flag at startup that causes <code>take_gil()</code> and <code>drop_gil()</code> to return early.</p>
<p dir="auto">With <code>PYTHON_GIL=0</code> set, I spot-checked a few tests and small programs that don&#39;t use threads. They all seem to run fine, and very basic threaded programs work, sometimes. Trying to run the full test suite crashes pretty quickly, in <code>test_asyncio</code>.</p>
<ul dir="auto">
<li>Issue: <span><svg title="Open" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path></svg><a data-error-text="Failed to load title" data-id="2162230088" data-permission-text="Title is private" data-url="https://github.com/python/cpython/issues/116167" data-hovercard-type="issue" data-hovercard-url="/python/cpython/issues/116167/hovercard" href="https://github.com/python/cpython/issues/116167">Add a mechanism to disable the GIL<span>Â #116167</span></a></span></li>
</ul>
    </div>
  </task-lists>
  
</div>

      </div></div>
  </body>
</html>
