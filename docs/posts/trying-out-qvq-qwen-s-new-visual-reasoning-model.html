<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simonwillison.net/2024/Dec/24/qvq/">Original</a>
    <h1>Trying out QvQ – Qwen&#39;s new visual reasoning model</h1>
    
    <div id="readability-page-1" class="page"><div>


<div data-permalink-context="/2024/Dec/24/qvq/">
<h2>Trying out QvQ—Qwen’s new visual reasoning model</h2>
<p>24th December 2024</p>



<p>I thought we were done for major model releases in 2024, but apparently not: Alibaba’s Qwen team just dropped the Apache 2.0 licensed QvQ-72B-Preview, “an experimental research model focusing on enhancing visual reasoning capabilities”.</p>
<p>Their blog post is titled <a href="https://qwenlm.github.io/blog/qvq-72b-preview/">QvQ: To See the World with Wisdom</a>—similar flowery language to their QwQ announcement <a href="https://qwenlm.github.io/blog/qwq-32b-preview/">QwQ: Reflect Deeply on the Boundaries of the Unknown</a> a few weeks ago in November.</p>
<p>It’s a vision-focused follow-up to QwQ, which I <a href="https://simonwillison.net/2024/Nov/27/qwq/">wrote about previousy</a>. QwQ is an impressive openly licensed inference-scaling model: give it a prompt and it will think out loud over many tokens while trying to derive a good answer, similar to OpenAI’s o1 and o3 models.</p>
<p>The new QvQ adds vision to the mix. You can try it out <a href="https://huggingface.co/spaces/Qwen/QVQ-72B-preview">on Hugging Face Spaces</a>—it accepts an image and a single prompt and then streams out a <em>very</em> long response where it thinks through the problem you have posed it. There’s no option to send a follow-up prompt.</p>
<p>I’ve tried it out with a bunch of things, with mixed results—but it’s really fun seeing how it works through a problem.</p>
<p>My most successful prompt was “Count the pelicans” with this image:</p>
<p><img src="https://static.simonwillison.net/static/2024/count-pelicans-easy.jpg" alt="A photograph of four glorious young California Brown Pelicans perched on a dock. The back end of another pelican is visible at the front of the photo."/></p>
<p>Here’s <a href="https://gist.github.com/simonw/6c296f4b9323736dc77978447b6368fc#response">the full response</a>. Some highlights:</p>
<blockquote>
<p>So I’ve got this picture of some pelicans, and I need to count them. Let me see... First off, I know that pelicans are those big birds with the massive beaks, right? [...]</p>
<p>Let me try counting again, more carefully this time. Starting from the left:</p>
<ol>
<li>The first pelican is fully visible, standing at the front.</li>
<li>Behind it, slightly to the right, is the second pelican.</li>
<li>Then, further back, there’s a third pelican.</li>
<li>And next to that one, there’s a fourth pelican.</li>
</ol>
<p>So, that’s four pelicans in total. But, I notice that on the far right of the image, there’s part of another bird, maybe a pelican’s back or tail feathers, but it’s not fully in the frame, so I don’t think I should count it as a whole pelican.</p>
</blockquote>
<p>Something about the tone of voice it uses, “First off, I know that pelicans are those big birds with the massive beaks, right?”, tickles me.</p>
<p>I also tried this on a <a href="https://gist.github.com/simonw/6c296f4b9323736dc77978447b6368fc#image-2">much harder image</a>—it counted 17 which looks about right to me but honestly I have trouble with that image myself.</p>
<p>I fed in <a href="https://gist.github.com/simonw/6c296f4b9323736dc77978447b6368fc#arc-agi-puzzle-0d87d2a6">one of the ARC-AGI puzzles</a> that o3 had failed at.</p>
<p><img alt="A puzzle with colored squares, where drawing a line between the single blue squares and turning any intersected rectangles blue is clearly the solution." src="https://static.simonwillison.net/static/2024/arc-agi-task-0d87d2a6.png"/></p>
<p>It produced <a href="https://gist.github.com/simonw/6c296f4b9323736dc77978447b6368fc#response-1">a very lengthy chain of thought</a> that was almost entirely incorrect, but had some interesting “ideas” in it:</p>
<blockquote>
<p>[...] Let me try to think in terms of cellular automata rules, like Conway’s Game of Life.</p>
<p>In Game of Life, each cell’s state in the next generation is determined by its current state and the states of its eight neighbors.</p>
<p>Perhaps a similar rule applies here.</p>
</blockquote>
<p>Finally, I asked it to “Estimate the height of the dinosaur” against this image (which, as it correctly noted, is actually an inflatable dragon):</p>
<p><img src="https://static.simonwillison.net/static/2024/inflatable-dragon.jpg" alt="A large inflatable Christmas decoration of a reindeer riding a dragon - both reindeer and dragon are wearing Christmas hats"/></p>
<p>I’m not sure this task is even possible given the lack of items in the frame of comparable known height. It <a href="https://gist.github.com/simonw/6c296f4b9323736dc77978447b6368fc#response-3">had a good go at it</a> though! I particularly enjoyed how it began:</p>
<blockquote>
<p>So I’ve got this inflatable Christmas decoration, and it’s a dragon! But not just any dragon—it’s a green dragon wearing a Santa hat and a red and white scarf. And get this, there’s a reindeer on its back, also wearing a Santa hat and holding onto the dragon’s wings. It’s pretty festive and colorful, with lots of vibrant greens, reds, and yellows.</p>
<p>The dragon has these big, friendly eyes and a smiling face, which makes it look really cheerful. Its wings are spread out, and it has white claws on its feet. The reindeer is brown with antlers and seems to be enjoying the ride on the dragon’s back.</p>
<p>Now, the question is, how tall is this inflatable dragon? I need to estimate its height. Let me see. I’m standing next to it, and I’m about 5 feet 10 inches tall. The dragon is definitely taller than me. Maybe around 8 or 9 feet high? But I should try to be more precise.</p>
</blockquote>
<p>I wonder how it decided that its own height was 5 feet 10 inches!</p>
<h4 id="running-qvq-locally">Running QvQ locally</h4>
<p>All of my experiments so far have used the <a href="https://huggingface.co/spaces/Qwen/QVQ-72B-preview">hosted Hugging Face demo</a>. I’m hoping to try it out on my own laptop soon—I think it should just fit in 64GB of M2, maybe with a smaller quantization.</p>
<p>Right now the options are:</p>
<ul>
<li>
<a href="https://huggingface.co/Qwen/QVQ-72B-Preview">Qwen/QVQ-72B-Preview</a> on Hugging Face has the GPU model weights, for use with Hugging Face Transformers and the <a href="https://pypi.org/project/qwen-vl-utils/">qwen-vl-utils</a> Python package.</li>
<li>Prince Canuma <a href="https://twitter.com/Prince_Canuma/status/1871687356815716672">converted the model for Apple’s MLX framework</a> as <a href="https://huggingface.co/collections/mlx-community/qvq-72b-preview-676b345a6f93172ba980c0d5">mlx-community/qvq-72b-preview</a> and got it working with his excellent <a href="https://github.com/Blaizzy/mlx-vlm">mlx-vlm</a> package.</li>
</ul>
<p>As a happy user of Ollama’s <a href="https://ollama.com/library/qwq">qwq port</a> I’m hoping they add a QvQ release at some point soon as well.</p>
<h4 id="with-mlx-vlm">Running QvQ on my Mac using mlx-vlm</h4>
<p><strong>Update</strong>: I successfully ran QvQ on my 64GB M2 MacBook Pro using Prince Canuma’s <code>mlx-vlm</code> via <code>uv run </code> with the following command:</p>
<div><pre>uv run --with <span><span>&#39;</span>numpy&lt;2.0<span>&#39;</span></span> --with mlx-vlm python \
  -m mlx_vlm.generate \
    --model mlx-community/QVQ-72B-Preview-4bit \
    --max-tokens 10000 \
    --temp 0.0 \
    --prompt <span><span>&#34;</span>describe this<span>&#34;</span></span> \
    --image pelicans-on-bicycles-veo2.jpg</pre></div>
<p>My image input here was taken from my experiment with Google’s <a href="https://simonwillison.net/2024/Dec/16/veo-2/">Veo 2</a> video generation model:</p>
<p><img src="https://static.simonwillison.net/static/2024/pelicans-on-bicycles-veo2.jpg" alt="A screenshot of the Google VideoFX video generation tool"/></p>
<p>Here’s the full output from running that command, after it first downloaded 38GB to <code>~/.cache/huggingface/hub/models--mlx-community--QVQ-72B-Preview-4bi</code>:</p>
<pre><code>==========
Image: [&#39;pelicans-on-bicycles-veo2.jpg&#39;] 

Prompt: &lt;|im_start|&gt;system
You are a helpful and harmless assistant. You are Qwen developed by Alibaba. You should think step-by-step.&lt;|im_end|&gt;
&lt;|im_start|&gt;user
describe this&lt;|vision_start|&gt;&lt;|image_pad|&gt;&lt;|vision_end|&gt;&lt;|im_end|&gt;
&lt;|im_start|&gt;assistant

Alright, I&#39;ve got this &#34;Text to Video&#34; tool to explore. It seems pretty advanced, allowing me to turn text descriptions into actual videos. The interface looks user-friendly, with a dark theme that&#39;s easy on the eyes. On the left side, there&#39;s a panel where I can input my text prompt. It already has an example filled in: &#34;A pelican riding a bicycle along a coastal path overlooking a harbor.&#34;

That sounds interesting! I can see four different video thumbnails on the right side, each showing variations of this scene. One of them even has the pelican wearing a helmet, which adds a humorous touch. Another shows the pelican standing next to a bicycle, almost as if it&#39;s ready to hop on and start pedaling.

Below the text input, there are some style options like &#34;photorealistic,&#34; &#34;35mm film,&#34; &#34;minimal,&#34; &#34;sketchy,&#34; &#34;handmade,&#34; and &#34;abstract.&#34; These probably let me choose the visual style of the video. For now, I&#39;ll stick with the default settings.

At the bottom of the left panel, there are two buttons: &#34;Start over&#34; and &#34;Create videos.&#34; I guess &#34;Create videos&#34; is the one I need to press to generate the videos based on my text prompt.

Let me think about this. I want to see what kind of videos this tool can produce based on my description. The example prompt is already filled in, so maybe I should just go ahead and click &#34;Create videos&#34; to see what happens.

Wait a minute, the prompt mentions a coastal path overlooking a harbor. In the thumbnails, I can see a background with water and boats, which matches the description. It&#39;s cool how the tool has interpreted the text into visual elements.

I should also pay attention to the &#34;Visual Prompt&#34; section, which says &#34;View only.&#34; That probably means I can&#39;t edit it directly, but I can view the generated videos based on this prompt.

Hmm, maybe I should try changing the prompt to see different results. For example, instead of a pelican riding a bicycle, maybe I could describe a different scene. But for now, I&#39;ll stick with the given example to understand how it works.

After clicking &#34;Create videos,&#34; I expect to see the videos being generated. There might be a loading process, depending on the complexity of the prompt and the tool&#39;s processing speed.

Once the videos are ready, I can preview them to see how well they match my description. If I&#39;m not satisfied, I can always go back and adjust the prompt or try different style options.

Overall, this seems like a powerful tool for creating custom videos based on textual descriptions. It could be really useful for storytelling, presentations, or even just for fun, experimenting with different scenes and styles.

I think I&#39;ll spend some time exploring the different style options to see how they affect the final videos. For instance, selecting &#34;35mm film&#34; might give the videos a vintage, cinematic look, while &#34;abstract&#34; could produce more artistic and less realistic visuals.

Also, I wonder if there&#39;s a way to customize more specific aspects, like the camera angle, lighting, or movement. Maybe after generating the initial videos, there are additional editing options available.

In summary, I&#39;m excited to use this Text to Video tool and see what kind of creative possibilities it opens up. With a bit of practice, I could probably create some impressive visual content just by describing what I want to see.

**Final Answer**

To proceed with generating videos based on the provided text prompt, I need to click on the &#34;Create videos&#34; button. This action will initiate the process of converting the textual description into visual content, resulting in multiple video thumbnails that can be previewed for further use or adjustments.
==========
Prompt: 0.870 tokens-per-sec
Generation: 7.694 tokens-per-sec
</code></pre>


</div>


</div></div>
  </body>
</html>
