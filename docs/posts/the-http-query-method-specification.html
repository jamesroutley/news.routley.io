<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-safe-method-w-body.html">Original</a>
    <h1>The HTTP QUERY Method specification</h1>
    
    <div id="readability-page-1" class="page">
<table>
<thead><tr>
<td>Internet-Draft</td>
<td>The HTTP QUERY Method</td>
<td>May 2023</td>
</tr></thead>
<tfoot><tr>
<td>Reschke, et al.</td>
<td>Expires 27 November 2023</td>
<td>[Page]</td>
</tr></tfoot>
</table>



<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This specification defines a new HTTP method, QUERY, as a safe, idempotent
        request method that can carry request content.<a href="#section-abstract-1">¶</a></p>
</section>
<section id="section-note.1">
      <h2 id="name-editorial-note">
<a href="#name-editorial-note">Editorial Note</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1">¶</a></p>
<p id="section-note.1-2">
        Discussion of this draft takes place on the HTTP working group
        mailing list (ietf-http-wg@w3.org), which is archived at
        <span><a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a></span>.<a href="#section-note.1-2">¶</a></p>
<p id="section-note.1-3">
        Working Group information can be found at <span><a href="https://httpwg.org/">https://httpwg.org/</a></span>;
        source code and issues list for this draft can be found at
        <span><a href="https://github.com/httpwg/http-extensions/labels/safe-method-w-body">https://github.com/httpwg/http-extensions/labels/safe-method-w-body</a></span>.<a href="#section-note.1-3">¶</a></p>
<p id="section-note.1-4">
        The changes in this draft are summarized in <a href="#changes.since.02">Appendix A.3</a>.<a href="#section-note.1-4">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as &#34;work in progress.&#34;<a href="#section-boilerplate.1-3">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 November 2023.<a href="#section-boilerplate.1-4">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust&#39;s Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>

<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1">1. </a><a href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
      This specification defines the HTTP QUERY request method as a means of
      making a safe, idempotent request that contains content.<a href="#section-1-1">¶</a></p>
<p id="section-1-2">
      Most often, this is desirable when the data conveyed in a request is
      too voluminous to be encoded into the request&#39;s URI. For example, while
      this is an common and interoperable query:<a href="#section-1-2">¶</a></p>
<div id="section-1-3">
<pre>GET /feed?q=foo&amp;limit=10&amp;sort=-published HTTP/1.1
Host: example.org
</pre><p><a href="#section-1-3">¶</a>
</p></div>
<p id="section-1-4">
      if the query parameters extend to several kilobytes or more of
      data it may not be, because many implementations place limits on their size. Often these limits are not
      known or discoverable ahead of time, because a request can pass through many uncoordinated
      systems. Additionally, expressing some data in the target URI is inefficient, because it
      needs to be encoded to be a valid URI.<a href="#section-1-4">¶</a></p>
<p id="section-1-5">
      Encoding query parameters directly into the request URI also effectively
      casts every possible combination of query inputs as distinct
      resources. Depending on the application, that may not be desirable.<a href="#section-1-5">¶</a></p>
<p id="section-1-6">
      As an alternative to using GET, many implementations make use of the
      HTTP POST method to perform queries, as illustrated in the example
      below. In this case, the input parameters to the search operation are
      passed along within the request content as opposed to using the
      request URI.<a href="#section-1-6">¶</a></p>
<p id="section-1-7">
      A typical use of HTTP POST for requesting a search<a href="#section-1-7">¶</a></p>
<div id="section-1-8">
<pre>POST /feed HTTP/1.1
Host: example.org
Content-Type: application/x-www-form-urlencoded

q=foo&amp;limit=10&amp;sort=-published
</pre><p><a href="#section-1-8">¶</a>
</p></div>
<p id="section-1-9">
      This variation, however, suffers from the same basic limitation as GET
      in that it is not readily apparent -- absent specific knowledge of the
      resource and server to which the request is being sent -- that a safe,
      idempotent query is being performed.<a href="#section-1-9">¶</a></p>
<p id="section-1-10">
      The QUERY method provides a solution that spans the gap between the use of GET and POST. As
      with POST, the input to the query operation is passed along within the content of the request
      rather than as part of the request URI. Unlike POST, however, the method is explicitly safe
      and idempotent, allowing functions like caching and automatic retries to operate.<a href="#section-1-10">¶</a></p>
<p id="section-1-11">
      The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL
      NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;NOT RECOMMENDED&#34;,
      &#34;MAY&#34;, and &#34;OPTIONAL&#34; in this document are to be interpreted as
      described in BCP 14 <span>[<a href="#RFC2119">RFC2119</a>]</span> <span>[<a href="#RFC8174">RFC8174</a>]</span> when, and only when, they
      appear in all capitals, as shown here.<a href="#section-1-11">¶</a></p>
</section>
</div>
<div id="search">
<section id="section-2">
      <h2 id="name-query">
<a href="#section-2">2. </a><a href="#name-query">QUERY</a>
      </h2>
<p id="section-2-1">
      The QUERY method is used to initiate a server-side query. Unlike
      the HTTP GET method, which requests that a server return a
      representation of the resource identified by the target URI
      (as defined by <span><a href="https://rfc-editor.org/rfc/rfc9110#section-7.1">Section 7.1</a> of [<a href="#HTTP">HTTP</a>]</span>), the QUERY
      method is used to ask the server to perform a query operation
      (described by the request content) over some set of data scoped to the
      effective request URI. The content returned in response to a QUERY
      cannot be assumed to be a representation of the resource identified by
      the effective request URI.<a href="#section-2-1">¶</a></p>
<p id="section-2-2">
      The content of the request defines the query. Implementations <span>MAY</span> use
      a request content of any media type with the QUERY method, provided that it
      has appropriate query semantics.<a href="#section-2-2">¶</a></p>
<p id="section-2-3">
      QUERY requests are both safe and idempotent with regards to the
      resource identified by the request URI. That is, QUERY requests do not
      alter the state of the targeted resource. However, while processing a
      QUERY request, a server can be expected to allocate computing and memory
      resources or even create additional HTTP resources through which the
      response can be retrieved.<a href="#section-2-3">¶</a></p>
<p id="section-2-4">
      A successful response to a QUERY request is expected to provide some
      indication as to the final disposition of the operation. For
      instance, a successful query that yields no results can be represented
      by a 204 No Content response. If the response includes content,
      it is expected to describe the results of the operation.
      In some cases, the server may choose to respond indirectly to the QUERY
      request by returning a 3xx Redirection with a Location header field specifying
      an alternate Request URI from which the results can be retrieved
      using an HTTP GET request. Various non-normative examples of successful
      QUERY responses are illustrated in <a href="#examples">Section 4</a>.<a href="#section-2-4">¶</a></p>
<p id="section-2-5">
      The semantics of the QUERY method change to a &#34;conditional QUERY&#34; if
      the request message includes an If-Modified-Since, If-Unmodified-
      Since, If-Match, If-None-Match, or If-Range header field
      (<span>[<a href="#HTTP">HTTP</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-13">Section 13</a></span>).  A conditional QUERY requests that the query
      be performed only under the circumstances described by the conditional
      header field(s). It is important to note, however, that such conditions
      are evaluated against the state of the target resource itself as opposed
      to the collected results of the search operation.<a href="#section-2-5">¶</a></p>
<section id="section-2.1">
        <h3 id="name-caching">
<a href="#section-2.1">2.1. </a><a href="#name-caching">Caching</a>
        </h3>
<p id="section-2.1-1">
        The response to a QUERY method is cacheable; a cache <span>MAY</span> use it to satisfy subsequent
        QUERY requests as per <span><a href="https://rfc-editor.org/rfc/rfc9111#section-4">Section 4</a> of [<a href="#HTTP-CACHING">HTTP-CACHING</a>]</span>).<a href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">
        The cache key for a query (see <span><a href="https://rfc-editor.org/rfc/rfc9111#section-2">Section 2</a> of [<a href="#HTTP-CACHING">HTTP-CACHING</a>]</span>) <span>MUST</span>
        incorporate the request content. When doing so, caches <span>SHOULD</span> first normalize request
        content to remove semantically insignificant differences, thereby improving cache
        efficiency, by:<a href="#section-2.1-2">¶</a></p>
<ul>
<li id="section-2.1-3.1">Removing content encoding(s)<a href="#section-2.1-3.1">¶</a>
</li>
          <li id="section-2.1-3.2">Normalizing based upon knowledge of format conventions, as indicated by the any media type suffix in the request&#39;s Content-Type field (e.g., &#34;+json&#34;)<a href="#section-2.1-3.2">¶</a>
</li>
          <li id="section-2.1-3.3">Normalizing based upon knowledge of the semantics of the content itself, as indicated by the request&#39;s Content-Type field.<a href="#section-2.1-3.3">¶</a>
</li>
        </ul>
<p id="section-2.1-4">
        Note that any such normalization is performed solely for the purpose of generating a cache key; it
        does not change the request itself.<a href="#section-2.1-4">¶</a></p>
</section>
</section>
</div>
<div id="field.accept-query">
<section id="section-3">
      
<p id="section-3-1">
      The &#34;Accept-Query&#34; response header field <span>MAY</span> be used by a server to
      directly signal support for the QUERY method while identifying
      the specific query format media type(s) that may be used.<a href="#section-3-1">¶</a></p>
<div id="section-3-2">
<pre>Accept-Query = 1#media-type
</pre><p><a href="#section-3-2">¶</a>
</p></div>
<p id="section-3-3">
      The Accept-Query header field specifies a comma-separated listing of media
      types (with optional parameters) as defined by
      <span><a href="https://rfc-editor.org/rfc/rfc9110#section-8.3.1">Section 8.3.1</a> of [<a href="#HTTP">HTTP</a>]</span>.<a href="#section-3-3">¶</a></p>
<p id="section-3-4">
      The order of types listed by the Accept-Query header field is not significant.<a href="#section-3-4">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-4">
      <h2 id="name-examples">
<a href="#section-4">4. </a><a href="#name-examples">Examples</a>
      </h2>
<p id="section-4-1">
      The non-normative examples in this section make use of a simple,
      hypothetical plain-text based query syntax based on SQL with results
      returned as comma-separated values. This is done for illustration
      purposes only. Implementations are free to use any format they wish on
      both the request and response.<a href="#section-4-1">¶</a></p>
<section id="section-4.1">
        <h3 id="name-simple-query-with-a-direct-">
<a href="#section-4.1">4.1. </a><a href="#name-simple-query-with-a-direct-">Simple QUERY with a Direct Response</a>
        </h3>
<p id="section-4.1-1">A simple query with a direct response:<a href="#section-4.1-1">¶</a></p>
<div id="section-4.1-2">
<pre>QUERY /contacts HTTP/1.1
Host: example.org
Content-Type: example/query
Accept: text/csv

select surname, givenname, email limit 10
</pre><p><a href="#section-4.1-2">¶</a>
</p></div>
<p id="section-4.1-3">Response:<a href="#section-4.1-3">¶</a></p>
<div id="section-4.1-4">
<pre>HTTP/1.1 200 OK
Content-Type: text/csv

surname, givenname, email
Smith, John, john.smith@example.org
Jones, Sally, sally.jones@example.com
Dubois, Camille, camille.dubois@example.net
</pre><p><a href="#section-4.1-4">¶</a>
</p></div>
</section>
<section id="section-4.2">
        <h3 id="name-simple-query-with-indirect-">
<a href="#section-4.2">4.2. </a><a href="#name-simple-query-with-indirect-">Simple QUERY with indirect response (303 See Other)</a>
        </h3>
<p id="section-4.2-1">A simple query with an Indirect Response (303 See Other):<a href="#section-4.2-1">¶</a></p>
<div id="section-4.2-2">
<pre>QUERY /contacts HTTP/1.1
Host: example.org
Content-Type: example/query
Accept: text/csv

select surname, givenname, email limit 10
</pre><p><a href="#section-4.2-2">¶</a>
</p></div>
<p id="section-4.2-3">Response:<a href="#section-4.2-3">¶</a></p>
<div id="section-4.2-4">
<pre>HTTP/1.1 303 See Other
Location: http://example.org/contacts/query123
</pre><p><a href="#section-4.2-4">¶</a>
</p></div>
<p id="section-4.2-5">Fetch Query Response:<a href="#section-4.2-5">¶</a></p>
<div id="section-4.2-6">
<pre>GET /contacts/query123 HTTP/1.1
Host: example.org
</pre><p><a href="#section-4.2-6">¶</a>
</p></div>
<p id="section-4.2-7">Response:<a href="#section-4.2-7">¶</a></p>
<div id="section-4.2-8">
<pre>HTTP/1.1 200 OK
Content-Type: text/csv

surname, givenname, email
Smith, John, john.smith@example.org
Jones, Sally, sally.jones@example.com
Dubois, Camille, camille.dubois@example.net
</pre><p><a href="#section-4.2-8">¶</a>
</p></div>
</section>
</section>
</div>
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5">5. </a><a href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">
      The QUERY method is subject to the same general security
      considerations as all HTTP methods as described in
      <span>[<a href="#HTTP">HTTP</a>]</span>.<a href="#section-5-1">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6">6. </a><a href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">
      IANA is requested to add QUERY method in the
      permanent registry at &lt;http://www.iana.org/assignments/http-methods&gt;
      (see <span><a href="https://rfc-editor.org/rfc/rfc9110#section-16.1.1">Section 16.1.1</a> of [<a href="#HTTP">HTTP</a>]</span>).<a href="#section-6-1">¶</a></p>
<table id="table-1">
        <caption><a href="#table-1">Table 1</a></caption>
<thead>
          <tr>
            <th rowspan="1" colspan="1">Method Name</th>
            <th rowspan="1" colspan="1">Safe</th>
            <th rowspan="1" colspan="1">Idempotent</th>
            <th rowspan="1" colspan="1">Specification</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">QUERY</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">
              <a href="#search">Section 2</a>
</td>
          </tr>
        </tbody>
      </table>
</section>
<section id="section-7">
      <h2 id="name-normative-references">
<a href="#section-7">7. </a><a href="#name-normative-references">Normative References</a>
      </h2>
<dl>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span>Bradner, S.</span>, <span>&#34;Key words for use in RFCs to Indicate Requirement Levels&#34;</span>, <span>BCP 14</span>, <span>RFC 2119</span>, <span>DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span>Leiba, B.</span>, <span>&#34;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&#34;</span>, <span>BCP 14</span>, <span>RFC 8174</span>, <span>DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd></dd>
<dt id="HTTP">[HTTP]</dt>
      <dd>
<span>Fielding, R., Ed.</span>, <span>Nottingham, M., Ed.</span>, and <span>J. Reschke, Ed.</span>, <span>&#34;HTTP Semantics&#34;</span>, <span>STD 97</span>, <span>RFC 9110</span>, <time datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd></dd>
<dt id="HTTP-CACHING">[HTTP-CACHING]</dt>
    <dd>
<span>Fielding, R., Ed.</span>, <span>Nottingham, M., Ed.</span>, and <span>J. Reschke, Ed.</span>, <span>&#34;HTTP Caching&#34;</span>, <span>STD 98</span>, <span>RFC 9111</span>, <time datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9111">https://www.rfc-editor.org/rfc/rfc9111</a>&gt;</span>. </dd>
<dd></dd>
</dl>
</section>

<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses">Authors&#39; Addresses</a>
      </h2>
<address>
        <p><span>Julian Reschke</span></p>
<p><span>greenbytes GmbH</span></p>
<p><span>Hafenweg 16</span></p>
<p><span>48155</span> <span>Münster</span>
</p>
<p><span>Germany</span></p>


</address>
<address>
        <p><span>Ashok Malhotra</span></p>

</address>
<address>
        <p><span>James M Snell</span></p>

</address>
</section>
</div>



</div>
  </body>
</html>
