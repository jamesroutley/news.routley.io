<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2022/04/06/text/">Original</a>
    <h1>You can do a lot with an empty file</h1>
    
    
<p>
Yesterday's
<a href="/w/2022/04/05/pipe/">post</a>
about "pipefail" also involved some systems which treated an empty file 
as a valid file.  This turns out to be surprisingly common.  I think 
people might be shocked at exactly how much you can get away with, and 
how many different things will accept such a beast.
</p><p>
One of the failure modes I used to see with certain package-based 
systems at a job with a large number of computers is that sometimes it 
would just fail to populate it with actual data.  This might've been due 
to a reboot during the package install process, or maybe the packager 
got killed for some reason, but it meant all kinds of badness would 
happen.
</p><p>
In particular, I saw times where it would drop a file on the disk in 
the right place, with the right permissions (readable + executable)
but totally empty!  Then, later on, something or other would ask if the 
package was installed, and as far as the package database was 
concerned, it was.  Also, then the cron job would try to run one of 
these binaries... and it wouldn't fail.  Nope, it was perfectly happy 
running exactly nothing.
</p><p>
Yes, if you weren't already aware of this, an empty file that's 
executable will totally "run" to "completion" and will even yield an 
exitcode of 0.  If you are checking that exitcode for success or 
failure, it's going to think everything is just fine.
</p><p>
No, really, look:
</p><p>
<pre>
linux$ touch empty
linux$ chmod a+rx empty
linux$ ls -l empty
-rwxr-xr-x 1 rkroll rkroll 0 Apr  6 12:07 empty
linux$ ./empty
linux$ echo $?
0
</pre>
</p><p>
Awesome, right?  This works just fine on Macs as well.  I don't have 
quite the assortment of shell accounts on other flavors of Unix that I 
did back in the '90s to test further, but I have to assume it'll 
probably work most of the time.  It's probably something funny involving 
how the interpreter is spun up - looking for #! and that kind of stuff.
</p><p>
I mean, what would the error be, anyway?
</p><p>
Does this mean the smallest /bin/true is actually an empty file?
</p>

  </body>
</html>
