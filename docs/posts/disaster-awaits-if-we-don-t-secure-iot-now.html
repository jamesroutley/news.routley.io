<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://spectrum.ieee.org/iot-security-root-of-trust">Original</a>
    <h1>Disaster awaits if we don&#39;t secure IoT now</h1>
    
    <div id="readability-page-1" class="page"><div data-headline="Disaster Awaits if We Don’t Secure IoT Now"><div><p>In 2015, <a href="https://spectrum.ieee.org/tag/ukraine">Ukraine</a> experienced a slew of unexpected <a href="https://www.cisa.gov/news-events/ics-alerts/ir-alert-h-16-056-01" rel="noopener noreferrer" target="_blank">power outages</a>. Much of the country went dark. The U.S. investigation has concluded that this was due to a Russian state cyberattack on Ukrainian computers running critical infrastructure.</p><p>In the decade that followed, <a data-linked-post="2658630634" href="https://spectrum.ieee.org/cyberattacks" target="_blank">cyberattacks</a> on critical infrastructure and near-misses <a href="https://www.rand.org/pubs/commentary/2024/02/threats-to-americas-critical-infrastructure-are-now-a-terrifying-reality.html" rel="noopener noreferrer" target="_blank">continued</a>. In 2017, a <a href="https://www.kcur.org/news/2022-03-24/federal-officials-say-russian-spies-tried-to-hack-into-a-kansas-nuclear-power-plant" rel="noopener noreferrer" target="_blank">nuclear power plant</a> in Kansas was the subject of a Russian cyberattack. In 2021, Chinese state actors reportedly gained access to parts of the <a href="https://spectrum.ieee.org/tag/new-york-city">New York City</a> <a href="https://spectrum.ieee.org/tag/subway">subway</a> computer system. Later in 2021, a <a href="https://www.cnn.com/2021/06/02/business/beef-hack-jbs/index.html" rel="noopener noreferrer" target="_blank">cyberattack</a> temporarily closed down beef processing plants. In 2023, <a href="https://spectrum.ieee.org/tag/microsoft">Microsoft</a> reported a cyberattack on its <a href="https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/" rel="noopener noreferrer" target="_blank">IT systems</a>, likely by Chinese-backed actors.</p><p>The risk is growing, particularly when it comes to <a data-linked-post="2659970239" href="https://spectrum.ieee.org/iot-for-arson-forensics" target="_blank">internet of things</a> (<a href="https://spectrum.ieee.org/tag/iot">IoT</a>) devices. Just below the veneer of popular fad <a href="https://spectrum.ieee.org/tag/gadgets">gadgets</a> (does anyone <em><em>really</em></em> want their refrigerator to automatically place orders for groceries?) is an increasing army of more prosaic Internet-connected devices that take care of keeping our world running. This is particularly true of a sub-class called <a data-linked-post="2650277653" href="https://spectrum.ieee.org/the-industrial-internet-of-things" target="_blank">Industrial Internet of Things</a> (IIoT), devices that implement our <a href="https://spectrum.ieee.org/tag/communication-networks">communication networks</a>, or control infrastructure such as <a href="https://spectrum.ieee.org/tag/power-grids">power grids</a> or chemical plants. IIoT devices can be small devices like valves or sensors, but also can include very substantial pieces of gear, such as an <a href="https://spectrum.ieee.org/tag/hvac">HVAC</a> system, an <a href="https://spectrum.ieee.org/tag/mri">MRI</a> machine, a dual-use aerial drone, an elevator, a nuclear centrifuge, or a jet engine. </p><p>The number of current <a href="https://spectrum.ieee.org/tag/iot-devices">IoT devices</a> is growing rapidly. In 2019, there were an <a href="https://explodingtopics.com/blog/iot-stats" rel="noopener noreferrer" target="_blank">estimated</a> 10 billion IoT devices in operation. At the end of 2024, it had almost doubled to <a href="https://iot-analytics.com/number-connected-iot-devices/" rel="noopener noreferrer" target="_blank">approximately</a> 19 billion. This number is set to more than double again by 2030. Cyber-attacks aimed at those devices, motivated either by political or financial gain, can cause very real physical-world damage to entire communities, far beyond damage to the device itself.</p><p>Security for IoT devices is often an afterthought, as they often have little need for a “human interface” (i.e., maybe a valve in a chemical plant only needs commands to Open, Close and Report), and usually they don’t contain information that would be viewed as sensitive (i.e., thermostats don’t need <a href="https://spectrum.ieee.org/tag/credit-cards">credit cards</a>, a medical device doesn’t have a Social Security Number). What could go wrong?</p><p>Of course, “what could go wrong” depends on the device, but especially with carefully planned, at-scale attacks, it’s already been shown that a lot can go wrong. For example, armies of poorly-secured, <a href="https://spectrum.ieee.org/tag/internet">internet</a> connected security <a href="https://spectrum.ieee.org/tag/cameras">cameras</a> have<a href="https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/" rel="noopener noreferrer" target="_blank"> already</a> been put to use in coordinated Distributed <a href="https://spectrum.ieee.org/tag/denial-of-service">Denial of Service</a> attacks, where each camera makes a few harmless requests of some victim service, causing the service to collapse under the load.</p><h2>How to secure IoT devices</h2><p>Measures to defend these devices generally fall into two categories: basic <a href="https://spectrum.ieee.org/tag/cybersecurity">cybersecurity</a> hygiene and defense in depth.</p><p>Cybersecurity hygiene consists of a few rules: Don’t use default <a href="https://spectrum.ieee.org/tag/passwords">passwords</a> on admin accounts, apply software updates regularly to remove newly-discovered vulnerabilities, require cryptographic signatures to validate updates, and understand your “<a href="https://datatracker.ietf.org/group/scitt/about/" rel="noopener noreferrer" target="_blank">software supply chain</a>:” where your software comes from, where the supplier obtains components that they may simply be passing through from open-source projects.</p><p>The rapid profusion of open-source software has prompted development of the US Government’s Software Bill of Materials (<a href="https://www.cisa.gov/sbom" rel="noopener noreferrer" target="_blank">SBOM</a>). This is a document that conveys <a href="https://spectrum.ieee.org/tag/supply-chain">supply chain</a> provenance, indicating which version of what packages went into making the product’s software. Both IIoT device suppliers and device users benefit from accurate SBOMs, shortening the path to determining if a specific device’s software may contain a version of a package vulnerable to attack. If the SBOM shows an up-to-date package version where the vulnerability has been addressed, both the IIoT vendor and user can breathe easy; if the package version listed in the SBOM is vulnerable, remediation may be in order.</p><p>Defense in depth is less well-known, and deserves more attention.</p><p>It is tempting to implement the easiest approach to cybersecurity, a “hard and crunchy on the outside, soft and chewy inside” model. This emphasizes perimeter defense, on the theory that if <a href="https://spectrum.ieee.org/tag/hackers">hackers</a> can’t get in, they can’t do damage. But even the smallest IoT devices may have a software stack that’s too complex for the designers to fully comprehend, usually leading to obscure vulnerabilities in dark corners of the code. As soon as these vulnerabilities become known, the device transitions from tight, well-managed security to no security, as there’s no second line of defense.</p><p>Defense in depth is the answer. A National Institute of Standards and Technology <a href="https://csrc.nist.gov/pubs/sp/800/193/final" rel="noopener noreferrer" target="_blank">publication</a> breaks down this approach to cyber resilience into three basic functions: <em><em>protect</em></em>, meaning use cybersecurity engineering to keep hackers out; <em><em>detect</em></em>, meaning add mechanisms to detect unexpected intrusions; and <em><em>remediate</em></em>, meaning take action to expel intruders to prevent subsequent damage. We will explore each of these in turn.</p><h2>Protect</h2><p>Systems that are designed for security use a layered approach, with most of the device’s “normal behavior” in an outer layer, while inner layers form a series of shells, each of which has smaller, more constrained functionality, making the inner shells progressively simpler to defend. These layers are often related to the sequence of steps followed during the initialization of the device, where the device starts in the inner layer with the smallest possible functionality, with just enough to get the next stage running, and so on until the outer layer is functional. </p><p>To ensure correct operation, each layer must also perform an integrity check on the next layer before starting it. In each ring, the current layer computes a <a href="https://spectrum.ieee.org/tag/fingerprint">fingerprint</a> or signature of the next layer out.</p><p><img alt="Concentric circles with labels: hardware root of trust (if present), firmware, operating system loader, operating system kernel, application software. " data-rm-shortcode-id="75446c778b28427c03db5d04d04c9f45" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/concentric-circles-with-labels-hardware-root-of-trust-if-present-firmware-operating-system-loader-operating-system-kernel.png?id=60339975&amp;width=980" height="1178" id="a1c56" lazy-loadable="true" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%202668%201178&#39;%3E%3C/svg%3E" width="2668"/><small placeholder="Add Photo Caption...">To make a defensible IoT device, the software needs to be layered, with each layer only running if the previous layer has deemed it safe. </small><small placeholder="Add Photo Credit...">Guy Fedorkow, Mark Montgomery </small></p><p>But there’s a puzzle here. Each layer is checking the next one before starting it, but who checks the first one? No one! The inner layer, whether the first checker is implemented in hardware or <a href="https://spectrum.ieee.org/tag/firmware">firmware</a>, must be implicitly trusted for the rest of the system to be worthy of trust. As such, it’s called a Root of Trust (RoT). </p><p>Roots of Trust must be carefully protected, because a compromise of the Root of Trust may be impossible to detect without specialized test hardware. One approach is to put the firmware that implements the Root of Trust into read-only memory that can’t be modified once the device is manufactured. That’s great if you know your RoT code doesn’t have any bugs, and uses <a href="https://spectrum.ieee.org/tag/algorithms">algorithms</a> that can’t go obsolete. But few of us live in that world, so, at a minimum, we usually must protect the RoT code with some simple hardware that makes the firmware read-only after it’s done its job, but writable during its startup phase, allowing for carefully vetted, cryptographically signed updates. </p><p>Newer processor chips move this Root of Trust one step back into the processor chip itself, a hardware Root of Trust. This makes the RoT much more resistant to firmware vulnerabilities or a hardware-based attack, because firmware boot code is usually stored in non-volatile <a href="https://spectrum.ieee.org/tag/flash-memory">flash memory</a> where it can be reprogrammed by the system manufacturer (and also by hackers). An RoT inside the processor can be made much more difficult to hack.</p><h2>Detect</h2><p>Having a reliable Root of Trust, we can arrange so each layer is able to check the next for hacks. This process can be augmented with <a href="https://datatracker.ietf.org/doc/rfc9683/" rel="noopener noreferrer" target="_blank">Remote Attestation</a>, where we collect and report the <a href="https://spectrum.ieee.org/tag/fingerprints">fingerprints</a> (called <em><em>attestation evidence</em></em>) gathered by each layer during the startup process. We can’t just ask the outer application layer if it’s been hacked; of course, any good <a href="https://spectrum.ieee.org/tag/hacker">hacker</a> would ensure the answer is “No Way! You can trust me!”, no matter what.</p><p>But remote attestation adds a small bit of hardware, such as the <a href="https://trustedcomputinggroup.org/new-tcg-guidance-simplifies-creating-cyber-resilient-devices/" rel="noopener noreferrer" target="_blank">Trusted Platform Module</a> (TPM) defined by the Trusted Computing Group. This bit of hardware collects evidence in shielded locations made of special-purpose, hardware-isolated memory cells that can’t be directly changed by the processor at all. The TPM also provides protected capability, which ensures that new information can be added to the shielded locations, but previously-stored information cannot be changed. And, it provides a protected capability that attaches a cryptographic signature to the contents of the Shielded Location to serve as evidence of the state of the machine, using a key known only to the Root of Trust hardware, called an Attestation Key (AK).</p><p>Given these functions, the application layer has no choice but to accurately report the attestation evidence, as proven by use of the RoT’s AK secret key. Any attempt to tamper with the evidence would invalidate the signature provided by the AK. At a remote location, a verifier can then validate the signature and check that all the fingerprints reported line up with known, trusted, versions of the device’s software. These known-good fingerprints, called endorsements, must come from a trusted source, such as the device manufacturer.  </p><p><img alt="A flow chart showing device manufacturer flowing to attester and verifier. " data-rm-shortcode-id="1ae39c03bcd527b4c6371f010c8e3fe3" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/a-flow-chart-showing-device-manufacturer-flowing-to-attester-and-verifier.png?id=60339987&amp;width=980" height="1346" id="2f6fb" lazy-loadable="true" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%202668%201346&#39;%3E%3C/svg%3E" width="2668"/><small placeholder="Add Photo Caption...">To verify that it’s safe to turn on an IoT device, one can use an attestation and verification protocol provided by the Trusted Computing Group. </small><small placeholder="Add Photo Credit...">Guy Fedorkow, Mark Montgomery</small></p><p>In practice, the Root of Trust may contain several separate mechanisms to protect individual functions, such as boot integrity, attestation and device identity, and the device designer is always responsible for assembling the specific components most appropriate for the device, then carefully integrating them, but organizations like Trusted Computing Group offer guidance and specifications for components that can offer considerable help, such as the Trusted Platform Module (TPM) commonly used in many larger computer systems.</p><h2>Remediate</h2><p>Once an anomaly is detected, there are a wide range of actions to remediate. A simple option is power-cycling the device or refreshing its software. However, trusted components inside the devices themselves may help with remediation through the use of authenticated watchdog timers or other approaches that cause the device to reset itself if it can’t demonstrate good health. <a href="https://trustedcomputinggroup.org/work-groups/cyber-resilient-technologies/" rel="noopener noreferrer" target="_blank"> Trusted Computing Group Cyber Resilience</a> provides guidance for these techniques.</p><p>The requirements outlined here have been available and used in specialized high-security applications for some years, and many of the attacks have been known for a decade. In the last few years, Root of Trust implementations have become widely used in <a href="https://techcommunity.microsoft.com/blog/surfaceitpro/study-highlights-critical-role-of-surface-firmware-protection/2245244" rel="noopener noreferrer" target="_blank">some laptop families</a>. But until recently, blocking Root of Trust attacks has been challenging and expensive even for cyber experts in the IIoT space. Fortunately, many of the silicon vendors that supply the underlying IoT hardware are <a href="https://docs.broadcom.com/doc/53650-PB" rel="noopener noreferrer" target="_blank">now</a><a href="https://docs.broadcom.com/doc/Data-Center-Security-WP100" rel="noopener noreferrer" target="_blank"> including</a><a href="https://www.marvell.com/content/dam/marvell/en/public-collateral/embedded-processors/marvell-infrastructure-processors-octeon-tx2-cn913x-product-brief.pdf" rel="noopener noreferrer" target="_blank"> these</a> high-security<a href="https://edc.intel.com/content/www/us/en/design/ipla/software-development-platforms/client/platforms/alder-lake-desktop/12th-generation-intel-core-processors-datasheet-volume-1-of-2/010/boot-guard-technology/" rel="noopener noreferrer" target="_blank"> mechanism</a> even in the budget-minded embedded chips, and reliable software stacks have evolved to make mechanisms for Root of Trust defense more available to any designer who wants to use it.</p><p>While the IIoT device designer has the responsibility to provide these cybersecurity mechanisms, it’s up to system integrators, who are responsible for the security of an overall service interconnecting IoT devices, to require the features from their suppliers, and to coordinate features inside the device with external resilience and monitoring mechanisms, all to take full advantage of the improved security now more readily available than ever.</p><p>Mind your roots of trust!</p></div></div></div>
  </body>
</html>
