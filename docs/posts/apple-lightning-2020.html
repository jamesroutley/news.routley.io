<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nyansatan.github.io/lightning/">Original</a>
    <h1>Apple Lightning (2020)</h1>
    
    <div id="readability-page-1" class="page"><div>

                
                <p>Created on 1.7.20</p>

                <p>
                    Here&#39;s my little article about (almost) everything I know about Apple Lightning and related technologies: <b>Tristar</b>, <b>Hydra</b>, <b>HiFive</b>, <b>SDQ</b>, <b>IDBUS</b> and etc. But first a tiny warning...
                </p>

                <p><i>
                        Read this article on your own <b>risk</b>! The information in this artcile is based on a lot of AppleInternal materials (leaked datasheets, schematics, source codes) I read in a diagonal direction. And of course on my own research too. I have to warn you, the reader, that I have never done such a research before. Thus, this write-up might use incorrect or just weird terms and turn out partially or completely <b>wrong</b>! 
                    </i>
                </p>

                <p>
                    Before going <i>deeper</i>, let&#39;s briefly sort out the terms:
                </p>

                <div>
                    <h2>What&#39;s Lightning?</h2>

                    <p><img src="https://nyansatan.github.io/lightning/resources/lightning_port_pinout.jpg"/></p></div>

                <div>
                    <h2>What&#39;re Tristar and Hydra?</h2>

                    <p><img src="https://nyansatan.github.io/lightning/resources/tristar_logo.png"/></p></div>

                <div>
                    <h2>What&#39;s HiFive?</h2>

                    <p><img src="https://nyansatan.github.io/lightning/resources/lightning_connector.svg"/></p></div>

                <div>
                    <h2>What&#39;re SDQ and IDBUS?</h2>

                    <p><img src="https://nyansatan.github.io/lightning/resources/idbus_little.png"/></p></div>

                <div>
                    <h2>Now we can play</h2><p>

                    Let&#39;s sniff the negotiations between Tristar and HiFive. Take a logic analyzer, a Lightning male-to-female passthrough breakout board, some accessory (normal Lightning to USB cable would fit just fine) and of course some device with Lightning port</p></div>

                <div>
                    <h2>Interpreting IDBUS requests and responses</h2><p>

                    The most important IDBUS request is <b>0x74</b> - it is used for two purposes: to tell HiFive enable full current (in case that&#39;s supported by an accessory) and to ask it about pin configuration the cable supports and some other metadata</p></div>

                <div>
                    <h2>Few words about ESN and Tristar I2C interface</h2><p>

                    Another feature of Tristar I&#39;d like to tell about is ESN. ESN is a little blob that Tristar stores in its EEPROM (on <b>CBTL1610A2</b> and later). It can be retrieved over IDBUS using Serial Number Reader cable (or Kanzi, they are basically the same thing, except for a different USB PID and a little bit different enclosure)</p></div>

                <div>
                    <h2>Tristar electric characteristics</h2><p>

                    Tristar itself is powered up from a 1.8V source. Lines used for IDBUS are 3.0V-tolerant according to my oscilloscope:</p></div>

                <div>
                    <h2>Credits</h2>

                    <p><b>@key2fr</b>, <b>@_L1ngL1ng_</b>, <b>@spbdimka</b>
                </p></div>
            </div></div>
  </body>
</html>
