<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://docs.python.org/3/library/dataclasses.html">Original</a>
    <h1>The Data Classes Decorator</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
        <div>
          <div role="main">
            
  <div id="module-dataclasses">

<p><strong>Source code:</strong> <a href="https://github.com/python/cpython/tree/3.10/Lib/dataclasses.py">Lib/dataclasses.py</a></p>
<hr/>
<p>This module provides a decorator and functions for automatically
adding generated <a href="https://docs.python.org/3/glossary.html#term-special-method"><span>special method</span></a>s such as <code><span>__init__()</span></code> and
<code><span>__repr__()</span></code> to user-defined classes.  It was originally described
in <span id="index-0"></span><a href="https://www.python.org/dev/peps/pep-0557"><strong>PEP 557</strong></a>.</p>
<p>The member variables to use in these generated methods are defined
using <span id="index-1"></span><a href="https://www.python.org/dev/peps/pep-0526"><strong>PEP 526</strong></a> type annotations.  For example, this code:</p>
<div><div><pre><span></span><span>from</span> <span>dataclasses</span> <span>import</span> <span>dataclass</span>

<span>@dataclass</span>
<span>class</span> <span>InventoryItem</span><span>:</span>
    <span>&#34;&#34;&#34;Class for keeping track of an item in inventory.&#34;&#34;&#34;</span>
    <span>name</span><span>:</span> <span>str</span>
    <span>unit_price</span><span>:</span> <span>float</span>
    <span>quantity_on_hand</span><span>:</span> <span>int</span> <span>=</span> <span>0</span>

    <span>def</span> <span>total_cost</span><span>(</span><span>self</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>return</span> <span>self</span><span>.</span><span>unit_price</span> <span>*</span> <span>self</span><span>.</span><span>quantity_on_hand</span>
</pre></div>
</div>
<p>will add, among other things, a <code><span>__init__()</span></code> that looks like:</p>
<div><div><pre><span></span><span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>name</span><span>:</span> <span>str</span><span>,</span> <span>unit_price</span><span>:</span> <span>float</span><span>,</span> <span>quantity_on_hand</span><span>:</span> <span>int</span> <span>=</span> <span>0</span><span>):</span>
    <span>self</span><span>.</span><span>name</span> <span>=</span> <span>name</span>
    <span>self</span><span>.</span><span>unit_price</span> <span>=</span> <span>unit_price</span>
    <span>self</span><span>.</span><span>quantity_on_hand</span> <span>=</span> <span>quantity_on_hand</span>
</pre></div>
</div>
<p>Note that this method is automatically added to the class: it is not
directly specified in the <code><span>InventoryItem</span></code> definition shown above.</p>
<p><span>New in version 3.7.</span></p>
<div id="module-contents">
<h2>Module contents<a href="#module-contents" title="Permalink to this headline">¶</a></h2>
<dl>
<dt id="dataclasses.dataclass">
<code>@</code><code>dataclasses.</code><code>dataclass</code><span>(</span><em><span>*</span></em>, <em><span>init</span><span>=</span><span>True</span></em>, <em><span>repr</span><span>=</span><span>True</span></em>, <em><span>eq</span><span>=</span><span>True</span></em>, <em><span>order</span><span>=</span><span>False</span></em>, <em><span>unsafe_hash</span><span>=</span><span>False</span></em>, <em><span>frozen</span><span>=</span><span>False</span></em>, <em><span>match_args</span><span>=</span><span>True</span></em>, <em><span>kw_only</span><span>=</span><span>False</span></em>, <em><span>slots</span><span>=</span><span>False</span></em><span>)</span><a href="#dataclasses.dataclass" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is a <a href="https://docs.python.org/3/glossary.html#term-decorator"><span>decorator</span></a> that is used to add generated
<a href="https://docs.python.org/3/glossary.html#term-special-method"><span>special method</span></a>s to classes, as described below.</p>
<p>The <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator examines the class to find
<code><span>field</span></code>s.  A <code><span>field</span></code> is defined as a class variable that has a
<a href="https://docs.python.org/3/glossary.html#term-variable-annotation"><span>type annotation</span></a>.  With two
exceptions described below, nothing in <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a>
examines the type specified in the variable annotation.</p>
<p>The order of the fields in all of the generated methods is the
order in which they appear in the class definition.</p>
<p>The <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator will add various “dunder” methods to
the class, described below.  If any of the added methods already
exist in the class, the behavior depends on the parameter, as documented
below. The decorator returns the same class that it is called on; no new
class is created.</p>
<p>If <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> is used just as a simple decorator with no parameters,
it acts as if it has the default values documented in this
signature.  That is, these three uses of <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> are
equivalent:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>...</span>

<span>@dataclass</span><span>()</span>
<span>class</span> <span>C</span><span>:</span>
    <span>...</span>

<span>@dataclass</span><span>(</span><span>init</span><span>=</span><span>True</span><span>,</span> <span>repr</span><span>=</span><span>True</span><span>,</span> <span>eq</span><span>=</span><span>True</span><span>,</span> <span>order</span><span>=</span><span>False</span><span>,</span> <span>unsafe_hash</span><span>=</span><span>False</span><span>,</span> <span>frozen</span><span>=</span><span>False</span><span>,</span> <span>match_args</span><span>=</span><span>True</span><span>,</span> <span>kw_only</span><span>=</span><span>False</span><span>,</span> <span>slots</span><span>=</span><span>False</span><span>)</span>
<span>class</span> <span>C</span><span>:</span>
   <span>...</span>
</pre></div>
</div>
<p>The parameters to <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> are:</p>
<ul>
<li><p><code><span>init</span></code>: If true (the default), a <code><span>__init__()</span></code> method will be
generated.</p>
<p>If the class already defines <code><span>__init__()</span></code>, this parameter is
ignored.</p>
</li>
<li><p><code><span>repr</span></code>: If true (the default), a <code><span>__repr__()</span></code> method will be
generated.  The generated repr string will have the class name and
the name and repr of each field, in the order they are defined in
the class.  Fields that are marked as being excluded from the repr
are not included.  For example:
<code><span>InventoryItem(name=&#39;widget&#39;,</span> <span>unit_price=3.0,</span> <span>quantity_on_hand=10)</span></code>.</p>
<p>If the class already defines <code><span>__repr__()</span></code>, this parameter is
ignored.</p>
</li>
<li><p><code><span>eq</span></code>: If true (the default), an <code><span>__eq__()</span></code> method will be
generated.  This method compares the class as if it were a tuple
of its fields, in order.  Both instances in the comparison must
be of the identical type.</p>
<p>If the class already defines <code><span>__eq__()</span></code>, this parameter is
ignored.</p>
</li>
<li><p><code><span>order</span></code>: If true (the default is <code><span>False</span></code>), <code><span>__lt__()</span></code>,
<code><span>__le__()</span></code>, <code><span>__gt__()</span></code>, and <code><span>__ge__()</span></code> methods will be
generated.  These compare the class as if it were a tuple of its
fields, in order.  Both instances in the comparison must be of the
identical type.  If <code><span>order</span></code> is true and <code><span>eq</span></code> is false, a
<a href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><code><span>ValueError</span></code></a> is raised.</p>
<p>If the class already defines any of <code><span>__lt__()</span></code>,
<code><span>__le__()</span></code>, <code><span>__gt__()</span></code>, or <code><span>__ge__()</span></code>, then
<a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> is raised.</p>
</li>
<li><p><code><span>unsafe_hash</span></code>: If <code><span>False</span></code> (the default), a <code><span>__hash__()</span></code> method
is generated according to how <code><span>eq</span></code> and <code><span>frozen</span></code> are set.</p>
<p><code><span>__hash__()</span></code> is used by built-in <a href="https://docs.python.org/3/library/functions.html#hash" title="hash"><code><span>hash()</span></code></a>, and when objects are
added to hashed collections such as dictionaries and sets.  Having a
<code><span>__hash__()</span></code> implies that instances of the class are immutable.
Mutability is a complicated property that depends on the programmer’s
intent, the existence and behavior of <code><span>__eq__()</span></code>, and the values of
the <code><span>eq</span></code> and <code><span>frozen</span></code> flags in the <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator.</p>
<p>By default, <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> will not implicitly add a <code><span>__hash__()</span></code>
method unless it is safe to do so.  Neither will it add or change an
existing explicitly defined <code><span>__hash__()</span></code> method.  Setting the class
attribute <code><span>__hash__</span> <span>=</span> <span>None</span></code> has a specific meaning to Python, as
described in the <code><span>__hash__()</span></code> documentation.</p>
<p>If <code><span>__hash__()</span></code> is not explicitly defined, or if it is set to <code><span>None</span></code>,
then <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> <em>may</em> add an implicit <code><span>__hash__()</span></code> method.
Although not recommended, you can force <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> to create a
<code><span>__hash__()</span></code> method with <code><span>unsafe_hash=True</span></code>. This might be the case
if your class is logically immutable but can nonetheless be mutated.
This is a specialized use case and should be considered carefully.</p>
<p>Here are the rules governing implicit creation of a <code><span>__hash__()</span></code>
method.  Note that you cannot both have an explicit <code><span>__hash__()</span></code>
method in your dataclass and set <code><span>unsafe_hash=True</span></code>; this will result
in a <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a>.</p>
<p>If <code><span>eq</span></code> and <code><span>frozen</span></code> are both true, by default <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> will
generate a <code><span>__hash__()</span></code> method for you.  If <code><span>eq</span></code> is true and
<code><span>frozen</span></code> is false, <code><span>__hash__()</span></code> will be set to <code><span>None</span></code>, marking it
unhashable (which it is, since it is mutable).  If <code><span>eq</span></code> is false,
<code><span>__hash__()</span></code> will be left untouched meaning the <code><span>__hash__()</span></code>
method of the superclass will be used (if the superclass is
<a href="https://docs.python.org/3/library/functions.html#object" title="object"><code><span>object</span></code></a>, this means it will fall back to id-based hashing).</p>
</li>
<li><p><code><span>frozen</span></code>: If true (the default is <code><span>False</span></code>), assigning to fields will
generate an exception.  This emulates read-only frozen instances.  If
<code><span>__setattr__()</span></code> or <code><span>__delattr__()</span></code> is defined in the class, then
<a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> is raised.  See the discussion below.</p></li>
<li><p><code><span>match_args</span></code>: If true (the default is <code><span>True</span></code>), the
<code><span>__match_args__</span></code> tuple will be created from the list of
parameters to the generated <code><span>__init__()</span></code> method (even if
<code><span>__init__()</span></code> is not generated, see above).  If false, or if
<code><span>__match_args__</span></code> is already defined in the class, then
<code><span>__match_args__</span></code> will not be generated.</p></li>
</ul>
<blockquote>
</blockquote>
<ul>
<li><p><code><span>kw_only</span></code>: If true (the default value is <code><span>False</span></code>), then all
fields will be marked as keyword-only.  If a field is marked as
keyword-only, then the only affect is that the <code><span>__init__()</span></code>
parameter generated from a keyword-only field must be specified
with a keyword when <code><span>__init__()</span></code> is called.  There is no
effect on any other aspect of dataclasses.  See the
<a href="https://docs.python.org/3/glossary.html#term-parameter"><span>parameter</span></a> glossary entry for details.  Also see the
<a href="#dataclasses.KW_ONLY" title="dataclasses.KW_ONLY"><code><span>KW_ONLY</span></code></a> section.</p></li>
</ul>
<blockquote>
</blockquote>
<ul>
<li><p><code><span>slots</span></code>: If true (the default is <code><span>False</span></code>), <code><span>__slots__</span></code> attribute
will be generated and new class will be returned instead of the original one.
If <code><span>__slots__</span></code> is already defined in the class, then <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a>
is raised.</p></li>
</ul>
<blockquote>
</blockquote>
<p><code><span>field</span></code>s may optionally specify a default value, using normal
Python syntax:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>a</span><span>:</span> <span>int</span>       <span># &#39;a&#39; has no default value</span>
    <span>b</span><span>:</span> <span>int</span> <span>=</span> <span>0</span>   <span># assign a default value for &#39;b&#39;</span>
</pre></div>
</div>
<p>In this example, both <code><span>a</span></code> and <code><span>b</span></code> will be included in the added
<code><span>__init__()</span></code> method, which will be defined as:</p>
<div><div><pre><span></span><span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>a</span><span>:</span> <span>int</span><span>,</span> <span>b</span><span>:</span> <span>int</span> <span>=</span> <span>0</span><span>):</span>
</pre></div>
</div>
<p><a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> will be raised if a field without a default value
follows a field with a default value.  This is true whether this
occurs in a single class, or as a result of class inheritance.</p>
</dd></dl>

<dl>
<dt id="dataclasses.field">
<code>dataclasses.</code><code>field</code><span>(</span><em><span>*</span></em>, <em><span>default</span><span>=</span><span>MISSING</span></em>, <em><span>default_factory</span><span>=</span><span>MISSING</span></em>, <em><span>init</span><span>=</span><span>True</span></em>, <em><span>repr</span><span>=</span><span>True</span></em>, <em><span>hash</span><span>=</span><span>None</span></em>, <em><span>compare</span><span>=</span><span>True</span></em>, <em><span>metadata</span><span>=</span><span>None</span></em>, <em><span>kw_only</span><span>=</span><span>MISSING</span></em><span>)</span><a href="#dataclasses.field" title="Permalink to this definition">¶</a></dt>
<dd><p>For common and simple use cases, no other functionality is
required.  There are, however, some dataclass features that
require additional per-field information.  To satisfy this need for
additional information, you can replace the default field value
with a call to the provided <a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a> function.  For example:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>mylist</span><span>:</span> <span>list</span><span>[</span><span>int</span><span>]</span> <span>=</span> <span>field</span><span>(</span><span>default_factory</span><span>=</span><span>list</span><span>)</span>

<span>c</span> <span>=</span> <span>C</span><span>()</span>
<span>c</span><span>.</span><span>mylist</span> <span>+=</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>3</span><span>]</span>
</pre></div>
</div>
<p>As shown above, the <a href="#dataclasses.MISSING" title="dataclasses.MISSING"><code><span>MISSING</span></code></a> value is a sentinel object used to
detect if some parameters are provided by the user. This sentinel is
used because <code><span>None</span></code> is a valid value for some parameters with
a distinct meaning.  No code should directly use the <a href="#dataclasses.MISSING" title="dataclasses.MISSING"><code><span>MISSING</span></code></a> value.</p>
<p>The parameters to <a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a> are:</p>
<ul>
<li><p><code><span>default</span></code>: If provided, this will be the default value for this
field.  This is needed because the <a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a> call itself
replaces the normal position of the default value.</p></li>
<li><p><code><span>default_factory</span></code>: If provided, it must be a zero-argument
callable that will be called when a default value is needed for
this field.  Among other purposes, this can be used to specify
fields with mutable default values, as discussed below.  It is an
error to specify both <code><span>default</span></code> and <code><span>default_factory</span></code>.</p></li>
<li><p><code><span>init</span></code>: If true (the default), this field is included as a
parameter to the generated <code><span>__init__()</span></code> method.</p></li>
<li><p><code><span>repr</span></code>: If true (the default), this field is included in the
string returned by the generated <code><span>__repr__()</span></code> method.</p></li>
<li><p><code><span>hash</span></code>: This can be a bool or <code><span>None</span></code>.  If true, this field is
included in the generated <code><span>__hash__()</span></code> method.  If <code><span>None</span></code> (the
default), use the value of <code><span>compare</span></code>: this would normally be
the expected behavior.  A field should be considered in the hash
if it’s used for comparisons.  Setting this value to anything
other than <code><span>None</span></code> is discouraged.</p>
<p>One possible reason to set <code><span>hash=False</span></code> but <code><span>compare=True</span></code>
would be if a field is expensive to compute a hash value for,
that field is needed for equality testing, and there are other
fields that contribute to the type’s hash value.  Even if a field
is excluded from the hash, it will still be used for comparisons.</p>
</li>
<li><p><code><span>compare</span></code>: If true (the default), this field is included in the
generated equality and comparison methods (<code><span>__eq__()</span></code>,
<code><span>__gt__()</span></code>, et al.).</p></li>
<li><p><code><span>metadata</span></code>: This can be a mapping or None. None is treated as
an empty dict.  This value is wrapped in
<a href="https://docs.python.org/3/library/types.html#types.MappingProxyType" title="types.MappingProxyType"><code><span>MappingProxyType()</span></code></a> to make it read-only, and exposed
on the <a href="#dataclasses.Field" title="dataclasses.Field"><code><span>Field</span></code></a> object. It is not used at all by Data
Classes, and is provided as a third-party extension mechanism.
Multiple third-parties can each have their own key, to use as a
namespace in the metadata.</p></li>
<li><p><code><span>kw_only</span></code>: If true, this field will be marked as keyword-only.
This is used when the generated <code><span>__init__()</span></code> method’s
parameters are computed.</p></li>
</ul>
<blockquote>
</blockquote>
<p>If the default value of a field is specified by a call to
<a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a>, then the class attribute for this field will be
replaced by the specified <code><span>default</span></code> value.  If no <code><span>default</span></code> is
provided, then the class attribute will be deleted.  The intent is
that after the <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator runs, the class
attributes will all contain the default values for the fields, just
as if the default value itself were specified.  For example,
after:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>x</span><span>:</span> <span>int</span>
    <span>y</span><span>:</span> <span>int</span> <span>=</span> <span>field</span><span>(</span><span>repr</span><span>=</span><span>False</span><span>)</span>
    <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>field</span><span>(</span><span>repr</span><span>=</span><span>False</span><span>,</span> <span>default</span><span>=</span><span>10</span><span>)</span>
    <span>t</span><span>:</span> <span>int</span> <span>=</span> <span>20</span>
</pre></div>
</div>
<p>The class attribute <code><span>C.z</span></code> will be <code><span>10</span></code>, the class attribute
<code><span>C.t</span></code> will be <code><span>20</span></code>, and the class attributes <code><span>C.x</span></code> and
<code><span>C.y</span></code> will not be set.</p>
</dd></dl>

<dl>
<dt id="dataclasses.Field">
<em>class </em><code>dataclasses.</code><code>Field</code><a href="#dataclasses.Field" title="Permalink to this definition">¶</a></dt>
<dd><p><a href="#dataclasses.Field" title="dataclasses.Field"><code><span>Field</span></code></a> objects describe each defined field. These objects
are created internally, and are returned by the <a href="#dataclasses.fields" title="dataclasses.fields"><code><span>fields()</span></code></a>
module-level method (see below).  Users should never instantiate a
<a href="#dataclasses.Field" title="dataclasses.Field"><code><span>Field</span></code></a> object directly.  Its documented attributes are:</p>
<blockquote>
<div><ul>
<li><p><code><span>name</span></code>: The name of the field.</p></li>
<li><p><code><span>type</span></code>: The type of the field.</p></li>
<li><p><code><span>default</span></code>, <code><span>default_factory</span></code>, <code><span>init</span></code>, <code><span>repr</span></code>, <code><span>hash</span></code>,
<code><span>compare</span></code>, <code><span>metadata</span></code>, and <code><span>kw_only</span></code> have the identical
meaning and values as they do in the <a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a> function.</p></li>
</ul>
</div></blockquote>
<p>Other attributes may exist, but they are private and must not be
inspected or relied on.</p>
</dd></dl>

<dl>
<dt id="dataclasses.fields">
<code>dataclasses.</code><code>fields</code><span>(</span><em><span>class_or_instance</span></em><span>)</span><a href="#dataclasses.fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of <a href="#dataclasses.Field" title="dataclasses.Field"><code><span>Field</span></code></a> objects that define the fields for this
dataclass.  Accepts either a dataclass, or an instance of a dataclass.
Raises <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> if not passed a dataclass or instance of one.
Does not return pseudo-fields which are <code><span>ClassVar</span></code> or <code><span>InitVar</span></code>.</p>
</dd></dl>

<dl>
<dt id="dataclasses.asdict">
<code>dataclasses.</code><code>asdict</code><span>(</span><em><span>instance</span></em>, <em><span>*</span></em>, <em><span>dict_factory</span><span>=</span><span>dict</span></em><span>)</span><a href="#dataclasses.asdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the dataclass <code><span>instance</span></code> to a dict (by using the
factory function <code><span>dict_factory</span></code>).  Each dataclass is converted
to a dict of its fields, as <code><span>name:</span> <span>value</span></code> pairs.  dataclasses, dicts,
lists, and tuples are recursed into.  Other objects are copied with
<a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy"><code><span>copy.deepcopy()</span></code></a>.</p>
<p>Example of using <a href="#dataclasses.asdict" title="dataclasses.asdict"><code><span>asdict()</span></code></a> on nested dataclasses:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>Point</span><span>:</span>
     <span>x</span><span>:</span> <span>int</span>
     <span>y</span><span>:</span> <span>int</span>

<span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
     <span>mylist</span><span>:</span> <span>list</span><span>[</span><span>Point</span><span>]</span>

<span>p</span> <span>=</span> <span>Point</span><span>(</span><span>10</span><span>,</span> <span>20</span><span>)</span>
<span>assert</span> <span>asdict</span><span>(</span><span>p</span><span>)</span> <span>==</span> <span>{</span><span>&#39;x&#39;</span><span>:</span> <span>10</span><span>,</span> <span>&#39;y&#39;</span><span>:</span> <span>20</span><span>}</span>

<span>c</span> <span>=</span> <span>C</span><span>([</span><span>Point</span><span>(</span><span>0</span><span>,</span> <span>0</span><span>),</span> <span>Point</span><span>(</span><span>10</span><span>,</span> <span>4</span><span>)])</span>
<span>assert</span> <span>asdict</span><span>(</span><span>c</span><span>)</span> <span>==</span> <span>{</span><span>&#39;mylist&#39;</span><span>:</span> <span>[{</span><span>&#39;x&#39;</span><span>:</span> <span>0</span><span>,</span> <span>&#39;y&#39;</span><span>:</span> <span>0</span><span>},</span> <span>{</span><span>&#39;x&#39;</span><span>:</span> <span>10</span><span>,</span> <span>&#39;y&#39;</span><span>:</span> <span>4</span><span>}]}</span>
</pre></div>
</div>
<p>To create a shallow copy, the following workaround may be used:</p>
<div><div><pre><span></span><span>dict</span><span>((</span><span>field</span><span>.</span><span>name</span><span>,</span> <span>getattr</span><span>(</span><span>instance</span><span>,</span> <span>field</span><span>.</span><span>name</span><span>))</span> <span>for</span> <span>field</span> <span>in</span> <span>fields</span><span>(</span><span>instance</span><span>))</span>
</pre></div>
</div>
<p><a href="#dataclasses.asdict" title="dataclasses.asdict"><code><span>asdict()</span></code></a> raises <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> if <code><span>instance</span></code> is not a dataclass
instance.</p>
</dd></dl>

<dl>
<dt id="dataclasses.astuple">
<code>dataclasses.</code><code>astuple</code><span>(</span><em><span>instance</span></em>, <em><span>*</span></em>, <em><span>tuple_factory</span><span>=</span><span>tuple</span></em><span>)</span><a href="#dataclasses.astuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the dataclass <code><span>instance</span></code> to a tuple (by using the
factory function <code><span>tuple_factory</span></code>).  Each dataclass is converted
to a tuple of its field values.  dataclasses, dicts, lists, and
tuples are recursed into. Other objects are copied with
<a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy"><code><span>copy.deepcopy()</span></code></a>.</p>
<p>Continuing from the previous example:</p>
<div><div><pre><span></span><span>assert</span> <span>astuple</span><span>(</span><span>p</span><span>)</span> <span>==</span> <span>(</span><span>10</span><span>,</span> <span>20</span><span>)</span>
<span>assert</span> <span>astuple</span><span>(</span><span>c</span><span>)</span> <span>==</span> <span>([(</span><span>0</span><span>,</span> <span>0</span><span>),</span> <span>(</span><span>10</span><span>,</span> <span>4</span><span>)],)</span>
</pre></div>
</div>
<p>To create a shallow copy, the following workaround may be used:</p>
<div><div><pre><span></span><span>tuple</span><span>(</span><span>getattr</span><span>(</span><span>instance</span><span>,</span> <span>field</span><span>.</span><span>name</span><span>)</span> <span>for</span> <span>field</span> <span>in</span> <span>dataclasses</span><span>.</span><span>fields</span><span>(</span><span>instance</span><span>))</span>
</pre></div>
</div>
<p><a href="#dataclasses.astuple" title="dataclasses.astuple"><code><span>astuple()</span></code></a> raises <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> if <code><span>instance</span></code> is not a dataclass
instance.</p>
</dd></dl>

<dl>
<dt id="dataclasses.make_dataclass">
<code>dataclasses.</code><code>make_dataclass</code><span>(</span><em><span>cls_name</span></em>, <em><span>fields</span></em>, <em><span>*</span></em>, <em><span>bases</span><span>=</span><span>()</span></em>, <em><span>namespace</span><span>=</span><span>None</span></em>, <em><span>init</span><span>=</span><span>True</span></em>, <em><span>repr</span><span>=</span><span>True</span></em>, <em><span>eq</span><span>=</span><span>True</span></em>, <em><span>order</span><span>=</span><span>False</span></em>, <em><span>unsafe_hash</span><span>=</span><span>False</span></em>, <em><span>frozen</span><span>=</span><span>False</span></em>, <em><span>match_args</span><span>=</span><span>True</span></em>, <em><span>kw_only</span><span>=</span><span>False</span></em>, <em><span>slots</span><span>=</span><span>False</span></em><span>)</span><a href="#dataclasses.make_dataclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new dataclass with name <code><span>cls_name</span></code>, fields as defined
in <code><span>fields</span></code>, base classes as given in <code><span>bases</span></code>, and initialized
with a namespace as given in <code><span>namespace</span></code>.  <code><span>fields</span></code> is an
iterable whose elements are each either <code><span>name</span></code>, <code><span>(name,</span> <span>type)</span></code>,
or <code><span>(name,</span> <span>type,</span> <span>Field)</span></code>.  If just <code><span>name</span></code> is supplied,
<code><span>typing.Any</span></code> is used for <code><span>type</span></code>.  The values of <code><span>init</span></code>,
<code><span>repr</span></code>, <code><span>eq</span></code>, <code><span>order</span></code>, <code><span>unsafe_hash</span></code>, <code><span>frozen</span></code>,
<code><span>match_args</span></code>, <code><span>kw_only</span></code>, and  <code><span>slots</span></code> have the same meaning as
they do in <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a>.</p>
<p>This function is not strictly required, because any Python
mechanism for creating a new class with <code><span>__annotations__</span></code> can
then apply the <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> function to convert that class to
a dataclass.  This function is provided as a convenience.  For
example:</p>
<div><div><pre><span></span><span>C</span> <span>=</span> <span>make_dataclass</span><span>(</span><span>&#39;C&#39;</span><span>,</span>
                   <span>[(</span><span>&#39;x&#39;</span><span>,</span> <span>int</span><span>),</span>
                     <span>&#39;y&#39;</span><span>,</span>
                    <span>(</span><span>&#39;z&#39;</span><span>,</span> <span>int</span><span>,</span> <span>field</span><span>(</span><span>default</span><span>=</span><span>5</span><span>))],</span>
                   <span>namespace</span><span>=</span><span>{</span><span>&#39;add_one&#39;</span><span>:</span> <span>lambda</span> <span>self</span><span>:</span> <span>self</span><span>.</span><span>x</span> <span>+</span> <span>1</span><span>})</span>
</pre></div>
</div>
<p>Is equivalent to:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>x</span><span>:</span> <span>int</span>
    <span>y</span><span>:</span> <span>&#39;typing.Any&#39;</span>
    <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>5</span>

    <span>def</span> <span>add_one</span><span>(</span><span>self</span><span>):</span>
        <span>return</span> <span>self</span><span>.</span><span>x</span> <span>+</span> <span>1</span>
</pre></div>
</div>
</dd></dl>

<dl>
<dt id="dataclasses.replace">
<code>dataclasses.</code><code>replace</code><span>(</span><em>instance</em>, <em>/</em>, <em>**changes</em><span>)</span><a href="#dataclasses.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new object of the same type as <code><span>instance</span></code>, replacing
fields with values from <code><span>changes</span></code>.  If <code><span>instance</span></code> is not a Data
Class, raises <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a>.  If values in <code><span>changes</span></code> do not
specify fields, raises <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a>.</p>
<p>The newly returned object is created by calling the <code><span>__init__()</span></code>
method of the dataclass.  This ensures that
<code><span>__post_init__()</span></code>, if present, is also called.</p>
<p>Init-only variables without default values, if any exist, must be
specified on the call to <a href="#dataclasses.replace" title="dataclasses.replace"><code><span>replace()</span></code></a> so that they can be passed to
<code><span>__init__()</span></code> and <code><span>__post_init__()</span></code>.</p>
<p>It is an error for <code><span>changes</span></code> to contain any fields that are
defined as having <code><span>init=False</span></code>.  A <a href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><code><span>ValueError</span></code></a> will be raised
in this case.</p>
<p>Be forewarned about how <code><span>init=False</span></code> fields work during a call to
<a href="#dataclasses.replace" title="dataclasses.replace"><code><span>replace()</span></code></a>.  They are not copied from the source object, but
rather are initialized in <code><span>__post_init__()</span></code>, if they’re
initialized at all.  It is expected that <code><span>init=False</span></code> fields will
be rarely and judiciously used.  If they are used, it might be wise
to have alternate class constructors, or perhaps a custom
<code><span>replace()</span></code> (or similarly named) method which handles instance
copying.</p>
</dd></dl>

<dl>
<dt id="dataclasses.is_dataclass">
<code>dataclasses.</code><code>is_dataclass</code><span>(</span><em><span>class_or_instance</span></em><span>)</span><a href="#dataclasses.is_dataclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code><span>True</span></code> if its parameter is a dataclass or an instance of one,
otherwise return <code><span>False</span></code>.</p>
<p>If you need to know if a class is an instance of a dataclass (and
not a dataclass itself), then add a further check for <code><span>not</span>
<span>isinstance(obj,</span> <span>type)</span></code>:</p>
<div><div><pre><span></span><span>def</span> <span>is_dataclass_instance</span><span>(</span><span>obj</span><span>):</span>
    <span>return</span> <span>is_dataclass</span><span>(</span><span>obj</span><span>)</span> <span>and</span> <span>not</span> <span>isinstance</span><span>(</span><span>obj</span><span>,</span> <span>type</span><span>)</span>
</pre></div>
</div>
</dd></dl>

<dl>
<dt id="dataclasses.MISSING">
<code>dataclasses.</code><code>MISSING</code><a href="#dataclasses.MISSING" title="Permalink to this definition">¶</a></dt>
<dd><p>A sentinel value signifying a missing default or default_factory.</p>
</dd></dl>

<dl>
<dt id="dataclasses.KW_ONLY">
<code>dataclasses.</code><code>KW_ONLY</code><a href="#dataclasses.KW_ONLY" title="Permalink to this definition">¶</a></dt>
<dd><p>A sentinel value used as a type annotation.  Any fields after a
pseudo-field with the type of <a href="#dataclasses.KW_ONLY" title="dataclasses.KW_ONLY"><code><span>KW_ONLY</span></code></a> are marked as
keyword-only fields.  Note that a pseudo-field of type
<a href="#dataclasses.KW_ONLY" title="dataclasses.KW_ONLY"><code><span>KW_ONLY</span></code></a> is otherwise completely ignored.  This includes the
name of such a field.  By convention, a name of <code><span>_</span></code> is used for a
<a href="#dataclasses.KW_ONLY" title="dataclasses.KW_ONLY"><code><span>KW_ONLY</span></code></a> field.  Keyword-only fields signify
<code><span>__init__()</span></code> parameters that must be specified as keywords when
the class is instantiated.</p>
<p>In this example, the fields <code><span>y</span></code> and <code><span>z</span></code> will be marked as keyword-only fields:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>Point</span><span>:</span>
  <span>x</span><span>:</span> <span>float</span>
  <span>_</span><span>:</span> <span>KW_ONLY</span>
  <span>y</span><span>:</span> <span>float</span>
  <span>z</span><span>:</span> <span>float</span>

<span>p</span> <span>=</span> <span>Point</span><span>(</span><span>0</span><span>,</span> <span>y</span><span>=</span><span>1.5</span><span>,</span> <span>z</span><span>=</span><span>2.0</span><span>)</span>
</pre></div>
</div>
<p>In a single dataclass, it is an error to specify more than one
field whose type is <a href="#dataclasses.KW_ONLY" title="dataclasses.KW_ONLY"><code><span>KW_ONLY</span></code></a>.</p>
</dd></dl>

<dl>
<dt id="dataclasses.FrozenInstanceError">
<em>exception </em><code>dataclasses.</code><code>FrozenInstanceError</code><a href="#dataclasses.FrozenInstanceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when an implicitly defined <code><span>__setattr__()</span></code> or
<code><span>__delattr__()</span></code> is called on a dataclass which was defined with
<code><span>frozen=True</span></code>. It is a subclass of <a href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="AttributeError"><code><span>AttributeError</span></code></a>.</p>
</dd></dl>

</div>
<div id="post-init-processing">
<h2>Post-init processing<a href="#post-init-processing" title="Permalink to this headline">¶</a></h2>
<p>The generated <code><span>__init__()</span></code> code will call a method named
<code><span>__post_init__()</span></code>, if <code><span>__post_init__()</span></code> is defined on the
class.  It will normally be called as <code><span>self.__post_init__()</span></code>.
However, if any <code><span>InitVar</span></code> fields are defined, they will also be
passed to <code><span>__post_init__()</span></code> in the order they were defined in the
class.  If no <code><span>__init__()</span></code> method is generated, then
<code><span>__post_init__()</span></code> will not automatically be called.</p>
<p>Among other uses, this allows for initializing field values that
depend on one or more other fields.  For example:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>a</span><span>:</span> <span>float</span>
    <span>b</span><span>:</span> <span>float</span>
    <span>c</span><span>:</span> <span>float</span> <span>=</span> <span>field</span><span>(</span><span>init</span><span>=</span><span>False</span><span>)</span>

    <span>def</span> <span>__post_init__</span><span>(</span><span>self</span><span>):</span>
        <span>self</span><span>.</span><span>c</span> <span>=</span> <span>self</span><span>.</span><span>a</span> <span>+</span> <span>self</span><span>.</span><span>b</span>
</pre></div>
</div>
<p>The <code><span>__init__()</span></code> method generated by <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> does not call base
class <code><span>__init__()</span></code> methods. If the base class has an <code><span>__init__()</span></code> method
that has to be called, it is common to call this method in a
<code><span>__post_init__()</span></code> method:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>Rectangle</span><span>:</span>
    <span>height</span><span>:</span> <span>float</span>
    <span>width</span><span>:</span> <span>float</span>

<span>@dataclass</span>
<span>class</span> <span>Square</span><span>(</span><span>Rectangle</span><span>):</span>
    <span>side</span><span>:</span> <span>float</span>

    <span>def</span> <span>__post_init__</span><span>(</span><span>self</span><span>):</span>
        <span>super</span><span>()</span><span>.</span><span>__init__</span><span>(</span><span>self</span><span>.</span><span>side</span><span>,</span> <span>self</span><span>.</span><span>side</span><span>)</span>
</pre></div>
</div>
<p>Note, however, that in general the dataclass-generated <code><span>__init__()</span></code> methods
don’t need to be called, since the derived dataclass will take care of
initializing all fields of any base class that is a dataclass itself.</p>
<p>See the section below on init-only variables for ways to pass
parameters to <code><span>__post_init__()</span></code>.  Also see the warning about how
<a href="#dataclasses.replace" title="dataclasses.replace"><code><span>replace()</span></code></a> handles <code><span>init=False</span></code> fields.</p>
</div>
<div id="class-variables">
<h2>Class variables<a href="#class-variables" title="Permalink to this headline">¶</a></h2>
<p>One of two places where <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> actually inspects the type
of a field is to determine if a field is a class variable as defined
in <span id="index-2"></span><a href="https://www.python.org/dev/peps/pep-0526"><strong>PEP 526</strong></a>.  It does this by checking if the type of the field is
<code><span>typing.ClassVar</span></code>.  If a field is a <code><span>ClassVar</span></code>, it is excluded
from consideration as a field and is ignored by the dataclass
mechanisms.  Such <code><span>ClassVar</span></code> pseudo-fields are not returned by the
module-level <a href="#dataclasses.fields" title="dataclasses.fields"><code><span>fields()</span></code></a> function.</p>
</div>
<div id="init-only-variables">
<h2>Init-only variables<a href="#init-only-variables" title="Permalink to this headline">¶</a></h2>
<p>The other place where <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> inspects a type annotation is to
determine if a field is an init-only variable.  It does this by seeing
if the type of a field is of type <code><span>dataclasses.InitVar</span></code>.  If a field
is an <code><span>InitVar</span></code>, it is considered a pseudo-field called an init-only
field.  As it is not a true field, it is not returned by the
module-level <a href="#dataclasses.fields" title="dataclasses.fields"><code><span>fields()</span></code></a> function.  Init-only fields are added as
parameters to the generated <code><span>__init__()</span></code> method, and are passed to
the optional <code><span>__post_init__()</span></code> method.  They are not otherwise used
by dataclasses.</p>
<p>For example, suppose a field will be initialized from a database, if a
value is not provided when creating the class:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>C</span><span>:</span>
    <span>i</span><span>:</span> <span>int</span>
    <span>j</span><span>:</span> <span>int</span> <span>=</span> <span>None</span>
    <span>database</span><span>:</span> <span>InitVar</span><span>[</span><span>DatabaseType</span><span>]</span> <span>=</span> <span>None</span>

    <span>def</span> <span>__post_init__</span><span>(</span><span>self</span><span>,</span> <span>database</span><span>):</span>
        <span>if</span> <span>self</span><span>.</span><span>j</span> <span>is</span> <span>None</span> <span>and</span> <span>database</span> <span>is</span> <span>not</span> <span>None</span><span>:</span>
            <span>self</span><span>.</span><span>j</span> <span>=</span> <span>database</span><span>.</span><span>lookup</span><span>(</span><span>&#39;j&#39;</span><span>)</span>

<span>c</span> <span>=</span> <span>C</span><span>(</span><span>10</span><span>,</span> <span>database</span><span>=</span><span>my_database</span><span>)</span>
</pre></div>
</div>
<p>In this case, <a href="#dataclasses.fields" title="dataclasses.fields"><code><span>fields()</span></code></a> will return <a href="#dataclasses.Field" title="dataclasses.Field"><code><span>Field</span></code></a> objects for <code><span>i</span></code> and
<code><span>j</span></code>, but not for <code><span>database</span></code>.</p>
</div>
<div id="frozen-instances">
<h2>Frozen instances<a href="#frozen-instances" title="Permalink to this headline">¶</a></h2>
<p>It is not possible to create truly immutable Python objects.  However,
by passing <code><span>frozen=True</span></code> to the <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator you can
emulate immutability.  In that case, dataclasses will add
<code><span>__setattr__()</span></code> and <code><span>__delattr__()</span></code> methods to the class.  These
methods will raise a <a href="#dataclasses.FrozenInstanceError" title="dataclasses.FrozenInstanceError"><code><span>FrozenInstanceError</span></code></a> when invoked.</p>
<p>There is a tiny performance penalty when using <code><span>frozen=True</span></code>:
<code><span>__init__()</span></code> cannot use simple assignment to initialize fields, and
must use <a href="https://docs.python.org/3/reference/datamodel.html#object.__setattr__" title="object.__setattr__"><code><span>object.__setattr__()</span></code></a>.</p>
</div>
<div id="inheritance">
<h2>Inheritance<a href="#inheritance" title="Permalink to this headline">¶</a></h2>
<p>When the dataclass is being created by the <a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator,
it looks through all of the class’s base classes in reverse MRO (that
is, starting at <a href="https://docs.python.org/3/library/functions.html#object" title="object"><code><span>object</span></code></a>) and, for each dataclass that it finds,
adds the fields from that base class to an ordered mapping of fields.
After all of the base class fields are added, it adds its own fields
to the ordered mapping.  All of the generated methods will use this
combined, calculated ordered mapping of fields.  Because the fields
are in insertion order, derived classes override base classes.  An
example:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>Base</span><span>:</span>
    <span>x</span><span>:</span> <span>Any</span> <span>=</span> <span>15.0</span>
    <span>y</span><span>:</span> <span>int</span> <span>=</span> <span>0</span>

<span>@dataclass</span>
<span>class</span> <span>C</span><span>(</span><span>Base</span><span>):</span>
    <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>10</span>
    <span>x</span><span>:</span> <span>int</span> <span>=</span> <span>15</span>
</pre></div>
</div>
<p>The final list of fields is, in order, <code><span>x</span></code>, <code><span>y</span></code>, <code><span>z</span></code>.  The final
type of <code><span>x</span></code> is <code><span>int</span></code>, as specified in class <code><span>C</span></code>.</p>
<p>The generated <code><span>__init__()</span></code> method for <code><span>C</span></code> will look like:</p>
<div><div><pre><span></span><span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>x</span><span>:</span> <span>int</span> <span>=</span> <span>15</span><span>,</span> <span>y</span><span>:</span> <span>int</span> <span>=</span> <span>0</span><span>,</span> <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>10</span><span>):</span>
</pre></div>
</div>
</div>
<div id="re-ordering-of-keyword-only-parameters-in-init">
<h2>Re-ordering of keyword-only parameters in <code><span>__init__()</span></code><a href="#re-ordering-of-keyword-only-parameters-in-init" title="Permalink to this headline">¶</a></h2>
<p>After the parameters needed for <code><span>__init__()</span></code> are computed, any
keyword-only parameters are moved to come after all regular
(non-keyword-only) parameters.  This is a requirement of how
keyword-only parameters are implemented in Python: they must come
after non-keyword-only parameters.</p>
<p>In this example, <code><span>Base.y</span></code>, <code><span>Base.w</span></code>, and <code><span>D.t</span></code> are keyword-only
fields, and <code><span>Base.x</span></code> and <code><span>D.z</span></code> are regular fields:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>Base</span><span>:</span>
    <span>x</span><span>:</span> <span>Any</span> <span>=</span> <span>15.0</span>
    <span>_</span><span>:</span> <span>KW_ONLY</span>
    <span>y</span><span>:</span> <span>int</span> <span>=</span> <span>0</span>
    <span>w</span><span>:</span> <span>int</span> <span>=</span> <span>1</span>

<span>@dataclass</span>
<span>class</span> <span>D</span><span>(</span><span>Base</span><span>):</span>
    <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>10</span>
    <span>t</span><span>:</span> <span>int</span> <span>=</span> <span>field</span><span>(</span><span>kw_only</span><span>=</span><span>True</span><span>,</span> <span>default</span><span>=</span><span>0</span><span>)</span>
</pre></div>
</div>
<p>The generated <code><span>__init__()</span></code> method for <code><span>D</span></code> will look like:</p>
<div><div><pre><span></span><span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>x</span><span>:</span> <span>Any</span> <span>=</span> <span>15.0</span><span>,</span> <span>z</span><span>:</span> <span>int</span> <span>=</span> <span>10</span><span>,</span> <span>*</span><span>,</span> <span>y</span><span>:</span> <span>int</span> <span>=</span> <span>0</span><span>,</span> <span>w</span><span>:</span> <span>int</span> <span>=</span> <span>1</span><span>,</span> <span>t</span><span>:</span> <span>int</span> <span>=</span> <span>0</span><span>):</span>
</pre></div>
</div>
<p>Note that the parameters have been re-ordered from how they appear in
the list of fields: parameters derived from regular fields are
followed by parameters derived from keyword-only fields.</p>
<p>The relative ordering of keyword-only parameters is maintained in the
re-ordered <code><span>__init__()</span></code> parameter list.</p>
</div>
<div id="default-factory-functions">
<h2>Default factory functions<a href="#default-factory-functions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>If a <a href="#dataclasses.field" title="dataclasses.field"><code><span>field()</span></code></a> specifies a <code><span>default_factory</span></code>, it is called with
zero arguments when a default value for the field is needed.  For
example, to create a new instance of a list, use:</p>
<div><div><pre><span></span><span>mylist</span><span>:</span> <span>list</span> <span>=</span> <span>field</span><span>(</span><span>default_factory</span><span>=</span><span>list</span><span>)</span>
</pre></div>
</div>
<p>If a field is excluded from <code><span>__init__()</span></code> (using <code><span>init=False</span></code>)
and the field also specifies <code><span>default_factory</span></code>, then the default
factory function will always be called from the generated
<code><span>__init__()</span></code> function.  This happens because there is no other
way to give the field an initial value.</p>
</div></blockquote>
</div>
<div id="mutable-default-values">
<h2>Mutable default values<a href="#mutable-default-values" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Python stores default member variable values in class attributes.
Consider this example, not using dataclasses:</p>
<div><div><pre><span></span><span>class</span> <span>C</span><span>:</span>
    <span>x</span> <span>=</span> <span>[]</span>
    <span>def</span> <span>add</span><span>(</span><span>self</span><span>,</span> <span>element</span><span>):</span>
        <span>self</span><span>.</span><span>x</span><span>.</span><span>append</span><span>(</span><span>element</span><span>)</span>

<span>o1</span> <span>=</span> <span>C</span><span>()</span>
<span>o2</span> <span>=</span> <span>C</span><span>()</span>
<span>o1</span><span>.</span><span>add</span><span>(</span><span>1</span><span>)</span>
<span>o2</span><span>.</span><span>add</span><span>(</span><span>2</span><span>)</span>
<span>assert</span> <span>o1</span><span>.</span><span>x</span> <span>==</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>]</span>
<span>assert</span> <span>o1</span><span>.</span><span>x</span> <span>is</span> <span>o2</span><span>.</span><span>x</span>
</pre></div>
</div>
<p>Note that the two instances of class <code><span>C</span></code> share the same class
variable <code><span>x</span></code>, as expected.</p>
<p>Using dataclasses, <em>if</em> this code was valid:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>D</span><span>:</span>
    <span>x</span><span>:</span> <span>List</span> <span>=</span> <span>[]</span>
    <span>def</span> <span>add</span><span>(</span><span>self</span><span>,</span> <span>element</span><span>):</span>
        <span>self</span><span>.</span><span>x</span> <span>+=</span> <span>element</span>
</pre></div>
</div>
<p>it would generate code similar to:</p>
<div><div><pre><span></span><span>class</span> <span>D</span><span>:</span>
    <span>x</span> <span>=</span> <span>[]</span>
    <span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>x</span><span>=</span><span>x</span><span>):</span>
        <span>self</span><span>.</span><span>x</span> <span>=</span> <span>x</span>
    <span>def</span> <span>add</span><span>(</span><span>self</span><span>,</span> <span>element</span><span>):</span>
        <span>self</span><span>.</span><span>x</span> <span>+=</span> <span>element</span>

<span>assert</span> <span>D</span><span>()</span><span>.</span><span>x</span> <span>is</span> <span>D</span><span>()</span><span>.</span><span>x</span>
</pre></div>
</div>
<p>This has the same issue as the original example using class <code><span>C</span></code>.
That is, two instances of class <code><span>D</span></code> that do not specify a value
for <code><span>x</span></code> when creating a class instance will share the same copy
of <code><span>x</span></code>.  Because dataclasses just use normal Python class
creation they also share this behavior.  There is no general way
for Data Classes to detect this condition.  Instead, the
<a href="#dataclasses.dataclass" title="dataclasses.dataclass"><code><span>dataclass()</span></code></a> decorator will raise a <a href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><code><span>TypeError</span></code></a> if it
detects a default parameter of type <code><span>list</span></code>, <code><span>dict</span></code>, or <code><span>set</span></code>.
This is a partial solution, but it does protect against many common
errors.</p>
<p>Using default factory functions is a way to create new instances of
mutable types as default values for fields:</p>
<div><div><pre><span></span><span>@dataclass</span>
<span>class</span> <span>D</span><span>:</span>
    <span>x</span><span>:</span> <span>list</span> <span>=</span> <span>field</span><span>(</span><span>default_factory</span><span>=</span><span>list</span><span>)</span>

<span>assert</span> <span>D</span><span>()</span><span>.</span><span>x</span> <span>is</span> <span>not</span> <span>D</span><span>()</span><span>.</span><span>x</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


            
          </div>
        </div>
      </div>
      
      
    </div></div>
  </body>
</html>
