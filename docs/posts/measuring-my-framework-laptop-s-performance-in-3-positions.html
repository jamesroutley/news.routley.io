<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ntietz.com/blog/measuring-my-framework-laptops-performance-in-3-positions/?utm_source=atom&amp;utm_medium=feed">Original</a>
    <h1>Measuring my Framework laptop&#39;s performance in 3 positions</h1>
    
    <div id="readability-page-1" class="page"><div><p>A few months ago, I was talking with a friend about <a href="https://ntietz.com/blog/evolving-ergo-setup/">my ergonomic setup</a> and they asked if being vertical helps it with cooling.
I wasn&#39;t sure, because it seems like it could help but it was probably such a small difference that it wouldn&#39;t matter.
So, I did what any self-respecting nerd would do: I procrastinated.</p>
<p>The question didn&#39;t leave me, though, so after those months passed, I did the <em>second</em> thing any self-respecting nerd would do: benchmarks.</p>

<p>What we want to find out is whether or not the position of the laptop would affect its CPU performance.
I wanted to measure it in three positions:</p>

<p>My hypothesis was that using it closed would slightly reduce CPU performance, and that using it normal or vertical would be roughly the same.</p>
<p>For this experiment, I&#39;m using my personal laptop.
It&#39;s one of the early Framework laptops (2nd batch of shipments) which is about four years old.
It has an 11th gen Intel CPU in it, the i7-1165G7.</p>
<p>My laptop will be sitting on a laptop riser for the closed and normal positions, and it will be sitting in my ergonomic tray for the vertical one.
For all three, it will be connected to the same set of peripherals through a single USB-C cable, and the internal display is disabled for all three.</p>

<p>I&#39;m not too interested in the initial boost clock.
I&#39;m more interested in what clock speeds we can sustain.
What happens under a sustained, heavy load, when we hit a saturation point and can&#39;t shed any more heat?</p>
<p>To test that, I&#39;m doing a test using heavy CPU load.
The load is generated by <a href="https://github.com/ColinIanKing/stress-ng">stress-ng</a>, which also reports some statistics.
Most notably, it reports CPU temperatures and clock speeds during the tests.</p>
<p>Here&#39;s the script I wrote to make these consistent.
To skip the boost clock period, I warm it up first with a 3-minute load
Then I do a 5-minute load and measure the CPU clock frequency and CPU temps every second along the way.</p>
<pre data-lang="bash"><code data-lang="bash"><span>#!/bin/bash
</span><span>
</span><span># load the CPU for 3 minutes to warm it up
</span><span>sudo stress-ng --matrix $2 -t 3m --tz --raplstat 1 --thermalstat 1 -Y warmup-$1.yaml --log-file warmup-$1.log --timestamp --ignite-cpu
</span><span>
</span><span># run for 5 minutes to gather our averages
</span><span>sudo stress-ng --matrix $2 -t 5m --tz --raplstat 1 --thermalstat 1 -Y cputhermal-$1.yaml --log-file cputhermal-$1.log --timestamp --ignite-cpu
</span></code></pre>
<p>We need <code>sudo</code> since we&#39;re using an option (<code>--ignite-cpu</code>) which needs root privileges and attempts to make the CPU run harder/hotter.
Then we specify the stressor we&#39;re using with <code>--matrix $2</code>, which does some matrix calculations over a number of cores we specify.
The remaining options are about reporting and logging.</p>
<p>I let the computer cool for a minute or two between each test, but not for a scientific reason.
Just because I was doing other things.
Since my goal was to saturate the temperatures, and they got stable within each warmup period, cooldowh time wasn&#39;t necessary—we&#39;d warm it back up anyway.</p>
<p>So, I ran this with the three positions, and with two core count options: 8, one per thread on my CPU; and 4, one per physical core on my CPU.</p>

<p>Once it was done, I analyzed the results.
I took the average clock speed across the 5 minute test for each of the configurations.
My hypothesis was partially right and partially wrong.</p>
<p>When doing 8 threads, each position had different results:</p>
<ul>
<li>Our baseline normal open position had an average clock speed of 3.44 GHz and an average CPU temp of 91.75 F.</li>
<li>With the laptop closed, the average clock speed was 3.37 GHz and the average CPU temp was 91.75 F.</li>
<li>With the laptop open vertical, the average clock speed was 3.48 GHz and the average CPU temp was 88.75 F.</li>
</ul>
<p>With 4 threads, the results were:</p>
<ul>
<li>For the baseline normal open position, the average clock speed was 3.80 GHz with average CPU temps of 91.11 F.</li>
<li>With the laptop closed, the average clock speed  was 3.64 GHz with average CPU temps of 90.70 F.</li>
<li>With the laptop open vertical, the average clock speed was 3.80 GHz with average CPU temps of 86.07 F.</li>
</ul>
<p>So, I was wrong in one big aspect: it <em>does</em> make a clearly measurable difference.
Having it open and vertical reduces temps by 3 degrees in one test and 5 in the other, and it had a higher clock speed (by 0.05 GHz, which isn&#39;t a lot but isn&#39;t nothing).
We can infer that, since clock speeds improved in the heavier load test but not in the lighter load test, that the lighter load isn&#39;t hitting our thermal limits—and when we do, the extra cooling from the vertical position really helps.
One thing is clear: in all cases, the CPU ran slower when the laptop was closed.</p>
<p>It&#39;s sorta weird that the CPU temps went <em>down</em> when closed in the second test.
I wonder if that&#39;s from being able to cool down more when it throttled down a lot, or if there was a hotspot that throttled the CPU but which wasn&#39;t reflected in the temp data, maybe a different sensor.</p>
<p>I&#39;m not sure if having my laptop vertical like I do will ever make a perceptible performance difference.
At any rate, that&#39;s not why I do it.
But it <em>does</em> have lower temps, and that should let my fans run less often and be quieter when they do.
That&#39;s a win in my book.</p>
<p>It also means that when I run CPU-intensive things (say hi to every single Rust compile!) I should not close the laptop.
And hey, if I decide to work from my armchair using my ergonomic tray, I can argue it&#39;s for efficiency: boss, I just gotta eke out those extra clock cycles.</p>
<hr/>
</div><p>
  If you&#39;re looking to grow more effective as a software engineer, please consider my <a href="https://lemonyte.com/coaching/">coaching services</a>.
  </p></div>
  </body>
</html>
