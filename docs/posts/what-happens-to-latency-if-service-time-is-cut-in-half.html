<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pveentjer.github.io/misc/2022/04/18/service-time-cut-in-half.html">Original</a>
    <h1>What happens to latency if service time is cut in half</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    

<p>The goal of this post is to determine how the latency is going to be impacted 
if the service time is going to be cut in half. I was watching a great <a href="https://youtu.be/03GsLxVdVzU">presentation</a> 
of Martin Thompson where he mentioned this <a href="https://youtu.be/03GsLxVdVzU?t=341">example</a> example and wanted 
to freshen up my queuing theory a bit and do some calculations.</p>

<h2 id="lots-of-formulas">Lots of formulas</h2>

<p>Let’s first get some formulas out of the way.</p>

<p>The mean latency as function of the utilization:</p><p>

\[R=\dfrac{1}{\mu(1-\rho)}\]

</p><ul>
  <li>\(R\) is latency (residency time)</li>
  <li>\(\mu\) is service rate</li>
  <li>\(\rho\) is utilization</li>
</ul>

<p>\(\mu\) is the reciprocal of service time \(S\).</p><p>

\[\mu=\dfrac{1}{S}\]

</p><p>And if we fill this in and simplify the formula a bit, we get the following:</p><p>

\[R=\dfrac{1}{\dfrac{1}{S}(1-\rho)}\]

\[R=\dfrac{S}{(1-\rho)}\]

</p><p>Another part we need is the calculation of the utilization:</p><p>

\[\rho = S \lambda\]

</p><ul>
  <li>\(\rho\) is the utilization</li>
  <li>\(\lambda\) is the arrival rate.</li>
  <li>\(S\) is the service time.</li>
</ul>

<p>This formula is known as the Utilization Law or Little’s Microscopic Law.</p>

<p>And this can be converted into a function that calculates the arrival rate as a function of utilization and service time:</p><p>

\[\lambda = \dfrac{S}{\rho}\]

</p><h2 id="comparing-the-latencies">Comparing the latencies</h2>

<p>In Martin’s example he has 2 services:</p>
<ul>
  <li>an unoptimized service with \(S=0.1\) seconds.</li>
  <li>an optimized service with \(S=0.05\) seconds</li>
</ul>

<p>To make it a bit more tangible let’s plot latency curves as function of utilization for both services.</p>

<p><img src="https://pveentjer.github.io/assets/utilization_plot.png" alt="utilization plot"/></p>

<ul>
  <li>green: unoptimized service</li>
  <li>blue: optimized service</li>
</ul>

<p>The x-axis is the utilization and the y-axis is the latency.</p>

<p>The first thing we can calculate is the latency with a service time of 0.10 seconds and a utilization of 0.90 because this utilization Martin picked in his example:</p>

<p>\(R=\dfrac{S}{(1-\rho)}=\dfrac{0.10}{(1.0-0.90)}=1.0\) second.</p>

<p>The next part we need to determine is the arrival rate based on the utilization and service time. So with a service time of 0.10 and a utilization of 0.90 we get the following arrival rate:</p>

<p>\(\lambda = \dfrac{S}{\rho} = \dfrac{0.1}{1-0.9} = 10\) requests/second.</p>

<p>So if the service time is going to be cut in half, and we keep the same arrival rate, the utilization is going to be cut in half:</p><p>

\[\rho = S \lambda = 0.05 \times 10 = 0.45\]

</p><p>And if fill this into the calculate the latency is function of the utilization for the optimized service, we get:</p>

<p>\(R=\dfrac{S}{(1-\rho)} = \dfrac{0.05}{1-0.45}=0.091\) seconds.</p>

<p>We can see both the calculated latencies in the plot below:</p>

<p><img src="https://pveentjer.github.io/assets/utilization_plot_dots.png" alt="utilization plot"/></p>

<p>So we went from a latency of 1 second to 0.091 seconds which is an \(\dfrac{1}{0.091}=11\) times improvement.</p>

<h2 id="discrepancy">Discrepancy</h2>

<p>Martin’s claim is that the latency improvement is 20x. But the results based on the above formulas don’t agree with that. He makes a remark that the unit of processing is half the calculated latency, but I don’t understand what he means or how this is relevant for the latency calculation.</p>

<p>I haven’t configured comments yet on this new website. So if you want to comment, send me a message on <a href="https://twitter.com/PeterVeentjer">Twitter</a>.</p>

  </div>
</article>

      </div>
    </div></div>
  </body>
</html>
