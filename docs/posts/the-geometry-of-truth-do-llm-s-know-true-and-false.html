<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://saprmarks.github.io/geometry-of-truth/dataexplorer/">Original</a>
    <h1>The Geometry of Truth: Do LLM&#39;s Know True and False</h1>
    
    <div id="readability-page-1" class="page"><div>
      
      
      

      

<p>This page contains interactive charts for exploring how large language models represent truth. It accompanies the paper <a href="https://arxiv.org/abs/2310.06824"><em>The Geometry of Truth: Emergent Linear Structure in Large Language Model Representations of True/False Datasets</em></a> by Samuel Marks and Max Tegmark.</p>

<p>To produce these visualizations, we first extract <a href="https://ai.meta.com/blog/large-language-model-llama-meta-ai/">LLaMA-13B</a> representations of factual statements. These representations live in a 5120-dimensional space, far too high-dimensional for us to picture, so we use <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> to select the two directions of greatest variation for the data. This allows us to produce 2-dimensional pictures of 5120-dimensional data. See this footnote for more details.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup></p>

<h2 id="basic-datasets">Basic datasets</h2>

<p>Let’s start off with our basic datasets, containing simple statements like “The city of Beijing is in China” (true) or “Fifty-eight is larger than sixty-one” (false). Mouse over the points below to see which statements they correspond to.</p>



<p>We’re not sure why the <code>smaller_than</code> dataset doesn’t look as separated as the rest. But things look better when you go to 3D (below, right).</p>



<p>Even with these simple plots, there’s already lots to explore! For instance, for <code>larger_than</code>, we see two axes of variation: one separating the red and blue clouds, and one running parallel to the point clouds (pointing up and to the right). Can you figure out what this second axis of variation is? See <a href="#other-tidbits">below</a> for the answer.</p>

<h2 id="negations">Negations</h2>

<p>Now let’s introduce some more complicated logical structure to our statements. We’ll start by negating statements by adding the word “not.”</p>



<p>How do the visually apparent “truth directions” of the negated statements compare to the “truth directions” of the un-negated statements? Let’s check:</p>

<p>Here we’ve done PCA on the two datsets together<sup id="fnref:1:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup>. You can toggle which datasets are shown by clicking on the plot legends.</p>

<p>What’s going on here? There are many possibilities, but our best guess is what we call the <em>Misalignment from Correlational Inconsistency</em> (MCI) hypothesis. In brief, MCI posits the existence of a confounding feature<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" rel="footnote">2</a></sup> which is <em>correlated</em> with truth on <code>cities</code> and <em>anti-correlated</em> with truth on <code>neg_cities</code>. See <a href="https://arxiv.org/abs/2310.06824">our paper</a> for much more discussion .</p>

<h2 id="conjunctions-and-disjunctions">Conjunctions and disjunctions</h2>

<p>Now let’s try some logical conjunctions and disjunctions. Mouse over the datapoints below to see what our conjunctive/disjunctive statements look like.</p>



<p>Does it look like the circled points form a bit of a separate cluster? We thought so, and indeed there’s a pattern to those statements. See if you can figure out what it is (answer <a href="#other-tidbits">below</a>).</p>

<h2 id="emergence-over-layers">Emergence over layers</h2>

<p>So far, we’ve only been looking at layer 12. But by sweeping over the layers of LLaMA-13B, we can watch as the features which distinguish true statements from false ones emerge. Interestingly, there’s a 4-layer offset between when <code>cities</code> separates and when <code>cities_cities_conj</code> (conjunctions of statements about cities) separates. This might be due to LLaMA-13B hierarchically building up concepts, with more composite concepts taking longer to emerge.</p>

<p><img src="https://saprmarks.github.io/geometry-of-truth/dataexplorer/plots/emergence.gif" width="100%" height="auto"/></p>

<p>Here’s an interactive version of the above with different datasets.</p>



<p>Interestingly, <code>cities</code> and <code>neg_cities</code> start off <em>antipodally</em> aligned before rotating to be orthogonal like in the plot above (toggle the datasets in the left plot on and off to see this).</p>



<h2 id="more-diverse-datasets">More diverse datasets</h2>

<p>All of the datasets so far were curated to contain statements which are <em>uncontroversial</em>, <em>unambiguous</em>, and <em>simple</em>. They are also not very diverse – each dataset is formed from a single template.</p>

<p>In contrast, we’ll now look at some <em>uncurated</em> datasets adapted <a href="https://arxiv.org/abs/2304.13734">from</a> <a href="https://github.com/Algorithmic-Alignment-Lab/CommonClaim/tree/main">other</a> <a href="https://rome.baulab.info/">sources</a>. Mouse over the plots below to see some of these datasets’ statements.</p>



<p>Why aren’t these datsets separating into true/false clusters? Because of the additional diversity. Recall that PCA identifies the most salient axes of variation for a dataset. In more diverse datasets, these axes are more likely to encode some truth-independent feature. For instance, the statements in <code>companies_true_false</code> are formed using three different templates, and the top 2 principal components mostly encode the difference between these templates. It’s quite shocking that <code>common_claim_true_false</code>, consisting of statements as diverse as “Rabbits can partially digest memories” (false) or “Dolphins are capable of acts of impressive intelligence” (true) has as much true/false separation as it does!</p>

<p>If we want to see separation into true/false clusters, we can borrow one of the PCA bases identified from our cleaner datasets. For instance, here are our uncurated datasets visualized in the PCA basis extracted from our <code>cities</code> dataset.</p>



<h2 id="other-tidbits">Other tidbits</h2>

<p>We’ve been mainly focusing on truth/falsehood, but there’s also more information present in the representations shown here. For instance, we asked <a href="#basic-datasets">above</a> what the non-truth axis of variation is for our <code>larger_than</code> dataset. Seemingly, for a statement like “<code>x</code> is larger than <code>y</code>,” it represents the <em>absolute value</em> of the difference <code>x - y</code>!<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" rel="footnote">3</a></sup></p>



<p>We also <a href="#conjunctions-and-disjunctions">noted</a> a separated cluster for <code>cities_cities_conj</code>, and challenged readers to figure out what distinguishes this cluster. Looking at a few examples, we see that statements involving China and India are common in this cluster. Perhaps it is the China/India cluster? A reasonable first guess, but not quite! Here are some example statements from the cluster:</p>

<ul>
  <li>It is the case both that the city of Shantou is in China and that the city of Antwerpen is in China.</li>
  <li>It is the case both that the city of Meerut is in India and that the city of Varanasi is in India.</li>
  <li>It is the case both that the city of Ha’il is in Saudi Arabia and that the city of Astrakhan is in Saudi Arabia.</li>
  <li>It is the case both that the city of Goyang-si is in Japan and that the city of Nagoya is in Japan.</li>
  <li>It is the case both that the city of Multan is in Mexico and that the city of Tlaquepaque is in Mexico.</li>
</ul>

<p>It seems to be that this cluster is for statements where the country in both halves of the conjunction are the same!<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" rel="footnote">4</a></sup></p>




      
    </div></div>
  </body>
</html>
