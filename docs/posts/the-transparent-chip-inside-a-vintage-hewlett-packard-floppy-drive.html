<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.righto.com/2023/12/HP-silicon-on-sapphire-phi-chip.html">Original</a>
    <h1>The transparent chip inside a vintage Hewlett-Packard floppy drive</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-2971165090947294481" itemprop="description articleBody">
<p>While repairing an eight-inch HP floppy drive, we found that the problem was a broken interface chip.
Since the chip was bad, I decapped it and took photos.
This chip is very unusual: instead of a silicon substrate, the chip is formed on
a base of sapphire, with silicon and metal wiring on top.
As a result, the chip is transparent as you can see from the gold &#34;X&#34; visible through the die in the photo below.</p>
<p><a href="https://static.righto.com/images/phi/transparent-die.jpg"><img alt="The PHI die as seen through an inspection microscope. Click this image (or any other) for a larger version." height="375" src="https://static.righto.com/images/phi/transparent-die-w500.jpg" title="The PHI die as seen through an inspection microscope. Click this image (or any other) for a larger version." width="500"/></a></p><p>The PHI die as seen through an inspection microscope. Click this image (or any other) for a larger version.</p>
<p>The chip is a custom HP chip from 1977 that provides an interface between HP&#39;s interface bus (HP-IB) and the
Z80 processor in the floppy drive controller.
HP designed this interface bus as a low-cost bus to connect test equipment, computers, and peripherals.
The chip, named PHI (Processor-to-HP-IB Interface), was used in multiple HP products.
It handles the bus protocol and buffered data between the
interface bus and a device&#39;s microprocessor.<span id="fnref:more"><a href="#fn:more">1</a></span>
In this article, I&#39;ll take a look inside this &#34;silicon-on-sapphire&#34; chip, examine its metal-gate CMOS
circuitry, and explain how it works.</p>
<h2>Silicon-on-sapphire</h2>
<p>Most integrated circuits are formed on a silicon wafer.
Silicon-on-sapphire, on the other hand, starts with a sapphire substrate.
A thin layer of silicon is built up on the sapphire substrate to form the circuitry.
The silicon is N-type, and is converted to P-type where needed by ion implantation.
A metal wiring layer is created on top, forming the wiring as well as the metal-gate transistors.
The diagram below shows a cross-section of the circuitry.</p>
<p><a href="https://static.righto.com/images/phi/cross-section.jpg"><img alt="Cross-section from HP Journal, April 1977." height="396" src="https://static.righto.com/images/phi/cross-section-w700.jpg" title="Cross-section from HP Journal, April 1977." width="700"/></a></p>
<p>The important thing about silicon-on-sapphire is that silicon regions are separated from each other.
Since the sapphire substrate is an insulator, transistors are completely isolated, unlike a regular
integrated circuit. This reduces the capacitance between transistors, improving performance.
The insulation also prevents stray currents, protecting against latch-up and radiation.
Because of its resistance to radiation, silicon-on-sapphire found use in space applications.</p>
<p><a href="https://static.righto.com/images/phi/illuminated.jpg"><img alt="An HP MC2 die, illuminated from behind with fiber optics. From Hewlett-Packard Journal, April 1977." height="527" src="https://static.righto.com/images/phi/illuminated-w500.jpg" title="An HP MC2 die, illuminated from behind with fiber optics. From Hewlett-Packard Journal, April 1977." width="500"/></a></p><p>An HP MC<sup>2</sup> die, illuminated from behind with fiber optics. From <a href="http://hparchive.com/Journals/HPJ-1977-04.pdf">Hewlett-Packard Journal</a>, April 1977.</p>
<p>Silicon-on-sapphire integrated circuits date back to research in 1963 at Autonetics,
an innovative but now-forgotten avionics
company that produced guidance computers for the Minuteman ICBMs, among other things.
RCA developed silicon-on-sapphire integrated circuits in the 1960s and the RCA 1802 processor was used
on the Galileo spacecraft.
HP used silicon-on-sapphire for multiple chips starting in 1977, such as the MC<sup>2</sup> Micro-CPU Chip.
HP also used SOS for the three-chip CPU in the <a href="https://www.cpushack.com/2016/11/26/hp-3000-series-33-16-bits-of-sapphire/">HP 3000 Amigo</a> (1978), but the system was a commercial failure.
The popularity of silicon-on-sapphire peaked in the early 1980s and
HP moved to <a href="https://www.hpl.hp.com/hpjournal/pdfs/IssuePDFs/1980-03.pdf#page=20">bulk silicon</a> integrated circuits for calculators such as the HP-41C.
Silicon-on-sapphire is still used in
various products, such as LEDs and RF applications, but is now mostly a niche technology.</p>
<!-- https://www.youtube.com/watch?v=p_ZoqOoW6sw&t=2s Why Silicon on Sapphire, Peregrine -->

<h2>Inside the PHI chip</h2>
<p>HP used an unusual package for the PHI chip. The chip is mounted on a ceramic substrate, protected by a ceramic cap.
The package has 48 gold fingers that
press into a socket. The chip is held into the socket by two metal spring clips.</p>
<p><a href="https://static.righto.com/images/phi/phi-package.jpg"><img alt="Package of the PHI chip, showing the underside. The package is flipped over when mounted in a socket." height="283" src="https://static.righto.com/images/phi/phi-package-w400.jpg" title="Package of the PHI chip, showing the underside. The package is flipped over when mounted in a socket." width="400"/></a></p><p>Package of the PHI chip, showing the underside. The package is flipped over when mounted in a socket.</p>
<p>Decapping the chip was straightforward, but more dramatic than I expected.
The chip&#39;s cap is attached with adhesive, which can be softened by heating.
Hot air wasn&#39;t sufficient, so we used a hot plate.
Eric tested the adhesive by poking it with an X-Acto knife, causing the cap to suddenly fly off with a loud &#34;pop&#34;
and sending the blade flying through the air.
I was happy to be wearing safety glasses.</p>
<p><a href="https://static.righto.com/images/phi/decap.jpg"><img alt="Decapping the chip with a hotplate and hot air." height="300" src="https://static.righto.com/images/phi/decap-w400.jpg" title="Decapping the chip with a hotplate and hot air." width="400"/></a></p><p>Decapping the chip with a hotplate and hot air.</p>
<p>After decapping the chip, I created the high-resolution die photo below.
The metal layer is clearly visible as white lines, while the silicon is grayish and the sapphire appears purple.
Around the edge of the die, bond wires connect the chip&#39;s 48 external connections to the die.
Slightly upper left of center, a large regular rectangular block of circuitry provides 160 bits of storage: this
is two 8-word FIFO buffers, passing 10-bit words between the interface bus and a connected microprocessor.
The thick metal traces around the edges provide +12 volts, +5 volts, and ground to the chip.</p>
<p><a href="https://static.righto.com/images/phi/die.jpg"><img alt="Die photo of the PHI chip, created by stitching together microscope photos. Click for a much larger image." height="493" src="https://static.righto.com/images/phi/die-w600.jpg" title="Die photo of the PHI chip, created by stitching together microscope photos. Click for a much larger image." width="600"/></a></p><p>Die photo of the PHI chip, created by stitching together microscope photos. Click for a much larger image.</p>
<h2>Logic gates</h2>
<p>Circuitry on this chip has an unusual appearance due to the silicon-on-sapphire implementation as well as the
use of metal-gate transistors, but fundamentally the circuits are standard CMOS.
The photo below shows a block that implements an inverter and a NAND gate.
The sapphire substrate appears as dark purple. On top of this, the thick gray lines are the silicon.
The white metal on top connects the transistors. The metal can also form the gates of transistors when it
crosses silicon (indicated by letters).
Inconveniently, metal that contacts silicon, metal that crosses over silicon, and metal that forms a transistor
all appear very similar in this chip.
This makes it more difficult to determine the wiring.</p>
<p><a href="https://static.righto.com/images/phi/gate-diagram.jpg"><img alt="This diagram shows an inverter and a NAND gate on the die." height="363" src="https://static.righto.com/images/phi/gate-diagram-w300.jpg" title="This diagram shows an inverter and a NAND gate on the die." width="300"/></a></p><p>This diagram shows an inverter and a NAND gate on the die.</p>
<p>The schematic below shows how the gates are implemented, matching the photo above.
The metal lines at the top and bottom provide the power and ground rails respectively.
The inverter is formed from NMOS transistor A and PMOS transistor B; the output goes to transistors D and F.
The NAND gate is formed by NMOS transistors E and F in conjunction with PMOS transistors C and C.
The components of the NAND gate are joined at the square of metal, and then the output leaves through
silicon on the right.
Note that signals can only cross when one signal is in the silicon layer and one is in the metal layer.
With only two wiring layers, signals in the PHI chip must often meander to avoid crossings, wasting a lot
of space.
(This wiring is much more constrained than typical chips of the 1970s that also had a polysilicon layer, providing
three wiring layers in total.)</p>
<p><a href="https://static.righto.com/images/phi/gate-schematic.png"><img alt="This schematic shows how the inverter and a NAND gate are implemented." height="293" src="https://static.righto.com/images/phi/gate-schematic-w400.png" title="This schematic shows how the inverter and a NAND gate are implemented." width="400"/></a></p><p>This schematic shows how the inverter and a NAND gate are implemented.</p>
<h2>The FIFOs</h2>
<p>The PHI chip has two first-in-first-out buffers (FIFOs) that occupy a substantial part of the die.
Each FIFO holds 8 words of 10 bits, with one FIFO for data being read from the bus and the other for data
written to the bus.
These buffers help match the bus speed to the microprocessor speed, ensuring that data transmission is
as fast as possible.</p>
<p>Each bit of the FIFO is essentially a static RAM cell, as shown below.
Inverters A and B form a loop to hold a bit. Pass transistor C provides feedback so the inverter loop remains
stable.
To write a word, 10 bits are fed through vertical bit-in lines. A horizontal word write signal is activated 
to select the word to update. This disables transistor C and turns on transistor D, allowing the new bit to
flow into the inverter loop.
To read a word, a horizontal word read line is activated, turning on pass transistor F.
This allows the bit in the cell to flow onto the vertical bit-out line, buffered by inverter E.
The two FIFOs have separate lines so they can be read and written independently.</p>
<p><a href="https://static.righto.com/images/phi/fifo-schematic.png"><img alt="One cell of the FIFO." height="217" src="https://static.righto.com/images/phi/fifo-schematic-w500.png" title="One cell of the FIFO." width="500"/></a></p><p>One cell of the FIFO.</p>
<p>The diagram below shows nine FIFO cells as they appear on the die. The red box indicates one cell, with
components labeled to match the schematic.
Cells are mirrored vertically and horizontally to increase the layout density.</p>
<p><a href="https://static.righto.com/images/phi/fifo-die.jpg"><img alt="Nine FIFO cells as they appear on the die." height="312" src="https://static.righto.com/images/phi/fifo-die-w600.jpg" title="Nine FIFO cells as they appear on the die." width="600"/></a></p><p>Nine FIFO cells as they appear on the die.</p>
<p>Control logic (not shown) to the left and right of the FIFOs manages the FIFOs.
This logic generates the appropriate read and write signals so data is
written to one end of the FIFO and read from the other end.</p>
<h2>The address decoder</h2>
<p>Another interesting circuit is the decoder that selects a particular register based on the address lines.
The PHI chip has eight registers, selected by three address lines. The decoder takes the address lines and
generates 16 control lines
(more or less), one to read from each register, and one to write to each register.</p>
<p><a href="https://static.righto.com/images/phi/decoder.jpg"><img alt="A die photo of the address decoder." height="440" src="https://static.righto.com/images/phi/decoder-w600.jpg" title="A die photo of the address decoder." width="600"/></a></p><p>A die photo of the address decoder.</p>
<p>The decoder has a regular matrix structure for efficient implementation.
Row lines are in pairs, with a line for each address bit input and its complement.
Each column corresponds to one output, with the transistors arranged so the column will be activated when
given the appropriate inputs.
At the top and bottom are inverters. These latch the incoming address bits, generate the complements, and
buffer the outputs.</p>
<p><a href="https://static.righto.com/images/phi/decoder-schematic.png"><img alt="Schematic of the decoder." height="501" src="https://static.righto.com/images/phi/decoder-schematic-w350.png" title="Schematic of the decoder." width="350"/></a></p><p>Schematic of the decoder.</p>
<p>The schematic above shows how the decoder operates. (I&#39;ve simplified it to two inputs and two outputs.)
At the top, the address line goes through a latch formed from two inverters and a pass transistor.
The address line and its complement form two row lines; the other row lines are similar.
Each column has a transistor on one row line and a diode on the other, selecting the address for that column.
For instance, supposed a<sub>0</sub> is 1 and a<sub>n</sub> is 0.
This matches the first column since the transistor lines are low and the diode lines are high.
The PMOS transistors in the column will all turn on, pulling the input to the inverter high.
However, if any of the inputs are &#34;wrong&#34;, the corresponding transistor will turn off, blocking the +12 volts.
Moreover, the output will be pulled low through the corresponding diode.
Thus, each column will be pulled high only if all the inputs match, and otherwise it will be pulled low.
Each column output controls one of the chip&#39;s registers, allowing that register to be accessed.</p>
<h2>The HP-IB bus and the PHI chip</h2>
<p>The Hewlett-Packard Interface Bus (HP-IB) was designed in the early 1970s as
a low-cost bus for connecting diverse devices including instrument systems (such as a digital voltmeter or frequency counter), storage, and computers.
This bus became an IEEE standard in 1975, known as the IEEE-488 bus.<span id="fnref:pet"><a href="#fn:pet">2</a></span>
The bus is 8-bits parallel, with handshaking between devices so slow devices can control the speed.</p>
<p>In 1977, HP Developed a chip, known as PHI (Processor to HP-IB Interface) to implement the bus protocol and
provide a microprocessor interface.
This chip not only simplified construction of a bus controller but also ensured that devices implemented
the protocol consistently.
The block diagram below shows the components of the PHI chip. It&#39;s not an especially complex chip, but it
isn&#39;t trivial either. I estimate that it has several thousand transistors.</p>
<p><a href="https://static.righto.com/images/phi/block-diagram.jpg"><img alt="Block diagram from HP Journal, July 1989." height="305" src="https://static.righto.com/images/phi/block-diagram-w700.jpg" title="Block diagram from HP Journal, July 1989." width="700"/></a></p><p>Block diagram from <a href="fttps://www.hpl.hp.com/hpjournal/pdfs/IssuePDFs/1978-07.pdf#page=16">HP Journal</a>, July 1989.</p>
<p>The die photo below shows some of the functional blocks of the PHI chip.
The microprocessor connected to the top pins, while the interface bus connected to the lower pins.</p>
<p><a href="https://static.righto.com/images/phi/die-labeled.jpg"><img alt="The PHI die with some functional blocks labeled," height="566" src="https://static.righto.com/images/phi/die-labeled-w700.jpg" title="The PHI die with some functional blocks labeled," width="700"/></a></p><p>The PHI die with some functional blocks labeled,</p>
<h2>Conclusions</h2>
<p><a href="https://static.righto.com/images/phi/top.jpg"><img alt="Top of the PHI chip, with the 1AA6-6004 part number. I&#39;m not sure what the oval stamp at the top is, maybe a turtle?" height="304" src="https://static.righto.com/images/phi/top-w350.jpg" title="Top of the PHI chip, with the 1AA6-6004 part number. I&#39;m not sure what the oval stamp at the top is, maybe a turtle?" width="350"/></a></p><p>Top of the PHI chip, with the 1AA6-6004 part number. I&#39;m not sure what the oval stamp at the top is, maybe a turtle?</p>
<p>The PHI chip is interesting as an example of a &#34;technology of the future&#34; that didn&#39;t quite pan out.
HP put a lot of effort into silicon-on-sapphire chips, expecting that this would become an important
technology: dense, fast, and low power.
However, regular silicon chips turned out to be the winning technology and silicon-on-sapphire was relegated
to niche markets.</p>
<p>Comparing HP&#39;s silicon-on-sapphire chips to regular silicon chips at the time shows some advantages and disadvantages.
HP&#39;s MC<sup>2</sup> 16-bit processor (1977) used 
silicon-on-sapphire technology and had 10,000 transistors and ran at 8 megahertz, using 350 mW.
In comparison, the Intel 8086 (1978) was also a 16-bit processor, but implemented on regular silicon and using NMOS instead of CMOS. The 8086 had 29,000 transistors, ran at 5 megahertz (at first) and
used up to 2.5 watts. The sizes of the chips were almost identical: 34 mm<sup>2</sup> for the HP processor and
33 mm<sup>2</sup> for the Intel processor.
This illustrates that CMOS uses much less power than NMOS, one of the reasons that CMOS is now the dominant technology.
For the other factors, silicon-on-sapphire had a bit of a speed advantage but wasn&#39;t as dense.
Silicon-on-sapphire&#39;s main problem was its low yield and high cost.
Crystal incompatibilities between silicon and sapphire made manufacturing difficult; HP achieved a yield of 9%,
meaning 91% of the dies failed.</p>
<p>The time period of the PHI chip is also interesting since interface buses were transitioning from
straightforward buses to high-performance buses with complex protocols.
Early buses could be implemented with simple integrated circuits, but as protocols became more complex,
custom interface chips became necessary.
(The <a href="https://en.wikipedia.org/wiki/MOS_Technology_6522">MOS 6522 Versatile Interface Adapter</a> chip (1977)
is another example, used in many home computers of the 1980s.)
But these interfaces were still simple enough that the interface chips didn&#39;t require microcontrollers,
using simple state machines instead.</p>
<p><a href="https://static.righto.com/images/phi/logo.jpg"><img alt="The HP logo on the die of the PHI chip." height="211" src="https://static.righto.com/images/phi/logo-w250.jpg" title="The HP logo on the die of the PHI chip." width="250"/></a></p><p>The HP logo on the die of the PHI chip.</p>
<p>For more,
follow me on Twitter <a href="https://twitter.com/kenshirriff">@kenshirriff</a> or <a href="https://www.righto.com/feeds/posts/default">RSS</a> for updates.
I&#39;m also on Mastodon occasionally as <a href="https://oldbytes.space/@kenshirriff">@<span data-cfemail="1279777c617a7b60607b7474527d7e76706b6677613c6162737177">[emailÂ protected]</span></a>.
Thanks to <a href="https://www.youtube.com/@CuriousMarc/featured">CuriousMarc</a> for providing the chip and to <a href="https://twitter.com/TubeTimeUS">TubeTimeUS</a> for help with decapping.</p>
<h2>Notes and references</h2>


</div></div>
  </body>
</html>
