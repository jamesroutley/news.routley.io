<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.x-plane.com/2022/02/x-plane-12-flight-model-update-supersonic-transition-delta-wings-and-mass-properties/">Original</a>
    <h1>X-Plane 12 Flight Model Update – Supersonic Transition, Delta Wings and Mass</h1>
    
    <div id="readability-page-1" class="page"><div>
				
<!-- content-single.php -->
<article id="post-40423">
<img width="2048" height="1513" src="https://developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM.png" alt="" srcset="//developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM.png 2048w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1024x757.png 1024w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1218x900.png 1218w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-768x567.png 768w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1536x1135.png 1536w" sizes="(max-width: 2048px) 100vw, 2048px"/>




<p>Oh my GOSH this is getting good.</p>



<p>One of my favorite planes the F-4 Phantom. And one of our alpha testers recently casually mentioned that he was an Israeli Air Force F-4 Phantom flight instructor. I’ve been exchanging emails with him about every 30 minutes or so, on average, for 12-hour-long days, for the past 5 days or so. We have been doing DOZENS of changes of EXEs and ACFs to get the F-4 in X-Plane flying PERFECTLY.</p>



<p>And the success we’ve realized is beyond my wildest expectations.</p>



<p>So here we go:</p>



<p>So here is the thing about the F-4: It has a HUGE speed envelope, going from 150 knots to… 1,500 knots.And a HUGE angle of attack envelope, going from zero to… 25 or 30 degrees AOA without losing control, as that huge delta wing rolls up a giant vortex to maintain low pressure above it, without stalling, up to absurdly-high angles of attack.</p>



<p>And it does this with almost no flight computer to speak of at all… just a rate-damper, nothing else!</p>



<p>So the F-4 Phantom has always been my dream airplane, and it exposes any error in the X-Plane code. It’s perfect.</p>



<p>And now, with an Israeli Air Force F-4 flight instructor putting in 12 hours days for five days or so with CONSTANT emails and iterations, we have this airplane DIALED IN TO FLIGHT PERFECTION.</p>



<p>And here is where it gets REALLY FUN: We did this not just by perfecting the ACF file (which we surely did) but ALSO by perfecting the flight model code in X-Plane, rolling in refinements that will subtly benefit ALL airplanes.</p>



<p>So here’s where we start:</p>



<p>BOOOO!</p>



<p>That’s not what the real airplane does!</p>



<p>Here is what is so amazing about this: For traditional wings like X-Plane has always simulated, air never comes up over the leading edge! Instead, at the stalling angle of attack, the air separates from the top, loses suction, and the wing stalls! And all of this is carefully orchestrated based on the AIRFOIL, or CROSS-SECTION SHAPE, of the wing!So X-Plane has always used the airfoil cross-section, corrected for the plan-form, or top-down shape of the wing, as classical wing theory calls for.</p>



<p>But now, with a delta wing, the cross-section of the wing hardly matters! Now what matters is the plan-form, or top-down shape, of the wing! That’s what lets the air roll up over that highly-swept leading edge to form the huge hurricane over the wing that SUUUUUUUCKS the wing up… and never stalls!</p>



<p>And X-Plane now used this classical wing theory based on the AIRFOIL CROSS SECTION for non-delta wings, vortex-generation based on the PLAN-FORM of the wing for delta wings, and even interpolate smoothly between them for partially-delta shapes, consider both the airfoil cross-section, and the delta plan-form, for a real three-dimensional understanding of the wing.</p>



<p>And that is what lets us simulate the delta wing of the F-4, with that huge over-the-wing hurricane that lifts the wing up without fear of stalling even at crazy-high angles of attack.</p>



<p>Of course, this gives HUGE LIFT, bit also with a resulting HUGE drag! So, to get this airplane right in X-Plane, job number one was to get this vortex formation working in the simulator, so we did! Now, as the wing as entered in Plane-Maker gets closer to the proper shape for vortex lift, X-Plane smoothly departs that oh-so-boring land of smooth flow up to the stall that we have gotten used to, and into the land of vortex-generation as a function of angle of attack! Now, when X-Plane detects the SHAPE of the DELTA wing, higher AOA means more lift (and boatloads more drag!) without any stall! And what is beautiful is that X-Plane PHASES SMOOTHLY INTO the delta-wing dynamics based on how CLOSE to a delta-wing the planform is. The F-4 wing is NOT QUITE a perfect delta-wing shape, so SOME classical wing dynamics remain in place: X-Plane is blending largely into the vortex dynamics, but still using some of the classical dynamics at the same time… and if you look at the slats on the leading edge of the real airplane, you will see that the designers telegraphed this to us, equipping the wing with slats to resist stall in the classical flight dynamics regime as well.</p>



<p>And, once that stall-proof delta-wing was done… I RIPPED THE ARTIFICIAL STABILITY COMPUTER RIGHT OUT OF THE AIRPLANE! NOTHING LEFT BUT A DAMPER, LIKE THE REAL PLANE!</p>



<p>The reason was quickly found:</p>



<p>And, and that LAST item is what the OLD flight model did not quite understand.</p>



<p>Boom. NOW we feel the transition from subsonic vortex lift to supersonic compression-shocks and expansion-fans and back to hurricane lift if we pull the nose hard in a supersonic turn to drag us back down to subsonic.</p>



<p>Why? Let’s look at transonic flight for a moment.</p>



<p>Imagine you are in a GLIDER. Nice long straight wings sticking out there. You are in thin air at 100,000 feet and diving down at a 45-degree angle. There’s probably RedBull logos on your airplane, and you’re in a pressure suit. As you dive, air speeds up to MORE than the speed of the airplane to get AROUND that thick, cambered wing. The THICKER the wing, the MORE the air speeds up to get around it. The GREATER THE CAMBER, or LIFT the wing, the MORE the air speeds up to get around the wing. (Remember, air speeds up to generate lift!)</p>



<p>But you are high on RedBull and have to pee so bad for obvious reasons that you want to get back down to Earth FASTER than Mach 0.60.You want more speed.How do you get it? OK, let’s operate with LESS LIFT. Let’s use a foil that is NOT SO CAMBERED on top. Without this airfoil camber and lift, the air does NOT speed up so much over the top of the wing! Of course, you have less lift now so the plane has a higher stall speed and HAS to fly faster, but who cares? You’re in a hurry. Reducing that camber and local airflow acceleration lets you get up to mach 0.65 before the flow goes to supersonic over the top of the wing. More speed!</p>



<p>But you still want to go faster. Nobody wants to pee inside a pressure suit.Ok, let’s make the wing THINNER! This means the air does NOT have to speed up as much to get around the wing, so now you can get to maybe Mach 0.70 before those thrice-damned shock waves form over the wing and block your acceleration. But you still want to go faster. As you get older, you can’t hold it as long. So now we SWEEP THE WINGS BACK. If we sweep the wing to a 45 degree angle, then the flow acting at a right angle to the chord is only 71% (cosine of 45 degrees) of the actual local speed.</p>



<p>Or, put another way, the wing is SLIDING out of a direct conflict with the air by slicing through it SIDEWAYS.</p>



<p>So that wing sweep EFFECTIVELY lowers the speed over the wing: Less airspeed acting at a right angle to it! And X-Plane was applying this speed reduction to the MACH NUMBER on the wing as well! Ooops! BAD MOVE.NOT RIGHT.</p>



<p>So the subtlety is that: Wing sweep lowers effective wing speed, by reducing the airspeed acting at a right angle to the chord and lowering the resultant lift… Wing sweep lowers effective wing camber and thickness, reducing localized flow acceleration to supersonic speeds… But once you are going Mach 1, the shock waves form on a wing of ANY sweep… the sweep just DELAYED that localized shock-wave build-up until CLOSER to Mach 1. Wing sweep doesn’t let you exceed Mach 1 with subsonic flow.</p>



<p>So based on this, we would expect an airplane with a long, thin, lightly-cambered, highly-swept wing to get very very CLOSE to Mach 1, but never quite HIT it. Because that thin, un-cambered, swept wing sees almost no localized sonic flow until almost the very moment the plane hits Mach 1. There’s very little localized flow acceleration.</p>



<p>Bingo.</p>



<p>The the NEXT thing we noticed is that the simulated F-4 did NOT want to raise the nose quick enough in take-off!The real airplane could raise that nose at 155 knots in the take-off roll… so why was the simulated airplane building up to 185 knots on the runway before we could get the nose up?</p>



<figure><img loading="lazy" width="1024" height="658" src="https://developer.x-plane.com/wp-content/uploads/2022/02/1645207357938.png" alt="" srcset="//developer.x-plane.com/wp-content/uploads/2022/02/1645207357938.png 1024w, //developer.x-plane.com/wp-content/uploads/2022/02/1645207357938-768x494.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>So the next thing I did was get all the fuel placed properly in Plane-Maker. Doing this, the nose came up at CLOSER to the right speed (175 knots?) under full acceleration, but still not he 155 knots we know the real airplane could do. </p>



<p>What’s next?</p>



<p>In the REAL airplane, downwash from the flaps certainly smacked DOWN on the horizontal stabs, giving more nose-up moment, but in X-Plane, we were just not seeing that downwash hitting the stabilizer during the take-off roll (but it was just fine in flight!!!) WHY?? As you may have guessed, it was GROUND EFFECT. IN REALITY, ground effect is BOUND to flatten out the downwash from the wing onto the horizontal stabilizer, and the old X-Plane flight model was OVER-DOING that effect, flattening out the ground effect a bit TOO MUCH. I went back to the ground effect reports I used, and found a better way to curve-fit the experimental data.</p>



<p>What ELSE were we missing?</p>



<p>We were still raising the nose at 170 knots… 15 knots too fast. We needed to get that nose up at 155 knots, 15 knots sooner.We need 15 knots more ‘oomph’.Somehow.</p>



<p>What were we missing?</p>



<p>Suddenly it hit me: There is a thing called ENTRAINED FLOW. ENTRAINED FLOW is wherever you find a fast-moving JET of air, and the air nearby is GRABBED AND DRAGGED ALONG WITH IT to some extent, speeding up the air all AROUND the jet. Look at video of any of Space-X’s or anyone else’s rocket engine tests on the test-stand: You plainly see air RUSHING through the test stand, entrained in the hypersonic rocket flow, and being dragged along with the current. Do you know of any jets of air located near the horizontal stabilizers of the F-4 Phantom?</p>



<p>If not, then here’s a small, subtle hint:</p>



<figure><img loading="lazy" width="736" height="490" src="https://developer.x-plane.com/wp-content/uploads/2022/02/iu.jpeg" alt=""/></figure>



<p>Now this is subtle, but if you look real careful and squint just right, you will see these HUGE FREAKING AFTERBURNERS PUSHING AIR OUT AT ONE FREAKING THOUSAND FIVE HUNDRED MILES PER HOUR. This entrains flow, without question. In other words, the entrained flow around the jet exhaust is getting dragged along by the supersonic core, speeding airflow over the horizontal stabilizer! </p>



<p>I asked the F-4 instructor, really assuming I was wasting my time asking a pilot such a weird technical question that nobody ever even thinks about.</p>



<p>Then, in his endless series of mic-drop moments, he knew.</p>



<p>And here it is:</p>



<figure><img loading="lazy" width="1062" height="900" src="https://developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM-1062x900.png" alt="" srcset="//developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM-1062x900.png 1062w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM-906x768.png 906w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM-768x651.png 768w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM-1536x1302.png 1536w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-21-at-4.25.31-PM.png 1680w" sizes="(max-width: 1062px) 100vw, 1062px"/></figure>



<p>Boom. My jaw dropped when I got this. The answer is right there.</p>



<p>Another fascinating thing you see is that as you move out to the SIDE from the CENTER, the flow cuts its’ speed almost exactly in HALF each bit of CONSTANT DISTANCE you move.</p>



<p>In other words, at a certain distance aft (call it 100 feet) the flow speed exactly cuts in HALF for each ten feet you move to the side! The EDGE of the drawn gray plume is NOT where the speed is ZERO… it is where the speed is fifteen knots… 1% of the core emitter velocity.And, as you can easily extrapolate from this, in another 10 feet it will be half of 15 knots! And, as you can easily extrapolate from this, in another 10 feet it will be one quarter of 15 knots!And, as you can easily extrapolate from this, in another 10 feet it will be one eighth of 15 knots! And, as you can easily extrapolate from this, in another 10 feet it will be one sixteenth of 15 knots!</p>



<p>I think you get the picture: The entrained flow goes out very very far (do you REALLY thing it WON’T be windy standing behind an F-4 Phantom at full afterburner?), but the flow speed simply gets very very small compared to the core speed as you move farther away.</p>



<figure><img loading="lazy" width="1218" height="900" src="https://developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1218x900.png" alt="" srcset="//developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1218x900.png 1218w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1024x757.png 1024w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-768x567.png 768w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM-1536x1135.png 1536w, //developer.x-plane.com/wp-content/uploads/2022/02/Screen-Shot-2022-02-22-at-11.12.30-AM.png 2048w" sizes="(max-width: 1218px) 100vw, 1218px"/></figure>



<p>Boom. Average 15 knots of help on the stabilizer from the entrained flow. The horizontal stab of an F-4 gets help from flow entrained in the jetwash, increasing the speed over the stabilizer. By an average of 15 knots. There was our missing 15 knots. With the entrained flow jet-blast model right from the ground-personnel warning, we suddenly had an extra 15 knots on the tail, and the nose coming up right at 155 knots, JUST LIKE THE REAL PLANE.</p>



<p>The performance was all dialed in, but something was still not quite right: The plane seemed to be too sluggish in roll. Sort of… wallowing. Even more than the real plane! Especially at low speeds. At high speeds, it was basically perfect.</p>



<p>Why? How do you have the roll being too sluggish at low speed, but just fine at high speed?</p>



<p>So, it was time to go into the way X-Plane distributes the mass across the airplane to DETERMINE the the inertias in pitch, roll, and yaw.Sure enough, X-Plane could be a bit better there! First, I updated X-Plane’s mass estimate for the ENGINES based on all the latest engine data I could find based on number of engine spools and bypass ratio. Then, I added consideration of the EMPTY fuel tanks to the mass-distribution estimate. Fuel itself was already added, but why not take it to the next level of accuracy and also add the weight estimate for the empty tanks themselves? They are mostly just above the centerline of the airplane, tightening that roll inertia right up. As well, why not consider the fact that THINNER wings probably weight less, since any airplane with really thin wings is not storing too much stuff IN those wings! Fighter jets store most of their stuff in their bodies, not in their wings! This is needed to keep the wings thin to keep the drag down! So, with fuel tank empty masses and locations considered, and thin wings pushing the innards of the airplane out of the wings and into the bodies a bit, X-Plane now had a more accurate moment of inertia estimates (on all axis) and that tightened up the roll inertia, resulting in proper roll even at low speeds, where the aero forces were low, and the body inertias very very apparent.</p>



<p>But now we got to a really odd subtlety: (this one also explained in a video found by Scott Manley on YouTube)</p>



<p>Check out this video: <a href="https://youtu.be/iZiduQboyow?t=573">//youtu.be/iZiduQboyow?t=573</a></p>



<p>At really high angle of attack, the speedbrakes become blanketed in turbulent, separated or cyclonic flow, and frankly don’t do anything.</p>



<p>But now we got to a really odd subtlety: (this one also explained in a video found by Scott Manley on YouTube… youtube.com/watch?v=iZiduQboyow, t = 9:33) At really high angle of attack, the speedbrakes become blanketed in turbulent, separated or cyclonic flow, and frankly don’t do anything. Think about it: They’re in the middle of the wing, far from the leading or trailing edge, in the middle of a chaotic and turbulent zone of air. Why WOULD they do anything in that scenario? So, at a very high angle of attack, the roll spoilers become use lawn-ornaments on the wing, and lowering an aileron just increases the DRAG on the wing you want to raise, pulling it AFT and dropping it, while of course advancing and lifting the other wing, causing the pane to wallow in the OPPOSITE direction you commanded! As my F-4 instructor put it: “If you try to pitch and roll at the same time, the Phantom will not obey”. So now, with blanked flow diminishing and then finally at max lift eliminating speedbrake effects, sure enough in X-Plane: Near max angle of attack, full left stick causes the nose to yaw right, and the plane to gradually wander off to the right, and vice-versa. All of this is emergent behavior in X-Plane: None of it was tacked on. Again, the huge performance envelope and nearly-absent computers, coupled with high mass and small wings made every single shortcoming in the flight model stand out like a sore thumb… so I could quickly address it!</p>



<p>So, we now have the F-4 flying at a level needs to give flight instruction.</p>



<p>But is there any OTHER use for these improvements in X-Plane?</p>



<p>Well, flying the new F-14 Tomcat, we suddenly do NOT need a fake, stall-proof airfoil for the horizontal stabilizer. Why? Because the horizontal stabilizer of the F-14 is a delta-wing. It doesn’t stall: It vortex-lifts itself to do any job. Now, the hurricane forms over the F-14 stabilizers, preventing any stall of the tail surface.</p>



<p>As well (and this is the big one) if you look at videos like this, you will see the horizontal stabilizers of large airliners shaking during their take-offs. And no, it is NOT from a bumpy runway: The main wings are as still as a rock in a field. Check it out:</p>



<figure><p>
<iframe loading="lazy" title="7 ROARING 777 TAKEOFFS | Anchorage Airport Plane Spotting" width="640" height="360" src="//www.youtube.com/embed/ltAlU8-5GJ8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p></figure>



<p>So why is the horizontal stabilizer jiggling along as if something is smacking into it? Well, as you now know: THERE IS! It’s the entrained flow from the engines! X-Plane now applies the entrained flow model from the F-4 ground-crew warning to ALL jets of air (physics are physics!) and sure enough, about 15 knots or so is making it to the stab of the A-330! Again, helping raise that nose at a lower speed, as our model needed.</p>



<figure><p>
<iframe loading="lazy" title="X-Plane 12 – A330 Flight Model Demo" width="640" height="480" src="//www.youtube.com/embed/eXY-h_chfAw?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p></figure>



<p>So, this tuning and upgrading of the flight model to NAIL the F-4 has been great, fleet-wide!</p>



<p>And, of course: Wow, what an airplane.</p>



<p>And the final note from the F-4 instructor:</p>



<blockquote><p><em>Hi Austin,</em></p><p><em>🙂</em></p></blockquote>



<p>P.S…. I just saw <a href="https://americanutopiabroadway.com/">American Utopia on Broadway in New York City</a>, and I have to say: It was incredible.</p>







<p>This is David Byrns’ show, where he does our favorite songs from the Talking Heads with a really incredible way of presenting both the band and the music… A free and liberating way I’ve never seen before. The theater is a small venue where you are really right there with David enjoying his creativity. It’s the best show I’ve ever been to. It’s shutting down in 30 days so if you want to see this incredible experience you’re just about out of time. New York is opening back up again so there’s just a narrow window left to hang out with David Byrne and see this. Seize the day while you can!</p>
            <div id="entry-author-info">
                <p><img alt="" src="https://secure.gravatar.com/avatar/782faf37132e9fff9d4c08dac8240d55?s=96&amp;d=mm&amp;r=g" srcset="//secure.gravatar.com/avatar/782faf37132e9fff9d4c08dac8240d55?s=192&amp;d=mm&amp;r=g 2x" height="96" width="96" loading="lazy"/></p>
                <!-- #author-description -->
            </div><!-- #entry-author-info -->
<hr/>
</article><!-- #post-## -->

<!-- #comments -->

			</div></div>
  </body>
</html>
