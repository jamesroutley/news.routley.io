<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/e-dant/watcher">Original</a>
    <h1>Show HN: Filesystem Watcher</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/e-dant/watcher/actions/workflows/codeql.yml/badge.svg"><img src="https://github.com/e-dant/watcher/actions/workflows/codeql.yml/badge.svg" alt="CodeQL"/></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/e-dant/watcher/actions/workflows/ubuntu.yml/badge.svg"><img src="https://github.com/e-dant/watcher/actions/workflows/ubuntu.yml/badge.svg" alt="Linux"/></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/e-dant/watcher/actions/workflows/macos.yml/badge.svg"><img src="https://github.com/e-dant/watcher/actions/workflows/macos.yml/badge.svg" alt="MacOS"/></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/e-dant/watcher/actions/workflows/windows.yml/badge.svg"><img src="https://github.com/e-dant/watcher/actions/workflows/windows.yml/badge.svg" alt="Windows"/></a></p>
<h2 dir="auto"><a id="user-content-quick-start" aria-hidden="true" href="#quick-start"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h2>
<p dir="auto">Write:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/* tiny-main.cpp */
#include &lt;iostream&gt;
#include &#34;../sinclude/watcher/watcher.hpp&#34; /* Point this to wherever yours is */
int main(int argc, char** argv) {
  using water::watcher::event::event, water::watcher::watch, std::cout, std::endl;
  cout &lt;&lt; R&#34;({&#34;water.watcher.stream&#34;:{)&#34; &lt;&lt; endl;

  /* This is the important line. */
  const auto is_watch_ok = watch&lt;16&gt;(
      argc &gt; 1 ? argv[1] : &#34;.&#34;,
      [](const event&amp; this_event) { cout &lt;&lt; this_event &lt;&lt; &#39;,&#39; &lt;&lt; endl; });

  cout &lt;&lt; &#39;}&#39; &lt;&lt; endl &lt;&lt; &#39;}&#39; &lt;&lt; endl;
  return is_watch_ok;
}"><pre><span><span>/*</span> tiny-main.cpp <span>*/</span></span>
#<span>include</span> <span><span>&lt;</span>iostream<span>&gt;</span></span>
#<span>include</span> <span><span>&#34;</span>../sinclude/watcher/watcher.hpp<span>&#34;</span></span> <span><span>/*</span> Point this to wherever yours is <span>*/</span></span>
<span>int</span> <span>main</span>(<span>int</span> argc, <span>char</span>** argv) {
  <span>using</span> water::watcher::event::event, water::watcher::watch, std::cout, std::endl;
  cout &lt;&lt; <span><span>R&#34;(</span>{&#34;water.watcher.stream&#34;:{<span>)&#34;</span></span> &lt;&lt; endl;

  <span><span>/*</span> This is the important line. <span>*/</span></span>
  <span>const</span> <span>auto</span> is_watch_ok = watch&lt;<span>16</span>&gt;(
      argc &gt; <span>1</span> ? argv[<span>1</span>] : <span><span>&#34;</span>.<span>&#34;</span></span>,
      [](<span>const</span> event&amp; this_event) { cout &lt;&lt; this_event &lt;&lt; <span><span>&#39;</span>,<span>&#39;</span></span> &lt;&lt; endl; });

  cout &lt;&lt; <span><span>&#39;</span>}<span>&#39;</span></span> &lt;&lt; endl &lt;&lt; <span><span>&#39;</span>}<span>&#39;</span></span> &lt;&lt; endl;
  <span>return</span> is_watch_ok;
}</pre></div>
<p dir="auto">Compile &amp; Run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="g++ -std=c++2a src/tiny-main.cpp -o watch
./watch"><pre>g++ -std=c++2a src/tiny-main.cpp -o watch
./watch</pre></div>
<p dir="auto">Enjoy!</p>
<h2 dir="auto"><a id="user-content-tell-me-more" aria-hidden="true" href="#tell-me-more"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tell Me More</h2>
<p dir="auto">An arbitrary filesystem event watcher which is:</p>
<ul dir="auto">
<li>simple</li>
<li>efficient</li>
<li>dependency free</li>
<li>runnable anywhere</li>
<li>header only</li>
</ul>
<p dir="auto"><em>Watcher</em> is extremely efficient. In most cases,
even when scanning millions of paths, this library
uses a near-zero amount of resources. <em>[1]</em></p>
<p dir="auto">If you don&#39;t want to use it in another project,
don&#39;t worry. It comes with one. Just build and
run and you&#39;ve got yourself a filesystem watcher
which prints filesystem events as JSON, which is
pretty cool.</p>
<p dir="auto">You could, for example, run this program, await events,
and filter through the noise:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# get
git clone https://github.com/e-dant/watcher.git &amp;&amp; cd watcher

# build
cmake -S build/in -B build/out &amp;&amp; cmake --build build/out --config Release
# or, from with the &#34;water&#34; project: `tell build`

# use
build/out/water.watcher | grep -oE &#39;needle-in-a-haystack/.+&#34;&#39;"><pre><span><span>#</span> get</span>
git clone https://github.com/e-dant/watcher.git <span>&amp;&amp;</span> <span>cd</span> watcher

<span><span>#</span> build</span>
cmake -S build/in -B build/out <span>&amp;&amp;</span> cmake --build build/out --config Release
<span><span>#</span> or, from with the &#34;water&#34; project: `tell build`</span>

<span><span>#</span> use</span>
build/out/water.watcher <span>|</span> grep -oE <span><span>&#39;</span>needle-in-a-haystack/.+&#34;<span>&#39;</span></span></pre></div>
<p dir="auto"><em>Watcher</em> is trivially easy to use, include,
and run. (I hope. If not, let me know.)</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<blockquote>
<p dir="auto"><em>Note</em>: If anything is unclear, make an issue about it!
For deeper information, please see the headers. They are
well-documented and are intended to be approachable.</p>
</blockquote>
<h3 dir="auto"><a id="user-content-important-files" aria-hidden="true" href="#important-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Important Files</h3>
<ul dir="auto">
<li><code>watcher.hpp</code>:
Public interface. Someday, this will be a module.</li>
<li><code>main.cpp</code>:
Build this to use it as a CLI program.</li>
</ul>
<h3 dir="auto"><a id="user-content-the-library" aria-hidden="true" href="#the-library"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The Library</h3>
<p dir="auto">Copy the <code>include</code> or <code>sinclude</code> (for the single header)
into your project. Include as:</p>
<div dir="auto" data-snippet-clipboard-copy-content="#include &lt;water/watcher.hpp&gt;"><pre>#<span>include</span> <span><span>&lt;</span>water/watcher.hpp<span>&gt;</span></span></pre></div>
<p dir="auto">After that, there are two things the user needs:</p>
<ul dir="auto">
<li>The <code>watch</code> function</li>
<li>The <code>event</code> structure</li>
</ul>
<p dir="auto"><code>watch</code> takes a path, which is a string-like thing, and a
callback, with is a function-like thing.</p>
<p dir="auto"><code>event</code> is an object used to pass information about
filesystem events to <code>watch</code>.</p>
<p dir="auto">The <code>event</code> object will contain the:</p>
<ul dir="auto">
<li>Path -- Which is always relative.</li>
<li>Path type -- one of:
<ul dir="auto">
<li>File</li>
<li>Directory</li>
<li>Symbolic Link</li>
<li>Hard Link</li>
<li>Unknown</li>
</ul>
</li>
<li>Event type -- one of:
<ul dir="auto">
<li>Create</li>
<li>Modify</li>
<li>Destroy</li>
<li>OS-Specific Events</li>
<li>Unknown</li>
</ul>
</li>
<li>Event time -- In nanoseconds since epoch</li>
</ul>
<p dir="auto">So, passing <code>watch</code> a string and a lambda would work well.</p>
<p dir="auto"><code>watch</code> will happily continue watching until it is
asked to stop or it hits an unrecoverable error.</p>
<h3 dir="auto"><a id="user-content-your-project" aria-hidden="true" href="#your-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Your Project</h3>
<p dir="auto">It is trivial to build programs that yield something useful.</p>
<p dir="auto">Here is a snapshot of the output taken while preparing this
commit, right before writing this paragraph.</p>
<div dir="auto" data-snippet-clipboard-copy-content="&#34;water.watcher.stream&#34;: {
    &#34;1663556133054707000&#34;: {
      &#34;where&#34;: &#34;water/watcher/.git/objects/cc/tmp_obj_sfbyd6&#34;,
      &#34;what&#34;: &#34;destroy&#34;,
      &#34;kind&#34;: &#34;other&#34;
    },
    &#34;1663556133054710000&#34;: {
      &#34;where&#34;: &#34;water/watcher/.git/HEAD.lock&#34;,
      &#34;what&#34;: &#34;create&#34;,
      &#34;kind&#34;: &#34;other&#34;
    },
    &#34;1663556133054713000&#34;: {
      &#34;where&#34;: &#34;water/watcher/.git/refs/heads/next.lock&#34;,
      &#34;what&#34;: &#34;create&#34;,
      &#34;kind&#34;: &#34;other&#34;
    },
    &#34;1663556133054716000&#34;: {
      &#34;where&#34;: &#34;water/watcher/.git/refs/heads/next.lock&#34;,
      &#34;what&#34;: &#34;modify&#34;,
      &#34;kind&#34;: &#34;other&#34;
    },
    &#34;1663556133069940000&#34;: {
      &#34;where&#34;: &#34;water/watcher/.git/logs/HEAD&#34;,
      &#34;what&#34;: &#34;modify&#34;,
      &#34;kind&#34;: &#34;file&#34;
    }
}"><pre><span>&#34;water.watcher.stream&#34;</span>: {
    <span>&#34;1663556133054707000&#34;</span>: {
      <span>&#34;where&#34;</span>: <span><span>&#34;</span>water/watcher/.git/objects/cc/tmp_obj_sfbyd6<span>&#34;</span></span>,
      <span>&#34;what&#34;</span>: <span><span>&#34;</span>destroy<span>&#34;</span></span>,
      <span>&#34;kind&#34;</span>: <span><span>&#34;</span>other<span>&#34;</span></span>
    },
    <span>&#34;1663556133054710000&#34;</span>: {
      <span>&#34;where&#34;</span>: <span><span>&#34;</span>water/watcher/.git/HEAD.lock<span>&#34;</span></span>,
      <span>&#34;what&#34;</span>: <span><span>&#34;</span>create<span>&#34;</span></span>,
      <span>&#34;kind&#34;</span>: <span><span>&#34;</span>other<span>&#34;</span></span>
    },
    <span>&#34;1663556133054713000&#34;</span>: {
      <span>&#34;where&#34;</span>: <span><span>&#34;</span>water/watcher/.git/refs/heads/next.lock<span>&#34;</span></span>,
      <span>&#34;what&#34;</span>: <span><span>&#34;</span>create<span>&#34;</span></span>,
      <span>&#34;kind&#34;</span>: <span><span>&#34;</span>other<span>&#34;</span></span>
    },
    <span>&#34;1663556133054716000&#34;</span>: {
      <span>&#34;where&#34;</span>: <span><span>&#34;</span>water/watcher/.git/refs/heads/next.lock<span>&#34;</span></span>,
      <span>&#34;what&#34;</span>: <span><span>&#34;</span>modify<span>&#34;</span></span>,
      <span>&#34;kind&#34;</span>: <span><span>&#34;</span>other<span>&#34;</span></span>
    },
    <span>&#34;1663556133069940000&#34;</span>: {
      <span>&#34;where&#34;</span>: <span><span>&#34;</span>water/watcher/.git/logs/HEAD<span>&#34;</span></span>,
      <span>&#34;what&#34;</span>: <span><span>&#34;</span>modify<span>&#34;</span></span>,
      <span>&#34;kind&#34;</span>: <span><span>&#34;</span>file<span>&#34;</span></span>
    }
}</pre></div>
<p dir="auto">Which is pretty cool.</p>
<p dir="auto">A <code>main</code> program suitable for this task:</p>
<div dir="auto" data-snippet-clipboard-copy-content="#include &lt;iostream&gt;            /* std::cout, std::endl */
#include &lt;watcher/watcher.hpp&gt; /* water::watcher::watch, water::watcher::event */

/* Watch a path, forever.
   Stream what happens.
   Print every 16ms. */
int main(int argc, char** argv) {
  using water::watcher::event::event, water::watcher::watch, std::cout, std::endl;
  cout &lt;&lt; R&#34;({&#34;water.watcher.stream&#34;:{)&#34; &lt;&lt; endl;

  /* Use the path we were given
     or the current directory. */
  const auto path = argc &gt; 1 ? argv[1] : &#34;.&#34;;

  /* Show what happens.
     Format as json.
     Use event&#39;s stream operator. */
  const auto show_event_json = [](const event&amp; this_event) {
    cout &lt;&lt; this_event &lt;&lt; &#39;,&#39; &lt;&lt; endl;
  };

  /* Tick every 16ms. */
  static constexpr auto delay_ms = 16;

  /* Run forever. */
  const auto is_watch_ok = watch&lt;delay_ms&gt;(path, show_event_json);

  cout &lt;&lt; &#39;}&#39; &lt;&lt; endl &lt;&lt; &#39;}&#39; &lt;&lt; endl;
  return is_watch_ok;
}"><pre>#<span>include</span> <span><span>&lt;</span>iostream<span>&gt;</span></span>            <span><span>/*</span> std::cout, std::endl <span>*/</span></span>
#<span>include</span> <span><span>&lt;</span>watcher/watcher.hpp<span>&gt;</span></span> <span><span>/*</span> water::watcher::watch, water::watcher::event <span>*/</span></span>

<span><span>/*</span> Watch a path, forever.</span>
<span>   Stream what happens.</span>
<span>   Print every 16ms. <span>*/</span></span>
<span>int</span> <span>main</span>(<span>int</span> argc, <span>char</span>** argv) {
  <span>using</span> water::watcher::event::event, water::watcher::watch, std::cout, std::endl;
  cout &lt;&lt; <span><span>R&#34;(</span>{&#34;water.watcher.stream&#34;:{<span>)&#34;</span></span> &lt;&lt; endl;

  <span><span>/*</span> Use the path we were given</span>
<span>     or the current directory. <span>*/</span></span>
  <span>const</span> <span>auto</span> path = argc &gt; <span>1</span> ? argv[<span>1</span>] : <span><span>&#34;</span>.<span>&#34;</span></span>;

  <span><span>/*</span> Show what happens.</span>
<span>     Format as json.</span>
<span>     Use event&#39;s stream operator. <span>*/</span></span>
  <span>const</span> <span>auto</span> show_event_json = [](<span>const</span> event&amp; this_event) {
    cout &lt;&lt; this_event &lt;&lt; <span><span>&#39;</span>,<span>&#39;</span></span> &lt;&lt; endl;
  };

  <span><span>/*</span> Tick every 16ms. <span>*/</span></span>
  <span>static</span> <span>constexpr</span> <span>auto</span> delay_ms = <span>16</span>;

  <span><span>/*</span> Run forever. <span>*/</span></span>
  <span>const</span> <span>auto</span> is_watch_ok = watch&lt;delay_ms&gt;(path, show_event_json);

  cout &lt;&lt; <span><span>&#39;</span>}<span>&#39;</span></span> &lt;&lt; endl &lt;&lt; <span><span>&#39;</span>}<span>&#39;</span></span> &lt;&lt; endl;
  <span>return</span> is_watch_ok;
}</pre></div>
<h2 dir="auto"><a id="user-content-consume" aria-hidden="true" href="#consume"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Consume</h2>
<h3 dir="auto"><a id="user-content-in-your-project" aria-hidden="true" href="#in-your-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>In Your Project</h3>
<p dir="auto">Download this project. Include <code>watcher.hpp</code>. That&#39;s all.</p>
<p dir="auto">This is a <code>FetchContent</code>-able project, if you&#39;re into that
kind of thing.</p>
<h3 dir="auto"><a id="user-content-as-a-cli-program" aria-hidden="true" href="#as-a-cli-program"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>As A CLI Program</h3>
<h4 dir="auto"><a id="user-content-tell" aria-hidden="true" href="#tell"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tell</h4>
<div dir="auto" data-snippet-clipboard-copy-content="cd water/water/watcher
`tell build`
# watches the current directory
`tell run`
# watches some path
# `tell run` your/favorite/path
# or, to do all of the above:
# `tell bun` your/favorite/path"><pre><span>cd</span> water/water/watcher
<span><span>`</span>tell build<span>`</span></span>
<span><span>#</span> watches the current directory</span>
<span><span>`</span>tell run<span>`</span></span>
<span><span>#</span> watches some path</span>
<span><span>#</span> `tell run` your/favorite/path</span>
<span><span>#</span> or, to do all of the above:</span>
<span><span>#</span> `tell bun` your/favorite/path</span></pre></div>
<p dir="auto">This will take care of:</p>
<ul dir="auto">
<li>Building a compiler if one is not found</li>
<li>Linking the <code>compile_commands.json</code> file
to this project&#39;s root</li>
<li>Actually building the project</li>
</ul>
<h4 dir="auto"><a id="user-content-cmake" aria-hidden="true" href="#cmake"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CMake</h4>
<div dir="auto" data-snippet-clipboard-copy-content="cd water/water/watcher/build
cmake -S &#39;in&#39; -B &#39;out&#39; -G &#39;Ninja&#39; -Wno-dev
cmake --build out --config Release
cd out
# watches the current directory
./water.watcher
# watches some path
# ./water.watcher &#39;your/favorite/path&#39;"><pre><span>cd</span> water/water/watcher/build
cmake -S <span><span>&#39;</span>in<span>&#39;</span></span> -B <span><span>&#39;</span>out<span>&#39;</span></span> -G <span><span>&#39;</span>Ninja<span>&#39;</span></span> -Wno-dev
cmake --build out --config Release
<span>cd</span> out
<span><span>#</span> watches the current directory</span>
./water.watcher
<span><span>#</span> watches some path</span>
<span><span>#</span> ./water.watcher &#39;your/favorite/path&#39;</span></pre></div>
<h2 dir="auto"><a id="user-content-notes" aria-hidden="true" href="#notes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Notes</h2>
<h3 dir="auto"><a id="user-content-1-exceptions-to-efficient-scanning" aria-hidden="true" href="#1-exceptions-to-efficient-scanning"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>[1] Exceptions to Efficient Scanning</h3>
<p dir="auto">There are two cases where <em>Watcher</em>&#39;s efficiency takes a hit:</p>
<ol dir="auto">
<li>When the platform-independant <code>warthog</code> adapter is used.
This happens on platforms which lack better alternatives,
such as BSD and Solaris (<code>warthog</code> beats <code>kqueue</code>).</li>
<li>On embedded systems (where resources matter regardless).</li>
</ol>
<p dir="auto"><em>Watcher</em> is still efficient in these cases. However, depending
on your hardware and whether you need to watch 10-million paths
or not, a longer <code>delay_ms</code> (such as in the seconds-range) might
be necessary to prevent your machine from entering-the-atmosphere
temperature.</p>
<p dir="auto">In all cases, this is a best-in-class filesystem watcher.
The <code>warthog</code> is a capable watcher.</p>
</article>
          </div></div>
  </body>
</html>
