<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cordlandwehr.wordpress.com/2023/01/14/running-plasma-on-visionfive-2/">Original</a>
    <h1>Running KDE Plasma on RISC-V VisionFive-2</h1>
    
    <div id="readability-page-1" class="page"><article id="post-443">
	
	<!-- .entry-header -->

	<div>
		
<p>New year, new RISC-V Yocto blog post \o/ When I wrote my last post, I did really not expect my brand new <a href="https://doc-en.rvspace.org/Doc_Center/visionfive_2.html">VisionFive-2 board</a> to find its way to me so soon‚Ä¶ But well, a week ago it was suddenly there. While unpacking I shortly pondered over my made plans to prepare a Plasma Bigscreen RaspberryPi 4 demo board for this year‚Äôs FOSDEM.</p>



<p>Obvious conclusion: ‚ÄúScrew it! Let‚Äôs do the demo on the VisionFive-2!‚Äù ‚Äî And there we are:</p>



<p>After some initial bumpy steps to boot up a first self-compiled U-boot and Kernel (If you unbox a new board, you need to do a bootloader and firmware update first! Otherwise it will not boot the latest VisionFive Kernel) it was surprisingly easy to prepare Yocto to build a core-image-minimal that really boots the whole way up.</p>



<p>Unfortunately after these first happy hours, the last week was full of handling the horrors of closed-source binary drivers for the GPU. Even though Imagination promised to provide an open source driver at some time, right now there is only the solution to use the closed source PVR driver. After quite a lot of trying, guessing and and comparing the boot and init sequences of the reference image to the dark screen in front of me, I came up with:</p>



<ul>
<li>a new visionfive2-graphics Yocto package for the closed source driver blobs</li>



<li>a fork of Mesa that uses a very heavy patch set for the PVR driver adaptions; all patches are taken from the VisionFive 2 buildroot configurations</li>



<li>and a couple of configs for making the system start with doing an initial modeset</li>
</ul>



<p>The result right now:</p>



<figure><a href="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg"><img data-attachment-id="451" data-permalink="https://cordlandwehr.wordpress.com/2023/01/14/running-plasma-on-visionfive-2/visionfive2/" data-orig-file="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg" data-orig-size="1513,1680" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;1.65&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;HD1900&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1673700613&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;4.755&#34;,&#34;iso&#34;:&#34;640&#34;,&#34;shutter_speed&#34;:&#34;0.02&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;,&#34;latitude&#34;:&#34;52.10579&#34;,&#34;longitude&#34;:&#34;8.08352&#34;}" data-image-title="visionfive2" data-image-description="" data-image-caption="" data-medium-file="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=270" data-large-file="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=660" src="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=922" alt="" srcset="https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=922 922w, https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=135 135w, https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=270 270w, https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg?w=768 768w, https://cordlandwehr.files.wordpress.com/2023/01/visionfive2.jpg 1513w" sizes="(max-width: 922px) 100vw, 922px"/></a></figure>



<p>VisionFive-2 device with Plasma-Bigscreen (KWin running via Wayland), SD card image built via Yocto, KDE software via KDE‚Äôs Yocto layers, Kernel and U-Boot being the latest fork versions <a href="https://github.com/starfive-tech">from StarFive</a></p>



<p>Actually, the full UI even feels much smoother than on my RPi4, which is quite cool. I am not sure where I will end in about 3 weeks with some more debugging and patching. But I am very confident that you can see a working RISC-V board with onboard GPU and running Plasma Shell, when you visit the KDE stall at FOSDEM in February üòâ</p>



<p>For people who are interested in Yocto, here is the WIP patch set: <a href="https://github.com/riscv/meta-riscv/pull/382">https://github.com/riscv/meta-riscv/pull/382</a></p>
	</div><!-- .entry-content -->

	
	<!-- .entry-footer -->

</article></div>
  </body>
</html>
