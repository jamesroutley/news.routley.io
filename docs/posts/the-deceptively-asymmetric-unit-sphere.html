<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.tangramvision.com/blog/the-deceptively-asymmetric-unit-sphere">Original</a>
    <h1>The Deceptively Asymmetric Unit Sphere</h1>
    
    <div id="readability-page-1" class="page"><div><p>Previously, we talked about [Pinhole Obsession](https://www.tangramvision.com/blog/camera-modeling-pinhole-obsession) and the downsides of assuming a default pinhole model. We presented an alternative formulation where rays are modeled on the unit sphere \\(\mathcal{S}^2\\) instead of the normalized image plane \\(\mathbb{T}^2\\).</p><p>We‚Äôve also previously written posts about how many problems in robotics can be formulated as [an optimization](https://www.tangramvision.com/blog/introduction-to-optimization-theory). At a high level, many continuous optimization algorithms perform the following steps</p><p>- Compute a quantity to minimize ‚Äî error, misalignment, risk, loss, etc.</p><p>Many continuous optimization problems are modeled on [vector spaces](https://en.wikipedia.org/wiki/Vector_space) and ‚Äúmoving‚Äù the parameters is simply vector addition. However, our prescription of using the unit sphere to model rays is obviously **not** a linear space! Therefore, we must start our discussion by describing how to travel on the sphere.</p><p>## Traveling on the Sphere</p><p>Generally, when we *travel* we want to do so in the most efficient manner. Undoubtedly, you‚Äôve heard the expression ‚Äúget from point a to b,‚Äù perhaps also with the implication ‚Äúas fast as possible.‚Äù Therefore, we‚Äôll want to minimize the distance that we travel or equivalently travel along the shortest path. In Differential Geometry, we call these ‚Äúshortest paths‚Äù *geodesics.*</p><p>An alternate way to view a *geodesic* is by starting at a point \\(p\\) on the manifold and traveling in the direction of some vector \\(v\\), carefully minimizing the distance at each increment. However, minimizing the distance at each step may mean we have to *change direction* along our shortest path.</p><p>‚ÄúChanging direction‚Äù and ‚Äútraveling in the shortest path‚Äù may seem to counter one another. After all, we all know that the shortest path between two points is a line. However, imagine we are flying in a plane starting at the equator and a heading of 45¬∞. If our goal is to travel *as far as possible* from our starting point, how should we chart our course?</p><p>&gt;¬†As usual, ignore air resistance, the jet stream and assume a spherical earth. This is a thought exercise, not pilot‚Äôs school.</p><p>A simple suggestion would be to maintain a heading of 45¬∞ during our travel, like we would locally: travel in a constant direction. However, if we maintain a fixed heading indefinitely, we will end up close to the north pole! The line traced by a path of constant heading is known as a [Rhumb Line](https://en.wikipedia.org/wiki/Rhumb_line) and, as pictured, is certainly not the shortest distance between two points on a sphere.</p><p>![Loxodrome.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f6319ebc7cd01b693200a_Loxodrome.png)</p><p>Alternatively, to truly travel the *farthest distance,* we travel along the [great circle](https://en.wikipedia.org/wiki/Great-circle_distance) until the aircraft runs out of fuel. Here it‚Äôs more obvious that the geodesic‚Äôs heading is continuously changing. One implication of this is that if we start at one point along the geodesic with a vector \\(v\\), we may not end up in the same location as if we start at a different point along the geodesic with the same vector \\(v\\).</p><p>![Illustration_of_great-circle_distance.svg](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f8b9f2d9bfdd0a7e52425_Illustration_of_great-circle_distance.png)</p><p>In Differential Geometry, the operator that traces the geodesic is known as ‚Äúthe exponential map.‚Äù For the reasons listed above, it‚Äôs defined as a local operator originating at a point \\(p\\) and traveling in a direction \\(v\\) i.e.</p><p>$$</p><p>Similarly, the operator that computes the direction and distance between two points on the manifold (the manifold‚Äôs logarithm) is defined as a local operator \\(\text{Log}_p(q)\\).</p><p>So to perform optimization on the unit sphere, we</p><p>- Compute the quantity to minimize ‚Äî error, misalignment, risk, loss, etc.</p><p>This begs the question: how do we compute this direction \\(v\\)? What does it really mean?</p><p>---</p><p>## The Briefest Introduction to Differential Geometry</p><p>&gt;¬†‚ö†Ô∏è Many maths below! But they‚Äôre cool maths, we promise.</p><p>To explain what a direction \\(v\\) means on the sphere and to explain why working with \\(\mathcal{S}^2\\) is difficult, we have to briefly touch on one of my favorite subjects: [Differential Geometry](https://en.wikipedia.org/wiki/Differential_geometry). This post will dive deep into the motivations behind why we use differential geometry in computer vision, and what advantages it brings. Much of this may seem like a tangent (no pun intended), but don‚Äôt worry: we‚Äôll bring it all back to our Pinhole Obsession and optimization at the end!</p><p>&gt;¬†üí° Obviously, we cannot cover the entirety of Differential Geometry in one blog post. There are many great resources to learn Differential Geometry. Some of our favorites are:</p><p>Historically, differential geometry arose from the study of ‚Äúcurves and surfaces.‚Äù As traditionally taught in multi-variable calculus, a curve is a mapping \\(\gamma: \mathbb{R} \to \mathbb{R}^3\\) and likewise, a surface is a mapping \\(\sigma: \mathbb{R}^2 \to \mathbb{R}^3\\).</p><p>Differential geometry generalizes these ‚Äúcurves and surfaces‚Äù to arbitrary dimensions. These generalized ‚Äúcurves and surfaces‚Äù are known as *smooth manifolds*. In this post, we‚Äôll skip the rigorous definition of a smooth manifold and simply define it as</p><p>&gt; *Smooth Manifold:* An N-dimensional space without corners, edges or self-intersections.</p><p>This smoothness (called continuity) allows us to perform optimization ‚Äúon the manifold‚Äù using our standard calculus techniques. We can compute errors and also compute the directions along which we can reduce those errors.</p><p>## Intrinsic vs Extrinsic Manifolds</p><p>To assist intuition, we‚Äôve leaned on prior knowledge of multi-variable calculus of curves and surfaces. At the undergraduate level, curves and surfaces are presented as [embedded entities](https://en.wikipedia.org/wiki/Nash_embedding_theorems) living in a higher-dimensional ambient space e.g. 3D Euclidean Space. However, this ambient space isn‚Äôt *strictly* needed for the development of differential geometry. In their search for a minimal set of axioms, differential geometers have taken great care to remove this dependence on an ambient space; they describe *smooth manifolds* as objects existing in their own right. Thus, there are two ways of thinking about differential geometry:</p><p>- *Extrinsic*: manifolds as embedded objects in space</p><p>In this manner, the error-minimizing direction we are searching for can either be viewed as *extrinsic* (embedded in ambient space) or it can be viewed as *intrinsic* (living alongside the manifold).</p><p>As engineers, the decision to use the intrinsic view of a manifold vs. the extrinsic view mostly impacts representation and computation. Thus, for a specific manifold, we choose the representation that‚Äôs computationally easiest to work with. Although the remainder of this post only briefly touches on the representation of manifolds, it‚Äôs **always** necessary to determine what representation is being used. The decision of an intrinsic or extrinsic representation will change how computation is performed on the manifold. Regardless of the choice of *intrinsic* or *extrinsic* representation, we often ‚Äúbundle‚Äù the representation of the manifold with the representation directions on that manifold.</p><p>&gt;¬†‚ö†Ô∏è The concepts of *intrinsic* and *extrinsic* used in differential geometry are unrelated to intrinsics (interior orientation) and extrinsics (exterior orientation) of cameras. This is simply an unfortunate naming collision at the intersection of two fields.</p><p>## A Brief Tangent for Tangents</p><p>‚Ä¶which brings us to **the** key concept in differential geometry: the [Tangent Bundle](https://en.wikipedia.org/wiki/Tangent_bundle). The Tangent Bundle is the underlying manifold stitched together with the vector spaces that are tangent to the manifold at each point.</p><p>To illustrate this, consider the unit circle \\(\mathcal{S}^1\\) below. The blue circle represents the underlying manifold and the red lines represent the one dimensional tangent space at each point on the circle. Together, the points and tangent spaces form the tangent bundle. It is important to note that that vectors in one tangent space should be regarded as distinct and separate from vectors in another tangent space.</p><p>![Tangent_bundle.svg](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f63501b983d8e9953910b_image.png)</p><p>Now that we have the correct picture in our heads, let‚Äôs visualize tangent vectors and the tangent bundle in more detail.</p><p>Consider an arbitrary manifold \\(M\\), and furthermore consider a curve on that manifold \\(\gamma: \mathbb{R} \to M\\). This curve \\(\gamma(t)\\) can be thought of ‚Äúthe location on the manifold at time \\(t\\).‚Äù Furthermore, let \\(\gamma(0)\\) be some point of interest \\(p \in M\\) on the manifold.</p><p>For visualization, consider this wavy circle manifold:</p><p>![GenericManifold_ManimCE_v0.18.1.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f636093b3a75b96cec282_GenericManifold_ManimCE_v0.18.1.png)</p><p>Now, consider the curve \\(\gamma(t)\\) living on this manifold.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GenericManifoldWithCurve.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GenericManifoldWithCurve.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>If we take the derivative of this curve, we obtain a pair \\((\gamma(t), \gamma&#39;(t))\\), where the first entry describes the point along the curve and the second entry describes how the curve is changing in time. This can be visualized as a vector ‚Äúriding along‚Äù the curve.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GenericManifoldWithCurveAndTangent.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GenericManifoldWithCurveAndTangent.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>The magnitude and sign of this vector can be changed by re-parametrizing the curve as</p><p>$$\gamma_{\alpha}(t) = \gamma(\alpha t)$$</p><p>Specifically, note that</p><p>$$\gamma&#39;_\alpha(0) = \alpha \gamma&#39;(0)$$</p><p>In this manner, we can ‚Äúscale‚Äù curves in the same way that we would scale vectors. Similarly, we can derive addition, inverse and zero curves and form a ‚Äúvector space of curves.‚Äù</p><p>Thus, we define the tangent space \\(T_pM\\) as the set of all curves that pass through a point of interest \\(p \in M\\). The tangent bundle of a manifold \\(TM\\) is the set of all tangent spaces combined under a *disjoint* union. In this context, a disjoint union simply means we cannot combine vectors in distinct tangent spaces. This is perhaps the most important takeaway: tangent vectors living in distinct tangent spaces cannot be added, combined or related without using some additional manifold structure.</p><p>&gt;¬†‚ö†Ô∏è Here, we have *de facto* assumed that we can take the derivative of a curve on the manifold. This is made more rigorous in most differential geometry books by either using charts on the manifold or an extrinsic view of a manifold facilitated by an embedding. Furthermore, we didn‚Äôt really show how to ‚Äúadd curves.‚Äù We haven‚Äôt done anything *improper* with this explanation, but it certainly is lacking detail! You can refer to the previously mentioned resources to learn more about the mathematically precise definitions of the Tangent Bundle.</p><p>If this is your first time studying Differential Geometry, you may be very uncomfortable with the notion of a vector being *attached* in any way to a specific point. After all, vectors are commonly taught as being geometric entities that can be moved anywhere in space, e.g. vector addition is taught using the ‚Äúhead to tail‚Äù method. It‚Äôs unclear when presenting these geometric explanations if the vectors are ‚Äúsitting on top of‚Äù the underlying manifold or if they are in their own ‚Äúvector space.‚Äù</p><p>To see why this ‚Äúhead to tail‚Äù method breaks down on manifolds, imagine traveling 1000 miles north and then 1000 miles west. This will take you to a very different location than if you had traveled 1000 miles west and then 1000 miles north. In other words, vectors may point in different directions at different points on the manifold, so we can only really discuss what a vector means *locally*.</p><p>The representation we have presented here of \\((\gamma(0), \gamma&#39;(0))\\) , is useful in describing the construction tangent vectors on a manifold and also useful in derivations of certain operators, but it is typically not used in computation. In ‚Äúthe real world,‚Äù we typically choose some canonical coordinates for the manifold and a basis for the associated tangent space and think of tangent vectors as \\((p, v) \in M \times \mathbb{R}^n\\).</p><p>With this understanding of tangent spaces, the exponential map can be understood more formally as an operator mapping vectors in a tangent space onto manifold.</p><p>$$</p><p>Likewise, the logarithmic map can be understood as an operator mapping points on the manifold back into a tangent space</p><p>$$</p><p>&gt;¬†üöß Ok, *technically*, more structure is needed for the existence of an exponential map. Since the exponential map minimizes distance along a path, we must have some notion of *length.* The subfield of Differential Geometry with *lengths* and *angles* is called [Riemannian Geometry](https://en.wikipedia.org/wiki/Riemannian_geometry) and is a fascinating subject in its own right. The definition of *lengths* and *angles* for a specific manifold is called the Riemannian Metric. We don‚Äôt have the space in this post to develop these ideas fully but we encourage the motivated reader to learn more!</p><p>With this understanding, we have the following prescription for optimization on a generic manifold \\(M\\)</p><p>- Compute the quantity to minimize ‚Äî perhaps using our logarithmic map \\(\text{Log}_p(q)\\)</p><p>At this point, you are probably saying</p><p>&gt; ‚ÄúWhy isn‚Äôt multi-variable optimization taught like this?‚Äù<br/></p><p>&gt; ‚ÄúI haven‚Äôt had to worry about *tangent spaces* and *exponential maps* before.‚Äù<br/></p><p>&gt; ‚ÄúAdding vectors has always *just worked* for me in the past.‚Äù<br/></p><p>Yes, BUT. The secret here is that you‚Äôve been exploiting a very special property of euclidean space: *continuous symmetry* of its tangent bundle.</p><p>## Continuous Symmetry</p><p>Some smooth manifolds exhibit a natural symmetry. By symmetry, we mean a concept that implies more than reflections or rotations of polygons taught in grade school. For instance, reflections and rotations of polygons are examples of *discrete symmetry.* However, in the study of smooth manifolds, we are interested in *continuous* *symmetry* of the Tangent Bundle. This is what makes optimization so simple in euclidean space.</p><p>To illustrate, consider the smooth manifold of real numbers of dimension \\(n\\): \\(\mathbb{R}^n\\) or Euclidean Space. We will visualize the plane \\(\mathbb{R}^2\\), but realize that these properties apply in higher dimensions, too.</p><p>Let‚Äôs place a uniform vector field on \\(\mathbb{R}^n\\), where ‚Äúthe same‚Äù vector \\(v\\) is attached to each point in the space \\(p\\). Imagine those points *flowing* along the vectors, as if the vectors describe the current of a river and the points are rafts in that river.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftPoints.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftPoints.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>You‚Äôll notice that the points before and after the flow are effectively the same! Since this flow doesn‚Äôt *fundamentally* change the total set of points, it‚Äôs called an *invariant flow.*</p><p>Now let‚Äôs flip it: instead of moving each point along the flow of individual vectors, let‚Äôs recenter the points on a new origin.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOrigin.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOrigin.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Notice that this recentering effectively produces the same transformation as the vector field above. This is one important property of continuous symmetry of the manifold: the equivalence of local transformations under *constant* vector fields and global transformations of the entire space.</p><p>We can also recenter both the vector field and its associated points. Doing so, we find that the points and vector field are fundamentally *unchanged.*</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOriginPointsVectors.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOriginPointsVectors.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Furthermore, the points and vector field don‚Äôt have to be recentered in the same direction as the vector field. Under any arbitrary translation, the points and the *constant* vector field remain unchanged*.* In this way, both the manifold and the Tangent Bundle exhibit continuous symmetry.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOriginPointsVectors2.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridShiftOriginPointsVectors2.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>So to recap, when we say *continuous symmetry* of the tangent bundle of \\(\mathbb{R}^n\\) we mean three things:</p><p>- Local flows along an invariant vector field are the same as a global translation of all points</p><p>One consequence of this continuous symmetry is that we can effectively treat *any* point in \\(\mathbb{R}^n\\) as the origin. To illustrate this, we will ‚Äúsubtract‚Äù two points \\(p\\) and \\(q\\) ¬†and get a vector pointing from \\(p\\) to \\(q\\), ¬†and then flow \\(p\\) along the vector to recover \\(q\\).</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridSubtractPoints.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridSubtractPoints.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>If we follow this animation *carefully,* we have to remember that this red vector lives in \\(T_p\mathbb{R}^n\\) and then *flow* the point starting at \\(p\\) until it reaches \\(q\\). Now, let‚Äôs first recenter the origin at \\(p\\) and then perform the subtraction.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridSubtractPointsAtOrigin.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/GridSubtractPointsAtOrigin.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>We see that this produces the *same* result, and this time the vector was ‚Äúattached to the origin.‚Äù In effect, we can do the subtraction *as if* the space was centered at \\(p\\) and then only worry about vectors living in \\(T_0 \mathbb{R}^n\\).</p><p>You probably didn‚Äôt realize it, but we‚Äôve set ourselves up for easy computation! If we use the standard basis of \\(\mathbb{R}^n\\), we simply subtract the coordinates of each point element-wise to get the vector. If we want to translate a point by a vector, we again can simply perform element-wise addition of the coordinates. The annoying book-keeping that comes with this vector distribution is effectively non-existent, because we just treat all vectors *as if* they lived in the tangent space at the origin.</p><p>In fact, since \\(T_0\mathbb{R}^n\\) is essentially just a copy of \\(\mathbb{R}^n\\), we can confuse points and vectors and likely *get away with it*. The distinction between a point and the vector that points from the origin to a point is so subtle that in practice it‚Äôs often not worth mentioning.</p><p>Using the continuous symmetry of \\(\mathbb{R}^n\\) we formulate our optimization steps as</p><p>- Compute the quantity to minimize *as if* our parameters represent the origin</p><p>With continuous symmetry in euclidean space on our side, we can use the \\(\mathbb{R}^n\\) hammer on *everything*. Recalling our [previous post](https://www.tangramvision.com/blog/camera-modeling-pinhole-obsession): consider \\(\mathbb{T}^2\\). You‚Äôll notice now that it is essentially \\(\mathbb{R}^2\\) with a couple of ‚Äúextra points at infinity.‚Äù This makes computer vision with camera rays and the pinhole camera model feel easy! We just treat \\(\mathbb{T}^2\\) ¬†as \\(\mathbb{R}^2\\) and compute reprojection error by subtracting points and minimizing that error.</p><p>## Lie Groups: *Continuing* the Symmetry Party</p><p>But, I hear you mutter to yourself,</p><p>&gt; ‚ÄúAre there manifolds that have continuous symmetry of their Tangent Bundle, but are not flat like \\(\mathbb{R}^n\\)?‚Äù<br/></p><p>Great question! The answer is yes! An example of manifolds that fit these criteria are [Lie Groups](https://en.wikipedia.org/wiki/Lie_group). A Lie Group (we‚Äôll call it \\(\mathcal{G})\\) is a [mathematical group](https://en.wikipedia.org/wiki/Group_(mathematics)) that is also a smooth manifold.</p><p>Many commonly-used manifolds in robotics are Lie Groups:</p><p>- Special Orthogonal Group \\(SO(3)\\) - used for describing rigid-body rotations</p><p>Given their wide usage, it‚Äôs worthwhile to explore what makes them so useful.</p><p>A Lie Group is a mathematical group; it‚Äôs in the name. This means it has a way to compose elements, typically denoted as \\(g \circ h\\) for group elements \\(g,h \in \mathcal{G}\\). Additionally, the group has an identity element (typically called \\(e\\)). In some fashion, this identity can be considered the ‚Äúorigin‚Äù. Since a Lie group is *also* a smooth manifold, it has a tangent space at this ‚Äúorigin.‚Äù The tangent space at the identity element is called the [Lie Algebra](https://en.wikipedia.org/wiki/Lie_algebra) and is denoted by \\(T_e \mathcal{G} = \mathfrak{g}.\\)</p><p>To help us develop some intuition of Lie Groups, we will consider the simplest non-euclidean Lie Group, the unit circle \\(\mathcal{S}^1\\) and its associated Lie Algebra. Note that unlike our visualization of \\(\mathbb{R}^n,\\) we have chosen to explicitly display a tangent space of unit circle, since it takes a different shape than the underlying manifold.</p><p>![CircleLieAlgebra_ManimCE_v0.18.1.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f8903a9b45c2d4aa6779b_CircleLieAlgebra_ManimCE_v0.18.1.png)</p><p> Now, we proceed to choose some vector in this tangent space at the identity.</p><p>![CircleVector_ManimCE_v0.18.1.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f89037c2ce14a94eb854b_CircleVector_ManimCE_v0.18.1.png)</p><p>Now, let‚Äôs try to move a point along our chosen vector.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleVectorFlowWrong.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleVectorFlowWrong.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>If we simply move the point along the vector, the point leaves the manifold! This is not a valid flow, because the points must *by definition* live on the underlying manifold. To fix this, we will define the *flow* as the curve \\(\varphi(t)\\) such that ¬†\\(\varphi&#39;(t)\\) matches the tangent vector. For a vector field \\(X\\) defined on the entire manifold, we denote this flow as \\(\varphi_X(t)\\).</p><p>However, this definition makes solving for \\(\varphi_X(t)\\) a bit tough since we have to solve an ordinary differential equation on a manifold. If we instead think of Euler integration, we can *approximate* a solution by ‚Äúmoving along‚Äù the manifold in the direction of the vector field.</p><p>In \\(\mathbb{R}^n\\), for a given vector field \\(X: \mathbb{R}^n \to T\mathbb{R}^n\\) euler integration gives us the recurrence of</p><p>$$</p><p>On the manifold we can use the exponential map to similar effect. For a given vector field \\(X: M \to TM\\) ‚Äúeuler integration‚Äù takes the form of</p><p>&lt;p&gt;$$p_k = \text{Exp}_{p_{k-1}}(X(p_{k-1})\Delta t)$$&lt;/p&gt;&lt;!-- manual html to prevent showdown changing underscores into emphasis tags before mathjax gets to it --&gt;</p><p>We can imagine this exponential map as a ‚Äúpushed down‚Äù vector on the manifold.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleVectorFlowRight.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleVectorFlowRight.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>&gt; ‚ö†Ô∏è In actuality, there is no such thing as a ‚Äúpushed down vector,‚Äù however it‚Äôs a useful concept for visualization. If we use the definition of the exponential map, we can imagine this ‚Äúpushed down vector‚Äù as the line drawn by the equation \\(\text{Exp}(\alpha v)\\) for a fixed vector \\(v\\) and a scalar \\(\alpha \in [0,1]\\).</p><p>Now following our example with \\(\mathbb{R}^2\\), let‚Äôs try to create a *constant* vector field by copying a vector into all points on the manifold. If we naively copy this vector in the same way that we did in the euclidean case (remember that big grid of arrows?), we get the following:</p><p>![CircleTangentSectionWrong_ManimCE_v0.18.1.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f89065b7a81cc793276c6_CircleTangentSectionWrong_ManimCE_v0.18.1.png)</p><p>This cannot be correct; our vectors wouldn‚Äôt live in their own respective tangent spaces. These ‚Äútangent vectors‚Äù have some component pointing normal to the manifold, which implies they are not tangent vectors at all! How do we address this mathematically?</p><p>&gt; ‚ö†Ô∏è Here we are claiming that this visualization is incorrect because we are considering the unit circle and its tangent bundle as entities *embedded* in ambient euclidean space \\(\mathbb{R}^2\\). In reality, we only care about the geometric and algebraic structure of the unit circle and our visualization is *somewhat independent* of that structure. It it not uncommon to visualize a manifold and an associated fibre bundle (e.g. the tangent bundle) as living in orthogonal spaces but connected at a single point. This explains why you sometimes may see the tangent bundle visualized as a manifold with non-overlapping tangent spaces.</p><p>&gt; ![Tangent_bundle.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f8903a9b1afcd2cb9b285_Tangent_bundle.png)</p><p>&gt; In this post, we‚Äôll continue with the embedded and overlapping view to aid intuition, but don‚Äôt be surprised if you see the tangent bundle drawn differently in other resources.</p><p>Instead of naively copying the vector at identity to every point on the lie group, let‚Äôs consider an arbitrary point \\(g \in \mathcal{G}\\). We can consider this point on the manifold as simply a point or, using the group structure, we can consider it as an operator since \\(g \circ e = g\\). In other words, \\(g\\) can be regarded as an operator that takes the identity into \\(g\\). This ‚Äúoperatorness‚Äù of \\(g\\) is typically denoted as the map</p><p>$$</p><p>where the \\(L\\) denotes that we are composing with \\(g\\) on the left. You can form a similar map by composing on the right; we‚Äôll call it \\(R_g\\).</p><p>We can use this operator concept to ‚Äúpush‚Äù vectors around on the manifold. Instead of \\(L_g\\) operating on a fixed value \\(h\\), we can imagine it operating on a curve \\(\gamma(t)\\) with \\(\gamma(0) = h\\).</p><p>Now we have a new *shifted* curve</p><p>$$</p><p>We can now consider the derivative of this new *shifted vector* as a vector living in the tangent space \\(T_{g \circ h} \mathcal{G}\\):</p><p>$$</p><p>‚Ä¶just like we did in our original vector field in \\(\mathbb{R}^n\\). For convenience of notation, we‚Äôll drop the explicit parametrization of the curves and denote this vector shift as \\(dL_g(h,v)\\) for some \\(v \in T_h \mathcal{G}.\\)</p><p>&lt;blockquote&gt;</p><p>The argument made here to derive this &lt;em&gt;vector shift&lt;/em&gt; function actually extends to arbitrary manifolds. If we have an map between manifolds</p><p>$$</p><p>that obeys the continuity properties of the manifold, we can create an induced map on the tangent bundle</p><p>$$</p><p>This induced map is often referred to as the differential or ‚Äúpush forward‚Äù map because it ‚Äúpushes‚Äù vectors in tangent spaces of one manifold onto tangent spaces of another manifold.</p><p>&lt;/blockquote&gt;</p><p>Now, we will state a few facts without proof about \\(dL_g(h,v)\\)</p><p>1. \\(dL_g(h,v)\\) ¬†is linear in \\(v\\)</p><p>Got all that? Good! Now that we have this structure in place, let‚Äôs return to our tangent vector at the origin.</p><p>![CircleVector_ManimCE_v0.18.1.png](https://cdn.prod.website-files.com/5fff85e7f613e35edb5806ed/673f89037c2ce14a94eb854b_CircleVector_ManimCE_v0.18.1.png)</p><p>This time we will copy the vector to the other points on the manifold by *pushing* the vector with \\(dL_g\\) to each \\(g\\) on the manifold.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleTangentSectionRight.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleTangentSectionRight.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>If we flow all the points on the manifold along these vectors we‚Äôll notice that all the points change in a consistent way! In the case for \\(\mathcal{S}^1\\) they are all rotating around the circle.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleTangentSectionFlow.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleTangentSectionFlow.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Here, we‚Äôve found another invariant flow field. Let‚Äôs determine if the vector field is *unchanged* under the combined transformation</p><p>$$</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleShiftVectors.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleShiftVectors.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Just like the case for \\(\mathbb{R}^n\\), the points and vector field remain *unchanged*. Furthermore, like \\(\mathbb{R}^n\\) the transformation does not have to be *in the same direction* as the vector field.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleShiftVectors2.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleShiftVectors2.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Since these vectors don‚Äôt all point in the same direction (at least from an extrinsic point of view), we cannot call this a *constant* vector field. However, the vector field is invariant to group transformations, so we will call it an *invariant* vector field.</p><p>With these observations, we can state that all Lie Groups have a *continuously symmetric* Tangent Bundle*.* The difference from the euclidean case is that points and (certain) vector fields are invariant under group *transformations* instead of *translations*.</p><p>&gt; üí°Although this difference may seem significant at first, it turns that \\(\mathbb{R}^n\\) is actually Lie Group with translation as the group operator! Would you look at that.</p><p>As an added bonus, for these *invariant* vector fields, the Euler integration using the exponential map is **exact.** Specifically, for an *invariant* vector field the following closed-form integration holds:</p><p>$$</p><p>&gt; ‚ö†Ô∏è Here in this section, we‚Äôve implied a parallel between *geodesics* on manifolds with a Riemannian Metric and the exponential map on Lie Groups. Technically, we have not defined a notion of a Riemannian Metric for Lie Groups. In this manner, it is possible to define a Riemannian Metric on Lie Groups such that the *geodesic exponential* and the *group exponential* are distinct. Regardless, broadly speaking, in both cases the exponential map helps us move along the manifold in a coherent manner.</p><p>As with Euclidean space, we can ‚Äúrecenter‚Äù the manifold by using the group operator to move \\(g\\) to the identity \\(e\\) while maintaining the distance to all other points. To do this, we simply apply the operator \\(L_{g^{-1}}\\) to all points on the manifold.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleRecenter.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleRecenter.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Likewise, we can ‚Äúsubtract‚Äù any two points \\(h\\) and \\(g\\) on the manifold by shifting the point we are subtracting to the origin and then using our aforementioned logarithm \\(\text{Log}_e(g^{-1} \circ h)\\).</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleRecenterSubtract.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/CircleRecenterSubtract.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Leveraging this *continuous symmetry* of Lie Groups, our optimization steps become</p><p>- Compute the quantity to minimize *as if* our parameters represent the origin i.e. using \\(\text{Log}_e(g^{-1} \circ h)\\)</p><p>Which makes for a pretty simple algorithm! We really only have to worry about two extra operators \\(\text{Log}_e\\) and \\(\text{Exp}_e\\). Maybe optimizing ‚Äúon the manifold‚Äù isn‚Äôt so difficult after all? Let‚Äôs apply this *continuous symmetry* concept to the unit sphere to finally cure our Pinhole Obsession.</p><p>## Symmetry of the Sphere</p><p>Back to our unit sphere! The whole reason we did this in the first place.</p><p>Ideally, we‚Äôd want the unit sphere to exhibit *continuous symmetry* of the Tangent Bundle so we can take advantage of its benefits:</p><p>- Local flow along *invariant* vector fields is the same as a global transformation</p><p>At first glance, the sphere *looks* fairly symmetric, so constructing an *invariant* vector field should be straightforward. Let‚Äôs try to find such a vector field. To start, let‚Äôs choose a vector field where all the vectors point at the north pole.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/longitude_sphere.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/longitude_sphere.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Here we notice that the points on the manifold are generally not all moving in the ‚Äúsame direction.‚Äù The points close to the north pole are converging and the points close to the south pole are diverging. This is not an invariant flow field.</p><p>Let‚Äôs again try to find an invariant flow field but this time choose the vector field where all the vectors are pointing east.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/east_sphere.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/east_sphere.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>Following the flow, the total set of points remains unchanged*.* This flow field yields a rotation of the sphere. So, the manifold itself exhibits some *continuous symmetry* because rotation leaves the set of points on the manifold unchanged.</p><p>&gt; ‚≠ê If you are wondering why these points flowing east are not moving along great circles, then you are a very astute reader! Remember, that in general using the exponential map \\(\text{Exp}_p(v)\\) to solve the flow \\(\varphi_X(t)\\) of a vector field \\(X\\) is an *approximation.* The true definition is that derivative of the flow \\(\varphi_X&#39;(t)\\) must match the vector field \\(X\\) at every point along the curve.</p><p>Does this symmetry extend to the tangent bundle \\(T\mathcal{S}^2\\)? Well, if we swap the north pole and south pole, the vector field is now pointing west! So, the vector field that produces rotations is *not* *invariant* under rotations.</p><p>&lt;video width=&#34;100%&#34; preload=&#34;metadata&#34; loop muted controls&gt;&lt;source src=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/flip_sphere.mp4&#34; type=&#34;video/mp4&#34;&gt; If this video doesn&#39;t work in browser, &lt;a href=&#34;https://tangram-vision-blog-resources.s3.us-west-1.amazonaws.com/video/flip_sphere.mp4&#34;&gt;download the video to view it&lt;/a&gt;&lt;/video&gt;</p><p>These visualizations, and the aircraft example from beginning of this post point to \\(\mathcal{S}^2\\) not having *continuous symmetry* of its Tangent Bundle. This lack of Tangent Bundle symmetry can be proven rigorously by using the [Hairy Ball theorem](https://en.wikipedia.org/wiki/Hairy_ball_theorem). Unfortunately, this means that we cannot take advantage of **all** the benefits of symmetry when optimizing over \\(\mathcal{S}^2\\). Specifically:</p><p>- There is no invariant vector field under a set of global transformations</p><p>Ultimately, optimizing over a generic asymmetric manifold is a large increase in complexity as opposed optimizing over Euclidean Space or Lie Groups. For each computation, we must perform careful book-keeping to ensure the coherence between:</p><p>- Points on the manifold: \\(p \in \mathcal{S}^2\\)</p><p>If this coherence is not maintained and properly modeled, the optimization is likely to fail. After really digging into the full complexity of optimization over a generic asymmetric manifold, Lie Groups and Euclidean Space seem even more pleasant to work with.</p><p>## ‚ÄúGrouping‚Äù it All Up</p><p>As we can see, optimization over Lie Groups (including Euclidean space) is actually a special case of optimization over a manifold. With *continuous symmetry,* we can actually ignore the effects of the starting point on the exponential operator*. Continuous symmetry* allows us to recenter the manifold on our starting point \\(g\\) (the Lie algebra) and *pretend* that we started at the origin. This is *incredibly handy* and in robotics we use this property a lot!</p><p>You‚Äôll notice that in the optimization steps For Lie Groups, we only used the exponential and logarithmic maps at one point: the identity \\(e\\). From a mathematical perspective, this is **the** defining characteristic of Lie Groups. This defining characteristic can be described as an isomorphism between</p><p>- The group itself \\(\mathcal{G}\\)</p><p>There is a number of deep mathematical connections that can be made here, and we encourage the interested reader to learn more. However, for our use-case, it means we can rewrite our exponential map as</p><p>$$</p><p>If you‚Äôve read the previously mentioned ‚ÄúMicro Lie Theory‚Äù paper, you‚Äôll recognize this as the ‚Äúcircle plus‚Äù operator i.e. \\(g \oplus v\\). With Lie Groups, there **really** is only one exponential map of concern ‚Äî the one defined at the identity. This does not hold true for general manifolds. This is why when talking about Lie Groups **the** exponential \\(\text{Exp}\\) map will be described instead of mentioning exponential maps at each point.</p><p>So, when using Lie Groups for optimization, we can ignore the specifics about ‚Äúwhich tangent space‚Äù we‚Äôre in. We operate either on the group \\(\mathcal{G}\\), or in the [Lie Algebra](https://en.wikipedia.org/wiki/Lie_algebra) \\(\mathfrak{g}\\). To recall our tools analogy, In the land of Lie Groups, we have two tools to master: a hammer \\(\mathcal{G}\\) ¬†and‚Ä¶ screwdriver \\(\mathfrak{g}\\).</p><p>---</p><p>Did you have fun? We sure did. Thanks for going on this deep dive into Differential Geometry and its implications for optimization problems in robotics. Everyone loves Lie groups, no doubt about it.</p><p>Of course, if you‚Äôre experiencing these concerns in your day-to-day development, it‚Äôs probably time you considered working with the Tangram team. We‚Äôve solved these problems so many different ways, on twice as many platforms. It‚Äôs our specialty! All this cool math in an easy-to-use package that can shorten your time to market; what‚Äôs not to love?</p><p>‚Äç</p></div></div>
  </body>
</html>
