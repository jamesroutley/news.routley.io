<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bitsight.com/blog/crowdstrike-timeline-mystery">Original</a>
    <h1>Something is strange with CrowdStrike timeline</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
    <div>
        <div>
    
    
          


  

<div class="block-content block-content--type-text block-content--29776 block-content--view-mode-full container">

  
  

          
  
      <div>
      
            <div>
                          <h2>The big outage</h2>

<p>As we are all very aware, being a technical person or layman, the <a href="https://www.bitsight.com/blog/crowdstrike-outage-short-term-actions-and-strategic-priorities-future">recent CrowdStrike outage</a> caused disruptions on a myriad of systems worldwide, affecting multiple industry sectors and millions of people in some way, shape, or format. </p>

<p>On July 19, 2024, as a result of a faulty update to CrowdStrike Falcon sensor configuration for Windows systems, intended to enhance security by targeting newly observed malicious activities, there was an inadvertent logic error that led to widespread system crashes and blue screens of death (BSOD) on affected machines. </p>

<p>Bitsight estimates that this chain of events immediately impacted and led to a significant drop in the number of systems and organizations that connected to CrowdStrike Falcon servers—between 15% and 20%. </p>

<p>Throughout this article, we will dive into our observations around the fatidical date and the strange patterns we observed just days before the big outage happened.</p>

<p>According to CrowdStrike and other sources, the timeline of events was as follows:</p>

<p><strong>July 19, 2024, 04:09 UTC</strong>: CrowdStrike released a sensor configuration update, Channel File 291, to Windows systems as part of their ongoing operations. This update triggered a logic error that caused system crashes on impacted machines​.</p>

<p><strong>July 19, 2024, 05:27 UTC</strong>: CrowdStrike identified the issue and reverted the changes, but by then, many systems had already been affected. The update impacted Windows 10 and later versions, but did not affect Mac and Linux systems, which also happen to have an inherently different kernel architecture.</p>

<p><em><strong>Immediate Impact</strong></em>: The faulty update caused significant disruptions globally. Approximately <a href="https://blogs.microsoft.com/blog/2024/07/20/helping-our-customers-through-the-crowdstrike-outage/">8.5 million devices were affected</a>, leading to outages in various sectors, including airlines, healthcare, and financial institutions. Notably, 5,078 flights were canceled worldwide, and operations at numerous airports were disrupted​. Delta Airlines is still struggling to return to normal operation as of July 23.</p>

<p><strong>July 19-22, 2024</strong>: CrowdStrike and Microsoft worked together to provide remediation steps. Affected machines required manual intervention to delete the faulty .sys file from the CrowdStrike directory. This process involved booting into Safe Mode or the Windows Recovery Environment, making recovery a time-consuming task for large organizations​. There are reports that cloud remediation is possible, but users must opt-in by submitting a request via the support portal and requesting to be included in cloud remediation and then rebooting.</p>

<p>This is the official timeline for this event. Bitsight is always monitoring all sorts of security-related events and, although this was not exactly a new vulnerability or anything of the sort, we wondered if we might have some visibility into what was happening.</p>

<p>So Bitsight TRACE got to work and got creative on ways we could measure the impact of this outage, what could we share about it, and how we could help our customers in any way, if possible.</p>

<h2>The where and what</h2>

<p>If you know Bitsight, you know we have an extraordinary amount of diverse datasets and capabilities. We use them to measure all kinds of security-related events that go on to comprise our rating. But that’s not all, we also use our capabilities in Bitsight TRACE for extensive research, on many different topics, like doing <a href="https://www.bitsight.com/blog/slicing-through-cisas-kev-catalog">KEV analysis</a> or helping our customers understand how the <a href="https://www.bitsight.com/blog/impact-kaspersky-ban">Kaspersky ban impacts</a> them or <a href="https://www.bitsight.com/blog/latrodectus-are-you-coming-back">analyzing latest malware</a> at Internet wide scale.</p>

<p>Needless to say, we started looking into this latest incident too and our findings were curious, at least.</p>

<p>CrowdStrike publishes the Cloud IP Addresses and the fully qualified domain names (FQDNs) that allow the Falcon sensor software to communicate with the CrowdStrike cloud for everyday operation. This allows system administrators to properly set up their firewall/IDS and add these FQDNs and/or IP addresses to allow for network communications.</p>

<p>By looking into traffic samples to and from these IP addresses, we can have some visibility on the recent incident, as well as map those IPs to organizations and have an indication of who uses CrowdStrike Falcon products and who was affected by the outage. Of course, there are some caveats such as collection bias, packet loss, and other issues that affect our visibility, but we consider our sample large enough to draw some conclusions.</p>

<h2>The dataset</h2>

<p>The dataset for our analysis has a time period between the 29th of June and 22nd of July, 2024. The mentioned time period (~3 weeks), for the reader to understand what we call large enough, has the following overall counts:</p>

<p><mark>Total number of contacts: 791.766.880</mark></p>

<p>With almost a billion IP contacts to the CrowdStrike Falcon servers and 600 thousand unique IP addresses to process, it was time to crunch the numbers and see what we could see.</p>

<h2>The observations</h2>

<h3>Daily new IPs</h3>

<p>The amount of newly unique IPs detected each day that contacted CrowdStrike Falcon servers drops very fast, suggesting that increasing the time period won’t yield a significant increase in visibility and we have reached a good compromise for our sample.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/New%20IPs%20per%20day.png" width="900" height="400" alt="Crowdstrike new ips per day" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>It also seems to confirm the frequent update requests that the Falcon agent issues, which makes complete sense for the type of cutting-edge software it is. Any decent anti-virus or equivalent solution must have their malware signatures up to date as frequently as possible if they want to stand a chance in this game.</p>

<h3>Packets and bytes</h3>

<p>We have an interesting number of unique IPs, let’s look into the packet count and amount of bytes exchanged between them and the CrowdStrike servers. That will help us understand the communication patterns and any outliers that might be seen.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/Total%20packets%20per%20hour.png" width="900" height="300" alt="Crowdstrike Total packets per hour" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>The hourly packet count floats around ~60M on weekdays and ~30M on weekends for most days, but we can easily see a spike around July 16th.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/Total%20bytes%20per%20hour.png" width="900" height="300" alt="crowdstrike Total bytes per hour" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>We can also observe that a peek in total bytes occurred at the exact same period, on Jul 16, 2024, at around 22:00 UTC. There might be several explanations as to why this has happened and, at this moment, we can only speculate. It is likely that this traffic spike might be related to an update that fixed a bug, which led to high CPU consumption on Windows hosts, <a href="https://www.thestack.technology/crowdstrike-bug-maxes-out-100-of-cpu-requires-windows-reboots/">as reported by The Stack</a>.</p>

<h3>Unique IPs</h3>

<p>When we plot the number of unique IPs per minute, we can see the weekly/weekend pattern. If we notice carefully, at around 22:00 on the 16th (the first green dashed line, left to right), a sharp spike appears. After that spike, there was a significant decrease in the maximum number of IPs per minute compared to the previous day&#39;s (and weekday) pattern.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/Unique%20IPs%20hourly%20avergae.png" width="930" height="465" alt="Crowdstrike Unique IPs hourly average" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>Two days and some hours after that, in the chaotic dawn of the 19th, between around 4am and 5am, there was an upward spike ( typical around that time), followed by the unexpected drop shortly after (second dashed green line, left to right).</p>

<p><strong>zoomed in chart:</strong></p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/Unique%20IPs%20per%20minute%20time%20of%20day.png" width="930" height="538" alt="crowdstrike Unique IPs per minute time of day" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>After these events, there was a significant decrease in the maximum amount of IPs per minute this past weekend. In particular, the maximum number of unique IPs per minute (on average) did not reach the minimum number of unique IPs on the previous weekends.</p>

<p>If we overlap each day onto a chart, the difference is more visible. Below, marked blue, are all weekdays up to the 16th. The 17th and 18th are marked orange, and the 19th is green.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/unique%20IPs%20per%20minute%20weekdays.png" width="930" height="465" alt="Crowdstrike unique IPs per minute weekdays" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>Looking at this past weekend and comparing it to the previous three weekends, a similar drop in the unique IPs per minute can be observed.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/unique%20IPs%20per%20minute_0.png" width="930" height="465" alt="crowdstrike unique IPs per minute weekends" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>Furthermore, when comparing the number of organizations we can observe (we monitored more than 3500 organizations in this sample), there was a similar drop.</p>

<article><p><img src="https://www.bitsight.com/sites/default/files/2024/07/23/unique%20orgs%20per%20hour.png" width="900" height="300" alt="crowdstrike unique orgs per hour" loading="lazy" typeof="foaf:Image"/></p>
      
  </article><p>Looking at all the telemetry, two observations emerge very quickly. First, there is a drop in traffic that started on July 16th, three days before the update in question was rolled out, and second, on July 19th, CrowdStrike servers globally had another decrease in traffic, likely due to the faulty update that took millions of machines offline.</p>

<h2>Conclusions</h2>

<p>As Bitsight continues to investigate the traffic patterns exhibited by CrowdStrike machines across organizations globally, two distinct points emerge as “interesting” from a data perspective. Firstly, on July 16th at around 22:00 there was a huge traffic spike, followed by a clear and significant drop off in egress traffic from organizations to CrowdStrike. Second, there was a significant drop, between 15% and 20%, in the number of unique IPs and organizations connected to CrowdStrike Falcon servers, after the dawn of the 19th. </p>

<p>While we can not infer what the root cause of the change in traffic patterns on the 16th can be attributed to, it does warrant the foundational question of “Is there any correlation between the observations on the 16th and the outage on the 19th?”. As more details from the event emerge, Bitsight will continue investigating the data. </p>

<p>Organizations globally continue to become hyper-digitized and reliant on external software for day-to-day operations, and, as such it has become increasingly important that both the organization itself and the software vendors that the organization relies on for day-to-day operations practice proper technology hygiene exhibited in the form of staged updates, phased rolls outs, proper back-ups and well-organized plans for operational disruptions. </p>

<p>As system administrators rush to fix their servers, our thoughts cannot help but to be with them. We honestly hope everyone recovers fairly quickly from this incident, lessons are learned and processes are adjusted accordingly.</p>

              </div>
      
    </div>
  </div>

      </div>

    </div>
  </div>

  </div></div>
  </body>
</html>
