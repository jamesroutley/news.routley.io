<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tedpiotrowski.svbtle.com/using-lidar-for-tree-shadows-in-shademap">Original</a>
    <h1>Using Lidar to map tree shadows</h1>
    
    <div id="readability-page-1" class="page"><section id="container">
  <article id="g3etMHMMG3awSk8PHwraSc">
	<time datetime="2023-07-09">July  9, 2023</time>
  
	<p><strong>tl;dr;</strong> <em>I can load LiDAR data to simulate tree shadows for any time of year, but the hardware demands and hosting costs may be prohibitive so I’m only sharing a small <a href="https://pub-2f76d53a7bba403bbf5ca35a8bf7e094.r2.dev/leaflet.html">demo</a> for now</em></p>

<p>Two years ago, I launched shademap.app, and since then, a common question I receive is: “Where are the trees?” It’s a valid inquiry, considering I reside in the Pacific Northwest—a region known for its towering trees that significantly affect the amount of direct sunlight a location receives.</p>

<p>Here are two renderings of the shadows on Bainbridge Island for July 9th at 7:09 AM. Radar clearly misses 90% of the shadows cast because it does not include vegetation. Radar only reflects off the ground, making objects such as trees and buildings invisible. On the other hand, LiDAR reflects off all objects, creating a much richer model of the earth’s surface.</p>

<p><a href="https://svbtleusercontent.com/bY4zNi97cMS6orbwoJmDKg0xspap.jpg"><img src="https://svbtleusercontent.com/bY4zNi97cMS6orbwoJmDKg0xspap_small.jpg" alt="Radar vs LiDAR shadow simulation"/></a></p>

<p>So why hasn’t ShadeMap included trees from the beginning? It’s because ShadeMap uses elevation data to simulate shadows and the only readily available world-wide elevation data sets come from <a href="https://en.wikipedia.org/wiki/Shuttle_Radar_Topography_Mission">radar</a>. Radar works at night time and penetrates clouds, so satellites are able to compile this data 24 hours per day from space.</p>

<p>LiDAR, on the other hand, is much more accurate but is collected from airplanes or drones and cannot penetrate fog and clouds. It’s much more time consuming and expensive to collect, leaving each local government to fund its surveying costs. However, I recently discovered that my state of Washington provides an extensive <a href="https://lidarportal.dnr.wa.gov/">LiDAR dataset</a> that covers large amounts of the state.</p>

<p><a href="https://svbtleusercontent.com/tF4Je2rM5W8N1eLXgDmybA0xspap.jpg"><img src="https://svbtleusercontent.com/tF4Je2rM5W8N1eLXgDmybA0xspap_small.jpg" alt="WA LiDAR portal"/></a></p>

<p>I could finally fill in the gaps in my shadow simulation-for my own backyard, at least. But there was one problem. The data format was geared towards traditional GIS software (it’s a GeoTIFF) and not browser friends (like a JPG or PNG). In order to use the data, I would have to take 100’s of gigabytes of floating point, imperial feet, GeoTIFF files and slice them up into small fast-loading image tiles where metric meters are encoded as red, green and blue pixel values.</p>

<p>I bought a 1TB hard drive and started asking ChatGPT questions on how to convert the data. (ChatGPT is a marvelous assistant and has saved me hours of reading documentation and irrelevant Google search results) Once, I started to run the conversion process, I realized that my 16GB of RAM could not load these large data files and I had to rewrite the conversion code to just work with a small region of the map at a time. For the first time in a long time, I’m feeling the need for a more powerful machine…</p>

<p>And it works. Or actually…it’s working right now. I’m attempting to convert just the Seattle metropolitan area and it’s only about half way done after 12 hours. The tiles are over 15GB and growing. The simulations are incredible, but I’m not sure I want to sink money into hosting this data and making it publicly available. It’s a shame but it’s the sound financial decision for now.</p>

<p><a href="https://svbtleusercontent.com/pd7efcJtXN5f8vho7JVP9y0xspap.gif"><img src="https://svbtleusercontent.com/pd7efcJtXN5f8vho7JVP9y0xspap_small.gif" alt="LiDAR shadow simulation"/></a></p>

<p>However, I can host small portions of this dataset for free so if you’re curious what my long-term vision for ShadeMap is, try this <a href="https://pub-2f76d53a7bba403bbf5ca35a8bf7e094.r2.dev/leaflet.html">demo</a></p>

<p>As always, follow me on <a href="https://twitter.com/shademap">Twitter</a> for frequent updates on this project or if you want to get in touch.</p>

  <figure id="kudo_g3etMHMMG3awSk8PHwraSc">
    <a href="#kudo">
      
    </a>
    <p>298</p>
    <p>Kudos</p>
  </figure>
  <figure id="kudo_side_g3etMHMMG3awSk8PHwraSc">
    <a href="#kudo">
      
    </a>
    <p>298</p>
    <p>Kudos</p>
  </figure>
</article>

</section></div>
  </body>
</html>
