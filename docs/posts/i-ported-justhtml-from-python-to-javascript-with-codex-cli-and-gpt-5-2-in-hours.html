<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simonwillison.net/2025/Dec/15/porting-justhtml/">Original</a>
    <h1>I ported JustHTML from Python to JavaScript with Codex CLI and GPT-5.2 in hours</h1>
    
    <div id="readability-page-1" class="page"><div>


<div data-permalink-context="/2025/Dec/15/porting-justhtml/">

<p>15th December 2025</p>



<p>I <a href="https://simonwillison.net/2025/Dec/14/justhtml/">wrote about JustHTML yesterday</a>—Emil Stenström’s project to build a new standards compliant HTML5 parser in pure Python code using coding agents running against the comprehensive html5lib-tests testing library. Last night, purely out of curiosity, I decided to try <strong>porting JustHTML from Python to JavaScript</strong> with the least amount of effort possible, using Codex CLI and GPT-5.2. It worked beyond my expectations.</p>
<h4 id="tl-dr">TL;DR</h4>
<p>I built <a href="https://github.com/simonw/justjshtml">simonw/justjshtml</a>, a dependency-free HTML5 parsing library in JavaScript which passes 9,200 tests from the html5lib-tests suite and imitates the API design of Emil’s JustHTML library.</p>
<p>It took two initial prompts and a few tiny follow-ups. <a href="https://simonwillison.net/2025/Dec/11/gpt-52/">GPT-5.2</a> running in <a href="https://github.com/openai/codex">Codex CLI</a> ran uninterrupted for several hours, burned through 1,464,295 input tokens, 97,122,176 cached input tokens and 625,563 output tokens and ended up producing 9,000 lines of fully tested JavaScript across 43 commits.</p>
<p>Time elapsed from project idea to finished library: about 4 hours, during which I also bought and decorated a Christmas tree with family and watched the latest Knives Out movie.</p>
<h4 id="some-background">Some background</h4>
<p>One of the most important contributions of the HTML5 specification ten years ago was the way it precisely specified how <em>invalid</em> HTML should be parsed. The world is full of invalid documents and having a specification that covers those means browsers can treat them in the same way—there’s no more “undefined behavior” to worry about when building parsing software.</p>
<p>Unsurprisingly, those invalid parsing rules are pretty complex! The free online book <a href="https://htmlparser.info/">Idiosyncrasies of the HTML parser</a> by Simon Pieters is an excellent deep dive into this topic, in particular <a href="https://htmlparser.info/parser/">Chapter 3. The HTML parser</a>.</p>
<p>The Python <a href="https://github.com/html5lib/html5lib-python">html5lib</a> project started the <a href="https://github.com/html5lib/html5lib-tests">html5lib-tests</a> repository with a set of implementation-independent tests. These have since become the gold standard for interoperability testing of HTML5 parsers, and are used by projects such as <a href="https://github.com/servo/servo">Servo</a> which used them to help build <a href="https://github.com/servo/html5ever">html5ever</a>, a “high-performance browser-grade HTML5 parser” written in Rust.</p>
<p>Emil Stenström’s <a href="https://github.com/EmilStenstrom/justhtml">JustHTML</a> project is a pure-Python implementation of an HTML5 parser that passes the full html5lib-tests suite. Emil <a href="https://friendlybit.com/python/writing-justhtml-with-coding-agents/">spent a couple of months</a> working on this as a side project, deliberately picking a problem with a comprehensive existing test suite to see how far he could get with coding agents.</p>
<p>At one point he had the agents rewrite it based on a close inspection of the Rust html5ever library. I don’t know how much of this was direct translation versus inspiration (here’s Emil’s <a href="https://news.ycombinator.com/item?id=46264195#46267059">commentary on that</a>)—his project has 1,215 commits total so it appears to have included a huge amount of iteration, not just a straight port.</p>
<p>My project <strong>is</strong> a straight port. I instructed Codex CLI to build a JavaScript version of Emil’s Python code.</p>
<h4 id="the-process-in-detail">The process in detail</h4>
<p>I started with a bit of mise en place. I checked out two repos and created an empty third directory for the new project:</p>
<div><pre><span>cd</span> <span>~</span>/dev
git clone https://github.com/EmilStenstrom/justhtml
git clone https://github.com/html5lib/html5lib-tests
mkdir justjshtml
<span>cd</span> justjshtml</pre></div>
<p>Then I started Codex CLI for GPT-5.2 like this:</p>

<p>That <code>--yolo</code> flag is a shortcut for <code>--dangerously-bypass-approvals-and-sandbox</code>, which is every bit as dangerous as it sounds.</p>
<p>My first prompt told Codex to inspect the existing code and use it to build a specification for the new JavaScript library:</p>
<blockquote>
<p><code>We are going to create a JavaScript port of ~/dev/justhtml - an HTML parsing library that passes the full ~/dev/html5lib-tests test suite. It is going to have a similar API to the Python library but in JavaScript. It will have no dependencies other than raw JavaScript, hence it will work great in the browser and node.js and other environments. Start by reading ~/dev/justhtml and designing the user-facing API for the new library - create a spec.md containing your plan.</code></p>
</blockquote>
<p>I reviewed the spec, which included a set of proposed milestones, and told it to add another:</p>
<blockquote>
<p><code>Add an early step to the roadmap that involves an initial version that parses a simple example document that is valid and returns the right results. Then add and commit the spec.md file.</code></p>
</blockquote>
<p>Here’s <a href="https://github.com/simonw/justjshtml/blob/19b8eb1f2ca80f428a3c40862d5ec05d36e5166b/spec.md">the resulting spec.md file</a>. My request for that initial version became “Milestone 0.5” which looked like this:</p>
<blockquote>
<p><strong>Milestone 0.5 — End-to-end smoke parse (single valid document)</strong></p>
<ul>
<li>Implement the smallest end-to-end slice so the public API is real early:
<ul>
<li>
<code>new JustHTML(&#34;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&#34;)</code> returns a tree with the expected tag structure and text nodes.</li>
<li>
<code>doc.toText()</code> returns <code>&#34;Hello&#34;</code> and <code>doc.errors</code> is empty for this valid input.</li>
</ul>
</li>
<li>Add <code>scripts/smoke.js</code> (no deps) that runs the example and asserts the expected structure/output.</li>
<li>Gate: <code>node scripts/smoke.js</code> passes.</li>
</ul>
</blockquote>
<p>Then I told it:</p>
<blockquote>
<p><code>Implement Milestone 0.5</code></p>
</blockquote>
<p>And off it went. The resulting code appeared to work so I said:</p>
<blockquote>
<p><code>Configure GitHub Actions test.yml to run that on every commit, then commit and push</code></p>
</blockquote>
<p>I ran <code>git init</code> and created a private GitHub repository for this project at this point, and set up the local directory to push to that remote.</p>
<p>Here’s <a href="https://github.com/simonw/justjshtml/commit/48497cbd05584c88af757a0736a2ee447468b6b3">that initial push</a>. Then I told it:</p>
<blockquote>
<p><code>OK do the rest, commit and push often</code></p>
</blockquote>
<p>And that was almost it!</p>
<p>I set my laptop to not fall asleep and left it to its devices while we went off to buy a Christmas tree. The “commit and push often” meant I could monitor its progress on my phone by refreshing <a href="https://github.com/simonw/justjshtml/commits/main">the commit log on GitHub</a>.</p>
<p>I was running this against my $20/month ChatGPT Plus account, which has a five hour token allowance window for Codex CLI. That ran out at 6:35pm and Codex paused, so I waited until the reset point at 7:14pm and typed:</p>
<blockquote>
<p><code>Keep going</code></p>
</blockquote>
<p>At 9:30pm it declared itself done with the following summary message:</p>
<pre><code>• What’s Done

  - html5lib-tests now run in CI and pass: tokenizer 6810/6810, tree 1770/1782
    (12 skipped: #script-on), serializer 230/230, encoding 82/83 (1 skipped:
    scripted) (.github/workflows/test.yml:1).
  - Public API expanded: stream() (src/stream.js:1), CSS selectors query()/
    matches() (src/selector.js:1), and toMarkdown() (src/markdown.js:1), all
    exported via src/index.js:1.
  - Added no-deps unit scripts for selectors/stream/markdown (scripts/run-
    selector-tests.js:1, scripts/run-stream-tests.js:1, scripts/run-markdown-
    tests.js:1) and wired them into CI.
  - Fixed TreeBuilder so &lt;br&gt; no longer closes &lt;p&gt; (src/treebuilder.js:647).
</code></pre>
<p>As a finishing touch, I had it add a playground interface so I could try out the new library in my browser. I prompted:</p>
<blockquote>
<p><code>Add a playground.html in the top level folder which loads the necessary ES modules from ./src/... and implements the exact same functionality as seen on https://tools.simonwillison.net/justhtml but using the JavaScript library instead of Pyodide</code></p>
</blockquote>
<p>It fetched my <a href="https://tools.simonwillison.net/justhtml">existing JustHTML playground page</a> (<a href="https://simonwillison.net/2025/Dec/14/justhtml/#first-impressions-of-justhtml">described here</a>) using <code>curl</code> and built a new <code>playground.html</code> file that loaded the new JavaScript code instead. This worked <em>perfectly</em>.</p>

<p>I enabled GitHub Pages for my still-private repo which meant I could access the new playground at this URL:</p>
<p><a href="https://simonw.github.io/justjshtml/playground.html">https://simonw.github.io/justjshtml/playground.html</a></p>
<p><img src="https://static.simonwillison.net/static/2025/justjshtml-playground.jpg" alt="Screenshot of JustJSHTML Playground web application. Header reads &#34;JustJSHTML Playground&#34; with subtitle &#34;A dependency-free JavaScript HTML5 parser - GitHub&#34;. Below is a status bar showing &#34;JavaScript Environment&#34; with a green &#34;Ready&#34; badge. The main input area has &#34;Paste HTML&#34; and &#34;Fetch from URL&#34; buttons, with a text area containing HTML code: &#34;&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Example Page&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;header&gt; &lt;nav&gt; &lt;ul&gt;&#34;. A &#34;Playground Mode&#34; section shows buttons for &#34;CSS Selector Query&#34;, &#34;Pretty Print HTML&#34;, &#34;Tree Structure&#34;, &#34;Stream Events&#34;, &#34;Extract Text&#34;, and &#34;To Markdown&#34; (highlighted in purple). Below is a text field labeled &#34;CSS Selector (optional - leave empty for whole document):&#34; with placeholder &#34;e.g., article, main, .content (or leave empty)&#34; and a green &#34;Convert to Markdown&#34; button. The Output section has a teal header with &#34;Whole document&#34; badge and displays converted markdown: &#34;Example Page&#34; followed by &#34;- [Home](/)&#34; &#34;- [About](/about)&#34; &#34;- [Contact](/contact)&#34;."/></p>
<p>All it needed now was some documentation:</p>
<blockquote>
<p><code>Add a comprehensive README with full usage instructions including attribution plus how this was built plus how to use in in HTML plus how to use it in Node.js</code></p>
</blockquote>
<p>You can <a href="https://github.com/simonw/justjshtml/blob/f3a33fdb29bf97846fd017185edc8cf82783032e/README.md">read the result here</a>.</p>
<p>We are now at eight prompts total, running for just over four hours and I’ve decorated for Christmas and watched <a href="https://en.wikipedia.org/wiki/Wake_Up_Dead_Man">Wake Up Dead Man</a> on Netflix.</p>
<p>According to Codex CLI:</p>
<blockquote>
<p><code>Token usage: total=2,089,858 input=1,464,295 (+ 97,122,176 cached) output=625,563 (reasoning 437,010)</code></p>
</blockquote>
<p>My <a href="https://www.llm-prices.com/#it=2089858&amp;cit=97122176&amp;ot=625563&amp;sel=gpt-5.2">llm-prices.com calculator</a> estimates that at $29.41 if I was paying for those tokens at API prices, but they were included in my $20/month ChatGPT Plus subscription so the actual extra cost to me was zero.</p>
<h4 id="what-can-we-learn-from-this-">What can we learn from this?</h4>
<p>I’m sharing this project because I think it demonstrates a bunch of interesting things about the state of LLMs in December 2025.</p>
<ul>
<li>Frontier LLMs really can perform complex, multi-hour tasks with hundreds of tool calls and minimal supervision. I used GPT-5.2 for this but I have no reason to believe that Claude Opus 4.5 or Gemini 3 Pro would not be able to achieve the same thing—the only reason I haven’t tried is that I don’t want to burn another 4 hours of time and several million tokens on more runs.</li>
<li>If you can reduce a problem to a robust test suite you can set a coding agent loop loose on it with a high degree of confidence that it will eventually succeed. I called this <a href="https://simonwillison.net/2025/Sep/30/designing-agentic-loops/">designing the agentic loop</a> a few months ago. I think it’s the key skill to unlocking the potential of LLMs for complex tasks.</li>
<li>Porting entire open source libraries from one language to another via a coding agent works extremely well.</li>
<li>Code is so cheap it’s practically free. Code that <em>works</em> continues to carry a cost, but that cost has plummeted now that coding agents can check their work as they go.</li>
<li>We haven’t even <em>begun</em> to unpack the etiquette and ethics around this style of development. Is it responsible and appropriate to churn out a direct port of a library like this in a few hours while watching a movie? What would it take for code built like this to be trusted in production?</li>
</ul>
<p>I’ll end with some open questions:</p>

<ul>
<li>Does this library represent a legal violation of copyright of either the Rust library or the Python one?</li>
<li>Even if this is legal, is it ethical to build a library in this way?</li>
<li>Does this format of development hurt the open source ecosystem?</li>
<li>Can I even assert copyright over this, given how much of the work was produced by the LLM?</li>
<li>Is it responsible to publish software libraries built in this way?</li>
<li>How much better would this library be if an expert team hand crafted it over the course of several months?</li>
</ul>


</div>



</div></div>
  </body>
</html>
