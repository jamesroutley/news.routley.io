<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.nvidia.com/blog/nvidia-transitions-fully-towards-open-source-gpu-kernel-modules/">Original</a>
    <h1>NVIDIA Transitions Fully Towards Open-Source Linux GPU Kernel Modules</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>With the R515 driver, NVIDIA released a set of <a href="https://developer.nvidia.com/blog/nvidia-releases-open-source-gpu-kernel-modules/" data-wpel-link="internal" target="_self" rel="noopener noreferrer">Linux GPU kernel</a> modules in May 2022 as open source with dual GPL and MIT licensing. The initial release targeted datacenter compute GPUs, with GeForce and Workstation GPUs in an alpha state. </p>



<p>At the time, we announced that more robust and fully-featured GeForce and Workstation Linux support would follow in subsequent releases and the NVIDIA Open Kernel Modules would eventually supplant the closed-source driver. </p>



<p>NVIDIA GPUs share a common driver architecture and capability set. The same driver for your desktop or laptop runs the world’s most advanced AI workloads in the cloud. It’s been incredibly important to us that we get it just right. </p>



<p>Two years on, we’ve achieved equivalent or better application performance with our open-source GPU kernel modules and added substantial new capabilities:</p>



<ul>
<li>Heterogeneous memory management (HMM) support</li>



<li>Confidential computing</li>



<li>The coherent memory architectures of our Grace platforms</li>



<li>And more</li>
</ul>



<p>We’re now at a point where transitioning fully to the open-source GPU kernel modules is the right move, and we’re making that change in the upcoming R560 driver release.</p>



<h2 id="supported_gpus">Supported GPUs<a href="#supported_gpus"><i></i></a></h2>



<p>Not every GPU is compatible with the open-source GPU kernel modules.</p>



<p>For cutting-edge platforms such as NVIDIA Grace Hopper or NVIDIA Blackwell, you must use the open-source GPU kernel modules. The proprietary drivers are unsupported on these platforms.</p>



<p>For newer GPUs from the Turing, Ampere, Ada Lovelace, or Hopper architectures, NVIDIA recommends switching to the open-source GPU kernel modules.</p>



<p>For older GPUs from the Maxwell, Pascal, or Volta architectures, the open-source GPU kernel modules are not compatible with your platform. Continue to use the NVIDIA proprietary driver.</p>



<p>For mixed deployments with older and newer GPUs in the same system, continue to use the proprietary driver.</p>



<p>If you are not sure, NVIDIA provides a new detection helper script to help guide you on which driver to pick. For more information, see the <strong>Using the installation helper script</strong> section later in this post.</p>



<h2 id="installer_changes">Installer changes<a href="#installer_changes"><i></i></a></h2>



<p>In general, the default version of the driver installed by all installation methods is switching from the proprietary driver to the open-source driver. There are a few specific scenarios that deserve special attention:</p>



<ul>
<li>Package managers with the CUDA metapackage</li>



<li>Runfile</li>



<li>Installation helper script</li>



<li>Package manager details</li>



<li>Windows Subsystem for Linux</li>



<li>CUDA Toolkit</li>
</ul>



<h3 id="using_package_managers_with_the_cuda_metapackage">Using package managers with the CUDA metapackage<a href="#using_package_managers_with_the_cuda_metapackage"><i></i></a></h3>



<p>When you are installing CUDA Toolkit using a package manager (not the .run file), installation metapackages exist and are commonly used. By installing a top-level <code>cuda</code> package, you install a combination of CUDA Toolkit and the associated driver release. For example, by installing cuda during the CUDA 12.5 release time frame, you get the proprietary NVIDIA driver 555 along with CUDA Toolkit 12.5. </p>



<p>Figure 1 shows this package structure.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" width="624" height="201" src="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6.png" alt="Diagram shows the flow of installing CUDA software that includes installing both the nvidia-driver-555 and cuda-toolkit-12.5 modules." srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6.png 624w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-300x97.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-179x58.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-500x161.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-160x52.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-362x117.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-before-12-6-341x110.png 341w" sizes="(max-width: 624px) 100vw, 624px"/></a><figcaption><em>Figure 1. CUDA packages before CUDA Toolkit 12.6</em></figcaption></figure></div>


<p>Previously, using the open-source GPU kernel modules would mean that you could use the top-level metapackage. You would have had to install the distro-specific NVIDIA driver open package along with the cuda-toolkit-X-Y package of your choice.</p>



<p>Beginning with the CUDA 12.6 release, the flow effectively switches places (Figure 2).</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" width="624" height="202" src="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6.png" alt="Diagram shows the revised flow of installing CUDA software, where the nvidia-driver-open-560 and cuda-toolkit-12.6 modules are installed instead." srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6.png 624w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-300x97.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-179x58.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-500x162.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-160x52.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-362x117.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/cuda-package-installation-after-12-6-340x110.png 340w" sizes="(max-width: 624px) 100vw, 624px"/></a><figcaption><em>Figure 2. CUDA packages after the CUDA Toolkit 12.6 release</em></figcaption></figure></div>


<h3 id="using_the_runfile">Using the runfile<a href="#using_the_runfile"><i></i></a></h3>



<p>If you install CUDA or the NVIDIA drivers using the <code>.run</code> file, the installer queries your hardware and automatically installs the best-fit driver for your system. UI toggles are also available to select between the proprietary driver and the open source driver, as you choose.</p>



<p>If you’re installing through the CUDA .run file and using the <code>ncurses</code> user interface, you now see a menu similar to the following:</p>


<div><pre title="">┌──────────────────────────────────────────────────────────────────────────────┐
│ CUDA Driver                                                                  │
│   [ ] Do not install any of the OpenGL-related driver files                  │
│   [ ] Do not install the nvidia-drm kernel module                            │
│   [ ] Update the system X config file to use the NVIDIA X driver             │
│ - [X] Override kernel module type                                            │
│      [X] proprietary                                                         │
│      [ ] open                                                                │
│   Change directory containing the kernel source files                        │
│   Change kernel object output directory                                      │
│   Done                                                                       │
│                                                                              │
│                                                                              │
│                                                                              │
│ Up/Down: Move | Left/Right: Expand | &#39;Enter&#39;: Select | &#39;A&#39;: Advanced options │
└──────────────────────────────────────────────────────────────────────────────┘

</pre></div>


<p>If you’re installing through the driver .run file, you see a similar choice presented (Figure 3).</p>


<div>
<figure><img loading="lazy" decoding="async" width="937" height="417" src="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection.png" alt="Screenshot shows the user interface highlighting two buttons labeled NVIDIA Proprietary and MIT/GPL, respectively. It suggests the user choose the MIT/GPL button to install the correct kernel module type." srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection.png 937w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-300x134.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-625x278.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-179x80.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-768x342.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-645x287.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-500x223.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-160x71.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-362x161.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2024/07/runfile-interactive-selection-247x110.png 247w" sizes="(max-width: 937px) 100vw, 937px"/><figcaption><em>Figure 3. New runfile interactive selection (driver installer)</em></figcaption></figure></div>


<p>You can also pass overrides using the command line to install without the user interface or if you are using automation tools such as Ansible.</p>


<div><pre title=""># sh ./cuda_12.6.0_560.22_linux.run --override --kernel-module-type=proprietary

# sh ./NVIDIA-Linux-x86_64-560.run --kernel-module-type=proprietary
</pre></div>


<h3 id="using_the_installation_helper_script">Using the installation helper script<a href="#using_the_installation_helper_script"><i></i></a></h3>



<p>As mentioned earlier, if you’re unsure which driver to pick for the GPUs in your system, NVIDIA created a helper script to guide you through the selection process. </p>



<p>To use it, first install the <code>nvidia-driver-assistant</code> package with your package manager, then run the script:</p>


<div><pre title="">$ nvidia-driver-assistant
</pre></div>


<h3 id="package_manager_details">Package manager details<a href="#package_manager_details"><i></i></a></h3>



<p>For a consistent experience, NVIDIA recommends that you use package managers to install CUDA Toolkit and the drivers. However, the specific details of which package management systems are used by different distributions or how packages are structured can vary depending on your particular distribution. </p>



<p>This section outlines the specific details, caveats, or migration steps needed for various platforms. </p>



<h4>apt: Ubuntu and Debian-based distributions</h4>



<p>Run the following command:</p>


<div><pre title="">$ sudo apt-get install nvidia-open
</pre></div>


<p>To upgrade using the <code>cuda</code> metapackage on Ubuntu 20.04, first switch to open kernel modules:</p>


<div><pre title="">$ sudo apt-get install -V nvidia-kernel-source-open

$ sudo apt-get install nvidia-open
</pre></div>


<h4>dnf: Red Hat Enterprise Linux, Fedora, Kylin, Amazon Linux, or Rocky Linux</h4>



<p>Run the following command:</p>


<div><pre title="">$ sudo dnf module install nvidia-driver:open-dkms
</pre></div>


<p>To upgrade using the <code>cuda</code> metapackage on dnf-based distros, module streams must be disabled:</p>


<div><pre title="">$ echo &#34;module_hotfixes=1&#34; | tee -a /etc/yum.repos.d/cuda*.repo
$ sudo dnf install --allowerasing nvidia-open
$ sudo dnf module reset nvidia-driver
</pre></div>


<h4>zypper: SUSE Linux Enterprise Server, or OpenSUSE</h4>



<p>Run one of the following commands:</p>


<div><pre title=""># default kernel flavor
$ sudo zypper install nvidia-open
</pre></div>

<div><pre title=""># azure kernel flavor (sles15/x86_64)
$ sudo zypper install nvidia-open-azure
</pre></div>

<div><pre title=""># 64kb kernel flavor (sles15/sbsa) required for Grace-Hopper
$ sudo zypper install nvidia-open-64k
</pre></div>


<h4>Package manager summary</h4>



<p>For simplification, we’ve condensed the package manager recommendations in table format. All releases beyond driver version 560 and CUDA Toolkit 12.6 will use these packaging conventions.</p>



<figure><table><tbody><tr><td><strong>Distro</strong></td><td><strong>Install the latest </strong></td><td><strong>Install a specific release </strong></td></tr><tr><td>Fedora/RHEL/Kylin</td><td><code>dnf module install nvidia-driver:open-dkms</code></td><td><code>dnf module install nvidia-driver:560-open</code></td></tr><tr><td>openSUSE/SLES</td><td><code>zypper install <strong>nvidia-open{-azure,-64k}</strong></code></td><td><code>zypper install <strong>nvidia-open-560{-azure,-64k}</strong></code></td></tr><tr><td>Debian</td><td><code>apt-get install <strong>nvidia-open</strong></code></td><td><code>apt-get install <strong>nvidia-open-560</strong></code></td></tr><tr><td>Ubuntu</td><td><code>apt-get install <strong>nvidia-open</strong></code></td><td><code>apt-get install <strong>nvidia-open-560</strong></code></td></tr></tbody></table><figcaption><em>Table 1. Package manager installation recommendations</em></figcaption></figure>



<p>For more information, see <a href="https://docs.nvidia.com/datacenter/tesla/drivers/index.html" data-wpel-link="internal" target="_self" rel="noopener noreferrer">NVIDIA Datacenter Drivers</a>.</p>



<h3 id="windows_subsystem_for_linux">Windows Subsystem for Linux<a href="#windows_subsystem_for_linux"><i></i></a></h3>



<p>Windows Subsystem for Linux (WSL) uses the NVIDIA kernel driver from the host Windows operating system. You shouldn’t install any driver into this platform specifically. If you are using WSL, no change or action is required.</p>



<h3 id="cuda_toolkit">CUDA Toolkit<a href="#cuda_toolkit"><i></i></a></h3>



<p>The installation of CUDA Toolkit remains unchanged through package managers. Run the following command:</p>


<div><pre title="">$ sudo apt-get/dnf/zypper install cuda-toolkit
</pre></div>


<h2 id="more_information">More information<a href="#more_information"><i></i></a></h2>



<p>For more information about how to install NVIDIA drivers or the CUDA Toolkit, including how to ensure that you install the proprietary drivers if you’re unable to migrate to the open-source GPU kernel modules at this time, see <a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/#driver-installation" data-wpel-link="internal" target="_self" rel="noopener noreferrer">Driver Installation</a> in the <em>CUDA Installation Guide</em>.</p>
</div></div>
  </body>
</html>
