<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/kronotop/kronotop">Original</a>
    <h1>Kronotop: Redis-compatible, transactional document store backed by FoundationDB</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Kronotop is a Redis-compatible, distributed and transactional document database backed by <a href="https://www.foundationdb.org/" rel="nofollow">FoundationDB</a>.</p>
<p dir="auto">Kronotop&#39;s main focus is building a document database that supports <a href="https://www.mongodb.com/docs/manual/reference/operator/" rel="nofollow">MQL-like query language</a>, <a href="https://apple.github.io/foundationdb/developer-guide.html#transaction-basics" rel="nofollow">ACID transactions</a>
and on-disk storage engine with a primary-standby replication model.</p>
<p dir="auto">Kronotop is still in its early stages of development. The API is unstable and might be changed in the future releases.</p>
<p dir="auto">See <a href="#getting-started">Getting started</a> section.</p>

<ul dir="auto">
<li>Horizontally scalable and sharded by default,</li>
<li>Supports single or multi-master cluster topologies for different deployment strategies,</li>
<li>Supports <a href="https://redis.io/docs/latest/develop/reference/protocol-spec/" rel="nofollow">Redis Serialization Protocol</a>, you can use any Redis client to connect the cluster.</li>
<li>Partly supports <a href="https://redis.io/docs/latest/operate/oss_and_stack/reference/cluster-spec/" rel="nofollow">Redis cluster specification</a>,</li>
<li>Uses FoundationDB as the metadata store for cluster management and data structures,</li>
<li>Implemented in Java and requires JDK 21+,</li>
</ul>

<p dir="auto">Kronotop is still in its early stages, but we have the following features with a strong foundation.</p>
<ul dir="auto">
<li>ZMap, an ordered key-value store. Simply, Redis protocol proxy for FoundationDB API,</li>
<li>Namespaces for isolating ZMaps and Buckets, basically it&#39;s a thin layer around FoundationDB&#39;s directory layer,</li>
<li>Volume, storage engine implementation with a primary-standby replication model,</li>
<li>Clustering with single or multi-master deployment scenarios,</li>
<li>Partial support for some Redis data structures: String and Hash.</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Plans for the foreseeable future</h2><a id="user-content-plans-for-the-foreseeable-future" aria-label="Permalink: Plans for the foreseeable future" href="#plans-for-the-foreseeable-future"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Design and implement a data structure called <strong>Bucket</strong> to store JSON-like documents,</li>
<li><strong>Bucket</strong> data structure will support an <a href="https://www.mongodb.com/docs/manual/reference/operator/" rel="nofollow">MQL-like query language</a> and transactions backed by FoundationDB,</li>
<li>Provide the most common Redis data structures such as String, Hash, Sorted Sets, etc.</li>
</ul>

<ul dir="auto">
<li><a href="#getting-started">Getting started</a>
<ul dir="auto">
<li><a href="#initializing-a-kronotop-cluster">Initializing a Kronotop cluster</a></li>
</ul>
</li>
<li><a href="#redis-compatibility">Redis compatibility</a></li>
<li><a href="#features">Features</a>
<ul dir="auto">
<li><a href="#transaction-management">Transaction management</a>
<ul dir="auto">
<li><a href="#begin">BEGIN</a></li>
<li><a href="#commit">COMMIT</a></li>
<li><a href="#rollback">ROLLBACK</a></li>
<li><a href="#getapproximatesize">GETAPPROXIMATESIZE</a></li>
<li><a href="#getreadversion">GETREADVERSION</a></li>
<li><a href="#snapshotread">SNAPSHOTREAD</a></li>
</ul>
</li>
<li><a href="#zmap">ZMap</a>
<ul dir="auto">
<li><a href="#zset">ZSET</a></li>
<li><a href="#zget">ZGET</a></li>
<li><a href="#zgetkey">ZGETKEY</a></li>
<li><a href="#zgetrange">ZGETRANGE</a></li>
<li><a href="#zgetrangesize">ZGETRANGESIZE</a></li>
<li><a href="#zmutate">ZMUTATE</a></li>
<li><a href="#zdel">ZDEL</a></li>
<li><a href="#zdelrange">ZDELRANGE</a></li>
</ul>
</li>
<li><a href="#namespaces">Namespaces</a>
<ul dir="auto">
<li><a href="#namespace-create">NAMESPACE CREATE</a></li>
<li><a href="#namespace-remove">NAMESPACE REMOVE</a></li>
<li><a href="#namespace-current">NAMESPACE CURRENT</a></li>
<li><a href="#namespace-use">NAMESPACE USE</a></li>
<li><a href="#namespace-exists">NAMESPACE EXISTS</a></li>
<li><a href="#namespace-list">NAMESPACE LIST</a></li>
<li><a href="#namespace-move">NAMESPACE MOVE</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<p dir="auto">It&#39;s easy to try Kronotop with Docker Compose:</p>
<div dir="auto" data-snippet-clipboard-copy-content="curl -o kronotop-demo.yaml https://raw.githubusercontent.com/kronotop/kronotop/refs/heads/main/docker/kronotop-demo.yaml"><pre>curl -o kronotop-demo.yaml https://raw.githubusercontent.com/kronotop/kronotop/refs/heads/main/docker/kronotop-demo.yaml</pre></div>
<p dir="auto">Then, you can run the following command to create a single-member Kronotop cluster for demonstration purposes:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker compose -f kronotop-demo.yaml up "><pre>docker compose -f kronotop-demo.yaml up </pre></div>
<p dir="auto">If everything goes okay, you should be able to connect to the primary node via <code>redis-cli</code>:</p>
<div data-snippet-clipboard-copy-content="redis-cli -p 3320 -c
127.0.0.1:3320&gt; PING
PONG"><pre><code>redis-cli -p 3320 -c
127.0.0.1:3320&gt; PING
PONG
</code></pre></div>
<p dir="auto">A cluster member serves from two ports:</p>
<ul dir="auto">
<li><em>5484</em> for the client communication,</li>
<li><em>3320</em> for the internal traffic and administrative commands.</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Initializing a Kronotop cluster</h3><a id="user-content-initializing-a-kronotop-cluster" aria-label="Permalink: Initializing a Kronotop cluster" href="#initializing-a-kronotop-cluster"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Before using Kronotop in your project, you first need to initialize the cluster. <code>KR.ADMIN INITIALIZE-CLUSTER</code> command creates
the cluster&#39;s layout on the FoundationDB and initializes the cluster:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:3320&gt; KR.ADMIN INITIALIZE-CLUSTER
OK"><pre><code>127.0.0.1:3320&gt; KR.ADMIN INITIALIZE-CLUSTER
OK
</code></pre></div>
<p dir="auto">Then, we must set the shard&#39;s primary ownership and make the shards operable. Currently, we only have a running Kronotop
instance in the cluster. It&#39;s good enough for demonstration purposes. We can assign all shards to this member.</p>
<p dir="auto">First, we should run <code>KR.ADMIN DESCRIBE-MEMBER</code> command to learn id of the current member:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:3320&gt; KR.ADMIN DESCRIBE-MEMBER
1# member_id =&gt; a0dc14d811a285834c187ddc20549de7c1c1a381
2# status =&gt; RUNNING
3# process_id =&gt; AAAOz0CfYCoAAAAA
4# external_host =&gt; 127.0.0.1
5# external_port =&gt; (integer) 5484
6# internal_host =&gt; 127.0.0.1
7# internal_port =&gt; (integer) 3320
8# latest_heartbeat =&gt; (integer) 8227"><pre><code>127.0.0.1:3320&gt; KR.ADMIN DESCRIBE-MEMBER
1# member_id =&gt; a0dc14d811a285834c187ddc20549de7c1c1a381
2# status =&gt; RUNNING
3# process_id =&gt; AAAOz0CfYCoAAAAA
4# external_host =&gt; 127.0.0.1
5# external_port =&gt; (integer) 5484
6# internal_host =&gt; 127.0.0.1
7# internal_port =&gt; (integer) 3320
8# latest_heartbeat =&gt; (integer) 8227
</code></pre></div>
<p dir="auto">We need <code>member_id</code> from this response. The following command sets the primary owner of all Redis shards;</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:3320&gt; KR.ADMIN ROUTE SET PRIMARY REDIS * a0dc14d811a285834c187ddc20549de7c1c1a381
OK"><pre><code>127.0.0.1:3320&gt; KR.ADMIN ROUTE SET PRIMARY REDIS * a0dc14d811a285834c187ddc20549de7c1c1a381
OK
</code></pre></div>
<p dir="auto">Now we are ready to make our all Redis shards writable:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:3320&gt; KR.ADMIN SET-SHARD-STATUS REDIS * READWRITE
OK"><pre><code>127.0.0.1:3320&gt; KR.ADMIN SET-SHARD-STATUS REDIS * READWRITE
OK
</code></pre></div>
<p dir="auto">If everything is okay, we can start using the newly formed Kronotop cluster:</p>
<div data-snippet-clipboard-copy-content="redis-cli -p 5484 -c
127.0.0.1:5484&gt; SET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; GET mykey
&#34;Hello&#34;"><pre><code>redis-cli -p 5484 -c
127.0.0.1:5484&gt; SET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; GET mykey
&#34;Hello&#34;
</code></pre></div>
<p dir="auto">All in-memory data will be persisted and replicated by the storage engine. See <a href="#storage-engine">Storage Engine</a> section for the details.</p>

<p dir="auto">Kronotop uses RESP3 as the client protocol. The reasoning behind this is simple: there are many high-quality Redis client implementations
in all languages, and almost everyone has some experience with Redis.</p>
<p dir="auto">Despite the main focus on building a transactional document database using FoundationDB as a metadata store, implementing
the most common Redis data structures is on the roadmap. Currently, Kronotop has already partial support for <em>String</em> and <em>Hash</em>
data structures.</p>


<p dir="auto">Kronotop exposes the FoundationDB API to Redis clients. This section explains transaction management commands.</p>
<p dir="auto"><em>Note that not all parts of the FoundationDB API are implemented yet.</em></p>

<p dir="auto"><code>BEGIN</code> creates a new transaction and set it to the current session.</p>
<p dir="auto"><strong>Example:</strong></p>

<p dir="auto">If there is another transaction in progress in the current session, it returns a <code>TRANSACTION</code> error message.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; BEGIN
(error) TRANSACTION there is already a transaction in progress."><pre><code>127.0.0.1:5484&gt; BEGIN
(error) TRANSACTION there is already a transaction in progress.
</code></pre></div>

<p dir="auto"><code>COMMIT</code> commits changes to the database.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; COMMIT
OK"><pre><code>127.0.0.1:5484&gt; COMMIT
OK
</code></pre></div>
<p dir="auto">FoundationDB currently does not support transactions running for over five seconds. If the transaction is too old,
it returns <code>TRANSACTIONOLD</code> error.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; COMMIT
(error) TRANSACTIONOLD transaction is too old to perform reads or be committed"><pre><code>127.0.0.1:5484&gt; COMMIT
(error) TRANSACTIONOLD transaction is too old to perform reads or be committed
</code></pre></div>
<p dir="auto">If there is no transaction in progress in the current session, it returns <code>TRANSACTION</code> error.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; COMMIT
(error) TRANSACTION there is no transaction in progress."><pre><code>127.0.0.1:5484&gt; COMMIT
(error) TRANSACTION there is no transaction in progress.
</code></pre></div>

<p dir="auto"><code>ROLLBACK</code> cancels the current session&#39;s in-progress transaction.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ROLLBACK
OK"><pre><code>127.0.0.1:5484&gt; ROLLBACK
OK
</code></pre></div>
<p dir="auto">If no transaction is in progress in the current session, it returns a <code>TRANSACTION</code> error message.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ROLLBACK
(error) TRANSACTION there is no transaction in progress."><pre><code>127.0.0.1:5484&gt; ROLLBACK
(error) TRANSACTION there is no transaction in progress.
</code></pre></div>

<p dir="auto"><code>GETAPPROXIMATESIZE</code> returns the approximated size of the commit, which is the summation of mutations, read conflict ranges,
and write conflict ranges. This can be called multiple times before a transaction commit.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; GETAPPROXIMATESIZE
(integer) 619"><pre><code>127.0.0.1:5484&gt; GETAPPROXIMATESIZE
(integer) 619
</code></pre></div>

<p dir="auto"><code>GETREADVERSION</code> returns the version at which the reads for the in-progress transaction will access the database.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; GETREADVERSION
16275608010704"><pre><code>127.0.0.1:5484&gt; GETREADVERSION
16275608010704
</code></pre></div>

<p dir="auto"><code>SNAPSHOTREAD ON|OFF</code> enables or disables snapshot reads for the in-progess transaction.</p>
<p dir="auto">In the FoundationDB context, snapshots a special-purpose, read-only view of the database. Reads done through this interface
are known as &#34;snapshot reads.&#34; Snapshot reads selectively relax FoundationDB&#39;s isolation property, reducing <a href="https://apple.github.io/foundationdb/developer-guide.html#conflict-ranges" rel="nofollow">Transaction
conflicts</a> but making reasoning about concurrency harder.  For more information about how to use snapshot reads correctly,
see Using <a href="https://apple.github.io/foundationdb/developer-guide.html#snapshot-reads" rel="nofollow">snapshot reads</a>.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; SNAPSHOTREAD ON
OK"><pre><code>127.0.0.1:5484&gt; SNAPSHOTREAD ON
OK
</code></pre></div>

<p dir="auto">Kronotop also provides a new data structure called ZMap. ZMap is simply a RESP proxy for FoundationDB API.</p>
<p dir="auto">FoundationDB’s core data model is an ordered key-value store. Also known as an ordered associative array, map, or dictionary,
this is a common data structure composed of a collection of key-value pairs in which all keys are unique. Starting with this simple model,
an application can create higher-level data models by mapping their elements to individual keys and values.</p>
<p dir="auto">See the <a href="https://apple.github.io/foundationdb/data-modeling.html" rel="nofollow">Data Modeling</a> section on FoundationDB documents.</p>
<p dir="auto"><strong>One-Off Transactions</strong></p>
<p dir="auto">Kronotop will create a new transaction and automatically commit changes to the database for the ad-hoc commands.</p>
<p dir="auto">In other terms, you do not need to do this for every command:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; BEGIN
OK
127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; COMMIT
OK"><pre><code>127.0.0.1:5484&gt; BEGIN
OK
127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; COMMIT
OK
</code></pre></div>
<p dir="auto">One-off transaction feature is especially useful for running commands in CLI.</p>
<p dir="auto"><strong>ZMap and Namespaces</strong></p>
<p dir="auto">A namespace prefixes all data stored in a ZMap. The current namespace can be inspected by running the following command:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE CURRENT
global"><pre><code>127.0.0.1:5484&gt; NAMESPACE CURRENT
global
</code></pre></div>
<p dir="auto"><code>global</code> is the default namespace. Namespaces create isolation between data structures. This is how it works for ZMap</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE CURRENT
global
127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; ZGET mykey
&#34;Hello&#34;
127.0.0.1:5484&gt; NAMESPACE CREATE global.child-namespace
OK
127.0.0.1:5484&gt; NAMESPACE USE global.child-namespace
OK
127.0.0.1:5484&gt; ZGET mykey
(nil)"><pre><code>127.0.0.1:5484&gt; NAMESPACE CURRENT
global
127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK
127.0.0.1:5484&gt; ZGET mykey
&#34;Hello&#34;
127.0.0.1:5484&gt; NAMESPACE CREATE global.child-namespace
OK
127.0.0.1:5484&gt; NAMESPACE USE global.child-namespace
OK
127.0.0.1:5484&gt; ZGET mykey
(nil)
</code></pre></div>
<p dir="auto">See <a href="#namespaces">Namespaces</a> section for further information.</p>

<p dir="auto"><code>ZSET</code> sets the value for a given key. This will not affect the database until <code>COMMIT</code> is called.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK"><pre><code>127.0.0.1:5484&gt; ZSET mykey &#34;Hello&#34;
OK
</code></pre></div>

<p dir="auto"><code>ZGET</code> gets a value from the database. The call will return <code>nil</code> if the key is not present in the database.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGET mykey
&#34;Hello&#34;"><pre><code>127.0.0.1:5484&gt; ZGET mykey
&#34;Hello&#34;
</code></pre></div>

<p dir="auto"><code>ZGETKEY</code> returns the key referenced by the specified <code>KeySelector</code>.</p>
<p dir="auto">The default key selector is <code>FIRST_GREATER_OR_EQUAL</code>, <code>KEY_SELECTOR</code> portion of the command is optional.</p>
<p dir="auto">Available key selectors:</p>
<ul dir="auto">
<li><code>FIRST_GREATER_OR_EQUAL</code>,</li>
<li><code>FIRST_GREATER_THAN</code>,</li>
<li><code>LAST_LESS_THAN</code>,</li>
<li><code>LAST_LESS_OR_EQUAL</code></li>
</ul>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; zset key-0 value-0
OK
127.0.0.1:5484&gt; zset key-1 value-1
OK
127.0.0.1:5484&gt; zset key-2 value-2
OK
127.0.0.1:5484&gt; zset key-3 value-3
OK
127.0.0.1:5484&gt; ZGETKEY key-0 KEY_SELECTOR FIRST_GREATER_THAN
&#34;key-1&#34;"><pre><code>127.0.0.1:5484&gt; zset key-0 value-0
OK
127.0.0.1:5484&gt; zset key-1 value-1
OK
127.0.0.1:5484&gt; zset key-2 value-2
OK
127.0.0.1:5484&gt; zset key-3 value-3
OK
127.0.0.1:5484&gt; ZGETKEY key-0 KEY_SELECTOR FIRST_GREATER_THAN
&#34;key-1&#34;
</code></pre></div>

<p dir="auto"><code>ZGETRANGE</code> gets an ordered range of keys and values from the database. The <em>begin</em> and <em>end</em> keys can be specified by
key selectors, with the begin <code>BEGIN_KEY_SELECTOR</code> inclusive and the end <code>END_KEY_SELECTOR</code> exclusive.</p>
<p dir="auto">The default <code>BEGIN_KEY_SELECTOR</code> is <code>FIRST_GREATER_OR_EQUAL</code>.
The default <code>END_KEY_SELECTOR</code> is <code>FIRST_GREATER_THAN</code>.</p>
<p dir="auto">Available key selectors:</p>
<ul dir="auto">
<li>FIRST_GREATER_OR_EQUAL,</li>
<li>FIRST_GREATER_THAN,</li>
<li>LAST_LESS_THAN,</li>
<li>LAST_LESS_OR_EQUAL</li>
</ul>
<p dir="auto">The key selector section of this command is optional.</p>
<p dir="auto"><strong>Example:</strong>*</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGETRANGE key-0 key-3
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;"><pre><code>127.0.0.1:5484&gt; ZGETRANGE key-0 key-3
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
</code></pre></div>
<p dir="auto">With <code>LIMIT</code> parameter:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGETRANGE key-0 key-5 LIMIT 3
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;"><pre><code>127.0.0.1:5484&gt; ZGETRANGE key-0 key-5 LIMIT 3
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
</code></pre></div>
<p dir="auto">With <code>LIMIT</code> and <code>REVERSE</code> parameters:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGETRANGE key-0 key-5 LIMIT 3 REVERSE
1) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
2) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;"><pre><code>127.0.0.1:5484&gt; ZGETRANGE key-0 key-5 LIMIT 3 REVERSE
1) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
2) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
</code></pre></div>
<p dir="auto">Range from beginning to end, get an ordered set or key/value pairs:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
4) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
5) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
6) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;
7) 1) &#34;key-6&#34;
   2) &#34;value-6&#34;"><pre><code>127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
4) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
5) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
6) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;
7) 1) &#34;key-6&#34;
   2) &#34;value-6&#34;
</code></pre></div>
<p dir="auto">Explicitly using key selectors, please note that you can use the key selectors individually.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZGETRANGE key-2 key-5 BEGIN_KEY_SELECTOR FIRST_GREATER_THAN
1) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;"><pre><code>127.0.0.1:5484&gt; ZGETRANGE key-2 key-5 BEGIN_KEY_SELECTOR FIRST_GREATER_THAN
1) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
</code></pre></div>

<p dir="auto"><code>ZGETRANGESIZE</code> gets an estimate for the number of bytes stored in the given range.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; zgetrangesize key-0 key-9
(integer) 0"><pre><code>127.0.0.1:5484&gt; zgetrangesize key-0 key-9
(integer) 0
</code></pre></div>
<p dir="auto"><em>FoundationDB says:</em></p>
<blockquote>
<p dir="auto">Note: the estimated size is calculated based on the sampling done by FDB server. The sampling algorithm works roughly in
this way: the larger the key-value pair is, the more likely it would be sampled and the more accurate its sampled size would be.
And due to that reason, it is recommended to use this API to query against large ranges for accuracy considerations.
For a rough reference, if the returned size is larger than 3MB, one can consider the size to be accurate.</p>
</blockquote>

<p dir="auto"><code>ZMUTATE</code> runs an atomic operation on the given key.</p>
<p dir="auto">Available mutation types:</p>
<ul dir="auto">
<li><code>ADD</code>: Performs an addition of little-endian integers.</li>
<li><code>APPEND_IF_FITS</code>: Appends param to the end of the existing value already in the database at the given key (or creates the key and sets the value to param if the key is empty).</li>
<li><code>BIT_AND</code>: Performs a bitwise and operation.</li>
<li><code>BIT_OR</code>: Performs a bitwise or operation.</li>
<li><code>BIT_XOR</code>: Performs a bitwise xor operation.</li>
<li><code>BYTE_MAX</code>: Performs lexicographic comparison of byte strings.</li>
<li><code>BYTE_MIN</code>: Performs lexicographic comparison of byte strings.</li>
<li><code>COMPARE_AND_CLEAR</code>: Performs an atomic compare and clear operation.</li>
<li><code>MAX</code>: Performs a little-endian comparison of byte strings.</li>
<li><code>MIN</code>: Performs a little-endian comparison of byte strings.</li>
<li><code>SET_VERSIONSTAMPED_KEY</code>: Transforms key using a versionstamp for the transaction.</li>
<li><code>SET_VERSIONSTAMPED_VALUE</code>: Transforms param using a versionstamp for the transaction.</li>
</ul>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZSET key-0 value-0
OK
127.0.0.1:5484&gt; ZMUTATE key-0 value COMPARE_AND_CLEAR
OK
127.0.0.1:5484&gt; ZGET key-0
&#34;value-0&#34;
127.0.0.1:5484&gt; ZMUTATE key-0 value-0 COMPARE_AND_CLEAR
OK
127.0.0.1:5484&gt; ZGET key-0
(nil)"><pre><code>127.0.0.1:5484&gt; ZSET key-0 value-0
OK
127.0.0.1:5484&gt; ZMUTATE key-0 value COMPARE_AND_CLEAR
OK
127.0.0.1:5484&gt; ZGET key-0
&#34;value-0&#34;
127.0.0.1:5484&gt; ZMUTATE key-0 value-0 COMPARE_AND_CLEAR
OK
127.0.0.1:5484&gt; ZGET key-0
(nil)
</code></pre></div>

<p dir="auto"><code>ZDEL</code> clears a given key from the database. This will not affect the database until <code>COMMIT</code> is called.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZDEL mykey
OK"><pre><code>127.0.0.1:5484&gt; ZDEL mykey
OK
</code></pre></div>

<p dir="auto"><code>ZDELRANGE</code> clears the keys in the given range. The <em>begin</em> is inclusive, <em>end</em> is exclusive.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZDELRANGE key-1 key-4
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
3) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;
4) 1) &#34;key-6&#34;
   2) &#34;value-6&#34;"><pre><code>127.0.0.1:5484&gt; ZDELRANGE key-1 key-4
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
3) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;
4) 1) &#34;key-6&#34;
   2) &#34;value-6&#34;
</code></pre></div>
<p dir="auto">Using <code>*</code> asterisk character to set a boundary:</p>
<p dir="auto">Wipe out all keys in the current namespace:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZDELRANGE * *
OK
127.0.0.1:5484&gt; ZGETRANGE * *
(empty array)"><pre><code>127.0.0.1:5484&gt; ZDELRANGE * *
OK
127.0.0.1:5484&gt; ZGETRANGE * *
(empty array)
</code></pre></div>
<p dir="auto">Clear all keys from the beginning to <code>key-3</code>:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZDELRANGE * key-3
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
3) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;"><pre><code>127.0.0.1:5484&gt; ZDELRANGE * key-3
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-3&#34;
   2) &#34;value-3&#34;
2) 1) &#34;key-4&#34;
   2) &#34;value-4&#34;
3) 1) &#34;key-5&#34;
   2) &#34;value-5&#34;
</code></pre></div>
<p dir="auto">Clear all keys from <code>key-3</code> to end of the range:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; ZDELRANGE key-3 *
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;"><pre><code>127.0.0.1:5484&gt; ZDELRANGE key-3 *
OK
127.0.0.1:5484&gt; ZGETRANGE * *
1) 1) &#34;key-0&#34;
   2) &#34;value-0&#34;
2) 1) &#34;key-1&#34;
   2) &#34;value-1&#34;
3) 1) &#34;key-2&#34;
   2) &#34;value-2&#34;
</code></pre></div>

<p dir="auto">Namespace is a thin layer around FoundationDB&#39;s powerful <a href="https://apple.github.io/foundationdb/developer-guide.html#directories" rel="nofollow">directory</a> concept. Namespaces are a recommended approach for administering applications.
Each application should create or open at least one directory to manage its subspaces. Namespaces are identified by
hierarchical paths analogous to the paths in a Unix-like file system.</p>
<p dir="auto">The hierarchy between directories is denoted by joining them with dot character. Let&#39;s assume that you have different
microservices and want to isolate their databases. You can create a namespace for each microservice under the <code>production</code> namespace.</p>
<p dir="auto">If you have three microservices named <code>users</code>, <code>orders</code> and <code>products</code>, your namespace hierarchy might look like the following:</p>
<ul dir="auto">
<li><code>production.users</code></li>
<li><code>production.orders</code></li>
<li><code>production.products</code></li>
</ul>
<p dir="auto">All data structures used by these namespaces will be isolated.</p>
<p dir="auto"><strong>Note:</strong> Redis data structures are not stored under namespaces. Currently, namespaces cover only ZMap data structure.</p>

<p dir="auto"><code>NAMESPACE CREATE</code> creates a new namespace with the given hierarchy.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE CREATE global.users "><pre><code>127.0.0.1:5484&gt; NAMESPACE CREATE global.users 
</code></pre></div>

<p dir="auto"><code>NAMESPACE REMOVE</code> removes the given namespace hierarchy. It&#39;s the equivalent of <code>DROP DATABASE</code> command in other databases.
So you should be careful when start typing this command. The result is irreversible.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE REMOVE global.users
OK "><pre><code>127.0.0.1:5484&gt; NAMESPACE REMOVE global.users
OK 
</code></pre></div>
<p dir="auto">You cannot remove the default namespace:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE REMOVE global
(error) ERR Cannot remove the default namespace: &#39;global&#39;"><pre><code>127.0.0.1:5484&gt; NAMESPACE REMOVE global
(error) ERR Cannot remove the default namespace: &#39;global&#39;
</code></pre></div>

<p dir="auto"><code>NAMESPACE CURRENT</code> command returns the current namespace in use for the session. The default namespace is in use if the
client doesn&#39;t set a different namespace by calling <code>NAMESPACE USE</code> command.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE CURRENT
global "><pre><code>127.0.0.1:5484&gt; NAMESPACE CURRENT
global 
</code></pre></div>

<p dir="auto"><code>NAMESPACE USE</code> sets an existing namespace to be used by the session.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE USE global.users
OK "><pre><code>127.0.0.1:5484&gt; NAMESPACE USE global.users
OK 
</code></pre></div>
<p dir="auto">It returns <code>NOSUCHNAMESPACE</code> error if the namespace doesn&#39;t exist:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; namespace use global.clients
(error) NOSUCHNAMESPACE No such namespace: global.clients"><pre><code>127.0.0.1:5484&gt; namespace use global.clients
(error) NOSUCHNAMESPACE No such namespace: global.clients
</code></pre></div>

<p dir="auto"><code>NAMESPACE EXISTS</code> checks a namespace whether exists or not.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE EXISTS global.users
(integer) 1"><pre><code>127.0.0.1:5484&gt; NAMESPACE EXISTS global.users
(integer) 1
</code></pre></div>
<p dir="auto">It returns <code>1</code> for existing namespaces and <code>0</code> for non-existing ones.</p>

<p dir="auto"><code>NAMESPACE LIST</code> lists the namespaces under the given hierarchy.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE LIST
1) global"><pre><code>127.0.0.1:5484&gt; NAMESPACE LIST
1) global
</code></pre></div>
<p dir="auto">It can take an optional parameter of namespace hierarchy.</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE LIST global
1) users"><pre><code>127.0.0.1:5484&gt; NAMESPACE LIST global
1) users
</code></pre></div>
<p dir="auto">It returns <code>NOSUCHNAMESPACE</code> error if the given hierarchy is invalid:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE LIST global.clients
(error) NOSUCHNAMESPACE No such namespace: global.clients"><pre><code>127.0.0.1:5484&gt; NAMESPACE LIST global.clients
(error) NOSUCHNAMESPACE No such namespace: global.clients
</code></pre></div>

<p dir="auto"><code>NAMESPACE MOVE</code> moves the rightmost namespace to another location in the given hierarchy.</p>
<p dir="auto"><strong>Example:</strong></p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE MOVE global.users staging.users
OK"><pre><code>127.0.0.1:5484&gt; NAMESPACE MOVE global.users staging.users
OK
</code></pre></div>
<p dir="auto">Let&#39;s check the result:</p>
<div data-snippet-clipboard-copy-content="127.0.0.1:5484&gt; NAMESPACE LIST global
(empty array)
127.0.0.1:5484&gt; NAMESPACE LIST staging
1) users"><pre><code>127.0.0.1:5484&gt; NAMESPACE LIST global
(empty array)
127.0.0.1:5484&gt; NAMESPACE LIST staging
1) users
</code></pre></div>
</article></div></div>
  </body>
</html>
