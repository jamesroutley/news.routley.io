<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.cnet.com/news/privacy/nsa-tracks-google-ads-to-find-tor-users/">Original</a>
    <h1>NSA tracks Google ads to find Tor users</h1>
    
    <div id="readability-page-1" class="page"><div id="article-12100c01-4de3-11e3-945a-14feb5ca9861"><div><div><div><p>
Just because the <span section="shortcodeLink"><a href="https://www.cnet.com/tech/nsa-sought-to-unmask-users-of-net-privacy-tool-tor-says-report/" rel="follow"><span>National Security Agency hasn&#39;t cracked the anonymizing service Tor</span></a></span> doesn&#39;t mean that people who use the service are free from surveillance.
</p> <p>
The NSA has been able to use ad networks like Google&#39;s, and The Onion Router&#39;s own entry and exit nodes on the Internet, to follow some Tor users, according to a new report based on documents leaked by whistleblower Edward Snowden and obtained by <a href="http://www.theguardian.com/world/2013/oct/04/tor-attacks-nsa-users-online-anonymity" rel="noopener nofollow" target="_blank">security researcher Bruce Schneier with the Guardian</a>. Tor is primarily funded by the US State Department and the Department of Defense, home of the NSA. 
</p>  <p><a href="https://www.torproject.org/" rel="noopener nofollow" target="_blank">Tor promotes itself</a> as helping people &#34;defend against traffic analysis, a form of network surveillance that threatens personal freedom and privacy, confidential business activities and relationships, and state security.&#34;
</p><p>
Robert Hansen, a browser specialist at the security firm White Hat Security, said that Tor access node tracking is not new.
</p><p>
&#34;A couple of years ago a hacking group published exactly 100 embassy passwords from Tor exit nodes. One hundred is too round of a number,&#34; he said. &#34;Just logically there must be more. If you get enough exit nodes and entrance nodes, they can be correlated together.&#34;
</p><p>
Director of National Intelligence James Clapper <a href="http://icontherecord.tumblr.com/post/63103784923/dni-statement-why-the-intelligence-community" rel="noopener nofollow" target="_blank">criticized</a> reporters and denied that his office was doing anything illegal, citing the threat of &#34;adversaries.&#34;  
</p><blockquote>
The articles fail to mention that the Intelligence Community is only interested in communication related to valid foreign intelligence and counterintelligence purposes and that we operate within a strict legal framework that prohibits accessing information related to the innocent online activities of US citizens.
</blockquote> <p>
The system that the NSA uses to locate and identify Tor users begins, at least sometimes, with the buying of ads on networks like Google&#39;s AdSense. 
</p><p>
&#34;Just because you&#39;re using Tor doesn&#39;t mean that your browser isn&#39;t storing cookies,&#34; said Jeremiah Grossman, a colleague of Hansen&#39;s who also specializes in browser vulnerabilities.
</p><p>
As Grossman described the procedure to CNET, the NSA is aware of Tor&#39;s entry and exit nodes because of its Internet-wide surveillance.
</p><p>
&#34;The very feature that makes Tor a powerful anonymity service, and the fact that all Tor users look alike on the Internet, makes it easy to differentiate Tor users from other Web users,&#34; he wrote.
</p><p>
The NSA buys ads from ad display companies like Google and seeds them around Tor&#39;s access points. 
</p> <figure><div><!----> <div><picture><source media="(max-width: 767px)" srcset="https://www.cnet.com/a/img/resize/e854459664a08d478d0f99c815a154a071ced447/hub/2013/09/28/5b994963-6dea-11e3-913e-14feb5ca9861/NSA_thumb.png?auto=webp&amp;width=768" alt=""/><source media="(max-width: 1023px)" srcset="https://www.cnet.com/a/img/resize/1ab45c3795547182449412f07c7228ce87dad787/hub/2013/09/28/5b994963-6dea-11e3-913e-14feb5ca9861/NSA_thumb.png?auto=webp&amp;width=1024" alt=""/><source media="(max-width: 1440px)" srcset="https://www.cnet.com/a/img/resize/f19908425bd684d147509559f0aee46671c9e774/hub/2013/09/28/5b994963-6dea-11e3-913e-14feb5ca9861/NSA_thumb.png?auto=webp&amp;width=1200" alt=""/> <img src="" alt="" height="306" width="1200" loading="lazy"/> </picture></div> <!----> <!----></div> <!----></figure> <p>
&#34;The NSA then cookies that ad, so that every time you go to a site, the cookie identifies you. Even though your IP address changed [because of Tor], the cookies gave you away,&#34; he said.
</p><p>
This is not some complicated or even an unusual trick, Grossman said. It&#39;s how tracking ads were intended to function. 
</p><p>
&#34;That&#39;s the Web by design, not a hack,&#34; he said.
</p><p>
The NSA, he said, is not spending much money on it since Internet ads are so cheap. Grossman speculated that an ad campaign would only cost around $1,000 to seed ads with the NSA&#39;s cookies around the Web. 
</p> <p>
&#34;$50,000 would be overkill,&#34; he said.
</p><p>
Because the NSA is essentially using how the Web functions to spy on its users, tools like Tortilla that <span section="shortcodeLink"><a href="https://www.cnet.com/home/tortilla-tool-makes-anonymizer-tor-more-digestible/" rel="follow"><span>take the burden of Tor usage away from Firefox</span></a></span> wouldn&#39;t prevent the NSA&#39;s tracking ads from finding people.
</p><p>
It wouldn&#39;t be feasible for Google to block ad buys from the NSA, and if the company did, he said, &#34;they could just buy through a proxy.&#34;
</p><p>
Google did not respond to a request for comment.
</p><p>
Both <a href="https://blog.torproject.org/blog/yes-we-know-about-guardian-article" rel="noopener nofollow" target="_blank">Tor itself</a> and Schneier noted that the NSA has not been able to track every Tor user this way. &#34;They are hard for any organization other than the NSA to reliably execute, because they require the attacker to have a privileged position on the Internet backbone,&#34; Schneier said.
</p><p>
Grossman speculated that the NSA could be using spam e-mail campaigns as it&#39;s been using display ads, though he cautioned that he didn&#39;t have evidence that this was actually happening. 
</p><p>
&#34;On the off chance that [the spam recipient] renders the HTML or clicks a link, [the NSA] can connect your e-mail address to your browser,&#34; he explained, which the NSA would have already connected to an IP address. &#34;Using Tor or any proxy wouldn&#39;t prevent it.&#34;
</p><p>
Not all Tor installations are created equal, added Hansen, who has an unusual pedigree in the browser vulnerability field because he&#39;s also a veteran of the ValueClick ad network, which was later bought by DoubleClick, which subsequently was purchased by Google.
</p><p>
&#34;It depends on whether you&#39;re using Tor Button or Tor Browser,&#34; he said. &#34;The Tor Button tends to be more secure because as you jump in and out of the Tor Browser, it tracks cache and cookies.&#34; 
</p><p>
However, since the Tor Project now includes a patched version of Firefox, it recommends <a href="https://www.torproject.org/torbutton/" rel="noopener nofollow" target="_blank">not using the Tor Button</a> and only using the standard <a href="https://www.torproject.org/download/download-easy.html.en" rel="noopener nofollow" target="_blank">Tor Browser Bundle</a> instead.
</p><p>
More secure than either, Hansen said, was to run Tor on a virtual machine so that cookies and cache are dumped when the machine is closed, and the kind of man-in-the-middle and man-on-the-side attacks described by Schneier are avoided.
</p><p>
&#34;If you don&#39;t <a href="https://www.torproject.org/download/download#warning" rel="noopener nofollow" target="_blank">take the critical steps to protect your privacy</a>, you will be de-cloaked if you&#39;re doing something interesting,&#34; Hansen said.
</p></div></div></div> </div></div>
  </body>
</html>
