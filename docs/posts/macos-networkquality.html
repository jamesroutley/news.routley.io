<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cyberhost.uk/the-hidden-macos-speedtest-tool-networkquality/">Original</a>
    <h1>MacOS networkQuality</h1>
    
    <div id="readability-page-1" class="page"><div>
              
              <!--kg-card-begin: markdown--><h2 id="getting-started-with-networkquality">Getting Started with networkQuality</h2>
<p>The networkQuality tool is a built-in tool released in macOS Monterey that can help diagnose network issues and measure network performance. In this post, we&#39;ll go over how to use the networkQuality tool and some of its key features.</p>
<h3 id="running-the-default-tests">Running the Default Tests</h3>
<p>To access the Network Quality tool, open the Terminal app on your Mac and enter the following command:</p>
<pre><code>networkQuality -v
</code></pre>
<p>This command starts the tool and performs the default set of tests, displaying the results in the Terminal window.</p>
<p>Example output:</p>
<pre><code>==== SUMMARY ====
Uplink capacity: 44.448 Mbps (Accuracy: High)
Downlink capacity: 162.135 Mbps (Accuracy: High)
Responsiveness: Low (73 RPM) (Accuracy: High)
Idle Latency: 50.125 milliseconds (Accuracy: High)
Interface: en0
Uplink bytes transferred: 69.921 MB
Downlink bytes transferred: 278.340 MB
Uplink Flow count: 16
Downlink Flow count: 12
Start: 13/05/2023, 15:04:13
End: 13/05/2023, 15:04:27
OS Version: Version 13.3.1 (a) (Build 22E772610a)
</code></pre>
<p>Usage:</p>
<pre><code>USAGE: networkQuality [-C &lt;configuration_url&gt;] [-c] [-h] [-I &lt;network interface name&gt;] [-k] [-p] [-r host] [-s] [-v]
    -C: override Configuration URL or path (with scheme file://)
    -c: Produce computer-readable output
    -h: Show help (this message)
    -I: Bind test to interface (e.g., en0, pdp_ip0,...)
    -k: Disable certificate validation
    -p: Use Private Relay
    -r: Connect to host or IP, overriding DNS for initial config request
    -s: Run tests sequentially instead of parallel upload/download
    -v: Verbose output
</code></pre>
<h3 id="using-private-relay">Using Private Relay</h3>
<p>The Network Quality tool also supports Apple&#39;s Private Relay feature, which encrypts and routes all network traffic through two separate servers for added privacy and security. To use Private Relay with the tool, you can add the &#34;-p&#34; flag to the command:</p>
<pre><code>networkQuality -v -p
</code></pre>
<h3 id="customizing-the-configuration">Customizing the Configuration</h3>
<p>You can customize the configuration used by the Network Quality tool. By default, the tool requests a configuration file from Apple everytime via <a href="https://mensura.cdn-apple.com/api/v1/gm/config">https://mensura.cdn-apple.com/api/v1/gm/config</a>. However, you can specify a different Configuration URL using the -C flag.</p>
<p>Apple&#39;s default config:</p>
<pre><code>{ &#34;version&#34;: 1,
  &#34;test_endpoint&#34;: &#34;uklon6-edge-bx-031.aaplimg.com&#34;,
  &#34;urls&#34;: {
      &#34;small_https_download_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/small&#34;,
      &#34;large_https_download_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/large&#34;,
      &#34;https_upload_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/slurp&#34;,
      &#34;small_download_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/small&#34;,
      &#34;large_download_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/large&#34;,
      &#34;upload_url&#34;: &#34;https://mensura.cdn-apple.com/api/v1/gm/slurp&#34;
   }
}
</code></pre>
<p>Apple&#39;s test_endpoint changes on each request, selecting a different nearby server to reduce latency and distributing their server load.</p>
<p>For example, if you have a custom configuration file located at <a href="https://networkquality.example.com/config">https://networkquality.example.com/config</a>, you can use the following command to run the Network Quality tool with your custom configuration:</p>
<pre><code>networkQuality -v -C https://networkquality.example.com/config
</code></pre>
<p>This command starts the tool and performs the tests using the configuration specified in the custom configuration file.</p>
<h3 id="creating-your-own-server">Creating Your Own Server</h3>
<p>If you want to set up your own server for the Network Quality tool, you can find documentation on how to do so on the project&#39;s GitHub page at <a href="https://github.com/network-quality/server">https://github.com/network-quality/server</a>. This allows you to customize the tool to your specific needs and run it on your own infrastructure.</p>
<p>Go Server: <a href="https://github.com/network-quality/goserver">https://github.com/network-quality/goserver</a></p>
<h2 id="conclusion">Conclusion</h2>
<p>The networkQuality tool in macOS is a powerful tool for measuring the performance of your network connection. The fact you can run the test via Apple Private Relay without iCloud+ is a neat feature. Next steps for me will be to self-host my own server which will be a good way to test network speeds locally.</p>
<p>networkQuality Wiki/Community: <a href="https://github.com/network-quality/community/wiki">https://github.com/network-quality/community/wiki</a></p>
<!--kg-card-end: markdown-->
                <section>
                  
                  <ul>
                      <li>
                        <a href="https://zck.org/tag/macos/" title="macOS">macOS</a>
                      </li>
                      <li>
                        <a href="https://zck.org/tag/unix/" title="Unix">Unix</a>
                      </li>
                  </ul>
                </section>
            </div></div>
  </body>
</html>
