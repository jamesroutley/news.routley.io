<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://macwright.com/2024/07/30/reverse-engineer-a-day.html">Original</a>
    <h1>Reverse engineering a day’s worth of websites</h1>
    
    <div id="readability-page-1" class="page"><div><p>Some light reverse-engineering of websites has been a source of entertainment and knowledge for me. I’ll poke around in the Chrome DevTools and figure out the basics of how popular websites work.</p><p>Sure, it’s common to compress JavaScript and other resources, and the HTML source of webpages no longer give many hints for technology – long gone are the days of having a <code>&lt;meta name=generator</code> tag that revealed your tech stack. But it’s pretty easy to suss out the major tech involved and reading obfuscated source isn’t too bad. The more you practice the easier it is to notice the patterns.</p><p>Here’s some of what I look at in a day, with some quick reverse-engineering applied. It’s interesting to get a sample of these applications, the ones that I use on a daily basis.</p><p><strong>The websites</strong></p><ul><li><a href="#fastmail">Fastmail</a>: custom framework ‘Overture’, custom protocols</li><li><a href="#kagi">Kagi</a>: Vanilla JavaScript</li><li><a href="#github">GitHub</a>: Ruby on Rails + React + Web Components</li><li><a href="#linear">Linear</a>: React + the kitchen sink</li><li><a href="#discord">Discord</a>: React</li><li><a href="#sentry">Sentry</a>: React (open source)</li><li><a href="#obsidian">Obsidian</a>: Vanilla JavaScript + CodeMirror customized to the hilt</li><li><a href="#signal">Signal</a>: React (open source)</li><li><a href="#reddit">Reddit</a>: Web Components</li><li><a href="#lichess">Lichess</a>: Snabbdom</li></ul><h2 id="fastmail">Fastmail</h2><p>I’ve used <a href="https://www.fastmail.com/">Fastmail</a> for <a href="https://macwright.com/2018/04/26/leaving-google">six years</a> as an alternative to GMail. It’s the first thing I open every day. I like them a lot. I am not happy that they <a href="https://union.place/@fastmailunited">laid of 60% of the bargaining unit of a union that attempted to get a contract</a>.</p><p>Fastmail’s architecture is pretty cool! They have their own frontend framework called <a href="https://github.com/fastmail/overture">Overture</a>, their own rich text editor called <a href="https://github.com/fastmail/Squire">Squire</a>, and they are the main authors of <a href="https://jmap.io/">jmap</a>, a standard that aims to be the successor to IMAP/POP, but contains a lot of interesting batch query ideas.</p><p>JMAP reminds me of GraphQL in a lot of ways because it lets you batch requests, and it has a wacky sort of spec for requests &amp; responses.</p><h2 id="kagi">Kagi</h2><p>I’ve been using <a href="https://kagi.com/">Kagi</a> as a Google alternative for searching. It’s pretty great. There are <a href="https://d-shoot.net/kagi.html">reasons to doubt them</a>, but the pros outweigh the cons for me, and it is not easy to find a high-quality search engine.</p><p>Kagi’s search page doesn’t use any major framework. It looks like they wrote the essential UI code in vanilla JavaScript. They do use <a href="https://floating-ui.com/">floating-ui</a>, the excellent library for positioning floating elements like tooltips and popovers, that might become unnecessary because the <a href="https://developer.chrome.com/blog/anchor-positioning-api">CSS anchor spec will provide that functionality at the platform level</a> but for now is an absolute godsend and we use it at <a href="https://www.val.town/">Val Town</a> because both <a href="https://www.radix-ui.com/primitives/docs/components/tooltip">Radix</a> and <a href="https://github.com/tailwindlabs/headlessui">Headlessui</a> use floating-ui to solve some of the positioning math for them.</p><h2 id="github">GitHub</h2><p>Then I open GitHub for work. I’ve been using GitHub for my entire career and I love it. I think it’s one of the best designed, most useful websites out there. I have basically no complaints.</p><p>GitHub is famously a <a href="https://rubyonrails.org/">Ruby on Rails</a> shop, and they used to really embrace that style of frontend experience: they published a <a href="https://github.com/github/github-elements">set of web components</a> which were extremely good quality, powered a lot of UI using HTML fundamentals - <a href="https://github.com/muan/details-on-details">muan’s writing about the <code>&lt;details&gt;</code> element is a classic of the genre</a>.</p><p>They still do some of this stuff: for example, if you open the GitHub Activity Feed with your Chrome devtools open, and you hover over someone’s username in the feed for long enough for a hovercard to show up, you’ll see a web request to a URL like</p><div><div><pre><code>GET https://github.com/users/tmcwe/hovercard…
</code></pre></div></div><p>And if you look at the response body, you’ll see the contents of that hovercard as HTML! This used to be true even of inline autocompletions when you typed <code>@</code> in a text field - the list of autocomplete options were genuine HTML returned in an HTTP response. <a href="https://htmx.org/">htmx</a> is re-popularizing this pattern, but GitHub was doing it with web components and the Rails patterns now known under the <a href="https://hotwired.dev/">hotwired.dev</a> project group.</p><p>Nowadays, it’s a mix: some HTML stuff powered by Rails, some web components, and a bunch of React stuff. There’s still some magic happening with the <code>&lt;details&gt;</code> element, which brings me joy.</p><h2 id="linear">Linear</h2><p>We’ve been managing our tasks with <a href="https://linear.app/">Linear</a>. It’s extremely impressive, luxurious software but I have mixed feelings about it. I’ve encountered a bunch of bugs, and I think it provides so many ways to organize that things get over-organized and disorganized because there is a lack of authoritative “single dimension” ways to look at tasks - it always wants me to look at some filtered view that inevitably skips something important.</p><p>But there’s no denying that Linear is a work of art when it comes to engineering. I’ve studied the <a href="https://www.youtube.com/watch?v=WxK11RsLqp4&amp;t=2175s">videos about how Linear implemented</a> sync and <a href="https://www.youtube.com/watch?v=Wo2m3jaJixU">scaled it</a> in depth for when I was trying to build my own sync system. They heavily use <a href="https://github.com/mobxjs/mobx">MobX</a>, a state management system based on Observables (not to be confused with <a href="https://observablehq.com/">Observable</a>). Using computed and reactive state has never felt right to me so I’ve stuck with systems like <a href="https://jotai.org/">Jotai</a>, but Linear has really made it work, and is a classic example of a web app that has entirely desktop-app-like tradeoffs - they probably don’t care about initial load times at all, or server-rendering, but they do really care about offline usage and runtime speed.</p><p>Linear is a <a href="https://react.dev/">React</a> app, and quite a big one.</p><ul><li>They use <a href="https://prosemirror.net/">Prosemirror</a> for editing text - the other library from <a href="https://marijnhaverbeke.nl/">Marijn</a>, who also wrote <a href="https://codemirror.net/">CodeMirror</a>. He is a hero of the internet.</li><li>They use <a href="https://nivo.rocks/">Nivo</a> for data visualization components, like those line/area charts of cycle progress.</li><li>They use <a href="https://sentry.io/">Sentry</a> for catching and tracking bugs, <a href="https://react-spring.dev/docs">react-spring</a> for animation, and <a href="https://en.wikipedia.org/wiki/GraphQL">GraphQL</a> for querying remote data.</li><li>I think that Linear is using <a href="https://popper.js.org/docs/v2/tutorial/">Popper</a> predecessor to floating-ui, for its right-click menus and the like.</li></ul><h2 id="discord">Discord</h2><p>My team at work uses <a href="https://discord.com/">Discord</a> for group chat. Like Linear, Discord is really a web application with entirely desktop-app-like tradeoffs: they aren’t motivated by writing quick-loading basic HTML webpages or minimizing bundle size. It’s a lot of JavaScript magic and the focus is on power and runtime speed. I should note, though, that poking around in the HTML for Discord revealed some good attention to detail for <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA">ARIA accessibility</a> attributes. Good job, folks!</p><p>Discord is famously an <a href="https://elixir-lang.org/blog/2020/10/08/real-time-communication-at-scale-with-elixir-at-discord/">Elixir shop</a> when it comes to the backend - which makes perfect sense, as Erlang, the language that inspired the BEAM virtual machine that Elixir uses, was a major part of the <a href="https://en.wikipedia.org/wiki/Erlang_%28programming_language%29#Usage">WhatsApp success story</a>. There is a lot of very fancy WebSocket-based binary-encoding streaming happening under the hood for Discord.</p><p>Discord was harder to reverse-engineer than the rest - they aggressively compress everything and don’t have even slightly descriptive filenames. That said,</p><ul><li>Discord is still using <a href="https://webpack.js.org/">webpack</a>, which is pretty interesting. Webpack has some staying power with high-end setups: I’ve heard that Figma uses it quite a bit because there are advanced bundle-splitting problems that only Webpack solves. Most ‘hip’ companies have moved on to rollup, vite, esbuild, or whatever Next.js bundles.</li><li>Discord is using React, and surprisingly has a bunch of <a href="https://legacy.reactjs.org/docs/components-and-props.html">class components</a>! It’s surely a huge codebase so it makes sense that there’s some technical debt, or maybe they know about some case where class components are superior.</li><li>They use <a href="https://airbnb.io/lottie/#/">Lottie</a>, a library that lets you render animated graphics exported from After Effects, and <a href="https://github.com/react-dnd/react-dnd">react-dnd</a> for drag &amp; drop. They also have <a href="https://immutable-js.com/">Immutable-JS</a> in the bundle, a library that I used heavily back in <a href="https://www.mapbox.com/mapbox-studio">Mapbox Studio</a> but probably wouldn’t use today because it has a pretty high overhead and a costly learning curve for the rest of the team.</li><li>Like Linear, there’s <a href="https://sentry.io/">Sentry</a> for catching and tracking bugs.</li></ul><h2 id="sentry">Sentry</h2><p>We use Sentry for bug tracking at Val Town, and I open it up every morning to check for anything new. There’s no need to reverse-engineer Sentry because it’s <a href="https://github.com/getsentry/sentry">open source!</a></p><h2 id="obsidian"><a href="https://obsidian.md/">Obsidian</a></h2><p><a href="https://macwright.com/2024/06/16/how-i-use-obsidian">I use Obsidian quite a lot</a>. It’s where I manage my day-to-day TODO lists, track little things like what batteries I need to buy for my guitar pedals and thermometers.</p><p>It’s very high-quality software: it does some complex things, like searching large document collections and supporting a pretty expressive plugin API, and it rarely crashes or shows any flaws.</p><p>Like Linear and Discord, Obsidian works as an embedded webview: it’s using <a href="https://www.electronjs.org/">Electron</a> as a wrapper.</p><p>The main editing view of Obsidian is powered by <a href="https://codemirror.net/">CodeMirror</a>, but it’s an exceptionally customized version of CodeMirror which supports both Markdown rendered as rich text, and Markdown edited as raw code, all at the same time. They’ve done a really great job of building a very sophisticated integration with CodeMirror.</p><ul><li>They have a bit of technical debt (if I can call it that) in continued use of <a href="https://momentjs.com/">Moment</a>, a JavaScript library for parsing and manipulating dates, which is pretty thoroughly deprecated.</li><li>They use <a href="https://github.com/mixmark-io/turndown">turndown</a> to convert pasted HTML content into Markdown.</li><li>They use <a href="https://github.com/mathjax/MathJax">MathJAX</a> for embedded <a href="https://www.latex-project.org/">LaTeX</a> math equation support.</li></ul><p>Surprisingly, maybe, Obsidian doesn’t seem to use a major web framework. They don’t even appear to be using some high-level abstraction of their own - it’s a pretty Vanilla approach to JavaScript - creating div elements and slapping classes on them. It works really well!</p><h2 id="signal">Signal</h2><p>I use Signal for most of my group chats with friends. It’s magical software: it bridges the gap between the Android and iPhone users, the encryption has been <a href="https://ssd.eff.org/">pretty good</a>.</p><p>The Signal macOS app is yet another website in an electron wrapper. It doesn’t require any reverse-engineering because <a href="https://github.com/signalapp/Signal-Desktop">it’s open source</a>. The app is yet another React application, that uses <a href="https://redux.js.org/">Redux</a> to manage state, some bits of <a href="https://react-spectrum.adobe.com/react-aria/">react-aria</a> for accessible components, popper for floating elements, and a long list of other dependencies. They famously have a heavy-hitting engineering team and it shows.</p><h2 id="reddit">Reddit</h2><p>My afternoon distraction is mostly Reddit. They’ve actually transitioned between technologies recently: a year ago, the Reddit I was using was a React app, but now it’s built on <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components">Web Components</a> and custom elements. I’ve been writing about <a href="https://macwright.com/2024/01/24/on-web-components">the lack of web components success stories</a>, and Reddit is the first that I can personally testify to. I’m not sure if the WC version of Reddit is that much faster for my personal usage, but it certainly works pretty well.</p><p>They’re using <a href="https://lit.dev/">lit-html</a> for templating, and a custom set of components that they seem to call ‘shreddit’ internally.</p><h2 id="lichess">Lichess</h2><p>My other distraction is <a href="https://lichess.org/">Lichess</a>. I play a lot of chess. My rating has plummeted but I’m getting it back.</p><p>No mystery here - <a href="https://lichess.org/source">Lichess is open source</a>!</p><p>And it’s a masterful application - I’m continually impressed by how fast and capable Lichess is. The stack is Scala on the backend and they use <a href="https://github.com/snabbdom/snabbdom">snabbdom</a> to build frontend components.</p><hr/><p>What have we learned?</p><ul><li>For these kinds of web-applications, React is pretty common!</li><li>All applications have a bit of technical debt.</li><li>Two of my favorite applications had weird stacks (Fastmail and Lichess)</li><li>Long-lived websites like GitHub are more likely to have mixed stacks</li><li>Reddit is the first example of a Web Component-based site that I use</li></ul></div></div>
  </body>
</html>
