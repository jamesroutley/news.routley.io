<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bsago.me/posts/that-annoying-shade-of-blue">Original</a>
    <h1>That annoying shade of blue (2018)</h1>
    
    <div id="readability-page-1" class="page"><div><article><div><p><span>Tuesday, 13th March, 2018</span></p><a href="https://bsago.me/posts/that-annoying-shade-of-blue"></a></div><div><div><p>About twelve years ago, I didn’t have a gaming computer, but I did have <span translate="">NetHack</span>.
I’d leave my laptop on at home and SSH into it from the labs at school using <span translate="">PuTTY</span>.
Never got as far as ascending, though I touched one of the altars once.</p><p><span translate="">NetHack</span>, by the way, looks like this:</p></div></div><div><div><pre translate="">You miss the jackal.  The kitten bites the jackal.  The jackal is killed!

            ----------------
            |.........&lt;....|
            |...<span>@</span>..........|
            |<span>$</span>..<span>%</span>..........|
            |...f..........<span>-</span>############
            --.-.-----------          ##   # #
              ####                  ###     <span>*</span>
               ###                  #-------.--
                ##########          #|<span>........</span>|
                  -.-----.----      #|<span>........</span>|
                  |<span>..........</span>.`######|<span>........</span>|
                  |<span>..........</span>|#######.<span>........</span>|
                  |<span>..........</span>.#      |<span>........</span>|
                  ------------       ----------

Ben the Rhizotomist          St:8 Dx:14 Co:15 In:7 Wi:14 Ch:17  Neutral
Dlvl:1  $:1965 HP:2(12) Pw:5(5) AC:7  Exp:1</pre></div></div><div><div><p>You were a character on a screen.
Menus and prompts were characters on a screen.
The dungeon, monsters, and items on the ground were — you guessed it — characters printed to the screen and displayed using ANSI escape codes.
It may look basic, but there was a lot of <a href="https://everything2.com/title/You+have+a+sad+feeling+for+a+moment%252C+then+it+passes" title="You have a sad feeling for a moment, then it passes.">strategy and emotion</a> in those symbols.</p><p>One particular infamous critter was the <em>floating eye</em>: it did no damage itself, but if you attacked one, there’d be a ⅔ chance that you’d get temporarily paralysed, usually for a long enough time that something <em>else</em> could come along and kill you when you have no chance to react.</p><p>That’s only half the reason why it’s so deadly.
The other reason is that it appeared as a particular shade of dark blue that did a very good job of blending into a black terminal background.
Mistake that blue <code>e</code> for a blue <code>o</code>, and you’d be dead.</p></div></div><div><div><h2 id="framebuffer-colours">Framebuffer colours
<a href="#framebuffer-colours" aria-hidden="true">#</a></h2><p>Technically, this wasn’t NetHack’s fault.
It couldn’t just pick its own shade of blue, because console applications only had eight colours to work with.
Some of them cheated by making bold text slightly brighter, resulting in these sixteen possible colours:</p></div></div><div><div><table><tbody><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td></tr><tr><td>08</td><td>09</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div></div><div><div><p>You can see what made floating eyes in particular so annoying.
(They used colour #4, of course. Not colour #12.)</p><p>It’s possible to change these colours into better-looking ones, but not everyone did, or could.
<span translate="">PuTTY</span> stores its configuration in the registry, and my school didn’t save registry settings, so I ended up having to change it every time I wanted to play and not die.</p><p>The same thing happens with lots of command-line programs.
<code translate="">vim</code> <a href="https://unix.stackexchange.com/questions/88879/better-colors-so-comments-arent-dark-blue-in-vim" title="“Better colors so comments aren’t dark blue in Vim?”">highlights comments as blue</a> by default, so if you’re stuck in a Linux framebuffer and need to edit a file, most of it’s going to be unreadable.
<code>ls</code> <a href="https://www.redhat.com/archives/rhl-list/2006-July/msg02043.html" title="“Re: possible to lighten blue color in bash shell ?”">highlights directories as blue</a>, too, meaning you have to squint in order to read anything.
These venerable programs used millions of times every day… are they <em>broken</em>?</p></div></div><div><div><pre translate=""><span># /etc/profile: system-wide .profile file for the Bourne shell (sh(1))</span>
<span># and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).</span>

<span>if [ &#34;</span><span>$PS1</span><span>&#34; ]; then</span>
&#34;/etc/profile&#34; 27L, 575C                                 1,1          Top</pre></div></div><div><p>The problem is that these colours weren’t <em>picked</em> at all.</p></div><div><div><p>If you’ve ever wondered why the console colours are in the order they are, look at the table: the last three bits of the number are the same as the blue, green, and red components of the colour respectively.</p><p>I can’t find any documentation on where these colours came from — they seem to have been passed down from terminal to terminal since the dawn of time.
But this can’t be a coincidence!</p><p>This colour palette is flawed in two ways: yellow, purple, and cyan are always going to appear brighter than red, green, and blue, because they’re just two of those colours added together.
Add red and green, and you get a yellow as bright as the red and the green combined, rather than the average of the two you’d get if you <em>mixed</em> them.</p></div><div><table><tbody><tr><th></th><th></th><th>#</th><th>Binary</th><th>RGB</th></tr><tr><td>Black</td><td><span></span></td><td>(0)</td><td><code>000</code></td><td><code>#000</code></td></tr><tr><td>Red</td><td><span></span></td><td>(1)</td><td><code>00<b>1</b></code></td><td><code>#<b>F</b>00</code></td></tr><tr><td>Green</td><td><span></span></td><td>(2)</td><td><code>0<b>1</b>0</code></td><td><code>#0<b>F</b>0</code></td></tr><tr><td>Yellow</td><td><span></span></td><td>(3)</td><td><code>0<b>11</b></code></td><td><code>#<b>FF</b>0</code></td></tr><tr><td>Blue</td><td><span></span></td><td>(4)</td><td><code><b>1</b>00</code></td><td><code>#00<b>F</b></code></td></tr><tr><td>Purple</td><td><span></span></td><td>(5)</td><td><code><b>1</b>0<b>1</b></code></td><td><code>#<b>F</b>0<b>F</b></code></td></tr><tr><td>Cyan</td><td><span></span></td><td>(6)</td><td><code><b>11</b>0</code></td><td><code>#0<b>FF</b></code></td></tr><tr><td>White</td><td><span></span></td><td>(7)</td><td><code><b>111</b></code></td><td><code>#<b>FFF</b></code></td></tr></tbody></table></div></div><div><div><p>But it also assumes that the human eye is going to respond to all colours the same way.
Look again at the set of framebuffer colours above: the green (<code>#0<b>F</b>0</code>) appears brighter than the red (<code>#<b>F</b>00</code>), which appears brighter than the blue (<code>#00<b>F</b></code>) — and yet they should all have the brightness of one <code><b>F</b></code> plus two <code>0</code> components.
What gives?</p><p>It turns out, the bug is in <em>our eyes</em>.</p></div></div><div><div><h2 id="human-vision">Cone cells and human colour vision
<a href="#human-vision" aria-hidden="true">#</a></h2><p>Each RGB pixel on a computer monitor emits a certain amount of red, a certain amount of green, and a certain amount of blue, depending on which colour it’s showing.
Human eyes, on the other hand, are not neatly subdivided into red, green, and blue cone cells.
We have <b title="Long">L</b>, mostly for greenish yellow, <b title="Medium">M</b>, mostly for yellowish green, and <b title="Short">S</b>, for blues and purples.
They overlap to varying degrees, and some colours (wavelengths) of light will make all three cone cells respond:</p></div></div><div><section><img src="https://bsago.b-cdn.net/a/posts/blue/cone-fundamentals.svg" height="200" alt="A chart of how effective our cone cells are across wavelengths"/><p>A chart of how effective the <b>S</b>, <b>M</b>, and <b>L</b> cone cells are across wavelengths between 400 and 700 nanometres.
The chart is normalised so each line has the same maximum.</p></section></div><div><div><p>The reason green (<code>#0<b>F</b>0</code>) appears brighter than blue (<code>#00<b>F</b></code>) is because of the way the yellowish-green-receiving <b>M</b> cone spans almost the entire visible spectrum, while the blue-and-purple <b>S</b> cone spans under half of it.
A green light is going to activate more cone cells than a blue one, making that green appear brighter.</p><p>This means you can’t rely on colours to have the same <em>visible brightness</em>, just because they contain the same hex digits!</p><p><i>(Update! I just read a very interesting blog post that goes into a lot more detail. For more information on this, please read <a href="http://jamie-wong.com/post/color/" title="“Color: From Hexcodes to Eyeballs”">Color: From Hexcodes to Eyeballs</a>.)</i></p></div></div><div><div><h2 id="software">What should software do?
<a href="#software" aria-hidden="true">#</a></h2><p>The question remains:
<b>If you’re developing command-line software, should you be using dark blue?</b></p><p>NetHack’s DevTeam didn’t seem to mind the blue so much, because NetHack was a <em>game</em>, not productivity software, and you didn’t <em>have</em> to play it.
Modern-day games make use of the mouse wheel, even though a decade ago not every mouse had a wheel; the hardware and software that the game is running on is not part of the game itself.</p><p>We can’t change human eyes, either.
The user base is seven billion and the upgrade procedure is… non-trivial.</p><p>But as the author of <a href="https://the.exa.website/" title="exa, my ls replacement">a very colourful command-line program</a>, I’m hesitant to ship software that, by default, will be unreadable for a certain group of people.
Yes, anybody who knows enough about the command-line to use a <i>ls</i> replacement will also probably know how to make everything use their own colour scheme, but that’s not a universal truth, like how I couldn’t save my colours at school.</p><p>And having to squint at <span>exa</span>’s output the first time you use it doesn’t exactly make for a good first impression.
Rebutting with <i>“But it’s technically your terminal emulator’s fault!”</i> won’t stop anyone from being annoyed.</p><p><b>I’m going to keep on using blue anyway</b>, because the tides <em>are</em> turning.</p><p>A few months ago, Microsoft announced that they’d be <a href="https://blogs.msdn.microsoft.com/commandline/2017/08/02/updating-the-windows-console-colors/" title="“Updating the Windows Console Colors”">changing the default Windows console colours</a> so the colours are actually readable:</p></div></div><div><div><table><tbody><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td></tr><tr><td>08</td><td>09</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div></div><div><p>And Linux distributions ship with something decent — here’s Ubuntu:</p></div><div><div><table><tbody><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td></tr><tr><td>08</td><td>09</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div></div><div><div><p>The lone holdout seems to be <span translate="">PuTTY</span>, which, despite regular updates, keeps using a colour scheme from the ’90s.</p><p>The point is, there’s no reason why this bug — and it is a bug! — should have stuck around for so long.
If your terminal emulator gets told to make text <em>blue</em>, and instead it makes it <em>unreadable</em>, then you can’t say that’s not a problem with the terminal emulator.</p><p>I’m sure that whichever terminal first debuted colour support actually displayed them all correctly.
But at some point along the way, something got lost.
Maybe computer screens have been getting less bright over time, and the effect slowly grew more pronounced.
Or maybe an engineer just threw some colours together one day, without testing how they looked together.
Whatever it was that happened, people ended up believing that it was <em>supposed</em> to be too dark to read.
The Xterm FAQ even says that <a href="http://invisible-island.net/xterm/xterm.faq.html#dont_like_blue" title="“I don’t like that shade of blue”">“there are no standards for terminal colours”</a> as though that were an excuse to implement an absolutely terrible default.</p><p>It’s never too late to fix problems like these.
Let’s not cling to the past over something that could easily just have been a mistake.<span>∎</span></p></div></div></article></div></div>
  </body>
</html>
