<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ndilieto/uacme">Original</a>
    <h1>Uacme: ACMEv2 client written in plain C with minimal dependencies</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto"><a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow"><img src="https://repository-images.githubusercontent.com/182530051/6d85b680-8e9d-11e9-91b9-0bc9eefac05e" alt="uacme manual"/></a></p>

<p dir="auto">lightweight client for the <a href="https://tools.ietf.org/html/rfc8555" rel="nofollow">RFC8555</a> ACMEv2 protocol, written in
plain C with minimal dependencies (<a href="https://curl.haxx.se/libcurl" rel="nofollow">libcurl</a> and one of
<a href="https://gnutls.org" rel="nofollow">GnuTLS</a>, <a href="https://www.openssl.org" rel="nofollow">OpenSSL</a> or <a href="https://tls.mbed.org" rel="nofollow">mbedTLS</a>).
The ACMEv2 protocol allows a Certificate Authority (<a href="https://letsencrypt.org" rel="nofollow">Let&#39;s Encrypt</a>
is a popular one) and an applicant to automate the process of verification
and certificate issuance. The protocol also provides facilities for other
certificate management functions, such as certificate revocation.</p>
<h2 dir="auto"><a id="user-content-features" aria-hidden="true" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h2>
<ul dir="auto">
<li><strong>Lightweight</strong> - Unlike most other ACME clients <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> does one
thing only and tries to do it well, according to the <a href="https://en.wikipedia.org/wiki/Unix_philosophy" rel="nofollow">Unix philosophy</a>.
For example don&#39;t expect it to automatically set up your webserver to use the
certificates it obtains.</li>
<li><strong>Written in C</strong> - It runs on any unix machine, including Linux, BSD, ...</li>
<li><strong>Minimal dependencies</strong> - Other than the standard C library, <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a>
depends only on <a href="https://curl.haxx.se/libcurl" rel="nofollow">libcurl</a> and one of <a href="https://gnutls.org" rel="nofollow">GnuTLS</a>,
<a href="https://www.openssl.org" rel="nofollow">OpenSSL</a> or <a href="https://tls.mbed.org" rel="nofollow">mbedTLS</a>. It does all the cryptography and
network communications without spawning external processes.
Particularly when using mbedTLS, it is small enough to run on embedded systems
with severe RAM and program memory restrictions (such as OpenWRT routers, for
example).  This is in contrast to solutions based on python or shell scripts,
which may well be a few hundred lines but require many other large applications
such as python or openssl to work.</li>
<li><strong>Native ECC support</strong> - Elliptic Curve keys and certificates can be
generated with a commmand line option (-t EC)</li>
<li><strong>Easily extensible</strong> - It optionally calls an external hook program
with the tokens required for domain authorization by the server. The
hook program can be an executable, shell script, perl script, python
script, or any file that the operating system can execute.</li>
<li><strong>ACME challenge agnostic</strong> - It provides the user or hook program
with all tokens and information required to complete any challenge type
but leaves the task of setting up and cleaning up the challenge environment
to the user or hook. Example shell scripts to handle <a href="https://github.com/ndilieto/uacme/blob/master/uacme.sh">http-01</a>,
<a href="https://github.com/ndilieto/uacme/blob/master/nsupdate.sh">dns-01</a> and <a href="https://github.com/ndilieto/uacme/blob/master/ualpn.sh">tls-alpn-01</a> challenges are provided.</li>
<li><strong>Zero downtime <a href="#tls-alpn-01-challenge-support">tls-alpn-01 support</a></strong> - The distribution also
includes <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a>, a lightweight proxying tls-alpn-01 challenge responder
compliant with <a href="https://tools.ietf.org/html/rfc8737" rel="nofollow">RFC8737</a> and <a href="https://tools.ietf.org/html/rfc8738" rel="nofollow">RFC8738</a>.</li>
<li><strong>Can run as a cron job</strong> - to renew certificates automatically
when needed, even for remote machines</li>
<li><strong>Robust</strong> - It checks every operation, retrying or failing gracefully
as appropriate</li>
<li><strong>Detailed error reporting</strong> - By default totally quiet when everything
works ok, it reports precise and detailed error information on stderr
when something goes wrong. Optionally it can also print debug information
by specifying the <strong>--verbose</strong> flag once or more.</li>
</ul>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<p dir="auto"><strong>Note: pristine releases are in the upstream/latest branch, tagged as
upstream/x.x.x</strong></p>
<div data-snippet-clipboard-copy-content="mkdir uacme
wget -O - https://github.com/ndilieto/uacme/archive/upstream/latest.tar.gz | tar zx -C uacme --strip-components=1
cd uacme
./configure --disable-maintainer-mode
make install"><pre><code>mkdir uacme
wget -O - https://github.com/ndilieto/uacme/archive/upstream/latest.tar.gz | tar zx -C uacme --strip-components=1
cd uacme
./configure --disable-maintainer-mode
make install
</code></pre></div>
<p dir="auto">If you just want to check out the latest pristine release from github:</p>
<div data-snippet-clipboard-copy-content="git clone -b upstream/latest https://github.com/ndilieto/uacme"><pre><code>git clone -b upstream/latest https://github.com/ndilieto/uacme
</code></pre></div>
<p dir="auto"><a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> is included in several distributions:</p>
<ul dir="auto">
<li><a href="https://packages.debian.org/uacme" rel="nofollow">https://packages.debian.org/uacme</a></li>
<li><a href="https://packages.ubuntu.com/uacme" rel="nofollow">https://packages.ubuntu.com/uacme</a></li>
<li><a href="https://software.opensuse.org/package/uacme" rel="nofollow">https://software.opensuse.org/package/uacme</a></li>
<li><a href="https://pkgs.alpinelinux.org/packages?name=uacme" rel="nofollow">https://pkgs.alpinelinux.org/packages?name=uacme</a></li>
<li><a href="https://aur.archlinux.org/packages/uacme" rel="nofollow">https://aur.archlinux.org/packages/uacme</a></li>
<li><a href="https://voidlinux.org/packages/?q=uacme" rel="nofollow">https://voidlinux.org/packages/?q=uacme</a></li>
<li><a href="https://cvsweb.openbsd.org/ports/security/uacme" rel="nofollow">https://cvsweb.openbsd.org/ports/security/uacme</a></li>
<li><a href="https://www.freshports.org/security/uacme" rel="nofollow">https://www.freshports.org/security/uacme</a></li>
<li><a href="https://github.com/openwrt/packages/tree/master/net/uacme">https://github.com/openwrt/packages/tree/master/net/uacme</a></li>
<li><a href="https://github.com/buildroot/buildroot/tree/master/package/uacme">https://github.com/buildroot/buildroot/tree/master/package/uacme</a></li>
</ul>
<h2 dir="auto"><a id="user-content-getting-started" aria-hidden="true" href="#getting-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting started</h2>
<p dir="auto">Once you have obtained <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> (see Installation above) the next step
is creating an ACME account:</p>
<div data-snippet-clipboard-copy-content="uacme -v -c /path/to/uacme.d new"><pre><code>uacme -v -c /path/to/uacme.d new
</code></pre></div>
<p dir="auto">The configuration directory and account private key should have been created:</p>
<div data-snippet-clipboard-copy-content="/path/to/uacme.d/private/key.pem"><pre><code>/path/to/uacme.d/private/key.pem
</code></pre></div>
<p dir="auto">You can then issue a certificate for your domain by doing</p>
<div data-snippet-clipboard-copy-content="uacme -v -c /path/to/uacme.d issue www.your.domain.com"><pre><code>uacme -v -c /path/to/uacme.d issue www.your.domain.com
</code></pre></div>
<p dir="auto">If everything goes well <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> asks you to set up a challenge, for
example</p>
<div data-snippet-clipboard-copy-content="uacme: challenge=http-01 ident=www.your.domain.com token=kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4
key_auth=kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4.2evcXalKLhAybRuxxE-HkSUihdzQ7ZDAKA9EZYrTXwU"><pre><code>uacme: challenge=http-01 ident=www.your.domain.com token=kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4
key_auth=kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4.2evcXalKLhAybRuxxE-HkSUihdzQ7ZDAKA9EZYrTXwU
</code></pre></div>
<p dir="auto">Note the challenge type in the example is http-01 which means you should set
up your web server to serve a URL based on the token:</p>
<div data-snippet-clipboard-copy-content="http://www.your.domain.com/.well-known/acme-challenge/kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4"><pre><code>http://www.your.domain.com/.well-known/acme-challenge/kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4
</code></pre></div>
<p dir="auto">The URL must return a text file containing a single line with the key
authorization:</p>
<div data-snippet-clipboard-copy-content="kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4.2evcXalKLhAybRuxxE-HkSUihdzQ7ZDAKA9EZYrTXwU"><pre><code>kZjqYgAss_sl4XXDfFq-jeQV1_lqsE76v2BoCGegFk4.2evcXalKLhAybRuxxE-HkSUihdzQ7ZDAKA9EZYrTXwU
</code></pre></div>
<p dir="auto">After setting up the web server you can then type &#39;y&#39; followed by a newline.
This notifies the ACME server that it can proceed with the challenge
verification.  If the procedure is successful <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> saves the
certificate and the key at:</p>
<div data-snippet-clipboard-copy-content="/path/to/uacme.d/www.your.domain.com/cert.pem
/path/to/uacme.d/private/www.your.domain.com/key.pem"><pre><code>/path/to/uacme.d/www.your.domain.com/cert.pem
/path/to/uacme.d/private/www.your.domain.com/key.pem
</code></pre></div>
<p dir="auto">Note several challenge types are possible. If you type anything other than
&#39;y&#39;, <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> skips the challenge and proposes a different one. The
easiest is http-01 but any other type can be dealt with. Keep in mind that
challenge types may be served in random order by the server. Do not make any
assumptions and read what <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> outputs carefully.</p>
<h2 dir="auto"><a id="user-content-automating-updates" aria-hidden="true" href="#automating-updates"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Automating updates</h2>
<p dir="auto">Use the -h flag to manage the challenge with a hook script:</p>
<div data-snippet-clipboard-copy-content="uacme -v -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com"><pre><code>uacme -v -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com
</code></pre></div>
<p dir="auto">or (depending on your installation)</p>
<div data-snippet-clipboard-copy-content="uacme -v -c /path/to/uacme.d -h /usr/local/share/uacme/uacme.sh issue www.your.domain.com"><pre><code>uacme -v -c /path/to/uacme.d -h /usr/local/share/uacme/uacme.sh issue www.your.domain.com
</code></pre></div>
<p dir="auto">This will use the example <a href="https://github.com/ndilieto/uacme/blob/master/uacme.sh">uacme.sh</a> hook script included in the
distribution to manage http-01 challenges. You might need to edit the script
to match your webserver&#39;s environment.</p>
<p dir="auto">Once everything works correctly you can also set up cron, for example</p>
<div data-snippet-clipboard-copy-content="6 15 * * * /usr/bin/uacme -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com "><pre><code>6 15 * * * /usr/bin/uacme -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com 
</code></pre></div>
<p dir="auto">The cron job will automatically update the certificate when needed.  Note the
absence of -v flag, this makes <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> only produce output upon errors.</p>
<p dir="auto">Note also that you will need to restart or reload any service that uses the
certificate, to make sure it uses the renewed one. This is system and
installation dependent. I normally put the necessary instructions in another
script (for example /usr/share/uacme/reload.sh) that is executed by cron
when <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> returns 0 (indicating the certificate has been reissued).</p>
<div data-snippet-clipboard-copy-content="6 15 * * * /usr/bin/uacme -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com &amp;&amp; /usr/share/uacme/reload.sh"><pre><code>6 15 * * * /usr/bin/uacme -c /path/to/uacme.d -h /usr/share/uacme/uacme.sh issue www.your.domain.com &amp;&amp; /usr/share/uacme/reload.sh
</code></pre></div>
<p dir="auto">Check <a href="https://github.com/jirutka/muacme">https://github.com/jirutka/muacme</a> for a complete, ready-to-go solution.</p>
<h2 dir="auto"><a id="user-content-dns-01-challenge-support" aria-hidden="true" href="#dns-01-challenge-support"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>dns-01 challenge support</h2>
<p dir="auto">The <a href="https://github.com/ndilieto/uacme/blob/master/nsupdate.sh">nsupdate.sh</a> hook script included in the distribution allows
managing dns-01 challenges with <a href="https://linux.die.net/man/1/nsupdate" rel="nofollow">nsupdate</a>. This only works if your
name server supports <a href="https://tools.ietf.org/html/rfc2136" rel="nofollow">RFC2136</a> (<a href="https://www.isc.org/bind" rel="nofollow">bind</a> does, <a href="https://www.nlnetlabs.nl/projects/nsd" rel="nofollow">nsd</a> doesn&#39;t).</p>
<p dir="auto"><a href="https://gitlab.alpinelinux.org/alpine/infra/docker/uacme-nsd-wildcard" rel="nofollow">https://gitlab.alpinelinux.org/alpine/infra/docker/uacme-nsd-wildcard</a>
is another example that works with <a href="https://www.nlnetlabs.nl/projects/nsd" rel="nofollow">nsd</a>.</p>
<p dir="auto"><a href="https://gist.github.com/Gowee/e756f925cfcbd5ab32d564ee3c795786">https://gist.github.com/Gowee/e756f925cfcbd5ab32d564ee3c795786</a> shows how
to integrate with <a href="https://api.cloudflare.com/#dns-records-for-a-zone-create-dns-record" rel="nofollow">Cloudflare API</a>.</p>
<p dir="auto"><a href="https://github.com/tdy91/uacme-gandi-hook">https://github.com/tdy91/uacme-gandi-hook</a> works with <a href="https://api.gandi.net/docs/livedns" rel="nofollow">gandi.net</a>.</p>
<h2 dir="auto"><a id="user-content-tls-alpn-01-challenge-support" aria-hidden="true" href="#tls-alpn-01-challenge-support"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>tls-alpn-01 challenge support</h2>
<p dir="auto"><a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> is a lightweight proxying <a href="https://tools.ietf.org/html/rfc8737" rel="nofollow">tls-alpn-01</a> challenge
responder, designed to handle incoming HTTPS connections on port 443.
Most of the time it just transparently proxies connections to the real web
server (which can be on either another machine, or a different TCP port on
the same machine).
When a tls-alpn-01 challenge handshake comes in <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> handles it on
the fly instead of proxying it to the webserver. This means that unlike other
available tls-alpn-01 responders, <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> does not require your
webserver to stop during the challenge (zero downtime).</p>
<p dir="auto">The high performance event-driven implementation is based on <a href="http://libev.schmorp.de" rel="nofollow">libev</a>
which considerably reduces the cost of context switches and memory usage. In
addition on systems such as Linux supporting the <a href="https://en.wikipedia.org/wiki/Splice_%28system_call%29" rel="nofollow">splice()</a> system
call, <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> is able to move network data entirely in kernel memory
without a round trip to user space, which further enhances performance.</p>
<p dir="auto"><a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> also listens to a UNIX domain socket so that it can be fed the
necessary tls-alpn-01 key authorizations for the domains being validated
by the ACME server. <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> was designed to be easy to integrate with
not only <a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a> (check the example <a href="https://github.com/ndilieto/uacme/blob/master/ualpn.sh">ualpn.sh</a> hook script)
but also other ACME clients. A <a href="https://github.com/ndilieto/certbot-ualpn">certbot plugin</a> is also available.</p>
<p dir="auto">To get started with <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a>:</p>
<ul dir="auto">
<li>move your real HTTPS server to port 4443 which doesn&#39;t need to be open
to the outside (only ualpn will connect to it) and set it up to accept the
<a href="http://www.haproxy.org/download/1.8/doc/proxy-protocol.txt" rel="nofollow">PROXY protocol</a>:
<ul dir="auto">
<li>for nginx: <a href="https://docs.nginx.com/nginx/admin-guide/load-balancer/using-proxy-protocol" rel="nofollow">https://docs.nginx.com/nginx/admin-guide/load-balancer/using-proxy-protocol</a>
<div data-snippet-clipboard-copy-content="server {
    listen 127.0.0.1:4443 ssl proxy_protocol;
    set_real_ip_from 127.0.0.0/24;
    real_ip_header proxy_protocol;
    proxy_set_header X-Real-IP $proxy_protocol_addr;
    proxy_set_header X-Forwarded-For $proxy_protocol_addr;
    ..."><pre><code>server {
    listen 127.0.0.1:4443 ssl proxy_protocol;
    set_real_ip_from 127.0.0.0/24;
    real_ip_header proxy_protocol;
    proxy_set_header X-Real-IP $proxy_protocol_addr;
    proxy_set_header X-Forwarded-For $proxy_protocol_addr;
    ...
</code></pre></div>
</li>
<li>for apache: <a href="https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html#remoteipproxyprotocol" rel="nofollow">https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html#remoteipproxyprotocol</a>
<div data-snippet-clipboard-copy-content="Listen 4443
&lt;VirtualHost *:4443&gt;
    RemoteIPProxyProtocol On
    ..."><pre><code>Listen 4443
&lt;VirtualHost *:4443&gt;
    RemoteIPProxyProtocol On
    ...
</code></pre></div>
</li>
</ul>
</li>
<li>launch <a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a> as a daemon and check the logs (by default in syslog)
<div data-snippet-clipboard-copy-content="sudo ualpn -v -d -u nobody:nogroup -c 127.0.0.1@4443 -S 666"><pre><code>sudo ualpn -v -d -u nobody:nogroup -c 127.0.0.1@4443 -S 666
</code></pre></div>
</li>
<li>create an ACME account
<div data-snippet-clipboard-copy-content="uacme -v -s -c /path/to/uacme.d -y new"><pre><code>uacme -v -s -c /path/to/uacme.d -y new
</code></pre></div>
</li>
<li>try obtaining a certificate with tls-alpn-01 challenge
<div data-snippet-clipboard-copy-content="uacme -v -s -c /path/to/uacme.d -h /usr/share/uacme/ualpn.sh issue www.your.domain.com"><pre><code>uacme -v -s -c /path/to/uacme.d -h /usr/share/uacme/ualpn.sh issue www.your.domain.com
</code></pre></div>
or, depending on your installation
<div data-snippet-clipboard-copy-content="uacme -v -s -c /path/to/uacme.d -h /usr/local/share/uacme/ualpn.sh issue www.your.domain.com"><pre><code>uacme -v -s -c /path/to/uacme.d -h /usr/local/share/uacme/ualpn.sh issue www.your.domain.com
</code></pre></div>
</li>
</ul>
<h2 dir="auto"><a id="user-content-documentation" aria-hidden="true" href="#documentation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Documentation</h2>
<p dir="auto">There are regular unix man pages in the distribution, also available in HTML:
<a href="https://ndilieto.github.io/uacme/uacme.html" rel="nofollow">uacme</a>
<a href="https://ndilieto.github.io/uacme/ualpn.html" rel="nofollow">ualpn</a></p>
<h2 dir="auto"><a id="user-content-bugs-and-suggestions" aria-hidden="true" href="#bugs-and-suggestions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Bugs and suggestions</h2>
<p dir="auto">If you believe you have found a bug, please log it at <a href="https://github.com/ndilieto/uacme/issues">https://github.com/ndilieto/uacme/issues</a></p>
<p dir="auto">If you have any suggestions for improvements, pull requests are welcome.</p>
</article>
          </div></div>
  </body>
</html>
