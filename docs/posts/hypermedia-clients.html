<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://htmx.org/essays/hypermedia-clients/">Original</a>
    <h1>Hypermedia Clients</h1>
    
    <div id="readability-page-1" class="page"><div>
    
<p>Often, when we are being insufferably pedantic in <a href="https://news.ycombinator.com/item?id=32141027">online discussions</a>
about <a href="https://htmx.org/essays/how-did-rest-come-to-mean-the-opposite-of-rest/">REST</a> &amp; <a href="https://htmx.org/essays/hateoas">HATEOAS</a>, we will
say something along the lines of this:</p>
<blockquote>
<p>JSON isn&#39;t a hypermedia because it doesn&#39;t have hypermedia controls.</p>
<p>Look at this JSON:</p>
</blockquote>
<pre><code><span>{</span>
 <span>&#34;account&#34;</span><span>:</span> <span>{</span>
   <span>&#34;account_number&#34;</span><span>:</span> <span>12345</span><span>,</span>
   <span>&#34;balance&#34;</span><span>:</span> <span>{</span>
     <span>&#34;currency&#34;</span><span>:</span> <span>&#34;usd&#34;</span><span>,</span>
     <span>&#34;value&#34;</span><span>:</span> <span>50.00</span>
   <span>}</span><span>,</span>
   <span>&#34;status&#34;</span><span>:</span> <span>&#34;open&#34;</span>
 <span>}</span>
<span>}</span>
</code></pre>
<blockquote>
<p>See?  No hypermedia controls.</p>
<p>So this JSON isn&#39;t a hypermedia, and, therefore, the API returning this JSON isn&#39;t RESTful.</p>
</blockquote>
<p>To this, occasionally, a smart and experienced web developer will reply with something along these lines:</p>
<blockquote>
<p>OK, mr. REST-y pants, how about this JSON?</p>
</blockquote>
<pre><code><span>{</span>
  <span>&#34;account&#34;</span><span>:</span> <span>{</span>
    <span>&#34;account_number&#34;</span><span>:</span> <span>12345</span><span>,</span>
    <span>&#34;balance&#34;</span><span>:</span> <span>{</span>
      <span>&#34;currency&#34;</span><span>:</span> <span>&#34;usd&#34;</span><span>,</span>
      <span>&#34;value&#34;</span><span>:</span> <span>50.00</span>
    <span>}</span><span>,</span>
    <span>&#34;status&#34;</span><span>:</span> <span>&#34;open&#34;</span><span>,</span>
    <span>&#34;links&#34;</span><span>:</span> <span>{</span>
      <span>&#34;deposits&#34;</span><span>:</span> <span>&#34;/accounts/12345/deposits&#34;</span><span>,</span>
      <span>&#34;withdrawals&#34;</span><span>:</span> <span>&#34;/accounts/12345/withdrawals&#34;</span><span>,</span>
      <span>&#34;transfers&#34;</span><span>:</span> <span>&#34;/accounts/12345/transfers&#34;</span><span>,</span>
      <span>&#34;close-requests&#34;</span><span>:</span> <span>&#34;/accounts/12345/close-requests&#34;</span>
    <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre>
<blockquote>
<p>There, now there are hypermedia controls in this response (normal humans call them links, btw) so this JSON is a
hypermedia.</p>
<p>So this JSON API is now RESTful.  Feel better?</p>
</blockquote>
<p>ðŸ˜‘</p>
<p>One must concede that, at least at a high-level, our online adversary has something of a talking point here: these
do appear to be hypermedia controls, and they are, in fact, in a JSON response.  So, couldn&#39;t you call this JSON response
RESTful?</p>
<p>Being obstinate by nature, we still wouldn&#39;t be willing to concede the immediate point without a good
<a href="https://i.imgur.com/DpQ9YJl.png">ackchyually</a> or two:</p>
<ul>
<li>First, these links hold no information about what HTTP method to use to access them</li>
<li>Secondly, these links aren&#39;t a <em>native</em> part of JSON the way that, for example, anchor and form tags are with HTML</li>
<li>Third, there is a lot of missing information about the hypermedia interactions at each end point (e.g. what data needs to
go up with the request.)</li>
</ul>
<p>And so on: the sorts of pedantic nit-picking that makes technical flame wars about REST on the internet such a <em>special</em> joy.</p>
<p>However, there is a deeper <a href="https://i.imgur.com/DpQ9YJl.png">ackchyually</a> here, and one that doesn&#39;t involve the <em>JSON API</em>
itself, but rather the other side of the wire: the <em>client</em> that receives the JSON.</p>
<h2>Hypermedia Clients &amp; Presentation Information</h2>
<p>The deeper problem with this proposed fix for non-RESTful JSON APIs is that, for this JSON response to participate
properly in a <a href="https://hypermedia.systems">hypermedia system</a>, the <em>client</em> that consumes the JSON needs to <em>also</em>
satisfy the <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">constraints</a> that the
RESTful architectural style places on the entire system.</p>
<p>In particular, the client needs to satisfy the <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_5">uniform interface</a>,
in which the client code knows nothing about the &#34;shape&#34; or details of the response beyond the ability to display
the given hypermedia to a user.  In a properly functioning RESTful system, the client isn&#39;t allowed to have any
&#34;out of band&#34; knowledge about the domain that a particular hypermedia representation, er, represents.</p>
<p>Let&#39;s look at the proposed JSON-as-hypermedia again:</p>
<pre><code><span>{</span>
  <span>&#34;account&#34;</span><span>:</span> <span>{</span>
    <span>&#34;account_number&#34;</span><span>:</span> <span>12345</span><span>,</span>
    <span>&#34;balance&#34;</span><span>:</span> <span>{</span>
      <span>&#34;currency&#34;</span><span>:</span> <span>&#34;usd&#34;</span><span>,</span>
      <span>&#34;value&#34;</span><span>:</span> <span>50.00</span>
    <span>}</span><span>,</span>
    <span>&#34;status&#34;</span><span>:</span> <span>&#34;open&#34;</span><span>,</span>
    <span>&#34;links&#34;</span><span>:</span> <span>{</span>
      <span>&#34;deposits&#34;</span><span>:</span> <span>&#34;/accounts/12345/deposits&#34;</span><span>,</span>
      <span>&#34;withdrawals&#34;</span><span>:</span> <span>&#34;/accounts/12345/withdrawals&#34;</span><span>,</span>
      <span>&#34;transfers&#34;</span><span>:</span> <span>&#34;/accounts/12345/transfers&#34;</span><span>,</span>
      <span>&#34;close-requests&#34;</span><span>:</span> <span>&#34;/accounts/12345/close-requests&#34;</span>
    <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre>
<p>Now, a client of this API <em>could</em> use a generic algorithm to transform this JSON into, for example, some HTML.  It could
do so via a client-side templating language that, for example, iterated over all the properties of the JSON object.</p>
<p>But there&#39;s a hitch: note that there isn&#39;t a lot of <em>presentation information</em> in the JSON response.  It is a fairly raw
data representation of the account in question, with a few additional URLs.</p>
<p>A client that wanted to satisfy the uniform interface constraint of REST doesn&#39;t have much information on how to present
this data to a user.  The client would, therefore, need to adopt a very basic approach to displaying this account to an
end user.</p>
<p>It would probably end up being roughly a set of name/value pairs and a set generic of buttons or links for actions, right?</p>
<p>There simply isn&#39;t much more it could do while remaining agnostic about the form of the JSON response.</p>
<h3>Pushing Our JSON API Further</h3>
<p>We could fix this by making our JSON API more elaborate and start including more information on how to lay out the
information: perhaps indications that some fields should be emphasized, or hidden, etc.</p>
<p>But that would only be part of the story.</p>
<p>We would also need to update the client side to interpret these new elements of our JSON API properly.  So we are no
longer just API designers: we are getting in to the hypermedia <em>client</em> creation business as well.  Or, more likely, we
are asking our <em>API clients</em> to get into the hypermedia client business as well.</p>
<p>Now, Mike Amundsen has written an <a href="https://www.oreilly.com/library/view/restful-web-clients/9781491921890/">excellent book</a> on
how to build a proper, generic hypermedia client.  But what you will see in that book is that creating a good hypermedia
client isn&#39;t trivial, and, further, it is certainly not what <em>most</em> engineers would build to consume a JSON API, even if
the JSON API had increasingly elaborate hypermedia controls and presentation information in their responses.</p>
<h3>&#34;Inefficient&#34; Representations</h3>
<p>As we begin to consider adding more information to our JSON response, a quote from Roy Fielding&#39;s dissertation jumps
to mind:</p>
<blockquote>
<p>The trade-off, though, is that a uniform interface degrades efficiency, since information is transferred in a
standardized form rather than one which is specific to an application&#39;s needs.</p>
</blockquote>
<p><em>-Roy Fielding, <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_5">https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_5</a></em></p>
<p>A criticism of HTML is that it mixes &#34;presentation&#34; information with &#34;semantic&#34; information.  This is often contrasted
unfavorably with the brevity of typical JSON API responses.</p>
<p>It turns out, however, that it is exactly that presentation information, and the ability of a web browser (i.e. a hypermedia client) to
turn it into a UI that a human can interact with, that makes HTML work so well as a component of the larger hypermedia
system that is the web.</p>
<p>And that exactly what we find ourselves adding to our own JSON API to support a proper hypermedia client.</p>
<h2>Building Hypermedia Clients</h2>
<p>So, you can see, just offering hypermedia controls in a JSON API response isn&#39;t enough.  It is <em>part</em> of the REST story,
but not the entire story.  And, I have come to understand, it is not really the <em>hard</em> part of the story.  In fact, creating the
hypermedia <em>client</em> is the hard part, and creating a <em>good</em> hypermedia client is <em>the really hard part</em>.</p>
<p>Now, we are all used to web browsers just being there, but think for a moment about all the technology that goes in to simply
parsing and rendering HTML to an end user in a normal, every day web request.  It&#39;s <em>extremely</em> complicated.</p>
<p>That&#39;s why, if we want to build web-based <a href="https://htmx.org/essays/hypermedia-driven-applications/">hypermedia-driven applications</a>,
it&#39;s probably a good idea to use the standard, web-based hypermedia client: the browser.</p>
<p>It is already an extremely powerful, well tested hypermedia client.  And, <a href="https://htmx.org/docs">with a bit of help</a>,
it can be an even better hypermedia client.</p>
<p>In general, building a good hypermedia client that satisfies all the constraints of REST is hard, and we should lean
towards using (and extending) existing clients rather than building our own new ones.</p>
<h3>Hyperview</h3>
<p>That being said, there are times when building a new hypermedia client is appropriate.  For example, this is what makes
a technology like <a href="https://hyperview.org/">Hyperview</a> so impressive and special.  Hyperview
doesn&#39;t just provide a specification for a new, mobile-friendly hypermedia, <a href="https://hyperview.org/docs/guide_html">HXML</a>.</p>
<p>It also provides developers with a hypermedia <em>client</em> that understands how to render HXML.</p>
<p>Without that hypermedia client, Hyperview would be just another hypermedia-in-theory, like the JSON above, rather
than a compelling, practical and <em>complete</em> RESTful hypermedia solution.</p>
<p>A hypermedia without a hypermedia client is like a fish without a bicycle, except where the fish is really only good at
bicycling.</p>
<h2>Conclusion</h2>
<p>It took me a long time to appreciate how important the <em>client</em> is to a proper, RESTful hypermedia system.  This is understandable,
since most of the early discussion around REST was around <a href="https://www.martinfowler.com/articles/richardsonMaturityModel.html">API Design</a>,
and the client simply didn&#39;t come up much.</p>
<p>What I see now is that a lot of these discussions were putting the cart before the horse: the only way a RESTful hypermedia
API can be useful is if it is consumed by a proper hypermedia client.  Otherwise, your hypermedia controls are wasted
on what is, at the end of the day, a domain-specific thick client that just wants to get things done.</p>
<p>Further, your hypermedia API is almost certainly going to have to carry a fair amount of presentation-layer information
in it to make the whole thing usable.  It turns out that &#34;Level 3&#34; of the
<a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richard Maturity Model</a>, Hypermedia Controls, <em>isn&#39;t</em>
enough to reach &#34;The Glory of REST&#34;.</p>
<p>In practice, you are going to need to add in a bunch of practical presentation-level technology to make
your hypermedia API really work, <em>and</em> you are going to need a properly built hypermedia client to consume it.</p>
<p>I had a nascent sense of this when I wrote <a href="https://intercoolerjs.org/2016/05/08/hatoeas-is-for-humans.html">HATEOAS Is For Humans</a>,
but I didn&#39;t, at that time, appreciate just how special the client/web browser was.</p>
<p>REST isn&#39;t solely about APIs: as Roy Fielding makes clear in his dissertation, it is a <em>system</em> architecture.</p>
<p>Except for a few people like <a href="https://training.amundsen.com/">Mike</a>, we&#39;ve been largely ignoring a larger (really,
<em>much</em> larger) part of the REST story:</p>
<p><img src="https://htmx.org/img/creating-client.png" alt="Creating A Hypermedia Client Is Hard Joke"/>
</p>
</div></div>
  </body>
</html>
