<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ziglang/zig/pull/25299">Original</a>
    <h1>Zig got a new ELF linker and it&#39;s fast</h1>
    
    <div id="readability-page-1" class="page"><div disabled="" sortable="">
<div>
          <h2 dir="auto">Release Notes</h2>
<p dir="auto">The new linker can be used with <code>-fnew-linker</code> in the CLI, or by setting <code>exe.use_new_linker = true</code> in a build script.</p>
<p dir="auto">It is already the default when passing <code>-fincremental</code> and targeting ELF.</p>
<p dir="auto">The performance is fast enough that there&#39;s no longer much of a benefit to exposing a <code>-Dno-bin</code> build step. You might as well keep codegen and linking always enabled because the compilation speed difference is negligible, and then you get an executable at the end.</p>
<h3 dir="auto">Performance Data Points</h3>
<p dir="auto">Old linker, building Zig compiler, then making a single-line change to a function, and then another:</p>
<div data-snippet-clipboard-copy-content="Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 18s


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 754ms


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 858ms"><pre><code>Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 18s


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 754ms


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 858ms
</code></pre></div>
<p dir="auto">New linker, building Zig compiler, then making a single-line change to a function, and then another:</p>
<div data-snippet-clipboard-copy-content="Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 18s
      └─ options success


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 73ms


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 72ms"><pre><code>Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 18s
      └─ options success


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 73ms


Build Summary: 4/4 steps succeeded
install success
└─ install zig success
   └─ compile exe zig Debug native success 72ms
</code></pre></div>
<p dir="auto">Disabling the backend and linker entirely, building Zig compiler (type checking only), then making a single-line change to a function, and then another:</p>
<div data-snippet-clipboard-copy-content="Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 17s


Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 70ms


Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 69ms"><pre><code>Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 17s


Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 70ms


Build Summary: 3/3 steps succeeded
install success
└─ compile exe zig Debug native success 69ms
</code></pre></div>
<p dir="auto">In summary:</p>
<ul dir="auto">
<li>incremental updates are 11 times faster.</li>
<li>with the new linker, there is only a 4% slowdown compared to <em>skipping code generation and linking entirely</em></li>
</ul>
      </div>
</div></div>
  </body>
</html>
