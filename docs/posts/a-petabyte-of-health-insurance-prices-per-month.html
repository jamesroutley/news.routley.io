<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.turquoise.health/a-petabyte-of-health-insurance-rates-a-month/">Original</a>
    <h1>A petabyte of health insurance prices per month</h1>
    
    <div id="readability-page-1" class="page"><div id="site-main">
    <div>

        <article>

            <header>

                <section>
                    <a href="http://tinylogger.com/tag/payer-data/">Payer Data</a>
                </section>

                

                <p>Why is there so much data and how do we shrink it?</p>

                <div>

                    <section>

                        

                        <section>
                            <h4><a href="http://tinylogger.com/author/adam-2/">Adam Geitgey</a></h4>
                            <p><time datetime="2023-07-11">11 Jul 2023</time>
                                <span><span>•</span> 8 min read</span>
                            </p>
                        </section>

                    </section>


                </div>
            </header>

            <figure>
                <img srcset="/content/images/size/w300/2023/07/Democratizing-Data.png 300w,
                            /content/images/size/w600/2023/07/Democratizing-Data.png 600w,
                            /content/images/size/w1000/2023/07/Democratizing-Data.png 1000w,
                            /content/images/size/w2000/2023/07/Democratizing-Data.png 2000w" sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px" src="http://tinylogger.com/content/images/size/w2000/2023/07/Democratizing-Data.png" alt="A Petabyte of Health Insurance Prices Per Month"/>
            </figure>

            <section>
                <div>
                    <p>Since July 2022, health insurance companies have been required to publish how much they pay healthcare providers for nearly all health care services. In the past, these negotiated prices were kept secret, leading to wide differences in payments between providers. Patients and even doctors had very little idea how much was actually being paid for healthcare.</p><p>Posting prices of items and services seems like an easy problem to solve. After all, across other industries, we can instantly browse prices for nearly anything, whether we are looking for something big like a new house or something truly important, like fuzzy cat socks:</p><figure><img src="https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-27-at-7.51.45-PM.png" alt="" srcset="https://blog.turquoise.health/content/images/size/w600/2023/06/Screenshot-2023-06-27-at-7.51.45-PM.png 600w, https://blog.turquoise.health/content/images/size/w1000/2023/06/Screenshot-2023-06-27-at-7.51.45-PM.png 1000w, https://blog.turquoise.health/content/images/size/w1600/2023/06/Screenshot-2023-06-27-at-7.51.45-PM.png 1600w, https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-27-at-7.51.45-PM.png 2372w" sizes="(min-width: 720px) 720px"/></figure><p>If other complex markets like air travel and real estate have public pricing, we should be able to do the same for healthcare. Unfortunately, nothing in the US healthcare system is simple.</p><p>While the<a href="https://github.com/CMSgov/price-transparency-guide"> Transparency in Coverage (TiC) rule</a> has been effective in revealing payer-negotiated rates, the amount of data is overwhelming. Insurance companies are posting in total about a petabyte per month of price data. And at Turquoise Health, we are collecting, cleaning, and augmenting all of that data every month. We use the data to populate our patient-facing website, to share with our customers and to power our own products.</p><p>If you are a software engineer, you might have just done a spit take at “a petabyte of data per month.” A petabyte is a truly astronomical amount of information — many hundreds of trillions of numbers. With only 66% of Americans covered by commercial health insurance, how is it that we need trillions of numbers to represent health care prices for only 220 million people?</p><h2 id="some-context-on-hospital-pricing">Some Context On Hospital Pricing</h2><p>Imagine that you are an online retailer selling cat socks. You would have a simple table of prices that looked like this:</p><figure><img src="https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-30-at-3.21.44-PM.png" alt="" srcset="https://blog.turquoise.health/content/images/size/w600/2023/06/Screenshot-2023-06-30-at-3.21.44-PM.png 600w, https://blog.turquoise.health/content/images/size/w1000/2023/06/Screenshot-2023-06-30-at-3.21.44-PM.png 1000w, https://blog.turquoise.health/content/images/size/w1600/2023/06/Screenshot-2023-06-30-at-3.21.44-PM.png 1600w, https://blog.turquoise.health/content/images/size/w2400/2023/06/Screenshot-2023-06-30-at-3.21.44-PM.png 2400w" sizes="(min-width: 1200px) 1200px"/></figure><p>That’s how most people think about prices — a menu of options provided at a fixed rate. So you’d think hospitals and insurance companies have a simple database table containing a list of services with prices like any other retailer. But in most cases, they have complex contracts that look like this:</p><figure><img src="https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-30-at-3.22.40-PM.png" alt="" srcset="https://blog.turquoise.health/content/images/size/w600/2023/06/Screenshot-2023-06-30-at-3.22.40-PM.png 600w, https://blog.turquoise.health/content/images/size/w1000/2023/06/Screenshot-2023-06-30-at-3.22.40-PM.png 1000w, https://blog.turquoise.health/content/images/size/w1600/2023/06/Screenshot-2023-06-30-at-3.22.40-PM.png 1600w, https://blog.turquoise.health/content/images/size/w2400/2023/06/Screenshot-2023-06-30-at-3.22.40-PM.png 2400w" sizes="(min-width: 1200px) 1200px"/></figure><p>Notice how every item has a price that requires external information to understand:</p><ul><li>Per diem rates are paid for each day a patient is in the hospital. We need to know how long the patient will be in the hospital to know the total amount.</li><li>Rates for Cardiac Studies require knowing the price the hospital will bill in the future. The rate is essentially “44.8% of another unknown price,” which isn’t terribly helpful to a patient.</li><li>Radiology rates are based on an external price list that has to be looked up in an entirely different database. External rate lists are very common in health insurance but are not helpful unless you have access to the latest price list and can do the math yourself.</li></ul><h3 id="making-a-menu-of-prices">Making a Menu of Prices</h3><p>Health insurance companies don&#39;t have a simple price list showing every price for every service. They have a rules engine that calculates prices based on formulas and look-up tables. While the healthcare system has lived with formula-based pricing for decades, the government was rightfully concerned that releasing rules-based prices would not be helpful to patients. Is “44.8% of an unknown price” better or worse than “162% of a benchmark rate that I also don’t know?”</p><p>As a result, the<a href="https://github.com/CMSgov/price-transparency-guide"> Transparency in Coverage rule</a> requires insurance companies to do the math for patients and, in most cases, publish prices as dollar amounts. That’s helpful for patients, but it requires that a price be pre-calculated for every possible service. Pre-calculating all the prices also causes the data to mushroom from a few formulas that apply to a range of billing codes to thousands of individual prices.</p><p>For example, using the table above, a payer would display a dollar amount for each billing code in the range shown in the Cardiac Studies column.</p><p>This single row:</p><figure><img src="https://lh6.googleusercontent.com/cSDYO5BsBoMWe7XCSChwVrFs9yAXsSssBW3BSm78RXsSDNdWEJdT0Xe_SQljNDgocKOXq_AVTse-AYELGRmx39MrvjoWTRqwVQwPPkftN5wiKi2xVl1FMVpLhHNwYn9tw2fgNQ8kFgkL49B9izfITKM" alt=""/></figure><p>Expands to many rows:</p><!--kg-card-begin: html--><table><colgroup><col/><col/><col/></colgroup><tbody><tr><td><p dir="ltr"><span>Service</span></p></td><td><p dir="ltr"><span>Billing Code</span></p></td><td><p dir="ltr"><span>Rate</span></p></td></tr><tr><td><p dir="ltr"><span>Cardiac Studies</span></p></td><td><p dir="ltr"><span>99303</span></p></td><td><p dir="ltr"><span>$5,432.08</span></p></td></tr><tr><td><p dir="ltr"><span>Cardiac Studies</span></p></td><td><p dir="ltr"><span>99304</span></p></td><td><p dir="ltr"><span>$5,499.75</span></p></td></tr><tr><td><p dir="ltr"><span>Cardiac Studies</span></p></td><td><p dir="ltr"><span>99305</span></p></td><td><p dir="ltr"><span>$4,381.08</span></p></td></tr><tr><td><br/></td><td><p dir="ltr"><span>1, 2, ..., 99…</span></p></td><td><br/></td></tr><tr><td><p dir="ltr"><span>Cardiac Studies</span></p></td><td><p dir="ltr"><span>93356</span></p></td><td><p dir="ltr"><span>$6,059.33</span></p></td></tr></tbody></table><!--kg-card-end: html--><p>This makes the data much larger than what insurance companies store internally, but it also makes the data much easier to use.</p><h2 id="same-procedure-different-scenarios">Same Procedure, Different Scenarios</h2><p>We can handle storing a menu of prices with each service and still have a manageable amount of data. In practice, though, every service has many possible prices because each service has many different scenarios that could affect the final price. Here are some common situations that change the price:</p><ul><li>A surgery was started but cancelled mid-operation for medical reasons.</li><li>A nurse practitioner performed the procedure in place of a doctor.</li><li>A doctor performed multiple procedures at once, which is cheaper than performing each procedure separately.</li><li>Instead of a doctor performing the MRI, a technician runs the MRI machine and a doctor reviews the results later.</li><li>A flu vaccination is given by a mobile flu clinic instead of in a hospital.</li></ul><p>So every item in the price list gets a price for all of the possible situations, creating hundreds of price variations of each service.</p><h3 id="massive-data-redundancy">Massive Data Redundancy</h3><p>Even with separate prices for each variant of each service, the data is still <em>possible</em> to manage. Where things get hairy is how the data is represented. The<a href="https://github.com/CMSgov/price-transparency-guide"> Transparency in Coverage schema</a> requires requires rates to be arranged in a hierarchical fashion, like this:</p><figure><img src="https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-30-at-3.26.56-PM.png" alt="" srcset="https://blog.turquoise.health/content/images/size/w600/2023/06/Screenshot-2023-06-30-at-3.26.56-PM.png 600w, https://blog.turquoise.health/content/images/size/w1000/2023/06/Screenshot-2023-06-30-at-3.26.56-PM.png 1000w, https://blog.turquoise.health/content/images/size/w1600/2023/06/Screenshot-2023-06-30-at-3.26.56-PM.png 1600w, https://blog.turquoise.health/content/images/size/w2400/2023/06/Screenshot-2023-06-30-at-3.26.56-PM.png 2400w" sizes="(min-width: 1200px) 1200px"/></figure><p>This means that each hospital&#39;s long list of doctors is repeated for every possible price variation of every medical service. Data balloons exponentially.</p><p>The schema does provide a way to avoid this duplication by referring to a separate list of doctors instead of repeating them. But taking advantage of that feature is currently optional, so not all insurance companies use it.</p><h3 id="clinically-implausible-rates">Clinically Implausible Rates</h3><p>The data is further ballooned because it includes rates for <strong><em>many</em></strong> medical services that can never occur. For example, an insurance company may have a contract that says they pay $180,000 for a heart transplant. The payer follows the rules and publishes that price for the list of “<strong>all </strong>doctors in this hospital.” That means including a heart transplant rate for podiatrists, pediatricians, urologists, and neurologists. Those doctors would never perform a heart transplant, so the data is dead weight. When multiplied by every possible procedure performed by every type of care provider, this issue adds a significant amount of useless data.</p><h3 id="highly-redundant-insurance-plans">Highly Redundant Insurance Plans</h3><p>Lastly, the law requires that rates are published for every insurance <strong><em>plan</em></strong>. Insurance companies don&#39;t usually set rates at the plan level. Insurance companies agree to rates with networks of doctors and those rates are re-used among many insurance plans. They may offer 1,000 slightly customized insurance plans to 1,000 different employers that all share largely the same rates for the same doctors. The result is 1,000 giant files that repeat the same prices for the same doctors repeatedly. There is some guidance on avoiding this in the schema, but the solutions aren&#39;t always used effectively.</p><h2 id="shrinking-it-down">Shrinking it Down</h2><p>First, we must credit CMS. It<a href="https://github.com/CMSgov/price-transparency-guide/issues"> developed its payer data schema in public on Github</a>, accepts suggestions from interested parties, and is responsive to feedback. We expect to see some of the issues mentioned here addressed in the future. Thanks, CMS!</p><p>But in the meantime,  Turquoise Health is processing around a petabyte of data per month which our users want to use to make decisions about healthcare prices. Our goal is to make the data as small, clean and easy to use as possible.</p><p>We’ve been working to pull the data out of an overly-hierarchical structure to remove the inherent duplication. The idea is to look for duplicated information being stored lower in the hierarchy and only store one copy. Along the way, we can also remove some unneeded levels of hierarchy:</p><figure><img src="https://blog.turquoise.health/content/images/2023/06/Screenshot-2023-06-30-at-3.29.18-PM.png" alt="" srcset="https://blog.turquoise.health/content/images/size/w600/2023/06/Screenshot-2023-06-30-at-3.29.18-PM.png 600w, https://blog.turquoise.health/content/images/size/w1000/2023/06/Screenshot-2023-06-30-at-3.29.18-PM.png 1000w, https://blog.turquoise.health/content/images/size/w1600/2023/06/Screenshot-2023-06-30-at-3.29.18-PM.png 1600w, https://blog.turquoise.health/content/images/size/w2400/2023/06/Screenshot-2023-06-30-at-3.29.18-PM.png 2400w" sizes="(min-width: 1200px) 1200px"/></figure><p>By storing only one copy of each piece of information, we can store the exact same information <em><strong>with an 85% reduction in size</strong></em>.</p><p>We are applying further optimizations to shrink the data even more. We&#39;ve analyzed historical healthcare records to identify which types of doctors are likely to perform which types procedures. By removing prices for clinically implausible services, we can cut the data at least in half again.</p><h2 id="smaller-data-leads-to-insights-and-saves-money-">Smaller Data Leads to Insights (and Saves Money)</h2><p>Performing this de-duplication processing is a tricky data engineering problem. The data is spread across millions of files from hundreds of insurance companies. Cross-referencing the data to find only unique information within a massive dataset is computationally intensive.</p><p>But the effort is worth it. Reducing this data down to a much smaller dataset has huge implications for our users and for us.</p><p>First, a much smaller dataset is exponentially faster to query. Queries that used to take minutes or hours now take seconds. Faster data exploration naturally leads to more exploration and insights.</p><p>Second, working with a much smaller dataset is quicker and more cost-effective when running complex analyses across the entire dataset. We are working on several exciting projects that require summarizing the entire price landscape. One of our first goals is to quantify the quality of each insurance company&#39;s published rates, which requires quickly analyzing all of the data together.</p><p>Third, the duplicated data we eliminated was making the data harder to understand. When users searched and exported data, they could get reams of repeated information that was challenging to pick through. Removing redundant data makes rates easier to understand.</p><h2 id="show-me-tangible-results">Show Me Tangible Results</h2><p>After filtering down the data, we are left with a few tens of terabytes of compressed information that represents the prices of the entire US commercial healthcare system. But tens of terabytes is still a challenge for traditional database systems.</p><p>To query this data quickly, we use the open-source <a href="https://trino.io/">Trino database engine</a>. Trino is designed from the ground up for big data analytics. The raw rate data is stored in Amazon S3 in a compressed file format. Users write normal SQL and Trino scans the data in S3 to find what it needs. To the user, it looks just like any other database. But behind the scenes, Trino executes many queries in parallel using a cluster of servers to speed up results.</p><p>Imagine that we want to grab the Anthem insurance rates for insurance plans for hospitals in California. It seems like a simple request, but even something this basic would be slow and difficult with the original data.</p><ul><li>Anthem operates in 14 states, including country-sized states like California and New York, and offers many plans in each market, making the pool of data we are checking quite large.</li><li>We look for hospitals using <a href="https://en.wikipedia.org/wiki/National_Provider_Identifier">National Provider IDs (NPIs)</a>, but each hospital has several NPIs, and the original payer data schema repeats the list of providers for every price – and we have to check them all!</li></ul><p>So we are actually looking for hundreds of needles in a haystack approximately the size of Mars. But with the deduplicated payer data and Trino, this query is no sweat. Previously, this kind of query could take an hour or more to run. Now it runs in 10-20 seconds.</p><h2 id="better-data-makes-everything-better">Better Data Makes Everything Better</h2><p>Raw performance improvements are great on their own, but these data improvements will also flow through to all of the tools on the Turquoise Health platform. </p><p>Many users explore pricing data through <a href="https://turquoise.health/products/rate_sense">Rate Sense</a>, our health rates search engine. Using Rate Sense, very complex questions like &#34;how much does it actually cost to deliver a baby in California?&#34; can be answered in seconds. </p><p>Just query for MSDRG 768 (the code for an inpatient child delivery in a hospital) and get specific prices or even a complete market summary in seconds:</p><figure><img src="https://blog.turquoise.health/content/images/2023/07/rs-demo-2.gif" alt=""/></figure><p>These data updates will make all our tools even more delightful to use. We are excited about the new possibilities! Want to learn more? <a href="https://turquoise.health/contact?page=contact-us">Get in touch</a>.</p>
                </div>
            </section>



        </article>

    </div>
</div></div>
  </body>
</html>
