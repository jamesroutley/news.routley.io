<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/jankae/LibreVNA">Original</a>
    <h1>100kHz to 6GHz 2 port USB based VNA</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/jankae/LibreVNA/blob/master/Software/PC_Application/LibreVNA-GUI/resources/banner.png"><img src="https://github.com/jankae/LibreVNA/raw/master/Software/PC_Application/LibreVNA-GUI/resources/banner.png" alt="LibreVNA"/></a></p>
<p dir="auto"><strong>100kHz to 6GHz VNA</strong></p>
<p dir="auto">This is the improved version of my <a href="https://www.github.com/jankae/VNA">first attempt</a> at a VNA.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/jankae/LibreVNA/blob/master/Documentation/Pictures/RevisionB6LTop.JPG"><img src="https://github.com/jankae/LibreVNA/raw/master/Documentation/Pictures/RevisionB6LTop.JPG" alt=""/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-gui-installation" aria-hidden="true" tabindex="-1" href="#gui-installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>GUI Installation</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-windows" aria-hidden="true" tabindex="-1" href="#windows"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Windows</h3>
<ul dir="auto">
<li>Download the latest <a href="https://github.com/jankae/LibreVNA/releases">Release</a> and unpack the zip file</li>
<li>Start the included LibreVNA-GUI.exe</li>
<li>No installation or driver is required, simply move the extracted folder somewhere convenient</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-ubuntu" aria-hidden="true" tabindex="-1" href="#ubuntu"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Ubuntu</h3>
<ul dir="auto">
<li>Download the latest <a href="https://github.com/jankae/LibreVNA/releases">Release</a> and unpack the zip file</li>
<li>Install the required libraries:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="sudo apt install libqt6widgets6 libqt6svg6"><pre><span>sudo apt install libqt6widgets6 libqt6svg6</span></pre></div>
<ul dir="auto">
<li>Install the udev rule (otherwise you don&#39;t have the permissions to access the USB device):</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="wget https://raw.githubusercontent.com/jankae/LibreVNA/master/Software/PC_Application/51-vna.rules
sudo cp 51-vna.rules /etc/udev/rules.d"><pre><span>wget https://raw.githubusercontent.com/jankae/LibreVNA/master/Software/PC_Application/51-vna.rules</span>
<span>sudo cp 51-vna.rules /etc/udev/rules.d</span></pre></div>
<ul dir="auto">
<li>Either reboot or reload the udev rules manually:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="sudo udevadm control --reload-rules
sudo udevadm trigger"><pre><span>sudo udevadm control --reload-rules</span>
<span>sudo udevadm trigger</span></pre></div>
<ul dir="auto">
<li>You can now start GUI:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="cd $UNPACKED_ZIP_FOLDER$
./LibreVNA-GUI"><pre><span>cd $UNPACKED_ZIP_FOLDER$</span>
<span>./LibreVNA-GUI</span></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-quick-start" aria-hidden="true" tabindex="-1" href="#quick-start"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quick Start</h2>
<ul dir="auto">
<li>You can find released versions of the GUI application and the device firmware <a href="https://github.com/jankae/LibreVNA/releases">here</a>.</li>
<li>If you would like to try out the newest features, the compiled versions of each commit can be found <a href="https://github.com/jankae/LibreVNA/actions">here</a> (but keep in mind that some features might be unstable or incomplete).</li>
<li>An (incomplete) <a href="https://github.com/jankae/LibreVNA/blob/master/Documentation/UserManual/manual.pdf">user manual</a> is also available.</li>
<li>If you would like to control the LibreVNA with a script, see the <a href="https://github.com/jankae/LibreVNA/blob/master/Documentation/UserManual/ProgrammingGuide.pdf">SCPI Programming Guide</a>.</li>
</ul>
<p dir="auto">Please also take a look at the <a href="https://github.com/jankae/LibreVNA/blob/master/Documentation/FAQ.md">FAQ</a>.</p>
<p dir="auto">If you notice bugs or have ideas for improvements, please create an issue for that.</p>
<p dir="auto">For general questions or discussions, the <a href="https://groups.io/g/LibreVNA-support/" rel="nofollow">LibreVNA group</a> is probably the best place.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-preliminary-specifications" aria-hidden="true" tabindex="-1" href="#preliminary-specifications"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Preliminary specifications</h3>
<p dir="auto">Some <a href="https://github.com/jankae/LibreVNA/blob/master/Documentation/UserManual/specsheet.pdf">specifications</a> are available but this project is still under development and the specifications might change.</p>
<p dir="auto">There are also some initial <a href="https://github.com/jankae/LibreVNA/blob/master/Documentation/Measurements/Measurements.md">example measurements</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-does-it-work" aria-hidden="true" tabindex="-1" href="#how-does-it-work"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How does it work?</h2>
<p dir="auto">The PCB is really only the RF frontend with some processing power. Everything else is handled in the PC application once the data is transferred via USB. You can try out the application without the PCB (obviously no measurements are possible, but you can import provided example measurements and get an idea about what it can and can&#39;t do).</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-rf-path" aria-hidden="true" tabindex="-1" href="#rf-path"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>RF path:</h3>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/jankae/LibreVNA/blob/master/Documentation/DeveloperInfo/RFBlockdiagram.svg"><img src="https://github.com/jankae/LibreVNA/raw/master/Documentation/DeveloperInfo/RFBlockdiagram.svg" alt=""/></a></p>
<ul dir="auto">
<li>The main clock source is an Si5351C, providing all the required clocks for the different blocks. It also serves as the stimulus source for frequencies below 25MHz. Its own reference clock is either a 26MHz crystal or an external 10MHz signal.</li>
<li>The stimulus source for frequencies above 25MHz is a MAX2871. Its output signal is slightly filtered to reduce the amount of harmonics.</li>
<li>The stimulus signal power can be adjusted between approximately -42 and -10dbm with a digital attenuator (RFSA3714).</li>
<li>After the amplifier(TRF37A73) the signal is split and the weaker part of it fed into the reference receiver.</li>
<li>The stronger part of the signal can be routed to either port. In each signal path, two RF switches are used in series to achieve higher isolation between the ports.</li>
<li>Instead of directional couplers, resistive return-loss-bridges are used (easier to implement for wide bandwidth).</li>
<li>Both ports have completely separated receive paths. This increases BOM cost but allows measuring two parameters at once (S11 and S21 or S22 and S12). It also avoids potential isolation issues that could arise if the receive paths would merge into a single mixer/ADC.</li>
<li>Each receiver consists of two down-convert mixers. The 1.IF sits at 60MHz, the 2.IF 250kHz.</li>
<li>The ADCs are sampling the final IF with 16bit@800kHz.</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-digital-section" aria-hidden="true" tabindex="-1" href="#digital-section"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Digital section:</h3>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/jankae/LibreVNA/blob/master/Documentation/DeveloperInfo/DigitalBlockdiagram.svg"><img src="https://github.com/jankae/LibreVNA/raw/master/Documentation/DeveloperInfo/DigitalBlockdiagram.svg" alt=""/></a></p>
<ul dir="auto">
<li>The central element is the Spartan6 FPGA. It handles all communication with the RF blocks and samples the ADCs. This allows for nearly instant switching of the measurement frequency, only limited by the settling time of the PLLs.</li>
<li>The microcontroller handles the setup of the sweep in the FPGA, extracts and preprocesses the measurements and passes them on through USB.</li>
<li>The flash contains the FPGA bitstream. Because the microcontroller has access to the flash, no FPGA-related hardware tools (such as JTAG programmers) are needed, everything can be updated via USB.</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-power-supply" aria-hidden="true" tabindex="-1" href="#power-supply"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Power supply:</h3>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/jankae/LibreVNA/blob/master/Documentation/DeveloperInfo/PowerBlockdiagram.svg"><img src="https://github.com/jankae/LibreVNA/raw/master/Documentation/DeveloperInfo/PowerBlockdiagram.svg" alt=""/></a></p>
<ul dir="auto">
<li>Everything is powered from USB (or optionally by external 5V DC)</li>
<li>Almost every RF block has its own local regulater, preventing noise and signals coupling into the supply lines from propagating across the whole PCB</li>
</ul>
</article></div></div>
  </body>
</html>
