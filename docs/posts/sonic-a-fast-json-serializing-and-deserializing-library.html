<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/bytedance/sonic">Original</a>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto">A blazingly fast JSON serializing &amp; deserializing library, accelerated by JIT (just-in-time compiling) and SIMD (single-instruction-multiple-data).</p>
<h2 dir="auto"><a id="user-content-requirement" aria-hidden="true" href="#requirement"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Requirement</h2>
<ul dir="auto">
<li>Go 1.15/1.16</li>
<li>Linux/darwin OS</li>
<li>Amd64 CPU with AVX instruction set</li>
</ul>
<h2 dir="auto"><a id="user-content-features" aria-hidden="true" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>Runtime object binding without code generation</li>
<li>Complete APIs for JSON value manipulation</li>
<li>Fast, fast, fast!</li>
</ul>
<h2 dir="auto"><a id="user-content-benchmarks" aria-hidden="true" href="#benchmarks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Benchmarks</h2>
<p dir="auto">For <strong>all sizes</strong> of json and <strong>all cases</strong> of usage, <strong>Sonic performs best</strong>.</p>

<p dir="auto"><strong>For medium data, Sonic&#39;s speed is <code>2.6x times</code> of <a href="https://github.com/json-iterator/go">json-iterator&#39;s</a> in <code>decoding</code>, <code>2.5x times</code> in <code>encoding</code>ï¼Œand <code>8.3x times</code> in <code>searching</code>.</strong></p>
<div data-snippet-clipboard-copy-content="goos: darwin
goarch: amd64
cpu: Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz
BenchmarkEncoder_Generic_Sonic-16                         100000             25547 ns/op         510.23 MB/s       13762 B/op          4 allocs/op
BenchmarkEncoder_Generic_JsonIter-16                      100000             44526 ns/op         292.75 MB/s       13433 B/op         77 allocs/op
BenchmarkEncoder_Generic_StdLib-16                        100000            134480 ns/op          96.93 MB/s       48177 B/op        827 allocs/op
BenchmarkEncoder_Binding_Sonic-16                         100000              6658 ns/op        1957.74 MB/s       14156 B/op          4 allocs/op
BenchmarkEncoder_Binding_JsonIter-16                      100000             21367 ns/op         610.05 MB/s        9487 B/op          2 allocs/op
BenchmarkEncoder_Binding_StdLib-16                        100000             17558 ns/op         742.41 MB/s        9480 B/op          1 allocs/op
BenchmarkEncoder_Parallel_Generic_Sonic-16                100000              4562 ns/op        2857.18 MB/s       10957 B/op          4 allocs/op
BenchmarkEncoder_Parallel_Generic_JsonIter-16             100000             10943 ns/op        1191.21 MB/s       13449 B/op         77 allocs/op
BenchmarkEncoder_Parallel_Generic_StdLib-16               100000             52174 ns/op         249.84 MB/s       48218 B/op        827 allocs/op
BenchmarkEncoder_Parallel_Binding_Sonic-16                100000              1422 ns/op        9168.12 MB/s       11030 B/op          4 allocs/op
BenchmarkEncoder_Parallel_Binding_JsonIter-16             100000              4630 ns/op        2815.35 MB/s        9496 B/op          2 allocs/op
BenchmarkEncoder_Parallel_Binding_StdLib-16               100000              4977 ns/op        2619.08 MB/s        9488 B/op          1 allocs/op

BenchmarkDecoder_Generic_Sonic-16                         100000             57247 ns/op         227.70 MB/s       49727 B/op        313 allocs/op
BenchmarkDecoder_Generic_StdLib-16                        100000            139698 ns/op          93.31 MB/s       50898 B/op        772 allocs/op
BenchmarkDecoder_Generic_JsonIter-16                      100000            101967 ns/op         127.84 MB/s       55787 B/op       1068 allocs/op
BenchmarkDecoder_Binding_Sonic-16                         100000             28254 ns/op         461.35 MB/s       25062 B/op         34 allocs/op
BenchmarkDecoder_Binding_StdLib-16                        100000            123779 ns/op         105.31 MB/s       10560 B/op        207 allocs/op
BenchmarkDecoder_Binding_JsonIter-16                      100000             38253 ns/op         340.75 MB/s       14674 B/op        385 allocs/op
BenchmarkDecoder_Parallel_Generic_Sonic-16                100000             10171 ns/op        1281.59 MB/s       49458 B/op        313 allocs/op
BenchmarkDecoder_Parallel_Generic_StdLib-16               100000             54916 ns/op         237.36 MB/s       50907 B/op        772 allocs/op
BenchmarkDecoder_Parallel_Generic_JsonIter-16             100000             48286 ns/op         269.95 MB/s       55811 B/op       1068 allocs/op
BenchmarkDecoder_Parallel_Binding_Sonic-16                100000              5282 ns/op        2467.83 MB/s       24683 B/op         34 allocs/op
BenchmarkDecoder_Parallel_Binding_StdLib-16               100000             31875 ns/op         408.94 MB/s       10559 B/op        207 allocs/op
BenchmarkDecoder_Parallel_Binding_JsonIter-16             100000             13810 ns/op         943.90 MB/s       14679 B/op        385 allocs/op

BenchmarkSearchOne_Gjson-16                               100000              8992 ns/op        1448.28 MB/s           0 B/op          0 allocs/op
BenchmarkSearchOne_Jsoniter-16                            100000             58313 ns/op         223.33 MB/s       27936 B/op        647 allocs/op
BenchmarkSearchOne_Sonic-16                               100000             10497 ns/op        1240.61 MB/s          29 B/op          1 allocs/op
BenchmarkSearchOne_Parallel_Gjson-16                      100000              1046 ns/op        12449.59 MB/s          0 B/op          0 allocs/op
BenchmarkSearchOne_Parallel_Jsoniter-16                   100000             16080 ns/op         809.88 MB/s       27942 B/op        647 allocs/op
BenchmarkSearchOne_Parallel_Sonic-16                      100000              1435 ns/op        9074.18 MB/s         285 B/op          1 allocs/op
"><pre>goos: darwin
goarch: amd64
cpu: Intel(R) Core(TM) i9<span>-</span>9880H CPU @ <span>2.</span>30GHz
BenchmarkEncoder_Generic_Sonic<span>-</span><span>16</span>                         <span>100000</span>             <span>25547</span> ns<span>/</span>op         <span>510.23</span> MB<span>/</span>s       <span>13762</span> B<span>/</span>op          <span>4</span> allocs<span>/</span>op
BenchmarkEncoder_Generic_JsonIter<span>-</span><span>16</span>                      <span>100000</span>             <span>44526</span> ns<span>/</span>op         <span>292.75</span> MB<span>/</span>s       <span>13433</span> B<span>/</span>op         <span>77</span> allocs<span>/</span>op
BenchmarkEncoder_Generic_StdLib<span>-</span><span>16</span>                        <span>100000</span>            <span>134480</span> ns<span>/</span>op          <span>96.93</span> MB<span>/</span>s       <span>48177</span> B<span>/</span>op        <span>827</span> allocs<span>/</span>op
BenchmarkEncoder_Binding_Sonic<span>-</span><span>16</span>                         <span>100000</span>              <span>6658</span> ns<span>/</span>op        <span>1957.74</span> MB<span>/</span>s       <span>14156</span> B<span>/</span>op          <span>4</span> allocs<span>/</span>op
BenchmarkEncoder_Binding_JsonIter<span>-</span><span>16</span>                      <span>100000</span>             <span>21367</span> ns<span>/</span>op         <span>610.05</span> MB<span>/</span>s        <span>9487</span> B<span>/</span>op          <span>2</span> allocs<span>/</span>op
BenchmarkEncoder_Binding_StdLib<span>-</span><span>16</span>                        <span>100000</span>             <span>17558</span> ns<span>/</span>op         <span>742.41</span> MB<span>/</span>s        <span>9480</span> B<span>/</span>op          <span>1</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Generic_Sonic<span>-</span><span>16</span>                <span>100000</span>              <span>4562</span> ns<span>/</span>op        <span>2857.18</span> MB<span>/</span>s       <span>10957</span> B<span>/</span>op          <span>4</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Generic_JsonIter<span>-</span><span>16</span>             <span>100000</span>             <span>10943</span> ns<span>/</span>op        <span>1191.21</span> MB<span>/</span>s       <span>13449</span> B<span>/</span>op         <span>77</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Generic_StdLib<span>-</span><span>16</span>               <span>100000</span>             <span>52174</span> ns<span>/</span>op         <span>249.84</span> MB<span>/</span>s       <span>48218</span> B<span>/</span>op        <span>827</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Binding_Sonic<span>-</span><span>16</span>                <span>100000</span>              <span>1422</span> ns<span>/</span>op        <span>9168.12</span> MB<span>/</span>s       <span>11030</span> B<span>/</span>op          <span>4</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Binding_JsonIter<span>-</span><span>16</span>             <span>100000</span>              <span>4630</span> ns<span>/</span>op        <span>2815.35</span> MB<span>/</span>s        <span>9496</span> B<span>/</span>op          <span>2</span> allocs<span>/</span>op
BenchmarkEncoder_Parallel_Binding_StdLib<span>-</span><span>16</span>               <span>100000</span>              <span>4977</span> ns<span>/</span>op        <span>2619.08</span> MB<span>/</span>s        <span>9488</span> B<span>/</span>op          <span>1</span> allocs<span>/</span>op

BenchmarkDecoder_Generic_Sonic<span>-</span><span>16</span>                         <span>100000</span>             <span>57247</span> ns<span>/</span>op         <span>227.70</span> MB<span>/</span>s       <span>49727</span> B<span>/</span>op        <span>313</span> allocs<span>/</span>op
BenchmarkDecoder_Generic_StdLib<span>-</span><span>16</span>                        <span>100000</span>            <span>139698</span> ns<span>/</span>op          <span>93.31</span> MB<span>/</span>s       <span>50898</span> B<span>/</span>op        <span>772</span> allocs<span>/</span>op
BenchmarkDecoder_Generic_JsonIter<span>-</span><span>16</span>                      <span>100000</span>            <span>101967</span> ns<span>/</span>op         <span>127.84</span> MB<span>/</span>s       <span>55787</span> B<span>/</span>op       <span>1068</span> allocs<span>/</span>op
BenchmarkDecoder_Binding_Sonic<span>-</span><span>16</span>                         <span>100000</span>             <span>28254</span> ns<span>/</span>op         <span>461.35</span> MB<span>/</span>s       <span>25062</span> B<span>/</span>op         <span>34</span> allocs<span>/</span>op
BenchmarkDecoder_Binding_StdLib<span>-</span><span>16</span>                        <span>100000</span>            <span>123779</span> ns<span>/</span>op         <span>105.31</span> MB<span>/</span>s       <span>10560</span> B<span>/</span>op        <span>207</span> allocs<span>/</span>op
BenchmarkDecoder_Binding_JsonIter<span>-</span><span>16</span>                      <span>100000</span>             <span>38253</span> ns<span>/</span>op         <span>340.75</span> MB<span>/</span>s       <span>14674</span> B<span>/</span>op        <span>385</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Generic_Sonic<span>-</span><span>16</span>                <span>100000</span>             <span>10171</span> ns<span>/</span>op        <span>1281.59</span> MB<span>/</span>s       <span>49458</span> B<span>/</span>op        <span>313</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Generic_StdLib<span>-</span><span>16</span>               <span>100000</span>             <span>54916</span> ns<span>/</span>op         <span>237.36</span> MB<span>/</span>s       <span>50907</span> B<span>/</span>op        <span>772</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Generic_JsonIter<span>-</span><span>16</span>             <span>100000</span>             <span>48286</span> ns<span>/</span>op         <span>269.95</span> MB<span>/</span>s       <span>55811</span> B<span>/</span>op       <span>1068</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Binding_Sonic<span>-</span><span>16</span>                <span>100000</span>              <span>5282</span> ns<span>/</span>op        <span>2467.83</span> MB<span>/</span>s       <span>24683</span> B<span>/</span>op         <span>34</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Binding_StdLib<span>-</span><span>16</span>               <span>100000</span>             <span>31875</span> ns<span>/</span>op         <span>408.94</span> MB<span>/</span>s       <span>10559</span> B<span>/</span>op        <span>207</span> allocs<span>/</span>op
BenchmarkDecoder_Parallel_Binding_JsonIter<span>-</span><span>16</span>             <span>100000</span>             <span>13810</span> ns<span>/</span>op         <span>943.90</span> MB<span>/</span>s       <span>14679</span> B<span>/</span>op        <span>385</span> allocs<span>/</span>op

BenchmarkSearchOne_Gjson<span>-</span><span>16</span>                               <span>100000</span>              <span>8992</span> ns<span>/</span>op        <span>1448.28</span> MB<span>/</span>s           <span>0</span> B<span>/</span>op          <span>0</span> allocs<span>/</span>op
BenchmarkSearchOne_Jsoniter<span>-</span><span>16</span>                            <span>100000</span>             <span>58313</span> ns<span>/</span>op         <span>223.33</span> MB<span>/</span>s       <span>27936</span> B<span>/</span>op        <span>647</span> allocs<span>/</span>op
BenchmarkSearchOne_Sonic<span>-</span><span>16</span>                               <span>100000</span>             <span>10497</span> ns<span>/</span>op        <span>1240.61</span> MB<span>/</span>s          <span>29</span> B<span>/</span>op          <span>1</span> allocs<span>/</span>op
BenchmarkSearchOne_Parallel_Gjson<span>-</span><span>16</span>                      <span>100000</span>              <span>1046</span> ns<span>/</span>op        <span>12449.59</span> MB<span>/</span>s          <span>0</span> B<span>/</span>op          <span>0</span> allocs<span>/</span>op
BenchmarkSearchOne_Parallel_Jsoniter<span>-</span><span>16</span>                   <span>100000</span>             <span>16080</span> ns<span>/</span>op         <span>809.88</span> MB<span>/</span>s       <span>27942</span> B<span>/</span>op        <span>647</span> allocs<span>/</span>op
BenchmarkSearchOne_Parallel_Sonic<span>-</span><span>16</span>                      <span>100000</span>              <span>1435</span> ns<span>/</span>op        <span>9074.18</span> MB<span>/</span>s         <span>285</span> B<span>/</span>op          <span>1</span> allocs<span>/</span>op</pre></div>
<p dir="auto">More detail see <a href="https://github.com/bytedance/sonic/blob/main/decoder/decoder_test.go">decoder/decoder_test.go</a>, <a href="https://github.com/bytedance/sonic/blob/main/encoder/encoder_test.go">encoder/encoder_test.go</a>, <a href="https://github.com/bytedance/sonic/blob/main/ast/search_test.go">ast/search_test.go</a>, <a href="https://github.com/bytedance/sonic/blob/main/ast/parser_test.go">ast/parser_test.go</a>, <a href="https://github.com/bytedance/sonic/blob/main/ast/node_test.go">ast/node_test.go</a></p>
<h2 dir="auto"><a id="user-content-how-it-works" aria-hidden="true" href="#how-it-works"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How it works</h2>
<p dir="auto">See <a href="https://github.com/bytedance/sonic/blob/main/INTRODUCTION.md">INTRODUCTION.md</a></p>
<h2 dir="auto"><a id="user-content-fuzzing" aria-hidden="true" href="#fuzzing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fuzzing</h2>
<p dir="auto"><a href="https://github.com/liuq19/sonic-fuzz">sonic-fuzz</a> is the repository for fuzzing tests. If you find any bug, please report the issue to sonic.</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<h3 dir="auto"><a id="user-content-marshalunmarshal" aria-hidden="true" href="#marshalunmarshal"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Marshal/Unmarshal</h3>
<p dir="auto">The behaviors are mostly consistent with encoding/json, except some uncommon escaping (see <a href="https://github.com/bytedance/sonic/issues/4">issue4</a>)</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic&#34;

var data YourSchema
// Marshal
output, err := sonic.Marshal(&amp;data) 
// Unmarshal
err := sonic.Unmarshal(output, &amp;data) 
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic&#34;</span>

<span>var</span> <span>data</span> <span>YourSchema</span>
<span>// Marshal</span>
<span>output</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>Marshal</span>(<span>&amp;</span><span>data</span>) 
<span>// Unmarshal</span>
<span>err</span> <span>:=</span> <span>sonic</span>.<span>Unmarshal</span>(<span>output</span>, <span>&amp;</span><span>data</span>) </pre></div>
<h3 dir="auto"><a id="user-content-use-numberuse-int64" aria-hidden="true" href="#use-numberuse-int64"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use Number/Use Int64</h3>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic/decoder&#34;

var input = `1`
var data interface{}

// default float64
dc := decoder.NewDecoder(input) 
dc.Decode(&amp;data) // data == float64(1)
// use json.Number
dc = decoder.NewDecoder(input)
dc.UseNumber()
dc.Decode(&amp;data) // data == json.Number(&#34;1&#34;)
// use int64
dc = decoder.NewDecoder(input)
dc.UseInt64()
dc.Decode(&amp;data) // data == int64(1)

root, err := sonic.GetFromString(input)
// Get json.Number
jn := root.Number()
jm := root.InterfaceUseNumber().(json.Number) // jn == jm
// Get float64
fn := root.Float64()
fm := root.Interface().(float64) // jn == jm
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic/decoder&#34;</span>

<span>var</span> <span>input</span> <span>=</span> <span>`1`</span>
<span>var</span> <span>data</span> <span>interface</span>{}

<span>// default float64</span>
<span>dc</span> <span>:=</span> <span>decoder</span>.<span>NewDecoder</span>(<span>input</span>) 
<span>dc</span>.<span>Decode</span>(<span>&amp;</span><span>data</span>) <span>// data == float64(1)</span>
<span>// use json.Number</span>
<span>dc</span> <span>=</span> <span>decoder</span>.<span>NewDecoder</span>(<span>input</span>)
<span>dc</span>.<span>UseNumber</span>()
<span>dc</span>.<span>Decode</span>(<span>&amp;</span><span>data</span>) <span>// data == json.Number(&#34;1&#34;)</span>
<span>// use int64</span>
<span>dc</span> <span>=</span> <span>decoder</span>.<span>NewDecoder</span>(<span>input</span>)
<span>dc</span>.<span>UseInt64</span>()
<span>dc</span>.<span>Decode</span>(<span>&amp;</span><span>data</span>) <span>// data == int64(1)</span>

<span>root</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>GetFromString</span>(<span>input</span>)
<span>// Get json.Number</span>
<span>jn</span> <span>:=</span> <span>root</span>.<span>Number</span>()
<span>jm</span> <span>:=</span> <span>root</span>.<span>InterfaceUseNumber</span>().(json.<span>Number</span>) <span>// jn == jm</span>
<span>// Get float64</span>
<span>fn</span> <span>:=</span> <span>root</span>.<span>Float64</span>()
<span>fm</span> <span>:=</span> <span>root</span>.<span>Interface</span>().(<span>float64</span>) <span>// jn == jm</span></pre></div>
<h3 dir="auto"><a id="user-content-sort-keys" aria-hidden="true" href="#sort-keys"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sort Keys</h3>
<p dir="auto">On account of the performance loss from sorting (roughly 10%), sonic doesn&#39;t enable this feature by default. If your component depends on it to work (like <a href="https://github.com/facebook/zstd">zstd</a>), Use it like this:</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic/encoder&#34;

m := map[string]interface{}{}
v, err := encoder.Encode(m, encoder.SortMapKeys)
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic/encoder&#34;</span>

<span>m</span> <span>:=</span> <span>map</span>[<span>string</span>]<span>interface</span>{}{}
<span>v</span>, <span>err</span> <span>:=</span> <span>encoder</span>.<span>Encode</span>(<span>m</span>, <span>encoder</span>.<span>SortMapKeys</span>)</pre></div>
<p dir="auto"><strong>Caution</strong>: sonic encode struct in order of its original field declaration, so if you want to sort a struct&#39;s keys like the map&#39;s, just rewrite your struct.</p>
<h3 dir="auto"><a id="user-content-print-syntax-error" aria-hidden="true" href="#print-syntax-error"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Print Syntax Error</h3>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic/decoder&#34;

var data interface{}
dc := decoder.NewDecoder(&#34;[[[}]]&#34;)
if err := dc.Decode(&amp;data); err != nil {
    if e, ok := err.(decoder.SyntaxError); ok {
        
        /*Syntax error at index 3: invalid char

            [[[}]]
            ...^..
        */
        print(e.Description())

        /*&#34;Syntax error at index 3: invalid char\n\n\t[[[}]]\n\t...^..\n&#34;*/
        println(fmt.Sprintf(&#34;%q&#34;, e.Description()))
    }

    /*Decode: Syntax error at index 3: invalid char*/
    t.Fatalf(&#34;Decode: %v&#34;, err) 
}
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic/decoder&#34;</span>

<span>var</span> <span>data</span> <span>interface</span>{}
<span>dc</span> <span>:=</span> <span>decoder</span>.<span>NewDecoder</span>(<span>&#34;[[[}]]&#34;</span>)
<span>if</span> <span>err</span> <span>:=</span> <span>dc</span>.<span>Decode</span>(<span>&amp;</span><span>data</span>); <span>err</span> <span>!=</span> <span>nil</span> {
    <span>if</span> <span>e</span>, <span>ok</span> <span>:=</span> <span>err</span>.(decoder.<span>SyntaxError</span>); <span>ok</span> {
        
        <span>/*Syntax error at index 3: invalid char</span>
<span></span>
<span>            [[[}]]</span>
<span>            ...^..</span>
<span>        */</span>
        <span>print</span>(<span>e</span>.<span>Description</span>())

        <span>/*&#34;Syntax error at index 3: invalid char\n\n\t[[[}]]\n\t...^..\n&#34;*/</span>
        <span>println</span>(<span>fmt</span>.<span>Sprintf</span>(<span>&#34;%q&#34;</span>, <span>e</span>.<span>Description</span>()))
    }

    <span>/*Decode: Syntax error at index 3: invalid char*/</span>
    <span>t</span>.<span>Fatalf</span>(<span>&#34;Decode: %v&#34;</span>, <span>err</span>) 
}</pre></div>
<h3 dir="auto"><a id="user-content-astnode" aria-hidden="true" href="#astnode"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Ast.Node</h3>
<p dir="auto">Sonic/ast.Node is a completely self-contained AST for JSON. It implements serialization and deserialization both, and provides robust APIs for obtaining and modification of generic data.</p>
<h4 dir="auto"><a id="user-content-getindex" aria-hidden="true" href="#getindex"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Get/Index</h4>
<p dir="auto">Search partial JSON by given paths, which must be non-negative integer or string or nil</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic&#34;

input := []byte(`{&#34;key1&#34;:[{},{&#34;key2&#34;:{&#34;key3&#34;:[1,2,3]}}]}`)

// no path, returns entire json
root, err := sonic.Get(input)
raw := root.Raw() // == string(input)

// multiple pathes
root, err := sonic.Get(input, &#34;key1&#34;, 1, &#34;key2&#34;)
sub := root.Get(&#34;key3&#34;).Index(2).Int64() // == 3
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic&#34;</span>

<span>input</span> <span>:=</span> []<span>byte</span>(<span>`{&#34;key1&#34;:[{},{&#34;key2&#34;:{&#34;key3&#34;:[1,2,3]}}]}`</span>)

<span>// no path, returns entire json</span>
<span>root</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>Get</span>(<span>input</span>)
<span>raw</span> <span>:=</span> <span>root</span>.<span>Raw</span>() <span>// == string(input)</span>

<span>// multiple pathes</span>
<span>root</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>Get</span>(<span>input</span>, <span>&#34;key1&#34;</span>, <span>1</span>, <span>&#34;key2&#34;</span>)
<span>sub</span> <span>:=</span> <span>root</span>.<span>Get</span>(<span>&#34;key3&#34;</span>).<span>Index</span>(<span>2</span>).<span>Int64</span>() <span>// == 3</span></pre></div>
<p dir="auto"><strong>Tip</strong>: since <code>Index()</code> uses offset to locate data, which is faster much than scanning like <code>Get()</code>, we suggest you use it as much as possible. And sonic also provides another API <code>IndexOrGet()</code> to underlying use offset as well as ensuring the key is matched.</p>
<h4 dir="auto"><a id="user-content-setunset" aria-hidden="true" href="#setunset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Set/Unset</h4>
<p dir="auto">Modify the json content by Set()/Unset()</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic&#34;

// Set
exist, err := root.Set(&#34;key4&#34;, NewBool(true)) // exist == false
alias1 := root.Get(&#34;key4&#34;) 
println(alias1.Valid()) // true
alias2 := root.Index(1)
println(alias1 == alias2) // true

// Unset
exist, err := root.UnsetByIndex(1) // exist == true
println(root.Get(&#34;key4&#34;).Check()) // &#34;value not exist&#34;
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic&#34;</span>

<span>// Set</span>
<span>exist</span>, <span>err</span> <span>:=</span> <span>root</span>.<span>Set</span>(<span>&#34;key4&#34;</span>, <span>NewBool</span>(<span>true</span>)) <span>// exist == false</span>
<span>alias1</span> <span>:=</span> <span>root</span>.<span>Get</span>(<span>&#34;key4&#34;</span>) 
<span>println</span>(<span>alias1</span>.<span>Valid</span>()) <span>// true</span>
<span>alias2</span> <span>:=</span> <span>root</span>.<span>Index</span>(<span>1</span>)
<span>println</span>(<span>alias1</span> <span>==</span> <span>alias2</span>) <span>// true</span>

<span>// Unset</span>
<span>exist</span>, <span>err</span> <span>:=</span> <span>root</span>.<span>UnsetByIndex</span>(<span>1</span>) <span>// exist == true</span>
<span>println</span>(<span>root</span>.<span>Get</span>(<span>&#34;key4&#34;</span>).<span>Check</span>()) <span>// &#34;value not exist&#34;</span></pre></div>
<h4 dir="auto"><a id="user-content-serialize" aria-hidden="true" href="#serialize"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Serialize</h4>
<p dir="auto">To encode <code>ast.Node</code> as json, use <code>MarshalJson()</code> or <code>json.Marshal()</code> (MUST pass the node&#39;s pointer)</p>
<div data-snippet-clipboard-copy-content="import (
    &#34;encoding/json&#34;
    &#34;github.com/bytedance/sonic&#34;
)

buf, err := root.MarshalJson()
println(string(buf))                // {&#34;key1&#34;:[{},{&#34;key2&#34;:{&#34;key3&#34;:[1,2,3]}}]}
exp, err := json.Marshal(&amp;root)     // WARN: use pointer
println(string(buf) == string(exp)) // true
"><pre><span>import</span> (
    <span>&#34;encoding/json&#34;</span>
    <span>&#34;github.com/bytedance/sonic&#34;</span>
)

<span>buf</span>, <span>err</span> <span>:=</span> <span>root</span>.<span>MarshalJson</span>()
<span>println</span>(<span>string</span>(<span>buf</span>))                <span>// {&#34;key1&#34;:[{},{&#34;key2&#34;:{&#34;key3&#34;:[1,2,3]}}]}</span>
<span>exp</span>, <span>err</span> <span>:=</span> <span>json</span>.<span>Marshal</span>(<span>&amp;</span><span>root</span>)     <span>// WARN: use pointer</span>
<span>println</span>(<span>string</span>(<span>buf</span>) <span>==</span> <span>string</span>(<span>exp</span>)) <span>// true</span></pre></div>
<h4 dir="auto"><a id="user-content-apis" aria-hidden="true" href="#apis"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>APIs</h4>
<ul dir="auto">
<li>validation: <code>Check()</code>, <code>Error()</code>, <code>Valid()</code>, <code>Exist()</code></li>
<li>searching: <code>Index()</code>, <code>Get()</code>, <code>IndexPair()</code>, <code>IndexOrGet()</code>, <code>GetByPath()</code></li>
<li>go-type casting: <code>Int64()</code>, <code>Float64()</code>, <code>String()</code>, <code>Number()</code>, <code>Bool()</code>, <code>Map[UseNumber|UseNode]()</code>, <code>Array[UseNumber|UseNode]()</code>, <code>Interface[UseNumber|UseNode]()</code></li>
<li>go-type packing: <code>NewRaw()</code>, <code>NewNumber()</code>, <code>NewNull()</code>, <code>NewBool()</code>, <code>NewString()</code>, <code>NewObject()</code>, <code>NewArray()</code></li>
<li>iteration: <code>Values()</code>, <code>Properties()</code></li>
<li>modification: <code>Set()</code>, <code>SetByIndex()</code>, <code>Add()</code>, <code>Cap()</code>, <code>Len()</code></li>
</ul>
<h2 dir="auto"><a id="user-content-tips" aria-hidden="true" href="#tips"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tips</h2>
<h3 dir="auto"><a id="user-content-pretouch" aria-hidden="true" href="#pretouch"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Pretouch</h3>
<p dir="auto">Since Sonic uses <a href="https://github.com/twitchyliquid64/golang-asm">golang-asm</a> as a JIT assembler, which is NOT very suitable for runtime compiling, first-hit running of a huge schema may cause request-timeout or even process-OOM. For better stability, we advise to <strong>use <code>Pretouch()</code> for huge-schema or compact-memory application</strong> before <code>Marshal()/Unmarshal()</code>.</p>
<div data-snippet-clipboard-copy-content="import (
    &#34;reflect&#34;
    &#34;github.com/bytedance/sonic&#34;
)

func init() {
    var v HugeStruct
    err := sonic.Pretouch(reflect.TypeOf(v))
}
"><pre><span>import</span> (
    <span>&#34;reflect&#34;</span>
    <span>&#34;github.com/bytedance/sonic&#34;</span>
)

<span>func</span> <span>init</span>() {
    <span>var</span> <span>v</span> <span>HugeStruct</span>
    <span>err</span> <span>:=</span> <span>sonic</span>.<span>Pretouch</span>(<span>reflect</span>.<span>TypeOf</span>(<span>v</span>))
}</pre></div>
<p dir="auto"><strong>CAUTION:</strong>  use the <strong>STRUCT instead of its POINTER</strong> to <code>Pretouch()</code>, otherwise it won&#39;t work when you pass the pointer to <code>Marshal()/Unmarshal()</code>!</p>
<h3 dir="auto"><a id="user-content-pass-string-or-byte" aria-hidden="true" href="#pass-string-or-byte"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Pass string or []byte?</h3>
<p dir="auto">For alignment to encoding/json, we provide API to pass <code>[]byte</code> as argument, but the string-to-bytes copy is conducted at the same time considering safety, which may lose performance when origin JSON is huge. Therefore, you can use <code>UnmarshalString</code>, <code>GetFromString</code> to pass a string, as long as your origin data is a string or <strong>nocopy-cast</strong> is safe for your []byte.</p>
<h3 dir="auto"><a id="user-content-better-performance-for-generic-deserializing" aria-hidden="true" href="#better-performance-for-generic-deserializing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Better performance for generic deserializing</h3>
<p dir="auto">In most cases, <code>Unmarshal()</code> with schemalized data performs better than <code>ast.Loads()</code>/<code>node.Interface()</code> with generic data. But if you only have a schema for partial json, you can combine <code>Get()</code> and <code>Unmarshal()</code> together:</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic&#34;

node, err := sonic.GetFromString(_TwitterJson, &#34;statuses&#34;, 3, &#34;user&#34;)
var user User // your partial schema...
err = sonic.UnmarshalString(node.Raw(), &amp;user)
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic&#34;</span>

<span>node</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>GetFromString</span>(<span>_TwitterJson</span>, <span>&#34;statuses&#34;</span>, <span>3</span>, <span>&#34;user&#34;</span>)
<span>var</span> <span>user</span> <span>User</span> <span>// your partial schema...</span>
<span>err</span> <span>=</span> <span>sonic</span>.<span>UnmarshalString</span>(<span>node</span>.<span>Raw</span>(), <span>&amp;</span><span>user</span>)</pre></div>
<p dir="auto">Even if you don&#39;t have any schema, Use <code>InterfaceUseNode()</code> as the container of generic values instead of <code>Map()</code> or <code>Interface()</code>:</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/bytedance/sonic&#34;

node, err := sonic.GetFromString(_TwitterJson, &#34;statuses&#34;, 3, &#34;user&#34;)
user := node.InterfaceUseNode() // use node.Interface() as little as possible
"><pre><span>import</span> <span>&#34;github.com/bytedance/sonic&#34;</span>

<span>node</span>, <span>err</span> <span>:=</span> <span>sonic</span>.<span>GetFromString</span>(<span>_TwitterJson</span>, <span>&#34;statuses&#34;</span>, <span>3</span>, <span>&#34;user&#34;</span>)
<span>user</span> <span>:=</span> <span>node</span>.<span>InterfaceUseNode</span>() <span>// use node.Interface() as little as possible</span></pre></div>
<p dir="auto">Why?</p>
<ol dir="auto">
<li>using <code>Interface()</code> means Sonic must parse all the underlying values, while in most cases you only need several of them;</li>
<li><code>map[x]</code> is not efficient enough compared to <code>array[x]</code>, but <code>ast.Node</code> can use <code>Index()</code>, for either array or object node;</li>
<li><code>map</code>&#39;s performance degrades a lot once rehashing triggered, but <code>ast.Node</code> doesn&#39;t has this concern;</li>
</ol>
</article>
        </div></div>
  </body>
</html>
