<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tone-row.com/blog/graph-syntax-css-selectors">Original</a>
    <h1>A CSS-Inspired Syntax for Flowcharts</h1>
    
    <div id="readability-page-1" class="page"><div><div><section><blockquote><p><strong>TL;DR</strong> This is an article about stumbling into an interesting syntax for describing graphs. If you want to see it in action you can <a target="_blank" href="http://graph-selector-syntax.vercel.app/">head straight for the demos!</a></p>
</blockquote>
<p><h2>Some Context</h2></p>
<p>About 18 months ago I created <a target="_blank" href="https://flowchart.fun">Flowchart Fun</a>: an app for generating flowcharts from text.</p>
<p>To create your flowchart, the app determines the nodes and edges from the input text according to a set of rules:</p>
<div><ul><li>text creates a node</li><li>an indent creates an edge</li><li>text before a colon <code>:</code> labels an edge</li></ul></div>

<img src="https://res.cloudinary.com/tone-row/image/upload/v1661117132/tone-row-2021/kw29haya3igd7w2j7bgv.png" width="443" alt="Flowchart Node A edge to Node B"/>
<p>Simple! Elegant! Chic!</p>
<p>But as with all things, over time some complexity crept in.</p>
<p><h2>#1 - Too Many Parents</h2></p>
<p>As long as nodes have zero or one parent, creating edges with indentation works great, e.g. a tree ðŸŒ³ or document outline; however, pretty often flowcharts contain at least one node with multiple parents.</p>
<img src="https://cacoo.com/wp-app/uploads/2018/12/5-Are-you-hungry-flowchart.jpg" alt="Cake flowchart"/>
<p>In our syntax a node only &#34;lives&#34; on one line, so we added the pointer syntax <code>()</code> to reference nodes elsewhere in the document.</p>
<div><div><pre><code>Are you hungry?
  yes: Do you want to eat healthy?
    yes: No you don&#39;t
      oh right: CAKE!
    hell no: (CAKE!)
  no: yes you are
    (CAKE!)</code></pre></div></div>

<p><h2>#2 - Long Labels</h2></p>
<p>When the label is short, like <code>CAKE!</code>, creating pointers is as easy as... pie, but what about when the label is a college essay?</p>
<img src="https://res.cloudinary.com/tone-row/image/upload/v1661099327/tone-row-2021/wnbqcpxp0iuxato16ckf.png" width="443" alt="Extremely long label for flowchart node"/>
<p>Typing long labels twice (once for the node and once for the pointer) would be time consuming and clutter the document- not to mention the label could change and cause the pointer to break. ðŸ˜•</p>
<p>To solve this problem we use the concept of ID&#39;s. We can give our node an ID <code>[a]</code> and reference the ID in the pointer <code>(a)</code>. Crisis averted!</p>
<div><div><pre><code>[a] This is an extraordinarily long label that will flow onto many lines and ultimately cause a lot of heartache for this otherwise simple graph.
  b
    (a)</code></pre></div></div>

<p><h2>#3 - Adding Styles</h2></p>
<p><a target="_blank" href="https://flowchart.fun">Flowchart Fun</a> is built using <a target="_blank" href="https://js.cytoscape.org/">Cytoscape.js</a> which uses the concept of CSS selectors to style nodes and edges.</p>
<p>As a frontend developer, I love this solution. After all, the DOM is a tree of nodes too.</p>
<img src="https://res.cloudinary.com/tone-row/image/upload/v1661371828/fy4p0qexfzyine2pecqy.png" width="350" alt="If it&#39;s good enough for the DOM it&#39;s good enough for me!"/>
<p>To add colors and shapes, I brought Cytoscape&#39;s concept of classes into the syntax.</p>
<div><div><pre><code>[a.blue] This is an extraordinarily long label that will flow onto many lines and ultimately cause a lot of heartache for this otherwise simple graph.
  [.star.yellow] b
    (a)</code></pre></div></div>
<img src="https://res.cloudinary.com/tone-row/image/upload/v1661099327/tone-row-2021/wr77s2b8fvcbugjqlcgz.png" width="443" alt="Flowchart with Styles"/>

<p><h2>Not badâ€¦ could it be better?</h2></p>
<p>This is how Flowchart Fun works today, but Iâ€™ve always felt it missed the opportunity of piggy-backing on a more well-known syntax: CSS Selectors.</p>
<p>Many people are familiar with <code>#</code> representing idâ€™s, <code>.</code> representing classes, and being able to string them together to refer to specific elements in the DOM. Consider this alternative:</p>
<div><div><pre><code>#a.blue This is an extraordinarily long label that will flow onto many lines and ultimately cause a lot of heartache for this otherwise simple graph.
  .star.yellow b
    (#a)</code></pre></div></div>
<p>With that, we have something that looks a little more familiar! For my frontends, it may even remind you of <a target="_blank" href="https://github.com/pugjs/pug">Pug</a> or <a target="_blank" href="https://github.com/dscape/jade">Jade</a>. The familiarity is already a win, but after staring at this revised syntax for a bit something else clicked.</p>
<p><h2>Storytime</h2></p>
<p>Once upon a time, someone wrote to me asking how they could use the syntax to create Bayesian Decision Trees. Naturally, being a very intelligent smart person, I immediately knew what they were talking about- but in case you do not, some internet searching reveals that it&#39;s something like this:</p>
<img src="https://i.stack.imgur.com/LP10c.jpg" alt="bayesian decision tree" width="443"/>
<p>The idea is that each edge stores a probability. Then, the probability of arriving at a node can be determined by walking up the tree and multiplying the edges on the way.</p>
<p>I built a crude version of this idea and eventually moved on, but one thing always stuck with me- <strong>being able to associate arbitrary data to nodes and edges would be really powerful.</strong> ðŸª„</p>
<p><h2>ðŸ’¡</h2></p>
<p>I eventually had the galaxy brain moment. CSS Selectors. Specifically, the attribute syntax for CSS selectors (i.e., <code>[key=value]</code>) is a known way to target- or in our case express- auxiliary data about a node.</p>
<div><div><pre><code>#id.class1.class2[key=value][key2=value2] Node Label</code></pre></div></div>
<p>Now, in addition to capturing the relationship between data points (nodes, edges) we can also store information about our data points; effectively storing tabular data. <em>Look ma, I&#39;m a CSV!</em></p>
<div><div><pre><code>[population=12396372] SÃ£o Paulo
[population=6775561] Rio de Janeiro
[population=3094325] Distrito Federal
[population=2900319] Bahia
[population=2703391] CearÃ¡</code></pre></div></div>
<img src="https://media0.giphy.com/media/9V1F9o1pBjsxFzHzBr/giphy.gif?cid=ecf05e47kei7k1k05pxt7snqva7ip3fdb49enl3ss4ai3fgg&amp;rid=giphy.gif&amp;ct=g" width="443" alt="but wait, there&#39;s more"/>
<p>Taking it a step further, rather than just being descriptors, we could turn around and use our selectors the way HÃ¥kon Wium Lie (the myth, the legend, the inventor of CSS) originally intended: to <strong>target</strong> a set of nodes in our graph. For example:</p>
<div><div><pre><code>.color red
.color blue
.color yellow

// create edges from node &#39;paintbrush&#39; to &#39;red&#39;, &#39;blue&#39;, and &#39;yellow&#39;
// with the label &#39;paints&#39;
paintbrush
	paints: (.color)</code></pre></div></div>
<img src="https://res.cloudinary.com/tone-row/image/upload/v1661534823/tone-row-2021/okixel38w3rcmxmxrwd7.png" width="443" alt="Paintbrush Flowchart"/>
<p><h2><em>Okay, and...?</em></h2></p>
<p>If you&#39;ve read this far, then you&#39;re either great at procrastinating or you have the same burning passion for quirky domain-specific languages as I do. Either way, I promise I&#39;m at the point.</p>
<p>This is what I think is cool about thisâ€” instead of just describing a flowchart, this syntax can be used to describe a ton of different types of data visualizations. It can be used to produce <a target="_blank" href="https://graph-selector-syntax.vercel.app/bar-graph">bar charts</a>, <a target="_blank" href="https://graph-selector-syntax.vercel.app/tabular-data">area charts</a>, or even <a target="_blank" href="https://graph-selector-syntax.vercel.app/sankey">Sankey diagrams</a>.</p>
<img src="https://res.cloudinary.com/tone-row/image/upload/v1661536356/tone-row-2021/zhzjqdhrvvjnbyicglsc.png" width="443" alt="Sankey Diagram"/>
<p>We can even use the same document to produce multiple types of graphs to illustrate different properties of the data. Wowowow!</p>
<img src="https://c.tenor.com/qAKRIiLIsXgAAAAM/cotton-candy-girl.gif"/>
<p><h2>A CSS-Inspired Syntax for Flowcharts?</h2></p>
<p>Sure, why not! This is what I&#39;ve done so far:</p>

<p><h2>What do you think? ðŸ‘€</h2></p>
<p>I&#39;m really interested in getting some feedback, especially for these questions:</p>
<div><ul><li>What could people see this being used for?</li><li>I named the repo <strong>Graph Selector Syntax</strong>, but that&#39;s not very fun. Can anyone suggest a name?</li><li>Should I migrate <a target="_blank" href="https://flowchart.fun">Flowchart Fun</a> to this syntax?</li></ul></div>
<p>Thank you for reading! Find me at <a target="_blank" href="https://twitter.com/tone_row_">@tone_row_</a> on Twitter</p></section></div></div></div>
  </body>
</html>
