<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.spinellis.gr/blog/20251223/?yc261223">Original</a>
    <h1>An initial analysis of the discovered Unix V4 tape</h1>
    
    <div id="readability-page-1" class="page"><div> <!-- Left content -->
  <p>Several news outlets
<a href="https://github.com/thaliaarchi/unix-history/blob/main/users/utah/v4.md#News">reported</a>
the <a href="https://discuss.systems/@ricci/115504720054699983">discovery of a 1970s Fourth Edition Research Unix magnetic tape</a>
at the University of Utah in July 2025 and its successful restoration.
This is a significant find, because up to now only
the Fourth Edition’s manual was thought to have survived.
Over the past few days I incorporated the tape’s source code into the
<a href="https://github.com/dspinellis/unix-history-repo">Unix History Repository</a>
hosted on GitHub (see it <a href="https://github.com/dspinellis/unix-history-repo/tree/Research-V4-Snapshot-Development?tab=readme-ov-file">here</a>)
and studied the code’s composition.</p>
<p>The Fourth Research Edition Unix came out of the famous
AT&amp;T Bell Laboratories in November 1973.
A significant development it introduced was the rewriting of large
parts of the system’s kernel in a high-level language (early C)
rather than PDP-11 assembly language.
The tape contains a complete system dump,
including both source code and the compiled binaries and kernel.
For inclusion in the Unix history repository, I removed the binaries,
to match what is normally put under source code version control.</p>
<div id="cb1"><pre><code><span id="cb1-1"><a href="https://www.spinellis.gr/blog/20251223/#cb1-1" aria-hidden="true" tabindex="-1"></a><span>find</span> <span>$dir</span> <span>-name</span> <span>&#39;*.[oa]&#39;</span> <span>|</span> <span>xargs</span> rm</span>
<span id="cb1-2"><a href="https://www.spinellis.gr/blog/20251223/#cb1-2" aria-hidden="true" tabindex="-1"></a><span>rm</span> <span>-rf</span> <span>$dir</span>/bin <span>$dir</span>/usr/bin <span>$dir</span>/usr/games <span>$dir</span>/lib <span>$dir</span>/dev</span>
<span id="cb1-3"><a href="https://www.spinellis.gr/blog/20251223/#cb1-3" aria-hidden="true" tabindex="-1"></a><span>rm</span> <span>$dir</span>/etc/<span>{lpd</span><span>,</span><span>init</span><span>,</span><span>msh</span><span>,</span><span>getty</span><span>,</span><span>mkfs</span><span>,</span><span>mknod</span><span>,</span><span>glob</span><span>,</span><span>update</span><span>,</span><span>umount</span><span>,</span><span>mount}</span></span>
<span id="cb1-4"><a href="https://www.spinellis.gr/blog/20251223/#cb1-4" aria-hidden="true" tabindex="-1"></a><span>rm</span> <span>$dir</span>/unix</span>
<span id="cb1-5"><a href="https://www.spinellis.gr/blog/20251223/#cb1-5" aria-hidden="true" tabindex="-1"></a><span>rm</span> <span>$dir</span>/usr/mdec/<span>[</span><span>tm</span><span>]</span>boot <span>$dir</span>/usr/sys/conf/mkconf <span>$dir</span>/usr/fort/fc1</span>
<span id="cb1-6"><a href="https://www.spinellis.gr/blog/20251223/#cb1-6" aria-hidden="true" tabindex="-1"></a><span>rm</span> <span>$dir</span>/usr/c/cvopt <span>$dir</span>/usr/lib/suftab</span></code></pre></div>
<p><img src="https://www.spinellis.gr/blog/20251223/tape.jpg" alt="The discovered Fourth Edition tape (photo credit Rob Ricci)"/>
As with other source code snapshots included in the Unix history repository,
the (synthetic) Git commit timestamps are derived from the file timestamps
while the commit authors are derived from a
<a href="https://github.com/dspinellis/unix-history-make/blob/master/src/author-path/Research-V4">manually-created map file</a>.
I <a href="https://github.com/dspinellis/unix-history-make/commit/b7078d294eb059b8f8fd749e8a9a978523fee1b5#diff-569406683cf381232b267505ddd708e67e51cd19ef26f5a14ce3351ec48e663c">updated</a>
the existing V4 author map file based on information I had gathered
for preceding and following Unix Research editions.
I explicitly put <code>ken,dmr</code>
(Ken Thompson and Dennis Ritchie the system’s main developers)
in all source code files where I lacked author
information (this is also the default introduced via a <code>.*</code> regular expression)
to mark missing details.
Two members of the original Bell Labs Unix development team kindly
provided me information to fill some details, such as
the developer of the SNOBOL III interpreter (<a href="https://en.wikipedia.org/wiki/Ken_Thompson">Ken Thompson</a>)
and the implementer of the math library and emulator (<a href="https://en.wikipedia.org/wiki/Robert_Morris_(cryptographer)">Robert H. Morris</a>).</p>
<p>Some have claimed that the tape’s contents are very close to the Fifth Edition
rather to what really was the Fourth Edition.
The reason for this claim is that, in contrast to Unix manual editions
(which were formally numbered and give the Unix Research Editions their name)
distributed software tapes were mostly a copy of whatever was at the time in
the (single) Unix development computer.
I set out to see the differences between the two versions.
First, I looked at the base file names included in the two.</p>
<div id="cb2"><pre><code><span id="cb2-1"><a href="https://www.spinellis.gr/blog/20251223/#cb2-1" aria-hidden="true" tabindex="-1"></a><span>normalize()</span></span>
<span id="cb2-2"><a href="https://www.spinellis.gr/blog/20251223/#cb2-2" aria-hidden="true" tabindex="-1"></a><span>{</span></span>
<span id="cb2-3"><a href="https://www.spinellis.gr/blog/20251223/#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span>sed</span> <span>&#39;s|.*/||&#39;</span> <span>|</span> <span>sort</span> <span>-u</span></span>
<span id="cb2-4"><a href="https://www.spinellis.gr/blog/20251223/#cb2-4" aria-hidden="true" tabindex="-1"></a><span>}</span></span>
<span id="cb2-5"><a href="https://www.spinellis.gr/blog/20251223/#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="https://www.spinellis.gr/blog/20251223/#cb2-6" aria-hidden="true" tabindex="-1"></a><span>comm</span>  <span>-3</span> <span>\</span></span>
<span id="cb2-7"><a href="https://www.spinellis.gr/blog/20251223/#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span>&lt;(</span><span>git</span> ls-tree <span>-r</span> <span>--name-only</span> Research-V4-Snapshot-Development <span>|</span> <span>normalize</span><span>)</span> <span>\</span></span>
<span id="cb2-8"><a href="https://www.spinellis.gr/blog/20251223/#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span>&lt;(</span><span>git</span> ls-tree <span>-r</span> <span>--name-only</span> Research-V5-Snapshot-Development <span>|</span> <span>normalize</span><span>)</span></span></code></pre></div>
<p>The above command, which outputs files whose base file name occurs only
in one of the two releases, shows only the following files introduced
in the Fifth Edition.</p>
<pre><code>        c13.c
        c21.c
        c2h.c
        cmp.c
        ldfps.s</code></pre>
<p>So, the C compiler grew by a few files, and the <code>cmp</code> (compare) utility
was written in C.</p>
<p>To dig deeper I then run <code>git blame</code> on each file of the two editions,
to see what parts of preceding editions they incorporated.</p>
<div id="cb4"><pre><code><span id="cb4-1"><a href="https://www.spinellis.gr/blog/20251223/#cb4-1" aria-hidden="true" tabindex="-1"></a><span># For each edition</span></span>
<span id="cb4-2"><a href="https://www.spinellis.gr/blog/20251223/#cb4-2" aria-hidden="true" tabindex="-1"></a><span>for</span> ref <span>in</span> Research-V4-Snapshot-Development <span>\</span></span>
<span id="cb4-3"><a href="https://www.spinellis.gr/blog/20251223/#cb4-3" aria-hidden="true" tabindex="-1"></a>  Research-V5-Snapshot-Development <span>;</span> <span>do</span></span>
<span id="cb4-4"><a href="https://www.spinellis.gr/blog/20251223/#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span>echo</span> <span>$ref</span></span>
<span id="cb4-5"><a href="https://www.spinellis.gr/blog/20251223/#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span># For all the edition&#39;s files</span></span>
<span id="cb4-6"><a href="https://www.spinellis.gr/blog/20251223/#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span>git</span> ls-tree <span>-r</span> <span>--name-only</span> <span>$ref</span> <span>|</span></span>
<span id="cb4-7"><a href="https://www.spinellis.gr/blog/20251223/#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span># Exclude administrative files introduced in the repo.</span></span>
<span id="cb4-8"><a href="https://www.spinellis.gr/blog/20251223/#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span>grep</span> <span>-Ev</span> <span>&#39;README|LICENSE|\.pdf|\.ref&#39;</span> <span>|</span></span>
<span id="cb4-9"><a href="https://www.spinellis.gr/blog/20251223/#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span># Run git-blame on each.</span></span>
<span id="cb4-10"><a href="https://www.spinellis.gr/blog/20251223/#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span>xargs</span> <span>-I</span> <span>&#39;{}&#39;</span> git blame <span>-M</span> <span>-M</span> <span>-C</span> <span>-C</span> <span>$ref</span> <span>--</span> <span>&#39;{}&#39;</span> <span>|</span></span>
<span id="cb4-11"><a href="https://www.spinellis.gr/blog/20251223/#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span>sort</span> <span>|</span></span>
<span id="cb4-12"><a href="https://www.spinellis.gr/blog/20251223/#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span># Sum lines for each commit</span></span>
<span id="cb4-13"><a href="https://www.spinellis.gr/blog/20251223/#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span>uniq</span> <span>-c</span> <span>|</span></span>
<span id="cb4-14"><a href="https://www.spinellis.gr/blog/20251223/#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span># Obtain lines and provenance of each commit; output totals.</span></span>
<span id="cb4-15"><a href="https://www.spinellis.gr/blog/20251223/#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span>awk</span> <span>&#39;{(&#34;git show &#34; $2 &#34;| awk &#39;</span><span>\&#39;</span><span>&#39;/Synthesized-from:/{print $2}&#39;</span><span>\&#39;</span><span>&#39;&#34;) | getline ver; total[ver] += $1 }</span></span>
<span id="cb4-16"><a href="https://www.spinellis.gr/blog/20251223/#cb4-16" aria-hidden="true" tabindex="-1"></a><span>      END {for (v in total) print v, total[v]}&#39;</span></span>
<span id="cb4-17"><a href="https://www.spinellis.gr/blog/20251223/#cb4-17" aria-hidden="true" tabindex="-1"></a><span>done</span></span></code></pre></div>
<p>The output gave me the following Fourth Edition’s composition
in terms of code lines:</p>
<pre><code>v4 75676
v3 6590
v2 168</code></pre>
<p>This shows a lot of new material and about 10% coming from earlier editions.</p>
<p>The corresponding output for the Fifth Edition is as follows.</p>
<pre><code>v5 11181
v4 52238
v3 3296
v2 168</code></pre>
<p>This shows that 52 thousand lines of the Fourth Edition are indeed
part of the Fifth Edition, but the Fifth Edition also introduces about eleven
new thousand lines of code.
This is not an insignificant amount.</p>
<p>Finally, I also looked at the average timestamp of the files
included in each release.</p>
<div id="cb7"><pre><code><span id="cb7-1"><a href="https://www.spinellis.gr/blog/20251223/#cb7-1" aria-hidden="true" tabindex="-1"></a><span># For each Research Edition</span></span>
<span id="cb7-2"><a href="https://www.spinellis.gr/blog/20251223/#cb7-2" aria-hidden="true" tabindex="-1"></a><span>for</span> v <span>in</span> <span>$(</span><span>seq</span> 1 7<span>)</span> <span>;</span> <span>do</span></span>
<span id="cb7-3"><a href="https://www.spinellis.gr/blog/20251223/#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span>ref</span><span>=</span>Research-V<span>$v</span>-Snapshot-Development</span>
<span id="cb7-4"><a href="https://www.spinellis.gr/blog/20251223/#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span>printf</span> <span>&#39;%s\t&#39;</span> <span>$ref</span></span>
<span id="cb7-5"><a href="https://www.spinellis.gr/blog/20251223/#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span># List all files</span></span>
<span id="cb7-6"><a href="https://www.spinellis.gr/blog/20251223/#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span>git</span> ls-tree <span>-r</span> <span>--name-only</span> <span>$ref</span> <span>|</span></span>
<span id="cb7-7"><a href="https://www.spinellis.gr/blog/20251223/#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span># Exclude administrative files introduced in the repo.</span></span>
<span id="cb7-8"><a href="https://www.spinellis.gr/blog/20251223/#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span>grep</span> <span>-Ev</span> <span>&#39;README|LICENSE|\.pdf|\.ref&#39;</span> <span>|</span></span>
<span id="cb7-9"><a href="https://www.spinellis.gr/blog/20251223/#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span># Output each file&#39;s commit time.</span></span>
<span id="cb7-10"><a href="https://www.spinellis.gr/blog/20251223/#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span>xargs</span> <span>-I@</span> git log <span>-1</span> <span>--format</span><span>=</span>%at <span>$ref</span> <span>--</span> @ <span>|</span></span>
<span id="cb7-11"><a href="https://www.spinellis.gr/blog/20251223/#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span># Obtain average value and format it as a date.</span></span>
<span id="cb7-12"><a href="https://www.spinellis.gr/blog/20251223/#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span>date</span> <span>-I</span> <span>-d</span> @<span>$(</span><span>awk</span> <span>&#39;{s += $1} END {printf(&#34;%.0f&#34;, s / NR)}&#39;</span><span>)</span></span>
<span id="cb7-13"><a href="https://www.spinellis.gr/blog/20251223/#cb7-13" aria-hidden="true" tabindex="-1"></a><span>done</span></span></code></pre></div>
<p>Here are the results.</p>
<pre><code>V1        1972-06-20
V2        1972-05-31
V3        1973-03-10
V4        1974-03-06
V5        1974-11-28
V6        1975-06-15
V7        1979-01-25</code></pre>
<p>The results indicate that the Fourth Edition precedes the Fifth
Edition by about about eight months — a significant period for the
pace by which the system was evolving at the time.
(The results also show that I need to examine the apparent timing
mismatch between the First and Second Editions.)</p>

    <p>
    <!-- COMMENTS -->
    <span><a href="https://www.spinellis.gr/cgi-bin/comment.pl?date=20251223#comments">Comments</a></span>
     
    <!-- Bluesky post -->

    <a href="https://bsky.app/intent/compose?text=An%20initial%20analysis%20of%20the%20discovered%20Unix%20V4%20tape%20https%3A%2F%2Fwww.spinellis.gr%2Fblog%2F20251223%20via%20%40CoolSWEng.bsky.social" target="_blank"><i></i>Post</a>

    <!-- Mastodon post -->
    <a href="https://toot.kytta.dev/?text=An%20initial%20analysis%20of%20the%20discovered%20Unix%20V4%20tape%20https%3A%2F%2Fwww.spinellis.gr%2Fblog%2F20251223%20via%20%40CoolSWEng%40mastodon.acm.org" target="_blank"><i></i> Toot!</a>
    <!-- Twitter button -->
    <span></span>

    <!-- Facebook button -->
    
    </p></div></div>
  </body>
</html>
