<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/google/security-research/security/advisories/GHSA-4xq7-4mgh-gp6w">Original</a>
    <h1>AMD: Microcode Signature Verification Vulnerability</h1>
    
    <div id="readability-page-1" class="page"><div>
  

<div>
  <div>
    <h3 dir="auto">Summary</h3>
<p dir="auto">Google Security Team has identified a security vulnerability in some AMD Zen-based CPUs. This vulnerability allows an adversary with local administrator privileges (ring 0 from outside a VM) to load malicious microcode patches. We have demonstrated the ability to craft arbitrary malicious microcode patches on Zen 1 through Zen 4 CPUs. The vulnerability is that the CPU uses an insecure hash function in the signature validation for microcode updates.  This vulnerability could be used by an adversary to compromise confidential computing workloads protected by the newest version of AMD Secure Encrypted Virtualization, SEV-SNP or to compromise Dynamic Root of Trust Measurement.</p>
<p dir="auto">AMD SEV-SNP users can verify the fix by confirming TCB values for SNP in their attestation reports (can be observed from a VM, consult <a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-3019.html" rel="nofollow">AMD&#39;s security bulletin</a> for further details).</p>
<h3 dir="auto">Severity</h3>
<p dir="auto">HIGH - Improper signature verification inÂ AMD CPU ROM microcode patch loader may allow an attacker with local administrator privilege to load malicious CPU microcode resulting in loss of confidentiality and integrity of a confidential guest running under AMD SEV-SNP.</p>
<h3 dir="auto">Proof of Concept</h3>
<p dir="auto">A test payload for Milan and Genoa CPUs that makes the RDRAND instruction return 4 can be downloaded <a href="https://github.com/google/security-research/tree/master/pocs/cpus/entrysign">here</a> (applying it requires the user to be root from outside of a VM).</p>
<h3 dir="auto">Timeline</h3>
<p dir="auto"><strong>Date reported</strong>:  September 25, 2024</p>
<p dir="auto">Google notified AMD of this vulnerability on September 25, 2024. AMD subsequently provided an embargoed fix to its customers on December 17, 2024. To coordinate with AMD, we made a one-off exception to our standard <a href="https://about.google/appsecurity" rel="nofollow">vulnerability disclosure policy</a> and delayed public disclosure until today, February 3, 2025. This joint disclosure occurs 46 days after AMD shared the fix with its customers and 131 days after Google&#39;s initial report. Due to the deep supply chain, sequence and coordination required to fix this issue, we will not be sharing full details at this time in order to give users time to re-establish trust on their confidential-compute workloads. We will share additional details and tools on March 5, 2025.</p>
  </div>
</div>

</div></div>
  </body>
</html>
