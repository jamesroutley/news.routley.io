<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://henvic.dev/posts/uuid/">Original</a>
    <h1>You Don&#39;t Need UUID</h1>
    
    <div id="readability-page-1" class="page"><article>
        
        
        
        <p><time datetime="2021-05-30 00:00:00 +0000 UTC"></time>Sunday, 30 May 2021.</p>
        
        <p><a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a>, short for Universally Unique Identifier (<a href="https://www.rfc-editor.org/info/rfc4122">spec</a>), is a 128-bit identifier format widespread on computer systems.
The following is an example, using its prevalent representation: <samp>a73ba12d-1d8b-2516-3aee-4b15e563a835</samp>.
I’ve experienced first-hand how using UUID hurts the usability of computer systems, and I want you to understand why you certainly don’t need it.</p>
<p>Take Amazon. Which do you think is a link to one of their products?</p>
<ul>
<li><a href="https://amzn.to/3c6n63N">amzn.to/3c6n63N</a></li>
<li>amzn.to/a73ba12d-1d8b-2516-3aee-4b15e563a835</li>
</ul>
<p>A simple ID like <samp>3c6n63N</samp> is more than enough to represent any product while keeping it readable and making communication easier.
A UUID alternative like <samp>a73ba12d-1d8b-2516-3aee-4b15e563a835</samp> is just wasteful from an user’s perspective.</p>
<p>In a specific case, I’ve witnessed entities that were supposed to be exposed to end-users using user-friendly ids while UUIDs were in use internally.
For this to work, either a one-to-one mapping or a separate list of unique ids for your entities are necessary.</p>
<blockquote>
<p>You might as well end up with a combination of the worst of both worlds: UUID + sequentially generated (auto increment) numeric identifiers.</p>
</blockquote>
<p>I’ve seen all sorts of combinations of this on many systems: some entities using only friendly ids, some using only sequential ids, and most using both.</p>
<p>For example, an entity that is used only internally might be using a UUID.
Then a demand to expose it externally appears, and developers add a new friendly ID so that users won’t deal with ridiculously long links.</p>
<ul>
<li>When using UUID, it’s hard to use, track, and compare data manually.</li>
<li>When using sequential ids, you might be leaking sensitive business metrics to the competition or hit scalability and syncing limits.</li>
<li>When using both at the same time, your internal users might have a hard time mapping ids to UUIDs and vice-versa.</li>
</ul>
<p>So, with all this said, I think I’ve made a case for trying to just stick to more accessible ids everywhere!
Next, watch this video, and let’s see a practical alternative.</p>
<div>
        <div>
                
                <p>
                  <iframe src="https://www.youtube.com/embed/gocwRvLhDf8" allowfullscreen="" title="YouTube Video"></iframe>
                </p>

                <p><small>
                <a href="https://www.youtube.com/watch?v=gocwRvLhDf8">Will YouTube Ever Run Out Of Video IDs?</a> by <a href="https://www.tomscott.com/">Tom Scott</a>
                </small></p>
        </div>
</div>
<h2 id="collisions-and-uniqueness">Collisions and uniqueness</h2>
<p>The UUID textual representation is 36 characters long, being four hyphen separators and 32 hexadecimal digits.
There are four versions.
Version 1 and 2 were date-time and MAC address-based.
Version 3 and 5 are namespace name-based.
Version 4 is completely randomly generated (hence, it has more entropy) and is what most web systems seem to use.</p>
<p>It has 16^32 = 2^128 bits that guarantee uniqueness and has an insignificant risk of collision.</p>
<blockquote>
<p>Hexadecimal is commonly used in computing as a compact representation for the binary numeral system.
In hexadecimal, 10 is 0xA, 11 is 0xB, 12 is 0xC, 13 is 0xD, 14 is 0xE, 15 is 0xF, 16 is 0x10, and so on.
Read <a href="https://en.wikipedia.org/wiki/Binary_number#Conversion_to_and_from_other_numeral_systems">Binary number: conversion to and from other numeral systems</a> if you want to learn or review how it works.</p>
</blockquote>
<h2 id="practical-solutions">Practical solutions</h2>
<p>As Tom Scott shows in his video, 11 base58-encoded characters are enough for YouTube to serve content even when considering that private videos should be undiscoverable.</p>
<p>Let’s see what a simple and elegant solution for generating that in Go might be:</p>
<div><div>
<table><tbody><tr><td>
<pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span></code></pre></td>
<td>
<pre tabindex="0"><code data-lang="go"><span><span><span>// NewID generates a random base-58 ID.
</span></span></span><span><span><span></span><span>func</span> <span>NewID</span>() <span>string</span> {
</span></span><span><span>	<span>const</span> (
</span></span><span><span>		<span>alphabet</span> = <span>&#34;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#34;</span> <span>// base58
</span></span></span><span><span><span></span>		<span>size</span>     = <span>11</span>
</span></span><span><span>	)
</span></span><span><span>
</span></span><span><span>        <span>var</span> <span>id</span> = make([]<span>byte</span>, <span>size</span>)
</span></span><span><span>	<span>if</span> <span>_</span>, <span>err</span> <span>:=</span> <span>rand</span>.<span>Read</span>(<span>id</span>); <span>err</span> <span>!=</span> <span>nil</span> {
</span></span><span><span>		panic(<span>err</span>)
</span></span><span><span>	}
</span></span><span><span>	<span>for</span> <span>i</span>, <span>p</span> <span>:=</span> <span>range</span> <span>id</span> {
</span></span><span><span>		<span>id</span>[<span>i</span>] = <span>alphabet</span>[int(<span>p</span>)<span>%</span>len(<span>alphabet</span>)] <span>// discard everything but the least significant bits
</span></span></span><span><span><span></span>	}
</span></span><span><span>	<span>return</span> string(<span>id</span>)
</span></span><span><span>}
</span></span></code></pre></td></tr></tbody></table>
</div>
</div><p><a href="https://play.golang.org/p/T3wvtUNSJcy" lang="en-US">Play with this code</a></p>
<p>This solution uses the human-readable <a href="https://tools.ietf.org/id/draft-msporny-base58-01.html">base58 encoding scheme</a>.
I cheated a little by using only the least significant bits to create the ID instead of trying to squeeze performance as this is good enough.</p>
<p>There are other possibilities. Base58 is just one option. You might have different needs, for example:</p>
<ul>
<li>Using only lowercase to avoid ambiguity</li>
<li>Limiting the number of chars combinations to avoid words (naughty words) coming out as identifiers</li>
</ul>
<p>You just need to do some basic math to make sure you’ve something solid for your use case.</p>
<h3 id="when-to-use-uuid">When to use UUID?</h3>
<p>UUID was designed thinking about distributed systems, but not all distributed systems are equal.
If you’re talking about a web system composed of microservice architecture all running on the same datacenter, perhaps sharing the same database, I’d say it’s implausible that you need UUIDs at all, even if you’re running things at scale.</p>
<p>On the other hand, if you’re ingesting data generated by systems out of your control, it might be a good choice.
I’ve used it when writing a metrics and diagnostics system for CLI tools (<a href="https://github.com/henvic/climetrics">climetrics</a>).
In this specific case, the CLI tool I maintained appended entries to a file flushed to our servers through a background process executed eventually following some heuristics.</p>
<p>Thank you for reading this article.</p>
<blockquote><p lang="en" dir="ltr">You don&#39;t need UUID <a href="https://t.co/pXgAQiy62t">https://t.co/pXgAQiy62t</a></p>— Henrique Vicente (@henriquev) <a href="https://twitter.com/henriquev/status/1399330361126031363?ref_src=twsrc%5Etfw">May 31, 2021</a></blockquote>




<p><small>If you click and buy any of these from Amazon after visiting the links above, I might get a commission from their <a href="https://affiliate-program.amazon.com/">Affiliate program</a>.</small></p>

                
                        
        
</article></div>
  </body>
</html>
