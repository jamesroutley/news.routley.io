<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble">Original</a>
    <h1>The Rubik&#39;s Cube Perfect Scramble (2024)</h1>
    
    <div id="readability-page-1" class="page"><section data-hook="post-description"><div><div><div data-rce-version="10.139.0"><div dir="ltr" data-id="content-viewer"><div><div><p data-breakout="normal"><h2 dir="auto" id="viewer-33l69"><span><span>The Challenge</span></span></h2></p><p dir="auto" id="viewer-96prj79"><span><span>I was playing with my son’s Rubik’s Cubes and tried to scramble a cube randomly so that no two squares with the same color were side by side. Here’s one way to do it:</span></span></p><div data-breakout="normal"><div id="viewer-cs56t2757"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="cs56t2757" data-hook="image-viewer-cs56t2757"><wow-image id="36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;cs56t2757&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:321,&#34;height&#34;:373,&#34;uri&#34;:&#34;36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png/v1/fill/w_321,h_373,al_c,q_85,enc_avif,quality_auto/36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png/v1/fill/w_449,h_522,al_c,lg_1,q_85/36e7f0_43a62088ef1b4e46b04cd880df73ee7a~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p dir="auto" id="viewer-1ua9z83"><span><span>But I wanted a scramble that looked like a random scramble. No matter how many different moves I made, I couldn’t do it. Every time I separated two squares with the same color, two other squares of the same color would touch somewhere else.</span></span></p><p dir="auto" id="viewer-30p6191"><span><span>The most impressive answer was by Florian F:</span></span></p><div data-breakout="normal"><div id="viewer-esu4x10077"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="esu4x10077" data-hook="image-viewer-esu4x10077"><wow-image id="36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;esu4x10077&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:508,&#34;height&#34;:378,&#34;uri&#34;:&#34;36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png/v1/fill/w_508,h_378,al_c,q_85,enc_avif,quality_auto/36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png/v1/fill/w_610,h_454,al_c,lg_1,q_85/36e7f0_175a2ba102914fc2a3a2abd916c7260b~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p dir="auto" id="viewer-5byar95"><span><span>However, it’s clear that every face of this scramble has the same pattern:</span></span></p><p dir="auto" id="viewer-e134e97"><span><span>A	D	A</span></span></p><p dir="auto" id="viewer-vr3ll99"><span><span>B	E	B</span></span></p><p dir="auto" id="viewer-nc48i101"><span><span>C	F	C</span></span></p><p dir="auto" id="viewer-6lfs1103"><span><span>I set out to try to find a better scramble.</span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-ib499105"><span><span>The Requirements</span></span></h2></p><p dir="auto" id="viewer-5yfvd107"><span><span>Florian F introduced several requirements:</span></span></p><p dir="auto" id="viewer-8qjvl109"><span><span>1)	Every color on every face.</span></span></p><p dir="auto" id="viewer-imktn111"><span><span>2)	No more than two of any color on a face.</span></span></p><p dir="auto" id="viewer-1evv6113"><span><span>3)	No two squares of the same color touching side-by-side on any face.</span></span></p><p dir="auto" id="viewer-zghi0115"><span><span>4)	No two squares of the same color touching on a corner (or diagonally) on any face.</span></span></p><p dir="auto" id="viewer-v2ynf117"><span><span>5)	No two squares of the same color touching on a corner where two faces meet.</span></span></p><p dir="auto" id="viewer-p9gzf12738"><span><span>To this list, I added one more requirement:</span></span></p><p dir="auto" id="viewer-5g0ok121"><span><span>6)	Every face must have a different pattern.</span></span></p><p dir="auto" id="viewer-z354p123"><span><span>This illustration shows a scramble that fails each requirement:</span></span></p><div data-breakout="normal"><div id="viewer-ym14k14494"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="ym14k14494" data-hook="image-viewer-ym14k14494"><wow-image id="36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;ym14k14494&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:404,&#34;height&#34;:488,&#34;uri&#34;:&#34;36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png/v1/fill/w_404,h_488,al_c,q_85,enc_avif,quality_auto/36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png/v1/fill/w_485,h_586,al_c,lg_1,q_85/36e7f0_09bd0cca003c49fc9cd7dabd51801c3e~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p dir="auto" id="viewer-j5oxu127"><span><span>1)	This face is missing yellow.</span></span></p><p dir="auto" id="viewer-58ha2129"><span><span>2)	This face has more than 2 green squares.</span></span></p><p dir="auto" id="viewer-zsl5z131"><span><span>3)	Here are two yellow squares touching on a side.</span></span></p><p dir="auto" id="viewer-5b962133"><span><span>4)	Here are two blue squares touching diagonally.</span></span></p><p dir="auto" id="viewer-e5yv9135"><span><span>5)	Here are two green squares touching diagonally across two faces.</span></span></p><p dir="auto" id="viewer-yz98z137"><span><span>6)	These two faces have the same pattern.</span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-xuqs8139"><span><span>The Method</span></span></h2></p><p dir="auto" id="viewer-7fffw141"><span><span>There are 43,252,003,274,489,856,000 ways to arrange a Rubik’s cube. If I could evaluate a million arrangements per second, it would take over 1.3 million years to evaluate all arrangements. So, inspecting every individual arrangement is out.</span></span></p><p dir="auto" id="viewer-d6z6g143"><span><span>I looked for a way to programmatically assemble a cube that met the criteria. To know how to generate only cubes that are solvable, I had to learn how to evaluate a randomly-assembled cube to tell if it was solvable. I found this question on puzzling.stackexchange: </span></span></p><p dir="auto" id="viewer-4daow31293"><span><span>This provided a partial answer from which I was able to work out a full answer. There are 3 limitations:</span></span></p><p dir="auto" id="viewer-qve85145"><span><span>1)	I can place the first 7 corner pieces onto the cube any way I want. The orientation of the last corner piece is determined by the orientations of the first 7.</span></span></p><p dir="auto" id="viewer-i1goo147"><span><span>2)	I can place the first 11 edge pieces onto the cube any way I want. The orientation of the last edge piece is determined by the orientation of the first 11.</span></span></p><p dir="auto" id="viewer-3e9rm149"><span><span>3)	I need to track how many swaps I create by placing those pieces. An even number of swaps is solvable, and odd number is not. </span></span></p><p dir="auto" id="viewer-c8k0q151"><span><span>I decided to try to break the problem up by creating two candidate lists:</span></span></p><p dir="auto" id="viewer-293xy153"><span><span>•	A list of all corner piece arrangements that could be part of a perfect scramble</span></span></p><p dir="auto" id="viewer-utpo2155"><span><span>•	A list of all edge piece arrangements that could be part of a perfect scramble.</span></span></p><p dir="auto" id="viewer-0xw7649536"><span><span>I planned to pair up these lists to create a full scramble.</span></span></p><p dir="auto" id="viewer-tpekw452706"><span><span>I didn’t know if the perfect scramble was possible, but Florian F’s solution showed that it is possible to meet requirements 1 – 4. I set that as the minimum bar and had the program save all solutions that met those requirements, separating the results by how much they met requirements 5 and 6. </span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-c6abe37178"><span><span>Corners</span></span></h2></p><p dir="auto" id="viewer-eu9no159"><span><span>For corner pieces, the only requirements I had to worry about were 2 (no more than two of any color on a face) and 4 (no squares of the same color touching diagonally). I treated the corner placement as a tree traversal. The top node is a skeleton of a Rubik’s Cube with just the center pieces filled in. This diagram shows a simplified version of the tree traversal.:</span></span></p><div data-breakout="normal"><div id="viewer-0tr5159749"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="0tr5159749" data-hook="image-viewer-0tr5159749"><wow-image id="36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;0tr5159749&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:413,&#34;height&#34;:590,&#34;uri&#34;:&#34;36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png/v1/fill/w_413,h_590,al_c,q_85,enc_avif,quality_auto/36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png/v1/fill/w_496,h_708,al_c,lg_1,q_85/36e7f0_8047c185fb90484ab76c75a039e61a84~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p dir="auto" id="viewer-bx06q163"><span><span>On second level, placing a corner piece with a white surface touching the white center is not allowed. Therefore, that branch stops there – there is no need to visit the 3,674,160 arrangements branching off of this node.</span></span></p><p dir="auto" id="viewer-svxwa64017"><span><span>At the fourth level, placing three corners of the same color on a single face violates requirement 2. That branch is also pruned. </span></span></p><p dir="auto" id="viewer-q7fbm68411"><span><span>This is a very simplified view. I considered the entire cube, not just the one face shown. Also, the full tree has 24 branches from the first node (eight corner pieces to place in the first position, each with three different orientations), and 10 of them are dead ends at the first level. So 40% of the work is cut out at the first level.</span></span></p><p dir="auto" id="viewer-z60b8170748"><span><span>Finally, I need to consider swap parity. A corner arrangement produced by performing an odd number of swaps must be combined with an edge arrangement that also uses an odd number of swaps, so that the total number of swaps is even. I split the corner arrangements into two lists, odd swap parity and even swap parity, intending to compare only odd swap parity edge arrangements to odd swap parity corner arrangements (and the same for even parity arrangements).</span></span></p><p dir="auto" id="viewer-32927267040"><span><span>In the end, 88,179,840 possible corner piece arrangements were reduced to 750,640 candidates in less than one second!</span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-ns1mg166593"><span><span>Edges</span></span></h2></p><p dir="auto" id="viewer-ot1w5167"><span><span>The edge arrangements took significantly longer – there are nearly a trillion arrangements to consider. Again, I could only consider requirements 2 and 4. To evaluate the other requirements, I need both corners and edges placed on a cube.</span></span></p><p dir="auto" id="viewer-482ta158503"><span><span>I had initially planned to build a list of edge combinations and then try each edge combination against each corner combination. However, the math showed that I would have had to perform trillions or quadrillions of comparisons, so I had to come up with something faster. I decided to compare each node on the tree with the list of corner arrangements and pruned a branch if there were no corner arrangements compatible with the edge arrangements. Thus, the comparison of edge and corner arrangements was done inline with the edge arrangement tree traversal. I had to go back and sort and index the corner arrangements so I could quickly jump from one compatible arrangement to the next. </span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-lqmmt173"><span><span>The Solution!</span></span></h2></p><p dir="auto" id="viewer-gd0lx175"><span><span>In the end, the program took 5 days to run. Here is the solution the program found:</span></span></p><div data-breakout="normal"><div id="viewer-00528478696"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="00528478696" data-hook="image-viewer-00528478696"><wow-image id="36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;00528478696&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:310,&#34;height&#34;:374,&#34;uri&#34;:&#34;36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png/v1/fill/w_310,h_374,al_c,q_85,enc_avif,quality_auto/36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png/v1/fill/w_434,h_524,al_c,lg_1,q_85/36e7f0_2ccab9fe5e094161b46aa3635088ea9a~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p dir="auto" id="viewer-agcfd179"><span><span>This meets all the criteria and … this is the cool part … </span><em><span>it’s the only solution!</span></em></span></p><p dir="auto" id="viewer-20epz181"><span><span>Now, you can hold the Rubik’s cube in one of 24 different positions and you can apply this solution or apply its mirror image, so there are 48 unique arrangements produced by this solution.</span></span></p><p dir="auto" id="viewer-xwyev183"><span><span>Here are the moves to produce the Perfect Scramble (Thanks to Redditor plutrichor for finding this optimal pattern and pointing me to </span><a target="_blank" href="https://kociemba.org/cube.htm" rel="noopener noreferrer" data-hook="web-link"><u><span>Cube Explorer</span></u></a><span>) :</span></span></p><p dir="auto" id="viewer-1ysde185"><span><span>Creating the perfect scramble: U F&#39; L&#39; U&#39; R2 F&#39; R2 B&#39; U&#39; R F&#39; U F D&#39; L2 F2 L2 U&#39;</span></span></p><p dir="auto" id="viewer-wfk15187"><span><span>Solving the perfect scramble: U L2 F2 L2 D F&#39; U&#39; F R&#39; U B R2 F R2 U L F U&#39;</span></span></p><p dir="auto" id="viewer-mua4e189"><span><span>Creating the mirror image: U&#39; F R U L2 F L2 B U L&#39; F U&#39; F&#39; D R2 F2 R2 U</span></span></p><p dir="auto" id="viewer-lrrx6191"><span><span>Solving the mirror image: U&#39; R2 F2 R2 D&#39; F U F&#39; L U&#39; B&#39; L2 F&#39; L2 U&#39; R&#39; F&#39; U</span></span></p><p dir="auto" id="viewer-fbpuo486725"><span><span>Here are all 48 unique arrangements produced by the perfect scramble:</span></span></p><div data-breakout="normal"><div id="viewer-7vpcn488605"><div><figure data-hook="figure-IMAGE"><a tabindex="0" target="_self"><div data-hook="image-viewer"><div id="7vpcn488605" data-hook="image-viewer-7vpcn488605"><wow-image id="36e7f0_9a4bb934126242afa087380515ffab51~mv2.png" data-image-info="{&#34;containerId&#34;:&#34;7vpcn488605&#34;,&#34;displayMode&#34;:&#34;fill&#34;,&#34;isLQIP&#34;:false,&#34;isSEOBot&#34;:true,&#34;encoding&#34;:&#34;AVIF&#34;,&#34;imageData&#34;:{&#34;width&#34;:981,&#34;height&#34;:440,&#34;uri&#34;:&#34;36e7f0_9a4bb934126242afa087380515ffab51~mv2.png&#34;,&#34;name&#34;:&#34;&#34;,&#34;displayMode&#34;:&#34;fill&#34;}}" data-motion-part="BG_IMG" data-bg-effect-name="" data-has-ssr-src=""><img src="https://static.wixstatic.com/media/36e7f0_9a4bb934126242afa087380515ffab51~mv2.png/v1/fill/w_980,h_440,al_c,q_90,usm_0.66_1.00_0.01,enc_avif,quality_auto/36e7f0_9a4bb934126242afa087380515ffab51~mv2.png" alt="ree" data-pin-url="https://www.solutionslookingforproblems.com/post/the-rubik-s-cube-perfect-scramble" data-pin-media="https://static.wixstatic.com/media/36e7f0_9a4bb934126242afa087380515ffab51~mv2.png/v1/fill/w_981,h_440,al_c,q_90/36e7f0_9a4bb934126242afa087380515ffab51~mv2.png" draggable="false"/></wow-image></div></div></a></figure></div></div></div><p data-breakout="normal"><h2 dir="auto" id="viewer-sqjip514220"><span><span>Could the program be faster?</span></span></h2></p><p dir="auto" id="viewer-n82g4528596"><span><span>Absolutely.</span></span></p><p dir="auto" id="viewer-t9i5d581481"><span><span>First, I could have made it multi-threaded. Since multi-threading only provides a linear speedup, I first optimized my tree searching, looking for better-than-linear speedups wherever I could. I planned to throw in multi-threading afterward, but once I saw that the program would finish in a reasonable amount of time, laziness kicked in and I just waited for the answer.</span></span></p><p dir="auto" id="viewer-9zzsw762058"><span><span>Second, knowing now that the perfect scramble is possible, I could prune any branches that violate requirements 5 and 6. Perhaps I could have started by performing that more restricted search first and then relaxing the requirements if it failed.</span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-dskcj489979"><span><span>Can we add more requirements?</span></span></h2></p><p dir="auto" id="viewer-t1h49199"><span><span>Since there is only one solution, any new requirements are either already met or impossible to meet, unless we remove one of the existing requirements.</span></span></p><p dir="auto" id="viewer-554j3498938"><span><span>For example, you could argue that a perfectly scrambled cube must take 20 moves to solve. My perfect scramble only takes 18 moves. To find a different scramble that takes 20 moves, one of the existing requirements must be relaxed.</span></span></p><p dir="auto" id="viewer-f6o73500191"><span><span>After my program finished running, I thought of the requirement that no piece is in its original position. The perfect scramble fails to meet that requirement because it has one corner piece and two edge pieces in their original positions (which I use as landmarks to tell how to orient the cube when I solve the perfect scramble). To find a scramble that meets this requirement, one of the existing requirements must be relaxed.</span></span></p><p dir="auto" id="viewer-0tnze1547"><span><span>On stack exchange, Florian F had one more requirement: All combinations of 4 colors meet at a junction of 4 corners. I ignored this requirement in my program, but it turns out that all combinations except one are present on a face. That combination, green-blue-orange-white, is present only on the edge of the cube. Thanks to Florian F for pointing that out! Again, this is as good as we can do, unless we relax one of the other requirements.</span></span></p><p dir="auto" id="viewer-bat6q501995"><span><span>So there it is! Out of 43 quintillion possible arrangements, there is only one solution and 48 unique arrangements that satisfy the requirements for a perfect scramble. If you were to try to find this by trial and error, you would have to try an average of 900 quadrillion arrangements before you found one of these 48.</span></span></p><p data-breakout="normal"><h2 dir="auto" id="viewer-uhkjo908780"><span><span>The Program</span></span></h2></p></div></div></div></div></div></div></section></div>
  </body>
</html>
