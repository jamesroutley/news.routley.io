<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://onestepcode.com/webpack-configuration-multiple-entry-points/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=webpack-configuration-multiple-entry-points">Original</a>
    <h1>Webpack configuration multiple entry points</h1>
    
    <div id="readability-page-1" class="page"><div>
						
<p>In this post, we’ll see how to configure <a href="https://webpack.js.org/">webpack</a> to create a website with multiple routes, each with its own associated JavaScript files.</p>



<p>We’ll start by setting up webpack for a very basic configuration with a single entry point. If you’re already familiar with webpack, you can skip directly to <a href="#conclusion">this section</a>.</p>



<h2>Initial setup </h2>



<p>We start by initializing <code>npm</code>.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ cd my-project-dir
$ npm init -y</pre>



<p>Then we install webpack along with some dependencies.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ npm install --save-dev webpack webpack-cli html-webpack-plugin</pre>



<p>The <code><a href="https://webpack.js.org/plugins/html-webpack-plugin/#root">html-webpack-plugin</a></code> is used to automatically include all the files generated by webpack (like the JavaScript and CSS files) to a HTML document.</p>



<h2>Project structure</h2>



<p>We’re free to work with any folder structure. We’ll use the following one for this tutorial:</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">.
├── public
└── src
    └── js</pre>



<p>The <code>src</code> folder will include all of our source files (HTML, JS, and CSS). The <code>public</code> folder will be the output folder of the files processed by webpack.</p>



<h2>Adding a first page</h2>



<p>Let’s start by adding the file <code>index.html</code> to the folder <code>src</code>. </p>



<p>Since the focus of this tutorial is to configure webpack, we’ll use a bare-bones HTML file.</p>



<pre data-enlighter-language="html" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;!-- index.html --&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
  &lt;head&gt;
    &lt;meta charset=&#34;UTF-8&#34; /&gt;
    &lt;title&gt;Home&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    Hello, world!
  &lt;/body&gt;
&lt;/html&gt;</pre>



<p>Now, let’s add some JS files to this HTML page. As an example, let’s create <code>showMessage.js</code> in a new folder <code>src/js/imports</code>. </p>



<pre data-enlighter-language="js" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">// showMessage.js
const showMessage = (msg) =&gt; console.log(msg);

export default showMessage;</pre>



<p>This file just defines a dummy function <code>showMessage</code> and exports it. We’ll import this function into our main JS file, <code>index.js</code>.</p>



<p>Let’s add <code>index.js</code> to  <code>src/js</code>.</p>



<pre data-enlighter-language="js" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">// index.js
import showMessage from &#34;./imports/showMessage&#34;;

showMessage(&#34;Hello from index&#34;);</pre>



<p>As we can see, this file imports the dummy function <code>showMessage</code> and calls it.</p>



<p>Our resulting file structure should be as follows:</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">├── src
    ├── index.html
    └── js
        ├── imports
        │   └── showMessage.js
        └── index.js
</pre>



<h2>Webpack single entry point configuration</h2>



<p>Now that we have our first webpage, <code>index.html</code>, and an associated JS file, <code>index.js</code>, we’ll configure webpack to automatically bundle the JS files into a single file (remember that <code>index.js</code> imports a function from another JS file) and add it to <code>index.html</code>.</p>



<p>Let’s create the file <code>webpack.config.js</code> in our root project folder.</p>



<pre data-enlighter-language="js" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">const HtmlWebpackPlugin = require(&#34;html-webpack-plugin&#34;);
const path = require(&#34;path&#34;);

module.exports = {
  entry: {
    index: [path.resolve(__dirname, &#34;src&#34;, &#34;js&#34;, &#34;index.js&#34;)],
  },
  mode: &#34;development&#34;,
  target: &#34;web&#34;,
  output: {
    filename: &#34;js/[name].js&#34;,
    path: path.resolve(__dirname, &#34;public&#34;),
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, &#34;src&#34;, &#34;index.html&#34;),
      filename: &#34;index.html&#34;,
      chunks: [&#34;index&#34;],
    }),
  ],
};</pre>



<p>We won’t go into the details of webpack configuration. We’re interested only in the <code>entry</code>, <code>output</code> and <code>plugins</code> properties used to link an entry point with an HTML file.</p>



<p>The <code>entry</code> property lists all of the entry points. An entry point is the root JS file associated with a HTML route. This file should have all of the necessary <code>imports</code> to other files and functions that will be required by our route. In this case, we called it <code>index</code>, but we can give the entry points any name. See that <code>index</code> simply points to the path of <code>index.js</code>. </p>



<p><code>ouput</code> tells webpack where to save the generated files. We set the <code>path</code> property to <code>./public</code> and we specify that the JS bundles will be saved to sub-folder <code>js</code>.  The placeholder<code>[name]</code> will be replaced with the name of the entry point. </p>



<p>By default, wepback would just generate a single bundle for each entry point, say <code>my-index-bundle.js</code>, and be done. However, we want this JS file to be added to <code>index.html</code> via a <code>script</code> tag.   We could do it manually, however, the <code>html-webpack-plugin</code> can do it automatically for us. This is particularly helpful if we name the bundle using a content hash that changes after every build, for example <code>[name][hash].js</code> (you can learn more about the bundle naming options <a href="https://webpack.js.org/configuration/output/#template-strings">here</a>).</p>



<p>The <code>html-webpack-plugin</code> is configured by setting the <code>template</code> property to the HTML template. Then we specify the output name with <code>filename</code>, and finally we associate it with one or more of the entry points with the <code>chunks</code> property.</p>



<p>After saving this file, we can ask webpack to generate our bundles and HTML files.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ npx webpack --config webpack.config.js</pre>



<p>For convenience, we can add an npm script by modifying <code>package.json</code> to automatically call the command above.</p>



<pre data-enlighter-language="json" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">// package.json
{
  ...
  &#34;scripts&#34;: {
    &#34;build&#34;: &#34;webpack --config webpack.config.js&#34;,
    ...
  }
  ...
}</pre>



<p>Now we can run it by running:</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ npm run build</pre>



<h2>Inspecting webpack compilation output files</h2>



<p>After running the previous command, we’ll have the following files added to the <code>public</code> folder.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">├── public
    ├── index.html
    └── js
        └── index.js</pre>



<p>If we inspect <code>index.html</code> we’ll see that it has an extra <code>script</code> tag added to <code>&lt;head&gt;</code>.</p>



<pre data-enlighter-language="html" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;script defer src=&#34;js/index.js&#34;&gt;&lt;/script&gt;</pre>



<p>This tag was added by the <code>html-webpack-plugin</code> and it points to the bundle generated by webpack.</p>



<p>If we open <code>index.html</code> (of the <code>public</code> folder), we will see that it displays the console log from <code>showMessage</code>. </p>



<h2>Adding the other routes and entry points files</h2>



<p>Now that we’ve seen how to configure webpack with a single entry point, let’s add the two following files <code>about.html</code> and <code>about.js</code>:</p>



<pre data-enlighter-language="html" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;!-- about.html --&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
  &lt;head&gt;
    &lt;meta charset=&#34;UTF-8&#34; /&gt;
    &lt;title&gt;About&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    About us.
  &lt;/body&gt;
&lt;/html&gt;</pre>



<pre data-enlighter-language="js" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">// about.js
import showMessage from &#34;./imports/showMessage&#34;;

showMessage(&#34;This is the about us page&#34;);</pre>



<p>We add them both to the <code>src</code> folder.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">├── src
    ├── about.html
    ├── index.html
    └── js
        ├── about.js
        ├── imports
        │   └── showMessage.js
        └── index.js</pre>



<h2 id="conclusion">Configuring webpack for multiple entry points</h2>



<p>Now, we’ll configure webpack so that besides associating <code>index.html</code>  with its bundle, it does the same for <code>about.html</code>.</p>



<p>We modify <code>webpack.config.js</code>as follows:</p>



<pre data-enlighter-language="js" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">//webpack.config.js
const HtmlWebpackPlugin = require(&#34;html-webpack-plugin&#34;);
const path = require(&#34;path&#34;);

module.exports = {
  entry: {
    index: [path.resolve(__dirname, &#34;src&#34;, &#34;js&#34;, &#34;index.js&#34;)],
    about: [path.resolve(__dirname, &#34;src&#34;, &#34;js&#34;, &#34;about.js&#34;)],
  },
  ...
  plugins: [
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, &#34;src&#34;, &#34;index.html&#34;),
      filename: &#34;index.html&#34;,
      chunks: [&#34;index&#34;],
    }),
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, &#34;src&#34;, &#34;about.html&#34;),
      filename: &#34;about.html&#34;,
      chunks: [&#34;about&#34;],
    }),
  ],
};</pre>



<p>See that all we did was add a second entry point <code>about</code> that points to <code>about.js</code> and a second <code>html-webpack-plugin</code> object to <code>plugins</code> that points to the corresponding <code>about.html</code> template linked to the appropriate entry point (by setting the<code>chunks</code> property).</p>



<p>Then run webpack again.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ npm run buil</pre>



<p>It will generate the following files in the <code>public</code> folder.</p>



<pre data-enlighter-language="raw" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">├── public
    ├── about.html
    ├── index.html
    └── js
        ├── about.js
        └── index.js</pre>



<p>If we open <code>about.html</code> with a web browser, we will see it displays the corresponding console log message, showing that the associated JS bundle was correctly added.</p>
					</div></div>
  </body>
</html>
