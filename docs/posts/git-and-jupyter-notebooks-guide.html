<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.reviewnb.com/git-jupyter-notebook-ultimate-guide">Original</a>
    <h1>Git and Jupyter Notebooks Guide</h1>
    
    <div id="readability-page-1" class="page"><div><div id="content"><div target="_blank" data-gatrack="Article,Click,ReviewNB-Link"><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/64915b58cd0e65617546326a_github_jupyter_hero_image.jpeg" loading="lazy" alt=""/></p></figure><p>Using Git to version control your Jupyter notebooks has many advantages but it&#39;s a bit tricky to version control your Jupyter notebooks on Git. In this guide, we show you all the best practices, workflows, and tools to make Jupyter Notebooks play nicely with Git, GitHub, and Bitbucket.</p><h2>Git ↔ Jupyter Challenges</h2><p>Let&#39;s briefly list down the challenges of using Git with Jupyter Notebooks -</p><ul role="list"><li>Notebook Git diffs are hard to review</li><li>Resolving notebook merge conflict is painful</li><li>Large notebooks fail to render on GitHub</li><li>Notebook code reviews &amp; collaboration is tough</li></ul><p>In this article, we&#39;ll look at each of these problems &amp; suggest optimal solution for each.</p><h2>Using Git with Jupyter</h2><p>First, let&#39;s get the basics out of the way. There are 2 main ways to perform Git operations (<em>clone / pull / push</em>) for Jupyter Notebooks -</p><ol start="" role="list"><li><a href="https://blog.reviewnb.com/jupyterlab-git-extension/" target="_blank">Use JupyterLab Git extension</a></li><li><a href="https://blog.reviewnb.com/github-jupyter-notebook/" target="_blank">Use command line to run Git commands for Notebooks</a></li></ol><p>If you&#39;re new to Git, the above articles would give you step-by-step guide to version control notebooks on GitHub. If you&#39;re an experienced Git user, just note that the basic Git commands remain the same regardless of notebook&#39;s <sup>.ipynb</sup> file type.</p><h2>Git Diffs for Jupyter Notebooks</h2><p>We use Git diff to see the difference between two versions of the same file. This could be:</p><ol role="list"><li><strong>Local Notebook Diff:</strong> To review the changes you’ve made on your local machine before committing your work and sharing it with others.</li><li><strong>Commit &amp; PR Diff:</strong> To review the changes already pushed upstream in the context of a pull request or commit</li></ol><h3>1. Local Notebook Diff</h3><p>You can use the <sup>git diff</sup> command to view the difference between the current state of the file you are working on and the most recently checked-in version of the same file. You might use Git diffs to review the changes before committing or to compare different versions of notebook.</p><p>A general Git diff will show you textual diff for all changed files:</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c38344833c0b5d9297b77_git_diff.png" loading="lazy" alt=""/></p><figcaption>Terminal Git diff Output</figcaption></figure><p>Some issues with <sup>git diff</sup> output for Jupyter Notebooks:</p><ul role="list"><li>Notebooks are JSON under the hood, <sup>git diff</sup> shows raw JSON changes without any markdown or output rendering, code syntax highlighting etc.</li><li>Rich output (images, plots, widgets) raw diffs are impossible to review e.g. see the encoded <sup>image/png</sup> data in the above diff.</li><li>Notebook diffs have a lot of noise due to unintended metadata changes which you might not care about (e.g. <sup>execution_count</sup>).</li></ul><h3>Solution → nbdime</h3><p>You always want to review local notebook diffs <strong>before</strong> pushing the changes. But as we saw above, it&#39;s quite painful to review notebook diffs with plain <sup>git diff</sup> on command line.</p><p>One tool that solves this is <a href="https://nbdime.readthedocs.io/en/latest/" target="_blank">nbdime</a>. It&#39;s a dedicated diff &amp; merge library for Jupyter Notebooks. You can <a href="https://nbdime.readthedocs.io/en/latest/installing.html" target="_blank">install nbdime</a> and review your local notebook changes in a rich rendered diff format as shown below -</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c4642afe9f6a54ef88a28_nbdime_gitdiff.png" loading="lazy" alt=""/></p><figcaption>Notebook diff via nbdime</figcaption></figure><h3>Solution → JupyterLab Git Extension</h3><p>Another option is to use <a href="https://blog.reviewnb.com/jupyterlab-git-extension/" target="_blank">JupyterLab Git extension</a> to review local notebook diffs. This extension uses the nbdime library underneath. But the key advantage is the ability to review local notebook diffs directly in the JupyterLab UI with a click of a button.</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c4d3a4c0f10df3fb58171_jupyterlab-git-commit.png" loading="lazy" alt=""/></p><figcaption>Notebook diff via JupyterLab Git extension</figcaption></figure><h3>2. Commits &amp; PR Diff</h3><p>nbdime is great for reviewing local changes but once you push the changes to a remote repository, your colleagues might want to review your notebook changes &amp; provide feedback. </p><p>This is where <a href="https://github.blog/changelog/2023-03-01-feature-preview-rich-jupyter-notebook-diffs/" target="_blank">rich notebook diffs on GitHub</a> are super helpful. Your teammates can simply go to GitHub &amp; open the commit or pull request page to review the notebook changes. While useful, the rich notebook diffs on GitHub has some limitations -</p><ul role="list"><li>One <a href="https://blog.reviewnb.com/how-to-add-comments-to-notebook-diffs-github/#problem" target="_blank">can&#39;t write comments</a> on rich notebook diffs. So your teammates can&#39;t give feedback on your notebook changes.</li><li>GitHub rich diffs <a href="https://blog.reviewnb.com/large-notebook-diff-not-rendering/" target="_blank">fail on large notebooks</a>, even if the actual differences you are reviewing are small. So if your notebooks are large, the GitHub diffs won’t be of much use.</li><li>GitHub <a href="https://blog.reviewnb.com/github-not-rendering-interactive-notebook-widgets/" target="_blank">doesn’t display interactive widgets or plots</a>. So if your notebook includes interactive visualizations from Plotly or Bokeh, or an ipywidget, it won’t render on GitHub.</li></ul><h3>Solution → ReviewNB</h3><p>We saw limitations of GitHub&#39;s notebook rich diff support above. One way to solve it is to use <a href="https://www.reviewnb.com" target="_blank" data-gatrack="Article,Click,ReviewNB-Link">ReviewNB</a>. It&#39;s a dedicated app for Jupyter Notebooks code reviews. It helps you review notebook pull requests on GitHub &amp; Bitbucket. </p><p>You can see rich diffs and write comments on any notebook cell as shown below. Unlike GitHub, ReviewNB offers in-line commenting on rich diffs, works with large notebooks, and renders interactive plots &amp; widgets.</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/61fcd6a09c061c32de8cbb25_new_visual_diff.png" loading="lazy" alt=""/></p><figcaption>Notebook code reviews on ReviewNB</figcaption></figure><h2>Handling Notebook Merge Conflicts</h2><p>A common Git workflow is:</p><ul role="list"><li>Create a new branch, usually from <sup>main</sup>,</li><li>Work in the branch.</li><li>When your work is ready (usually after a pull request reviewed by your colleagues), merge the new branch back into the <sup>main</sup> branch</li></ul><p>Sometimes during this process, you may encounter a merge conflict. Merge conflicts usually happen when the branch you are trying to merge back into has changed, causing a conflict that Git needs your input to resolve.</p><p>For Jupyter notebooks, merge conflicts can be caused by code changes, but they can also be caused by notebook metadata. Metadata conflicts can be particularly difficult to visualize and fix. You might first notice a merge conflict on a pull request page:</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c65be20fce185e4e3d2b5_merge_conflict.png" loading="lazy" alt=""/></p><figcaption>Merge conflict on GitHub PR page</figcaption></figure><p>Or on the command line following a merge attempt:</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c66a3d2a19d7345839d25_merge_conflict_terminal.png" loading="lazy" alt=""/></p><figcaption>Merge conflict on terminal</figcaption></figure><p>If you start Jupyter and try to open a notebook in this state, you’ll get an error message saying that the notebook is unreadable. It&#39;s because the Git conflict markers make the notebook JSON invalid.</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c66efddf071ba70832e6e_error_message.png" loading="lazy" alt=""/></p></figure><h3>Solution → Text Editor</h3><p>Small notebook git merge conflicts can be resolved without any extra tooling, using either the GitHub UI or any text editor of your choice.</p><ul start="" role="list"><li>Use the git status command to check which files have merge conflicts. </li><li>Open the notebook in a text editor like Notepad, and you’ll see why Jupyter can’t read it: The notebook is no longer in standard JSON format because of the merge-conflict text.</li></ul><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c6b1e47a6171c9438eac2_conflict_short.png" loading="lazy" alt=""/></p><figcaption>Merge conflict on a text editor</figcaption></figure><ul start="" role="list"><li>To find the conflicts, search for the conflict markers &lt;&lt;&lt;&lt;&lt;&lt;&lt;, =======, &gt;&gt;&gt;&gt;&gt;&gt;&gt;.</li><li>Manually edit the JSON text to fix the conflict—you can choose the original version, the new version, or change the text to be some combination of both.</li></ul><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c6dbc6fa313cc83cef490_text_editor_conflict_resolved.png" loading="lazy" alt=""/></p><figcaption>Merge conflict resolved</figcaption></figure><ul role="list"><li>Remove the conflict markers when you have fixed the conflicting contents.</li><li>Mark the conflict as resolved by committing the notebook</li></ul><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648c6ce17cc69a36bfde3d5d_mark_conflict_resolution.png" loading="lazy" alt=""/></p><figcaption>Mark conflict resolution</figcaption></figure><h3>Solution → nbdime / nbdev / JupyterLab Git Extension</h3><p>Small (1-2 line) conflicts can be resolved easily on a text editor but large conflicts are difficult. The biggest challenge is ensuring that the end state is a valid notebook JSON. Miss a comma or a double quote or a closing brace, and suddenly your notebook is not valid anymore.</p><p>If your merge conflict is more than a line or two, you would do better to use a tool like <a href="https://nbdime.readthedocs.io/en/latest/cli.html#merging" target="_blank">nbdime</a>, <a href="https://nbdev1.fast.ai/merge.html" target="_blank">nbdev</a>, or the JupyterLab Git extension. Here&#39;s a step-by-step guide on resolving merge conflicts using the JupyterLab Git extension -</p><ul role="list"><li>When we try to merge conflicting git branches in the JupyterLab Git extension, merge fails midway &amp; the offending notebook appear in the “Conflicted” section of the left-hand Git panel (e.g. see <sup>NASA_Sea_level.ipynb</sup> in the screenshot below).</li><li>Double-click on the notebook to view the conflict. You will see the three versions: <sup>Current</sup>, <sup>Incoming</sup> &amp; the <sup>Common Ancestor</sup> -</li></ul><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/648e93f7fa7bd074605539f8_jupyterlab-git-conflict-compare.png" loading="lazy" alt=""/></p><figcaption>Merge conflict resolution in JupyterLab Git Extension</figcaption></figure><ul role="list"><li>Change the bottom cell to manually resolve the conflict. Either choose one of the three versions above or some combination thereof. </li><li>Click on “Mark as resolved”. You will see the notebook file move from the “Conflicted” section to the “Staged” section. It’s ready to commit. Use the bottom commit box to create &amp; push the commit, and you’re done!</li></ul><h2>Large Notebook Rendering on GitHub</h2><p>GitHub correctly renders small Jupyter Notebook files &amp; diffs. Unfortunately, GitHub fails to render large notebooks showing errors like <strong>“Unable to render rich display”</strong> or <strong>“The notebook took too long to render”</strong>.</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/6491445bd9536cfdac20751c_too-big-to-render.png" loading="lazy" alt=""/></p><figcaption>GitHub fails to render large Notebooks &amp; Diffs</figcaption></figure><h3>Why notebook rendering fails on GitHub?</h3><p>There are 2 reasons for this -</p><ol start="" role="list"><li>GitHub rich diff functionality uses <a href="https://nbdime.readthedocs.io/en/latest/" target="_blank">nbdime</a> under the hood. And nbdime diffs can be very slow for large notebooks (as mentioned by others <a href="https://github.com/jupyter/nbdime/issues/358">here</a> and <a href="https://github.com/jupyter/nbdime/issues/540">here</a>).</li><li>For performance reasons, GitHub <a href="https://github.com/cabforum/servercert/issues/27#:~:text=GitHub%27s%20rich%20diff%20generator%20takes%20close%20to%205%20seconds%2C%20which%20is%20their%20internal%20timeout%20per%20discussions%20with%20GitHub%20Support" target="_blank">imposes a 5-second limitation</a> on rich diff rendering. So in cases where nbdime can’t render a diff in 5 seconds, GitHub won’t render it at all.</li></ol><p>This tells us why notebook diff rendering fails on GitHub. We assume similar reasons exist for the failure of rendering standalone notebooks. Bottom line is, at GitHub&#39;s scale, they don&#39;t want to wait tens of seconds for files to render on their platform. </p><h3>Solution → NBviewer</h3><p><a href="https://nbviewer.org/" target="_blank">NBviewer</a> is an online service provided by the Jupyter project that offers a free tool for rendering static Jupyter Notebooks from URLs. It allows you to explore the structure of a GitHub repository and select specific notebooks for viewing.</p><p>NBviewer requires your notebooks to be publicly accessible. If you&#39;re operating within a private GitHub repository, NBviewer cannot be used.</p><h3>Solution → Binder</h3><p><a href="https://mybinder.org/" target="_blank">Binder</a> is another Jupyter subproject that offers a free service enabling the sharing of executable notebooks on an online platform. To utilize Binder, simply provide the path to your repository, and it will generate a JupyterLab instance for you.</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/64914cb78b5eab49d89d9668_binder.png" loading="lazy" alt=""/></p><figcaption>Opening Jupyter Notebook on Binder</figcaption></figure><p>Binder is particularly advantageous when your notebook includes interactive elements like plots or widgets. GitHub&#39;s notebook viewer disables such interactivity for security reasons. Similar to nbviewer mentioned earlier, <a href="https://mybinder.org/" target="_blank">mybinder.org</a> is also limited to public repositories exclusively. If you wish to access notebooks from private repositories, you will need to <a href="https://binderhub.readthedocs.io/en/latest/zero-to-binderhub/setup-binderhub.html" target="_blank">deploy your own BinderHub</a>.</p><h3>Solution → ReviewNB </h3><p><a href="https://www.reviewnb.com" target="_blank" data-gatrack="Article,Click,ReviewNB-Link">ReviewNB</a> is a SaaS for Jupyter Notebook code reviews &amp; collaboration on GitHub &amp; Bitbucket. ReviewNB can render large notebook files that GitHub won&#39;t render natively. Below we see the ~30mb notebook that GitHub couldn’t render natively, rendering fine in ReviewNB —</p><figure><p><img src="https://uploads-ssl.webflow.com/5ba4ebe021cb91ae35dbf88c/64919b6cd366a419f0f4cebf_nbreview.png" loading="lazy" alt=""/></p></figure><p>ReviewNB can be used with both public and private repositories. ReviewNB also supports Google-Doc style <a href="https://blog.reviewnb.com/commenting-for-jupyter/">commenting &amp; discussion on Jupyter notebook cells</a>.</p><p>Lastly, ReviewNB also shows you rich diffs for commit &amp; PRs with the ability to write comments on the rich diff. It also renders all interactive elements like plots &amp; widgets, making it easy to review cell outputs.</p><h2>Summary</h2><p>During our exploration of using Jupyter notebooks with Git/GitHub, we focused on addressing specific challenges such as <strong>Git diffs</strong>, <strong>merge conflicts</strong>, <strong>code reviews</strong>, and  <strong>rendering large notebooks</strong> on GitHub. We offered state-of-the-art solutions to each of these problems.</p><p>Whether you are new to Git or looking to enhance your Jupyter Notebook collaboration, this ultimate guide serves as a valuable resource for maximizing productivity and efficiency in your data science projects.</p><p>Happy Hacking!</p><p>‍</p></div></div></div></div>
  </body>
</html>
