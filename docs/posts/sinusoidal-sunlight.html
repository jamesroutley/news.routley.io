<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://leancrew.com/all-this/2024/10/sinusoidal-sunlight/">Original</a>
    <h1>Sinusoidal Sunlight</h1>
    
    <div id="readability-page-1" class="page"><div id="container">
       <!-- header -->
      
      <div id="content">
        <p>
          <span></span>
          <a href="https://leancrew.com/all-this/2024/10/rebar-and-reinforced-concrete/">Previous post</a>        </p>
        
        <p>October 23, 2024 at  4:24 PM by Dr. Drang</p>
        <p>I started my morning walk earlier than usual today, and it was still fairly dark out. I thought about <a href="https://leancrew.com/all-this/2023/11/more-general-sunrise-sunset-plots/">this post</a> from last year and the Daylight line in the graph:</p>

<p><img width="100%" src="https://leancrew.com/all-this/images2024/20241023-Chicago,%20IL-2024.png" alt="Chicago, IL-2024" title="Chicago, IL-2024"/></p>

<p>I wondered how hard it would be to alter the code to plot the slope of the Daylight line. That would give perhaps a better sense of how rapidly we gain daylight in the spring and lose it in the fall. But I soon decided against trying that for two reasons:</p>

<ol>
<li>Numerical differentiation (i.e., finding the slope) tends to create noisy data and therefore jagged graphs. I figured this was especially likely with the <a href="https://aa.usno.navy.mil/data/RS_OneYear">US Naval Observatory</a> data, since it gives the sunrise/sunset times rounded to the nearest minute.</li>
<li>If the Daylight line really was a sine wave, its slope would also be a sine wave, just shifted by about three months. Not very interesting.</li>
</ol>

<p>But the second objection got me thinking: how close to a sine wave is the Daylight line? I could try fitting a sine function to the data and see how much the error is. This would give me a chance to learn something new about <s>Mathematica</s> Wolfram.<sup id="fnref:wolfram"><a href="#fn:wolfram" rel="footnote">1</a></sup></p>

<p>Here’s the notebook I made to check the fit:</p>



<p>The first three evaluation cells create a list of <code>(day, daylight)</code> pairs that cover a 16-year period starting on January 1, 2009 and ending on December 31, 2024. I used a multiple of four years so leap years would appear in the same proportion they normally do, at least over the period from 1901 through 2099.</p>

<p>The <code>day</code> is an integer, starting at 0, and the <code>daylight</code> is given in minutes. We usually talk about “daylight hours,” not “daylight minutes,” but because I was going to plot the difference between the actual length of daylight and the best fit sine curve, I thought minutes would be an easier unit to work in.</p>

<p>The <code>daylight</code> list is calculated through the <a href="https://reference.wolfram.com/language/ref/Sunrise.html?q=Sunrise"><code>Sunrise</code></a> and <a href="https://reference.wolfram.com/language/ref/Sunset.html?q=Sunset"><code>Sunset</code></a> functions, which give results to at least the nearest second. (They display a time to the nearest second but may keep fractions of a second internally.)</p>

<p>We’re going to fit the data to a curve of this form:</p>

<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mo>=</mo><mi>m</mi><mo>+</mo><mi>a</mi><mi>sin</mi><mrow><mo>[</mo><mfrac><mrow><mn>2</mn><mi>π</mi><mspace width="thinmathspace"></mspace><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><mi>p</mi></mfrac><mo>]</mo></mrow></math></p><p>where</p>

<ul>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>d</mi></math> is the length of daylight (in minutes),</li>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>t</mi></math> is the time (in days),</li>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>m</mi></math> is the mean daylight (minutes),</li>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>a</mi></math> is the amplitude of the sine wave (minutes),</li>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>p</mi></math> is the period of the sine wave (days), and</li>
<li><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>f</mi></math> is the offset, or phase, of the sine wave (days).</li>
</ul>

<p>The phase of a sine wave is usually expressed as an angle in radians, but here I’ve rejiggered the equation to give it the same units as time.</p>

<p>The best fit of the data to this equation is found through the <a href="https://reference.wolfram.com/language/ref/FindFit.html"><code>FindFit</code> function</a>. Because this is a fit to a nonlinear curve, I thought it best to give decent initial guesses for each parameter,</p>

<pre><code>fit = FindFit[data, model, {{m, 12*60}, {a, 3*60}, {f, 80}, {p, 365}}, t]
</code></pre>

<p>The mean daylight value is going to be near 12 hours, so the initial guess for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>m</mi></math> is 720 minutes. Here in the Chicago area, we go from about 9 hours of daylight in the winter to about 15 hours in the summer, which puts the initial guess for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>a</mi></math> at 3 hours or 180 minutes. The period has to be about a year, so the initial guess for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>p</mi></math> is 365 days. Finally, because 12-hour days happen at the equinoxes, our initial guess for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>f</mi></math> is 80 days, which is about where March 21 lands.</p>

<p>As you can see, the best fit values for the parameters are</p>

<pre><code>{m -&gt; 733.182, a -&gt; 176.722, f -&gt; 79.5656, p -&gt; 365.249}
</code></pre>

<p>so our initial guesses were pretty good. Note that the best fit period is 365¼ days, which matches up with the frequency of leap years.</p>

<p>Finally, we get the difference between the actual data and the best fit curve and plot it. The first plot covers the entire 16-year period and is kind of hard to read. The error of each year is basically the same, so we can get a decent idea of how the error varies by looking at just the first year, which is shown in the second plot and reproduced here:</p>

<p><img width="100%" src="https://leancrew.com/all-this/images2024/20241023-Sine%20wave%20error.png" alt="Sine wave error" title="Sine wave error"/></p>

<p>The largest error (in absolute value) is about 7 minutes at or near the winter solstice. The error varies in a sort of sinusoidal fashion with a period of about 4 months, so the peaks and valleys of the error function are roughly 2 months apart.</p>

<p>You can decide for yourself whether an error like this—7 minutes out of 9 hours—makes the real data “close” to a sine wave. I’d say ~1% isn’t bad for such a simple model. Mostly, though, I’m happy to have learned a little more about the Wolfram Language.</p>


        <p>
          <span></span>
          <a href="https://leancrew.com/all-this/2024/10/rebar-and-reinforced-concrete/">Previous post</a>        </p>

      </div> <!-- content -->
      
       <!-- sidebar -->
       
       <!-- footer -->
    </div></div>
  </body>
</html>
