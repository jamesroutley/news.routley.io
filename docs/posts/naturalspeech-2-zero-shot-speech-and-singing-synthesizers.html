<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://speechresearch.github.io/naturalspeech2/">Original</a>
    <h1>NaturalSpeech 2: Zero-shot speech and singing synthesizers</h1>
    
    <div id="readability-page-1" class="page"><div>

<main role="main">
<article itemscope="" itemtype="https://schema.org/BlogPosting">

<div>
	<div>
	
        <h3>Latent Diffusion Models are Natural and Zero-Shot Speech and Singing Synthesizers</h3><p>
		[<a href="https://arxiv.org/abs/2304.09116">Paper</a>] [<a href="https://www.reddit.com/r/singularity/comments/12rubq4/latent_diffusion_models_are_natural_and_zeroshot">Reddit Discussion</a>] [<a href="https://news.ycombinator.com/item?id=35627790">Hack News</a>]

        </p>
        
        <p><b>Microsoft Research Asia &amp; Microsoft Azure Speech</b></p>
	</div>
	<p>
        <b>Abstract.</b> 
		While text-to-speech (TTS) systems (e.g., NaturalSpeech) have achieved high speech quality on single-speaker recording-studio datasets, these datasets are
not enough to capture the diversity in human speech such as speaker identities, prosodies, styles (e.g., singing). When scaling to large-scale, multi-speaker, and in-
the-wild datasets, current TTS systems usually quantize speech into discrete tokens and use language models to generate these tokens one by one, which suffer from
unstable prosody, word skipping/repeating issue, and poor voice quality. In this paper, we develop NaturalSpeech 2, a TTS system that uses a latent diffusion model
to synthesize natural voices with high expressiveness/robustness/fidelity and strong zero-shot ability. Specifically, we leverage a neural audio codec with residual
vector quantizers to reconstruct speech waveform and get the quantized latent vectors, and then use a diffusion model to generate these latent vectors conditioned
on text input. To enhance the zero-shot capability, we design a speech prompting mechanism to facilitate in-context learning in the duration/pitch predictor and
diffusion model. We scale NaturalSpeech 2 to large-scale datasets with 44K hours of speech and singing data and evaluate its voice quality on unseen (zero-shot)
speakers. NaturalSpeech 2 outperforms previous TTS systems by a large margin in terms of prosody/timbre similarity, robustness, and voice quality, and can perform
novel zero-shot singing synthesis with only a speech prompt.
		</p>
</div>
		
<div>		
	<h2 id="model-overview">Overview</h2>
	
		<p>
			<img src="https://ntietz.com/blog/scheduling-visits-from-the-muse/pics/overview.png" width="800"/>
		</p>
	
	<p>
		NaturalSpeech 2 consists of an audio codec encoder/decoder and a latent diffusion model conditioned on a prior (a phoneme encoder and a duration/pitch predictor).
	</p>
	
		<p>
			<img src="https://ntietz.com/blog/scheduling-visits-from-the-muse/pics/table1.png" width="600"/>
		</p>
	
	<p>
		The comparison between NaturalSpeech 2 and previous large-scale TTS systems.
	</p>


</div>


<div>
	<h2 id="sr-samples">LibriSpeech Samples</h2>
		<div>
			<table>
			<thead>
			<tr>
			<th>Text</th>
			<th>Prompt</th>
			<th>Ground Truth</th>
			<th>Baseline</th>
			<th>NaturalSpeech 2</th>
			</tr>
			</thead>
			<tbody>
			<tr>
			<td>Indeed, there were only one or two strangers who could be admitted among the sisters without producing the same result.</td>
			<td><audio controls="controls"><source src="audio/librispeech_examples/case1/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/librispeech_examples/case1/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/librispeech_examples/case1/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/librispeech_examples/case1/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>For if he&#39;s anywhere on the farm, we can send for him in a minute.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case2/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case2/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case2/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case2/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>Their piety would be like their names, like their faces, like their clothes, and it was idle for him to tell himself that their humble and contrite hearts it might be paid a far-richer tribute of devotion than his had ever been. A gift tenfold more acceptable than his elaborate adoration.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case3/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case3/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case3/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case3/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>Come, come returned Hawkeye, uncasing his honest countenance, the better to assure the wavering confidence of his companion. You may see a skin which, if it be not as white as one of the gentle ones, has no tinge of red to it that the winds of the heaven and the sun have not bestowed. Now, let us to business.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case4/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case4/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case4/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case4/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>The air and the earth are curiously mated and intermingled as if the one were the breath of the other.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case5/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case5/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case5/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case5/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>I had always known him to be restless in his manner, but on this particular occasion he was in such a state of uncontrollable agitation that it was clear something very unusual had occurred.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case6/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case6/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case6/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case6/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>His death in this conjuncture was a public misfortune.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case8/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case8/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case8/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case8/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>It is this that is of interest to theory of knowledge.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case9/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case9/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case9/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case9/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>For a few miles, she followed the line hitherto presumably occupied by the coast of Algeria, but no land appeared to the south.</td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case10/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case10/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case10/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/librispeech_examples/case10/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			</tbody>
			</table>
		</div>
</div>

<div>
	<h2 id="sr-samples">VCTK Samples</h2>
		<div>
			<table>
			<thead>
			<tr>
			<th>Text</th>
			<th>Prompt</th>
			<th>Ground Truth</th>
			<th>Baseline</th>
			<th>NaturalSpeech 2</th>
			</tr>
			</thead>
			<tbody>
			<tr>
			<td>It is an absolute nonsense.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case1/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case1/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case1/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case1/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>Truth is the child of time.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case2/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case2/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case2/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case2/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>We have a long way to go this week.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case3/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case3/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case3/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case3/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>Maybe we expected too much from the fixture.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case4/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case4/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case4/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case4/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>We will turn the corner.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case5/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case5/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case5/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case5/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>It will also require a lengthy series of clinical trials.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case6/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case6/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case6/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case6/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>Subs not used, McKenzie, Ritchie.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case7/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case7/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case7/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case7/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>That&#39;s the only thing I will say.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case9/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case9/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case9/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case9/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr><td>Every aspect of our play was first class.</td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case10/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case10/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case10/yourtts.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/vctk_examples/case10/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			</tbody>
			</table>
		</div>
</div>



<div>
	<h2 id="sr-samples">Samples compared with VALL-E</h2>
		<div>
			<table>
			<thead>
			<tr>
			<th>Text</th>
			<th>Prompt</th>
			<th>Ground Truth</th>
			<th>VALL-E</th>
			<th>NaturalSpeech 2</th>
			</tr>
			</thead>
			<tbody>
			<tr>
			<td>And lay me down in my cold bed and leave my shining lot.</td>
			<td><audio controls="controls"><source src="audio/compare_with_valle/case1/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/compare_with_valle/case1/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/compare_with_valle/case1/valle.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			<td><audio controls="controls"><source src="audio/compare_with_valle/case1/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>Yea, his honourable worship is within, but he hath a godly minister or two with him, and likewise a leech.</td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case2/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case2/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case2/valle.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case2/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>The army found the people in poverty and left them in comparative wealth.</td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case3/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case3/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case3/valle.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case3/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			<tr>
				<td>Thus did this humane and right minded father comfort his unhappy daughter, and her mother embracing her again, did all she could to soothe her feelings.</td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case4/reference.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case4/gt.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case4/valle.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/compare_with_valle/case4/ns.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			</tbody>
			</table>
		</div>
</div>




<div>
	<h2 id="sr-samples">Singing Samples </h2>
	<div>
		<!-- <h2 id="sr-samples" style="text-align: center;">Text & Audio to be inferred</h2> -->
		<table> 
		<thead>
			<tr>
				<th>Text</th>
				<th>Prompt Type</th>
				<th>Prompt</th>
				<th>NaturalSpeech 2</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>So listen very carefully.</td>
				<td>Speech</td>
				<td><audio controls="controls"><source src="audio/singing/libritts/ref_2.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/libritts/2_text2.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>		

			<tr>
				<td>So listen very carefully.</td>
				<td>Singing</td>
				<td><audio controls="controls"><source src="audio/singing/nhss/en0004b/ref_singing.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/nhss/en0004b/singing_2.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			
		</tbody>
		</table>
	</div>

	
	<div>
		<table> 
		<thead>
			<tr>
				<th>Text</th>
				<th>Prompt Type</th>
				<th>Prompt</th>
				<th>NaturalSpeech 2</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>To keep it all in like you do.</td>
				<td>Speech</td>
				<td><audio controls="controls"><source src="audio/singing/libritts/ref_4.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/libritts/4_text3.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>

			<tr>
				<td>To keep it all in like you do.</td>
				<td>Singing</td>
				<td><audio controls="controls"><source src="audio/singing/nhss/945/ref_singing.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/nhss/945/singing_3.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			
		</tbody>
		</table>
	</div>

	<div>
		<table> 
		<thead>
			<tr>
				<th>Text</th>
				<th>Prompt Type</th>
				<th>Prompt</th>
				<th>NaturalSpeech 2</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>In the middle of the night.</td>
				<td>Speech</td>
				<td><audio controls="controls"><source src="audio/singing/libritts/ref_3.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/libritts/3_text4.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>

			<tr>
				<td>In the middle of the night.</td>
				<td>Singing</td>
				<td><audio controls="controls"><source src="audio/singing/nhss/2259/ref_singing.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
				<td><audio controls="controls"><source src="audio/singing/nhss/2259/singing_4.wav" autoplay=""/>Your browser does not support the audio element.</audio></td>
			</tr>
			

		</tbody>
		</table>
	</div>

</div>










<div>	
	<h2 id="Ethics-Statement">	
		Ethics Statement
	</h2>
	<p>
		NaturalSpeech 2 can synthesize speech with good expressiveness/fidelity and good similarity with a speech prompt, which could be potentially misused, such as speaker mimicking and voice spoofing. To avoid potential issues, we appeal to our practitioners to not abuse this technology and to develop defending tools to detect AI-synthesized voices. We will always take <a href="https://www.microsoft.com/ai/responsible-ai">Microsoft AI Principles</a> as guidelines to develop such AI models.
	</p>
</div>




</article>
</main>
</div></div>
  </body>
</html>
