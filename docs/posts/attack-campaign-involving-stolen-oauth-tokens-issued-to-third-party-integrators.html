<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.blog/2022-04-15-security-alert-stolen-oauth-user-tokens/">Original</a>
    <h1>Attack campaign involving stolen OAuth tokens issued to third-party integrators</h1>
    
    <div id="readability-page-1" class="page"><div><div>


<div id="post-64202">
	<p>On April 12, GitHub Security began an investigation that uncovered evidence that an attacker abused stolen OAuth user tokens issued to two third-party OAuth integrators, Heroku and Travis-CI, to download data from dozens of organizations, including <a href="https://github.blog/2020-03-16-npm-is-joining-github/">npm</a>. The applications maintained by these integrators were used by GitHub users, including GitHub itself. We do not believe the attacker obtained these tokens via a compromise of GitHub or its systems, because the tokens in question are not stored by GitHub in their original, usable formats. Following immediate investigation, we disclosed our findings to Heroku and Travis-CI on April 13 and 14; more detail is available below and we will update this blog as we learn more.</p>
<p>Looking across the entire GitHub platform, we have high confidence that compromised OAuth user tokens from Heroku and Travis-CI-maintained OAuth applications were stolen and abused to download private repositories belonging to dozens of victim organizations that were using these apps. Our analysis of other behavior by the threat actor suggests that the actors may be mining the downloaded private repository contents, to which the stolen OAuth token had access, for secrets that could be used to pivot into other infrastructure.</p>
<p>Known-affected OAuth applications as of April 15, 2022:</p>
<ul>
<li>Heroku Dashboard (ID: 145909)</li>
<li>Heroku Dashboard (ID: 628778)</li>
<li>Heroku Dashboard – Preview (ID: 313468)</li>
<li>Heroku Dashboard – Classic (ID: 363831)</li>
<li>Travis CI (ID: 9216)</li>
</ul>
<p>We are sharing this today as we believe the attacks may be ongoing and action is required for customers to protect themselves.</p>
<h4>Impact to GitHub.com and npm</h4>
<p>The initial detection related to this campaign occurred on April 12 when GitHub Security identified unauthorized access to our npm production infrastructure using a compromised AWS API key. Based on subsequent analysis, we believe this API key was obtained by the attacker when they downloaded a set of private npm repositories using a stolen OAuth token from one of the two affected third-party OAuth applications described above. Upon discovering the broader theft of third-party OAuth tokens not stored by GitHub or npm on the evening of April 13, we immediately took action to protect GitHub and npm by revoking tokens associated with GitHub and npm’s internal use of these compromised applications.</p>
<p>We believe that the two impacts to npm are unauthorized access to, and downloading of, the private repositories in the npm organization on GitHub.com and potential access to the npm packages as they exist in AWS S3 storage. At this point, we assess that the attacker did not modify any packages or gain access to any user account data or credentials. We are still working to understand whether the attacker viewed or downloaded private packages. npm uses completely separate infrastructure from GitHub.com; GitHub was not affected in this original attack. Though investigation continues, we have found no evidence that other GitHub-owned private repos were cloned by the attacker using stolen third-party OAuth tokens.</p>
<h4>How GitHub responded to protect users of GitHub.com</h4>
<p>Once GitHub identified stolen third-party OAuth tokens affecting GitHub users, GitHub took immediate steps to respond and protect users.  GitHub contacted Heroku and Travis-CI to request that they initiate their own security investigations, revoke all OAuth user tokens associated with the affected applications, and begin work to notify their own users.</p>
<p>GitHub remains closely engaged with both organizations in an effort to assist their investigation and recovery efforts, and better protect shared customers.</p>
<h4>What GitHub customers and organizations need to know</h4>
<p>GitHub is currently working to identify and notify all of the known-affected victim users and organizations that we discovered through our analysis across GitHub.com. These customers will receive a notification email from GitHub with additional details and next steps to assist in their own response within the next 72 hours.</p>
<p>If you do not receive a notification, you and/or your organization have not been identified as affected. GitHub will continue to notify any additional affected users or organizations as they are identified. You should, however, periodically <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-authorized-applications-oauth">review what OAuth applications you’ve authorized</a> or are <a href="https://docs.github.com/en/enterprise-cloud@latest/organizations/restricting-access-to-your-organizations-data/about-oauth-app-access-restrictions">authorized to access your organization</a> and prune anything that’s no longer needed. You can also review your <a href="https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization">organization audit logs</a> and <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log">user account security logs</a> for unexpected or anomalous activity.</p>
<h4>If you have questions or concerns</h4>
<p>If you have questions or need assistance regarding affected OAuth applications maintained by Heroku, please reach out to Salesforce / Heroku security and support at <a href="https://help.heroku.com/">help.heroku.com</a>, and monitor the <a href="https://trust.salesforce.com">Salesforce Trust</a> site for additional updates.</p>
<p>If you have questions or need assistance regarding affected OAuth applications maintained by Travis CI, please reach out to <a href="mailto:compliance@travis-ci.com">compliance@travis-ci.com</a>.</p>
<p>Customers who are directly contacted by GitHub regarding this issue are welcome to contact us according to directions in the notification you received.</p>
<p>For other questions regarding GitHub and npm you can contact <a href="https://support.github.com/contact?subject=GH-0200941-4895-0+Questions&amp;tags=GH-0200941-4895-0">GitHub Support</a>.</p>
<h4>Conclusion</h4>
<p>The security and trustworthiness of GitHub, npm, and the broader developer ecosystem is our highest priority. Our investigation is ongoing, and we will update this blog, and our communications with affected customers, as we learn more.</p>

    

</div>


</div></div></div>
  </body>
</html>
