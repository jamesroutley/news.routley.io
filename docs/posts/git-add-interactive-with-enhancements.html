<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/cwarden/git-add-interactive">Original</a>
    <h1>Show HN: Git-Add–Interactive with Enhancements</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A Go port of Git&#39;s interactive add functionality, providing the same interface as <code>git add -i</code> and <code>git add -p</code>, with a few enhancements.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/cwarden/git-add--interactive/blob/main/examples/demo.gif"><img src="https://github.com/cwarden/git-add--interactive/raw/main/examples/demo.gif" alt="Demo" data-animated-image=""/></a></p>

<ul dir="auto">
<li><strong>Interactive staging</strong>: Select files and hunks to stage interactively</li>
<li><strong>Patch mode</strong>: Review and selectively stage individual hunks with <code>y/n/s/e/q/a/d</code> commands</li>
<li><strong>Hunk operations</strong>: Split hunks, manually edit hunks, navigate between hunks</li>
<li><strong>Multiple patch modes</strong>: Support for stage, reset, checkout, stash, and worktree operations</li>
<li><strong>Git integration</strong>: Full Git color configuration and repository support</li>
<li><strong>Terminal UI</strong>: Color-coded interface with keyboard shortcuts</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Enhancements Over Perl Version</h2><a id="user-content-enhancements-over-perl-version" aria-label="Permalink: Enhancements Over Perl Version" href="#enhancements-over-perl-version"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This Go implementation adds several powerful features beyond the original Perl script:</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Global Filtering (G command)</h3><a id="user-content-global-filtering-g-command" aria-label="Permalink: Global Filtering (G command)" href="#global-filtering-g-command"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Filter hunks across all files using regex patterns:</p>
<div data-snippet-clipboard-copy-content="G &lt;regex&gt;    # Set global filter to show only hunks matching pattern
G            # Clear filter (interactive prompt for new pattern)"><pre><code>G &lt;regex&gt;    # Set global filter to show only hunks matching pattern
G            # Clear filter (interactive prompt for new pattern)
</code></pre></div>
<p dir="auto"><strong>Example workflows:</strong></p>
<ul dir="auto">
<li><code>G TODO</code> - Show only hunks containing &#34;TODO&#34; comments</li>
<li><code>G import</code> - Focus on import statement changes</li>
<li><code>G console\.log</code> - Find all debugging statements</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Auto-Splitting (S command)</h3><a id="user-content-auto-splitting-s-command" aria-label="Permalink: Auto-Splitting (S command)" href="#auto-splitting-s-command"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Automatically split all hunks to maximum granularity:</p>
<div data-snippet-clipboard-copy-content="S    # Enable auto-splitting globally and split all hunks"><pre><code>S    # Enable auto-splitting globally and split all hunks
</code></pre></div>
<p dir="auto">This recursively splits hunks until no further splitting is possible, giving you the finest possible control over what gets staged.</p>

<p dir="auto">Accept all hunks across all files (after filtering and splitting):</p>
<div data-snippet-clipboard-copy-content="A    # Accept all visible hunks in all remaining files"><pre><code>A    # Accept all visible hunks in all remaining files
</code></pre></div>
<p dir="auto"><strong>Powerful workflow combinations:</strong></p>
<ul dir="auto">
<li><code>S</code> → <code>G &lt;pattern&gt;</code> → <code>A</code> - Split everything, filter by pattern, accept all matches</li>
<li><code>G console\.log</code> → <code>A</code> - Quickly stage all debugging code across your entire changeset</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Enhanced Search and Navigation</h3><a id="user-content-enhanced-search-and-navigation" aria-label="Permalink: Enhanced Search and Navigation" href="#enhanced-search-and-navigation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><strong>Local search (<code>/</code>)</strong>: Search within current file without affecting global filter</li>
<li><strong>Status display</strong>: Shows <code>[filter: pattern]</code> and <code>[auto-split]</code> indicators</li>
<li><strong>Cross-file filtering</strong>: Global filters persist across all files in the session</li>
</ul>



<div dir="auto"><h3 tabindex="-1" dir="auto">Install as Git Command (Optional)</h3><a id="user-content-install-as-git-command-optional" aria-label="Permalink: Install as Git Command (Optional)" href="#install-as-git-command-optional"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To use this implementation as the default <code>git add -i</code> and <code>git add -p</code>, you can install it to your Go bin directory and update your Git exec path:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Build and install to Go bin directory
go build -o &#34;$(go env GOPATH)/bin/git-add--interactive&#34; .

# Add Go bin to Git&#39;s exec path (add to your shell profile for persistence)
export GIT_EXEC_PATH=&#34;$(go env GOPATH)/bin:$(git --exec-path)&#34;"><pre><span><span>#</span> Build and install to Go bin directory</span>
go build -o <span><span>&#34;</span><span><span>$(</span>go env GOPATH<span>)</span></span>/bin/git-add--interactive<span>&#34;</span></span> <span>.</span>

<span><span>#</span> Add Go bin to Git&#39;s exec path (add to your shell profile for persistence)</span>
<span>export</span> GIT_EXEC_PATH=<span><span>&#34;</span><span><span>$(</span>go env GOPATH<span>)</span></span>/bin:<span><span>$(</span>git --exec-path<span>)</span></span><span>&#34;</span></span></pre></div>
<p dir="auto">After setting this up, <code>git add -i</code> and <code>git add -p</code> will use the Go implementation instead of the Perl script.</p>

<div dir="auto" data-snippet-clipboard-copy-content="# Check which git-add--interactive is being used
which git-add--interactive

# Test interactive add
git add -i

# Test patch mode
git add -p"><pre><span><span>#</span> Check which git-add--interactive is being used</span>
which git-add--interactive

<span><span>#</span> Test interactive add</span>
git add -i

<span><span>#</span> Test patch mode</span>
git add -p</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Uninstall (Revert to Original)</h3><a id="user-content-uninstall-revert-to-original" aria-label="Permalink: Uninstall (Revert to Original)" href="#uninstall-revert-to-original"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To revert back to the original Perl implementation:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Remove the Go binary from your Go bin
rm &#34;$(go env GOPATH)/bin/git-add--interactive&#34;

# Reset Git exec path (remove from your shell profile too)
unset GIT_EXEC_PATH
# Or set it back to default
export GIT_EXEC_PATH=&#34;$(git --exec-path)&#34;"><pre><span><span>#</span> Remove the Go binary from your Go bin</span>
rm <span><span>&#34;</span><span><span>$(</span>go env GOPATH<span>)</span></span>/bin/git-add--interactive<span>&#34;</span></span>

<span><span>#</span> Reset Git exec path (remove from your shell profile too)</span>
<span>unset</span> GIT_EXEC_PATH
<span><span>#</span> Or set it back to default</span>
<span>export</span> GIT_EXEC_PATH=<span><span>&#34;</span><span><span>$(</span>git --exec-path<span>)</span></span><span>&#34;</span></span></pre></div>


<div dir="auto" data-snippet-clipboard-copy-content="# Run directly
./git-add--interactive

# Or if installed as Git command
git add -i"><pre><span><span>#</span> Run directly</span>
./git-add--interactive

<span><span>#</span> Or if installed as Git command</span>
git add -i</pre></div>
<p dir="auto">This launches the main interactive menu with options:</p>
<ul dir="auto">
<li><code>status</code> - Show paths with changes</li>
<li><code>update</code> - Add working tree state to staged changes</li>
<li><code>revert</code> - Revert staged changes back to HEAD</li>
<li><code>add untracked</code> - Add untracked files to staged changes</li>
<li><code>patch</code> - Pick hunks and update selectively</li>
<li><code>diff</code> - View diff between HEAD and index</li>
<li><code>quit</code> - Exit the program</li>
<li><code>help</code> - Show help</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="# Direct usage
./git-add--interactive --patch --
./git-add--interactive --patch=stage --
./git-add--interactive --patch=reset --
./git-add--interactive --patch=checkout --

# Or if installed as Git command
git add -p              # Same as --patch
git add --patch         # Stage mode
git reset -p            # Reset mode  
git checkout -p         # Checkout mode"><pre><span><span>#</span> Direct usage</span>
./git-add--interactive --patch --
./git-add--interactive --patch=stage --
./git-add--interactive --patch=reset --
./git-add--interactive --patch=checkout --

<span><span>#</span> Or if installed as Git command</span>
git add -p              <span><span>#</span> Same as --patch</span>
git add --patch         <span><span>#</span> Stage mode</span>
git reset -p            <span><span>#</span> Reset mode  </span>
git checkout -p         <span><span>#</span> Checkout mode</span></pre></div>
<p dir="auto">Patch mode allows you to interactively select hunks with these commands:</p>
<ul dir="auto">
<li><code>y</code> - Accept this hunk</li>
<li><code>n</code> - Skip this hunk</li>
<li><code>q</code> - Quit; skip this hunk and remaining ones</li>
<li><code>a</code> - Accept this hunk and all later hunks in the file</li>
<li><code>d</code> - Skip this hunk and all later hunks in the file</li>
<li><code>s</code> - Split the current hunk into smaller hunks</li>
<li><code>e</code> - Manually edit the current hunk</li>
<li><code>j/k</code> - Navigate to next/previous undecided hunk</li>
<li><code>J/K</code> - Navigate to next/previous hunk</li>
<li><code>g</code> - Go to a specific hunk number</li>
<li><code>/</code> - Search for pattern in current file</li>
<li><code>G</code> - Set global filter for all files (or clear with empty pattern)</li>
<li><code>S</code> - Enable auto-splitting globally and split all hunks</li>
<li><code>A</code> - Accept all hunks in all remaining files</li>
<li><code>?</code> - Show help</li>
</ul>

<p dir="auto">The codebase is organized into these main packages:</p>
<ul dir="auto">
<li><code>main.go</code> - Entry point and command-line parsing</li>
<li><code>internal/git/</code> - Git repository interaction and operations
<ul dir="auto">
<li><code>repository.go</code> - Git repository abstraction and command execution</li>
<li><code>status.go</code> - File status parsing and tracking</li>
<li><code>patch.go</code> - Diff parsing and patch mode operations</li>
</ul>
</li>
<li><code>internal/ui/</code> - Interactive terminal interface
<ul dir="auto">
<li><code>app.go</code> - Main application logic and menu system</li>
<li><code>patch.go</code> - Patch mode UI and hunk interaction</li>
</ul>
</li>
</ul>

<p dir="auto">Run the test suite:</p>

<p dir="auto">Run tests with verbose output:</p>


<p dir="auto">The code follows Go conventions and includes:</p>
<ul dir="auto">
<li>Comprehensive unit tests for core functionality</li>
<li>Git integration respecting user&#39;s color and configuration</li>
<li>Error handling for edge cases and invalid input</li>
<li>Support for all major patch modes and operations</li>
</ul>

<p dir="auto">This implementation provides the same functionality as the original Perl <code>git-add--interactive</code> script, including:</p>
<ul dir="auto">
<li>All patch modes (stage, reset, checkout, stash, worktree variants)</li>
<li>Full hunk manipulation (splitting, editing, navigation)</li>
<li>Git color configuration support</li>
<li>Interactive selection with prefix matching</li>
<li>Range and comma-separated selections</li>
</ul>
</article></div></div>
  </body>
</html>
