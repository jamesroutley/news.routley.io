<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lock.cmpxchg8b.com/hiew.html">Original</a>
    <h1>Hiew Hex Editor</h1>
    
    <div id="readability-page-1" class="page"><section id="introduction">

<p>A big part of my daily work is digging around in binary blobs. I‚Äôve been using Hiew almost exclusively for a few years, and I‚Äôm a big fan ‚Äì more people should use it!</p>
<p>The problem is Hiew has a steep learning curve, so if you literally use a hex editor once a year, then it‚Äôs probably just not worth it. However, if you live in a hex editor, then it might be more interesting than you realized!</p>
<p>This article assumes you‚Äôre already familiar with another hex editor, and are curious if it‚Äôs worth your time learning Hiew.</p>
<p>Let me walk you through a few common hex editing tasks and show you how they look‚Ä¶ maybe 0.01% of the people reading this will be intrigued üòÇ</p>
<section id="background">
<h2>Background</h2>
<p>Let‚Äôs get this out of the way - if you‚Äôve never seen Hiew before, it‚Äôs a console hex editor!</p>
<p>It has basic mouse support, but you primarily operate it with the keyboard. If you think <code>vim</code> looks arcane, you‚Äôre not going to enjoy using Hiew ‚Äì that‚Äôs okay!</p>
<p>Hiew has been around a long time, first released in 1991. It‚Äôs still actively maintained ‚Äì version 8.80 was just released in November ‚Äì but it comes from an era where powerful software was usually designed around the idea of keyboard macros.</p>
<p>Like other tools built this way, Hiew has an emphasis on chaining together simple commands to perform complex tasks. That means there‚Äôs a steep learning curve before you feel proficient, but as you build up your command vocabulary you‚Äôll be able to perform operations that look like magic.</p>
<p>Okay, Let‚Äôs dive right in!</p>
<details>
<summary>
<p>
<em>‚Üê Psst‚Ä¶this symbol means there‚Äôs a figure available‚Ä¶ just click it!</em>
</p>
</summary> <span> üéà </span>
</details>
</section>
<section id="scenarios">
<h2>Scenarios</h2>
<section id="scenario-1">
<h3>Scenario #1</h3>
<p><em>You‚Äôre trying to understand an undocumented proprietary file format.</em></p>
<hr/>
<details>
<summary> A good place to start is usually looking at the list of strings that appear in the file, that‚Äôs <kbd>alt</kbd>+<kbd>f6</kbd>. </summary>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/stringlist.png" alt=""/><figcaption>String List</figcaption>
</figure>
</blockquote>
</details>
<p>Hopefully that will give you some clues about what fields might be in the header. In Hiew, you mark fields using <em>blocks</em>, and you start a block with <kbd>*</kbd>.</p>
<p>I see there‚Äôs what looks like a filename near the top, so let me mark that.</p>
<blockquote>
<video controls="">
<source src="img/hiew/blocksimple.webm" type="video/webm"/>
</video>
</blockquote>
<p>All the usual movement commands work while you‚Äôre defining a block, including searching and jumping. Vim users will recognize this as very similar to visual mode.</p>
<p>Now that it‚Äôs marked, you can assign it a color with <kbd>alt</kbd>+<kbd>m</kbd>, or just give it a random color with <kbd>alt</kbd>+<kbd>shift</kbd>+<kbd>m</kbd>.</p>
<details>
<summary> I like to just keep hitting <kbd>alt</kbd>+<kbd>shift</kbd>+<kbd>m</kbd> until I get a color I like. </summary>
<blockquote>
<video controls="">
<source src="img/hiew/randomizecolor.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>Okay, now you can watch me repeat that process for a few more fields‚Ä¶</p>
<blockquote>
<video controls="">
<source src="img/hiew/assignfields.webm" type="video/webm"/>
</video>
</blockquote>
<blockquote>
<p>Tip: Feeling <kbd>s</kbd><kbd>h</kbd><kbd>o</kbd><kbd>r</kbd><kbd>t</kbd><kbd>c</kbd><kbd>u</kbd><kbd>t</kbd> overload? Don‚Äôt worry, I made <a href="https://taviso.github.io/hiewdocs/index.htm">hiewdocs</a>, an easy online shortcut reference!</p>
</blockquote>
<details>
<summary> Now we probably want to add some notes to remind us what we think a field is. In Hiew, you enter a comment with <kbd>;</kbd>. </summary>
<blockquote>
<video controls="">
<source src="img/hiew/entercomment.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>Just like with a dissasembler, each location can have a <em>name</em> and a <em>comment</em>, you enter a name with <kbd>shift</kbd>+<kbd>f12</kbd>. They‚Äôre both optional, skip one or both if you like!</p>
<p>Once some fields are marked, you can move between them with <kbd>alt</kbd>+<kbd>n</kbd> (forward) and <kbd>alt</kbd>+<kbd>shift</kbd>+<kbd>n</kbd> (backward).</p>
<details>
<summary> Hiew will display any names and comments as you navigate around as floating tips. You can also open a list with <kbd>f12</kbd> and jump straight to the one you‚Äôre interested in! </summary>
<blockquote>
<video controls="">
<source src="img/hiew/displaycomments.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>I think we‚Äôre making progress. Look at this field, I think it‚Äôs the length of the data block:</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/compressedsize.png" alt=""/><figcaption>Calculator</figcaption>
</figure>
</blockquote>
<p>If I examine it in the calculator, as a <code>DWORD</code> that would be <code>203008</code>. Okay, Let‚Äôs extract a block of that length and save it to a file.</p>
<p>So we need to‚Ä¶</p>
<ol type="1">
<li>Hit <kbd>*</kbd> to select a block.</li>
<li>Press <kbd>f5</kbd> to jump to an offset.</li>
<li>Enter <code>+203008t</code> to move forward that many bytes.</li>
</ol>
<details>
<summary> Now we can use <kbd>f2</kbd> to save the current block to a file. </summary>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/writeblock.png" alt=""/><figcaption>Write Block</figcaption>
</figure>
</blockquote>
</details>
<p>You can hit <kbd>backspace</kbd> to jump back to your last location when done.</p>
<blockquote>
<p>Tip: Hiew has about a million ways to jump around a file! Don‚Äôt worry, you don‚Äôt need to memorize them!</p>
</blockquote>
<details>
<summary> Let‚Äôs take a look at this block we saved. I think I know what this is, if I add a deflate header‚Ä¶ </summary>
<blockquote>
<video controls="">
<source src="img/hiew/zpipe.webm" type="video/webm"/>
</video>
</blockquote>
<p>Ah-ha, we got back the uncompressed data!</p>
</details>
<p>You probably spotted the <code>PK</code> header, and realized this is not an undocumented file format at all, it‚Äôs a ZIP archive. Yep, you got me üôÇ</p>
<p>You don‚Äôt need to go through this process for common formats like Zip, you can just use a standard template that will populate the fields for you. If I do that, the names list <kbd>f12</kbd> looks like this.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/kiewtai.png" alt=""/><figcaption>Kiewtai</figcaption>
</figure>
</blockquote>
</section>
<section id="scenario-2">
<h3>Scenario #2</h3>
<p>You‚Äôre trying to patch an executable you don‚Äôt have the source code for.</p>
<hr/>
<details>
<summary> The first thing you need to know is that Hiew has three main views. They are <em>text</em>, <em>code</em> and <em>data</em>. You can quickly flip between them without losing your place, just hit <kbd>enter</kbd>. Most Hiew users get into the habit of doing this frequently! </summary>
<blockquote>
<video controls="">
<source src="img/hiew/hiewviews.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>Let‚Äôs take a closer look at the code view.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/codeview.png" alt=""/><figcaption>Code View</figcaption>
</figure>
</blockquote>
<p>As you can see, Hiew has a builtin disassembler, very handy if you work in security and need to extract shellcode!</p>
<details>
<summary> Do you see those little arrow annotations? Those are shortcuts to follow a branch, you just hit the corresponding key to jump to the branch target. This lets you browse the code effectively without leaving Hiew.
<p>If you see <code>‚Üì5</code>, that means it‚Äôs a forward branch and you can press <kbd>5</kbd> to jump to the destination. </p></summary>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/branchannot.png" alt=""/><figcaption>Branch Annotations</figcaption>
</figure>
</blockquote>
</details>
<details>
<summary> While we‚Äôre browsing around we can enter comments with <kbd>;</kbd>, just like in data view. The only difference is that your comments get added to the disassembly, rather than as floating tooltips! </summary>
<blockquote>
<video controls="">
<source src="img/hiew/codecomment.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>Here‚Äôs a neat feature, see these dashes?</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/bookmarkstack.png" alt=""/><figcaption>Bookmark Stack</figcaption>
</figure>
</blockquote>
<p>That‚Äôs your bookmark stack! If you want to go explore somewhere else, you can hit <kbd>+</kbd>, then you return later by hitting <kbd>-</kbd>.</p>
<blockquote>
<p>Tip: Take a look at <a href="https://taviso.github.io/hiewdocs/index.htm?query=bookmark">hiewdocs</a> if you want to master the bookmark stack!</p>
</blockquote>
<details>
<summary> Hiew understands most major executable formats, and will populate names automatically. You can easily browse and patch headers, sections, tables, and so on.
<p>Let‚Äôs take a look at the imports table. </p></summary>
<blockquote>
<video controls="">
<source src="img/hiew/imports.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>Look, there‚Äôs a call to <code>IsDebuggerPresent()</code>.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/debugger.png" alt=""/><figcaption>IsDebuggerPresent</figcaption>
</figure>
</blockquote>
<p>Let‚Äôs patch it out just for fun. Hiew not only has a dissasembler built in, it also has an <em>assembler</em>. I think this is a unique feature among major hex editors!</p>
<p>There‚Äôs a handy shortcut to just <code>nop</code> an instruction <kbd>alt</kbd>+<kbd>f2</kbd>.</p>
<blockquote>
<video controls="">
<source src="img/hiew/nopnop.webm" type="video/webm"/>
</video>
</blockquote>
<p>Now let‚Äôs change this nop into <code>xor eax, eax</code>, and we‚Äôre done!</p>
<p>I challenge you to find me a hex editor that makes patching executables easier than Hiew üòÇ</p>
</section>
<section id="scenario-3">
<h3>Scenario #3</h3>
<p>You‚Äôre trying to repair a damaged file.</p>
<hr/>
<p>Want to see a picture of my pup üê∂? His name is Deputy Dexter!</p>
<pre><code>$ display dexter.png
display-im6.q16: improper image header `dexter.png&#39; @ error/png.c/ReadPNGImage/4107.</code></pre>
<p>Huh, that didn‚Äôt work! Maybe we can fix this problem with Hiew.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/dexbroken.png" alt=""/><figcaption>Broken Header</figcaption>
</figure>
</blockquote>
<p>Okay, this doesn‚Äôt look right, there‚Äôs an extra <code>0D</code> in the header.</p>
<p>I‚Äôd bet this was probably broken by someone trying to convert from UNIX to DOS line endings!<a href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a> We need to go through the file and replace every occurrence of <code>0D 0A</code> with <code>0A</code>.</p>
<p>A repetitive task like this is a good opportunity for me to show you how keyboard macros work. All we need to do is fix one of these errors, then we can tell Hiew to repeat everything we just did.</p>
<p>So, hit <kbd>alt</kbd>+<kbd>.</kbd> to begin recording a macro. This recording symbol should appear.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/macroindicator.png" alt=""/><figcaption>Macro Indicator</figcaption>
</figure>
</blockquote>
<details>
<summary> Now we need to search for the next occurrence of <code>0D 0A</code>, so <kbd>f7</kbd>, and enter <code>0D0A</code>.
<p>To delete a byte, you mark it then press <kbd>shift</kbd>+<kbd>f2</kbd>.</p>
<p>That‚Äôs it! Now hit <kbd>alt</kbd>+<kbd>.</kbd> to end the macro. </p></summary>
<blockquote>
<video controls="">
<source src="img/hiew/macrorecord.webm" type="video/webm"/>
</video>
</blockquote>
</details>
<p>To tell Hiew to repeat this for every occurrence in the file, open the macro manager with <kbd>alt</kbd>+<kbd>=</kbd>, and then make sure the <code>L</code> (loop) and <code>S</code> (<strong>s</strong>earch failure) flags are set. This just means that Hiew should repeat exection until a search failure occurs.</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/macromanager.png" alt=""/><figcaption>Macro Manager</figcaption>
</figure>
</blockquote>
<p>You can give it a name if you want to save it for future use, but we‚Äôre only going to use it once. So hit <kbd>enter</kbd> to run it!</p>
<blockquote>
<video controls="">
<source src="img/hiew/macroplay.webm" type="video/webm"/>
</video>
</blockquote>
<blockquote>
<p>Tip: The default execution speed is 200ms, which is slow enough that you can watch it run. It‚Äôs kinda cool to watch, but you can turn it all the way down to 0ms if you like!</p>
</blockquote>
<p>Let‚Äôs check if that worked, can we see Dexter!</p>
<blockquote>
<figure>
<img src="https://slinkp.com/img/hiew/dexter.png" alt=""/><figcaption>Macro Manager</figcaption>
</figure>
</blockquote>
<p>There‚Äôs my little guy!</p>
<blockquote>
<p>Tip: You can abort a running macro with <kbd>esc</kbd>. For some reason it will say ‚Äúaborted by hacker‚Äù lol?</p>
</blockquote>
</section>
</section>
</section></div>
  </body>
</html>
