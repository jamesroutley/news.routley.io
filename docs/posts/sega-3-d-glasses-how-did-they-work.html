<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nicole.express/2023/the-third-dimension-and-the-eight-bits.html">Original</a>
    <h1>Sega 3-D Glasses: How did they work?</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>Most people have two eyes, allowing for a stereoscopic view of reality.<sup><i><a href="https://en.wikipedia.org/wiki/Citation_needed">[citation needed]</a></i></sup>. Nevertheless, video games are generally designed to run on monitors with a single screen, viewed from a distance, so three-dimensional effects have to be done with perspective and other techniques. But of course, many ways have been made to give a true stereoscopic view; from the 3DTV fad of the early 2010s, to the Nintendo 3DS’ glasses-free parallax barrier. But how did systems in the primitive days of 8-bit consoles do it? Let’s ask Sega!</p>

<h2 id="glasses">Glasses</h2>

<p>These are my Sega 3-D glasses. They’re in rough shape; a previous owner has cracked them, and replaced the hinged arms with a headband. But hey, they work!</p>

<p><img src="https://loeber.substack.com/assets/img/glass/realglass.JPEG" title="honestly the headband strap just makes it more cyber, wish it was neon green" alt="A heavily damaged pair of Sega 3-D glasses"/></p>

<p>And it’s not a big deal. After all, if the damage bothers me, I can just use these glasses; the Asus VR-100, from around 2000. They’re actually the exact same technology, using the same 3.5mm port. And they’ve got bigger panels to boot.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/fakeglass.JPEG" title="they are missing the foam on one side, though" alt="A much nicer pair of Asus glasses"/></p>

<p>Even more modern active shutter glasses aren’t that different technologically, but they often used different connectors, or even wireless. But they all do the same thing. A signal sent to the glasses tells one LCD panel, or the other, to “blank”, preventing the eye from seeing out of it. This is pretty much the same thing as an <a href="https://loeber.substack.com/2022/in-soviet-russia-game-watches-you.html">LCD game</a>, but even simpler, since there’s only two.</p>

<p>Unfortunately, I, uh, can’t find my Sega 3-D glasses adaptor. I’ve been through a few moves since buying it. But it doesn’t matter, because I have a Japanese Sega Master System! Once you get an adapter to play western Master System games on, this thing really is the ideal console (for those who don’t want to play <em>Earthworm Jim</em> (sprite scaling) or <em>Dizzy</em> (224-line mode), anyway) for the Master System, as it features the 3-D glasses <em>built in</em>. Well, the adapter anyway. It also has FM sound.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/adapt.JPEG" title="The &#39;Card Input&#39; text was moved to the red areas" alt="Master System (J) with its system"/></p>

<h3 id="the-3-d-signal">The 3-D signal</h3>

<p>The glasses are, in a sense, passive devices. Even though they’re called “active shutter” glasses. That is to say, they are entirely controlled by the signals sent by the console. Liquid crystal needs an AC signal to activate or deactivate, and I’ve captured one of the channels on my oscilloscope. Unfortunately, the signal doesn’t work when the scope is connected to my computer (grounding issues), so here’s a terrible photo.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/signal.JPEG" title="My oscilloscope quality goes down from post to post" alt="Pulses of AC"/></p>

<p>How does this get generated? Well, unfortunately, this is one case where having the Japanese Master System is a downside. Tracing the 3-D glasses signal on the circuitboard, we see it comes from a μPC324, an NEC chip which is made up of four op-amps. This amplifies and controls the signals coming from the 315-5297 IO chip.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/board.JPEG" title="Oh boy, black box chips" alt="Op-amp and IO chip"/></p>

<p>The 315-5297 is, as far as I know, unique to the Japanese Master System. It generates the AC reference signal and some controls to send the correct signal down the op-amp’s lines; <a href="https://www.smspower.org/forums/15109-3155297AndMoreJapaneseMSStuffPinout">SMS Power</a> has documented that. Forum users there have also mapped out the <a href="https://www.smspower.org/forums/14635-SegaCardFor3DGlassesCircuit#78112">discrete circuit</a> used in the separate adapter, which is in the end a simple oscillator.</p>

<p>The glasses adapter plugs into the card slot solely to look at the system bus. When it sees a write to <code>$fff8</code>, it looks at the low bit of the bus and uses that to distinguish which eye’s glass should be enabled. It’s a very simple system; so simple, the console actually has no way to detect that glasses are present. It just throws its writes into the void and hopes for the best. (Well, actually, they end up also being written to RAM at <code>$dff8</code>, but that happens regardless)</p>



<p>And from a hardware perspective, that’s all that exists to support the 3-D glasses. Everything else is up to the game code to figure out.</p>

<h2 id="space-harrier-3-d"><em>Space Harrier 3-D</em></h2>

<p><em>Space Harrier 3-D</em> is not my favorite way to play <em>Space Harrier</em>, even on the Master System. But let’s put that aside.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/shbox.JPEG" title="The weird angle here is just to show off the third dimension" alt="Space Harrier 3D&#39;s western box"/></p>

<p>So, up-front, we know the limitations of the Master System hardware; like anything that runs in a progressive mode on a standard television of the era, it can only run at 60Hz. (yes, 240p is fake and a lie, but close enough for us) As noted above, the glasses work by choosing one eye at a time. So any game is going to have to run at 30Hz. (25Hz for PAL types)</p>

<p>Now, 30Hz isn’t the worst; after all, it’s the frame rate of the <a href="https://loeber.substack.com/2021/interlace-me-not.html">interlaced video</a> that a standard television is designed to display. But don’t watch it without the glasses on to get 60Hz! That’s much worse. If we look at a video capture of <em>Space Harrier 3-D</em>, we see that it shows each image for each eye, one after the other. Things that move more from left to right between the frames, end up being seen as farther in the background.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/title.gif" title="it&#39;s faster than this though" alt="Space Harrier 3D title screen, performing the stereoscopic angle effect"/></p>

<p>One thing about the Master System port of <em>Space Harrier</em> is that they use <strong>software sprites</strong>. That is to say, many of the moving objects on the screen– pretty much everything other than Harrier– are not actually sprites, but are part of the tilemap.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/software.jpg" title="space harrier 1 is the better game tbh" alt="Space Harrier 2D gameplay showing software sprites"/></p>

<p>This causes them to move a bit choppily and not have transparency with the background, but the tradeoff is that <em>Space Harrier</em> can have very large objects without flicker. In these games, it’s worth it. <em>Space Harrier 3-D</em> works pretty much the same way.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/game.jpg" title="whatever" alt="Space Harrier 3D gameplay showing software sprites"/></p>

<p>Now, the problem with software sprites on systems like the Master System and the NES is that you can only write a certain number of bytes to VRAM at a time, so changing a lot of tiles on every frame can be a problem. This isn’t a huge deal, though, because usually you can just lower the framerate; since their position is limited by the size of an 8x8 tile anyway. But remember, to be 3-D, you have to switch everything every frame.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/game.gif" title="whatever but in 3d" alt="Space Harrier 3D gameplay showing software sprites, alternating two frames"/></p>

<p>So how do you do this? That’s a lot of data to write to VRAM.</p>

<p>Well, remember when <a href="https://loeber.substack.com/2021/i-am-the-mark-iii.html">I said</a> the following?</p>

<blockquote>
  <p>The tilemap of the Master System mode is surprisingly smaller than that of the NES; it’s 32x28 8x8 tiles instead, or 256x224 pixels. Since the vertical height of the display area is limited to 192 pixels, this is still fine for vertical scrolling. (There are 224 and 240-line modes on some later SMS models; they also expand the tilemap, and were only used by some European publishers late in the system’s life) Note that the tilemap eats into that 16kiB of VRAM.</p>
</blockquote>

<p>This is, on the face of it, true. At any given time, the Sega Master System can display one tilemap layer. It is 256x224 pixels large and made of 8x8 tiles, and takes up <code>0x700</code> bytes in the Master System’s 16kiB of VRAM.</p>

<p>And this is all true. Using the emulator <a href="https://emulicious.net/">Emulicious</a>, we can visualize the VRAM. Here it is for <em>Space Harrier</em>, the original, non-3D version.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/2dvram.png" title="all the animations of harrier are updated each frame, the SMS really can upload a lot to VRAM" alt="Space Harrier vram. It&#39;s primarily tiles with a small area at the bottom"/></p>

<p>Notice that it’s almost entirely made up of tiles that are used by the tilemap and sprites. But there’s an area at the bottom of the screen, at <code>$3800</code>, where the tilemap is. (And then, at <code>$3f00</code>, the sprite data)</p>

<p>But if we look at <em>Space Harrier 3-D</em>, it looks a little different.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/3dvram.png" title="it&#39;s red because I died lol" alt="Space Harrier 3D vram. It&#39;s primarily tiles with a larger area at the bottom"/></p>

<p>Things are arranged pretty differently. But most notably, the area of tiles and sprites is twice as big. How can this be true, if the Master System has only one tilemap?</p>

<p>The Master System only has one tilemap <em>at a time</em>. You see, while almost every Master System game has its tilemap (“name table”) at <code>$3800</code> and its sprite table at <code>$3f00</code>, that’s not required. There are two <a href="https://www.smspower.org/Development/VDPRegisters#Register02NameTableBaseAddress">VDP registers</a> that let you move it to other points in RAM.</p>

<p>This is a feature dating back to the TMS9918A VDP. While computers and game consoles generally paired the VDP with 16kiB of RAM, the <a href="https://archive.org/details/Texas_Instruments_TMS9918A">datasheet</a> mentions that it can support RAM as low as 4kiB. In this case, it’s very convenient to move things around, and not have fixed addresses. This sort of thing is the difference between a more general-purpose chip like the TMS9918A, and single-purpose chips like the NES PPU. (The Master System VDP is a single-purpose chip, but it has <em>heritage</em>, damnit)</p>

<p>So <em>Space Harrier 3-D</em> gives up some tile space to instead maintain two copies of the name and sprite tables, and shifts between them each frame. You still need to upload twice as much data to VRAM as with one screen, but you don’t need to redraw the whole screen every frame, just the changes. From my testing, every 3-D Master System game uses this screen-flopping method to a degree, though some only flip the tilemap and not sprites; and <em>Poseidon Wars 3-D</em> only uses the tilemap flipping for the HUD in gameplay.</p>

<p>And remember, this is the base Master System hardware. Any game that’s willing to give up the tile space– a big sacrifice– can make this tradeoff. Here’s the title screen of <em>Double Target</em>, the Japanese version of the game we got in the west as <em>Quartet</em>. I have the Japanese version because it has much better box art.</p>

<p><video src="/assets/img/glass/target.mp4" autoplay="" loop="" muted="" width="100%"> You don&#39;t have a video tag support or something? So you can&#39;t see this footage of *Double Target*? Ah too bad.</video></p>

<p>That cool smooth-scrolling could probably be done with an elaborate set of sprites and careful timing, but because they could spare the tiles, they instead just stored two title screen nametables in VRAM, and use the Master System’s line interrupt to switch between them as-needed while the screen is being drawn.</p>

<p>Here’s the nametable at <code>0x3000</code> for <em>Double Target</em>:</p>

<p><img src="https://loeber.substack.com/assets/img/glass/dt3000.png" title="this game is so honest, it would never claim to have four characters" alt="Double target title screen with character art and the title"/></p>

<p>And here it is at <code>0x3800</code>. Interestingly, it actually has most of the character art present still, but uses a different palette (the one usually used for sprites) to cover them up.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/dt3800.png" title="nice high score idiot" alt="Double target title screen without character art, but with the top score"/></p>

<p>It’s a pretty neat trick, if you can spare the VRAM. The Master System may not be able to do video bankswitching like the NES, but this sort of thing allows some similar effects, with a lot of flexibility, since it’s all in RAM.</p>



<h2 id="playing-on-lcd">Playing on LCD</h2>

<p>So you might have noticed that I mentioned that 3DTVs used the same active shutter technique. It might make you wonder, why don’t the 3D glasses work on LCD TVs, then? Even with a low-lag upscaler?</p>

<p>The answer is that there’s always some lag on an LCD. The 3D circuitry in a 3DTV is part of the LCD, and therefore can know exactly when the LCD will display a frame. Unfortunately, the Sega Master System is just as limited. In theory, though, I suppose if you had the programming skill and an upscaler and display with a constant, known lag, you could change the game to time properly. Good luck…</p>

<p><img src="https://loeber.substack.com/assets/img/composhoot/2mini4u.jpg" title="Remember these" alt="Two plastic &#39;MINI&#39; branded upscalers"/></p>

<p>Another option is to play on a very <em>bad</em> upscaler. 3-D games alterate 240p frames on every field. Therefore, upscalers designed for exclusively 480i video content will just interpret them as interlaced, and combine the two frames together.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/bad1.jpg" title="I resized these from the 16:9 I actually played it in. You&#39;re welcome." alt="Space Harrier 3D title screen over a bad upscaler"/></p>

<p>Notice that items that are further away end up duplicated. This makes oncoming objects appear as two elements that merge together as they get close; your bullets do the opposite, splitting into two as they move into the distance. While it’s surprisingly playable like this, if this is the only way you can play it, do yourself a favor and stick to the first Master System <i>Space Harrier</i>. You don’t need the 3D version’s FM soundtrack <i>that</i> badly.</p>

<p><img src="https://loeber.substack.com/assets/img/glass/bad2.jpg" title="pew pew | pew pew" alt="Space Harrier 3D gameplay over a bad upscaler"/></p>

<p>Of course, you’ll also get <a href="https://loeber.substack.com/2021/composite-conflict-completed.html">the downsides</a> of low-quality upscalers. Still, rapidly switching to create a fake interlacing effect is how <a href="https://loeber.substack.com/2023/april-fools-joke.html">my nightmare cartridge</a> produced those high-resolution skulls, in case you wondered.</p>

<p>In the end, if you want to play <em>Space Harrier</em> in 3-D with the objects really coming at you, it’s this or the <a href="http://archives.sega.jp/3d/archives/">Japanese-only Nintendo 3DS port</a>. And even at 30fps, that’s still a pretty cool effect. Just make sure you actually have the glasses.</p>

  </div>

  
</article>

      </div>
    </div></div>
  </body>
</html>
