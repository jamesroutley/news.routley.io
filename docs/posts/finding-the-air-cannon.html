<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.twobraids.com/2024/01/air-cannon.html">Original</a>
    <h1>Finding the Air Cannon</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-3837106197826318742">




<div>
  <p><span>tldr;</span> <i>An agricultural air cannon began firing every two minutes all night long disrupting the sleep of many in my community. I used Google Maps, three listening posts, and a programmed simulation to pinpoint the field hosting the air cannon. The county tax assessor office identified the land owner. I had a phone conversation with the farm manager. That conversation was coincident with the cessation of the nighttime air cannon. I can sleep again.</i></p>
</div>

<div>
  <p><a href="https://www.amazon.com/SlavicBeauty-Wildlife-Propane-Scarecrow-Mechanical/dp/B07HQ2BRH3/ref=sr_1_4?crid=3OSENULXJ1UK3&amp;keywords=propane+gas+cannon&amp;qid=1706405090&amp;sprefix=propane+gas+cannon%2Caps%2C198&amp;sr=8-4&amp;ufe=app_do%3Aamzn1.fos.c3015c4a-46bb-44b9-81a4-dc28e6d374b3"><img alt="" data-original-height="893" data-original-width="1479" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj_FQwP9m5fn3Zo66GLkoPYC_xuQFxGSQQl-i7w-6TH4qz95_A-cmVA8NL8S_wJLlj6aWzQpkFlyyZE3ji38laNBUjMP-9PpU5Si9Gi2JTtLGfiPQHa3T9kxJ1d3ZzbzzWgnnWywCIocOZS19J92xTcAjgbx2Rxzyd-19_KLsbuWgGOPhKJi1S3yw/s320/screen-shot%202024-01-27%2017:26:04.png" width="320"/></a></p><p><i>120dB;</i></p>
</div><p>

The use of agricultural air cannons south of Corvallis has been extreme this month. Farmers with field crops are often beset with Canadian Geese overwintering in the Willamette Valley. To scare the geese away, they frequently use propane air cannons on timers. Starting on January 5th, an air cannon began firing every two minutes all day and throughout the night. My sleep and that of many neighbors was disrupted for nearly a month.

</p><p>Trying to figure out where the cannon shots originated, I drove out and listened from several locations. It was loud on Airport Road, Bellfountain Rd, 53rd St, Plymouth Dr, Nash Ave, Brooklane Dr, Wake Robin Road, Rivergreen Ave and as far north as the Benton County Fair Grounds.  It was silent anywhere south of Llewellyn Rd.  Trying to get a heading for the sound with just my ears and a compass was way more difficult than I expected.</p> 

<div>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhuSBx5gLXhaIinsApi2URlvPqoxnsgiE5JgvLnMqbrBmDDMQAyAiFILjkt1Bt2mx6nZe-AisQosnlQ0kcfUfgVcxBJLb2yvHpeWHc8hC6vTOeehbwYKNvk33fjpGj5DsmrA021ok8YrOxunFVX4uTuWKWnhmvheuOpbbPN4GTQNZ0yv5z3B1UnaQ/s1619/airport.png"><img alt="" data-original-height="1314" data-original-width="1619" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhuSBx5gLXhaIinsApi2URlvPqoxnsgiE5JgvLnMqbrBmDDMQAyAiFILjkt1Bt2mx6nZe-AisQosnlQ0kcfUfgVcxBJLb2yvHpeWHc8hC6vTOeehbwYKNvk33fjpGj5DsmrA021ok8YrOxunFVX4uTuWKWnhmvheuOpbbPN4GTQNZ0yv5z3B1UnaQ/s320/airport.png" width="320"/></a></p>
      <p><i>The Corvallis Airport</i>
  </p>
</div>

<p>All indications were that the sound was coming from the area of the airport, but I could not pin it down any more accurately. The airport staff denied using an air cannon. However, they indicated that they could hear one to the south.</p>  

<p>The most easily identifiable farm south of the airport was Venell Farms.  They fervently denied they were using an air cannon. </p> 

<p>That left a big chunk of land south and west of the airport that was not crossed by public roads. Not willing to trespass to find the source, I needed a new strategy. </p> 

<p>After some deep thought, I theorized I could pinpoint the location of the air cannon by logging the arrival times of the sound from three locations.  It took three people stationed at remote locations miles apart using a synchronized clock on our cell phones. We each waited over the same ten minute period, noting the exact time for each of the five cannon shots that we heard. </p>  

<p>The sound arrived at our Bellfountain Rd location first. About four seconds later, the sound arrived at our Brooklane Dr. lookout.  Two seconds later, it arrived at our Rivergreen Ave listening post.</p> 

<p>I took a screen capture of a Google Map of our area with a measurement line on the map for scale. I plotted our three listening locations. The scale allowed us to figure out how far apart our test locations were and facilitated a method for translating back and forth between the image coordinate system and the real world coordinate system.</p> 

<p>

<svg width="100%" height="100%" viewBox="0 0 492.8461 371.50821" version="1.1" id="svg17092" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
  <defs id="defs17089">
    <rect x="-584.29248" y="230.31636" width="386.43683" height="52.555412" id="rect22296"></rect>
    <rect x="41.73518" y="-522.46265" width="347.79315" height="55.646904" id="rect21554"></rect>
    <rect x="775" y="621" width="164.51292" height="117.63713" id="rect11999"></rect>
    <rect x="414" y="525" width="190.37944" height="132.24751" id="rect12023"></rect>
    <rect x="1148" y="336" width="159.04301" height="107.50495" id="rect12005"></rect>
    <rect x="39" y="855" width="46" height="52" id="rect15046"></rect>
    <rect x="822" y="235" width="42" height="56" id="rect16560"></rect>
    <rect x="1530" y="394" width="40" height="49" id="rect16616"></rect>
    <rect x="534" y="1239" width="651" height="106" id="rect16771"></rect>
  </defs>
  <g id="layer1" transform="translate(151.36078,123.1619)">
    <path style="display:inline;fill:#ff0000;fill-opacity:1;stroke:#ff0000;stroke-width:2.64583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" d="M -127.17327,51.363991 274.72881,-51.823508" id="path1884"></path>
    <text xml:space="preserve" id="text11997" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect11999);display:inline;fill:#ff0000;fill-opacity:1;stroke:#ff0000;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.25717254,-0.06218219,0.06218219,0.25717254,-185.96658,-121.22037)" x="72.895889" y="0"><tspan x="782.3297" y="659.92612" id="tspan29329">6.3km
</tspan><tspan x="791.24637" y="713.2595" id="tspan29331">Δ~6S</tspan></text>
    <path style="display:inline;fill:#ffff00;fill-opacity:1;stroke:#ffff00;stroke-width:2.646;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" d="M -127.43785,50.570241 81.582981,-96.008924" id="path4910"></path>
    <text xml:space="preserve" id="text12021" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect12023);display:inline;fill:#ffff00;fill-opacity:1;stroke:#ffff00;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.21861977,-0.14902931,0.14902931,0.21861977,-217.32216,-74.882632)" x="72.895889" y="0"><tspan x="434.26231" y="563.92612" id="tspan29333">3.8km
</tspan><tspan x="443.17899" y="617.2595" id="tspan29335">Δ~4S</tspan></text>
    <path style="display:inline;fill:#00d000;fill-opacity:1;stroke:#00d000;stroke-width:2.64583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" d="M 81.318397,-96.273508 274.46423,-51.558925" id="path8615"></path>
    <text xml:space="preserve" id="text12003" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect12005);display:inline;fill:#00d000;fill-opacity:1;stroke:#00d000;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.25756972,0.06051592,-0.06051592,0.25756972,-118.37472,-249.16854)" x="72.895889" y="0"><tspan x="1152.5943" y="374.92612" id="tspan29337">3.0km
</tspan><tspan x="1161.511" y="428.2595" id="tspan29339">Δ~2S</tspan></text>
    <circle style="display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:0.291042;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" id="path16672" cx="-127.04098" cy="51.496281" r="3.8364582"></circle>
    <text xml:space="preserve" id="text15044" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;white-space:pre;shape-inside:url(#rect15046);display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.26458333,0,0,0.26458333,-146.1757,-190.97013)"><tspan x="39" y="893.92612" id="tspan29341">A</tspan></text>
    <circle style="display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:0.291042;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" id="path16672-2" cx="81.318398" cy="-95.215172" r="3.8364582"></circle>
    <text xml:space="preserve" id="text16558" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;white-space:pre;shape-inside:url(#rect16560);display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.26458333,0,0,0.26458333,-140.52262,-173.41165)"><tspan x="822" y="273.92612" id="tspan29343">B</tspan></text>
    <circle style="display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:0.291042;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" id="path16672-0" cx="274.19965" cy="-51.823509" r="3.8364582"></circle>
    <text xml:space="preserve" id="text16614" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;white-space:pre;shape-inside:url(#rect16616);display:inline;fill:#ff7f00;fill-opacity:1;stroke:#ff7f00;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" transform="matrix(0.26458333,0,0,0.26458333,-135.08656,-172.08874)"><tspan x="1530" y="432.92612" id="tspan29345">C</tspan></text>
    <rect style="fill:#00407f;fill-opacity:0;stroke:#00d0ff;stroke-width:2.64599;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" id="rect26072" width="375.03372" height="145.18753" x="-92.429253" y="101.83577"></rect>
    <text xml:space="preserve" id="text16769" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect16771);shape-padding:0;display:inline;fill:#00d0ff;fill-opacity:1;stroke:#00d0ff;stroke-width:1.1;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" x="311.58356" y="0" transform="matrix(0.26458333,0,0,0.26458333,-130.20216,-167.90979)"><tspan x="687.47904" y="1277.9261" id="tspan29347">Sound Source
</tspan><tspan x="714.69781" y="1331.2595" id="tspan29349">Search Area</tspan></text>
    <text xml:space="preserve" transform="matrix(0.26458333,0,0,0.26458333,27.810572,13.496307)" id="text21552" style="font-weight:bold;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect21554);fill:#ff7f00;stroke:#ff7f00;stroke-width:1.1;stroke-linecap:round;stroke-opacity:1"><tspan x="58.662969" y="-483.53677" id="tspan29351">Brooklane Dr</tspan></text>
    <text xml:space="preserve" style="font-weight:bold;font-size:11.2889px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;text-anchor:middle;fill:#ff7f00;stroke:#ff7f00;stroke-width:0.291042;stroke-linecap:round;stroke-opacity:1" x="293.23795" y="-70.344383" id="text21566"><tspan id="tspan21564" style="stroke-width:0.291042" x="293.23795" y="-70.344383">Rivergreen Ave</tspan></text>
    <text xml:space="preserve" transform="scale(0.26458333)" id="text22294" style="font-weight:bold;font-size:42.6667px;font-family:sans-serif;-inkscape-font-specification:&#39;sans-serif Bold&#39;;text-align:center;white-space:pre;shape-inside:url(#rect22296);fill:#ff7f00;stroke:#ff7f00;stroke-width:1.1;stroke-linecap:round;stroke-opacity:1"><tspan x="-575.48061" y="269.24253" id="tspan29353">Bellfountain Rd</tspan></text>
  </g>
</svg>
  </p>

    
<p>I wrote a program in Python (<a href="#source">see source code below</a>) that could iterate all the points in the image in the search area where we suspected the air cannon sat. Translating those image points to real world coordinates, I used the speed of sound at 35℉ to calculate the travel time to each of our three listening posts. Comparing the arrival times of the simulated sounds, I could match them with the deltas from the real observations. Once my program scanned and tested every point on the south half of the map image, it identified a point that exactly replicated the deltas. I knew I found the only possible origin of the sound and therefore the location of the air cannon. I translated my grid system back to real world coordinates and plotted it on my map. That identified the offending farm field.</p> 

<div>
<p><a href="https://www.flickr.com/photos/189561381@N07/51995423877"><img alt="" data-original-height="3528" data-original-width="3481" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFfWazPu7dqU6J0fo7Q_pEnQdbTbnqcTREMdcIV1GALIMd5ID_9vqfgECc7030ioVMdviAP4GEhFyMpFme2kC4w9Omf1qz43HK6S_RJ5l-fFzrCA1xRKQpqfe8GP-A47y-lUmedNJi3HB3Dr3wHUGnitb_MrO9ifmlynRin8HwFbG-MXkxlvz3hA/s320/angry-goose.jpg"/></a></p>
    <p><i>Angry goose does not like</i>
  </p>

</div>

<p>I went to the County Tax Assessor Office to find the owner of the property. With a company name, I found a Web site and a phone number.</p> 

<p>I called the owner of the farm (headquartered in Monmouth) and asked if they used an air cannon on their property near the Corvallis airport. They confirmed that they do. I asked if they run it at night, they said they do not. However, the manager said that he&#39;d contact the people working onsite.  Twenty minutes later, he called back reaffirming they are not running their cannons at night.  He also assured me that their air cannons could not be heard more than a mile away.  The air cannon that we tracked to his farm was clearly audible 6 miles away from the Benton County Fairgrounds. I did not trust his knowledge of his own equipment nor how it was used by the onsite staff.</p> 

<p>However, in an amazing coincidence, the air cannons stopped that very evening of our phone conversation (Thursday, January 25). The air cannons have fallen silent at night since that day.  I suspect that the cessation was not a random correlation.  I surmise that they actually were using the cannon at night and the manager stopped the practice.</p> 

<p>It was a miserable twenty days of ruined sleep. I found threads about the air cannon on Facebook, Reddit, Twitter/X and Nextdoor. How many people in Corvallis and Philomath were disrupted?</p> 

<p>I’m refraining from revealing the name of the farm. I don’t want folk harassing them. I will say, though, it wasn’t Venell Farms as so many expected.</p> 

<p>Should the nighttime air cannon start up again, I have an easy tool to figure out its exact location from miles away. I will exercise this newly found power whenever I need it.</p>  

<div>
  <div>
  <p><a href="https://www.flickr.com/photos/98799884@N00/13136553864"><img alt="" data-original-height="476" data-original-width="2160" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPb1NWS39zJYhkRB7bAITlBLzvUuAiFqzqPhH3BCHK_Hb1gbz3eNGwHHtdfnq4gYyZ4DqdGw3NeAXT3OkUf31ktfL4nAglCvxSUW5Nr_WBjHmkw11u-VF2cN1V5xhyphenhyphen-fIsGEuz6586_43TbeUy7g77gKOmnco87SW9yhmv_nK3ArpR3vQyoUIkdw/s1600/geese.jpg"/></a></p>
</div>
</div>
<p><a name="source"></a>Please note: this code is shared to show the algorithm, not as
a drop-in application that just runs.  It depends on two private
  modules <a href="https://github.com/twobraids/configmanners"><tt>configmanners</tt></a> and <a href="https://github.com/twobraids/whats_my_point"><tt>Points</tt></a>. 
Both of these are on github, but to put them upload them to
pip would be to commit to supporting them in perpetuity.  I&#39;m
not willing to do that.</p>

<p>There is no warranty, no guarantee, and the author is absentee.</p>
<div><p>
The Source Code to my Air Cannon location search program.

</p><pre><span>#!/usr/bin/env python3</span>

<span>from</span> <span>math</span> <span>import</span> <span>sqrt</span>, <span>isclose</span>
<span>from</span> <span>functools</span> <span>import</span> <span>partial</span>

<span>from</span> <span>points</span> <span>import</span> <span>Point</span>, <span>Block</span>
<span>from</span> <span>configmanners</span> <span>import</span> <span>Namespace</span>, <span>configuration</span>
<span>from</span> <span>configmanners</span>.<span>converters</span> <span>import</span> <span>str_to_list</span>

<span>terrible_number</span> <span>=</span> <span>100000</span>

<span>def</span> <span>distance</span>(<span>p1</span>, <span>p2</span>):
    <span>return</span> <span>sqrt</span>((<span>p2</span>.<span>x</span> <span>-</span> <span>p1</span>.<span>x</span>) <span>**</span> <span>2</span> <span>+</span> (<span>p2</span>.<span>y</span> <span>-</span> <span>p1</span>.<span>y</span>) <span>**</span> <span>2</span>)


<span>str_to_Point</span> <span>=</span> <span>partial</span>(
    <span>str_to_list</span>, <span>item_converter</span><span>=</span><span>float</span>, <span>list_to_collection_converter</span><span>=</span><span>Point</span>
)

<span>str_to_Block</span> <span>=</span> <span>partial</span>(
    <span>str_to_list</span>, <span>item_converter</span><span>=</span><span>int</span>, <span>list_to_collection_converter</span><span>=</span><span>Block</span>
)


<span>def</span> <span>all_points_within_block_iter</span>(<span>a_block</span>):
    <span>for</span> <span>x</span> <span>in</span> <span>range</span>(<span>a_block</span>.<span>left</span>, <span>a_block</span>.<span>right</span>):
        <span>for</span> <span>y</span> <span>in</span> <span>range</span>(<span>a_block</span>.<span>upper</span>, <span>a_block</span>.<span>lower</span>):
            <span>yield</span> <span>Point</span>(<span>x</span>, <span>y</span>)


<span>required_config</span> <span>=</span> <span>Namespace</span>()
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;A_in_px&#34;</span>,
    <span>default</span><span>=</span><span>Point</span>(<span>58.34</span>, <span>844.29</span>),
    <span>doc</span><span>=</span><span>&#34;point A in pixel coordinates&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)

<span>required_config</span>.<span>add_option</span>(
    <span>&#34;B_in_px&#34;</span>,
    <span>default</span><span>=</span><span>Point</span>(<span>846.05</span>, <span>290.27</span>),
    <span>doc</span><span>=</span><span>&#34;point B in pixel coordinates&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;C_in_px&#34;</span>,
    <span>default</span><span>=</span><span>Point</span>(<span>1574.73</span>, <span>453.96</span>),
    <span>doc</span><span>=</span><span>&#34;point C in pixel coordinates&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;AB_time_delta&#34;</span>,
    <span>default</span><span>=</span><span>4.0</span>,
    <span>doc</span><span>=</span><span>&#34;time delta between listening posts A and B&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;AC_time_delta&#34;</span>,
    <span>default</span><span>=</span><span>6.0</span>,
    <span>doc</span><span>=</span><span>&#34;time delta between listening posts A and C&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;BC_time_delta&#34;</span>,
    <span>default</span><span>=</span><span>2.0</span>,
    <span>doc</span><span>=</span><span>&#34;time delta between listening posts B and C&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Point</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;AB_in_m&#34;</span>,
    <span>default</span><span>=</span><span>3800.0</span>,
    <span>doc</span><span>=</span><span>&#34;distance in meters between points A and B&#34;</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;speed_of_sound_in_mps&#34;</span>,
    <span>default</span><span>=</span><span>332.24</span>,
    <span>doc</span><span>=</span><span>&#34;the speed of sound in meters per second&#34;</span>,
)
<span>required_config</span>.<span>add_option</span>(
    <span>&#34;search_box_in_px&#34;</span>,
    <span>default</span><span>=</span><span>&#34;400, 1000, 1200, 2000&#34;</span>,
    <span>doc</span><span>=</span><span>&#34;coodinate extents in pixels of the search area&#34;</span>,
    <span>from_string_converter</span><span>=</span><span>str_to_Block</span>,
)


<span>config</span> <span>=</span> <span>configuration</span>(<span>required_config</span>)

<span>scale</span> <span>=</span> <span>config</span>.<span>AB_in_m</span> <span>/</span> <span>distance</span>(<span>config</span>.<span>A_in_px</span>, <span>config</span>.<span>B_in_px</span>)


<span>def</span> <span>test_fitness</span>(<span>test_point_in_px</span>):
    <span>SA_in_m</span> <span>=</span> <span>distance</span>(<span>config</span>.<span>A_in_px</span>, <span>test_point_in_px</span>) <span>*</span> <span>scale</span>
    <span>SB_in_m</span> <span>=</span> <span>distance</span>(<span>config</span>.<span>B_in_px</span>, <span>test_point_in_px</span>) <span>*</span> <span>scale</span>
    <span>SC_in_m</span> <span>=</span> <span>distance</span>(<span>config</span>.<span>C_in_px</span>, <span>test_point_in_px</span>) <span>*</span> <span>scale</span>

    <span>TA_in_s</span> <span>=</span> <span>SA_in_m</span> <span>/</span> <span>config</span>.<span>speed_of_sound_in_mps</span>
    <span>TB_in_s</span> <span>=</span> <span>SB_in_m</span> <span>/</span> <span>config</span>.<span>speed_of_sound_in_mps</span>
    <span>TC_in_s</span> <span>=</span> <span>SC_in_m</span> <span>/</span> <span>config</span>.<span>speed_of_sound_in_mps</span>

    <span>test_AB_delta</span> <span>=</span> <span>abs</span>(<span>TB_in_s</span> <span>-</span> <span>TA_in_s</span>)
    <span>if</span> <span>not</span> <span>isclose</span>(<span>test_AB_delta</span>, <span>config</span>.<span>AB_time_delta</span>, <span>abs_tol</span><span>=</span><span>0.1</span>):
        <span>return</span> <span>terrible_number</span>

    <span>test_AC_delta</span> <span>=</span> <span>abs</span>(<span>TA_in_s</span> <span>-</span> <span>TC_in_s</span>)
    <span>if</span> <span>not</span> <span>isclose</span>(<span>test_AC_delta</span>, <span>config</span>.<span>AC_time_delta</span>, <span>abs_tol</span><span>=</span><span>0.1</span>):
        <span>return</span> <span>terrible_number</span>

    <span>test_BC_delta</span> <span>=</span> <span>abs</span>(<span>TB_in_s</span> <span>-</span> <span>TC_in_s</span>)
    <span>if</span> <span>not</span> <span>isclose</span>(<span>test_BC_delta</span>, <span>config</span>.<span>BC_time_delta</span>, <span>abs_tol</span><span>=</span><span>0.1</span>):
        <span>return</span> <span>terrible_number</span>

    <span># return the deviation from the sum of the deltas as a fittness value</span>
    <span>return</span> <span>abs</span>(
        <span>test_AB_delta</span>
        <span>+</span> <span>test_AC_delta</span>
        <span>+</span> <span>test_BC_delta</span>
        <span>-</span> <span>config</span>.<span>AB_time_delta</span>
        <span>-</span> <span>config</span>.<span>AC_time_delta</span>
        <span>-</span> <span>config</span>.<span>BC_time_delta</span>
    )


<span>best_fitness</span> <span>=</span> <span>terrible_number</span>
<span>best_point</span> <span>=</span> <span>None</span>
<span>for</span> <span>test_point_in_px</span> <span>in</span> <span>all_points_within_block_iter</span>(<span>config</span>.<span>search_box_in_px</span>):
    <span>fitness</span> <span>=</span> <span>test_fitness</span>(<span>test_point_in_px</span>)
    <span>if</span> <span>fitness</span> <span>&lt;</span> <span>best_fitness</span>:
        <span>best_fitness</span> <span>=</span> <span>fitness</span>
        <span>best_point</span> <span>=</span> <span>test_point_in_px</span>


<span>if</span> <span>best_point</span> <span>is</span> <span>not</span> <span>None</span>:
    <span>print</span>(<span>f&#39;<span><span>{</span><span>best_point</span><span>=</span><span>}</span></span> at <span><span>{</span><span>best_fitness</span><span>=</span><span>}</span></span>&#39;</span>)
<span>else</span>:
    <span>print</span>(<span>&#39;the air cannon is not in the search area&#39;</span>)</pre>
<p><span>
    (this code is not currently hosted in a public repository)
  </span>
</p></div>
<p>Please note: this code is shared to show the algorithm, not as
a drop-in application that just runs.  It depends on two private
  modules <a href="https://github.com/twobraids/configmanners"><tt>configmanners</tt></a> and <a href="https://github.com/twobraids/whats_my_point"><tt>Points</tt></a>. 
Both of these are on git hub, but to put them upload them to
pip would be to commit to supporting them in perpetuity.  I&#39;m
not willing to do that.</p>

<p>There is no warranty, no guarantee, and the author is absentee.</p>
</div></div>
  </body>
</html>
