<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dsego.github.io/demystifying-fourier/">Original</a>
    <h1>Demystifying Fourier analysis</h1>
    
    <div id="readability-page-1" class="page">




<h4 id="intro"><a href="#intro">Intro</a></h4>

<p>I&#39;ve started learning about spectrum analysis a long time ago at university,
  but failed to gain a true insight in how it works under the hood.
  For me, it was just some magical math formulas I had to memorize and know about.
  I knew the theory but it didn&#39;t really <q>click</q>.
</p>
<p>
  A few years ago I wanted to do some audio programming and play around with analyzing sound. That&#39;s
  how I got interested into building an intuition on how the Fourier transform <q>actually</q> works.
</p>
<p>I made these interactive examples mostly to improve my own understanding and learn by doing.
  I am following a mechanistic approach and building from the ground up with simpler building blocks,
  rather than introducing the formula and saying <cite><q>this is what it means.</q></cite>
  Since I mainly do web programming for a living, this seems to be easier to wrap my mind around than some <i>abstract math</i>.
</p>
<p>
  My language and math are very simplified, and probably a bit imprecise or not completely correct.
  I am also not including explanations for everything (like trigonometry functions etc, because that&#39;s out of scope)
  and completely ignoring some details that I didn&#39;t think are relevant (like negative frequencies).
</p>
<p>Feel free to submit any corrections or feedback in the <a href="https://github.com/dsego/demystifying-fourier">github repo</a>.
</p>


<h4 id="sound"><a href="#sound">Sound</a></h4>

<p> Sound comprises of oscillations or repeating patterns in pressure that propagate in a medium.
  Sound waves typically have complex patterns repeating at different frequencies.
  We can typically reconstruct any complex wave form from other periodic waves.
</p>
<p>Sinusoidal waves are a good choice for this because they have nice mathematical properties.
That is, sound waves are not made out of sines as real-word phenomena. </p>

<p>To quote one reddit comment:</p>

<blockquote cite="https://www.reddit.com/r/askscience/comments/huxkb/comment/c1ynlgj/?utm_source=share&amp;utm_medium=web2x&amp;context=3">
  <q>The only things &#34;perfect&#34; about a sine wave are its mathematical conveniences,
    it has no special connection to real-world phenomena.
    You could model those phenomena with equal precision with other waveforms.</q>
    <cite>~RickRussellTX</cite>
</blockquote>

<p>Sine waves also represent up-and-down motion of pistons on a crankshaft:</p>
<blockquote cite="https://www.reddit.com/r/askscience/comments/huxkb/comment/c1yobfr/?utm_source=share&amp;utm_medium=web2x&amp;context=3">
  <q>I suspect that the obsession with sine waves comes from the fact that in
  our daily machine-driven lives we have an awful lot of machines that rotate around an axis,
  or are attached to crankshafts and what-have you.
  A piston on a crankshaft produces &#34;pure&#34; sinusoidal up-and-down motion when operating at constant angular velocity.</q>
  <cite>~RickRussellTX</cite>
</blockquote>

<p>Sinusoids in fact cannot correctly reproduce discontinuous signals, but they are good enough for band-limited signals.</p>



<h4 id="probing-with-a-single-sine-wave">
  <a href="#probing-with-a-single-sine-wave">
    <q>Probing</q> with a single sine wave
  </a>
</h4>

<p>
  <img src="https://i.imgflip.com/gkh5g.jpg" alt="Let the probing... Begin!"/>
</p>

<p>
  We start from a relatively straightforward approach of <q><i>probing</i></q> or analyzing the target signal by
  doing a <a href="https://en.wikipedia.org/wiki/Sine_and_cosine_transforms"><i>sine transform</i></a>
  as originally done by Fourier himself. I&#39;m using the term <q>probe</q> here, I&#39;ve read it somewhere else already and it feels appropriate,
  but these are usually called <q><cite>analyzing functions.</cite></q>
</p>
<p>The idea is to multiply the signal with a pure sine wave.
  The resulting transform is the area, which can tell us how closely the signal aligns with our test sine wave.
</p>

<p>Here is a simplified formula for this idea:
$$\mathit{transform} = \mathit{area}(\ \mathit{target\ signal} \times \mathit{probe}\ )$$</p>

<p>For completeness sake, let&#39;s also include the math formula for our
 sine transform that analyzes the presence of frequency <i>s</i> in the target signal:</p>

$$F_{s} = \int_{-\infty}^\infty f(t) \times \sin(2πst) dt$$

<p>\(sin(2πst)\) is our sine analysis function (aka <i>probe</i>) and \(f(t)\) is our target signal.


</p><figure id="example-1"><!-- interactive demo --></figure>

<p><label><small>Probe frequency</small></label>
  
  <output id="example-1-freq"></output>
</p>

<p><label><small>Target signal amplitude</small></label>
  
  <output id="example-1-amplitude-label"></output>
</p>




<p>
  Our target signal is a <b>4Hz sine wave</b>.
  We can multiply it by a single sine probe with a fixed phase. This means it won&#39;t slide left or right, just change its frequency.
</p>
<p> When we aggregate all the values in the transform together, we get a high positive result if the probe correlates with the signal.
  This number represents the magnitude of the transform.
  For non-matching frequencies the result is zero because all the peaks and troughs cancel out.
</p>
<p>This is all there is to it, the magic trick behind the transform.
  The total sum of a single sine wave averages out to zero, because there are positive and negative sides.
  But when we multiply it with a correlating signal, multiplying the negatives will turn them into positive numbers,
  effectively resulting in a non-zero sum of the transform.
</p>
<p>
  Notice how the resulting magnitude and also depends on amplitude of the signal we want to analyze.
</p>



<h4 id="probing-and-phase">
  <a href="#probing-and-phase">
    Probing and phase
  </a>
</h4>

<p>Let&#39;s try to analyze a signal that is still <b>4Hz</b> but offset by a quarter of a turn (phase is <b>π/2</b>).</p>
<p> Why can&#39;t we match the signal?</p>

<figure id="example-2"><!-- interactive demo --></figure>








<p>The sine probe is out of phase with the target signal and won&#39;t correlate.
Sinusoidal waves are periodic and repeat from the beginning every one turn around the circle, 360° or 2π radians.
When the phase of our probe doesn&#39;t match the phase of the target wave, we won&#39;t get a match.
</p>

<p> Let&#39;s turn our probe into a <i>cosine</i> wave. This will bring it back by a quarter of a turn to match the signal perfectly.
</p><p>Notice how we&#39;re also getting a so-called <cite>DC offset</cite> of magnitude 1 for all the frequencies that we are analyzing.
The transform for our 0Hz probe is also a replica of the original wave! This is because the <i>cosine</i> function is 1 when the phase is 0.
The <i>sine</i> starts at 0, so we don&#39;t see the same effect.
</p>


<h4 id="probing-with-sine-and-cosine">
  <a href="#probing-with-sine-and-cosine">
    <q>Probing</q> with sine and cosine
  </a>
</h4>

<p> Let&#39;s try combining the sine &amp; cosine transforms in our analysis of a
  4Hz wave ofset by π/4 (half way between a sine and a cosine).
  This is effectively the famous <a href="https://en.wikipedia.org/wiki/Fourier_transform"><q>Fourier transform</q></a>.
  </p>
<p>
  When we pick the 4Hz analysis waves, we can notice how both match partially.
  From this we can re-construct a complete match.
  Any movement in phase of the target wave will reflect in the sine and cosine components of our transform.
</p>

<figure id="example-3-signal-plot"><!-- interactive demo --></figure>








<p>From the ratio of our sine and cosine matches we can figure out the actual phase and magnitude (as if we were using a sinusoid of that phase).
</p><p>The magnitude becomes the length of the diagonal line, which is equal to \(\sqrt{{sin}^2 + {cos}^2}\).
  The phase can be found from the ratio or angle between the sine &amp; cosine components, ie \(atan2({sin}, {cos})\).
</p>



<h4 id="sinecosine-probes-and-their-negatives">
  <a href="#sinecosine-probes-and-their-negatives">Sine/cosine probes and their negatives</a>
</h4>
<p>We don&#39;t need any more <i>probes</i> to cover the rest of the quadrants, since the next two
sinusoids (apart by π/2) would just be the negatives of our sine/cosine probes. </p>

<p>$$\sin(π) = {-\sin(0)}, \ \  \cos(-{π\over4}) = {-\cos(0)}$$</p>



<figure id="example-sincos">
  <!-- interactive demo -->
  </figure>



<h4 id="phase">
  <a href="#phase">Phase</a>
</h4>

<p>To further drive the point home, let&#39;s look at another interactive example.</p>
<p>Here we make the frequencies of both the signal under test and our sine/cosine probes set at <b>4Hz</b>
  and just look at the phase of the signal.
</p><p><b>Drag</b> the target sine wave left and right. Notice that our sine &amp; cosine probes give a match for any phase in-between.</p>

<figure id="example-31"><!-- interactive demo --></figure>





<h4 id="analyzing-a-complex-wave">
  <a href="#analyzing-a-complex-wave">Analyzing a complex wave</a>
</h4>

Let&#39;s analyze a more complex signal which consists of multiple components, a strong one at 2Hz and two weaker ones at 4Hz &amp; 7Hz.
The 4Hz component has a phase of π/3 and the 7Hz a phase of π/4.
This example includes a frequency spectrum plot that shows a bar for each analysis probe. Clicking on a frequency bin will
show the corresponding analysis function and transform (just as selecting the probe frequency on a slider in previous examples).

<figure id="example-4"><!-- interactive demo --></figure>

<label><small>Granularity</small></label>





<hr/>
<ul>
  <li>The frequency graph with bins shows magnitudes for all probed frequencies.</li>
  <li>Again, notice that the 0Hz band for our cosine transform produces an average of the signal (which is zero in this case).</li>
  <li>When choosing 1/4 Hertz resolution there is something strange going on.
    We don&#39;t get a nice single bar for each of the frequencies.
    Instead, the spectrum spills over into neighboring buckets.
  </li>
  <li>
    At 0.25Hz resolution the 3.75Hz frequency bar appears stronger than the 4Hz bar,
    even though it&#39;s a 4Hz component (the actual component has a phase of π).
  </li>
  <li>Drag the target signal left or right to change its phase. Notice how this affects the bars in the spectrum plot.
</li></ul>
<p>Let&#39;s examine these anomalies in our next examples.</p>



<h4 id="spectral-spillover">
  <a href="#spectral-spillover">Spectral spillover</a>
</h4>

<p>
  What happens if we analyze frequencies that are not whole numbers, but somewhere in-between?
  Let&#39;s say this time we are analyzing a frequency of <b>3.5Hz</b> with phase <b>π/3</b>.</p>
<p>
  See how for non-integer frequencies we don&#39;t get a single bar, instead the spectrum is spilling over into adjacent buckets.
  The actual peak is somewhere between 3Hz &amp; 4Hz. We can figure out the actual peak either by interpolating
  between the bins, or we can increase the number of bins by creating more granular probes for analyzing.
</p>
<p>
 What&#39;s even stranger is how the spill-over shape doesn&#39;t just taper out like a bell curve,
 instead it oscillates up and down, but dampens as it spreads out,
 creating shapes known as <cite>lobes</cite>.
</p>

<figure id="example-5"><!-- interactive demo --></figure>

<label><small>Granularity</small></label>






<h4 id="sinc-function-and-spectral-resolution">
  <a href="#sinc-function-and-spectral-resolution">The sinc function &amp; spectral resolution</a>
</h4>

<p>
This <i>spilling over</i> happens because our sine isn&#39;t infinite in time and we are analyzing
frequencies that are not all periodic with the fixed time interval.
</p><p>
An infinite sine would give perfect peaks in the spectrum plot, but our sine signal is showing lobes in neighboring frequency bins.
With a finite window we will have many of our probes that are close in frequency give a perceptible match.
That&#39;s because they or the signal don&#39;t fit perfectly in the window (aren&#39;t periodic with it)
and have some dangling fragments near each side of the window.
</p>

<p>In different words, our transforms don&#39;t always cancel out when they should, they are sliced off at the ends in the wrong place.
If we had an infinite window of time or we tailored the window to be periodic with each measured frequency and the target signal,
all of this noise would cancel out and leave a pure spike for the probe that fully matches our sinusoid.
</p>

<p>To illustrate the effect, here is an example of <b>2.5Hz</b> wave and a 1-second time window.
  Increasing the time interval changes the spectral resolution and we get a cleaner spike for the target frequency.
  This shape of the frequency spectrum with <cite>side lobes</cite> spreading out is known as the <b>sinc</b> function (in this case, it&#39;s absolute, ie |sinc|).
</p>

<figure id="example-6"><!-- interactive demo --></figure>

<label><small>Time window</small></label>




<h4 id="periodic-window-and-frayed-ends">
  <a href="#periodic-window-and-frayed-ends">Periodic window &amp; frayed ends</a>
</h4>

<p>We can demonstrate this requirement to have a periodic window of time in the following interactive example.</p>
<p>
  There is a 2Hz target sine wave and a 4Hz sine probe. The time interval can be increased in increments of 0.125s
  or half of the probe&#39;s period.
  Notice how when the window size is periodic with the sine transform, we get a perfect cancellation.
  This is the behavior we want, our 4Hz probe isn&#39;t supposed to give a match for the 2Hz target signal.
  We get partial matches when the probe sine does not perfectly fit in the window (isn&#39;t periodic with it).
</p>
<p>This is where those lobes and the <i>sinc</i> shape come from.
Note that for higher frequencies these fragments are smaller and have less effect on the transform,
causing smaller spectrum lobes.</p>

<figure id="example-7"><!-- interactive demo --></figure>


<p><label><small>Time window</small></label>
  
  <output id="example-7-time-label"></output>
</p>

<p><label><small>Probe frequency</small></label>
  
  <output id="example-7-freq-label"></output>
</p>





<h4 id="complex-numbers">
  <a href="#complex-numbers">Complex numbers</a>
</h4>
<p>How do complex numbers come into play? </p>

<p>There is a common way to write down the Fourier transform for frequency <i>s</i> that uses complex numbers:
 $$F_s = \int_{-\infty}^\infty f(t)\cdot(\cos(2πst) - i \cdot\sin(2πst))dt$$</p>

<p>From my understanding, it&#39;s just a convenient way to write sine &amp; cosine components in a single math expression.
  Multiplying the sine transform with the imaginary number separates it from the cosine component,
  since real &amp; imaginary numbers don&#39;t mix.
</p>

<p>
  Another common notation uses <a href="https://en.wikipedia.org/wiki/Euler%27s_identity">Euler&#39;s identity</a>:
  $$e^{ix} = \cos{x} + i\sin{x}$$

  which gives us this beautiful condensed version:
  $$F_s = \int_{-\infty}^\infty f(t)\cdot e^{-i2πst}dt$$
</p>

<h4 id="conclusion">
  <a href="#conclusion">Conclusion</a>
</h4>


<p>
We can analyze frequencies in any waveform by multiplying it with other periodic waves for each of the frequencies we want to find.
These analysis waveforms, aka <q>probes</q> must have some parts above zero and some below zero so their sum averages to zero.
Sines and cosines are good candidates, the combination of these two transforms is sufficient to detect a
frequency regardless of where it is positioned in the wave, ie its phase (or even its duration).
But they exhibit issues when analyzing limited time intervals, since they don&#39;t taper off and instead extend to infinity.
</p>

<hr/>





</div>
  </body>
</html>
