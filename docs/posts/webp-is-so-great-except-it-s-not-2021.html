<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://eng.aurelienpierre.com/2021/10/webp-is-so-great-except-its-not/">Original</a>
    <h1>WebP is so great except it&#39;s not (2021)</h1>
    
    <div id="readability-page-1" class="page">
		<a href="#content">Skip to content</a>

	<div id="boxed-wrapper">
		
		<div id="wrapper">
			
							
					
			<header>
				<div>
					
<div>
	<div>
					<div><div data-margin-top="0px" data-margin-bottom="0px" data-margin-left="0px" data-margin-right="0px">
			<a href="https://eng.aurelienpierre.com/">

						<!-- standard logo -->
			<img src="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/03/signature-logo-petit.png" srcset="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/03/signature-logo-petit.png 1x, https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2020/10/signature-logo-retina.png 2x" width="" height="" alt="Aurélien PIERRE Engineering Logo" data-retina_logo_url="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2020/10/signature-logo-retina.png"/>

			
					</a>
		</div></div>		<nav aria-label="Main Menu"></nav>	

<nav aria-label="Main Menu Mobile"></nav>

					</div>
</div>
				</div>
				
			</header>
								
							
				
					
							
			<section aria-label="Page Title Bar">
	
</section>

						<main id="main">
				<div>

<section id="content">
									<div id="post-1039">

				<div>
					<!-- maths detected --><article><div><div><div><div><p>I’m a responsible web designer, and as such, since WordPress (finally) accepts media uploads of <code>image/webp</code> MIME type and since <strong>all</strong> <a href="https://caniuse.com/webp">web browsers</a> newer than september 2020 (even Apple Safari \o/) can display it, I have been moving my <a href="https://photo.aurelienpierre.com/portfolio">photos library</a> to <a href="https://en.wikipedia.org/wiki/WebP">WebP</a>. After all, when you create content, the least you can do is to also provide the smoothest user experience around it.</p>

<p>WebP falls close to magical : lookie those file weights ! <a href="https://www.industrialempathy.com/posts/avif-webp-quality-settings/">15% savings</a> compared to JPEG at same quality ! What are we waiting for ? Google even claims <a href="https://developers.google.com/speed/webp/docs/webp_study">25-34% smaller</a>.</p>

<p>There are dozens of WordPress plugins allowing you to convert your old media library on-the-fly, most of them operating as SaaS (Shit as a Software) and doing the conversion on their own servers, which entitles them to make you pay a ridiculous amount for it, <a href="https://imagify.io/">one of them</a> I’m very unhappy to have actually paid (something about sparing time, which actually led to losing time AND money). All of them claim that their “aggressive” compression factor is safe for 99 % of your pictures.</p>

<p>The most technical ones will go as far as telling you that WebP quality greater than <code>lossy 80</code> is useless for most pictures, sustaining their claim with a glorious <a href="https://groups.google.com/a/webmproject.org/forum/#!topic/webp-discuss/0GmxDmlexek">Google logo</a> encoded at various rates. Because everyone knows shooting logos is the bread and butter of every photographer, especially the Adobe Stock ones. Also, logos have their gradients following an hyper-laplacian distribution like any other natural image<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">[1]</a></sup>. Or maybe not. Who cares about gradients stats anyway ? We are only talking about 2D compression heuristics with entropy and high-frequencies thresholding, after all.</p>

<p>So, while I may have lost all respect for coding monkeys turned into image dudes just because a position opened (and everyone loves pics, right ? They are fun and much easier on the brain than words), especially the internet image dudes, I still fall every time for that silly assumption: people who are supposed to know, actually know. Years pass, I don’t learn : I read docs, I do what they say, I discover it doesn’t work as promised, only then I remember those guys don’t know shit about images. And here I am, loosing faith in humanity one wrong expert at a time.</p>

<p>In my great silliness, I set the <a href="https://wordpress.org/plugins/webp-express/">third and last plugin I tried</a> to the advised <code>lossy 80</code> quality and trigger the batch conversion. I have relative faith in it since it uses server-side <a href="https://en.wikipedia.org/wiki/GraphicsMagick">GraphicsMagic</a> instead of the unfortunate PHP shitstack (GD, Gmagick and the likes) or the laggy HTTP-error connection-timed-out DNS-said-not-today please-retry-later SaaS nonsense.</p>

<p>Everything goes well, until this happens…</p>

<p><a href="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/02/03-WEB-800x971.webp"><img decoding="async" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-orig-src="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/02/03-WEB-800x971.webp" alt=""/></a></p>

<p>To the non-educated eye, this might look ok, but for a photographer it’s not, and for several reasons. See the posterized ring in the background ? First of all, it’s not graceful, but then it has nothing to do there. This comes from a 16 bits scan of an Ilford Delta 400 film shot with a Mamiya RB 67, that is old school analog medium format at 6×7 cm. The silver halide crystals of the Delta 400 emulsion act as a natural dithering which makes high-frequency compressions more difficult and therefore prevent posterization in smooth areas. So, for any compression algo, managing to posterize a Delta 400 scan is a feat of the wrong kind.</p>

<p>Look at the original JPEG at quality 85 :</p>

<p><a href="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/02/03-WEB-800x971.jpg"><img decoding="async" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-orig-src="https://photo.aurelienpierre.com/wp-content/uploads/sites/3/2017/02/03-WEB-800x971.jpg" alt=""/></a></p>

<p>It’s not 100 % clean either, but much better. Granted, this is WebP re-encoding of an already lossy compressed JPEG, so we stack 2 steps of destructive compression. <strong>But</strong> this is what <a href="https://developers.google.com/speed/pagespeed/insights/">Google Page Speed insights</a> encourage you to do and what a shitload of plugins enable you to do, while pretending it’s completely safe. <strong>It’s not.</strong></p>

<p>I have seen a similar effect in other similar pictures : always pictures with large, smooth, gradients in the background, which happens a lot when some punctual-ish light falls off a wall. That’s not something accidental, smooth fall-off are actively built by photographers to create organic-looking backgrounds with just enough of texture to not get boring, yet discrete enough to not draw attention off the foreground/subject.</p>

<p>So, I wondered how bad it was for actual raw photos encoded straight in darktable. Meaning just one step of encoding. Meaning real WebP quality comparison for real-life studio head-shots, which are one of the last things customers are willing to pay actual photographers to do (instead of snapping their own iPhone). Meaning real money for real professionals. Meaning something the image coding douchebags may have not foreseen, because it doesn’t happen in VS Code (or Vim, for that matter).</p>

<p>Let’s start. The following 2 images use <a href="https://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering">Floyd-Steinberg dithering</a> in 8 bits, with lossy compression set at 90 for both JPEG and WebP (remember, the experts recommend 80 for WebP). All images below, saved in WebP, use the “photo” image hint of Jeroen Oom’s <a href="https://cran.r-project.org/web/packages/webp/index.html">libwebp</a> 1.2.1. <em>Click on images to open the full-size version, or better : right-click and open them in a new tab</em></p>

<p>JPEG, lossy, 90 : 227 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90.jpg"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90.jpg" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90.jpg" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-200x113.jpg 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-300x169.jpg 300w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-400x225.jpg 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-600x338.jpg 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-768x432.jpg 768w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-800x450.jpg 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-1024x576.jpg 1024w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-1200x675.jpg 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90-1536x864.jpg 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-90.jpg 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>JPEG, lossy, 85 : 184 kiB 
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-200x113.webp 200w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-300x169.jpg 300w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-400x225.webp 400w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-600x338.webp 600w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-768x432.jpg 768w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-800x450.webp 800w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-1024x576.jpg 1024w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-1200x675.webp 1200w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-1536x864.webp 1536w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>WebP, lossy, 90 : 140 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-200x113.webp 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-400x225.webp 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-600x338.webp 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-800x450.webp 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-1200x675.webp 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering-1536x864.webp 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-dithering.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>JPEG 85 and WebP 90 both fail the test, looking like shit. But WebP looks more like shit : the contrast in posterized rings is higher. <strong>And</strong> we are already 10 % above the recommended quality that “should fit 99 % of pictures”. JPEG 90 looks ok though, but it’s a lot heavier.</p>

<p>So, let’s try something else, now : going lossless WebP. That should be our ground truth of WebP supremacy.</p>

<p>WebP, lossless : 660 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-200x113.webp 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-400x225.webp 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-600x338.webp 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-800x450.webp 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-1200x675.webp 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless-1536x864.webp 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossless.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>JPEG, quality 100 : 759 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100.jpg"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100.jpg" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100.jpg" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-200x113.jpg 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-300x169.jpg 300w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-400x225.jpg 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-600x338.jpg 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-768x432.jpg 768w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-800x450.jpg 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-1024x576.jpg 1024w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-1200x675.jpg 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100-1536x864.jpg 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-100.jpg 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>JPEG, quality 95 : 363 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95.jpg"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95.jpg" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95.jpg" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-200x113.jpg 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-300x169.jpg 300w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-400x225.jpg 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-600x338.jpg 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-768x432.jpg 768w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-800x450.jpg 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-1024x576.jpg 1024w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-1200x675.jpg 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95-1536x864.jpg 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-95.jpg 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>So, the WebP quality is now clean, but I’m not impressed with the weight, especially since you need a really good look to distinguish it from JPEG 90, which weighs about a third of that, and it’s forensically similar to JPEG 95, which is a bit more than half. Ooops.</p>

<p>Let’s try something else : redo it, but instead of the light Floyd-Steinberg dithering, use heavier random noise at -48 dB PSNR. That’s a very high PSNR, meaning it should be almost unnoticeable to human eyes but should give an harder time to the high-frequency filtering which is most of the trick behind image compressing.</p>

<p>JPEG, lossy, 85 : 211 KiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-200x113.webp 200w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-300x169.jpg 300w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-400x225.webp 400w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-600x338.webp 600w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-768x432.jpg 768w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-800x450.webp 800w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-1024x576.jpg 1024w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-1200x675.webp 1200w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-1536x864.webp 1536w,https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>WebP, lossy, 90 : 146 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-200x113.webp 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-400x225.webp 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-600x338.webp 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-800x450.webp 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-1200x675.webp 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-1536x864.webp 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>The WebP is still more prone to posterization. So, I wondered what the WebP quality was that would be as smooth as the JPEG 85 with -48 dB of noise (which was pretty damn smooth). The answer is somewhere between 95 and 96, even though it’s hard to make an equivalence since the quality and texture of the artifacts differ.</p>

<p>WebP, lossy, 96 : 294 kiB
<a href="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96.webp"><img decoding="async" src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96.webp" data-orig-src="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96.webp" alt="" width="2048" height="1152" srcset="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%272048%27%20height%3D%271152%27%20viewBox%3D%270%200%202048%201152%27%3E%3Crect%20width%3D%272048%27%20height%3D%271152%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E" data-srcset="https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-200x113.webp 200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-400x225.webp 400w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-600x338.webp 600w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-800x450.webp 800w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-1200x675.webp 1200w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96-1536x864.webp 1536w, https://eng.aurelienpierre.com/wp-content/uploads/sites/8/2021/10/Shoot-Antoine-0044-_DSC0085-lossy-noise-96.webp 2048w" data-sizes="auto" data-orig-sizes="(max-width: 2048px) 100vw, 2048px"/></a></p>

<p>Yeah, you read it. WebP is actually 39 % heavier than JPEG 85 plus noise for a similar-ish look on this difficult picture, and still not totally as smooth as the JPEG (there is still a tiny bit of ringing). It’s also 30 % heavier than JPEG 90 with simple Floyd-Steinberg dithering.</p>

<p>So, what do we take from that ?</p>

<p>First, at similar visual quality and for photographs, WebP is not lighter than JPEG, it’s actually the opposite. All the Google claims rely on measuring the average SSIM and average bit weight over a dataset of images. Call me crazy, but I don’t give a shit about averages. For a <a href="https://en.wikipedia.org/wiki/Normal_distribution">gaussian &#34;normal&#34; process</a>, probabilities say half of your sample will be above and half will be below the average (which is also the median in a gaussian distribution). If we designed cars for the average load they would have to sustain, it means we would kill about half of the customers. Instead, we design cars for the worst foreseeable scenario, add a safety factor on top, and they still kill a fair amount of them, but a lot fewer than in the past. Most probabilistic distributions are close to gaussian, so the assumption that average = median ± a little something is fair. Also the <a href="https://fr.wikipedia.org/wiki/Structural_Similarity">SSIM</a> metric is an incomplete, biased, controverted metric of image similarity that takes no actual perceptual metric into account<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">[2]</a></sup>, it’s just averages, variances and covariances, meaning it is barely a pattern recognition scheme from a machine perspective.</p>

<p>As a photographer, I care about robustness of the visual output. Which means, as a designer, designing for the worst possible image and taking numerical metrics with a grain of salt. And that whole WebP hype is unjustified, in this regard. It surely performs well in well chosen examples, no doubt. The question is : what happens when it doesn’t ? I can’t fine-tune the WebP quality for each individual image on my website, that’s time consuming and WordPress doesn’t even allow that. I can’t have a portfolio of pictures with even 25 % posterized backgrounds either, the whole point of a portfolio is to showcase your skills and results, not to take a wild guess on the compression performance of your image backend. Average won’t do, it’s simply not good enough. And in setting the weight vs. quality ratio, the nature of the induced artifacts matters perhaps more than the norm of the deviation. We can tolerate higher variance in random noise than in patterned blotches.</p>

<p>Second, I don’t know why all the techies around have a huge kink over sharpness, but the most challenging situations I have faced as a photographer were with smooth gradients. Or more accurately, gradients that should have been smooth and weren’t in the output. So there is a real issue with the design priorities of image algos from tech guys who clearly lack historical and artistic background, and don’t talk to artists, who anyway have largely decided that they were above science, maths and other menial materialistic concerns. Most test pictures for WebP compression showcase sharp scenes with large depth of field, so lots of details, aka high-frequencies, which have zero chance of posterization and are not the pain point of such algorithms. Lack of sharpness has never destroyed a picture, on the contrary. Painters took as much trouble to render atmospheric haze and <em><a href="https://en.wikipedia.org/wiki/Sfumato">sfumato</a></em> as photographers take now to revert them. But having a staircase in place of a smooth vignette surely <strong>is</strong> damaging to the picture in an unacceptable way.</p>

<p>Third, big shout-out to all the morons, idiots, douchebags and monkeys who make big claims all around on matters they don’t nearly understand. Why the big words ? I have been told on my previous article that I was too heavy on insults… Well, we live in a time where time is the ultimate luxury, and the idiots-who-should-know-but-didn’t are not only causing damages, they also cost money and time, and I really think they should be punished for this. You can refund money, you can’t refund time. Thing is, as technologies are “improving”, people don’t get more free time because the work doesn’t get any easier. Instead, the tools become more complex and the customer expect more as the tools get faster, meaning workers have as much work as before, only with more complex toolkits. So, actually, better tech doesn’t mean less or easier work for the actual workers, it may just mean better result if it is actually better tech, which, in this case, it is not. The proof has been made here that WebP is simply not robust enough for image makers, regardless of its average performance, if lesser (or even similar) data bandwidth is the ultimate goal. The test done here is simple enough to have been done by anyone much earlier, provided they used image datasets from actual photographers.</p>

<p>Image-making is not just a vocational part-time activity for bored upper-class or retired citizen with enough money to buy 10 k€ camera systems and do mostly nothing out of them. Some people rely on that to make a living. And they are already in a precarious enough situation (even before COVID… how many newspapers still had a photo staff in 2015 ?) to not take more shit from the people who pretend to help them, when they do the opposite. I have the ability to double-check the stupid shit I read here and there, but the large majority of visual artists don’t and will take the word of “experts” for truth even though it contradicts facts they have witnessed themselves for years.</p>

<p>The Google monkeys at Page Speed are idiots when they advise you to move all your content to WebP. Also they are dishonest since they commited it themselves, so they are judge and party. The Google monkeys who said WebP has lower weight at similar average SSIM say nothing because neither the SSIM nor the average are meaningful : none is robust enough, at best it’s a 50⁄50 % of satisfying/unacceptable outcome. The WordPress plugins monkeys are idiots when they advise and tool you up to convert already lossy JPEGs to WebP. Oh, they probably make all their claims in good faith, the problem is they didn’t see the problems, precisely. And it’s super difficult to argue with people who don’t — literally — see the problems because it’s their bad eyes against your experience, and since people believe only what they see, you are screwed. But then, a lot of lower-tier websites and blog will repeat everything coming from these “trustable” sources, doing even more damage. I have personally lost about a full working week in the past 6 months over that whole WebP migration madness and thanks to all these fake news, to make it work across URL rewriting and CDN redirections, and then to understand why it looked so bad at the end.</p>

<p>Finally, WebP is badly designed. Being necessarily RGB or RGBalpha, there is no way to save a monochrome grey image on single channel. We see that all the posterization here is made worse by magenta and green rings which come solely from the chroma subsampling. With a purely monochrome format saved on a single channel, you don’t introduce any additional chroma shift. It’s as bad as JPEG, but it could have been fixed. That’s what AVIF did, at least, but it won’t be a technical reality for at least another decade.</p>

<p>How do we solve that ?</p>

<ol>
<li>Stick to JPEG at 90 quality (or at least 85) if images matter to you, e.g. if you are a visual artist. If images are pretty decorations for your textual content, it doesn’t matter.</li>
<li>Always add dithering and/or a tiny bit of noise in your images, just to be sure smooth gradients will stay smooth no matter the amount of damage they will take from stupid websites recompressions.</li>
<li>Don’t convert your old JPEG to WebP even if every idiot around tells you to, unless you find the images shown above remotely acceptable.</li>
<li>Serve your images from a fast <a href="https://developer.mozilla.org/en-US/docs/Glossary/CDN">CDN</a>, use <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images">responsive image sizes</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading">image lazy loading</a> to improve loading speed and perceived responsiveness from the user/client side, but there is not much more you can do without damaging the quality of your images.</li>
<li>Avoid all the SaaS ways of converting your images on another server. On paper, they sound great because they relieve your own server from the conversion load, which is good on mutualized hostings. Except they cost, don’t disclose the actual quality factor they use, and don’t work in lots of cases (HTTP connections errors everywhere, especially if you have hardened WordPress with a security plugin). You would be better off with a better hosting and running conversions on your server straight with Image Magick/Graphics Magick (not the PHP interfaces, but directly the server program). There is a <a href="https://wordpress.org/plugins/imagemagick-engine/">WordPress plugin</a> that does just that.</li>
<li>Devs and techs really need to pull their head out of their arses and start discussing with actual artists to understand their challenges and priorities.</li>
<li>Devs and techs really need to get a grasp at basic probabilities because… average, really ?</li>
<li>We really need people able to have one foot in the tech world and the other in the art world, and being able to discuss with both worlds, because having them in two separate bubbles is damaging on a large scale right now, and I don’t see it improving.</li>
</ol>


</div></div></div></div></article>
				</div>
			</div>
			</section>

						
					</div>  <!-- fusion-row -->
				</main>  <!-- #main -->
				
				
								
					
		 <!-- fusion-footer -->

		
					
												</div> <!-- wrapper -->
		</div> <!-- #boxed-wrapper -->
				<a tabindex="-1" href="#" aria-hidden="true">Page load link</a>

		

			<section aria-labelledby="awb-to-top-label">
		<a href="#" id="toTop">
			<span id="awb-to-top-label">Go to Top</span>
		</a>
	</section>
		


</div>
  </body>
</html>
