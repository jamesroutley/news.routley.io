<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/yshavit/mdq">Original</a>
    <h1>Show HN: Jq-Like Tool for Markdown</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://github.com/yshavit/mdq/actions/workflows/coverage.yml?query=branch%3Amain"><img src="https://camo.githubusercontent.com/e00250a78d40dd1b59825a23f22254a4a45a693289697ee25aeb939e0d68c047/68747470733a2f2f696d672e736869656c64732e696f2f656e64706f696e743f75726c3d6874747073253341253246253246676973742e67697468756275736572636f6e74656e742e636f6d2532467973686176697425324635333930316130313135623539366530313561383931633431666230663235362532467261772532466d64712d636f7665726167652e6a736f6e" alt="Code Coverage" data-canonical-src="https://img.shields.io/endpoint?url=https%3A%2F%2Fgist.githubusercontent.com%2Fyshavit%2F53901a0115b596e015a891c41fb0f256%2Fraw%2Fmdq-coverage.json"/></a>
<a href="https://github.com/yshavit/mdq/actions/workflows/rust.yml?query=branch%3Amain"><img src="https://github.com/yshavit/mdq/actions/workflows/rust.yml/badge.svg" alt="Build status"/></a>
<a href="https://github.com/search?q=repo%3Ayshavit%2Fmdq+NOT+path%3A.github%2Fworkflows%2Fcoverage.yml+NOT+path%3AREADME.md+todo&amp;type=code"><img src="https://camo.githubusercontent.com/fa2d0ff288b4ea8442ba13e1a2d3e9723f2b7fb8f7f388140871cff364dda3bb/68747470733a2f2f696d672e736869656c64732e696f2f656e64706f696e743f75726c3d6874747073253341253246253246676973742e67697468756275736572636f6e74656e742e636f6d2532467973686176697425324665376139653965373236353164613064376432623166626265353632333764302532467261772532466d64712d746f646f732e6a736f6e" alt="Pending TODOs" data-canonical-src="https://img.shields.io/endpoint?url=https%3A%2F%2Fgist.githubusercontent.com%2Fyshavit%2Fe7a9e9e72651da0d7d2b1fbbe56237d0%2Fraw%2Fmdq-todos.json"/></a>
<a href="https://github.com/search?q=repo%3Ayshavit%2Fmdq+%28%28path%3A%2F%5C.rs%24%2F+%22%23%5Bignore%5D%22%29+OR+%28path%3Atests%2Fmd_cases+%2F%5Eignore%2F%29%29&amp;type=code"><img src="https://camo.githubusercontent.com/24b941eb55a662fac1b55cd6f1678fb3d2186c8a79241607d3d04bc4a4f75033/68747470733a2f2f696d672e736869656c64732e696f2f656e64706f696e743f75726c3d6874747073253341253246253246676973742e67697468756275736572636f6e74656e742e636f6d2532467973686176697425324637383261386463356637376432636634623163373734646137323633366630302532467261772532466d64712d69676e6f726564732e6a736f6e" alt="Ignored tests" data-canonical-src="https://img.shields.io/endpoint?url=https%3A%2F%2Fgist.githubusercontent.com%2Fyshavit%2F782a8dc5f77d2cf4b1c774da72636f00%2Fraw%2Fmdq-ignoreds.json"/></a></p>

<p dir="auto">mdq aims to do for Markdown what jq does for JSON: provide an easy way to zero in on specific parts of a document.</p>
<p dir="auto">For example, GitHub PRs are Markdown documents, and some organizations have specific templates with checklists for all
reviewers to complete. Enforcing these often requires ugly regexes that are a pain to write and worse to debug. Instead,
you can (for example) ask mdq for all uncompleted tasks:</p>

<p dir="auto">mdq is available under the Apache 2.0 or MIT licenses, at your option. I am open to other permissive licenses, if you
have one you prefer.</p>

<p dir="auto">Any of these will work:</p>
<ol dir="auto">
<li>
<div dir="auto" data-snippet-clipboard-copy-content="cargo install --git https://github.com/yshavit/mdq"><pre>cargo install --git https://github.com/yshavit/mdq</pre></div>
</li>
<li>Download binaries from <a href="https://github.com/yshavit/mdq/releases/latest">the latest release</a> (or any other release, of course).</li>
<li>You can also grab the binaries from the latest <a href="https://github.com/yshavit/mdq/actions/workflows/build-release.yml">build-release</a> workflow run. You must be logged into GitHub to do
that (this is GitHub&#39;s limitation, not mine). You&#39;ll have to <code>chmod +x</code> them before you can run them.</li>
</ol>
<details>
<summary>Security concerns</summary>
The release and latest-workflow binaries are built on GitHub&#39;s servers, so if you trust my code (and dependencies), and you trust GitHub,
you can trust the binaries. See <a href="https://github.com/yshavit/mdq/wiki/Release-binaries">https://github.com/yshavit/mdq/wiki/Release-binaries</a> for information on how to verify them.
 </details>

<p dir="auto">Simple example to select sections containing &#34;usage&#34;:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat example.md | mdq &#39;# usage&#39;"><pre>cat example.md <span>|</span> mdq <span><span>&#39;</span># usage<span>&#39;</span></span></pre></div>
<p dir="auto">Use pipe (<code>|</code>) to chain filters together. For example, to select sections containing &#34;usage&#34;, and within those find
all unordered list items:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat example.md | mdq &#39;# usage | -&#39;"><pre>cat example.md <span>|</span> mdq <span><span>&#39;</span># usage | -<span>&#39;</span></span></pre></div>
<p dir="auto">The filter syntax is designed to mirror Markdown syntax. You can select...</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Element</th>
<th>Syntax</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sections</td>
<td><code># title text</code></td>
</tr>
<tr>
<td>Lists</td>
<td><code>- unordered list item text</code></td>
</tr>
<tr>
<td>&#34;</td>
<td><code>1. ordered list item text</code></td>
</tr>
<tr>
<td>&#34;</td>
<td><code>- [ ] uncompleted task</code></td>
</tr>
<tr>
<td>&#34;</td>
<td><code>- [x] completed task</code></td>
</tr>
<tr>
<td>&#34;</td>
<td><code>- [?] any task</code></td>
</tr>
<tr>
<td>Links</td>
<td><code>[display text](url)</code></td>
</tr>
<tr>
<td>Images</td>
<td><code>![alt text](url)</code></td>
</tr>
<tr>
<td>Block quotes</td>
<td><code>&gt; block quote text</code></td>
</tr>
<tr>
<td>Code blocks</td>
<td><code> ```language &lt;code block text&gt;</code></td>
</tr>
<tr>
<td>Raw HTML</td>
<td><code>&lt;/&gt; html_tag</code></td>
</tr>
<tr>
<td>Plain paragraphs</td>
<td><code>P: paragraph text </code></td>
</tr>
<tr>
<td>Tables</td>
<td><code>:-: header text :-: row text</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">(Tables selection differs from other selections in that you can actually select only certain headers and rows, such that
the resulting element is of a different shape than the original. See the example below, or the wiki for more detail.)</p>
<p dir="auto">In any of the above, the text may be:</p>
<ul dir="auto">
<li>an <code>unquoted string</code> that starts with a letter; this is case-insensitive</li>
<li>a <code>&#34;quoted string&#34;</code> (either single or double quotes); this is case-sensitive</li>
<li>a string (quoted or unquoted) anchored by <code>^</code> or <code>$</code> (for start and end of string, respectively)</li>
<li>a <code>/regex/</code></li>
<li>omitted or <code>*</code>, to mean &#34;any&#34;</li>
</ul>
<p dir="auto">See the <a href="https://github.com/yshavit/mdq/wiki/Tutorial">tutorial</a> for a bit more detail, and <a href="https://github.com/yshavit/mdq/wiki/Full-User-Manual">user manual</a> for the full picture.</p>

<div dir="auto"><h3 tabindex="-1" dir="auto">Ensuring that people have searched existing issues before submitting a bug report</h3><a id="user-content-ensuring-that-people-have-searched-existing-issues-before-submitting-a-bug-report" aria-label="Permalink: Ensuring that people have searched existing issues before submitting a bug report" href="#ensuring-that-people-have-searched-existing-issues-before-submitting-a-bug-report"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Many projects have bug report templates that ask the submitter to attest that they&#39;ve checked existing issues for possible dupliates. In mdq, you can do:</p>
<div dir="auto" data-snippet-clipboard-copy-content="if echo &#34;$ISSUE_TEXT&#34; | mdq -q &#39;- [x] I have searched for existing issues&#39; ; then
  ..."><pre><span>if</span> <span>echo</span> <span><span>&#34;</span><span>$ISSUE_TEXT</span><span>&#34;</span></span> <span>|</span> mdq -q <span><span>&#39;</span>- [x] I have searched for existing issues<span>&#39;</span></span> <span>;</span> <span>then</span>
  ...</pre></div>
<p dir="auto">(The <code>-q</code> option is like grep&#39;s: it doesn&#39;t output anything to stdout, but exits 0 if any items were found, or non-0 otherwise.)</p>
<p dir="auto">This will match:</p>
<blockquote>
<ul>
<li> I have searched for existing issues</li>
</ul>
</blockquote>
<p dir="auto">... but will fail if the checkbox is unchecked:</p>
<blockquote>
<ul>
<li> I have searched for existing issues</li>
</ul>
</blockquote>
<div dir="auto"><h3 tabindex="-1" dir="auto">Extracting a referenced ticket</h3><a id="user-content-extracting-a-referenced-ticket" aria-label="Permalink: Extracting a referenced ticket" href="#extracting-a-referenced-ticket"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Some organizations use GitHub Actions to update their ticket tracker, if a PR mentions a ticket. You can use mdq to extract the link from Markdown as JSON, and then use jq to get the URL:</p>
<div dir="auto" data-snippet-clipboard-copy-content="TICKET_URL=&#34;$(echo &#34;$PR_TEXT&#34;
  | mdq --output json &#39;# Ticket | [](^https://tickets.example.com/[A-Z]+-\d+$)&#39;
  | jq -r &#39;.items[].link.url&#39;)&#34;"><pre>TICKET_URL=<span><span>&#34;</span><span><span>$(</span>echo <span><span>&#34;</span><span>$PR_TEXT</span><span>&#34;</span></span></span></span>
<span><span>  <span>|</span> mdq --output json <span><span>&#39;</span># Ticket | [](^https://tickets.example.com/[A-Z]+-\d+$)<span>&#39;</span></span></span></span>
<span><span>  <span>|</span> jq -r <span><span>&#39;</span>.items[].link.url<span>&#39;</span></span><span>)</span></span><span>&#34;</span></span></pre></div>
<p dir="auto">This will match Markdown like:</p>
<blockquote>

<p dir="auto"><a href="https://tickets.example.com/PROJ-1234" rel="nofollow">https://tickets.example.com/PROJ-1234</a></p>
</blockquote>
<div dir="auto"><h3 tabindex="-1" dir="auto">Whittling down a big table</h3><a id="user-content-whittling-down-a-big-table" aria-label="Permalink: Whittling down a big table" href="#whittling-down-a-big-table"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Let&#39;s say you have a table whose columns reference people in an on-call schedule, rows correspond to weeks in <code>YYYY-MM-DD</code> format:</p>
<blockquote>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>On-Call</th>
<th>Alice</th>
<th>Bob</th>
<th>Sam</th>
<th>Pat</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-01-08</td>
<td>x</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2024-01-15</td>
<td></td>
<td></td>
<td>x</td>
<td></td>
</tr>
<tr>
<td>2024-01-22</td>
<td></td>
<td>x</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
</blockquote>
<p dir="auto">To find out when Alice is on call:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat oncall.md | mdq &#39;:-: /On-Call|Alice/:-: *&#39;"><pre>cat oncall.md <span>|</span> mdq <span><span>&#39;</span>:-: /On-Call|Alice/:-: *<span>&#39;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="|  On-Call   | Alice |
|:----------:|:-----:|
| 2024-01-08 |   x   |
| 2024-01-15 |       |
| 2024-01-22 |       |"><pre><span>|</span>  On-Call   <span>|</span> Alice <span>|</span>
<span>|</span>:----------:<span>|</span>:-----:<span>|</span>
<span>|</span> 2024-01-08 <span>|</span>   x   <span>|</span>
<span>|</span> 2024-01-15 <span>|</span>       <span>|</span>
<span>|</span> 2024-01-22 <span>|</span>       <span>|</span></pre></div>
<p dir="auto">Or, to find out who&#39;s on call for the week of Jan 15:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cat oncall.md | mdq &#39;:-: * :-: 2024-01-15&#39;"><pre>cat oncall.md <span>|</span> mdq <span><span>&#39;</span>:-: * :-: 2024-01-15<span>&#39;</span></span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="|  On-Call   | Alice | Bob | Sam | Pat |
|:----------:|:-----:|:---:|:---:|----:|
| 2024-01-15 |       |     |  x  |     |"><pre><span>|</span>  On-Call   <span>|</span> Alice <span>|</span> Bob <span>|</span> Sam <span>|</span> Pat <span>|</span>
<span>|</span>:----------:<span>|</span>:-----:<span>|</span>:---:<span>|</span>:---:<span>|</span>----:<span>|</span>
<span>|</span> 2024-01-15 <span>|</span>       <span>|</span>     <span>|</span>  x  <span>|</span>     <span>|</span></pre></div>
</article></div></div>
  </body>
</html>
