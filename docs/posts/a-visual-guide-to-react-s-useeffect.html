<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://alexsidorenko.com/blog/useeffect/">Original</a>
    <h1>A Visual Guide to React&#39;s useEffect</h1>
    
    <div id="readability-page-1" class="page"><article><header><p>December 07, 2021</p></header><section><p>Here is what happens when you try to fetch data directly from the body of a functional component in React üëá</p>

<p>Why does this happen and what tools does React offer to solve this problem?</p>
<h2 id="side-effects">Side effects</h2>
<p>If your React component affects anything outside of itself, it‚Äôs called a side effect.</p>
<p><span>
      <span></span>
  <img alt="Example of side effects in React" title="Example of side effects in React" src="https://alexsidorenko.com/static/3af4fc361c972facf838dcb10eb0e851/f058b/side-effect-3.png" srcset="/static/3af4fc361c972facf838dcb10eb0e851/c26ae/side-effect-3.png 158w,
/static/3af4fc361c972facf838dcb10eb0e851/6bdcf/side-effect-3.png 315w,
/static/3af4fc361c972facf838dcb10eb0e851/f058b/side-effect-3.png 630w,
/static/3af4fc361c972facf838dcb10eb0e851/40601/side-effect-3.png 945w,
/static/3af4fc361c972facf838dcb10eb0e851/78612/side-effect-3.png 1260w,
/static/3af4fc361c972facf838dcb10eb0e851/df88b/side-effect-3.png 1906w" sizes="(max-width: 630px) 100vw, 630px" loading="lazy"/>
    </span></p>
<p>Side effects shouldn‚Äôt happen during component render. Therefore they do not belong to the body of a functional component. React has a special place for them. </p>
<p>To learn more about side effects and why they need a special treatment, check out this brilliant section in the new React documentation - <a target="_blank" rel="noreferrer" href="https://beta.reactjs.org/learn/keeping-components-pure">Keeping Components Pure</a>.</p>
<h2 id="dealing-with-side-effects">Dealing with side effects</h2>
<p>The special place for side effects is inside the <code>useEffect</code> hook. Hence the name.</p>
<blockquote>
<p>By using this Hook, you tell React that your component needs to do something after render. React will remember the function you passed (we‚Äôll refer to it as our ‚Äúeffect‚Äù), and call it later after performing the DOM updates.</p>
<p><a href="https://reactjs.org/docs/hooks-effect.html#example-using-hooks" target="_blank" rel="nofollow noopener noreferrer">React Docs - Using the Effect Hook</a></p>
</blockquote>
<p>Let‚Äôs try it with our initial component:</p>

<p>The <code>useEffect</code> does not run during the render. It runs after the render, which is what we want. But we still have the same problem. That‚Äôs because, by default, <code>useEffect</code> will run after every component render.</p>
<h2 id="running-effects-conditionally">Running effects conditionally</h2>
<p>There is a way to run effects conditionally, not after every render. The <code>useEffect</code> hook accepts the dependency list as a second argument. React will only re-run the effect if any dependency in the list changes. Let‚Äôs try it out:</p>

<p>When you pass an empty array as a dependency list, the effect will run only once, after the first render. It prevents the infinite loop from happening in our case. However, you might notice that our fetch function relies on the <code>props.id</code> .</p>
<h2 id="reacting-to-changes">Reacting to changes</h2>
<p>Let‚Äôs pick up where we left off and see what happens when we change the component‚Äôs props.</p>

<p>We would expect the component to react to prop change and fetch another product, but nothing happens. That‚Äôs because we have an empty dependency list. </p>
<p>If the side effect relies on any props or state variables, we should put them in the dependency list. After every render, React will check whether any dependency has changed, and if it did, will re-run the effect.</p>

<h2 id="next-chapter">Next Chapter</h2>
<p><a href="https://alexsidorenko.com/blog/useeffect-cleanups">A Visual Guide to useEffect - Cleanups</a></p></section></article></div>
  </body>
</html>
