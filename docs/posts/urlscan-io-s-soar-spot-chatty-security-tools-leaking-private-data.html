<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://positive.security/blog/urlscan-data-leaks">Original</a>
    <h1>Urlscan.io’s SOAR spot: Chatty security tools leaking private data</h1>
    
    <div id="readability-page-1" class="page"><div><ul role="list"><li>Sensitive URLs to shared documents, password reset pages, team invites, payment invoices and more are publicly listed and searchable on <a href="http://urlscan.io">urlscan.io</a>, a security tool used to analyze URLs</li><li>Part of the data has been leaked in an automated way by other security tools that accidentally made their scans public (as did GitHub earlier this year)</li><li>Users of such misconfigured Security Orchestration, Automation and Response (SOAR) tools have a high risk of their accounts being hijacked via manually triggered password resets</li><li>We are in no way affiliated with urlscan.io and just want to inform the public of its risk and potential in offensive security</li></ul><p>Most of our readers probably know <a href="https://en.wikipedia.org/wiki/Google_hacking">Google Dorks</a>. Some may have also searched through data in public S3 buckets or implemented a scraper for Pastebin. But are you familiar with <a href="http://urlscan.io">urlscan.io</a>, and what kind of data you can find there that is arguably even more private?</p><p>-- MARKDOWN --</p><p># Table of Contents</p><p>In February this year, GitHub sent an email to affected customers notifying them of a data breach. Specifically, users that enabled hosting via Github Pages for a private repository had the repository name leaked (together with their username).</p><p>There seems to be no public acknowledgement of this breach, and I was only made aware through a <a href="https://news.ycombinator.com/item?id=30348980">Hacker News post</a>, where the full email was posted.</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b6105403d961685fb29861_hn.png" loading="lazy" alt=""/></p></a></figure><p>So, how did that happen?</p><p>From the mail:</p><blockquote>GitHub learned from an internal discovery by a GitHub employee, that GitHub Pages sites published from private repositories on GitHub were being sent to <a href="http://urlscan.io">urlscan.io</a> for metadata analysis as part of an automated process</blockquote><p>GitHub responded to the breach by “<em>fixing the automated process that sends GitHub Pages sites for metadata analysis so that only public GitHub Pages sites are sent for analysis”</em> as well as asking the 3rd-party to delete the data.</p><p>Seeing that GitHub can make the mistake of accidentally listing their internal urlscan.io scans publicly, I thought the site could contain potential for more data leaks.</p><p>As I hadn’t heard of the site before, I decided to check it out.</p><p><a href="http://urlscan.io/">urlscan.io</a> describes itself as “a sandbox for the web”, where you can submit URLs which are then analyzed and scanned in various ways, mainly to detect malicious websites such as phishing sites. Besides analyzing the URLs submitted via the website, urlscan.io also scans URLs from public data sources and provides an API to integrate the check into other products. This last option is the one that lead to the systematic data leak of private repository URLs by GitHub.</p><h2>Lots of data</h2><p>At the time of writing, the landing page listed 124k public, 76k unlisted and 436k private scans performed within the last 24 hours.</p><p>It also includes one of those “recent scan” views that is typical for that kind of security scanning sites (e.g. compare with <a href="https://www.ssllabs.com/ssltest/">https://www.ssllabs.com/ssltest/</a>).</p><p>What is however more surprising is the option to search through all historical data (as an unauthenticated user) using the <a href="https://urlscan.io/docs/search/">extensive ElasticSearch Query String syntax</a>. This was also mentioned in GitHub’s notification mail:</p><blockquote>To view the name of the private repository on <a href="http://urlscan.io">urlscan.io</a>, you would need to have been looking at the front page of <a href="http://urlscan.io">urlscan.io</a> within approximately 30 seconds of the analysis being performed <strong>or have specifically searched using a query that would return the analysis in the search results.</strong></blockquote><p>For every scan result, the service provides a lot of information:</p><ul role="list"><li>The submitted URL (with all GET parameters)</li><li>The effective URL in case of a redirect</li><li>Any HTTP requests that were performed while scraping/scanning the URL</li><li>Information about the IPs and domains communicated with</li><li>A screenshot of the page taken at the time of the scan</li><li>The full HTML response of the site</li></ul><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b61064cfc6234bb5a1e0f3_urlscan_info.png" loading="lazy" alt=""/></p></a><figcaption>An OAuth2 redirect flow and other loaded resources captured on urlscan. The submitted URL also contains an UUID, which the web application might not expect to become public.</figcaption></figure><h2>Lots of integrations</h2><p><a href="https://urlscan.io/docs/integrations/">urlscan.io’s docs page</a> lists 26 commercial security solutions by vendors such as Palo Alto, Splunk, Rapid7, FireEye and ArcSight that have integrated the service via its API. GitHub, which is directly using this API internally as part of their SaaS offering, is missing from this list however, as are probably many more enterprise customers.</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62d092a9d38ec9048366c48a_urlscan_integrations.png" loading="lazy" alt=""/></p></a><figcaption>urlscan is integrated in a multitude of commercial security tools</figcaption></figure><p>If any of those tools/API users are accidentally performing public URL scans, this could lead to systematic data leakage. As those advanced security tools are mostly installed in large corporations and government organizations, leaked information could be particularly sensitive.</p><p>Besides commercial products, the integration page also lists 22 open-source projects, some of which are information gathering tools, and others are simple library implementations for easier querying of the API.</p><p>With the type of integration of this API (for example via a security tool that scans every incoming email and performs a urlscan on all links), and the amount of data in the database, there is a wide variety of sensitive data that can be searched for and retrieved by an anonymous user.</p><h2>urlscan.io dorks</h2><p>Please find below a collection of clickable “urlscan.io dorks” and (redacted) example results (please note that after reporting our findings to urlscan.io, they have added deletion rules for many of the below dorks so you might need to get a bit creative with the queries yourself):</p><h4><a href="https://urlscan.io/search/#page.url%3Apassword%20AND%20page.url%3Areset">Password reset links</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b611927d8adbebcdfde485_insta_pw_reset.png" loading="lazy" alt=""/></p></a><figcaption>An Instagram password reset confirmation page that requests the user to enter the new password twice</figcaption></figure><h4><a href="https://urlscan.io/search/#page.url%3Apassword%20AND%20page.url%3Acreate">Account creation links</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b6119f03d961040fb2bff1_zendesk_pw_reset.png" loading="lazy" alt=""/></p></a><figcaption>The initial password setup page for an NBC News account on Zendesk (a customer support and sales SaaS)</figcaption></figure><h4><a href="https://urlscan.io/search/#page.url%3Aapikey">API keys</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b612ca2f00918671eda8d5_virustotal_api_key.png" loading="lazy" alt=""/></p></a><figcaption>A link containing a valid VirusTotal API key</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Aapi.telegram.org">Telegram bots</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b612d23d21d07a5068ed83_telegram_bot.png" loading="lazy" alt=""/></p></a><figcaption>Telegram API URLs contain a long, secret identifier that can be used to call different <a href="https://telegram-bot-sdk.readme.io/reference/getme">API methods</a> on the bot</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Adocusign.net%20AND%20page.url%3ASigning%20AND%20page.url%3Ati">DocuSign signing requests</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b612daf61e916316428b19_docusign.png" loading="lazy" alt=""/></p></a><figcaption>DocuSign signing requests usually contain contractual documents with sensitive information</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Adrive.google.com">Shared Google Drive documents</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d8123f3172c645228b3f_gdrive_shared_folder.png" loading="lazy" alt=""/></p></a></figure><h4><a href="https://urlscan.io/search/#page.domain%3Adropbox.com%20AND%20page.url%3Atransfer">Dropbox file transfers</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d82a7b0b187ba873363c_dropbox_police.png" loading="lazy" alt=""/></p></a></figure><h4><a href="https://urlscan.io/search/#page.url%3Ainvitation%20AND%20page.domain%3Asharepoint.com">Sharepoint invites</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b616dc2f00917320edd77d_sharepoint_invite.png" loading="lazy" alt=""/></p></a><figcaption>As SharePoint workspaces are tied to organizations, the subdomain already gives a clue what the invite is for (in this case the &#34;Government of Ontario&#34;, as confirmed in the invite text)</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Adiscord.com%20AND%20page.url%3Ainvite">Discord invites</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b616e636589e583f5c13fc_discord_invite.png" loading="lazy" alt=""/></p></a><figcaption>The search query returns over 7k Discord invite codes for various communities</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Azoomgov.com">Government Zoom invites</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b616f04cc86858e0ed75d0_zoomgov.png" loading="lazy" alt=""/></p></a><figcaption>More sensitive than Discord invites might be Zoom invites, in particular to court hearings</figcaption></figure><h4><a href="https://urlscan.io/search/#page.url%3Arecordingservice">WebEx meeting recordings</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d83ea445bc10312eae2f_webex_recording.png" loading="lazy" alt=""/></p></a></figure><h4><a href="https://urlscan.io/search/#page.domain%3Apaypal.com%20AND%20page.url%3Ainvoice">PayPal invoices</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617023b830881c4a5cf81_paypal_invoice.png" loading="lazy" alt=""/></p></a><figcaption>A PayPal-hosted invoice obviously contains all the (personal) information needed for a valid invoice and can be retrieved by anyone that knows its ID. Please not however that <a href="https://krebsonsecurity.com/2022/08/paypal-phishing-scam-uses-invoices-sent-via-paypal/">those invoices are also used for spamming/scamming</a>.</figcaption></figure><h4><a href="https://urlscan.io/search/#page.url%3A%22transfer%2Fclaim-money%22">Paypal money claim requests</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617688f515005f60cc87d_paypal_claim.png" loading="lazy" alt=""/></p></a><figcaption>PayPal money claim requests &#34;only&#34; prefill the target&#39;s email address (together with the amount and recipient), leaking a bit less information than the invoice</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Adhl.de%20AND%20page.url%3Apiececode">Package tracking links</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b61773fb58ea03b147bbb3_package_tracking.png" loading="lazy" alt=""/></p></a><figcaption>Package tracking links for various postal services can be found as well. Interestingly, DHL seems to be aware of the risk of leaked tracking codes and asks for the recipient&#39;s ZIP code before showing their address. Note: With only 8k ZIP codes existing for locations in Germany, and the general area being known from the package trace, the code might be guessable</figcaption></figure><h4><a href="https://urlscan.io/search/#page.domain%3Aamazon.com%20AND%20page.url%3Agcx">Amazon gift delivery links</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d8c70fc47522fd3595d1_amazon_gift.png" loading="lazy" alt=""/></p></a><figcaption>Amazon gift delivery links leak the name of the giver and the gifted item.</figcaption></figure><h4><a href="https://urlscan.io/search/#page.url%3Aunsubscribe">Unsubscribe links</a></h4><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b6179c3aaf473327441172_hibp_unsubscribe.png" loading="lazy" alt=""/></p></a><figcaption>A HIBP unsbscribe link that would allow cancelling the breach notifications for a domain (Good: The domain itself is not shown on the page)</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617a738ce8f1cf2e795cc_paypal_unsubscribe.png" loading="lazy" alt=""/></p></a><figcaption>On the PayPal unsubscribe page, the user&#39;s email address is fully shown. Some other services at least partially redact the email address on unsubscribe pages</figcaption></figure><h2>Apple seems to have disappeared?</h2><p>Interestingly, when I performed my initial search back in February, I could find a lot of juicy URLs for Apple domains:</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62c4305f4a5b32a02cd8799b_apple_1.png" loading="lazy" alt=""/></p></a><figcaption>An Apple Developer ID activation page that allows setting the new password (seemingly a developer related to a Cancer Center)</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617b9c338e074425f9900_apple_2.png" loading="lazy" alt=""/></p></a><figcaption>An Apple ID finalization page that allows setting the password, seemingly for a Gamestop account</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d86eb0769527ed559f7f_apple_3.png" loading="lazy" alt=""/></p></a><figcaption>A Family Sharing invite, which allows the use of other&#39;s purchased subscriptions and might even give access to the family&#39;s photos and device&#39;s locations</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617c6bbb02578fca9ef14_apple_4.png" loading="lazy" alt=""/></p></a><figcaption>Invites for Enterprise-only online events</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617cce86364f6d215f120_apple_5.png" loading="lazy" alt=""/></p></a><figcaption>iCloud of course also has the option to create public sharing links, which were leaked via urlscan.io</figcaption></figure><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/6318d88b73ba27346c0f193b_apple_6.png" loading="lazy" alt=""/></p></a><figcaption>For iCloud Calendar invites, Apple seems to also create a link with all information</figcaption></figure><p>It seems like this information has in the meantime been hidden or deleted from the database:</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62b617dd2f00910b21ede53e_apple_deleted.png" loading="lazy" alt=""/></p></a><figcaption>Searching for any scans for apple.com (and its subdomains) now only returns 2 results</figcaption></figure><p>However, when continuously monitoring the <a href="https://urlscan.io/search/#page.domain%3Aapple.com">above result page</a>, sometimes some fresh additional entries can be spotted, which disappear again within around 10 minutes.</p><p>We later found out that Apple has in the meantime requested an exclusion of their domains from the scan results, which is implemented via periodically deleting all scan results matching certain rules.</p><p>Overall, the urlscan.io service contains a trove of sensitive information of various kinds, that can be used by hackers, spammers, or cyber criminals for example to take over accounts, perform identity theft, or run believable phishing campaigns.</p><p>We can see from the details of a scan result whether a scan was submitted via the API, but we can not find out which application or integration submitted the scan request.</p><p>For this, we had two options:</p><ul role="list"><li><strong>Contact affected users. </strong>Send mails to users with leaked email address to inform them of the leak and inquire about any security tooling that might be the culprit.</li><li><strong>Contact urlscan.io.</strong> Send a list of suspicious automated submissions and ask urlscan to investigate whether any integrations have the scan option accidentally set to public.</li></ul><p>We decided to do both and started contacting users while also collecting a list of scan results to send to urlscan.io.</p><h3>Contacting users</h3><p>We sent 23 mails to individuals whose email addresses were leaked in API-started scans (15 were from unsubscribe links, 5 from PayPal invoices, 2 from password reset links, and 1 from a PayPal claim).</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62c758a869abf940f19be8bd_notification_mail.png" loading="lazy" alt=""/></p></a><figcaption>Example mail sent out with a link to the corresponding urlscan result page and a test link at the bottom</figcaption></figure><p>At the end of the notification mails were &#34;bait links&#34; with unique UUIDs to test whether any URLs will be auto-submitted to urlscan.io. If that was the case, the unique token would allow us to associate the scan request back to a mail recipient.</p><p>Out of the 23 test links that we sent out, 9 (~40%) were submitted via the API to urlscan.io (most of them immediately after the corresponding mail was sent):</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62c720af372331304b6e53cc_pingbacks.png" loading="lazy" alt=""/></p></a><figcaption>Public results for the &#34;private&#34; test links included in the notification mails (please note that some URLs were scanned multiple times)</figcaption></figure><p>Without counting PayPal invoices (which might have actually <a href="https://krebsonsecurity.com/2022/08/paypal-phishing-scam-uses-invoices-sent-via-paypal/">been created as part of a scam campaign</a>), the success rate is 9 out of 18 (50%).</p><p>The next day we sent out another 24 mails to email addresses from <a href="https://urlscan.io/search/#page.domain%3Ahubspotemail.net%20AND%20page.url%3Aunsubscribe">leaked hubspot unsubscribe links </a>with 12 of them (50% again) triggering a public scan.</p><p>Those &#34;pingbacks&#34; show us several things:</p><ul role="list"><li>Our assumption of there being misconfigured security tools that submit any link received via mail as public scan to urlscan.io seems to be correct</li><li>Users of those misconfigured security tools are at a high risk of losing all of their online accounts (via a multi-step attack explained in the next section)</li><li>Seemingly low-severity urlscan.io findings (such as an email address from an unsubscribe link) can have critical impact</li></ul><p>For organizations where we found multiple email addresses or systematic leakage, we also tried contacting the IT/security department directly.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><a href="https://positive.security" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62d09f3c3a9c5f8fc30a0a76_Twitter_notification_2.png" loading="lazy" alt=""/></p></a><figcaption>When there was no answer or proper report contact, we also tried reaching out via Twitter</figcaption></figure><p>Unfortunately, neither did we receive any answer on any of the data leak notification mails to affected individuals nor could we get any feedback from organizations that seem to have a systematic problem.</p><p>With one exception: After sending one person a DocuSign link to their work contract, their employer reached out to us, started an investigation and awarded a bug bounty. They found the source of the leak to be &#34;a misconfiguration of [their] Security Orchestration, Automation and Response playbook for integration with urlscan.io, which was in active development&#34;.</p><h3>Contacting urlscan.io</h3><p>Without much feedback from affected users, we also explained the situation to urlscan.io.</p><p>In case the integration developers are following urlscan.io&#39;s docs (at least with regard to the following section), it should be quite easy for the urlscan.io team to identify the source software of the scan requests:</p><blockquote>‍<strong>Integrations</strong>: Use a custom HTTP user-agent string for your library/integration. Include a software version if applicable.</blockquote><p>We therefore asked, whether it would be possible for them to generate a list of user agents that triggered the scans related to the people we contacted, as well as for the scans of our own bait links, and if they would share that list with us - which they did!</p><p>In general, the urlscan.io team was very responsive and offered to investigate and work together with us to improve the current situation.</p><p>Reviewing the list of user agents revealed that many API integrations do not follow the above recommendation with more than half of the scans having been started with a generic &#34;python-requests/2.X.Y&#34; user agent.</p><p>The two solutions that could be easily identified via the user agents were:</p><ul role="list"><li><a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar">PaloAlto&#39;s XSOAR</a> </li><li><a href="https://swimlane.com/">Swimlane</a></li></ul><p>Further investigations on the API keys used to start scans with &#34;python-requests&#34; user agents revealed that many of them were also generated for PaloAlto&#39;s XSOAR (or &#34;Demisto&#34;, its former name). Others were generated for:</p><ul role="list"><li><a href="https://www.ibm.com/products/qradar-soar">IBM Resilient (now &#34;IBM Security QRadar SOAR&#34;)</a></li><li><a href="https://docs.splunk.com/Documentation/Phantom/4.10.7/User/Intro">Splunk Phantom (now &#34;Splunk SOAR&#34;)</a></li><li><a href="https://www.dimensiondata.com/en-gb/solutions/intelligent-security/">DimensionData&#39;s SOAR</a></li></ul><h4><strong>So how exactly did the data end up there?</strong></h4><p>-- MARKDOWN --</p><p>Security Orchestration, Automation and Response (SOAR) platforms allow organizations to write their own playbooks to connect different data sources with security tools and services. To ease development, the platforms offer integrations with several 3rd-party services, e.g. via [this XSOAR urlscan.io pack](https://cortex.marketplace.pan.dev/marketplace/details/UrlScan/). With this pack installed, a playbook could extract URLs from incoming emails and submit them to urlscan with the command `!url url=https://example.com using=&#34;urlscan.io&#34;` with optional parameters for e.g. the timeout and scan visibility.</p><p>The visibility of such a scan is then dependent on</p><p>Therefore, a scan can be be wrongfully submitted as public</p><p>-- /MARKDOWN --</p><blockquote>The argument [ ...] had been configured to have a default value of <em>public</em>, and this argument overrides all other settings related to visibility. [...] Consequently, for all command invocations that did not explicitly provide a value for this newly introduced argument, all scans have since been executed with visibility public.</blockquote><h4><strong>Response</strong></h4><p>As a result of our findings, urlscan.io reached out to customers who they identified as submitting a significant amount of public scans and started reviewing popular third-party integrations such as for SOAR tools to ensure they respect the user intent with regards to visibility.</p><p>Furthermore, they implemented the following changes:</p><ul role="list"><li>Added deletion rules for dorks presented here to periodically delete scan results matching the search patterns</li><li>Highlighted the default visibility setting in the UI</li><li>Added an option to set a team-wide maximum visibility</li></ul><p>urlscan.io also published <a href="https://urlscan.io/blog/2022/07/27/scan-visibility-best-practices/">a blog post titled &#34;Scan Visibility Best Practices&#34;</a> that explains scan visibility settings, encourages users to frequently review their submissions and details urlscan&#39;s efforts to prevent such leaks.</p><p>In case sensitive data is still leaked, they offer the following options:</p><ul role="list"><li><strong>Affected users</strong> can report scan results with sensitive data via the &#34;Report&#34; button which immediately deactivates them</li><li><strong>Companies</strong> that wish to have their domains or specific URL patterns excluded from scanning (or corresponding existing results deleted) can contact urlscan.io. This is also how the Apple results had disappeared</li><li><strong>Security researchers</strong> that found systematic leakage are also asked to reach out to urlscan.io</li></ul><p>While passively searching through historical urlscan.io data already uncovers a trove of sensitive information, combining it with &#34;active probing&#34; can greatly increase the impact of any small leak.</p><p>As we have seen earlier, for around 50% of the users that have an unsubscribe link leaked in urlscan.io, any link in any incoming email will be immediately submitted to urlscan as a public scan.</p><p>We can find those misconfigured clients by scraping urlscan.io for email addresses (e.g. in unsubscribe pages or even just in the URL itself), sending them a &#34;bait link&#34; via mail and subsequently checking urlscan.io for the link.</p><p>By actively triggering password resets for the affected email addresses at various web services such as social media sites, other email providers or banks, and then checking for recent scan results for the corresponding domains in the urlscan database, we can exploit this behavior to take over those user&#39;s accounts. Searching additional data leaks e.g. using <a href="https://haveibeenpwned.com">HaveIBeenPwned</a> for those email addresses might also provide hints which services the users are registered at.</p><p>For company email addresses, custom login portals and popular enterprise SaaS can be particularly interesting to find existing accounts at and trigger password resets for.</p><p>And even if no account exists yet at a specific service, just creating a new one with a corporate email address might <a href="https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c">provide access to the company&#39;s internal data stored on that service</a>.</p><p>The following graphic illustrates all the necessary steps to perform the account takeover attack:</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><a href="https://positive.security/#zoom" target="_blank"><p><img src="https://uploads-ssl.webflow.com/5f6498c074436c349716e747/62c75134e3b100af89706a78_multi-step-account-takeover.png" loading="lazy" alt=""/></p></a><figcaption>Combining a passive search with active probing for misconfigured clients and triggering of password resets can greatly increase the impact of any single urlscan.io leak</figcaption></figure><p><strong>As owner of a web service</strong>, you can make sure that you’re expiring password reset and similar links quickly and are not leaking unnecessary information to unauthenticated users via links that could become public. On an unsubscribe page, redact the user’s email address, and ask for additional authentication/information before showing PII (like many package tracking websites nowadays ask for a ZIP code before showing the full address). When implementing API authentication, do not accept API keys via GET parameters and instead require the usage of a separate HTTP header.</p><p>Furthermore, you can also search <a href="http://urlscan.io">urlscan.io</a> as well as other services yourself for any data leaks regarding your own web service or organization, request deletions/exclusions and e.g. disable and rotate any leaked API keys of your users.</p><p><strong>urlscan.io users/security teams that integrate the service</strong> should review their command, integration and account visibility settings, keep their integrations up to date, regularly review <a href="https://urlscan.io/search/#user%3Ame%20OR%20team%3Ame">their submitted scans</a> and check the urlscan.io <a href="https://urlscan.io/blog/2022/07/27/scan-visibility-best-practices/">blog post</a> for more information.</p><p>We have shown that the service <a href="http://urlscan.io">urlscan.io</a>, which usually helps protect users, also stores sensitive information of those users, some of which is publicly available and can be searched through by attackers.</p><p>This information could be used by spammers to collect email addresses and other personal information. It could be used by cyber criminals to take over accounts and run believable phishing campaigns. And it could also be used by red teamers and security researchers to find hidden admin portals, gain a first foothold or find potential targets.</p><p>Similar to Google Dorking or the <a href="https://buckets.grayhatwarfare.com/">search through public S3 buckets</a>, “urlscan.io mining” reveals a lot of information that was not meant to be public. The difference is, that the information that can be found via Google or that is in a public S3 buckets actually is already public, while the URLs submitted to urlscan.io for public scanning might contain authentication tokens and originate from a private email to an individual, submitted by a security solution. It’s a case where the introduction of additional security tooling can actually degrade a system&#39;s security.</p><p>The docs do warn of personally identifiable information in the submitted URLs, but only suggest to mark those scans as <em>Unlisted</em> (instead of <em>Private</em>):</p><blockquote><strong>TAKE CARE</strong> to remove PII from URLs or submit these scans as <em>Unlisted</em>, e.g. when there is an email address in the URL.</blockquote><p>Those unlisted scans are at least still “visible to vetted security researchers and security companies in [the] urlscan Pro platform”. Furthermore, this warning does not address the risk of PII in the returned page instead of in the URL itself.</p><p>The <a href="https://urlscan.io/pricing/">pricing and API quotas</a> also heavily favor the use of public scans and the service does not (effectively) proactively prevent the leakage of PII (e.g. a simple search for <a href="https://urlscan.io/search/#page.url%3A%40gmail.com">page.url:@gmail.com</a> returns the maximum number of 10000 results).</p><p>However, the urlscan.io team has been very responsive to our report, supported the investigation, published a blog post to educate their users and implemented software and process changes to reduce the number of leaks.</p><p>-- MARKDOWN --</p><p>-- /MARKDOWN --</p><p>‍</p></div></div>
  </body>
</html>
