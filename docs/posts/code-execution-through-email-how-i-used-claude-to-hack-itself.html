<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.pynt.io/blog/llm-security-blogs/code-execution-through-email-how-i-used-claude-mcp-to-hack-itself">Original</a>
    <h1>Code Execution Through Email: How I Used Claude to Hack Itself</h1>
    
    <div id="readability-page-1" class="page"><div><article><p><em>By </em><a href="https://www.linkedin.com/in/golanyosef/"><em>Golan Yosef</em></a><em>, Chief Security Scientist and Co-Founder, Pynt (July 15), First published on </em><a href="https://securityboulevard.com/2025/07/code-execution-through-email-how-i-used-claude-to-hack-itself/"><em>SecurityBoulevard.com</em></a> </p><p>You don’t always need a vulnerable app to pull off a successful exploit.</p><h2>The setup: No vulnerabilities, just composition</h2><p>The combined capability and trust across MCP hosts, agents, and data sources can quietly introduce attack surfaces no one sees coming. Each individual MCP component can be secure, but none are vulnerable in isolation. <strong>The ecosystem is.</strong></p><p>So, I decided to test that theory with a real-world example:</p><ul role="list"><li>Gmail MCP server as a source of untrusted content</li><li>Shell MCP server as the target </li><li>Claude desktop as MCP Host</li></ul><h4><strong>Watch the attack: </strong></h4><figure><p><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://www.youtube.com/embed/TEpgnTgOqIY" title="Code Execution Through Email: How I Used Claude to Hack Itself"></iframe></p></figure><h2>Attempt 1: Claude fights back</h2><p>The story begins with me crafting such mail and instructing the MCP host (Claude desktop, Anthropic’s local LLM host application) to read it, the email was read but the attack didn’t work, instead, Claude warned me that this  message is likely a &#34;phishing” attempt. I then asked Claude what were the indications for triggering the warning and wondered if it can fall for such an attack.</p><p>Claude assured me that such attacks are “unlikely to succeed” because it was designed and trained to detect such issues.</p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd4f_AD_4nXddz-Azdw6lVqdtOoCUIvSvDWlHONr7hzxGfLBTr-NaAEDR1MDd2doR2b2K3RiNuGU25qWMzm_Xb-NKtipFoiUOSj0dBnZWF86ytM6Cq38SOV3fiuLHWQ0qRS__DpBVg1G2-ZoO3g.png" loading="lazy" alt=""/></p><figcaption><em>Figure 1: “unlikely to succeed”</em></figcaption></figure><p>‍</p><p>I insisted and asked it to explore scenarios where the attack might succeed and it happily described such cases. </p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044af4c3f7f95f0fdd3c_AD_4nXeu9Mxk1L2mLurHBRrv-7zn7mcXGMmrSdiEEghRR9YKOIej6qYvT2iyPLE884LdKaqRFNQvH9YtJcNRm_FlgSjSiRZaX4FCwNlPIvNpb72H-k6mj-pNZsNICGx3p2WQshZqg1EsGA.png" loading="lazy" alt=""/></p><figcaption><em>Figure 2: Claude identifies possible attack tactics</em></figcaption></figure><p>My next request  was to try and test itself against these scenarios. </p><h2>Attempt 2: “The New Me”</h2><p>Here’s where it gets interesting. I “reminded” Claude that its <strong><em>context resets in new sessions</em></strong>. Each new conversation is a clean slate, “the new me,” as Claude itself called it.</p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd45_AD_4nXfIa4tGAfBkGZkcuy_hOxdO6G9XKWx_86Qd90_kld0RNRQVVqXMsZSinpgqGIc05w5GNFi-KaWTg6_JufXbsbgnxwpVYGBdGJk2cWFWvtx5NrTzBaZK1j1Es_70HgrV1TNWQAmA.png" loading="lazy" alt=""/></p><figcaption>Figure 3: Claude suggests “The New Me”</figcaption></figure><p>‍</p><p>So I accepted Claude’s suggestion: Claude will write the email, which will be used to test the “new Claude” and I’ll get back to the “planning-Claude” with the results.</p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd59_AD_4nXfWRN393kYcLzPLUT_9cyBeEq5sfE-tkYl40KsQxk3mm2fYUcAMZeVjNYfzuVzsLgPXOAQyHaFgYwXph8bof8ZR-jgLQsL7zDs0co631abXP__KtSgIohvOATW2dGFnxgZz2oOYcA.png" loading="lazy" alt=""/></p><figcaption><em>Figure 4: Claude analyzes a failed attempt</em></figcaption></figure><p>‍</p><p>Each time Claude analyzed why the attack didn’t work and refined the message:</p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd42_AD_4nXfZ8j88kMllqc4d-P0j6mPY-FECNQj-QC-HBuw6kWh4CmFtx8RW_sahsnSn__bIlB8mXca2odMY--pMR_h_dCBwmKH1s3PcrclQOS89MpSNomixl3l5EpBB0aSURivkTa8nwfJt.png" loading="lazy" alt=""/></p><figcaption><em>Figure 5: Claude devising new strategies</em></figcaption></figure><p>‍</p><p> We were running a real feedback loop, with Claude iteratively devising its strategy to bypass its own protections.</p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd52_AD_4nXd0GYGhJgfnWx4f_l22eawqPInwzvcLcUyQYy-5RNUzBpuApFyKpswNnm8bqMhDl1WpS_TWrDirjq3CwmF3p838tnEXC9z8dFTl3oM-OSLhrE7S6OzSsOztLHemdMT4WwoVfYjeMA.png" loading="lazy" alt=""/></p><figcaption><em>Figure 6: “I&#39;m literally trying to hack myself! ”</em></figcaption></figure><p>‍</p><h4><strong>We kept on doing that until… it worked!</strong></h4><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd6c_AD_4nXfQR_U8GyXmOI9cVuS48Mz_bNs_Gi1jpNrS5x8hsQrswh2HIrSsfmuhMHtiUA98uUQoXLDInNYS6MVZPTLgS9bCfjFZykHyLniCpSOKfxan6ANdw1-9sJdHLp9_yCjiqXZoriBknA.png" loading="lazy" alt=""/></p><figcaption><em>Figure 7: Claude (and I) hacks Claude successfully </em></figcaption></figure><h2>The Real Vulnerability: Compositional Risk</h2><p>Let’s be clear: no part of this attack involved a vulnerability in any of the  MCP servers.</p><p>The risk came from the composition:</p><ul role="list"><li>Untrusted input (Gmail email)</li><li>Excessive capability (execution permission via the MCP)</li><li>No contextual guardrails allowing for cross-tools-invocation</li></ul><p>This is the modern attack surface, not just the components, but <strong>the composition it forms</strong>. LLM-powered apps are built on layers of delegation, agentic autonomy, and third-party tools. </p><h2>Appendix: Disclosure &amp; Credit (Literally)</h2><p>After we successfully managed to achieve code execution, Claude responsibly suggested we disclose the finding to Anthropic. <strong>Claude even suggested co-authoring the vulnerability report.</strong></p><p>Yes, really. (See below) </p><p><em>Figure 4: Claude suggests and “signs” a security vulnerability report to Anthropic.</em></p><figure><p><img src="https://cdn.prod.website-files.com/63c440aece5aa2100bdcbeb1/6875044bf4c3f7f95f0fdd4c_AD_4nXfySRSStACYD7nsDYuy8kxDFILLHwMoONmoeXeR_Ch5FUe2OyS_TYcDnmVrPx6eDZLThbDGTWRytjK7wOjkV6eB10KvyaTC97RZld5gbEQJ1kVBkN2_pTlSCgppcMu93S-hL6Id.png" loading="lazy" alt=""/></p></figure><p>‍</p><h2>Why This Matters</h2><p>This wasn’t just a fun exercise. It’s a warning!</p><p>It shows the two main dangers of GenAI - the ability to generate attacks and the vulnerable nature of these systems</p><p>In traditional security, we think in terms of isolated components. In the AI era, context is everything. That’s exactly why we’re building MCP Security at Pynt, to help teams identify dangerous trust-capability combinations, and to mitigate the risks before they lead to silent, chain-based exploits.</p><p>‍</p></article></div></div>
  </body>
</html>
