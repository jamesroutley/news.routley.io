<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/gorhill/uBlock/commit/a559f5f2715c58fea4de09330cf3d06194ccc897">Original</a>
    <h1>“UBO Minus (MV3)” – An Experimental uBlock Origin Build for Manifest V3</h1>
    
    <div id="readability-page-1" class="page"><div data-tab-size="8" data-diff-anchor="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9c" data-paste-markdown-skip="">
              
              <tbody>
                    
      <tr data-position="0">
    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cHL0" data-line-number="..."></td>
    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cHR1" data-line-number="..."></td>
    <td>@@ -0,0 +1,235 @@</td>
  </tr>

    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR1" data-line-number="1"></td>

  <td>
    <span data-code-marker="+"><span>/*******************************************************************************</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR2" data-line-number="2"></td>

  <td>
    <span data-code-marker="+"><span></span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR3" data-line-number="3"></td>

  <td>
    <span data-code-marker="+"><span>    uBlock Origin - a browser extension to block requests.</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR4" data-line-number="4"></td>

  <td>
    <span data-code-marker="+"><span>    Copyright (C) 2022-present Raymond Hill</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR5" data-line-number="5"></td>

  <td>
    <span data-code-marker="+"><span></span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR6" data-line-number="6"></td>

  <td>
    <span data-code-marker="+"><span>    This program is free software: you can redistribute it and/or modify</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR7" data-line-number="7"></td>

  <td>
    <span data-code-marker="+"><span>    it under the terms of the GNU General Public License as published by</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR8" data-line-number="8"></td>

  <td>
    <span data-code-marker="+"><span>    the Free Software Foundation, either version 3 of the License, or</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR9" data-line-number="9"></td>

  <td>
    <span data-code-marker="+"><span>    (at your option) any later version.</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR10" data-line-number="10"></td>

  <td>
    <span data-code-marker="+"><span></span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR11" data-line-number="11"></td>

  <td>
    <span data-code-marker="+"><span>    This program is distributed in the hope that it will be useful,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR12" data-line-number="12"></td>

  <td>
    <span data-code-marker="+"><span>    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR13" data-line-number="13"></td>

  <td>
    <span data-code-marker="+"><span>    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR14" data-line-number="14"></td>

  <td>
    <span data-code-marker="+"><span>    GNU General Public License for more details.</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR15" data-line-number="15"></td>

  <td>
    <span data-code-marker="+"><span></span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR16" data-line-number="16"></td>

  <td>
    <span data-code-marker="+"><span>    You should have received a copy of the GNU General Public License</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR17" data-line-number="17"></td>

  <td>
    <span data-code-marker="+"><span>    along with this program.  If not, see {http://www.gnu.org/licenses/}.</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR18" data-line-number="18"></td>

  <td>
    <span data-code-marker="+"><span></span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR19" data-line-number="19"></td>

  <td>
    <span data-code-marker="+"><span>    Home: https://github.com/gorhill/uBlock</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR20" data-line-number="20"></td>

  <td>
    <span data-code-marker="+"><span>*/</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR21" data-line-number="21"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR22" data-line-number="22"></td>

  <td>
    <span data-code-marker="+"><span>&#39;use strict&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR23" data-line-number="23"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR24" data-line-number="24"></td>

  <td>
    <span data-code-marker="+"><span>/******************************************************************************/</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR25" data-line-number="25"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR26" data-line-number="26"></td>

  <td>
    <span data-code-marker="+"><span>import</span> <span>fs</span> <span>from</span> <span>&#39;fs/promises&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR27" data-line-number="27"></td>

  <td>
    <span data-code-marker="+"><span>import</span> <span>process</span> <span>from</span> <span>&#39;process&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR28" data-line-number="28"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR29" data-line-number="29"></td>

  <td>
    <span data-code-marker="+"><span>import</span> <span>rulesetConfigs</span> <span>from</span> <span>&#39;./ruleset-config.js&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR30" data-line-number="30"></td>

  <td>
    <span data-code-marker="+"><span>import</span> <span>{</span> <span>dnrRulesetFromRawLists</span> <span>}</span> <span>from</span> <span>&#39;./js/static-dnr-filtering.js&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR31" data-line-number="31"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR32" data-line-number="32"></td>

  <td>
    <span data-code-marker="+"><span>/******************************************************************************/</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR33" data-line-number="33"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR34" data-line-number="34"></td>

  <td>
    <span data-code-marker="+"><span>const</span> <span>commandLineArgs</span> <span>=</span> <span>(</span><span>(</span> <span>)</span> <span>=&gt;</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR35" data-line-number="35"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>args</span> <span>=</span> <span>new</span> <span>Map</span><span>(</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR36" data-line-number="36"></td>

  <td>
    <span data-code-marker="+">    <span>let</span> <span>name</span><span>,</span> <span>value</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR37" data-line-number="37"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> <span>(</span> <span>const</span> <span>arg</span> <span>of</span> <span>process</span><span>.</span><span>argv</span><span>.</span><span>slice</span><span>(</span><span>2</span><span>)</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR38" data-line-number="38"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>pos</span> <span>=</span> <span>arg</span><span>.</span><span>indexOf</span><span>(</span><span>&#39;=&#39;</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR39" data-line-number="39"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>pos</span> <span>===</span> <span>-</span><span>1</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR40" data-line-number="40"></td>

  <td>
    <span data-code-marker="+">            <span>name</span> <span>=</span> <span>arg</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR41" data-line-number="41"></td>

  <td>
    <span data-code-marker="+">            <span>value</span> <span>=</span> <span>&#39;&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR42" data-line-number="42"></td>

  <td>
    <span data-code-marker="+">        <span>}</span> <span>else</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR43" data-line-number="43"></td>

  <td>
    <span data-code-marker="+">            <span>name</span> <span>=</span> <span>arg</span><span>.</span><span>slice</span><span>(</span><span>0</span><span>,</span> <span>pos</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR44" data-line-number="44"></td>

  <td>
    <span data-code-marker="+">            <span>value</span> <span>=</span> <span>arg</span><span>.</span><span>slice</span><span>(</span><span>pos</span><span>+</span><span>1</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR45" data-line-number="45"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR46" data-line-number="46"></td>

  <td>
    <span data-code-marker="+">        <span>args</span><span>.</span><span>set</span><span>(</span><span>name</span><span>,</span> <span>value</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR47" data-line-number="47"></td>

  <td>
    <span data-code-marker="+">    <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR48" data-line-number="48"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>args</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR49" data-line-number="49"></td>

  <td>
    <span data-code-marker="+"><span>}</span><span>)</span><span>(</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR50" data-line-number="50"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR51" data-line-number="51"></td>

  <td>
    <span data-code-marker="+"><span>/******************************************************************************/</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR52" data-line-number="52"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR53" data-line-number="53"></td>

  <td>
    <span data-code-marker="+"><span>async</span> <span>function</span> <span>main</span><span>(</span><span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR54" data-line-number="54"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR55" data-line-number="55"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>writeOps</span> <span>=</span> <span>[</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR56" data-line-number="56"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>ruleResources</span> <span>=</span> <span>[</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR57" data-line-number="57"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>regexRuleResources</span> <span>=</span> <span>[</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR58" data-line-number="58"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>outputDir</span> <span>=</span> <span>commandLineArgs</span><span>.</span><span>get</span><span>(</span><span>&#39;output&#39;</span><span>)</span> <span>||</span> <span>&#39;.&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR59" data-line-number="59"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR60" data-line-number="60"></td>

  <td>
    <span data-code-marker="+">    <span>let</span> <span>goodTotalCount</span> <span>=</span> <span>0</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR61" data-line-number="61"></td>

  <td>
    <span data-code-marker="+">    <span>let</span> <span>maybeGoodTotalCount</span> <span>=</span> <span>0</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR62" data-line-number="62"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR63" data-line-number="63"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>output</span> <span>=</span> <span>[</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR64" data-line-number="64"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>log</span> <span>=</span> <span>(</span><span>text</span><span>,</span> <span>silent</span> <span>=</span> <span>false</span><span>)</span> <span>=&gt;</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR65" data-line-number="65"></td>

  <td>
    <span data-code-marker="+">        <span>output</span><span>.</span><span>push</span><span>(</span><span>text</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR66" data-line-number="66"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>silent</span> <span>===</span> <span>false</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR67" data-line-number="67"></td>

  <td>
    <span data-code-marker="+">            <span>console</span><span>.</span><span>log</span><span>(</span><span>text</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR68" data-line-number="68"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR69" data-line-number="69"></td>

  <td>
    <span data-code-marker="+">    <span>}</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR70" data-line-number="70"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR71" data-line-number="71"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>replacer</span> <span>=</span> <span>(</span><span>k</span><span>,</span> <span>v</span><span>)</span> <span>=&gt;</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR72" data-line-number="72"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>k</span><span>.</span><span>startsWith</span><span>(</span><span>&#39;__&#39;</span><span>)</span> <span>)</span> <span>{</span> <span>return</span><span>;</span> <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR73" data-line-number="73"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>Array</span><span>.</span><span>isArray</span><span>(</span><span>v</span><span>)</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR74" data-line-number="74"></td>

  <td>
    <span data-code-marker="+">            <span>return</span> <span>v</span><span>.</span><span>sort</span><span>(</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR75" data-line-number="75"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR76" data-line-number="76"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>v</span> <span>instanceof</span> <span>Object</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR77" data-line-number="77"></td>

  <td>
    <span data-code-marker="+">            <span>const</span> <span>sorted</span> <span>=</span> <span>{</span><span>}</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR78" data-line-number="78"></td>

  <td>
    <span data-code-marker="+">            <span>for</span> <span>(</span> <span>const</span> <span>kk</span> <span>of</span> <span>Object</span><span>.</span><span>keys</span><span>(</span><span>v</span><span>)</span><span>.</span><span>sort</span><span>(</span><span>)</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR79" data-line-number="79"></td>

  <td>
    <span data-code-marker="+">                <span>sorted</span><span>[</span><span>kk</span><span>]</span> <span>=</span> <span>v</span><span>[</span><span>kk</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR80" data-line-number="80"></td>

  <td>
    <span data-code-marker="+">            <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR81" data-line-number="81"></td>

  <td>
    <span data-code-marker="+">            <span>return</span> <span>sorted</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR82" data-line-number="82"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR83" data-line-number="83"></td>

  <td>
    <span data-code-marker="+">        <span>return</span> <span>v</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR84" data-line-number="84"></td>

  <td>
    <span data-code-marker="+">    <span>}</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR85" data-line-number="85"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR86" data-line-number="86"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isUnsupported</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR87" data-line-number="87"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>_error</span> <span>!==</span> <span>undefined</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR88" data-line-number="88"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isRegex</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR89" data-line-number="89"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>condition</span> <span>!==</span> <span>undefined</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR90" data-line-number="90"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>condition</span><span>.</span><span>regexFilter</span> <span>!==</span> <span>undefined</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR91" data-line-number="91"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isRedirect</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR92" data-line-number="92"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span> <span>!==</span> <span>undefined</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR93" data-line-number="93"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span><span>.</span><span>type</span> <span>===</span> <span>&#39;redirect&#39;</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR94" data-line-number="94"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span><span>.</span><span>redirect</span><span>.</span><span>extensionPath</span> <span>!==</span> <span>undefined</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR95" data-line-number="95"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isCsp</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR96" data-line-number="96"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span> <span>!==</span> <span>undefined</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR97" data-line-number="97"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span><span>.</span><span>type</span> <span>===</span> <span>&#39;modifyHeaders&#39;</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR98" data-line-number="98"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isRemoveparam</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR99" data-line-number="99"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span> <span>!==</span> <span>undefined</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR100" data-line-number="100"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span><span>.</span><span>type</span> <span>===</span> <span>&#39;redirect&#39;</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR101" data-line-number="101"></td>

  <td>
    <span data-code-marker="+">        <span>rule</span><span>.</span><span>action</span><span>.</span><span>redirect</span><span>.</span><span>transform</span> <span>!==</span> <span>undefined</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR102" data-line-number="102"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>isGood</span> <span>=</span> <span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR103" data-line-number="103"></td>

  <td>
    <span data-code-marker="+">        <span>isUnsupported</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR104" data-line-number="104"></td>

  <td>
    <span data-code-marker="+">        <span>isRedirect</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR105" data-line-number="105"></td>

  <td>
    <span data-code-marker="+">        <span>isCsp</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR106" data-line-number="106"></td>

  <td>
    <span data-code-marker="+">        <span>isRemoveparam</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR107" data-line-number="107"></td>

  <td>
    <span data-code-marker="+">        <span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR108" data-line-number="108"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR109" data-line-number="109"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>rulesetDir</span> <span>=</span> <span>`<span><span>${</span><span>outputDir</span><span>}</span></span>/rulesets`</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR110" data-line-number="110"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>rulesetDirPromise</span> <span>=</span> <span>fs</span><span>.</span><span>mkdir</span><span>(</span><span>`<span><span>${</span><span>rulesetDir</span><span>}</span></span>`</span><span>,</span> <span>{</span> <span>recursive</span>: <span>true</span> <span>}</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR111" data-line-number="111"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR112" data-line-number="112"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>fetchList</span> <span>=</span> <span>url</span> <span>=&gt;</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR113" data-line-number="113"></td>

  <td>
    <span data-code-marker="+">        <span>return</span> <span>fetch</span><span>(</span><span>url</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR114" data-line-number="114"></td>

  <td>
    <span data-code-marker="+">            <span>.</span><span>then</span><span>(</span><span>response</span> <span>=&gt;</span> <span>response</span><span>.</span><span>text</span><span>(</span><span>)</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR115" data-line-number="115"></td>

  <td>
    <span data-code-marker="+">            <span>.</span><span>then</span><span>(</span><span>text</span> <span>=&gt;</span> <span>(</span><span>{</span> <span>name</span>: <span>url</span><span>,</span> text <span>}</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR116" data-line-number="116"></td>

  <td>
    <span data-code-marker="+">    <span>}</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR117" data-line-number="117"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR118" data-line-number="118"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>readList</span> <span>=</span> <span>path</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR119" data-line-number="119"></td>

  <td>
    <span data-code-marker="+">        <span>fs</span><span>.</span><span>readFile</span><span>(</span><span>path</span><span>,</span> <span>{</span> <span>encoding</span>: <span>&#39;utf8&#39;</span> <span>}</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR120" data-line-number="120"></td>

  <td>
    <span data-code-marker="+">            <span>.</span><span>then</span><span>(</span><span>text</span> <span>=&gt;</span> <span>(</span><span>{</span> <span>name</span>: <span>path</span><span>,</span> text <span>}</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR121" data-line-number="121"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR122" data-line-number="122"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>writeFile</span> <span>=</span> <span>(</span><span>path</span><span>,</span> <span>data</span><span>)</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR123" data-line-number="123"></td>

  <td>
    <span data-code-marker="+">        <span>rulesetDirPromise</span><span>.</span><span>then</span><span>(</span><span>(</span> <span>)</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR124" data-line-number="124"></td>

  <td>
    <span data-code-marker="+">            <span>fs</span><span>.</span><span>writeFile</span><span>(</span><span>path</span><span>,</span> <span>data</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR125" data-line-number="125"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR126" data-line-number="126"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> <span>(</span> <span>const</span> <span>ruleset</span> <span>of</span> <span>rulesetConfigs</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR127" data-line-number="127"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>lists</span> <span>=</span> <span>[</span><span>]</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR128" data-line-number="128"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR129" data-line-number="129"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`Listset for &#39;<span><span>${</span><span>ruleset</span><span>.</span><span>id</span><span>}</span></span>&#39;:`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR130" data-line-number="130"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR131" data-line-number="131"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>Array</span><span>.</span><span>isArray</span><span>(</span><span>ruleset</span><span>.</span><span>paths</span><span>)</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR132" data-line-number="132"></td>

  <td>
    <span data-code-marker="+">            <span>for</span> <span>(</span> <span>const</span> <span>path</span> <span>of</span> <span>ruleset</span><span>.</span><span>paths</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR133" data-line-number="133"></td>

  <td>
    <span data-code-marker="+">                <span>log</span><span>(</span><span>`\t<span><span>${</span><span>path</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR134" data-line-number="134"></td>

  <td>
    <span data-code-marker="+">                <span>lists</span><span>.</span><span>push</span><span>(</span><span>readList</span><span>(</span><span>`assets/<span><span>${</span><span>path</span><span>}</span></span>`</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR135" data-line-number="135"></td>

  <td>
    <span data-code-marker="+">            <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR136" data-line-number="136"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR137" data-line-number="137"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> <span>(</span> <span>Array</span><span>.</span><span>isArray</span><span>(</span><span>ruleset</span><span>.</span><span>urls</span><span>)</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR138" data-line-number="138"></td>

  <td>
    <span data-code-marker="+">            <span>for</span> <span>(</span> <span>const</span> <span>url</span> <span>of</span> <span>ruleset</span><span>.</span><span>urls</span> <span>)</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR139" data-line-number="139"></td>

  <td>
    <span data-code-marker="+">                <span>log</span><span>(</span><span>`\t<span><span>${</span><span>url</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR140" data-line-number="140"></td>

  <td>
    <span data-code-marker="+">                <span>lists</span><span>.</span><span>push</span><span>(</span><span>fetchList</span><span>(</span><span>url</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR141" data-line-number="141"></td>

  <td>
    <span data-code-marker="+">            <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR142" data-line-number="142"></td>

  <td>
    <span data-code-marker="+">        <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR143" data-line-number="143"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR144" data-line-number="144"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>rules</span> <span>=</span> <span>await</span> <span>dnrRulesetFromRawLists</span><span>(</span><span>lists</span><span>,</span> <span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR145" data-line-number="145"></td>

  <td>
    <span data-code-marker="+">            <span>env</span>: <span>[</span> <span>&#39;chromium&#39;</span> <span>]</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR146" data-line-number="146"></td>

  <td>
    <span data-code-marker="+">        <span>}</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR147" data-line-number="147"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR148" data-line-number="148"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`Ruleset size for &#39;<span><span>${</span><span>ruleset</span><span>.</span><span>id</span><span>}</span></span>&#39;: <span><span>${</span><span>rules</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR149" data-line-number="149"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR150" data-line-number="150"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>good</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span> <span>isGood</span><span>(</span><span>rule</span><span>)</span> <span>&amp;&amp;</span> <span>isRegex</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR151" data-line-number="151"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tGood: <span><span>${</span><span>good</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR152" data-line-number="152"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR153" data-line-number="153"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>regexes</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span> <span>isGood</span><span>(</span><span>rule</span><span>)</span> <span>&amp;&amp;</span> <span>isRegex</span><span>(</span><span>rule</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR154" data-line-number="154"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tMaybe good (regexes): <span><span>${</span><span>regexes</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR155" data-line-number="155"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR156" data-line-number="156"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>redirects</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR157" data-line-number="157"></td>

  <td>
    <span data-code-marker="+">            <span>isUnsupported</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR158" data-line-number="158"></td>

  <td>
    <span data-code-marker="+">            <span>isRedirect</span><span>(</span><span>rule</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR159" data-line-number="159"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR160" data-line-number="160"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tredirect-rule= (discarded): <span><span>${</span><span>redirects</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR161" data-line-number="161"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR162" data-line-number="162"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>headers</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR163" data-line-number="163"></td>

  <td>
    <span data-code-marker="+">            <span>isUnsupported</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR164" data-line-number="164"></td>

  <td>
    <span data-code-marker="+">            <span>isCsp</span><span>(</span><span>rule</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR165" data-line-number="165"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR166" data-line-number="166"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tcsp= (discarded): <span><span>${</span><span>headers</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR167" data-line-number="167"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR168" data-line-number="168"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>removeparams</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR169" data-line-number="169"></td>

  <td>
    <span data-code-marker="+">            <span>isUnsupported</span><span>(</span><span>rule</span><span>)</span> <span>===</span> <span>false</span> <span>&amp;&amp;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR170" data-line-number="170"></td>

  <td>
    <span data-code-marker="+">            <span>isRemoveparam</span><span>(</span><span>rule</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR171" data-line-number="171"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR172" data-line-number="172"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tremoveparams= (discarded): <span><span>${</span><span>removeparams</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR173" data-line-number="173"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR174" data-line-number="174"></td>

  <td>
    <span data-code-marker="+">        <span>const</span> <span>bad</span> <span>=</span> <span>rules</span><span>.</span><span>filter</span><span>(</span><span>rule</span> <span>=&gt;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR175" data-line-number="175"></td>

  <td>
    <span data-code-marker="+">            <span>isUnsupported</span><span>(</span><span>rule</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR176" data-line-number="176"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR177" data-line-number="177"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span><span>`\tUnsupported: <span><span>${</span><span>bad</span><span>.</span><span>length</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR178" data-line-number="178"></td>

  <td>
    <span data-code-marker="+">        <span>log</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR179" data-line-number="179"></td>

  <td>
    <span data-code-marker="+">            <span>bad</span><span>.</span><span>map</span><span>(</span><span>rule</span> <span>=&gt;</span> <span>rule</span><span>.</span><span>_error</span><span>.</span><span>map</span><span>(</span><span>v</span> <span>=&gt;</span> <span>`\t\t<span><span>${</span><span>v</span><span>}</span></span>`</span><span>)</span><span>)</span><span>.</span><span>join</span><span>(</span><span>&#39;\n&#39;</span><span>)</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR180" data-line-number="180"></td>

  <td>
    <span data-code-marker="+">            <span>true</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR181" data-line-number="181"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR182" data-line-number="182"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR183" data-line-number="183"></td>

  <td>
    <span data-code-marker="+">        <span>writeOps</span><span>.</span><span>push</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR184" data-line-number="184"></td>

  <td>
    <span data-code-marker="+">            <span>writeFile</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR185" data-line-number="185"></td>

  <td>
    <span data-code-marker="+">                <span>`<span><span>${</span><span>rulesetDir</span><span>}</span></span>/<span><span>${</span><span>ruleset</span><span>.</span><span>id</span><span>}</span></span>.json`</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR186" data-line-number="186"></td>

  <td>
    <span data-code-marker="+">                <span>`<span><span>${</span><span>JSON</span><span>.</span><span>stringify</span><span>(</span><span>good</span><span>,</span> <span>replacer</span><span>,</span> <span>2</span><span>)</span><span>}</span></span>\n`</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR187" data-line-number="187"></td>

  <td>
    <span data-code-marker="+">            <span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR188" data-line-number="188"></td>

  <td>
    <span data-code-marker="+">        <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR189" data-line-number="189"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR190" data-line-number="190"></td>

  <td>
    <span data-code-marker="+">        <span>regexRuleResources</span><span>.</span><span>push</span><span>(</span><span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR191" data-line-number="191"></td>

  <td>
    <span data-code-marker="+">            <span>id</span>: <span>ruleset</span><span>.</span><span>id</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR192" data-line-number="192"></td>

  <td>
    <span data-code-marker="+">            <span>enabled</span>: <span>ruleset</span><span>.</span><span>enabled</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR193" data-line-number="193"></td>

  <td>
    <span data-code-marker="+">            <span>rules</span>: <span>regexes</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR194" data-line-number="194"></td>

  <td>
    <span data-code-marker="+">        <span>}</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR195" data-line-number="195"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR196" data-line-number="196"></td>

  <td>
    <span data-code-marker="+">        <span>ruleResources</span><span>.</span><span>push</span><span>(</span><span>{</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR197" data-line-number="197"></td>

  <td>
    <span data-code-marker="+">            <span>id</span>: <span>ruleset</span><span>.</span><span>id</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR198" data-line-number="198"></td>

  <td>
    <span data-code-marker="+">            <span>enabled</span>: <span>ruleset</span><span>.</span><span>enabled</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR199" data-line-number="199"></td>

  <td>
    <span data-code-marker="+">            <span>path</span>: <span>`/rulesets/<span><span>${</span><span>ruleset</span><span>.</span><span>id</span><span>}</span></span>.json`</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR200" data-line-number="200"></td>

  <td>
    <span data-code-marker="+">        <span>}</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR201" data-line-number="201"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR202" data-line-number="202"></td>

  <td>
    <span data-code-marker="+">        <span>goodTotalCount</span> <span>+=</span> <span>good</span><span>.</span><span>length</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR203" data-line-number="203"></td>

  <td>
    <span data-code-marker="+">        <span>maybeGoodTotalCount</span> <span>+=</span> <span>regexes</span><span>.</span><span>length</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR204" data-line-number="204"></td>

  <td>
    <span data-code-marker="+">    <span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR205" data-line-number="205"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR206" data-line-number="206"></td>

  <td>
    <span data-code-marker="+">    <span>writeOps</span><span>.</span><span>push</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR207" data-line-number="207"></td>

  <td>
    <span data-code-marker="+">        <span>writeFile</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR208" data-line-number="208"></td>

  <td>
    <span data-code-marker="+">            <span>`<span><span>${</span><span>rulesetDir</span><span>}</span></span>/regexes.js`</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR209" data-line-number="209"></td>

  <td>
    <span data-code-marker="+">            <span>`export default <span><span>${</span><span>JSON</span><span>.</span><span>stringify</span><span>(</span><span>regexRuleResources</span><span>,</span> <span>replacer</span><span>,</span> <span>2</span><span>)</span><span>}</span></span>;\n`</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR210" data-line-number="210"></td>

  <td>
    <span data-code-marker="+">        <span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR211" data-line-number="211"></td>

  <td>
    <span data-code-marker="+">    <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR212" data-line-number="212"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR213" data-line-number="213"></td>

  <td>
    <span data-code-marker="+">    <span>await</span> <span>Promise</span><span>.</span><span>all</span><span>(</span><span>writeOps</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR214" data-line-number="214"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR215" data-line-number="215"></td>

  <td>
    <span data-code-marker="+">    <span>log</span><span>(</span><span>`Total good rules count: <span><span>${</span><span>goodTotalCount</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR216" data-line-number="216"></td>

  <td>
    <span data-code-marker="+">    <span>log</span><span>(</span><span>`Total regex rules count: <span><span>${</span><span>maybeGoodTotalCount</span><span>}</span></span>`</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR217" data-line-number="217"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR218" data-line-number="218"></td>

  <td>
    <span data-code-marker="+">    <span>// Patch manifest</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR219" data-line-number="219"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>manifest</span> <span>=</span> <span>await</span> <span>fs</span><span>.</span><span>readFile</span><span>(</span><span>`<span><span>${</span><span>outputDir</span><span>}</span></span>/manifest.json`</span><span>,</span> <span>{</span> <span>encoding</span>: <span>&#39;utf8&#39;</span> <span>}</span><span>)</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR220" data-line-number="220"></td>

  <td>
    <span data-code-marker="+">        <span>.</span><span>then</span><span>(</span><span>text</span> <span>=&gt;</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span><span>text</span><span>)</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR221" data-line-number="221"></td>

  <td>
    <span data-code-marker="+">    <span>manifest</span><span>.</span><span>declarative_net_request</span> <span>=</span> <span>{</span> <span>rule_resources</span>: <span>ruleResources</span> <span>}</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR222" data-line-number="222"></td>

  <td>
    <span data-code-marker="+">    <span>const</span> <span>now</span> <span>=</span> <span>new</span> <span>Date</span><span>(</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR223" data-line-number="223"></td>

  <td>
    <span data-code-marker="+">    <span>manifest</span><span>.</span><span>version</span> <span>=</span> <span>`0.1.<span><span>${</span><span>now</span><span>.</span><span>getUTCFullYear</span><span>(</span><span>)</span> <span>-</span> <span>2000</span><span>}</span></span>.<span><span>${</span><span>now</span><span>.</span><span>getUTCMonth</span><span>(</span><span>)</span> <span>*</span> <span>100</span> <span>+</span> <span>now</span><span>.</span><span>getUTCDate</span><span>(</span><span>)</span><span>}</span></span>`</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR224" data-line-number="224"></td>

  <td>
    <span data-code-marker="+">    <span>await</span> <span>fs</span><span>.</span><span>writeFile</span><span>(</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR225" data-line-number="225"></td>

  <td>
    <span data-code-marker="+">        <span>`<span><span>${</span><span>outputDir</span><span>}</span></span>/manifest.json`</span><span>,</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR226" data-line-number="226"></td>

  <td>
    <span data-code-marker="+">        <span>JSON</span><span>.</span><span>stringify</span><span>(</span><span>manifest</span><span>,</span> <span>null</span><span>,</span> <span>2</span><span>)</span> <span>+</span> <span>&#39;\n&#39;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR227" data-line-number="227"></td>

  <td>
    <span data-code-marker="+">    <span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR228" data-line-number="228"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR229" data-line-number="229"></td>

  <td>
    <span data-code-marker="+">    <span>// Log results</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR230" data-line-number="230"></td>

  <td>
    <span data-code-marker="+">    <span>await</span> <span>fs</span><span>.</span><span>writeFile</span><span>(</span><span>`<span><span>${</span><span>outputDir</span><span>}</span></span>/log.txt`</span><span>,</span> <span>output</span><span>.</span><span>join</span><span>(</span><span>&#39;\n&#39;</span><span>)</span> <span>+</span> <span>&#39;\n&#39;</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR231" data-line-number="231"></td>

  <td>
    <span data-code-marker="+"><span>}</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR232" data-line-number="232"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR233" data-line-number="233"></td>

  <td>
    <span data-code-marker="+"><span>main</span><span>(</span><span>)</span><span>;</span></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR234" data-line-number="234"></td>

  <td>
    <span data-code-marker="+"><br/></span></td>
</tr>




    <tr data-hunk="e10c9d23c2b15b51c4127f274a320c6ae1272941ce6b70ea7c6ab17d750a8ced">
    <td></td>

    <td id="diff-19e4ce2ddb01445d83dc0d85e49e9749277f353b0bca0d9ab86616aae0f0ab9cR235" data-line-number="235"></td>

  <td>
    <span data-code-marker="+"><span>/******************************************************************************/</span></span></td>
</tr>






              </tbody>
            </div></div>
  </body>
</html>
