<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://words.filippo.io/last-resort/">Original</a>
    <h1>Maintainers of Last Resort</h1>
    
    <div id="readability-page-1" class="page"><article>
        <time datetime="2025-08-14">
            14 Aug 2025</time>
        
        <section>
            <!-- buttondown-editor-mode: plaintext -->
<p><a href="https://geomys.org">Geomys</a> is an organization of professional open source maintainers, focused on a portfolio of critical Go projects. For example, we are two thirds of the Go standard library cryptography maintainers, we provide the <a href="https://geomys.org/fips140">FIPS 140-3 validation</a> of the upstream Go Cryptographic Module, and we fund the maintenance of x/crypto/ssh and staticcheck amongst others.</p>
<p>Our retainer clients <a href="https://words.filippo.io/geomys/">engage us</a> both to get access to our expertise, and so that the critical dependencies they rely on are professionally maintained. Beyond our portfolio, we sometimes act as <em>maintainers of last resort</em> when critical, security-relevant Go projects go unmaintained.</p>
<p>Recently, there were two occasions in which we stepped into this informal role:</p>
<ul>
<li>we took over maintenance of the popular <a href="https://github.com/microcosm-cc/bluemonday">bluemonday</a> HTML sanitizer when the maintainer chose to move on; and</li>
<li>we built alternative upgrade paths for the seemingly unmaintained <a href="https://github.com/gorilla/csrf">gorilla/csrf</a> library, by introducing a new <a href="https://words.filippo.io/csrf">carefully researched implementation</a> into the standard library and creating a <a href="https://pkg.go.dev/filippo.io/csrf/gorilla">drop-in package replacement</a>, after we discovered a security vulnerability in the original.</li>
</ul>
<p>We can professionally serve in this role, including contracting external help, thanks to the sustainable funding of our retainer agreements. Our clients benefit from our maintenance efforts, and have a direct line to highlight projects in need.</p>
<h2 id="bluemonday">bluemonday</h2>
<p><a href="https://github.com/microcosm-cc/bluemonday">bluemonday</a> is the most popular HTML sanitizer in the Go ecosystem, used by thousands of applications and libraries to clean up user-generated markup before including it in web pages. Needless to say, it’s a security-critical, load-bearing component.</p>
<p>In late 2023, the sole previous maintainer announced that their new professional circumstances were not compatible with volunteer OSS work, and that they were looking for responsible ways to wind it down. Geomys offered to take over maintenance instead.</p>
<p>Over 2024, Geomys worked with the maintainer to take over the project at its original location, avoiding the disruption of a deprecation, and guaranteeing a natural path for future security updates.</p>
<p>Since we work on Go and open source on a daily basis, the marginal load for Geomys is tiny, but there is outsized value to the community in knowing that security reports would be handled by dedicated professionals that can prioritize them appropriately.</p>
<p>Beyond handling security and critical issues, we are also discussing bringing on a domain subject expert on a contract basis to improve safety in edge cases and to future-proof the library further. Again, we can do that because we are sustainably funded through our retainer agreements.</p>
<p>This <a href="https://news.ycombinator.com/item?id=40906971">was welcomed as a great outcome by the original maintainer</a>. The existence of a maintainer of last resort is not only beneficial to the consumers of the ecosystem, but also releases a lot of pressure from volunteer maintainers who would otherwise sometimes carry unsustainable loads out of a sense of duty.</p>
<h2 id="gorillacsrf">gorilla/csrf</h2>
<p><a href="https://github.com/gorilla/csrf">gorilla/csrf</a> is an extremely popular <a href="https://words.filippo.io/csrf">Cross-Site Request Forgery</a> protection middleware.</p>
<p>In December 2024, Patrick O’Doherty discovered that <a href="https://csrf.patrickod.com/">the library was unintentionally vulnerable to <em>schemelessly</em> same-site cross-origin request forgeries</a>. This means <code>https://admin.example.com</code> could be attacked by <code>https://blog.example.com</code> or, even worse, <code>http://foo.example.com</code>. Unless <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security">HTTP Strict-Transport-Security</a> with <code>includeSubDomains</code> is used, any network attacker can control the latter and mount the attack. This was <a href="https://github.com/gorilla/csrf/commit/9dd6af1f6d30fc79fb0d972394deebdabad6b5eb">fixed publicly in January</a>, but a new release (v1.7.3) and an advisory (<a href="https://github.com/advisories/GHSA-rq77-p4h8-4crw">CVE-2025-24358</a>) weren’t published until April.</p>
<p>Alerted by Patrick’s finding, we looked into the library, and found a further issue that again allowed network attackers to mount CSRF attacks if the application used the <code>TrustedOrigins</code> option. We reported this to the project on April 18th, 2025; however, it hasn’t been acknowledged and the project appears unmaintained. (We are <a href="https://github.com/golang/vulndb/issues/3884">publicly disclosing it</a> as the customary 90-day deadline has lapsed, and all the upgrade paths listed below are available as of yesterday, with the release of Go 1.25.)</p>
<p>We tried reaching out to past maintainers via email and Slack to offer to take over the project, but unfortunately never heard back. Therefore, we set out to find other solutions to fill this critical CSRF-shaped hole in the ecosystem.</p>
<ol>
<li>First, we researched the landscape of CSRF countermeasures, and consulted with subject experts, including some of the authors of relevant Web specifications. We found that modern browsers provide <a href="https://web.dev/articles/fetch-metadata">security metadata in request headers</a> that makes it possible to reject cross-origin requests without any tokens or keys, leading to a drastically better developer experience, better security, and fewer false positives! <a href="https://words.filippo.io/csrf">The results of that investigation</a> are public for other projects that may benefit from it.</li>
<li>Second, we <a href="https://github.com/golang/go/issues/73626">proposed and introduced</a> a new <a href="https://pkg.go.dev/net/http#CrossOriginProtection">CrossOriginProtection</a> middleware in the <code>net/http</code> standard library package. It is part of Go 1.25, <a href="https://go.dev/blog/go1.25">released yesterday</a>, and we recommend all gorilla/csrf users consider switching to it. We trust that a standard library solution will safely serve the ecosystem going forward.</li>
<li>For applications that are not ready to update to Go 1.25, we made a nearly-identical middleware available as a Go module, at <a href="https://pkg.go.dev/filippo.io/csrf">filippo.io/csrf</a>.</li>
<li>Finally, we made a drop-in replacement package for the whole gorilla/csrf API that uses the new countermeasures instead: <a href="https://pkg.go.dev/filippo.io/csrf/gorilla">filippo.io/csrf/gorilla</a>. We tried to minimize any side-effects of the substitution, for example by returning random values in place of the now disused tokens, but we invite you to read the package docs.</li>
</ol>
<p>Again, all of this is enabled by and part of the Geomys retainer contracts. If you work at a company with a critical dependency on the Go ecosystem, consider reaching out at hi@geomys.org. Regardless, you might also want to follow me on Bluesky at <a href="https://bsky.app/profile/filippo.abyssdomain.expert">@filippo.abyssdomain.expert</a> or on Mastodon at <a href="https://abyssdomain.expert/@filippo">@filippo@abyssdomain.expert</a>.</p>
<h2 id="the-picture">The picture</h2>
<p>Since we’re talking about Geomys, here’s a throwback to… last year? Was it just last year?? Anyway, we sponsored GopherCon US and set up a booth mostly to cover it with my collection of gophers and pins.</p>
<p><img alt="A photo of a conference booth. On the left, there&#39;s a tall white and yellow vertical banner. The top half has the Geomys logo. Below that is a description of Geomys. The bottom half of the banner lists Geomys clients. In the center, there is a table covered with a yellow tablecloth. On the table, there are several plush gophers. Some are black, while others are various pastel colors like pink, blue, and purple. In the middle of the plush toys, there are some some stickers and a laptop. Behind the table, a large whiteboard with handwritten notes and diagrams, including the TLS 1.3 handshake, and a little garden of enamel pins. A metal street sign with the word &#34;DEPRECATED&#34; is leaning against the bottom of the whiteboard." src="https://assets.buttondown.email/images/9f0cbfcd-75d3-482b-ae3f-69ed83d64a3b.jpg?w=1600&amp;fit=max"/></p>
<p>Geomys is funded by <a href="https://smallstep.com/">Smallstep</a>, <a href="https://www.avalabs.org/">Ava Labs</a>, <a href="https://goteleport.com/">Teleport</a>, <a href="https://tailscale.com/">Tailscale</a>, and <a href="https://sentry.io/">Sentry</a>. Here are a few words from some of them!</p>
<p>Teleport — For the past five years, attacks and compromises have been shifting from traditional malware and security breaches to identifying and compromising valid user accounts and credentials with social engineering, credential theft, or phishing. <a href="https://goteleport.com/platform/identity/?utm=filippo">Teleport Identity</a> is designed to eliminate weak access patterns through access monitoring, minimize attack surface with access requests, and purge unused permissions via mandatory access reviews.</p>
<p>Ava Labs — We at <a href="https://www.avalabs.org">Ava Labs</a>, maintainer of <a href="https://github.com/ava-labs/avalanchego">AvalancheGo</a> (the most widely used client for interacting with the <a href="https://www.avax.network">Avalanche Network</a>), believe the sustainable maintenance and development of open source cryptographic protocols is critical to the broad adoption of blockchain technology. We are proud to support this necessary and impactful work through our ongoing sponsorship of Filippo and his team.</p>
        </section>
    </article></div>
  </body>
</html>
