<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ggerganov/llama.cpp/pull/613">Original</a>
    <h1>Llama.cpp 30B runs with only 6GB of RAM now</h1>
    
    <div id="readability-page-1" class="page"><div data-view-component="true">          <div>
  <div>
    <div>
      
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/jart/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://www.recurse.com/jart">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/49262?s=40&amp;v=4" width="20" height="20" alt="@jart"/>
</a>  </p>
</div>

      

      

      

      
    </div>
  </div>
    <div>
      <pre>This is a breaking change that&#39;s going to give you three benefits:

1. Your inference commands should load 100x faster
2. You may be able to safely load models 2x larger
3. You can run many concurrent inference processes

This was accomplished by changing the file format so we can mmap()
weights directly into memory without having to read() or copy them
thereby ensuring the kernel can make its file cache pages directly
accessible to our inference processes; and secondly, that the file
cache pages are much less likely to get evicted (which would force
loads to hit disk) because they&#39;re no longer competing with memory
pages that were needlessly created by gigabytes of standard i/o.

The new file format supports single-file models like LLaMA 7b, and
it also supports multi-file models like LLaMA 13B. Our Python tool
now merges the foo.1, foo.2, etc. files back into a single file so
that the C++ code which maps it doesn&#39;t need to reshape data every
time. That&#39;s made llama.cpp so much simpler. Much of its load code
has now been deleted.

Furthermore, this change ensures that tensors are aligned properly
on a 32-byte boundary. That opens the door to seeing if we can get
additional performance gains on some microprocessors, by using ops
that require memory alignment.

Lastly note that both POSIX and the Windows platform are supported

<span aria-label="This commit closes issue #91.">Fixes</span> <a data-error-text="Failed to load title" data-id="1621329164" data-permission-text="Title is private" data-url="https://github.com/ggerganov/llama.cpp/issues/91" data-hovercard-type="issue" data-hovercard-url="/ggerganov/llama.cpp/issues/91/hovercard" href="https://github.com/ggerganov/llama.cpp/issues/91">ggerganov#91</a></pre>
    </div>
</div>

</div></div>
  </body>
</html>
