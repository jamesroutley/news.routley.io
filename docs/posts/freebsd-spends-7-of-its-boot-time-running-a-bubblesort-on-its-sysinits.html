<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/cperciva/status/1659558311920914432">Original</a>
    <h1>FreeBSD spends 7% of its boot time running a bubblesort on its SYSINITs</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-3506" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558311920914432" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="21" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:55:09.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:55:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="mainEntityOfPage"/><article aria-labelledby="id__ns5olkt20j7 id__al2j95i88t4 id__c6z1es826gr id__6lldtnajrd id__8pxx2bkdl4a id__gp36y71mmdr id__ju7z41vcqwq id__7kzbv5pmg0a id__gvxkic1052m id__p7k5o3nzln id__6nnwyzbxgut id__smystaabin9 id__8mt1vb1aqux id__54e01ilxiyg id__31yilzfkkas id__el94t7dt4nl id__vnsn08r6fwm id__s4gmc3uimtl id__89dd85m73ev" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the FreeBSD kernel boots in Firecracker (1 CPU, 128 MB RAM), it now spends 7% of its time running a bubblesort on its SYSINITs.

O(N^2) can bite hard when you&#39;re sorting over a thousand items.  Time to replace the bubblesort with something faster.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659569284241080321" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:38:45.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:38:45.000Z" itemprop="datePublished"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__6bqpsqd9tng id__v8q2mu1vzo id__54vwnzi720t id__brxjkvxijyw id__dy9csc3c78m id__ngvas11n4w id__7fyc8zpnm4q id__yasd7abxqdc id__n4zwwnzmnr id__agn6p1hx6kl id__512voc41w4u id__0ldun4sssij id__kd0loao3vx id__a6vn2r1wq5 id__9ys9ogmpyia id__b2xwd48z5ai id__kjv9rb1xixi id__nu83f779hln id__fndo0iyicy9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-stefanomarinell"><div><div><div><div><a href="https://twitter.com/stefanomarinell" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1632691876791828481/ceoU234-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Well done! It would be great if all developers took into account the computational complexity of their software.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577927665610753" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:13:06.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:13:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577927665610753" itemprop="url"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="isPartOf"/><article aria-labelledby="id__f52wbcbj83b id__swklli2hioc id__z6tdzyd5s7q id__jzma8tf1gvs id__79q4d9q569e id__xsgpzy6oru id__a5veertudd5 id__fe6mf2yg6re id__sh2whtvdbol id__3l0tqutyzkk id__4jzo3ivfhk id__gra6oxw1esv id__d8y7ha6iknu id__xlcoevg994 id__wam97y25u2 id__j4a2i4w3p1n id__9fuvogbir2t id__upxsqucsaor id__sppzyzslzv9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To be fair, when this code was written in 1996, there were only about 30 SYSINITs being sorted.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558943260299264" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:57:39.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:57:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__87um98kioej id__n9km6buxfsj id__dtnr589ihnl id__5hhnb9nv80s id__pdgsnlkx6wb id__ivjn14axjm id__5ap3r634unb id__q3usgdw2npj id__oofadtf6tn id__gfefg99qzga id__o3pmqxkt5p9 id__rgem0ihddu id__hp589nfalkb id__nawkks3jl2o id__2v29m5l2uf5 id__ib8q5dyadef id__edsurnt3je5 id__zowamoj20w id__jetkqm2f9qh" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-pandrewhk"><div><div><div><div><a href="https://twitter.com/pandrewhk" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1359477974890815489/wBGOrr4J_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>hmm it can be pre-computed after every edit, right?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561673278226432" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:08:30.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:08:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561673278226432" itemprop="url"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="isPartOf"/><article aria-labelledby="id__htaeqgtxvfv id__i2w9eddtrfe id__eyz0tscwim7 id__wkmzq7ojik id__1if1ozqsefu id__vlf7fsljs5 id__d589mhu6ppd id__cxe4dy1lu3 id__r02l8kxzf0p id__ry7vv314aik id__6y6t9knueyu id__gicyucu3zc9 id__4hsvs48wiq7 id__21wc18zxola id__4v4gu79c7cx id__wncgxe851y id__fvjn3t9iy5o id__3ddegkc7w1m id__vcgnut6trds" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Theoretically we could get the linker to sort SYSINITs and then just merge the lists from kernel and modules.  I suspect quicksort will be enough though.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659560974578499586" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:05:44.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:05:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__hazv0aq5226 id__2dfaazt4xc2 id__xnasuhld24 id__eiyxhg7smk id__9zuc4k94y id__rthyqrvoen id__t1i6af20hmp id__j7t5tbotdb id__to1b8tigknj id__uwv5n7cpcip id__210fpj2iait id__cwbrr1jpo8 id__ikcvf30p8wp id__fdjxxjeca5 id__lo7k9v3ftv id__5a3kz1y7v57 id__f7ousqdskwr id__wuyqzxiphr id__pv87gz7g0et" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-shachaf"><div><div><div><div><a href="https://twitter.com/shachaf" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1201618403372306433/nJ-IaIu-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Even in the world of quadratic-time sorts, bubble sort is really very bad. I bet insertion sort would do much better in every respect (including simplicity).</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561874126413824" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:09:18.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:09:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561874126413824" itemprop="url"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="isPartOf"/><article aria-labelledby="id__w9632m6j6dm id__ydzf5shuyrf id__39sfuvr4e79 id__7udo0h1tbx8 id__5yhipzovzp7 id__h2wqzhyxfpq id__zzbqz575haj id__a4o5qltw2wd id__wis5hova31m id__42t7lwvyb6v id__1zrxkyszrfy id__rhdpkdbqjuq id__exnzf968xg id__xtuky992fa id__vvqiolqnp4f id__u0glmwgov7d id__1az9j7hxjr5 id__xdly85rxvod id__8y82hg5z9d5" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I would probably have just made it a selection sort.  But this hasn&#39;t been touched since 1996; I guess it was good enough at that point.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659568009021648897" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:33:41.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:33:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__gxek39ifnio id__4jurwbodbps id__qk4mgax8v49 id__3nmqeuh1e5 id__708fp7tlhjb id__hqf2df9hb1n id__a9ky1hat39c id__nzy4mce33vd id__4vb5freit3t id__fugzb11i9gm id__dqq0kbwr34 id__ppwy5hvtw2 id__erzcghtd8vw id__z6zin4ro9t id__e2srfggg7f4 id__hf1q5wy4tev id__p9xh5ypzku id__9wgs84j48rf id__pd4hii3f9x9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-tzriggs"><div><div><div><div><a href="https://twitter.com/tzriggs" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1343967903926857740/ggYs1Ea7_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How long (in seconds) is that boot process overall?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577625289928705" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:11:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:11:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577625289928705" itemprop="url"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="isPartOf"/><article aria-labelledby="id__0mhhtqzdrhi id__oayvxf9667 id__mvww9keimh id__qvfk2tmxk8 id__a2e97i0jhqi id__y9yt5xmkr3 id__q2alb7uvq2 id__3sppbmps54a id__sf180shgrvi id__0hrpiakqi61u id__t8hyh4mt2xb id__egmfhememk id__h70al6euok id__zq0sy9unav id__ke1cx8qovj id__l15czzkqnj id__y2khf9czi4n id__npnvs1n43d id__kep2r2tw1w" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel boot (of which 7% is bubblesort) is 28 ms.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659646829363961856" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:46:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:46:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__1k2g31e1cci id__sgimojbhm6d id__ckuvqcyhpvf id__6yzc1mjewal id__des580wipl id__nzk2zv2cc2n id__zmu0o1mqnws id__null0txm57l id__fcyftdd4mpu id__ae7f3edkn3 id__g7aveibxuao id__bn4a5gmx0wi id__lys54s0tlb id__bp9ge4yi6kq id__8r5nwxxfhrj id__03a9r6yer2ee id__2fkrxf8jj2a id__zpn4ru05w id__5t5xwcrhhvi" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-WeedStocksNews"><div><div><div><div><a href="https://twitter.com/WeedStocksNews" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1085138515606884352/8rJn06u5_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How did that happen? Did the amount of SYSINITs grow from &lt;100 to 1000 or did someone decide to apply his job interview preparation?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659649740315799554" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:58:27.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:58:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659649740315799554" itemprop="url"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="isPartOf"/><article aria-labelledby="id__c4wglm6hyij id__d3jxzw4qf3 id__1mg6hdu553f id__qs2m7s91onc id__a0t2ys8qgou id__umlil7p8yce id__bshsr4ff2ek id__g0kracseevj id__v5hix8a8dvq id__vfuj0qwwq5i id__qobv7z5t3yq id__lvz0u39ayxk id__e80g052l786 id__6rdape1d46b id__n5ybc591ejj id__rlndbr8oa7p id__wnqokoxzqoi id__332w2j33evv id__zii2yo2v64e" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the bubblesort was added in 1996, there were only a few dozen SYSINITs.</span></p></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
