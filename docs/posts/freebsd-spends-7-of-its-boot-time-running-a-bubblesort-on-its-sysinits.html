<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/cperciva/status/1659558311920914432">Original</a>
    <h1>FreeBSD spends 7% of its boot time running a bubblesort on its SYSINITs</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-67270" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558311920914432" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="21" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:55:09.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:55:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="mainEntityOfPage"/><article aria-labelledby="id__rib5f5g34zp id__o8vrprzgth id__5mqx68jmt55 id__zybs92ck13l id__8n7sstvid5 id__7jg42imcaw id__2qtfs1egu8u id__h6vtmq5zp3u id__yvvocfjijyc id__2qi834afato id__fwic9uet27 id__kg9qjxlh5fs id__l8hiawcf06 id__a3m1sslpkys id__61l3azwqa2g id__90thy6bueud id__2qya1lex1nl id__3nqd1sptdk5 id__5c7y4rzbjhr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the FreeBSD kernel boots in Firecracker (1 CPU, 128 MB RAM), it now spends 7% of its time running a bubblesort on its SYSINITs.

O(N^2) can bite hard when you&#39;re sorting over a thousand items.  Time to replace the bubblesort with something faster.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659569284241080321" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:38:45.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:38:45.000Z" itemprop="datePublished"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__i2kgk7ur9y id__so7g2om7phm id__n75x3mvq5r id__mk4y2qzv7ac id__ft78ehtcqef id__zmygj9isiko id__j966f9npimf id__ey6ccki0ghg id__eifw7dkpaiv id__a5gqta4i5vu id__mvstlqx9hk id__41txe1utzjm id__61gyeypdshu id__ichsg17f9hr id__l6ae72vupp9 id__32z51au64dq id__t8993sne19g id__kzcj7qzqc3h id__s2pnmo6y7oo" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-stefanomarinell"><div><div><div><div><a href="https://twitter.com/stefanomarinell" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1632691876791828481/ceoU234-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Well done! It would be great if all developers took into account the computational complexity of their software.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577927665610753" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:13:06.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:13:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577927665610753" itemprop="url"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="isPartOf"/><article aria-labelledby="id__fs5uhiy2uoi id__kkf1l4jpigg id__o8tz2yd2tm id__j5wbdtiulg id__qt36zzi5vio id__0vb86d8i03od id__y8ybgysnz7g id__mjsa5a7o7sj id__3faq2s0objp id__wdu653w54r id__iyvyd1ysbec id__m9reafsgnr id__uphzvkc4cgs id__xlz5trv0c7i id__5xa48omioua id__t7nebivddye id__lofg3e0s3m id__48j1iyzxrty id__0keuvur9man" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To be fair, when this code was written in 1996, there were only about 30 SYSINITs being sorted.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558943260299264" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:57:39.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:57:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__44dokdfnmew id__r718svyxwn id__2hhlvux23mr id__zgm00ruybh id__pz9o3in12y id__0ql4pwrpzsld id__9d16yr1odcg id__hlcspnz7a3l id__utja6tjfus id__kcjjfs7u09 id__3lft2otgtod id__9rk279uea7 id__qjt8x8ro6ee id__jz0fdt1164 id__ugkky1jhp5 id__1nsxyb3wf8s id__gib5wei7mgn id__1108yhjg81e id__l6rb0xb7mdt" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-pandrewhk"><div><div><div><div><a href="https://twitter.com/pandrewhk" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1359477974890815489/wBGOrr4J_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>hmm it can be pre-computed after every edit, right?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561673278226432" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:08:30.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:08:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561673278226432" itemprop="url"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="isPartOf"/><article aria-labelledby="id__6y6o564uvpw id__4fuuqfoo7e8 id__f05vmypo0l7 id__fg55ogzx11k id__n1vz5ad7h19 id__8e0ocblr8g7 id__s0g1ykvw57 id__bagsj6u7bmh id__7tvzryoz9s8 id__xeubkxf484 id__t4hjq6aaaln id__hdm8ax364i8 id__8x76gt1ps6n id__rnbnts400lc id__4ecal9sstub id__m8vfgcfvh7 id__0r1rwa6rduy id__humk2oobgv id__yezqsryzjtq" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Theoretically we could get the linker to sort SYSINITs and then just merge the lists from kernel and modules.  I suspect quicksort will be enough though.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659560974578499586" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:05:44.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:05:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__1n9uk0ect0s id__fbpgqcyu1xj id__1rf546k5zfx id__rqp27wktuu id__v1qfrda3qn id__ksqsuxstlte id__63yuw4m3kv7 id__p4yjzhqafxe id__pxuxrqpg1l id__7o4l34wj9qh id__kfvkq2n4px id__1i7kqf4oi0b id__28tm7h3mxfe id__s02bsd22qa id__xa1tusso7y id__cndjau7r3fl id__kbx2062597c id__kdm2aeosyq id__p3x2hijvhdf" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-shachaf"><div><div><div><div><a href="https://twitter.com/shachaf" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1201618403372306433/nJ-IaIu-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Even in the world of quadratic-time sorts, bubble sort is really very bad. I bet insertion sort would do much better in every respect (including simplicity).</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561874126413824" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:09:18.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:09:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561874126413824" itemprop="url"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="isPartOf"/><article aria-labelledby="id__14bbysnhoms9 id__2okzy2dqcfh id__kx2i9j20uq id__ipa1hlxrvj id__tftnsankig id__fvtd395yyuf id__mi13u0t0l1l id__nr610mweks id__6l5dwweimtr id__xl2ujgtqtj id__u2hzmobnc6o id__rbupb3evci id__urkolqbovu id__f8p1qh06hhp id__r9skcyso4n id__hvttaoa44v6 id__joufz3auc5o id__wx4rlii5veo id__tajwmddj6fn" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I would probably have just made it a selection sort.  But this hasn&#39;t been touched since 1996; I guess it was good enough at that point.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659568009021648897" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:33:41.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:33:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__xoce3cpjlfg id__zdf74fyxgi8 id__nzufunglvmd id__1mwdphreb29 id__u1lznbd1d9m id__cxsilocq6hw id__ihoy4oz196i id__afknx507t8c id__mzceh3b8f id__5qzyf83yuwh id__g4nvljhw8p id__pje9sq9pe8h id__78yrfprljos id__h3di8fvx7gq id__hge1o7le1g id__gqzsc55d21s id__b2nwaj4ini6 id__qa1bebx3gs id__u9j2w9fqluq" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-tzriggs"><div><div><div><div><a href="https://twitter.com/tzriggs" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1343967903926857740/ggYs1Ea7_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How long (in seconds) is that boot process overall?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577625289928705" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:11:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:11:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577625289928705" itemprop="url"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="isPartOf"/><article aria-labelledby="id__6q1rirjgpgc id__uxrts70sgch id__zq5httcun4 id__t7lubj57qq id__zyljitaog7 id__vduyh8nlt9e id__sglhbccnvc8 id__lsksl3t7pp id__23ar5wxd7l1 id__agmtojgqmp5 id__wt2aofrmrch id__as8tbslnn4o id__atwqwvroe9c id__wojo84hqp8 id__q1tad5xam1r id__xjgyov8y5u id__8ncgawntxfs id__xgthv6d2omr id__44wyjuxjmi5" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel boot (of which 7% is bubblesort) is 28 ms.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659646829363961856" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:46:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:46:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__o91ie2i1kqn id__5b0pw9ylok id__p2n5lmtbr8i id__zjuyfgoqx8g id__rxbxdqk907 id__rvhtvlo1crq id__rtmzs3hhp8a id__4tef4lrmxk7 id__rg1jxqq0f5 id__rf7sp8fikya id__k7dti0rf7og id__x25ksvyvf9o id__51ttjd03wrt id__1j8u6k8pzvz id__0zmvn0f0y4pb id__b0x34hjeww6 id__m2hjtogv08a id__ge868vhfqnt id__59y906uqmjj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-WeedStocksNews"><div><div><div><div><a href="https://twitter.com/WeedStocksNews" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1085138515606884352/8rJn06u5_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How did that happen? Did the amount of SYSINITs grow from &lt;100 to 1000 or did someone decide to apply his job interview preparation?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659649740315799554" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:58:27.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:58:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659649740315799554" itemprop="url"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="isPartOf"/><article aria-labelledby="id__293b5udowvr id__mtnxx8rizb id__wkgzfve8a8m id__pcu1pnq6tun id__9m2ovnaqtyv id__rai36bolooa id__o1a41fkbzie id__wwslxbz3dnn id__dmutuattru7 id__26xuxrllc2h id__8pkoin1qop7 id__xyan5x8481 id__93fv7qlh3os id__ggdk14kuajr id__9h2fwuhuthq id__vqidx9tiaf id__4vl7arq8jaj id__73izbbtg1x7 id__svzfiyfg01" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the bubblesort was added in 1996, there were only a few dozen SYSINITs.</span></p></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
