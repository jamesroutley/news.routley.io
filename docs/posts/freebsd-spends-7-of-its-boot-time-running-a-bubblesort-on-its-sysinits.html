<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/cperciva/status/1659558311920914432">Original</a>
    <h1>FreeBSD spends 7% of its boot time running a bubblesort on its SYSINITs</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-126879" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558311920914432" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="21" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:55:09.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:55:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="mainEntityOfPage"/><article aria-labelledby="id__iszn3errzio id__b2ox8i8kkl7 id__fmkl8m0jzwp id__gaew48g17no id__b4ynnev9fd id__z4pfo3amnfm id__hemmwdj3jbf id__3or3otbxhcf id__8nsjg9puwej id__gl2e3irnx6v id__d7rrrpuvpt id__iggviskxzo id__piswjuojf7c id__w2farqp4r7 id__515lxkk1upa id__yomox6kojnl id__3mqle83xxow id__madg4eiqh6 id__ktbfvx1zfi" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the FreeBSD kernel boots in Firecracker (1 CPU, 128 MB RAM), it now spends 7% of its time running a bubblesort on its SYSINITs.

O(N^2) can bite hard when you&#39;re sorting over a thousand items.  Time to replace the bubblesort with something faster.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659569284241080321" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:38:45.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:38:45.000Z" itemprop="datePublished"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__nst75ad869 id__o7m21gkxkf id__50sdcvce21p id__1iu3ivtdjem id__vbhjkrrgkl id__9pc350zbbor id__ela5chnp6i id__1ugqhcotwt1 id__0vujoopcuutg id__mikm5z51zhr id__n0kepm39yig id__vlukd0vhl2f id__g4pucmeu2gv id__dqe1c3b9f5v id__mgbyyik991q id__rdf66ca7lht id__49km0yqcegn id__tjggocy5e3 id__vpjj7dyk2h" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-stefanomarinell"><div><div><div><div><a href="https://twitter.com/stefanomarinell" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1632691876791828481/ceoU234-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Well done! It would be great if all developers took into account the computational complexity of their software.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577927665610753" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:13:06.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:13:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577927665610753" itemprop="url"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="isPartOf"/><article aria-labelledby="id__cud77lw89zf id__fpduvfrzjpr id__2uo1z61hsg id__2c839vokwuq id__q7ffvgjith id__tnfdvpqpo4 id__e0xae2bj57p id__gy4ng0p6jmk id__7q6e1qfr4sb id__hkkboz9yf2o id__eyotser9eeg id__4ezqrhuuf0w id__mrsk1yv6c5b id__rnf7cnnw2k id__dfvklx20ll id__yo6qgdonwy id__9c8d63f8xyg id__jtjumxh64di id__vpdkkla69d" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To be fair, when this code was written in 1996, there were only about 30 SYSINITs being sorted.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558943260299264" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:57:39.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:57:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__890tk3cg6xp id__bia0uube626 id__7d5eoyinz5p id__ys7lz5ao4q id__obw38pg265 id__ghpv0sjoe2 id__uol3qta6y8 id__mlmju2iqg07 id__qqftsyovrl8 id__9z4yeaw4r2r id__zfm02cxmu5h id__2t39m5vspxg id__cstcuh42vq id__l0pz7n1n22g id__y2h4u8gl3ar id__u7emukzp2r id__tzbwe5hb58 id__uzbt1wpa7uf id__5cxm7tlpzik" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-pandrewhk"><div><div><div><div><a href="https://twitter.com/pandrewhk" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1359477974890815489/wBGOrr4J_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>hmm it can be pre-computed after every edit, right?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561673278226432" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:08:30.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:08:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561673278226432" itemprop="url"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="isPartOf"/><article aria-labelledby="id__k83uy753fth id__rxxrbebasvd id__5po1x5gocu id__3dbx6bkzc9u id__dayj9ou36eh id__aya2sd3lky9 id__2zp09f2q03h id__hctny2hju4j id__nlcvnzgahca id__vf3pa5xz28 id__fxghkuss3ai id__ray4rcm31i id__tub7wuwrw5g id__0e09pzydb9x id__09r1orcj6kxc id__iwcfr1m4ir id__351pgflb3ej id__1mvwhd0bz5e id__bwdk9o07xfj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Theoretically we could get the linker to sort SYSINITs and then just merge the lists from kernel and modules.  I suspect quicksort will be enough though.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659560974578499586" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:05:44.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:05:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__ht5k5t2xvjw id__jp2rzk6t5dd id__rbdq5p5gtk id__mzghrh6vff id__vszd5j0dz3 id__hopm3711s1v id__egvyximox2 id__g1n3wcz1dch id__sec7r7k4g5e id__jpu7394cdi id__ecpdnagd4gk id__huo5oqshz2 id__3cntzrzywjw id__5e4qbn0o487 id__sgr0jjf0t97 id__0nlzgmjtv9jp id__51t901dorca id__u7cngi9ujp id__ffmsypgxu4v" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-shachaf"><div><div><div><div><a href="https://twitter.com/shachaf" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1201618403372306433/nJ-IaIu-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Even in the world of quadratic-time sorts, bubble sort is really very bad. I bet insertion sort would do much better in every respect (including simplicity).</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561874126413824" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:09:18.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:09:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561874126413824" itemprop="url"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="isPartOf"/><article aria-labelledby="id__wtruz05cuth id__wb3aymbg9t id__jdnlh46kaj id__xwcg9qql0r9 id__fd174c84lxf id__qs1tq4rpsrs id__q55d6vfv6lq id__eawws92dxr id__1gl1jht7m5p id__u8drou9rce8 id__1u3a4f68sgji id__4x9mmf2jejn id__fqas8y3af7b id__6atcbj4z7np id__v7bp394t3ls id__v4k0vzbqz id__966fmpeiaur id__h2i8y5h967 id__07lj1v6n3v64" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I would probably have just made it a selection sort.  But this hasn&#39;t been touched since 1996; I guess it was good enough at that point.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659568009021648897" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:33:41.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:33:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__chw2t1bdkwd id__6r2gcpbsbko id__tfva3iyc4y id__3kcyk7ka4vl id__c1sj0t8p5md id__efhmdojuy8r id__lfcev1pptc id__0jh6az6z8r7f id__67y0rla3cui id__1hu6z2zpoow id__7q73ytosy17 id__6brth73bx4u id__pyhj2fw3vg id__ei397l709e8 id__0t0ljz3xnxq id__dir1k68egdf id__zrj4koivegr id__in547gkgyyl id__d0nh94cyo5t" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-tzriggs"><div><div><div><div><a href="https://twitter.com/tzriggs" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1343967903926857740/ggYs1Ea7_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How long (in seconds) is that boot process overall?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577625289928705" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:11:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:11:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577625289928705" itemprop="url"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="isPartOf"/><article aria-labelledby="id__jvfngdvaif id__oy08b2evjwj id__yrv5f2krot id__q27meipy6jd id__vzvym216tah id__cubkluxwwes id__nj94ib4xsaa id__ikrxwk8752o id__yh53dyhvvs id__3f0hua80ovw id__k9388a8irs id__eoa2upwosbv id__cbf8ka5l2co id__5npabu33nsg id__nmdawivz7p8 id__39hyfilx16p id__0meapk8sru4q id__k0a826qfhs8 id__inv8uuaatq9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel boot (of which 7% is bubblesort) is 28 ms.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659646829363961856" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:46:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:46:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__rtueiad9e1i id__t72eib0m1 id__llmwtdidoxj id__bc56e5lpp2 id__jbwbpkjho6i id__b8u0w9dqtfe id__rx2vwh0erpi id__57d111j1pr4 id__b7z70gzd3ro id__tub5itlpb5d id__vzbvdsfuj3h id__nerlfrk2ab id__h37cxs9xq7 id__o0e173j9n8 id__3ruilsbqmhi id__7dg5hk6trlw id__am4y0ktk8xt id__1bg23ixxkrq id__5o6o6k2qsmw" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-WeedStocksNews"><div><div><div><div><a href="https://twitter.com/WeedStocksNews" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1085138515606884352/8rJn06u5_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How did that happen? Did the amount of SYSINITs grow from &lt;100 to 1000 or did someone decide to apply his job interview preparation?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659649740315799554" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:58:27.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:58:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659649740315799554" itemprop="url"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="isPartOf"/><article aria-labelledby="id__4noxpg5ds9a id__jyc3hid4xjg id__wqmmehekpnd id__s0fwvk477kn id__ad9fwin6vao id__bacrewvzau9 id__hkvuow59be8 id__cnszr96ptld id__v6fikokecu id__gt9sbbl3f8u id__wztrzyzdtx id__yb3tmv9z9xs id__q6dh58nt48l id__rf93y7r9shf id__yq74f7idsy9 id__avuwqz4b93 id__fi1k3hjr1r id__8vla5wh76zu id__sqnq2l8tfp" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the bubblesort was added in 1996, there were only a few dozen SYSINITs.</span></p></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
