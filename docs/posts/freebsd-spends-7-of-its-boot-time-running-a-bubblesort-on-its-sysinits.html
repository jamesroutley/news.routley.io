<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/cperciva/status/1659558311920914432">Original</a>
    <h1>FreeBSD spends 7% of its boot time running a bubblesort on its SYSINITs</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-26104" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558311920914432" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="21" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:55:09.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:55:09.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="mainEntityOfPage"/><article aria-labelledby="id__mwhbjh4ww4 id__g45ub8441k4 id__l15wig0s03 id__kbkyjga08qq id__6ufv3d7mfzw id__kf04dkdtn3 id__nhzqznrtzie id__ozbgcaoft5k id__7pa4ddzhtvp id__xzpn5tfb6c id__s9cfgu2f02s id__jp49bu0u8cn id__pijh3lf03z id__6m9zav24asp id__k5zhfp1fmwf id__rrw67xlzpxe id__qg3y7c5oikc id__xv5mc67qre id__b3est8qipg8" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the FreeBSD kernel boots in Firecracker (1 CPU, 128 MB RAM), it now spends 7% of its time running a bubblesort on its SYSINITs.

O(N^2) can bite hard when you&#39;re sorting over a thousand items.  Time to replace the bubblesort with something faster.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659569284241080321" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:38:45.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:38:45.000Z" itemprop="datePublished"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__4xyr324ih7y id__jy6yreusuzg id__e3wju06776t id__8e509z7ubnh id__rq818xs5i0i id__zfja0q7ytgo id__k6jljjlqxo9 id__7ouebrtpj9d id__z3j4udzo4cl id__36iycmiidoj id__ag9ihiwez7p id__eig8aenhb7c id__0ua9lc5k8jso id__6j3tm6s2l4r id__kul4xf10oic id__veehr5pvaz id__jr24cblrwkp id__z31jof4udp id__mqae56cezck" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-stefanomarinell"><div><div><div><div><a href="https://twitter.com/stefanomarinell" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1632691876791828481/ceoU234-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Well done! It would be great if all developers took into account the computational complexity of their software.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577927665610753" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:13:06.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:13:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577927665610753" itemprop="url"/><meta content="https://twitter.com/stefanomarinell/status/1659569284241080321" itemprop="isPartOf"/><article aria-labelledby="id__cdi8hy93l5u id__vay0h3cjta id__o7ps73lgtd8 id__ddqph5t08he id__90vrk4sjoe8 id__k548v3kmjg id__j168ygg15a id__xb2j3qc2i6q id__00vfm1usyjxgc id__g7dd4edadh5 id__9dipp7pm3sl id__gnyd4ehu19e id__od2a88tul id__tyk9piqex2h id__wn571zjtgie id__mfuxregg1kg id__t74gvggbgy id__d0cl9y9tu0w id__bwj4huzaoxr" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>To be fair, when this code was written in 1996, there were only about 30 SYSINITs being sorted.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659558943260299264" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T13:57:39.000Z" itemprop="dateCreated"/><meta content="2023-05-19T13:57:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__ve0pwmoq1e id__3mku8wcvlns id__dxp32sp6ct4 id__xfhvmqr3xs id__n9tfsue287 id__ar2ia1kq1g id__a44sbsx6ejv id__b4mkr1p01cp id__9q0an3xb81i id__9jarog7oocd id__338vwc7gdbu id__5j0plwxeq6f id__l2s9t5vecvr id__l77b2zryaif id__8bcgivkyi5 id__bce20yo8d8 id__iu1t9bm45og id__efxik1iwvkv id__dzlj8yujouj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-pandrewhk"><div><div><div><div><a href="https://twitter.com/pandrewhk" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1359477974890815489/wBGOrr4J_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>hmm it can be pre-computed after every edit, right?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561673278226432" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:08:30.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:08:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561673278226432" itemprop="url"/><meta content="https://twitter.com/pandrewhk/status/1659558943260299264" itemprop="isPartOf"/><article aria-labelledby="id__tvqo15uofhf id__5i8vz26iwxp id__c39ne1e1pim id__l4upcyp30bh id__fzjb2x4vg8 id__kcld4lzrq1 id__rdxyh79awdo id__7a2vwhu11tp id__21a4f8vcdqm id__9scgrzh0lua id__pjo7x9v8ald id__11es3e6sh0y9 id__672sxv5rlk4 id__wfc4w1rlha id__68qpmwa8u22 id__prc8fdokpke id__hq4vrrtt9vo id__5clgpi89ki2 id__44qipzb0nrx" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Theoretically we could get the linker to sort SYSINITs and then just merge the lists from kernel and modules.  I suspect quicksort will be enough though.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659560974578499586" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:05:44.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:05:44.000Z" itemprop="datePublished"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__xlqaaaseurb id__cgi9tsckivo id__j22mxng5s1c id__rfy3qzpc53 id__9elxcgltzj4 id__1t0qlbuyiiw id__mugya467pcs id__d08l2ygkp2 id__ykciwspgcz9 id__qoviqxo07l id__neus22q9hii id__kgw500hdh3 id__at7qgiuxfsa id__968n5esg9j id__ay895xwdyqb id__324h4ab6gcf id__w0g7rwtyo2 id__jvn9zd1lk0b id__wn09nu0q5t" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-shachaf"><div><div><div><div><a href="https://twitter.com/shachaf" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1201618403372306433/nJ-IaIu-_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Even in the world of quadratic-time sorts, bubble sort is really very bad. I bet insertion sort would do much better in every respect (including simplicity).</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659561874126413824" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:09:18.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:09:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659561874126413824" itemprop="url"/><meta content="https://twitter.com/shachaf/status/1659560974578499586" itemprop="isPartOf"/><article aria-labelledby="id__53csw5k041g id__tmmhbvzfi2 id__hyvc4d0ovut id__imqzqde8ou id__4t70upmo1fi id__8fekv9mulit id__x7znbjyt5uo id__iljhiswfvu8 id__ultrnrn2fjb id__5owrhwabujc id__6ahl51cdzk3 id__wabytzfu7dj id__s71e5emc47 id__iyujexqggmk id__bfz5nyiosj id__qyubvuleijp id__lfc3179s3mr id__my52fyb5ut id__e07w87lsjbg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I would probably have just made it a selection sort.  But this hasn&#39;t been touched since 1996; I guess it was good enough at that point.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659568009021648897" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T14:33:41.000Z" itemprop="dateCreated"/><meta content="2023-05-19T14:33:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__v38sp1pmab id__afblsh0v8a9 id__f5j5ra6x3kq id__je1gozlqml9 id__4vaf6zy9wky id__0ulpjcympcrg id__aqo6r49eda id__y20s4iecltc id__9f5z4zq9ctk id__6v1e8gb52bn id__etmgsib1ap id__arzktrsfmdw id__0op2sqhdeu9n id__tm6b4xd7opq id__ywlp29k194s id__ppa7puv7ym id__v44kv09mjf id__rgaq7ems8a id__ewahcgz8m2t" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-tzriggs"><div><div><div><div><a href="https://twitter.com/tzriggs" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1343967903926857740/ggYs1Ea7_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How long (in seconds) is that boot process overall?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659577625289928705" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T15:11:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T15:11:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659577625289928705" itemprop="url"/><meta content="https://twitter.com/tzriggs/status/1659568009021648897" itemprop="isPartOf"/><article aria-labelledby="id__gmbdlxti1bj id__kukekmtu9q id__f8byqvf8rm6 id__97jzwx8ddek id__7pl9jrh3sgg id__tt8j17zdlte id__vp78txmyfz id__it9ojh73u5q id__df1v988pnn id__ryr6fijog7g id__22h66gi8ijw id__vfl07m9emss id__v5lkl2f4788 id__hmji14a2gba id__w90qac71lni id__7z3ynj0wrrw id__l0mkdukmno id__if4yjqplwhn id__9o7mzcmpt5t" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The kernel boot (of which 7% is bubblesort) is 28 ms.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659646829363961856" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:46:53.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:46:53.000Z" itemprop="datePublished"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="url"/><meta content="https://twitter.com/cperciva/status/1659558311920914432" itemprop="isPartOf"/><article aria-labelledby="id__tjdjiyt89j id__2in8o9qe3km id__lgj0edvqd5 id__zsx9gs6f76 id__4tozhl9kyrb id__kehxhlqae9 id__rvdstvczxzd id__jmgkswyg2zq id__40cpof70wwa id__qhvmescdmnh id__sj09wh4o1g id__3y9xe2nohgq id__b3xacx63fcv id__jvnmg2f4qz id__0e95gc544cpd id__46mu3f0rvue id__tvc4brc2ims id__0cjrurh7g6mp id__556kljrm5v9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-WeedStocksNews"><div><div><div><div><a href="https://twitter.com/WeedStocksNews" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1085138515606884352/8rJn06u5_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>How did that happen? Did the amount of SYSINITs grow from &lt;100 to 1000 or did someone decide to apply his job interview preparation?</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1659649740315799554" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-05-19T19:58:27.000Z" itemprop="dateCreated"/><meta content="2023-05-19T19:58:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cperciva/status/1659649740315799554" itemprop="url"/><meta content="https://twitter.com/WeedStocksNews/status/1659646829363961856" itemprop="isPartOf"/><article aria-labelledby="id__4p6q04c19vl id__65cp2p39ry7 id__pqug0eextdp id__fjse6z900x5 id__yq0thsncw6l id__yx3qgirmdfa id__ul5ap4hhpdg id__r5ilv34f8mm id__xn3a6o24pu id__3hl7zphknij id__bccc2c1no2d id__m0rmetq1ji9 id__urz3c9nlszn id__xa33hbwztor id__d2ygm7glmt id__oq4g7xtj4ns id__d6qqebylsf id__r0ofvpx5n38 id__vquyvfw2cae" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cperciva"><div><div><div><div><a href="https://twitter.com/cperciva" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/427942491/Colin_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>When the bubblesort was added in 1996, there were only a few dozen SYSINITs.</span></p></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
