<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/spam/WellPreparedPhishSpammer">Original</a>
    <h1>We got hit by an alarmingly well-prepared phish spammer</h1>
    
    <div id="readability-page-1" class="page"><div><h2>We got hit by an alarmingly well-prepared phish spammer</h2>

	<p><small>January 28, 2025</small></p>
</div><div><p>Yesterday evening, <a href="https://support.cs.toronto.edu/">we</a> were hit
by a run of phish spam that I would call &#39;vaguely customized&#39; for
us, for example the display name in the From: header was &#34;U of T |
CS Dept&#34; (but then the actual email address was that of the compromised
account elsewhere that was used to send the phish spam). The
destination addresses here weren&#39;t particularly well chosen, and
some of them didn&#39;t even exist. So far, so normal. One person here
fell for the phish spam that evening but realized it almost immediately
and promptly changed their password. Today that person got in touch with
us because they&#39;d started receiving email bounces for (spam) email that
they hadn&#39;t sent. Investigation showed that the messages were being sent
through us, but in an alarmingly clever way.</p>

<p>We have a local VPN service for people, and this VPN service requires
a different password from your regular (Unix and IMAP and etc)
password. People connecting through our VPN have access to an
internal-only SMTP gateway machine that doesn&#39;t require SMTP
authentication. As far as we can tell, in the quite short interval
between when the person fell for the phish and then changed their
password, the phish spam attacker used the main password they&#39;d
just stolen to register the person for our VPN and obtain a VPN
password (which we don&#39;t reset on Unix password changes). They then
connected to the VPN using their stolen credentials and used the
VPN to send spam email through our internal-only SMTP gateway
(initially last evening and then again today, at which point they
were detected).</p>

<p>Based on some log evidence, I think that the phish spammer first
tried to use authenticated SMTP but failed due to the password
change, then fell back on the VPN access. Even if VPN access hadn&#39;t
been their primary plan, they worked very fast to secure themselves
an additional access method. It seems extremely likely that the
attacker had already researched our mail and VPN environment before
they sent their initial phish spam, since they knew exactly where
to go and what to do.</p>

<p>If phish spammers are increasingly going to be this well prepared
and clever, we&#39;re going to have to be prepared for that on our side.
Until now, we hadn&#39;t really thought about the possibility of phish
spammers gaining VPN access; previous phish spammers have exploited
some combination of webmail and authenticated SMTP.</p>

<p>(We&#39;re also going to need to be more concerned about other methods
of obtaining persistent account access, such as adding new SSH
authorized keys to the Unix login. This attacker didn&#39;t attempt any
sort of SSH access.)</p>
</div></div>
  </body>
</html>
