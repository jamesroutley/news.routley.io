<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gexp.no/blog/hacking-anything-with-gnu-guix.html">Original</a>
    <h1>Hacking anything with GNU Guix</h1>
    
    <div id="readability-page-1" class="page"><div><p>Perhaps my favourite feature of Guix is <code>guix shell</code>.  It is one of those
tools that I don&#39;t know how to do without.  Even if you are not ready to
use Guix as a package manager (or distro), <code>guix shell</code> alone might be a
reason to have Guix installed.</p><p>Why?</p><p>If you are a software developer, system administrator, or anything in
between, you have probably experienced a situation where you want to
patch some piece of software that you did not write.  Either to fix a
bug, try an idea you had in the shower, or just have fun.</p><p>Then you discover that it needs a mountain of dependencies to build,
and that the versions provided by your operating system are too old, or
only available on a mixture of PyPI, CPAN, and random repositories.  Even
if your preferred package manager has all dependencies available, you may
not want to install all that just to scratch that itch.</p><p>Enter <code>guix shell</code>.  If you are lucky, that project you want to hack on
is one of the 21000+ packages available in Guix.  Then you can simply
clone the repository, navigate to the project in a terminal, and run:</p><pre><code>guix shell --development the-package</code></pre><p>That&#39;s it.  Guix will download everything required to build that package
from source, run tests, etc; and make them available for that shell
session only.  Then you can <code>make</code>, <code>pytest</code>, or whatever you need to
try that patch.  <code>PYTHONPATH</code>, <code>CPATH</code>, etc are all set up and ready to go.</p><p>Once you exit the shell, the environment is gone, like it never existed.
If you want to hack on that project later, simply run the same command
again.  Now all the dependencies are cached on your system and so creating
the environment takes milliseconds.</p><p>What if the package is not in Guix, but its dependencies are?  You can
create arbitrary environments with:</p><pre><code>guix shell package1 package2 packageN</code></pre><p>Or mix and match:</p><pre><code>guix shell -D the-package package1 package2 -D package3</code></pre><p>(<code>-D</code> is shorthand for <code>--development</code>)</p><p>But what if you don&#39;t trust the packages or build systems to not litter
your <code>$HOME</code>, steal your passwords, or
<a href="https://github.com/MrMEEE/bumblebee-Old-and-abbandoned/issues/123">wipe your data</a>?
<code>guix shell</code> has you covered:</p><pre><code>guix shell --container [...]</code></pre><p>Now you are in an isolated environment that can only access the current
working directory, and with no network access (unless you pass <code>--network</code>).
You can make select parts of your file system visible with <code>--expose</code>
(read-only) and <code>--share</code> (read/write).  This is useful if you just want to
try some program, or script, without needing to trust it completely.</p><p>There are more features lurking in <code>guix shell</code>, but these are by far the
ones I use the most.  I don&#39;t even have <code>python</code> available on <code>PATH</code> and just
create a shell every time I need it, tailored to the project I want to hack on.</p><p>This blog is proudly powered by a <code>guix shell -m manifest.scm -- haunt build</code> step.</p><p>Happy hacking!</p></div></div>
  </body>
</html>
