<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/tidwall/pogocache">Original</a>
    <h1>Show HN: Pogocache – Fast caching software</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
<a target="_blank" rel="noopener noreferrer" href="https://avi.im/tidwall/pogocache/blob/main/.github/images/logo.png"><img alt="Pogocache" src="https://avi.im/tidwall/pogocache/raw/main/.github/images/logo.png" width="600"/></a>
</p>
<p dir="auto">Pogocache is fast caching software built from scratch with a focus on low latency and cpu efficency.</p>
<p dir="auto"><strong>Faster</strong>: Pogocache is faster than Memcache, Valkey, Redis, Dragonfly, and Garnet.
It has the lowest latency per request, providing the quickest response times.
It&#39;s optimized to scale from one to many cores, giving you the best single-threaded and multithreaded performance.</p>
<p dir="auto"><strong>Cheaper</strong>: Pogocache uses the fewest cpu cycles per request; minimizing server load, energy usage, and the overall cost to operate.</p>
<p dir="auto"><strong>Easier</strong>: Pogocache runs as a server-based program.
It supports Memcache, Valkey/Redis, HTTP, and Postgres wire protocols,
allowing for the use of system tools such as curl and psql, and numerous client libraries that are available for most programming languages.</p>
<p dir="auto"><strong>Embeddable</strong>: Optionally instead of running Pogocache as a server-based program,
the self-contained pogocache.c file can be compiled into existing software,
bypassing the network and directly accessing the cache programmatically.
Running embedded provides raw speed, with over 100M ops per second.</p>
<hr/>

<themed-picture data-catalyst-inline="true"><picture>
  <source media="(prefers-color-scheme: dark)" srcset="/tidwall/pogocache/raw/main/.github/images/graphs-dark.png"/>
  <source media="(prefers-color-scheme: light)" srcset="/tidwall/pogocache/raw/main/.github/images/graphs-light.png"/>
  <img alt="Graphs" src="https://avi.im/tidwall/pogocache/raw/main/.github/images/graphs-light.png"/>
</picture></themed-picture>
<p dir="auto">The above benchmarks measure the performance of Pogocache against other caching
software running 8 threads on an AWS c8g.8xlarge.</p>

<ul dir="auto">
<li><a href="#getting-started">Gettng started</a>
<ul dir="auto">
<li><a href="#building">Building</a></li>
<li><a href="#running">Running</a></li>
<li><a href="#connecting">Connecting</a></li>
</ul>
</li>
<li><a href="#wire-protocols-and-commands">Wire protocols and commands</a>
<ul dir="auto">
<li><a href="#http">HTTP</a></li>
<li><a href="#memcache">Memcache</a></li>
<li><a href="#resp-valkeyredis">RESP (Valkey/Redis)</a></li>
<li><a href="#postgres">Postgres</a></li>
</ul>
</li>
<li><a href="#security">Security</a>
<ul dir="auto">
<li><a href="#tlshttps">TLS/HTTPS</a></li>
<li><a href="#auth-password">Auth password</a></li>
</ul>
</li>
<li><a href="#embeddable">Embeddable</a></li>
<li><a href="#design-details">Design details</a></li>
<li><a href="#roadmap-and-status">Roadmap and status</a></li>
<li><a href="#license">License</a></li>
<li><a href="#support">Support</a></li>
</ul>

<p dir="auto">Pogocache is designed and tested on 64-bit Linux and MacOS.</p>


<p dir="auto">This will build the <code>pogocache</code> program</p>


<p dir="auto">This will start the server on localhost (127.0.0.1) port 9401.
To allow connections from other machines, bind the listener to an accessible
host address.</p>
<div data-snippet-clipboard-copy-content="./pogocache -h 172.30.2.84"><pre><code>./pogocache -h 172.30.2.84
</code></pre></div>
<details>
<summary>
<p dir="auto"><strong>See all Pogocache program options</strong></p>
</summary>
<p dir="auto">The help menu displayed on a Linux server with 32 CPUs.</p>

<div data-snippet-clipboard-copy-content="Usage: pogocache [options]

Basic options:
  -h hostname            listening host                 (default: 127.0.0.1)
  -p port                listening port                 (default: 9401)
  -s socket              unix socket file               (default: none)
  -v,-vv,-vvv            verbose logging level

Additional options:
  --threads count        number of threads              (default: 32)
  --maxmemory value      set max memory usage           (default: 80%)
  --evict yes/no         evict keys at maxmemory        (default: yes)
  --persist path         persistence file               (default: none)
  --maxconns conns       maximum connections            (default: 1024)

Security options:
  --auth passwd          auth token or password         (default: none)
  --tlsport port         enable tls on port             (default: none)
  --tlscert certfile     tls cert file                  (default: none)
  --tlskey keyfile       tls key file                   (default: none)
  --tlscacert cacertfile tls ca-cert file               (default: none)

Advanced options:
  --shards count         number of shards               (default: 4096)
  --backlog count        accept backlog                 (default: 1024)
  --queuesize count      event queuesize size           (default: 128)
  --reuseport yes/no     reuseport for tcp              (default: no)
  --tcpnodelay yes/no    disable nagles algo            (default: yes)
  --quickack yes/no      use quickack (linux)           (default: no)
  --uring yes/no         use uring (linux)              (default: yes)
  --loadfactor percent   hashmap load factor            (default: 75)
  --keysixpack yes/no    sixpack compress keys          (default: yes)
  --cas yes/no           use compare and store          (default: no)"><pre><code>Usage: pogocache [options]

Basic options:
  -h hostname            listening host                 (default: 127.0.0.1)
  -p port                listening port                 (default: 9401)
  -s socket              unix socket file               (default: none)
  -v,-vv,-vvv            verbose logging level

Additional options:
  --threads count        number of threads              (default: 32)
  --maxmemory value      set max memory usage           (default: 80%)
  --evict yes/no         evict keys at maxmemory        (default: yes)
  --persist path         persistence file               (default: none)
  --maxconns conns       maximum connections            (default: 1024)

Security options:
  --auth passwd          auth token or password         (default: none)
  --tlsport port         enable tls on port             (default: none)
  --tlscert certfile     tls cert file                  (default: none)
  --tlskey keyfile       tls key file                   (default: none)
  --tlscacert cacertfile tls ca-cert file               (default: none)

Advanced options:
  --shards count         number of shards               (default: 4096)
  --backlog count        accept backlog                 (default: 1024)
  --queuesize count      event queuesize size           (default: 128)
  --reuseport yes/no     reuseport for tcp              (default: no)
  --tcpnodelay yes/no    disable nagles algo            (default: yes)
  --quickack yes/no      use quickack (linux)           (default: no)
  --uring yes/no         use uring (linux)              (default: yes)
  --loadfactor percent   hashmap load factor            (default: 75)
  --keysixpack yes/no    sixpack compress keys          (default: yes)
  --cas yes/no           use compare and store          (default: no)
</code></pre></div>
</details>

<p dir="auto">A variety of tools may be used to connect to Pogocache.
This includes <a href="https://github.com/valkey-io/valkey">valkey-cli</a>, <a href="https://github.com/redis/redis">redis-cli</a>, <a href="https://www.postgresql.org/docs/current/app-psql.html" rel="nofollow">psql</a>, and <a href="https://curl.se/docs/manpage.html" rel="nofollow">curl</a>.
Telnet is also available, which uses the <a href="#memcache">Memcache</a> interface.</p>
<p dir="auto">Here&#39;s an example using curl</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ curl -X PUT -d &#34;my value&#34; http://localhost:9401/mykey
Stored

$ curl http://localhost:9401/mykey
my value

$ curl -X DELETE http://localhost:9401/mykey
Deleted"><pre>$ curl -X PUT -d <span><span>&#34;</span>my value<span>&#34;</span></span> http://localhost:9401/mykey
Stored

$ curl http://localhost:9401/mykey
my value

$ curl -X DELETE http://localhost:9401/mykey
Deleted</pre></div>
<p dir="auto">Here&#39;s an example using a RESP (Valkey/Redis) client.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ valkey-cli -p 9401
&gt; SET mykey value
OK
&gt; GET mykey
&#34;my value&#34;
&gt; DEL mykey
(integer) 1"><pre>$ valkey-cli -p 9401
<span>&gt;</span> SET mykey value
OK
<span>&gt;</span> GET mykey
<span><span>&#34;</span>my value<span>&#34;</span></span>
<span>&gt;</span> DEL mykey
(integer) 1</pre></div>
<p dir="auto">Here&#39;s an example using psql, the Postgres command line tool.</p>
<div dir="auto" data-snippet-clipboard-copy-content="psql -h localhost -p 9401
=&gt; SET mykey &#39;my value&#39;;
=&gt; GET mykey;
=&gt; DEL mykey;"><pre>psql -h localhost -p 9401
=<span>&gt;</span> SET mykey <span><span>&#39;</span>my value<span>&#39;</span></span><span>;</span>
=<span>&gt;</span> GET mykey<span>;</span>
=<span>&gt;</span> DEL mykey<span>;</span></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Wire protocols and commands</h2><a id="user-content-wire-protocols-and-commands" aria-label="Permalink: Wire protocols and commands" href="#wire-protocols-and-commands"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Pogocache supports the following wire protocols.</p>
<ul dir="auto">
<li><a href="#http">HTTP</a></li>
<li><a href="#memcache">Memcache</a></li>
<li><a href="#postgres">Postgres</a></li>
<li><a href="#resp-valkeyredis">RESP (Valkey/Redis)</a></li>
</ul>

<p dir="auto">Pogocache uses HTTP methods PUT, GET, DELETE to store, retrieve, and delete
entries.</p>



<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Param</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>yes</td>
<td>Key of entry</td>
</tr>
<tr>
<td>ttl</td>
<td>no</td>
<td>Time to live in seconds</td>
</tr>
<tr>
<td>nx</td>
<td>no</td>
<td>Only store if it does not already exist.</td>
</tr>
<tr>
<td>xx</td>
<td>no</td>
<td>Only store if it already exists.</td>
</tr>
<tr>
<td>auth</td>
<td>no</td>
<td>Auth password</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<ul dir="auto">
<li><code>200 OK</code> with the response &#34;Stored&#34;</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="curl -X PUT -d &#34;my value&#34; &#34;http://localhost:9401/mykey&#34;        # store entry
curl -X PUT -d &#34;my value&#34; &#34;http://localhost:9401/mykey?ttl=15&#34; # store with 15 second ttl"><pre>curl -X PUT -d <span><span>&#34;</span>my value<span>&#34;</span></span> <span><span>&#34;</span>http://localhost:9401/mykey<span>&#34;</span></span>        <span><span>#</span> store entry</span>
curl -X PUT -d <span><span>&#34;</span>my value<span>&#34;</span></span> <span><span>&#34;</span>http://localhost:9401/mykey?ttl=15<span>&#34;</span></span> <span><span>#</span> store with 15 second ttl</span></pre></div>



<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Param</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>yes</td>
<td>Key of entry</td>
</tr>
<tr>
<td>auth</td>
<td>no</td>
<td>Auth password</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<ul dir="auto">
<li><code>200 OK</code> and the value in the body</li>
<li><code>404 Not Found</code> and the value &#34;Not Found&#34;</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="curl -X PUT -d &#34;my value&#34; &#34;http://localhost:9401/mykey&#34;        # store entry"><pre>curl -X PUT -d <span><span>&#34;</span>my value<span>&#34;</span></span> <span><span>&#34;</span>http://localhost:9401/mykey<span>&#34;</span></span>        <span><span>#</span> store entry</span></pre></div>


<ul dir="auto">
<li><code>200 OK</code> with the respone &#34;Deleted&#34;</li>
<li><code>404 Not Found</code> and the value &#34;Not Found&#34;</li>
</ul>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Param</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>yes</td>
<td>Key of entry</td>
</tr>
<tr>
<td>auth</td>
<td>no</td>
<td>Auth password</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">Pogocache supports the commands from the <a href="https://docs.memcached.org/protocols/basic/" rel="nofollow">Memcache text protocol</a>, including
<code>set</code>, <code>add</code>, <code>replace</code>, <code>append</code>, <code>prepend</code>, <code>cas</code>
<code>get</code>, <code>gets</code>, <code>delete</code>, <code>incr/decr</code>, <code>flush_all</code></p>

<p dir="auto">Pogocache has the following RESP commands, which can be used in your favorite
Valkey/Redis command line tool or client library.</p>
<p dir="auto"><a href="#resp-set">SET</a>, <a href="#resp-get">GET</a>, <a href="#resp-del">DEL</a>, <a href="#resp-mget">MGET</a>, <a href="#resp-mgets">MGETS</a>, <a href="#resp-ttl">TTL</a>, <a href="#resp-pttl">PTTL</a>, <a href="#resp-expire">EXPIRE</a>, <a href="#resp-dbsize">DBSIZE</a>, <a href="#resp-quit">QUIT</a>, <a href="#resp-echo">ECHO</a>, <a href="#resp-exists">EXISTS</a>, <a href="#resp-flush">FLUSH</a>, <a href="#resp-purge">PURGE</a>, <a href="#resp-sweep">SWEEP</a>, <a href="#resp-keys">KEYS</a>, <a href="#resp-ping">PING</a>, <a href="#resp-incrby">INCRBY</a>, <a href="#resp-decrby">DECRBY</a>, <a href="#resp-incr">INCR</a>, <a href="#resp-decr">DECR</a>, <a href="#resp-uincrby">UINCRBY</a>, <a href="#resp-udecrby">UDECRBY</a>, <a href="#resp-uincr">UINCR</a>, <a href="#resp-udecr">UDECR</a>, <a href="#resp-append">APPEND</a>, <a href="#resp-prepend">PREPEND</a>, <a href="#resp-auth">AUTH</a>, <a href="#resp-save">SAVE</a>, <a href="#resp-load">LOAD</a></p>
<markdown-accessiblity-table><table>
<tbody><tr><td>
  <a name="user-content-resp-set"></a>
  <b>SET key value [NX | XX] [GET] [EX seconds | PX milliseconds | EXAT unix-time-seconds | PXAT unix-time-milliseconds | KEEPTTL] [FLAGS flags] [CAS cas]</b></td></tr>
<tr><td>
<a name="user-content-resp-get"></a>
  <b>GET key</b></td></tr>
<tr><td>
  <a name="user-content-resp-del"></a>
  <b>DEL key</b></td></tr>
<tr><td>
  <a name="user-content-resp-mget"></a>
  <b>MGET key [key ...]</b></td></tr>
<tr><td>
  <a name="user-content-resp-mgets"></a>
  <b>MGETS key [key ...]</b></td></tr>
<tr><td>
  <a name="user-content-resp-ttl"></a>
  <b>TTL key</b></td></tr>
<tr><td>
  <a name="user-content-resp-pttl"></a>
  <b>PTTL key</b></td></tr>
<tr><td>
  <a name="user-content-resp-expire"></a>
  <b>EXPIRE key seconds</b></td></tr>
<tr><td>
  <a name="user-content-resp-dbsize"></a>
  <b>DBSIZE</b></td></tr>
<tr><td>
  <a name="user-content-resp-quit"></a>
  <b>QUIT</b></td></tr>
<tr><td>
  <a name="user-content-resp-echo"></a>
  <b>ECHO message</b></td></tr>
<tr><td>
  <a name="user-content-resp-ping"></a>
  <b>PING [message]</b></td></tr>
<tr><td>
  <a name="user-content-resp-exists"></a>
  <b>EXISTS key [key ...]</b></td></tr>
<tr><td>
  <a name="user-content-resp-flush"></a>
  <b>FLUSH [SYNC|ASYNC] [DELAY ]</b></td></tr>
<tr><td>
  <a name="user-content-resp-sweep"></a>
  <b>SWEEP [ASYNC]</b></td></tr>
<tr><td>
  <a name="user-content-resp-purge"></a>
  <b>PURGE [ASYNC]</b></td></tr>
<tr><td>
  <a name="user-content-resp-keys"></a>
  <b>KEYS pattern</b></td></tr>
<tr><td>
  <a name="user-content-resp-incrby"></a>
  <b>INCRBY key delta</b></td></tr>
<tr><td>
  <a name="user-content-resp-decrby"></a>
  <b>DECRBY key delta</b></td></tr>
<tr><td>
  <a name="user-content-resp-incr"></a>
  <b>INCR key</b></td></tr>
<tr><td>
  <a name="user-content-resp-decr"></a>
  <b>DECR key</b></td></tr>
<tr><td>
  <a name="user-content-resp-uincrby"></a>
  <b>UINCRBY key delta</b></td></tr>
<tr><td>
  <a name="user-content-resp-udecrby"></a>
  <b>UDECRBY key delta</b></td></tr>
<tr><td>
  <a name="user-content-resp-uincr"></a>
  <b>UINCR key</b></td></tr>
<tr><td>
  <a name="user-content-resp-udecr"></a>
  <b>UDECR key</b></td></tr>
<tr><td>
  <a name="user-content-resp-append"></a>
  <b>APPEND key value</b></td></tr>
<tr><td>
  <a name="user-content-resp-prepend"></a>
  <b>PREPEND key value</b></td></tr>
<tr><td>
  <a name="user-content-resp-auth"></a>
  <b>AUTH password</b></td></tr>
<tr><td>
  <a name="user-content-resp-save"></a>
  <b>SAVE [TO path] [FAST]</b></td></tr>
<tr><td>
  <a name="user-content-resp-load"></a>
  <b>LOAD [FROM path] [FAST]</b></td></tr>
</tbody></table></markdown-accessiblity-table>

<p dir="auto">The postgres commands are the same as the RESP above.</p>
<p dir="auto">Here&#39;s an example in Python using the <a href="https://www.psycopg.org" rel="nofollow">psycopg</a> client.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import psycopg

# Connect to Pogocache
conn = psycopg.connect(&#34;host=localhost port=9401&#34;)

# Insert some values
conn.execute(&#34;SET first Tom&#34;)
conn.execute(&#34;SET last Anderson&#34;)
conn.execute(&#34;SET age 37&#34;)
conn.execute(&#34;SET city %s&#34;, [&#34;Phoenix&#34;])

# Get the values back
print(conn.execute(&#34;GET first&#34;).fetchone()[0])
print(conn.execute(&#34;GET last&#34;).fetchone()[0])
print(conn.execute(&#34;GET age&#34;).fetchone()[0])
print(conn.execute(&#34;GET %s&#34;, [&#34;city&#34;]).fetchone()[0])

# Loop over multiple values
for row in conn.execute(&#34;MGET first last city&#34;):
    print(row[0], row[1])

conn.close()

# Output:
# Tom
# Anderson
# 37
# first Tom
# last Anderson
# city Phoenix"><pre><span>import</span> <span>psycopg</span>

<span># Connect to Pogocache</span>
<span>conn</span> <span>=</span> <span>psycopg</span>.<span>connect</span>(<span>&#34;host=localhost port=9401&#34;</span>)

<span># Insert some values</span>
<span>conn</span>.<span>execute</span>(<span>&#34;SET first Tom&#34;</span>)
<span>conn</span>.<span>execute</span>(<span>&#34;SET last Anderson&#34;</span>)
<span>conn</span>.<span>execute</span>(<span>&#34;SET age 37&#34;</span>)
<span>conn</span>.<span>execute</span>(<span>&#34;SET city %s&#34;</span>, [<span>&#34;Phoenix&#34;</span>])

<span># Get the values back</span>
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET first&#34;</span>).<span>fetchone</span>()[<span>0</span>])
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET last&#34;</span>).<span>fetchone</span>()[<span>0</span>])
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET age&#34;</span>).<span>fetchone</span>()[<span>0</span>])
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET %s&#34;</span>, [<span>&#34;city&#34;</span>]).<span>fetchone</span>()[<span>0</span>])

<span># Loop over multiple values</span>
<span>for</span> <span>row</span> <span>in</span> <span>conn</span>.<span>execute</span>(<span>&#34;MGET first last city&#34;</span>):
    <span>print</span>(<span>row</span>[<span>0</span>], <span>row</span>[<span>1</span>])

<span>conn</span>.<span>close</span>()

<span># Output:</span>
<span># Tom</span>
<span># Anderson</span>
<span># 37</span>
<span># first Tom</span>
<span># last Anderson</span>
<span># city Phoenix</span></pre></div>
<p dir="auto">Using psql</p>
<div dir="auto" data-snippet-clipboard-copy-content="psql -h localhost -p 9401
=&gt; SET first Tom;
=&gt; SET last Anderson;
=&gt; SET age 37;"><pre>psql -h localhost -p 9401
=<span>&gt;</span> SET first Tom<span>;</span>
=<span>&gt;</span> SET last Anderson<span>;</span>
=<span>&gt;</span> SET age 37<span>;</span></pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Binary data with Postgres client</h4><a id="user-content-binary-data-with-postgres-client" aria-label="Permalink: Binary data with Postgres client" href="#binary-data-with-postgres-client"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The default Postgres output format in Pogocache is <code>::text</code>.
This is generally the perferred format and allows for the most seamless text
translations between client and server.</p>
<p dir="auto">But occasionally storing binary is needed, such as with image, PDFs, or other special
data formats.
While Pogocache can transparently handle both text and binary, some client libraries
may have problems convering text &lt;-&gt; binary due to strict type rules.</p>
<p dir="auto">Pogocache provides the <code>::text</code> and <code>::bytea</code> command directives that will
switch the output format for the client session.</p>
<p dir="auto">While in <code>::bytea</code> mode, it becomes the programmers responsibility to convert
between binary and text.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import psycopg

conn = psycopg.connect(&#34;host=localhost port=9401&#34;)

conn.execute(&#34;SET name %s&#34;, [&#34;Tom&#34;])
conn.execute(&#34;SET binary %s&#34;, [b&#39;\x00\x01\x02hello\xff&#39;])

conn.execute(&#34;::bytea&#34;)
print(conn.execute(&#34;GET name&#34;).fetchone()[0])
print(conn.execute(&#34;GET binary&#34;).fetchone()[0])

conn.execute(&#34;::text&#34;)
print(conn.execute(&#34;GET name&#34;).fetchone()[0])

# Output:
# b&#39;Tom&#39;
# b&#39;\x00\x01\x02hello\xff&#39;
# Tom"><pre><span>import</span> <span>psycopg</span>

<span>conn</span> <span>=</span> <span>psycopg</span>.<span>connect</span>(<span>&#34;host=localhost port=9401&#34;</span>)

<span>conn</span>.<span>execute</span>(<span>&#34;SET name %s&#34;</span>, [<span>&#34;Tom&#34;</span>])
<span>conn</span>.<span>execute</span>(<span>&#34;SET binary %s&#34;</span>, [<span>b&#39;<span>\x00</span><span>\x01</span><span>\x02</span>hello<span>\xff</span>&#39;</span>])

<span>conn</span>.<span>execute</span>(<span>&#34;::bytea&#34;</span>)
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET name&#34;</span>).<span>fetchone</span>()[<span>0</span>])
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET binary&#34;</span>).<span>fetchone</span>()[<span>0</span>])

<span>conn</span>.<span>execute</span>(<span>&#34;::text&#34;</span>)
<span>print</span>(<span>conn</span>.<span>execute</span>(<span>&#34;GET name&#34;</span>).<span>fetchone</span>()[<span>0</span>])

<span># Output:</span>
<span># b&#39;Tom&#39;</span>
<span># b&#39;\x00\x01\x02hello\xff&#39;</span>
<span># Tom</span></pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Postgres parameterize queries</h4><a id="user-content-postgres-parameterize-queries" aria-label="Permalink: Postgres parameterize queries" href="#postgres-parameterize-queries"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Parameterize queries are allowed with Pogocache. The example above shows how
the <code>psycopg</code> uses the <code>%s</code> as a placeholder for a parameter. Other client may
use the standard Postgres placeholders, such as <code>$1</code>, <code>$2</code>, <code>$3</code>.</p>
<p dir="auto">For example, with the popular <a href="https://github.com/jackc/pgx">jackc/pgx</a> client for Go:</p>
<div dir="auto" data-snippet-clipboard-copy-content="package main

import (
	&#34;context&#34;
	&#34;fmt&#34;
	&#34;os&#34;

	&#34;github.com/jackc/pgx/v5&#34;
)

func main() {
	// Connect to Pogocache
	url := &#34;postgres://127.0.0.1:9401&#34;
	conn, err := pgx.Connect(context.Background(), url)
	if err != nil {
		fmt.Fprintf(os.Stderr, &#34;Unable to connect to cache: %v\n&#34;, err)
		os.Exit(1)
	}
	defer conn.Close(context.Background())

	conn.Exec(context.Background(), &#34;SET $1 $2&#34;, &#34;first&#34;, &#34;Tom&#34;)
	row := conn.QueryRow(context.Background(), &#34;GET $1&#34;, &#34;first&#34;)

	var value string
	row.Scan(&amp;value)
	println(value)

	userID := &#34;1287&#34;
	conn.Exec(context.Background(), &#34;SET user:$1:first $2&#34;, userID, &#34;Tom&#34;)
	conn.Exec(context.Background(), &#34;SET user:$1:last $2&#34;, userID, &#34;Anderson&#34;)
	conn.Exec(context.Background(), &#34;SET user:$1:age $2&#34;, userID, &#34;37&#34;)

	var first, last, age string

	conn.QueryRow(context.Background(), &#34;GET user:$1:first&#34;, userID).Scan(&amp;first)
	conn.QueryRow(context.Background(), &#34;GET user:$1:last&#34;, userID).Scan(&amp;last)
	conn.QueryRow(context.Background(), &#34;GET user:$1:age&#34;, userID).Scan(&amp;age)

	println(first)
	println(last)
	println(age)
}

// Output:
// Tom
// Tom
// Anderson
// 37"><pre><span>package</span> main

<span>import</span> (
	<span>&#34;context&#34;</span>
	<span>&#34;fmt&#34;</span>
	<span>&#34;os&#34;</span>

	<span>&#34;github.com/jackc/pgx/v5&#34;</span>
)

<span>func</span> <span>main</span>() {
	<span>// Connect to Pogocache</span>
	<span>url</span> <span>:=</span> <span>&#34;postgres://127.0.0.1:9401&#34;</span>
	<span>conn</span>, <span>err</span> <span>:=</span> <span>pgx</span>.<span>Connect</span>(<span>context</span>.<span>Background</span>(), <span>url</span>)
	<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
		<span>fmt</span>.<span>Fprintf</span>(<span>os</span>.<span>Stderr</span>, <span>&#34;Unable to connect to cache: %v<span>\n</span>&#34;</span>, <span>err</span>)
		<span>os</span>.<span>Exit</span>(<span>1</span>)
	}
	<span>defer</span> <span>conn</span>.<span>Close</span>(<span>context</span>.<span>Background</span>())

	<span>conn</span>.<span>Exec</span>(<span>context</span>.<span>Background</span>(), <span>&#34;SET $1 $2&#34;</span>, <span>&#34;first&#34;</span>, <span>&#34;Tom&#34;</span>)
	<span>row</span> <span>:=</span> <span>conn</span>.<span>QueryRow</span>(<span>context</span>.<span>Background</span>(), <span>&#34;GET $1&#34;</span>, <span>&#34;first&#34;</span>)

	<span>var</span> <span>value</span> <span>string</span>
	<span>row</span>.<span>Scan</span>(<span>&amp;</span><span>value</span>)
	<span>println</span>(<span>value</span>)

	<span>userID</span> <span>:=</span> <span>&#34;1287&#34;</span>
	<span>conn</span>.<span>Exec</span>(<span>context</span>.<span>Background</span>(), <span>&#34;SET user:$1:first $2&#34;</span>, <span>userID</span>, <span>&#34;Tom&#34;</span>)
	<span>conn</span>.<span>Exec</span>(<span>context</span>.<span>Background</span>(), <span>&#34;SET user:$1:last $2&#34;</span>, <span>userID</span>, <span>&#34;Anderson&#34;</span>)
	<span>conn</span>.<span>Exec</span>(<span>context</span>.<span>Background</span>(), <span>&#34;SET user:$1:age $2&#34;</span>, <span>userID</span>, <span>&#34;37&#34;</span>)

	<span>var</span> <span>first</span>, <span>last</span>, <span>age</span> <span>string</span>

	<span>conn</span>.<span>QueryRow</span>(<span>context</span>.<span>Background</span>(), <span>&#34;GET user:$1:first&#34;</span>, <span>userID</span>).<span>Scan</span>(<span>&amp;</span><span>first</span>)
	<span>conn</span>.<span>QueryRow</span>(<span>context</span>.<span>Background</span>(), <span>&#34;GET user:$1:last&#34;</span>, <span>userID</span>).<span>Scan</span>(<span>&amp;</span><span>last</span>)
	<span>conn</span>.<span>QueryRow</span>(<span>context</span>.<span>Background</span>(), <span>&#34;GET user:$1:age&#34;</span>, <span>userID</span>).<span>Scan</span>(<span>&amp;</span><span>age</span>)

	<span>println</span>(<span>first</span>)
	<span>println</span>(<span>last</span>)
	<span>println</span>(<span>age</span>)
}

<span>// Output:</span>
<span>// Tom</span>
<span>// Tom</span>
<span>// Anderson</span>
<span>// 37</span></pre></div>
<p dir="auto">Any string or keyword can be parameterized.</p>

<ul dir="auto">
<li><a href="#tlshttps">TLS/HTTPS</a></li>
<li><a href="#auth-password">Auth password</a></li>
</ul>

<p dir="auto">To use TLS, you need to start Pogocache with TLS-specific program flags.</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">Example TLS certificate generation</h4><a id="user-content-example-tls-certificate-generation" aria-label="Permalink: Example TLS certificate generation" href="#example-tls-certificate-generation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You’ll need:</p>
<ul dir="auto">
<li>CA certificate: ca.crt</li>
<li>Server certificate: pogocache.crt</li>
<li>Server private key: pogocache.key</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="# Generate CA key and cert
openssl req -x509 -newkey rsa:4096 -sha256 -days 365 -nodes \
  -keyout ca.key -out ca.crt -subj &#34;/CN=My Pogocache CA&#34;

# Generate server key and CSR
openssl req -newkey rsa:4096 -nodes -keyout pogocache.key -out pogocache.csr -subj &#34;/CN=localhost&#34;

# Sign server cert with CA
openssl x509 -req -sha256 -days 365 -in pogocache.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out pogocache.crt"><pre><span># Generate CA key </span><span>and</span><span> cert</span>
<span>openssl req </span><span>-</span><span>x509 </span><span>-</span><span>newkey rsa:</span><span>4096</span><span> </span><span>-</span><span>sha256 </span><span>-</span><span>days </span><span>365</span><span> </span><span>-</span><span>nodes \</span>
<span>  </span><span>-</span><span>keyout ca.key </span><span>-</span><span>out</span><span> ca.crt </span><span>-</span><span>subj </span><span>&#34;/CN=My Pogocache CA&#34;</span>

<span># Generate server key </span><span>and</span><span> CSR</span>
<span>openssl req </span><span>-</span><span>newkey rsa:</span><span>4096</span><span> </span><span>-</span><span>nodes </span><span>-</span><span>keyout pogocache.key </span><span>-</span><span>out</span><span> pogocache.csr </span><span>-</span><span>subj </span><span>&#34;/CN=localhost&#34;</span>

<span># Sign server cert with CA</span>
<span>openssl x509 </span><span>-</span><span>req </span><span>-</span><span>sha256 </span><span>-</span><span>days </span><span>365</span><span> </span><span>-</span><span>in</span><span> pogocache.csr </span><span>-</span><span>CA ca.crt </span><span>-</span><span>CAkey ca.key </span><span>-</span><span>CAcreateserial </span><span>-</span><span>out</span><span> pogocache.crt</span></pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="pogocache -p 0             \
   --tlsport 9401          \
   --tlscert pogocache.crt \
   --tlskey pogocache.key  \
   --tlscacert ca.crt"><pre>pogocache -p 0             \
   --tlsport 9401          \
   --tlscert pogocache.crt \
   --tlskey pogocache.key  \
   --tlscacert ca.crt</pre></div>
<p dir="auto">The <code>-p 0</code> disables the plain-text port.</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">Connect to Pogocache with TLS</h4><a id="user-content-connect-to-pogocache-with-tls" aria-label="Permalink: Connect to Pogocache with TLS" href="#connect-to-pogocache-with-tls"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<div dir="auto" data-snippet-clipboard-copy-content="valkey-cli --tls         \
    --cert pogocache.crt \
    --key pogocache.key  \
    --cacert ca.crt      \
    -h localhost -p 9401"><pre>valkey-cli --tls         \
    --cert pogocache.crt \
    --key pogocache.key  \
    --cacert ca.crt      \
    -h localhost -p 9401</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="curl &#34;https://localhost:9401&#34; \
  --cert pogocache.crt        \
  --key pogocache.key         \
  --cacert ca.crt"><pre>curl <span><span>&#34;</span>https://localhost:9401<span>&#34;</span></span> \
  --cert pogocache.crt        \
  --key pogocache.key         \
  --cacert ca.crt</pre></div>

<p dir="auto">An optional auth password may be provide to Pogocache through the <code>--auth</code> program flag.
When an auth password is being used on the server, that password must be provided with all client request.</p>

<p dir="auto">Now all connection must supply the auth password</p>
<div dir="auto" data-snippet-clipboard-copy-content="valkey-cli -p 9401 -a mypass"><pre>valkey-cli -p 9401 -a mypass</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="curl -H &#34;Authorization: Bearer mypass&#34; &#34;http://localhost:9401/mykey&#34; # Use header
curl &#34;http://localhost:9401/mykey?auth=mypass&#34;                       # Use querystring"><pre>curl -H <span><span>&#34;</span>Authorization: Bearer mypass<span>&#34;</span></span> <span><span>&#34;</span>http://localhost:9401/mykey<span>&#34;</span></span> <span><span>#</span> Use header</span>
curl <span><span>&#34;</span>http://localhost:9401/mykey?auth=mypass<span>&#34;</span></span>                       <span><span>#</span> Use querystring</span></pre></div>

<p dir="auto">The pogocache.c file in the src directory is a standalone library that can be compiled directly into an existing project that supports C.
This makes available an interface to the primary caching operations provided by Pogocache.</p>
<p dir="auto">For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// prog.c
#include &lt;stdio.h&gt;
#include &#34;pogocache.h&#34;

static void load_callback(int shard, int64_t time, const void *key,
    size_t keylen, const void *value, size_t valuelen, int64_t expires, 
    uint32_t flags, uint64_t cas, struct pogocache_update **update, 
    void *udata)
{
    printf(&#34;%.*s\n&#34;, (int)valuelen, (char*)value);
}

int main(void) {
    // Create a Pogocache instance
    struct pogocache *cache = pogocache_new(0);

    // Store some values
    pogocache_store(cache, &#34;user:1391:name&#34;, 14, &#34;Tom&#34;, 3, 0);
    pogocache_store(cache, &#34;user:1391:last&#34;, 14, &#34;Anderson&#34;, 8, 0);
    pogocache_store(cache, &#34;user:1391:age&#34;, 13, &#34;37&#34;, 2, 0);

    // Read the values back
    struct pogocache_load_opts lopts = { .entry = load_callback };
    pogocache_load(cache, &#34;user:1391:name&#34;, 14, &amp;lopts);
    pogocache_load(cache, &#34;user:1391:last&#34;, 14, &amp;lopts);
    pogocache_load(cache, &#34;user:1391:age&#34;, 13, &amp;lopts);
    return 0;
}
// Tom
// Anderson
// 37"><pre><span>// prog.c</span>
<span>#include</span> <span>&lt;stdio.h&gt;</span>
<span>#include</span> <span>&#34;pogocache.h&#34;</span>

<span>static</span> <span>void</span> <span>load_callback</span>(<span>int</span> <span>shard</span>, <span>int64_t</span> <span>time</span>, <span>const</span> <span>void</span> <span>*</span><span>key</span>,
    <span>size_t</span> <span>keylen</span>, <span>const</span> <span>void</span> <span>*</span><span>value</span>, <span>size_t</span> <span>valuelen</span>, <span>int64_t</span> <span>expires</span>, 
    <span>uint32_t</span> <span>flags</span>, <span>uint64_t</span> <span>cas</span>, <span>struct</span> <span>pogocache_update</span> <span>*</span><span>*</span><span>update</span>, 
    <span>void</span> <span>*</span><span>udata</span>)
{
    <span>printf</span>(<span>&#34;%.*s\n&#34;</span>, (<span>int</span>)<span>valuelen</span>, (<span>char</span><span>*</span>)<span>value</span>);
}

<span>int</span> <span>main</span>(<span>void</span>) {
    <span>// Create a Pogocache instance</span>
    <span>struct</span> <span>pogocache</span> <span>*</span><span>cache</span> <span>=</span> <span>pogocache_new</span>(<span>0</span>);

    <span>// Store some values</span>
    <span>pogocache_store</span>(<span>cache</span>, <span>&#34;user:1391:name&#34;</span>, <span>14</span>, <span>&#34;Tom&#34;</span>, <span>3</span>, <span>0</span>);
    <span>pogocache_store</span>(<span>cache</span>, <span>&#34;user:1391:last&#34;</span>, <span>14</span>, <span>&#34;Anderson&#34;</span>, <span>8</span>, <span>0</span>);
    <span>pogocache_store</span>(<span>cache</span>, <span>&#34;user:1391:age&#34;</span>, <span>13</span>, <span>&#34;37&#34;</span>, <span>2</span>, <span>0</span>);

    <span>// Read the values back</span>
    <span>struct</span> <span>pogocache_load_opts</span> <span>lopts</span> <span>=</span> { .<span>entry</span> <span>=</span> <span>load_callback</span> };
    <span>pogocache_load</span>(<span>cache</span>, <span>&#34;user:1391:name&#34;</span>, <span>14</span>, <span>&amp;</span><span>lopts</span>);
    <span>pogocache_load</span>(<span>cache</span>, <span>&#34;user:1391:last&#34;</span>, <span>14</span>, <span>&amp;</span><span>lopts</span>);
    <span>pogocache_load</span>(<span>cache</span>, <span>&#34;user:1391:age&#34;</span>, <span>13</span>, <span>&amp;</span><span>lopts</span>);
    <span>return</span> <span>0</span>;
}
<span>// Tom</span>
<span>// Anderson</span>
<span>// 37</span></pre></div>
<p dir="auto">Compile and run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cc prog.c pogocache.c
./a.out"><pre>cc prog.c pogocache.c
./a.out</pre></div>
<p dir="auto">See the <a href="https://avi.im/tidwall/pogocache/blob/main/src/pogocache.h">src/pogocache.h</a> and <a href="https://avi.im/tidwall/pogocache/blob/main/src/pogocache.c">src/pogocache.c</a> for more information.</p>


<p dir="auto">Pogocache is fast caching software.
It&#39;s goal is to provide low latency and cpu efficency.
It&#39;s written in the C programing language and runs on MacOS and Linux.</p>

<p dir="auto">Pogocache stores entries (key value pairs) in a sharded hashmap.
That sharded hashmap has a high fanout, often 4096 shards.
The number of shards is automatically configured at startup and can be changed by the user.</p>
<p dir="auto">Each shard has its own independent hashmap. That hashmap uses <a href="https://en.wikipedia.org/wiki/Hash_table#Open_addressing" rel="nofollow">open addressing</a> with <a href="https://en.wikipedia.org/wiki/Hash_table#Robin_Hood_hashing" rel="nofollow">Robin hood hashing</a>.
The concept for this design originated from the <a href="https://github.com/tidwall/shardmap">tidwall/shardmap</a> project.</p>
<p dir="auto">The hashmap buckets are 10-bytes. One byte for the dib (distance to bucket), three bytes for the hash, and six bytes for the entry pointer.</p>
<p dir="auto">Each entry is a single allocation on the heap.
This allocation contains a one byte header and a series of fields.
These fields always include one key and one value.
There may also be various optional fields such as expiry, cas, and flags.
The key is stored using the bespoke sixpack compression, which is just a minor optimization for storing keys using six bits per byte rather than eight.</p>
<p dir="auto">When inserting or retrieving an entry, the entry&#39;s key is hashed into a 64-bit number.
From that 64-bit hash, the high 32-bits are used to determine the shard and the low 32-bits are used for the per-shard hashmap.
The hash function used is <a href="https://github.com/tidwall/th64">tidwall/th64</a>.
Each hash call uses a seed that is crypto-randomly generated at the start of the Pogocache program.</p>
<p dir="auto">When operating on a shard, that shard is locked for the duration of the operation using a lightweight spinlock.</p>

<p dir="auto">At startup Pogocache determines the number threads to use for the life of the program.
This number is based on the core count on the machine.
At which point the network is initialized.</p>
<p dir="auto">For each thread, an event queue (epoll or kqueue) is instantiated.
All socket connections are bound to one of the queues by round-robin selection.
Each queue waits on socket read events.
The concept for this model originated from the <a href="https://github.com/tidwall/evio">tidwall/evio</a> project.</p>
<p dir="auto">For linux, when available, <a href="https://en.wikipedia.org/wiki/Io_uring" rel="nofollow">io_uring</a> may be used for read and write batching. This is a minor optimization which can be turned off by the user.</p>

<p dir="auto">All entries may have an optional expiry value.
Upon expiration that entry will no longer be available and will be evicted from the shard.</p>
<p dir="auto">The other way an entry may be evicted is when the program is low on memory.
When memory is low the insert operation will automatically choose to evict some older entry, using the <a href="https://danluu.com/2choices-eviction/" rel="nofollow">2-random algorithm</a>.</p>
<p dir="auto">Low memory evictions free up memory immediately to make room for new entries.
Expiration evictions, on the other hand, will not free the memory until the
entry&#39;s container bucket is accessed, or until the sweep operation is called.</p>

<p dir="auto">Pogocache&#39;s initial goal was to create the fastest, most efficent cache.</p>
<p dir="auto">Next steps are:</p>
<ul dir="auto">
<li>Build domain specific integrations for web, sql, prompts, and geo.</li>
<li>Add direct access over shared memory and IPC.</li>
<li>Provide enterprise tooling such as distributed routing and failovers.</li>
</ul>

<p dir="auto">Pogocache is free &amp; open source software released under the terms of the AGPL license. The Pogocache source code was written and copyrighted by Polypoint Labs, LLC.</p>
<p dir="auto">For alternative licensing options, please contact us at <a href="mailto:licensing@polypointlabs.com">licensing@polypointlabs.com</a>.</p>

<p dir="auto">If you decided to use Pogocache for commercial purposes, please consider purchasing support.
Contact us at <a href="mailto:support@polypointlabs.com">support@polypointlabs.com</a> for more information.</p>
</article></div></div>
  </body>
</html>
