<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/jxmnop/status/1953899426075816164">Original</a>
    <h1>Curious about the training data of OpenAI&#39;s new GPT-OSS models? I was too</h1>
    
    <div id="readability-page-1" class="page"><div>
        

        
        
        <p><i>August 9, 2025</i></p>
        
        
        <div>
            <p>The <code>sprintf</code> family of functions (<code>sprintf</code>, <code>snprintf</code>, <code>vsnprintf</code>, …)
have this little-known feature to what size your buffer should be. In cases
where you don’t have a fixed upper bound, this is really useful.</p>

<p>For example:</p>

<div><div><pre><code><span>int</span> <span>size</span> <span>=</span> <span>snprintf</span><span>(</span><span>/*str=*/</span><span>NULL</span><span>,</span> <span>/*size=*/</span><span>0</span><span>,</span>
                    <span>&#34;%d: %s&#34;</span><span>,</span> <span>some_int</span><span>,</span> <span>some_c_str</span><span>);</span>
<span>if</span> <span>(</span><span>size</span> <span>&lt;</span> <span>0</span><span>)</span> <span>abort</span><span>();</span>
<span>int</span> <span>size_with_nul</span> <span>=</span> <span>size</span> <span>+</span> <span>1</span><span>;</span>
<span>char</span> <span>*</span><span>buf</span> <span>=</span> <span>malloc</span><span>(</span><span>size_with_nul</span><span>);</span>
<span>if</span> <span>(</span><span>buf</span> <span>==</span> <span>NULL</span><span>)</span> <span>abort</span><span>();</span>
<span>int</span> <span>result</span> <span>=</span> <span>snprintf</span><span>(</span><span>/*str=*/</span><span>buf</span><span>,</span> <span>/*size=*/</span><span>size_with_nul</span><span>,</span>
                      <span>&#34;%d: %s&#34;</span><span>,</span> <span>some_int</span><span>,</span> <span>some_c_str</span><span>);</span>
<span>if</span> <span>(</span><span>result</span> <span>&lt;</span> <span>0</span><span>)</span> <span>abort</span><span>();</span>
</code></pre></div></div>

<p>I have <code>size_with_nul</code> because <code>snprintf</code> man pages say</p>

<blockquote>
  <p>The functions <code>snprintf()</code> and <code>vsnprintf()</code> write at most <code>size</code> bytes
(including the terminating null byte (‘\0’)) to <code>str</code>.</p>
</blockquote>

<p>If you like, check out <a href="https://github.com/tekknolagi/fmt">this tiny header-only
library</a> I wrote a couple of years ago and
promptly forgot about.</p>

<p>Go forth and please stop manually computing buffer sizes.</p>

        </div>
            
    <!-- Workaround for FB MITM -->
    <!-- Google tag (gtag.js) -->







    </div></div>
  </body>
</html>
