<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gwolf.org/2024/10/started-a-guide-to-writing-fuse-filesystems-in-python.html">Original</a>
    <h1>Started a guide to writing FUSE filesystems in Python</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
	
	
<!-- Blog entry follows -->

<p>As DebConf22 was coming to an end, in Kosovo, talking with <em>Eeveelweezel</em> they
invited me to prepare a talk to give for the <a href="https://chipy.org">Chicago Python User
Group</a>. I replied that I‚Äôm not really that much of a Python
guy‚Ä¶ But would think about a topic. Two years passed. I meet <em>Eeveelweezel</em>
again for DebConf24 in Busan, South Korea. And the topic came up again. I had
thought of some ideas, but none really pleased me. Again, I do write some Python
when needed, and I <em>teach</em> using Python, as it‚Äôs the language I find my students
can best cope with. But <em>delivering a talk</em> to ChiPy?</p>

<p>On the other hand, I have long used a very simplistic and limited filesystem
I‚Äôve designed as an implementation project at class:
<a href="https://github.com/unamfi/sistop-2024-2/blob/main/proyectos/1/README.org">FIUnamFS</a>
(for ‚ÄúFacultad de Ingenier√≠a, Universidad Nacional Aut√≥noma de M√©xico‚Äù: the
Engineering Faculty for Mexico‚Äôs National University, where I teach. Sorry, the
link is in Spanish ‚Äî but you will find several implementations of it from the
students üòâ). It is a toy filesystem, with as many bad characteristics you can
think of, but easy to specify and implement. It is based on contiguous file
allocation, has no support for sub-directories, and is often limited to the size
of a 1.44MB floppy disk.</p>

<p>As I give this filesystem as a <em>project</em> to my students (and not as a mere
<em>homework</em>), I always ask them to try and provide a good, polished, professional
interface, not just the simplistic menu I often get. And I tell them the best
possible interface would be if they provide support for FIUnamFS transparently,
usable by the user without thinking too much about it. With high probability,
that would mean: Use FUSE.</p>

<p><a href="https://gwolf.org/files/2024-10/python-fuse.png"><img src="https://gwolf.org/files/2024-10/python-fuse.400.png" alt="Python FUSE"/></a></p>

<p>But, in the six semesters I‚Äôve used this project (with 30-40 students per
semester group), <em>only one student</em> has bitten the bullet and presented a FUSE
implementation.</p>

<p>Maybe this is because it‚Äôs not easy to understand how to build a FUSE-based
filesystem from a high-level language such as Python? Yes, I‚Äôve seen several
implementation examples and even nice web pages (i.e. <a href="https://github.com/libfuse/python-fuse/tree/master/example">the examples shipped with
the<code>python-fuse</code>
module</a> <a href="https://www.stavros.io/posts/python-fuse-filesystem/">Stavros‚Äô
passthrough filesystem</a>,
<a href="https://thepythoncorner.com/posts/2017-02-27-writing-a-fuse-filesystem-in-python/">Dave Filesystem based upon, and further explaining,
Stavros‚Äô</a>,
and several others) explaining how to provide basic functionality. I found a
<a href="https://speakerdeck.com/matteobertozzi/python-fuse-pycon4">particularly useful presentation by Matteo
Bertozzi</a> presented
~15 years ago at PyCon4‚Ä¶ But none of those is IMO followable enough by
itself. Also, most of them are <em>very</em> old (maybe the world is telling me
something that I refuse to understand?).</p>

<p>And of course, there isn‚Äôt a single interface to work from. In Python only, we
can find
<a href="https://github.com/libfuse/python-fuse/tree/master/example">python-fuse</a>,
<a href="https://github.com/nrclark/pyfuse">Pyfuse</a>,
<a href="https://github.com/fusepy/fusepy">Fusepy</a>‚Ä¶ Where to start from?</p>

<p>‚Ä¶So I setup to try and help.</p>

<p>Over the past couple of weeks, I have been slowly working on my own version, and
presenting it as a <em>progressive set of tasks</em>, adding filesystem calls, and
being careful to thoroughly document what I write (but‚Ä¶ maybe my documentation
ends up <em>obfuscating</em> the intent? I hope not ‚Äî and, read on, I‚Äôve provided some
remediation).</p>

<p>I registered a GitLab project for <a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide">a hand-holding guide to writing FUSE-based
filesystems in Python</a>. This
is a project where I present several working FUSE filesystem implementations,
some of them RAM-based, some passthrough-based, and I intend to add to this also
filesystems backed on pseudo-block-devices (for implementations such as my
FIUnamFS).</p>

<p>So far, I have added five stepwise pieces, starting from the barest possible
<a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/1._emptyfs.py">empty
filesystem</a>,
and adding system calls (and functionality) until (so far) either a <a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/4._basic_stat_info.py">read-write
filesystem in RAM with basic<code>stat()</code>
support</a>
or a <a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/5._read_only_passthrough.py">read-only passthrough
filesystem</a>.</p>

<p>I think providing fun or useful examples is also a good way to get students to
use what I‚Äôm teaching, so I‚Äôve added some ideas I‚Äôve had: <a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/useful/dnsfs.py">DNS
Filesystem</a>,
<a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/useful/markdown_compiling_fs.py">on-the-fly markdown compiling
filesystem</a>,
<a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/useful/unzipfs.py">unzip
filesystem</a>
and <a href="https://gitlab.com/gunnarwolf/fuse_in_python_guide/-/blob/main/useful/uncommentfs.py">uncomment
filesystem</a>.</p>

<p>They all provide something that could be seen as useful, in a way that‚Äôs easy to
teach, in just some tens of lines. And, in case my comments/documentation are
too long to read, <code>uncommentfs</code> will happily strip all comments and whitespace
automatically! üòâ</p>

<p>So‚Ä¶ I will be delivering my talk <a href="https://www.chipy.org/meetings/288/">tomorrow (2024.10.10, 18:30 GMT-6) at
ChiPy</a> (virtually). I am also presenting
this talk virtually at <a href="https://eventol.flisol.org.ar/events/jrsl-2024-santa-fe/">Jornadas Regionales de Software
Libre</a> in Santa Fe,
Argentina, next week (virtually as well). And also in November, in person, at
<a href="https://nerdear.la/">nerdear.la</a>, that will be held in Mexico City for the
first time.</p>

<p>Of course, I will also share this project with my students in the next couple of
weeks‚Ä¶ And hope it manages to lure them into implementing FUSE in Python. At
some point, I shall report!</p>




      </div></div>
  </body>
</html>
