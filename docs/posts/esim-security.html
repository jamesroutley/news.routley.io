<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://security-explorations.com/esim-security.html">Original</a>
    <h1>ESIM Security</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p>In a result of its research investigation efforts, Security Explorations, a research lab of AG Security Research company, conducted security analysis of eSIM technology.</p>
		<p>This section of our website presents initial information regarding the project.</p>
		<h3>Notes</h3>
		<p>We broke security of <a href="https://kigen.com/">Kigen</a>(*) <a href="https://en.wikipedia.org/wiki/EUICC">eUICC</a> card with <a href="https://www.gsma.com/about-us/">GSMA</a> consumer certificates installed into it.</p>
		<p>The eUICC card makes it possible to install the so called eSIM profiles into target chip. eSIM profiles are software representations of mobile subscriptions. For many years such mobile subscriptions had a form of a physical <a href="https://en.wikipedia.org/wiki/SIM_card">SIM card</a> of various factors (SIM, microSIM, nonoSIM). With eSIM, the subscription can come in a pure digital form (as a software bundle), it can also carry Java Card applications.</p>
		<p>According to Kigen:
		</p><p>1) eSIMs are &#34;as secure and interoperable as SIM cards [...] thanks to the multi-layered GSMA eSIM certification scheme that protects device makers, device owners and mobile network operators (MNOs)&#34; (<a href="https://kigen.com/wp-content/uploads/2020/11/Kigen-An-essential-guide-to-GSMA-eSIM-certification.pdf">source</a>)</p>
		<p>2) &#34;Kigen OS offers the highest level of logical security when employed on any SIM form factor, including a secure enclave&#34; and &#34;Kigen SIM OS features help differentiate, scale and grow revenues with zero compromise security&#34; (<a href="https://kigen.com/products/sim-os/">source</a>)</p>

		<p>The hack proves that our <a href="https://security-explorations.com/java-card.html">research on Java Card from 2019</a> did matter. Oracle indicated the <a href="https://security-explorations.com/materials/SE-2019-01-ORACLE.pdf">vulnerabilities we reported</a> to the company in 2019 were rather irrelevant (the company referred to them as &#34;security concerns&#34;) / did not affect their production Java Card VM. These are now proved to be real bugs.</p>
		<p>This is likely the first successful public hack against:</p>
		<ul>
		<li>consumer GSMA eUICC</li>
		<li>Kigen eSIM (Kigen <a href="https://kigen.com/resources/press-releases/over-2-billion-kigen-sims/">press releases</a> and <a href="https://kigen.com/company/">web pages</a> implicate over 2 billion SIMs enabled by Kigen secure SIM OS)</li>
		<li>EAL(**) certified GSMA security chip (<a href="https://www.infineon.com/cms/en/product/security-smart-card-solutions/security-controllers/serial-interface-security-controllers/slc37esa1m2/">SLC37 chip</a> based on 32-bit ARM SecurCore SC300 processor from <a href="https://www.infineon.com/">Infineon</a>)</li>
		</ul>			
		<p>The attack against Kigen eUICC relies both on physical access to sample card along knowledge of the keys used for malicious Java app installation. The remote over-the-air (OTA) vector can&#39;t be excluded - our Proof of Concept code mimics a malicious applet installation over OTA <a href="https://www.etsi.org/deliver/etsi_ts/123000_123099/123048/05.09.00_60/ts_123048v050900p.pdf">SMS-PP protocol</a> (Short Message Service Point to Point) on a target Kigen eUICC. In that context, knowledge of the keys is a primary requirement for target card compromise.</p>
		<p>The hack proves no security / isolation for the eSIM profile and Java apps (no security for eUICC memory content).</p>
		<p>It&#39;s worth to note that while this work builds on our past Java Card research from 2019 (along [<a href="https://www.blackhat.com/presentations/bh-asia-02/LSD/bh-asia-02-lsd-article.pdf">25</a>] [<a href="https://packetstorm.news/download/34653">years</a>] [<a href="https://security-explorations.com/materials/se-2012-01-report.pdf">of</a>] [<a href="https://security-explorations.com/materials/SE-2013-01-ORACLE.pdf">Java</a>] [<a href="https://security-explorations.com/materials/se-2014-02-report.pdf">hacking</a>] experience), it required development of some new exploitation techniques / know-how.</p>
		<p>We hope the hack brings eSIM security along associated security risks to the focus of mobile network operators (MNOs), vendors, security researchers and security companies. This is important in the context of somewhat bold security claims / overconfidence of eUICC vendors (vide <a href="https://security-explorations.com/samples/kigen_euicc_cert.txt">leaf eUICC cert valid for 100 years</a>) and MNO assumptions pertaining to profile trust and its storage in a tamper-proof security element (MNO profile integrity / no compromise / no tampering assumed).</p>
		<p>(*) as denoted by eUICC / EUM certificates and card EID</p>
		<p>(**) <a href="https://www.gsma.com/solutions-and-impact/technologies/esim/wp-content/uploads/2021/08/SGP.21-v2.4.pdf">RSP specification</a> impose minimum EAL4 level (&#34;4.14.1 eUICC Certification Requirements&#34;, page 55)</p>
		<h3>Crypto Proof</h3>
		<p>As a result of eUICC compromise, we were able to extract private <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">ECC</a> key for the certificate identifying target GSMA card.</p>
		<p>The cryptographic proof for a successful eUICC compromise can be downloaded from <a href="https://security-explorations.com/samples/kigen_euicc_hack_proof.tar.gz">this</a> location. The proof was provided to Kigen on Mar 17, 2025 (it was confirmed by the company on Mar 20, 2025).</p>
		<h3>Demonstration movies</h3>
			<li>&#34;Kigen eUICC simulated over-the-air app install and card compromise&#34;, MP4 movie file, 39MB
			<p>
          <a href="https://security-explorations.com/samples/kigen_euicc_demo1.mp4"><img src="https://security-explorations.com/samples/kigen_euicc_demo1.jpg" width="300" height="170"/></a>
			</p></li>
			<li>&#34;Kigen eUICC identity certificate and private key extraction&#34;, MP4 movie file, 13MB
			<p>
          <a href="https://security-explorations.com/samples/kigen_euicc_demo2.mp4"><img src="https://security-explorations.com/samples/kigen_euicc_demo2.jpg" width="300" height="170"/></a>
			</p></li>		
		<h3>GSMA certificate theft implications</h3>
		<p>The theft of arbitrary GSMA consumer certificate has the following implications:</p>
		<p>1) one can download arbitrary profiles (&#34;software&#34; SIM cards) from MNOs in cleartext, we have used Kigen eUICC cert to download decrypted eSIM profiles for various MNOs (ATT, Vodafone, O2, Orange, Bouygues Telecom, DTAC, China Mobile, CMHK and T-Mobile in particular), see <a href="https://security-explorations.com/samples/china_mobile_esim.png">sample profile</a> output</p>
		<p>2) GSMA cert theft makes UICC security element (certified, tamper-proof one) irrelevant - no need to hack the HW / UICC card of which goal is to keep MNO secrets secure</p>
		<p>3) profiles contain MNO secrets (subscriber / network configs, secret / OTA keys, Java apps), some apps might be sensitive (call control, etc.), some keys might be shared across profiles / UICCs (for over-the-air SMSPP and/or Cell Broadcast) 
		</p><p>4) network operators key OPc and Authentication Management Field (AMF) are two very critical secret keys embedded in eSIM profiles, these should be safeguarded by the network operators at any cost (see this <a href="https://medium.com/uw-ictd/lte-authentication-2d0810a061ec">Medium post</a> on LTE security for explanation)</p>
		<p>5) the apps can be extracted for inspection (for bug hunting / secrets, etc.), the functionality of our codes can extract and disassemble the apps in an automatic fashion (see <a href="https://security-explorations.com/samples/att_usa_app.png">sample app</a> extraction output from <code>loadBlock</code> profile section)</p>
		<p>6) the downloaded profile can be modified and put into arbitrary eUICC, we have verified that such a modified profile (with custom Java STK app injected) works fine (for calls, messaging, etc.). Currently, there is no ability for the MNO to detect their profile has been tampered. Modified Orange profile loaded into test eUICC card and used with Samsung 5G phone is illustrated by <a href="https://security-explorations.com/samples/custom_app_on_orange_esim_tool_view.png">screenshot 1</a> and <a href="https://security-explorations.com/samples/custom_app_on_orange_esim_phone_view.png">screenshot 2</a>.</p>
		<p>7) the downloaded profile can be potentially modified in such a way, so that the operator loses control over the profile (no ability for remote control / no ability to disable / invalidate it, etc.), the operator can be provided with a completely false view of the profile state (the result of its remote management ops in particular) or all of its activity can be subject to monitoring (vide rogue apps mimicking / proxying behavior of real ones)</p>
		<p>In our opinion, the ability for a single broken eUICC / single eUICC GSMA cert theft to peek into (download in plaintext) eSIMs of arbitrary MNO constitutes a significant eSIM architecture weak point (we see no base for extending MNO trust beyond its own network).</p>
		<h3>Kigen notification / reports</h3>
		<p>We initiated contact with Kigen on Mar 17, 2025 (crypto proof delivery to media addr due to missing dedicated security contact). On Mar 21, 2025 Kigen was provided with a technical document describing successful compromise of its eUICC and secrets theft.</p>
		<p>The document was provided to Kigen completely free of any charge and without any conditions. We however indicated to Kigen that it should not publish / should not share the info received with any other 3rd party (outside of Kigen) as it contains our unpublished know-how / IP.</p>
		<p>Per response received from Kigen on Mar 21, 2025, the company has all the information required to start work aimed at addressing the issues (<i>&#34;The level of detail in your findings has been incredibly helpful - your work has played a crucial role in enabling us to fully understand the issue and begin crafting effective mitigation strategies&#34;</i>).</p>
		<p>On Mar 30, 2025, Kigen was provided with additional information about multiple (100+) security vulnerabilities affecting its Java Card VM  implementation.</p>
		<p>On Apr 1, 2025, we provided Kigen with a brief technical doc explaining potential approach to the addressing / mitigation of the 2 core issues exploited in the attack.</p>
		<p>On Apr 17, 2025, Kigen asked for &#34;the list of entities we intend to name (planned to be referenced in the July 2025 disclosure), so that Kigen could ensure timely coordination with those organizations. On Apr 18, 2025, we provided Kigen with a full list of MNO / EID corresponding to eSIM profiles downloaded with the use of a compromised Kigen eUICC identity.</p>
		<p>On Jun 10, 2025, we informed Kigen that we developed a Proof of Concept code that is able to reliably and in an automatic fashion exploit Kigen eUICC cards (card compromise, memory access, eUICC leaf cert extraction, <a href="https://security-explorations.com/samples/kigen_euicc_keys_dump.txt">secret keys dump in plaintext</a>). We also provided Kigen with a few ideas that are worth considering implementation in Kigen Sim OS as these could mitigate the exploitation scenario. Finally, we notified Kigen about a key instance shared by ECASD domain of arbitrary Kigen eUICC cards (cards available under different brands).</p>
		<h3>Reward from Kigen</h3>
		<p>On Mar 31, 2025, Kigen informed us that it is willing to reward us with <a href="https://security-explorations.com/recognition.html">$30K</a> &#34;for the detailed work we have performed to identify the vulnerability and to establish a 90-day non-disclosure period&#34;.</p>
		<p>The reward has been paid in full by Kigen in three installments (on Day 1, Day 45 and Day 90).</p>
		<h3>The core issues</h3>
		<p>The core issues exploited in the attack against Kigen card rely on the same type confusion condition as <a href="https://security-explorations.com/materials/SE-2019-01-ORACLE.pdf">Issues 1 and 2</a> from 2019:</p>
			<p><a href="https://security-explorations.com/samples/javacard_issue_2019_vs_2025.png"><img src="https://security-explorations.com/samples/javacard_issue_2019_vs_2025_small.png" width="300" height="170"/></a></p><p>The only difference is in the way (direction) target exploit (type confusion) condition is set up.</p>		
		<p>One might argue that this is a completely new / unknown issue (missing checks in <i>getfield</i> / <i>putfield</i> bytecodes), but we stick to the rationale that it is not as:</p>
		<ul>
		<li>2019 issues clearly pointed out the possibility of a type confusion between an object and array instance</li>
		<li>2019 issues signalled the problem of an overlap between array size and object instance field</li>
		<li>2019 issues were mostly around missing type safety checks in bytecode implementation</li>
		</ul>			
		<p>As a minimum, the vendor should have implemented security measures that would detect type casts between arrays of bytes and object instances (in either direction) and that would hide array size field (made it part of an object header). None of that took place, thus our conclusion that the case is about old / known bugs and the impact of not addressing them (or bad addressing).</p>
		<h4>Kigen &#34;mitigation&#34;</h4>
		<p>Kigen decided to implement type safety checks aimed to detect arbitrary casts between object and integer types. The checks were introduced for almost all <a href="https://docs.oracle.com/en/java/javacard/3.1/jc-vm-spec/F12650_05.pdf">JavaCard bytecode instructions</a> (there are ~180 of them). Unfortunately, the design / overall idea was completely broken due to the incomplete type state information (only type for the stack top checked), no real control-flow tracking and introduction of an arbitrary union / univesal type (corresponding to both integer and object type). The end result could not be different (100+ broken bytecode locations). In other words, Kigen fell the victim of anyone trying to implement some form of a bytecode verification without proper background / &#34;state of the art&#34; knowledge on the topic.</p>
		<h3>GSMA and Oracle notifications</h3>
		<p>Due to the potential impact of some parts of this research to the whole telecom / mobile industry, on Mar 31, 2025 we have reached out to <a href="https://www.gsma.com/solutions-and-impact/technologies/security/">GSMA security</a> and provided it with a pre-disclosure notification document (Apr 07, 2025). The notification was destined for the review by the <a href="https://www.gsma.com/solutions-and-impact/technologies/security/wp-content/uploads/2024/09/GSMA-CVD_brochure_2024-25-06-24-updated-150924.pdf">CVD Panel of Expert Companies</a> consisting of major eUICC / mobile phone vendors.</p>
		<p>We indicated to GSMA that the case was not directly applicable to <a href="https://www.gsma.com/solutions-and-impact/technologies/security/gsma-coordinated-vulnerability-disclosure-programme/">GSMA CVD program</a> as it was about old / known bugs and the impact of not addressing them (or bad addressing) by the industry and/or technology owner. In that context, it was more about an early notification with respect to the planned public disclosure.</p>
		<p>We gave GSMA permission to share the notification document among the organisation and its <a href="https://www.gsma.com/get-involved/gsma-membership/our-members/">members</a>. We indicted that this is GSMA responsibility and decision regarding who gets early notification / info prior to the public disclosure (the 2nd week of Jul 2025, in accordance with the 90-day non-disclosure period agreed with Kigen).</p>
		<p>On Apr 10, 2025, we also shared a pre-disclosure notification with Oracle Java Card team located in Germany. Oracle got back to us on Apr 18, 2025 via its Security Alert. The company informed that its Java Card team was reviewing the report and that it will get back to us soon once the team completes the review.</p>
		<p>Oracle has not expressed interest in a brief technical doc explaining possible approach to address / mitigate the core issues that are used in the new exploit and offered to be shared with the company completely for free (Apr 24, 2025). The company provided results of its analysis / review of the notification doc on Jul 03, 2025. Oracle response can be seen <a href="https://security-explorations.com/materials/oracle_euicc_compromise_reponse.pdf">here</a>.</p>
		<h3>Vulnerable Kigen products / fixing status / patch details</h3>
		<p>The following information was received from Kigen on Jun 30, 2025 with respect to the vulnerability impact and its fixing:</p>		
		<ul>
		<li>Impacted Product: Kigen ECu10.13, an eSIM product</li>		
		<li>Severity: The compound vulnerability has been classified as CVSS v3.1 score: 6.7 (Medium)</li>		
		<li>Vector: <a href="https://www.first.org/cvss/calculator/3-1#CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:M/MAV:P/MAC:H/MPR:N/MUI:N/MS:C/MC:H/MI:H/MA:H">AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:M/MAV:P/MAC:H/MPR:N/MUI:N/MS:C/MC:H/MI:H/MA:H</a></li>		
		</ul>
		<p>The CVSS score provided by Kigen is an Environmental score (Base score has severity 7.1 High). This score assumes physical access vector only. With Network access vector assumed (the issues can be exploited over-the-air* upon keys knowledge as indicated in our reports provided to Kigen), the Base CVSS score is 9.1 (Critical). We notified Kigen of this potential CVSS miscalculation on Jul 01, 2025.</p>
		<p>Kigen informed us that the company has coordinated with the GSMA to update the <a href="https://www.gsma.com/get-involved/working-groups/gsma_resources/ts-48-v7-0-generic-euicc-test-profile-for-device-testing/">TS.48 Generic Test Profile specification</a>, addressing the chain-of-trust weakness that enabled Remote Applet Management by an unauthorised actor. Simultaneously, Kigen issued a patch across all affected eSIM variants as a precautionary measure, both in-field and in inventory.</p>
		<p>The fix disallows applet installation in TS.48 Test Profiles, in line with TS.48 v7. It introduces JavaCard Virtual Machine hardening to prevent the specific bytecode manipulation pathway outlined in our reports.</p>
		<p>Kigen indicated that this patch has already been distributed to millions of eSIMs. The company said that it has also engaged indirectly with other eSIM vendors via the GSMA CVD programme and communicated directly with all known impacted mobile networks and customers to ensure the value of our findings is well understood across the ecosystem, and that stakeholders are equipped to mitigate accordingly.</p>
		<p>Kigen has not provided the CVE number(s) corresponding to the reported issues. The company justified this as following:</p>
		<p><i>Given the extent of private coordination and outreach - including direct notification to over 100 organisations and indirect notice to hundreds more through the CVD programme - we have opted not to request a CVE at this time. We feel the objectives of responsible disclosure have been met without introducing public registry overhead. We remain open to future CVE registration if ecosystem needs evolve.</i></p>
		<p>(*) SMSPP over-the-air vector is simulated by our toolkit for malicious applet installation</p>
		<h4>Kigen eUICC FW check</h4>
		<p>According to information provided by Kigen, &#34;ECu10.13&#34; string indicates vulnerable eUICC card. We found out that this sequence is returned by the GET DATA command for an unpublished 0xDF1F item (&#34;80 ca df 1f 00&#34; APDU). Sample log illustrating FW version retrieval for Kigen eUICC through OTA SMSPP and our toolkit can be checked <a href="https://security-explorations.com/samples/kigen_euicc_ota_fw_check.txt">here</a>.</p>
		<h3>Initial research impact</h3>
		<p>The research [<a href="https://security-explorations.com/materials/se-2011-01-hitb2.pdf">once</a>] [<a href="https://security-explorations.com/materials/idemia_exchange.pdf">again</a>] questions the value carried by various certification schemes.</p>
		<p>Kigen&#39;s <a href="https://kigen.com/wp-content/uploads/2020/11/Kigen-An-essential-guide-to-GSMA-eSIM-certification.pdf">guide to GSMA eSIM certification</a> indicates that GSMA eUICC (eSIM) must be certified to an assurance level of EAL4+. Assessment and issuance of the certification report is performed by a security laboratory qualified by a Common Criteria certification body (i.e. ANSSI or BSI), which conducts penetration tests aimed to verify whether designed security features are properly implemented. This is all done with respect to both an off-card actor or an on-card application.</p>
		<p>The research also demonstrates that eSIM hacking makes things easier from a point of a backdoor / tampered profile (no need for low level, eUICC specific tampering / exploitation, which cannot be excluded - malicious Java app can still target underlying eUICC).</p>
		<p>The hack should trigger attention of mobile network operators to the topic (there are 500+ of them according to <a href="https://www.gsma.com/get-involved/gsma-membership/our-members/">GSMA pages</a>).</p>
		<p>It should revise MNOs trust / change their perception with respect to eUICC security and eSIMs in general (vide single broken eUICC / single eUICC GSMA cert theft and its power).</p>
		<h3>The warning call for mobile phone vendors</h3>
		<p>The eUICC (eSIM) chip is embedded (is part of a silicon) in most modern smart phones. While default access seems to be restricted to trusted parties only (i.e. access to <a href="https://developer.apple.com/support/nfc-se-platform">Apple NFC &amp; SE Platform</a> and <a href="https://developer.samsung.com/ese/overview.html">Samsung eSE SDK</a>) in our opinion this is irrelevant (*).</p>
		<p>If target eUICC chip runs vulnerable Java Card VM implementation, its security should be taken with cautious (vulnerable Java Card VM can lead to chip compromise and secrets extraction as illustrated by this research, backdooring of a target eUICC can&#39;t be excluded too).</p>
		<p>Target eUICC chips may run some sensitive applications (digital wallets / payment, digital car keys, transportation cards, access / identification cards, etc.). In case of a successful eSIM compromise, the security / credibility of such apps may be affected.</p>
		<p>With respect to the above, the research and demonstrated attack should serve as an early warning call for mobile phone vendors.</p>
		<p>(*) our experience indicates that a target card (i.e. SIM / USIM / eUICC) running on top of a vulnerable JavaCard VM can be always compromised (100% success rate)</p>
		<h3>GSMA inquiry around eUICC / eSA certification scheme</h3>
		<p>We inquired GSMA on the issues pertaining to <a href="https://www.gsma.com/solutions-and-impact/industry-services/wp-content/uploads/2025/02/eSIM-Compliance-and-Certification-Webinar-17-PDF.pdf">eUICC / eSA certification</a> process, its costs(*), mandatory status, liabilities and &#34;privileged&#34; parties (with a power to provision potentially malicious apps into eSIMs). Our questions along answers provided by GSMA staff members on Jun 27, 2025 can be found in <a href="https://security-explorations.com/materials/gsma_esa_euicc_inquiry.pdf">this document</a>.</p>
		<p>(*) in the context of the exploit presence and Kigen investments to ensure the company is building secure products</p>
		<h3>GSMA spec changes</h3>
		<p>As a result of this research, GSMA decided to <a href="https://bravenewnet.com/esim-alert-gsma-shuts-down-all-ts-48-test-profiles/">shut down all test profiles</a>.</p>
		<p>The new <a href="https://www.gsma.com/get-involved/working-groups/gsma_resources/ts-48-v7-0-generic-euicc-test-profile-for-device-testing/">TS.48 Generic Test Profile specification</a> aims to address the issue by preventing the ability for an unauthorized actor to install potentially malicious Java Card applications on eSIM.</p>
		<p>We fear this might not be enough (this might not address the core of the issue) due to the following:</p>
		<ul>
		<li>the problem has its origin in insecure Java Card VM architecture (split verification process, unverified bytecode execution)</li>
		<li>per specs, eUICC need to support Java Card apps (eSIM profiles can embed Java Card apps)</li>
		<li>there are many parties which theoretically might be able to provision arbitrary Java Card apps into eSIM (MNOs, RSP server owners, eUICC vendors, GSMA sub/certificate owners, etc.).</li>
		</ul>
		<p>That alone creates a significant threat surface from a point of view of potentially bad actors (including rogue MNO / eSIM provider). One cannot exclude rougue eSIM store too.</p>
		<h3>eUICC / Java Card exploitation toolkit</h3>
		<p>Our custom toolset makes it possible to test Java Card capable chipsets (SIM / USIM / eUICC) for the presence of security weaknesses and to investigate and exploit these in a convenient way through commands / scripting.</p>
			<p><a href="https://security-explorations.com/samples/toolkit.png"><img src="https://security-explorations.com/samples/toolkit_small.png" width="300" height="170"/></a></p><p>The toolkit implements BSC command (Basic Security Check) that provides a brief summary(*) of a target Java Card capable eUICC from a point of view of bytecode security:</p>
			<pre>scard&gt; bsc
- castcheck        [Check for arbitrary int / obj casts]
- ptrgranularity   [Check for ptr granularity / tr table presence)]
- locvaraccess     [Check for arbitrary local variable access]
- stkframeaccess   [Check for arbitrary stack frame access]
- instfieldaccess  [Check for arbitrary instance field access]
- objarrconfusion  [Check for arbitrary object / array type and size field confusion]
			</pre>
			<p>Sample output / &#34;report&#34; for the checks conducted for Kigen eUICC card can be seen <a href="https://security-explorations.com/samples/bsc_check_kigen.txt">here</a>.</p>
		<p>The toolset makes it possible to download arbitrary eSIM profile in a plaintext and user friendly form with the use of a SW eUICC identity (a bundle of certificate chains, eUICC info and private key is completely sufficient for that).</p>
		<p>Upon extracting the private eUICC key, the target card is not needed any more as the tool relies on a software (digital) form of the eUICC for its operation.</p>
		<p>(*) which can&#39;t be perceived in terms of any comprehensive evaluation, but rather as providing an initial &#34;feel&#34; about target chip&#39;s Java Card VM security strength</p>	
		<h3>Remote SIM provisioning (RSP) servers</h3>
		<p>We verified that arbitrary eSIM profiles could be downloaded from various production RSP servers including those operated by Oberthur (IDEMIA) and Thales (major SIM / USIM / eUICC card vendors).</p>
		<p>It seems, no detection is made by RSP servers with respect to the rogue / compromised eUICC identity as of now (vide the confirmed use of a single eUICC identity for unusual(*) eSIM profile download patterns).</p>
		<p>It&#39;s worth to note that EID of a target eUICC was required (most likely for auth / profile binding purposes) by only one of tested operators prior to eSIM activation (T-Mobile USA).</p>
		<p>(*) understood in a context of multiple downloads, downloads conducted within a given time frame, with respect to same MNO or with respect to MNOs spread across various countries, all done with respect to same eUICC identity (EID)</p>		
		<h3>Orange Poland mirrored eSIMs test</h3>
		<p>Orange Poland makes it possible for its subscribers to request an eSIM profile (or several of them) that acts as a mirror for subscriber&#39;s primary number (eSIM can receive all SMS and calls as if it was the primary number):</p>
			<p><a href="https://security-explorations.com/samples/orange_extra_esims_screenshot.png"><img src="https://security-explorations.com/samples/orange_extra_esims_screenshot_small.png" width="300" height="170"/></a></p><h4>Shared secret keys test</h4>
		<p>We used a compromised Kigen eUICC identity to download the content of two Orange Extra eSIM profiles associated with a given subscriber in plaintext.</p>
		<p>Investigation of the profiles&#39; content revealed the following:</p>
		<ul>
		<li>network operators key / OPc parameters responsible for security of the subscriper&#39;s identity were different (each eSIM was bound to a different phone number, the network routed eSIM numbers as if they were a primary one)</li>
		<li>OTA keys used for remote management were also different (no key sharing)</li>
		</ul>
		<h4>eSIM spoofing / cloning test</h4>
		<p>On Jul 04, 2025 we conducted a test in the Orange network of which aim was to verify the impact of a spoofed / cloned eSIM profile.</p>
		<p>For the purpose of the test, we installed an identical (cloned) Orange eSIM profile (downloaded in plaintext with the use of compromised Kigen eUICC identity) on two different physical eUICC cards. These two cards (associated with the same mobile network subscriber) have been then inserted into two different Samsung phones (PHONE 1 and PHONE 2).</p>
		<p>The players / test information:</p>
		<ul>
		<li>PHONE A (eSIM profile) - legit user</li>
		<li>PHONE B (eSIM profile clone) - rogue / malicious user</li>
		</ul>
		<p>The test proceeded in the following steps:</p>
		<p>1) PHONE A was turned on, we confirmed that arbitrary phone calls / SMS messages could be established with it (legit user could use the phone as usual)</p>
		<p>2) PHONE B was turned on by the malicious user, we confirmed that arbitrary phone calls / SMS messages started to be established with PHONE B, not PHONE A, we verified that PHONE A stopped receiving SMS messages / calls destinated to real subscriber number</p>
		<p>3) PHONE B was turned off, PHONE A could start receiving calls / SMS messages upon network re-attach (such as through phone reset or plane-mode on / off procedure), PHONE A did not receive SMS messages (or their copies) received by malicious PHONE B in step 2 (at the time of hijacking) - the network assumed these messages have been already successfully delivered (they were).</p>
			<p><a href="https://security-explorations.com/samples/sim_clone_operation.png"><img src="https://security-explorations.com/samples/sim_clone_operation_small.png" height="280"/></a></p><p>The above test confirmed that eSIM cloning makes it possible to hijack identity of legitimate MNO subscribers. The hijacking can be conducted for arbitrary time period (attacker&#39;s choice). The user might not be aware* of the fact that its MNO identity has been hijacked and that it is not receiving calls / SMS messages (no visible trace at user end).</p>
		<p>The possibility to hijack phone of a target MNO subscriber can potentially have serious implications. Multiple 3rd parties (i.e. Google Mail, e-banking sites) rely on SMS message for 2FA / OTP authentication. We verified that cloned eSIM can be abused for GMail.</p>
			<p><a href="https://security-explorations.com/samples/gmail_esim_clone_test.png"><img src="https://security-explorations.com/samples/gmail_esim_clone_test_small.png" width="300"/></a></p><p>According to some <a href="https://stackoverflow.com/questions/15887092/how-are-duplicate-sim-cards-detected-by-the-provider">sources</a>, the network should not allow access for duplicate SIMs (corresponding to same IMSI number) / SIMs already marked by the network as active. This does not seem to be the case for Orange network.</p><p>GSMA eSIM Security Group and ecosystem is well aware of SIM cloning threat (page 10 of this <a href="https://www.gsma.com/solutions-and-impact/industry-services/wp-content/uploads/2025/02/eSIM-Compliance-and-Certification-Webinar-17-PDF.pdf">presentation</a>). Yet, we think it is worth to bring the results of this real-life test to the public attention to emphasize broad importance of eSIM security / the other impact of compromising a single eUICC with the use of Java Card issues.</p>
		<p>It&#39;s worth to note that a compromise of the eSIM chip embedded in the mobile phone may lead to eSIM cloning as malicious applet may access (steal by the means of memory reading / key decryption) content of all other eSIM profiles installed on the phone (eSIM chip). This makes eSIM cloning issue relevant.</p>
		<p>(*) the copies of messages delivered to each mirrored eSIM are received by the main physical card though (vide trace leaving), the sole hijack possibility is key though</p>
		<h3>The ultimate (pending) goal</h3>
		<p>The actual goal of this research was to find remote vulnerability affecting eUICC for arbitrary mass-market mobile phone device (such as Samsung or Apple). One cannot exclude remote chip compromise - per GSMA standards, eUICC are obliged to implement remote management / remote SW update functionalities, which alone constitute a significant threat surface (beyond the <a href="https://security-explorations.com/materials/sim_card_notes.pdf">threat surface for SIM / USIM cards</a>).</p>
		<p>We failed to gain funding for this research through <a href="https://security-explorations.com/microsoft-warbird-pmp.html">our project</a> designated for that purpose (*). We also failed to <a href="https://security-explorations.com/sim-usim-cards-news.html">attract 3rd parties</a> to the topic of SIM / USIM cards security analysis. Thus, somewhat incomplete (initial) research results / goals.</p>
		<p>(*) in that context Microsoft could have had a real, potentially positive and wider impact, with proper funding we would also consider providing GSMA <a href="https://www.gsma.com/get-involved/gsma-membership/our-members/">members</a> with research results completely for free</p>
		<h3>Other eUICC vendors</h3>
		<p>Please, note that the hack should not be perceived in terms of a sole failure by Kigen company as it was primarily possible due to a ~5 years old flaw in Java Card VM (there has been some mitigations observed, it&#39;s not clear if these aimed to block the old issues though).</p>
		<p>We believe there are systemic issues in the telecom ecosystem that make this (and can make future hacks like this) possible. Please, see our <a href="https://security-explorations.com/sim-usim-cards.html%20">SIM / USIM cards project</a> page for further information / insights on the topic.</p>
		<p>While there are other vendors of eUICC elements such as NXP and Thales in particular, we have limited means to verify if their products are secure / conform to vendors&#39; claims (obstacles regarding access to card samples, no sale policy to security companies, access through NDA only, etc.).</p>
		<p>We have learned that no eSIM does bytecode verification (per eSIM protection profile described in <a href="https://www.gsma.com/solutions-and-impact/technologies/esim/gsma_resources/sgp-25-euicc-for-consumer-and-iot-devices-protection-profile-v2-1/">SGP.25</a> and the <a href="https://www.oracle.com/java/technologies/java-card/javacard-protection-profile.html">Java Card protection profile</a> in particular). This implicates an architectural weakness. This implicates that all eSIMs are likely vulnerable.</p>
		<p>With respect to Java Card vulnerabilities from 2019, we suggest to inquire respective eUICC vendor directly for the fixing / impact status.</p>
		<h4>G&amp;D eUICC</h4>
		<p>On Jul 02, 2025 we have used Comprion <a href="https://www.comprion.com/products-solutions/products-solutions-a-z/esim-test-profile-service/">eSIM Test Profile Service</a>(*) to install TS.48 test profile on a consumer GSMA eUICC from Giesecke Devrient:</p>		
			<p><a href="https://security-explorations.com/samples/gd_euiccinfo2.png"><img src="https://security-explorations.com/samples/gd_euiccinfo2_small.png" width="300" height="170"/></a>			
			<a href="https://security-explorations.com/samples/eTPS_screenshot.png"><img src="https://security-explorations.com/samples/eTPS_screenshot_small.png" width="300" height="170"/></a></p><p>We then used our toolkit and profile&#39;s <a href="https://www.gsma.com/newsroom/wp-content/uploads/GSMA_TS48_eSIM_GTP_Profile_Structure-v4.0.xlsx">known OTA key sets</a> to install the malicious (test) applet into the chip over simulated OTA SMSPP protocol.</p>		
		<p>Initial analysis indicates the following:</p>		
		<ul>		
		<li>while the chip allows for arbitrary casts, it implements some form of a memory safety similar to the idea from our report</li>	
		<li>the size field of the array object does not overlap with Object instance data</li>		
		</ul>		
		<p>This makes the attack / bytecode sequence used for Kigen eUICC not directly applicable to tested G&amp;D eUICC. This also goes along GSMA answer to <a href="https://security-explorations.com/materials/gsma_esa_euicc_inquiry.pdf">question 1</a> (&#34;some eUICC have additional proprietary mechanisms within their JVM implementations that, while not a full on-card bytecode verification, would stop some attacks and as a minimum require further, highly complex work to be successfully attacked&#34;).</p>		
		<p>BSC command summary for G&amp;D chip can be seen <a href="https://security-explorations.com/samples/bsc_check_gd.txt">here</a>.</p>		
		<p>It&#39;s worth to mention that target GD eUICC contained a leaf certificate valid for <a href="https://security-explorations.com/samples/gd_euicc_cert.txt">7984 years</a>.</p>
		<p>(*) for the purpose of this research, we subscribed to Comprion service a year ago (Jul 2024), but have not used it so far (on purpose)</p>		
		<h3>Summary of security mechanisms / features of a target card</h3>
		<p>The following lists security mechanisms / features that are either implemented or has been encountered by us during the research (and hacking) of a target Kigen eUICC card:</p>
		<ul>
		<li>EAL4/5 certification</li>
		<li>side-channel / fault injection attacks countermeasures</li>
		<li>Java Card Runtime security mechanisms / type-safe language features</li>
		<li>additional mitigation against arbitrary Java casts</li>
		<li>indirect Java pointers (pointers translation)</li>
		<li>integrity / Java pointers validation checks</li>
		<li>applet firewall (application isolation)</li>
		<li>eSIM profiles isolation</li>
		<li>stack isolation (separate java / native stack)</li>
		<li>non-executable memory (stack)</li>
		<li>tamper-proof silicon / secure processor (chip specific HW key for secrets storage)</li>
		<li>time of check/time of use (TOCTOU) checks for security sensitive runtime / config structures</li>
		</ul>			
		<p>The attack demonstrated through this research showed these did not matter.</p>		
		<p>Per information received from Kigen, target card did not implement Infineon’s Integrity Guard (security feature specific to unsupported chip variant).</p>
		<h3>Research complexity</h3>
		<p>This work started in Jul 2024 and initially took us ~8 months of work*. It required significant reverse engineering and R&amp;D efforts (see <a href="https://security-explorations.com/esim-security.html#details">details</a> for information regarding size of developed code).</p>
		<p>Each of our projects contains notes directory (<code>_re</code>). The notes directory for eSIM security research contains ~4200 files (the files we created to note down / record any important or relevant information spotted across the analysis / reverse engineering process). For a comparison, the <code>_re</code> directory for our <a href="https://security-explorations.com/microsoft-warbird-pmp.html">previous project</a> contains ~6800 files.</p>
		<p>The above should provide a better picture on the overall work complexity / R&amp;D effort conducted at our end while investigating security of target products.</p>
		<p>(*) we also spent 2 months of the non-disclosure period for various toolkit developments, additional Kigen reversing, shared keys investigation, reliable / automatic exploit development, spoofing test</p>
		<h3>On technology vendor&#39;s responsibility</h3>
		<p>Kigen took full responsibility for both the presence and resolution of the JavaCard vulnerabilities that have been identified in its eUICC OS. The company informed that it does not use Oracle’s JavaCard Reference Implementation in its commercial eUICC products. Its JavaCard Virtual Machine and Operating System were both developed entirely in-house from scratch to meet its performance, size, and security objectives.</p>
		<p>Kigen acknowledged that similarities - conceptual or structural - may have been inadvertently introduced with respect to Oracle RI (Reference Implementation), which explained some overlap with the findings we made <a href="https://security-explorations.com/java-card.html">public in 2019</a>.</p>
		<p>Kigen indicated that its team was not made aware of those findings at the time. It&#39;s worth to note that according to our communication archive we have <a href="https://security-explorations.com/samples/kigen_msg_nov_2020.txt">reached out to Kigen</a> (web form) in Nov 2020 as a follow up of a <a href="https://javacardforum.com/jcf-2020-webinar-series/">Java Card Forum webinar</a> conducted by the company with Orange.</p>
		<p>Regardless of whether a licensee uses Oracle RI directly or builds a new VM from it, reference implementation should have security issues addressed, so that arbitrary parties / licensees such as Kigen do not replicate / introduce these in their own implementation.</p>
		<p>Oracle is the primary source for all the information pertaining to what is needed to build a secure Java VM, what pitfalls / attacks to avoid. It is also the technology owner and licensor. In that context, it should be Oracle responsibility to provide state of the art, secure RI or at least notify licensees of any security problems affecting it.</p>
		<p>Java security can be complex and full of pitfalls. Building a secure Java VM can constitute a <a href="https://security-explorations.com/materials/se-javaland.pdf">significant challenge for Java vendor</a> itself. Leaving this job to licensees is like asking for trouble.</p>
		<h3>On the value of independent security research</h3>
		<p>Java Card vulnerabilities disclosed in 2019 by our company (and reported to the vendor) have been instrumental for the attack against Kigen GSMA eUICC card.</p>
		<p>If these vulnerabilities hadn&#39;t been <a href="https://www.securityweek.com/oracle-gemalto-downplay-java-card-vulnerabilities/">downplayed</a> by the vendor and instead been addressed at Java Card VM level (in runtime), the attack might have not been possible.</p>
		<p>In that context, the research highlights both the need for and value of independent security research along its impact to security of real-life systems. It also highlights the need for SW / HW vendors to listen to / take action and provide financial recognition for the work and contributions of external parties such as ours (vide <a href="https://security-explorations.com/materials/se_bugs_stats.pdf">127 security issues</a> reported to Oracle over the years and not rewarded financially in any way).</p>
		<h3>Some recommendations / take aways for MNOs and/or vendors</h3>
		<p>We recommend to take the following into account in the context of eSIM security:</p>
		<li>never rely on any shared secret keys / credentials for eSIM security</li>
		<li>request and/or implement JavaCard hardening / runtime fixes from your JavaCard / eUICC vendor (memory protection at least)</li>
		<li>request and/or implement bytecode verification at RSP server (Java Card application scanning prior to bundle delivery)</li>
		<li>always assume your apps, their logic, associated secrets and/or some eSIM content could be revealed (one compromised eUICC identity can be used to download and peek into eSIM of any MNO)</li>
		<li>keep in mind that code extraction from an arbitrary eUICC may facilitate a more in-depth analysis (and new bug discoveries) along side channel attacks (known code sequence)</li>
		<li>do not take vendors&#39; claims for granted, the telecom / mobile ecosystem in most cases relies on <a href="https://security-explorations.com/sim-usim-cards.html">&#34;security through obscurity&#34;</a></li>
		<li>keep in mind that we have not tested eSIM chips used in mobile phones coming from major vendors, we haven&#39;t tried all of the ideas we have around the topic</li>
		<p>One does need to keep in mind that eSIM insecurity primarily impacts end users. Arbitrary eSIM compromise may lead to compromise of secrets responsible for subscriber&#39;s privacy and security (security of voice / data communication in the mobile network).</p>
		<p>Both eSIM and mobile phones&#39; security architecture do not make it possible for users to inspect the content of the applications carried by eSIM profiles. The assumption is that these are safe / of a trusted orgin. This might not be the case. Same for the communication (SMSPP / CBS / BIP channels), which in most cases is done without any user consent. That architecture alone makes eSIM a perfect attack target and backdoor location for nation states / cybercrime groups.</p>
		
			 </div></div>
  </body>
</html>
