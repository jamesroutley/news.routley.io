<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tomscii.sig7.se/2021/01/Typing-latency-of-Zutty">Original</a>
    <h1>Measured: Typing latency of Zutty compared to other terminal emulators (2021)</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">
  
  <div itemprop="articleBody">
    <p>This is a follow-up post to my <a href="https://tomscii.sig7.se/2020/12/A-totally-biased-comparison-of-Zutty">previous article</a> comparing <a href="https://tomscii.sig7.se/zutty">Zutty</a> to
various other X terminal emulators. That assessment, while going into
a lot of detail, missed an important aspect: the typing latency of
each program.</p>

<p>On the most basic level, we are talking about the delay it takes for
an interactive program (such as a terminal emulator) to appropriately
respond to an input event, in this case by altering its screen output
in response to the user pressing a key. This is quite fundamental for
usability: high latencies tend to affect the user negatively, as the
constant lag between user action and perceptional feedback acts as a
(perhaps unregistered) mental burden.
<a href="https://pavelfatin.com/typing-with-pleasure/">This article</a> by Pavel
Fatin argues for the importance of sufficiently low latencies much
better than I could, so I encourage you to check it out.</p>

<p>Clearly, typing latency is an essential metric to consider when
evaluating any terminal emulator, and since I had the recent pleasure
of inflicting Zutty on a completely unassuming world of innocent Linux
users, it is only natural that I also benchmark it to demonstrate how
it fits in with other, more established programs. If you are not
familiar with my <a href="https://tomscii.sig7.se/2020/12/A-totally-biased-comparison-of-Zutty">previous article</a>, I encourage you to check it out,
as it contains a summary of all programs in my test that I will not
repeat here. In short: we will be looking at seven programs in total,
tested on the same hardware setup as documented there. The only
difference here is that I am testing a slightly newer revision of
Zutty (tagged as
<a href="https://github.com/tomscii/zutty/releases/tag/0.7">Release 0.7</a>)
with some fixes and enhancements that did not yet exist at the time
of my last article.</p>

<p>To measure the typing latency of each program, I used Pavel Fatin’s
excellent <a href="https://github.com/pavelfatin/typometer">typometer</a>. This program measures end-to-end latency: it
emits keypress events and captures the screen to note when it gets
updated (as actually visible to the user), and this is clearly the
right thing to do (check out Pavel’s cool article with lots of detail
on various components of latency).</p>

<p>The default measurement settings were used (200 chars with 150 ms
delay, using native API) with the exception that I also enabled async
mode. I did this to decouple the periodicity of typing from the
display lag, and also because in my experience it produced less noisy
results. To measure only essential latency induced by the programs
themselves, I ran each of them full-screen (without any window
decorations, their client area being equivalent to the root window)
for the time of the measurement in a non-compositing, lightweight
tiling window manager (i3). The screen resolution was 1920x1080 and
the LCD refresh rate 60 Hz. The machine was not running anything other
than the programs involved in the measurement.</p>

<p>Results:</p>

<p><img src="https://tomscii.sig7.se/files/zutty/latency/latency.png" alt=""/></p>

<p>Graph data in tabular format (all numbers are milliseconds):</p>

<table>
  <thead>
    <tr>
      <th>program</th>
      <th>minimum</th>
      <th>1st quantile</th>
      <th>median</th>
      <th>mean</th>
      <th>3rd quantile</th>
      <th>maximum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xterm</td>
      <td>1.04</td>
      <td>1.74</td>
      <td>1.96</td>
      <td>2.21</td>
      <td>2.68</td>
      <td>8.14</td>
    </tr>
    <tr>
      <td>Zutty</td>
      <td>5.5</td>
      <td>6.22</td>
      <td>6.42</td>
      <td>6.51</td>
      <td>6.72</td>
      <td>10.58</td>
    </tr>
    <tr>
      <td>Kitty</td>
      <td>7.92</td>
      <td>8.90</td>
      <td>8.99</td>
      <td>8.96</td>
      <td>9.07</td>
      <td>13.8</td>
    </tr>
    <tr>
      <td>Alacritty</td>
      <td>8.54</td>
      <td>13.51</td>
      <td>17.11</td>
      <td>17.48</td>
      <td>21.87</td>
      <td>26.43</td>
    </tr>
    <tr>
      <td>urxvt</td>
      <td>18.01</td>
      <td>18.88</td>
      <td>19.32</td>
      <td>19.28</td>
      <td>19.66</td>
      <td>23.21</td>
    </tr>
    <tr>
      <td>st</td>
      <td>19.80</td>
      <td>20.11</td>
      <td>20.29</td>
      <td>20.36</td>
      <td>20.55</td>
      <td>22.39</td>
    </tr>
    <tr>
      <td>gnome-terminal</td>
      <td>26.78</td>
      <td>27.71</td>
      <td>27.95</td>
      <td>27.98</td>
      <td>28.18</td>
      <td>32.60</td>
    </tr>
  </tbody>
</table>





<p>The figures pretty much speak for themselves, so I will leave it up to
you to draw your conclusions. Some of my own points though:</p>

<ul>
  <li>
    <p>xterm does direct rendering via Xlib, which is the primary reason it
can be so fast in responding to user input. This is also the reason
why its throughput is, on the other hand, rather poor.</p>
  </li>
  <li>
    <p>Kitty seems to deliver pretty low latency on a very consistent
basis, which is a non-trivial fact given that it is GPU-based. It is
almost as responsive as Zutty. In fact, I am not sure whether anyone
would be able to tell them apart in a blind test. [Update: Kitty’s
author informs me that in order to achieve the lowest possible
latency with Kitty, its configuration option <code>input_delay</code> should be
set to 0 (the default value is 3). I found this to improve Kitty’s
overall numbers by about 2 milliseconds, putting it squarely in the
same spot (within measurement error) as Zutty.]</p>
  </li>
  <li>
    <p>Alacritty is surprisingly slow here and worse, its performance
exhibits great variation, which is also bad for user experience.
This seems to be directly tied in with the program’s design; a
variety of tickets in Alacritty’s issue tracker demonstrate that its
developers are well aware of the problem (but there is no easy
solution).</p>
  </li>
  <li>
    <p>Speaking of the remaining terminal emulators, there is clearly room for
improvement.</p>
  </li>
</ul>


  </div>
</article>

      </div>
    </div></div>
  </body>
</html>
