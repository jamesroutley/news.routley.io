<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://neon.tech/blog/why-does-everyone-run-ancient-postgres-versions">Original</a>
    <h1>Why does everyone run ancient Postgres versions?</h1>
    
    <div id="readability-page-1" class="page"><div><p>Most Postgres users wonâ€™t upgrade to Postgres 17, but why? </p></div><div>
<p><span aria-owns="rmiz-modal-" data-rmiz=""><span data-rmiz-content="not-found"><img alt="Post image" fetchpriority="high" width="1024" height="576" decoding="async" data-nimg="1" sizes="(max-width: 767px) 100vw" srcset="/_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=640&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 640w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=750&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 750w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=828&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 828w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=1080&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 1080w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=1200&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 1200w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=1920&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 1920w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=2048&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 2048w, /_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=3840&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ 3840w" src="https://jack.leightcap.com/_next/image?url=https%3A%2F%2Fneondatabase.wpengine.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fneon-ancient-postgres.jpg&amp;w=3840&amp;q=85&amp;dpl=dpl_7ezU7qvLmaWkHAjUZAgkhjtrRcYQ"/></span></span></p><p><a href="https://neon.tech/blog/postgres-17">Postgres 17.0 has been out for a bit and itâ€™s awesome</a>, but hereâ€™s the reality: most Postgres users wonâ€™t upgrade right away. Most probably arenâ€™t even on 16.4 or <em>16.anything </em>ðŸ˜±â€”theyâ€™re probably still using Postgres 15 or an even older version. ðŸ˜­ With Postgres, itâ€™s not like the latest Call of Duty, where everyone wants the update the moment itâ€™s available.</p>



<p>Why donâ€™t more people upgrade?</p>



<p>There are many reasons for this, but it comes down to two core issues: Postgres works and upgrades suck.</p>



<h2 id="the-foundational-greatness-of-postgres"><a href="#the-foundational-greatness-of-postgres" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14"><path stroke="currentColor" stroke-linecap="square" stroke-linejoin="round" stroke-width="1.4" d="m3.938 12.688 1.75-11.375M8.313 12.688l1.75-11.375M3.063 4.813h8.75M2.188 9.188h8.75"></path></svg></a>The foundational greatness of Postgres</h2>



<p>We at Neon are embedded in the Postgres world. <a href="https://neon.tech/blog/top-3-features-in-postgres-17">Our team has worked on Postgres 17</a> and weâ€™re all excited about all the new features and optimizations. But the entire point of Neon is acknowledging that most developers arenâ€™t like usâ€”they arenâ€™t all about the database. For an average developer, the database is just a tool.Â </p>



<p>And Postgres has been a great tool since many versions before 17. For what most developers need, older versions of Postgres are more than capable. The core functionality of Postgres has been there for many years. This foundational strength is what allows developers to build robust, scalable applications without worrying about the underlying database version.</p>



<p><strong>This doesnâ€™t mean that Postgres hasnâ€™t improved. </strong>Weâ€™ll show you a tool later in this post that will allow you to see this much more clearly. </p>



<p>For example, letâ€™s say youâ€™re currently on version 12. Since then, Postgres performance alone has improved significantly: </p>



<ul>
<li><a href="http://v/">Postgres 13</a> improved performance for queries that use aggregates or partitioned tables</li>



<li><a href="https://www.postgresql.org/docs/release/14.0/">Postgres 14</a> brought numerous performance improvements for parallel queries, heavily concurrent workloads, partitioned tables, logical replication, and vacuuming</li>



<li><a href="https://www.postgresql.org/docs/release/15.0/">Postgres 15</a> offered performance enhancements, particularly for in-memory and on-disk sorting</li>



<li><a href="https://www.postgresql.org/docs/release/16.0/">Postgres 16</a> improved the performance of vacuum freezing and logical replication from replicas</li>
</ul>



<p>These under-the-hood improvements are critical for building better applications. <a href="https://rmarcus.info/blog/2024/04/12/pg-over-time.html">Tail latency dropped by half</a> (over a second) between Postgres versions 8 and 16:</p>



<p><img loading="lazy" decoding="async" src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXchs45eq_Qd7frywBYmtMrXuj5Hvdf2bWXyRCAclDPWvqlqsexeRdt0hIYG5T6EcQDg_AjN4xZ-sB8wfGDBiQvSw7y4_6DebxJzTmXfUgLXFvZ9fhMH_pa1eWUK4lE2pVHmHvU1Ro8658nT714M4bntkyN2?key=whimhCY7Z8YO4kaKWqIxOg" width="575" height="401"/></p>



<p>This is without counting the security improvements, bug fixes, and of course new features. The new versions have brought support for the SQL <a href="https://www.postgresql.org/docs/15/sql-merge.html">MERGE</a> command, SQL/JSON constructors and identity functions, parallelized vacuuming of indexesâ€¦Â </p>



<p>But now, to look at the other side of the coin: Unless you either a) are really reaching the limits of Postgres performance and are looking for any possible improvements or b) particularly need some newly added functionality, Postgres 12 probably works <em>fine</em> for you already.</p>







<p>So thatâ€™s the first reason many Postgres users hesitate to upgrade: Postgres is already great as it is. But weâ€™d be fooling ourselves if we didnâ€™t also acknowledge how painful it can be to update major versions of Postgres, especially for large production databases.</p>



<p>Minor updates are fine, and theyâ€™re completely covered for you by many managed Postgres services like Neonâ€”<a href="https://neon.tech/docs/postgresql/postgres-version-policy">you donâ€™t even have to think about them</a>. But updating a major version is a different game. Major versions of Postgres might introduce changes that arenâ€™t backward compatible (something that doesnâ€™t happen with minor versions) meaning that itâ€™s much harder for Postgres companies to simply upgrade you automatically.</p>



<p>This doesnâ€™t mean that itâ€™s impossible to simplify this process. At Neon, weâ€™ve put a lot of thought into <a href="https://neon.tech/docs/postgresql/postgres-upgrade">making it easier for you to upgrade</a>â€”for example, by supporting logical replicationâ€”and <strong>weâ€™re working on a one-click Postgres upgrade feature so you can upgrade with minimal downtime. Not only that, but with Neon youâ€™ll upgrade within a branch to ensure things work, and then upgrade your production with the least amount of interruption as possible. (Keep an eye on 2025 roadmap).</strong></p>







<p>To put things into perspective, letâ€™s look at two public stories of companies that performed Postgres upgrades, jumping multiple major versions while managing databases of considerable size in production: <a href="https://knock.app/blog/zero-downtime-postgres-upgrades">Knock</a> (they upgraded from Postgres 11 to 15) and <a href="https://retool.com/blog/how-we-upgraded-postgresql-database">Retool</a> (from Postgres 9 to 13). These are big leaps that need to be made strategically.</p>



<p>Hereâ€™s what these companies had to do:</p>



<ol>
<li><strong>Assessment and planning.</strong> They evaluated their database sizes and workloads (Retool had a 4 TB database; Knock managed multiple databases). Objectives like minimizing downtime and upgrading before end-of-life were set. They chose their target Postgres versions and crafted detailed project timelines and risk assessments.</li>



<li><strong>Set up replication.</strong> New database instances running the target Postgres versions were spun up and logical replication from the old to the new databases was established. Retool used <a href="https://www.citusdata.com/blog/2017/12/08/citus-warp-pain-free-migrations/">Warp</a> for parallel processing to expedite the initial dump and restore, while Knock created custom publications and subscriptions for incremental migration.</li>



<li><strong>Migrate data incrementally.</strong> Tables were categorized based on size and update frequency. Small tables were added to replication and synchronized quickly. For large, append-only tables, they used separate publications with copy_data = false and then backfilled. Custom migration strategies were considered for large, frequently updated tables.</li>



<li><strong>Testing and verification.</strong> Thorough testing was performed on the new database versions. They compared row counts and sample data between old and new databases, ran load tests to verify performance, and conducted multiple dry runs in staging environments.</li>



<li><strong>Application changes.</strong> After testing, they modified their applications to support connections to both old and new databases. Mechanisms were implemented to switch traffic from the old to the new databases, such as using feature flags.</li>



<li><strong>cutover strategy.</strong> The cutover was scheduled during low-traffic periods. Retool used a maintenance window aiming for about one hour, while Knock achieved near-zero downtime with a brief pause in new queries.</li>



<li><strong>Post-migration tasks.</strong> Afterward, they verified data integrity and application functionality, optimized the new databases (e.g., reindexing, vacuuming), monitored performance in the following days, removed old replication setups, and decommissioned the old databases.</li>
</ol>



<p>Yep. Thatâ€™s a lot of work. Thereâ€™s no way around that. Upgrading a production Postgres database thatâ€™s multiple versions behind requires a significant investment of time and resources. For many organizations, this level of effort can be daunting, so they often postpone upgrades until absolutely necessary.</p>







<p>Despite all this, we still want to encourage you to <em>upgrade, upgrade, upgrade</em>!Â Donâ€™t worry too much, <strong>weâ€™ll make this process so much easier! </strong>(Remember the 2025 roadmap!)</p>



<p><a href="https://www.postgresql.org/about/news/postgresql-17-released-2936/">If the great new functionality in Postgres 17 isnâ€™t enough to convince you</a>, here are some other reasons:</p>



<ul>
<li><strong>Youâ€™ll eventually have to do it anyway. </strong>Postgres versions have a lifecycle, and support for each version eventually ends (5 years after its initial release).Â </li>



<li><strong>Itâ€™s more difficult to jump many versions at once. </strong>The longer you wait to upgrade, the more versions youâ€™ll have to leap over when you finally do. Itâ€™s best to jump as many versions as you can when you do upgrade but if you wait for 5 or more versions there will be many compatibility issues and breaking changes ahead.Â </li>



<li><strong>Your app might fall behind. </strong>Newer versions of Postgres come with performance optimizations and new functionalities that can enhance your applications. By sticking with an older version, you might be missing out on improvements that could make your system faster and more efficient.Â </li>



<li><strong>Compatibility. </strong>New frameworks, libraries, and tools might come out without compatibility for the older version of Postgres you might be working with. Updated APIs or extensions might not be backward compatible, preventing you from integrating certain tools or requiring complex workarounds.</li>
</ul>







<p>Part of the lack of inspiration around upgrading comes from the hassle of manually comparing release notes between versions and figuring out how many improvements youâ€™re missing. To make this easier, weâ€™ve built a tool: <a href="https://pgversions.com/">https://pgversions.com/</a></p>



<figure><video autoplay="" controls="" loop="" src="https://neondatabase.wpengine.com/wp-content/uploads/2024/10/pgversions.mov"></video></figure>



<p>This tool helps you quickly identify the improvements youâ€™re missing by running an older Postgres version. For example, if youâ€™re running Postgres 16.1, a quick search using pgversions.com tells you that youâ€™re missing:</p>



<ul>
<li>4 security improvements</li>



<li>177 bug fixes</li>



<li>24 performance improvements</li>



<li>10 new features</li>
</ul>



<p>If <a href="https://pgversions.com/">pgversions</a> inspires you to finally upgrade, the <code>How to upgrade</code> section in the report will point you toward the right docs for different providers.</p>







<p>If youâ€™re running an older version of Postgres and thinking thereâ€™s plenty more time. We know itâ€™s tempting to procrastinate, but donâ€™t let technical debt haunt you. <a href="https://neon.tech/docs/postgresql/postgres-upgrade">Follow this guide to plan to upgrade your Neon database to Postgres 17</a> and just cross it off your to-do list.Â </p>



<p>Are you running an older version of Postgres where they donâ€™t offer the latest versions? A migration to Neon could mean upgrading and <a href="https://neon.tech/blog/how-dispatch-speeds-up-development-with-neon-while-keeping-workloads-on-aurora">switching to a better development environment</a>. Feel free to<a href="https://neon.tech/migration-assistance"> reach out to us</a> with any questions.Â </p>



<p><em>If youâ€™re new to Neon, you can get started with Postgres 17 right away </em><a href="https://console.neon.tech/signup"><em>via our Free plan.</em></a></p>
</div></div>
  </body>
</html>
