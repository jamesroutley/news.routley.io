<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://george.mand.is/2024/09/using-email-and-val-town-to-draft-blog-posts/">Original</a>
    <h1>Using Email and Val Town to Draft Blog Posts</h1>
    
    <div id="readability-page-1" class="page"><div><article><section><header><p><time datetime="2024-09-29">September 29th, 2024</time> • ~400 words • 2 minute read</p></header><p>Lately I&#39;ve been playing around with <a href="https://val.town">Val Town</a>. Their pitch is something like &#34;If AWS Lambdas were fun&#34; and—despite being unable to articulate what that even <em>means</em>—I have to chuckle and nod. It&#39;s a great product that I&#39;ve really enjoyed using the past few weeks.</p><p>Two things in particular have been great about it:</p><ul><li><strong>Free OpenAI access</strong>. It&#39;s already pretty cheap to play around with LLMs on most platforms right now, but you can&#39;t beat free.</li><li><strong>Email-driven workflows</strong>. I think I find this more compelling than the average person, and the ease with which you can setup scripts that are triggered by inbound emails on Val Town caught my attention.</li></ul><p>In fact, this post started life as a document I emailed to one of those scripts!</p><p><img src="https://george.mand.is/media/email-drafts/valtown-email-to-draft.png" alt="The email that started this draft"/></p><h2>How it works</h2><ul><li><strong>We send an email to a special Val Town email address</strong>. Under the hood, I think Val Town is using <a href="https://www.twilio.com/docs/sendgrid/ui/account-and-settings/inbound-parse">SendGrid</a> to route these emails to my script—specifically their Inbound Parse Webhooks.</li><li><strong>The script takes the plain-text email content</strong> and creates a new draft in my blog&#39;s GitHub repository using <a href="https://github.com/octokit">Octokit</a>.</li></ul><p><img src="https://george.mand.is/media/email-drafts/val-town-markdown-converted.png" alt="The email that started this draft"/></p><p>That&#39;s pretty much it?</p><h2>Noteworthy</h2><ul><li>This workflow assumes you&#39;re using some sort of static site generator and storing your content in GitHub. There are many to choose from in this space. I&#39;m partial to <a href="https://www.11ty.dev/">11ty</a>.</li><li><strong>Gmail is doing some heavy-lifting for me here</strong> in terms of kindly converting my HTML email to Markdown behind the scenes. There&#39;s no guarantee all email providers do this. If yours does not, you may have to investigate an HTML-to-Markdown conversion step.</li><li>It uses the GitHub API via <a href="https://github.com/octokit">Octokit</a> to create the file. You&#39;ll need to create a <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#">personal access token</a> and store it an an environmental variable in your Val Town settings.</li></ul><p>Other services in this space for inbound-email processing:</p><ul><li><a href="https://www.twilio.com/docs/sendgrid/ui/account-and-settings/inbound-parse">Twilio SendGrid</a></li><li><a href="https://www.mailgun.com/solutions/use-cases/email-parsing/">Mailgun</a></li><li><a href="https://docs.aws.amazon.com/ses/latest/dg/receiving-email.html">Amazon SES</a></li></ul><h2>What&#39;s next</h2><p>I want to try and recreate this workflow with <a href="https://developers.cloudflare.com/email-routing/email-workers/">Cloudflare Email Workers</a>. I finally figured out how to get those working this weekend despite the documentation omitting what felt like a <em>lot</em> of important details.</p><p>There is a side-project/product I&#39;d like to pursue in this space, and while Val Town is a lot of fun for a quick-and-dirty MVPs (or even <a href="https://george.mand.is/notes/software/imps/">IMPs</a>) I&#39;d be nervous trying to run anything resembling areal business on it.</p><p>Stay tuned!</p><h2>The Code</h2><p>If you&#39;re on Val Town and want to give it a fave or a fork you can find the script here:</p><ul><li><a href="https://www.val.town/v/georgemandis/convertEmailToBlogDraft">https://www.val.town/v/georgemandis/convertEmailToBlogDraft</a></li></ul></section></article></div></div>
  </body>
</html>
