<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kb.cert.org/vuls/id/782720">Original</a>
    <h1>TCG TPM2.0 implementations vulnerable to memory corruption</h1>
    
    <div id="readability-page-1" class="page"><div>
    <div>
      <div>
        <div>
	  
	  <h3 id="overview">Overview</h3>
<p>Two buffer overflow vulnerabilities were discovered in the Trusted Platform Module (TPM)  2.0 reference library specification, currently at <a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part4_SuppRoutines_code_pub.pdf">Level 00, Revision 01.59  November 2019</a>.   An attacker who has access to a TPM-command interface can send maliciously-crafted commands to the module and trigger these vulnerabilities. This allows either read-only access to sensitive data or overwriting of normally protected data that is only available to the TPM (e.g., cryptographic keys). </p>
<h3 id="description">Description</h3>
<p>Trusted Platform Module (TPM) technology is a hardware-based solution that provides secure cryptographic functions to the operating systems on modern computers, making it resistant to tampering. As cloud computing and virtualization have become more popular in recent years, software-based TPM implementations have also gained popularity. TPM can be implemented in the form of Discrete, Integrated or Firmware TPM in its hardware form.  The virtual TPM&#39;s exists in Hypervisor form or in a purely software-based TPM implementation e.g.,  <a href="https://github.com/stefanberger/swtpm/wiki">swtpm</a>.   The <a href="https://trustedcomputinggroup.org">Trusted Computing Group</a> (TCG) is responsible for maintaining the TPM specifications, which are actively contributed to by both hardware and software manufacturers. The TCG released the TPM 2.0 specifications in October 2014 and has since revised them multiple times. The latest version, Revision 01.59, was released in November 2019. Many TPM hardware and software manufacturers use these specifications to build firmware that complies with standards and provides a secure interface to sensitive cryptographic data. TPM is employed in a variety of devices, from specialized enterprise-grade hardware to Internet of Things (IoT) appliances.</p>
<p>The  <a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part1_Architecture_pub.pdf">TPM Library Specification Architecture</a> documents &#34;Session-based encryption&#34; that allows a cryptographic client application to perform various operations, including those that provide <a href="https://www.wolfssl.com/tpm-parameter-encryption/">Parameter Encryption</a> capabilities. Session-based encryption may be used to ensure confidentiality of these parameters. The operating system or the client software relies on the TPM to securely provide capabilities such as Cipher Feedback (CFB) for block cipher or streaming hash-based XOR obfuscation of the intended parameter payloads.</p>
<p>Quarkslab security researchers found two vulnerabilities in the way the TPM reference specification processes some of these parameters that are part of TPM commands.  An Out Of Bound (OOB) read vulnerability in the <code>CryptParameterDecryption()</code>  routine allowed a 2-byte read access to data that was not part of the current session.  It was also possible to write 2-bytes past the end of the current command buffer resulting in corruption of memory.  </p>
<p>An attacker with access to a device built with a vulnerable version of the TPM can trigger this bug by sending crafted commands to the TPM.  The vulnerable TPM can thus be tricked to access data that is not part of the intended operation. As the OS relies on the TPM firmware for these functions, it may be difficult to detect or prevent such access using traditional host-based security capabilities. </p>
<h3 id="impact">Impact</h3>
<p>An authenticated, local attacker could send maliciously crafted commands to a vulnerable TPM allowing access to sensitive data. In some cases, the attacker can also overwrite protected data in the TPM firmware. This may lead to a crash or arbitrary code execution within the TPM. Because the attacker&#39;s payload runs within the TPM, it may be undetectable by other components of the target device.</p>
<h3 id="solution">Solution</h3>
<p><strong><em>Apply an update</em></strong>
The Trusted Computing Group (TCG) has released an update to their <a href="https://trustedcomputinggroup.org/resource/errata-for-tpm-library-specification-2-0/">Errata for TPM2.0 Library Specification</a> with instructions to address these vulnerabilities.  To ensure the security of their systems, users should apply any updates provided by hardware and software manufacturers through their supply chain as soon as possible. Updating the firmware of TPM chips may be necessary, and this can be done through an OS vendor or the original equipment manufacturer (OEM). In some cases, the OEM may require resetting the TPM to its original factory default values as part of the update process.</p>
<p>Users in high-assurance computing environments should consider using TPM <a href="https://tpm2-software.github.io/tpm2-tss/getting-started/2019/12/18/Remote-Attestation.html">Remote Attestation</a> to detect any changes to devices and ensure their TPM is tamper proofed. As these attacks involve TPM-based software, mechanisms such as user-password or PIN protection and tpm-totp do not protect against attacks leveraging the vulnerabilities discussed in this article.</p>
<p><strong>Note: </strong> the <a href="https://trustedcomputinggroup.org/resource/errata-for-tpm-library-specification-2-0//">TCG&#39;s Errata</a> covers a larger scope and addresses additional security issues beyond the two vulnerabilities discussed in this advisory.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>Thanks to Francisco Falcon and Ivan Arce of Quarkslab who researched and reported these vulnerabilities, respectively. The TCG and their members worked closely with us and other vendors to coordinate the disclosure of these vulnerabilities.</p>
<p>This document was written by Vijay Sarvepalli.</p>
	  
	</div>
      </div>
      <div>
	<div>
	  <h3 id="vendor-information">Vendor Information</h3>
	  
	  <div>
  <div>
    
    
    <p><label>Filter by content:</label>
      <label for="checkbox1"><i aria-hidden="true"></i> Additional information available</label>
    </p>
    <p><label><i aria-hidden="true"></i>Â Sort by:</label>
      
    </p>
  </div>
</div>


	  
	  
	</div>
      </div>
      </div>
  </div></div>
  </body>
</html>
