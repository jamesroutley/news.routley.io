<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/PLSysSec/FaCT">Original</a>
    <h1>FaCT: Constant Time Programming Language</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">This is the compiler for the Flexible and Constant Time cryptographic programming language.
FaCT is a domain-specific language that aids you in writing constant-time code for cryptographic routines
that need to be free from timing side channels.</p>
<h2 dir="auto"><a id="user-content-useful-links" aria-hidden="true" href="#useful-links"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Useful links:</h2>
<ul dir="auto">
<li><a href="https://donnywinston.com/PLSysSec/FaCT/blob/master/FaCT_extended.pdf">Our paper</a></li>
<li><a href="https://fact.sysnet.ucsd.edu/" rel="nofollow">Online demo using Compiler Explorer</a> (<a href="https://github.com/bjohannesmeyer/fact-website">source</a> forked from <a href="https://github.com/mattgodbolt/compiler-explorer">mattgodbolt/compiler-explorer</a>)</li>
<li><a href="https://github.com/PLSysSec/fact-eval">FaCT case studies / evaluation</a></li>
<li><a href="https://github.com/PLSysSec/inline-fact">Haskell embedding</a></li>
<li><a href="https://github.com/PLSysSec/CTFFI">Python embedding</a></li>
<li><a href="https://github.com/PLSysSec/factlang.vim">Vim syntax files</a></li>
</ul>
<h2 dir="auto"><a id="user-content-building" aria-hidden="true" href="#building"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building</h2>
<p dir="auto">To build the compiler, you can either build from source or download a pre-built release.
We recommend building from source if possible.</p>
<h3 dir="auto"><a id="user-content-virtual-machine-image" aria-hidden="true" href="#virtual-machine-image"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Virtual machine image</h3>
<p dir="auto">You can download a <a href="https://drive.google.com/open?id=1xzw4Ohsdj4WqxJPl1RvvxSnhysMSejPi" rel="nofollow">VM image pre-configured for building the FaCT compiler and case studies</a>.
The file <code>fact.ova</code> should have a SHA256 sum of <code>089398c85c5074d911c2f2b67ca22df453235e8733f1eb283c71717cf70f714c</code>.</p>
<h3 dir="auto"><a id="user-content-using-docker" aria-hidden="true" href="#using-docker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using Docker</h3>
<p dir="auto">If you have docker installed, you can load our docker image with the build
environment already installed:</p>

<p dir="auto">Once inside the docker shell, run the following to finish setting up the environment:</p>
<div data-snippet-clipboard-copy-content="cd FaCT/
eval $(opam config env)"><pre><code>cd FaCT/
eval $(opam config env)
</code></pre></div>
<h3 dir="auto"><a id="user-content-setting-up-the-build-environment" aria-hidden="true" href="#setting-up-the-build-environment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setting up the build environment</h3>
<p dir="auto">FaCT is developed using OCaml 4.06.0 and LLVM 6.0.</p>
<h3 dir="auto"><a id="user-content-using-a-local-environment" aria-hidden="true" href="#using-a-local-environment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using a local environment</h3>
<p dir="auto">Building FaCT has been tested on Ubuntu 16.04, 18.04, and macOS.</p>
<h4 dir="auto"><a id="user-content-1-install-system-dependencies" aria-hidden="true" href="#1-install-system-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. Install System Dependencies</h4>
<p dir="auto"><strong>Ubuntu (16.04 &amp; 18.04)</strong></p>
<div data-snippet-clipboard-copy-content="sudo apt install llvm-6.0 clang-6.0 cmake libgmp-dev m4 pkg-config"><pre><code>sudo apt install llvm-6.0 clang-6.0 cmake libgmp-dev m4 pkg-config
</code></pre></div>
<p dir="auto"><strong>macOS</strong></p>
<p dir="auto">These instructions require <a href="https://brew.sh" rel="nofollow">Homebrew</a></p>
<div data-snippet-clipboard-copy-content="brew install cmake gmp m4 pkg-config
brew install llvm@6 --with-toolchain"><pre><code>brew install cmake gmp m4 pkg-config
brew install llvm@6 --with-toolchain
</code></pre></div>
<p dir="auto"><strong>Note:</strong> This does not put the proper version of clang on your <code>PATH</code>. You will need to run:</p>
<div data-snippet-clipboard-copy-content="export PATH=&#34;$(brew --prefix llvm@6)/bin:$PATH&#34;"><pre><code>export PATH=&#34;$(brew --prefix llvm@6)/bin:$PATH&#34;
</code></pre></div>
<h4 dir="auto"><a id="user-content-2-install-ocaml--packages" aria-hidden="true" href="#2-install-ocaml--packages"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Install OCaml + packages</h4>
<p dir="auto">We recommend installing the <a href="https://opam.ocaml.org/" rel="nofollow">opam package manager</a> to manage OCaml and package dependencies:</p>
<div data-snippet-clipboard-copy-content="sh &lt;(curl -sL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh)"><pre><code>sh &lt;(curl -sL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh)
</code></pre></div>
<p dir="auto">Then, install OCaml and the libraries:</p>
<div data-snippet-clipboard-copy-content="opam init
eval $(opam config env)
opam switch create 4.06.0
eval $(opam config env)
opam switch import ocamlswitch.txt"><pre><code>opam init
eval $(opam config env)
opam switch create 4.06.0
eval $(opam config env)
opam switch import ocamlswitch.txt
</code></pre></div>
<p dir="auto">Finally, make sure the Z3 lib is available to the OCaml compiler:</p>
<div data-snippet-clipboard-copy-content="export LD_LIBRARY_PATH=&#34;$HOME/.opam/4.06.0/lib/z3:$LD_LIBRARY_PATH&#34;"><pre><code>export LD_LIBRARY_PATH=&#34;$HOME/.opam/4.06.0/lib/z3:$LD_LIBRARY_PATH&#34;
</code></pre></div>
<h4 dir="auto"><a id="user-content-3-configure-paths" aria-hidden="true" href="#3-configure-paths"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. Configure Paths</h4>
<p dir="auto">The FaCT compiler depends on the LLVM 6.0 toolchain <strong>at runtime</strong>,
and expects binaries with <code>-6.0</code> suffixes.
Ensure that <code>clang-6.0</code> is in your PATH:</p>

<h3 dir="auto"><a id="user-content-compiling-fact" aria-hidden="true" href="#compiling-fact"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Compiling FaCT</h3>
<p dir="auto">You can now build the compiler:</p>

<p dir="auto">This will produce the <code>factc</code> executable.</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<h4 dir="auto"><a id="user-content-basic-usage" aria-hidden="true" href="#basic-usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic Usage</h4>
<p dir="auto">Run <code>./factc &lt;source files&gt;</code> to compile a FaCT program.</p>
<h4 dir="auto"><a id="user-content-link-to-a-c-library" aria-hidden="true" href="#link-to-a-c-library"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Link to a C library</h4>
<p dir="auto">FaCT is designed to be called from C code. Compiling FaCT source files will
output an object file, which can then be linked to a C file. As an example:</p>
<div data-snippet-clipboard-copy-content="cd example/
../factc -generate-header example.fact
clang-6.0 -c main.c
clang-6.0 -o final main.o example.o"><pre><code>cd example/
../factc -generate-header example.fact
clang-6.0 -c main.c
clang-6.0 -o final main.o example.o
</code></pre></div>
<p dir="auto">You can then run the executable:</p>
<p dir="auto"><code>./final</code></p>
<h4 dir="auto"><a id="user-content-debugging" aria-hidden="true" href="#debugging"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Debugging</h4>
<p dir="auto">Many debugging options and intermediate data structures are available. Run <code>./factc -help</code> for all options.</p>
<h2 dir="auto"><a id="user-content-acknowledgements" aria-hidden="true" href="#acknowledgements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Acknowledgements</h2>
<p dir="auto">We thank the anonymous PLDI and PLDI AEC reviewers for their suggestions and
insightful comments.</p>
</article>
          </div></div>
  </body>
</html>
