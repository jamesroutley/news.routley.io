<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/sosy-lab/cpu-energy-meter">Original</a>
    <h1>CPU Energy Meter: A tool for measuring energy consumption of Intel CPUs</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">

<p dir="auto"><a href="https://gitlab.com/sosy-lab/software/cpu-energy-meter/pipelines" rel="nofollow"><img src="https://camo.githubusercontent.com/3b2e2e44e005c60ee6d71f8c6809f83c193ed224c1d0b42bb2223967c4564a6b/68747470733a2f2f6769746c61622e636f6d2f736f73792d6c61622f736f6674776172652f6370752d656e657267792d6d657465722f6261646765732f6d61696e2f706970656c696e652e737667" alt="Build Status" data-canonical-src="https://gitlab.com/sosy-lab/software/cpu-energy-meter/badges/main/pipeline.svg"/></a>
<a href="https://github.com/sosy-lab/cpu-energy-meter/blob/main/LICENSE"><img src="https://camo.githubusercontent.com/1aaf5e71abd8dbe565cc0ed7ba58a18597fa5a29ac1f05fc2008cf6006b39a2f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4253442d2d332d2d636c617573652d627269676874677265656e2e737667" alt="BSD-3-Clause License" data-canonical-src="https://img.shields.io/badge/license-BSD--3--clause-brightgreen.svg"/></a>
<a href="https://github.com/sosy-lab/cpu-energy-meter/releases"><img src="https://camo.githubusercontent.com/dd46eab6b8c7c31d612c1a172019367238c4833663dc6d26dcbfb1d715b93742/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f736f73792d6c61622f6370752d656e657267792d6d657465722e737667" alt="Releases" data-canonical-src="https://img.shields.io/github/release/sosy-lab/cpu-energy-meter.svg"/></a>
<a href="https://zenodo.org/badge/latestdoi/46493895" rel="nofollow"><img src="https://camo.githubusercontent.com/4b9e215a2babde7837ff8b29e2f952dffc23d9f1e276e5a581f87a5bdd7d1b56/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f34363439333839352e737667" alt="DOI via Zenodo" data-canonical-src="https://zenodo.org/badge/46493895.svg"/></a></p>
<p dir="auto">CPU Energy Meter is a Linux tool that allows to monitor power consumption of Intel CPUs
at fine time granularities (few tens of milliseconds).
Power monitoring is available for the following power domains:</p>
<ul dir="auto">
<li>per package domain (CPU socket)</li>
<li>per core domain (all the CPU cores on a package)</li>
<li>per uncore domain (uncore components, e.g., integrated graphics on client CPUs)</li>
<li>per memory node (memory local to a package, server CPUs only)</li>
<li>per platform (all devices in the platform that receive power from integrated
power delivery mechanism, e.g., processor cores, SOC, memory, add-on or
peripheral devices)</li>
</ul>
<p dir="auto">To do this, the tool uses a feature of Intel CPUs that is called <a href="https://en.wikipedia.org/wiki/Running_average_power_limit" rel="nofollow">RAPL (Running Average Power Limit)</a>,
which is documented in the <a href="https://software.intel.com/en-us/articles/intel-sdm" rel="nofollow">Intel Software Developers Manual</a>, Volume 3B Chapter 14.9.
RAPL is available on CPUs from the generation <a href="https://en.wikipedia.org/wiki/Sandy_Bridge" rel="nofollow">Sandy Bridge</a> and later.
Because CPU Energy Meter uses the maximal possible measurement interval
(depending on the hardware this is between a few minutes and an hour),
it causes negligible overhead.</p>
<p dir="auto">CPU Energy Meter is a fork of the <a href="https://software.intel.com/en-us/articles/intel-power-gadget-20" rel="nofollow">Intel Power Gadget</a>
and developed at the <a href="https://www.sosy-lab.org" rel="nofollow">Software Systems Lab</a>
of the <a href="https://www.uni-muenchen.de" rel="nofollow">Ludwig-Maximilians-Universität München (LMU Munich)</a>
under the <a href="https://github.com/sosy-lab/cpu-energy-meter/blob/main/LICENSE">BSD-3-Clause License</a>.</p>

<p dir="auto">For Debian or Ubuntu the easiest way is to install from our <a href="https://launchpad.net/~sosy-lab/+archive/ubuntu/benchmarking" rel="nofollow">PPA</a>:</p>
<div data-snippet-clipboard-copy-content="sudo add-apt-repository ppa:sosy-lab/benchmarking
sudo apt install cpu-energy-meter"><pre><code>sudo add-apt-repository ppa:sosy-lab/benchmarking
sudo apt install cpu-energy-meter
</code></pre></div>
<p dir="auto">Alternatively, you can download our <code>.deb</code> package from <a href="https://github.com/sosy-lab/cpu-energy-meter/releases">GitHub</a>
and install it with <code>apt install ./cpu-energy-meter*.deb</code>.</p>
<p dir="auto">Dependencies of CPU Energy Meter are <a href="https://sites.google.com/site/fullycapable/" rel="nofollow">libcap</a>,
which is available on most Linux distributions in package <code>libcap</code> (e.g., Fedora)
or <code>libcap2</code> (e.g, Debian and Ubuntu: <code>sudo apt install libcap2</code>),
and a Linux kernel with the MSR module (available by default)</p>
<p dir="auto">Alternatively, for running CPU Energy Meter from source (quick and dirty):</p>
<div data-snippet-clipboard-copy-content="sudo apt install libcap-dev
sudo modprobe msr
make
sudo ./cpu-energy-meter"><pre><code>sudo apt install libcap-dev
sudo modprobe msr
make
sudo ./cpu-energy-meter
</code></pre></div>
<p dir="auto">It is also possible (and recommended) to run CPU Energy Meter without root.
To do so, the following needs to be done:</p>
<ul dir="auto">
<li>Load kernel modules <code>msr</code> and <code>cpuid</code>.</li>
<li>Add a group <code>msr</code>.</li>
<li>Add a Udev rule that grants access to <code>/dev/cpu/*/msr</code> to group <code>msr</code> (<a href="https://github.com/sosy-lab/cpu-energy-meter/blob/main/debian/additional_files/59-msr.rules">example</a>).</li>
<li>Run <code>chgrp msr</code>, <code>chmod 2711</code>, and <code>setcap cap_sys_rawio=ep</code> on the binary (<code>make setup</code> is a shortcut for this).</li>
</ul>
<p dir="auto">The provided Debian package in our <a href="https://launchpad.net/~sosy-lab/+archive/ubuntu/benchmarking" rel="nofollow">PPA</a>
and on <a href="https://github.com/sosy-lab/cpu-energy-meter/releases">GitHub</a> does these steps automatically
and lets all users execute CPU Energy Meter.</p>

<div data-snippet-clipboard-copy-content="cpu-energy-meter [-d] [-e sampling_delay_ms] [-r]"><pre><code>cpu-energy-meter [-d] [-e sampling_delay_ms] [-r]
</code></pre></div>
<p dir="auto">The tool will continue counting the cumulative energy use of all supported CPUs
in the background and will report a key-value list of its measurements when it
receives SIGINT (Ctrl+C):</p>
<div data-snippet-clipboard-copy-content="+--------------------------------------+
| CPU-Energy-Meter            Socket 0 |
+--------------------------------------+
Duration                  2.504502 sec
Package                   3.769287 Joule
Core                      0.317749 Joule
Uncore                    0.010132 Joule
DRAM                      0.727783 Joule
PSYS                     29.792603 Joule"><pre><code>+--------------------------------------+
| CPU-Energy-Meter            Socket 0 |
+--------------------------------------+
Duration                  2.504502 sec
Package                   3.769287 Joule
Core                      0.317749 Joule
Uncore                    0.010132 Joule
DRAM                      0.727783 Joule
PSYS                     29.792603 Joule
</code></pre></div>
<p dir="auto">To get intermediate measurements, send signal <code>USR1</code> to the process.</p>
<p dir="auto">Optionally, the tool can be executed with parameter <code>-r</code>
to print the output as a raw (easily parsable) list:</p>
<div data-snippet-clipboard-copy-content="cpu_count=1
duration_seconds=3.241504
cpu0_package_joules=4.971924
cpu0_core_joules=0.461182
cpu0_uncore_joules=0.053406
cpu0_dram_joules=0.953979
cpu0_psys_joules=38.904785"><pre><code>cpu_count=1
duration_seconds=3.241504
cpu0_package_joules=4.971924
cpu0_core_joules=0.461182
cpu0_uncore_joules=0.053406
cpu0_dram_joules=0.953979
cpu0_psys_joules=38.904785
</code></pre></div>
<p dir="auto">The parameter <code>-d</code> adds debug output.
By default, CPU Energy Meter computes the necessary measurement interval automatically,
this can be overridden with the parameter <code>-e</code>.</p>
</article></div></div>
  </body>
</html>
