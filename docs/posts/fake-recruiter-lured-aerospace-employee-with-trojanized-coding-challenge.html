<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.welivesecurity.com/en/eset-research/lazarus-luring-employees-trojanized-coding-challenges-case-spanish-aerospace-company/">Original</a>
    <h1>Fake recruiter lured aerospace employee with trojanized coding challenge</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p>ESET researchers have uncovered a Lazarus attack against an aerospace company in Spain, where the group deployed several tools, most notably a publicly undocumented backdoor we named LightlessCan. Lazarus operators obtained initial access to the company’s network last year after a successful spearphishing campaign, masquerading as a recruiter for Meta – the company behind Facebook, Instagram, and WhatsApp.</p>
<p>The fake recruiter contacted the victim via LinkedIn Messaging, a feature within the LinkedIn professional social networking platform, and sent two coding challenges required as part of a hiring process, which the victim downloaded and executed on a company device. The first challenge is a very basic project that displays the text “Hello, World!”, the second one prints a Fibonacci sequence – a series of numbers in which each number is the sum of the two preceding ones. ESET Research was able to reconstruct the initial access steps and analyze the toolset used by Lazarus thanks to cooperation with the affected aerospace company.</p>
<p>In this blogpost, we describe the method of infiltration and the tools deployed during this Lazarus attack. We will also present some of our findings about this attack at the <a href="https://www.virusbulletin.com/conference/vb2023/abstracts/lazarus-campaigns-and-backdoors-2022-2023/" target="_blank" rel="noopener">Virus Bulletin conference</a> on October 4, 2023.</p>
<blockquote>
<p><strong>Key points of the blogpost:</strong></p>
<ul>
<li><em>Employees of the targeted company were contacted by a fake recruiter via LinkedIn and tricked into opening a malicious executable presenting itself as a coding challenge or quiz.</em></li>
<li><em>We identified four different execution chains, delivering three types of payloads via DLL side-loading .</em></li>
<li><em>The most notable payload is the LightlessCan backdoor, implementing techniques to hinder detection by real-time security monitoring software and analysis by cybersecurity professionals; this presents a major shift in comparison with its predecessor BlindingCan, a flagship HTTP(S) Lazarus RAT.</em></li>
<li><em>We attribute this activity with a high level of confidence to Lazarus, particularly to its campaigns related to Operation DreamJob.</em></li>
<li><em>The final goal of the attack was cyberespionage.</em></li>
</ul>
</blockquote>
<p>Lazarus delivered various payloads to the victims’ systems; the most notable is a publicly undocumented and sophisticated remote access trojan (RAT) that we named LightlessCan, which represents a significant advancement compared to its predecessor, BlindingCan. LightlessCan mimics the functionalities of a wide range of native Windows commands, enabling discreet execution within the RAT itself instead of noisy console executions. This strategic shift enhances stealthiness, making detecting and analyzing the attacker’s activities more challenging.</p>
<p>Another mechanism used to minimize exposure is the employment of execution guardrails; Lazarus made sure the payload can only be decrypted on the intended victim’s machine. Execution guardrails are a set of protective protocols and mechanisms implemented to safeguard the integrity and confidentiality of the payload during its deployment and execution, effectively preventing unauthorized decryption on unintended machines, such as those of security researchers. We describe the implementation of this mechanism in the <em><a href="#Execution chain 3: LightlessCan (complex version)">Execution chain 3: LightlessCan (complex version)</a> </em>section.</p>
<h2>Attribution to the Lazarus group</h2>
<p>The Lazarus group (also known as HIDDEN COBRA) is a cyberespionage group <a href="https://attack.mitre.org/groups/G0032/" target="_blank" rel="noopener">linked to North Korea</a> that has been active since at least 2009. It is responsible for high-profile incidents such as both the <a href="https://www.welivesecurity.com/2014/12/08/sony-pictures-hacking-traced-thai-hotel-north-korea-denies-involvement/" target="_blank" rel="noopener">Sony Pictures Entertainment hack</a> and tens-of-millions-of-dollar <a href="https://www.welivesecurity.com/2016/03/15/bangladesh-central-bank-boss-quits-100m-cyberheist/" target="_blank" rel="noopener">cyberheists in 2016</a>, the <a href="https://www.welivesecurity.com/2017/05/15/wannacryptor-key-questions-answered/" target="_blank" rel="noopener">WannaCryptor</a> (aka WannaCry) outbreak in 2017, the 3CX and X_TRADER <a href="https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack/" target="_blank" rel="noopener">supply-chain attacks</a>, and a long history of <a href="https://www.welivesecurity.com/2020/11/16/lazarus-supply-chain-attack-south-korea/" target="_blank" rel="noopener">disruptive attacks against South Korean</a> public and critical infrastructure since at least 2011. The diversity, number, and eccentricity in implementation of Lazarus campaigns define this group, as well as that it performs all three pillars of cybercriminal activities: cyberespionage, cybersabotage, and pursuit of financial gain.</p>
<p>Aerospace companies are not an unusual target for North Korea-aligned advanced persistent threat (APT) groups. The country has conducted <a href="https://www.dia.mil/Portals/110/Documents/News/North_Korea_Military_Power.pdf" target="_blank" rel="noopener">multiple nuclear tests</a> and launched intercontinental ballistic missiles, which violate United Nations (UN) Security Council <a href="https://www.securitycouncilreport.org/un-documents/dprk-north-korea/" target="_blank" rel="noopener">resolutions</a>. The UN monitors North Korea’s nuclear activities to prevent further development and proliferation of nuclear weapons or weapons of mass destruction, and publishes <a href="https://www.un.org/securitycouncil/sanctions/1718/panel_experts/reports" target="_blank" rel="noopener">biannual reports</a> tracking such activities. According to these reports, North Korea-aligned APT groups attack aerospace companies in attempts to access sensitive technology and aerospace know-how, as intercontinental ballistic missiles spend their midcourse phase in the space outside of Earth’s atmosphere. These reports also claim that money gained from cyberattacks accounts for a portion of North Korea’s missile development costs.</p>
<p>We attribute the attack in Spain to the Lazarus group, specifically to Operation DreamJob, with a high level of confidence. The name for Operation DreamJob was coined in a <a href="https://www.clearskysec.com/operation-dream-job/" target="_blank" rel="noopener">blogpost</a> by ClearSky from August 2020, describing a Lazarus campaign targeting defense and aerospace companies, with the objective of cyberespionage. Since then, we have loosely used the term to denote various Lazarus operations leveraging job-offering lures but not deploying tools clearly similar to those involved in its other activities, such as <a href="https://www.welivesecurity.com/2020/06/17/operation-interception-aerospace-military-companies-cyberspies/" target="_blank" rel="noopener">Operation In(ter)ception</a>. For example, the campaign involving tools signed with 2 TOY GUYS certificates (see <a href="https://web-assets.esetstatic.com/wls/en/papers/threat-reports/eset_threat_report_t12021.pdf#page=11" target="_blank" rel="noopener">ESET Threat Report T1 2021, page 11</a>), and the case of <a href="https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/" target="_blank" rel="noopener">Amazon-themed lures</a> in the Netherlands and Belgium published in September 2022.</p>
<p>Our attribution is based on the following factors, which show a relationship mostly with the previously mentioned Amazon-themed campaign:</p>
<p>1. Malware (the intrusion set):</p>
<ul>
<li>Initial access was obtained by making contact via LinkedIn and then convincing the target to execute malware, disguised as a test, in order to succeed in a hiring process. This is a known Lazarus tactic, used at least since Operation DreamJob.</li>
<li>We observed new variants of payloads that were previously identified in the Dutch case from last year, such as intermediate loaders and the BlindingCan backdoor <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.blindingcan" target="_blank" rel="noopener">linked with Lazarus</a>.</li>
<li>Multiple types of strong encryption were leveraged in the tools of this Lazarus campaign – AES-128 and RC6 with a 256-bit key – that were also used in the Amazon-themed campaign.</li>
</ul>
<p>2. Infrastructure:</p>
<ul>
<li>For the first-level C&amp;C servers (listed in the Network section at the end of this blogpost), the attackers do not set up their own servers, but compromise existing ones, usually those having poor security and that host sites with neglected maintenance. This is a <a href="https://www.microsoft.com/en-us/security/blog/2022/09/29/zinc-weaponizing-open-source-software/" target="_blank" rel="noopener">typical</a>, yet weak-confidence behavior, of Lazarus.</li>
</ul>
<p>3. <em><a href="https://en.wikipedia.org/wiki/Cui_bono" target="_blank" rel="noopener">Cui bono</a>:</em></p>
<ul>
<li>Pilfering the know-how of an aerospace company is aligned with long-term goals manifested by Lazarus.</li>
</ul>
<h2>Initial access</h2>
<p>The group targeted multiple company employees via LinkedIn Messaging. Masquerading as a <a href="https://www.meta.com/" target="_blank" rel="noopener">Meta</a> recruiter, the attacker used a job offer lure to attract the target’s attention and trust; a screenshot of this conversation, which we obtained during our cooperation with the Spanish aerospace company, is depicted in Figure 1.</p>
<figure><img title="" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-01-copy-2.png" alt="Figure_01 - Copy (2)" width="" height=""/>
<figcaption><em>Figure 1. The initial contact by the attacker impersonating a recruiter from Meta</em></figcaption>
</figure>
<p>At the beginning of Lazarus attacks, the unaware targets are usually convinced to recklessly self-compromise their systems. For this purpose, the attackers employ different strategies; for example, the target is lured to execute an attacker-provided (and trojanized) PDF viewer to see the full content of a job offer. Alternately, the target is encouraged to connect with a trojanized SSL/VPN client, being provided with an IP address and login details. Both scenarios are described in a <a href="https://www.microsoft.com/en-us/security/blog/2022/09/29/zinc-weaponizing-open-source-software/" target="_blank" rel="noopener">Microsoft blogpost</a> published in September 2022. The narrative in this case was the scammer’s request to prove the victim’s proficiency in the C++ programming language.</p>
<p>Two malicious executables, <span>Quiz1.exe</span> and <span>Quiz2.exe</span>, were provided for that purpose and delivered via the <span>Quiz1.iso</span> and <span>Quiz2.iso</span> images hosted on a third-party cloud storage platform. Both executables are very simple command line applications asking for input.</p>
<p>The first one is a Hello World project, which is a very basic program, often consisting of just a single line of code, that displays the text “Hello, World!” when executed. The second prints a Fibonacci sequence up to the largest element smaller than the number entered as input. A Fibonacci sequence is a series of numbers in which each number is the sum of the two preceding ones, typically starting with 0 and 1; however, in this malicious challenge, the sequence starts with 1 and 2. Figure 2 displays example output from the Fibonacci sequence challenge. After the output is printed, both executables trigger the malicious action of installing additional payloads from the ISO images onto the target’s system. The task for a targeted developer is to understand the logic of the program and rewrite it in the C++ programming language.</p>
<figure><img title="Figure 2. The output of the decoy program Quiz2.exe" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 2. The output of the decoy program Quiz2.exe</em></figcaption>
</figure>
<p>The chain of events that led to the initial compromise is sketched in Figure 3. The first payload delivered to the target’s system is an HTTP(S) downloader that we have named NickelLoader. The tool allows the attackers to deploy any desired program into the memory of the victim’s computer.</p>
<figure><img title="Figure 3. The chain of events completing the initial access" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 3. The chain of events completing the initial access</em></figcaption>
</figure>
<h2>Post-compromise toolset</h2>
<p>Once NickelLoader is running on the target’s system, the attackers use it to deliver two types of RATs. One of these RATs is already known to be part of the Lazarus toolkit, specifically a variant of the BlindingCan backdoor with limited functionality but identical command processing logic. To distinguish it, we put the prefix mini- in front of the variant’s name. Additionally, the attackers introduced a RAT not previously undocumented publicly, which we have named LightlessCan.</p>
<p>The RATs are deployed as the final step of chains of stages with varying levels of complexity and are preceded by helper executables, like droppers and loaders. We denote an executable as a dropper if it contains an embedded payload, even if it’s not dropped onto the file system but instead loaded directly into memory and executed. Malware that doesn’t have an encrypted embedded data array, but that loads a payload from the file system, we denote as a loader.</p>
<p>Besides the initial quiz-related lures, Table 1 summarizes the executable files (EXEs) and dynamic link libraries (DLLs) delivered to the victim’s system. All the malware samples in the third column are trojanized open-source applications (see the fourth column for the underlying project), with a legitimate executable side-loading a malicious DLL. For example, the malicious <span>mscoree.dll</span> is a trojanized version of the legitimate NppyPluginDll; the DLL contains an embedded NickelLoader and is loaded by a legitimate <span>PresentationHost.exe</span>, both located in the <span>C:\ProgramShared</span> directory.</p>
<p><em><a name="_Ref99698352"></a><span lang="EN-US">Table </span><!-- [if supportFields]><span style='mso-bookmark:
_Ref99698352'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:_Ref99698352'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>SEQ Table \* ARABIC <span style='mso-element:
field-separator'></span></span></span><![endif]--><span lang="EN-US">1</span><!-- [if supportFields]><span
style='mso-bookmark:_Ref99698352'></span><span style='mso-element:field-end'></span><![endif]--></em><span lang="EN-US"><em>. Summary of binaries involved in the attack</em></span></p>
<table>
<thead>
<tr>
<td>
<p><strong>Location directory</strong></p>
</td>
<td>
<p><strong>Legitimate parent process</strong></p>
</td>
<td>
<p><strong>Malicious side-loaded DLL</strong></p>
</td>
<td>
<p><strong>Trojanized project</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span>C:\ProgramShared\</span></p>
</td>
<td>
<p><span>PresentationHost.exe</span></p>
</td>
<td>
<p><span>mscoree.dll</span></p>
</td>
<td>
<p>NppyPluginDll</p>
</td>
</tr>
<tr>
<td>
<p><span>C:\ProgramData\Adobe\</span></p>
</td>
<td>
<p><span>colorcpl.exe</span></p>
</td>
<td>
<p><span>colorui.dll</span></p>
</td>
<td>
<p>LibreSSL 2.6.5</p>
</td>
</tr>
<tr>
<td>
<p><span>C:\ProgramData\Oracle\Java\</span></p>
</td>
<td>
<p><span>fixmapi.exe</span></p>
</td>
<td>
<p><span>mapistub.dll</span></p>
</td>
<td>
<p>Lua plugin for Notepad++ 1.4.0.0</p>
</td>
</tr>
<tr>
<td>
<p><span>C:\ProgramData\Adobe\ARM\</span></p>
</td>
<td>
<p><span>tabcal.exe</span></p>
</td>
<td>
<p><span>HID.dll</span></p>
</td>
<td>
<p>MZC8051 for Notepad++ 3.2</p>
</td>
</tr>
</tbody>
</table>
<h2>LightlessCan – new backdoor</h2>
<p>The most interesting payload used in this campaign is LightlessCan, a successor of the group’s flagship HTTP(S) Lazarus RAT named BlindingCan. LightlessCan is a new complex RAT that has support for up to 68 distinct commands, indexed in a custom function table, but in the current version, 1.0, only 43 of those commands are implemented with some functionality. The remaining commands are present but have a formal implementation in the form of placeholders, lacking actual functionality. The project behind the RAT is definitely based on the BlindingCan source code, as the order of the shared commands is preserved significantly, even though there may be differences in their indexing.</p>
<p>The most significant update is mimicked functionality of many native <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands" target="_blank" rel="noopener">Windows commands</a> like <span>ping</span>, <span>ipconfig</span>, <span>systeminfo</span>, <span>sc</span>, <span>net</span>, etc. The hardcoded string “The operation completed successfully.”, the standard system message for the <a href="https://learn.microsoft.com/en-us/windows/win32/debug/system-error-codes--0-499-" target="_blank" rel="noopener">ERROR_SUCCESS</a> result, brought us to that idea. Table 2 contains a list of those commands that are implemented in LightlessCan. In previously reported Lazarus attacks, as documented in blogposts by <a href="https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/lazarus-recruitment/" target="_blank" rel="noopener">Positive Technologies</a> in April 2021 and <a href="https://www.hvs-consulting.de/media/downloads/ThreatReport-Lazarus.pdf" target="_blank" rel="noopener">HvS Consulting</a> in December 2020, these native commands are often executed <a href="https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html" target="_blank" rel="noopener">in many instances</a> after the attackers have gotten a foothold in the target’s system. However, in this case, these commands are executed discreetly within the RAT itself, rather than being executed visibly in the system console. This approach offers a significant advantage in terms of stealthiness, both in evading real-time monitoring solutions like EDRs, and postmortem digital forensic tools. The internal version number (1.0) indicates that this represents a new development effort by the attackers.</p>
<p>As the core utilities of Windows are proprietary and not open-source, the developers of LightlessCan faced a choice: either to reverse engineer the closed-source system binaries or to get inspired by the code available via the <a href="https://www.winehq.org/" target="_blank" rel="noopener">Wine</a> project, where many <a href="https://gitlab.winehq.org/wine/wine/-/tree/master/programs" target="_blank" rel="noopener">programs</a> are rewritten in order to mimic their execution on other platforms like Linux, macOS, or ChromeOS. We are inclined to believe the developers chose the first option, as the corresponding Wine programs they mimicked in LightlessCan were implemented a little bit differently or not at all (e.g., <span>netsh</span>).</p>
<p>Interestingly, in one of the cases we analyzed, the LightlessCan payload is stored in an encrypted file on the compromised machine, which can only be decrypted using an environment-dependent key. More details about this can be found in the <em><a href="#Execution chain 3: LightlessCan (complex version)">Execution chain 3: LightlessCan (complex version)</a></em> section. This is to ensure that the payload can only be decrypted on the computer of the intended victim and not, for example, on a device of a security researcher.</p>
<p><span lang="EN-US"><em>Table 2. The list of LightlessCan commands mimicking those for Windows prompt</em></span></p>
<table>
<thead>
<tr>
<td>
<p><strong>Index </strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span>33</span></p>
</td>
<td>
<p>Mimic the <span>ipconfig </span>command from the Windows command prompt; see Figure 4.</p>
</td>
</tr>
<tr>
<td>
<p><span>34</span></p>
</td>
<td>
<p>Mimic the <span>net</span> command from the Windows prompt; see Figure 5.</p>
</td>
</tr>
<tr>
<td>
<p><span>35</span></p>
</td>
<td>
<p>Mimic the <span>netshadvfirewall firewall</span> command from the Windows prompt; see Figure 4.</p>
</td>
</tr>
<tr>
<td>
<p><span>36</span></p>
</td>
<td>
<p>Mimic the <span>netstat </span>command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>37</span></p>
</td>
<td>
<p>Mimic the <span>ping -6</span> command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>38</span></p>
</td>
<td>
<p>Mimic the <span>reg </span>command from the Windows prompt; see Figure 7.</p>
</td>
</tr>
<tr>
<td>
<p><span>39</span></p>
</td>
<td>
<p>Mimic the <span>sc </span>command from the Windows prompt; see Figure 8.</p>
</td>
</tr>
<tr>
<td>
<p><span>40</span></p>
</td>
<td>
<p>Mimic the <span>ping </span>command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>41</span></p>
</td>
<td>
<p>Mimic the <span>tasklist </span>command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>42</span></p>
</td>
<td>
<p>Mimic the <span>wmic process call create</span> command from the Windows prompt; see Figure 9.</p>
</td>
</tr>
<tr>
<td>
<p><span>43</span></p>
</td>
<td>
<p>Mimic the <span>nslookup </span>command from the Windows Server prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>44</span></p>
</td>
<td>
<p>Mimic the <span>schstasks </span>command from the Windows prompt; see Figure 10.</p>
</td>
</tr>
<tr>
<td>
<p><span>45</span></p>
</td>
<td>
<p>Mimic the <span>systeminfo </span>command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>46</span></p>
</td>
<td>
<p>Mimic the <span>arp </span>command from the Windows prompt.</p>
</td>
</tr>
<tr>
<td>
<p><span>47</span></p>
</td>
<td>
<p>Mimic the <span>mkdir </span>command from the Windows prompt.</p>
</td>
</tr>
</tbody>
</table>
<figure><img title="Figure 4. Hardcoded strings revealing the subset of the ipconfig functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-04-ipconfig.png" alt="Figure_04_ipconfig" width="" height=""/>
<figcaption><em>Figure 4. Hardcoded strings revealing the subset of the <span>ipconfig</span> functionality</em></figcaption>
</figure>
<figure><img title="Figure 5. Hardcoded strings revealing the subset of the net functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-05-net.png" alt="Figure_05_net" width="" height=""/>
<figcaption><em>Figure 5. Hardcoded strings revealing the subset of the <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/net-commands-on-operating-systems" target="_blank" rel="noopener"><span>net</span> </a>functionality</em></figcaption>
</figure>
<figure><img title="Figure 6. Hardcoded strings revealing the netsh firewall functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-06-netsh.png" alt="Figure_06_netsh" width="" height=""/>
<figcaption><em>Figure 6. Hardcoded strings revealing the <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior" target="_blank" rel="noopener"><span>netsh firewall</span></a> functionality</em></figcaption>
</figure>
<figure><img title="Figure 7. Hardcoded strings revealing the (partial) reg functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 7. Hardcoded strings revealing the (partial) <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg" target="_blank" rel="noopener"><span>reg</span> </a>functionality</em></figcaption>
</figure>
<figure><img title="Figure 8. Hardcoded strings revealing the (partial) sc functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2-3.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 8. Hardcoded strings revealing the (partial) <a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc754599(v=ws.11)" target="_blank" rel="noopener"><span>sc</span></a> functionality</em></figcaption>
</figure>
<figure><img title="Figure 9. Hardcoded strings revealing the wmic process call create functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2-3-4.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 9. Hardcoded strings revealing the <span>wmic process call create</span> functionality</em></figcaption>
</figure>
<figure><img title="Figure 10. Hardcoded strings revealing the (partial) schtasks functionality" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2-3-4-5.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 10. Hardcoded strings revealing the (partial) <span>schtasks</span> functionality</em></figcaption>
</figure>
<p>Furthermore, an examination of the RAT’s internal configuration suggests that, in comparison to BlindingCan, Lazarus increased the code sophistication in LightlessCan.</p>
<h2>Technical analysis</h2>
<p>In this section, we provide technical details about the compromise chain that delivers the NickelLoader downloader, and the three execution chains Lazarus used to deliver its payloads on the compromised system.</p>
<h3>Compromise chain: NickelLoader</h3>
<p>NickelLoader is an HTTP(S) downloader executed on the compromised system via DLL side-loading, which is later used to deliver other Lazarus payloads.</p>
<p>The process of delivering NickelLoader unfolds in a series of stages, commencing with the execution of <span>PresentationHost.exe</span>, which is triggered automatically after the target manually executes the initial quiz challenges; the <span>Quiz1 </span>case is depicted in Figure 3. A malicious dynamically linked library, <span>mscoree.dll</span>, is then side-loaded by the legitimate <span>PresentationHost.exe</span> – both located in <span>C:\ProgramShared\</span>. This DLL is a trojanized <span>NppyPluginDll.dll</span>, from the inactive <a href="https://github.com/Ciantic/NppyPluginDll" target="_blank" rel="noopener">General Python Plugins DLL for Notepad++</a> project from 2011. It serves as a dropper and has various exports: all the exports copied from the original <span>NppyPluginDll.dll</span> plus all the exports from the legitimate <span>mscoree.dll</span>. One of these legitimate exports, <span>CorExitProcess</span>, contains the malicious code responsible for the decryption and execution of the next malware stage.</p>
<p>To successfully decrypt an encrypted data array embedded in the dropper, three 16-character-long keywords are required by the dropper. These keywords are as follows:</p>
<ol>
<li>the name of the parent process (<span>PresentationHost</span>),</li>
<li>the internal parameter hardcoded in the binary (<span>9zCnQP6o78753qg8</span>), and</li>
<li>the external parameter passed on the command line (<span>‑embeddingObject</span>), which is inherited from the parent process of <span>PresentationHost.exe</span>, being provided by <span>Quiz1.exe</span> or <span>Quiz2.exe</span>.</li>
</ol>
<p>The keywords are XOR-ed byte by byte and the output forms the AES-128 decryption key.</p>
<p>The payload is an HTTP(S) downloader that recognizes four commands, all five letters long, shown in Table 3. Because of those five letter commands, we chose to name this payload “NickelLoader”, drawing inspiration from the colloquial term for the US five-cent coin – a nickel. The most important commands are <span>avdrq </span>and <span>gabnc</span>. When these commands are issued, each of them loads data received from the C&amp;C server as a DLL. For this purpose, the attackers probably used <a href="https://github.com/fancycode/MemoryModule" target="_blank" rel="noopener">MemoryModule</a>, a library that can be used to load a DLL completely from memory.</p>
<p><span lang="EN-US"><em>Table 3. The list of magic keywords recognized in received buffers</em></span></p>
<table>
<thead>
<tr>
<td>
<p><strong>Keyword</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span><span lang="EN-US">abcde</span></span></p>
</td>
<td>
<p><span lang="EN-US">Requests another immediate command without the usual long sleep delay that separates the execution of the commands.</span></p>
</td>
</tr>
<tr>
<td>
<p><span><span lang="EN-US">avdrq</span></span></p>
</td>
<td>
<p><span lang="EN-US">Loads a DLL contained in the received buffer and executes its hardcoded export </span><span lang="EN-US">info</span><span lang="EN-US">.</span></p>
</td>
</tr>
<tr>
<td>
<p><span><span lang="EN-US">gabnc</span></span></p>
</td>
<td>
<p><span lang="EN-US">Loads a DLL contained in the received buffer.</span></p>
</td>
</tr>
<tr>
<td>
<p><span><span lang="EN-US">dcrqv</span></span></p>
</td>
<td>Terminates itself.</td>
</tr>
</tbody>
</table>
<h3>Execution chain 1: miniBlindingCan</h3>
<p>One of the payloads downloaded and executed by NickelLoader is miniBlindingCan, a simplified version of the group’s flagship BlindingCan RAT. It was reported for the first time by <a href="https://www.mandiant.com/resources/blog/dprk-whatsapp-phishing" target="_blank" rel="noopener">Mandiant</a> in September 2022, under the name AIRDRY.V2.</p>
<p>To load miniBlindingCan, a 64-bit malicious dynamically linked library <span>colorui.dll </span>is side-loaded by a legitimate <span>colorcpl.exe</span> executed from <span>C:\ProgramData\Adobe\</span> and serves as a dropper. The DLL is obfuscated using VMProtect and contains thousands of exports from which <span>LaunchColorCpl</span> is the most important, as it handles the execution of the next stage. There’s an encrypted data array in the DLL’s dumped body, together with multiple debug symbols revealing the root directory and the project from which it was built:</p>
<p><span>W:\Develop\aTool\ShellCodeLoader\App\libressl-2.6.5\</span></p>
<p>As the name <span>ShellCodeLoader </span>suggests, the main purpose of this initial stage is to decrypt and load the data array from its body, which contains shellcode. At the beginning of its execution, <span>ShellCodeLoader </span>employs anti-debugging techniques by inspecting the <span>BeingDebugged </span>value within the Process Environment Block (PEB) structure to determine if it’s being scrutinized or analyzed by debugging tools, and utilizes anti-sandbox techniques to avoid detection within sandboxed environments designed for security analysis. The malware also explicitly checks whether its parent process is <span>colorcpl.exe</span>; if not, it exits immediately.</p>
<p>The decrypted data array is not a complete DLL, but forms an intermediate blob with two parts: shellcode followed by another encrypted data array, which represents the last step of the chain. The shellcode seems to be produced by an instance of the open-source project <a href="https://github.com/monoxgas/sRDI/tree/master/ShellcodeRDI" target="_blank" rel="noopener">ShellcodeRDI</a> – in particular, the <span>ShellcodeRDI.c</span> code. It was probably produced by executing the Python script <span>ConvertToShellcode.py</span> from this project on a payload DLL acting as a source for <a href="https://disman.tl/2015/01/30/an-improved-reflective-dll-injection-technique.html" target="_blank" rel="noopener">reflective DLL injection</a>.</p>
<p>The final payload is extracted and decrypted using XOR with a long key, which is a string built by concatenating the name of the parent process (<span>colorcpl.exe</span>), the filename of the dropper (<span>colorui.dll</span>), and the external command line parameter – in this case resulting in <span>COLORCPL.EXECOLORUI.DLL669498484488D3F22712CC5BACA6B7A7</span>. This process is akin to what we observed with BlindingCan backdoor in the Dutch case we previously described in <a href="https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/" target="_blank" rel="noopener">this WeLiveSecurity blogpost</a>. The decryption reveals an executable with download-and-execute functionality, whose internal logic of sending and parsing commands is strongly reminiscent of BlindingCan, a flagship HTTP(S) Lazarus RAT. Unlike the case in the Netherlands, it is not VMProtect-ed and it supports only a small subset of commands available previously: compare Table 4in this blogpost and Table 3 in the <a href="https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/" target="_blank" rel="noopener">blogpost on the Dutch case</a> from September 2022. Because the features of this RAT are notably scaled down compared to those in BlindingCan, and yet they seem to share the same server-side infrastructure, we have chosen to distinguish it by appending the prefix “mini-“ to its name, highlighting its reduced functionality compared to its fully-featured RAT counterpart.</p>
<p><em>Table 4. Commands of miniBlindingCan</em></p>
<table>
<thead>
<tr>
<td>
<p><strong>Command ID </strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span>8201</span></p>
</td>
<td>
<p>Send system information like computer name, Windows version, and code page.</p>
</td>
</tr>
<tr>
<td>
<p><span>8232</span></p>
</td>
<td>
<p>Update the current communication interval with a value provided by the C&amp;C server.</p>
</td>
</tr>
<tr>
<td>
<p><span>8233</span></p>
</td>
<td>
<p>Discontinue the command execution.</p>
</td>
</tr>
<tr>
<td>
<p><span>8241</span></p>
</td>
<td>
<p>Send the current configuration of size 9,392 bytes to the C&amp;C server.</p>
</td>
</tr>
<tr>
<td>
<p><span>8242</span></p>
</td>
<td>
<p>Update the configuration of size 9,392 bytes, stored encrypted on the file system.</p>
</td>
</tr>
<tr>
<td>
<p><span>8247</span></p>
</td>
<td>
<p>Wait for the next command.</p>
</td>
</tr>
<tr>
<td>
<p><span>8248</span></p>
</td>
<td>
<p>Update the current communication interval with a value stored in the configuration.</p>
</td>
</tr>
<tr>
<td>
<p><span>8274</span></p>
</td>
<td>
<p>Download and decrypt a file from the C&amp;C server.</p>
</td>
</tr>
<tr>
<td>
<p><span>8279</span></p>
</td>
<td>
<p>Execute shellcode passed as a parameter.</p>
</td>
</tr>
</tbody>
</table>
<p>Figure 11 shows the decrypted state of a 9,392-byte-long configuration embedded in the RAT. It contains five URLs, in this case compromised websites, each limited by a maximum size of 260 <a href="https://en.wikipedia.org/wiki/Wide_character" target="_blank" rel="noopener">wide characters</a>.</p>
<figure><img title="Figure 11. A configuration of the miniBlindingCan backdoor. The highlighted value is the count of URLs, but only the first and the last of the five URLs are shown here. The purpose of the last two wide strings is not known" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2-3-4-5-6.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 11. A configuration of the miniBlindingCan backdoor. The highlighted value is the count of URLs, but only the first and the last of the five URLs are shown here. The purpose of the last two wide strings is not known</em></figcaption>
</figure>
<h3>Execution chain 2: LightlessCan (simple version)</h3>
<p>Another payload we have seen executed by NickelLoader is LightlessCan, a new Lazarus backdoor. We have observed two different chains loading this backdoor.</p>
<p>In the simple version of the chain, the dropper of this payload is the malicious dynamically linked library <span>mapistub.dll</span> that is side-loaded by the legitimate <span>fixmapi.exe</span> executed from <span>C:\ProgramData\Oracle\Java\</span>. The DLL is a trojanized Lua plugin, version 1.4, with all the exports copied from the legitimate Windows <span>mapi32.dll</span>. The export <span>FixMAPI</span> contains malicious code responsible for decrypting and loading the next stage; all the other exports contain benign code sourced from a publicly available <a href="https://github.com/gbelwariar/Self-Made-Projects/tree/master/Minesweeper" target="_blank" rel="noopener">MineSweeper sample project</a>. This <span>mapistub.dll</span> dropper has persistence established via a scheduled task. Unfortunately, we lack additional details about this task, except that its parent process appears as <span>%WINDOWS%\system32\svchost.exe -k netsvcs -p -s Schedule</span>.</p>
<p>To successfully decrypt the embedded data array, the dropper needs three keywords to be provided correctly:</p>
<ol>
<li>the name of the parent process (<span>fixmapi.exe</span>),</li>
<li>the internal parameter hardcoded in the binary (<span>IP7pdINfE9uMz63n</span>), and</li>
<li>the external parameter passed in the command line (<span>AudioEndpointBuilder</span>).</li>
</ol>
<p>The keywords are XOR-ed byte by byte and the output forms a 128-bit AES key to be used for decryption. Note that the length of the keywords are not all exactly 16 bytes, but the decryption process will still work if the oversized string is truncated to a 16-byte length (for instance, <span>AudioEndpointBuilder </span>to <span>AudioEndpointBui</span>), and the undersized string, <span>fixmapi.exe</span>, is treated as <span>fixmapi.exe\x00\x00\x00\x00\x00</span>, because the string was initialized as 260 instances of the <a href="https://en.wikipedia.org/wiki/Null_character" target="_blank" rel="noopener">NUL</a> character.</p>
<h3>Execution chain 3: LightlessCan (complex version)<a id="Execution chain 3: LightlessCan (complex version)"></a></h3>
<p>The most complex chain we observed on the compromised system also delivers LightlessCan, with various components involved in the complete chain of installation stages: a legitimate application, an initial dropper, a complete dropper (which contains the configuration), an intermediate dropper, a configuration file, a file with system information (for the decryption of encrypted payloads on the file system), an intermediate loader and the final step, the LightlessCan RAT. The connections and relationships among these files are illustrated in Figure 12.</p>
<figure><img title="Figure 12. A complex chain of stages delivering the fourth payload" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-12-chain.png" alt="Figure_12_chain" width="" height=""/>
<figcaption><em>Figure 12. A complex chain of stages delivering the fourth payload</em></figcaption>
</figure>
<p>The initial dropper of the fourth chain is a malicious dynamically linked library <span>HID.dll</span> that is side-loaded by a legitimate executable, <span>tabcal.exe</span>, executed from <span>C:\ProgramData\Adobe\ARM\</span>. The DLL is a trojanized version of <span>MZC8051.dll</span>, a legitimate file from the <a href="https://github.com/Jiangshan00001/npp_MZC8051" target="_blank" rel="noopener">8051 C compiler plugin</a> project for Notepad++. It contains all the exports from the original project, but also the necessary exports from the legitimate Hid User Library by Microsoft, so that the side-loading by <span>tabcal.exe</span> will be successful. The export <span>HidD_GetHidGuid</span> contains the malicious code responsible for dropping the next stage and, as in the case of the dropper of the previous chain (Execution chain 2), all the other exports contain the benign MineSweeper code.</p>
<p>As in the previous cases, three long keywords must be provided to decrypt the embedded payload:</p>
<ol>
<li>the name of the parent process (<span>tabcal.exe</span>),</li>
<li>the internal parameter hardcoded in the binary (<span>9zCnQP6o78753qg8</span>), and</li>
<li>the external parameter (<span>LocalServiceNetworkRestricted</span>) – this time not expressed as a command line parameter, but instead as the content of a file located at <span>%WINDOWS%\system32\thumbs.db</span>.</li>
</ol>
<p>Again, the keywords are XOR-ed byte by byte and the output forms a 128-bit AES key to be used for the decryption. As in the previous case, the lengths of the keywords are not all exactly 16 bytes, but the decryption will still work if the oversized string is truncated (for instance, to <span>LocalServiceNetw</span>) and the undersized string is extended with nulls (for instance, to <span>tabcal.exe\x00\x00\x00\x00\x00\x00</span>).</p>
<p>The executable produced by the above recipe is the complete dropper from Figure 12 and has the InternalName resource <span>AppResolver.dll</span> (found in the VERSIONINFO resource). It contains two encrypted data arrays: a small one of 126 bytes, and a large one of 1,807,464 bytes (which contains three subparts). First, it decrypts the small array using the RC6 algorithm with the hardcoded 256-bit key <span>DA 48 A3 14 8D BF E2 D2 EF 91 12 11 FF 75 59 A3 E1 6E A0 64 B8 78 89 77 A0 37 91 58 5A FF FF 07</span>. The output represents paths to which the first two subparts of the large blob are dropped (i.e., LightlessCan and the intermediate dropper), and yields the strings <span>C:\windows\system32\oci.dll</span> and <span>C:\windows\system32\grpedit.dat</span>.</p>
<p>Next, it continues with decrypting the second data array – the large blob – using the same encryption key as before. The result is a decrypted blob containing three subparts: a DLL corresponding to <span>grpedit.dat</span> (LightlessCan), a DLL corresponding to <span>oci.dll</span> (the intermediate dropper), and a 14,948 byte encrypted file dropped to <span>%WINDOWS%\System32\wlansvc.cpl </span>(configuration); as depicted in Figure 13.</p>
<figure><img title="Figure 13. The decrypted configuration stored in wlansvc.cpl" src="https://web-assets.esetstatic.com/wls/2023/2023-09/lazarus-in-spain/figure-03-1-2-3-4-5-6-7.png" alt="Figure_03" width="" height=""/>
<figcaption><em>Figure 13. The decrypted configuration stored in wlansvc.cpl</em></figcaption>
</figure>
<p>Moreover, the complete dropper also stores several characteristics identifying the compromised system in the file <span>%WINDOWS%\System32\4F59FB87DF2F</span>, whose name is hardcoded in the binary. These characteristics are primarily retrieved from the <span>Computer\HKLM\HARDWARE\DESCRIPTION\System\BIOS</span> registry path. Here are the specific values of these characteristics, along with a PowerShell command provided in brackets that can be used to display the corresponding value on any Windows machine:</p>
<ul>
<li>SystemBIOSDate (<span>Get-ItemProperty &#34;HKLM:\HARDWARE\Description\System\BIOS&#34; -Name BIOSReleaseDate | Select-Object -Property BIOSReleaseDate</span>)</li>
<li>SystemBIOSVersion (<span>Get-CimInstance -ClassName Win32_Bios | Select-Object -Property Version</span>)</li>
<li>SystemManufacturer (<span>Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object -Property Manufacturer</span>)</li>
<li>SystemProductName (<span>Get-CimInstance -ClassName Win32_ComputerSystemProduct | Select-Object -Property Name</span>)</li>
<li>Identifier in <span>Computer\HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\MultifunctionAdapter\0\DiskController\0\DiskPeripheral\0</span></li>
</ul>
<p>The concatenation of the values is required for decryption of the encrypted <span>grpedit.dat</span> from the file system. On a test machine running an image of Windows 10 on VMWare, the output can be:</p>
<p><span>11/12/20INTEL - 6040000VMware, Inc.VMware Virtual Platform656ba047-20b25a2a-A</span></p>
<p>The <span>oci.dll</span> file is another dropping layer – the intermediate dropper that drops the intermediate loader, which is a payload similar to the one described in the previously mentioned <a href="https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/" target="_blank" rel="noopener">Dutch case</a>. Again, the attackers used an open-source project, the <a href="https://web.archive.org/web/0/https:/github.com/Nikipit/Flashing-tip" target="_blank" rel="noopener">Flashing Tip</a> plugin for Notepad++, which is no longer available online. Unlike the previous cases, only two long keywords must be provided in order to decrypt the embedded payload successfully using AES-128:</p>
<ol>
<li>the name of the parent process (<span>msdtc.exe</span>), and</li>
<li>the internal parameter hardcoded in the binary (<span>fb5XPNCr8v83Y85P</span>).</li>
</ol>
<p>Both keywords are XOR-ed byte by byte (the parent process name is truncated, or padded with NULLs, as necessary to fill 16 bytes). The product of the decryption is the intermediate loader (<span>LLTMapperAPI.dll</span>). It uses the system information (same as the values stored in <span>4F59FB87DF2F</span>) to decrypt the configuration file <span>wlansvc.cpl</span> and to locate, decrypt, and load the encrypted <span>grpedit.dat</span>, which is LightlessCan, the new full-featured RAT.</p>
<h2>Conclusion</h2>
<p>We have described a new Lazarus attack that originated on LinkedIn where fake recruiters approached their potential victims, who were using corporate computers for personal purposes. Even though public awareness of these types of attacks should be high, the success rates of these campaigns have still not dropped to zero.</p>
<p>The most worrying aspect of the attack is the new type of payload, LightlessCan, a complex and possibly evolving tool that exhibits a high level of sophistication in its design and operation, representing a significant advancement in malicious capabilities compared to its predecessor, BlindingCan.</p>
<p>The attackers can now significantly limit the execution traces of their favorite Windows command line programs that are heavily used in their post-compromise activity. This maneuver has far-reaching implications, impacting the effectiveness of both real-time monitoring solutions and of post-mortem digital forensic tools.</p>
<blockquote>
<p>For any inquiries about our research published on WeLiveSecurity, please contact us at <a href="mailto:threatintel@eset.com?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=autotagging&amp;utm_content=eset-research&amp;utm_term=en">threatintel@eset.com</a>.</p>
</blockquote>
<h2>IoCs</h2>
<h3>Files</h3>
<table>
<thead>
<tr>
<td>
<p><strong>SHA-1</strong></p>
</td>
<td>
<p><strong>Filename</strong></p>
</td>
<td>
<p><strong>Detection</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span>C273B244EA7DFF20B1D6B1C7FD97F343201984B3</span></p>
</td>
<td nowrap="nowrap">
<p><span>%TEMP%\7zOC35416EE\Quiz1.exe</span></p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KT</p>
</td>
<td nowrap="nowrap">
<p>An initial dropper disguised as a “Hello World” challenge that triggers the compromise.</p>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<p><span>38736CA46D7FC9B9E5C74D192EEC26F951E45752</span></p>
</td>
<td nowrap="nowrap">
<p><span>%TEMP%\7zOCB3CC96D\Quiz2.exe</span></p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KT</p>
</td>
<td nowrap="nowrap">
<p>An initial dropper disguised as a “Fibonacci sequence” challenge that triggers the compromise.</p>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<p><span>C830B895FB934291507E490280164CC4234929F0</span></p>
</td>
<td nowrap="nowrap">
<p><span>%ALLUSERSPROFILE%\Adobe\colorui.dll</span></p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KV</p>
</td>
<td nowrap="nowrap">
<p>A VMProtect-ed dropper side-loaded by the legitimate <span>colorcpl.exe</span>. It contains the debug information string <span>W:\Develop\aTool\ShellCodeLoader\App\libressl-2.6.5</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>8CB37FA97E936F45FA8ECD7EB5CFB68545810A22</span></p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>Win64/NukeSped.KU</p>
</td>
<td>
<p>The miniBlindingCan backdoor dropped by <span>colorui.dll</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>0F33ECE7C32074520FBEA46314D7D5AB9265EC52</span></p>
</td>
<td>
<p><span>%ALLUSERSPROFILE%\Oracle\Java\mapistub.dll</span></p>
</td>
<td>
<p>Win64/NukeSped.KW</p>
</td>
<td nowrap="nowrap">
<p>A dropper of LightlessCan, side-loaded by the legitimate <span>fixmapi.exe</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>C7C6027ABDCED3093288AB75FAB907C598E0237D</span></p>
</td>
<td>
<p>N/A</p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KW</p>
</td>
<td nowrap="nowrap">
<p>A LightlessCan backdoor dropped by <span>mapistub.dll</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>C136DD71F45EAEF3206BF5C03412195227D15F38</span></p>
</td>
<td>
<p><span>C:\ProgramShared\mscoree.dll</span></p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KT</p>
</td>
<td nowrap="nowrap">
<p>A dropper of NickelLoader, side-loaded by <span>PresentationHost.exe</span>. It is dropped by both quiz-related samples: <span>C273B244EA7DFF20B1D6B1C7FD97F343201984B3</span> and <span>38736CA46D7FC9B9E5C74D192EEC26F951E45752</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>E61672B23DBD03FE3B97EE469FA0895ED1F9185D</span></p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>Win64/NukeSped.KT</p>
</td>
<td>
<p>An HTTPS downloader we’ve named NickelLoader, dropped by <span>mscoree.dll</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>E18B9743EC203AB49D3B57FED6DF5A99061F80E0</span></p>
</td>
<td>
<p><span>%ALLUSERSPROFILE%\Adobe\ARM\HID.dll</span></p>
</td>
<td>
<p>Win64/NukeSped.KX</p>
</td>
<td nowrap="nowrap">
<p>An initial dropper side-loaded by the legitimate <span>tabcal.exe</span>.</p>
</td>
</tr>
<tr>
<td>
<p><span>10BD3E6BA6A48D3F2E056C4F974D90549AED1B96</span></p>
</td>
<td nowrap="nowrap">
<p>N/A</p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KT</p>
</td>
<td nowrap="nowrap">
<p>The complete dropper <span>AppResolver.dll</span> dropped by <span>HID.dll</span> in the complex chain of LightlessCan delivery.</p>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<p><span>3007DDA05CA8C7DE85CD169F3773D43B1A009318</span></p>
</td>
<td>
<p><span>%WINDIR%\system32\grpedit.dat</span></p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KW</p>
</td>
<td nowrap="nowrap">
<p>A LightlessCan backdoor dropped in the complex chain of its delivery.</p>
</td>
</tr>
<tr>
<td>
<p><span>247C5F59CFFBAF099203F5BA3680F82A95C51E6E</span></p>
</td>
<td>
<p><span>%WINDIR%\system32\oci.dll</span></p>
</td>
<td nowrap="nowrap">
<p>@Trojan.Win64/NukeSped.MI</p>
</td>
<td nowrap="nowrap">
<p>The intermediate dropper dropping the intermediate loader in the complex chain of the LightlessCan delivery.</p>
</td>
</tr>
<tr>
<td>
<p><span>EBD3EF268C71A0ED11AE103AA745F1D8A63DDF13</span></p>
</td>
<td nowrap="nowrap">
<p>N/A</p>
</td>
<td nowrap="nowrap">
<p>Win64/NukeSped.KT</p>
</td>
<td nowrap="nowrap">
<p>The intermediate loader of LightlessCan.</p>
</td>
</tr>
</tbody>
</table>
<h3><span>Network</span></h3>
<table>
<thead>
<tr>
<td>
<p><strong>IP</strong></p>
</td>
<td>
<p><strong>Domain</strong></p>
</td>
<td>
<p><strong>Hosting provider</strong></p>
</td>
<td>
<p><strong>First seen</strong></p>
</td>
<td>
<p><strong>Details</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><span>46.105.57[.]169</span></p>
</td>
<td>
<p><span>bug.restoroad[.]com</span></p>
</td>
<td>
<p>OVH SAS</p>
</td>
<td>
<p>2021‑10‑10</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>http://bug.restoroad[.]com/admin/view_status.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>50.192.28[.]29</span></p>
</td>
<td>
<p><span>hurricanepub[.]com</span></p>
</td>
<td>
<p>Comcast Cable Communications, LLC</p>
</td>
<td>
<p>2020‑01‑06</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>https://hurricanepub[.]com/include/include.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>67.225.140[.]4</span></p>
</td>
<td>
<p><span>turnscor[.]com</span></p>
</td>
<td>
<p>Liquid Web, L.L.C</p>
</td>
<td>
<p>2020‑01‑03</p>
</td>
<td>
<p>A compromised legitimate WordPress-based site hosting the C&amp;C server:</p>
<p><span>https://turnscor[.]com/wp-includes/contacts.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>78.11.12[.]13</span></p>
</td>
<td>
<p><span>mantis.quick.net[.]pl</span></p>
</td>
<td>
<p>Netia SA</p>
</td>
<td>
<p>2021‑03‑22</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>http://mantis.quick.net[.]pl/library/securimage/index.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>89.187.86[.]214</span></p>
</td>
<td>
<p><span>www.radiographers[.]org</span></p>
</td>
<td>
<p>Coreix Ltd</p>
</td>
<td>
<p>2020‑10‑23</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>https://www.radiographers[.]org/aboutus/aboutus.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>118.98.221[.]14</span></p>
</td>
<td>
<p><span>kapata-arkeologi.kemdikbud.go[.]id</span></p>
</td>
<td>
<p>Pustekkom</p>
</td>
<td>
<p>2020‑01‑02</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>https://kapata-arkeologi.kemdikbud.go[.]id/pages/payment/payment.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>160.153.33[.]195</span></p>
</td>
<td>
<p><span>barsaji.com[.]mx</span></p>
</td>
<td>
<p>GoDaddy.com, LLC</p>
</td>
<td>
<p>2020‑03‑27</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>http://barsaji.com[.]mx/src/recaptcha/index.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>175.207.13[.]231</span></p>
</td>
<td>
<p><span>www.keewoom.co[.]kr</span></p>
</td>
<td>
<p>Korea Telecom</p>
</td>
<td>
<p>2021‑01‑17</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>http://www.keewoom.co[.]kr/prod_img/201409/prod.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>178.251.26[.]65</span></p>
</td>
<td>
<p><span>kerstpakketten.horesca-meppel[.]nl</span></p>
</td>
<td>
<p>InterRacks B.V.</p>
</td>
<td>
<p>2020‑11‑02</p>
</td>
<td>
<p>A compromised legitimate WordPress-based site hosting the C&amp;C server:</p>
<p><span>https://kerstpakketten.horesca-meppel[.]nl/wp-content/plugins/woocommerce/lib.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>185.51.65[.]233</span></p>
</td>
<td>
<p><span>kittimasszazs[.]hu</span></p>
</td>
<td>
<p>DoclerNet Operations, ORG-DHK1-RIPE</p>
</td>
<td>
<p>2020‑02‑22</p>
</td>
<td>
<p>A compromised legitimate site hosting the C&amp;C server:</p>
<p><span>https://kittimasszazs[.]hu/images/virag.php</span></p>
</td>
</tr>
<tr>
<td>
<p><span>199.188.206[.]75</span></p>
</td>
<td>
<p><span>nrfm[.]lk</span></p>
</td>
<td>
<p>Namecheap, Inc.</p>
</td>
<td>
<p>2021‑03‑13</p>
</td>
<td>
<p>A compromised legitimate WordPress-based site hosting the C&amp;C server:</p>
<p><span>https://nrfm[.]lk/wp-includes/SimplePie/content.php</span></p>
</td>
</tr>
</tbody>
</table>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/">version 13</a> of the MITRE ATT&amp;CK framework.</p>
<table>
<thead>
<tr>
<td nowrap="nowrap">
<p><strong>Tactic</strong></p>
</td>
<td nowrap="nowrap">
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Name</strong></p>
</td>
<td nowrap="nowrap">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><strong>Reconnaissance</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1593/001/"><em>T1593.001</em></a></p>
</td>
<td>
<p>Search Open Websites/Domains: Social Media</p>
</td>
<td>
<p>Lazarus attackers used LinkedIn to identify and contact specific employees of a company of interest.</p>
</td>
</tr>
<tr>
<td rowspan="5">
<p><strong>Resource Development</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1583/004/"><em>T1584.004</em></a></p>
</td>
<td>
<p>Acquire Infrastructure: Server</p>
</td>
<td>
<p>Compromised servers were used by the Lazarus HTTP(S) backdoors and the downloader for C&amp;C.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1585/001/"><em>T1585.001</em></a></p>
</td>
<td>
<p>Establish Accounts: Social Media Accounts</p>
</td>
<td>
<p>Lazarus attackers created a fake LinkedIn identity of a headhunter from Meta.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1585/003/"><em>T1585.003</em></a></p>
</td>
<td>
<p>Establish Accounts: Cloud Accounts</p>
</td>
<td>
<p>Lazarus attackers had to create an account on a third-party cloud storage in order to deliver the initial ISO images.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1587/001/"><em>T1587.001</em></a></p>
</td>
<td>
<p>Develop Capabilities: Malware</p>
</td>
<td>
<p>Custom tools from the attack are likely developed by the attackers. Some exhibit highly specific kernel development capacities seen earlier in Lazarus tools.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1608/001/"><em>T1608.001</em></a></p>
</td>
<td>
<p>Stage Capabilities: Upload Malware</p>
</td>
<td>
<p>Lazarus attackers uploaded the initial ISO images to a cloud storage.</p>
</td>
</tr>
<tr>
<td rowspan="2">
<p><strong>Initial Access</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1566/002/"><em>T1566.002</em></a></p>
</td>
<td>
<p>Phishing: Spearphishing Link</p>
</td>
<td>
<p>The target received a link to a third-party remote storage with malicious ISO images.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1566/003/"><em>T1566.003</em></a></p>
</td>
<td>
<p>Phishing: Spearphishing via Service</p>
</td>
<td>
<p>The target was contacted via LinkedIn Messaging.</p>
</td>
</tr>
<tr>
<td rowspan="5">
<p><strong>Execution</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1106/"><em>T1106</em></a></p>
</td>
<td>
<p>Native API</p>
</td>
<td>
<p>Windows APIs are essential for miniBlindingCan and LightlessCan to function and are resolved dynamically at runtime.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1053/"><em>T1053</em></a></p>
</td>
<td>
<p>Scheduled Task/Job</p>
</td>
<td>
<p>Based on the parent process, a scheduled task was probably created to trigger thesimple chain of the LightlessCan execution.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1129/"><em>T1129</em></a></p>
</td>
<td>
<p>Shared Modules</p>
</td>
<td>
<p>NickelLoader can load and execute an arbitrary DLL within memory.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1204/002/"><em>T1204.002</em></a></p>
</td>
<td>
<p>User Execution: Malicious File</p>
</td>
<td>
<p>Lazarus attackers relied on the execution of <span>Quiz1.exe</span> and <span>Quiz2.exe</span> from the ISO files.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1047/"><em>T1047</em></a></p>
</td>
<td>
<p>Windows Management Instrumentation</p>
</td>
<td>
<p>One of the LightlessCan commands allows creation of a new process via WMI.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Persistence</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1053/"><em>T1053</em></a></p>
</td>
<td>
<p>Scheduled Task/Job</p>
</td>
<td>
<p>Based on the parent process, a scheduled task was probably created to trigger the simple chain of the LightlessCan execution. Moreover, LightlessCan can mimic the <span>schtasks </span>command.</p>
</td>
</tr>
<tr>
<td rowspan="16">
<p><strong>Defense Evasion</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1134/002/"><em>T1134.002</em></a></p>
</td>
<td>
<p>Access Token Manipulation: Create Process with Token</p>
</td>
<td>
<p>LightlessCan can create a new process in the security context of the user represented by the specified token and collect the output.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1622/"><em>T1622</em></a></p>
</td>
<td>
<p>Debugger Evasion</p>
</td>
<td>
<p>There’s an anti-debug check in the dropper of miniBlindingCan.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1480/"><em>T1480</em></a></p>
</td>
<td>
<p>Execution Guardrails</p>
</td>
<td>
<p>There’s a parent process check in the miniBlindingCan dropper. The concatenation of the values is required for decryption of the encrypted LightlessCan from the file system.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1140/"><em>T1140</em></a></p>
</td>
<td>
<p>Deobfuscate/Decode Files or Information</p>
</td>
<td>
<p>Many of these Lazarus tools and configurations are encrypted on the file system, e.g., LightlessCan in <span>grpedit.dat</span> and its configuration in <span>wlansvc.cpl</span>.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1574/002/"><em>T1574.002</em></a></p>
</td>
<td>
<p>Hijack Execution Flow: DLL Side-Loading</p>
</td>
<td>
<p>Many of the Lazarus droppers and loaders use a legitimate program for their loading.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1027/002/"><em>T1027.002</em></a></p>
</td>
<td>
<p>Obfuscated Files or Information: Software Packing</p>
</td>
<td>
<p>Lazarus obfuscated several executables by VMProtect in this attack, e.g., <span>colorui.dll</span></p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1027/007/"><em>T1027.007</em></a></p>
</td>
<td>
<p>Obfuscated Files or Information: Dynamic API Resolution</p>
</td>
<td>
<p>Both LightlessCan and miniBlindingCan resolve Windows APIs dynamically.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1027/009/"><em>T1027.009</em></a></p>
</td>
<td>
<p>Obfuscated Files or Information: Embedded Payloads</p>
</td>
<td>
<p>The droppers of all malicious chains contain an embedded data array with an additional stage.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1562/003/"><em>T1562.003</em></a></p>
</td>
<td>
<p>Impair Defenses: Impair Command History Logging</p>
</td>
<td>
<p>New features of LightlessCan mimic the most useful Windows command line utilities, to avoid executing the original console utilities.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1562/004/"><em>T1562.004</em></a></p>
</td>
<td>
<p>Impair Defenses: Disable or Modify System Firewall</p>
</td>
<td>
<p>LightlessCan can mimic the <span>netsh</span> command and interact with firewall rules.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1070/004/"><em>T1070.004</em></a></p>
</td>
<td>
<p>Indicator Removal: File Deletion</p>
</td>
<td>
<p>LightlessCan has the ability to delete files securely.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1070/006/"><em>T1070.006</em></a></p>
</td>
<td>
<p>Indicator Removal: Timestomp</p>
</td>
<td>
<p>LightlessCan can alter the modification timestamps of files.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1202/"><em>T1202</em></a></p>
</td>
<td>
<p>Indirect Command Execution</p>
</td>
<td>
<p>LightlessCan bypasses command execution by implementing their functionality.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1055/"><em>T1055</em></a></p>
</td>
<td>
<p>Process Injection</p>
</td>
<td>
<p>LightlessCan and miniBlindingCan use various types of process injection.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1497/003/"><em>T1497.003</em></a></p>
</td>
<td>
<p>Virtualization/Sandbox Evasion: Time Based Evasion</p>
</td>
<td>
<p>The miniBlindingCan dropper has an intentional initial execution delay.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1620/"><em>T1620</em></a></p>
</td>
<td>
<p>Reflective Code Loading</p>
</td>
<td>
<p>Most of the droppers use reflective DLL injection.</p>
</td>
</tr>
<tr>
<td rowspan="8">
<p><strong>Discovery</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1083/"><em>T1083</em></a></p>
</td>
<td>
<p>File and Directory Discovery</p>
</td>
<td>
<p>LightlessCan can locate a file by its name.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1135/"><em>T1135</em></a></p>
</td>
<td>
<p>Network Share Discovery</p>
</td>
<td>
<p>LightlessCan can mimic the <span>net share</span> command.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1057/"><em>T1057</em></a></p>
</td>
<td>
<p>Process Discovery</p>
</td>
<td>
<p>LightlessCan identifies processes by name.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1012/"><em>T1012</em></a></p>
</td>
<td>
<p>Query Registry</p>
</td>
<td>
<p>LightlessCan queries the registry for various system information it uses for encryption.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1018/"><em>T1018</em></a></p>
</td>
<td>
<p>Remote System Discovery</p>
</td>
<td>
<p>LightlessCan can mimic the <span>net view</span> command.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1016/"><em>T1016</em></a></p>
</td>
<td>
<p>System Network Configuration Discovery</p>
</td>
<td>
<p>LightlessCan can mimic the <span>arp </span>and <span>ipconfig </span>commands.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1049/"><em>T1049</em></a></p>
</td>
<td>
<p>System Network Connections Discovery</p>
</td>
<td>
<p>LightlessCan can mimic the <span>netstat </span>command.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1007/"><em>T1007</em></a></p>
</td>
<td>
<p>System Service Discovery</p>
</td>
<td>
<p>LightlessCan can mimic the <span>sc query</span> and <span>tasklist </span>commands.</p>
</td>
</tr>
<tr>
<td rowspan="3">
<p><strong>Command and Control</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1071/001/"><em>T1071.001</em></a></p>
</td>
<td>
<p>Application Layer Protocol: Web Protocols</p>
</td>
<td>
<p>NickelLoader, LightlessCan, and miniBlindingCan use HTTP and HTTPS for C&amp;C.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1573/001/"><em>T1573.001</em></a></p>
</td>
<td>
<p>Encrypted Channel: Symmetric Cryptography</p>
</td>
<td>
<p>LightlessCan and miniBlindingCan encrypt C&amp;C traffic using the AES-128 algorithm.</p>
</td>
</tr>
<tr>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1132/001/"><em>T1132.001</em></a></p>
</td>
<td>
<p>Data Encoding: Standard Encoding</p>
</td>
<td>
<p>LightlessCan and miniBlindingCan encode C&amp;C traffic using base64.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Exfiltration</strong></p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1041/"><em>T1041</em></a></p>
</td>
<td>
<p>Exfiltration Over C2 Channel</p>
</td>
<td>
<p>LightlessCan can exfiltrate data to its C&amp;C server.</p>
</td>
</tr>
</tbody>
</table>
<h2>References</h2>
<p>[1] <span> </span>Microsoft Security Threat Intelligence, &#34;<a href="https://www.microsoft.com/en-us/security/blog/2022/09/29/zinc-weaponizing-open-source-software/" target="_blank" rel="noopener">ZINC weaponizing open-source software</a>,&#34; 29 September 2022. [Online].</p>
<p>[2] <span> </span>D. Breitenbacher and O. Kaspars, &#34;<a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_Operation_Interception.pdf" target="_blank" rel="noopener">Operation In(ter)ception: Aerospace and military companies in the crosshairs of cyberspies</a>,&#34; June 2020. [Online].</p>
<p>[3] <span> </span>HvS-Consulting AG, &#34;<a href="https://www.hvs-consulting.de/media/downloads/ThreatReport-Lazarus.pdf" target="_blank" rel="noopener">Greetings from Lazarus: Anatomy of a cyber-espionage campaign</a>,&#34; 15 December 2020. [Online].</p>
<p>[4] <span> </span>Positive Technologies Expert Security Center, &#34;<a href="https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/lazarus-recruitment/" target="_blank" rel="noopener">Lazarus Group Recruitment: Threat Hunters vs Head Hunters</a>,&#34; Positive Technologies, 27 April 2021. [Online].</p>
<p>[5] <span> </span>P. Kálnai, &#34;<a href="https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium" target="_blank" rel="noopener">Amazon-themed campaigns of Lazarus in the Netherlands</a>,&#34; 30 September 2022. [Online].</p>
<p>[6] <span> </span>P. Kálnai, &#34;Lazarus campaigns and backdoors in 2022-2023,&#34; in Virus Bulletin International Conference, London, 2023. </p>
<p>[7] <span> </span>A. Martin, &#34;<a href="https://www.welivesecurity.com/2014/12/08/sony-pictures-hacking-traced-thai-hotel-north-korea-denies-involvement/" target="_blank" rel="noopener">Sony Pictures hacking traced to Thai hotel as North Korea denies involvement</a>,&#34; WeLiveSecurity.com, 08 December 2014. [Online].</p>
<p>[8] <span> </span>P. Kálnai and M.-É. M.Leveillé, &#34;<a href="https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack/" target="_blank" rel="noopener">Linux malware strengthens links between Lazarus and the 3CX supply chain attack</a>,&#34; ESET, 20 April 2023. [Online].</p>
<p>[9] <span> </span>Defense Intelligence Agency, North Korea military power : a growing regional and global threat, Washington, D.C.: U.S. Government Publishing Office, 2021, p. 98.</p>
<p>[10] <span> </span>UN Panel of Experts, &#34;<a href="https://www.securitycouncilreport.org/un-documents/dprk-north-korea/" target="_blank" rel="noopener">UN Security Council Resolutions</a>,&#34; 1993-2023. [Online].</p>
<p>[11] <span> </span>ESET Editor, &#34;<a href="https://www.welivesecurity.com/2017/05/15/wannacryptor-key-questions-answered/" target="_blank" rel="noopener">WannaCryptor aka WannaCry: Key questions answered</a>,&#34; WeLiveSecurity.com, 15 May 2017. [Online].</p>
<p>[12] <span> </span>Security Council Committee, &#34;<a href="https://www.un.org/securitycouncil/sanctions/1718/panel_experts/reports" target="_blank" rel="noopener">Sanctions Committee (DPRK), Panel of Experts, Reports</a>,&#34; United Nations Security Council, 2010-2023. [Online].</p>
<p>[13] <span> </span>ClearSky Research Team, &#34;<a href="https://www.clearskysec.com/wp-content/uploads/2020/08/Dream-Job-Campaign.pdf" target="_blank" rel="noopener">Operation ‘Dream Job’ Widespread North Korean Espionage Campaign</a>,&#34; 13 August 2020. [Online].</p>
<p>[14] <span> </span>ESET Research, &#34;<a href="https://web-assets.esetstatic.com/wls/2022/06/eset_threat_report_t12022.pdf" target="_blank" rel="noopener">Threat Report T1 2022</a>,&#34; ESET, June 2022. [Online]. </p>
<p>[15] <span> </span>D. Staples, &#34;<a href="https://disman.tl/2015/01/30/an-improved-reflective-dll-injection-technique.html" target="_blank" rel="noopener">An Improved Reflective DLL Injection Technique</a>,&#34; 30 January 2015. [Online].</p>
<p>[16] <span> </span>J. Maclachlan, M. Potaczek, N. Isakovic, M. Williams and Y. Gupta, &#34;<a href="https://www.mandiant.com/resources/blog/dprk-whatsapp-phishing" target="_blank" rel="noopener">It&#39;s Time to PuTTY! DPRK Job Opportunity Phishing via WhatsApp</a>,&#34; Mandiant, 14 September 2022. [Online].</p>
<p>[17] <span> </span>S. Tomonaga, &#34;<a href="https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html" target="_blank" rel="noopener">Windows Commands Abused by Attackers</a>,&#34; JPCERT/CC, 26 January 2016. [Online].</p>

<p><a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=lazarus-luring-employees-trojanized-coding-challenges-case-spanish-aerospace-company" target="_blank" rel="noopener"><img src="https://web-assets.esetstatic.com/wls/2022/12/eset-threat-intelligence.png" alt="" width="915" height="296"/></a></p>
</div></div>
  </body>
</html>
