<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/information-technology/2022/05/how-hackers-used-smarts-and-a-novel-iot-botnet-to-plunder-email-for-months/">Original</a>
    <h1>Botnet that hid for 18 months</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2022/05/digital-eye-800x534.jpeg" alt="Botnet that hid for 18 months boasted some of the coolest tradecraft ever"/>
      <figcaption></figcaption>  </figure>

  




<!-- cache hit 331:single/related:9970a499b421da880c672326799c1f59 --><!-- empty -->
<p>It’s not the kind of security discovery that happens often. A previously unknown hacker group used a novel backdoor, top-notch tradecraft, and software engineering to create an espionage botnet that was largely invisible in many victim networks.</p>
<p>The group, which security firm Mandiant is calling UNC3524, has spent the past 18 months burrowing into victims’ networks with unusual stealth. In cases where the group is ejected, it wastes no time reinfecting the victim environment and picking up where things left off. There are many keys to its stealth, including:</p>
<ul>
<li>The use of a unique backdoor Mandiant calls Quietexit, which runs on load balancers, wireless access point controllers, and other types of IoT devices that don’t support antivirus or endpoint detection. This makes detection through traditional means difficult.</li>
<li>Customized versions of the backdoor that use file names and creation dates that are similar to legitimate files used on a specific infected device.</li>
<li>A live-off-the-land approach that favors common Windows programming interfaces and tools over custom code with the goal of leaving as light a footprint as possible.</li>
<li>An unusual way a second-stage backdoor connects to attacker-controlled infrastructure by, in essence, acting as a TLS-encrypted server that proxies data through the <a href="https://en.wikipedia.org/wiki/SOCKS">SOCKS protocol.</a></li>
</ul>
<h2>A tunneling fetish with SOCKS</h2>
<p>In a <a href="https://www.mandiant.com/resources/unc3524-eye-spy-email">post</a>, Mandiant researchers Doug Bienstock, Melissa Derr, Josh Madeley, Tyler McLellan, and Chris Gardner wrote:</p>
<blockquote><p>Throughout their operations, the threat actor demonstrated sophisticated operational security that we see only a small number of threat actors demonstrate. The threat actor evaded detection by operating from devices in the victim environment’s blind spots, including servers running uncommon versions of Linux and network appliances running opaque OSes. These devices and appliances were running versions of operating systems that were unsupported by agent-based security tools, and often had an expected level of network traffic that allowed the attackers to blend in. The threat actor’s use of the QUIETEXIT tunneler allowed them to largely live off the land, without the need to bring in additional tools, further reducing the opportunity for detection. This allowed UNC3524 to remain undetected in victim environments for, in some cases, upwards of 18 months.</p></blockquote>
<p>The SOCKS tunnel allowed the hackers to effectively connect their control servers to a victim’s network where they could then execute tools without leaving traces on any of the victims&#39; computers.</p>                                            
                                                        
<figure><a href="https://cdn.arstechnica.net/wp-content/uploads/2022/05/quietexit-tunneling.png" data-height="976" data-width="1754"><img src="https://cdn.arstechnica.net/wp-content/uploads/2022/05/quietexit-tunneling-640x356.png" width="640" height="356" srcset="https://cdn.arstechnica.net/wp-content/uploads/2022/05/quietexit-tunneling-1280x712.png 2x"/></a><figcaption><p>Mandiant</p></figcaption></figure>
<p>A secondary backdoor provided an alternate means of access to infected networks. It was based on a version of the legitimate <a href="https://github.com/sensepost/reGeorg">reGeorg</a> webshell that had been heavily obfuscated to make detection harder. The threat actor used it in the event the primary backdoor stopped working. The researchers explained:</p>
<blockquote><p>Once inside the victim environment, the threat actor spent time to identify web servers in the victim environment and ensure they found one that was Internet accessible before copying REGEORG to it. They also took care to name the file so that it blended in with the application running on the compromised server. Mandiant also observed instances where UNC3452 used timestomping [referring to a tool available <a href="https://duckduckgo.com/?q=timestomping+what+is&amp;atb=v314-1&amp;ia=web">here</a> for deleting or modifying timestamp-related information on files] to alter the Standard Information timestamps of the REGEORG web shell to match other files in the same directory.</p></blockquote>
<p>One of the ways the hackers maintain a low profile is by favoring standard Windows protocols over malware to move laterally. To move to systems of interest, UNC3524 used a customized version of <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py">WMIEXEC</a>, a tool that uses Windows Management Instrumentation to establish a shell on the remote system.</p>
<p>Eventually, Quietexit executes its final objective: accessing email accounts of executives and IT personnel in hopes of obtaining documents related to things like corporate development, mergers and acquisitions, and large financial transactions.</p>
<p>“Once UNC3524 successfully obtained privileged credentials to the victim’s mail environment, they began making Exchange Web Services (EWS) API requests to either the on-premises Microsoft Exchange or Microsoft 365 Exchange Online environment,” the Mandiant researchers wrote. “In each of the UNC3524 victim environments, the threat actor would target a subset of mailboxes….”</p>

                                                </div></div>
  </body>
</html>
