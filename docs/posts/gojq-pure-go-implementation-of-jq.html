<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/itchyny/gojq">Original</a>
    <h1>Gojq: Pure Go Implementation of Jq</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://github.com/itchyny/gojq/actions"><img src="https://github.com/itchyny/gojq/workflows/CI/badge.svg" alt="CI Status"/></a>
<a href="https://goreportcard.com/report/github.com/itchyny/gojq" rel="nofollow"><img src="https://camo.githubusercontent.com/1eacc2b75f342af67f4876707a6563d7839e05f547fbb0cb518595b2241c498f/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f69746368796e792f676f6a71" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/itchyny/gojq"/></a>
<a href="https://github.com/itchyny/gojq/blob/main/LICENSE"><img src="https://camo.githubusercontent.com/83d3746e5881c1867665223424263d8e604df233d0a11aae0813e0414d433943/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e737667" alt="MIT License" data-canonical-src="https://img.shields.io/badge/license-MIT-blue.svg"/></a>
<a href="https://github.com/itchyny/gojq/releases"><img src="https://camo.githubusercontent.com/bca0c3989dd757362e3a3fd5b0ff972ad3545e66218ebebb4d9aecb9d307a079/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f69746368796e792f676f6a712f616c6c2e737667" alt="release" data-canonical-src="https://img.shields.io/github/release/itchyny/gojq/all.svg"/></a>
<a href="https://pkg.go.dev/github.com/itchyny/gojq" rel="nofollow"><img src="https://camo.githubusercontent.com/745c436ac354a4be20943c040a0c67d12f7f140257b12115416a2f4f1f829b57/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f69746368796e792f676f6a71" alt="pkg.go.dev" data-canonical-src="https://pkg.go.dev/badge/github.com/itchyny/gojq"/></a></p>
<h3 dir="auto"><a id="user-content-pure-go-implementation-of-jq" aria-hidden="true" href="#pure-go-implementation-of-jq"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Pure Go implementation of <a href="https://github.com/stedolan/jq">jq</a></h3>
<p dir="auto">This is an implementation of jq command written in Go language.
You can also embed gojq as a library to your Go products.</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<div data-snippet-clipboard-copy-content=" $ echo &#39;{&#34;foo&#34;: 128}&#39; | gojq &#39;.foo&#39;
128
 $ echo &#39;{&#34;a&#34;: {&#34;b&#34;: 42}}&#39; | gojq &#39;.a.b&#39;
42
 $ echo &#39;{&#34;id&#34;: &#34;sample&#34;, &#34;10&#34;: {&#34;b&#34;: 42}}&#39; | gojq &#39;{(.id): .[&#34;10&#34;].b}&#39;
{
  &#34;sample&#34;: 42
}
 $ echo &#39;[{&#34;id&#34;:1},{&#34;id&#34;:2},{&#34;id&#34;:3}]&#39; | gojq &#39;.[] | .id&#39;
1
2
3
 $ echo &#39;{&#34;a&#34;:1,&#34;b&#34;:2}&#39; | gojq &#39;.a += 1 | .b *= 2&#39;
{
  &#34;a&#34;: 2,
  &#34;b&#34;: 4
}
 $ echo &#39;{&#34;a&#34;:1} [2] 3&#39; | gojq &#39;. as {$a} ?// [$a] ?// $a | $a&#39;
1
2
3
 $ echo &#39;{&#34;foo&#34;: 4722366482869645213696}&#39; | gojq .foo
4722366482869645213696  # keeps the precision of large numbers
 $ gojq -n &#39;def fact($n): if $n &lt; 1 then 1 else $n * fact($n - 1) end; fact(50)&#39;
30414093201713378043612608166064768844377641568960512000000000000 # arbitrary-precision integer calculation"><pre> $ <span>echo</span> <span><span>&#39;</span>{&#34;foo&#34;: 128}<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.foo<span>&#39;</span></span>
128
 $ <span>echo</span> <span><span>&#39;</span>{&#34;a&#34;: {&#34;b&#34;: 42}}<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.a.b<span>&#39;</span></span>
42
 $ <span>echo</span> <span><span>&#39;</span>{&#34;id&#34;: &#34;sample&#34;, &#34;10&#34;: {&#34;b&#34;: 42}}<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>{(.id): .[&#34;10&#34;].b}<span>&#39;</span></span>
{
  <span><span>&#34;</span>sample<span>&#34;</span></span>: 42
}
 $ <span>echo</span> <span><span>&#39;</span>[{&#34;id&#34;:1},{&#34;id&#34;:2},{&#34;id&#34;:3}]<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.[] | .id<span>&#39;</span></span>
1
2
3
 $ <span>echo</span> <span><span>&#39;</span>{&#34;a&#34;:1,&#34;b&#34;:2}<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.a += 1 | .b *= 2<span>&#39;</span></span>
{
  <span><span>&#34;</span>a<span>&#34;</span></span>: 2,
  <span><span>&#34;</span>b<span>&#34;</span></span>: 4
}
 $ <span>echo</span> <span><span>&#39;</span>{&#34;a&#34;:1} [2] 3<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>. as {$a} ?// [$a] ?// $a | $a<span>&#39;</span></span>
1
2
3
 $ <span>echo</span> <span><span>&#39;</span>{&#34;foo&#34;: 4722366482869645213696}<span>&#39;</span></span> <span>|</span> gojq .foo
4722366482869645213696  <span><span>#</span> keeps the precision of large numbers</span>
 $ gojq -n <span><span>&#39;</span>def fact($n): if $n &lt; 1 then 1 else $n * fact($n - 1) end; fact(50)<span>&#39;</span></span>
30414093201713378043612608166064768844377641568960512000000000000 <span><span>#</span> arbitrary-precision integer calculation</span></pre></div>
<p dir="auto">Nice error messages.</p>
<div data-snippet-clipboard-copy-content=" $ echo &#39;[1,2,3]&#39; | gojq &#39;.foo &amp; .bar&#39;
gojq: invalid query: .foo &amp; .bar
    .foo &amp; .bar
         ^  unexpected token &#34;&amp;&#34;
 $ echo &#39;{&#34;foo&#34;: { bar: [] } }&#39; | gojq &#39;.&#39;
gojq: invalid json: &lt;stdin&gt;
    {&#34;foo&#34;: { bar: [] } }
              ^  invalid character &#39;b&#39; looking for beginning of object key string"><pre> $ <span>echo</span> <span><span>&#39;</span>[1,2,3]<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.foo &amp; .bar<span>&#39;</span></span>
gojq: invalid query: .foo <span>&amp;</span> .bar
    .foo <span>&amp;</span> .bar
         ^  unexpected token <span><span>&#34;</span>&amp;<span>&#34;</span></span>
 $ <span>echo</span> <span><span>&#39;</span>{&#34;foo&#34;: { bar: [] } }<span>&#39;</span></span> <span>|</span> gojq <span><span>&#39;</span>.<span>&#39;</span></span>
gojq: invalid json: <span>&lt;</span>stdin<span>&gt;</span>
    {<span><span>&#34;</span>foo<span>&#34;</span></span>: { bar: [] } }
              ^  invalid character <span><span>&#39;</span>b<span>&#39;</span></span> looking <span>for</span> beginning of object key string</pre></div>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<h3 dir="auto"><a id="user-content-homebrew" aria-hidden="true" href="#homebrew"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Homebrew</h3>

<h3 dir="auto"><a id="user-content-zero-install" aria-hidden="true" href="#zero-install"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Zero Install</h3>
<div data-snippet-clipboard-copy-content="0install add gojq https://apps.0install.net/utils/gojq.xml"><pre>0install add gojq https://apps.0install.net/utils/gojq.xml</pre></div>
<h3 dir="auto"><a id="user-content-build-from-source" aria-hidden="true" href="#build-from-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Build from source</h3>
<div data-snippet-clipboard-copy-content="go install github.com/itchyny/gojq/cmd/gojq@latest"><pre>go install github.com/itchyny/gojq/cmd/gojq@latest</pre></div>
<h3 dir="auto"><a id="user-content-docker" aria-hidden="true" href="#docker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Docker</h3>
<div data-snippet-clipboard-copy-content="docker run -i --rm itchyny/gojq
docker run -i --rm ghcr.io/itchyny/gojq"><pre>docker run -i --rm itchyny/gojq
docker run -i --rm ghcr.io/itchyny/gojq</pre></div>
<h2 dir="auto"><a id="user-content-difference-to-jq" aria-hidden="true" href="#difference-to-jq"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Difference to jq</h2>
<ul dir="auto">
<li>gojq is purely implemented with Go language and is completely portable. jq depends on the C standard library so the availability of math functions depends on the library. jq also depends on the regular expression library and it makes build scripts complex.</li>
<li>gojq implements nice error messages for invalid query and JSON input. The error message of jq is sometimes difficult to tell where to fix the query.</li>
<li>gojq does not keep the order of object keys. I understand this might cause problems for some scripts but basically, we should not rely on the order of object keys. Due to this limitation, gojq does not have <code>keys_unsorted</code> function and <code>--sort-keys</code> (<code>-S</code>) option. I would implement when ordered map is implemented in the standard library of Go but I&#39;m less motivated.</li>
<li>gojq supports arbitrary-precision integer calculation while jq does not; jq loses the precision of large integers when calculation is involved. Note that even with gojq, all mathematical functions, including <code>floor</code> and <code>round</code>, convert integers to floating-point numbers; only addition, subtraction, multiplication, modulo, and division operators (when divisible) keep the integer precision. To calculate floor division of integers without losing the precision, use <code>def idivide($n): (. - . % $n) / $n;</code>. To round down floating-point numbers to integers, use <code>def ifloor: floor | tostring | tonumber;</code>, but note that this function does not work with large floating-point numbers and also loses the precision of large integers.</li>
<li>gojq fixes various bugs of jq. gojq correctly deletes elements of arrays by <code>|= empty</code> (<a href="https://github.com/stedolan/jq/issues/2051" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2051/hovercard">jq#2051</a>). gojq fixes <code>try</code>/<code>catch</code> handling (<a href="https://github.com/stedolan/jq/issues/1859" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1859/hovercard">jq#1859</a>, <a href="https://github.com/stedolan/jq/issues/1885" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1885/hovercard">jq#1885</a>, <a href="https://github.com/stedolan/jq/issues/2140" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2140/hovercard">jq#2140</a>). gojq fixes <code>nth/2</code> to output nothing when the count is equal to or larger than the stream size (<a href="https://github.com/stedolan/jq/issues/1867" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1867/hovercard">jq#1867</a>). gojq consistently counts by characters (not by bytes) in <code>index</code>, <code>rindex</code>, and <code>indices</code> functions; <code>&#34;１２３４５&#34; | .[index(&#34;３&#34;):]</code> results in <code>&#34;３４５&#34;</code> (<a href="https://github.com/stedolan/jq/issues/1430" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1430/hovercard">jq#1430</a>, <a href="https://github.com/stedolan/jq/issues/1624" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1624/hovercard">jq#1624</a>). gojq handles overlapping occurrence differently in <code>rindex</code> and <code>indices</code>; <code>&#34;ababa&#34; | [rindex(&#34;aba&#34;), indices(&#34;aba&#34;)]</code> results in <code>[2,[0,2]]</code> (<a href="https://github.com/stedolan/jq/issues/2433" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2433/hovercard">jq#2433</a>). gojq supports string indexing; <code>&#34;abcde&#34;[2]</code> (<a href="https://github.com/stedolan/jq/issues/1520" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1520/hovercard">jq#1520</a>). gojq accepts indexing query <code>.e0</code> (<a href="https://github.com/stedolan/jq/issues/1526" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1526/hovercard">jq#1526</a>, <a href="https://github.com/stedolan/jq/issues/1651" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1651/hovercard">jq#1651</a>), and allows <code>gsub</code> to handle patterns including <code>&#34;^&#34;</code> (<a href="https://github.com/stedolan/jq/issues/2148" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2148/hovercard">jq#2148</a>). gojq improves variable lexer to allow using keywords for variable names, especially in binding patterns, also disallows spaces after <code>$</code> (<a href="https://github.com/stedolan/jq/issues/526" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/526/hovercard">jq#526</a>). gojq fixes handling files with no newline characters at the end (<a href="https://github.com/stedolan/jq/issues/2374" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2374/hovercard">jq#2374</a>).</li>
<li>gojq implements <code>@uri</code> to escape all the reserved characters defined in RFC 3986, Sec. 2.2 (<a href="https://github.com/stedolan/jq/issues/1506" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1506/hovercard">jq#1506</a>), and fixes <code>@base64d</code> to allow binary string as the decoded string (<a href="https://github.com/stedolan/jq/issues/1931" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1931/hovercard">jq#1931</a>). gojq improves time formatting and parsing; deals with <code>%f</code> in <code>strftime</code> and <code>strptime</code> (<a href="https://github.com/stedolan/jq/issues/1409" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1409/hovercard">jq#1409</a>), parses timezone offsets with <code>fromdate</code> and <code>fromdateiso8601</code> (<a href="https://github.com/stedolan/jq/issues/1053" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1053/hovercard">jq#1053</a>), supports timezone name/offset with <code>%Z</code>/<code>%z</code> in <code>strptime</code> (<a href="https://github.com/stedolan/jq/issues/929" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/929/hovercard">jq#929</a>, <a href="https://github.com/stedolan/jq/issues/2195" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/2195/hovercard">jq#2195</a>), and looks up correct timezone during daylight saving time on formatting with <code>%Z</code> (<a href="https://github.com/stedolan/jq/issues/1912" data-hovercard-type="issue" data-hovercard-url="/stedolan/jq/issues/1912/hovercard">jq#1912</a>). gojq supports nanoseconds in date and time functions.</li>
<li>gojq does not support some functions intentionally; <code>get_jq_origin</code>, <code>get_prog_origin</code>, <code>get_search_list</code> (unstable, not listed in jq document), <code>input_line_number</code>, <code>$__loc__</code> (performance issue), <code>recurse_down</code> (deprecated in jq). gojq does not support some flags; <code>--ascii-output, -a</code> (performance issue), <code>--seq</code> (not used commonly), <code>--sort-keys, -S</code> (sorts by default because <code>map[string]interface{}</code> does not keep the order), <code>--unbuffered</code> (unbuffered by default). gojq does not parse JSON extensions supported by jq; <code>NaN</code>, <code>Infinity</code>, and <code>[000]</code>. gojq normalizes floating-point numbers to fit to double-precision floating-point numbers. gojq does not support some regular expression flags (regular expression engine differences). gojq does not support BOM (<code>encoding/json</code> does not support this). gojq disallows using keywords for function names (declaration of <code>def true: .;</code> is a confusing query).</li>
<li>gojq supports reading from YAML input (<code>--yaml-input</code>) while jq does not. gojq also supports YAML output (<code>--yaml-output</code>).</li>
</ul>
<h3 dir="auto"><a id="user-content-color-configuration" aria-hidden="true" href="#color-configuration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Color configuration</h3>
<p dir="auto">The gojq command automatically disables coloring output when the output is not a tty.
To force coloring output, specify <code>--color-output</code> (<code>-C</code>) option.
When <a href="https://no-color.org/" rel="nofollow"><code>NO_COLOR</code> environment variable</a> is present or <code>--monochrome-output</code> (<code>-M</code>) option is specified, gojq disables coloring output.</p>
<p dir="auto">Use <code>GOJQ_COLORS</code> environment variable to configure individual colors.
The variable is a colon-separated list of ANSI escape sequences of <code>null</code>, <code>false</code>, <code>true</code>, numbers, strings, object keys, arrays, and objects.
The default configuration is <code>90:33:33:36:32:34;1</code>.</p>
<h2 dir="auto"><a id="user-content-usage-as-a-library" aria-hidden="true" href="#usage-as-a-library"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage as a library</h2>
<p dir="auto">You can use the gojq parser and interpreter from your Go products.</p>
<div data-snippet-clipboard-copy-content="package main

import (
	&#34;fmt&#34;
	&#34;log&#34;

	&#34;github.com/itchyny/gojq&#34;
)

func main() {
	query, err := gojq.Parse(&#34;.foo | ..&#34;)
	if err != nil {
		log.Fatalln(err)
	}
	input := map[string]interface{}{&#34;foo&#34;: []interface{}{1, 2, 3}}
	iter := query.Run(input) // or query.RunWithContext
	for {
		v, ok := iter.Next()
		if !ok {
			break
		}
		if err, ok := v.(error); ok {
			log.Fatalln(err)
		}
		fmt.Printf(&#34;%#v\n&#34;, v)
	}
}"><pre><span>package</span> main

<span>import</span> (
	<span>&#34;fmt&#34;</span>
	<span>&#34;log&#34;</span>

	<span>&#34;github.com/itchyny/gojq&#34;</span>
)

<span>func</span> <span>main</span>() {
	<span>query</span>, <span>err</span> <span>:=</span> <span>gojq</span>.<span>Parse</span>(<span>&#34;.foo | ..&#34;</span>)
	<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
		<span>log</span>.<span>Fatalln</span>(<span>err</span>)
	}
	<span>input</span> <span>:=</span> <span>map</span>[<span>string</span>]<span>interface</span>{}{<span>&#34;foo&#34;</span>: []<span>interface</span>{}{<span>1</span>, <span>2</span>, <span>3</span>}}
	<span>iter</span> <span>:=</span> <span>query</span>.<span>Run</span>(<span>input</span>) <span>// or query.RunWithContext</span>
	<span>for</span> {
		<span>v</span>, <span>ok</span> <span>:=</span> <span>iter</span>.<span>Next</span>()
		<span>if</span> <span>!</span><span>ok</span> {
			<span>break</span>
		}
		<span>if</span> <span>err</span>, <span>ok</span> <span>:=</span> <span>v</span>.(<span>error</span>); <span>ok</span> {
			<span>log</span>.<span>Fatalln</span>(<span>err</span>)
		}
		<span>fmt</span>.<span>Printf</span>(<span>&#34;%#v<span>\n</span>&#34;</span>, <span>v</span>)
	}
}</pre></div>
<ul dir="auto">
<li>Firstly, use <a href="https://pkg.go.dev/github.com/itchyny/gojq#Parse" rel="nofollow"><code>gojq.Parse(string) (*Query, error)</code></a> to get the query from a string.</li>
<li>Secondly, get the result iterator
<ul dir="auto">
<li>using <a href="https://pkg.go.dev/github.com/itchyny/gojq#Query.Run" rel="nofollow"><code>query.Run</code></a> or <a href="https://pkg.go.dev/github.com/itchyny/gojq#Query.RunWithContext" rel="nofollow"><code>query.RunWithContext</code></a></li>
<li>or alternatively, compile the query using <a href="https://pkg.go.dev/github.com/itchyny/gojq#Compile" rel="nofollow"><code>gojq.Compile</code></a> and then <a href="https://pkg.go.dev/github.com/itchyny/gojq#Code.Run" rel="nofollow"><code>code.Run</code></a> or <a href="https://pkg.go.dev/github.com/itchyny/gojq#Code.RunWithContext" rel="nofollow"><code>code.RunWithContext</code></a>. You can reuse the <code>*Code</code> against multiple inputs to avoid compilation of the same query.</li>
<li>In either case, you cannot use custom type values as the query input. The type should be <code>[]interface{}</code> for an array and <code>map[string]interface{}</code> for a map (just like decoded to an <code>interface{}</code> using the <a href="https://golang.org/pkg/encoding/json/" rel="nofollow">encoding/json</a> package). You can&#39;t use <code>[]int</code> or <code>map[string]string</code>, for example. If you want to query your custom struct, marshal to JSON, unmarshal to <code>interface{}</code> and use it as the query input.</li>
</ul>
</li>
<li>Thirdly, iterate through the results using <a href="https://pkg.go.dev/github.com/itchyny/gojq#Iter" rel="nofollow"><code>iter.Next() (interface{}, bool)</code></a>. The iterator can emit an error so make sure to handle it. The method returns <code>true</code> with results, and <code>false</code> when the iterator terminates.
<ul dir="auto">
<li>The return type is not <code>(interface{}, error)</code> because iterators can emit multiple errors and you can continue after an error. It is difficult for the iterator to tell the termination in this situation.</li>
<li>Note that the result iterator may emit infinite number of values; <code>repeat(0)</code> and <code>range(infinite)</code>. It may stuck with no output value; <code>def f: f; f</code>. Use <code>RunWithContext</code> when you want to limit the execution time.</li>
</ul>
</li>
</ul>
<p dir="auto"><a href="https://pkg.go.dev/github.com/itchyny/gojq#Compile" rel="nofollow"><code>gojq.Compile</code></a> allows to configure the following compiler options.</p>
<ul dir="auto">
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithModuleLoader" rel="nofollow"><code>gojq.WithModuleLoader</code></a> allows to load modules. By default, the module feature is disabled. If you want to load modules from the file system, use <a href="https://pkg.go.dev/github.com/itchyny/gojq#NewModuleLoader" rel="nofollow"><code>gojq.NewModuleLoader</code></a>.</li>
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithEnvironLoader" rel="nofollow"><code>gojq.WithEnvironLoader</code></a> allows to configure the environment variables referenced by <code>env</code> and <code>$ENV</code>. By default, OS environment variables are not accessible due to security reasons. You can use <code>gojq.WithEnvironLoader(os.Environ)</code> if you want.</li>
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithVariables" rel="nofollow"><code>gojq.WithVariables</code></a> allows to configure the variables which can be used in the query. Pass the values of the variables to <a href="https://pkg.go.dev/github.com/itchyny/gojq#Code.Run" rel="nofollow"><code>code.Run</code></a> in the same order.</li>
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithFunction" rel="nofollow"><code>gojq.WithFunction</code></a> allows to add a custom internal function. An internal function can return a single value (which can be an error) each invocation. To add a jq function (which may include a comma operator to emit multiple values, <code>empty</code> function, accept a filter for its argument, or call another built-in function), use <code>LoadInitModules</code> of the module loader.</li>
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithIterFunction" rel="nofollow"><code>gojq.WithIterFunction</code></a> allows to add a custom iterator function. An iterator function returns an iterator to emit multiple values. You cannot define both iterator and non-iterator functions of the same name (with possibly different arities). You can use <a href="https://pkg.go.dev/github.com/itchyny/gojq#NewIter" rel="nofollow"><code>gojq.NewIter</code></a> to convert values or an error to a <a href="https://pkg.go.dev/github.com/itchyny/gojq#Iter" rel="nofollow"><code>gojq.Iter</code></a>.</li>
<li><a href="https://pkg.go.dev/github.com/itchyny/gojq#WithInputIter" rel="nofollow"><code>gojq.WithInputIter</code></a> allows to use <code>input</code> and <code>inputs</code> functions. By default, these functions are disabled.</li>
</ul>
<h2 dir="auto"><a id="user-content-bug-tracker" aria-hidden="true" href="#bug-tracker"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Bug Tracker</h2>
<p dir="auto">Report bug at <a href="https://github.com/itchyny/gojq/issues">Issues・itchyny/gojq - GitHub</a>.</p>
<h2 dir="auto"><a id="user-content-author" aria-hidden="true" href="#author"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Author</h2>
<p dir="auto">itchyny (<a href="https://github.com/itchyny">https://github.com/itchyny</a>)</p>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">This software is released under the MIT License, see LICENSE.</p>
</article>
          </div></div>
  </body>
</html>
