<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.yossarian.net/2022/12/28/ReDoS-vulnerabilities-and-misaligned-incentives">Original</a>
    <h1>ReDoS “vulnerabilities” and misaligned incentives</h1>
    
    <div id="readability-page-1" class="page">


<h2><em>Programming, philosophy, pedaling.</em></h2>

<ul>
    <li><a href="https://blog.yossarian.net/">Home</a></li>
    <li><a href="https://blog.yossarian.net/tags">Tags</a></li>
    <li><a href="https://blog.yossarian.net/series">Series</a></li>
    <li><a href="https://blog.yossarian.net/favorites">Favorites</a></li>
    <li><a href="https://blog.yossarian.net/archive">Archive</a></li>
    
      <li><a href="https://yossarian.net">Main Site</a></li>
    
</ul>

<hr/>



<h2>
  <p>
    <span><em>Dec 28, 2022</em></span>

       

    
      <span>
        Tags:
        
        
          <a href="https://blog.yossarian.net/tags#oss">oss</a>,
        
          <a href="https://blog.yossarian.net/tags#rant">rant</a>,
        
          <a href="https://blog.yossarian.net/tags#security">security</a>
        
      </span>
    

       

    
  </p>
</h2>

<hr/>

<p>Caveat: These are my personal opinions, not the opinions of my employer or
any open source projects I work on or with.</p>

<hr/>

<p>I wrote this post back in October, but shelved it for being too circuitous
and spending too much time on background (like explaining <em>what</em> ReDoS is).
This is my attempt to cut it down to just the pithy (read: ranty) bits, spurred on by
the <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-40898">continued</a>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-40897">appearance</a> of
<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42969">mostly useless</a>
ReDoS CVEs.</p>

<p><strong>TL;DR</strong>: <a href="https://en.wikipedia.org/wiki/ReDoS">ReDoS</a> “vulnerabilities” are,
overwhelmingly, indistinguishable from <strong>malicious noise</strong>:</p>

<ol>
  <li>They exist primarily because of <strong>misaligned incentives</strong> in the
security reporting and vulnerability reporting ecosystems (and industries);</li>
  <li>The risk they pose is <strong>extremely context sensitive</strong> and does not align
with their <strong>ridiculous “severity” scores</strong>;</li>
  <li>They <strong>produce security fatigue</strong> in the very engineers they’re meant to help,
and effectively represent their own denial of service against timely
resolution of <strong>actual vulnerabilities</strong>.</li>
</ol>

<hr/>

<h2 id="misaligned-incentives">Misaligned incentives</h2>

<p><img src="https://blog.yossarian.net/assets/vulnerability-reporting.jpg" alt="The &#34;this baby&#34; car salesman meme, except it says &#34;this baby can fit so many misaligned incentives in it&#34;"/></p>

<p>The proliferation of ReDoS vulnerabilities is the product of <strong>badly
misaligned incentives</strong> in separate but related domains: <em>vulnerability
feeds</em> and <em>supply chain security vendors</em>.</p>

<h3 id="vulnerability-feeds-everyone-wants-to-be-famous">Vulnerability feeds: everyone wants to be famous</h3>

<p>Vulnerability feeds are not even remotely new: NIST’s CVE feed is (more than)
old enough to drink, and had been a core part of automating reporting
and triage since its inception.</p>

<p>Having your vulnerability appear in a vulnerability feed has historically
services has both <strong>practical</strong> and <strong>political</strong> benefits:</p>

<ol>
  <li>
    <p><strong>Practical</strong>: being assigned a vulnerability ID means that your
vulnerability appears automatically in all sorts of reporting and
remediation systems, reducing the amount of manual effort needed to
spread awareness of the underlying problem.</p>
  </li>
  <li>
    <p><strong>Political</strong>: vulnerability feeds are public, and thus can be used to
apply <em>public pressure</em> towards getting a vulnerability fixed or, at the
least, acknowledged by the responsible vendor. Someone with a vulnerability
ID can (in principle) walk into their executive’s office and offer
<strong>proof</strong> that the public knows about an embarrassing weakness, and that
it’s therefore in the company’s interest to address it as soon as possible.</p>
  </li>
</ol>

<p>As a consequence of those benefits, there’s a natural third use that
arises for vulnerability feeds: <strong>clout</strong>. Security researchers <em>love</em>
being assigned CVEs for their work<sup id="fnref:public" role="doc-noteref"><a href="#fn:public" rel="footnote">1</a></sup>; they put it on their resumes and in
their talk slides as evidence of their prowess and domain knowledge.</p>

<p>There’s nothing <em>necessarily</em> wrong with this: it’s essentially a seal of
quality! But it does introduce a <strong>perverse incentive</strong>: when public
acknowledgement of a report is <em>itself</em> seen as a sign of quality, <em>any</em>
report will do. This in turn means a search for easy things to report, and
it doesn’t get much easier than ReDoS<sup id="fnref:sarcasm" role="doc-noteref"><a href="#fn:sarcasm" rel="footnote">2</a></sup>.</p>

<h3 id="supply-chain-security-vendors-worse-is-worse">Supply chain security vendors: worse is worse</h3>

<p>“Software supply chain security” is really hot right now: there are dozens of
startups<sup id="fnref:biz" role="doc-noteref"><a href="#fn:biz" rel="footnote">3</a></sup> vying for attention (and public/private money) in the domain.</p>

<p>Most are selling small variations on the same underlying product<sup id="fnref:saas" role="doc-noteref"><a href="#fn:saas" rel="footnote">4</a></sup>:
a tool or other integration that <em>scans software dependencies and reasons
about them</em>, usually to the end of producing an
<a href="https://www.cisa.gov/sbom">SBOM</a> or other machine-readable report for
subsequent analysis and remediation<sup id="fnref:remediation" role="doc-noteref"><a href="#fn:remediation" rel="footnote">5</a></sup>.</p>

<p>Consequently, the need for <em>differentiation</em> is high: these companies
<strong>need</strong> to set themselves apart from their cohort, in an ecosystem that’s
otherwise difficult to differentiate in. Thus our second misaligned incentive:
discovering <em>volumes</em> of low-quality “vulnerabilities” and churning out
breathless blogspam for each.</p>

<p>This misaligned incentive predates on other misalignments:</p>

<ul>
  <li>
    <p>Technology (and especially security) journalism that optimizes for
eye-poppers (Massive typo-squatting attack on <code>$INDEX</code>! <code>$STARTUP</code> finds over
70 critical<sup id="fnref:critical" role="doc-noteref"><a href="#fn:critical" rel="footnote">6</a></sup> vulnerabilities in open source projects!) over impact
analysis (How many squatted package copies were <em>actually</em> downloaded? Why
aren’t these “critical” vulnerabilities being exploited if they’re critical?).</p>
  </li>
  <li>
    <p>Asymmetric maintenance and response burden: it’s easy to submit a ReDoS
vulnerability report to an open source project. Remediation is another matter:
even simple patches (which, blessedly, ReDoS remediations tend to have)
require serious maintainer attention in ecosystems where even tiny changes
can produce breakages for millions of downstream users.</p>

    <p>In other words: blasting open source projects with low effort ReDoS
“vulnerabilities” requires maintainers to make significant time commitments,
commitments that would otherwise be allocated towards feature development,
stability, <em>other security tasks</em>, or just about anything else ordinarily
needed to keep a project running and useful. It’s a demand for <em>another</em>
slice of maintainers’ time and resources, one that’s difficult to decline
lest they be tarnished as “not taking security seriously.”<sup id="fnref:seriously" role="doc-noteref"><a href="#fn:seriously" rel="footnote">7</a></sup></p>

    <p>I’ll sum this point up with a thought experiment: let’s say someone submits
a patch for a “high” severity ReDoS in a popular tool and, in the process,
accidentally introduces a bug that causes failures on millions of machines
until a fixed patch can be rolled out. Which was worse: the ReDoS or the
<em>actual</em> DoS?</p>
  </li>
</ul>

<p>So far, this has culminated in a culture of “worse is worse”<sup id="fnref:worse" role="doc-noteref"><a href="#fn:worse" rel="footnote">8</a></sup> among
software supply chain vendors<sup id="fnref:generalizing" role="doc-noteref"><a href="#fn:generalizing" rel="footnote">9</a></sup>: vendors have been incentivized
to “shoot first and ask questions later,” with no regards for report quality
or increased burden on open source maintainers<sup id="fnref:burden" role="doc-noteref"><a href="#fn:burden" rel="footnote">10</a></sup>. This is not
sustainable in the long term!</p>

<h2 id="999-of-developers-rightfully-do-not-care-about-redos">99.9% of developers (rightfully) do not care about ReDoS</h2>

<p>I’ll just be blunt about it: 99.9% of developers do not care about ReDoS
“vulnerabilities,” and <strong>they’re right not to care</strong>. That includes in web
development, one of the supposed key targets for ReDoS (and thus audiences
for remediation).</p>

<p>I will not make the claim that every single ReDoS “vulnerability” is pure
junk<sup id="fnref:junk" role="doc-noteref"><a href="#fn:junk" rel="footnote">11</a></sup>. Instead, I’ll say that <em>every single</em> ReDoS “vulnerability” that
<em>I’ve</em> ever seen has been pure junk, and has fallen into one of two categories:</p>

<ol>
  <li>
    <p><strong>“Completely irrelevant”</strong>: domains like developer tooling, command line
tools for data processing, &amp;c: here, a ReDoS “attack” manifests
as a hung command-line program. The user interrupts it, debugs it, and
goes on with their life. <strong>At no point is any security property of the
system violated.</strong></p>
  </li>
  <li>
    <p><strong>“Spicy DoS”</strong>: domains like web development, protocol design,
&amp;c: here, a ReDoS “attack” manifests as a waste of compute resources,
theoretically taking the service down with excess load. Except, of course,
that <strong>no attacker bothers to do this</strong>: it’s simpler, easier, and <em>just
as effective</em> to perform a DoS the “good old fashioned” way.</p>
  </li>
</ol>

<p>This is even before any of the <em>really</em> cheap shots, like observing that
<strong>the entire bug class is based on unreliable premises</strong>: that
there are no timeouts or resource limits anywhere else in the system
(almost always false, particularly in web development), and that the regular
expression engine <em>itself</em> is susceptible to pathological runtime behavior
(plenty aren’t).</p>

<p>Like every rule, there are exceptions: I am <em>positive</em> there are instances
where being able to cause a Denial of Service through a regular expression
violates some important security property. But there is <strong>no public evidence
whatsoever</strong> that these instances warrant the noise, make-work, and consequent
fatigue that their reports induce.</p>

<h2 id="security-fatigue">Security fatigue</h2>

<p><a href="https://www.nist.gov/news-events/news/2016/10/security-fatigue-can-cause-computer-users-feel-hopeless-and-act-recklessly">Security fatigue</a> is <em>badly</em> overlooked in the security tooling community; I
could<sup id="fnref:wont" role="doc-noteref"><a href="#fn:wont" rel="footnote">12</a></sup> write an entire separate post on it.</p>

<p>Instead, I’ll make it pithy: <strong>your vulnerability reports and tooling don’t
matter a single bit unless a responsible party cares about them. The single
easiest way to get the responsible party to stop caring is to make it easier
to not care<sup id="fnref:stress" role="doc-noteref"><a href="#fn:stress" rel="footnote">13</a></sup> than to care.</strong></p>

<p>Programmers want to be <em>delighted</em> by their tools: they like tools that do the
right thing by default, that nudge (but don’t prod) them in the right direction,
that integrate into their existing workflows and <em>want</em> to be integrated,
rather than demanding unique treatment. The best tools <em>reduce the amount
of work</em> an engineer needs to do; the second best tools don’t change
the volume of work but <em>make it more enjoyable.</em></p>

<p>Security tools are, overwhelmingly, <strong>not delightful</strong>: they’re bespoke
and picky about their inputs and runtimes, require their own dedicated workflows,
and, most important of all, <strong>create work that didn’t exist before</strong> for reasons
that are opaque and unaccountable without domain experience<sup id="fnref:perspective" role="doc-noteref"><a href="#fn:perspective" rel="footnote">14</a></sup>.</p>

<p><img src="https://blog.yossarian.net/assets/tooling.jpg" alt="A meme of &#34;buff shibe&#34; and &#34;cheems,&#34; comparing the perception of developer tooling to security tooling."/>
<em>(Pictured: how your developers see the security tooling you bought for them.)</em></p>

<p>ReDoS and other junk “vulnerability” classes <strong>make a bad situation worse</strong>:
they add <em>more</em> fatigue to already fatigue-inducing tools by requiring
developers to mentally correct for over-scored vulnerabilities, to wade through
the cognitive dissonance of targeting a metric (no vulnerable dependencies!)
versus their domain experience (this vulnerability is fake!), &amp;c &amp;c.</p>

<p>And finally, as I’ve hinted before, the failure mode for a security-fatigued
engineer <strong>is itself a security problem</strong>: engineers who feel like they only
respond to useless reports develop the habit of ignoring all reports,
including the real ones. When <em>actual</em> critical vulnerability reports roll in,
they lose time unlearning all of the muscle memory that bad data instills in
them. In this way, <strong>the proliferation of ReDoS “vulnerabilities” is itself
a Denial of Service</strong> against the people and mechanisms that keep software
ecosystems secure.</p>

<h2 id="cleaning-things-up">Cleaning things up</h2>

<p>It’s not fair for me to rant without offering solutions. So here are
some things we can do to immediately improve the state of affairs:</p>

<ul>
  <li>
    <p>Security feeds: <strong>ban ReDoS vulnerability reports now</strong>. The signal-to-noise
ratio on ReDoS reports is <strong>unacceptable</strong> and is a <strong>security risk in
itself</strong>; a blanket ban is a <em>justifiable</em> stop-gap until our reporting and
scoring formats can express the nuance necessary for the tiny minority of
ReDoS vulnerabilities that <em>actually</em> matter. No serious vulnerability feed
accepts the constant stream of bogus <a href="https://www.troyhunt.com/beg-bounties/">beg bounty</a> reports submitted
to vendors; ReDoS “vulnerabilities” should be treated with the same default
skepticism.</p>
  </li>
  <li>
    <p>Software supply chain companies: <strong>stop <a href="https://www.youtube.com/watch?v=_ogxZxu6cjM">juking the stats</a></strong>. There’s enough
bad software our there in the world; you shouldn’t have to bump your numbers
with low-signal, high-noise “vulnerabilities.” Even better: <strong>realign
your incentives</strong> towards security <em>throughput</em>, rather than security
<em>inundation</em>: your goal should be to make consumers of your tooling
<strong>as productive as possible</strong>, rather than burying them in noise as evidence
of your own products’ functioning.</p>
  </li>
  <li>
    <p>Open source developers: <strong>just say no.</strong> We all know that ReDoS
“vulnerability” that landed in your lap (probably from some automated
pipeline somewhere) is junk; you can say no (and say it
<strong>loudly</strong>) to fixing it. Vulnerability feeds and vendors get away with
chasing their misaligned incentives because, at the end of the day,
it’s easier for an open source maintainer to shrug and accept a
pointless patch than to employ the <em>actual</em> principles of vulnerability
analysis<sup id="fnref:analysis" role="doc-noteref"><a href="#fn:analysis" rel="footnote">15</a></sup>. The more you say no and complain about this crap,
the more pressure the responsible parties feel to realign their incentives
towards <em>helping</em> you, rather than achieving throughput statistics that
please investors.</p>
  </li>
</ul>

<hr/>




<hr/>


<span>
  Discussions:
  
  <a href="https://www.reddit.com/r/enosuchblog/comments/zxara7/redos_vulnerabilities_and_misaligned_incentives/">Reddit</a>
  

  
  <a href="https://twitter.com/8x5clPW2/status/1608111906169946112">Twitter</a>
  

  
  <a href="https://infosec.exchange/@yossarian/109591743958465135">Mastodon</a>
  
</span>

<hr/>



  






</div>
  </body>
</html>
