<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cofense.com/blog/google-amp-the-newest-of-evasive-phishing-tactic/">Original</a>
    <h1>Google AMP – The Newest of Evasive Phishing Tactic</h1>
    
    <div id="readability-page-1" class="page"><section data-id="3ff2b55" data-element_type="section">
						<div>
					<div data-id="2f9e23d5" data-element_type="column">
			<div>
								<section data-id="7447f043" data-element_type="section">
						<div>
					<div data-id="61c2ddb7" data-element_type="column">
			<div>
								<div data-id="62ca0142" data-element_type="widget" data-widget_type="theme-post-content.default">
				<div>
					<div data-elementor-type="wp-post" data-elementor-id="103659" data-elementor-post-type="post">
									<section data-id="ffe68e9" data-element_type="section">
						<div>
					<div data-id="a0ee2f7" data-element_type="column">
			<div>
								<div data-id="e008337" data-element_type="widget" data-widget_type="text-editor.default">
				<div>
							<p>Author: Dylan Duncan</p><p>A new phishing tactic utilizing Google Accelerated Mobile Pages (AMP) has hit the threat landscape and proven to be very successful at reaching intended targets. Google AMP is an open-source HTML framework used to build websites that are optimized for both browser and mobile use. The websites that we observed in these campaigns are hosted on Google.com or Google.co.uk, both of which are considered trusted domains to most users. This phishing campaign not only employs Google AMP URLs to evade security, but also incorporates a multitude of other tactics, techniques, and procedures (TTPs) known to be successful at bypassing email security infrastructure. </p><h2>Key Points </h2><ul><li>A new tactic employed by threat actors utilizes Google AMP URLs as links embedded within their phishing emails. These links are hosted on trusted domains and have proven to be successful at reaching enterprise-level employees.</li><li>Google AMP URLs used in phishing recently emerged during May of 2023 and have continued to be disseminated since the time of this writing, targeting employee login credentials.</li><li>The campaigns using this tactic have proven to be very evasive and are employing other TTPs known to bypass email security infrastructure. The following tactics have been observed by Cofense to be incorporated into the campaigns using Google AMP URLs:</li></ul><h2>Google AMP – The Latest Legitimate Application to be Abused for Phishing</h2><p><a href="https://developers.google.com/amp" target="_blank" rel="noopener">Google AMP</a> is a web component framework that allows users to create web pages that are also optimized for mobile use. Google allows each web page to be viewable on Google Search and can use Google AMP Cache as well as Google Analytics, both of which provide users with additional features to track other user interactions on AMP pages. Another feature Google AMP offers is that the webpages are initially hosted on a Google AMP URL like the example in Figure 1. This means each URL is hosted on <strong>https://www.google.com/amp/s/</strong> or <strong>https://www.google.co.uk/amp/s/</strong>. In the example below, the left half of the URL is the legitimate Google AMP pathing, and the right half would be the webpage setup by the Google AMP user. To visit this URL, a user can access the webpage link directly or through this extended version of the URL.</p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2QAAAEaAQAAAABWJKn9AAAAAnRSTlMAAHaTzTgAAAA1SURBVHja7cExAQAAAMKg9U9tB2+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfgN5LAABub1eDQAAAABJRU5ErkJggg==" alt="Figure 1: Example of a Google AMP URL. " width="868" height="282" data-wp-editing="1" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure1-1.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure1-1.png 868w, https://cofense.com/wp-content/uploads/2023/07/Figure1-1-300x97.png 300w, https://cofense.com/wp-content/uploads/2023/07/Figure1-1-768x250.png 768w" data-sizes="auto" data-eio-rwidth="868" data-eio-rheight="282"/></p><p><em>Figure 1: Example of a Google AMP URL. </em></p><p>The same features that make Google AMP appealing to legitimate users can also attract threat actors that are seeking to use it for malicious reasons. Phishing threat actors have been seen hosting malicious web pages using the Google AMP URL path within their phishing emails seeking to steal email login credentials. This can be difficult for email security infrastructure to detect the malicious nature of the emails since these URLs are hosted on legitimate Google domains. The addition of Google Analytics also provides threat actors with a way to track user interactions within their phishing pages. Figure 2 shows a real example of a phishing URL hosted using Google AMP. The Google AMP URL acts very similar to a redirect by sending users from the initial URL to the URL found within the path. For this example, that is the URL hosted on the domain netbitsfibra[.]com. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2QAAAEIAQAAAAAYOgptAAAAAnRSTlMAAHaTzTgAAAAzSURBVHja7cExAQAAAMKg9U9tDQ+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4McXAAASjLxt4AAAAASUVORK5CYII=" alt="Figure 2: Real Google AMP Phishing Example That Reached an Intended Target. " width="868" height="264" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure2-1.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure2-1.png 868w, https://cofense.com/wp-content/uploads/2023/07/Figure2-1-300x91.png 300w, https://cofense.com/wp-content/uploads/2023/07/Figure2-1-768x234.png 768w" data-sizes="auto" data-eio-rwidth="868" data-eio-rheight="264"/></p><p><em>Figure 2: Real Google AMP Phishing Example That Reached an Intended Target. </em></p><h2>A Month’s Worth of Activity – Worth Monitoring </h2><p>When it comes to monitoring phishing campaigns, it is important to focus on the ones that matter. A phishing URL blocked before it reaches the intended target doesn’t pose a threat. For this campaign, the Google AMP URLs have proven to be very successful at reaching users in environments protected by secure email gateways (SEGs). Figure 3 below shows the weekly volume of phishing emails that contain Google AMP links that Cofense has observed inside of an intended target’s inbox. These emails have proven to be successful at reaching their targets for a variety of reasons, primarily due to the fast that these URLs are hosted on a legitimate Google domain. As of this report, these emails are largely seeking to steal employee email login credentials. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB4AAAARlAQAAAABwuOfHAAAAAnRSTlMAAHaTzTgAAAEdSURBVHja7cEBDQAAAMKg909tDwcUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJwbI1EAAa1aoPkAAAAASUVORK5CYII=" alt="Google AMP – The Newest of Evasive Phishing Tactic" width="1993" height="1168" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image.png 1993w, https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image-300x176.png 300w, https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image-1024x600.png 1024w, https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image-768x450.png 768w, https://cofense.com/wp-content/uploads/2023/07/Figure3-Featured-Image-1536x900.png 1536w" data-sizes="auto" data-eio-rwidth="1993" data-eio-rheight="1168"/></p><p><em>Figure 3: Weekly volume of phishing emails abusing Google AMP. </em></p><p>Phishing campaigns abusing the Google AMP services picked up during May and haven’t left the threat landscape since. Overall, we have seen the volume oscillate drastically throughout recent weeks, with the week of May 29th and July 10th showing new heights for the tactic. On June 15th, we saw a change in tactics that included the use of Google.co.uk within the Google AMP URLs. The tactic remains the same, but the URL is hosted on Google’s United Kingdom top-level-domain.  </p><p>Out of all the Google AMP URLs we have observed, approximately 77% were hosted on the domain google.com and 23% were hosted on the domain google.co.uk. The URL pathing is a good indicator for this phishing campaign, but it is difficult to outright block “google.com/amp/s/” due to the legitimate uses. It is recommended organizations discuss the legitimate uses for this pathing for their users before outright blocking. Although blocking the path may be difficult, it could be a good opportunity to flag URLs with it. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB4AAAARlAQAAAABwuOfHAAAAAnRSTlMAAHaTzTgAAAEdSURBVHja7cEBDQAAAMKg909tDwcUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJwbI1EAAa1aoPkAAAAASUVORK5CYII=" alt="Figure 4: Comparison between the domains used by phishing emails utilizing Google AMP. " width="1993" height="1168" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure4-1.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure4-1.png 1993w, https://cofense.com/wp-content/uploads/2023/07/Figure4-1-300x176.png 300w, https://cofense.com/wp-content/uploads/2023/07/Figure4-1-1024x600.png 1024w, https://cofense.com/wp-content/uploads/2023/07/Figure4-1-768x450.png 768w, https://cofense.com/wp-content/uploads/2023/07/Figure4-1-1536x900.png 1536w" data-sizes="auto" data-eio-rwidth="1993" data-eio-rheight="1168"/></p><p><em>Figure 4: Comparison between the domains used by phishing emails utilizing Google AMP. </em></p><h2>Threat Actors Combine the Newest Tactic with other Tried and True TTPs </h2><p>The Google AMP phishing campaigns have proven to successfully reach their intended targets. This is likely due to the trusted status and legitimacy of the Google domains that each URL is hosted on. Although that reason may be sufficient, threat actors employing this new tactic have also incorporated the tried-and-true methods already known to contribute to the evasiveness of a phishing email. The following TTPs have been observed in a variety of phishing emails that are using Google AMP URLs as embedded links within phishing emails: </p><p><strong>Trusted Domains</strong> – The Google AMP tactic is effective because of the combination of hosting a URL on a trusted domain as well as the redirection-like process it takes going from the Google AMP URL to the phishing site. Trusted domains make automated analysis difficult, since you cannot simply outright block the legitimate parts of a malicious URL abusing the process. </p><p><strong>Image-based Phishing Emails</strong> – Several of the emails observed are image-based phishing emails. This means the emails do not contain a traditional email body, but rather they contain an HTML image. Emails of this nature are more difficult to detect compared to text-based emails. This is due to the image adding more noise within the email’s headers as well as obfuscating security solutions that involve scanning email text. The email shown in Figure 5 is a phishing email found in a user’s inbox that was using a Google AMP URL. The whole image is clickable and directs users to the next step of the phishing attack. The lures behind these emails have varied, but are primarily email notifications, requests, reminders, shared files, or are finance related. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtQAAAKsAQAAAADkJxfxAAAAAnRSTlMAAHaTzTgAAABTSURBVHja7cEBAQAAAIIg/69uSEABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALwb10AABPc1hUgAAAABJRU5ErkJggg==" alt="Figure 5: Example of phishing email that used Google AMP with a clickable HTML image. " width="724" height="684" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure5-1.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure5-1.png 724w, https://cofense.com/wp-content/uploads/2023/07/Figure5-1-300x283.png 300w" data-sizes="auto" data-eio-rwidth="724" data-eio-rheight="684"/></p><p><em>Figure 5: Example of phishing email that used Google AMP with a clickable HTML image. </em></p><p><strong>URL Redirection</strong> – URL redirection has become an increasingly popular method for disrupting email analysis. Having multiple redirects within a single phishing attack chain rather than a single malicious URL can make analysis difficult. The example in Figure 6 below was pulled from a user’s inbox and is a good example of both trusted domains and URL redirection used as a TTP within a phishing email. The redirection is not only redirecting to the Google AMP domain, but it is also hosted on Microsoft.com, which is another trusted domain. This adds an additional layer of false legitimacy to the campaign. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAugAAACQAQAAAAByz6O4AAAAAnRSTlMAAHaTzTgAAAAkSURBVGje7cExAQAAAMKg9U9tDB+gAAAAAAAAAAAAAAAAAD4GNOAAAZntBQgAAAAASUVORK5CYII=" alt="Figure 6: Phishing URL utilizing a Microsoft domain to redirect to a Google AMP phishing site.  " width="744" height="144" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure6.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure6.png 744w, https://cofense.com/wp-content/uploads/2023/07/Figure6-300x58.png 300w" data-sizes="auto" data-eio-rwidth="744" data-eio-rheight="144"/></p><p><em>Figure 6: Phishing URL utilizing a Microsoft domain to redirect to a Google AMP phishing site.  </em></p><p><strong>Cloudflare CAPTCHA</strong> – The abuse of Cloudflare’s CAPTCHA service has become a popular anti-analysis tactic. Cloudflare is a legitimate domain security service used to keep websites secure from bots or other automated visitors. This has proven to be a very effective tactic at evading email security because the CAPTCHAs often come prior to any actual-malicious URLs. The use of a CAPTCHA requires a manual user to be present to reach the final malicious URL within the initial redirection or infection chain. Cloudflare services also allow the blocking of certain geo-locations through IP filtering, and IP proxying services which allow the threat actor to hide the domain’s original hosting provider. </p><p><img decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjQAAAEiAQAAAADGl3W1AAAAAnRSTlMAAHaTzTgAAAAqSURBVHja7cEBAQAAAIIg/69uSEABAAAAAAAAAAAAAAAAAAAAAAAAAHwZUZAAAcKJy9QAAAAASUVORK5CYII=" alt="Figure 7: Example of Cloudflare CAPTCHA pulled from Google AMP phishing campaign. " width="564" height="290" data-src="https://cofense.com/wp-content/uploads/2023/07/Figure7.png" data-srcset="https://cofense.com/wp-content/uploads/2023/07/Figure7.png 564w, https://cofense.com/wp-content/uploads/2023/07/Figure7-300x154.png 300w" data-sizes="auto" data-eio-rwidth="564" data-eio-rheight="290"/></p><p><em>Figure 7: Example of Cloudflare CAPTCHA pulled from Google AMP phishing campaign. </em></p>						</div>
				</div>
					</div>
		</div>
							</div>
		</section>
							</div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
					</div>
		</div>
							</div>
		</section></div>
  </body>
</html>
