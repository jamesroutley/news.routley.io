<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2024/08/17/compression-and-interpolation/">Original</a>
    <h1>Compressing data with sample points and polynomial interpolation</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p>Data compression is everywhere. We’re unaware of it when it is done well. We only become aware of it when it is pushed too far, such as when a photo looks grainy or fuzzy because it was compressed too much.</p>
<p>The basic idea of data compression is to not transmit the raw data but to transmit some of the data along with instructions for how to approximately reconstruct the rest [1].</p>
<p>Fifty years ago scientists were concerned with a different application of compression: reducing the size of mathematical tables. Books of tabulated functions are obsolete now, but the principles used in producing these tables are still very much relevant. We use compression and interpolation far more often now, though it’s almost always invisibly executed by software.</p>
<h2>Compressing tables</h2>
<p>In this post I want to expand on comments by Forman Acton from his book <em>Numerical Methods That Work</em> on compression.</p>
<blockquote><p>Many persons are unaware of the considerable compression in a table that even the use of quadratic interpolation permits. A table of sin <em>x</em> covering the first quadrant, for example, requires 541 pages if it is to be linearly interpolable to eight decimal places. If quadratic interpolation is used, the same table takes only <em>one</em> page having entries at one-degree intervals with functions of the first and second differences being recorded together with the sine itself.</p></blockquote>
<p>Acton goes on to mention the advantage of condensing shelf space by a factor of 500. We no longer care about saving shelf space, but we may care very much about saving memory in an embedded device.</p>
<p>Quadratic interpolation does allow more compression than linear interpolation, but not by a factor of 500. I admire Acton’s numerical methods book, but I’m afraid he got this one wrong.</p>
<h2>Interpolation error bound</h2>
<p>In order to test Acton’s claim we will need the following theorem on interpolation error [2].</p>
<p>Let <em>f</em> be a function so that <em>f</em><sup>(<em>n</em>+1)</sup> is continuous on [<em>a</em>, <em>b</em>] and satisfies |<em>f</em><sup>(<em>n</em>+1)</sup> (<em>x</em>)| ≤ <em>M</em>. Let <em>p</em> be the polynomial of degree ≤ <em>n</em> that interpolates <em>f</em> at <em>n</em> + 1 equally spaced nodes in [<em>a</em>, <em>b</em>], including the end points. Then on [<em>a</em>, <em>b</em>],</p>
<p><img decoding="async" src="https://www.johndcook.com/interpolationerror2.svg" alt="|f(x) - p(x)| \leq \frac{1}{4(n+1)} M \left(\frac{b-a}{n}\right)^{n+1}" width="311" height="52"/></p>
<h2>Quadratic interpolation error</h2>
<p>Acton claims that quadratic interpolation at intervals of one degree is adequate to produce eight decimal places of accuracy. Quadratic interpolation means <em>n</em> = 2.</p>
<p>We have our function tabulated at evenly spaced points a distance <em>h</em> = π/180 radians apart. Quadratic interpolation requires function values at three points, so <em>b</em> − <em>a</em> = 2<em>h</em> = π/90. The third derivative of sine is negative cosine, so <em>M</em> = 1.</p>
<p>This gives an error bound of 4.43 × 10<sup>−7</sup>, so this would give slightly better than six decimal place accuracy, not eight.</p>
<h2>Linear interpolation error</h2>
<p>Suppose we wanted to create a table of sine values so that linear interpolation would give results accurate to eight decimal places.</p>
<p><a href="https://www.johndcook.com/blog/2017/02/26/function-on-cover-of-abramowitz-stegun/">Abramowitz and Stegun</a> devotes 32 pages to tabulating sine and cosine at increments of 0.001 radian. This does not always guarantee eight decimal place accuracy using linear interpolation, but it does guarantee at least seven places (more on that <a href="https://www.johndcook.com/blog/2024/06/25/trig-tables/">here</a>), which is better than a table at one degree increments would deliver using quadratic interpolation. So it would have been more accurate for Acton to say quadratic interpolation reduces the number of pages by a factor of 30 rather than 500.</p>
<h2>Cubic interpolation error</h2>
<p>If we have a table of sine values at one degree increments, how much accuracy could we get using cubic interpolation? In that case we’d apply the interpolation error theorem with <em>n</em> = 3 and <em>b</em> − <em>a</em> = 3(π/180) = π/60. Then the error bound is 5.8 × 10<sup>−9</sup>. This would usually give you eight decimal place accuracy, so perhaps Acton carried out the calculation for cubic interpolation rather than quadratic interpolation.</p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/2021/08/23/naive-compression-of-genetic-data/">Compressing genetic data</a></li>
<li><a href="https://www.johndcook.com/blog/2024/06/03/using-a-table-of-logarithms/">Using a table of logarithns</a></li>
<li><a href="https://www.johndcook.com/blog/2024/08/08/interpolating-gamma/">Interpolating the gamma function</a></li>
</ul>
<p>[1] This is what’s known as <em>lossy</em> compression; some information is lost in the compression process. Lossless compression also replaces the original data with a description that can be used to reproduce the data, but in this case the reconstruction process is perfect.</p>
<p>[2] Ward Cheney and David Kincaid. Numerical Methods and Computation. Third edition.</p>

			</div></div>
  </body>
</html>
