<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.linuxatemyram.com/">Original</a>
    <h1>Linux Ate My RAM</h1>
    
    <div id="readability-page-1" class="page"><article>

      <center>
        <img src="https://www.linuxatemyram.com/atemyram.png" alt="Linux ate my RAM!"/>
        
      </center>

        <h2>What&#39;s going on?</h2>
        <p>Linux is borrowing unused memory for disk caching. This makes it look like you are low on memory, but you are not! Everything is fine!</p>

        <h2>Why is it doing this?</h2>
        <p>Disk caching makes the system much faster and more responsive! There are no downsides, except for confusing newbies. It does not take memory away from applications in any way, ever!</p>

        <h2>What if I want to run more applications?</h2>
        <p>If your applications want more memory, they just take back a chunk that the disk cache borrowed. Disk cache can always be given back to applications immediately! You are not low on ram!</p>

        <h2>Do I need more swap?</h2>
        <p>No, disk caching only borrows the ram that applications don&#39;t currently want. It will not use swap. If applications want more memory, they just take it back from the disk cache. They will not start swapping.</p>

        <h2>How do I stop Linux from doing this?</h2>
        <p>You can&#39;t disable disk caching. The only reason anyone ever wants to disable disk caching is because they think it takes memory away from their applications, which it doesn&#39;t! Disk cache makes applications load faster and run smoother, but it NEVER EVER takes memory away from them! Therefore, there&#39;s absolutely no reason to disable it!</p>
        <p>If, however, you find yourself needing to clear some RAM quickly to workaround another issue, like a VM misbehaving, you can force linux to nondestructively <a href="https://linux-mm.org/Drop_Caches">drop caches</a> using <code>echo 3 | sudo tee /proc/sys/vm/drop_caches</code>.</p>

        <h2>Why does top and free say all my ram is used if it isn&#39;t?</h2>
        <p>This is just a difference in terminology. Both you and Linux agree that memory taken by applications is &#34;used&#34;, while memory that isn&#39;t used for anything is &#34;free&#34;.</p>
        <p>But how do you count memory that is currently used for something, but can still be made available to applications?</p>
        <p>You might count that memory as &#34;free&#34; and/or &#34;available&#34;. Linux instead counts it as &#34;used&#34;, but also &#34;available&#34;:</p>
        <table>
          <thead>
            <tr>
              <th>Memory that is</th>
              <th>You&#39;d call it</th>
              <th>Linux calls it</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>used by applications</td>
              <td>Used</td>
              <td>Used</td>
            </tr>
            <tr>
              <td>used, but can be made available</td>
              <td>Free (or Available)</td>
              <td>Used (and Available)</td>
            </tr>
            <tr>
              <td>not used for anything</td>
              <td>Free</td>
              <td>Free</td>
            </tr>
          </tbody>
        </table>
        <p>This &#34;something&#34; is (roughly) what top and free calls &#34;buffers&#34; and &#34;cached&#34;. Since your and Linux&#39;s terminology differs, you might think you are low on ram when you&#39;re not.</p>

        <h2>How do I see how much free ram I really have?</h2>
        <p>To see how much ram your applications could use without swapping, run <code>free -m</code> and look at the &#34;available&#34; column:</p>
        <pre>  $ free -m
                total        used        free      shared  buff/cache   available
  Mem:           1504        1491          13           0         855      <span><strong>792</strong></span>
  Swap:          2047           6        2041
</pre>
        <p><small>(On installations from before 2016, look at &#34;free&#34; column in the &#34;-/+ buffers/cache&#34; row instead.)</small></p>
        <p>This is your answer in MiB. If you just naively look at &#34;used&#34; and &#34;free&#34;, you&#39;ll think your ram is 99% full when it&#39;s really just 47%!</p>
        <p>For a more detailed and technical description of what Linux counts as &#34;available&#34;, see <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=34e431b0ae398fc54ea69ff85ec700722c9da773">the commit that added the field</a>.</p>

        <h2>When should I start to worry?</h2>
        <p>A <strong>healthy Linux system</strong> with more than enough memory will, after running for a while, show the following expected and harmless behavior:</p>
        <ul>
          <li><code>free</code> memory is close to <code>0</code> </li>
          <li><code>used</code> memory is close to <code>total</code> </li>
          <li><code>available</code> memory (or &#34;free + buffers/cache&#34;) has enough room (let&#39;s say, 20%+ of total)</li>
          <li><code>swap used</code> does not change</li>
        </ul>
        <p><strong>Warning signs</strong> of a genuine low memory situation that you may want to look into:</p>
        <ul>
          <li><code>available</code> memory (or &#34;free + buffers/cache&#34;) is close to zero</li>
          <li><code>swap used</code> increases or fluctuates</li>
          <li><code>dmesg | grep oom-killer</code> shows the OutOfMemory-killer at work</li>
        </ul>

        <h2>How can I verify these things?</h2>
        <p>See <a href="https://www.linuxatemyram.com/play.html">this page</a> for more details and how you can experiment with disk cache to show the effects described here. Few things make you appreciate disk caching more than measuring an order-of-magnitude speedup on your own hardware!</p>

        <small><strong>LinuxAteMyRam.com was presented by <a href="http://www.vidarholen.net">VidarHolen.net</a>. This site is available <a href="https://github.com/koalaman/linuxatemyram.com">on GitHub</a> for comments and PRs.</strong></small>

    </article></div>
  </body>
</html>
