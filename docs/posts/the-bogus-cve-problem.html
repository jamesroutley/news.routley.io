<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lwn.net/Articles/944209/">Original</a>
    <h1>The Bogus CVE Problem</h1>
    
    <div id="readability-page-1" class="page"><div>
<center>
           <div><b>LWN.net needs you!</b><p>Without subscribers, LWN would simply not exist.  Please consider
       <a href="https://lwn.net/subscribe/">signing up for a subscription</a> and helping
       to keep LWN publishing</p></div>
           </center>
           
<p>
The &#34;<a href="https://cve.mitre.org/">Common Vulnerabilities and
Exposures</a>&#34; (CVE) system was launched late 
in the previous century (September 1999) to track vulnerabilities in
software.  Over the years since, it has had a <a href="https://lwn.net/Articles/679315/">somewhat checkered
reputation</a>, along with some <a href="https://lwn.net/Articles/851849/">some attempts to
replace it</a>, but CVE numbers are still the only effective way to track
vulnerabilities.  While that can certainly be useful, the
CVE-assignment (and severity scoring) process is not without its problems.
The prominence of CVE numbers, and the consequent increase in 
&#34;reputation&#34; for a reporter, have combined to create a system that can
be—and is—actively gamed.  Meanwhile, the organizations that oversee the
system are ultimately not doing a particularly stellar job.
</p>

<p>
A recent incident highlights some of the problems inherent in the system. <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-19909">CVE-2020-19909</a>,
which is an integer-overflow bug in
the <a href="https://curl.se/">curl tool and library for URL-based data
transfers</a> that was only reported
to the project in 2023.  In a <a href="https://daniel.haxx.se/blog/2023/08/26/cve-2020-19909-is-everything-that-is-wrong-with-cves/">blog
post describing the mess</a>, curl maintainer Daniel
Stenberg said that a <a href="https://curl.se/mail/lib-2023-08/0031.html">message to the
curl-library mailing list</a> on August 25 alerted the project that the CVE
had become public the week before.
</p>

<p>
The year in the CVE number (2020 in this case) is meant to indicate when
the bug was 
reported to one of the <a href="https://www.cve.org/ProgramOrganization/CNAs">more than 300 CVE
numbering authorities</a> (CNAs) that hand out CVE numbers.  Under normal
circumstances, a new bug showing up with a CVE number would have 2023 in
it, but sometimes CVEs are given out for older bugs that somehow
slipped through the cracks.  That appears to be what happened in this case,
as Stenberg was able to track the problem back to a <a href="https://hackerone.com/reports/661847">bug report</a> from Jason Lee
in mid-2019.
</p>

<p>
The report was for a legitimate bug, where the
<tt>‑‑retry‑delay</tt> option value was being multiplied
by 1000 (to milliseconds) without an overflow check.  But what it was
<i>not</i> was a security 
bug, Stenberg said; giving insanely large values for the
option might result in incorrect 
delays—far shorter than requested—but it is not a security problem to make
multiple requests in a short time span.  If it were, &#34;<q>then a browser
makes a DOS [denial of service] every time you visit a website — and curl
does it when you give it two URLs on the same command line</q>&#34;, he said in
a <a href="https://daniel.haxx.se/blog/2023/09/05/bogus-cve-follow-ups/">followup
post</a>. 
</p>

<p>
The problem was <a href="https://github.com/curl/curl/pull/4166">duly
fixed</a>, a test case was added, and Lee was credited with the report in
the commit message.  In September 2019, curl 7.66.0 was <a href="https://curl.se/mail/archive-2019-09/0002.html">released</a> with
fix, which was mentioned in the announcement; also notable are the two CVEs
mentioned at the top of the bug fixes listed.  As Stenberg noted, the curl
project 
works hard to ensure that it fully documents the (real) CVEs that get filed
for
it; his exasperation with CVE-2020-19909 coming out of the blue is evident:
</p><blockquote>
In the curl project we work hard and fierce on security and we always work
with security researchers who report problems. We file our own CVEs, we
document them and we make sure to tell the world about them. <a href="https://curl.se/docs/security.html">We list over 140 of them</a> with every imaginable detail about them provided. We aim at
providing gold-level documentation for <i>everything</i> and that includes our
past security vulnerabilities. 
<p>
That someone else suddenly has submitted a CVE for curl is a surprise. We
have not been told about this and we would <i>really</i> have liked to. [...]
</p></blockquote>


<p>
The <a href="https://nvd.nist.gov/">National Vulnerability Database</a>
(NVD) tracks CVEs and &#34;scores&#34; them using the <a href="https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System">Common
Vulnerability Scoring System</a> (CVSS), which is a ten-point scale that is
meant to give an indication of the severity of a vulnerability.  For the
curl bug, which should probably not be scored at all, NVD initially came up
with a &#34;9.8 critical&#34;, scoring an integer overflow in a delay parameter
as one of the most severe types of vulnerability possible.  Stenberg, who
has tangled with NVD over scoring before, is even further exasperated:
</p><blockquote>
It was obvious already before that NVD really does not try very hard to
actually understand or figure out the problem they grade. In this case it
is quite impossible for me to understand how they could come up with this
severity level. It&#39;s like they saw &#34;integer overflow&#34; and figure that <i>wow,
yeah that is the most horrible flaw we can imagine</i>, but clearly nobody at
NVD engaged their brains nor looked at the &#34;vulnerable&#34; code or the patch
that fixed the bug. Anyone that looks can see that this is not a security
problem. 
</blockquote>


<p>
In fact, the pull request for the fix was attached to the report, but that
apparently made little difference in the assessment from NVD.  Back in
March, 
Stenberg <a href="https://daniel.haxx.se/blog/2023/03/06/nvd-makes-up-vulnerability-severity-levels/">decried</a>
the NVD scoring process and, in particular, the NVD practice of re-scoring
CVEs that have already had severity levels attached to them.  NVD uses
CVSS, but the curl project long ago rejected that scoring system:
</p><blockquote>
In the curl project we decided to abandon CVSS years ago because of its
inherent problems. Instead we use only the four severity names: <b>Low</b>,
<b>Medium</b>, <b>High</b>, and <b>Critical</b> and we work out the
severity together in the 
curl security team as we work on the vulnerability. We make sure we
understand the problem, the risks, its prevalence and more. We take all
factors into account and then we set a severity level we think helps the
world understand it. 
</blockquote>


<p>
His example in that case is <a href="https://curl.se/docs/CVE-2022-42915.html">a double-free in curl</a>
that the project determined had a &#34;medium&#34; severity, while NVD scored it as
&#34;9.8 critical&#34;, as can be seen in the <a href="https://github.com/advisories/GHSA-98w6-hw73-ph8m">GitHub advisory
database</a>. Since then, NVD apparently had a change of heart after
Stenberg&#39;s complaint as the CVE is <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42915">now scored &#34;8.1
high&#34;</a>.  In a <a href="https://daniel.haxx.se/blog/2023/06/12/nvd-damage-continued/">followup
on NVD &#34;brokenness&#34;</a>, Stenberg gave another example of a CVE that was
initially scored &#34;9.8 critical&#34;, but eventually was reduced to &#34;5.9 medium&#34;
after complaints—though the curl project rates it as &#34;low&#34;.  He also noted
that there is a set of projects that never report low or medium CVEs that
they find, in order to avoid these kinds of scoring woes.
</p>

<p>
One could perhaps wonder if this is all just a problem for the curl project
and not more widespread, but there is a fair amount of evidence of a
variety of problems in CVE-land.  For example, the PostgreSQL project had a
similar problem with a <a href="https://www.postgresql.org/about/news/cve-2020-21469-is-not-a-security-vulnerability-2701/">CVE
&#34;from&#34; 2020</a> that appeared recently—and is not a security vulnerability
at all, according to the project.  In June, the <a href="https://keepassxc.org/">KeePassXC</a> password manager project
<a href="https://keepassxc.org/blog/2023-06-20-cve-202335866/">had a bogus
CVE filed</a> for the tool; there are other examples as well.
</p>

<p>
Each of these bogus CVE filings, which can apparently be made anonymously and
without much in the way of backing information, require that the project
notice its existence, analyze the problem (or &#34;problem&#34;), and, if
necessary, dispute the existence or score of the CVE.
As noted, several curl CVEs have had their scores reduced rather
substantially due to requests from the project.  The delay parameter
overflow that was initially scored 9.8 has been reduced to &#34;3.3
low&#34;, marked as &#34;disputed&#34;, and had a link to Stenberg&#39;s blog post
added to the NVD entry.

</p><p>
Keeping up with all of that is a lot of
work, which Stenberg said he is going to try to avoid in the future by
applying to become the CNA for curl.  Several other open-source projects are
CNAs, which gives them some notification of a reported problem along with
ways to try to ensure that the problem is handled sanely.  He mentioned
Apache, OpenSSL, and Python as some of the projects that are already
CNAs; Python was just <a href="https://pyfound.blogspot.com/2023/08/psf-authorized-as-cna.html">granted
CNA status</a> at the end of August.
</p>

<p>
Meanwhile, though, CVEs are used in ways that elevate their importance well
beyond the level that makes sense given the amount of scrutiny that is
apparently applied to them.
Service-level contracts and governmental requirements mean that a critical
CVE needs to be addressed in short order, so non-critical bugs that get
marked that way can cause real problems.  It does provide incentives for
companies and others to try to downplay the severity of bugs, as well, of
course, which makes for something of a &#34;<a href="https://en.wikipedia.org/wiki/List_of_Doctor_Dolittle_characters#Pushmi-Pullyu">Pushmi-Pullyu</a>&#34;
in CVE-land.
</p>

<p>
As was alluded to in our mid-August <a href="https://lwn.net/Articles/941745/">look at
kernel security reporting for distributions</a>, the CVE system is
generally included in the &#34;security circus&#34; that kernel developers
largely disdain.  A <a href="https://lwn.net/Articles/801157/">2019 talk by Greg
Kroah-Hartman</a> described multiple problems that he sees with the
system as well.
</p>

<p>
All in all, the CVE system seems to be broken in various ways.  It also
seems to be getting more and more entrenched into &#34;cybersecurity&#34; handling
at various levels.  Given that it is effectively run by—and now
for—governmental agencies, the ability to replace it with something more
sensible has likely already passed us by.  CVE, warts and all, will be with
us for a long time to come; FOSS projects and organizations are simply
going to have to figure out how to coexist with it.
</p></div></div>
  </body>
</html>
