<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.reversemode.com/2022/03/satcom-terminals-under-attack-in-europe.html">Original</a>
    <h1>SATCOM terminals under attack in Europe: a plausible analysis</h1>
    
    <div id="readability-page-1" class="page"><div>
<h3>
 SATCOM terminals under attack in Europe: a plausible analysis.
</h3>
</div><div>
<div id="post-body-7894236783287384900">
<p>February 24th: at the same time Russia initiated a full-scale attack on Ukraine, tens of thousands of KA-SAT SATCOM terminals suddenly <a href="https://www.reuters.com/business/aerospace-defense/satellite-firm-viasat-probes-suspected-cyberattack-ukraine-elsewhere-2022-02-28/" target="_blank">stopped</a> working in several european countries: Germany, Ukraine, Greece, Hungary, Poland...Germany&#39;s Enercon moved forward and acknowledged that approximately 5800 of its wind turbines, presumably those remotely operated via a SATCOM link in central Europe, had lost contact with their <a href="https://www.enercon.de/en/technology/grid-technology/" target="_blank">SCADA server</a>.  In the affected countries, a significant part of the customers of Eutelsat&#39;s domestic broadband service were also unable to access Internet. </p><p>From the very beginning Eutelsat and its parent company Viasat, stated that the issue was being investigated as a cyberattack. Since then, details have been scarcely provided but few days ago I came across a really interesting video in the following <a href="https://twitter.com/LaeCesari/status/1499863645987168256?" target="_blank">tweet</a>.</p><p>In the video, the Commander General Michel Friedling confirms that the incident was originated by a cyberattack. However, he also provides a key detail that has the potential to turn a boring DDoS scenario, as some initially pointed out, into something much more interesting: &#34;the terminals have been damaged, made inoperable and probably cannot be repaired&#34;</p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgOqVKgkh9XVGuBFUrnUJi1kFWcOGs78QDY4KyrLMO5NVAaUehXEpWER22jIMi-xBdWMx46mKxvAlDnb27UhtcEtyEplO_JhdQT9ooboctiTbY6uLccUfhobRJRwR1Tarxp-s26OaSuUnNHXW-cRlTLvBiC4ZaShryTyvnc9hAo6i5VqEKEaE3Btg4O_g"><img alt="" data-original-height="648" data-original-width="1156" height="357" src="https://blogger.googleusercontent.com/img/a/AVvXsEgOqVKgkh9XVGuBFUrnUJi1kFWcOGs78QDY4KyrLMO5NVAaUehXEpWER22jIMi-xBdWMx46mKxvAlDnb27UhtcEtyEplO_JhdQT9ooboctiTbY6uLccUfhobRJRwR1Tarxp-s26OaSuUnNHXW-cRlTLvBiC4ZaShryTyvnc9hAo6i5VqEKEaE3Btg4O_g=w638-h357" width="638"/></a></p><p>Based on the information publicly available and my experience researching into SATCOM terminals I&#39;ll try to present a plausible explanation for such a destructive attack. </p><h3>Introduction</h3><p>Please note that this is merely a speculative exercise, although backed by a realistic technical reasoning...anyway probably I&#39;m totally wrong.</p><p>Back in 2014 and then in 2018 I presented at BlackHat USA two different papers mainly focused on evaluating the security posture of multiple SATCOM terminals, by uncovering a plethora of vulnerabilities and real-world scenarios across different sectors. Within these papers the reader can find an introduction to the SATCOM architecture, threat scenarios and some technical terms that will be used during this blog post.</p><p>2014 - <a href="https://ioactive.com/pdfs/IOActive_SATCOM_Security_WhitePaper.pdf" target="_blank">A Wake-Up call for SATCOM Security</a></p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgjFzNB64Tyti8ppeIAsTrQq5dt1qiVRYhgGACr1CAO3cBeShZPPvbN3AssVXJYPw8JuBWTDqoVrgmELihHIWhl3iw_xNiZgX4fZ6sYFLU4Xudp8Ef9YFJQYHVnODz4EDzMSiXk492WmHGH2a3ui_QV2hjWvwoHgq8H5s0WLKkixuXJf9DT3971Y3TdSA"><img alt="" data-original-height="1522" data-original-width="1154" height="478" src="https://blogger.googleusercontent.com/img/a/AVvXsEgjFzNB64Tyti8ppeIAsTrQq5dt1qiVRYhgGACr1CAO3cBeShZPPvbN3AssVXJYPw8JuBWTDqoVrgmELihHIWhl3iw_xNiZgX4fZ6sYFLU4Xudp8Ef9YFJQYHVnODz4EDzMSiXk492WmHGH2a3ui_QV2hjWvwoHgq8H5s0WLKkixuXJf9DT3971Y3TdSA=w362-h478" width="362"/></a></p><p>2018 - <a href="https://ioactive.com/wp-content/uploads/2018/08/us-18-Santamarta-Last-Call-For-Satcom-Security-wp.pdf" target="_blank">Last Call for SATCOM Security</a> </p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgNguCPYXVk3ikNIGOBiSOIW95kfokpEavUWtStUIZO86rmk2VP704gN4nLqD_OSCNMkLkc-qC-_7uOJZnjhY0I7sz75UWq2n7VDVJ_0yvxRK8LeB5mFav1dO9hVx2V5tV35Pq_EANWz7etnkx5a4DlDAdN6CQDyOdh0Q-eq_74b29UdoeBJWvbQd4z3w"><img alt="" data-original-height="550" data-original-width="1194" height="250" src="https://blogger.googleusercontent.com/img/a/AVvXsEgNguCPYXVk3ikNIGOBiSOIW95kfokpEavUWtStUIZO86rmk2VP704gN4nLqD_OSCNMkLkc-qC-_7uOJZnjhY0I7sz75UWq2n7VDVJ_0yvxRK8LeB5mFav1dO9hVx2V5tV35Pq_EANWz7etnkx5a4DlDAdN6CQDyOdh0Q-eq_74b29UdoeBJWvbQd4z3w=w543-h250" width="543"/></a></p><p>In the ground segment of the <a href="https://studylib.net/doc/5668139/" target="_blank">KA-SAT</a>  <a href="https://en.wikipedia.org/wiki/KA-SAT" target="_blank">infrastructure</a> we find 10 gateways distributed across Europe. Please note that the Berlin Gateway is the closest one to Ukraine. Coincidentally, Germany seems to have suffered one the worst parts of the attack.</p><div><div><h3><span><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiteJGJ7rQEpx02GDf3ZiWjRac1hvUfpEciek2DP7eFjhZGuCm9JH1ak3AZAepbhHjwTP6ayFRaz-p6iRZjvTluoqzUEDZNFNppmI6q0vt6IvFkYz5xaN8vaullvr4GxV6oopKxfyZLuydFRa-s1UVZHjFlHEr3dLUHs6W5hnoMPLYuOEcWeu-vKhxZUA=s1744"><img data-original-height="1070" data-original-width="1744" height="371" src="https://blogger.googleusercontent.com/img/a/AVvXsEiteJGJ7rQEpx02GDf3ZiWjRac1hvUfpEciek2DP7eFjhZGuCm9JH1ak3AZAepbhHjwTP6ayFRaz-p6iRZjvTluoqzUEDZNFNppmI6q0vt6IvFkYz5xaN8vaullvr4GxV6oopKxfyZLuydFRa-s1UVZHjFlHEr3dLUHs6W5hnoMPLYuOEcWeu-vKhxZUA=w605-h371" width="605"/></a></span></h3></div><p>These Gateway Earth Stations are interconnected using a redundant fiber ring. This backbone also maintains the connectivity with up to 6 telco Points of Presence (POP).</p></div><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhYajeVKB5_oyjJM8WWYBmjGWWQBxeo_sib-zQuFPvqYZO30Unji7DPm43-MTLMm0iVwh6bOkzD_NWbc2S0KWo1MLkETIVHmlaqtpaG3dHQ_393NqH7lL7_iiWDp0IJR_smAecN7AdTz5lm7XYGdKQOitKzdAdaR6Zejc2XI1GfSXg4FhzO4OYpm_a7Kw=s1594"><img data-original-height="1078" data-original-width="1594" height="412" src="https://blogger.googleusercontent.com/img/a/AVvXsEhYajeVKB5_oyjJM8WWYBmjGWWQBxeo_sib-zQuFPvqYZO30Unji7DPm43-MTLMm0iVwh6bOkzD_NWbc2S0KWo1MLkETIVHmlaqtpaG3dHQ_393NqH7lL7_iiWDp0IJR_smAecN7AdTz5lm7XYGdKQOitKzdAdaR6Zejc2XI1GfSXg4FhzO4OYpm_a7Kw=w611-h412" width="611"/></a></p><p>The satellite coverage is divided into the <a href="https://www.satbeams.com/footprints?beam=6706" target="_blank">82 spot beams</a>, each of them is approximately 300km of diameter. As it can be seen in the following image, there are four types of spot beams which enable approximately 240 MHz in both directions (independently for the Forward and Return channels), thus allowing to re-use the slots of available frequencies (1.95 GHz in total, ~((240Mhz*2)*4)) under different polarizations. This throughput requires using multiple Gateway Earth Stations, geographically separated, for properly providing the service.</p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjPEp_BlWRu97U2czdJdx14WKvgaBxyUpNDQ-YcxAqLZ42dZwINY7KgWsgmDTC1Wm9i48Xqq9E21-S6iOxQQKKwxHq8WBkpc6jAhFnkALzB0GT6jGTWP7AnGRAaAmpAdFAS2EkXtV_tmQqWTg3dg1L49LbDVEotp2nbypvuxFNC0_wWlrjRS3Sbgqx_ow=s1024"><img data-original-height="768" data-original-width="1024" height="466" src="https://blogger.googleusercontent.com/img/a/AVvXsEjPEp_BlWRu97U2czdJdx14WKvgaBxyUpNDQ-YcxAqLZ42dZwINY7KgWsgmDTC1Wm9i48Xqq9E21-S6iOxQQKKwxHq8WBkpc6jAhFnkALzB0GT6jGTWP7AnGRAaAmpAdFAS2EkXtV_tmQqWTg3dg1L49LbDVEotp2nbypvuxFNC0_wWlrjRS3Sbgqx_ow=w621-h466" width="621"/></a></p><p>An important detail is that the mappings between the spot beams and the gateways are fixed: each gateway handles a set of 10 different beams. </p><div><p>The user terminals are comprised of:</p><p>1.- The ODU (Outdoor Unit) </p><p><span>	</span>The transmit-receive assembly (TRIA). </p><p>2.- The IDU (Indoor Unit) </p><div><h2>What do we really know about the attack?</h2><p>From the information publicly available there are 5 facts that should drive this analysis:</p><p>1.- It seems that the attackers originally targeted Eutelsat&#39;s KA-SAT SATCOM terminals located in Ukraine but the attack propagated to other countries such as Greece, Germany, Poland, Italy or Hungary.</p><p>2.- Apparently, tens of thousands of terminals have been permanently damaged, rendering them inoperable. </p><p>3.- It happened at the same time the russian forces initiated the invasion of Ukraine.</p><p>4.- It targeted the fixed broadband customers of a civil satellite network, neither maritime nor aviation sectors were affected.</p><p>5.- According to the video of the Commander General Michel Friedling, it didn&#39;t impact the space segment.  </p></div><div><h2>Scenarios</h2><p>We can initially assess the following scenarios:</p><p><u>1. DDoS</u></p><p>A targeted DDoS attack could have initially explained the temporary disruption of the service, thus complying with all the previous facts. However, it does not provide any explanation for the permanent damage (fact number 2)</p><p><u>2.  RF/EM pulse</u></p><p>An attack requiring enough power to deep-fry tens of thousands of terminals at the same time, which are located across multiple countries covering a vast area in the order of thousands of Kms, is not feasible. Moreover, it would have impacted other devices, also immediately triggering a lot of military alarms. </p><p><u>3. 0day in SATCOM terminals publicly exposed.</u></p><p>A remotely exploitable vulnerability in a SATCOM terminal, in addition to an improper network configuration of the satellite provider, is a totally feasible scenario that can be exploited at a certain scale. In 2018 I documented how dozens of commercial aircraft were publicly exposed to the internet through a vulnerable SATCOM infrastructure (see &#39;Last Call For SATCOM security&#39; - Aviation, Pages 3-19 ). </p><p>Please also note that Internet is not the only attack vector that can be used,  a malicious terminal connected to a specific SATCOM network may also leverage improper network configurations to attack other terminals. Obviously, this scenario highly depends on the satellite service and operators.</p><div><p>It is interesting that after 4 years,  a month ago the NSA released an advisory &#34;<a href="https://media.defense.gov/2022/Jan/25/2002927101/-1/-1/0/CSA_PROTECTING_VSAT_COMMUNICATIONS_01252022.PDF" target="_blank">Protecting VSAT Communications</a>&#34; which specifically referenced my 2018 research. </p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhWgC__lXhvh8faYn_xDtajjbuLEqYnC82s9T0lLsijwQycI7zlXW5H3HOf0X3ir-q3SKZ4RRAdOmWzMGXTiXte9mrNkNKoOH3wcuyrvqQNrmoe1wuIwW017Kp9xBiFgl9BxLxdCh48vVJu7TnAJL84CH2_YFXzQWNkLJ_Z1DpF2M3k_NMnjAJXDwAZIg=s1638"><img data-original-height="594" data-original-width="1638" height="223" src="https://blogger.googleusercontent.com/img/a/AVvXsEhWgC__lXhvh8faYn_xDtajjbuLEqYnC82s9T0lLsijwQycI7zlXW5H3HOf0X3ir-q3SKZ4RRAdOmWzMGXTiXte9mrNkNKoOH3wcuyrvqQNrmoe1wuIwW017Kp9xBiFgl9BxLxdCh48vVJu7TnAJL84CH2_YFXzQWNkLJ_Z1DpF2M3k_NMnjAJXDwAZIg=w615-h223" width="615"/></a></p></div><p>A permanent damage is also technically possible. In 2014, during the &#39;<a href="https://ioactive.com/pdfs/IOActive_SATCOM_Presentation_Black_Hat_2014.pdf" target="_blank">Wake Up call for SATCOM security</a>&#39; research I reverse engineered a proprietary protocol (Zing) implemented in certain Inmarsat BGAN terminals from Hughes, which allowed multiple privileged operations over the network, including the ability to modify the image of the FPGA controlling the antenna pointing. A successful exploitation rendered the terminal inoperable, pretty much the same scenario we are discussing.  In fact, at that time, I successfully tested this destructive attack against the <a href="https://www.hughes.com/what-we-offer/satellite-ground-systems/mobile-satellite-terminals/hughes-9201-bgan" target="_blank">Hughes 9201</a> terminal I bought for that research. </p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEg6BtemegRI7m6yRYhQ31NOODD7FTByuIDmm7OhZ4JYNxQCCw5wzHDFL3-ItrQdokQzdbfevcHIDJbeH4qy5StTto1W4BhpUW586hsYbJsTr6kpjAuculzkdUOtW51hy5YjbSKezApNnWozgaWgZP9eMzWfSlIJ11nRneoo_BKLAGJcu0r_GOVs5Ngllg=s1916"><img data-original-height="1062" data-original-width="1916" height="346" src="https://blogger.googleusercontent.com/img/a/AVvXsEg6BtemegRI7m6yRYhQ31NOODD7FTByuIDmm7OhZ4JYNxQCCw5wzHDFL3-ItrQdokQzdbfevcHIDJbeH4qy5StTto1W4BhpUW586hsYbJsTr6kpjAuculzkdUOtW51hy5YjbSKezApNnWozgaWgZP9eMzWfSlIJ11nRneoo_BKLAGJcu0r_GOVs5Ngllg=w625-h346" width="625"/></a></p></div><div><p>Despite all of these indications, I don&#39;t think this scenario completely represents what happened in Ukraine and the rest of the affected countries. Certainly, there is a chance that an undocumented feature/0day was  exploited but there are other aspects in the attack that do not match: the scale of the attack, the kind of affected systems and its geographical location.</p><p><u>4. A compromised Gateway Earth Station / Network Operations Center.</u></p><p>In the &#39;Last Call For SATCOM Security&#39;  research  (Pages 20-44) I elaborated a post-exploitation scenario for an airborne SATCOM terminal, intended to turn it into an intentional radiator. </p></div><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgd1m2HlD5icHwNNCpWT7wC25w2BX2UBazKe0Z3Hnl87k6XkmxJH6v_rJ9c48kLttNSR1lZOwuagEga1r3E4izhy-HrEzNc2IZDE0qvXFIcDkrQZvrKpBPyovXmoK8W2PEjT1uZryNUD14y5HArW48MN29VQa05g7pww5xmC1zJdbku7Oh_Cyk0MPhRBw=s1156"><img data-original-height="910" data-original-width="1156" height="434" src="https://blogger.googleusercontent.com/img/a/AVvXsEgd1m2HlD5icHwNNCpWT7wC25w2BX2UBazKe0Z3Hnl87k6XkmxJH6v_rJ9c48kLttNSR1lZOwuagEga1r3E4izhy-HrEzNc2IZDE0qvXFIcDkrQZvrKpBPyovXmoK8W2PEjT1uZryNUD14y5HArW48MN29VQa05g7pww5xmC1zJdbku7Oh_Cyk0MPhRBw=w552-h434" width="552"/></a></p><p>This attack required modifying the firmware to ignore certain specific messages coming from the NOC. </p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgn9ACaj6t3J4OweqsMWcuqep3JSPdy7HQyjhfG7pURBvmw--U5ovPWkI2s4qHIsffPVLJcWwCgqgdKXIRVookTOfYdskPW8QppsvTloAqJZqZ8onlo80RkTWeIH1yQ0E75lBjy0holg4-jxr4-ismKhc7-cPpb9BgBsiWuXQATirV-CKFcGsprkXD4LQ=s1334"><img data-original-height="1334" data-original-width="1286" height="506" src="https://blogger.googleusercontent.com/img/a/AVvXsEgn9ACaj6t3J4OweqsMWcuqep3JSPdy7HQyjhfG7pURBvmw--U5ovPWkI2s4qHIsffPVLJcWwCgqgdKXIRVookTOfYdskPW8QppsvTloAqJZqZ8onlo80RkTWeIH1yQ0E75lBjy0holg4-jxr4-ismKhc7-cPpb9BgBsiWuXQATirV-CKFcGsprkXD4LQ=w487-h506" width="487"/></a></p><p>For that research, I reverse engineered Hughes&#39; proprietary ICAP protocol, used to remotely control the SATCOM terminal from the NOC. The image below shows some of the implemented messages, which are self-explanatory in certain cases (i.e &#39;Enable/Disable transmit&#39;)</p><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEghnCpBj3c1QRUyWKSn55_BV-oV5oVc6G-f-2hu1i0Mieg8lVp3kLOgj6K5b2wrbVlweayJumgjga9uv8EsoSvuYKYQAdq6OjUgVVQcYsTI29mYmk39wYvOmsmTP2w5e8fGL8m5tcVRtTCTXxD54uHmX3bwvFG4bgWnnY77lLldZLjEtcauOLoscG0MLg=s1226"><img data-original-height="1146" data-original-width="1226" height="592" src="https://blogger.googleusercontent.com/img/a/AVvXsEghnCpBj3c1QRUyWKSn55_BV-oV5oVc6G-f-2hu1i0Mieg8lVp3kLOgj6K5b2wrbVlweayJumgjga9uv8EsoSvuYKYQAdq6OjUgVVQcYsTI29mYmk39wYvOmsmTP2w5e8fGL8m5tcVRtTCTXxD54uHmX3bwvFG4bgWnnY77lLldZLjEtcauOLoscG0MLg=w634-h592" width="634"/></a></p><div><p>I was controlling the SATCOM terminal, so my approach was to prevent the NOC from forcing the compromised SATCOM terminal to &#39;behave&#39; properly (in the context of an intentional radiator payload, terminals are designed in such a way that if you are not locked to the satellite, you shouldn&#39;t be transmitting). However, if you&#39;ve got the NOC under your control, you can achieve the opposite scenario, thus directly attacking the SATCOM terminals within your coverage. </p><p>I think that, maybe, what happened in Ukraine is similar to this scenario.</p></div><div><h2>Conclusion</h2><p>My theory is that attackers somehow managed to compromise/spoof the ground station/NOC in charge of those spot beams covering, at least, Ukraine. At a certain time they abused a legitimate control protocol to issue specific commands to the targeted SATCOM terminals, resulting in the claimed permanent damage. That request may involve disabling the transmitter, corrupting the antenna pointing logic, demod, power params...</p><p>I don&#39;t have access to a Surfbeam2 modem, but I found a <a href="https://rjmendez.github.io/posts/2018/09/rm4100-memdump/" target="_blank">writeup</a> of a researcher who dumped its firmware. After reading some of its contents, I&#39;m now even more convinced that there are multiple ways to permanently damage a KA-SAT SATCOM terminal...</p></div><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhJVeL_ViZxHepbzc-VXgk9fnY0L5pVP9wmuAjRXtQO_p63kVaevmGz0v6BWNxz5vbZCHGDNEg7SDlnttEAyb4ToV-fsgw62vBbtLOtHNwA0D4AFch6XxQKWU97u_-RHwpIymsUbxiCK7ZRxSGu-6P4MmF7ZUwTlRCPjBiskxsQgQPDTX_3fEScaWn0PA=s830"><img data-original-height="622" data-original-width="830" height="398" src="https://blogger.googleusercontent.com/img/a/AVvXsEhJVeL_ViZxHepbzc-VXgk9fnY0L5pVP9wmuAjRXtQO_p63kVaevmGz0v6BWNxz5vbZCHGDNEg7SDlnttEAyb4ToV-fsgw62vBbtLOtHNwA0D4AFch6XxQKWU97u_-RHwpIymsUbxiCK7ZRxSGu-6P4MmF7ZUwTlRCPjBiskxsQgQPDTX_3fEScaWn0PA=w531-h398" width="531"/></a></p><p>Finally, we should bear in mind that, as it has been explained, the KA-SAT infrastructure involves multiple interconnected gateways Earth Stations and a specific number of mappings between beams and gateways. As a result, I would say that probably the Enercon incident, and the disruption that occured in other european countries, were just a &#39;collateral damage&#39; derived from attacking the main target: Ukraine.</p></div>
</div>

</div></div>
  </body>
</html>
