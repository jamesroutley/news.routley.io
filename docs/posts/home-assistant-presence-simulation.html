<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/slashback100/presence_simulation">Original</a>
    <h1>Home Assistant Presence Simulation</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><em>Please ⭐ this repo if you find it useful</em></p>

<p dir="auto"><a href="https://github.com/hacs/integration"><img src="https://camo.githubusercontent.com/8f3b4deb8f6c11b8f563e6549a91e5af94b6241364792bc23d2d30578839ab0c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f484143532d44656661756c742d6f72616e67652e737667" alt="hacs_badge" data-canonical-src="https://img.shields.io/badge/HACS-Default-orange.svg"/></a></p>
<p dir="auto">This Home Assistant component aim to provide a presence simulation in your home while you are away. It will turn on &amp; off lights, switches, covers... based on your history.</p>

<p dir="auto">It will look in the DB for the states history of all the entities configured in the component for a period corresponding to a <code>delta</code> variable defined in the component.
It will apply to the entites the same state (and some attributes like brightness and rgb_color) as it was <code>delta</code> days ago, in order to simulate your presence.
If the service is running longer than the number of days defined as the <code>delta</code>, the component will simply be reset and start over, until the stop service is called.</p>
<p dir="auto">Supported entities domains:</p>
<ul dir="auto">
<li><code>light</code></li>
<li><code>cover</code></li>
<li><code>media_player</code></li>
<li>All domains for which entities have status <code>on</code> or <code>off</code> than can be turned on/off with service <code>homeassistant.turn_on</code> and <code>homeassistant.turn_off</code> (<code>automation</code>, <code>switch</code>, <code>group</code>...).</li>
</ul>

<p dir="auto">The <code>history</code> integration must be activated - <a href="https://www.home-assistant.io/integrations/history/" rel="nofollow">which it is by default</a>. The period kept in the DB should be bigger than the delta used in the simulation. The default number of days kept is 10 and this <a href="https://www.home-assistant.io/integrations/recorder/" rel="nofollow">can be configured</a> with the <code>recorder</code> integration.</p>

<ul dir="auto">
<li>Smart Home Junkie&#39;s English tutorial: <a href="https://youtu.be/OTQu3BMr3EU" rel="nofollow">https://youtu.be/OTQu3BMr3EU</a></li>
<li>Tristan&#39;s Smartes Heim&#39;s German tutorial: <a href="https://youtu.be/5vCp3iKZb4Q" rel="nofollow">https://youtu.be/5vCp3iKZb4Q</a></li>
<li>HectorziN Domótica&#39;s Spanish tutorial: <a href="https://youtu.be/2N7aihhnkNg" rel="nofollow">https://youtu.be/2N7aihhnkNg</a></li>
</ul>


<ul dir="auto">
<li>In your Home Assistant configuration directory (<code>~/.homeassistant</code> for instance), create a directory <code>custom_components/presence_simulation</code> and put the code in it.</li>
<li>Restart Home Assistant</li>
</ul>

<ul dir="auto">
<li>Go in your Home Assistant configuration directory (<code>~/.homeassistant</code> for instance)</li>
<li><code>git clone https://github.com/slashback100/presence_simulation.git</code>. It will create the directory <code>custom_components/presence_simulation</code></li>
<li>Restart Home Assistant</li>
</ul>

<ul dir="auto">
<li>Have <a href="https://hacs.xyz/" rel="nofollow">HACS</a> installed, this will allow you to easily manage and track updates.</li>
<li>You can either search for &#34;Presence Simulation&#34; or use this link <a href="https://my.home-assistant.io/redirect/hacs_repository/?repository=presence_simulation&amp;category=Integration&amp;owner=slashback100" rel="nofollow"><img src="https://camo.githubusercontent.com/8cec5af6ba93659beb5352741334ef3bbee70c4cb725f20832a1b897dfb8fc5f/68747470733a2f2f6d792e686f6d652d617373697374616e742e696f2f6261646765732f686163735f7265706f7369746f72792e737667" alt="Open your Home Assistant instance and open a repository inside the Home Assistant Community Store." data-canonical-src="https://my.home-assistant.io/badges/hacs_repository.svg"/></a>.</li>
<li>Click Install below the found integration.</li>
<li>Restart Home Assistant</li>
</ul>
<p dir="auto">NB: it can also be added as a custom repository if you have an issue with above procedure</p>

<ul dir="auto">
<li>In the UI, go in Configuration &gt; Integration (or click here <a href="https://my.home-assistant.io/redirect/integrations/" rel="nofollow"><img src="https://camo.githubusercontent.com/e92df511bc81280c59f187c087f876f52cdf4602d91a26a4041f95e0b7ddd83e/68747470733a2f2f6d792e686f6d652d617373697374616e742e696f2f6261646765732f696e746567726174696f6e732e737667" alt="Open your Home Assistant instance and show your integrations." data-canonical-src="https://my.home-assistant.io/badges/integrations.svg"/></a>)</li>
<li>Click on the &#39;+&#39; button</li>
<li>Search for &#34;Presence Simulation&#34;</li>
<li>Confirm:</li>
</ul>
<p dir="auto">
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/slashback100/presence_simulation/raw/main/custom_components/presence_simulation/images/configFlow.png"><img width="400px" src="https://github.com/slashback100/presence_simulation/raw/main/custom_components/presence_simulation/images/configFlow.png" alt="accessibility text"/></a>
</p>
<ul dir="auto">
<li>Set the entties or group of entities to be used in the simulation. It can be a group of lights, switches, covers, light groups, media_player or of any component that can be turned on and off with the service <code>homeassistant.turn_on</code> and <code>homeassistant.turn_off</code>. You can setup several entities. If you use a group, the simulation will act on each entity of the group independently.</li>
<li>Set the number of days of history the simulation will use (the delta)</li>
<li>Set the poll interval in seconds that determines how quickly the simulation notices that it has been requested to stop. Default is 30 seconds. Warning, the smaller the number you choose, the more computing process the component will take.</li>
<li>After the simulation, choose to restore the states as they were before the start of ths simulation</li>
<li>You can choose to randomize the activation/deactivation of your entities. &#39;0&#39; to disable this behaviour, a positive number (representing a number of seconds) to activate the behaviour. A random number of seconds limited to this parameter is added to (or substracted from) the time the entity was actually switched on or off in your historical data.</li>
<li>You can choose to consider &#39;Unavailable&#39; states as &#39;Off&#39; state (needed for some devices that are unavailable instead of off)</li>
</ul>
<p dir="auto">You can edit these configurations afterwards by clicking on Options in the integration screen.</p>
<p dir="auto"><em>New in version 4.0</em> You can create several presence simulation switches, associate them to different configurations (entities, random feature...) and turn them on and off independently.</p>

<p dir="auto">The component will create an entity with a name computed from the name you choosed (<code>switch.presence_simulation</code> for example). This entity will be set to <code>on</code> when the simulation is running. <code>off</code> otherwise.
You have 2 ways of launching the simulation:</p>

<p dir="auto">Toggling the switch (<code>switch.presence_simulation</code> for example) will toggle the presence simulation.</p>

<p dir="auto">Three services are available:</p>

<p dir="auto">The service <code>presence_simulation.start</code> will start the simulation and set the referenced presence simulation switch entity to <code>on</code>.</p>
<p dir="auto"><g-emoji alias="warning">⚠️</g-emoji> From v4, the parameter <code>switch_id</code> is mandatory <em>if you have several switches</em>. It should be the name of the switch you want to turn on.
Optionally, you can reference a list of entities, a delta, choose to restore the states or set a random offset if you want to override the presence simulation switch configuration:</p>
<div data-snippet-clipboard-copy-content="switch_id: switch.presence_simulation
entity_id:
  - group.outside_lights
  - light.living_room
  - light.hall
delta: 5
restore_states: True
random: 300"><pre><code>switch_id: switch.presence_simulation
entity_id:
  - group.outside_lights
  - light.living_room
  - light.hall
delta: 5
restore_states: True
random: 300
</code></pre></div>

<p dir="auto">The service <code>presence_simulation.stop</code> will stop the simulation and set the <code>switch.presence_simulation</code> entity to <code>off</code>.</p>
<p dir="auto"><g-emoji alias="warning">⚠️</g-emoji> From v4, the parameter <code>switch_id</code> is mandatory <em>if you have several switches</em>. It should be the name of the switch you want to turn off.</p>

<p dir="auto">The service <code>presence_simulation.toggle</code> will start or stop the simulation, depending on the current state of the switch entity.</p>
<p dir="auto"><g-emoji alias="warning">⚠️</g-emoji> From v4, the parameter <code>switch_id</code> is mandatory <em>if you have several switches</em>. It should be the name of the switch you want to toggle.</p>

<p dir="auto">Each time the simulation calls a service (turn on a light, open a cover, ...), an event <code>presence_simulation_change</code> is fired. You can catch this event in an automation, to notify you for instance.</p>

<p dir="auto">Liked some of my work? Buy me a coffee (or more likely a beer)</p>
<p dir="auto"><a href="https://www.buymeacoffee.com/slashback" rel="nofollow"><img src="https://camo.githubusercontent.com/4c31625833b2598a9acf63a0a82416a0621a93d5d4f5aa285eef92593e5ebc42/68747470733a2f2f626d632d63646e2e6e7963332e6469676974616c6f6365616e7370616365732e636f6d2f424d432d627574746f6e2d696d616765732f637573746f6d5f696d616765732f6f72616e67655f696d672e706e67" alt="Buy Me A Coffee" data-canonical-src="https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/custom_images/orange_img.png"/></a></p>
</article></div></div>
  </body>
</html>
