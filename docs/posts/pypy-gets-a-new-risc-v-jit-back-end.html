<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pypy.org/posts/2024/08/pypy-v7317-release.html">Original</a>
    <h1>PyPy gets a new RISC-V JIT back end</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody text">
      <section id="pypy-v7-3-17-release-of-python-2-7-and-3-10"><h2>PyPy v7.3.17: release of python 2.7 and 3.10<a href="#pypy-v7-3-17-release-of-python-2-7-and-3-10" title="Permalink to this heading">¶</a></h2>
<p>The PyPy team is proud to release version 7.3.17 of PyPy.</p>
<p>This release includes a new <a href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#risc-v-jit-backend">RISC-V JIT backend</a>, an <a href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#improved-repl">improved REPL</a> based on
work by the CPython team, and <a href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#better-jit-optimizations">better JIT optimizations</a> of integer
operations. Special shout-outs to <a href="https://github.com/loganchien">Logan Chien</a> for the <a href="https://github.com/pypy/pypy/pull/5002">RISC-V backend
work</a>, to <a href="https://github.com/nirit100">Nico Rittinghaus</a> for better integer optimization in the JIT, and
the CPython team that has worked on the repl.</p>
<p>The release includes two different interpreters:</p>
<ul>
<li><p>PyPy2.7, which is an interpreter supporting the syntax and the features of
Python 2.7 including the stdlib for CPython 2.7.18+ (the <code>+</code> is for
backported security updates)</p></li>
<li><p>PyPy3.10, which is an interpreter supporting the syntax and the features of
Python 3.10, including the stdlib for CPython 3.10.14.</p></li>
</ul>
<p>The interpreters are based on much the same codebase, thus the dual
release. This is a micro release, all APIs are compatible with the other 7.3
releases. It follows after 7.3.16 release on April 23, 2024.</p>
<p>We recommend updating. You can find links to download the releases here:</p>
<blockquote>
<p><a href="https://pypy.org/download.html">https://pypy.org/download.html</a></p>
</blockquote>
<p>We would like to thank our donors for the continued support of the PyPy
project. If PyPy is not quite good enough for your needs, we are available for
<a href="https://www.pypy.org/pypy-sponsors.html">direct consulting</a> work. If PyPy is helping you out, we would love to hear
about it and encourage submissions to our <a href="https://pypy.org/blog">blog</a> via a pull request
to <a href="https://github.com/pypy/pypy.org">https://github.com/pypy/pypy.org</a></p>
<p>We would also like to thank our contributors and encourage new people to join
the project. PyPy has many layers and we need help with all of them: bug fixes,
<a href="https://pypy.org/posts/2024/08/index.html">PyPy</a> and <a href="https://rpython.readthedocs.org">RPython</a> documentation improvements, or general <a href="https://pypy.org/posts/2024/08/project-ideas.html">help</a> with
making RPython&#39;s JIT even better.</p>
<p>If you are a python library maintainer and use C-extensions, please consider
making a <a href="https://hpyproject.org/">HPy</a> / <a href="https://cffi.readthedocs.io">CFFI</a> / <a href="https://cppyy.readthedocs.io">cppyy</a> version of your library that would be performant
on PyPy. In any case, both <a href="https://github.com/joerick/cibuildwheel">cibuildwheel</a> and the <a href="https://github.com/matthew-brett/multibuild">multibuild system</a> support
building wheels for PyPy.</p>
<section id="risc-v-backend-for-the-jit"><span id="risc-v-jit-backend"></span><h3>RISC-V backend for the JIT<a href="#risc-v-backend-for-the-jit" title="Permalink to this heading">¶</a></h3>
<p>PyPy&#39;s JIT has added support for generating 64-bit RISC-V machine code at
runtime (RV64-IMAD, specifically). So far we are not releasing binaries for any
RISC-V platforms, but there are <a href="https://rpython.readthedocs.io/en/latest/riscv.html">instructions</a> on how to cross-compile binaries.</p>
</section><section id="repl-improvements"><span id="improved-repl"></span><h3>REPL Improvements<a href="#repl-improvements" title="Permalink to this heading">¶</a></h3>
<p>The biggest user-visible change of the release is new features in the repl of
PyPy3.10. CPython 3.13 has adopted and extended PyPy&#39;s pure-Python repl, adding
a number of features and fixing a number or bugs in the process. We have
backported and added the following features:</p>
<ul>
<li><p>Prompts and tracebacks use terminal colors, as well as <a href="https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda">terminal hyperlinks</a>
for file names.</p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Bracketed-paste">Bracketed paste</a> enable pasting several lines of input into the terminal
without auto-indentation getting in the way.</p></li>
<li><p>A special interactive help browser (F1), history browser (F2), explicit paste
mode (F3).</p></li>
<li><p>Support for Ctrl-&lt;left/right&gt; to jump over whole words at a time.</p></li>
</ul>
<p>See the <a href="https://docs.python.org/3.13/whatsnew/3.13.html#a-better-interactive-interpreter">CPython documentation for further details</a>. Thanks to Łukasz Langa,
Pablo Galindo Salgado and the other CPython devs involved in this work.</p>
</section><section id="better-jit-optimizations-of-integer-operations"><span id="better-jit-optimizations"></span><h3>Better JIT optimizations of integer operations<a href="#better-jit-optimizations-of-integer-operations" title="Permalink to this heading">¶</a></h3>
<p>The optimizers of PyPy&#39;s JIT have become much better at reasoning about and
optimizing integer operations. This is done with a new <a href="https://pypy.org/posts/2024/08/toy-knownbits.html">&#34;knownbits&#34; abstract
domain</a>. In many programs that do bit-manipulation of integers, some of the
bits of the integer variables of the program can be statically known. Here&#39;s a
simple example:</p>
<div><pre><a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-1" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-1" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-1"></a><span>x</span> <span>=</span> <span>a</span> <span>|</span> <span>1</span>
<a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-2" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-2" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-2"></a><span>...</span>
<a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-3" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-3" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-3"></a><span>if</span> <span>x</span> <span>&amp;</span> <span>1</span><span>:</span>
<a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-4" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-4" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-4"></a>    <span>...</span>
<a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-5" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-5" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-5"></a><span>else</span><span>:</span>
<a id="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-6" name="rest_code_eca6db629fd844478a4ee5bd2ccb11fc-6" href="https://pypy.org/posts/2024/08/pypy-v7317-release.html#rest_code_eca6db629fd844478a4ee5bd2ccb11fc-6"></a>    <span>...</span>
</pre></div>
<p>With the new abstract domain, the JIT can optimize the <code>if</code>-condition to
<code>True</code>, because it already knows that the lowest bit of <code>x</code> must be set.
This optimization applies to all Python-integers that fit into a machine word
(PyPy optimistically picks between two different representations for <code>int</code>,
depending on the size of the value). Unfortunately there is very little impact
of this change on almost all Python code, because intensive bit-manipulation is
rare in Python. However, the change leads to significant performance
improvements in <a href="https://docs.pydrofoil.org/en/latest/">Pydrofoil</a> (the RPython-based RISC-V/ARM emulators that are
automatically generated from high-level <a href="https://github.com/rems-project/sail/">Sail</a> specifications of the respective
ISAs, and that use the RPython JIT to improve performance).</p>
</section><section id="pypy-versions-and-speed-pypy-org"><h3>PyPy versions and speed.pypy.org<a href="#pypy-versions-and-speed-pypy-org" title="Permalink to this heading">¶</a></h3>
<p>The keen-eyed will have noticed no mention of Python version 3.9 in the
releases above. Typically we will maintain only one version of Python3, but due
to PyPy3.9 support on conda-forge we maintained multiple versions from the
first release of PyPy3.10 in PyPy v7.3.12 (Dec 2022). Conda-forge is
<a href="https://pypy.org/posts/2024/08/conda-forge-proposes-dropping-support-for-pypy.html">sunsetting its PyPy support</a>, which means we can drop PyPy3.9. Since that was
the major driver of benchmarks at <a href="https://speed.pypy.org">https://speed.pypy.org</a>, we revamped the site
to showcase PyPy3.9, PyPy3.10, and various versions of cpython on the home
page. For historical reasons, the &#34;baseline&#34; for comparison is still cpython
3.7.19.</p>
<p>We will keep the buildbots building PyPY3.9 until the end of August, these
builds will still be available on the <a href="https://buildbot.pypy.org/nightly/">nightly builds</a> tab of the buildbot.</p>
</section><section id="what-is-pypy"><h3>What is PyPy?<a href="#what-is-pypy" title="Permalink to this heading">¶</a></h3>
<p>PyPy is a Python interpreter, a drop-in replacement for CPython
It&#39;s fast (<a href="https://speed.pypy.org">PyPy and CPython</a> performance
comparison) due to its integrated tracing JIT compiler.</p>
<p>We also welcome developers of other <a href="https://rpython.readthedocs.io/en/latest/examples.html">dynamic languages</a> to see what RPython
can do for them.</p>
<p>We provide binary builds for:</p>
<ul>
<li><p><strong>x86</strong> machines on most common operating systems
(Linux 32/64 bits, Mac OS 64 bits, Windows 64 bits)</p></li>
<li><p>64-bit <strong>ARM</strong> machines running Linux (<code>aarch64</code>) and macos (<code>macos_arm64</code>).</p></li>
</ul>
<p>PyPy supports Windows 32-bit, Linux PPC64 big- and little-endian, Linux ARM
32 bit, RISC-V RV64IMAFD Linux, and s390x Linux but does not release binaries.
Please reach out to us if you wish to sponsor binary releases for those
platforms. Downstream packagers provide binary builds for debian, Fedora,
conda, OpenBSD, FreeBSD, Gentoo, and more.</p>
</section><section id="what-else-is-new"><h3>What else is new?<a href="#what-else-is-new" title="Permalink to this heading">¶</a></h3>
<p>For more information about the 7.3.17 release, see the <a href="https://doc.pypy.org/en/latest/release-v7.3.17.html#changelog">full changelog</a>.</p>
<p>Please update, and continue to help us make pypy better.</p>
<p>Cheers,
The PyPy Team</p>
</section></section>
</div></div>
  </body>
</html>
