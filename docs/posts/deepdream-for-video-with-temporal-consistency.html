<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/jeremicna/deepdream-video-pytorch">Original</a>
    <h1>Show HN: DeepDream for Video with Temporal Consistency</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">This is a fork of <a href="https://github.com/ProGamerGov/neural-dream">neural-dream</a>, a PyTorch implementation of DeepDream. This fork introduces <strong>optical flow estimation</strong> and <strong>occlusion masking</strong> to apply DeepDream to videos with temporal consistency.</p>

<ul dir="auto">
<li><strong>Standard DeepDream</strong>: The original single-image implementation.</li>
<li><strong>Video DeepDream</strong>: New CLI (<code>video_dream.py</code>) that uses RAFT Optical Flow to warp previous dream frames into the current frame, ensuring smooth transitions and object tracking.</li>
<li><strong>Occlusion Masking</strong>: Automatically detects when objects move in front of one another to prevent &#34;ghosting&#34; artifacts.</li>
</ul>

<div dir="auto"><h3 tabindex="-1" dir="auto">With temporal consistency</h3><a id="user-content-with-temporal-consistency" aria-label="Permalink: With temporal consistency" href="#with-temporal-consistency"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>mallard_demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531395410-0f3302a1-d670-45dd-afb6-5a99b561e0f6.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzEzOTU0MTAtMGYzMzAyYTEtZDY3MC00NWRkLWFmYjYtNWE5OWI1NjFlMGY2Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE2MTU3NWE4ODZhOGRlY2E2ZTk4ZWM5NDI4YjVkYmIzYjRiM2QzOTYxMDQ0YzU3ZWZmZjUyMWI0NDljYmQ1M2UmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gfZWjU6bqMiu-W0AOtmAQIT8J7e44F9kOUr0zlmPoxU" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531395410-0f3302a1-d670-45dd-afb6-5a99b561e0f6.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzEzOTU0MTAtMGYzMzAyYTEtZDY3MC00NWRkLWFmYjYtNWE5OWI1NjFlMGY2Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE2MTU3NWE4ODZhOGRlY2E2ZTk4ZWM5NDI4YjVkYmIzYjRiM2QzOTYxMDQ0YzU3ZWZmZjUyMWI0NDljYmQ1M2UmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gfZWjU6bqMiu-W0AOtmAQIT8J7e44F9kOUr0zlmPoxU" controls="controls" muted="muted">

  </video>
</details>

<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>highway_demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531395806-e7630c8c-3ed9-4b42-bba9-a666338a1784.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzEzOTU4MDYtZTc2MzBjOGMtM2VkOS00YjQyLWJiYTktYTY2NjMzOGExNzg0Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk4Yzk5ZjAxZGI4ZTgxYjQ1Y2I4ZTNlMWRmZTVlZmExMDc0ZGUxOTUxY2ZiZjZkYTc0NWZlNGZkYWE3MmFhMzMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.z_B8Jl54tCJEQxdY1zd3IXdPO90l1MCTEF7ckNPHAoc" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531395806-e7630c8c-3ed9-4b42-bba9-a666338a1784.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzEzOTU4MDYtZTc2MzBjOGMtM2VkOS00YjQyLWJiYTktYTY2NjMzOGExNzg0Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk4Yzk5ZjAxZGI4ZTgxYjQ1Y2I4ZTNlMWRmZTVlZmExMDc0ZGUxOTUxY2ZiZjZkYTc0NWZlNGZkYWE3MmFhMzMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.z_B8Jl54tCJEQxdY1zd3IXdPO90l1MCTEF7ckNPHAoc" controls="controls" muted="muted">

  </video>
</details>

<div dir="auto"><h3 tabindex="-1" dir="auto">With frames processed independently</h3><a id="user-content-with-frames-processed-independently" aria-label="Permalink: With frames processed independently" href="#with-frames-processed-independently"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>mallard_independent_demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531548554-11eb095b-9c8a-4a5c-ac7b-d1e669682bb3.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg1NTQtMTFlYjA5NWItOWM4YS00YTVjLWFjN2ItZDFlNjY5NjgyYmIzLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3YzAwMWM4MGY2MTQ4ZWUxZmQxMGU3NmI3YjcxZTE3MGM3NjJiZThjZWU3MzAyMjQyZjJiMTg4YmRhZTY2Y2ImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.v0WuFhmfO5i84-lCIJWzDsfk4ZYOH_LCZoggtI-H0GM" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531548554-11eb095b-9c8a-4a5c-ac7b-d1e669682bb3.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg1NTQtMTFlYjA5NWItOWM4YS00YTVjLWFjN2ItZDFlNjY5NjgyYmIzLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3YzAwMWM4MGY2MTQ4ZWUxZmQxMGU3NmI3YjcxZTE3MGM3NjJiZThjZWU3MzAyMjQyZjJiMTg4YmRhZTY2Y2ImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.v0WuFhmfO5i84-lCIJWzDsfk4ZYOH_LCZoggtI-H0GM" controls="controls" muted="muted">

  </video>
</details>

<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>highway_independent_demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531548564-7c560487-9ab4-4f69-ace2-7221d7ff1edb.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg1NjQtN2M1NjA0ODctOWFiNC00ZjY5LWFjZTItNzIyMWQ3ZmYxZWRiLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTExMjdiNmM0ZDg4NzE5ZmI0MDRiZmExMWQ0ZGFhZWI5OTllMGFlNjNiNDQxNDlkM2JiMWZjYmYyYmJjNWJkMDkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.6vtpIz-sBZyJDpRlRAx_Hj1W9P4doUaTTluWB1l3yew" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531548564-7c560487-9ab4-4f69-ace2-7221d7ff1edb.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg1NjQtN2M1NjA0ODctOWFiNC00ZjY5LWFjZTItNzIyMWQ3ZmYxZWRiLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTExMjdiNmM0ZDg4NzE5ZmI0MDRiZmExMWQ0ZGFhZWI5OTllMGFlNjNiNDQxNDlkM2JiMWZjYmYyYmJjNWJkMDkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.6vtpIz-sBZyJDpRlRAx_Hj1W9P4doUaTTluWB1l3yew" controls="controls" muted="muted">

  </video>
</details>


<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>mallard.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531548786-1c6bec63-078d-4817-86a4-a50716b7e4ec.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg3ODYtMWM2YmVjNjMtMDc4ZC00ODE3LTg2YTQtYTUwNzE2YjdlNGVjLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI1YmE0YWQ5M2UwMTJhODdhOTE5YjhlNjRiZDg2ZDJhNzg3ZjJhZjVmMmE4YTJlNjQ3MTkwYmJlZWU5NzllMTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.g-xEQmty_YYGJoa8DH2B18vmeojNxkrvEeqs1Z0qW0o" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531548786-1c6bec63-078d-4817-86a4-a50716b7e4ec.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg3ODYtMWM2YmVjNjMtMDc4ZC00ODE3LTg2YTQtYTUwNzE2YjdlNGVjLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI1YmE0YWQ5M2UwMTJhODdhOTE5YjhlNjRiZDg2ZDJhNzg3ZjJhZjVmMmE4YTJlNjQ3MTkwYmJlZWU5NzllMTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.g-xEQmty_YYGJoa8DH2B18vmeojNxkrvEeqs1Z0qW0o" controls="controls" muted="muted">

  </video>
</details>

<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span>highway.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/69542758/531548799-57f80cd1-24f3-410a-b44c-61d74bae4ae1.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg3OTktNTdmODBjZDEtMjRmMy00MTBhLWI0NGMtNjFkNzRiYWU0YWUxLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZlZDNmZGQxYjk1OTcxYjFjYmVkZjEzN2ViYTkzNzQxOTIyZTdhOWJhMGE2NmMzNWFjZDc0ZTkyZTkzOWFiMzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.RHlBTmUDhRd_G7KGxx8PD9VEHb7ouAG8B0BVlPLlgIg" data-canonical-src="https://private-user-images.githubusercontent.com/69542758/531548799-57f80cd1-24f3-410a-b44c-61d74bae4ae1.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njc5MDQyMTMsIm5iZiI6MTc2NzkwMzkxMywicGF0aCI6Ii82OTU0Mjc1OC81MzE1NDg3OTktNTdmODBjZDEtMjRmMy00MTBhLWI0NGMtNjFkNzRiYWU0YWUxLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTA4VDIwMjUxM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZlZDNmZGQxYjk1OTcxYjFjYmVkZjEzN2ViYTkzNzQxOTIyZTdhOWJhMGE2NmMzNWFjZDc0ZTkyZTkzOWFiMzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.RHlBTmUDhRd_G7KGxx8PD9VEHb7ouAG8B0BVlPLlgIg" controls="controls" muted="muted">

  </video>
</details>



<p dir="auto">This project requires the following key packages:</p>
<ul dir="auto">
<li><strong>PyTorch</strong></li>
<li><strong>torchvision</strong></li>
<li><strong>OpenCV</strong></li>
<li><strong>NumPy</strong></li>
<li><strong>Pillow</strong></li>
</ul>
<p dir="auto"><strong>Install Dependencies</strong>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="pip install -r requirements.txt"><pre>pip install -r requirements.txt</pre></div>
<p dir="auto"><strong>Download Models</strong>:
Run the download script to fetch the standard Inception/GoogLeNet models:</p>
<div dir="auto" data-snippet-clipboard-copy-content="python models/download_models.py"><pre>python models/download_models.py</pre></div>
<p dir="auto">To download all compatible models:</p>
<div dir="auto" data-snippet-clipboard-copy-content="python models/download_models.py -models all-caffe-googlenet"><pre>python models/download_models.py -models all-caffe-googlenet</pre></div>


<p dir="auto">To dream on a video, use the <code>video_dream.py</code> script. This wrapper accepts specific video arguments <strong>and</strong> any argument accepted by the standard image dreamer (e.g., layers, octaves, iterations).</p>
<p dir="auto"><strong>Basic Video Command:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="python video_dream.py -content_video input.mp4 -output_video output.mp4 -num_iterations 1"><pre>python video_dream.py -content_video input.mp4 -output_video output.mp4 -num_iterations 1</pre></div>
<p dir="auto"><strong>Note:</strong> For video processing, <strong>we recommend using <code>-num_iterations 1</code></strong>. The temporal consistency from optical flow means each frame builds on the previous dream, so fewer iterations per frame are needed compared to single images.</p>
<p dir="auto"><strong>Video-Specific Arguments:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Argument</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-content_video</code></td>
<td><code>input.mp4</code></td>
<td>Path to the source video file.</td>
</tr>
<tr>
<td><code>-output_video</code></td>
<td><code>output.mp4</code></td>
<td>Path where the final video will be saved.</td>
</tr>
<tr>
<td><code>-blend</code></td>
<td><code>0.5</code></td>
<td><strong>(0.0 - 1.0)</strong>: Mix ratio between the raw video frame and the warped previous dream. Higher values (closer to 1.0) use more of the raw frame; lower values (closer to 0.0) preserve more of the previous hallucinations.</td>
</tr>
<tr>
<td><code>-independent</code></td>
<td><code>False</code></td>
<td><strong>Flag</strong>: If set, disables temporal consistency (Optical Flow). Every frame is dreamed on independently (causes flickering).</td>
</tr>
<tr>
<td><code>-update_interval</code></td>
<td><code>5</code></td>
<td>Updates the output video file on disk every N frames (allows you to preview progress while running).</td>
</tr>
<tr>
<td><code>-temp_dir</code></td>
<td><code>temp</code></td>
<td>Directory to store extracted frames, flow data, and masks during processing.</td>
</tr>
<tr>
<td><code>-keep_temp</code></td>
<td><code>False</code></td>
<td><strong>Flag</strong>: If set, the temporary directory is not deleted after processing finishes.</td>
</tr>
<tr>
<td><code>-verbose</code></td>
<td><code>False</code></td>
<td><strong>Flag</strong>: Enable detailed logs (prints DeepDream iteration logs for every frame).</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>
<div dir="auto"><h3 tabindex="-1" dir="auto">2. Standard DeepDream Arguments</h3><a id="user-content-2-standard-deepdream-arguments" aria-label="Permalink: 2. Standard DeepDream Arguments" href="#2-standard-deepdream-arguments"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">All of the following arguments are from the single frame implementation, and you can mix and match any of these with the video-specific arguments above. Refer to <a href="https://github.com/ProGamerGov/neural-dream">neural-dream</a> for more information on single frame parameters.</p>
<p dir="auto"><strong>Example combining video and standard args:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="python video_dream.py -content_video test.mp4 -dream_layers inception_4d -num_iterations 1 -octave_scale 0.7 -image_size 512"><pre>python video_dream.py -content_video test.mp4 -dream_layers inception_4d -num_iterations 1 -octave_scale 0.7 -image_size 512</pre></div>
<p dir="auto"><strong>For single image processing only:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="python neural_dream.py -content_image &lt;image.jpg&gt; -dream_layers inception_4c -num_iterations 10"><pre>python neural_dream.py -content_image <span>&lt;</span>image.jpg<span>&gt;</span> -dream_layers inception_4c -num_iterations 10</pre></div>
<p dir="auto"><strong>Note</strong>: Paths to images should not contain the <code>~</code> character; use relative or absolute paths.</p>

<ul dir="auto">
<li><code>-image_size</code>: Maximum side length (in pixels) of the generated image. Default is 512.</li>
<li><code>-gpu</code>: Zero-indexed ID of the GPU to use; for CPU mode set <code>-gpu</code> to <code>c</code>; for MPS mode (Apple Silicon) set <code>-gpu</code> to <code>mps</code>.</li>
</ul>

<ul dir="auto">
<li><code>-dream_weight</code>: How much to weight DeepDream. Default is <code>1e3</code>.</li>
<li><code>-tv_weight</code>: Weight of total-variation (TV) regularization; helps smooth the image. Default <code>0</code>.</li>
<li><code>-l2_weight</code>: Weight of latent state regularization. Default <code>0</code>.</li>
<li><code>-num_iterations</code>: Number of iterations. Default is <code>10</code>. <strong>For video, use <code>1</code></strong> (temporal consistency reduces the need for multiple iterations per frame).</li>
<li><code>-init</code>: Initialization method: <code>image</code> (content image) or <code>random</code> (noise). Default <code>image</code>.</li>
<li><code>-jitter</code>: Apply jitter to image. Default <code>32</code>.</li>
<li><code>-layer_sigma</code>: Apply gaussian blur to image. Default <code>0</code> (disabled).</li>
<li><code>-optimizer</code>: <code>lbfgs</code> or <code>adam</code>. Default <code>adam</code>.</li>
<li><code>-learning_rate</code>: Learning rate (step size). Default <code>1.5</code>.</li>
<li><code>-normalize_weights</code>: Divide dream weights by the number of channels.</li>
<li><code>-loss_mode</code>: Loss mode: <code>bce</code>, <code>mse</code>, <code>mean</code>, <code>norm</code>, or <code>l2</code>. Default <code>l2</code>.</li>
</ul>

<ul dir="auto">
<li><code>-output_image</code>: Name of the output image. Default <code>out.png</code>.</li>
<li><code>-output_start_num</code>: Number to start output image names at. Default <code>1</code>.</li>
<li><code>-print_iter</code>: Print progress every N iterations.</li>
<li><code>-save_iter</code>: Save image every N iterations.</li>
</ul>

<ul dir="auto">
<li><code>-dream_layers</code>: Comma-separated list of layer names to use.</li>
<li><code>-channels</code>: Comma-separated list of channels to use.</li>
<li><code>-channel_mode</code>: Selection mode: <code>all</code>, <code>strong</code>, <code>avg</code>, <code>weak</code>, or <code>ignore</code>.</li>
<li><code>-channel_capture</code>: <code>once</code> or <code>octave_iter</code>.</li>
</ul>

<ul dir="auto">
<li><code>-num_octaves</code>: Number of octaves per iteration. Default <code>4</code>.</li>
<li><code>-octave_scale</code>: Resize value. Default <code>0.6</code>.</li>
<li><code>-octave_iter</code>: Iterations (steps) per octave. Default <code>50</code>.</li>
<li><code>-octave_mode</code>: <code>normal</code>, <code>advanced</code>, <code>manual_max</code>, <code>manual_min</code>, or <code>manual</code>.</li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Laplacian Pyramid Options</h4><a id="user-content-laplacian-pyramid-options" aria-label="Permalink: Laplacian Pyramid Options" href="#laplacian-pyramid-options"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><code>-lap_scale</code>: Number of layers in laplacian pyramid. Default <code>0</code> (disabled).</li>
<li><code>-sigma</code>: Strength of gaussian blur in pyramids. Default <code>1</code>.</li>
</ul>

<ul dir="auto">
<li><code>-zoom</code>: Amount to zoom in.</li>
<li><code>-zoom_mode</code>: <code>percentage</code> or <code>pixel</code>.</li>
<li><code>-tile_size</code>: Desired tile size. Default <code>0</code> (disabled).</li>
<li><code>-overlap_percent</code>: Percentage of overlap for tiles. Default <code>50</code>.</li>
</ul>

<ul dir="auto">
<li><code>-original_colors</code>: Set to <code>1</code> to keep content image colors.</li>
<li><code>-model_file</code>: Path to <code>.pth</code> file. Default is VGG-19.</li>
<li><code>-model_type</code>: <code>caffe</code>, <code>pytorch</code>, <code>keras</code>, or <code>auto</code>.</li>
<li><code>-backend</code>: <code>nn</code>, <code>cudnn</code>, <code>openmp</code>, or <code>mkl</code>.</li>
<li><code>-cudnn_autotune</code>: Use built-in cuDNN autotuner (slower start, faster run).</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Frequently Asked Questions</h2><a id="user-content-frequently-asked-questions" aria-label="Permalink: Frequently Asked Questions" href="#frequently-asked-questions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Problem: The program runs out of memory (OOM)</strong>
<strong>Solution:</strong></p>
<ol dir="auto">
<li>Reduce <code>-image_size</code> (e.g., to 512 or 256).</li>
<li>If using GPU, use <code>-backend cudnn</code>.</li>
<li>For video: Reduce the input video resolution before processing.</li>
</ol>
<p dir="auto"><strong>Problem: Video processing is very slow</strong>
<strong>Solution:</strong>
Video DeepDreaming is computationally expensive. It runs the full DeepDream process <em>per frame</em>, plus Optical Flow calculations.</p>
<ul dir="auto">
<li><strong>Use <code>-num_iterations 1</code></strong> (recommended for video; temporal consistency means fewer iterations are needed).</li>
<li>Reduce <code>-octave_iter</code> (e.g., to 10 or 20).</li>
<li>Use a smaller <code>-image_size</code>.</li>
</ul>

<p dir="auto">By default, <code>neural-dream</code> uses the <code>nn</code> backend.</p>
<ul dir="auto">
<li><strong>Use cuDNN</strong>: <code>-backend cudnn</code> (GPU only, reduces memory).</li>
<li><strong>Reduce Size</strong>: <code>-image_size 256</code> (Halves memory usage).</li>
</ul>
<p dir="auto">With default settings, standard execution uses ~1.3 GB GPU memory.</p>

<p dir="auto">You can use multiple devices with <code>-gpu</code> and <code>-multidevice_strategy</code>.
Example: <code>-gpu 0,1,2,3 -multidevice_strategy 3,6,12</code> splits layers across 4 GPUs. See <a href="https://github.com/ProGamerGov/neural-dream#multi-gpu-scaling">ProGamerGov/neural-dream</a> for details.</p>
</article></div></div>
  </body>
</html>
