<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/VadimYuryev/status/1514295682777059329">Original</a>
    <h1>Apple&#39;s M1 Ultra comes with a 32MB TLB bottleneck</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-56095" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295682777059329" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="44" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:19.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295682777059329" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295682777059329" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__lqgqhae919 id__8hhkjiwmof id__lue5mzj60ot id__u9nn5ci0qus id__z19bhdemn2j id__9rq6qg6ker6 id__p9aytvxpxdk id__ik02n9ozvqf id__yiz24fcwako id__lojllapgwp id__dflf71pda1t id__biu8krfhp6 id__n5da87kw5vn id__3fuwj77g4gb id__embvd12hw5t id__6n8rfh59txr" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__9rq6qg6ker6"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody"><div><div lang="en" dir="auto" id="id__dflf71pda1t"><p><span>Exclusive: Apple&#39;s M1 family of chips comes with a design limitation that was overlooked by Apple engineers when they started working on the chips 5-7 years ago. 

The bottleneck is the 32MB TLB. Thank you to </span></p><p><span> for the help in explaining how it works.

Let me explain.. </span><span>ðŸ§µ</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295684844830724" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:20.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:20.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295684844830724" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295682777059329" itemprop="isPartOf"/><div><article aria-labelledby="id__yndh0dt9qaj id__wonmc2j123i id__g3b6ey0tpw id__webtoeqfizj id__6ou24w8udap id__jbhh1omtyb id__0l6j76haqaeq id__23zf6t9t5yx id__mdw4dede0vg id__u9c3vcs9tq id__g29et12dqy7 id__6fk8huhq4wr id__ygbaojh73xb id__o3ow6bnaik id__voj6c2olcmk id__ixyogjmacbe" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__jbhh1omtyb"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Problem: Apple shows that the M1 Ultra GPU can use up to 105W of power. However, the highest we could ever get it to reach was around 86W.

No, the Mac Studio cooling wasn&#39;t a problem because the GPU stayed cool, around 55-58Â°C compared to in the past when Apple allowed 100Â°C.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295686589677569" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:20.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:20.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295686589677569" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295684844830724" itemprop="isPartOf"/><div><article aria-labelledby="id__obpfbxi82l8 id__hkirs43vy2o id__3oq0ljj30ch id__zxm6fyvv79 id__ehwpo4p4cs id__tkvchyel9oq id__xpzcq0yspbl id__dgq9nftqz4d id__i6hjvh9krsp id__lk3zx5d0s2 id__5wwrfnoj22j id__reqi65rndyj id__uemt1nvmi3l id__dkjroapzyaq id__6sbyo8m8cin id__9fd47wt5z" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__tkvchyel9oq"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>This makes it pretty clear that the Mac Studio cooling system is OVERKILL in most apps, which means that there was a disconnect between Apple&#39;s Mac Studio cooling system engineers and the M1 Ultra chip designers/engineers. Something has gone terribly wrong in terms of chip perf.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295688326103040" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:21.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295688326103040" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295686589677569" itemprop="isPartOf"/><div><article aria-labelledby="id__smsxyzcbtj id__wmncl044dd9 id__5mpfarnxvvk id__rklcxpejqu id__g4hsr5rt4tp id__b08uropx79w id__iu5xxrn8qn id__d5p6bpp3edm id__fklf9ud1fwj id__1kpe4ayq9ax id__4bfvggtd0wa id__vy61fl1q7t id__ys7w24dt0oh id__tjsdcf6vg1q id__lr762cefbze id__vm54vi01an" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__b08uropx79w"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Culprit: Each cluster of GPU cores within an M1/M1 Pro/M1 Max/M1 Ultra chip comes with a 32MB TLB or Transaction Lookaside Buffer, which is a memory cache that stores the recent translations of virtual memory to physical memory, used to reduce user memory location access time.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295690037383169" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:21.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295690037383169" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295688326103040" itemprop="isPartOf"/><div><article aria-labelledby="id__rypgarq0h1m id__7zibzzjtss8 id__deijwtyfku8 id__5dh5jip1zg4 id__oo6ma05qvhb id__68vdz4dth6b id__filmfd8nx7 id__tw8kvft5ycp id__tjayya5topb id__7lhgx134xdh id__gbbrhuon785 id__q1craudidlm id__apzxpe88yig id__8547wnwsdjd id__gbinuilap id__4bmtyw4zmof" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__68vdz4dth6b"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Hishnash: &#34;If an application has not been optimized for the M1 GPU architecture&#39;s tile memory, (not just Metal optimized) then every read/write needs to go all the way out to system memory. If the GPU compute task is issuing MANY little reads, then this will saturate the TLB.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295691874484227" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:21.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295691874484227" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295690037383169" itemprop="isPartOf"/><div><article aria-labelledby="id__fw26cfiyf0r id__o5hrqa5c7oo id__rgbsgwcwckq id__vaovxz8h2dq id__smh059cotph id__higxuwikx28 id__cw71s9mmbsa id__egvinefwbo9 id__w1znp8nebce id__n6mfaibqwwe id__w1nles28lop id__cgg5dmfzago id__1z9h20es75q id__xuhc6iolm8e id__qhu8s7chzb id__e6d9k0vdthi" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__higxuwikx28"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The issue is if GPU data hits the TLB and the page table being read/written to is not loaded, then that entire thread group on the GPU needs to pause while the page table is loaded into the TLB. If your application is using MANY reads/writes per second, this results in...</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295693581586434" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:22.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295693581586434" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295691874484227" itemprop="isPartOf"/><div><article aria-labelledby="id__87ir2o04d59 id__7exzgdglgdu id__xzkilnbm7pp id__1jst6dri7o6 id__g618smoso4j id__ypdbwm601a id__gyy5q9vmyzo id__uwt3w1uib9l id__3wb9cqc2wia id__wfmmjc6w4h id__itl64udv6l id__vti9ghzl27 id__a6y2r3lfkbw id__2ko07ug1dmz id__cel6cqbdxx4 id__hs5ncv9x5e" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ypdbwm601a"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>...a lot of STALLED GPU thread groups. Unlike a CPU, when a GPU is waiting for data, it can&#39;t just switch to work on something else. So the GPU sits there and waits for the TLB buffer to clear in order to get more work to process.&#34; This is why we only saw 86W peak GPU usage...</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295695297064962" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:22.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295695297064962" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295693581586434" itemprop="isPartOf"/><div><article aria-labelledby="id__ep4oax1n02m id__cwivym4f9nj id__0x03cpw4grh id__wybiv63693c id__mbnmjbtgfxa id__jpgy3zip1w id__z1n449yvw2n id__4im51j08all id__5halvxzys5t id__09plu1zgwqjd id__hphhjh28sms id__3t4forhdrd id__xrim89incq id__f651ldfi55q id__0r5ofz383y4a id__76197c2b9ih" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__jpgy3zip1w"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>..in an app that was considered to be decently optimized. However, for apps that CLAIM to support Apple Silicon support but have NOT been rewritten to take advantage of Apple&#39;s TBDR tile memory system, they will be severely limited by the 32MB TLB if there are many reads/writes.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295697020887044" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:23.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295697020887044" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295695297064962" itemprop="isPartOf"/><div><article aria-labelledby="id__vu1eporu5bh id__wvfbzykn30s id__pwevnnqsvss id__1g86ta5b5ap id__aehrq2u375 id__lpxh2pxrcjb id__0eoisgotpxmu id__za8ukimok6 id__hdhbyl3r055 id__p6m7ddvuubp id__vyuemp6pqlh id__w09au096cc id__sd21o4bhlyo id__v863ayrrx7 id__qr3gxgikthm id__lymukoqp1r" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__lpxh2pxrcjb"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The problem is that ALMOST ALL apps out there haven&#39;t been optimized for Apple&#39;s TBDR tile memory system. Many software developers simply get it to work using the traditional TBIR model and call it good to go, being unaware of the 32MB TLB limitation that bottlenecks performance.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295698736377858" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:23.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295698736377858" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295697020887044" itemprop="isPartOf"/><div><article aria-labelledby="id__v98vptduyzc id__mu4910mmdd9 id__qq58j8t8qp id__wwj166noy4e id__kq59k88quk id__x3ppitg9ia id__5ioksmzjivr id__45h595ghm8k id__1w1bhf116e2 id__s945vyxu13e id__80y11al72e id__owbsk4fr35 id__xn3u9202vo id__sfuajrm5lq id__wj775z8aeta id__ztungkg4oh" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__x3ppitg9ia"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Hishnash: &#34;What apps should be doing is loading as much data as possible into the tile mem and flushing it out in large chunks when needed. I bet a lot of the writes (over 95%) are for temporary values that could&#39;ve been stored in tile mem and never needed to be written at all.&#34;</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295700456042507" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:23.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295700456042507" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295698736377858" itemprop="isPartOf"/><div><article aria-labelledby="id__5isg57uryae id__prcncifgpkj id__fkc3h8faaor id__144v39ssu0oa id__efk35xue2lg id__p5lzc0ylwap id__j15kp41sjzi id__skt3nig2d3 id__0ym0zbzz7z2 id__5iinbm58q5g id__7fs4mt3ryyc id__8ywljcls97k id__meydl8r1zw id__fhub539nkww id__rrbhl26xcgg id__7l0s9ck3o6d" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__p5lzc0ylwap"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Hishnash: &#34;I expect that the people building the M1 family of chips didn&#39;t expect applications to be running on it that are not TBDR optimized. So they thought 32MB would be enough.&#34;
WRONG. Most apps aren&#39;t optimized for Tile-mem, even if they claim it supports Apple Silicon.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295702259585027" itemprop="identifier"/><meta content="12" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:24.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295702259585027" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295700456042507" itemprop="isPartOf"/><div><article aria-labelledby="id__jdueolunor id__5sukhltmyaq id__8kuycwnf5sw id__i8k3chubr2 id__mgrkyswnirn id__taslhy2w4ht id__rf09pa919vg id__q120og1w10o id__l3bcopcqlzd id__3qmsjixxcd id__xwkjw9zvxw id__pf249tvnajk id__nxowkd9sjgk id__ioixs5bfugk id__md6b6yt7qv id__gjgfhnx7g09" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__taslhy2w4ht"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Keep in mind that between the time when Apple started engineering the M1 family 5-7 years ago, reliance on GPU performance has skyrocketed, so the chip designers probably didn&#39;t think there would be so many reads/writes to the 32MB TLB.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295704016941056" itemprop="identifier"/><meta content="13" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:24.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295704016941056" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295702259585027" itemprop="isPartOf"/><div><article aria-labelledby="id__h4u2vuf8knt id__sygwshwdm9l id__3ciwnveaord id__rfxf0m490bj id__2j7vf3p6css id__4mib8fhjp7q id__oj5zoh6lgzd id__mfsylgo7upq id__v196cclrr3q id__nepxn4tx62 id__cp4jgnwt356 id__t2dugj1shg id__deadzio0ybq id__u27of412u8f id__a25nigd0ota id__s76uda52p4" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4mib8fhjp7q"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>What does this mean? The M1 family of chips, including the M1 Ultra, has a major limitation that can&#39;t be fixed unless apps are properly optimized. Here&#39;s the problem.
Hishnash: &#34;The effort needed to optimize for tile memory is MASSIVE. It requires going all the way back to the..</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295705761767431" itemprop="identifier"/><meta content="14" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:25.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295705761767431" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295704016941056" itemprop="isPartOf"/><div><article aria-labelledby="id__wdgabyucc9 id__eiqd87m21bw id__0j6qgj3rekgi id__ax1nuqc60pn id__wmei4hvxaa id__km08gmus3s id__f11vwf2kaab id__1uxf1vkmjco id__l6a0ldndc7m id__pp5grii1oug id__cv9r8ky26vt id__ckxmz1yb5p6 id__68g50olkxni id__uh50z0g0mri id__i5twgi9ix9 id__qsagak6jwsi" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__km08gmus3s"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>...drawing board, re-considering everything, like the concept that there is a local on-die memory pool you can read/write from with very very low perf impact is unthinkable in the current desktop GPU space. Itâ€™s a matter of a complete rewrite at a concept/algorithmic level.&#34;</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295707481501700" itemprop="identifier"/><meta content="15" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:25.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295707481501700" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295705761767431" itemprop="isPartOf"/><div><article aria-labelledby="id__pg6cbm7gzr id__iw5thg3h8g id__a3ajyf13adu id__8qeeono1vt id__zybx4ofb1s id__v609h6k3hy id__oomyfjgct3i id__ieiuxj0jslr id__ajtpsjnxuvf id__otajuqw6gos id__8kvnbh69vf8 id__3fno6u47dba id__fmq0dq2ea2m id__j9cbq8zyh8 id__0je0gq4ozeb id__9gyc9b8nzwr" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__v609h6k3hy"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Why is this such a big problem for M1 Ultra?
With the M1 and M1 Pro chips, there wasn&#39;t enough GPU performance to hit that 32MB TLB limit. However, the M1 Max is where you see GPU scaling fall off a cliff due to the TLB, especially the 32-core GPU model.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295709201166340" itemprop="identifier"/><meta content="16" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:25.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295709201166340" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295707481501700" itemprop="isPartOf"/><div><article aria-labelledby="id__q64f2jvgcfb id__fup2a68ahg8 id__mqxc2uyeosa id__x9h95m3lnq id__41owfjf67p6 id__gyvfshxcvue id__fo5z44zdsxv id__35r6zyopbq8 id__1t0q4wdu3sx id__f42it4mbzd id__ds70h2m3mwa id__bnksys1e4h7 id__oa5lkq22fye id__5xqignkbj9m id__xsztv1j2y9h id__730i4h0nac5" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__gyvfshxcvue"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>This problem scales linearly, so if, for example, 26 cores is the sweet spot for the M1 Max, with the rest of the 6 cores being bottlenecked by the TLB, the M1 Ultra will be bottlenecked by 12 GPU cores because it features two 32-core M1 Max dies. No wonder it scales poorly.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295710962778113" itemprop="identifier"/><meta content="17" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:26.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:26.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295710962778113" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295709201166340" itemprop="isPartOf"/><div><article aria-labelledby="id__bogoj4okbms id__g40q14qwr2n id__5s051mig9lt id__062tigkedd3a id__ygd3lpp03ag id__403gku336wg id__n3w831rjmo id__2pocmrl1j1 id__6uona0nuvdf id__c6f7jpobikm id__c2a2tpanvv id__gbnz9qzeyr8 id__v8huyezw9gn id__y4nhx4duanh id__shhlus5v36o id__i6vkwvsk32p" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__403gku336wg"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><div lang="en" dir="auto" id="id__c2a2tpanvv"><p><span>The solution from </span></p><p><span>: &#34;Increasing the TLB will help a lot for applications that are not optimized. This is important because many apps will NEVER be optimized, and even fewer games.&#34; This is why gaming performance is so poor on M1 Ultra, apart from the Rosetta bottleneck.</span></p></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295712711806976" itemprop="identifier"/><meta content="18" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:26.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:26.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295712711806976" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295710962778113" itemprop="isPartOf"/><div><article aria-labelledby="id__8kshmc6dzus id__38bg350yv5q id__leej05cnh8 id__tc3igfri9mh id__besqajjz20j id__11tw74gyk9pe id__0uodwo0dhh3i id__kem361htej id__2th3jct0tz4 id__otfascxzxjc id__k05ddt394pd id__rlguggursuj id__w7qoxmdgmk id__98p0v34nua6 id__yl1dy0gqrxk id__uz6acfv9x9g" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__11tw74gyk9pe"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>Hishnash: &#34;For game engines that are not TBDR aware/optimized, they might be currently bottlenecked on reads.. and depending on the post-processing effects, might have some large bottlenecks on writes if they&#39;re not using tile memory and tile compute shaders where possible.&#34;</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295714469228553" itemprop="identifier"/><meta content="19" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:27.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295714469228553" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295712711806976" itemprop="isPartOf"/><div><article aria-labelledby="id__5r4n6n7uunh id__bjtrmvoy64k id__aan90b4bdcd id__ry0sia72j5 id__bxhi4k3enc id__43moj98ei16 id__hjy9pblw35p id__z4p8to3xvu id__7p2ouf06i4t id__nwiw7vc4of id__viuakb4xvv id__juzz0zrgutn id__go0riz8gddq id__ikn6u2bks3 id__gbokzbm3wq8 id__u9hv5qscmyp" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__43moj98ei16"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The reason World of Warcraft runs so well and compares well to the RTX 3080/3090 is because APPLE helped them optimize the game PROPERLY to take advantage of the new TBDR tile-based architecture. (WoW Metal Update Released one week after M1 event proves they got help from Apple.)</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295716205670401" itemprop="identifier"/><meta content="20" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:27.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295716205670401" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295714469228553" itemprop="isPartOf"/><div><article aria-labelledby="id__jb8xrcz69x7 id__vt4m6ka01d9 id__1sqwlcqapvv id__ef1z7mv189n id__94f82mdhtpv id__9e8wpiw3hmw id__5g8qzz55wu id__lcl8g0w198c id__xv1r7lk816 id__3ue36eyb0e7 id__2j2z88i9com id__0n4glkoqano id__zvqrh5ei93l id__fqtfjg6x6mk id__jywtktagadg id__bqy2uvisngc" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__9e8wpiw3hmw"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The solution from our source: Future M-chip families (Hopefully and probably M2) will see a big increase in the TLB to solve this problem since developers are likely to be slow in optimizing apps. Apple will likely release white papers at WWDC on how to optimize apps properly.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295717958852608" itemprop="identifier"/><meta content="21" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:28.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:28.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295717958852608" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295716205670401" itemprop="isPartOf"/><div><article aria-labelledby="id__vzm459v3d9d id__0qqn63bvk5vo id__kk6n22phkj id__iroeifyxbtn id__lqc9itsxvgn id__nocyt84p5qc id__j78z58ig66 id__gode8k5qfl5 id__pptpefvgyi id__l4sbr22c18 id__qckx92fg9cj id__byq7rg3ow1w id__k75e8ajpav9 id__u58vg4qnczb id__p0r5p2zd52 id__5pbeud1nwgm" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__nocyt84p5qc"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>This means that the M2 Ultra will see a HUGE boost in GPU performance over the M1 Ultra if the 32TLB bottleneck is removed. And that performance boost will be on top of higher clock speeds and potentially higher GPU core counts.</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295719716294657" itemprop="identifier"/><meta content="22" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:28.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:28.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295719716294657" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295717958852608" itemprop="isPartOf"/><div><article aria-labelledby="id__xcjkd9eicp id__ff7hte1fw7s id__bj1us0ujgj id__vi6gy6jni7g id__acvv1ot6alj id__4hdnk2vzwrc id__dwmmbjv2xob id__yyfnwz7lmc id__1frcf0bvi3u id__fq48aoywtbw id__7xti18zcn6 id__vm8qku55zld id__rfnkf5y3mfd id__uejqrkh282a id__50zm47jioz6 id__xssdctkqf3" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4hdnk2vzwrc"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><div><p><span>The only hope for the M1 Ultra is that developers finally decide to completely rethink and rewrite their apps to support the TBDR tile-based memory architecture. (Good luck)
Oh, and by the way, expect hardware ray-tracing support on future M-chip families. (Hopefully M2 Pro+)</span></p></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295721431773184" itemprop="identifier"/><meta content="23" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:28.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:28.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295721431773184" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295719716294657" itemprop="isPartOf"/><div><article aria-labelledby="id__23hk3le14or id__dpjr9s0k4xq id__j2f8iedgfv id__4cvggkxlrl8 id__bx1jf5k35bh id__5ehyijlodfd id__cipes24vevs id__l640rzndj8m id__xnhy3hqczp id__z6tjv50erud id__f0cs491ol76 id__4kemgopf84k id__90xtcgm6596 id__fn516babepe id__3ocgfkw30nd id__uh9dsywgrf" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__5ehyijlodfd"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1514295723277266946" itemprop="identifier"/><meta content="24" itemprop="position"/><meta content="15" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-04-13T17:33:29.000Z" itemprop="dateCreated"/><meta content="2022-04-13T17:33:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/VadimYuryev/status/1514295723277266946" itemprop="url"/><meta content="https://twitter.com/VadimYuryev/status/1514295721431773184" itemprop="isPartOf"/><div><article aria-labelledby="id__ic9r15noua id__oug7wexou2m id__iaqxxw4auib id__fqwgpzbmsxb id__x8ct20n3sup id__nwlge94ia8b id__ogyjqx6ccr id__xmwxeznis4 id__h4inynmdfxp id__0r1lz4818nap id__ftf5ywev3h9 id__81etjuhqpul id__h6ywygpuaqo id__s9qtcalqww9 id__1v5xdkz7agr id__naoldjk9ar" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__nwlge94ia8b"><div><div><div><div><a href="https://rfong.github.io/VadimYuryev" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1383152788071272448/UewIy3Oc_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
