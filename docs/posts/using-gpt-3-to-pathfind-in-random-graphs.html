<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/">Original</a>
    <h1>Using GPT-3 to pathfind in random graphs</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<p>I wondered how GPT-3 might do on the following problem: given a partially-connected graph, find a path between two nodes, or determine that no path exists.</p>



<p>I <a href="https://github.com/polkerty/gpt3-graph-search">wrote some code</a> to automate generating graphs, feeding them to GPT-3, and parsing + grading its results. I generated 1000 random graphs and fed them to the model. The graphs ranged from 3 to 14 nodes, and up to 25 edges. The optimal path through the graph ranged from 2-7 nodes. How did GPT-3 do? The model found a valid path (or correctly reported no result) a little over 60% of the time:</p>



<figure><img data-attachment-id="335" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-5-2/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png" data-orig-size="1682,1026" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-5" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-5.png 1682w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Here, the first 3 bars count as “correct” and the others are all different ways that GPT-3 is incorrect. In a few cases, there was a correct solution as a subarray of an otherwise incorrect solution. GPT-3 performed slightly better at a lower temperature; at temperature 1 (for “creative applications”) it found a valid answer about 50% of the time, but at temperature 0 (used for the results in this post) it was right about 60% of the time.</p>



<p>What’s GPT-3’s nicest solution? Here is an optimal path of length 6 it found from node 3 to node 2:</p>



<figure><img data-attachment-id="331" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-3-3/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png" data-orig-size="1170,914" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-3" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-3.png 1170w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Here’s a path of length 5 it found through a much denser graph, from node 10 through node 14:</p>



<figure><img data-attachment-id="330" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-2-3/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png" data-orig-size="1322,982" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-2" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-2.png 1322w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>GPT-3 was even able to crack a path of length 7! This graph is interesting because it is disconnected; the model is keeping track of quite a bit of state here as it moved from node 3 to node 8:</p>



<figure><img data-attachment-id="333" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-4-2/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png" data-orig-size="1212,1068" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-4" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-4.png 1212w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>In general though GPT-3 struggled to solve graphs with longer paths:</p>



<figure><img data-attachment-id="336" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-6-2/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png" data-orig-size="1174,702" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-6" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-6.png 1174w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>The graph is a bit noisy, but in general, longer paths are harder for GPT-3, as we’d expect. </p>



<p>In case you’d like to give this a try in the <a href="https://beta.openai.com/playground">playground</a>, here’s an example of the prompt I used (this one is for the length-7 path above):</p>



<pre>You are solving a graph problem where you need to find a path in the graph.

The graph has 14 nodes, numbered from 1 to 14.

The graph has 9 bidirectional edges. Here they are:
An edge from node 1 to 7
An edge from node 12 to 14
An edge from node 10 to 11
An edge from node 3 to 14
An edge from node 9 to 13
An edge from node 9 to 12
An edge from node 1 to 9
An edge from node 7 to 8
An edge from node 5 to 10

You are currently on node 3. 
You would like to find the optimal path to node 8.

Output the list of nodes you visit on this path in order, separated by commas. If there is no path, instead print &#34;There is no path.&#34;

Your solution should start with node 3 and end with node 8. 

Do not include any extra text.</pre>



<p>It’s also remarkably easy to hook up a script to the OpenAI API — I encourage everyone to give it a try! It cost me about $10 to do this blog post, including a few abortive attempts to grade a lot of graphs:</p>



<figure><img data-attachment-id="338" data-permalink="https://jacobbrazeal.wordpress.com/2022/09/23/gpt-3-can-find-paths-up-to-7-nodes-long-in-random-graphs/image-7-2/" data-orig-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png" data-orig-size="1712,1174" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="image-7" data-image-description="" data-image-caption="" data-medium-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=300" data-large-file="https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=1024" src="https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=1024" alt="" srcset="https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=1024 1024w, https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=150 150w, https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=300 300w, https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png?w=768 768w, https://jacobbrazeal.files.wordpress.com/2022/09/image-7.png 1712w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p><em>Appendix</em></p>



<p>I encountered the <a href="http://www.dogbunnypuzzle.com/">Dog Bunny Puzzle</a> a few days ago and wondered if GPT-3 would be able to solve it. Sadly I wasn’t able to get it to work, although the following prompt got kind of close:</p>



<pre><code>There is a graph with 7 nodes: &#34;bone&#34;, &#34;house&#34;, &#34;bunny&#34;, &#34;tree&#34;, &#34;flower&#34;, &#34;well&#34;, and &#34;carrot&#34;.

There are 9 edges between the nodes:

&#34;bone&#34; connects to &#34;boat&#34;,
&#34;bone&#34; connects to &#34;house&#34;.
&#34;house&#34; connects to &#34;boat&#34;.
&#34;house&#34; connects to &#34;tree&#34;.
&#34;&#39;tree&#34; connects to &#34;carrot&#34;.
&#34;tree&#34; connects to &#34;well&#34;.
&#34;well&#34; connects to &#34;carrot&#34;.
&#34;well&#34; connects to &#34;flower&#34;.
&#34;flower&#34; connects to &#34;boat&#34;.

There are 3 pieces on the graph in the start position:

The &#34;bunny1&#34; piece is on the &#34;house&#34; node.
The &#34;bunny2&#34; piece is on the &#34;boat&#34; node.
The &#34;dog&#34; piece is one the &#34;tree&#34; node.

We would like to move the pieces along the edges of the graph until the following target position is reached:

The &#34;bunny1&#34; piece is on the &#34;carrot&#34; node.
The &#34;bunny2&#34; piece is on the &#34;carrot&#34; node.
The &#34;dog&#34; piece is on the &#34;bone&#34; node.

But there are some special rules to remember.

You can only move between &#34;bone&#34; and &#34;house&#34; if there is a piece on the &#34;carrot&#34; node.
You can only move between &#34;bone&#34; and &#34;ship&#34; if there is a piece on the &#34;tree&#34; node.
You can only move between &#34;house&#34; and &#34;tree&#34; if there is a piece on the &#34;bone&#34; node AND a piece on the &#34;flower&#34; node.
You can only move between  &#34;well&#34; and &#34;carrot&#34; if there is no piece on the &#34;bone&#34; node. 

Print a sequence of moves where the pieces begin in the start position and move between edges until they reach the target position. </code></pre>



<p>GPT-3 responds:</p>



<pre><code>Note that you do not have to use all of the edges, but you can only use each edge once.

The possible moves are:

bone to house
house to bone
bone to ship
ship to bone
house to tree
tree to house
tree to well
well to tree
well to carrot
carrot to well
carrot to bone</code></pre>



<p>Amusingly, it adds some details to the prompt constraints (“Note that you do not have to use all of the edges, but you can only use each edge once”) but the actual moves are useless. Removing the “special rules” section helped the model perform more accurately, in my experiments, but my sense was that the level of complexity in the Dog Bunny Puzzle was overwhelming the model. (<a href="https://github.com/polkerty/dog-bunny-puzzle-solver">Here is a solution to the puzzle</a> in Python, in case you’re curious!)</p>
	</div><div>
			<!-- .entry-auhtor -->
		<p><strong>Published</strong>
			<time datetime="2022-09-23T07:48:09+00:00">September 23, 2022</time><time datetime="2022-09-23T08:12:46+00:00">September 23, 2022</time>		</p><!-- .site-posted-on -->
	</div></div>
  </body>
</html>
