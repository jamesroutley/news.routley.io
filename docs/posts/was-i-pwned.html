<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://news.ycombinator.com/item?id=33820330">Original</a>
    <h1>Ask HN: Was I pwned?</h1>
    
    <div id="readability-page-1" class="page"><div><td colspan="2"></td><td><div><p>A few days ago, I noticed that my home network performance would degrade substantially to the point of being unusable. I would just power-cycle all my switches, and the issue would resolve for a while. It happened again this morning, so I decided to try to look closer at what could be causing the issue. That&#39;s when I noticed that my Linux desktop was doing a lot of traffic, and here&#39;s what I observed:</p><p>- My desktop has a private IP address, let&#39;s say 10.0.0.2.</p><p>- Running `iftop`, I saw all the traffic coming from a different source IP address, 10.0.0.3. It was transferring ~300Mbps.</p><p>- Running `tcpdump`, I saw that all of this traffic was going to a public IP address (AT&amp;T). All of the source port/dest were ipsec-nat-t.</p><p>- I saw that `10.0.0.3` showed up as a client on my switch with a randomized MAC address (presumably, since I couldn&#39;t find the MAC prefix in a vendor list).</p><p>- I could not find any references to `10.0.0.3` or the random MAC address on my desktop (looking at kernel logs, system logs, ip a, ifconfig).</p><p>- During this period, my network was degraded (high packet loss across my switches).</p><p>It was at this point that I decided to try blocking the MAC address from my switch, and performance immediately returned to normal. I tried unblocking the MAC a few minutes later, but it has yet to return. That plus the fact that the issue happens at seemingly random times (especially the middle of the night) makes me think that it&#39;s not automatically connecting and instead being triggered remotely.</p><p>I&#39;ve since disconnected my desktop from the network and am in the process of rotating keys. I&#39;m especially perplexed at the traffic showing up from a different source IP on my desktop, but I did not see any interface that matched. I tried to look and see if it was potentially a VM running, but I didn&#39;t see anything in virsh. I did have Docker containers running, but I assume I would have seen the IP address show up on one of my interfaces.</p><p>I&#39;m at a bit of a loss and was wondering if anyone has ever seen anything like this before, and if there is any suggestions for things I should check.</p></div></td></div></div>
  </body>
</html>
