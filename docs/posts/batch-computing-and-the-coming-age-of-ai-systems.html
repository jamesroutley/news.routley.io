<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hazyresearch.stanford.edu/blog/2023-04-12-batch">Original</a>
    <h1>Batch computing and the coming age of AI systems</h1>
    
    <div id="readability-page-1" class="page"><div><figure><img src="https://hazyresearch.stanford.edu/static/posts/2023-04-12-batch/blogpost_figure-01.png"/></figure>
<p>There’s a lot of excitement right now about human-in-the-loop systems supercharged by foundation models including chat assistants (<a href="https://openai.com/blog/chatgpt">ChatGPT</a>), word processing (<a href="https://www.theverge.com/2023/3/16/23642833/microsoft-365-ai-copilot-word-outlook-teams">Microsoft Office</a>), graphic design (<a href="https://stability.ai/blog/stable-diffusion-public-release">Stable Diffusion</a>), and code editing (<a href="https://github.com/features/copilot">Copilot</a>). However, these systems only begin to scratch the surface of the role foundation models could play in our world. There’s another set of workloads, which we refer to as <em>batch processing tasks</em>, that require processing many inputs without a human-in-the-loop. If foundation models could be applied reliably and at scale, they could power complex batch processing tasks that impact every part of our society - from how we deliver healthcare, to how we do science and understand our economy. </p>
<p>This divide between human-in-the-loop and batch computing already exists in software today. There are human-in-the-loop systems like search, which are highly visible and impactful to everyday users, but only account for a fraction of the role computing plays in the world. Much of our economy depends on <em>batch processing</em> systems that run at scale behind the scenes, without humans in the loop. Today, this includes systems for everything from processing financial transactions to managing supply chains to analyzing scientific and health data. Understanding these two settings can help us frame where foundation models are and where they could go.</p>
<p>Before foundation models, tackling batch processing tasks with AI was impactful but took significant time and expertise. Some examples from our own work:</p>
<ul>
<li><strong>In healthcare:</strong> we built systems to do <a href="https://www.nature.com/articles/s41746-019-0168-z">medical device surveillance</a> and understand whether implants were systematically failing veterans. We also contributed to systems that help <a href="https://amelie.stanford.edu/">diagnose rare genetic disorders in children</a>.</li>
<li><strong>In human rights:</strong> we worked on systems to assist in <a href="http://deepdive.stanford.edu/showcase/memex">the fight against human trafficking</a>. </li>
<li><strong>In science:</strong> we developed a system for organizing huge swaths of scientific literature in <a href="https://geodeepdive.org/index.html#the-team">geology and beyond</a>.</li>
</ul>
<p>Each of these systems took PhD-decades to build. Our recent work suggests foundation models could dramatically reduce the time and difficulty of building AI-powered batch processing systems like these. This democratization puts amazing technology in the hands of the amazing people of the world who can use it to improve all of our lives. From simplifying <a href="https://www.nejm.org/doi/full/10.1056/NEJMsa2206117">observational studies</a> in medical research to automating <a href="https://www.expenseanywhere.com/wp-content/uploads/2019/04/2019-Payables-Insight-Report_ExpenseAnywhere.pdf">accounting processes for businesses</a>, we’re incredibly excited about the impact foundation models could have when applied to batch processing tasks.</p>
<p>However, using foundation models effectively in batch processing applications brings a new set of challenges that aren’t present in human-in-the-loop applications. Unlike chat and autocomplete, which have low data volumes per user and depend on low latency responses, batch processing applications have high data volume and need to be optimized for high-throughput data processing. This is particularly important given the enormous compute and memory requirements for serving these models. Moreover, because of the volume, batch processing systems must maintain high quality without humans in the loop manually reviewing the output of each operation. These differences point to unanswered research questions and room for improvement. </p>
<p>We’ve already made some headway on these challenges with efficiency and quality in applying foundation models to batch processing - and our early experiments suggest there’s a long way to go.</p>
<ul>
<li><strong>Systems improvements:</strong> We think there is significant room for systems improvements to improve efficiency for exact inference in batch processing. In <a href="https://github.com/FMInference/FlexGen">FlexGen</a>, we were able to achieve 100x higher maximum throughput for foundation model inference in resource-constrained settings by optimizing offloading strategies for high-throughput instead of latency.</li>
<li><strong>New trade-offs:</strong> With new strategies for querying foundation models, we can explore new quality and accuracy trade-offs for batch processing and achieve asymptotically better performance. In <a href="https://github.com/HazyResearch/evaporate">Evaporate</a>, we showed that instead of directly extracting data with foundation models, we can generate <em>code</em> that does the processing for us. This leads to foundation model compute costs that are fixed with respect to the size of the data to be processed. Our study on 16 real-world evaluation settings showed we could achieve 12.1 F1 improvements in extraction quality with 110x reduction in tokens processed by the foundation model.</li>
<li><strong>Quality and validation:</strong> Although foundation models have impressive capabilities across a broad set of tasks, they <a href="https://arxiv.org/abs/2302.10724">fail</a> in surprising ways. When applied at scale without a human-in-the-loop, these failures could go unnoticed if users don’t perform careful evaluations. The issue is, existing validation tooling is not suited to FMs. In traditional machine learning, the cost of collecting training data outweighs the cost of collecting validation data, but since FMs don’t require training data, evaluation is now the rate-limiting-step. In <a href="https://github.com/HazyResearch/meerkat">Meerkat</a>, we’re making FM evaluation more accessible and efficient by creating new error analysis interfaces and asking FMs to evaluate themselves. </li>
</ul>
<p>We’re just getting started here. Our bet is that enabling foundation models to reliably and efficiently perform batch processing tasks will yield a new class of data systems and impactful applications that we are just beginning to understand.</p>
<h2>Acknowledgements</h2>
<p>Thanks to Simran Arora, Arjun Desai, Karan Goel, Ce Zhang, Ines Chami, Benjamin Spector for their comments and feedback on this post.</p></div></div>
  </body>
</html>
