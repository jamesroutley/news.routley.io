<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.jonstokes.com/p/chatgpt-explained-a-guide-for-normies">Original</a>
    <h1>ChatGPT Explained: A normie&#39;s guide to how it works</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><div class=""><div><div dir="auto"><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg" width="1456" height="1008" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1008,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:79120,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:false,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6866ca04-5223-46df-82dc-7ac024bc74ab_1664x1152.jpeg 1456w" sizes="100vw"/></picture></div></a></figure></div><p><em><strong>The story so far:</strong><span> Most of the discussion of ChatGPT I’m seeing from even very smart, tech-savvy people is just not good. In articles and podcasts, people are talking about this chatbot in unhelpful ways. And by “unhelpful ways,” I don’t just mean that they’re anthropomorphizing (though they are doing that). Rather, what I mean is that they’re not working with a practical, productive understanding of what the bot’s main parts are and how they fit together.</span></em></p><p><em><span>To put it another way, there are some </span><a href="https://www.jonstokes.com/p/the-can-opener-problem" rel="">can-opener problems</a><span> manifesting in the ChatGPT conversation, and lowering the quality of The Discourse.</span></em></p><p><em>To be clear, I do not know everything I’d like to know about this topic. Like everyone else, including active researchers in machine learning, I’m still on my own journey with getting my head around it at multiple levels. (Speaking of, if you run a shop that sells dedicated ML workstations and would like to publicly sponsor this newsletter by sending me one, do get in touch.)</em><span> </span></p><p><em>That said, I’m certainly far enough along that I can help others who are a few steps behind. So what follows is my effort to help others get closer to the target in their thinking and writing about this new category of technology.</em></p><p><span>At the heart of ChatGPT is a large language model (LLM) that belongs to the family of generative machine learning models. This family also includes </span><a href="https://www.jonstokes.com/p/getting-started-with-stable-diffusion" rel="">Stable Diffusion</a><span> and all the other prompt-driven, text-to-whatever models that are daily doing fresh miracles on everyone’s feeds right now.</span></p><p>If you want to know more about how generative ML models work and you have some time, read the following pieces:</p><ul><li><p><span>AI content generation series: </span><a href="https://www.jonstokes.com/p/ai-content-generation-part-1-machine" rel="">Part 1</a><span>, </span><a href="https://www.jonstokes.com/p/ai-content-generation-part-2-tasks" rel="">Part 2</a><span>, </span><a href="https://www.jonstokes.com/p/ai-content-generation-part-4-whats" rel="">Part 4</a></p></li><li><p><a href="https://www.jonstokes.com/p/what-does-it-mean-to-create-something" rel="">What Does It Mean to “Create” Something With Generative AI?</a></p></li><li><p><a href="https://www.jonstokes.com/p/the-hall-monitors-are-winning-the" rel="">The Hall Monitors Are Winning the AI Wars, Part 1: ChatGPT</a></p></li></ul><p><span>⭐️ But if you don’t have time to read all that, here’s a </span><strong>one-sentence explanation of a generative AI model:</strong><span> </span><em>a generative model is a function that can take a structured collection of symbols as input and produce a related structured collection of symbols as output</em><span>.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg" width="1000" height="543" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/bcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:543,&#34;width&#34;:1000,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:197355,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcf9a88e-e597-4868-b49c-f4fe6a08bebe_1000x543.jpeg 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>Here are some examples of structured collections of symbols:</p><ul><li><p>Letters in a word</p></li><li><p>Words in a sentence</p></li><li><p>Pixels in an image</p></li><li><p>Frames in a video</p></li></ul><p><span>Now, there are plenty of ways to turn one collection of symbols into another, related collection of symbols — you don’t even need computers to do this. Or, you can write a computer program that uses rules and lookup tables, like a certain </span><a href="https://return.life/2023/02/please-stop-talking-about-the-eliza-chatbot/" rel="">famous chatbot from the 60s</a><span> that I’m sick of hearing about.</span></p><p><span>👷‍♂️ The hard and expensive part of the above one-sentence explanation — the part that we’ve only recently hit on how to do using massive amounts of electricity and leading-edge computer chips — is hidden deep inside the word </span><em>related</em><span>.</span></p><p>Before we get into relationships, you need two concepts that will come up again and again throughout this piece:</p><ul><li><p><strong>⚙️ Deterministic: </strong><span>A deterministic process is a process that, given a particular input, will always produce the same output.</span></p></li><li><p><strong>🎲 Stochastic: </strong><span>A stochastic process is a process that, given a particular input, is more likely to produce some outputs and less likely to produce others.</span></p></li></ul><p>A classic gumball machine is deterministic — if I insert a quarter and turn the crank, I get a single gumball every time. So one quarter == one gumball, always.</p><p><span>But a classic gumball machine is </span><em>also</em><span> stochastic — if I put in a quarter and turn the crank, the color of the gumball I’ll get is fundamentally random. Furthermore, the odds of getting one color or another depends on the ratios of different colors inside the machine. Five different gumball machines with five different gumball color ratios will have five different probability distributions for gumball color output.</span></p><p>Now, with these key concepts out of the way, back to the reason why relationships can be hard.</p><p>Collections of symbols can be related in different ways, and the more abstract and subtle the relationship, the more technology we’ll need to throw at the problem of capturing that relationship in a way that’s useful for knowledge work.</p><ol><li><p><span>If I’m relating the collections </span><code>{cat}</code><span> and </span><code>{at-cay}</code><span>, that’s a standard “</span><a href="https://en.wikipedia.org/wiki/Pig_Latin" rel="">Pig Latin</a><span>” transformation I can manage with a simple, handwritten rule set.</span></p></li><li><p><span>If I’m relating </span><code>{cat}</code><span> to </span><code>{dog}</code><span>, then there are many levels of abstraction on which those two collections can relate. </span></p><ol><li><p>As ordered symbol collections (sequences), they both have three symbols. </p></li><li><p>As three-symbol sequences, they’re both words. </p></li><li><p>As words, they both refer to biological organisms. </p></li><li><p>As organisms, they’re both mammals. </p></li><li><p>As mammals, they’re both house pets. And so on.</p></li></ol></li><li><p><span>If I’m relating </span><code>{the cat is alive}</code><span> to </span><code>{the cat is dead}</code><span>, then there’s an even larger number of even more higher-order concepts that we can use to compare and contrast those two sequences of symbols. </span></p><ol><li><p><span>All of the concepts related to </span><code>cat</code><span> are in play, as are concepts related to “alive” vs. “dead.” </span></p></li><li><p><span>On yet another level, many readers will spot what we might call an </span><a href="https://en.wikipedia.org/wiki/Intertextuality" rel="">intertextual</a><span> reference to </span><a href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger%27s_cat" rel="">Schrödinger’s Cat</a><span>.</span></p></li></ol></li><li><p><span>Let’s add one more relationship, just for fun: </span><code>{the cat is immature}</code><span> vs. </span><code>{the cat is mature}</code><span>. But are we talking about a stage of physical development or a state of emotional development? </span></p><ol><li><p>Since it’s a cat, “immature” is probably a straightforward synonym for “young” or “juvenile.” </p></li><li><p>If the subject of the sentence were a human, the sentence would more likely be invoking a cluster of concepts around age-appropriate behavior. </p></li></ol></li></ol><p>📈 As you read through the list of items above, you can imagine that as you go up in number from one to four there’s an explosion of possible relationships between the symbols. And as the number of possible relationships increases, the qualities of the relationships themselves increase in abstraction, complexity, and subtlety.</p><p>The different relationships above take different classes of symbol storage and retrieval — from paper notebooks up to datacenters — to capture and encode in a useful way. </p><p>That first, simplistic Pig Latin relationship can be described on a single sheet of paper, such that anyone with that paper can transform any word from English into Pig Latin. But by the time we get to example four, a strange thing has happened, and that strange thing is why machine learning requires tens of millions of dollars worth of resources: </p><ol><li><p><span>We’ve uncovered a small </span><strong>universe of possible relationships</strong><span> between those collections. There’s just a bewildering, densely connected network of concepts, all the way up the abstraction ladder from simple physical characteristics, to biological taxonomies, to subtle notions of physical and emotional development.</span></p></li><li><p><span>Some of the more abstract possible relationships are more likely to be in play than others. So an element of </span><strong>probability has entered the picture</strong><span>. </span></p><ol><li><p><span>As I said in the example, given that we’re talking about a cat, it’s </span><em>more likely</em><span> that the mature/immature dichotomy is related to a cluster of concepts around physical development and </span><em>less likely</em><span> that it’s related to a cluster of concepts around emotional or intellectual development.</span></p></li></ol></li></ol><p>Regarding the probabilities in #2 above, “less likely” does not mean impossible, especially if we open the door to a bit of extra context. What if we added a few additional words, and the collection pair was: </p><ul><li><p><code>{Regarding the cat in the hat: the cat is mature.}</code></p></li><li><p><code>{Regarding the cat in the hat: the cat is immature.}</code></p></li></ul><p>🌈 Suddenly, all the probabilities have shifted and we’re in a whole other realm of likely meaning with respect to maturity and immaturity.</p><p><strong>Summary:</strong></p><ul><li><p><span>When the relationships among collections of symbols are </span><strong>simple and deterministic</strong><span>, you don’t need much storage or computing power to relate one collection to the other.</span></p></li><li><p><span>When the relationships among collections of symbols are </span><strong>complex and stochastic</strong><span>, then throwing more storage and computing power at the problem of relating one collection to another enables you to relate those collections in ever richer and more complex ways.</span></p></li></ul><p>If you managed to get through high school chemistry, then you have a set of concepts that are useful for thinking about generative AI: atomic orbitals.</p><p><span>😳 And if you didn’t get through basic chemistry, or you don’t remember any of it, then don’t worry. </span><strong>This section is mostly about the pictures</strong><span>, so look at the pictures and scan for the boldfaced words, then move on.</span></p><p>We all learn in basic chemistry that orbitals are just regions of space where an electron is likely to be at any moment. Electrons at different energy levels have orbitals that are shaped differently, which means we’re likely to find them in different regions. </p><p>Take a look at hydrogen:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg" width="1100" height="1000" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/b2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:1000,&#34;width&#34;:1100,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:114424,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb2d67d9f-39bc-4963-a26d-fe3178d6105c_1100x1000.jpeg 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>Let’s zoom in on one of the orbitals:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg" width="600" height="600" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:600,&#34;width&#34;:600,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:23461,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F67053e39-216f-4585-a5a4-f8a10dfa9df4_600x600.jpeg 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p>For the orbital above, the brighter the region the higher the odds you’d bump into an electron there if you were to poke at the atom with something even tinier than an electron. For the black regions in the picture, that doesn’t mean the probability of finding an electron is zero — it just means it’s so low as to practically be zero.</p><p><span>Those orbitals are </span><strong>probability distributions</strong><span> and they have a certain shape to them — the one above has </span><strong>four</strong><span> </span><strong>lobes</strong><span>, so that if you observe a point in one of those four areas you’re more likely to spot an electron than if you observe one of the black regions. The other orbitals have different lobes that are arranged in different ways.</span></p><p>🥳 Ok, you made it! That’s all the quantum chemistry you need, and in fact, it’s all the background you need at the moment. We can now talk about the thing everything is trying to understand: ChatGPT.</p><p>You can imagine that for a model like ChatGPT, each possible blob of text the model could generate — everything from a few words of gibberish to a full page of coherent English — is a single point in a probability distribution, like electron positions in the atomic orbitals of the previous section’s hydrogen atom. </p><p><span>When you feed ChatGPT’s input box a collection of words — e.g. </span><code>{Tell me about the state of a cat in a box with a flask of poison and a bit of radioactive material}</code><span> — you can think of that action of clicking the “Submit” button as making an observation that collapses a wave function and results in an observation of a single collection of symbols (out of many possible collections).</span></p><p><span>🧠 </span><strong>Note for more informed readers:</strong><span> Some of you who read the above will be aware that a text-to-text LLM is actually locating single words in the probability space and successively stringing them together to build up sentences. The distinction between “latent space is the multidimensional space of all likely words the model might output” vs. “latent space is the multidimensional space of all likely word sequences the model might output” is pretty academic at this level of abstraction, though. So for the purpose of downloading better intuitions into readers and minimizing complexity, I’m going with the second option.</span></p><p><span>🎲 Sometimes, your text prompt input will take you to a point in the probability distribution that corresponds to a collection like, </span><code>{The cat is alive}</code><span>, and at other times you’ll end up at a point that corresponds to </span><code>{The cat is dead}</code><span>.</span></p><p><span>Note that it is </span><em>possible</em><span>, though not at all likely, that the aforementioned input symbols could take you to the point in the model’s </span><strong>latent space</strong><span> corresponding to the following collection: </span><code>{ph&#39;nglui mglw&#39;nafh Cthulhu R&#39;lyeh wgah&#39;nagl fhtagn}</code><span>. It all depends on the shape of the probability distributions you’re poking at with your text inputs and on the dice that the universe — or, rather, the computer’s random number generator — is rolling.</span></p><p><strong>👉 Important implication:</strong><span> It’s common but not necessarily always useful to say the language model “knows” the state of the cat in this example — i.e., whether it’s alive or dead. It’s suboptimal to lean too hard on the idea that the model has a kind of internal, true/false orientation to the cat and different claims about its circumstances. </span></p><p>Instead, it’s better to think of it like this: </p><p><span>➡ In the space of all the possible collections of symbols the model could produce — from collections that are snippets of gibberish to collections that are pages of Shakespeare — </span><em>there are regions in the model’s probability distributions that contain collections of symbols we humans interpret to mean that the cat is alive</em><span>. And there are also adjacent regions in that probability space containing collections of symbols we interpret to mean the cat is dead.</span></p><p><span>🐈 Here are some cat-related symbol collections we might encounter in ChatGPT’s </span><strong>latent space</strong><span> — i.e., the space of possible outputs, which has been deliberately sculpted into a particular shape by an expensive training process:</span></p><ul><li><p><code>{The cat roused herself from slumber and blinked her eyes.}</code></p></li><li><p><code>{The soft breathing of the sleeping cat greeted Schrödinger as he opened the box.}</code></p></li><li><p><code>{Ja mon, de cat him dead.}</code></p></li><li><p><code>{“I’ve killed my favorite cat!” screamed Schrödinger as he pulled his pet’s lifeless corpse from the box.}</code></p></li><li><p><code>{Patches watched the scene from above, his astral cat form floating near the ceiling as his master lifted his lifeless body from the box and wept.}</code></p></li></ul><p>When you poke at the model with different input collections, you’re more likely to encounter some of these output collections than others, but they’re all at least theoretically possible to encounter.</p><p><span>👎 So when you and I are both interacting with ChatGPT around a topic that’s related to some set of facts in the world — e.g., the status of the Bengal tiger, and if it’s endangered or not — don’t imagine that we’re both asking some </span><strong>unitary entity with a personal history</strong><span> and set of experiences to communicate to us some of the facts about Bengal tigers that it has tucked away in its memory, where if it tells you one thing and me the opposite then it’s somehow lying to one of us.</span></p><p><span>👍 Rather, think of our activity like this: I am using my text prompt to </span><strong>observe a single point in a probability distribution</strong><span> that corresponds (at least on my reading of the model’s output symbols) to a cluster of facts and concepts around Bengal tigers, and you are doing the same thing. When both of us are getting different sequences of words that seem (again, to us as humans who are interpreting this sequence) to represent a divergent fact pattern — e.g., it tells me the tiger is endangered, and it tells you the tiger is so prevalent that it’s a nuisance animal — it’s because we’re poking at different lobes of a probability distribution and finding different points in those divergent lobes. </span></p><ul><li><p><span>The lobe in the probability distribution that I’m poking at encompasses word sequences that generally correspond to what I, a human English speaker, interpret as claims about the </span><strong>endangered status</strong><span> of Bengal tigers. </span></p></li><li><p><span>The lobe you’re poking at encompasses word sequences that generally correspond to what you interpret as claims about the </span><strong>superabundance</strong><span> of Bengal tigers.</span></p></li></ul><p>So how do we fix this? </p><p>Given that the Bengal tiger is, in fact, endangered (or, at least this is what I take to be the state of the world based on the words that Google’s ML-powered machines are telling right now when I type in a search query), how do we eliminate or at least shrink the probability distribution lobe that you’re poking at — the one that covers text blobs about Bengal tigers overrunning the cities, digging in people’s garbage, and other nonsense?</p><p>✋ Not only is it not clear we can, but it’s also not really clear we’d always want to. Let me explain.</p><p>When an LLM spits out a word combination that an observer takes to misrepresent the state of reality, we say that the model is “hallucinating.”</p><p><strong>😵‍💫 Aside:</strong><span> I gotta say, this “hallucination” term is pretty loaded. His hallucination is her </span><a href="https://en.wikipedia.org/wiki/Mythopoeia" rel="">mythopoesis</a><span> is my prophecy of things which must shortly come to pass (he who has ears to hear, let him hear). Wars have been fought over this stuff, and may be yet again if a famous collection of alleged hallucinations is interpreted as “true” in some way… But let’s not get ahead of ourselves by veering into hermeneutics just yet. We’ll pick up this thread again in a moment.</span></p><p><span>Right now in early 2023, we have a set of tools that allow us to </span><strong>shape an LLM’s probability distributions</strong><span>, so that some regions get smaller or less dense and some regions get larger or denser:</span></p><ol><li><p>Training</p></li><li><p>Fine-tuning</p></li><li><p>Reinforcement learning with human feedback (RLHF)</p></li></ol><p><span>🏋️ We can </span><strong>train</strong><span> a foundation model on high-quality data — on collections of symbols that we, as human observers, take to be meaningful and to correspond to true facts about the world. In this way, the trained model is like an atom where the orbitals are shaped in a way we find to be useful.</span></p><p><span>🪛 Then after poking at that model for a bit and discovering regions in the space of likely outputs that we observers would prefer to stop encountering in the course of our observations, we </span><strong>fine-tune</strong><span> it with more focused, carefully curated training data. This fine-tuning shrinks some lobes and expands others, and hopefully, after poking some more at the results of this lobe-shaping process we’re happier with the outputs we’re seeing when we collapse the wave function again and again.</span></p><p><span>👩‍🏫 Finally, we can bring in some humans in the </span><strong>RLHF</strong><span> phase to help us really to dial in the shape of the model’s probability space so that it covers as tightly as possible only the points in the space of all possible outputs that correspond to “true facts” (whatever those are!) about things in the world, and so that it does not cover any points that correspond to “fake news” (whatever that is!) about things in the world. If we’ve done our job right, then all the observations we make of the model’s probability space will seem true to us.</span></p><p><span>🙋‍♂️ I’m personally left with </span><strong>two primary questions</strong><span> about everything in this section:</span></p><ol><li><p><strong>Who is this “observer”</strong><span> we keep referencing — this human who’s interpreting the model’s output and giving it a 👍 or 👎? Are they in-group or out-group? Are they smart or stupid? Are they really interested in the truth, or are they just trying to sculpt this model’s probability distributions to serve their own ends?</span></p></li><li><p><span>In cases where I’m lucky enough to be the observer who decides whether the model’s output is true or not, </span><strong>do I really always want the truth?</strong><span> If I ask the model for a comforting bedtime story about a unicorn, do I really want it to go all Neil deGrasse Tyson on me and open with “well </span><em>actually</em><span>, Jon…”? Isn’t the model’s ability to make things up often a feature, not a bug?</span></p></li></ol><p><span>These questions are central to the issue of “hallucination,” but they are not technical questions. They are questions of philosophy of language, of hermeneutics, of politics, and, most of all, of </span><strong>power</strong><span>.</span></p><p><strong>This really is the payoff</strong><span> to all this article’s talk of probability distributions, atomic orbitals, and alive/dead cats: </span><em>When I, a human being with a history and an identity and a set of goals and interests, observe a single point in the model’s probability space, it’s always up to me to interpret that point as language and to imbue it with meaning.</em></p><p><span>Indeed, LLMs may be humanity’s first practical use for </span><a href="https://www.poetryfoundation.org/learn/glossary-terms/reader-response-theory" rel="">reader response theory</a><span>, apart from academic self-promotion. Authorial intent doesn’t matter because there literally is no author and no intent — only a text object that a machine assembles from a vast, multidimensional probability distribution.</span></p><p><span>The ChatGPT experience of back-and-forth interaction is powerful, but it’s really a kind of </span><a href="https://uxplanet.org/a-look-at-skeuomorphic-ui-design-32f50016a50a" rel="">skeuomorphic UI affordance</a><span>, like when a calculator app looks like a little physical calculator. </span></p><p><span>🗣️ It certainly </span><em>feels</em><span> like the model itself is learning about you just like you’re learning about it — like as the conversation develops you’re each updating your own internal understanding of the other. But this is mostly not what’s happening, and to the extent that it </span><em>is</em><span> happening, it’s happening in a very limited way.</span></p><p><span>There’s a final concept you need to grasp in order to thoroughly untangle yourself from the idea that ChatGPT is truly talking to </span><em>you</em><span>, vs. just shouting language-like symbol collections into the void: </span><strong>the token window</strong><span>.</span></p><p><span>With a normal language model like what I’ve described so far in this article, you give the model a set of inputs, it does its probability things, and it gives you an output. The inputs are entered into the model’s </span><strong>token window</strong><span>.</span></p><ul><li><p><strong>Tokens</strong><span> are the ML term for the “symbols” I’ve been talking about in this whole article. I wanted to reduce the specialist lingo so I said “symbols,” but really the models take in tokens and spit out tokens.</span></p></li><li><p><span>The </span><strong>window</strong><span> is the number of tokens a model can ingest and turn into a sequence of related output tokens.</span></p></li></ul><p>So when I use a pre-ChatGPT LLM, I put tokens into a token window, then the model returns a point in its latent space that’s located near the tokens I put in.</p><p>Let’s return to the diagram at the start of the article and look at it again with our new knowledge of token windows and probability distributions. That weird-looking thing in the middle is supposed to be the model:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg" width="1000" height="543" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:543,&#34;width&#34;:1000,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:197355,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/jpeg&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F68dcee14-7cdb-4f5d-a670-b353cb068d12_1000x543.jpeg 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p><strong>🔑 This point is key:</strong><span> the probability space </span><em>does not change shape</em><span> in response to the tokens I put into the token window. The model’s weights remain static as I interact with it from one window to the other. It doesn’t remember the contents of previous token windows.</span></p><p>Think of it this way: Every time I put tokens into the model’s token window and hit “Submit,” it’s like I’m walking up to it on the street and speaking to it for the very first time. It has no place to store any mutually evolving, shared history with me.</p><p><strong>Another analogy</strong><span> that’s not perfect, but it’s pretty close: Every time I feed a specific prompt and a seed into Stable Diffusion, I get back the same image. Each prompt and seed combination will take me to a single point in latent space where a particular image is located, and if I keep giving it the same input tokens I’ll keep getting the same output tokens. I’m not building up any shared history with the model and Stable Diffusion isn’t “learning” anything about me as I use it.</span></p><p><span>(Language models like GPT-3 </span><strong>purposefully inject randomness</strong><span> in places where Stable Diffusion does not, in order to vary the output and make it seem more natural. That’s why you get different responses to the same prompt from a language model — it’s a little bit like using Stable Diffusion but the software is forcing you to vary the seed number on each submission. It’s not </span><em>exactly</em><span> like that, but it’s close enough.)</span></p><p><span>🤏 The end result is that the only brand new, post-training information that the model can obtain about the world is </span><strong>limited to whatever I put into a token window</strong><span>. If I type a word sequence containing facts about my marital status into the token window, then the model takes those sequences and returns a point in latent space that’s adjacent to the input sequence — a point that probably represents facts that seem related to the facts I gave it in the token window.</span></p><p><span>ChatGPT is an LLM with a </span><strong>single, large token window</strong><span>, but it uses its token window in such a way as to make the experience of using the model feel more interactive, like a real conversation.</span></p><p><strong>Warning</strong><span>: I haven’t read an explicit explanation of how it works, so what’s in this section is my informed speculation based on how it kinda </span><em>has</em><span> to work. There really aren’t any other options given how LLMs function, but as always if I’m wrong I’m happy to be corrected.</span></p><p>ChatGPT’s clever UI trick is easier to show than to describe, so let’s imagine that I open up my browser and start a fresh ChatGPT session that goes something like this:</p><ul><li><p>Me: What’s up, man.</p></li><li><p>ChatGPT: Not much. What’s up with you?</p></li><li><p>Me: Eh, my cat just died in a lab accident.</p></li><li><p>ChatGPT: I’m very sorry to hear that.</p></li><li><p>Me: Yeah, it sucks. I’ve already picked out a dog at the shelter, though. I pick him up this afternoon. </p></li><li><p>ChatGPT: That’s exciting! I’m sure your new dog will be a as good a companion for you as your now deceased cat.</p></li></ul><p>Let’s break this session down into multiple token windows, each of which gets fed into the model over the course of our session:</p><p>Token window 1: </p><pre><code><code>{What&#39;s up, man.}</code></code></pre><p>Output 1:</p><pre><code><code>{Not much. What’s up with you?}</code></code></pre><p>Token window 2: </p><pre><code><code>{Me: What’s up, man.
 ChatGPT: Not much. What’s up with you?
 Me: Eh, my cat just died in a lab accident.}</code></code></pre><p>Output 2:</p><pre><code><code>{I&#39;m very sorry to hear that.}</code></code></pre><p>Token window 3:</p><pre><code><code>{Me: What’s up, man.
 ChatGPT: Not much. What’s up with you?
 Me: Eh, my cat just died in a lab accident.
 ChatGPT: I’m very sorry to hear that.
 Me: Yeah, it sucks. I’ve already picked out a dog at 
     the shelter, though.}</code></code></pre><p>Output 3:</p><pre><code><code>{That’s exciting! I’m sure your new dog will be a as good a companion for you as your now deceased cat.}</code></code></pre><p>🪄 Do you see the way it works? OpenAI keeps appending the output of each new exchange to the existing output so that the content of the token window grows as the exchange progresses.</p><p>Every time I hit “Send,” OpenAI is not only submitting my latest input to the model — it’s also adding to the token window all the previous exchanges in the session so that the model can take the whole “chat history” and use it to steer me toward the right lobe in its probability space.</p><p>In other words, as my ChatGPT session progresses, the “text prompt” I’m feeding this model is getting longer and more information-rich. So in that third exchange, the only reason ChatGPT “knows” my cat is dead and can respond appropriately is because OpenAI has secretly been slipping our entire “chat” history into every new token window.</p><p><span>The model, then, does not and cannot “know” anything about me other than what’s there in our chat history. The token window, then, is a form of </span><strong>shared, mutable state</strong><span> that the model and I are modifying together and that represents everything the model can possibly use to find a relevant word sequence to show me.</span></p><p>📝 To summarize:</p><ul><li><p><strong>Frozen and immutable</strong><span> during normal use: the </span><em>model’s weights</em><span>, which give rise to the probability distributions described above and that represent everything it “knows” about language and the world.</span></p></li><li><p><strong>Can be updated with new facts</strong><span> about the world: the </span><em>token window</em><span> that I dump into the model in order to get fresh output from it.</span></p></li></ul><p>Note that in the case of BingGPT, it seems there was probably an extra step in there where that newer model was doing a web search, then dumping the results into the token window alongside the entirety of the chat history.</p><p><span>🐳 If you’ve grasped all of the above, then you know why the </span><strong>32K-token window</strong><span> on the upcoming versions of OpenAI’s models is a really big deal. That’s enough tokens to really load up the model with fresh facts, like customer service histories, book chapters or scripts, action sequences, and many other things.</span></p><p>As token windows get bigger, pre-trained models can “learn” more things on-the-fly. So watch for bigger token windows to unlock brand-new AI capabilities.</p></div></div></div></article></div></div></div>
  </body>
</html>
