<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.dialup.net/wingpt/">Original</a>
    <h1>Show HN: WinGPT – AI assistant for Windows 3.1</h1>
    
    <div id="readability-page-1" class="page"><article>
<img src="https://www.dialup.net/wingpt/wingpt_images/wingpt128.png" alt="WinGPT logo"/>

<p>
    Do you use Windows 3.1? Do your friends send you jokes and haikus written by ChatGPT, and make you
    feel left out? Do you wish you had the sum of all human knowledge at your fingertips? Or wish you
    had your very own AI chatbot on your trusty 386?
</p>
<p>
    Wish no more! Introducing WinGPT, an AI Assistant for Windows 3.1.
</p>
<p>
    WinGPT helps you:<sup><a href="#footnote1">[1]</a>
</sup></p>
<ul>
    <li>
        <strong>Do research:</strong> WinGPT helpfully answers your queries on everything from current events to
        kitchen recipes. Say goodbye to dusty encyclopedias and Encarta!
    </li>
    <li>
        <strong>Stay entertained:</strong> WinGPT gives helpful life advice and tells you jokes to your
        heart&#39;s content. Embrace a world of multimedia entertainment right on your desktop,
        as long as it&#39;s text-based!
    </li>
    <li>
        <strong>Master your productivity:</strong> WinGPT is your digital sidekick, helping you draft documents and
        spreadsheets with the utmost confidence.
    </li>
</ul>

<p><img src="https://www.dialup.net/wingpt/wingpt_images/wingpt_current_affairs.png" alt="Screenshot of WinGPT" width="600"/></p>

<h2>How was this made?</h2>
<p>
    WinGPT is written in C, using the standard Windows API. I used
    <a href="https://github.com/open-watcom/open-watcom-v2" target="_blank">Open Watcom v2</a> as the
    compiler, which is very convenient as it supports cross-compiling to 16-bit Windows from even Windows 11.
</p>
<p>
    WinGPT connects to the OpenAI API server <strong>natively with TLS 1.3</strong>, so it doesn&#39;t require a proxy on a
    modern machine to terminate TLS. To see how I did this and some of the challenges,
    take a look at <strong><a href="https://www.dialup.net/wingpt/tls.html">Modern TLS on 16-bit Windows</a></strong>. (As you&#39;ll see on that page,
    this is not a secure implementation).
</p>

<p><img src="https://www.dialup.net/wingpt/wingpt_images/wireshark.png" alt="Screenshot of Wireshark showing WinGPT connecting using TLS" width="600"/></p>

<h2>Building the UI</h2>
<p>
    Having been used to building Windows apps like <a href="https://www.dialup.net/windle/">Windle</a> using
    <a href="https://en.wikipedia.org/wiki/Delphi_(software)" target="_blank">Delphi</a> previously,
    I was surprised how primitive the UI building capabilities are with Windows 3.1 if you only use the
    built-in Windows API.
</p>
<p>
    I built most of the UI in C directly, meaning that each UI component had to be manually constructed in code.
    Resizing logic manually ensures that each component retains its proper size when the window is resized.
</p>
<p><img src="https://www.dialup.net/wingpt/wingpt_images/gui_code.png" alt="Screenshot of WinGPT GUI code" width="600"/></p>
<p>
    In particular, I was surprised that the set of standard controls available to use by any program with
    Windows 3.1 is incredibly limited. You have some controls you&#39;d expect—push buttons, check boxes, radio
    buttons, edit boxes—but any other control you might need, including those used across the operating
    system itself, aren&#39;t available.
</p>
<table>
    <tbody>
        <tr>
            <td><img src="https://www.dialup.net/wingpt/wingpt_images/desktop.png" alt="Desktop settings in Windows 3.1" width="300"/></td>
        </tr>
    </tbody>
    <caption>Desktop control panel in Windows 3.1, showing many of the standard controls.</caption>
</table>
<p>
    I ran into this problem when I was trying to figure out how to add a status bar to WinGPT. Status bars
    appear all over Windows 3.1, including in the File Manager and Control Panel. Unfortunately, Microsoft
    didn&#39;t make them widely available to other application developers until Windows 95, alongside a
    bunch of other useful controls like progress bars, toolbars, and tree views.<sup><a href="#footnote2">[2]</a></sup>
</p>
<p>
    As an aside, I asked ChatGPT how I might be able to use a status bar in my program. It replied with a header file
    that only exists for later versions of Windows, and when I asked it to clarify, it came up with the name
    of a very enticing (but I&#39;m pretty sure very non-existent) UI library. Luckily, Philip J. Erdelsky still
    has a <a href="http://www.efgh.com/old_website/status.html" target="_blank">status bar implementation</a>
    from 1997 that is very kindly in the public domain that I was able to use! I modified that code to more closely
    represent the status bars in Microsoft&#39;s programs pixel for pixel.
</p>
<p><img src="https://www.dialup.net/wingpt/wingpt_images/gaslight.png" alt="Screenshot of ChatGPT" width="600"/></p>
<p>
    Another fun part of building WinGPT was designing the icon in Borland&#39;s Image Editor, which is really
    just a clone of Microsoft Paint that happens to make ICO files instead. Program icons in Windows 3.1 are
    32x32, and show up in the Program Manager as well as in the task switcher. I also designed a 16x16
    version that shows up on later versions of Windows.
</p>
<p><img src="https://www.dialup.net/wingpt/wingpt_images/image_editor.png" alt="Screenshot of the WinGPT icon being created" width="600"/></p>

<h2>Limitations</h2>
<p>
    Memory is quite limited on Windows 3.1 machines, so I tried to reduce the
    amount of memory needed for WinGPT, especially in sending and receiving the query and response from
    the OpenAI API. The JSON responses of modern APIs aren&#39;t especially optimized for size, and OpenAI&#39;s
    API is no exception. I&#39;ve asked the model to be brief in an effort to keep responses as small as possible.
    I&#39;ve also chosen not to send the text of previous turns in the API calls, even though this means that the
    bot won&#39;t be able to use prior conversation context.
</p>
<p><img src="https://www.dialup.net/wingpt/wingpt_images/wingpt_computer.png" alt="Screenshot of WinGPT" width="600"/></p>

<h2>Try WinGPT</h2>
<p>WinGPT is licensed under the GNU General Public License (GPL) v2.</p>

<p>
    WinGPT will work on any 16-bit or 32-bit version of Windows post-Windows 3.1. It requires an
    implementation of Winsock (tested with Microsoft TCP/IP-32 3.11b on Windows 3.11 for Workgroups and
    on stock Windows 2000). It will not work on 64-bit versions of Windows (but does work on
    Wine—give it a try!)
</p>

<p>
    You&#39;ll also need an OpenAI API key to talk to OpenAI. Once you open WinGPT, go to File | Options... to
    enter your secret key.
</p>

<ul>
    <li>Download: <a href="https://www.dialup.net/wingpt/download/wingpt10.zip">Binaries for 16-bit and 32-bit Windows</a></li>
    <li>Source: Bundled with the <a href="https://www.dialup.net/wingpt/tls.html">modified WolfSSL source code</a> (in
    <tt>watcom16/wingpt</tt>)</li>
</ul>

<h2>Footnotes</h2>



</article></div>
  </body>
</html>
