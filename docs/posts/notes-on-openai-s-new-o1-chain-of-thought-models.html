<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simonwillison.net/2024/Sep/12/openai-o1/">Original</a>
    <h1>Notes on OpenAI&#39;s new o1 chain-of-thought models</h1>
    
    <div id="readability-page-1" class="page"><div>


<div data-permalink-context="/2024/Sep/12/openai-o1/">

<p>12th September 2024</p>

<p>OpenAI <a href="https://openai.com/o1/">released two major new preview models</a> today: <code>o1-preview</code> and <code>o1-mini</code> (that mini one is <a href="https://twitter.com/shengjia_zhao/status/1834641413121740893">not a preview</a>)—previously rumored as having the codename “strawberry”. There’s a lot to understand about these models—they’re not as simple as the next step up from GPT-4o, instead introducing some major trade-offs in terms of cost and performance in exchange for improved “reasoning” capabilities.</p>

<ul>
  <li><a href="#trained-for-chain-of-thought">Trained for chain of thought</a></li>
  <li><a href="#low-level-details-from-the-api-documentation">Low-level details from the API documentation</a></li>
  <li><a href="#hidden-reasoning-tokens">Hidden reasoning tokens</a></li>
  <li><a href="#examples">Examples</a></li>
  <li><a href="#what-s-new-in-all-of-this">What’s new in all of this</a></li>
</ul>

<h4 id="trained-for-chain-of-thought">Trained for chain of thought</h4>
<p>OpenAI’s elevator pitch is a good starting point:</p>
<blockquote>
<p>We’ve developed a new series of AI models designed to spend more time thinking before they respond.</p>
</blockquote>
<p>One way to think about these new models is as a specialized extension of the chain of thought prompting pattern—the “think step by step” trick that we’ve been exploring as a a community for a couple of years now, first introduced in the paper <a href="https://arxiv.org/abs/2205.11916">Large Language Models are Zero-Shot Reasoners</a> in May 2022.</p>
<p>OpenAI’s article <a href="https://openai.com/index/learning-to-reason-with-llms/">Learning to Reason with LLMs</a> explains how the new models were trained:</p>
<blockquote>
<p>Our large-scale reinforcement learning algorithm teaches the model how to think productively using its chain of thought in a highly data-efficient training process. We have found that the performance of o1 consistently improves with more reinforcement learning (train-time compute) and with more time spent thinking (test-time compute). The constraints on scaling this approach differ substantially from those of LLM pretraining, and we are continuing to investigate them.</p>
<p>[...]</p>
<p>Through reinforcement learning, o1 learns to hone its chain of thought and refine the strategies it uses. It learns to recognize and correct its mistakes. It learns to break down tricky steps into simpler ones. It learns to try a different approach when the current one isn’t working. This process dramatically improves the model’s ability to reason.</p>
</blockquote>
<p>Effectively, this means the models can better handle significantly more complicated prompts where a good result requires backtracking and “thinking” beyond just next token prediction.</p>
<p>I don’t really like the term “reasoning” because I don’t think it has a robust definition in the context of LLMs, but OpenAI have committed to using it here and I think it does an adequate job of conveying the problem these new models are trying to solve.</p>
<h4 id="low-level-details-from-the-api-documentation">Low-level details from the API documentation</h4>
<p>Some of the most interesting details about the new models and their trade-offs can be found in their <a href="https://platform.openai.com/docs/guides/reasoning">API documentation</a>:</p>
<blockquote>
<p>For applications that need image inputs, function calling, or consistently fast response times, the GPT-4o and GPT-4o mini models will continue to be the right choice. However, if you’re aiming to develop applications that demand deep reasoning and can accommodate longer response times, the o1 models could be an excellent choice.</p>
</blockquote>
<p>Some key points I picked up from the docs:</p>
<ul>
<li>API access to the new <code>o1-preview</code> and <code>o1-mini</code> models is currently reserved for tier 5 accounts—you’ll <a href="https://platform.openai.com/docs/guides/rate-limits/usage-tiers?context=tier-five">need to have spent</a> at least $1,000 on API credits.</li>
<li>No system prompt support—the models use the existing chat completion API but you can only send <code>user</code> and <code>assistant</code> messages.</li>
<li>No streaming support, tool usage, batch calls or image inputs either.</li>
<li>“Depending on the amount of reasoning required by the model to solve the problem, these requests can take anywhere from a few seconds to several minutes.”</li>
</ul>
<p>Most interestingly is the introduction of “reasoning tokens”—tokens that are not visible in the API response but are still billed and counted as output tokens. These tokens are where the new magic happens.</p>
<p>Thanks to the importance of reasoning tokens—OpenAI suggests allocating a budget of around 25,000 of these for prompts that benefit from the new models—the output token allowance has been increased dramatically—to 32,768 for <code>o1-preview</code> and 65,536 for the supposedly smaller <code>o1-mini</code>! These are an increase from the <code>gpt-4o</code> and <code>gpt-4o-mini</code> models which both currently have a 16,384 output token limit.</p>
<p>One last interesting tip from that API documentation:</p>
<blockquote>
<p><strong>Limit additional context in retrieval-augmented generation (RAG)</strong>: When providing additional context or documents, include only the most relevant information to prevent the model from overcomplicating its response.</p>
</blockquote>
<p>This is a big change from how RAG is usually implemented, where the advice is often to cram as many potentially relevant documents as possible into the prompt.</p>
<h4 id="hidden-reasoning-tokens">Hidden reasoning tokens</h4>
<p>A frustrating detail is that those reasoning tokens remain invisible in the API—you get billed for them, but you don’t get to see what they were. OpenAI explain why in <a href="https://openai.com/index/learning-to-reason-with-llms/#hiding-the-chains-of-thought">Hiding the Chains of Thought</a>:</p>
<blockquote>
<p>Assuming it is faithful and legible, the hidden chain of thought allows us to “read the mind” of the model and understand its thought process. For example, in the future we may wish to monitor the chain of thought for signs of manipulating the user. However, for this to work the model must have freedom to express its thoughts in unaltered form, so we cannot train any policy compliance or user preferences onto the chain of thought. We also do not want to make an unaligned chain of thought directly visible to users.</p>
<p>Therefore, after weighing multiple factors including user experience, competitive advantage, and the option to pursue the chain of thought monitoring, we have decided not to show the raw chains of thought to users.</p>
</blockquote>
<p>So two key reasons here: one is around safety and policy compliance: they want the model to be able to reason about how it’s obeying those policy rules without exposing intermediary steps that might include information that violates those policies. The second is what they call <strong>competitive advantage</strong>—which I interpret as wanting to avoid other models being able to train against the reasoning work that they have invested in.</p>
<p>I’m not at all happy about this policy decision. As someone who develops against LLMs interpretability and transparency are everything to me—the idea that I can run a complex prompt and have key details of how that prompt was evaluated hidden from me feels like a big step backwards.</p>
<h4 id="examples">Examples</h4>
<p>OpenAI provide some initial examples in the <a href="https://openai.com/index/learning-to-reason-with-llms/#chain-of-thought">Chain of Thought</a> section of their announcement, covering things like generating Bash scripts, solving crossword puzzles and calculating the pH of a moderately complex solution of chemicals.</p>
<p>These examples show that the ChatGPT UI version of these models <em>does</em> expose details of the chain of thought... but it doesn’t show the raw reasoning tokens, instead using a separate mechanism to summarize the steps into a more human-readable form.</p>
<p>OpenAI also have two new cookbooks with more sophisticated examples, which I found a little hard to follow:</p>
<ul>
<li>
<a href="https://cookbook.openai.com/examples/o1/using_reasoning_for_data_validation">Using reasoning for data validation</a> shows a multiple step process for generating example data in an 11 column CSV and then validating that in various different ways.</li>
<li>
<a href="https://cookbook.openai.com/examples/o1/using_reasoning_for_routine_generation">Using reasoning for routine generation</a> showing <code>o1-preview</code> code to transform knowledge base articles into a set of routines that an LLM can comprehend and follow.</li>
</ul>
<p>I <a href="https://twitter.com/simonw/status/1834286442971103468">asked on Twitter</a> for examples of prompts that people had found which failed on GPT-4o but worked on <code>o1-preview</code>. A couple of my favourites:</p>
<ul>
<li>
<code>How many words are in your response to this prompt?</code> <a href="https://twitter.com/matthewberman/status/1834295485773054312">by Matthew Berman</a>—the model thinks for ten seconds across five visible turns before answering “There are seven words in this sentence.”</li>
<li>
<code>Explain this joke: “Two cows are standing in a field, one cow asks the other: “what do you think about the mad cow disease that’s going around?”. The other one says: “who cares, I’m a helicopter!”</code> <a href="https://twitter.com/fabianstelzer/status/1834300757241102588">by Fabian Stelzer</a>—the explanation makes sense, apparently other  models have failed here.</li>
</ul>
<p>Great examples are still a bit thin on the ground though. Here’s <a href="https://twitter.com/_jasonwei/status/1834278706522849788">a relevant note</a> from OpenAI researcher Jason Wei, who worked on creating these new models:</p>
<blockquote>
<p>Results on AIME and GPQA are really strong, but that doesn’t necessarily translate to something that a user can feel. Even as someone working in science, it’s not easy to find the slice of prompts where GPT-4o fails, o1 does well, and I can grade the answer. But when you do find such prompts, o1 feels totally magical. We all need to find harder prompts.</p>
</blockquote>
<p>Ethan Mollick has been previewing the models for a few weeks, and published <a href="https://www.oneusefulthing.org/p/something-new-on-openais-strawberry">his initial impressions</a>. His crossword example is particularly interesting for the visible reasoning steps, which include notes like:</p>
<blockquote>
<p>I noticed a mismatch between the first letters of 1 Across and 1 Down. Considering “CONS” instead of “LIES” for 1 Across to ensure alignment.</p>
</blockquote>
<h4 id="what-s-new-in-all-of-this">What’s new in all of this</h4>
<p>It’s going to take a while for the community to shake out the best practices for when and where these models should be applied. I expect to continue mostly using GPT-4o (and Claude 3.5 Sonnet), but it’s going to be really interesting to see us collectively expand our mental model of what kind of tasks can be solved using LLMs given this new class of model.</p>
<p>I expect we’ll see other AI labs, including the open model weights community, start to replicate some of these results with their own versions of models that are specifically trained to apply this style of chain-of-thought reasoning.</p>
</div>



</div></div>
  </body>
</html>
