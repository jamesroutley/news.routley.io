<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ntietz.com/blog/til-docker-log-rotation/?utm_source=atom&amp;utm_medium=feed">Original</a>
    <h1>TIL: Docker log rotation</h1>
    
    <div id="readability-page-1" class="page"><div>
  

  <p><strong>Monday, February 16, 2026</strong></p>

  <div><p>Last week, when I went to publish my blog post, I ran into a surprising error: I was out of disk space. My server is used only for hosting a couple of small static sites, so I was surprised. None of the content is very large, why is the disk full?</p>
<p>A little investigation found the culprit. Starting from <code>/</code> and then drilling in using <code>du -h -d 1 .</code> showed me that a Docker folder was using most of the server&#39;s 25 GB disk. None of my container images are very large, so I checked in side and found a few log files that were larger than 10 GB each.</p>
<p>It turns out, Docker doesn&#39;t automatically rotate log files! As long as a container exists, the logs will keep growing for it. This means even if you stop a container and start it again, the logs are still there and getting bigger. I&#39;d not thought about this before, but it turns out that when my blog is seeing heavy traffic, the logs can grow in order of megabytes per hour. And that really adds up over time.</p>
<p>* * *</p>
<p>First I did a quick check of how the logs are configured to start with. You can see the log configuration by using <code>docker inspect</code>.</p>
<pre data-lang="bash"><code data-lang="bash"><span>$ docker inspect --format</span><span>=</span><span>&#39;{{.HostConfig.LogConfig}}&#39;</span><span> my-poor-container
</span><span>{json-file map</span><span>[]</span><span>}
</span></code></pre>
<p>And my container&#39;s logging was totally unconfigured! That explained a lot.</p>
<p>Now the fix is pretty quick. The <a href="https://docs.docker.com/engine/logging/drivers/json-file/">docs</a> show us an example that works well enough here. <code>/etc/docker/daemon.json</code> didn&#39;t exist yet, so I created it and added this log configuration in.</p>
<pre data-lang="json"><code data-lang="json"><span>{
</span><span>  </span><span>&#34;log-driver&#34;</span><span>: </span><span>&#34;json-file&#34;</span><span>,
</span><span>  </span><span>&#34;log-opts&#34;</span><span>: {
</span><span>    </span><span>&#34;max-size&#34;</span><span>: </span><span>&#34;100m&#34;</span><span>,
</span><span>    </span><span>&#34;max-file&#34;</span><span>: </span><span>&#34;3&#34;
</span><span>  }
</span><span>}
</span></code></pre>
<p>The original example had <code>10m</code> for log files, but I want a little more than that. I have the disk space, and I&#39;d like longer to investigate logs before they are truncated away.</p>
<p>After setting that up, I restarted the docker daemon by calling <code>systemctl restart docker</code>. But logs don&#39;t rotate yet, no! The docs told us that this applies for <em>new</em> containers after Docker is restarted, but not for existing containers. So the final step was to stop and remove any containers I wanted rotation to work on, then recreate them.</p>
<p>After that, a quick check, and we&#39;ve got log rotation.</p>
<pre data-lang="bash"><code data-lang="bash"><span>$ docker inspect --format</span><span>=</span><span>&#39;{{.HostConfig.LogConfig}}&#39;</span><span> my-happy-container
</span><span>{json-file map</span><span>[</span><span>max</span><span>-</span><span>file:3 max</span><span>-</span><span>size:100m</span><span>]</span><span>}
</span></code></pre>
<p>* * *</p>
<p>Don&#39;t be like me, don&#39;t forget to rotate your logs!</p>
<p>Or, do forget. Focus on the things you enjoy, and do just enough of the other things to make it work. You can always hire someone else to solve some of the annoying, tedious, or difficult problems for you. (Hi. <a href="https://cuteandfuzzylogic.com">Hire me!</a>)</p>
<hr/>
</div>

  


  <hr/>
  <p><i>
  If you&#39;re looking for help on a software project, please consider <a href="https://cuteandfuzzylogic.com">working with me</a>!
  </i></p>


  <hr/>

  <p>
    Please share this post, and subscribe to the <a href="https://ntietz.com/newsletter/">newsletter</a> or <a href="https://ntietz.com/atom.xml">RSS feed</a>.
    You can email <a href="mailto:me@ntietz.com">my personal email</a> with any comments or questions.
  </p>


  <p>
  <i></i> Want to become a better programmer?
  <a href="https://www.recurse.com/scout/click?t=c9a1a9e2e7a2ffefd4af20020b4af1e6">Join the Recurse Center!</a>
  </p>


</div></div>
  </body>
</html>
